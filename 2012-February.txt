From bbolker at gmail.com  Wed Feb  1 00:25:21 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 31 Jan 2012 18:25:21 -0500
Subject: [Rd] ignorant question about Roxy- mode in ESS
Message-ID: <4F287861.4030904@gmail.com>


  I am slowly getting up to speed/being dragged into using Roxygen in a
project. I'm wondering if there's a way to emulate the behaviour of C-c
C-p (Rd-preview-help) in Rd-mode (create a preview in a new Emacs buffer
in "R Help Preview" mode), but from an Roxygen chunk.  In Roxy-mode
there is C-c C-e C-t (ess-proxy-preview-HTML), which works to preview
the documentation derived from the current chunk, but it opens the view
in a browser window instead of an Emacs buffer. (ess-proxy-preview-Rd
previews the Rd file, which I find cannot be transitively run through
Rd-preview-help ...)

 (update: I can get it to work if I C-u C-c C-e C-r [to create a buffer
with the right name], C-x C-s [save it], *then* C-c C-p , but this (a)
seems like a lot of keystrokes, (b) creates a file that I then have to
go delete ...)

  Any ideas?  I'm not enough of an emacs-hacker to figure out how to put
these two pieces together.  Perhaps I have an old ess version (5.14)?

 thanks
   Ben Bolker


From bbolker at gmail.com  Wed Feb  1 02:58:43 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 1 Feb 2012 01:58:43 +0000
Subject: [Rd] ignorant question about Roxy- mode in ESS
References: <4F287861.4030904@gmail.com>
Message-ID: <loom.20120201T025646-955@post.gmane.org>

Ben Bolker <bbolker <at> gmail.com> writes:

>   I am slowly getting up to speed/being dragged into using Roxygen in a
> project. I'm wondering if there's a way to emulate the behaviour of C-c
> C-p (Rd-preview-help) in Rd-mode (create a preview in a new Emacs buffer
> in "R Help Preview" mode), but from an Roxygen chunk.  In Roxy-mode
> there is C-c C-e C-t (ess-proxy-preview-HTML), which works to preview
> the documentation derived from the current chunk, but it opens the view
> in a browser window instead of an Emacs buffer. (ess-proxy-preview-Rd
> previews the Rd file, which I find cannot be transitively run through
> Rd-preview-help ...)
> 
>  (update: I can get it to work if I C-u C-c C-e C-r [to create a buffer
> with the right name], C-x C-s [save it], *then* C-c C-p , but this (a)
> seems like a lot of keystrokes, (b) creates a file that I then have to
> go delete ...)
> 
>   Any ideas?  I'm not enough of an emacs-hacker to figure out how to put
> these two pieces together.  Perhaps I have an old ess version (5.14)?
> 

  UPDATE: after some more poking around I found the ess-help list,
probably a better place for this (and found a relatively recent, open
thread where people were having a similar issue: 
http://thread.gmane.org/gmane.emacs.ess.general/5477/ ).


From dpugmire at gmail.com  Wed Feb  1 16:24:23 2012
From: dpugmire at gmail.com (Dave Pugmire)
Date: Wed, 1 Feb 2012 10:24:23 -0500
Subject: [Rd] Crash in R using embedded.
Message-ID: <CAM6_Vww=6SjgiDpZLQookKN=4jJCWz3HEBJyjTisq6yfAYaHMQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120201/865f44fc/attachment.pl>

From murdoch.duncan at gmail.com  Wed Feb  1 17:41:06 2012
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 01 Feb 2012 11:41:06 -0500
Subject: [Rd] Crash in R using embedded.
In-Reply-To: <CAM6_Vww=6SjgiDpZLQookKN=4jJCWz3HEBJyjTisq6yfAYaHMQ@mail.gmail.com>
References: <CAM6_Vww=6SjgiDpZLQookKN=4jJCWz3HEBJyjTisq6yfAYaHMQ@mail.gmail.com>
Message-ID: <4F296B22.4090607@gmail.com>

You posted this message already.  If you didn't get any responses based 
on that posting, I think it means nobody has any suggestions beyond what 
you're already doing.  Debugging is hard sometimes, even if you approach 
it in the right way.

A common source of hard-to-find bugs is the R garbage collection scheme: 
  if you don't PROTECT an allocation, sometimes it will be overwritten 
before you're done with it, because you haven't told R you're using it. 
  Running under gctorture() can sometimes trigger this sooner, but it's 
very slow.

Duncan Murdoch

On 12-02-01 10:24 AM, Dave Pugmire wrote:
> Hi,
> I'm new to R, and am trying to embed R into another application.
> I'm calling gev.fit() from the ismev package, and it is crashing somewhere
> inside it.
> gdb is not catching it, and valgrind is not showing any memory corruption
> issues.
> I suspect it's memory corruption, because it doesn't crash in exactly the
> same spot each time.
> I'm running R 2.12.2 on a 64 bit linux (Ubuntu 10.04)
>
> Also, before I make the gev.fit() call, I save out the R state using
> "save.image(....)", then load the image file into a standalone R on the
> console, and call gev.fit(), and it works fine.
> So, it's something to do with my app, and the R.
>
> I'm looking for hints/ideas/tricks/etc for debugging this.
> I'm starting to put print statements into the R code, and into the C code
> in R (src/main/optim.c), but it hasn't shown me the source of the problem.
>
> Thanks!
>
>
> Here is the code I'm using to initialize:
>
> putenv("R_HOME=/apps/R/install/lib64/R");
> const char *R_argv[]= {"RInterfaceTest", "--gui=none", "--no-save",
> "--no-readline", "--silent"};
> Rf_initialize_R(sizeof(R_argv)/sizeof(R_argv[0]), const_cast<char
> **>(R_argv));
>
> setup_Rmainloop();
>
> ParseStatus status;
> SEXP cmdSexp, cmdexpr = R_NilValue;
> int error;
> string rcommand = "f<-file(paste(tempdir(), \"/Routput.txt\", sep = \"\"),
> open=\"wt+\")\nsink(f)\n";
> PROTECT(cmdSexp = allocVector(STRSXP, 1));
> SET_STRING_ELT(cmdSexp, 0, mkChar(rcommand.c_str()));
>
> cmdexpr = PROTECT(R_ParseVector(cmdSexp, -1,&status, R_NilValue));
> for(int i = 0; i<  length(cmdexpr); i++)
> {
>       R_tryEval(VECTOR_ELT(cmdexpr, i),NULL,&error);
>   }
>   UNPROTECT(2);
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From oliver at first.in-berlin.de  Wed Feb  1 18:38:42 2012
From: oliver at first.in-berlin.de (oliver)
Date: Wed, 1 Feb 2012 18:38:42 +0100
Subject: [Rd] Crash in R using embedded.
In-Reply-To: <CAM6_Vww=6SjgiDpZLQookKN=4jJCWz3HEBJyjTisq6yfAYaHMQ@mail.gmail.com>
References: <CAM6_Vww=6SjgiDpZLQookKN=4jJCWz3HEBJyjTisq6yfAYaHMQ@mail.gmail.com>
Message-ID: <20120201173842.GA9093@siouxsie>

Hello,


On Wed, Feb 01, 2012 at 10:24:23AM -0500, Dave Pugmire wrote:
> Hi,
> I'm new to R, and am trying to embed R into another application.
> I'm calling gev.fit() from the ismev package, and it is crashing somewhere
> inside it.
> gdb is not catching it, and valgrind is not showing any memory corruption
> issues.
[...]

valgrind? *shudder*  ;-)


> I suspect it's memory corruption, because it doesn't crash in exactly the
> same spot each time.
> I'm running R 2.12.2 on a 64 bit linux (Ubuntu 10.04)
[...]

You could analyze the coredump with gdb, if you allow one to be written.

On Ubuntu the default is to set core size to 0 Bytes,
so a crash will be silent.
(I think this is also true on some (most? all?) other Linux distributions).

You need to change this behaviour and then you might get some progress
in your debugging attempts.

Ciao,
   Oliver


From edd at debian.org  Wed Feb  1 19:07:08 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 1 Feb 2012 12:07:08 -0600
Subject: [Rd] Crash in R using embedded.
In-Reply-To: <CAM6_Vww=6SjgiDpZLQookKN=4jJCWz3HEBJyjTisq6yfAYaHMQ@mail.gmail.com>
References: <CAM6_Vww=6SjgiDpZLQookKN=4jJCWz3HEBJyjTisq6yfAYaHMQ@mail.gmail.com>
Message-ID: <20265.32588.891886.41937@max.nulle.part>


On 1 February 2012 at 10:24, Dave Pugmire wrote:
| Hi,
| I'm new to R, and am trying to embed R into another application.
| I'm calling gev.fit() from the ismev package, and it is crashing somewhere
| inside it.
| gdb is not catching it, and valgrind is not showing any memory corruption
| issues.
| I suspect it's memory corruption, because it doesn't crash in exactly the
| same spot each time.
| I'm running R 2.12.2 on a 64 bit linux (Ubuntu 10.04)
| 
| Also, before I make the gev.fit() call, I save out the R state using
| "save.image(....)", then load the image file into a standalone R on the
| console, and call gev.fit(), and it works fine.
| So, it's something to do with my app, and the R.
| 
| I'm looking for hints/ideas/tricks/etc for debugging this.
| I'm starting to put print statements into the R code, and into the C code
| in R (src/main/optim.c), but it hasn't shown me the source of the problem.
| 
| Thanks!
| 
| 
| Here is the code I'm using to initialize:
| 
| putenv("R_HOME=/apps/R/install/lib64/R");
| const char *R_argv[]= {"RInterfaceTest", "--gui=none", "--no-save",
| "--no-readline", "--silent"};
| Rf_initialize_R(sizeof(R_argv)/sizeof(R_argv[0]), const_cast<char
| **>(R_argv));
| 
| setup_Rmainloop();
| 
| ParseStatus status;
| SEXP cmdSexp, cmdexpr = R_NilValue;
| int error;
| string rcommand = "f<-file(paste(tempdir(), \"/Routput.txt\", sep = \"\"),
| open=\"wt+\")\nsink(f)\n";
| PROTECT(cmdSexp = allocVector(STRSXP, 1));
| SET_STRING_ELT(cmdSexp, 0, mkChar(rcommand.c_str()));
| 
| cmdexpr = PROTECT(R_ParseVector(cmdSexp, -1, &status, R_NilValue));
| for(int i = 0; i < length(cmdexpr); i++)
| {
|      R_tryEval(VECTOR_ELT(cmdexpr, i),NULL,&error);
|  }
|  UNPROTECT(2);

FWIW I think both littler and RInside use a bit more legwork to initialize
the R engine they embed. The code is public, so you could look at that.

And/or you could of course just use RInside to make your life easier...

Dirk

-- 
"Outside of a dog, a book is a man's best friend. Inside of a dog, it is too
dark to read." -- Groucho Marx


From rflight79 at gmail.com  Wed Feb  1 20:10:48 2012
From: rflight79 at gmail.com (Robert M. Flight)
Date: Wed, 1 Feb 2012 14:10:48 -0500
Subject: [Rd] location of check.Renviron on Windows
Message-ID: <CAJLyBTX-cq8zEgziSkrJyLQ7BJ_g7632JYxe_L11-NymSMoOvg@mail.gmail.com>

Doing package development on a Windows 7 machine, and I want to tell R
check not to worry about the "suggested" packages.

I realize this can be done using the ~/.R/check.Renviron file, but
what directory corresponds to "~"? Is that supposed to be the user
directory? Or is it some other directory?

I have this _R_CHECK_FORCE_SUGGESTS_=false (have also tried FALSE) in
C:\Users\username\.R

I have also tried putting the file in C:\Users\username

Using r58183

Thanks,

-Robert

Robert M. Flight, Ph.D.
University of Louisville Bioinformatics Laboratory
University of Louisville
Louisville, KY

PH 502-852-1809 (HSC)
PH 502-852-0467 (Belknap)
EM robert.flight at louisville.edu
EM rflight79 at gmail.com
robertmflight.blogspot.com
bioinformatics.louisville.edu/lab

The most exciting phrase to hear in science, the one that heralds new
discoveries, is not "Eureka!" (I found it!) but "That's funny ..." -
Isaac Asimov


From ligges at statistik.tu-dortmund.de  Wed Feb  1 20:23:13 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 01 Feb 2012 20:23:13 +0100
Subject: [Rd] location of check.Renviron on Windows
In-Reply-To: <CAJLyBTX-cq8zEgziSkrJyLQ7BJ_g7632JYxe_L11-NymSMoOvg@mail.gmail.com>
References: <CAJLyBTX-cq8zEgziSkrJyLQ7BJ_g7632JYxe_L11-NymSMoOvg@mail.gmail.com>
Message-ID: <4F299121.6070900@statistik.tu-dortmund.de>



On 01.02.2012 20:10, Robert M. Flight wrote:
> Doing package development on a Windows 7 machine, and I want to tell R
> check not to worry about the "suggested" packages.
>
> I realize this can be done using the ~/.R/check.Renviron file, but
> what directory corresponds to "~"? Is that supposed to be the user
> directory? Or is it some other directory?
>
> I have this _R_CHECK_FORCE_SUGGESTS_=false (have also tried FALSE) in
> C:\Users\username\.R


~ is proably "c:/Users/%USERNAME%/My Documents" (cannot remember exactly 
- on XP right now).

Uwe Ligges




>
> I have also tried putting the file in C:\Users\username
>
> Using r58183
>
> Thanks,
>
> -Robert
>
> Robert M. Flight, Ph.D.
> University of Louisville Bioinformatics Laboratory
> University of Louisville
> Louisville, KY
>
> PH 502-852-1809 (HSC)
> PH 502-852-0467 (Belknap)
> EM robert.flight at louisville.edu
> EM rflight79 at gmail.com
> robertmflight.blogspot.com
> bioinformatics.louisville.edu/lab
>
> The most exciting phrase to hear in science, the one that heralds new
> discoveries, is not "Eureka!" (I found it!) but "That's funny ..." -
> Isaac Asimov
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From edd at debian.org  Wed Feb  1 20:41:30 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 1 Feb 2012 13:41:30 -0600
Subject: [Rd] location of check.Renviron on Windows
In-Reply-To: <4F299121.6070900@statistik.tu-dortmund.de>
References: <CAJLyBTX-cq8zEgziSkrJyLQ7BJ_g7632JYxe_L11-NymSMoOvg@mail.gmail.com>
	<4F299121.6070900@statistik.tu-dortmund.de>
Message-ID: <20265.38250.503358.232636@max.nulle.part>


On 1 February 2012 at 20:23, Uwe Ligges wrote:
| 
| 
| On 01.02.2012 20:10, Robert M. Flight wrote:
| > Doing package development on a Windows 7 machine, and I want to tell R
| > check not to worry about the "suggested" packages.
| >
| > I realize this can be done using the ~/.R/check.Renviron file, but
| > what directory corresponds to "~"? Is that supposed to be the user
| > directory? Or is it some other directory?
| >
| > I have this _R_CHECK_FORCE_SUGGESTS_=false (have also tried FALSE) in
| > C:\Users\username\.R
| 
| 
| ~ is proably "c:/Users/%USERNAME%/My Documents" (cannot remember exactly 
| - on XP right now).

I always define HOME on Windows.  

Stupid that this is still a required manual step in this day and age, but
then it is on Windows where many things "different".

Dirk
 
| Uwe Ligges
| 
| 
| 
| 
| >
| > I have also tried putting the file in C:\Users\username
| >
| > Using r58183
| >
| > Thanks,
| >
| > -Robert
| >
| > Robert M. Flight, Ph.D.
| > University of Louisville Bioinformatics Laboratory
| > University of Louisville
| > Louisville, KY
| >
| > PH 502-852-1809 (HSC)
| > PH 502-852-0467 (Belknap)
| > EM robert.flight at louisville.edu
| > EM rflight79 at gmail.com
| > robertmflight.blogspot.com
| > bioinformatics.louisville.edu/lab
| >
| > The most exciting phrase to hear in science, the one that heralds new
| > discoveries, is not "Eureka!" (I found it!) but "That's funny ..." -
| > Isaac Asimov
| >
| > ______________________________________________
| > R-devel at r-project.org mailing list
| > https://stat.ethz.ch/mailman/listinfo/r-devel
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
"Outside of a dog, a book is a man's best friend. Inside of a dog, it is too
dark to read." -- Groucho Marx


From simon.urbanek at r-project.org  Wed Feb  1 20:52:50 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 1 Feb 2012 14:52:50 -0500
Subject: [Rd] location of check.Renviron on Windows
In-Reply-To: <CAJLyBTX-cq8zEgziSkrJyLQ7BJ_g7632JYxe_L11-NymSMoOvg@mail.gmail.com>
References: <CAJLyBTX-cq8zEgziSkrJyLQ7BJ_g7632JYxe_L11-NymSMoOvg@mail.gmail.com>
Message-ID: <6F67C614-BCA7-4B93-B382-7BABFFFE795D@r-project.org>


On Feb 1, 2012, at 2:10 PM, Robert M. Flight wrote:

> Doing package development on a Windows 7 machine, and I want to tell R
> check not to worry about the "suggested" packages.
> 
> I realize this can be done using the ~/.R/check.Renviron file, but
> what directory corresponds to "~"? Is that supposed to be the user
> directory? Or is it some other directory?
> 

Ask R:

> normalizePath("~")
[1] "C:\\Users\\urbanek\\Documents"

Cheers,
S


> I have this _R_CHECK_FORCE_SUGGESTS_=false (have also tried FALSE) in
> C:\Users\username\.R
> 
> I have also tried putting the file in C:\Users\username
> 
> Using r58183
> 
> Thanks,
> 
> -Robert
> 
> Robert M. Flight, Ph.D.
> University of Louisville Bioinformatics Laboratory
> University of Louisville
> Louisville, KY
> 
> PH 502-852-1809 (HSC)
> PH 502-852-0467 (Belknap)
> EM robert.flight at louisville.edu
> EM rflight79 at gmail.com
> robertmflight.blogspot.com
> bioinformatics.louisville.edu/lab
> 
> The most exciting phrase to hear in science, the one that heralds new
> discoveries, is not "Eureka!" (I found it!) but "That's funny ..." -
> Isaac Asimov
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>


From rflight79 at gmail.com  Wed Feb  1 20:57:43 2012
From: rflight79 at gmail.com (Robert M. Flight)
Date: Wed, 1 Feb 2012 14:57:43 -0500
Subject: [Rd] location of check.Renviron on Windows
In-Reply-To: <6F67C614-BCA7-4B93-B382-7BABFFFE795D@r-project.org>
References: <CAJLyBTX-cq8zEgziSkrJyLQ7BJ_g7632JYxe_L11-NymSMoOvg@mail.gmail.com>
	<6F67C614-BCA7-4B93-B382-7BABFFFE795D@r-project.org>
Message-ID: <CAJLyBTXrePc1N=v3MqcbP548viVpDygAKs7jvm6mGy7pYAiwdA@mail.gmail.com>

Thanks Simon, that did the ticket. Will remember that next time.

-Robert

Robert M. Flight, Ph.D.
University of Louisville Bioinformatics Laboratory
University of Louisville
Louisville, KY

PH 502-852-1809 (HSC)
PH 502-852-0467 (Belknap)
EM robert.flight at louisville.edu
EM rflight79 at gmail.com
robertmflight.blogspot.com
bioinformatics.louisville.edu/lab

The most exciting phrase to hear in science, the one that heralds new
discoveries, is not "Eureka!" (I found it!) but "That's funny ..." -
Isaac Asimov



On Wed, Feb 1, 2012 at 14:52, Simon Urbanek <simon.urbanek at r-project.org> wrote:
>
> On Feb 1, 2012, at 2:10 PM, Robert M. Flight wrote:
>
>> Doing package development on a Windows 7 machine, and I want to tell R
>> check not to worry about the "suggested" packages.
>>
>> I realize this can be done using the ~/.R/check.Renviron file, but
>> what directory corresponds to "~"? Is that supposed to be the user
>> directory? Or is it some other directory?
>>
>
> Ask R:
>
>> normalizePath("~")
> [1] "C:\\Users\\urbanek\\Documents"
>
> Cheers,
> S
>
>
>> I have this _R_CHECK_FORCE_SUGGESTS_=false (have also tried FALSE) in
>> C:\Users\username\.R
>>
>> I have also tried putting the file in C:\Users\username
>>
>> Using r58183
>>
>> Thanks,
>>
>> -Robert
>>
>> Robert M. Flight, Ph.D.
>> University of Louisville Bioinformatics Laboratory
>> University of Louisville
>> Louisville, KY
>>
>> PH 502-852-1809 (HSC)
>> PH 502-852-0467 (Belknap)
>> EM robert.flight at louisville.edu
>> EM rflight79 at gmail.com
>> robertmflight.blogspot.com
>> bioinformatics.louisville.edu/lab
>>
>> The most exciting phrase to hear in science, the one that heralds new
>> discoveries, is not "Eureka!" (I found it!) but "That's funny ..." -
>> Isaac Asimov
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>


From ripley at stats.ox.ac.uk  Wed Feb  1 22:44:06 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 01 Feb 2012 21:44:06 +0000
Subject: [Rd] location of check.Renviron on Windows
In-Reply-To: <CAJLyBTXrePc1N=v3MqcbP548viVpDygAKs7jvm6mGy7pYAiwdA@mail.gmail.com>
References: <CAJLyBTX-cq8zEgziSkrJyLQ7BJ_g7632JYxe_L11-NymSMoOvg@mail.gmail.com>
	<6F67C614-BCA7-4B93-B382-7BABFFFE795D@r-project.org>
	<CAJLyBTXrePc1N=v3MqcbP548viVpDygAKs7jvm6mGy7pYAiwdA@mail.gmail.com>
Message-ID: <4F29B226.7000104@stats.ox.ac.uk>

On 01/02/2012 19:57, Robert M. Flight wrote:
> Thanks Simon, that did the ticket. Will remember that next time.

It is also an FAQ:

http://cran.r-project.org/bin/windows/base/rw-FAQ.html#What-are-HOME-and-working-directories_003f

> -Robert
>
> Robert M. Flight, Ph.D.
> University of Louisville Bioinformatics Laboratory
> University of Louisville
> Louisville, KY
>
> PH 502-852-1809 (HSC)
> PH 502-852-0467 (Belknap)
> EM robert.flight at louisville.edu
> EM rflight79 at gmail.com
> robertmflight.blogspot.com
> bioinformatics.louisville.edu/lab
>
> The most exciting phrase to hear in science, the one that heralds new
> discoveries, is not "Eureka!" (I found it!) but "That's funny ..." -
> Isaac Asimov
>
>
>
> On Wed, Feb 1, 2012 at 14:52, Simon Urbanek<simon.urbanek at r-project.org>  wrote:
>>
>> On Feb 1, 2012, at 2:10 PM, Robert M. Flight wrote:
>>
>>> Doing package development on a Windows 7 machine, and I want to tell R
>>> check not to worry about the "suggested" packages.
>>>
>>> I realize this can be done using the ~/.R/check.Renviron file, but
>>> what directory corresponds to "~"? Is that supposed to be the user
>>> directory? Or is it some other directory?
>>>
>>
>> Ask R:
>>
>>> normalizePath("~")
>> [1] "C:\\Users\\urbanek\\Documents"
>>
>> Cheers,
>> S
>>
>>
>>> I have this _R_CHECK_FORCE_SUGGESTS_=false (have also tried FALSE) in
>>> C:\Users\username\.R
>>>
>>> I have also tried putting the file in C:\Users\username
>>>
>>> Using r58183
>>>
>>> Thanks,
>>>
>>> -Robert
>>>
>>> Robert M. Flight, Ph.D.
>>> University of Louisville Bioinformatics Laboratory
>>> University of Louisville
>>> Louisville, KY
>>>
>>> PH 502-852-1809 (HSC)
>>> PH 502-852-0467 (Belknap)
>>> EM robert.flight at louisville.edu
>>> EM rflight79 at gmail.com
>>> robertmflight.blogspot.com
>>> bioinformatics.louisville.edu/lab
>>>
>>> The most exciting phrase to hear in science, the one that heralds new
>>> discoveries, is not "Eureka!" (I found it!) but "That's funny ..." -
>>> Isaac Asimov
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From wdunlap at tibco.com  Thu Feb  2 20:54:11 2012
From: wdunlap at tibco.com (William Dunlap)
Date: Thu, 2 Feb 2012 19:54:11 +0000
Subject: [Rd] inconsistency with names on call object
Message-ID: <E66794E69CFDE04D9A70842786030B93263817@PA-MBX03.na.tibco.com>

With most sorts of objects the following three expression
have the same value:
    names(obj)
    attr(obj, "names")
    attributes(obj)$names
However, for call objects the last gives NULL, whether there
are names or not.
    > obj <- quote(func(one=1))
    > obj
    func(one = 1)
    > names(obj)
    [1] ""    "one"
    > attr(obj, "names")
    [1] ""    "one"
    > attributes(obj)$names
    NULL
I imagine that the underlying cause is that names are not
stored as other attributes are for call objects.  Is is
just an oversight that attributes(call) does not include
a "names" component?

This can arise when using functions that recursively walk
through objects. 

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com 


From tal.galili at gmail.com  Fri Feb  3 16:55:48 2012
From: tal.galili at gmail.com (Tal Galili)
Date: Fri, 3 Feb 2012 17:55:48 +0200
Subject: [Rd] Is the link to the R wiki down?
Message-ID: <CANdJ3dUtH27qGopM6U9s8mykbb6AuWFjmzbhhWdxVZdmovcyFw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120203/3fa852da/attachment.pl>

From simon.urbanek at r-project.org  Fri Feb  3 18:08:03 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 3 Feb 2012 12:08:03 -0500
Subject: [Rd] Is the link to the R wiki down?
In-Reply-To: <CANdJ3dUtH27qGopM6U9s8mykbb6AuWFjmzbhhWdxVZdmovcyFw@mail.gmail.com>
References: <CANdJ3dUtH27qGopM6U9s8mykbb6AuWFjmzbhhWdxVZdmovcyFw@mail.gmail.com>
Message-ID: <D7992417-C1DE-47B2-8631-3969AD5CBCA8@r-project.org>

On Feb 3, 2012, at 10:55 AM, Tal Galili wrote:

> I am getting a 404 page for this:
> http://wiki.r-project.org/
> 
> I was not sure who to write this to - so I am writing it here.
> 

This seems like a server mis-configuration on the wiki server which is external and if I remember correctly run by Philippe Grosjean. The actual URL seems to work
http://rwiki.sciviews.org/

Cheers,
Simon


> Best,
> Tal
> 
> 
> ----------------Contact
> Details:-------------------------------------------------------
> Contact me: Tal.Galili at gmail.com |  972-52-7275845
> Read me: www.talgalili.com (Hebrew) | www.biostatistics.co.il (Hebrew) |
> www.r-statistics.com (English)
> ----------------------------------------------------------------------------------------------
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From malsburg at gmail.com  Fri Feb  3 11:49:37 2012
From: malsburg at gmail.com (Titus von der Malsburg)
Date: Fri, 3 Feb 2012 11:49:37 +0100
Subject: [Rd] Resume processing after warning handler.
Message-ID: <CAM+LvrB21RWJJ2UcO6xaNbb5X9xUJXju04pwEJCwAt79qjdUtQ@mail.gmail.com>

Dear list!

I have a script that processes a large number of data files.  When one
file fails to process correctly, I want the script to write a message
and to continue with the next file.  I achieved this with tryCatch:

  for (f in files)
    tryCatch({heavy.lifting(f)}, error=function(e) log.error.to.file(e))

I also want to log warning messages and tried something like this:

  for (f in files)
    tryCatch({heavy.lifting(f)},
             warning=function(w) {log.warning.to.file(w)},
             error=function(e) {log.error.to.file(e)})

Unfortunately, this aborts processing when a warning is generated.  My
question: how can I resume processing after I logged the warning as if
nothing had happened?  My understanding of the man page is that his is
not possible with tryCatch but I'm not sure.

Thanks for any suggestions!

  Titus


From Philippe.Grosjean at umons.ac.be  Fri Feb  3 17:19:00 2012
From: Philippe.Grosjean at umons.ac.be (Philippe Grosjean)
Date: Fri, 3 Feb 2012 17:19:00 +0100
Subject: [Rd] Is the link to the R wiki down?
In-Reply-To: <CANdJ3dUtH27qGopM6U9s8mykbb6AuWFjmzbhhWdxVZdmovcyFw@mail.gmail.com>
References: <CANdJ3dUtH27qGopM6U9s8mykbb6AuWFjmzbhhWdxVZdmovcyFw@mail.gmail.com>
Message-ID: <4F2C08F4.1060008@umons.ac.be>

Hello,

I am the guilty! I am changing the wiki server... but cannot get that 
name resolution to work. The R wiki is now served at 
http://rwiki.sciviews.org. I still have to solve translation into 
http://wiki.r-project.org.
Best,

Philippe Grosjean

On 03/02/12 16:55, Tal Galili wrote:
> I am getting a 404 page for this:
> http://wiki.r-project.org/
>
> I was not sure who to write this to - so I am writing it here.
>
> Best,
> Tal
>
>
> ----------------Contact
> Details:-------------------------------------------------------
> Contact me: Tal.Galili at gmail.com |  972-52-7275845
> Read me: www.talgalili.com (Hebrew) | www.biostatistics.co.il (Hebrew) |
> www.r-statistics.com (English)
> ----------------------------------------------------------------------------------------------
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From mtmorgan at fhcrc.org  Sat Feb  4 16:37:19 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Sat, 04 Feb 2012 07:37:19 -0800
Subject: [Rd] Resume processing after warning handler.
In-Reply-To: <CAM+LvrB21RWJJ2UcO6xaNbb5X9xUJXju04pwEJCwAt79qjdUtQ@mail.gmail.com>
References: <CAM+LvrB21RWJJ2UcO6xaNbb5X9xUJXju04pwEJCwAt79qjdUtQ@mail.gmail.com>
Message-ID: <4F2D50AF.2050801@fhcrc.org>

On 02/03/2012 02:49 AM, Titus von der Malsburg wrote:
> Dear list!
>
> I have a script that processes a large number of data files.  When one
> file fails to process correctly, I want the script to write a message
> and to continue with the next file.  I achieved this with tryCatch:
>
>    for (f in files)
>      tryCatch({heavy.lifting(f)}, error=function(e) log.error.to.file(e))
>
> I also want to log warning messages and tried something like this:
>
>    for (f in files)
>      tryCatch({heavy.lifting(f)},
>               warning=function(w) {log.warning.to.file(w)},
>               error=function(e) {log.error.to.file(e)})
>
> Unfortunately, this aborts processing when a warning is generated.  My
> question: how can I resume processing after I logged the warning as if
> nothing had happened?  My understanding of the man page is that his is
> not possible with tryCatch but I'm not sure.

Hi Titus -- use withCallingHandlers to capture the warning, and 
invokeRestart() to continue after handling it.

withCallingHandlers({
     warning('oops')
     message('continuing')
}, warning=function(w) {
     message('handling: ', conditionMessage(w))
     invokeRestart("muffleWarning")
})


>
> Thanks for any suggestions!
>
>    Titus
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From maechler at stat.math.ethz.ch  Sat Feb  4 17:38:52 2012
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Sat, 4 Feb 2012 17:38:52 +0100
Subject: [Rd] RFC: Proposal to make NROW() and NCOL() slightly more general
Message-ID: <20269.24348.398088.826473@stat.math.ethz.ch>

The help has

> Description:

>   'nrow' and 'ncol' return the number of rows or columns present in 'x'.  
>   'NCOL' and 'NROW' do the same treating a vector as 1-column matrix.

and

>   x: a vector, array or data frame

I'm proposing to extend these two convenience functions
to also work ``correctly'' for generalized versions of matrices.


The current implementation :

NROW <- function(x) if(is.array(x)||is.data.frame(x)) nrow(x) else length(x)
NCOL <- function(x) if(is.array(x) && length(dim(x)) > 1L || is.data.frame(x)) ncol(x) else 1L

only treats something as matrix when  is.array(.) is true,
which is not the case, e.g., for multiprecision matrices from
package 'gmp' or for matrices from packages SparseM, Matrix or similar.

Of course, all these packages could write methods for NROW, NCOL
for their specific matrix class, but given that the current
definition is so simple,
I'd find it an unnecessary complication.

Rather I propose the following new version

NROW <- function(x) if(length(dim(x)) || is.data.frame(x)) nrow(x) else length(x)
NCOL <- function(x) if(length(dim(x)) > 1L || is.data.frame(x)) ncol(x) else 1L

I've tested to see that it does not change any of the R 'make
check-all' checks...
but I'd really like to let this pass by as a general RFC..
(in spite of the fact that I'll offline for almost all the rest
 of the weekend).

Martin Maechler


From hadley at rice.edu  Sat Feb  4 18:08:27 2012
From: hadley at rice.edu (Hadley Wickham)
Date: Sat, 4 Feb 2012 11:08:27 -0600
Subject: [Rd] RFC: Proposal to make NROW() and NCOL() slightly more
	general
In-Reply-To: <20269.24348.398088.826473@stat.math.ethz.ch>
References: <20269.24348.398088.826473@stat.math.ethz.ch>
Message-ID: <CABdHhvFiCmaPdeQKB64RjiPwT8TUdFdsFdEqY8rg4YaFp5YkvA@mail.gmail.com>

On Sat, Feb 4, 2012 at 10:38 AM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
> The help has
>
>> Description:
>
>> ? 'nrow' and 'ncol' return the number of rows or columns present in 'x'.
>> ? 'NCOL' and 'NROW' do the same treating a vector as 1-column matrix.
>
> and
>
>> ? x: a vector, array or data frame
>
> I'm proposing to extend these two convenience functions
> to also work ``correctly'' for generalized versions of matrices.
>
>
> The current implementation :
>
> NROW <- function(x) if(is.array(x)||is.data.frame(x)) nrow(x) else length(x)
> NCOL <- function(x) if(is.array(x) && length(dim(x)) > 1L || is.data.frame(x)) ncol(x) else 1L
>
> only treats something as matrix when ?is.array(.) is true,
> which is not the case, e.g., for multiprecision matrices from
> package 'gmp' or for matrices from packages SparseM, Matrix or similar.
>
> Of course, all these packages could write methods for NROW, NCOL
> for their specific matrix class, but given that the current
> definition is so simple,
> I'd find it an unnecessary complication.
>
> Rather I propose the following new version
>
> NROW <- function(x) if(length(dim(x)) || is.data.frame(x)) nrow(x) else length(x)
> NCOL <- function(x) if(length(dim(x)) > 1L || is.data.frame(x)) ncol(x) else 1L

That makes me wonder about:

DIM <- function(x) if (length(dim(x)) > 1L) dim(x) else c(length(x), 1L)

or maybe more efficiently:

DIM <- function(x) {
  d <- dim(x)
  if (length(d) > 1L) dim(x) else c(length(x), 1L)
}

given that dim() is not always trivial to compute (e.g. for data
frames it can be rather slow if you're doing it for hundreds of data
frames)

then NROW and NCOL could be exact equivalents to nrow and ncol.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From ajdamico at gmail.com  Sat Feb  4 22:22:46 2012
From: ajdamico at gmail.com (Anthony Damico)
Date: Sat, 4 Feb 2012 16:22:46 -0500
Subject: [Rd] Reading a Fixed-Width File with SAS import instructions
 directly into an R data frame
Message-ID: <CAOwvMDzBT4SEpEvA7kG2qBuszmsi8zX5f6i95js53HEGkrTsDQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120204/5ebae0c3/attachment.pl>

From manuel.lopez-ibanez at ulb.ac.be  Sun Feb  5 17:33:58 2012
From: manuel.lopez-ibanez at ulb.ac.be (=?ISO-8859-1?Q?Manuel_L=F3pez-Ib=E1=F1ez?=)
Date: Sun, 05 Feb 2012 17:33:58 +0100
Subject: [Rd] [ping] panel.first for bxp
In-Reply-To: <4F26D24E.9030508@ulb.ac.be>
References: <4F26D24E.9030508@ulb.ac.be>
Message-ID: <4F2EAF76.8050800@ulb.ac.be>

Patch: https://stat.ethz.ch/pipermail/r-devel/2012-January/063147.html

On 30/01/12 18:24, Manuel L?pez-Ib??ez wrote:
> I am intrigued why bxp does not support panel.first in order to draw a grid
> behind the boxplots. The advice given here:
>
> https://stat.ethz.ch/pipermail/r-help/2006-April/104608.html
>
> seems utterly bogus, and the result is noticeably different in PDF.
>
> I would propose the following patch, which follows what is done for
> plot.default. If it is ok, I can produce also patches for the documentation.
>
> Please apply to:
>
> https://svn.r-project.org/R/trunk/src/library/graphics/R/boxplot.R
>
> Cheers,
> Manuel.
>
>


From ripley at stats.ox.ac.uk  Mon Feb  6 10:48:46 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 06 Feb 2012 09:48:46 +0000
Subject: [Rd] [ping] panel.first for bxp
In-Reply-To: <4F2EAF76.8050800@ulb.ac.be>
References: <4F26D24E.9030508@ulb.ac.be> <4F2EAF76.8050800@ulb.ac.be>
Message-ID: <4F2FA1FE.9010205@stats.ox.ac.uk>

This is the wrong place: please file enhancement requests on R-bugs.

But I see no case at all for adding this, and all enhancements to base R 
need convincing cases since you are effectively volunteering someone 
else to maintain this in perpetuity.  The lack of response so far 
suggests that no R-core member is willing to be volunteered.

On 05/02/2012 16:33, Manuel L?pez-Ib??ez wrote:
> Patch: https://stat.ethz.ch/pipermail/r-devel/2012-January/063147.html
>
> On 30/01/12 18:24, Manuel L?pez-Ib??ez wrote:
>> I am intrigued why bxp does not support panel.first in order to draw a
>> grid
>> behind the boxplots. The advice given here:

You give no example of what you want to do, nor any argument as to why 
this cannot be done any other way.  For example, why does bxp(add=TRUE) 
not suffice?

>> https://stat.ethz.ch/pipermail/r-help/2006-April/104608.html

Which is not from a recognized authority ....

>> seems utterly bogus, and the result is noticeably different in PDF.
>>
>> I would propose the following patch, which follows what is done for
>> plot.default. If it is ok, I can produce also patches for the
>> documentation.
>>
>> Please apply to:
>>
>> https://svn.r-project.org/R/trunk/src/library/graphics/R/boxplot.R
>>
>> Cheers,
>> Manuel.
>>
>>
>
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From manuel.lopez-ibanez at ulb.ac.be  Mon Feb  6 12:38:31 2012
From: manuel.lopez-ibanez at ulb.ac.be (=?ISO-8859-1?Q?Manuel_L=F3pez-Ib=E1=F1ez?=)
Date: Mon, 06 Feb 2012 12:38:31 +0100
Subject: [Rd] [ping] panel.first for bxp
In-Reply-To: <4F2FA1FE.9010205@stats.ox.ac.uk>
References: <4F26D24E.9030508@ulb.ac.be> <4F2EAF76.8050800@ulb.ac.be>
	<4F2FA1FE.9010205@stats.ox.ac.uk>
Message-ID: <4F2FBBB7.40403@ulb.ac.be>

On 06/02/12 10:48, Prof Brian Ripley wrote:
> This is the wrong place: please file enhancement requests on R-bugs.

Sorry, I wasn't aware of this rule. It makes sense. Done as requested:

https://bugs.r-project.org/bugzilla3/show_bug.cgi?id=14804

Cheers,
	Manuel.

From malsburg at gmail.com  Mon Feb  6 13:46:40 2012
From: malsburg at gmail.com (Titus von der Malsburg)
Date: Mon, 6 Feb 2012 13:46:40 +0100
Subject: [Rd] Resume processing after warning handler.
In-Reply-To: <4F2D50AF.2050801@fhcrc.org>
References: <CAM+LvrB21RWJJ2UcO6xaNbb5X9xUJXju04pwEJCwAt79qjdUtQ@mail.gmail.com>
	<4F2D50AF.2050801@fhcrc.org>
Message-ID: <CAM+LvrCCFXHNe6XHB_2m6xKPc_hXi6NYj+kUehqAGL_VC1mQfQ@mail.gmail.com>

On Sat, Feb 4, 2012 at 4:37 PM, Martin Morgan <mtmorgan at fhcrc.org> wrote:
> On 02/03/2012 02:49 AM, Titus von der Malsburg wrote:
> Hi Titus -- use withCallingHandlers to capture the warning, and
> invokeRestart() to continue after handling it.
>
> withCallingHandlers({
> ? ?warning('oops')
> ? ?message('continuing')
> }, warning=function(w) {
> ? ?message('handling: ', conditionMessage(w))
> ? ?invokeRestart("muffleWarning")
> })


Thanks Martin!  This is exactly what I was looking for.  I saw the
invocation of muffledWarning in a few places when I googled warning
and error handlers but unfortunately I couldn't find explanations and
documentation about it.  When I invoked muffledWarning in a warning
handler for tryCatch, I got a message saying that there's no restart
named like that.  MuffledWarning is not mentioned in the man page of
withCallingHandlers.  Also, figuring out basic stuff like that you can
add warning and error arguments to tryCatch was also not so easy.  Is
there a document somewhere that explains handling of errors and
warnings in detail?

  Titus


From dadler at uni-goettingen.de  Mon Feb  6 14:27:59 2012
From: dadler at uni-goettingen.de (Daniel Adler)
Date: Mon, 6 Feb 2012 14:27:59 +0100
Subject: [Rd] Segfault on ".C" registration via R_CMethodDef according to
	'Writing R Extensions'.
Message-ID: <1FB48665-E0BE-4956-A3BE-9B02038006B7@uni-goettingen.de>

Dear R List,

I encountered a serious problem regarding the registration of ".C" when following the documentation "Writing R Extensions"
that leads to a segmentation fault (tested on windows and mac os x).

The registration mechanism for ".C" routines via R_registerRoutines and
the R_CMethodDef structure has been enhanced recently with the
addition of two fields, one for type specification and the other for
the style (in, out, inout or irrelevant). 

According to the manual 'Writing R Extensions' of version 2.14.1
an example is given that specifies to use the fourth field (type information)
for definitions of C routines that use the ".C" calling convention:

R_CMethodDef cMethods[] = {
        {"myC", (DL_FUNC) &myC, 4, {REALSXP, INTSXP, STRSXP, LGLSXP}}, /* segfault! */
        {NULL, NULL, 0}
};

If I follow this example I get compiler warnings or errors (whether I use C or C++, respectively) and 
a segmentation fault (in the case of C) when doing R CMD INSTALL, which seem to happen during testing.
See build log at the end of this e-mail.

When removing the last field in the initializer list in order to register .C routines in the old way the segfault goes away:

R_CMethodDef cMethods[] = {
        {"myC", (DL_FUNC) &myC, 4}, /* works */
        {NULL, NULL, 0}
};

There are still warnings/segfault or an error when initializing the undocumented fifth entry (parameter passing style), e.g.

R_CMethodDef cMethods[] = {
        {"myC", (DL_FUNC) &myC, 4, {REALSXP, INTSXP, STRSXP, LGLSXP}, {R_ARG_IN, R_ARG_IN, R_ARG_IN, R_ARG_IN},  /* segfault! */
        {NULL, NULL, 0}
};

Using a C source, the warnings are:

*** arch - i386
gcc -arch i386 -std=gnu99 -I/Library/Frameworks/R.framework/Resources/include -I/Library/Frameworks/R.framework/Resources/include/i386  -I/usr/local/include    -fPIC  -g -O2 -Wall -pedantic -c reg.c -o reg.o
reg.c:24: warning: braces around scalar initializer
reg.c:24: warning: (near initialization for ?cMethods[0].types?)
reg.c:24: warning: initialization makes pointer from integer without a cast
reg.c:24: warning: excess elements in scalar initializer
reg.c:24: warning: (near initialization for ?cMethods[0].types?)
reg.c:24: warning: excess elements in scalar initializer
reg.c:24: warning: (near initialization for ?cMethods[0].types?)
reg.c:24: warning: excess elements in scalar initializer
reg.c:24: warning: (near initialization for ?cMethods[0].types?)


Using C++, protecting the init/unload function prototypes and structure declarations via 'extern "C" { }', I get the following error:

*** arch - i386
g++ -arch i386 -I/Library/Frameworks/R.framework/Resources/include -I/Library/Frameworks/R.framework/Resources/include/i386  -I/usr/local/include    -fPIC  -g -O2 -c reg.cpp -o reg.o
reg.cpp:30: error: braces around scalar initializer for type ???R_NativePrimitiveArgType*???

(line 24 is the point on the entry, while line 30 is the end of the overall array initialization list in C++).

If I put the type and style (unsigned int and enum) arrays separately,
the build process works just fine. E.g.

R_NativePrimitiveArgType types[] = {REALSXP, INTSXP, STRSXP, LGLSXP};
R_NativeArgStyle styles[] = { R_ARG_IN, R_ARG_IN, R_ARG_IN, R_ARG_IN };

R_CMethodDef cMethods[] = {
        {"myC", (DL_FUNC) &myC, 4, types, NULL},    /* works */
        {"myC2", (DL_FUNC) &myC, 4, types, style},  /* works */
        {NULL, NULL, 0}
};

(Though I haven't tested the runtime behaviour yet.. but at least no segfault during R CMD INSTALL..)

I wonder what is wrong with the static initializer lists?!

I could imagine it has something to do with the standard compilance of the C/C++
compiler (due to the different behaviour warning or error during compilation).

Anyway, going with the manual right now, the ordinary user will get warnings and 
errors - at least on the systems that I have tested (recent version of Rtools/Windows 7
and Mac OS X 10.6 with gcc 4.2.1). 
On Windows instead of a trace output, a window pops up during install to tell 
about a process crash.

- Daniel

PS: If it helps, I could put up a test package online for further debugging.

--- build log: ----------------------------------------------------------------

** testing if installed package can be loaded
*** arch - i386

 *** caught bus error ***
address 0xe, cause 'non-existent physical address'

Traceback:
 1: dyn.load(file, DLLpath = DLLpath, ...)
 2: library.dynam(lib, package, package.lib)
 3: loadNamespace(package, c(which.lib.loc, lib.loc))
 4: doTryCatch(return(expr), name, parentenv, handler)
 5: tryCatchOne(expr, names, parentenv, handlers[[1L]])
 6: tryCatchList(expr, classes, parentenv, handlers)
 7: tryCatch(expr, error = function(e) {    call <- conditionCall(e)    if (!is.null(call)) {        if (identical(call[[1L]], quote(doTryCatch)))             call <- sys.call(-4L)        dcall <- deparse(call)[1L]        prefix <- paste("Error in", dcall, ": ")        LONG <- 75L        msg <- conditionMessage(e)        sm <- strsplit(msg, "\n")[[1L]]        w <- 14L + nchar(dcall, type = "w") + nchar(sm[1L], type = "w")        if (is.na(w))             w <- 14L + nchar(dcall, type = "b") + nchar(sm[1L],                 type = "b")        if (w > LONG)             prefix <- paste(prefix, "\n  ", sep = "")    }    else prefix <- "Error : "    msg <- paste(prefix, conditionMessage(e), "\n", sep = "")    .Internal(seterrmessage(msg[1L]))    if (!silent && identical(getOption("show.error.messages"),         TRUE)) {        cat(msg, file = stderr())        .Internal(printDeferredWarnings())    }    invisible(structure(msg, class = "try-error", condition = e))})
 8: try({    ns <- loadNamespace(package, c(which.lib.loc, lib.loc))    dataPath <- file.path(which.lib.loc, package, "data")    env <- attachNamespace(ns, pos = pos, dataPath = dataPath,         deps)})
 9: library(pkg_name, lib.loc = lib, character.only = TRUE, logical.return = TRUE)
10: withCallingHandlers(expr, packageStartupMessage = function(c) invokeRestart("muffleMessage"))
11: suppressPackageStartupMessages(library(pkg_name, lib.loc = lib,     character.only = TRUE, logical.return = TRUE))
12: doTryCatch(return(expr), name, parentenv, handler)
13: tryCatchOne(expr, names, parentenv, handlers[[1L]])
14: tryCatchList(expr, classes, parentenv, handlers)
15: tryCatch(expr, error = function(e) {    call <- conditionCall(e)    if (!is.null(call)) {        if (identical(call[[1L]], quote(doTryCatch)))             call <- sys.call(-4L)        dcall <- deparse(call)[1L]        prefix <- paste("Error in", dcall, ": ")        LONG <- 75L        msg <- conditionMessage(e)        sm <- strsplit(msg, "\n")[[1L]]        w <- 14L + nchar(dcall, type = "w") + nchar(sm[1L], type = "w")        if (is.na(w))             w <- 14L + nchar(dcall, type = "b") + nchar(sm[1L],                 type = "b")        if (w > LONG)             prefix <- paste(prefix, "\n  ", sep = "")    }    else prefix <- "Error : "    msg <- paste(prefix, conditionMessage(e), "\n", sep = "")    .Internal(seterrmessage(msg[1L]))    if (!silent && identical(getOption("show.error.messages"),         TRUE)) {        cat(msg, file = stderr())        .Internal(printDeferredWarnings())    }    invisible(structure(msg, class = "try-error", condition = e))})
16: try(suppressPackageStartupMessages(library(pkg_name, lib.loc = lib,     character.only = TRUE, logical.return = TRUE)))
17: tools:::.test_load_package("mylib", "/Users/dadler/Library/R/2.14/library")
aborting ...
sh: line 1: 75200 Bus error               '/Library/Frameworks/R.framework/Resources/bin/R' --arch=i386 --no-save --slave < /var/folders/Lr/Lrh7GWILEqCwHkyF1MdauE+++TI/-Tmp-//RtmpDqusSN/file1259d93ec2eb
*** arch - x86_64


From maechler at stat.math.ethz.ch  Mon Feb  6 15:35:36 2012
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 6 Feb 2012 15:35:36 +0100
Subject: [Rd] RFC: Proposal to make NROW() and NCOL() slightly more
	general
In-Reply-To: <CABdHhvFiCmaPdeQKB64RjiPwT8TUdFdsFdEqY8rg4YaFp5YkvA@mail.gmail.com>
References: <20269.24348.398088.826473@stat.math.ethz.ch>
	<CABdHhvFiCmaPdeQKB64RjiPwT8TUdFdsFdEqY8rg4YaFp5YkvA@mail.gmail.com>
Message-ID: <20271.58680.79353.519909@stat.math.ethz.ch>


> On Sat, Feb 4, 2012 at 10:38 AM, Martin Maechler
> <maechler at stat.math.ethz.ch> wrote:
> > The help has
> >
> >> Description:
> >
> >> ? 'nrow' and 'ncol' return the number of rows or columns present in 'x'.
> >> ? 'NCOL' and 'NROW' do the same treating a vector as 1-column matrix.
> >
> > and
> >
> >> ? x: a vector, array or data frame
> >
> > I'm proposing to extend these two convenience functions
> > to also work ``correctly'' for generalized versions of matrices.
> >
> >
> > The current implementation :
> >
> > NROW <- function(x) if(is.array(x)||is.data.frame(x)) nrow(x) else length(x)
> > NCOL <- function(x) if(is.array(x) && length(dim(x)) > 1L || is.data.frame(x)) ncol(x) else 1L
> >
> > only treats something as matrix when ?is.array(.) is true,
> > which is not the case, e.g., for multiprecision matrices from
> > package 'gmp' or for matrices from packages SparseM, Matrix or similar.
> >
> > Of course, all these packages could write methods for NROW, NCOL
> > for their specific matrix class, but given that the current
> > definition is so simple,
> > I'd find it an unnecessary complication.
> >
> > Rather I propose the following new version
> >
> > NROW <- function(x) if(length(dim(x)) || is.data.frame(x)) nrow(x) else length(x)
> > NCOL <- function(x) if(length(dim(x)) > 1L || is.data.frame(x)) ncol(x) else 1L

> That makes me wonder about:

> DIM <- function(x) if (length(dim(x)) > 1L) dim(x) else c(length(x), 1L)

> or maybe more efficiently:

> DIM <- function(x) {
>   d <- dim(x)
>   if (length(d) > 1L) dim(x) else c(length(x), 1L)
> }

> given that dim() is not always trivial to compute (e.g. for data
> frames it can be rather slow if you're doing it for hundreds of data
> frames)

> then NROW and NCOL could be exact equivalents to nrow and ncol.

> Hadley

Thank you, Hadley.
Indeed, your suggestion seems to make sense
{as far as it makes sense to have such simple functions to
 exist in base at all, but as we already have NROW and NCOL ..}

So, I propose to adopt Hadley's  DIM() proposal, modified to

DIM <- function(x) if(length(d <- dim(x))) d else c(length(x), 1L)

and wait a day or so (or longer for reasons of vacation!) before
committing it, so the public can raise opinions.

Martin


From simon.urbanek at r-project.org  Mon Feb  6 15:47:07 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 6 Feb 2012 09:47:07 -0500
Subject: [Rd] Segfault on ".C" registration via R_CMethodDef according
	to 'Writing R Extensions'.
In-Reply-To: <1FB48665-E0BE-4956-A3BE-9B02038006B7@uni-goettingen.de>
References: <1FB48665-E0BE-4956-A3BE-9B02038006B7@uni-goettingen.de>
Message-ID: <EF93290B-D4D2-476C-8E35-698A5DA28721@r-project.org>

Daniel,

the code you are using is probably not what you intended - since there is no length information the compiler assumes you are filling the structure sequentially and thus the expected value is that for R_NativePrimitiveArgType* which has no length, so it can only be initialized with a scalar value, so you are setting

R_NativePrimitiveArgType* types = REALSXP

which is wrong as you are casing an integer into a pointer. Also that's why you get the warnings which are all valid:

ra.c:9: warning: braces around scalar initializer
-- because it is interpeted as {REALSXP} hence superfluous braces

ra.c:9: warning: initialization makes pointer from integer without a cast
-- because you're initializing  R_NativePrimitiveArgType* with an integer (REALSXP)

ra.c:9: warning: excess elements in scalar initializer
-- because INTSXP, ... must be ignored since "types" can only be initialized with a scalar (pointer)

For what you intended, you're using variable-length array so you have to specify its length:

 {"myC", (DL_FUNC) &myC, 4,  (R_NativePrimitiveArgType[4]) {REALSXP, INTSXP, STRSXP, LGLSXP}}

which will allocate extra static object (it has to because "types" is a pointer, not a fixed array) - so the effect is the same as using a static object.

Cheers,
Simon



On Feb 6, 2012, at 8:27 AM, Daniel Adler wrote:

> Dear R List,
> 
> I encountered a serious problem regarding the registration of ".C" when following the documentation "Writing R Extensions"
> that leads to a segmentation fault (tested on windows and mac os x).
> 
> The registration mechanism for ".C" routines via R_registerRoutines and
> the R_CMethodDef structure has been enhanced recently with the
> addition of two fields, one for type specification and the other for
> the style (in, out, inout or irrelevant). 
> 
> According to the manual 'Writing R Extensions' of version 2.14.1
> an example is given that specifies to use the fourth field (type information)
> for definitions of C routines that use the ".C" calling convention:
> 
> R_CMethodDef cMethods[] = {
>        {"myC", (DL_FUNC) &myC, 4, {REALSXP, INTSXP, STRSXP, LGLSXP}}, /* segfault! */
>        {NULL, NULL, 0}
> };
> 
> If I follow this example I get compiler warnings or errors (whether I use C or C++, respectively) and 
> a segmentation fault (in the case of C) when doing R CMD INSTALL, which seem to happen during testing.
> See build log at the end of this e-mail.
> 
> When removing the last field in the initializer list in order to register .C routines in the old way the segfault goes away:
> 
> R_CMethodDef cMethods[] = {
>        {"myC", (DL_FUNC) &myC, 4}, /* works */
>        {NULL, NULL, 0}
> };
> 
> There are still warnings/segfault or an error when initializing the undocumented fifth entry (parameter passing style), e.g.
> 
> R_CMethodDef cMethods[] = {
>        {"myC", (DL_FUNC) &myC, 4, {REALSXP, INTSXP, STRSXP, LGLSXP}, {R_ARG_IN, R_ARG_IN, R_ARG_IN, R_ARG_IN},  /* segfault! */
>        {NULL, NULL, 0}
> };
> 
> Using a C source, the warnings are:
> 
> *** arch - i386
> gcc -arch i386 -std=gnu99 -I/Library/Frameworks/R.framework/Resources/include -I/Library/Frameworks/R.framework/Resources/include/i386  -I/usr/local/include    -fPIC  -g -O2 -Wall -pedantic -c reg.c -o reg.o
> reg.c:24: warning: braces around scalar initializer
> reg.c:24: warning: (near initialization for ?cMethods[0].types?)
> reg.c:24: warning: initialization makes pointer from integer without a cast
> reg.c:24: warning: excess elements in scalar initializer
> reg.c:24: warning: (near initialization for ?cMethods[0].types?)
> reg.c:24: warning: excess elements in scalar initializer
> reg.c:24: warning: (near initialization for ?cMethods[0].types?)
> reg.c:24: warning: excess elements in scalar initializer
> reg.c:24: warning: (near initialization for ?cMethods[0].types?)
> 
> 
> Using C++, protecting the init/unload function prototypes and structure declarations via 'extern "C" { }', I get the following error:
> 
> *** arch - i386
> g++ -arch i386 -I/Library/Frameworks/R.framework/Resources/include -I/Library/Frameworks/R.framework/Resources/include/i386  -I/usr/local/include    -fPIC  -g -O2 -c reg.cpp -o reg.o
> reg.cpp:30: error: braces around scalar initializer for type ???R_NativePrimitiveArgType*???
> 
> (line 24 is the point on the entry, while line 30 is the end of the overall array initialization list in C++).
> 
> If I put the type and style (unsigned int and enum) arrays separately,
> the build process works just fine. E.g.
> 
> R_NativePrimitiveArgType types[] = {REALSXP, INTSXP, STRSXP, LGLSXP};
> R_NativeArgStyle styles[] = { R_ARG_IN, R_ARG_IN, R_ARG_IN, R_ARG_IN };
> 
> R_CMethodDef cMethods[] = {
>        {"myC", (DL_FUNC) &myC, 4, types, NULL},    /* works */
>        {"myC2", (DL_FUNC) &myC, 4, types, style},  /* works */
>        {NULL, NULL, 0}
> };
> 
> (Though I haven't tested the runtime behaviour yet.. but at least no segfault during R CMD INSTALL..)
> 
> I wonder what is wrong with the static initializer lists?!
> 
> I could imagine it has something to do with the standard compilance of the C/C++
> compiler (due to the different behaviour warning or error during compilation).
> 
> Anyway, going with the manual right now, the ordinary user will get warnings and 
> errors - at least on the systems that I have tested (recent version of Rtools/Windows 7
> and Mac OS X 10.6 with gcc 4.2.1). 
> On Windows instead of a trace output, a window pops up during install to tell 
> about a process crash.
> 
> - Daniel
> 
> PS: If it helps, I could put up a test package online for further debugging.
> 
> --- build log: ----------------------------------------------------------------
> 
> ** testing if installed package can be loaded
> *** arch - i386
> 
> *** caught bus error ***
> address 0xe, cause 'non-existent physical address'
> 
> Traceback:
> 1: dyn.load(file, DLLpath = DLLpath, ...)
> 2: library.dynam(lib, package, package.lib)
> 3: loadNamespace(package, c(which.lib.loc, lib.loc))
> 4: doTryCatch(return(expr), name, parentenv, handler)
> 5: tryCatchOne(expr, names, parentenv, handlers[[1L]])
> 6: tryCatchList(expr, classes, parentenv, handlers)
> 7: tryCatch(expr, error = function(e) {    call <- conditionCall(e)    if (!is.null(call)) {        if (identical(call[[1L]], quote(doTryCatch)))             call <- sys.call(-4L)        dcall <- deparse(call)[1L]        prefix <- paste("Error in", dcall, ": ")        LONG <- 75L        msg <- conditionMessage(e)        sm <- strsplit(msg, "\n")[[1L]]        w <- 14L + nchar(dcall, type = "w") + nchar(sm[1L], type = "w")        if (is.na(w))             w <- 14L + nchar(dcall, type = "b") + nchar(sm[1L],                 type = "b")        if (w > LONG)             prefix <- paste(prefix, "\n  ", sep = "")    }    else prefix <- "Error : "    msg <- paste(prefix, conditionMessage(e), "\n", sep = "")    .Internal(seterrmessage(msg[1L]))    if (!silent && identical(getOption("show.error.messages"),         TRUE)) {        cat(msg, file = stderr())        .Internal(printDeferredWarnings())    }    invisible(structure(msg, class = "try-error", condition = e))})
> 8: try({    ns <- loadNamespace(package, c(which.lib.loc, lib.loc))    dataPath <- file.path(which.lib.loc, package, "data")    env <- attachNamespace(ns, pos = pos, dataPath = dataPath,         deps)})
> 9: library(pkg_name, lib.loc = lib, character.only = TRUE, logical.return = TRUE)
> 10: withCallingHandlers(expr, packageStartupMessage = function(c) invokeRestart("muffleMessage"))
> 11: suppressPackageStartupMessages(library(pkg_name, lib.loc = lib,     character.only = TRUE, logical.return = TRUE))
> 12: doTryCatch(return(expr), name, parentenv, handler)
> 13: tryCatchOne(expr, names, parentenv, handlers[[1L]])
> 14: tryCatchList(expr, classes, parentenv, handlers)
> 15: tryCatch(expr, error = function(e) {    call <- conditionCall(e)    if (!is.null(call)) {        if (identical(call[[1L]], quote(doTryCatch)))             call <- sys.call(-4L)        dcall <- deparse(call)[1L]        prefix <- paste("Error in", dcall, ": ")        LONG <- 75L        msg <- conditionMessage(e)        sm <- strsplit(msg, "\n")[[1L]]        w <- 14L + nchar(dcall, type = "w") + nchar(sm[1L], type = "w")        if (is.na(w))             w <- 14L + nchar(dcall, type = "b") + nchar(sm[1L],                 type = "b")        if (w > LONG)             prefix <- paste(prefix, "\n  ", sep = "")    }    else prefix <- "Error : "    msg <- paste(prefix, conditionMessage(e), "\n", sep = "")    .Internal(seterrmessage(msg[1L]))    if (!silent && identical(getOption("show.error.messages"),         TRUE)) {        cat(msg, file = stderr())        .Internal(printDeferredWarnings())    }    invisible(structure(msg, class = "try-error", condition = e))})
> 16: try(suppressPackageStartupMessages(library(pkg_name, lib.loc = lib,     character.only = TRUE, logical.return = TRUE)))
> 17: tools:::.test_load_package("mylib", "/Users/dadler/Library/R/2.14/library")
> aborting ...
> sh: line 1: 75200 Bus error               '/Library/Frameworks/R.framework/Resources/bin/R' --arch=i386 --no-save --slave < /var/folders/Lr/Lrh7GWILEqCwHkyF1MdauE+++TI/-Tmp-//RtmpDqusSN/file1259d93ec2eb
> *** arch - x86_64
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From dadler at uni-goettingen.de  Mon Feb  6 16:42:21 2012
From: dadler at uni-goettingen.de (Daniel Adler)
Date: Mon, 6 Feb 2012 16:42:21 +0100
Subject: [Rd] Segfault on ".C" registration via R_CMethodDef according
	to 'Writing R Extensions'.
In-Reply-To: <EF93290B-D4D2-476C-8E35-698A5DA28721@r-project.org>
References: <1FB48665-E0BE-4956-A3BE-9B02038006B7@uni-goettingen.de>
	<EF93290B-D4D2-476C-8E35-698A5DA28721@r-project.org>
Message-ID: <F3013779-A90C-42A3-A2BA-6C8E8F127B2F@uni-goettingen.de>

Simon,

Thank you for the prompt and comprehensive explaination.
Using the explicit array casts for types and style in all the variants previously mentioned works fine - no errors, warnings, segfaults.
Great! 
I suggest to add the "(R_NativePrimitiveArgType[4])" expression to the example in the manual.

Regards,
- Daniel


On Feb 6, 2012, at 3:47 PM, Simon Urbanek wrote:

> Daniel,
> 
> the code you are using is probably not what you intended - since there is no length information the compiler assumes you are filling the structure sequentially and thus the expected value is that for R_NativePrimitiveArgType* which has no length, so it can only be initialized with a scalar value, so you are setting
> 
> R_NativePrimitiveArgType* types = REALSXP
> 
> which is wrong as you are casing an integer into a pointer. Also that's why you get the warnings which are all valid:
> 
> ra.c:9: warning: braces around scalar initializer
> -- because it is interpeted as {REALSXP} hence superfluous braces
> 
> ra.c:9: warning: initialization makes pointer from integer without a cast
> -- because you're initializing  R_NativePrimitiveArgType* with an integer (REALSXP)
> 
> ra.c:9: warning: excess elements in scalar initializer
> -- because INTSXP, ... must be ignored since "types" can only be initialized with a scalar (pointer)
> 
> For what you intended, you're using variable-length array so you have to specify its length:
> 
> {"myC", (DL_FUNC) &myC, 4,  (R_NativePrimitiveArgType[4]) {REALSXP, INTSXP, STRSXP, LGLSXP}}
> 
> which will allocate extra static object (it has to because "types" is a pointer, not a fixed array) - so the effect is the same as using a static object.


> 
> Cheers,
> Simon
> 
> 
> 
> On Feb 6, 2012, at 8:27 AM, Daniel Adler wrote:
> 
>> Dear R List,
>> 
>> I encountered a serious problem regarding the registration of ".C" when following the documentation "Writing R Extensions"
>> that leads to a segmentation fault (tested on windows and mac os x).
>> 
>> The registration mechanism for ".C" routines via R_registerRoutines and
>> the R_CMethodDef structure has been enhanced recently with the
>> addition of two fields, one for type specification and the other for
>> the style (in, out, inout or irrelevant). 
>> 
>> According to the manual 'Writing R Extensions' of version 2.14.1
>> an example is given that specifies to use the fourth field (type information)
>> for definitions of C routines that use the ".C" calling convention:
>> 
>> R_CMethodDef cMethods[] = {
>>       {"myC", (DL_FUNC) &myC, 4, {REALSXP, INTSXP, STRSXP, LGLSXP}}, /* segfault! */
>>       {NULL, NULL, 0}
>> };
>> 
>> If I follow this example I get compiler warnings or errors (whether I use C or C++, respectively) and 
>> a segmentation fault (in the case of C) when doing R CMD INSTALL, which seem to happen during testing.
>> See build log at the end of this e-mail.
>> 
>> When removing the last field in the initializer list in order to register .C routines in the old way the segfault goes away:
>> 
>> R_CMethodDef cMethods[] = {
>>       {"myC", (DL_FUNC) &myC, 4}, /* works */
>>       {NULL, NULL, 0}
>> };
>> 
>> There are still warnings/segfault or an error when initializing the undocumented fifth entry (parameter passing style), e.g.
>> 
>> R_CMethodDef cMethods[] = {
>>       {"myC", (DL_FUNC) &myC, 4, {REALSXP, INTSXP, STRSXP, LGLSXP}, {R_ARG_IN, R_ARG_IN, R_ARG_IN, R_ARG_IN},  /* segfault! */
>>       {NULL, NULL, 0}
>> };
>> 
>> Using a C source, the warnings are:
>> 
>> *** arch - i386
>> gcc -arch i386 -std=gnu99 -I/Library/Frameworks/R.framework/Resources/include -I/Library/Frameworks/R.framework/Resources/include/i386  -I/usr/local/include    -fPIC  -g -O2 -Wall -pedantic -c reg.c -o reg.o
>> reg.c:24: warning: braces around scalar initializer
>> reg.c:24: warning: (near initialization for ?cMethods[0].types?)
>> reg.c:24: warning: initialization makes pointer from integer without a cast
>> reg.c:24: warning: excess elements in scalar initializer
>> reg.c:24: warning: (near initialization for ?cMethods[0].types?)
>> reg.c:24: warning: excess elements in scalar initializer
>> reg.c:24: warning: (near initialization for ?cMethods[0].types?)
>> reg.c:24: warning: excess elements in scalar initializer
>> reg.c:24: warning: (near initialization for ?cMethods[0].types?)
>> 
>> 
>> Using C++, protecting the init/unload function prototypes and structure declarations via 'extern "C" { }', I get the following error:
>> 
>> *** arch - i386
>> g++ -arch i386 -I/Library/Frameworks/R.framework/Resources/include -I/Library/Frameworks/R.framework/Resources/include/i386  -I/usr/local/include    -fPIC  -g -O2 -c reg.cpp -o reg.o
>> reg.cpp:30: error: braces around scalar initializer for type ???R_NativePrimitiveArgType*???
>> 
>> (line 24 is the point on the entry, while line 30 is the end of the overall array initialization list in C++).
>> 
>> If I put the type and style (unsigned int and enum) arrays separately,
>> the build process works just fine. E.g.
>> 
>> R_NativePrimitiveArgType types[] = {REALSXP, INTSXP, STRSXP, LGLSXP};
>> R_NativeArgStyle styles[] = { R_ARG_IN, R_ARG_IN, R_ARG_IN, R_ARG_IN };
>> 
>> R_CMethodDef cMethods[] = {
>>       {"myC", (DL_FUNC) &myC, 4, types, NULL},    /* works */
>>       {"myC2", (DL_FUNC) &myC, 4, types, style},  /* works */
>>       {NULL, NULL, 0}
>> };
>> 
>> (Though I haven't tested the runtime behaviour yet.. but at least no segfault during R CMD INSTALL..)
>> 
>> I wonder what is wrong with the static initializer lists?!
>> 
>> I could imagine it has something to do with the standard compilance of the C/C++
>> compiler (due to the different behaviour warning or error during compilation).
>> 
>> Anyway, going with the manual right now, the ordinary user will get warnings and 
>> errors - at least on the systems that I have tested (recent version of Rtools/Windows 7
>> and Mac OS X 10.6 with gcc 4.2.1). 
>> On Windows instead of a trace output, a window pops up during install to tell 
>> about a process crash.
>> 
>> - Daniel
>> 
>> PS: If it helps, I could put up a test package online for further debugging.
>> 
>> --- build log: ----------------------------------------------------------------
>> 
>> ** testing if installed package can be loaded
>> *** arch - i386
>> 
>> *** caught bus error ***
>> address 0xe, cause 'non-existent physical address'
>> 
>> Traceback:
>> 1: dyn.load(file, DLLpath = DLLpath, ...)
>> 2: library.dynam(lib, package, package.lib)
>> 3: loadNamespace(package, c(which.lib.loc, lib.loc))
>> 4: doTryCatch(return(expr), name, parentenv, handler)
>> 5: tryCatchOne(expr, names, parentenv, handlers[[1L]])
>> 6: tryCatchList(expr, classes, parentenv, handlers)
>> 7: tryCatch(expr, error = function(e) {    call <- conditionCall(e)    if (!is.null(call)) {        if (identical(call[[1L]], quote(doTryCatch)))             call <- sys.call(-4L)        dcall <- deparse(call)[1L]        prefix <- paste("Error in", dcall, ": ")        LONG <- 75L        msg <- conditionMessage(e)        sm <- strsplit(msg, "\n")[[1L]]        w <- 14L + nchar(dcall, type = "w") + nchar(sm[1L], type = "w")        if (is.na(w))             w <- 14L + nchar(dcall, type = "b") + nchar(sm[1L],                 type = "b")        if (w > LONG)             prefix <- paste(prefix, "\n  ", sep = "")    }    else prefix <- "Error : "    msg <- paste(prefix, conditionMessage(e), "\n", sep = "")    .Internal(seterrmessage(msg[1L]))    if (!silent && identical(getOption("show.error.messages"),         TRUE)) {        cat(msg, file = stderr())        .Internal(printDeferredWarnings())    }    invisible(structure(msg, class = "try-error", condition = e))})
>> 8: try({    ns <- loadNamespace(package, c(which.lib.loc, lib.loc))    dataPath <- file.path(which.lib.loc, package, "data")    env <- attachNamespace(ns, pos = pos, dataPath = dataPath,         deps)})
>> 9: library(pkg_name, lib.loc = lib, character.only = TRUE, logical.return = TRUE)
>> 10: withCallingHandlers(expr, packageStartupMessage = function(c) invokeRestart("muffleMessage"))
>> 11: suppressPackageStartupMessages(library(pkg_name, lib.loc = lib,     character.only = TRUE, logical.return = TRUE))
>> 12: doTryCatch(return(expr), name, parentenv, handler)
>> 13: tryCatchOne(expr, names, parentenv, handlers[[1L]])
>> 14: tryCatchList(expr, classes, parentenv, handlers)
>> 15: tryCatch(expr, error = function(e) {    call <- conditionCall(e)    if (!is.null(call)) {        if (identical(call[[1L]], quote(doTryCatch)))             call <- sys.call(-4L)        dcall <- deparse(call)[1L]        prefix <- paste("Error in", dcall, ": ")        LONG <- 75L        msg <- conditionMessage(e)        sm <- strsplit(msg, "\n")[[1L]]        w <- 14L + nchar(dcall, type = "w") + nchar(sm[1L], type = "w")        if (is.na(w))             w <- 14L + nchar(dcall, type = "b") + nchar(sm[1L],                 type = "b")        if (w > LONG)             prefix <- paste(prefix, "\n  ", sep = "")    }    else prefix <- "Error : "    msg <- paste(prefix, conditionMessage(e), "\n", sep = "")    .Internal(seterrmessage(msg[1L]))    if (!silent && identical(getOption("show.error.messages"),         TRUE)) {        cat(msg, file = stderr())        .Internal(printDeferredWarnings())    }    invisible(structure(msg, class = "try-error", condition = e))})
>> 16: try(suppressPackageStartupMessages(library(pkg_name, lib.loc = lib,     character.only = TRUE, logical.return = TRUE)))
>> 17: tools:::.test_load_package("mylib", "/Users/dadler/Library/R/2.14/library")
>> aborting ...
>> sh: line 1: 75200 Bus error               '/Library/Frameworks/R.framework/Resources/bin/R' --arch=i386 --no-save --slave < /var/folders/Lr/Lrh7GWILEqCwHkyF1MdauE+++TI/-Tmp-//RtmpDqusSN/file1259d93ec2eb
>> *** arch - x86_64
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> 
> 


From mtmorgan at fhcrc.org  Mon Feb  6 18:02:34 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Mon, 06 Feb 2012 09:02:34 -0800
Subject: [Rd] Resume processing after warning handler.
In-Reply-To: <CAM+LvrCCFXHNe6XHB_2m6xKPc_hXi6NYj+kUehqAGL_VC1mQfQ@mail.gmail.com>
References: <CAM+LvrB21RWJJ2UcO6xaNbb5X9xUJXju04pwEJCwAt79qjdUtQ@mail.gmail.com>
	<4F2D50AF.2050801@fhcrc.org>
	<CAM+LvrCCFXHNe6XHB_2m6xKPc_hXi6NYj+kUehqAGL_VC1mQfQ@mail.gmail.com>
Message-ID: <4F3007AA.8020105@fhcrc.org>

On 02/06/2012 04:46 AM, Titus von der Malsburg wrote:
> On Sat, Feb 4, 2012 at 4:37 PM, Martin Morgan<mtmorgan at fhcrc.org>  wrote:
>> On 02/03/2012 02:49 AM, Titus von der Malsburg wrote:
>> Hi Titus -- use withCallingHandlers to capture the warning, and
>> invokeRestart() to continue after handling it.
>>
>> withCallingHandlers({
>>     warning('oops')
>>     message('continuing')
>> }, warning=function(w) {
>>     message('handling: ', conditionMessage(w))
>>     invokeRestart("muffleWarning")
>> })
>
>
> Thanks Martin!  This is exactly what I was looking for.  I saw the
> invocation of muffledWarning in a few places when I googled warning
> and error handlers but unfortunately I couldn't find explanations and
> documentation about it.  When I invoked muffledWarning in a warning
> handler for tryCatch, I got a message saying that there's no restart
> named like that.  MuffledWarning is not mentioned in the man page of
> withCallingHandlers.  Also, figuring out basic stuff like that you can
> add warning and error arguments to tryCatch was also not so easy.  Is
> there a document somewhere that explains handling of errors and
> warnings in detail?

Hi Titus

I don't have a particular resource for you; others on the list might, 
and google turned up some useful hits. "muffleWarning" is mentioned on 
?warning, but in truth I first spotted it when looking at the source for 
warning.

Martin

>
>    Titus


-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From jeroen.ooms at stat.ucla.edu  Mon Feb  6 21:45:53 2012
From: jeroen.ooms at stat.ucla.edu (Jeroen Ooms)
Date: Mon, 6 Feb 2012 12:45:53 -0800
Subject: [Rd] mem.limits deprecated
Message-ID: <CABFfbXu-YRzG7oUBqZyDm_k1GWBRPXoTdi+dMd1-d-+_80TusQ@mail.gmail.com>

After upgrading my servers to 2.14, log files were filled warnings
that 'mem.limits' has been deprecated and to use gc instead. After
reading the NEWS for R 2.14.0 and PR#14795 I learned that it is
actually deprecated without replacement.

Hereby I just want to voice that this function was actually in use by
at least several users. Among other things, it is a useful to limit
per-session memory on a shared resource. I am not sure what the
assumption that 'these limits are nowadays almost never used' was
based on, but I would disagree.

Obviously this is message is late, the decision has been made and we
were not paying attention when we should have. However if there is
possibly anything that can be done to rescue some of this
functionality that would be greatly appreciated. E.g. by keeping some
of the support in the memory allocator and moving the R code into a
package or so.

Thank you


From edd at debian.org  Mon Feb  6 22:15:40 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 6 Feb 2012 15:15:40 -0600
Subject: [Rd] mem.limits deprecated
In-Reply-To: <CABFfbXu-YRzG7oUBqZyDm_k1GWBRPXoTdi+dMd1-d-+_80TusQ@mail.gmail.com>
References: <CABFfbXu-YRzG7oUBqZyDm_k1GWBRPXoTdi+dMd1-d-+_80TusQ@mail.gmail.com>
Message-ID: <20272.17148.285000.583616@max.nulle.part>


On 6 February 2012 at 12:45, Jeroen Ooms wrote:
| After upgrading my servers to 2.14, log files were filled warnings
| that 'mem.limits' has been deprecated and to use gc instead. After
| reading the NEWS for R 2.14.0 and PR#14795 I learned that it is
| actually deprecated without replacement.
| 
| Hereby I just want to voice that this function was actually in use by
| at least several users. Among other things, it is a useful to limit
| per-session memory on a shared resource. I am not sure what the
| assumption that 'these limits are nowadays almost never used' was
| based on, but I would disagree.

Your operating system is better at these thing. 'man bash' and search for ulimit.

Dirk
 
| Obviously this is message is late, the decision has been made and we
| were not paying attention when we should have. However if there is
| possibly anything that can be done to rescue some of this
| functionality that would be greatly appreciated. E.g. by keeping some
| of the support in the memory allocator and moving the R code into a
| package or so.
| 
| Thank you
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
"Outside of a dog, a book is a man's best friend. Inside of a dog, it is too
dark to read." -- Groucho Marx


From mtmorgan at fhcrc.org  Mon Feb  6 22:57:42 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Mon, 06 Feb 2012 13:57:42 -0800
Subject: [Rd] mem.limits deprecated
In-Reply-To: <CABFfbXu-YRzG7oUBqZyDm_k1GWBRPXoTdi+dMd1-d-+_80TusQ@mail.gmail.com>
References: <CABFfbXu-YRzG7oUBqZyDm_k1GWBRPXoTdi+dMd1-d-+_80TusQ@mail.gmail.com>
Message-ID: <4F304CD6.4080106@fhcrc.org>

On 02/06/2012 12:45 PM, Jeroen Ooms wrote:
> After upgrading my servers to 2.14, log files were filled warnings
> that 'mem.limits' has been deprecated and to use gc instead. After
> reading the NEWS for R 2.14.0 and PR#14795 I learned that it is
> actually deprecated without replacement.
>
> Hereby I just want to voice that this function was actually in use by
> at least several users. Among other things, it is a useful to limit
> per-session memory on a shared resource. I am not sure what the
> assumption that 'these limits are nowadays almost never used' was
> based on, but I would disagree.

These were also sometimes useful in our own use case, where setting 
--min-n/vsize can speed start-up of scripts loading complicated packages 
(e.g., Matrix or Bioconductor IRanges) that trigger dozens of garbage 
collections before arriving at the > prompt, or needing to input large 
data up-front; as a contrived example (70 garbage collections under 
default values):

mtmorgan at linux-ibmc:~> time ~/bin/R-2-13-branch/bin/R --slave --vanilla 
-e "library(IRanges)"

real    0m2.306s
user    0m2.270s
sys     0m0.028s

mtmorgan at linux-ibmc:~> time ~/bin/R-2-13-branch/bin/R 
--min-nsize=2200000 --slave --vanilla -e "library(IRanges)"

real    0m1.931s
user    0m1.854s
sys     0m0.069s

mtmorgan at linux-ibmc:~> ~/bin/R-2-13-branch/bin/R --version
R version 2.13.1 Patched (2011-09-04 r56932)
Copyright (C) 2011 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-unknown-linux-gnu (64-bit)

These were particularly useful in starting up nodes in an (Rmpi) 
cluster, and perhaps more generally suggest that, for some use cases, 
the default memory allocations could be revised (they have not for a 
long time, from current R-devel):

  29749     ripley #define Min_Nsize 220000
  29749     ripley #define Min_Vsize (1*Mega)

Martin

> Obviously this is message is late, the decision has been made and we
> were not paying attention when we should have. However if there is
> possibly anything that can be done to rescue some of this
> functionality that would be greatly appreciated. E.g. by keeping some
> of the support in the memory allocator and moving the R code into a
> package or so.
>
> Thank you
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From maechler at stat.math.ethz.ch  Tue Feb  7 17:32:47 2012
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 7 Feb 2012 17:32:47 +0100
Subject: [Rd] RFC: Proposal to make NROW() and NCOL() slightly more
	general
In-Reply-To: <20271.58680.79353.519909@stat.math.ethz.ch>
References: <20269.24348.398088.826473@stat.math.ethz.ch>
	<CABdHhvFiCmaPdeQKB64RjiPwT8TUdFdsFdEqY8rg4YaFp5YkvA@mail.gmail.com>
	<20271.58680.79353.519909@stat.math.ethz.ch>
Message-ID: <20273.21039.489592.750036@stat.math.ethz.ch>

>>>>> Martin Maechler <maechler at stat.math.ethz.ch>
>>>>>     on Mon, 6 Feb 2012 15:35:36 +0100 writes:

    >> On Sat, Feb 4, 2012 at 10:38 AM, Martin Maechler
    >> <maechler at stat.math.ethz.ch> wrote:
    >> > The help has
    >> >
    >> >> Description:
    >> >
    >> >> ? 'nrow' and 'ncol' return the number of rows or columns present in 'x'.
    >> >> ? 'NCOL' and 'NROW' do the same treating a vector as 1-column matrix.
    >> >
    >> > and
    >> >
    >> >> ? x: a vector, array or data frame
    >> >
    >> > I'm proposing to extend these two convenience functions
    >> > to also work ``correctly'' for generalized versions of matrices.
    >> >
    >> >
    >> > The current implementation :
    >> >
    >> > NROW <- function(x) if(is.array(x)||is.data.frame(x)) nrow(x) else length(x)
    >> > NCOL <- function(x) if(is.array(x) && length(dim(x)) > 1L || is.data.frame(x)) ncol(x) else 1L
    >> >
    >> > only treats something as matrix when ?is.array(.) is true,
    >> > which is not the case, e.g., for multiprecision matrices from
    >> > package 'gmp' or for matrices from packages SparseM, Matrix or similar.
    >> >
    >> > Of course, all these packages could write methods for NROW, NCOL
    >> > for their specific matrix class, but given that the current
    >> > definition is so simple,
    >> > I'd find it an unnecessary complication.
    >> >
    >> > Rather I propose the following new version
    >> >
    >> > NROW <- function(x) if(length(dim(x)) || is.data.frame(x)) nrow(x) else length(x)
    >> > NCOL <- function(x) if(length(dim(x)) > 1L || is.data.frame(x)) ncol(x) else 1L

    >> That makes me wonder about:

    >> DIM <- function(x) if (length(dim(x)) > 1L) dim(x) else c(length(x), 1L)

    >> or maybe more efficiently:

    >> DIM <- function(x) {
    >> d <- dim(x)
    >> if (length(d) > 1L) dim(x) else c(length(x), 1L)
    >> }

    >> given that dim() is not always trivial to compute (e.g. for data
    >> frames it can be rather slow if you're doing it for hundreds of data
    >> frames)

    >> then NROW and NCOL could be exact equivalents to nrow and ncol.

    >> Hadley

    > Thank you, Hadley.
    > Indeed, your suggestion seems to make sense
    > {as far as it makes sense to have such simple functions to
    > exist in base at all, but as we already have NROW and NCOL ..}

    > So, I propose to adopt Hadley's  DIM() proposal, modified to

    > DIM <- function(x) if(length(d <- dim(x))) d else c(length(x), 1L)

    > and wait a day or so (or longer for reasons of vacation!) before
    > committing it, so the public can raise opinions.

Actually, the above --- building NROW() and NCOL() ond DIM() is
not quite correct:
 
  NCOL <- function(x) DIM(x)[2L]

will fail for   x <- array(1:3, 3)

so I think I'll stick for now with the generalizations to NROW()
and NCOL(), using

NROW <- function(x) if(length(d <- dim(x)))      d[1L] else length(x)
NCOL <- function(x) if(length(d <- dim(x)) > 1L) d[2L] else 1L

which incorporates Hadley's note that there are case where
dim(.) is ``relatively expensive''.
Note that the above are also (very slightly) more efficient than
basing them on DIM(.).

Martin


From hadley at rice.edu  Tue Feb  7 19:13:06 2012
From: hadley at rice.edu (Hadley Wickham)
Date: Tue, 7 Feb 2012 12:13:06 -0600
Subject: [Rd] Using custom R_LIBS with R CMD install
Message-ID: <CABdHhvELJ6SDQ0qSfGrxn-Rju1-=8Vr0=1QQ6bvQKxgHQZ_JQw@mail.gmail.com>

Hi all,

Am I using the correct syntax to set a custom R_LIBS when running R
CMD INSTALL from the command line?

I get:

R_LIBS=/Users/hadley/R-dev R CMD INSTALL aL3xa-rapport-08e68ca/
# Desktop : R_LIBS=/Users/hadley/R-dev R CMD INSTALL aL3xa-rapport-08e68ca/
# * installing to library ?/Users/hadley/R?
# ERROR: dependency ?ascii? is not available for package ?rapport?

But:

ls /Users/hadley/R-dev/
# HandyStuff animation  biOps      mcmcTools  mvbutils   quantreg   testthat
# SparseM    ascii      ggplot2    mturkr     nstest     scales     whisker

(I'm actually running this from inside R using system2, but I think
this is the essence of my misunderstanding)

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From proebuck at mdanderson.org  Tue Feb  7 22:34:22 2012
From: proebuck at mdanderson.org (Roebuck,Paul L)
Date: Tue, 7 Feb 2012 15:34:22 -0600
Subject: [Rd] Canonical package directory name for JAR files?
Message-ID: <CB56F4FE.283B6%proebuck@mdanderson.org>

We have an R package which needs to include a JAR file.
Is there a canonical directory for it?


From simon.urbanek at r-project.org  Wed Feb  8 00:37:11 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 7 Feb 2012 18:37:11 -0500
Subject: [Rd] Canonical package directory name for JAR files?
In-Reply-To: <CB56F4FE.283B6%proebuck@mdanderson.org>
References: <CB56F4FE.283B6%proebuck@mdanderson.org>
Message-ID: <C9774AFE-A21F-43EC-B33C-BB6F71F23E14@r-project.org>


On Feb 7, 2012, at 4:34 PM, Roebuck,Paul L wrote:

> We have an R package which needs to include a JAR file.
> Is there a canonical directory for it?
> 

rJava defines "java" for that purpose (see ?.jpackage). How canonical that is may be open for debate ;)


Cheers,
Simon


From hpages at fhcrc.org  Wed Feb  8 01:08:13 2012
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Tue, 07 Feb 2012 16:08:13 -0800
Subject: [Rd] capture.output() is trying to allocate 17179869182.6 Gb on my
 not so big data.frame
Message-ID: <4F31BCED.7040506@fhcrc.org>

Hi,

This is what I get with recent R devel on a 64-bit Ubuntu laptop:

   > mydf <- data.frame(a=1:2080, b=1001:2040, c=letters, d=LETTERS, 
e=1:1040)
   > mydf_in_a_character_vector <- capture.output(mydf)
   Error in print.default(m, ..., quote = quote, right = right) :
     cannot allocate memory block of size 17179869182.6 Gb

I get something similar with R 2.14.1.

Cheers,
H.

 > sessionInfo()
R Under development (unstable) (2012-01-16 r58124)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
  [7] LC_PAPER=C                 LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From mtmorgan at fhcrc.org  Wed Feb  8 04:31:41 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Tue, 07 Feb 2012 19:31:41 -0800
Subject: [Rd] capture.output() is trying to allocate 17179869182.6 Gb on
 my not so big data.frame
In-Reply-To: <4F31BCED.7040506@fhcrc.org>
References: <4F31BCED.7040506@fhcrc.org>
Message-ID: <4F31EC9D.9020004@fhcrc.org>

On 02/07/2012 04:08 PM, Herv? Pag?s wrote:
> Hi,
>
> This is what I get with recent R devel on a 64-bit Ubuntu laptop:
>
>  > mydf <- data.frame(a=1:2080, b=1001:2040, c=letters, d=LETTERS,
> e=1:1040)
>  > mydf_in_a_character_vector <- capture.output(mydf)
> Error in print.default(m, ..., quote = quote, right = right) :
> cannot allocate memory block of size 17179869182.6 Gb

The error is thrown inside src/main/printarray.c:425

		Rprintf("%*s%s", R_print.gap, "",
			EncodeString(x[i + j * r], w[j], quote, right));

where the array w is the result of an unPROTECTed allocation earlier in 
the function, and a garbage collection triggered in MatrixRowLabel (in 
this case; allocation also occurs in MatrixColLabel, Rprintf). 
PROTECTion seems to have been implemented in the file assuming that the 
only allocations are at the head of the function; the return in the 
_PRINT_DEAL_c_eq_0 macro makes it difficult to balance the protection 
stack, and R_alloc seems to be a better solution anyway. diff attached.

Martin Morgan

>
> I get something similar with R 2.14.1.
>
> Cheers,
> H.
>
>  > sessionInfo()
> R Under development (unstable) (2012-01-16 r58124)
> Platform: x86_64-unknown-linux-gnu (64-bit)
>
> locale:
> [1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C
> [3] LC_TIME=en_US.UTF-8 LC_COLLATE=en_US.UTF-8
> [5] LC_MONETARY=en_US.UTF-8 LC_MESSAGES=en_US.UTF-8
> [7] LC_PAPER=C LC_NAME=C
> [9] LC_ADDRESS=C LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats graphics grDevices utils datasets methods base
>


-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793
-------------- next part --------------
A non-text attachment was scrubbed...
Name: printarray.c.diff
Type: text/x-patch
Size: 3445 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120207/aa4d0042/attachment.bin>

From maechler at stat.math.ethz.ch  Wed Feb  8 09:55:18 2012
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 8 Feb 2012 09:55:18 +0100
Subject: [Rd] capture.output() is trying to allocate 17179869182.6 Gb on
 my not so big data.frame
In-Reply-To: <4F31EC9D.9020004@fhcrc.org>
References: <4F31BCED.7040506@fhcrc.org>
	<4F31EC9D.9020004@fhcrc.org>
Message-ID: <20274.14454.843172.560335@stat.math.ethz.ch>

>>>>> Martin Morgan <mtmorgan at fhcrc.org>
>>>>>     on Tue, 7 Feb 2012 19:31:41 -0800 writes:

    > On 02/07/2012 04:08 PM, Herv? Pag?s wrote:
    >> Hi,
    >> 
    >> This is what I get with recent R devel on a 64-bit Ubuntu laptop:
    >> 
    >> > mydf <- data.frame(a=1:2080, b=1001:2040, c=letters, d=LETTERS,
    >> e=1:1040)
    >> > mydf_in_a_character_vector <- capture.output(mydf)
    >> Error in print.default(m, ..., quote = quote, right = right) :
    >> cannot allocate memory block of size 17179869182.6 Gb

    > The error is thrown inside src/main/printarray.c:425

    > Rprintf("%*s%s", R_print.gap, "",
    >         EncodeString(x[i + j * r], w[j], quote, right));

    > where the array w is the result of an unPROTECTed allocation earlier in
    > the function, and a garbage collection triggered in MatrixRowLabel (in
    > this case; allocation also occurs in MatrixColLabel, Rprintf).
    > PROTECTion seems to have been implemented in the file assuming that the
    > only allocations are at the head of the function; the return in the
    > _PRINT_DEAL_c_eq_0 macro makes it difficult to balance the protection
    > stack, and R_alloc seems to be a better solution anyway. 

yes, I think so too.

    > diff attached.

I'm testing that and will commit.. if things seem fine.
Martin Maechler

    > Martin Morgan

    >> 
    >> I get something similar with R 2.14.1.
    >> 
    >> Cheers,
    >> H.
    >> 
    >> > sessionInfo()
    >> R Under development (unstable) (2012-01-16 r58124)
    >> Platform: x86_64-unknown-linux-gnu (64-bit)
    >> 
    >> locale:
    >> [1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C
    >> [3] LC_TIME=en_US.UTF-8 LC_COLLATE=en_US.UTF-8
    >> [5] LC_MONETARY=en_US.UTF-8 LC_MESSAGES=en_US.UTF-8
    >> [7] LC_PAPER=C LC_NAME=C
    >> [9] LC_ADDRESS=C LC_TELEPHONE=C
    >> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
    >> 
    >> attached base packages:
    >> [1] stats graphics grDevices utils datasets methods base
    >> 


    > -- 
    > Computational Biology
    > Fred Hutchinson Cancer Research Center
    > 1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

    > Location: M1-B861 Telephone: 206 667-2793 x external: printarray.c.diff
    > text/x-patch, u [Click mouse-2 to display text]
    > ______________________________________________ R-devel at r-project.org
    > mailing list https://stat.ethz.ch/mailman/listinfo/r-devel


From jorismeys at gmail.com  Wed Feb  8 11:38:24 2012
From: jorismeys at gmail.com (Joris Meys)
Date: Wed, 8 Feb 2012 11:38:24 +0100
Subject: [Rd] Error in data.frame(srcfile = NA_character_ ...) using R CMD
	check
Message-ID: <CAO1zAVbzAxGdvEgr5qL0CZdsEdar=wvMmyfiuVoe2W=4Kanh3g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120208/8623f068/attachment.pl>

From madjakarta at gmail.com  Wed Feb  8 01:02:26 2012
From: madjakarta at gmail.com (=?EUC-KR?B?wPzI8b/4?=)
Date: Wed, 8 Feb 2012 09:02:26 +0900
Subject: [Rd] Options for keeping files when package re-install or update.
Message-ID: <CAKN9kqVQx6o=AB_Uh342f3k_YQVG9mfs3YC4D99ZJ-gu3YiQHw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120208/37497c17/attachment.pl>

From ligges at statistik.tu-dortmund.de  Wed Feb  8 15:11:47 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 08 Feb 2012 15:11:47 +0100
Subject: [Rd] Options for keeping files when package re-install or
	update.
In-Reply-To: <CAKN9kqVQx6o=AB_Uh342f3k_YQVG9mfs3YC4D99ZJ-gu3YiQHw@mail.gmail.com>
References: <CAKN9kqVQx6o=AB_Uh342f3k_YQVG9mfs3YC4D99ZJ-gu3YiQHw@mail.gmail.com>
Message-ID: <4F3282A3.3080107@statistik.tu-dortmund.de>

User defined files are not touched if you update a package *unless* you 
put it into the directory structure of the package, where a user defined 
file is not intended to be ...

Uwe



On 08.02.2012 01:02, ??? wrote:
> Hi! All
> I want to keep some file which user defined when re-installing or updating
> package. Is there any way to do?
>
> Thanks.
>
> --Heewon--
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From kevin.r.coombes at gmail.com  Wed Feb  8 16:40:18 2012
From: kevin.r.coombes at gmail.com (Kevin R. Coombes)
Date: Wed, 08 Feb 2012 09:40:18 -0600
Subject: [Rd] Canonical package directory name for JAR files?
In-Reply-To: <C9774AFE-A21F-43EC-B33C-BB6F71F23E14@r-project.org>
References: <CB56F4FE.283B6%proebuck@mdanderson.org>
	<C9774AFE-A21F-43EC-B33C-BB6F71F23E14@r-project.org>
Message-ID: <4F329762.4080208@gmail.com>

It may not (yet) be canonical, but it is (a) easy to remember and (b) 
likely to be recognized easily by someone looking at the structure.

On 2/7/2012 5:37 PM, Simon Urbanek wrote:
> On Feb 7, 2012, at 4:34 PM, Roebuck,Paul L wrote:
>
>> We have an R package which needs to include a JAR file.
>> Is there a canonical directory for it?
>>
> rJava defines "java" for that purpose (see ?.jpackage). How canonical that is may be open for debate ;)
>
>
> Cheers,
> Simon
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From proebuck at mdanderson.org  Wed Feb  8 17:13:58 2012
From: proebuck at mdanderson.org (Roebuck,Paul L)
Date: Wed, 8 Feb 2012 10:13:58 -0600
Subject: [Rd] Canonical package directory name for JAR files?
In-Reply-To: <C9774AFE-A21F-43EC-B33C-BB6F71F23E14@r-project.org>
Message-ID: <CB57FB66.28481%proebuck@mdanderson.org>

On 2/7/12 5:37 PM, "Simon Urbanek" <simon.urbanek at r-project.org> wrote:

> On Feb 7, 2012, at 4:34 PM, Roebuck,Paul L wrote:
> 
>> We have an R package which needs to include a JAR file.
>> Is there a canonical directory for it?
> 
> rJava defines "java" for that purpose (see ?.jpackage).
> How canonical that is may be open for debate ;)

Yeah, when I wrote Java stuff, that was the Java source code
root directory. Yet, 'lib' (which was the directory where JAR
files lived in Java projects) seems inappropriate for non-Java
projects.

But 'java' appears to be the de-facto standard for R packages,
so...


From ligges at statistik.tu-dortmund.de  Wed Feb  8 19:26:04 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 08 Feb 2012 19:26:04 +0100
Subject: [Rd] Using custom R_LIBS with R CMD install
In-Reply-To: <CABdHhvELJ6SDQ0qSfGrxn-Rju1-=8Vr0=1QQ6bvQKxgHQZ_JQw@mail.gmail.com>
References: <CABdHhvELJ6SDQ0qSfGrxn-Rju1-=8Vr0=1QQ6bvQKxgHQZ_JQw@mail.gmail.com>
Message-ID: <4F32BE3C.8050304@statistik.tu-dortmund.de>



On 07.02.2012 19:13, Hadley Wickham wrote:
> Hi all,
>
> Am I using the correct syntax to set a custom R_LIBS when running R
> CMD INSTALL from the command line?
>
> I get:
>
> R_LIBS=/Users/hadley/R-dev R CMD INSTALL aL3xa-rapport-08e68ca/
> # Desktop : R_LIBS=/Users/hadley/R-dev R CMD INSTALL aL3xa-rapport-08e68ca/
> # * installing to library ?/Users/hadley/R?
> # ERROR: dependency ?ascii? is not available for package ?rapport?


I wonder it works that far. It won't for me on Windows nor Linux, 
because system2 passes the whole thing shQuoted to the shell. Hence it 
is highly shell dependent what happens with the ill formed command.

Whay not specify --library= in R CMD INSTALL if you are calling it 
programatically from R anyway?

Uwe

> But:
>
> ls /Users/hadley/R-dev/
> # HandyStuff animation  biOps      mcmcTools  mvbutils   quantreg   testthat
> # SparseM    ascii      ggplot2    mturkr     nstest     scales     whisker
>
> (I'm actually running this from inside R using system2, but I think
> this is the essence of my misunderstanding)
>
> Hadley
>


From hadley at rice.edu  Wed Feb  8 19:36:16 2012
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 8 Feb 2012 12:36:16 -0600
Subject: [Rd] Using custom R_LIBS with R CMD install
In-Reply-To: <4F32BE3C.8050304@statistik.tu-dortmund.de>
References: <CABdHhvELJ6SDQ0qSfGrxn-Rju1-=8Vr0=1QQ6bvQKxgHQZ_JQw@mail.gmail.com>
	<4F32BE3C.8050304@statistik.tu-dortmund.de>
Message-ID: <CABdHhvFdJsRDz3xehivG2vm+0Z=wVtm4gviNp9yh5RLex24WNg@mail.gmail.com>

> I wonder it works that far. It won't for me on Windows nor Linux, because
> system2 passes the whole thing shQuoted to the shell. Hence it is highly
> shell dependent what happens with the ill formed command.

Well I was using the env argument to system2, which claims to be
cross-platform (at least for R and make).  This command:

R_LIBS=/Users/hadley/R-dev R CMD INSTALL aL3xa-rapport-08e68ca/

is ok, isn't it?

> Whay not specify --library= in R CMD INSTALL if you are calling it
> programatically from R anyway?

My understanding (from reading R CMD INSTALL --help) was that
--library was for specifying the destination library.  Here I want to
specify the full libpath - i.e. some of the packages that this package
depends on may be in library 1, others may be in library 2.  Have I
misunderstood the documentation?

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From edd at debian.org  Wed Feb  8 19:43:51 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 8 Feb 2012 12:43:51 -0600
Subject: [Rd] Using custom R_LIBS with R CMD install
In-Reply-To: <4F32BE3C.8050304@statistik.tu-dortmund.de>
References: <CABdHhvELJ6SDQ0qSfGrxn-Rju1-=8Vr0=1QQ6bvQKxgHQZ_JQw@mail.gmail.com>
	<4F32BE3C.8050304@statistik.tu-dortmund.de>
Message-ID: <20274.49767.550788.274014@max.nulle.part>


On 8 February 2012 at 19:26, Uwe Ligges wrote:
| 
| 
| On 07.02.2012 19:13, Hadley Wickham wrote:
| > Hi all,
| >
| > Am I using the correct syntax to set a custom R_LIBS when running R
| > CMD INSTALL from the command line?
| >
| > I get:
| >
| > R_LIBS=/Users/hadley/R-dev R CMD INSTALL aL3xa-rapport-08e68ca/
| > # Desktop : R_LIBS=/Users/hadley/R-dev R CMD INSTALL aL3xa-rapport-08e68ca/
| > # * installing to library ?/Users/hadley/R?
| > # ERROR: dependency ?ascii? is not available for package ?rapport?
| 
| 
| I wonder it works that far. It won't for me on Windows nor Linux, 
| because system2 passes the whole thing shQuoted to the shell. Hence it 
| is highly shell dependent what happens with the ill formed command.
| 
| Whay not specify --library= in R CMD INSTALL if you are calling it 
| programatically from R anyway?

AFAICT Hadley is concerned about a library _source_ directory (for something
the package under development needs to run / load) rather than a _destination_.

Dirk
 
| Uwe
| 
| > But:
| >
| > ls /Users/hadley/R-dev/
| > # HandyStuff animation  biOps      mcmcTools  mvbutils   quantreg   testthat
| > # SparseM    ascii      ggplot2    mturkr     nstest     scales     whisker
| >
| > (I'm actually running this from inside R using system2, but I think
| > this is the essence of my misunderstanding)
| >
| > Hadley
| >
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
"Outside of a dog, a book is a man's best friend. Inside of a dog, it is too
dark to read." -- Groucho Marx


From ligges at statistik.tu-dortmund.de  Wed Feb  8 20:05:08 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 08 Feb 2012 20:05:08 +0100
Subject: [Rd] Using custom R_LIBS with R CMD install
In-Reply-To: <CABdHhvFdJsRDz3xehivG2vm+0Z=wVtm4gviNp9yh5RLex24WNg@mail.gmail.com>
References: <CABdHhvELJ6SDQ0qSfGrxn-Rju1-=8Vr0=1QQ6bvQKxgHQZ_JQw@mail.gmail.com>
	<4F32BE3C.8050304@statistik.tu-dortmund.de>
	<CABdHhvFdJsRDz3xehivG2vm+0Z=wVtm4gviNp9yh5RLex24WNg@mail.gmail.com>
Message-ID: <4F32C764.1070400@statistik.tu-dortmund.de>



On 08.02.2012 19:36, Hadley Wickham wrote:
>> I wonder it works that far. It won't for me on Windows nor Linux, because
>> system2 passes the whole thing shQuoted to the shell. Hence it is highly
>> shell dependent what happens with the ill formed command.
>
> Well I was using the env argument to system2, which claims to be
> cross-platform (at least for R and make).  This command:
>
> R_LIBS=/Users/hadley/R-dev R CMD INSTALL aL3xa-rapport-08e68ca/
>
> is ok, isn't it?

You haven't said you were using the env argument, have you? If so, I 
missed that part. I assumed you were specifying the above as the 
"command" argument.

Hmmm, former message not quoted, as we ask in the posting guide. Where 
is the reproducible example?

Anyway, this won't work under a Windows shell, I believe. At least, I do 
not know how to set an env variable and run RCMD INSTALL in a Windows 
shell as a one liner - independent of R.


>> Whay not specify --library= in R CMD INSTALL if you are calling it
>> programatically from R anyway?
>
> My understanding (from reading R CMD INSTALL --help) was that
> --library was for specifying the destination library.  Here I want to
> specify the full libpath - i.e. some of the packages that this package
> depends on may be in library 1, others may be in library 2.  Have I
> misunderstood the documentation?

That's right, then you want (under Linux alikes):

system2("R", "CMD INSTALL package_version.tar.gz", env="R_LIBS=lib")

obviously.

Under Windows, you have to construct the shell command:

"set R_LIBS=lib & R CMD INSTALL package_version.tar.gz"

Uwe







>
> Hadley
>


From edd at debian.org  Wed Feb  8 20:21:01 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 8 Feb 2012 13:21:01 -0600
Subject: [Rd] Using custom R_LIBS with R CMD install
In-Reply-To: <4F32C764.1070400@statistik.tu-dortmund.de>
References: <CABdHhvELJ6SDQ0qSfGrxn-Rju1-=8Vr0=1QQ6bvQKxgHQZ_JQw@mail.gmail.com>
	<4F32BE3C.8050304@statistik.tu-dortmund.de>
	<CABdHhvFdJsRDz3xehivG2vm+0Z=wVtm4gviNp9yh5RLex24WNg@mail.gmail.com>
	<4F32C764.1070400@statistik.tu-dortmund.de>
Message-ID: <20274.51997.235294.238761@max.nulle.part>


On 8 February 2012 at 20:05, Uwe Ligges wrote:
| Anyway, this won't work under a Windows shell, I believe. At least, I do 
| not know how to set an env variable and run RCMD INSTALL in a Windows 
| shell as a one liner - independent of R.

FWIW this issue was addressed by Oleg years ago in cfunction() in his inline
package -- by using Sys.setenv() prior to calling system().  This works
in a cross-platform way, avoiding the need for special cases.

Dirk

-- 
"Outside of a dog, a book is a man's best friend. Inside of a dog, it is too
dark to read." -- Groucho Marx


From hadley at rice.edu  Wed Feb  8 21:05:45 2012
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 8 Feb 2012 14:05:45 -0600
Subject: [Rd] Using custom R_LIBS with R CMD install
In-Reply-To: <4F32C764.1070400@statistik.tu-dortmund.de>
References: <CABdHhvELJ6SDQ0qSfGrxn-Rju1-=8Vr0=1QQ6bvQKxgHQZ_JQw@mail.gmail.com>
	<4F32BE3C.8050304@statistik.tu-dortmund.de>
	<CABdHhvFdJsRDz3xehivG2vm+0Z=wVtm4gviNp9yh5RLex24WNg@mail.gmail.com>
	<4F32C764.1070400@statistik.tu-dortmund.de>
Message-ID: <CABdHhvEyt1G9Bab10vUJMfinhq4YuNtA6qoV1M-rdm67huu1kA@mail.gmail.com>

2012/2/8 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>
>
> On 08.02.2012 19:36, Hadley Wickham wrote:
>>>
>>> I wonder it works that far. It won't for me on Windows nor Linux, because
>>> system2 passes the whole thing shQuoted to the shell. Hence it is highly
>>> shell dependent what happens with the ill formed command.
>>
>>
>> Well I was using the env argument to system2, which claims to be
>> cross-platform (at least for R and make). ?This command:
>>
>> R_LIBS=/Users/hadley/R-dev R CMD INSTALL aL3xa-rapport-08e68ca/
>>
>> is ok, isn't it?
>
>
> You haven't said you were using the env argument, have you? If so, I missed
> that part. I assumed you were specifying the above as the "command"
> argument.
>
> Hmmm, former message not quoted, as we ask in the posting guide. Where is
> the reproducible example?

We seem to be having a bit of a communication breakdown.  This is the
code that I run from the command line (on mac os x):

R_LIBS=/Users/hadley/R-dev R CMD INSTALL aL3xa-rapport-08e68ca/
# Desktop : R_LIBS=/Users/hadley/R-dev R CMD INSTALL aL3xa-rapport-08e68ca/
# * installing to library ?/Users/hadley/R?
# ERROR: dependency ?ascii? is not available for package ?rapport?

But:

ls /Users/hadley/R-dev/
# HandyStuff animation  biOps      mcmcTools  mvbutils   quantreg   testthat
# SparseM    ascii      ggplot2    mturkr     nstest     scales     whisker

It's hard to provide a reproducible example because it depends on
exactly what package you have installed where, but I had hoped that
this would at least illustrate my problem - R CMD install doesn't seem
to be respecting R_LIBS.  I'm trying to understand whether this is a
bug, or something I don't understand correctly about R CMD INSTALL.

> That's right, then you want (under Linux alikes):
>
> system2("R", "CMD INSTALL package_version.tar.gz", env="R_LIBS=lib")
>
> obviously.
>
> Under Windows, you have to construct the shell command:
>
> "set R_LIBS=lib & R CMD INSTALL package_version.tar.gz"

To clarify, system2 doesn't work in windows?  The system2
documentation has: " On Windows, ?env? is currently only supported for
commands such as ?R? and ?make? which accept environment variables on
their command line."

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From lorenz at usgs.gov  Wed Feb  8 21:16:32 2012
From: lorenz at usgs.gov (David L Lorenz)
Date: Wed, 8 Feb 2012 14:16:32 -0600
Subject: [Rd] FORTRAN compilation error
Message-ID: <OF060AAA2C.DF464D46-ON8625799E.006EB68C-8625799E.006F60E9@usgs.gov>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120208/a4c2f901/attachment.pl>

From wdunlap at tibco.com  Wed Feb  8 21:27:25 2012
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 8 Feb 2012 20:27:25 +0000
Subject: [Rd] Canonical package directory name for JAR files?
In-Reply-To: <CB57FB66.28481%proebuck@mdanderson.org>
References: <C9774AFE-A21F-43EC-B33C-BB6F71F23E14@r-project.org>
	<CB57FB66.28481%proebuck@mdanderson.org>
Message-ID: <E66794E69CFDE04D9A70842786030B93265A56@PA-MBX03.na.tibco.com>

For what it is worth, the S+ package system uses
the java directory in source packages to store
java source code (under pkg/java/src/, using the usual
directory structure that follows the class structure
under there), prebuilt jar files (in pkg/java/prebuiltjars,
no subdirectories), and a Makevars file (pkg/java/Makevars)
that can define the java compiler flags PKG_JAVAC_CLASSPATH
and PKG_JAVACFLAGS, e.g.,
  PKG_JAVAC_CLASSPATH=$(SHOME)/java/jre/libext/jaxp.jar;$(SHOME)/java/jre/libext/batik.jar
  PKG_JAVACFLAGS=-verbose -g

INSTALL compiles the java code in pkg/java/src and puts
it into into a jar file called pkg/jars/pkg.jar.  All of
the jar files in pkg/java/prebuiltjars are copied into
pkg/jars as well.  The installed package has a jars directory
but no java directory (i.e., {java,jars} <=> {src,libs}).

library(pkg) adds pkg/jars to the CLASSPATH so .Java calls
will find it.


Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com 

> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of Roebuck,Paul L
> Sent: Wednesday, February 08, 2012 8:14 AM
> To: Simon Urbanek
> Cc: R-Devel
> Subject: Re: [Rd] Canonical package directory name for JAR files?
> 
> On 2/7/12 5:37 PM, "Simon Urbanek" <simon.urbanek at r-project.org> wrote:
> 
> > On Feb 7, 2012, at 4:34 PM, Roebuck,Paul L wrote:
> >
> >> We have an R package which needs to include a JAR file.
> >> Is there a canonical directory for it?
> >
> > rJava defines "java" for that purpose (see ?.jpackage).
> > How canonical that is may be open for debate ;)
> 
> Yeah, when I wrote Java stuff, that was the Java source code
> root directory. Yet, 'lib' (which was the directory where JAR
> files lived in Java projects) seems inappropriate for non-Java
> projects.
> 
> But 'java' appears to be the de-facto standard for R packages,
> so...
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hadley at rice.edu  Wed Feb  8 22:36:32 2012
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 8 Feb 2012 15:36:32 -0600
Subject: [Rd] Using custom R_LIBS with R CMD install
In-Reply-To: <CABdHhvEyt1G9Bab10vUJMfinhq4YuNtA6qoV1M-rdm67huu1kA@mail.gmail.com>
References: <CABdHhvELJ6SDQ0qSfGrxn-Rju1-=8Vr0=1QQ6bvQKxgHQZ_JQw@mail.gmail.com>
	<4F32BE3C.8050304@statistik.tu-dortmund.de>
	<CABdHhvFdJsRDz3xehivG2vm+0Z=wVtm4gviNp9yh5RLex24WNg@mail.gmail.com>
	<4F32C764.1070400@statistik.tu-dortmund.de>
	<CABdHhvEyt1G9Bab10vUJMfinhq4YuNtA6qoV1M-rdm67huu1kA@mail.gmail.com>
Message-ID: <CABdHhvE6Kce7JerMDQCL=UTwgfLtK_9AbAOs6sSvEOmmJRKQBQ@mail.gmail.com>

> It's hard to provide a reproducible example because it depends on
> exactly what package you have installed where, but I had hoped that
> this would at least illustrate my problem - R CMD install doesn't seem
> to be respecting R_LIBS. ?I'm trying to understand whether this is a
> bug, or something I don't understand correctly about R CMD INSTALL.

Ok - found the problem.  I had

R_LIBS=~/R

in my .Renviron

which overrides the environment variable.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From simon.urbanek at r-project.org  Wed Feb  8 22:45:57 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 8 Feb 2012 16:45:57 -0500
Subject: [Rd] Canonical package directory name for JAR files?
In-Reply-To: <E66794E69CFDE04D9A70842786030B93265A56@PA-MBX03.na.tibco.com>
References: <C9774AFE-A21F-43EC-B33C-BB6F71F23E14@r-project.org>
	<CB57FB66.28481%proebuck@mdanderson.org>
	<E66794E69CFDE04D9A70842786030B93265A56@PA-MBX03.na.tibco.com>
Message-ID: <9166865A-D720-4971-A7BA-D5952219C88A@r-project.org>

Unfortunately we cannot mandate JDK so packages have to use the build stage for compilation so the S+ model doesn't work. I think java is more consistent than src/java -> jars

Sent from my iPhone

On Feb 8, 2012, at 3:27 PM, William Dunlap <wdunlap at tibco.com> wrote:

> For what it is worth, the S+ package system uses
> the java directory in source packages to store
> java source code (under pkg/java/src/, using the usual
> directory structure that follows the class structure
> under there), prebuilt jar files (in pkg/java/prebuiltjars,
> no subdirectories), and a Makevars file (pkg/java/Makevars)
> that can define the java compiler flags PKG_JAVAC_CLASSPATH
> and PKG_JAVACFLAGS, e.g.,
>  PKG_JAVAC_CLASSPATH=$(SHOME)/java/jre/libext/jaxp.jar;$(SHOME)/java/jre/libext/batik.jar
>  PKG_JAVACFLAGS=-verbose -g
> 
> INSTALL compiles the java code in pkg/java/src and puts
> it into into a jar file called pkg/jars/pkg.jar.  All of
> the jar files in pkg/java/prebuiltjars are copied into
> pkg/jars as well.  The installed package has a jars directory
> but no java directory (i.e., {java,jars} <=> {src,libs}).
> 
> library(pkg) adds pkg/jars to the CLASSPATH so .Java calls
> will find it.
> 
> 
> Bill Dunlap
> Spotfire, TIBCO Software
> wdunlap tibco.com 
> 
>> -----Original Message-----
>> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of Roebuck,Paul L
>> Sent: Wednesday, February 08, 2012 8:14 AM
>> To: Simon Urbanek
>> Cc: R-Devel
>> Subject: Re: [Rd] Canonical package directory name for JAR files?
>> 
>> On 2/7/12 5:37 PM, "Simon Urbanek" <simon.urbanek at r-project.org> wrote:
>> 
>>> On Feb 7, 2012, at 4:34 PM, Roebuck,Paul L wrote:
>>> 
>>>> We have an R package which needs to include a JAR file.
>>>> Is there a canonical directory for it?
>>> 
>>> rJava defines "java" for that purpose (see ?.jpackage).
>>> How canonical that is may be open for debate ;)
>> 
>> Yeah, when I wrote Java stuff, that was the Java source code
>> root directory. Yet, 'lib' (which was the directory where JAR
>> files lived in Java projects) seems inappropriate for non-Java
>> projects.
>> 
>> But 'java' appears to be the de-facto standard for R packages,
>> so...
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From wdunlap at tibco.com  Wed Feb  8 23:12:17 2012
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 8 Feb 2012 22:12:17 +0000
Subject: [Rd] Canonical package directory name for JAR files?
In-Reply-To: <9166865A-D720-4971-A7BA-D5952219C88A@r-project.org>
References: <C9774AFE-A21F-43EC-B33C-BB6F71F23E14@r-project.org>
	<CB57FB66.28481%proebuck@mdanderson.org>
	<E66794E69CFDE04D9A70842786030B93265A56@PA-MBX03.na.tibco.com>
	<9166865A-D720-4971-A7BA-D5952219C88A@r-project.org>
Message-ID: <E66794E69CFDE04D9A70842786030B93265BA4@PA-MBX03.na.tibco.com>

We don't "mandate" a given JDK (including the compiler,
javac), but we do supply the JRE.  We do require that the
java compiler be able to produce code that the JRE accepts
(we test-run javac with a variety of common version-type
flags to try to find one that works with our JRE).

It is source:pkg/java/{src,prebuiltjars,Makevars} -> binary:pkg/jars,
roughly parallel with source:pkg/src -> binary:pkg/libs.

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com 

> -----Original Message-----
> From: Simon Urbanek [mailto:simon.urbanek at r-project.org]
> Sent: Wednesday, February 08, 2012 1:46 PM
> To: William Dunlap
> Cc: Roebuck,Paul L; R-Devel
> Subject: Re: [Rd] Canonical package directory name for JAR files?
> 
> Unfortunately we cannot mandate JDK so packages have to use the build stage for compilation so the S+
> model doesn't work. I think java is more consistent than src/java -> jars
> 
> Sent from my iPhone
> 
> On Feb 8, 2012, at 3:27 PM, William Dunlap <wdunlap at tibco.com> wrote:
> 
> > For what it is worth, the S+ package system uses
> > the java directory in source packages to store
> > java source code (under pkg/java/src/, using the usual
> > directory structure that follows the class structure
> > under there), prebuilt jar files (in pkg/java/prebuiltjars,
> > no subdirectories), and a Makevars file (pkg/java/Makevars)
> > that can define the java compiler flags PKG_JAVAC_CLASSPATH
> > and PKG_JAVACFLAGS, e.g.,
> >  PKG_JAVAC_CLASSPATH=$(SHOME)/java/jre/libext/jaxp.jar;$(SHOME)/java/jre/libext/batik.jar
> >  PKG_JAVACFLAGS=-verbose -g
> >
> > INSTALL compiles the java code in pkg/java/src and puts
> > it into into a jar file called pkg/jars/pkg.jar.  All of
> > the jar files in pkg/java/prebuiltjars are copied into
> > pkg/jars as well.  The installed package has a jars directory
> > but no java directory (i.e., {java,jars} <=> {src,libs}).
> >
> > library(pkg) adds pkg/jars to the CLASSPATH so .Java calls
> > will find it.
> >
> >
> > Bill Dunlap
> > Spotfire, TIBCO Software
> > wdunlap tibco.com
> >
> >> -----Original Message-----
> >> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of
> Roebuck,Paul L
> >> Sent: Wednesday, February 08, 2012 8:14 AM
> >> To: Simon Urbanek
> >> Cc: R-Devel
> >> Subject: Re: [Rd] Canonical package directory name for JAR files?
> >>
> >> On 2/7/12 5:37 PM, "Simon Urbanek" <simon.urbanek at r-project.org> wrote:
> >>
> >>> On Feb 7, 2012, at 4:34 PM, Roebuck,Paul L wrote:
> >>>
> >>>> We have an R package which needs to include a JAR file.
> >>>> Is there a canonical directory for it?
> >>>
> >>> rJava defines "java" for that purpose (see ?.jpackage).
> >>> How canonical that is may be open for debate ;)
> >>
> >> Yeah, when I wrote Java stuff, that was the Java source code
> >> root directory. Yet, 'lib' (which was the directory where JAR
> >> files lived in Java projects) seems inappropriate for non-Java
> >> projects.
> >>
> >> But 'java' appears to be the de-facto standard for R packages,
> >> so...
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >


From proebuck at mdanderson.org  Wed Feb  8 23:31:00 2012
From: proebuck at mdanderson.org (Roebuck,Paul L)
Date: Wed, 8 Feb 2012 16:31:00 -0600
Subject: [Rd] Canonical package directory name for JAR files?
In-Reply-To: <E66794E69CFDE04D9A70842786030B93265BA4@PA-MBX03.na.tibco.com>
Message-ID: <CB5853C4.28536%proebuck@mdanderson.org>

What would be involved in modifying rJava's .jpackage() method
to search in both locations ('java' and/or 'jars') for JAR files
to be added to the CLASSPATH on JVM initialization?


On 2/8/12 4:12 PM, "William Dunlap" <wdunlap at tibco.com> wrote:

> We don't "mandate" a given JDK (including the compiler,
> javac), but we do supply the JRE.  We do require that the
> java compiler be able to produce code that the JRE accepts
> (we test-run javac with a variety of common version-type
> flags to try to find one that works with our JRE).
> 
> It is source:pkg/java/{src,prebuiltjars,Makevars} -> binary:pkg/jars,
> roughly parallel with source:pkg/src -> binary:pkg/libs.
> 
> Bill Dunlap
> Spotfire, TIBCO Software
> wdunlap tibco.com
> 
>> -----Original Message-----
>> From: Simon Urbanek [mailto:simon.urbanek at r-project.org]
>> Sent: Wednesday, February 08, 2012 1:46 PM
>> To: William Dunlap
>> Cc: Roebuck,Paul L; R-Devel
>> Subject: Re: [Rd] Canonical package directory name for JAR files?
>> 
>> Unfortunately we cannot mandate JDK so packages have to use the build
>> stage for compilation so the S+ model doesn't work. I think java is
>> more consistent than src/java -> jars
>> 
>> Sent from my iPhone
>> 
>> On Feb 8, 2012, at 3:27 PM, William Dunlap <wdunlap at tibco.com> wrote:
>> 
>>> For what it is worth, the S+ package system uses
>>> the java directory in source packages to store
>>> java source code (under pkg/java/src/, using the usual
>>> directory structure that follows the class structure
>>> under there), prebuilt jar files (in pkg/java/prebuiltjars,
>>> no subdirectories), and a Makevars file (pkg/java/Makevars)
>>> that can define the java compiler flags PKG_JAVAC_CLASSPATH
>>> and PKG_JAVACFLAGS, e.g.,
>>>  
>>> PKG_JAVAC_CLASSPATH=$(SHOME)/java/jre/libext/jaxp.jar;$(SHOME)/java/jre/libe
>>> xt/batik.jar
>>>  PKG_JAVACFLAGS=-verbose -g
>>> 
>>> INSTALL compiles the java code in pkg/java/src and puts
>>> it into into a jar file called pkg/jars/pkg.jar.  All of
>>> the jar files in pkg/java/prebuiltjars are copied into
>>> pkg/jars as well.  The installed package has a jars directory
>>> but no java directory (i.e., {java,jars} <=> {src,libs}).
>>> 
>>> library(pkg) adds pkg/jars to the CLASSPATH so .Java calls
>>> will find it.
>>> 
>>> 
>>> Bill Dunlap
>>> Spotfire, TIBCO Software
>>> wdunlap tibco.com
>>> 
>>>> -----Original Message-----
>>>> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org]
>>>> On Behalf Of
>> Roebuck,Paul L
>>>> Sent: Wednesday, February 08, 2012 8:14 AM
>>>> To: Simon Urbanek
>>>> Cc: R-Devel
>>>> Subject: Re: [Rd] Canonical package directory name for JAR files?
>>>> 
>>>> On 2/7/12 5:37 PM, "Simon Urbanek" <simon.urbanek at r-project.org> wrote:
>>>> 
>>>>> On Feb 7, 2012, at 4:34 PM, Roebuck,Paul L wrote:
>>>>> 
>>>>>> We have an R package which needs to include a JAR file.
>>>>>> Is there a canonical directory for it?
>>>>> 
>>>>> rJava defines "java" for that purpose (see ?.jpackage).
>>>>> How canonical that is may be open for debate ;)
>>>> 
>>>> Yeah, when I wrote Java stuff, that was the Java source code
>>>> root directory. Yet, 'lib' (which was the directory where JAR
>>>> files lived in Java projects) seems inappropriate for non-Java
>>>> projects.
>>>> 
>>>> But 'java' appears to be the de-facto standard for R packages,
>>>> so...
>>>> 
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>>> 


From hpages at fhcrc.org  Thu Feb  9 01:08:33 2012
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Wed, 08 Feb 2012 16:08:33 -0800
Subject: [Rd] RFC: Proposal to make NROW() and NCOL() slightly more
	general
In-Reply-To: <20273.21039.489592.750036@stat.math.ethz.ch>
References: <20269.24348.398088.826473@stat.math.ethz.ch>
	<CABdHhvFiCmaPdeQKB64RjiPwT8TUdFdsFdEqY8rg4YaFp5YkvA@mail.gmail.com>
	<20271.58680.79353.519909@stat.math.ethz.ch>
	<20273.21039.489592.750036@stat.math.ethz.ch>
Message-ID: <4F330E81.5070708@fhcrc.org>

Hi Martin,

On 02/07/2012 08:32 AM, Martin Maechler wrote:
>>>>>> Martin Maechler<maechler at stat.math.ethz.ch>
>>>>>>      on Mon, 6 Feb 2012 15:35:36 +0100 writes:
>
>      >>  On Sat, Feb 4, 2012 at 10:38 AM, Martin Maechler
>      >>  <maechler at stat.math.ethz.ch>  wrote:
>      >>  >  The help has
>      >>  >
>      >>  >>  Description:
>      >>  >
>      >>  >>     'nrow' and 'ncol' return the number of rows or columns present in 'x'.
>      >>  >>     'NCOL' and 'NROW' do the same treating a vector as 1-column matrix.
>      >>  >
>      >>  >  and
>      >>  >
>      >>  >>     x: a vector, array or data frame
>      >>  >
>      >>  >  I'm proposing to extend these two convenience functions
>      >>  >  to also work ``correctly'' for generalized versions of matrices.
>      >>  >
>      >>  >
>      >>  >  The current implementation :
>      >>  >
>      >>  >  NROW<- function(x) if(is.array(x)||is.data.frame(x)) nrow(x) else length(x)
>      >>  >  NCOL<- function(x) if(is.array(x)&&  length(dim(x))>  1L || is.data.frame(x)) ncol(x) else 1L
>      >>  >
>      >>  >  only treats something as matrix when  is.array(.) is true,
>      >>  >  which is not the case, e.g., for multiprecision matrices from
>      >>  >  package 'gmp' or for matrices from packages SparseM, Matrix or similar.
>      >>  >
>      >>  >  Of course, all these packages could write methods for NROW, NCOL
>      >>  >  for their specific matrix class, but given that the current
>      >>  >  definition is so simple,
>      >>  >  I'd find it an unnecessary complication.
>      >>  >
>      >>  >  Rather I propose the following new version
>      >>  >
>      >>  >  NROW<- function(x) if(length(dim(x)) || is.data.frame(x)) nrow(x) else length(x)
>      >>  >  NCOL<- function(x) if(length(dim(x))>  1L || is.data.frame(x)) ncol(x) else 1L
>
>      >>  That makes me wonder about:
>
>      >>  DIM<- function(x) if (length(dim(x))>  1L) dim(x) else c(length(x), 1L)
>
>      >>  or maybe more efficiently:
>
>      >>  DIM<- function(x) {
>      >>  d<- dim(x)
>      >>  if (length(d)>  1L) dim(x) else c(length(x), 1L)
>      >>  }
>
>      >>  given that dim() is not always trivial to compute (e.g. for data
>      >>  frames it can be rather slow if you're doing it for hundreds of data
>      >>  frames)
>
>      >>  then NROW and NCOL could be exact equivalents to nrow and ncol.
>
>      >>  Hadley
>
>      >  Thank you, Hadley.
>      >  Indeed, your suggestion seems to make sense
>      >  {as far as it makes sense to have such simple functions to
>      >  exist in base at all, but as we already have NROW and NCOL ..}
>
>      >  So, I propose to adopt Hadley's  DIM() proposal, modified to
>
>      >  DIM<- function(x) if(length(d<- dim(x))) d else c(length(x), 1L)
>
>      >  and wait a day or so (or longer for reasons of vacation!) before
>      >  committing it, so the public can raise opinions.
>
> Actually, the above --- building NROW() and NCOL() ond DIM() is
> not quite correct:
>
>    NCOL<- function(x) DIM(x)[2L]
>
> will fail for   x<- array(1:3, 3)

But that's because in your modified version of DIM() you changed
Hadley's original proposed semantic. With the original semantic:

   DIM <- function(x) if(length(d <- dim(x)) >= 2L) d else c(length(x), 1L)

things work as expected on array(1:3, 3):

   > x <- array(1:3, 3)
   > DIM(x)
   [1] 3 1

(Note that using >= 2L instead of > 1L is more readable as it emphasizes
the fact that the returned vector will always have at least 2 elements.)

Cheers,
H.

>
> so I think I'll stick for now with the generalizations to NROW()
> and NCOL(), using
>
> NROW<- function(x) if(length(d<- dim(x)))      d[1L] else length(x)
> NCOL<- function(x) if(length(d<- dim(x))>  1L) d[2L] else 1L
>
> which incorporates Hadley's note that there are case where
> dim(.) is ``relatively expensive''.
> Note that the above are also (very slightly) more efficient than
> basing them on DIM(.).
>
> Martin
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From simon.urbanek at r-project.org  Thu Feb  9 02:08:45 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 8 Feb 2012 20:08:45 -0500
Subject: [Rd] Canonical package directory name for JAR files?
In-Reply-To: <CB5853C4.28536%proebuck@mdanderson.org>
References: <CB5853C4.28536%proebuck@mdanderson.org>
Message-ID: <16BEE518-70A7-4166-94CB-452B97F8DC45@r-project.org>

On Feb 8, 2012, at 5:31 PM, Roebuck,Paul L wrote:

> What would be involved in modifying rJava's .jpackage() method
> to search in both locations ('java' and/or 'jars') for JAR files
> to be added to the CLASSPATH on JVM initialization?
> 

Well, it wouldn't take much but I don't like that idea. The canonical directory as far as rJava is concerned is java. 
As I said, I think S+ behavior is irrelevant for R here since it is a different philosophy (and our package system has nothing to do with S+) - their API is not even compatible to ours so it's not our fault. In addition, I think it is a bad idea to mix up the directories as S+ does.

Cheers,
Simon




> 
> On 2/8/12 4:12 PM, "William Dunlap" <wdunlap at tibco.com> wrote:
> 
>> We don't "mandate" a given JDK (including the compiler,
>> javac), but we do supply the JRE.  We do require that the
>> java compiler be able to produce code that the JRE accepts
>> (we test-run javac with a variety of common version-type
>> flags to try to find one that works with our JRE).
>> 
>> It is source:pkg/java/{src,prebuiltjars,Makevars} -> binary:pkg/jars,
>> roughly parallel with source:pkg/src -> binary:pkg/libs.
>> 
>> Bill Dunlap
>> Spotfire, TIBCO Software
>> wdunlap tibco.com
>> 
>>> -----Original Message-----
>>> From: Simon Urbanek [mailto:simon.urbanek at r-project.org]
>>> Sent: Wednesday, February 08, 2012 1:46 PM
>>> To: William Dunlap
>>> Cc: Roebuck,Paul L; R-Devel
>>> Subject: Re: [Rd] Canonical package directory name for JAR files?
>>> 
>>> Unfortunately we cannot mandate JDK so packages have to use the build
>>> stage for compilation so the S+ model doesn't work. I think java is
>>> more consistent than src/java -> jars
>>> 
>>> Sent from my iPhone
>>> 
>>> On Feb 8, 2012, at 3:27 PM, William Dunlap <wdunlap at tibco.com> wrote:
>>> 
>>>> For what it is worth, the S+ package system uses
>>>> the java directory in source packages to store
>>>> java source code (under pkg/java/src/, using the usual
>>>> directory structure that follows the class structure
>>>> under there), prebuilt jar files (in pkg/java/prebuiltjars,
>>>> no subdirectories), and a Makevars file (pkg/java/Makevars)
>>>> that can define the java compiler flags PKG_JAVAC_CLASSPATH
>>>> and PKG_JAVACFLAGS, e.g.,
>>>> 
>>>> PKG_JAVAC_CLASSPATH=$(SHOME)/java/jre/libext/jaxp.jar;$(SHOME)/java/jre/libe
>>>> xt/batik.jar
>>>> PKG_JAVACFLAGS=-verbose -g
>>>> 
>>>> INSTALL compiles the java code in pkg/java/src and puts
>>>> it into into a jar file called pkg/jars/pkg.jar.  All of
>>>> the jar files in pkg/java/prebuiltjars are copied into
>>>> pkg/jars as well.  The installed package has a jars directory
>>>> but no java directory (i.e., {java,jars} <=> {src,libs}).
>>>> 
>>>> library(pkg) adds pkg/jars to the CLASSPATH so .Java calls
>>>> will find it.
>>>> 
>>>> 
>>>> Bill Dunlap
>>>> Spotfire, TIBCO Software
>>>> wdunlap tibco.com
>>>> 
>>>>> -----Original Message-----
>>>>> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org]
>>>>> On Behalf Of
>>> Roebuck,Paul L
>>>>> Sent: Wednesday, February 08, 2012 8:14 AM
>>>>> To: Simon Urbanek
>>>>> Cc: R-Devel
>>>>> Subject: Re: [Rd] Canonical package directory name for JAR files?
>>>>> 
>>>>> On 2/7/12 5:37 PM, "Simon Urbanek" <simon.urbanek at r-project.org> wrote:
>>>>> 
>>>>>> On Feb 7, 2012, at 4:34 PM, Roebuck,Paul L wrote:
>>>>>> 
>>>>>>> We have an R package which needs to include a JAR file.
>>>>>>> Is there a canonical directory for it?
>>>>>> 
>>>>>> rJava defines "java" for that purpose (see ?.jpackage).
>>>>>> How canonical that is may be open for debate ;)
>>>>> 
>>>>> Yeah, when I wrote Java stuff, that was the Java source code
>>>>> root directory. Yet, 'lib' (which was the directory where JAR
>>>>> files lived in Java projects) seems inappropriate for non-Java
>>>>> projects.
>>>>> 
>>>>> But 'java' appears to be the de-facto standard for R packages,
>>>>> so...
>>>>> 
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>> 
>>>> 
> 
> 


From simon.urbanek at r-project.org  Thu Feb  9 02:13:31 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 8 Feb 2012 20:13:31 -0500
Subject: [Rd] FORTRAN compilation error
In-Reply-To: <OF060AAA2C.DF464D46-ON8625799E.006EB68C-8625799E.006F60E9@usgs.gov>
References: <OF060AAA2C.DF464D46-ON8625799E.006EB68C-8625799E.006F60E9@usgs.gov>
Message-ID: <71DDC9A4-DCF8-49E1-AF6A-A81D2BBE35C3@r-project.org>


On Feb 8, 2012, at 3:16 PM, David L Lorenz wrote:

> I get an error when trying to compile a FORTRAN source file for use in a 
> package that I am developing. The error, reported in 00install.out is 
> below.
> 
> * installing *source* package 'USGSstats' ...
> ** libs
> 
> *** arch - i386
> C:/PROGRA~1/R/R-214~1.1/etc/i386/Makeconf:194: warning: overriding recipe 
> for target `.m.o'
> C:/PROGRA~1/R/R-214~1.1/etc/i386/Makeconf:187: warning: ignoring old 
> recipe for target `.m.o'
> gfortran      -O3  -mtune=core2 -c seakenF.f -o seakenF.o
> "zseakenF.o" was unexpected at this time.
> make: *** [USGSstats.dll] Error 255
> ERROR: compilation failed for package 'USGSstats'
> 
> I am running R 2.14.1 on a Windows 7 pc. The gnu compilers are all 
> installed and work just fine. In fact, the .o file is created and I can 
> manually create the .dll file.
> The error seems to be in the generation of the object name zseakenF.o. I 
> do not see where that might have been generated in the Makeconf file.
> 

The problem is caused by your Makeconf which you didn't share, so there is not much we can help you with ... You should remove the offending Makeconf to start with ...

Cheers,
Simon


From hb at biostat.ucsf.edu  Thu Feb  9 02:31:20 2012
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Wed, 8 Feb 2012 17:31:20 -0800
Subject: [Rd] R devel: R CMD build now sources ~/.Rprofile
Message-ID: <CAFDcVCT4YyEmuNag6vw_zf-s4ZHM_Q1dEHrWMH40QnemwMgbhQ@mail.gmail.com>

I've just noticed that with a recent R devel on Windows, R CMD build
sources ~/.Rprofile, e.g.

> RCMD build
Running ~/.Rprofile

> R CMD build
Running ~/.Rprofile

FYI R --no-init-file & R --vanilla still avoid this.

> sessionInfo()
R Under development (unstable) (2012-02-08 r58297)
Platform: x86_64-pc-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base
>

/Henrik


From hpages at fhcrc.org  Thu Feb  9 02:36:18 2012
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Wed, 08 Feb 2012 17:36:18 -0800
Subject: [Rd] capture.output() is trying to allocate 17179869182.6 Gb on
 my not so big data.frame
In-Reply-To: <20274.14454.843172.560335@stat.math.ethz.ch>
References: <4F31BCED.7040506@fhcrc.org> <4F31EC9D.9020004@fhcrc.org>
	<20274.14454.843172.560335@stat.math.ethz.ch>
Message-ID: <4F332312.6060105@fhcrc.org>

Thanks Martin.  H.

On 02/08/2012 12:55 AM, Martin Maechler wrote:
>>>>>> Martin Morgan<mtmorgan at fhcrc.org>
>>>>>>      on Tue, 7 Feb 2012 19:31:41 -0800 writes:
>
>      >  On 02/07/2012 04:08 PM, Herv? Pag?s wrote:
>      >>  Hi,
>      >>
>      >>  This is what I get with recent R devel on a 64-bit Ubuntu laptop:
>      >>
>      >>  >  mydf<- data.frame(a=1:2080, b=1001:2040, c=letters, d=LETTERS,
>      >>  e=1:1040)
>      >>  >  mydf_in_a_character_vector<- capture.output(mydf)
>      >>  Error in print.default(m, ..., quote = quote, right = right) :
>      >>  cannot allocate memory block of size 17179869182.6 Gb
>
>      >  The error is thrown inside src/main/printarray.c:425
>
>      >  Rprintf("%*s%s", R_print.gap, "",
>      >          EncodeString(x[i + j * r], w[j], quote, right));
>
>      >  where the array w is the result of an unPROTECTed allocation earlier in
>      >  the function, and a garbage collection triggered in MatrixRowLabel (in
>      >  this case; allocation also occurs in MatrixColLabel, Rprintf).
>      >  PROTECTion seems to have been implemented in the file assuming that the
>      >  only allocations are at the head of the function; the return in the
>      >  _PRINT_DEAL_c_eq_0 macro makes it difficult to balance the protection
>      >  stack, and R_alloc seems to be a better solution anyway.
>
> yes, I think so too.
>
>      >  diff attached.
>
> I'm testing that and will commit.. if things seem fine.
> Martin Maechler
>
>      >  Martin Morgan
>
>      >>
>      >>  I get something similar with R 2.14.1.
>      >>
>      >>  Cheers,
>      >>  H.
>      >>
>      >>  >  sessionInfo()
>      >>  R Under development (unstable) (2012-01-16 r58124)
>      >>  Platform: x86_64-unknown-linux-gnu (64-bit)
>      >>
>      >>  locale:
>      >>  [1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C
>      >>  [3] LC_TIME=en_US.UTF-8 LC_COLLATE=en_US.UTF-8
>      >>  [5] LC_MONETARY=en_US.UTF-8 LC_MESSAGES=en_US.UTF-8
>      >>  [7] LC_PAPER=C LC_NAME=C
>      >>  [9] LC_ADDRESS=C LC_TELEPHONE=C
>      >>  [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>      >>
>      >>  attached base packages:
>      >>  [1] stats graphics grDevices utils datasets methods base
>      >>
>
>
>      >  --
>      >  Computational Biology
>      >  Fred Hutchinson Cancer Research Center
>      >  1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109
>
>      >  Location: M1-B861 Telephone: 206 667-2793 x external: printarray.c.diff
>      >  text/x-patch, u [Click mouse-2 to display text]
>      >  ______________________________________________ R-devel at r-project.org
>      >  mailing list https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From hpages at fhcrc.org  Thu Feb  9 02:59:22 2012
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Wed, 08 Feb 2012 17:59:22 -0800
Subject: [Rd] scan() doesn't like '1.#IND'
Message-ID: <4F33287A.3040008@fhcrc.org>

Hi,

Since C++ code compiled with g++ 4.6.3 on Windows (the version included
in latest Rtools) now can produce things like '1.#IND' when writing
doubles to a file (using the << operator), I wonder whether scan()
shouldn't support those things. Right now (with recent R devel and
latest Rtools) we get errors like:

   Error in scan(file, what, nmax, sep, dec, quote, skip, nlines, 
na.strings,  :
     scan() expected 'a real', got '-1.#IND'

that we didn't get with previous versions of R devel and Rtools.
See

 
http://bioconductor.org/checkResults/2.10/bioc-LATEST/BGmix/moscato2-buildsrc.html

for the details. (Note that the file containing the numeric values
is generated during the creation of the vignette.)

We don't see this error on Linux or Mac because on those platforms
the C++ code will produce 'nan' or 'inf', which are supported by
scan().

Thanks,
H.

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From murdoch.duncan at gmail.com  Thu Feb  9 05:07:11 2012
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 08 Feb 2012 23:07:11 -0500
Subject: [Rd] scan() doesn't like '1.#IND'
In-Reply-To: <4F33287A.3040008@fhcrc.org>
References: <4F33287A.3040008@fhcrc.org>
Message-ID: <4F33466F.2080501@gmail.com>

On 12-02-08 8:59 PM, Herv? Pag?s wrote:
> Hi,
>
> Since C++ code compiled with g++ 4.6.3 on Windows (the version included
> in latest Rtools) now can produce things like '1.#IND' when writing
> doubles to a file (using the<<  operator), I wonder whether scan()
> shouldn't support those things. Right now (with recent R devel and
> latest Rtools) we get errors like:
>
>     Error in scan(file, what, nmax, sep, dec, quote, skip, nlines,
> na.strings,  :
>       scan() expected 'a real', got '-1.#IND'
>
> that we didn't get with previous versions of R devel and Rtools.
> See
>
>
> http://bioconductor.org/checkResults/2.10/bioc-LATEST/BGmix/moscato2-buildsrc.html
>
> for the details. (Note that the file containing the numeric values
> is generated during the creation of the vignette.)
>
> We don't see this error on Linux or Mac because on those platforms
> the C++ code will produce 'nan' or 'inf', which are supported by
> scan().

Is that a bug in the C++ run-time, or is there a legitimate reason to 
produce 1.#IND?

If it's a C++ bug it makes more sense to fix it there than in R.

Duncan Murdoch


From dtenenba at fhcrc.org  Thu Feb  9 05:36:15 2012
From: dtenenba at fhcrc.org (Dan Tenenbaum)
Date: Wed, 8 Feb 2012 20:36:15 -0800
Subject: [Rd] scan() doesn't like '1.#IND'
In-Reply-To: <4F33466F.2080501@gmail.com>
References: <4F33287A.3040008@fhcrc.org>
	<4F33466F.2080501@gmail.com>
Message-ID: <CAF42j21tYJRR4PjYDVXN=KfeetRwZTH-cS-fJKV1RZOTg3xUaw@mail.gmail.com>

2012/2/8 Duncan Murdoch <murdoch.duncan at gmail.com>:
> On 12-02-08 8:59 PM, Herv? Pag?s wrote:
>>
>> Hi,
>>
>> Since C++ code compiled with g++ 4.6.3 on Windows (the version included
>> in latest Rtools) now can produce things like '1.#IND' when writing
>> doubles to a file (using the<< ?operator), I wonder whether scan()
>> shouldn't support those things. Right now (with recent R devel and
>> latest Rtools) we get errors like:
>>
>> ? ?Error in scan(file, what, nmax, sep, dec, quote, skip, nlines,
>> na.strings, ?:
>> ? ? ?scan() expected 'a real', got '-1.#IND'
>>
>> that we didn't get with previous versions of R devel and Rtools.
>> See
>>
>>
>>
>> http://bioconductor.org/checkResults/2.10/bioc-LATEST/BGmix/moscato2-buildsrc.html
>>
>> for the details. (Note that the file containing the numeric values
>> is generated during the creation of the vignette.)
>>
>> We don't see this error on Linux or Mac because on those platforms
>> the C++ code will produce 'nan' or 'inf', which are supported by
>> scan().
>
>
> Is that a bug in the C++ run-time, or is there a legitimate reason to
> produce 1.#IND?

I don't think it's a bug; it's just a different way of saying what
earlier versions of g++ said when they generate "inf", namely that the
number is too large to fit in a double. (The MSVC++ compiler has
always used 1.#IND instead of inf, BTW, and now g++ has decided to do
the same).

It does probably represent a floating-point exception in C++ code, but
not a bug in the C++ runtime, so IMO it should be handled by scan() in
the same way as 'inf', since the identical code may produce different
error codes on different platforms.

Note also that there are other variations of the code, such as 11.#INF.
See
http://stackoverflow.com/questions/347920/what-do-1-inf00-1-ind00-and-1-ind-mean
and
http://www.johndcook.com/IEEE_exceptions_in_cpp.html
for more information.

Thanks,
Dan


>
> If it's a C++ bug it makes more sense to fix it there than in R.
>
> Duncan Murdoch
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Thu Feb  9 09:28:23 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 09 Feb 2012 09:28:23 +0100
Subject: [Rd] Using custom R_LIBS with R CMD install
In-Reply-To: <CABdHhvEyt1G9Bab10vUJMfinhq4YuNtA6qoV1M-rdm67huu1kA@mail.gmail.com>
References: <CABdHhvELJ6SDQ0qSfGrxn-Rju1-=8Vr0=1QQ6bvQKxgHQZ_JQw@mail.gmail.com>
	<4F32BE3C.8050304@statistik.tu-dortmund.de>
	<CABdHhvFdJsRDz3xehivG2vm+0Z=wVtm4gviNp9yh5RLex24WNg@mail.gmail.com>
	<4F32C764.1070400@statistik.tu-dortmund.de>
	<CABdHhvEyt1G9Bab10vUJMfinhq4YuNtA6qoV1M-rdm67huu1kA@mail.gmail.com>
Message-ID: <4F3383A7.20504@statistik.tu-dortmund.de>



On 08.02.2012 21:05, Hadley Wickham wrote:
> 2012/2/8 Uwe Ligges<ligges at statistik.tu-dortmund.de>:
>>
>>
>> On 08.02.2012 19:36, Hadley Wickham wrote:
>>>>
>>>> I wonder it works that far. It won't for me on Windows nor Linux, because
>>>> system2 passes the whole thing shQuoted to the shell. Hence it is highly
>>>> shell dependent what happens with the ill formed command.
>>>
>>>
>>> Well I was using the env argument to system2, which claims to be
>>> cross-platform (at least for R and make).  This command:
>>>
>>> R_LIBS=/Users/hadley/R-dev R CMD INSTALL aL3xa-rapport-08e68ca/
>>>
>>> is ok, isn't it?
>>
>>
>> You haven't said you were using the env argument, have you? If so, I missed
>> that part. I assumed you were specifying the above as the "command"
>> argument.
>>
>> Hmmm, former message not quoted, as we ask in the posting guide. Where is
>> the reproducible example?
>
> We seem to be having a bit of a communication breakdown.  This is the
> code that I run from the command line (on mac os x):
>
> R_LIBS=/Users/hadley/R-dev R CMD INSTALL aL3xa-rapport-08e68ca/
> # Desktop : R_LIBS=/Users/hadley/R-dev R CMD INSTALL aL3xa-rapport-08e68ca/
> # * installing to library ?/Users/hadley/R?
> # ERROR: dependency ?ascii? is not available for package ?rapport?
>
> But:
>
> ls /Users/hadley/R-dev/
> # HandyStuff animation  biOps      mcmcTools  mvbutils   quantreg   testthat
> # SparseM    ascii      ggplot2    mturkr     nstest     scales     whisker
>
> It's hard to provide a reproducible example because it depends on
> exactly what package you have installed where, but I had hoped that
> this would at least illustrate my problem - R CMD install doesn't seem
> to be respecting R_LIBS.  I'm trying to understand whether this is a
> bug, or something I don't understand correctly about R CMD INSTALL.
>
>> That's right, then you want (under Linux alikes):
>>
>> system2("R", "CMD INSTALL package_version.tar.gz", env="R_LIBS=lib")
>>
>> obviously.
>>
>> Under Windows, you have to construct the shell command:
>>
>> "set R_LIBS=lib&  R CMD INSTALL package_version.tar.gz"
>
> To clarify, system2 doesn't work in windows?

It does.

 > The system2
> documentation has: " On Windows, ?env? is currently only supported for
> commands such as ?R? and ?make? which accept environment variables on
> their command line."

Yes, but "R CMD INSTALL" does not accept those variables in the command 
line. This could perhaps be improved given someone finds some time to do it.

Uwe


>
> Hadley
>


From hadley at rice.edu  Thu Feb  9 14:32:51 2012
From: hadley at rice.edu (Hadley Wickham)
Date: Thu, 9 Feb 2012 07:32:51 -0600
Subject: [Rd] Using custom R_LIBS with R CMD install
In-Reply-To: <4F3383A7.20504@statistik.tu-dortmund.de>
References: <CABdHhvELJ6SDQ0qSfGrxn-Rju1-=8Vr0=1QQ6bvQKxgHQZ_JQw@mail.gmail.com>
	<4F32BE3C.8050304@statistik.tu-dortmund.de>
	<CABdHhvFdJsRDz3xehivG2vm+0Z=wVtm4gviNp9yh5RLex24WNg@mail.gmail.com>
	<4F32C764.1070400@statistik.tu-dortmund.de>
	<CABdHhvEyt1G9Bab10vUJMfinhq4YuNtA6qoV1M-rdm67huu1kA@mail.gmail.com>
	<4F3383A7.20504@statistik.tu-dortmund.de>
Message-ID: <CABdHhvGRmWY9Qqte=iVDDcxgghUwqLcOu1a=1FcVdkLudxuuQg@mail.gmail.com>

>>
>> To clarify, system2 doesn't work in windows?
>
> It does.
>
>> The system2
>>
>> documentation has: " On Windows, ?env? is currently only supported for
>> commands such as ?R? and ?make? which accept environment variables on
>> their command line."
>
> Yes, but "R CMD INSTALL" does not accept those variables in the command
> line. This could perhaps be improved given someone finds some time to do it.

Ok, so R does, but R CMD INSTALL does not.  That was the source of my
confusion - thanks for clearing that up!

However, is there a reason that system2 doesn't use the more general
technique of Sys.setenv?

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From lorenz at usgs.gov  Thu Feb  9 15:54:12 2012
From: lorenz at usgs.gov (David L Lorenz)
Date: Thu, 9 Feb 2012 08:54:12 -0600
Subject: [Rd] FORTRAN compilation error
In-Reply-To: <71DDC9A4-DCF8-49E1-AF6A-A81D2BBE35C3@r-project.org>
References: <OF060AAA2C.DF464D46-ON8625799E.006EB68C-8625799E.006F60E9@usgs.gov>
	<71DDC9A4-DCF8-49E1-AF6A-A81D2BBE35C3@r-project.org>
Message-ID: <OF3776AFCC.AA479B1F-ON8625799F.00518F22-8625799F.0051DE67@usgs.gov>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120209/0b0d01c5/attachment.pl>

From simon.urbanek at r-project.org  Thu Feb  9 16:24:44 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 9 Feb 2012 10:24:44 -0500
Subject: [Rd] FORTRAN compilation error
In-Reply-To: <OF3776AFCC.AA479B1F-ON8625799F.00518F22-8625799F.0051DE67@usgs.gov>
References: <OF060AAA2C.DF464D46-ON8625799E.006EB68C-8625799E.006F60E9@usgs.gov>
	<71DDC9A4-DCF8-49E1-AF6A-A81D2BBE35C3@r-project.org>
	<OF3776AFCC.AA479B1F-ON8625799F.00518F22-8625799F.0051DE67@usgs.gov>
Message-ID: <CBE24AE4-0E8C-4CDF-88E0-410E37BC71BD@r-project.org>

On Feb 9, 2012, at 9:54 AM, David L Lorenz wrote:

> 
> I should also have explained that I was using the default Makeconf file in R-2.14.1\etc\i386. it is reproduced below. I've tried it on other packages and it inserts a z in front of the object files. 

I'm not talking about R Makeconf, but the one in your package (in src). What are your settings there? And what are the files?

Thanks,
Simon



> Dave 
> 
> #-*- Makefile -*- 
> # $(R_HOME}/etc$(R_ARCH)/Makeconf 
> 
> # Hand-edited version for gnuwin32. 
> 
> ifdef DEBUG 
>   DLLFLAGS= 
>   DEBUGFLAG=-gdwarf-2 
> else 
>   DLLFLAGS=-s 
>   DEBUGFLAG= 
> endif 
> 
> DLLFLAGS+= -static-libgcc 
> LINKFLAGS+= -static-libgcc 
> 
> ## Things which are substituted by fixed/Makefile (and also -O3 -> -O2) 
> WIN = 32 
> BINPREF = 
> # SYMPAT = 's/^.* [BCDRT] _/ /p' for 32-bit 
> # SYMPAT = 's/^.* [BCDRT] / /p' for 64-bit 
> SYMPAT = 's/^.* [BCDRT] _/ /p' 
> IMPDIR = bin/i386 
> # flags for multilib builds, for compilers, dlltool and windres 
> M_ARCH = 
> DT_ARCH = 
> RC_ARCH = 
> # Used by packages tcltk and tkrplot 
> TCL_HOME = $(R_HOME)/Tcl 
> LOCAL_SOFT = d:/RCompile/CRANpkg/extralibs/local 
> 
> ifneq ($(strip $(LOCAL_SOFT)),) 
> LOCAL_CPPFLAGS = -I"$(LOCAL_SOFT)/include" 
> LOCAL_LIBS = -L"$(LOCAL_SOFT)/lib$(R_ARCH)" -L"$(LOCAL_SOFT)/lib" 
> endif 
> 
> DLLTOOL = $(BINPREF)dlltool --as $(BINPREF)as $(DT_ARCH) 
> DLLTOOLFLAGS = -k 
> NM = $(BINPREF)nm 
> RESCOMP = $(BINPREF)windres $(RC_ARCH) 
> ## MAIN_LD needs to be set by the package 
> LINKER = $(MAIN_LD) 
> ## as a default 
> DLL = $(CC) 
> 
> ## Things defined in Renviron on Unix 
> SED = sed 
> TAR = tar 
> 
> ## Things defined in MkRules 
> CAT = cat 
> CP = cp 
> MKDIR = mkdir 
> RM = rm -f 
> SORT = sort 
> 
> ## For use in packages 
> GRAPHAPP_LIB = -lRgraphapp 
> TCL_VERSION = 85 
> ZLIB_LIBS = -lRzlib 
> 
> AR = $(BINPREF)ar 
> ## Used by packages 'maps' and 'mapdata' 
> AWK = gawk 
> BLAS_LIBS = -L"$(R_HOME)/$(IMPDIR)" -lRblas 
> C_VISIBILITY = 
> CC = $(BINPREF)gcc $(M_ARCH) 
> CFLAGS = -O3 -Wall $(DEBUGFLAG) -std=gnu99 -mtune=core2 
> CPICFLAGS = 
> CPPFLAGS = 
> CXX = $(BINPREF)g++ $(M_ARCH) 
> CXXCPP = $(CXX) -E 
> CXXFLAGS = -O2 -Wall $(DEBUGFLAG) -mtune=core2 
> CXXPICFLAGS = 
> DYLIB_EXT = .dll 
> DYLIB_LD = $(DLL) 
> DYLIB_LDFLAGS = -shared 
> DYLIB_LINK = $(DYLIB_LD) $(DYLIB_LDFLAGS) $(LDFLAGS) 
> ECHO = echo 
> ECHO_C = 
> ECHO_N = -n 
> ECHO_T = 
> FC = $(BINPREF)gfortran $(M_ARCH) 
> FCFLAGS = -O3 $(DEBUGFLAG) -mtune=core2 
> # additional libs needed when linking with $(FC), e.g. on Solaris 
> FCLIBS = 
> F77 = $(BINPREF)gfortran $(M_ARCH) 
> F77_VISIBILITY = 
> FFLAGS = -O3 $(DEBUGFLAG) -mtune=core2 
> FLIBS = -lgfortran 
> FCPICFLAGS = 
> FPICFLAGS = 
> FOUNDATION_CPPFLAGS = 
> FOUNDATION_LIBS = 
> JAR = 
> JAVA = 
> JAVAC = 
> JAVAH = 
> # JAVA_HOME = 
> # JAVA_LD_LIBRARY_PATH = 
> JAVA_LIBS = -L"$(JAVA_HOME)/bin/client" -ljvm -ljvm-w32 
> JAVA_CPPFLAGS = -I"$(JAVA_HOME)/../include" -I"$(JAVA_HOME)/../include/win32" 
> LAPACK_LIBS = -L"$(R_HOME)/$(IMPDIR)" -lRlapack 
> ## we only need this is if it is external, as otherwise link to R 
> LIBINTL= 
> LIBM = -lm 
> LIBR = -L"$(R_HOME)/$(IMPDIR)" -lR 
> LIBS =  -lm 
> ## needed by R CMD config 
> LIBnn = lib 
> LIBTOOL = 
> LDFLAGS = 
> ## needed to build applications linking to static libR 
> # MAIN_LD = 
> # MAIN_LDFLAGS = 
> # MAIN_LINK = $(MAIN_LD) $(MAIN_LDFLAGS) $(LDFLAGS) 
> # don't have this: would 'mkdir -p' do? 
> # MKINSTALLDIRS = $(R_HOME)/bin/mkinstalldirs 
> OBJC = $(CC) 
> OBJCFLAGS = -O2 
> OBJC_LIBS = -lobjc 
> OBJCXX = 
> R_ARCH = /i386 
> RANLIB = $(BINPREF)ranlib 
> SAFE_FFLAGS = -O3 -ffloat-store 
> SED = sed 
> ## it seems some makes (but not ours) get upset if SHELL is set. 
> # SHELL = /bin/sh 
> SHLIB_CFLAGS = 
> SHLIB_CXXFLAGS = 
> SHLIB_CXXLD = $(CXX) 
> ## ideally -shared -static-libstdc++, but not for gcc 4.2.1 
> SHLIB_CXXLDFLAGS = -shared 
> SHLIB_EXT = .dll 
> SHLIB_FCLD = $(FC) 
> ## ideally -shared -static-libgfortran, but not for gcc 4.2.1 
> SHLIB_FCLDFLAGS = -shared 
> SHLIB_FFLAGS = 
> SHLIB_LD = $(CC) 
> SHLIB_LDFLAGS = -shared 
> SHLIB_LIBADD = 
> SHLIB_LINK = $(SHLIB_LD) -Wl,--export-all-symbols $(SHLIB_LDFLAGS) $(LDFLAGS) 
> # not implemented in current toolchain 
> SHLIB_OPENMP_CFLAGS = 
> SHLIB_OPENMP_CXXFLAGS = 
> SHLIB_OPENMP_FCFLAGS = 
> SHLIB_OPENMP_FFLAGS = 
> STRIP_LIBS = $(BINPREF)strip --strip-unneeded 
> STRIP_STATIC_LIBS = $(BINPREF)strip --strip-debug 
> TCLTK_CPPFLAGS = -I "$(TCL_HOME)/include" -DWin32 
> TCLTK_LIBS = -L"$(TCL_HOME)/bin" -ltcl$(TCL_VERSION) -ltk$(TCL_VERSION) 
> 
> STATIC_LIBR = 
> 
> R_XTRA_CFLAGS = 
> R_XTRA_CPPFLAGS = -I"$(R_HOME)/include" 
> R_XTRA_CXXFLAGS = 
> R_XTRA_FFLAGS = 
> 
> ALL_CFLAGS = $(R_XTRA_CFLAGS) $(PKG_CFLAGS) $(CPICFLAGS) $(SHLIB_CFLAGS) $(CFLAGS) 
> ALL_CPPFLAGS = $(R_XTRA_CPPFLAGS) $(PKG_CPPFLAGS) $(CPPFLAGS) $($*-CPPFLAGS) $(CLINK_CPPFLAGS) $(LOCAL_CPPFLAGS) 
> ALL_CXXFLAGS = $(R_XTRA_CXXFLAGS) $(PKG_CXXFLAGS) $(CXXPICFLAGS) $(SHLIB_CXXFLAGS) $(CXXFLAGS) 
> ALL_OBJCFLAGS = $(PKG_OBJCFLAGS) $(CPICFLAGS) $(SHLIB_CFLAGS) $(OBJCFLAGS) 
> ALL_OBJCXXFLAGS = $(PKG_OBJCXXFLAGS) $(CXXPICFLAGS) $(SHLIB_CXXFLAGS) $(OBJCXXFLAGS) 
> ALL_FFLAGS = $(R_XTRA_FFLAGS) $(PKG_FFLAGS) $(FPICFLAGS) $(SHLIB_FFLAGS) $(FFLAGS) 
> ALL_LIBS = $(LOCAL_LIBS) $(PKG_LIBS) $(SHLIB_LIBADD) $(LIBR) $(LIBINTL) 
> 
> .SUFFIXES: 
> .SUFFIXES: .c .cc .cpp .d .f .f90 .f95 .m .mm .M .o .a .def .dll .exe .rc 
> 
> .c.o: 
>         $(CC) $(ALL_CPPFLAGS) $(ALL_CFLAGS) -c $< -o $@ 
> .c.d: 
>         @echo "making $@ from $<" 
>         @$(CC) -std=gnu99 -MM $(ALL_CPPFLAGS) $< > $@ 
> .cc.o: 
>         $(CXX) $(ALL_CPPFLAGS) $(ALL_CXXFLAGS) -c $< -o $@ 
> .cpp.o: 
>         $(CXX) $(ALL_CPPFLAGS) $(ALL_CXXFLAGS) -c $< -o $@ 
> .cc.d: 
>         @echo "making $@ from $<" 
>         @$(CXX) -M $(ALL_CPPFLAGS) $< > $@ 
> .cpp.d: 
>         @echo "making $@ from $<" 
>         @$(CXX) -M $(ALL_CPPFLAGS) $< > $@ 
> .m.o: 
>         $(OBJC) $(ALL_CPPFLAGS) $(ALL_OBJCFLAGS) -c $< -o $@ 
> .m.d: 
>         @echo "making $@ from $<" 
>         @$(OBJC) -MM $(ALL_CPPFLAGS) $< > $@ 
> .mm.o: 
>         $(OBJCXX) $(ALL_CPPFLAGS) $(ALL_OBJCXXFLAGS) -c $< -o $@ 
> .M.o: 
>         $(OBJCXX) $(ALL_CPPFLAGS) $(ALL_OBJCXXFLAGS) -c $< -o $@ 
> .f.o: 
>         $(F77) $(ALL_FFLAGS) -c $< -o $@ 
> .f95.o: 
>         $(FC) $(PKG_FCFLAGS) $(FCPICFLAGS) $(FCFLAGS) -c  $< -o $@ 
> .f90.o: 
>         $(FC) $(PKG_FCFLAGS) $(FCPICFLAGS) $(FCFLAGS) -c  $< -o $@ 
> 
> %.exe: 
>         $(LINKER) $(LINKFLAGS) $($*-LINKFLAGS) -o $@ $^ $($*-LIBS) $(LOCAL_LIBS) $(LIBS) 
> 
> %.dll: 
>         @echo EXPORTS > $*.def 
>         @$(NM) $^ | $(SED) -n $(SYMPAT) >> $*.def 
>         $(SHLIB_LD) -shared $(DLLFLAGS) -o $@ $*.def $^ $(ALL_LIBS) 
>         @$(RM) $*.def 
> 
> lib%.dll.a: %.def 
>         $(DLLTOOL) $(DLLTOOLFLAGS) $($*-DLLTOOLFLAGS) --dllname $*.dll --input-def $*.def --output-lib $@ 
> 
> %.a: 
>         @$(RM) $@ 
>         $(AR) crs $@ $^ 
> 
> %.o: %.rc 
>         $(RESCOMP) $(RESFLAGS) -i $< -o $@ 
> 
> 
> 
> From:	Simon Urbanek <simon.urbanek at r-project.org>
> To:	David L Lorenz <lorenz at usgs.gov>
> Cc:	r-devel at r-project.org
> Date:	02/08/2012 07:13 PM
> Subject:	Re: [Rd] FORTRAN compilation error
> 
> 
> 
> 
> 
> On Feb 8, 2012, at 3:16 PM, David L Lorenz wrote:
> 
> > I get an error when trying to compile a FORTRAN source file for use in a 
> > package that I am developing. The error, reported in 00install.out is 
> > below.
> > 
> > * installing *source* package 'USGSstats' ...
> > ** libs
> > 
> > *** arch - i386
> > C:/PROGRA~1/R/R-214~1.1/etc/i386/Makeconf:194: warning: overriding recipe 
> > for target `.m.o'
> > C:/PROGRA~1/R/R-214~1.1/etc/i386/Makeconf:187: warning: ignoring old 
> > recipe for target `.m.o'
> > gfortran      -O3  -mtune=core2 -c seakenF.f -o seakenF.o
> > "zseakenF.o" was unexpected at this time.
> > make: *** [USGSstats.dll] Error 255
> > ERROR: compilation failed for package 'USGSstats'
> > 
> > I am running R 2.14.1 on a Windows 7 pc. The gnu compilers are all 
> > installed and work just fine. In fact, the .o file is created and I can 
> > manually create the .dll file.
> > The error seems to be in the generation of the object name zseakenF.o. I 
> > do not see where that might have been generated in the Makeconf file.
> > 
> 
> The problem is caused by your Makeconf which you didn't share, so there is not much we can help you with ... You should remove the offending Makeconf to start with ...
> 
> Cheers,
> Simon
> 
> 
> 
> 


From lorenz at usgs.gov  Thu Feb  9 16:48:13 2012
From: lorenz at usgs.gov (David L Lorenz)
Date: Thu, 9 Feb 2012 09:48:13 -0600
Subject: [Rd] FORTRAN compilation error
In-Reply-To: <CBE24AE4-0E8C-4CDF-88E0-410E37BC71BD@r-project.org>
References: <OF060AAA2C.DF464D46-ON8625799E.006EB68C-8625799E.006F60E9@usgs.gov>
	<71DDC9A4-DCF8-49E1-AF6A-A81D2BBE35C3@r-project.org>
	<OF3776AFCC.AA479B1F-ON8625799F.00518F22-8625799F.0051DE67@usgs.gov>
	<CBE24AE4-0E8C-4CDF-88E0-410E37BC71BD@r-project.org>
Message-ID: <OF653320A6.D2385C90-ON8625799F.0055ACB1-8625799F.0056D062@usgs.gov>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120209/dc14c434/attachment.pl>

From simon.urbanek at r-project.org  Thu Feb  9 16:55:37 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 9 Feb 2012 10:55:37 -0500
Subject: [Rd] FORTRAN compilation error
In-Reply-To: <OF653320A6.D2385C90-ON8625799F.0055ACB1-8625799F.0056D062@usgs.gov>
References: <OF060AAA2C.DF464D46-ON8625799E.006EB68C-8625799E.006F60E9@usgs.gov>
	<71DDC9A4-DCF8-49E1-AF6A-A81D2BBE35C3@r-project.org>
	<OF3776AFCC.AA479B1F-ON8625799F.00518F22-8625799F.0051DE67@usgs.gov>
	<CBE24AE4-0E8C-4CDF-88E0-410E37BC71BD@r-project.org>
	<OF653320A6.D2385C90-ON8625799F.0055ACB1-8625799F.0056D062@usgs.gov>
Message-ID: <D028A7A7-81C4-4621-BC1E-D76C2519CB5E@r-project.org>

David,

On Feb 9, 2012, at 10:48 AM, David L Lorenz wrote:

> 
> Simon, 
>   It was not clear that I needed any makefiles in src. I have seen no documentation anywhere that I needed a makefile in src. 

You don't - I thought you are using one to modify the object list. Simple output of ls -l in your src would have been very helpful with your first e-mail ;).


>   The FORTRAN source compiles just fine by hand, so the error is not in the code. It is just one single source code file with one subroutine. 
>   The problem appears to be the z that is inserted in from the the object file name when the .dll is created. 

Actually, I think I now see the problem - you have incompatible "make" on your PATH that does not come form the R tools (easy way to tell is that our make is case-sensitive while yours is not - hence the warning). Please make sure you have Rtools on your PATH *before* any other tools.

Cheers,
Simon


> 
> 
> From:	Simon Urbanek <simon.urbanek at r-project.org>
> To:	David L Lorenz <lorenz at usgs.gov>
> Cc:	r-devel at r-project.org
> Date:	02/09/2012 09:24 AM
> Subject:	Re: [Rd] FORTRAN compilation error
> 
> 
> 
> 
> On Feb 9, 2012, at 9:54 AM, David L Lorenz wrote:
> 
> > 
> > I should also have explained that I was using the default Makeconf file in R-2.14.1\etc\i386. it is reproduced below. I've tried it on other packages and it inserts a z in front of the object files. 
> 
> I'm not talking about R Makeconf, but the one in your package (in src). What are your settings there? And what are the files?
> 
> Thanks,
> Simon
> 
> 
> 
> > Dave 
> > 
> > #-*- Makefile -*- 
> > # $(R_HOME}/etc$(R_ARCH)/Makeconf 
> > 
> > # Hand-edited version for gnuwin32. 
> > 
> > ifdef DEBUG 
> >   DLLFLAGS= 
> >   DEBUGFLAG=-gdwarf-2 
> > else 
> >   DLLFLAGS=-s 
> >   DEBUGFLAG= 
> > endif 
> > 
> > DLLFLAGS+= -static-libgcc 
> > LINKFLAGS+= -static-libgcc 
> > 
> > ## Things which are substituted by fixed/Makefile (and also -O3 -> -O2) 
> > WIN = 32 
> > BINPREF = 
> > # SYMPAT = 's/^.* [BCDRT] _/ /p' for 32-bit 
> > # SYMPAT = 's/^.* [BCDRT] / /p' for 64-bit 
> > SYMPAT = 's/^.* [BCDRT] _/ /p' 
> > IMPDIR = bin/i386 
> > # flags for multilib builds, for compilers, dlltool and windres 
> > M_ARCH = 
> > DT_ARCH = 
> > RC_ARCH = 
> > # Used by packages tcltk and tkrplot 
> > TCL_HOME = $(R_HOME)/Tcl 
> > LOCAL_SOFT = d:/RCompile/CRANpkg/extralibs/local 
> > 
> > ifneq ($(strip $(LOCAL_SOFT)),) 
> > LOCAL_CPPFLAGS = -I"$(LOCAL_SOFT)/include" 
> > LOCAL_LIBS = -L"$(LOCAL_SOFT)/lib$(R_ARCH)" -L"$(LOCAL_SOFT)/lib" 
> > endif 
> > 
> > DLLTOOL = $(BINPREF)dlltool --as $(BINPREF)as $(DT_ARCH) 
> > DLLTOOLFLAGS = -k 
> > NM = $(BINPREF)nm 
> > RESCOMP = $(BINPREF)windres $(RC_ARCH) 
> > ## MAIN_LD needs to be set by the package 
> > LINKER = $(MAIN_LD) 
> > ## as a default 
> > DLL = $(CC) 
> > 
> > ## Things defined in Renviron on Unix 
> > SED = sed 
> > TAR = tar 
> > 
> > ## Things defined in MkRules 
> > CAT = cat 
> > CP = cp 
> > MKDIR = mkdir 
> > RM = rm -f 
> > SORT = sort 
> > 
> > ## For use in packages 
> > GRAPHAPP_LIB = -lRgraphapp 
> > TCL_VERSION = 85 
> > ZLIB_LIBS = -lRzlib 
> > 
> > AR = $(BINPREF)ar 
> > ## Used by packages 'maps' and 'mapdata' 
> > AWK = gawk 
> > BLAS_LIBS = -L"$(R_HOME)/$(IMPDIR)" -lRblas 
> > C_VISIBILITY = 
> > CC = $(BINPREF)gcc $(M_ARCH) 
> > CFLAGS = -O3 -Wall $(DEBUGFLAG) -std=gnu99 -mtune=core2 
> > CPICFLAGS = 
> > CPPFLAGS = 
> > CXX = $(BINPREF)g++ $(M_ARCH) 
> > CXXCPP = $(CXX) -E 
> > CXXFLAGS = -O2 -Wall $(DEBUGFLAG) -mtune=core2 
> > CXXPICFLAGS = 
> > DYLIB_EXT = .dll 
> > DYLIB_LD = $(DLL) 
> > DYLIB_LDFLAGS = -shared 
> > DYLIB_LINK = $(DYLIB_LD) $(DYLIB_LDFLAGS) $(LDFLAGS) 
> > ECHO = echo 
> > ECHO_C = 
> > ECHO_N = -n 
> > ECHO_T = 
> > FC = $(BINPREF)gfortran $(M_ARCH) 
> > FCFLAGS = -O3 $(DEBUGFLAG) -mtune=core2 
> > # additional libs needed when linking with $(FC), e.g. on Solaris 
> > FCLIBS = 
> > F77 = $(BINPREF)gfortran $(M_ARCH) 
> > F77_VISIBILITY = 
> > FFLAGS = -O3 $(DEBUGFLAG) -mtune=core2 
> > FLIBS = -lgfortran 
> > FCPICFLAGS = 
> > FPICFLAGS = 
> > FOUNDATION_CPPFLAGS = 
> > FOUNDATION_LIBS = 
> > JAR = 
> > JAVA = 
> > JAVAC = 
> > JAVAH = 
> > # JAVA_HOME = 
> > # JAVA_LD_LIBRARY_PATH = 
> > JAVA_LIBS = -L"$(JAVA_HOME)/bin/client" -ljvm -ljvm-w32 
> > JAVA_CPPFLAGS = -I"$(JAVA_HOME)/../include" -I"$(JAVA_HOME)/../include/win32" 
> > LAPACK_LIBS = -L"$(R_HOME)/$(IMPDIR)" -lRlapack 
> > ## we only need this is if it is external, as otherwise link to R 
> > LIBINTL= 
> > LIBM = -lm 
> > LIBR = -L"$(R_HOME)/$(IMPDIR)" -lR 
> > LIBS =  -lm 
> > ## needed by R CMD config 
> > LIBnn = lib 
> > LIBTOOL = 
> > LDFLAGS = 
> > ## needed to build applications linking to static libR 
> > # MAIN_LD = 
> > # MAIN_LDFLAGS = 
> > # MAIN_LINK = $(MAIN_LD) $(MAIN_LDFLAGS) $(LDFLAGS) 
> > # don't have this: would 'mkdir -p' do? 
> > # MKINSTALLDIRS = $(R_HOME)/bin/mkinstalldirs 
> > OBJC = $(CC) 
> > OBJCFLAGS = -O2 
> > OBJC_LIBS = -lobjc 
> > OBJCXX = 
> > R_ARCH = /i386 
> > RANLIB = $(BINPREF)ranlib 
> > SAFE_FFLAGS = -O3 -ffloat-store 
> > SED = sed 
> > ## it seems some makes (but not ours) get upset if SHELL is set. 
> > # SHELL = /bin/sh 
> > SHLIB_CFLAGS = 
> > SHLIB_CXXFLAGS = 
> > SHLIB_CXXLD = $(CXX) 
> > ## ideally -shared -static-libstdc++, but not for gcc 4.2.1 
> > SHLIB_CXXLDFLAGS = -shared 
> > SHLIB_EXT = .dll 
> > SHLIB_FCLD = $(FC) 
> > ## ideally -shared -static-libgfortran, but not for gcc 4.2.1 
> > SHLIB_FCLDFLAGS = -shared 
> > SHLIB_FFLAGS = 
> > SHLIB_LD = $(CC) 
> > SHLIB_LDFLAGS = -shared 
> > SHLIB_LIBADD = 
> > SHLIB_LINK = $(SHLIB_LD) -Wl,--export-all-symbols $(SHLIB_LDFLAGS) $(LDFLAGS) 
> > # not implemented in current toolchain 
> > SHLIB_OPENMP_CFLAGS = 
> > SHLIB_OPENMP_CXXFLAGS = 
> > SHLIB_OPENMP_FCFLAGS = 
> > SHLIB_OPENMP_FFLAGS = 
> > STRIP_LIBS = $(BINPREF)strip --strip-unneeded 
> > STRIP_STATIC_LIBS = $(BINPREF)strip --strip-debug 
> > TCLTK_CPPFLAGS = -I "$(TCL_HOME)/include" -DWin32 
> > TCLTK_LIBS = -L"$(TCL_HOME)/bin" -ltcl$(TCL_VERSION) -ltk$(TCL_VERSION) 
> > 
> > STATIC_LIBR = 
> > 
> > R_XTRA_CFLAGS = 
> > R_XTRA_CPPFLAGS = -I"$(R_HOME)/include" 
> > R_XTRA_CXXFLAGS = 
> > R_XTRA_FFLAGS = 
> > 
> > ALL_CFLAGS = $(R_XTRA_CFLAGS) $(PKG_CFLAGS) $(CPICFLAGS) $(SHLIB_CFLAGS) $(CFLAGS) 
> > ALL_CPPFLAGS = $(R_XTRA_CPPFLAGS) $(PKG_CPPFLAGS) $(CPPFLAGS) $($*-CPPFLAGS) $(CLINK_CPPFLAGS) $(LOCAL_CPPFLAGS) 
> > ALL_CXXFLAGS = $(R_XTRA_CXXFLAGS) $(PKG_CXXFLAGS) $(CXXPICFLAGS) $(SHLIB_CXXFLAGS) $(CXXFLAGS) 
> > ALL_OBJCFLAGS = $(PKG_OBJCFLAGS) $(CPICFLAGS) $(SHLIB_CFLAGS) $(OBJCFLAGS) 
> > ALL_OBJCXXFLAGS = $(PKG_OBJCXXFLAGS) $(CXXPICFLAGS) $(SHLIB_CXXFLAGS) $(OBJCXXFLAGS) 
> > ALL_FFLAGS = $(R_XTRA_FFLAGS) $(PKG_FFLAGS) $(FPICFLAGS) $(SHLIB_FFLAGS) $(FFLAGS) 
> > ALL_LIBS = $(LOCAL_LIBS) $(PKG_LIBS) $(SHLIB_LIBADD) $(LIBR) $(LIBINTL) 
> > 
> > .SUFFIXES: 
> > .SUFFIXES: .c .cc .cpp .d .f .f90 .f95 .m .mm .M .o .a .def .dll .exe .rc 
> > 
> > .c.o: 
> >         $(CC) $(ALL_CPPFLAGS) $(ALL_CFLAGS) -c $< -o $@ 
> > .c.d: 
> >         @echo "making $@ from $<" 
> >         @$(CC) -std=gnu99 -MM $(ALL_CPPFLAGS) $< > $@ 
> > .cc.o: 
> >         $(CXX) $(ALL_CPPFLAGS) $(ALL_CXXFLAGS) -c $< -o $@ 
> > .cpp.o: 
> >         $(CXX) $(ALL_CPPFLAGS) $(ALL_CXXFLAGS) -c $< -o $@ 
> > .cc.d: 
> >         @echo "making $@ from $<" 
> >         @$(CXX) -M $(ALL_CPPFLAGS) $< > $@ 
> > .cpp.d: 
> >         @echo "making $@ from $<" 
> >         @$(CXX) -M $(ALL_CPPFLAGS) $< > $@ 
> > .m.o: 
> >         $(OBJC) $(ALL_CPPFLAGS) $(ALL_OBJCFLAGS) -c $< -o $@ 
> > .m.d: 
> >         @echo "making $@ from $<" 
> >         @$(OBJC) -MM $(ALL_CPPFLAGS) $< > $@ 
> > .mm.o: 
> >         $(OBJCXX) $(ALL_CPPFLAGS) $(ALL_OBJCXXFLAGS) -c $< -o $@ 
> > .M.o: 
> >         $(OBJCXX) $(ALL_CPPFLAGS) $(ALL_OBJCXXFLAGS) -c $< -o $@ 
> > .f.o: 
> >         $(F77) $(ALL_FFLAGS) -c $< -o $@ 
> > .f95.o: 
> >         $(FC) $(PKG_FCFLAGS) $(FCPICFLAGS) $(FCFLAGS) -c  $< -o $@ 
> > .f90.o: 
> >         $(FC) $(PKG_FCFLAGS) $(FCPICFLAGS) $(FCFLAGS) -c  $< -o $@ 
> > 
> > %.exe: 
> >         $(LINKER) $(LINKFLAGS) $($*-LINKFLAGS) -o $@ $^ $($*-LIBS) $(LOCAL_LIBS) $(LIBS) 
> > 
> > %.dll: 
> >         @echo EXPORTS > $*.def 
> >         @$(NM) $^ | $(SED) -n $(SYMPAT) >> $*.def 
> >         $(SHLIB_LD) -shared $(DLLFLAGS) -o $@ $*.def $^ $(ALL_LIBS) 
> >         @$(RM) $*.def 
> > 
> > lib%.dll.a: %.def 
> >         $(DLLTOOL) $(DLLTOOLFLAGS) $($*-DLLTOOLFLAGS) --dllname $*.dll --input-def $*.def --output-lib $@ 
> > 
> > %.a: 
> >         @$(RM) $@ 
> >         $(AR) crs $@ $^ 
> > 
> > %.o: %.rc 
> >         $(RESCOMP) $(RESFLAGS) -i $< -o $@ 
> > 
> > 
> > 
> > From:                 Simon Urbanek <simon.urbanek at r-project.org>
> > To:                 David L Lorenz <lorenz at usgs.gov>
> > Cc:                 r-devel at r-project.org
> > Date:                 02/08/2012 07:13 PM
> > Subject:                 Re: [Rd] FORTRAN compilation error
> > 
> > 
> > 
> > 
> > 
> > On Feb 8, 2012, at 3:16 PM, David L Lorenz wrote:
> > 
> > > I get an error when trying to compile a FORTRAN source file for use in a 
> > > package that I am developing. The error, reported in 00install.out is 
> > > below.
> > > 
> > > * installing *source* package 'USGSstats' ...
> > > ** libs
> > > 
> > > *** arch - i386
> > > C:/PROGRA~1/R/R-214~1.1/etc/i386/Makeconf:194: warning: overriding recipe 
> > > for target `.m.o'
> > > C:/PROGRA~1/R/R-214~1.1/etc/i386/Makeconf:187: warning: ignoring old 
> > > recipe for target `.m.o'
> > > gfortran      -O3  -mtune=core2 -c seakenF.f -o seakenF.o
> > > "zseakenF.o" was unexpected at this time.
> > > make: *** [USGSstats.dll] Error 255
> > > ERROR: compilation failed for package 'USGSstats'
> > > 
> > > I am running R 2.14.1 on a Windows 7 pc. The gnu compilers are all 
> > > installed and work just fine. In fact, the .o file is created and I can 
> > > manually create the .dll file.
> > > The error seems to be in the generation of the object name zseakenF.o. I 
> > > do not see where that might have been generated in the Makeconf file.
> > > 
> > 
> > The problem is caused by your Makeconf which you didn't share, so there is not much we can help you with ... You should remove the offending Makeconf to start with ...
> > 
> > Cheers,
> > Simon
> > 
> > 
> > 
> > 
> 
> 
> 


From bbolker at gmail.com  Thu Feb  9 17:45:52 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 09 Feb 2012 11:45:52 -0500
Subject: [Rd] na.omit option in prcomp: formula interface only
Message-ID: <4F33F840.50406@gmail.com>


  This is a wishlist/request for discussion about the behaviour of the
na.action option in prcomp, specifically the fact that it only applies
to the formula interface.

   I had a question from a friend (who is smart and careful and
generally R's TFM, although like all of us he misses things sometimes)
asking why the na.action= argument didn't seem to be doing anything in
prcomp (i.e. one gets an "Error in svd(x, nu=0): infinite or missing
values in 'x'").  Some poking later, I realized that na.action only
applied to the formula interface (so I told him to try
prcomp(~.,data=x,...) instead).  Sufficiently careful reading of the
help page, with hindsight, revealed that na.action only appears in the
arguments for the formula method, not the default (on the other hand,
'scale.' only appears in the default formula, but it *does* work with
prcomp.formula as well, because prcomp.formula passes ... through to
prcomp.default ...)

  Would it be reasonable to (at least) add a sentence to the
documentation saying that na.action applies only to the formula
interface or (possibly) to add some NA-processing machinery to
prcomp.default to allow it to handle na.action as well?  (I can
appreciate from looking at stats:::prcomp.formula that the NA-processing
is not completely trivial ...)

  Ben Bolker


From r.m.krug at gmail.com  Fri Feb 10 09:11:35 2012
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri, 10 Feb 2012 09:11:35 +0100
Subject: [Rd] [R] Version control (git, mercurial) for R packages
In-Reply-To: <CABdHhvHCE0RjUCxNWpZtQjuRfQ+8bh0F5xEjGRG6MSyeSQLCRw@mail.gmail.com>
References: <CA+hbrhWcgynWvDWMCL4ozv3W3q0pn0Tddyo3F4RO5=gJ0e8OGQ@mail.gmail.com>
	<4F33873B.6050100@gmail.com>
	<CABdHhvHCE0RjUCxNWpZtQjuRfQ+8bh0F5xEjGRG6MSyeSQLCRw@mail.gmail.com>
Message-ID: <4F34D137.8030808@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

CCd to r-devel as suggested by Peter.

On 09/02/12 19:28, Hadley Wickham wrote:
>>> I'm exploring using a version control system to keep better
>>> track of changes to the packages I maintain. I'm leaning
>>> towards git (although mercurial also looks good) but am not
>>> sure what is the best way to set up the repository. It seems I
>>> can't set the repository directly within the R package main
>>> directory, since it will be incompatible with the standard
>>> package structure. I can set the repository in the directory
>>> that contains my R packages, but then I have a single
>>> repository for all of my packages, which is not ideal.
>> 
>> Git is nice - but if you ar looking for simplicity in usage for
>> R packages, I guess r-forge and rforge are the easiest to use.
> 
> I think git + github is substantially easier to use, especially if
> you want to incorporate patches from the community.
> 
>> But I would be interested in the workflow when using github as
>> the main VCS.
> 
> The thing that has made this really successful for me is the 
> install_github function in devtools.  Then it's easy for people to
> try out development versions:
> 
> install.packages("devtools") library(devtools) 
> install_github("myrepo", "myusername")

Thanks Hadley - I should definitely look closer into the devtools
package - there really seem to be some gems in there.
One example is this function - sounds perfect for small scale usages
and for developers.

But what I was thinking about (in my other post as well) is to include
github (or any other git repo provider) into r-forge for the automatic
creation of packages.

So is there an easy way to kind of push a certain revision up to
r-forge to have the automatic builds?
One could do it manualy, but automatic would be so much nicer.

> 
> This requires a working R development environment but thanks to
> the hard work of Simon Urbanek, Duncan Murdoch, Brian Ripley and
> others, this is a one-install process on all major platforms.

True - no problem for developers.

Cheers,

Rainer

> 
> Hadley
> 
> 


- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk800TcACgkQoYgNqgF2ego0QgCfcDIpUlxmVHfYMHi/IlCNKSJ3
1sIAnjQEmBYoTXIE5SlvRUqs/eAioibC
=38uA
-----END PGP SIGNATURE-----


From malsburg at gmail.com  Fri Feb 10 13:18:38 2012
From: malsburg at gmail.com (Titus von der Malsburg)
Date: Fri, 10 Feb 2012 13:18:38 +0100
Subject: [Rd] Creating XML document extremely slow
Message-ID: <CAM+LvrA9pWspU2qTMf4dJTbxFZzS9waDLTbHtHU=0GiJYwD4dA@mail.gmail.com>

Hi list,

I'm using the package XML to create a simple XML document.
Unfortunately constructing the XML tree is extremely slow.  My code
(see below) adds only about 100 nodes per second on an Intel i5
machine.  There's clearly something wrong but I don't see what.

Here's a sample of the XML document:

  <?xml version="1.0" encoding="utf-8"?>
  <MarkerSet xmlns="http://www.brainproducts.com/MarkerSet">
   <SamplingRate>512.032770097286</SamplingRate>
   <SamplingInterval>1.953</SamplingInterval>
   <Markers>
    <Marker>
     <Type>Stimulus</Type>
     <Description>prr_156</Description>
     <Position>397497</Position>
     <Points>1</Points>
     <Channel>All</Channel>
    </Marker>
    ...
   </Markers>
  </MarkerSet>

There are about 500 very similar marker tags.  Here's the part of the
code that is particularly slow (x is a character, y is an integer,
both have a length of about 500):

  markernode <- xmlNode('Markers')
  for(i in 1:length(t)){
    markernode <- addChildren(markernode, xmlNode('Marker',
             xmlNode('Type', 'Stimulus'), xmlNode('Description', x[i]),
             xmlNode('Position', y[i]), xmlNode('Points', 1),
             xmlNode('Channel', 'All')))
  }

Looks pretty harmless to me.  Any suggestion about how I can speed
this up are most welcome!

  Titus


From malsburg at gmail.com  Fri Feb 10 13:53:21 2012
From: malsburg at gmail.com (Titus von der Malsburg)
Date: Fri, 10 Feb 2012 13:53:21 +0100
Subject: [Rd] Creating XML document extremely slow
In-Reply-To: <20277.4167.362367.846175@worblehat.boku.ac.at>
References: <CAM+LvrA9pWspU2qTMf4dJTbxFZzS9waDLTbHtHU=0GiJYwD4dA@mail.gmail.com>
	<20277.4167.362367.846175@worblehat.boku.ac.at>
Message-ID: <CAM+LvrA+s0TgR1fPzW+Ft6CkjV_kfPSbgq98-m6T-kCQGmHt4g@mail.gmail.com>

On Fri, Feb 10, 2012 at 1:40 PM, Friedrich Leisch wrote:
> Have you considered simply writing the XML using standard functions
> like cat() and friends? That can be much faster than creating an XML
> object and writing that out (have just done that to write exams into
> our e-learning platform via XML).

Friedrich, thanks for your response.  Since my current XML document is
fairly simple, I could of course just paste some pre-fabricated
strings together.  For more complex documents this would however not
be a satisfying solution.

The reason I though I should ask on the list is that it seems to me
that the extremely poor performance could be due to a bug in the XML
package.

  Titus


From nalimilan at club.fr  Fri Feb 10 14:10:19 2012
From: nalimilan at club.fr (Milan Bouchet-Valat)
Date: Fri, 10 Feb 2012 14:10:19 +0100
Subject: [Rd] Creating XML document extremely slow
In-Reply-To: <CAM+LvrA9pWspU2qTMf4dJTbxFZzS9waDLTbHtHU=0GiJYwD4dA@mail.gmail.com>
References: <CAM+LvrA9pWspU2qTMf4dJTbxFZzS9waDLTbHtHU=0GiJYwD4dA@mail.gmail.com>
Message-ID: <1328879419.2325.8.camel@milan>

Le vendredi 10 f?vrier 2012 ? 13:18 +0100, Titus von der Malsburg a
?crit :
> Hi list,
> 
> I'm using the package XML to create a simple XML document.
> Unfortunately constructing the XML tree is extremely slow.  My code
> (see below) adds only about 100 nodes per second on an Intel i5
> machine.  There's clearly something wrong but I don't see what.
> 
> Here's a sample of the XML document:
> 
>   <?xml version="1.0" encoding="utf-8"?>
>   <MarkerSet xmlns="http://www.brainproducts.com/MarkerSet">
>    <SamplingRate>512.032770097286</SamplingRate>
>    <SamplingInterval>1.953</SamplingInterval>
>    <Markers>
>     <Marker>
>      <Type>Stimulus</Type>
>      <Description>prr_156</Description>
>      <Position>397497</Position>
>      <Points>1</Points>
>      <Channel>All</Channel>
>     </Marker>
>     ...
>    </Markers>
>   </MarkerSet>
> 
> There are about 500 very similar marker tags.  Here's the part of the
> code that is particularly slow (x is a character, y is an integer,
> both have a length of about 500):
> 
>   markernode <- xmlNode('Markers')
>   for(i in 1:length(t)){
>     markernode <- addChildren(markernode, xmlNode('Marker',
>              xmlNode('Type', 'Stimulus'), xmlNode('Description', x[i]),
>              xmlNode('Position', y[i]), xmlNode('Points', 1),
>              xmlNode('Channel', 'All')))
>   }
> 
> Looks pretty harmless to me.  Any suggestion about how I can speed
> this up are most welcome!
Just a guess, but I'd try creating all 'Marker' nodes first, storing
them in a 'markers' list, and then calling addChildren(markernode,
kids=markers). Adding nodes one by one is likely to create useless
overhead.

Hope this helps


From nalimilan at club.fr  Fri Feb 10 16:15:41 2012
From: nalimilan at club.fr (Milan Bouchet-Valat)
Date: Fri, 10 Feb 2012 16:15:41 +0100
Subject: [Rd] Out of date instructions to build R using MKL
Message-ID: <1328886941.2325.23.camel@milan>

Hi!

I've been playing with MKL for a few days and I noticed the instructions
in the R Installation Administration manual [1] no longer apply. It
seems that since version 10.0 (the one used by the manual),
libmkl_lapack.so has been renamed/split (although the official
explanations seem to imply this was already the case in 10.0 [2]).

As a consequence, the instructions for dynamic linking no longer work
with the last version (2011-sp1). This is also the case of what is
explained on several sites like [3] or [4]. The manual's instructions to
link statically to MKL still work fine, though.

I'm merely signaling this fact to more clued people, since I've not been
able to get R to dynamically link to MKL. I'm always getting this notice
during ./configure:
> checking whether double complex BLAS can be used... no

Anyways, one of the problems is also that it's no longer possible to
make libRblas.so and libRlapack.so symlinks to the Intel libs, as they
are split into several files.

If nobody knows how or cares about to fix this ATM, a simple warning
that the instructions are outdated would already improve the situation,
as it took me some time to understand things had changed and I wasn't
just being silly. ;-)

(That said, I'm not convinced using an external BLAS/LAPACK is really
interesting for standard desktops. Performances gains compared to
default packages are incredible in benchmarks, but for real use cases
multi-threading often makes things slower - at least for me, using gnm.
I guess this is mostly interesting for very larges matrices, and not for
many repeated small operations.)

Regards


1: http://cran.r-project.org/doc/manuals/R-admin.html#MKL
2: http://software.intel.com/en-us/forums/showthread.php?t=81302
3:
http://www.r-bloggers.com/compiling-64-bit-r-2-10-1-with-mkl-in-linux/
4: http://www.rd.dnc.ac.jp/~otsu/lecture/RwithMKL.html


From malsburg at gmail.com  Fri Feb 10 17:36:45 2012
From: malsburg at gmail.com (Titus von der Malsburg)
Date: Fri, 10 Feb 2012 17:36:45 +0100
Subject: [Rd] Creating XML document extremely slow
In-Reply-To: <1328879419.2325.8.camel@milan>
References: <CAM+LvrA9pWspU2qTMf4dJTbxFZzS9waDLTbHtHU=0GiJYwD4dA@mail.gmail.com>
	<1328879419.2325.8.camel@milan>
Message-ID: <CAM+LvrAY7OCUOk8fZyBmQw+ZnA4U296Q84MLA4nVLCKyrA6Lgg@mail.gmail.com>

On Fri, Feb 10, 2012 at 2:10 PM, Milan Bouchet-Valat <nalimilan at club.fr> wrote:
> Le vendredi 10 f?vrier 2012 ? 13:18 +0100, Titus von der Malsburg a
> ?crit :
> Just a guess, but I'd try creating all 'Marker' nodes first, storing
> them in a 'markers' list, and then calling addChildren(markernode,
> kids=markers).

A good guess.  I changed the code according to your suggestion and it
reduced the processing time from ~25 to ~3 seconds.  Better but still
ridiculously slow.  When I generate the same XML document by
concatenating pre-fabricated strings, as suggested by Friedrich, the
whole process takes just 10 ms according to system.time.

 Titus


From nalimilan at club.fr  Fri Feb 10 18:43:05 2012
From: nalimilan at club.fr (Milan Bouchet-Valat)
Date: Fri, 10 Feb 2012 18:43:05 +0100
Subject: [Rd] Creating XML document extremely slow
In-Reply-To: <CAM+LvrAY7OCUOk8fZyBmQw+ZnA4U296Q84MLA4nVLCKyrA6Lgg@mail.gmail.com>
References: <CAM+LvrA9pWspU2qTMf4dJTbxFZzS9waDLTbHtHU=0GiJYwD4dA@mail.gmail.com>
	<1328879419.2325.8.camel@milan>
	<CAM+LvrAY7OCUOk8fZyBmQw+ZnA4U296Q84MLA4nVLCKyrA6Lgg@mail.gmail.com>
Message-ID: <1328895785.2325.37.camel@milan>

Le vendredi 10 f?vrier 2012 ? 17:36 +0100, Titus von der Malsburg a
?crit :
> On Fri, Feb 10, 2012 at 2:10 PM, Milan Bouchet-Valat <nalimilan at club.fr> wrote:
> > Le vendredi 10 f?vrier 2012 ? 13:18 +0100, Titus von der Malsburg a
> > ?crit :
> > Just a guess, but I'd try creating all 'Marker' nodes first, storing
> > them in a 'markers' list, and then calling addChildren(markernode,
> > kids=markers).
> 
> A good guess.  I changed the code according to your suggestion and it
> reduced the processing time from ~25 to ~3 seconds.  Better but still
> ridiculously slow.  When I generate the same XML document by
> concatenating pre-fabricated strings, as suggested by Friedrich, the
> whole process takes just 10 ms according to system.time.
Doesn't sound so bad to me. I don't think you'll find a use case where
3s will really be a problem.

>From what Rprof() says, xmlNode() doesn't seem to do anything obviously
wrong. It's just that you're calling it 500 times, so there's some
overhead. You'd need a vectorized version that would handle all the data
in one go, i.e. create all the children from the values of x and y, and
then add them to their respective parents, in one function call.

Actually, if you look at what xmlNode() does, you'll see that it can
easily be re-implemented to do this. Though, since your data is simple,
it might be as easy to write the output by hand as you said. The real
benefit of libxml2 appears when you create complex documents, and even
more when you need to parse them: the hardest part to implement is error
checking and finding nodes in a structure you don't perfectly know in
advance.


Cheers


From malsburg at gmail.com  Fri Feb 10 19:12:45 2012
From: malsburg at gmail.com (Titus von der Malsburg)
Date: Fri, 10 Feb 2012 19:12:45 +0100
Subject: [Rd] Creating XML document extremely slow
In-Reply-To: <1328895785.2325.37.camel@milan>
References: <CAM+LvrA9pWspU2qTMf4dJTbxFZzS9waDLTbHtHU=0GiJYwD4dA@mail.gmail.com>
	<1328879419.2325.8.camel@milan>
	<CAM+LvrAY7OCUOk8fZyBmQw+ZnA4U296Q84MLA4nVLCKyrA6Lgg@mail.gmail.com>
	<1328895785.2325.37.camel@milan>
Message-ID: <CAM+LvrD9eoL-wHjNzk3K0NOjU6488NwjXUSOOKo--ArMfJAMsg@mail.gmail.com>

On Fri, Feb 10, 2012 at 6:43 PM, Milan Bouchet-Valat <nalimilan at club.fr> wrote:
> Doesn't sound so bad to me. I don't think you'll find a use case where
> 3s will really be a problem.

Actually I have exactly such a case because I have to produce many
such documents and a difference of two orders of magnitude in
processing matters greatly.

> From what Rprof() says, xmlNode() doesn't seem to do anything obviously
> wrong. It's just that you're calling it 500 times, so there's some
> overhead. You'd need a vectorized version that would handle all the data
> in one go

My code that patches together strings is also not vectorized and does
something in 500 iteration.  Still it is 300 times faster than the
solution that uses the XML package.  Also, I could only bring down the
processing time of the code that uses XML package to 3 seconds because
(i) the amount of data that was very small and (ii) because the XML
document had a very repetitive structure.  Documents with a more
varied structure don't allow the kind of optimization that you
proposed and if they have a non-trivial size the processing time can
easily become prohibitive.

Anyway, my problem is solved because I'm switched to my own homebrewed
xml generation and it works fine.

  Titus


From cubranic at stat.ubc.ca  Fri Feb 10 22:05:37 2012
From: cubranic at stat.ubc.ca (Davor Cubranic)
Date: Fri, 10 Feb 2012 13:05:37 -0800
Subject: [Rd] [R] Version control (git, mercurial) for R packages
In-Reply-To: <4F34D137.8030808@gmail.com>
References: <CA+hbrhWcgynWvDWMCL4ozv3W3q0pn0Tddyo3F4RO5=gJ0e8OGQ@mail.gmail.com>
	<CABdHhvHCE0RjUCxNWpZtQjuRfQ+8bh0F5xEjGRG6MSyeSQLCRw@mail.gmail.com>
	<4F34D137.8030808@gmail.com>
Message-ID: <42870113.3HDWH6xair@prle>

On February 10, 2012 09:11:35 AM Rainer M Krug wrote:
> But what I was thinking about (in my other post as well) is to include
> github (or any other git repo provider) into r-forge for the automatic
> creation of packages.
> 
> So is there an easy way to kind of push a certain revision up to
> r-forge to have the automatic builds?
> One could do it manualy, but automatic would be so much nicer.

With Git, it is possible to add a remote branch that points to a Subversion 
repository. That way, you do your work on Github, and when you're ready to 
release, just push your changes to R-Forge SVN. 

Details: http://cameron.bracken.bz/git-with-r-forge

Davor


From trevor.l.davis at gmail.com  Sat Feb 11 00:04:09 2012
From: trevor.l.davis at gmail.com (Trevor Davis)
Date: Fri, 10 Feb 2012 15:04:09 -0800
Subject: [Rd] inconsolata font for building vignettes with R-devel
In-Reply-To: <20093.1853.453993.100510@max.nulle.part>
References: <4E7D023E.5070003@ufl.edu>
	<20093.1853.453993.100510@max.nulle.part>
Message-ID: <CAMigB8G5RsvrxeUkOSKXdg56M_nOcT3bmR-Uc71S+=6jibpSCg@mail.gmail.com>

> So is there a safe fallback or not? ?Should I install texlive-fonts-extra too
> when building?
>
> Dirk
>

Today I needed to run

sudo apt-get install texlive-fonts-extra

in order to build a package in R 2.14.1 Ubuntu 11.10

Else I get the following warning/error:

* checking PDF version of manual ... WARNING
LaTeX errors when creating PDF version.
This typically indicates Rd problems.
LaTeX errors found:
! LaTeX Error: File `inconsolata.sty' not found.

Type X to quit or <RETURN> to proceed,
or enter new name. (Default extension: sty)

! Emergency stop.
<read *>

l.267 ^^M

!  ==> Fatal error occurred, no output PDF file produced!

If you don't use the latest Ubuntu build from CRAN but instead use the
build of R in the normal Ubuntu repos (i.e. R 13.2) than this
error/warning does not occur...  Probably wisest to install
texlive-fonts-extra for now.


From pburns at pburns.seanet.com  Sat Feb 11 18:55:03 2012
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Sat, 11 Feb 2012 17:55:03 +0000
Subject: [Rd] Task views (was: Re: [R] Schwefel Function Optimization)
In-Reply-To: <loom.20120211T090340-743@post.gmane.org>
References: <0ABCA2ECCCA5B34DA18927BB044B196828C9AEB0@IU-MSSG-MBX104.ads.iu.edu>
	<loom.20120211T090340-743@post.gmane.org>
Message-ID: <4F36AB77.2090706@pburns.seanet.com>



On 11/02/2012 08:25, Hans W Borchers wrote:
> Vartanian, Ara<aravart<at>  indiana.edu>  writes:
>
>> All,
>>
>> I am looking for

...

>>

>
> Why is it necessary over and over again to point to the Optimization Task
> View?

...

Now it could be that people are not trying
very hard to solve their own problems, but
to be fair it is a pretty gruelling process
to find the Task Views.

May I suggest that there be a "Task Views" item
on the left sidebar of the R website in the
Documentation section?

-- 
Patrick Burns
pburns at pburns.seanet.com
twitter: @portfolioprobe
http://www.portfolioprobe.com/blog
http://www.burns-stat.com
(home of 'Some hints for the R beginner'
and 'The R Inferno')


From ligges at statistik.tu-dortmund.de  Sat Feb 11 19:10:09 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sat, 11 Feb 2012 19:10:09 +0100
Subject: [Rd] Task views
In-Reply-To: <4F36AB77.2090706@pburns.seanet.com>
References: <0ABCA2ECCCA5B34DA18927BB044B196828C9AEB0@IU-MSSG-MBX104.ads.iu.edu>
	<loom.20120211T090340-743@post.gmane.org>
	<4F36AB77.2090706@pburns.seanet.com>
Message-ID: <4F36AF01.7010402@statistik.tu-dortmund.de>



On 11.02.2012 18:55, Patrick Burns wrote:
>
>
> On 11/02/2012 08:25, Hans W Borchers wrote:
>> Vartanian, Ara<aravart<at> indiana.edu> writes:
>>
>>> All,
>>>
>>> I am looking for
>
> ...
>
>>>
>
>>
>> Why is it necessary over and over again to point to the Optimization Task
>> View?
>
> ...
>
> Now it could be that people are not trying
> very hard to solve their own problems, but
> to be fair it is a pretty gruelling process
> to find the Task Views.
>
> May I suggest that there be a "Task Views" item
> on the left sidebar of the R website in the
> Documentation section?
>


It is in the left side bar of CRAN already.

Uwe


From pgilbert902 at gmail.com  Sat Feb 11 19:38:10 2012
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Sat, 11 Feb 2012 13:38:10 -0500
Subject: [Rd] Task views
In-Reply-To: <4F36AF01.7010402@statistik.tu-dortmund.de>
References: <0ABCA2ECCCA5B34DA18927BB044B196828C9AEB0@IU-MSSG-MBX104.ads.iu.edu>
	<loom.20120211T090340-743@post.gmane.org>
	<4F36AB77.2090706@pburns.seanet.com>
	<4F36AF01.7010402@statistik.tu-dortmund.de>
Message-ID: <4F36B592.3010007@gmail.com>

On 12-02-11 01:10 PM, Uwe Ligges wrote:
> On 11.02.2012 18:55, Patrick Burns wrote:
>>
>> On 11/02/2012 08:25, Hans W Borchers wrote:
>>> Vartanian, Ara<aravart<at> indiana.edu> writes:
>>>
>>>> All,
>>>>
>>>> I am looking for
>> ...
>>> Why is it necessary over and over again to point to the Optimization
>>> Task
>>> View?
>> ...
>> Now it could be that people are not trying
>> very hard to solve their own problems, but
>> to be fair it is a pretty gruelling process
>> to find the Task Views.
>>
>> May I suggest that there be a "Task Views" item
>> on the left sidebar of the R website in the
>> Documentation section?
>>
> It is in the left side bar of CRAN already.
>
> Uwe

Yes, on CRAN but not on the R Homepage. I do agree with Hans that people 
do not seem to find it easily. One reason may be the term "Task Views" 
is fine once you know what it is, but it is not completely self 
explanatory, so you have to look to see what it is. Thus, a bit like 
reading documentation, people do not always do it. Perhaps a bullet in 
"Getting Started" would help?

Paul


From edd at debian.org  Sat Feb 11 20:46:38 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 11 Feb 2012 13:46:38 -0600
Subject: [Rd] inconsolata font for building vignettes with R-devel
In-Reply-To: <CAMigB8G5RsvrxeUkOSKXdg56M_nOcT3bmR-Uc71S+=6jibpSCg@mail.gmail.com>
References: <4E7D023E.5070003@ufl.edu>
	<20093.1853.453993.100510@max.nulle.part>
	<CAMigB8G5RsvrxeUkOSKXdg56M_nOcT3bmR-Uc71S+=6jibpSCg@mail.gmail.com>
Message-ID: <20278.50590.974073.924510@max.nulle.part>


Trevor,

On 10 February 2012 at 15:04, Trevor Davis wrote:
| > So is there a safe fallback or not? ?Should I install texlive-fonts-extra too
| > when building?
| >
| > Dirk
| >

You quoted a message (skipping its date) that is rather old,

     R> difftime(Sys.Date()-1, as.Date("2011-09-23"))
     Time difference of 140 days

So what follows is now somewhat out of context.

| Today I needed to run
| 
| sudo apt-get install texlive-fonts-extra
| 
| in order to build a package in R 2.14.1 Ubuntu 11.10
| 
| Else I get the following warning/error:
| 
| * checking PDF version of manual ... WARNING
| LaTeX errors when creating PDF version.
| This typically indicates Rd problems.
| LaTeX errors found:
| ! LaTeX Error: File `inconsolata.sty' not found.
| 
| Type X to quit or <RETURN> to proceed,
| or enter new name. (Default extension: sty)
| 
| ! Emergency stop.
| <read *>
| 
| l.267 ^^M
| 
| !  ==> Fatal error occurred, no output PDF file produced!
| 
| If you don't use the latest Ubuntu build from CRAN but instead use the
| build of R in the normal Ubuntu repos (i.e. R 13.2) than this

Michael does his work (based on my Debian packages) so that you do not have
to live with outdated packaged.  And ...

| error/warning does not occur...  Probably wisest to install
| texlive-fonts-extra for now.

... the current r-base-dev package now has a 'Suggests:' on
texlive-fonts-extra, partly in result of the thread you replied to, 4+ months
later. 

All this is off-topic here anyway and should have been r-sig-debian.

Hope this helps,  Dirk

-- 
"Outside of a dog, a book is a man's best friend. Inside of a dog, it is too
dark to read." -- Groucho Marx


From b.rowlingson at lancaster.ac.uk  Sun Feb 12 11:43:05 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 12 Feb 2012 10:43:05 +0000
Subject: [Rd] Task views (was: Re: [R] Schwefel Function Optimization)
In-Reply-To: <4F36AB77.2090706@pburns.seanet.com>
References: <0ABCA2ECCCA5B34DA18927BB044B196828C9AEB0@IU-MSSG-MBX104.ads.iu.edu>
	<loom.20120211T090340-743@post.gmane.org>
	<4F36AB77.2090706@pburns.seanet.com>
Message-ID: <CANVKczO3xf6qok8CjKJEZ5Lnotq6OxB4J7vAmD01M0QWoh_+wg@mail.gmail.com>

On Sat, Feb 11, 2012 at 5:55 PM, Patrick Burns <pburns at pburns.seanet.com> wrote:

> Now it could be that people are not trying
> very hard to solve their own problems, but
> to be fair it is a pretty gruelling process
> to find the Task Views.
>
> May I suggest that there be a "Task Views" item
> on the left sidebar of the R website in the
> Documentation section?
>

 I'd go further, and suggest that the list of Task Views appears on
the home page of www.r-project.org under the heading "Look at all
these things you can do with R". (Maybe to replace the 8 year old
clustering graphic (or maybe someone could do something in ggplot2
that looks nice n shiny?) )

 "Task Views" (stupid name, who's idea was that?) are an absolute GEM
and shouldn't be slotted between 'What's New?' and "Search" on CRAN
mirror sites. The CRAN Task Views page doesn't even say what "Task
Views" are. Here's some text that might help:

 "Task Views are short documents outlining the functionality of R in a
given field or methodology. Since most of R's power comes from add-on
packages downloaded from CRAN, Task Views tend to concentrate on
summarising the packages that are relevant. If you ever find yourself
thinking 'how do I do X in R?' then the list of Task Views should be
your first stop."

Barry


From murdoch.duncan at gmail.com  Mon Feb 13 00:56:10 2012
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 12 Feb 2012 18:56:10 -0500
Subject: [Rd] Task views
In-Reply-To: <CANVKczO3xf6qok8CjKJEZ5Lnotq6OxB4J7vAmD01M0QWoh_+wg@mail.gmail.com>
References: <0ABCA2ECCCA5B34DA18927BB044B196828C9AEB0@IU-MSSG-MBX104.ads.iu.edu>
	<loom.20120211T090340-743@post.gmane.org>
	<4F36AB77.2090706@pburns.seanet.com>
	<CANVKczO3xf6qok8CjKJEZ5Lnotq6OxB4J7vAmD01M0QWoh_+wg@mail.gmail.com>
Message-ID: <4F38519A.7070503@gmail.com>

On 12-02-12 5:43 AM, Barry Rowlingson wrote:
> On Sat, Feb 11, 2012 at 5:55 PM, Patrick Burns<pburns at pburns.seanet.com>  wrote:
>
>> Now it could be that people are not trying
>> very hard to solve their own problems, but
>> to be fair it is a pretty gruelling process
>> to find the Task Views.
>>
>> May I suggest that there be a "Task Views" item
>> on the left sidebar of the R website in the
>> Documentation section?
>>
>
>   I'd go further, and suggest that the list of Task Views appears on
> the home page of www.r-project.org under the heading "Look at all
> these things you can do with R". (Maybe to replace the 8 year old
> clustering graphic (or maybe someone could do something in ggplot2
> that looks nice n shiny?) )
>
>   "Task Views" (stupid name, who's idea was that?) are an absolute GEM
> and shouldn't be slotted between 'What's New?' and "Search" on CRAN
> mirror sites. The CRAN Task Views page doesn't even say what "Task
> Views" are. Here's some text that might help:
>
>   "Task Views are short documents outlining the functionality of R in a
> given field or methodology. Since most of R's power comes from add-on
> packages downloaded from CRAN, Task Views tend to concentrate on
> summarising the packages that are relevant. If you ever find yourself
> thinking 'how do I do X in R?' then the list of Task Views should be
> your first stop."

One difficulty we have is the ancient HTML used on both www and CRAN. 
The main www site is not mirrored, but CRAN is.  A link to 
CRAN.r-project.org always goes to the main site, and there's some 
reluctance to advertise that:  it kind of defeats the load balancing 
that the mirrors are intended to do.

I'm sure the R community has hundreds of members who could provide the 
code to link from the www page to a geographically appropriate CRAN 
mirror.  Would someone care to offer it?

Duncan Murdoch


From slava.razbash at gmail.com  Mon Feb 13 07:51:31 2012
From: slava.razbash at gmail.com (Slava Razbash)
Date: Mon, 13 Feb 2012 17:51:31 +1100
Subject: [Rd] Can I use "..." in parallel:::clusterApplyLB?
Message-ID: <CANYYcsL3UG=QbnetyV00ok-OWUotdMp0PmFFzRL_GEL2kNDquA@mail.gmail.com>

Hello,

Can I do the following? Is parallel:::clusterApplyLB() designed to
work like this? The code below is for illustrative purposes only.

library(parallel)

myFunction<-function(myPar1, myPar2, ...) {

    clusterApplyLB(myCluster, x, otherFunction, otherPar1=myPar1,
otherPar2=myPar2, ....)


}


otherFunction<-function(otherPar1, otherPar2, ...) {

   someFunction(somePar1, ....)

}


someFunction<-function(somePar1, somePar2=NULL, somePar3=someVal) {

   ##Do some stuff


}


myFunction( myVal1, myVal2, somePar2=myVal3, somePar3=myVal4)



The intention is that myVal3 and myVal4 get passed to someFunction()
through clusterApplyLB if they are specified.


Best Regards,

Slava


From r.m.krug at gmail.com  Mon Feb 13 09:31:46 2012
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Mon, 13 Feb 2012 09:31:46 +0100
Subject: [Rd] [R] Version control (git, mercurial) for R packages
In-Reply-To: <42870113.3HDWH6xair@prle>
References: <CA+hbrhWcgynWvDWMCL4ozv3W3q0pn0Tddyo3F4RO5=gJ0e8OGQ@mail.gmail.com>
	<CABdHhvHCE0RjUCxNWpZtQjuRfQ+8bh0F5xEjGRG6MSyeSQLCRw@mail.gmail.com>
	<4F34D137.8030808@gmail.com> <42870113.3HDWH6xair@prle>
Message-ID: <4F38CA72.80906@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 10/02/12 22:05, Davor Cubranic wrote:
> On February 10, 2012 09:11:35 AM Rainer M Krug wrote:
>> But what I was thinking about (in my other post as well) is to
>> include github (or any other git repo provider) into r-forge for
>> the automatic creation of packages.
>> 
>> So is there an easy way to kind of push a certain revision up to 
>> r-forge to have the automatic builds? One could do it manualy,
>> but automatic would be so much nicer.
> 
> With Git, it is possible to add a remote branch that points to a
> Subversion repository. That way, you do your work on Github, and
> when you're ready to release, just push your changes to R-Forge
> SVN.
> 
> Details: http://cameron.bracken.bz/git-with-r-forge
> 
> Davor

Thanks - then I'll look into it again - hope I'll understand it this time.

Cheers,

Rainer


- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk84ynEACgkQoYgNqgF2egqsOgCeOUeo0asKMn59eDaO0l/gzZyU
Nd0AoIGo96eBbV+01ymBmrxN3s5I2we0
=kaBh
-----END PGP SIGNATURE-----


From ripley at stats.ox.ac.uk  Mon Feb 13 09:54:24 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 13 Feb 2012 08:54:24 +0000
Subject: [Rd] Can I use "..." in parallel:::clusterApplyLB?
In-Reply-To: <CANYYcsL3UG=QbnetyV00ok-OWUotdMp0PmFFzRL_GEL2kNDquA@mail.gmail.com>
References: <CANYYcsL3UG=QbnetyV00ok-OWUotdMp0PmFFzRL_GEL2kNDquA@mail.gmail.com>
Message-ID: <4F38CFC0.5050909@stats.ox.ac.uk>

On 13/02/2012 06:51, Slava Razbash wrote:
> Hello,
>
> Can I do the following? Is parallel:::clusterApplyLB() designed to
> work like this? The code below is for illustrative purposes only.

It is designed to work with standard R semantics.  For ... those are 
quite complex, and you may have to force evaluation before sending to 
the workers: that is easy to do, and there are examples in package boot.


> library(parallel)
>
> myFunction<-function(myPar1, myPar2, ...) {
>
>      clusterApplyLB(myCluster, x, otherFunction, otherPar1=myPar1,
> otherPar2=myPar2, ....)
>
>
> }
>
>
> otherFunction<-function(otherPar1, otherPar2, ...) {
>
>     someFunction(somePar1, ....)
>
> }

Well, that will not work.  See what the posting guide has to say about 
reproducible examples.

>
> someFunction<-function(somePar1, somePar2=NULL, somePar3=someVal) {
>
>     ##Do some stuff
>
>
> }
>
>
> myFunction( myVal1, myVal2, somePar2=myVal3, somePar3=myVal4)
>
>
>
> The intention is that myVal3 and myVal4 get passed to someFunction()
> through clusterApplyLB if they are specified.
>
>
> Best Regards,
>
> Slava
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From pburns at pburns.seanet.com  Mon Feb 13 10:32:49 2012
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Mon, 13 Feb 2012 09:32:49 +0000
Subject: [Rd] Task views
In-Reply-To: <CANVKczO3xf6qok8CjKJEZ5Lnotq6OxB4J7vAmD01M0QWoh_+wg@mail.gmail.com>
References: <0ABCA2ECCCA5B34DA18927BB044B196828C9AEB0@IU-MSSG-MBX104.ads.iu.edu>
	<loom.20120211T090340-743@post.gmane.org>
	<4F36AB77.2090706@pburns.seanet.com>
	<CANVKczO3xf6qok8CjKJEZ5Lnotq6OxB4J7vAmD01M0QWoh_+wg@mail.gmail.com>
Message-ID: <4F38D8C1.8090209@pburns.seanet.com>

I feel compelled to rebuff Barry's
attack on the word "Task Views".
I think it is a fine description (I
was not involved in originating it),
though of course I'd be open to better
suggestions.

"Look at all these things you can do with R"
is also nice but lacks a certain amount
of brevity.

Pat

On 12/02/2012 10:43, Barry Rowlingson wrote:
> On Sat, Feb 11, 2012 at 5:55 PM, Patrick Burns<pburns at pburns.seanet.com>  wrote:
>
>> Now it could be that people are not trying
>> very hard to solve their own problems, but
>> to be fair it is a pretty gruelling process
>> to find the Task Views.
>>
>> May I suggest that there be a "Task Views" item
>> on the left sidebar of the R website in the
>> Documentation section?
>>
>
>   I'd go further, and suggest that the list of Task Views appears on
> the home page of www.r-project.org under the heading "Look at all
> these things you can do with R". (Maybe to replace the 8 year old
> clustering graphic (or maybe someone could do something in ggplot2
> that looks nice n shiny?) )
>
>   "Task Views" (stupid name, who's idea was that?) are an absolute GEM
> and shouldn't be slotted between 'What's New?' and "Search" on CRAN
> mirror sites. The CRAN Task Views page doesn't even say what "Task
> Views" are. Here's some text that might help:
>
>   "Task Views are short documents outlining the functionality of R in a
> given field or methodology. Since most of R's power comes from add-on
> packages downloaded from CRAN, Task Views tend to concentrate on
> summarising the packages that are relevant. If you ever find yourself
> thinking 'how do I do X in R?' then the list of Task Views should be
> your first stop."
>
> Barry
>

-- 
Patrick Burns
pburns at pburns.seanet.com
twitter: @portfolioprobe
http://www.portfolioprobe.com/blog
http://www.burns-stat.com
(home of 'Some hints for the R beginner'
and 'The R Inferno')


From Thorn.Thaler at rdls.nestle.com  Mon Feb 13 12:59:37 2012
From: Thorn.Thaler at rdls.nestle.com (Thaler,Thorn,LAUSANNE,Applied Mathematics)
Date: Mon, 13 Feb 2012 12:59:37 +0100
Subject: [Rd] Overwrite S3 methond from base package
Message-ID: <F54EF8F1B477CF448729593FE421F6466EDD5A@HQVEVE0032.nestle.com>

Dear all,

I am developing a package, which bundles my most frequently used
functions. One of those is a modified version of droplevels from the
base package (basically, it preserves any contrast function which was
used to create the factor, contrast matrices are not kept, for they
could be wrong if a level is dropped).

In my NAMESPACE file I've the following directives, which should export
my methods:

S3method(droplevels, factor)
S3method(droplevels, data.frame)

However, when I load my package and I try to use those functions, the
dispatching mechanism calls the functions droplevels.factor and
droplevels.data.frame from the _base package_.

So, is there any way to overwrite droplevels.factor and
droplevels.data.frame from the base package with my functions? Or do I
have to create a generic function on my own?

Thanks for your help.

Kind Regards,

Thorn


From mauricio.zambrano at jrc.ec.europa.eu  Mon Feb 13 17:30:50 2012
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Mon, 13 Feb 2012 17:30:50 +0100
Subject: [Rd] requesting a new SIG mailing list
Message-ID: <4F393ABA.4020806@jrc.ec.europa.eu>

Dear R developers,

Due to the increasing use R in hydrology and other close-related 
environmental sciences, I would like to ask if it would be possible to 
create a new Special Interest Group mailing list, called 'R-sig-hydro', 
specially devoted those topics. If possible to do so, I'd offer myself 
to maintain such mailing list (if needed).


Thanks in advance,

Mauricio Zambrano-Bigiarini

-- 
=======================================================
FLOODS Action
Water Resources Unit (H01)
Institute for Environment and Sustainability (IES)
European Commission, Joint Research Centre (JRC)
webinfo    : http://floods.jrc.ec.europa.eu/
=======================================================
DISCLAIMER:\ "The views expressed are purely those of th...{{dropped:10}}


From pburns at pburns.seanet.com  Mon Feb 13 18:18:09 2012
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Mon, 13 Feb 2012 17:18:09 +0000
Subject: [Rd] Overwrite S3 methond from base package
In-Reply-To: <F54EF8F1B477CF448729593FE421F6466EDD5A@HQVEVE0032.nestle.com>
References: <F54EF8F1B477CF448729593FE421F6466EDD5A@HQVEVE0032.nestle.com>
Message-ID: <4F3945D1.2040904@pburns.seanet.com>

The key question is:

 > So, is there any way to overwrite droplevels.factor and
 > droplevels.data.frame from the base package with my functions?

There is "can" and there is "should".

I don't know the answer to "can".

In regard to "should", I think it is a
very very bad idea.

The result that someone gets depends on
whether or not the new package is attached
in the session.  That is a recipe for hours
(or days) of trying to figure out mysterious
behavior.

Much better, I think, is to create a new
generic.

Pat


On 13/02/2012 11:59, Thaler,Thorn,LAUSANNE,Applied Mathematics wrote:
> Dear all,
>
> I am developing a package, which bundles my most frequently used
> functions. One of those is a modified version of droplevels from the
> base package (basically, it preserves any contrast function which was
> used to create the factor, contrast matrices are not kept, for they
> could be wrong if a level is dropped).
>
> In my NAMESPACE file I've the following directives, which should export
> my methods:
>
> S3method(droplevels, factor)
> S3method(droplevels, data.frame)
>
> However, when I load my package and I try to use those functions, the
> dispatching mechanism calls the functions droplevels.factor and
> droplevels.data.frame from the _base package_.
>
> So, is there any way to overwrite droplevels.factor and
> droplevels.data.frame from the base package with my functions? Or do I
> have to create a generic function on my own?
>
> Thanks for your help.
>
> Kind Regards,
>
> Thorn
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Patrick Burns
pburns at pburns.seanet.com
twitter: @portfolioprobe
http://www.portfolioprobe.com/blog
http://www.burns-stat.com
(home of 'Some hints for the R beginner'
and 'The R Inferno')


From Thorn.Thaler at rdls.nestle.com  Tue Feb 14 08:12:42 2012
From: Thorn.Thaler at rdls.nestle.com (Thaler,Thorn,LAUSANNE,Applied Mathematics)
Date: Tue, 14 Feb 2012 08:12:42 +0100
Subject: [Rd] Overwrite S3 methond from base package
In-Reply-To: <4F3945D1.2040904@pburns.seanet.com>
References: <F54EF8F1B477CF448729593FE421F6466EDD5A@HQVEVE0032.nestle.com>
	<4F3945D1.2040904@pburns.seanet.com>
Message-ID: <F54EF8F1B477CF448729593FE421F6466EDDBE@HQVEVE0032.nestle.com>

> In regard to "should", I think it is a
> very very bad idea.
> 
> The result that someone gets depends on
> whether or not the new package is attached
> in the session.  That is a recipe for hours
> (or days) of trying to figure out mysterious
> behavior.

I fully agree. However, there are 2 reasons in this particular case, why
I decided nevertheless to be "evil":

1. The package will never (well, never say never, but from today's point
of view I see no reason, why this should ever happen) be published and
is intended for internal use only. 
2. Even more important: I think that 'droplevels' in the base package
has a major flaw as it silently drops any contrast chosen by the user.
Hence, a user who wants to use droplevels, has to reassign all contrasts
afterwards. In another discussion it was pointed out, that contrasts
which worked fine for a factor, may be erroneous once a level is dropped
(in the case we specify the contrasts matrix directly). I acknowledge
this case (and so does my function as it falls back to the base version
but issues a warning), yet I think for all the other cases, where the
contrast is defined via a function, it would be the better behaviour to
use the same contrast function rather than dropping it silently. As a
consequence, I think that my function does no harm, for it does exactly
the same as the base function while adding more functionality. Thus,
even if the user is used to the annoying behaviour of base::droplevels
and reassigns the contrast after each use of droplevels, he will see no
difference whether or not my package is loaded. In the former case the
step is however not necessary.

For the "how" part, I find out that I have to explicitly export my
functions such that they can override the ones from the base package.
Thus the solution was to add

export(droplevels.factor, droplevels.data.frame)

to my NAMESPACE file.

Thanks for your input,

-Thorn


From r.m.krug at gmail.com  Tue Feb 14 09:36:36 2012
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Tue, 14 Feb 2012 09:36:36 +0100
Subject: [Rd] requesting a new SIG mailing list
In-Reply-To: <4F393ABA.4020806@jrc.ec.europa.eu>
References: <4F393ABA.4020806@jrc.ec.europa.eu>
Message-ID: <4F3A1D14.1050909@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 13/02/12 17:30, Mauricio Zambrano-Bigiarini wrote:
> Dear R developers,
> 
> Due to the increasing use R in hydrology and other close-related 
> environmental sciences, I would like to ask if it would be possible
> to create a new Special Interest Group mailing list, called
> 'R-sig-hydro', specially devoted those topics. If possible to do
> so, I'd offer myself to maintain such mailing list (if needed).

I think it would be more useful to use the R-sig-geo for that, as
hydrology (please correct me if I am wrong - I am not an expert in
hydrology) is mainly spatial.

A fragmentation of the lists would need to duplicate effort by members.

Cheers,

Rainer


> 
> 
> Thanks in advance,
> 
> Mauricio Zambrano-Bigiarini
> 


- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk86HRQACgkQoYgNqgF2egp1pwCfXrUJEBhQ8+50iwv7iYEZXa1C
7l4Anj9EmGCL3QE61VGZ/bw+/3r8n5b4
=bVRp
-----END PGP SIGNATURE-----


From mauricio.zambrano at jrc.ec.europa.eu  Tue Feb 14 17:31:45 2012
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Tue, 14 Feb 2012 17:31:45 +0100
Subject: [Rd] requesting a new SIG mailing list
In-Reply-To: <4F3A1D14.1050909@gmail.com>
References: <4F393ABA.4020806@jrc.ec.europa.eu> <4F3A1D14.1050909@gmail.com>
Message-ID: <4F3A8C71.4000407@jrc.ec.europa.eu>

On 14/02/12 09:36, Rainer M Krug wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> On 13/02/12 17:30, Mauricio Zambrano-Bigiarini wrote:
>> Dear R developers,
>>
>> Due to the increasing use R in hydrology and other close-related
>> environmental sciences, I would like to ask if it would be possible
>> to create a new Special Interest Group mailing list, called
>> 'R-sig-hydro', specially devoted those topics. If possible to do
>> so, I'd offer myself to maintain such mailing list (if needed).
>
> I think it would be more useful to use the R-sig-geo for that, as
> hydrology (please correct me if I am wrong - I am not an expert in
> hydrology) is mainly spatial.
>
> A fragmentation of the lists would need to duplicate effort by members.

I don't want to duplicate efforts, but I'm not sure about R-sig-geo as 
the right mailing list for hydrology and close-related environmental 
sciences.

It is true that hydrology has much to do with spatial analysis 
(interpolation techniques, use of satellite images as input for 
hydrological models, mapping, etc), but it has also a strong link to 
time series analysis (trend detection, stationary and non-stationary 
water quantity and quality modelling, climate change modelling, and a 
long etc), and probably the latter topics would be considered off-topic 
in the R-sig-geo

Another possibility could be to use the R-sig-ecology, which seems to be 
more related to hydrology:

"analytical techniques and topics that are appropriate for discussion on 
R-sig-ecology are quite broad. For examples of what might be appropriate 
for discussion on this list, please see the Environmentrics Task View 
(http://cran.r-project.org/web/views/Environmetrics.html)"
(taken from: https://stat.ethz.ch/mailman/listinfo/r-sig-ecology)

However, I did a quick search on the archives of 'R-sig-ecology' for the 
year 2011, and I could only found one single mail related to hydrology:

https://stat.ethz.ch/pipermail/r-sig-ecology/2011-July/002274.html

(in the same search I couldn't find any single reference to hydrology in 
the R-sig-geo during the year 2011)

I think the lack of posts related to hydrological sciences in dedicated 
R-sig-xxx mailing lists is not due to a lack of interest (in the same 
period I got several questions regarding the hydroTSM and hydroGOF 
packages), but they may be due to the fact that r-sig-geo or 
r-sig-ecology are not very intuitive for hydrologists....

So, if you think that creating a new mailing list only for hydrology and 
related sciences could lead to fragmentation of the community and a 
duplication of efforts, we could start using the 'R-sig-ecology' mailing 
list.

Cheers,


Mauricio Zambrano-Bigiarini

-- 
=======================================================
FLOODS Action
Water Resources Unit (H01)
Institute for Environment and Sustainability (IES)
European Commission, Joint Research Centre (JRC)
TP 261, Via Enrico Fermi 2749, 21027 Ispra (VA), Italy
webinfo    : http://floods.jrc.ec.europa.eu/
=======================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as stating
an official position of the European Commission."
=======================================================
Linux user #454569 -- Ubuntu user #17469
=======================================================
"The greatest inspiration is often born of desperation."
(Comer Cotrell)




> Cheers,
>
> Rainer
>
>
>>
>>
>> Thanks in advance,
>>
>> Mauricio Zambrano-Bigiarini
>>
>
>
> - --
> Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
> Biology, UCT), Dipl. Phys. (Germany)
>
> Centre of Excellence for Invasion Biology
> Stellenbosch University
> South Africa
>
> Tel :       +33 - (0)9 53 10 27 44
> Cell:       +33 - (0)6 85 62 59 98
> Fax :       +33 - (0)9 58 10 27 44
>
> Fax (D):    +49 - (0)3 21 21 25 22 44
>
> email:      Rainer at krugs.de
>
> Skype:      RMkrug
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.11 (GNU/Linux)
> Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
>
> iEYEARECAAYFAk86HRQACgkQoYgNqgF2egp1pwCfXrUJEBhQ8+50iwv7iYEZXa1C
> 7l4Anj9EmGCL3QE61VGZ/bw+/3r8n5b4
> =bVRp
> -----END PGP SIGNATURE-----
>


From james.foadi at diamond.ac.uk  Tue Feb 14 17:43:03 2012
From: james.foadi at diamond.ac.uk (james.foadi at diamond.ac.uk)
Date: Tue, 14 Feb 2012 16:43:03 +0000
Subject: [Rd] method using several (and different) arguments in turn
Message-ID: <DDDDFD4A9D76184F8562ACE0629AD471121B9D28@EXCHMBX03.fed.cclrc.ac.uk>

Dear R-developers community, I have the following generic:

setGeneric(
                   name="newsample",
                   def=function(x,y,z,a,b,c,...){standardGeneric("newsample")}

And I can build several methods for this generic. One useful thing is to use "newsample"
with only one of the 6 arguments listed. At the moment this is what I do:

setMethod(
                   f="newsample",
                   signature=c("missing","missing","numeric","missing","missing","missing"),
                   function(x,y,z,a,b,c,...)
                   {
                       ..............................
                       ..............................

                    }
                    )

This would be used when the single argument is z:

newsample(z=12.5)

To use newsample with another argument (say x) I should implement the same as before,
but with signature c("numeric","missing","missing","missing","missing","missing").
Is there another shorter and easier way to do this?


J

-- 
This e-mail and any attachments may contain confidential...{{dropped:8}}


From ripley at stats.ox.ac.uk  Tue Feb 14 17:45:58 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 14 Feb 2012 16:45:58 +0000
Subject: [Rd] requesting a new SIG mailing list
In-Reply-To: <4F3A8C71.4000407@jrc.ec.europa.eu>
References: <4F393ABA.4020806@jrc.ec.europa.eu> <4F3A1D14.1050909@gmail.com>
	<4F3A8C71.4000407@jrc.ec.europa.eu>
Message-ID: <4F3A8FC6.3030903@stats.ox.ac.uk>

Have you asked the maintainers of those lists?  Or the person who would 
have to do the work to set the list up (Martin Maechler, who is 
currently on vacation, or colleagues at ETHZ)?

My suspicion is that there would be too little traffic to make a 
separate list worthwhile to administer.  (You might feel so too: list 
administrators end up dealing with a lot of nuisance traffic.)

On 14/02/2012 16:31, Mauricio Zambrano-Bigiarini wrote:
> On 14/02/12 09:36, Rainer M Krug wrote:
>> -----BEGIN PGP SIGNED MESSAGE-----
>> Hash: SHA1
>>
>> On 13/02/12 17:30, Mauricio Zambrano-Bigiarini wrote:
>>> Dear R developers,
>>>
>>> Due to the increasing use R in hydrology and other close-related
>>> environmental sciences, I would like to ask if it would be possible
>>> to create a new Special Interest Group mailing list, called
>>> 'R-sig-hydro', specially devoted those topics. If possible to do
>>> so, I'd offer myself to maintain such mailing list (if needed).
>>
>> I think it would be more useful to use the R-sig-geo for that, as
>> hydrology (please correct me if I am wrong - I am not an expert in
>> hydrology) is mainly spatial.
>>
>> A fragmentation of the lists would need to duplicate effort by members.
>
> I don't want to duplicate efforts, but I'm not sure about R-sig-geo as
> the right mailing list for hydrology and close-related environmental
> sciences.
>
> It is true that hydrology has much to do with spatial analysis
> (interpolation techniques, use of satellite images as input for
> hydrological models, mapping, etc), but it has also a strong link to
> time series analysis (trend detection, stationary and non-stationary
> water quantity and quality modelling, climate change modelling, and a
> long etc), and probably the latter topics would be considered off-topic
> in the R-sig-geo
>
> Another possibility could be to use the R-sig-ecology, which seems to be
> more related to hydrology:
>
> "analytical techniques and topics that are appropriate for discussion on
> R-sig-ecology are quite broad. For examples of what might be appropriate
> for discussion on this list, please see the Environmentrics Task View
> (http://cran.r-project.org/web/views/Environmetrics.html)"
> (taken from: https://stat.ethz.ch/mailman/listinfo/r-sig-ecology)
>
> However, I did a quick search on the archives of 'R-sig-ecology' for the
> year 2011, and I could only found one single mail related to hydrology:
>
> https://stat.ethz.ch/pipermail/r-sig-ecology/2011-July/002274.html
>
> (in the same search I couldn't find any single reference to hydrology in
> the R-sig-geo during the year 2011)
>
> I think the lack of posts related to hydrological sciences in dedicated
> R-sig-xxx mailing lists is not due to a lack of interest (in the same
> period I got several questions regarding the hydroTSM and hydroGOF
> packages), but they may be due to the fact that r-sig-geo or
> r-sig-ecology are not very intuitive for hydrologists....
>
> So, if you think that creating a new mailing list only for hydrology and
> related sciences could lead to fragmentation of the community and a
> duplication of efforts, we could start using the 'R-sig-ecology' mailing
> list.
>
> Cheers,
>
>
> Mauricio Zambrano-Bigiarini
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From mtmorgan at fhcrc.org  Tue Feb 14 18:00:04 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Tue, 14 Feb 2012 09:00:04 -0800
Subject: [Rd] method using several (and different) arguments in turn
In-Reply-To: <DDDDFD4A9D76184F8562ACE0629AD471121B9D28@EXCHMBX03.fed.cclrc.ac.uk>
References: <DDDDFD4A9D76184F8562ACE0629AD471121B9D28@EXCHMBX03.fed.cclrc.ac.uk>
Message-ID: <4F3A9314.5020300@fhcrc.org>

On 02/14/2012 08:43 AM, james.foadi at diamond.ac.uk wrote:
> Dear R-developers community, I have the following generic:
>
> setGeneric(
>                     name="newsample",
>                     def=function(x,y,z,a,b,c,...){standardGeneric("newsample")}
>
> And I can build several methods for this generic. One useful thing is to use "newsample"
> with only one of the 6 arguments listed. At the moment this is what I do:
>
> setMethod(
>                     f="newsample",
>                     signature=c("missing","missing","numeric","missing","missing","missing"),
>                     function(x,y,z,a,b,c,...)
>                     {
>                         ..............................
>                         ..............................
>
>                      }
>                      )
>
> This would be used when the single argument is z:
>
> newsample(z=12.5)
>
> To use newsample with another argument (say x) I should implement the same as before,
> but with signature c("numeric","missing","missing","missing","missing","missing").
> Is there another shorter and easier way to do this?

Hi James --

A matter of opinion, but multiple dispatch like this can be very 
complicated, e.g., figuring out the 'next' method when dispatching on 
two or more arguments; I'd really discourage it.

A different approach, assuming that x, y, z, ... are all numeric() but 
that the sample to be drawn differs, is to define a small class 
hierarchy to be used for dispatch.

   setClass("TypeOfSample")

   setClass("XSample", contains="TypeOfSample")
   XSample <- new("XSample")  ## a 'singleton', used for dispatch

   setClass("YSample", contains="TypeOfSample")
   YSample <- new("YSample")

and then

   setGeneric("newsample",
       function(type, x=numeric(), ...) standardGeneric("newsample"),
       signature="type")

   setMethod("newsample", "XSample", function(type, x=numeric(), ...) {
       "XSample"
   })

   setMethod("newsample", "YSample", function(type, x=numeric(), ...) {
       "YSample"
   })

One could implement a default method on "TypeOfSample", and use 
callNextMethod() after initial transformation, if that were the pattern.

To use:

   newsample(XSample, x=1:100)

Martin

>
>
> J
>


-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From mauricio.zambrano at jrc.ec.europa.eu  Tue Feb 14 18:14:49 2012
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Tue, 14 Feb 2012 18:14:49 +0100
Subject: [Rd] requesting a new SIG mailing list
In-Reply-To: <4F3A8FC6.3030903@stats.ox.ac.uk>
References: <4F393ABA.4020806@jrc.ec.europa.eu> <4F3A1D14.1050909@gmail.com>
	<4F3A8C71.4000407@jrc.ec.europa.eu> <4F3A8FC6.3030903@stats.ox.ac.uk>
Message-ID: <4F3A9689.1030507@jrc.ec.europa.eu>

On 14/02/12 17:45, Prof Brian Ripley wrote:
> Have you asked the maintainers of those lists? Or the person who would
> have to do the work to set the list up (Martin Maechler, who is
> currently on vacation, or colleagues at ETHZ)?

No, I haven't done yet, but I'll do it, to know which list is the right 
one for hydrology.

>
> My suspicion is that there would be too little traffic to make a
> separate list worthwhile to administer. (You might feel so too: list
> administrators end up dealing with a lot of nuisance traffic.)

Probably you are right, and it is worth to wait until the traffic in 
some of those lists be enough to justify a different mailing list.

Thank you very much for your feedback prof. Ripley.


All the best,

Mauricio Zambrano-Bigiarini

-- 
=======================================================
FLOODS Action
Water Resources Unit (H01)
Institute for Environment and Sustainability (IES)
European Commission, Joint Research Centre (JRC)
TP 261, Via Enrico Fermi 2749, 21027 Ispra (VA), Italy
webinfo    : http://floods.jrc.ec.europa.eu/
=======================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as stating
an official position of the European Commission."
=======================================================
Linux user #454569 -- Ubuntu user #17469
=======================================================

>
> On 14/02/2012 16:31, Mauricio Zambrano-Bigiarini wrote:
>> On 14/02/12 09:36, Rainer M Krug wrote:
>>> -----BEGIN PGP SIGNED MESSAGE-----
>>> Hash: SHA1
>>>
>>> On 13/02/12 17:30, Mauricio Zambrano-Bigiarini wrote:
>>>> Dear R developers,
>>>>
>>>> Due to the increasing use R in hydrology and other close-related
>>>> environmental sciences, I would like to ask if it would be possible
>>>> to create a new Special Interest Group mailing list, called
>>>> 'R-sig-hydro', specially devoted those topics. If possible to do
>>>> so, I'd offer myself to maintain such mailing list (if needed).
>>>
>>> I think it would be more useful to use the R-sig-geo for that, as
>>> hydrology (please correct me if I am wrong - I am not an expert in
>>> hydrology) is mainly spatial.
>>>
>>> A fragmentation of the lists would need to duplicate effort by members.
>>
>> I don't want to duplicate efforts, but I'm not sure about R-sig-geo as
>> the right mailing list for hydrology and close-related environmental
>> sciences.
>>
>> It is true that hydrology has much to do with spatial analysis
>> (interpolation techniques, use of satellite images as input for
>> hydrological models, mapping, etc), but it has also a strong link to
>> time series analysis (trend detection, stationary and non-stationary
>> water quantity and quality modelling, climate change modelling, and a
>> long etc), and probably the latter topics would be considered off-topic
>> in the R-sig-geo
>>
>> Another possibility could be to use the R-sig-ecology, which seems to be
>> more related to hydrology:
>>
>> "analytical techniques and topics that are appropriate for discussion on
>> R-sig-ecology are quite broad. For examples of what might be appropriate
>> for discussion on this list, please see the Environmentrics Task View
>> (http://cran.r-project.org/web/views/Environmetrics.html)"
>> (taken from: https://stat.ethz.ch/mailman/listinfo/r-sig-ecology)
>>
>> However, I did a quick search on the archives of 'R-sig-ecology' for the
>> year 2011, and I could only found one single mail related to hydrology:
>>
>> https://stat.ethz.ch/pipermail/r-sig-ecology/2011-July/002274.html
>>
>> (in the same search I couldn't find any single reference to hydrology in
>> the R-sig-geo during the year 2011)
>>
>> I think the lack of posts related to hydrological sciences in dedicated
>> R-sig-xxx mailing lists is not due to a lack of interest (in the same
>> period I got several questions regarding the hydroTSM and hydroGOF
>> packages), but they may be due to the fact that r-sig-geo or
>> r-sig-ecology are not very intuitive for hydrologists....
>>
>> So, if you think that creating a new mailing list only for hydrology and
>> related sciences could lead to fragmentation of the community and a
>> duplication of efforts, we could start using the 'R-sig-ecology' mailing
>> list.
>>
>> Cheers,
>>
>>
>> Mauricio Zambrano-Bigiarini
>>
>
>

"The greatest inspiration is often born of desperation."
(Comer Cotrell)


From sarah.goslee at gmail.com  Tue Feb 14 18:21:43 2012
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Tue, 14 Feb 2012 12:21:43 -0500
Subject: [Rd] requesting a new SIG mailing list
In-Reply-To: <4F3A8C71.4000407@jrc.ec.europa.eu>
References: <4F393ABA.4020806@jrc.ec.europa.eu> <4F3A1D14.1050909@gmail.com>
	<4F3A8C71.4000407@jrc.ec.europa.eu>
Message-ID: <CAM_vjunBbLcNA0nGP0FyqkL-h+ZwP6F45FEDiFA6GcxKr18+SQ@mail.gmail.com>

Hello,

I'm one of the maintainers of the r-sig-ecology list, and I think
it would be entirely appropriate to include hydrology within
the scope of the list.

There hasn't been much hydrologic discussion, as you noted,
but not because we wish to exclude it.

Sarah

On Tue, Feb 14, 2012 at 11:31 AM, Mauricio Zambrano-Bigiarini
<mauricio.zambrano at jrc.ec.europa.eu> wrote:

> Another possibility could be to use the R-sig-ecology, which seems to be
> more related to hydrology:
>
> "analytical techniques and topics that are appropriate for discussion on
> R-sig-ecology are quite broad. For examples of what might be appropriate for
> discussion on this list, please see the Environmentrics Task View
> (http://cran.r-project.org/web/views/Environmetrics.html)"
> (taken from: https://stat.ethz.ch/mailman/listinfo/r-sig-ecology)
>
> However, I did a quick search on the archives of 'R-sig-ecology' for the
> year 2011, and I could only found one single mail related to hydrology:
>
> https://stat.ethz.ch/pipermail/r-sig-ecology/2011-July/002274.html
>
> (in the same search I couldn't find any single reference to hydrology in the
> R-sig-geo during the year 2011)

-- 
Sarah Goslee
http://www.functionaldiversity.org


From james.foadi at diamond.ac.uk  Tue Feb 14 18:57:14 2012
From: james.foadi at diamond.ac.uk (james.foadi at diamond.ac.uk)
Date: Tue, 14 Feb 2012 17:57:14 +0000
Subject: [Rd] method using several (and different) arguments in turn
In-Reply-To: <4F3A9314.5020300@fhcrc.org>
References: <DDDDFD4A9D76184F8562ACE0629AD471121B9D28@EXCHMBX03.fed.cclrc.ac.uk>,
	<4F3A9314.5020300@fhcrc.org>
Message-ID: <DDDDFD4A9D76184F8562ACE0629AD471121BADD7@EXCHMBX03.fed.cclrc.ac.uk>

Dear Martin,
I could not entirely follow your suggestion.
I can see how you define two classes inheriting from TypeOfSample, and how these two
classes have two associated methods (incidentally, I'm unfamiliar with the:

           function(type,x=numeric(),...)to do.

J


expression. What is type?

But then I'm lost. I wouldn't know how to carry on from here. 

I don't know if I have explained the key point clear enough before. For the person using
"newsample" it makes sense which name (x or y or z, etc) is used. newsample(x=12.4) would
give something different from newsample(y=12.4); and yet another result would be obtained if
using a combination, like newsample(x=12.4,y=12.4).

I wanted to use a simple function with default values at first, but I'm in the middle of developing
a package using S4 formalism. I'm not sure this would be a wise thing 
________________________________________
Sent: 14 February 2012 17:00
To: Foadi, James (Imperial Coll.,RAL,DIA)
Cc: r-devel at r-project.org
Subject: Re: [Rd] method using several (and different) arguments in turn

On 02/14/2012 08:43 AM, james.foadi at diamond.ac.uk wrote:
> Dear R-developers community, I have the following generic:
>
> setGeneric(
>                     name="newsample",
>                     def=function(x,y,z,a,b,c,...){standardGeneric("newsample")}
>
> And I can build several methods for this generic. One useful thing is to use "newsample"
> with only one of the 6 arguments listed. At the moment this is what I do:
>
> setMethod(
>                     f="newsample",
>                     signature=c("missing","missing","numeric","missing","missing","missing"),
>                     function(x,y,z,a,b,c,...)
>                     {
>                         ..............................
>                         ..............................
>
>                      }
>                      )
>
> This would be used when the single argument is z:
>
> newsample(z=12.5)
>
> To use newsample with another argument (say x) I should implement the same as before,
> but with signature c("numeric","missing","missing","missing","missing","missing").
> Is there another shorter and easier way to do this?

Hi James --

A matter of opinion, but multiple dispatch like this can be very
complicated, e.g., figuring out the 'next' method when dispatching on
two or more arguments; I'd really discourage it.

A different approach, assuming that x, y, z, ... are all numeric() but
that the sample to be drawn differs, is to define a small class
hierarchy to be used for dispatch.

   setClass("TypeOfSample")

   setClass("XSample", contains="TypeOfSample")
   XSample <- new("XSample")  ## a 'singleton', used for dispatch

   setClass("YSample", contains="TypeOfSample")
   YSample <- new("YSample")

and then

   setGeneric("newsample",
       function(type, x=numeric(), ...) standardGeneric("newsample"),
       signature="type")

   setMethod("newsample", "XSample", function(type, x=numeric(), ...) {
       "XSample"
   })

   setMethod("newsample", "YSample", function(type, x=numeric(), ...) {
       "YSample"
   })

One could implement a default method on "TypeOfSample", and use
callNextMethod() after initial transformation, if that were the pattern.

To use:

   newsample(XSample, x=1:100)

Martin

>
>
> J
>


--
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793

-- 
This e-mail and any attachments may contain confidential...{{dropped:8}}


From rvaradhan at jhmi.edu  Wed Feb 15 05:30:16 2012
From: rvaradhan at jhmi.edu (Ravi Varadhan)
Date: Wed, 15 Feb 2012 04:30:16 +0000
Subject: [Rd] Task views
In-Reply-To: <4F38D8C1.8090209@pburns.seanet.com>
References: <0ABCA2ECCCA5B34DA18927BB044B196828C9AEB0@IU-MSSG-MBX104.ads.iu.edu>
	<loom.20120211T090340-743@post.gmane.org>
	<4F36AB77.2090706@pburns.seanet.com>
	<CANVKczO3xf6qok8CjKJEZ5Lnotq6OxB4J7vAmD01M0QWoh_+wg@mail.gmail.com>,
	<4F38D8C1.8090209@pburns.seanet.com>
Message-ID: <2F9EA67EF9AE1C48A147CB41BE2E15C316AD29@DOM-EB-MAIL2.win.ad.jhu.edu>

A couple of (lengthier!) suggestions: "topic-area resources" or "task-oriented resources"

Ravi
________________________________________
From: r-devel-bounces at r-project.org [r-devel-bounces at r-project.org] on behalf of Patrick Burns [pburns at pburns.seanet.com]
Sent: Monday, February 13, 2012 4:32 AM
To: Barry Rowlingson
Cc: Hans W Borchers; r-devel
Subject: Re: [Rd] Task views

I feel compelled to rebuff Barry's
attack on the word "Task Views".
I think it is a fine description (I
was not involved in originating it),
though of course I'd be open to better
suggestions.

"Look at all these things you can do with R"
is also nice but lacks a certain amount
of brevity.

Pat

On 12/02/2012 10:43, Barry Rowlingson wrote:
> On Sat, Feb 11, 2012 at 5:55 PM, Patrick Burns<pburns at pburns.seanet.com>  wrote:
>
>> Now it could be that people are not trying
>> very hard to solve their own problems, but
>> to be fair it is a pretty gruelling process
>> to find the Task Views.
>>
>> May I suggest that there be a "Task Views" item
>> on the left sidebar of the R website in the
>> Documentation section?
>>
>
>   I'd go further, and suggest that the list of Task Views appears on
> the home page of www.r-project.org under the heading "Look at all
> these things you can do with R". (Maybe to replace the 8 year old
> clustering graphic (or maybe someone could do something in ggplot2
> that looks nice n shiny?) )
>
>   "Task Views" (stupid name, who's idea was that?) are an absolute GEM
> and shouldn't be slotted between 'What's New?' and "Search" on CRAN
> mirror sites. The CRAN Task Views page doesn't even say what "Task
> Views" are. Here's some text that might help:
>
>   "Task Views are short documents outlining the functionality of R in a
> given field or methodology. Since most of R's power comes from add-on
> packages downloaded from CRAN, Task Views tend to concentrate on
> summarising the packages that are relevant. If you ever find yourself
> thinking 'how do I do X in R?' then the list of Task Views should be
> your first stop."
>
> Barry
>

--
Patrick Burns
pburns at pburns.seanet.com
twitter: @portfolioprobe
http://www.portfolioprobe.com/blog
http://www.burns-stat.com
(home of 'Some hints for the R beginner'
and 'The R Inferno')

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel

From jeroen.ooms at stat.ucla.edu  Wed Feb 15 07:05:29 2012
From: jeroen.ooms at stat.ucla.edu (Jeroen Ooms)
Date: Tue, 14 Feb 2012 22:05:29 -0800
Subject: [Rd] read.spss issues
Message-ID: <CABFfbXuC++xk=-98C=xFDrXHENa8fWOArstTnqqrz7Go4cfBSA@mail.gmail.com>

Someone supplied me with a small SPSS datafile that caused a buffer
overflow and then a crash when reading it in R. It seems like a pretty
serious issue to me. Unfortunately I can't supply the dataset at hand
and I have a hard time reproducing it with a toy example. But I found
at least 2 issues that might be related.

The first one is that when the spss dataset has a 'string' variable
that is longer than 200 characters, it generates a bunch of warnings
and then additional variables in the dataset. E.g:

library(foreign)
x <- read.spss("http://www.stat.ucla.edu/~jeroen/spss/longstring.sav");
str(x);

The second problem is that the spss dataformat allows to specify
'duplicate labels', whereas this is not allowed for factors. read.spss
does not deal with this and creates a bad factor

x <- read.spss("http://www.stat.ucla.edu/~jeroen/spss/duplicate_labels.sav",
use.value.labels=T);
levels(x$opinion);

which causes issues downstream. I am not sure if this is an issue in
read.spss() or as.factor(), but I guess it might be wise to try to
detect duplicate levels and assign them all with one and the same
integer value when converting to a factor.

Thank you,

Jeroen


From hkawakat at gmail.com  Wed Feb 15 14:03:18 2012
From: hkawakat at gmail.com (hkawakat at gmail.com)
Date: Wed, 15 Feb 2012 13:03:18 +0000
Subject: [Rd] help.search() in html?
Message-ID: <20120215130318.GA13405@euler.dcu.ie>

Hi,

I have options(help_type="html") in my .Rprofile and when I type
?foo, the man page appears as a new tab in my web browser (which is
already running). Fine. However, when I type ??foo, rather than the
results appearing in a new tab, a new instance of the web browser is
spawned with the default homepage displayed. Same with
help.search("foo"). Am I the only one seeing this? Is there some
setting/option that I am missing?
(At the moment, I bring up a man page via ?foo and then manually
follow the <Index> link at the bottom of the page to go up to the
search engine page.) R --vanilla shows the results of ??foo in the
terminal window as expected.

I am running
> sessionInfo()
R Under development (unstable) (2012-02-13 r58337)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8    
 [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8   
 [7] LC_PAPER=C                 LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

loaded via a namespace (and not attached):
[1] tools_2.15.0

h.
-- 
+---
| Hiroyuki Kawakatsu
| Business School, Dublin City University
| Dublin 9, Ireland. Tel +353 (0)1 700 7496


From lorenzo.lucido at asia.bnpparibas.com  Tue Feb 14 01:09:23 2012
From: lorenzo.lucido at asia.bnpparibas.com (Lorenzo)
Date: Mon, 13 Feb 2012 16:09:23 -0800 (PST)
Subject: [Rd] R CMD SHLIB in Windows XP - No output at all
Message-ID: <1329178163008-4385797.post@n4.nabble.com>

Hello all,

I'm trying hard to make R CMD SHLIB work on Windows XP (32-bit) - please
note that I don't have the admin rights on the computer.
In terms of setup, I have followed the procedure :
=> installed Rtools 2.14
=> changed my path :
PATH=C:\Trading\R\RTools\bin;C:\Trading\R\RTools\MinGW\bin;C:\Trading\R\R-2.14.1\bin\i386;C:\WINDOWS\system32;%OTHER_PATHS%

But when I try R CMD SHLIB *.* I have litterally nothing, no output at all.
(and R CMD INSTALL debug tells me, of course that the operation failed while
calling R CMD SHLIB)
I tried the command R CMD SHLIB -n, which gives me : 
make -f "C:/Trading/R/R-2.14.1/etc/i386/Makeconf" -f
"C:/Trading/R/R-2.14.1/share/make/winshlib.mk" SHLIB= OBJECTS= 

So I had a closer look at these two files, and found some strange things in
Makeconf, for example a variable LOCAL_SOFT with a d: path which has nothing
to do with my configuration :
LOCAL_SOFT = d:/RCompile/CRANpkg/extralibs/local

Ok, the thing is, my Makeconf is strange, but when I actually use the 
""" make -f "C:/Trading/R/R-2.14.1/etc/i386/Makeconf" -f
"C:/Trading/R/R-2.14.1/share/make/winshlib.mk" SHLIB= OBJECTS=  """ 
directly in the command prompt, it works more or less.
I managed to build a simple dll based on C code (convolve2.dll, from the
example), but couldn't build any dll based on c++ code.

Is my SHLIB properly set up ? Why do I have a strange Makeconf ? Should I
try to find a proper version of the file ? or reinstall R ?

Does anyone have any idea how to fix that ?
Been trying to fix it for a long time now !

Thanks in advance !

Lorenzo

--
View this message in context: http://r.789695.n4.nabble.com/R-CMD-SHLIB-in-Windows-XP-No-output-at-all-tp4385797p4385797.html
Sent from the R devel mailing list archive at Nabble.com.


From Friedrich.Leisch at boku.ac.at  Fri Feb 10 13:40:39 2012
From: Friedrich.Leisch at boku.ac.at (Friedrich Leisch)
Date: Fri, 10 Feb 2012 13:40:39 +0100
Subject: [Rd] Creating XML document extremely slow
In-Reply-To: <CAM+LvrA9pWspU2qTMf4dJTbxFZzS9waDLTbHtHU=0GiJYwD4dA@mail.gmail.com>
References: <CAM+LvrA9pWspU2qTMf4dJTbxFZzS9waDLTbHtHU=0GiJYwD4dA@mail.gmail.com>
Message-ID: <20277.4167.362367.846175@worblehat.boku.ac.at>

>>>>> On Fri, 10 Feb 2012 13:18:38 +0100,
>>>>> Titus von der Malsburg (TvdM) wrote:

  > Hi list,
  > I'm using the package XML to create a simple XML document.
  > Unfortunately constructing the XML tree is extremely slow.  My code
  > (see below) adds only about 100 nodes per second on an Intel i5
  > machine.  There's clearly something wrong but I don't see what.

Have you considered simply writing the XML using standard functions
like cat() and friends? That can be much faster than creating an XML
object and writing that out (have just done that to write exams into
our e-learning platform via XML).

Best,
Fritz


From lorenz at usgs.gov  Tue Feb 14 20:14:29 2012
From: lorenz at usgs.gov (David L Lorenz)
Date: Tue, 14 Feb 2012 13:14:29 -0600
Subject: [Rd] requesting a new SIG mailing list
In-Reply-To: <CAM_vjunBbLcNA0nGP0FyqkL-h+ZwP6F45FEDiFA6GcxKr18+SQ@mail.gmail.com>
References: <4F393ABA.4020806@jrc.ec.europa.eu>
	<4F3A1D14.1050909@gmail.com>	<4F3A8C71.4000407@jrc.ec.europa.eu>
	<CAM_vjunBbLcNA0nGP0FyqkL-h+ZwP6F45FEDiFA6GcxKr18+SQ@mail.gmail.com>
Message-ID: <OF12FFE926.89CF684A-ON862579A4.0068F4F0-862579A4.0069B2AC@usgs.gov>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120214/19f4548d/attachment.pl>

From reusser at pik-potsdam.de  Wed Feb 15 09:07:21 2012
From: reusser at pik-potsdam.de (Dominik Reusser)
Date: Wed, 15 Feb 2012 09:07:21 +0100
Subject: [Rd] requesting a new SIG mailing list
In-Reply-To: <OF12FFE926.89CF684A-ON862579A4.0068F4F0-862579A4.0069B2AC@usgs.gov>
References: <4F393ABA.4020806@jrc.ec.europa.eu>
	<CAM_vjunBbLcNA0nGP0FyqkL-h+ZwP6F45FEDiFA6GcxKr18+SQ@mail.gmail.com>
	<OF12FFE926.89CF684A-ON862579A4.0068F4F0-862579A4.0069B2AC@usgs.gov>
Message-ID: <201202150907.21227.reusser@pik-potsdam.de>

Dear all,
I do think that joining efforts is a good idea. However, hydrologists will 
probably not intuitively think about joining r-sig-ecology to discuss 
hydrological issues. Could we therefore explicitely state on the infopage that 
discussions to hydrology (in addition to general  environmental data) are also 
welcome.

I don't think it is worth it, but probably the appropriate name would then be 
r-sig-env for such a list? In the description, you are also refering to the 
Environmetrics task list.

I'm wondering where we can make people aware of the fact, that hydrological 
issues are discussed on r-sig-ecology. I'm going to ask Gavin Simpson to put 
references to the list on the environmetrics task view if you agree that this 
would be useful. Also, we can announce the mailing list during our R-short 
course on hydrology at EGU. What else?

Best regards!
Dominik



Am Dienstag, 14. Februar 2012 schrieb David L Lorenz:
> All,
>   Is it decided then? It does make sense to me, because much of the
> hydrologic work that we do is related to aquatic ecology.
>   I am responsible for coordinating the migration to use R as the
> supported statistical package within the Water Mission Area of the USGS.
> I'd expect that many of our hydrologists will be interested in subscribing
> to r-sig-ecology to keep up with fellow researchers. I am also sure that
> some will be frustrated because they will need to wade through material
> not directly related to their work.
>   When I hear r-sig-ecology will be the forum for hydrology, I'll notify
> the transition team so that they can subscribe and other hydrologist as
> they start to use R.
>   Thanks.
> Dave
> 
> 
> 
> From:
> Sarah Goslee <sarah.goslee at gmail.com>
> To:
> mauricio.zambrano at jrc.ec.europa.eu
> Cc:
> Dominik Reusser <reusser at pik-potsdam.de>, r-devel at r-project.org,
> w.buytaert at imperial.ac.uk
> Date:
> 02/14/2012 11:24 AM
> Subject:
> Re: [Rd] requesting a new SIG mailing list
> Sent by:
> r-devel-bounces at r-project.org
> 
> 
> 
> Hello,
> 
> I'm one of the maintainers of the r-sig-ecology list, and I think
> it would be entirely appropriate to include hydrology within
> the scope of the list.
> 
> There hasn't been much hydrologic discussion, as you noted,
> but not because we wish to exclude it.
> 
> Sarah
> 
> On Tue, Feb 14, 2012 at 11:31 AM, Mauricio Zambrano-Bigiarini
> 
> <mauricio.zambrano at jrc.ec.europa.eu> wrote:
> > Another possibility could be to use the R-sig-ecology, which seems to be
> > more related to hydrology:
> > 
> > "analytical techniques and topics that are appropriate for discussion on
> > R-sig-ecology are quite broad. For examples of what might be appropriate
> 
> for
> 
> > discussion on this list, please see the Environmentrics Task View
> > (http://cran.r-project.org/web/views/Environmetrics.html)"
> > (taken from: https://stat.ethz.ch/mailman/listinfo/r-sig-ecology)
> > 
> > However, I did a quick search on the archives of 'R-sig-ecology' for the
> > year 2011, and I could only found one single mail related to hydrology:
> > 
> > https://stat.ethz.ch/pipermail/r-sig-ecology/2011-July/002274.html
> > 
> > (in the same search I couldn't find any single reference to hydrology in
> 
> the
> 
> > R-sig-geo during the year 2011)


-- 
Dr. Dominik Reusser

North-South Project
Potsdam Institute for Climate Impact Research
Research Domain 2: Climate Impacts & Vulnerabilities

Telephone +49 331 288 26 46
Fax            +49 331 288 20709

P.O.Box 60 12 03, 14412 Potsdam, Germany
Visiting adress: Pappelallee 20, 14469 Potsdam


From mauricio.zambrano at jrc.ec.europa.eu  Wed Feb 15 11:04:57 2012
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Wed, 15 Feb 2012 11:04:57 +0100
Subject: [Rd] requesting a new SIG mailing list
In-Reply-To: <201202150907.21227.reusser@pik-potsdam.de>
References: <4F393ABA.4020806@jrc.ec.europa.eu>
	<CAM_vjunBbLcNA0nGP0FyqkL-h+ZwP6F45FEDiFA6GcxKr18+SQ@mail.gmail.com>
	<OF12FFE926.89CF684A-ON862579A4.0068F4F0-862579A4.0069B2AC@usgs.gov>
	<201202150907.21227.reusser@pik-potsdam.de>
Message-ID: <4F3B8349.9010507@jrc.ec.europa.eu>

On 15/02/12 09:07, Dominik Reusser wrote:
> Dear all,
> I do think that joining efforts is a good idea. However, hydrologists will
> probably not intuitively think about joining r-sig-ecology to discuss
> hydrological issues. Could we therefore explicitely state on the infopage that
> discussions to hydrology (in addition to general  environmental data) are also
> welcome.

It would be great if Sara of someone of the maintainers of the 
r-sig-ecology list could add that info to the info page.
>
> I don't think it is worth it, but probably the appropriate name would then be
> r-sig-env for such a list? In the description, you are also refering to the
> Environmetrics task list.

I think that r-sig-env would be much more intuitive for environmental 
scientists coming from fields different from ecology, but I don't think 
it is possible to change the name of an existing mailing list.

However, I'm wondering if it would be possible to create an alias termed 
'r-sig-env' to 'r-sig-ecology' ?, in order to make the name of the list 
more intuitive for environmental scientists but without disturbing the 
current users.

>
> I'm wondering where we can make people aware of the fact, that hydrological
> issues are discussed on r-sig-ecology. I'm going to ask Gavin Simpson to put
> references to the list on the environmetrics task view if you agree that this
> would be useful.

I think it would be very useful to make more general the description of 
the r-sig-ecology in the R mailing list page 
(http://www.r-project.org/mail.html), something like:

R-sig-ecology: Using R in environmental and ecological data analysis


Also, we can announce the mailing list during our R-short
> course on hydrology at EGU. What else?

This would be great !

>
> Best regards!
> Dominik


All the best,

Mauricio Zambrano-Bigiarini

-- 
=======================================================
FLOODS Action
Water Resources Unit (H01)
Institute for Environment and Sustainability (IES)
European Commission, Joint Research Centre (JRC)
webinfo    : http://floods.jrc.ec.europa.eu/
=======================================================
DISCLAIMER:\ "The views expressed are purely those of th...{{dropped:10}}


From sagarnikam123 at gmail.com  Fri Feb 10 11:54:54 2012
From: sagarnikam123 at gmail.com (sagarnikam123)
Date: Fri, 10 Feb 2012 02:54:54 -0800 (PST)
Subject: [Rd] which R package is used for browsing web pages through coding
Message-ID: <1328871294669-4375909.post@n4.nabble.com>

i know RCurl pakage to retrieve web content,it has limited use, i want
interactive package like 

(in perl--->Mechanize, 
In java--->Watij,Prowser,HTMLunit,HTTPunit, 
in Ruby---->Watir ,etc) 

this modules/packages opens appropriate browser,which can create
queries,retrieves output, clicks buttons, fill up form
automatically,searches keyword in search engine, Downloads many items from
internet 
All this is by coding .... 

if find ,kindly give me sample examples(codes) at list two/five 
if not found,give me RCurl's sample codes starting from how to import
library to closing browser, 
with explanation for each line of code 


--
View this message in context: http://r.789695.n4.nabble.com/which-R-package-is-used-for-browsing-web-pages-through-coding-tp4375909p4375909.html
Sent from the R devel mailing list archive at Nabble.com.


From sagarnikam123 at gmail.com  Fri Feb 10 11:59:55 2012
From: sagarnikam123 at gmail.com (sagarnikam123)
Date: Fri, 10 Feb 2012 02:59:55 -0800 (PST)
Subject: [Rd] how to convert JGR package script to .exe
Message-ID: <1328871595333-4375925.post@n4.nabble.com>

i made jDialog through JGR package(Java gui 4 R),
i want to export it with imported external package e.g.bio3d,RCOR , into
.exe

or if not possible convert code to executable jar file
how should i go, give me package name,example codes (if possible) 


--
View this message in context: http://r.789695.n4.nabble.com/how-to-convert-JGR-package-script-to-exe-tp4375925p4375925.html
Sent from the R devel mailing list archive at Nabble.com.


From sahir.bhatnagar at gmail.com  Mon Feb 13 20:36:29 2012
From: sahir.bhatnagar at gmail.com (sahir bhatnagar)
Date: Mon, 13 Feb 2012 14:36:29 -0500
Subject: [Rd] executable files R package
Message-ID: <CAEV=kBNoZ5ooTQVpQmsV-P4jbMekg=KSw==O=fwCMPGL71Dx0Q@mail.gmail.com>

I am in the process of creating a package in R which calls
pre-compiled C code i.e. '.exe' files in Windows.

Since CRAN will not accept packages with binary code files, what are
my options to meet the requirements while still including the
executable file?

I read section 1.5.2 of the manual which mentions three options two of
which involve negotiating with CRAN administrators. The third
references the package Cairo which arranges to download additional
software, but I don't see how this will allow my package to get
accepted.

It would seem that I need to ensure that my package works under both
architectures (32 and 64 bit).

1) Would this be sufficient to get it accepted?
2) If so, does anyone have any documentation in performing this task,
or can someone point me in the right direction?

I was told that 'arulesSequences' is an example of a CRAN package
while compiles executables. Was this package accepted because it
worked under both architectures? or are there other reasons.

thanks


From edd at debian.org  Wed Feb 15 14:55:28 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 15 Feb 2012 07:55:28 -0600
Subject: [Rd] R CMD SHLIB in Windows XP - No output at all
In-Reply-To: <1329178163008-4385797.post@n4.nabble.com>
References: <1329178163008-4385797.post@n4.nabble.com>
Message-ID: <20283.47440.458365.839827@max.nulle.part>


On 13 February 2012 at 16:09, Lorenzo wrote:
| Hello all,
| 
| I'm trying hard to make R CMD SHLIB work on Windows XP (32-bit) - please

Have a look at the countless examples and hundreds of unit tests in the Rcpp
package.  Almost all of them work by using the inline package to compile,
link and load shared libraries on the fly.

And yes, it all works fine on Windows XP.  [ We do here that people on
Windows 7 have to fight with security and admin settings though. ]

You "merely" need to install Rtools right and get your PATH settings sorted
out.  This is documented in numerous places.

Dirk

| note that I don't have the admin rights on the computer.
| In terms of setup, I have followed the procedure :
| => installed Rtools 2.14
| => changed my path :
| PATH=C:\Trading\R\RTools\bin;C:\Trading\R\RTools\MinGW\bin;C:\Trading\R\R-2.14.1\bin\i386;C:\WINDOWS\system32;%OTHER_PATHS%
| 
| But when I try R CMD SHLIB *.* I have litterally nothing, no output at all.
| (and R CMD INSTALL debug tells me, of course that the operation failed while
| calling R CMD SHLIB)
| I tried the command R CMD SHLIB -n, which gives me : 
| make -f "C:/Trading/R/R-2.14.1/etc/i386/Makeconf" -f
| "C:/Trading/R/R-2.14.1/share/make/winshlib.mk" SHLIB= OBJECTS= 
| 
| So I had a closer look at these two files, and found some strange things in
| Makeconf, for example a variable LOCAL_SOFT with a d: path which has nothing
| to do with my configuration :
| LOCAL_SOFT = d:/RCompile/CRANpkg/extralibs/local
| 
| Ok, the thing is, my Makeconf is strange, but when I actually use the 
| """ make -f "C:/Trading/R/R-2.14.1/etc/i386/Makeconf" -f
| "C:/Trading/R/R-2.14.1/share/make/winshlib.mk" SHLIB= OBJECTS=  """ 
| directly in the command prompt, it works more or less.
| I managed to build a simple dll based on C code (convolve2.dll, from the
| example), but couldn't build any dll based on c++ code.
| 
| Is my SHLIB properly set up ? Why do I have a strange Makeconf ? Should I
| try to find a proper version of the file ? or reinstall R ?
| 
| Does anyone have any idea how to fix that ?
| Been trying to fix it for a long time now !
| 
| Thanks in advance !
| 
| Lorenzo
| 
| --
| View this message in context: http://r.789695.n4.nabble.com/R-CMD-SHLIB-in-Windows-XP-No-output-at-all-tp4385797p4385797.html
| Sent from the R devel mailing list archive at Nabble.com.
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
"Outside of a dog, a book is a man's best friend. Inside of a dog, it is too
dark to read." -- Groucho Marx


From murdoch.duncan at gmail.com  Wed Feb 15 16:14:25 2012
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 15 Feb 2012 10:14:25 -0500
Subject: [Rd] executable files R package
In-Reply-To: <CAEV=kBNoZ5ooTQVpQmsV-P4jbMekg=KSw==O=fwCMPGL71Dx0Q@mail.gmail.com>
References: <CAEV=kBNoZ5ooTQVpQmsV-P4jbMekg=KSw==O=fwCMPGL71Dx0Q@mail.gmail.com>
Message-ID: <4F3BCBD1.1050103@gmail.com>

On 13/02/2012 2:36 PM, sahir bhatnagar wrote:
> I am in the process of creating a package in R which calls
> pre-compiled C code i.e. '.exe' files in Windows.
>
> Since CRAN will not accept packages with binary code files, what are
> my options to meet the requirements while still including the
> executable file?

I think you should ask the CRAN administrators that, but my 
understanding is that they are unlikely to accept your package as 
described.  CRAN is interested in platform-neutral packages, and if you 
have an .exe, you're going to be Windows-only.

If you include the source code for that .exe and put together the 
Makefile to compile it, then they'd be more receptive, and someone might 
offer help to get it to run on other platforms if it doesn't on your 
first attempt.

If you don't want to include the .exe source (or can't), I think you 
should just publish it on your own web page.

Duncan Murdoch

> I read section 1.5.2 of the manual which mentions three options two of
> which involve negotiating with CRAN administrators. The third
> references the package Cairo which arranges to download additional
> software, but I don't see how this will allow my package to get
> accepted.
>
> It would seem that I need to ensure that my package works under both
> architectures (32 and 64 bit).
>
> 1) Would this be sufficient to get it accepted?
> 2) If so, does anyone have any documentation in performing this task,
> or can someone point me in the right direction?
>
> I was told that 'arulesSequences' is an example of a CRAN package
> while compiles executables. Was this package accepted because it
> worked under both architectures? or are there other reasons.
>
> thanks
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch.duncan at gmail.com  Wed Feb 15 16:17:36 2012
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 15 Feb 2012 10:17:36 -0500
Subject: [Rd] help.search() in html?
In-Reply-To: <20120215130318.GA13405@euler.dcu.ie>
References: <20120215130318.GA13405@euler.dcu.ie>
Message-ID: <4F3BCC90.2090704@gmail.com>

On 15/02/2012 8:03 AM, hkawakat at gmail.com wrote:
> Hi,
>
> I have options(help_type="html") in my .Rprofile and when I type
> ?foo, the man page appears as a new tab in my web browser (which is
> already running). Fine. However, when I type ??foo, rather than the
> results appearing in a new tab, a new instance of the web browser is
> spawned with the default homepage displayed. Same with
> help.search("foo"). Am I the only one seeing this? Is there some
> setting/option that I am missing?
> (At the moment, I bring up a man page via ?foo and then manually
> follow the<Index>  link at the bottom of the page to go up to the
> search engine page.) R --vanilla shows the results of ??foo in the
> terminal window as expected.

I just tried it on Windows, and got this error message in R-devel:

 > options(help_type="html")
 > ??mean
starting httpd help server ... done
Error in shell.exec(url) :
   'http://127.0.0.1: 13432 /doc/html/Search?pattern= mean          ' 
not found

Looks like some spaces have crept into the URL.  I'll take a look.  
(R-patched was fine.)

Duncan Murdoch

> I am running
> >  sessionInfo()
> R Under development (unstable) (2012-02-13 r58337)
> Platform: x86_64-unknown-linux-gnu (64-bit)
>
> locale:
>   [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C
>   [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8
>   [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8
>   [7] LC_PAPER=C                 LC_NAME=C
>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] tools_2.15.0
>
> h.


From murdoch.duncan at gmail.com  Wed Feb 15 16:29:46 2012
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 15 Feb 2012 10:29:46 -0500
Subject: [Rd] help.search() in html?
In-Reply-To: <20120215130318.GA13405@euler.dcu.ie>
References: <20120215130318.GA13405@euler.dcu.ie>
Message-ID: <4F3BCF6A.4060903@gmail.com>

Fixed now on my system and committed as r58351.  It was simply a typo in 
some housekeeping changes made in December, where
paste(..., sep="") was replaced by paste0(...).

Duncan Murdoch


On 15/02/2012 8:03 AM, hkawakat at gmail.com wrote:
> Hi,
>
> I have options(help_type="html") in my .Rprofile and when I type
> ?foo, the man page appears as a new tab in my web browser (which is
> already running). Fine. However, when I type ??foo, rather than the
> results appearing in a new tab, a new instance of the web browser is
> spawned with the default homepage displayed. Same with
> help.search("foo"). Am I the only one seeing this? Is there some
> setting/option that I am missing?
> (At the moment, I bring up a man page via ?foo and then manually
> follow the<Index>  link at the bottom of the page to go up to the
> search engine page.) R --vanilla shows the results of ??foo in the
> terminal window as expected.
>
> I am running
> >  sessionInfo()
> R Under development (unstable) (2012-02-13 r58337)
> Platform: x86_64-unknown-linux-gnu (64-bit)
>
> locale:
>   [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C
>   [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8
>   [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8
>   [7] LC_PAPER=C                 LC_NAME=C
>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] tools_2.15.0
>
> h.


From murdoch.duncan at gmail.com  Wed Feb 15 16:44:32 2012
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 15 Feb 2012 10:44:32 -0500
Subject: [Rd] R CMD SHLIB in Windows XP - No output at all
In-Reply-To: <1329178163008-4385797.post@n4.nabble.com>
References: <1329178163008-4385797.post@n4.nabble.com>
Message-ID: <4F3BD2E0.8070602@gmail.com>

On 13/02/2012 7:09 PM, Lorenzo wrote:
> Hello all,
>
> I'm trying hard to make R CMD SHLIB work on Windows XP (32-bit) - please
> note that I don't have the admin rights on the computer.
> In terms of setup, I have followed the procedure :
> =>  installed Rtools 2.14
> =>  changed my path :
> PATH=C:\Trading\R\RTools\bin;C:\Trading\R\RTools\MinGW\bin;C:\Trading\R\R-2.14.1\bin\i386;C:\WINDOWS\system32;%OTHER_PATHS%
>
> But when I try R CMD SHLIB *.* I have litterally nothing, no output at all.
> (and R CMD INSTALL debug tells me, of course that the operation failed while
> calling R CMD SHLIB)
> I tried the command R CMD SHLIB -n, which gives me :
> make -f "C:/Trading/R/R-2.14.1/etc/i386/Makeconf" -f
> "C:/Trading/R/R-2.14.1/share/make/winshlib.mk" SHLIB= OBJECTS=
>
> So I had a closer look at these two files, and found some strange things in
> Makeconf, for example a variable LOCAL_SOFT with a d: path which has nothing
> to do with my configuration :
> LOCAL_SOFT = d:/RCompile/CRANpkg/extralibs/local

That's a path on the machine which builds the R binary distributions.  
It shouldn't have leaked out, but it should be harmless.

I think the problem might be with the "*.*".  On a Unix system, the 
shell expands wildcards, but on Windows, the individual commands are 
supposed to do it.  But our commands generally follow the Unix 
conventions, so perhaps nobody is expanding that, and nothing is being 
requested.  (When I try it in R-patched, it works.  But I'm not using 
that version of Rtools, and you don't say what version of R you're using.)

If you use a bash shell (e.g. from Cygwin) then it will follow the Unix 
convention, and that will probably work.  That's what I normally do.

Alternatively, you can just list the files that you want to compile.  If 
it's a long list, I think there are Windows ways to put the whole list 
into a shell variable and put the shell variable on that line, but I 
forget what they are.  I would certainly try that for debugging purposes.

Duncan Murdoch

> Ok, the thing is, my Makeconf is strange, but when I actually use the
> """ make -f "C:/Trading/R/R-2.14.1/etc/i386/Makeconf" -f
> "C:/Trading/R/R-2.14.1/share/make/winshlib.mk" SHLIB= OBJECTS=  """
> directly in the command prompt, it works more or less.
> I managed to build a simple dll based on C code (convolve2.dll, from the
> example), but couldn't build any dll based on c++ code.
>
> Is my SHLIB properly set up ? Why do I have a strange Makeconf ? Should I
> try to find a proper version of the file ? or reinstall R ?
>
> Does anyone have any idea how to fix that ?
> Been trying to fix it for a long time now !
>
> Thanks in advance !
>
> Lorenzo
>
> --
> View this message in context: http://r.789695.n4.nabble.com/R-CMD-SHLIB-in-Windows-XP-No-output-at-all-tp4385797p4385797.html
> Sent from the R devel mailing list archive at Nabble.com.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From jeffrey.ryan at lemnica.com  Wed Feb 15 16:59:24 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Wed, 15 Feb 2012 09:59:24 -0600
Subject: [Rd] which R package is used for browsing web pages through
	coding
In-Reply-To: <1328871294669-4375909.post@n4.nabble.com>
References: <1328871294669-4375909.post@n4.nabble.com>
Message-ID: <CABDUZc9=Oxhqij826Ho=o_-4VE_s+TbAqMGiOKHyh6OBUOJ+_Q@mail.gmail.com>

Probably not R-devel, more likely R-help or google.

Why not just use the 6+ solutions you have outlined and use R for what
R is good at?

Jeff

On Fri, Feb 10, 2012 at 4:54 AM, sagarnikam123 <sagarnikam123 at gmail.com> wrote:
> i know RCurl pakage to retrieve web content,it has limited use, i want
> interactive package like
>
> (in perl--->Mechanize,
> In java--->Watij,Prowser,HTMLunit,HTTPunit,
> in Ruby---->Watir ,etc)
>
> this modules/packages opens appropriate browser,which can create
> queries,retrieves output, clicks buttons, fill up form
> automatically,searches keyword in search engine, Downloads many items from
> internet
> All this is by coding ....
>
> if find ,kindly give me sample examples(codes) at list two/five
> if not found,give me RCurl's sample codes starting from how to import
> library to closing browser,
> with explanation for each line of code
>
>
> --
> View this message in context: http://r.789695.n4.nabble.com/which-R-package-is-used-for-browsing-web-pages-through-coding-tp4375909p4375909.html
> Sent from the R devel mailing list archive at Nabble.com.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From sarah.goslee at gmail.com  Wed Feb 15 18:16:01 2012
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Wed, 15 Feb 2012 12:16:01 -0500
Subject: [Rd] requesting a new SIG mailing list
In-Reply-To: <4F3B8349.9010507@jrc.ec.europa.eu>
References: <4F393ABA.4020806@jrc.ec.europa.eu>
	<CAM_vjunBbLcNA0nGP0FyqkL-h+ZwP6F45FEDiFA6GcxKr18+SQ@mail.gmail.com>
	<OF12FFE926.89CF684A-ON862579A4.0068F4F0-862579A4.0069B2AC@usgs.gov>
	<201202150907.21227.reusser@pik-potsdam.de>
	<4F3B8349.9010507@jrc.ec.europa.eu>
Message-ID: <CAM_vjunNLcj7h9xHRz6FFhvAWHOrs-RuGQCEBuFU0qg6LbWkJw@mail.gmail.com>

Hi all,

> It would be great if Sara of someone of the maintainers of the r-sig-ecology
> list could add that info to the info page.

I'm talking with the other maintainer about revising both the short and
the long descriptions.

> I think that r-sig-env would be much more intuitive for environmental
> scientists coming from fields different from ecology, but I don't think it
> is possible to change the name of an existing mailing list.
>
> However, I'm wondering if it would be possible to create an alias termed
> 'r-sig-env' to 'r-sig-ecology' ?, in order to make the name of the list more
> intuitive for environmental scientists but without disturbing the current
> users.

I don't know that there is any mechanism for doing either of those things.
Changing the name would be disruptive, and I don't know of an alias
option. I think ecology is a more inclusive term than environmental anyway,
but then I'm an ecologist.

Sarah

-- 
Sarah Goslee
http://www.functionaldiversity.org


From hkawakat at gmail.com  Wed Feb 15 18:49:13 2012
From: hkawakat at gmail.com (Hiroyuki Kawakatsu)
Date: Wed, 15 Feb 2012 17:49:13 +0000
Subject: [Rd] help.search() in html?
In-Reply-To: <4F3BCF6A.4060903@gmail.com>
References: <20120215130318.GA13405@euler.dcu.ie> <4F3BCF6A.4060903@gmail.com>
Message-ID: <CADBEN2yx4TXQ1uCFmiw1BmH5b2t1Dfe_b-JZBTKoYXqi03MC0w@mail.gmail.com>

On Wed, Feb 15, 2012, Duncan Murdoch wrote:
> Fixed now on my system and committed as r58351. ?It was simply a typo in
> some housekeeping changes made in December, where
> paste(..., sep="") was replaced by paste0(...).

Many thanks for your swift attention and fix. I can confirm the fix on
my machine with r58354.

h.
-- 
+---
| Hiroyuki Kawakatsu
| Business School, Dublin City University
| Dublin 9, Ireland. Tel +353 (0)1 700 7496


From tlumley at uw.edu  Wed Feb 15 21:28:32 2012
From: tlumley at uw.edu (Thomas Lumley)
Date: Thu, 16 Feb 2012 09:28:32 +1300
Subject: [Rd] read.spss issues
In-Reply-To: <CABFfbXuC++xk=-98C=xFDrXHENa8fWOArstTnqqrz7Go4cfBSA@mail.gmail.com>
References: <CABFfbXuC++xk=-98C=xFDrXHENa8fWOArstTnqqrz7Go4cfBSA@mail.gmail.com>
Message-ID: <CAJ55+dKrZKaxMq2vANPaUsTppe4FixDAY5or0MSK8JQuKV-73Q@mail.gmail.com>

On Wed, Feb 15, 2012 at 7:05 PM, Jeroen Ooms <jeroen.ooms at stat.ucla.edu> wrote:

> The second problem is that the spss dataformat allows to specify
> 'duplicate labels', whereas this is not allowed for factors. read.spss
> does not deal with this and creates a bad factor
>
> x <- read.spss("http://www.stat.ucla.edu/~jeroen/spss/duplicate_labels.sav",
> use.value.labels=T);
> levels(x$opinion);
>
> which causes issues downstream. I am not sure if this is an issue in
> read.spss() or as.factor(), but I guess it might be wise to try to
> detect duplicate levels and assign them all with one and the same
> integer value when converting to a factor.

I think this one would be better dealt with by giving an error.

SPSS value labels are just labels, so they don't map very well onto R
factors, which are enumerated types.  Rather than force them and lose
data, I would prefer to make the user decide what to do.

    -thomas

-- 
Thomas Lumley
Professor of Biostatistics
University of Auckland


From dwinsemius at comcast.net  Wed Feb 15 23:04:33 2012
From: dwinsemius at comcast.net (David Winsemius)
Date: Wed, 15 Feb 2012 17:04:33 -0500
Subject: [Rd] read.spss issues
In-Reply-To: <CAJ55+dKrZKaxMq2vANPaUsTppe4FixDAY5or0MSK8JQuKV-73Q@mail.gmail.com>
References: <CABFfbXuC++xk=-98C=xFDrXHENa8fWOArstTnqqrz7Go4cfBSA@mail.gmail.com>
	<CAJ55+dKrZKaxMq2vANPaUsTppe4FixDAY5or0MSK8JQuKV-73Q@mail.gmail.com>
Message-ID: <23385ED3-7BED-429B-A03F-88CD57E443E3@comcast.net>


On Feb 15, 2012, at 3:28 PM, Thomas Lumley wrote:

> On Wed, Feb 15, 2012 at 7:05 PM, Jeroen Ooms <jeroen.ooms at stat.ucla.edu 
> > wrote:
>
>> The second problem is that the spss dataformat allows to specify
>> 'duplicate labels', whereas this is not allowed for factors.  
>> read.spss
>> does not deal with this and creates a bad factor
>>
>> x <- read.spss("http://www.stat.ucla.edu/~jeroen/spss/duplicate_labels.sav 
>> ",
>> use.value.labels=T);
>> levels(x$opinion);
>>
>> which causes issues downstream. I am not sure if this is an issue in
>> read.spss() or as.factor(), but I guess it might be wise to try to
>> detect duplicate levels and assign them all with one and the same
>> integer value when converting to a factor.
>
> I think this one would be better dealt with by giving an error.
>
> SPSS value labels are just labels, so they don't map very well onto R
> factors, which are enumerated types.  Rather than force them and lose
> data, I would prefer to make the user decide what to do.

I could imagine that users might appreciate the possibility of getting  
the data from read.spss one pass,  but also getting the labels from a  
separate function that made a best guess at what was needed but did  
not try to unambiguously match up variables with factor levels for all  
variables. For big datasets, there might be only a few edits needed to  
throw out duplicates and save a lot of typing errors.

-- 

David Winsemius, MD
West Hartford, CT


From lorenzo.lucido at asia.bnpparibas.com  Thu Feb 16 00:32:47 2012
From: lorenzo.lucido at asia.bnpparibas.com (Lorenzo)
Date: Wed, 15 Feb 2012 15:32:47 -0800 (PST)
Subject: [Rd] R CMD SHLIB in Windows XP - No output at all
In-Reply-To: <20283.47440.458365.839827@max.nulle.part>
References: <1329178163008-4385797.post@n4.nabble.com>
	<20283.47440.458365.839827@max.nulle.part>
Message-ID: <1329348767349-4392407.post@n4.nabble.com>

Hi Dirk,

Thanks for your suggestion.
Seems that I have the same issue with the inline package, here is my output
:

############ INLINE SIMPLE EXAMPLE 
> library(Rcpp)
> library(inline)
> library(RcppArmadillo)
> foo <- '
+   int i, j, na, nb, nab;
+   double *xa, *xb, *xab;
+   SEXP ab;
+ 
+   PROTECT(a = AS_NUMERIC(a));
+   PROTECT(b = AS_NUMERIC(b));
+   na = LENGTH(a); nb = LENGTH(b); nab = na + nb - 1;
+   PROTECT(ab = NEW_NUMERIC(nab));
+   xa = NUMERIC_POINTER(a); xb = NUMERIC_POINTER(b);
+   xab = NUMERIC_POINTER(ab);
+   for(i = 0; i < nab; i++) xab[i] = 0.0;
+   for(i = 0; i < na; i++)
+     for(j = 0; j < nb; j++) xab[i + j] += xa[i] * xb[j];
+   UNPROTECT(3);
+   return(ab);
+ '
> foo
[1] "\n  int i, j, na, nb, nab;\n  double *xa, *xb, *xab;\n  SEXP ab;\n\n 
PROTECT(a = AS_NUMERIC(a));\n  PROTECT(b = AS_NUMERIC(b));\n  na =
LENGTH(a); nb = LENGTH(b); nab = na + nb - 1;\n  PROTECT(ab =
NEW_NUMERIC(nab));\n  xa = NUMERIC_POINTER(a); xb = NUMERIC_POINTER(b);\n 
xab = NUMERIC_POINTER(ab);\n  for(i = 0; i < nab; i++) xab[i] = 0.0;\n 
for(i = 0; i < na; i++)\n    for(j = 0; j < nb; j++) xab[i + j] += xa[i] *
xb[j];\n  UNPROTECT(3);\n  return(ab);\n"
> funx <- cfunction(signature(a="numeric",b="numeric"), foo, Rcpp=FALSE,
> verbose=FALSE)

ERROR(s) during compilation: source code errors or compiler configuration
errors!

Program source:
  1: #include <R.h>
  2: #include <Rdefines.h>
  3: #include <R_ext/Error.h>
  4: 
  5: 
  6: extern "C" {
  7:   SEXP file48858916c0f ( SEXP a, SEXP b );
  8: }
  9: 
 10: SEXP file48858916c0f ( SEXP a, SEXP b ) {
 11: 
 12:   int i, j, na, nb, nab;
 13:   double *xa, *xb, *xab;
 14:   SEXP ab;
 15: 
 16:   PROTECT(a = AS_NUMERIC(a));
 17:   PROTECT(b = AS_NUMERIC(b));
 18:   na = LENGTH(a); nb = LENGTH(b); nab = na + nb - 1;
 19:   PROTECT(ab = NEW_NUMERIC(nab));
 20:   xa = NUMERIC_POINTER(a); xb = NUMERIC_POINTER(b);
 21:   xab = NUMERIC_POINTER(ab);
 22:   for(i = 0; i < nab; i++) xab[i] = 0.0;
 23:   for(i = 0; i < na; i++)
 24:     for(j = 0; j < nb; j++) xab[i + j] += xa[i] * xb[j];
 25:   UNPROTECT(3);
 26:   return(ab);
 27: 
 28:   warning("your C program does not return anything!");
 29:   return R_NilValue;
 30: }
*Error in compileCode(f, code, language, verbose) : 
  Compilation ERROR, function(s)/method(s) not created! 
In addition: Warning message:
running command 'C:/Trading/R/R-2.14.1/bin/i386/R CMD SHLIB
file48858916c0f.cpp 2> file48858916c0f.cpp.err.txt' had status 1 *
#####################################

Looks like my issue on R CMD SHLIB is causing the compileCode function to
fail.




--
View this message in context: http://r.789695.n4.nabble.com/R-CMD-SHLIB-in-Windows-XP-No-output-at-all-tp4385797p4392407.html
Sent from the R devel mailing list archive at Nabble.com.


From lorenzo.lucido at asia.bnpparibas.com  Thu Feb 16 01:03:07 2012
From: lorenzo.lucido at asia.bnpparibas.com (Lorenzo)
Date: Wed, 15 Feb 2012 16:03:07 -0800 (PST)
Subject: [Rd] R CMD SHLIB in Windows XP - No output at all
In-Reply-To: <4F3BD2E0.8070602@gmail.com>
References: <1329178163008-4385797.post@n4.nabble.com>
	<4F3BD2E0.8070602@gmail.com>
Message-ID: <1329350587496-4392482.post@n4.nabble.com>

Hi Duncan,

Thanks for your help, I am actually using R Windows version 2.14.1 (22th Dec
2011).

Actually by "R CMD SHLIB *.*" I actually meant putting any file name after
the R CMD SHLIB ("R CMD SHLIB convolve.c" for example).
Another case which fails is : creating a Rcpp Armadillo package skeleton
(named MyPackage for example) and trying the R CMD INSTALL MyPackage. Fails
as well on the R CMD SHLIB line.

What I actually don't understand is how the R CMD SHLIB command links to the
RTools cygwin and mingw.
It really looks like the "make" function works in my command line when I use
it directly but the link between R CMD SHLIB and cygwin fails...

--
View this message in context: http://r.789695.n4.nabble.com/R-CMD-SHLIB-in-Windows-XP-No-output-at-all-tp4385797p4392482.html
Sent from the R devel mailing list archive at Nabble.com.


From wdunlap at tibco.com  Thu Feb 16 02:26:58 2012
From: wdunlap at tibco.com (William Dunlap)
Date: Thu, 16 Feb 2012 01:26:58 +0000
Subject: [Rd] R CMD SHLIB in Windows XP - No output at all
In-Reply-To: <1329350587496-4392482.post@n4.nabble.com>
References: <1329178163008-4385797.post@n4.nabble.com>
	<4F3BD2E0.8070602@gmail.com> <1329350587496-4392482.post@n4.nabble.com>
Message-ID: <E66794E69CFDE04D9A70842786030B9327B563@PA-MBX04.na.tibco.com>

Does the following example help?  I installed Duncan Murdoch's
Rtools-2.13 into E:\Rtools-2.13 and R into E:\Program Files\R\R-2.14.1.
I put a small file of C code into E:\temp\junk.c.  Here is record
of what I did after opening a new cmd.exe window.  Setting PATH
is critical: put the 2 bin directories under Rtools first in PATH.
You might want R_HOME\bin early too, if you already have some other R_HOME
directory in your standard PATH.

C:\Documents and Settings\wdunlap>set PATH=e:\Rtools-2.13\bin;e:\Rtools-2.13\MinGW\bin;%PATH%;e:\Program Files\R\R-2.14.1\bin

C:\Documents and Settings\wdunlap>e:

E:\>cd \temp

E:\temp>R CMD SHLIB -o junk.dll junk.c
cygwin warning:
  MS-DOS style path detected: E:/PROGRA~1/R/R-214~1.0/etc/i386/Makeconf
  Preferred POSIX equivalent is: /cygdrive/e/PROGRA~1/R/R-214~1.0/etc/i386/Makeconf
  CYGWIN environment variable option "nodosfilewarning" turns off this warning.
  Consult the user's guide for more details about POSIX paths:
    http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
gcc  -I"E:/PROGRA~1/R/R-214~1.0/include"     -I"d:/RCompile/CRANpkg/extralibs/local/include"     -O3 -Wall  -std=gnu99 -mtune=core2 -c junk.c -o junk.
o
gcc -shared -s -static-libgcc -o junk.dll tmp.def junk.o -Ld:/RCompile/CRANpkg/extralibs/local/lib -LE:/PROGRA~1/R/R-214~1.0/bin/i386 -lR

E:\temp>type junk.c
void my_junk(double *x)
{
    *x = *x + 100.0;
}

E:\temp>R
... [elided startup messages] ...
> dyn.load("junk.dll")
> .C("my_junk", pi) # expect to get 100+3.14159265...
[[1]]
[1] 103.1416

>

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com 
> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of Lorenzo
> Sent: Wednesday, February 15, 2012 4:03 PM
> To: r-devel at r-project.org
> Subject: Re: [Rd] R CMD SHLIB in Windows XP - No output at all
> 
> Hi Duncan,
> 
> Thanks for your help, I am actually using R Windows version 2.14.1 (22th Dec
> 2011).
> 
> Actually by "R CMD SHLIB *.*" I actually meant putting any file name after
> the R CMD SHLIB ("R CMD SHLIB convolve.c" for example).
> Another case which fails is : creating a Rcpp Armadillo package skeleton
> (named MyPackage for example) and trying the R CMD INSTALL MyPackage. Fails
> as well on the R CMD SHLIB line.
> 
> What I actually don't understand is how the R CMD SHLIB command links to the
> RTools cygwin and mingw.
> It really looks like the "make" function works in my command line when I use
> it directly but the link between R CMD SHLIB and cygwin fails...
> 
> --
> View this message in context: http://r.789695.n4.nabble.com/R-CMD-SHLIB-in-Windows-XP-No-output-at-
> all-tp4385797p4392482.html
> Sent from the R devel mailing list archive at Nabble.com.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From wdunlap at tibco.com  Thu Feb 16 03:08:52 2012
From: wdunlap at tibco.com (William Dunlap)
Date: Thu, 16 Feb 2012 02:08:52 +0000
Subject: [Rd] R CMD SHLIB in Windows XP - No output at all
In-Reply-To: <E66794E69CFDE04D9A70842786030B9327B563@PA-MBX04.na.tibco.com>
References: <1329178163008-4385797.post@n4.nabble.com>
	<4F3BD2E0.8070602@gmail.com> <1329350587496-4392482.post@n4.nabble.com>
	<E66794E69CFDE04D9A70842786030B9327B563@PA-MBX04.na.tibco.com>
Message-ID: <E66794E69CFDE04D9A70842786030B9327B590@PA-MBX04.na.tibco.com>

It looks like my original path had R_HOME for
2.14.0 in it, but what I did works when that
was changed.

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com 

> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of William Dunlap
> Sent: Wednesday, February 15, 2012 5:27 PM
> To: Lorenzo; r-devel at r-project.org
> Subject: Re: [Rd] R CMD SHLIB in Windows XP - No output at all
> 
> Does the following example help?  I installed Duncan Murdoch's
> Rtools-2.13 into E:\Rtools-2.13 and R into E:\Program Files\R\R-2.14.1.
> I put a small file of C code into E:\temp\junk.c.  Here is record
> of what I did after opening a new cmd.exe window.  Setting PATH
> is critical: put the 2 bin directories under Rtools first in PATH.
> You might want R_HOME\bin early too, if you already have some other R_HOME
> directory in your standard PATH.
> 
> C:\Documents and Settings\wdunlap>set PATH=e:\Rtools-2.13\bin;e:\Rtools-
> 2.13\MinGW\bin;%PATH%;e:\Program Files\R\R-2.14.1\bin
> 
> C:\Documents and Settings\wdunlap>e:
> 
> E:\>cd \temp
> 
> E:\temp>R CMD SHLIB -o junk.dll junk.c
> cygwin warning:
>   MS-DOS style path detected: E:/PROGRA~1/R/R-214~1.0/etc/i386/Makeconf
>   Preferred POSIX equivalent is: /cygdrive/e/PROGRA~1/R/R-214~1.0/etc/i386/Makeconf
>   CYGWIN environment variable option "nodosfilewarning" turns off this warning.
>   Consult the user's guide for more details about POSIX paths:
>     http://cygwin.com/cygwin-ug-net/using.html#using-pathnames
> gcc  -I"E:/PROGRA~1/R/R-214~1.0/include"     -I"d:/RCompile/CRANpkg/extralibs/local/include"     -O3 -
> Wall  -std=gnu99 -mtune=core2 -c junk.c -o junk.
> o
> gcc -shared -s -static-libgcc -o junk.dll tmp.def junk.o -Ld:/RCompile/CRANpkg/extralibs/local/lib -
> LE:/PROGRA~1/R/R-214~1.0/bin/i386 -lR
> 
> E:\temp>type junk.c
> void my_junk(double *x)
> {
>     *x = *x + 100.0;
> }
> 
> E:\temp>R
> ... [elided startup messages] ...
> > dyn.load("junk.dll")
> > .C("my_junk", pi) # expect to get 100+3.14159265...
> [[1]]
> [1] 103.1416
> 
> >
> 
> Bill Dunlap
> Spotfire, TIBCO Software
> wdunlap tibco.com
> > -----Original Message-----
> > From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of Lorenzo
> > Sent: Wednesday, February 15, 2012 4:03 PM
> > To: r-devel at r-project.org
> > Subject: Re: [Rd] R CMD SHLIB in Windows XP - No output at all
> >
> > Hi Duncan,
> >
> > Thanks for your help, I am actually using R Windows version 2.14.1 (22th Dec
> > 2011).
> >
> > Actually by "R CMD SHLIB *.*" I actually meant putting any file name after
> > the R CMD SHLIB ("R CMD SHLIB convolve.c" for example).
> > Another case which fails is : creating a Rcpp Armadillo package skeleton
> > (named MyPackage for example) and trying the R CMD INSTALL MyPackage. Fails
> > as well on the R CMD SHLIB line.
> >
> > What I actually don't understand is how the R CMD SHLIB command links to the
> > RTools cygwin and mingw.
> > It really looks like the "make" function works in my command line when I use
> > it directly but the link between R CMD SHLIB and cygwin fails...
> >
> > --
> > View this message in context: http://r.789695.n4.nabble.com/R-CMD-SHLIB-in-Windows-XP-No-output-at-
> > all-tp4385797p4392482.html
> > Sent from the R devel mailing list archive at Nabble.com.
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From lorenzo.lucido at asia.bnpparibas.com  Thu Feb 16 06:06:13 2012
From: lorenzo.lucido at asia.bnpparibas.com (Lorenzo)
Date: Wed, 15 Feb 2012 21:06:13 -0800 (PST)
Subject: [Rd] R CMD SHLIB in Windows XP - No output at all
In-Reply-To: <E66794E69CFDE04D9A70842786030B9327B590@PA-MBX04.na.tibco.com>
References: <1329178163008-4385797.post@n4.nabble.com>
	<4F3BD2E0.8070602@gmail.com>
	<1329350587496-4392482.post@n4.nabble.com>
	<E66794E69CFDE04D9A70842786030B9327B563@PA-MBX04.na.tibco.com>
	<E66794E69CFDE04D9A70842786030B9327B590@PA-MBX04.na.tibco.com>
Message-ID: <1329368773328-4393012.post@n4.nabble.com>

Hi all,

Thanks a LOT for your help.

My issue actually came from the fact that my Renviron.site file was
modifying the path variable (I though windows path and R path were different
so hardcoded a path in Renviron.
Because of this, the command in R "tool::.SHLIB()" was crashing R without
any error message.

I can finally use Rcpp and RcppArmadillo, love it !

Best,
Lorenzo


--
View this message in context: http://r.789695.n4.nabble.com/R-CMD-SHLIB-in-Windows-XP-No-output-at-all-tp4385797p4393012.html
Sent from the R devel mailing list archive at Nabble.com.


From maechler at stat.math.ethz.ch  Thu Feb 16 12:39:20 2012
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 16 Feb 2012 12:39:20 +0100
Subject: [Rd] requesting a new SIG mailing list
In-Reply-To: <CAM_vjunNLcj7h9xHRz6FFhvAWHOrs-RuGQCEBuFU0qg6LbWkJw@mail.gmail.com>
References: <4F393ABA.4020806@jrc.ec.europa.eu>
	<CAM_vjunBbLcNA0nGP0FyqkL-h+ZwP6F45FEDiFA6GcxKr18+SQ@mail.gmail.com>
	<OF12FFE926.89CF684A-ON862579A4.0068F4F0-862579A4.0069B2AC@usgs.gov>
	<201202150907.21227.reusser@pik-potsdam.de>
	<4F3B8349.9010507@jrc.ec.europa.eu>
	<CAM_vjunNLcj7h9xHRz6FFhvAWHOrs-RuGQCEBuFU0qg6LbWkJw@mail.gmail.com>
Message-ID: <20284.60136.347334.135722@stat.math.ethz.ch>

Hi,

I'm the "site maintainer" of the R-SIG-... at r-project.org mailing
lists (and back from vacations).

>>>>> Sarah Goslee <sarah.goslee at gmail.com>
>>>>>     on Wed, 15 Feb 2012 12:16:01 -0500 writes:

    > Hi all,
    >> It would be great if Sara of someone of the maintainers
    >> of the r-sig-ecology list could add that info to the info page.

    > I'm talking with the other maintainer about revising both
    > the short and the long descriptions.

    >> I think that r-sig-env would be much more intuitive for
    >> environmental scientists coming from fields different
    >> from ecology, but I don't think it is possible to change
    >> the name of an existing mailing list.

yes, that would be only doable with much effort,
and (unless even more effort is put in) it would invalidate all
current links to the current archives etc. 

    >> However, I'm wondering if it would be possible to create
    >> an alias termed 'r-sig-env' to 'r-sig-ecology' ?, in
    >> order to make the name of the list more intuitive for
    >> environmental scientists but without disturbing the
    >> current users.

    > I don't know that there is any mechanism for doing either
    > of those things.  Changing the name would be disruptive,
    > and I don't know of an alias option. 

there is none, on the mailing list level.
On the mail server side, I could create such aliases,
but then these would only apply to e-mail addresses and the ML
software would still "speak" of the official ML name...

Given all the issues and opinions heard so far, I'd also
propose trying to have hydrologists and other env.scientists
join the r-sig-ecology for the time being.

Brian Ripley has already mentioned the very important point, 
that there's some often non-negligible admin overhead for each
list, and I can add that indeed, we have had several lists that
always remained too small and so never "started flying".

    > I think ecology is a more inclusive term than
    > environmental anyway, but then I'm an ecologist.

    > Sarah

ah, that's an interesting side issue, and at first somewhat
counter intuitive to a layman like me,... but after thinking a bit
about the meaning of the words, most will have to agree with you.
{but please let's not start a thread on that now..}

Martin Maechler, ETH Zurich


From sarah.goslee at gmail.com  Thu Feb 16 12:51:39 2012
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Thu, 16 Feb 2012 06:51:39 -0500
Subject: [Rd] requesting a new SIG mailing list
In-Reply-To: <20284.60136.347334.135722@stat.math.ethz.ch>
References: <4F393ABA.4020806@jrc.ec.europa.eu>
	<CAM_vjunBbLcNA0nGP0FyqkL-h+ZwP6F45FEDiFA6GcxKr18+SQ@mail.gmail.com>
	<OF12FFE926.89CF684A-ON862579A4.0068F4F0-862579A4.0069B2AC@usgs.gov>
	<201202150907.21227.reusser@pik-potsdam.de>
	<4F3B8349.9010507@jrc.ec.europa.eu>
	<CAM_vjunNLcj7h9xHRz6FFhvAWHOrs-RuGQCEBuFU0qg6LbWkJw@mail.gmail.com>
	<20284.60136.347334.135722@stat.math.ethz.ch>
Message-ID: <CAM_vjun5POqv1kzAQ8JXidv0H5RQmAiHSJnbmJCxFGeq=UnotA@mail.gmail.com>

Dear Martin,

Thank you for confirming what I'd already suspected
about the mailing list software.

I've added hydrology explicitly to the list description, and
hope that the hydrologists find it a welcoming home. We've
got a solid core of participants, so R users should
find it a useful resource.

Sarah

On Thu, Feb 16, 2012 at 6:39 AM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
> Hi,
>
> I'm the "site maintainer" of the R-SIG-... at r-project.org mailing
> lists (and back from vacations).
>
>>>>>> Sarah Goslee <sarah.goslee at gmail.com>
>>>>>> ? ? on Wed, 15 Feb 2012 12:16:01 -0500 writes:
>
> ? ?> Hi all,
> ? ?>> It would be great if Sara of someone of the maintainers
> ? ?>> of the r-sig-ecology list could add that info to the info page.
>
> ? ?> I'm talking with the other maintainer about revising both
> ? ?> the short and the long descriptions.
>
> ? ?>> I think that r-sig-env would be much more intuitive for
> ? ?>> environmental scientists coming from fields different
> ? ?>> from ecology, but I don't think it is possible to change
> ? ?>> the name of an existing mailing list.
>
> yes, that would be only doable with much effort,
> and (unless even more effort is put in) it would invalidate all
> current links to the current archives etc.
>
> ? ?>> However, I'm wondering if it would be possible to create
> ? ?>> an alias termed 'r-sig-env' to 'r-sig-ecology' ?, in
> ? ?>> order to make the name of the list more intuitive for
> ? ?>> environmental scientists but without disturbing the
> ? ?>> current users.
>
> ? ?> I don't know that there is any mechanism for doing either
> ? ?> of those things. ?Changing the name would be disruptive,
> ? ?> and I don't know of an alias option.
>
> there is none, on the mailing list level.
> On the mail server side, I could create such aliases,
> but then these would only apply to e-mail addresses and the ML
> software would still "speak" of the official ML name...
>
> Given all the issues and opinions heard so far, I'd also
> propose trying to have hydrologists and other env.scientists
> join the r-sig-ecology for the time being.
>
> Brian Ripley has already mentioned the very important point,
> that there's some often non-negligible admin overhead for each
> list, and I can add that indeed, we have had several lists that
> always remained too small and so never "started flying".
>


-- 
Sarah Goslee
http://www.functionaldiversity.org


From mauricio.zambrano at jrc.ec.europa.eu  Thu Feb 16 14:04:14 2012
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Thu, 16 Feb 2012 14:04:14 +0100
Subject: [Rd] requesting a new SIG mailing list
In-Reply-To: <CAM_vjun5POqv1kzAQ8JXidv0H5RQmAiHSJnbmJCxFGeq=UnotA@mail.gmail.com>
References: <4F393ABA.4020806@jrc.ec.europa.eu>
	<CAM_vjunBbLcNA0nGP0FyqkL-h+ZwP6F45FEDiFA6GcxKr18+SQ@mail.gmail.com>
	<OF12FFE926.89CF684A-ON862579A4.0068F4F0-862579A4.0069B2AC@usgs.gov>
	<201202150907.21227.reusser@pik-potsdam.de>
	<4F3B8349.9010507@jrc.ec.europa.eu>
	<CAM_vjunNLcj7h9xHRz6FFhvAWHOrs-RuGQCEBuFU0qg6LbWkJw@mail.gmail.com>
	<20284.60136.347334.135722@stat.math.ethz.ch>
	<CAM_vjun5POqv1kzAQ8JXidv0H5RQmAiHSJnbmJCxFGeq=UnotA@mail.gmail.com>
Message-ID: <4F3CFECE.4060106@jrc.ec.europa.eu>

On 16/02/12 12:51, Sarah Goslee wrote:
> Dear Martin,
>
> Thank you for confirming what I'd already suspected
> about the mailing list software.

What a pity that is not possible, but thank you very much Martin for 
confirming and explaining why is not possible.

>
> I've added hydrology explicitly to the list description, and
> hope that the hydrologists find it a welcoming home. We've
> got a solid core of participants, so R users should
> find it a useful resource.
>

It is decided then.
Thank you very much Sarah for adding hydrology to the description of the 
R-sig-ecology mailing list:

"The purpose of R-sig-ecology is two-fold. First, we want to provide a 
discussion forum for those analyzing ecological and environmental data 
with R, including but not limited to vegetation, soils and hydrology. 
Second, we want to encourage R users of all ability and experience to 
participate so that we may grow the community of ecologists and 
environmental scientists that use R."


Thank you all for taking part in this discussion. I'll start spreading 
the voice among colleagues.

I hope Dominik may mention this mailing list in the EGU 2012 short 
course "Hydrological Analysis in R":
http://meetingorganizer.copernicus.org/EGU2012/session/10635


All the best for the enhanced R-sig-ecology mailing list.

Mauricio Zambrano-Bigiarini

-- 
=======================================================
FLOODS Action
Water Resources Unit (H01)
Institute for Environment and Sustainability (IES)
European Commission, Joint Research Centre (JRC)
webinfo    : http://floods.jrc.ec.europa.eu/
=======================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as stating
an official position of the European Commission."
=======================================================
Linux user #454569 -- Ubuntu user #17469
=======================================================
"The greatest inspiration is often born of desperation."
(Comer Cotrell)

> Sarah
>
> On Thu, Feb 16, 2012 at 6:39 AM, Martin Maechler
> <maechler at stat.math.ethz.ch>  wrote:
>> Hi,
>>
>> I'm the "site maintainer" of the R-SIG-... at r-project.org mailing
>> lists (and back from vacations).
>>
>>>>>>> Sarah Goslee<sarah.goslee at gmail.com>
>>>>>>>      on Wed, 15 Feb 2012 12:16:01 -0500 writes:
>>
>>     >  Hi all,
>>     >>  It would be great if Sara of someone of the maintainers
>>     >>  of the r-sig-ecology list could add that info to the info page.
>>
>>     >  I'm talking with the other maintainer about revising both
>>     >  the short and the long descriptions.
>>
>>     >>  I think that r-sig-env would be much more intuitive for
>>     >>  environmental scientists coming from fields different
>>     >>  from ecology, but I don't think it is possible to change
>>     >>  the name of an existing mailing list.
>>
>> yes, that would be only doable with much effort,
>> and (unless even more effort is put in) it would invalidate all
>> current links to the current archives etc.
>>
>>     >>  However, I'm wondering if it would be possible to create
>>     >>  an alias termed 'r-sig-env' to 'r-sig-ecology' ?, in
>>     >>  order to make the name of the list more intuitive for
>>     >>  environmental scientists but without disturbing the
>>     >>  current users.
>>
>>     >  I don't know that there is any mechanism for doing either
>>     >  of those things.  Changing the name would be disruptive,
>>     >  and I don't know of an alias option.
>>
>> there is none, on the mailing list level.
>> On the mail server side, I could create such aliases,
>> but then these would only apply to e-mail addresses and the ML
>> software would still "speak" of the official ML name...
>>
>> Given all the issues and opinions heard so far, I'd also
>> propose trying to have hydrologists and other env.scientists
>> join the r-sig-ecology for the time being.
>>
>> Brian Ripley has already mentioned the very important point,
>> that there's some often non-negligible admin overhead for each
>> list, and I can add that indeed, we have had several lists that
>> always remained too small and so never "started flying".
>>
>
>


From gavin.simpson at ucl.ac.uk  Thu Feb 16 14:08:15 2012
From: gavin.simpson at ucl.ac.uk (Gavin Simpson)
Date: Thu, 16 Feb 2012 13:08:15 +0000
Subject: [Rd] requesting a new SIG mailing list
In-Reply-To: <CAM_vjunBbLcNA0nGP0FyqkL-h+ZwP6F45FEDiFA6GcxKr18+SQ@mail.gmail.com>
References: <4F393ABA.4020806@jrc.ec.europa.eu> <4F3A1D14.1050909@gmail.com>
	<4F3A8C71.4000407@jrc.ec.europa.eu>
	<CAM_vjunBbLcNA0nGP0FyqkL-h+ZwP6F45FEDiFA6GcxKr18+SQ@mail.gmail.com>
Message-ID: <1329397695.2603.19.camel@prometheus.geog.ucl.ac.uk>

On Tue, 2012-02-14 at 12:21 -0500, Sarah Goslee wrote:
> Hello,
> 
> I'm one of the maintainers of the r-sig-ecology list, and I think
> it would be entirely appropriate to include hydrology within
> the scope of the list.

I also agree. It was always the intention AFAICR for the R-SIG-Ecology
list to cover environmetrics in its fullest sense. With hindsight
R-SIG-Environ or something along those lines would have given the
impression of a wider focus for the list, but only in some quarters.

I do hope that the hydrologists do join us in asking and answering
questions on the R-SIG-Ecology list as both are needed for the list to
flourish.

G

> There hasn't been much hydrologic discussion, as you noted,
> but not because we wish to exclude it.
> 
> Sarah
> 
> On Tue, Feb 14, 2012 at 11:31 AM, Mauricio Zambrano-Bigiarini
> <mauricio.zambrano at jrc.ec.europa.eu> wrote:
> 
> > Another possibility could be to use the R-sig-ecology, which seems to be
> > more related to hydrology:
> >
> > "analytical techniques and topics that are appropriate for discussion on
> > R-sig-ecology are quite broad. For examples of what might be appropriate for
> > discussion on this list, please see the Environmentrics Task View
> > (http://cran.r-project.org/web/views/Environmetrics.html)"
> > (taken from: https://stat.ethz.ch/mailman/listinfo/r-sig-ecology)
> >
> > However, I did a quick search on the archives of 'R-sig-ecology' for the
> > year 2011, and I could only found one single mail related to hydrology:
> >
> > https://stat.ethz.ch/pipermail/r-sig-ecology/2011-July/002274.html
> >
> > (in the same search I couldn't find any single reference to hydrology in the
> > R-sig-geo during the year 2011)
> 

-- 
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
 Dr. Gavin Simpson             [t] +44 (0)20 7679 0522
 ECRC, UCL Geography,          [f] +44 (0)20 7679 0565
 Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk
 Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/
 UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%


From mtmorgan at fhcrc.org  Fri Feb 17 07:50:42 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Thu, 16 Feb 2012 22:50:42 -0800
Subject: [Rd] Parallel R CMD check?
Message-ID: <4F3DF8C2.4030800@fhcrc.org>

Running R CMD check on a package can take quite a lot of time. Checks 
seem like they could be run in parallel (separate processes for, e.g., 
codoc, examples, tests, ...). Is there a way to do this? My current 
usage is typically

    R CMD build <pkg>
    R CMD check pkg_x.y.z.tar.gz

Thanks for any hints,

Martin
-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From ripley at stats.ox.ac.uk  Fri Feb 17 10:42:30 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 17 Feb 2012 09:42:30 +0000
Subject: [Rd] Parallel R CMD check?
In-Reply-To: <4F3DF8C2.4030800@fhcrc.org>
References: <4F3DF8C2.4030800@fhcrc.org>
Message-ID: <4F3E2106.8080708@stats.ox.ac.uk>

On 17/02/2012 06:50, Martin Morgan wrote:
> Running R CMD check on a package can take quite a lot of time. Checks
> seem like they could be run in parallel (separate processes for, e.g.,
> codoc, examples, tests, ...). Is there a way to do this? My current
> usage is typically
>
> R CMD build <pkg>
> R CMD check pkg_x.y.z.tar.gz
>
> Thanks for any hints,

Not at present.  It would need a lot of re-organization of the check.R 
code to collect output and present it in a reasonable order.  I rather 
doubt is worth the effort: most of us with machines with large numbers 
of cores are not just checking one package at a time, and for many 
packages with long check times it is one aspect of the check which takes 
most of the time.

We have considered running separate tests and vignette R code in 
parallel: it was one of the motivations of having package 'parallel'. 
But even then people complained when we batched up all the test output 
and only reported it when all the tests had been run.

>
> Martin


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From bbolker at gmail.com  Fri Feb 17 17:31:18 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Fri, 17 Feb 2012 11:31:18 -0500
Subject: [Rd] building r-devel
Message-ID: <4F3E80D6.6030503@gmail.com>


  I'm sure I'm being an absolute bonehead (again), but can someone
suggest what I might be doing wrong?

 Trying to build latest r-devel on Ubuntu 10.04; as recommended in
various places, trying to build it in a separate build directory (since
starting to compose this e-mail I've found that it works if I build in
the original source directory [as disrecommended], so this has become a
less urgent question, but I'm still curious what I'm doing wrong).  I
configure, make (see details below), eventually get to
"/usr/bin/install: cannot create regular file
`../../include/Rinternals.h': No such file or directory
make[2]: *** [Rinternals.ts] Error 1".


  Any thoughts about what's going on here or what I can do to further
diagnose the problem?

  thanks
    Ben Bolker

==================

bolker at ubuntu-10:~/R/r-devel$ svn update
At revision 58379.

cd ../r-build
make distclean
../r-devel/configure


R is now configured for i686-pc-linux-gnu

  Source directory:          ../r-devel
  Installation directory:    /usr/local

  C compiler:                gcc -std=gnu99  -g -O2
  Fortran 77 compiler:       gfortran  -g -O2

  C++ compiler:              g++  -g -O2
  Fortran 90/95 compiler:    gfortran -g -O2
  Obj-C compiler:	

  Interfaces supported:      X11, tcltk
  External libraries:        readline
  Additional capabilities:   PNG, JPEG, NLS, cairo
  Options enabled:           shared BLAS, R profiling, Java

  Recommended packages:      yes

make

bolker at ubuntu-10:~/R/r-build$ make
make[1]: Entering directory `/mnt/hgfs/bolker/Documents/R/r-build/m4'
make[1]: Nothing to be done for `R'.
make[1]: Leaving directory `/mnt/hgfs/bolker/Documents/R/r-build/m4'
make[1]: Entering directory `/mnt/hgfs/bolker/Documents/R/r-build/tools'
make[1]: Nothing to be done for `R'.
make[1]: Leaving directory `/mnt/hgfs/bolker/Documents/R/r-build/tools'
make[1]: Entering directory `/mnt/hgfs/bolker/Documents/R/r-build/doc'
make[2]: Entering directory `/mnt/hgfs/bolker/Documents/R/r-build/doc/html'
make[3]: Entering directory `/mnt/hgfs/bolker/Documents/R/r-build/doc/html'
make[3]: Leaving directory `/mnt/hgfs/bolker/Documents/R/r-build/doc/html'
make[2]: Leaving directory `/mnt/hgfs/bolker/Documents/R/r-build/doc/html'
make[2]: Entering directory
`/mnt/hgfs/bolker/Documents/R/r-build/doc/manual'
make[2]: Nothing to be done for `R'.
make[2]: Leaving directory `/mnt/hgfs/bolker/Documents/R/r-build/doc/manual'
make[2]: Entering directory `/mnt/hgfs/bolker/Documents/R/r-build/doc'
make[2]: Leaving directory `/mnt/hgfs/bolker/Documents/R/r-build/doc'
make[1]: Leaving directory `/mnt/hgfs/bolker/Documents/R/r-build/doc'
make[1]: Entering directory `/mnt/hgfs/bolker/Documents/R/r-build/etc'
make[1]: Leaving directory `/mnt/hgfs/bolker/Documents/R/r-build/etc'
make[1]: Entering directory `/mnt/hgfs/bolker/Documents/R/r-build/share'
make[2]: Entering directory `/mnt/hgfs/bolker/Documents/R/r-build/share'
mkdir -p -- ../share/R
mkdir -p -- ../share/encodings
mkdir -p -- ../share/java
mkdir -p -- ../share/licenses
mkdir -p -- ../share/make
mkdir -p -- ../share/sh
mkdir -p -- ../share/texmf
mkdir -p -- ../share/texmf/bibtex/bib
mkdir -p -- ../share/texmf/bibtex/bst
mkdir -p -- ../share/texmf/tex/latex
make[2]: Leaving directory `/mnt/hgfs/bolker/Documents/R/r-build/share'
make[1]: Leaving directory `/mnt/hgfs/bolker/Documents/R/r-build/share'
make[1]: Entering directory `/mnt/hgfs/bolker/Documents/R/r-build/src'
make[2]: Entering directory
`/mnt/hgfs/bolker/Documents/R/r-build/src/scripts'
creating src/scripts/R.fe
make[3]: Entering directory
`/mnt/hgfs/bolker/Documents/R/r-build/src/scripts'
mkdir -p -- ../../bin
make[3]: Leaving directory
`/mnt/hgfs/bolker/Documents/R/r-build/src/scripts'
make[2]: Leaving directory
`/mnt/hgfs/bolker/Documents/R/r-build/src/scripts'
make[2]: Entering directory
`/mnt/hgfs/bolker/Documents/R/r-build/src/include'
/usr/bin/install: cannot create regular file
`../../include/Rinternals.h': No such file or directory
make[2]: *** [Rinternals.ts] Error 1
make[2]: Leaving directory
`/mnt/hgfs/bolker/Documents/R/r-build/src/include'
make[1]: *** [R] Error 1
make[1]: Leaving directory `/mnt/hgfs/bolker/Documents/R/r-build/src'
make: *** [R] Error 1


From mtmorgan at fhcrc.org  Fri Feb 17 19:19:47 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Fri, 17 Feb 2012 10:19:47 -0800
Subject: [Rd] Parallel R CMD check?
In-Reply-To: <4F3E2106.8080708@stats.ox.ac.uk>
References: <4F3DF8C2.4030800@fhcrc.org> <4F3E2106.8080708@stats.ox.ac.uk>
Message-ID: <4F3E9A43.3030305@fhcrc.org>

On 02/17/2012 01:42 AM, Prof Brian Ripley wrote:
> On 17/02/2012 06:50, Martin Morgan wrote:
>> Running R CMD check on a package can take quite a lot of time. Checks
>> seem like they could be run in parallel (separate processes for, e.g.,
>> codoc, examples, tests, ...). Is there a way to do this? My current
>> usage is typically
>>
>> R CMD build <pkg>
>> R CMD check pkg_x.y.z.tar.gz
>>
>> Thanks for any hints,
>
> Not at present. It would need a lot of re-organization of the check.R
> code to collect output and present it in a reasonable order. I rather
> doubt is worth the effort: most of us with machines with large numbers
> of cores are not just checking one package at a time, and for many
> packages with long check times it is one aspect of the check which takes
> most of the time.

OK thank you. My own 'issue' is that the package takes ~ 20s to load 
(because of dependencies). The check process seems to load the package 
at least 10 times, so 200s in package loading. I'm thinking of this from 
a package developer perspective, rather than checking many packages. 
Obviously from my end I can work to reduce the dependencies (and their 
loading times).

Martin


>
> We have considered running separate tests and vignette R code in
> parallel: it was one of the motivations of having package 'parallel'.
> But even then people complained when we batched up all the test output
> and only reported it when all the tests had been run.
>
>>
>> Martin
>
>


-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From pgilbert902 at gmail.com  Fri Feb 17 20:46:30 2012
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Fri, 17 Feb 2012 14:46:30 -0500
Subject: [Rd] Parallel R CMD check?
In-Reply-To: <4F3E9A43.3030305@fhcrc.org>
References: <4F3DF8C2.4030800@fhcrc.org> <4F3E2106.8080708@stats.ox.ac.uk>
	<4F3E9A43.3030305@fhcrc.org>
Message-ID: <4F3EAE96.4010406@gmail.com>



On 12-02-17 01:19 PM, Martin Morgan wrote:
> On 02/17/2012 01:42 AM, Prof Brian Ripley wrote:
>> On 17/02/2012 06:50, Martin Morgan wrote:
>>> Running R CMD check on a package can take quite a lot of time. Checks
>>> seem like they could be run in parallel (separate processes for, e.g.,
>>> codoc, examples, tests, ...). Is there a way to do this? My current
>>> usage is typically
>>>
>>> R CMD build <pkg>
>>> R CMD check pkg_x.y.z.tar.gz
>>>
>>> Thanks for any hints,
>>
>> Not at present. It would need a lot of re-organization of the check.R
>> code to collect output and present it in a reasonable order. I rather
>> doubt is worth the effort: most of us with machines with large numbers
>> of cores are not just checking one package at a time, and for many
>> packages with long check times it is one aspect of the check which takes
>> most of the time.
>
> OK thank you. My own 'issue' is that the package takes ~ 20s to load
> (because of dependencies). The check process seems to load the package
> at least 10 times, so 200s in package loading. I'm thinking of this from
> a package developer perspective, rather than checking many packages.
> Obviously from my end I can work to reduce the dependencies (and their
> loading times).

For my own package development testing I use a make target that does 
something like:
	R CMD BATCH  --vanilla tests/$(notdir $@)  $@.tmp
and then make -j  does all the tests in parallel. Of course, when the 
package is actually working this means that I run the tests twice, once 
individually with this target, and another time when I do R CMD check 
(then again on R-forge, and then on CRAN Kurt catches something I 
missed.)  So, when you are really in development mode the above target 
is useful, because you get to the failure point quickly, but if 
everything is working then it is slower.

Happy to share more details off-line if you want.

Paul

> Martin
>
>
>>
>> We have considered running separate tests and vignette R code in
>> parallel: it was one of the motivations of having package 'parallel'.
>> But even then people complained when we batched up all the test output
>> and only reported it when all the tests had been run.
>>
>>>
>>> Martin
>>
>>
>
>


From edd at debian.org  Fri Feb 17 20:46:41 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 17 Feb 2012 13:46:41 -0600
Subject: [Rd] building r-devel
In-Reply-To: <4F3E80D6.6030503@gmail.com>
References: <4F3E80D6.6030503@gmail.com>
Message-ID: <20286.44705.875487.758549@max.nulle.part>


Ben,

On 17 February 2012 at 11:31, Ben Bolker wrote:
| 
|   I'm sure I'm being an absolute bonehead (again), but can someone
| suggest what I might be doing wrong?
| 
|  Trying to build latest r-devel on Ubuntu 10.04; as recommended in

Happy to take this off-list --- I do build every now and then off R-devel's
SVN because R CMD check really wants to be done again R-release and R-devel
as that is what Vienna does...

I just invoke one simple shell script (which regroups the various configure
options) and have --prefix set to /usr/local/lib/R-devel, and all this works
pretty reliably.  Like you, I do build from the SVN dir. No issues AFAICT.

Dirk

-- 
"Outside of a dog, a book is a man's best friend. Inside of a dog, it is too
dark to read." -- Groucho Marx


From pauljohn32 at gmail.com  Fri Feb 17 21:57:26 2012
From: pauljohn32 at gmail.com (Paul Johnson)
Date: Fri, 17 Feb 2012 14:57:26 -0600
Subject: [Rd] portable parallel seeds project: request for critiques
Message-ID: <CAErODj-KZo+Am6a30pnVrPC-STw++500=QOi-rZaMsXYWzeX+Q@mail.gmail.com>

I've got another edition of my simulation replication framework.  I'm
attaching 2 R files and pasting in the readme.

I would especially like to know if I'm doing anything that breaks
.Random.seed or other things that R's parallel uses in the
environment.

In case you don't want to wrestle with attachments, the same files are
online in our SVN

http://winstat.quant.ku.edu/svn/hpcexample/trunk/Ex66-ParallelSeedPrototype/


## Paul E. Johnson CRMDA <pauljohn at ku.edu>
## Portable Parallel Seeds Project.
## 2012-02-18

Portable Parallel Seeds Project

This is how I'm going to recommend we work with random number seeds in
simulations. It enhances work that requires runs with random numbers,
whether runs are in a cluster computing environment or in a single
workstation.

It is a solution for two separate problems.

Problem 1. I scripted up 1000 R runs and need high quality,
unique, replicable random streams for each one. Each simulation
runs separately, but I need to be confident their streams are
not correlated or overlapping. For replication, I need to be able to
select any run, say 667, and restart it exactly as it was.

Problem 2. I've written a Parallel MPI (Message Passing Interface)
routine that launches 1000 runs and I need to assure each has
a unique, replicatable, random stream. I need to be able to
select any run, say 667, and restart it exactly as it was.

This project develops one approach to create replicable simulations.
It blends ideas about seed management from John M. Chambers
Software for Data Analysis (2008) with ideas from the snowFT
package by Hana Sevcikova and Tony R. Rossini.


Here's my proposal.

1. Run a preliminary program to generate an array of seeds

run1:   seed1.1   seed1.2   seed1.3
run2:   seed2.1   seed2.2   seed2.3
run3:   seed3.1   seed3.2   seed3.3
...      ...       ...
run1000   seed1000.1  seed1000.2   seed1000.3

This example provides 3 separate streams of random numbers within each
run. Because we will use the L'Ecuyer "many separate streams"
approach, we are confident that there is no correlation or overlap
between any of the runs.

The projSeeds has to have one row per project, but it is not a huge
file. I created seeds for 2000 runs of a project that requires 2 seeds
per run.  The saved size of the file 104443kb, which is very small. By
comparison, a 1400x1050 jpg image would usually be twice that size.
If you save 10,000 runs-worth of seeds, the size rises to 521,993kb,
still pretty small.

Because the seeds are saved in a file, we are sure each
run can be replicated. We just have to teach each program
how to use the seeds. That is step two.


2. Inside each run, an initialization function runs that loads the
seeds file and takes the row of seeds that it needs.  As the
simulation progresses, the user can ask for random numbers from the
separate streams. When we need random draws from a particular stream,
we set the variable "currentStream" with the function useStream().

The function initSeedStreams creates several objects in
the global environment. It sets the integer currentStream,
as well as two list objects, startSeeds and currentSeeds.
At the outset of the run, startSeeds and currentSeeds
are the same thing. When we change the currentStream
to a different stream, the currentSeeds vector is
updated to remember where that stream was when we stopped
drawing numbers from it.


Now, for the proof of concept. A working example.

Step 1. Create the Seeds. Review the R program

seedCreator.R

That creates the file "projSeeds.rda".


Step 2. Use one row of seeds per run.

Please review "controlledSeeds.R" to see an example usage
that I've tested on a cluster.

"controlledSeeds.R" can also be run on a single workstation for
testing purposes.  There is a variable "runningInMPI" which determines
whether the code is supposed to run on the RMPI cluster or just in a
single workstation.


The code for each run of the model begins by loading the
required libraries and loading the seed file, if it exists, or
generating a new "projSeed" object if it is not found.

library(parallel)
RNGkind("L'Ecuyer-CMRG")
set.seed(234234)
if (file.exists("projSeeds.rda")) {
  load("projSeeds.rda")
} else {
  source("seedCreator.R")
}

## Suppose the "run" number is:
run <- 232
initSeedStreams(run)	

After that, R's random generator functions will draw values
from the first random random stream that was initialized
in projSeeds. When each repetition (run) occurs,
R looks up the right seed for that run, and uses it.

If the user wants to begin drawing observations from the
second random stream, this command is used:

useStream(2)

If the user has drawn values from stream 1 already, but
wishes to begin again at the initial point in that stream,
use this command

useStream(1, origin = TRUE)


Question: Why is this approach better for parallel runs?

Answer: After a batch of simulations, we can re-start any
one of them and repeat it exactly. This builds on the idea
of the snowFT package, by Hana Sevcikova and A.J. Rossini.

That is different from the default approach of most R parallel
designs, including R's own parallel, RMPI and snow.

The ordinary way of controlling seeds in R parallel would initialize
the 50 nodes, and we would lose control over seeds because runs would
be repeatedly assigned to nodes. The aim here is to make sure that
each particular run has a known starting point. After a batch of
10,000 runs, we can look and say "something funny happened on run
1,323" and then we can bring that back to life later, easily.



Question: Why is this better than the simple old approach of
setting the seeds within each run with a formula like

set.seed(2345 + 10 * run)

Answer: That does allow replication, but it does not assure
that each run uses non-overlapping random number streams. It
offers absolutely no assurance whatsoever that the runs are
actually non-redundant.

Nevertheless, it is a method that is widely used and recommended
by some visible HOWTO guides.



Citations

Hana Sevcikova and A. J. Rossini (2010). snowFT: Fault Tolerant
 Simple Network of Workstations. R package version 1.2-0.
 http://CRAN.R-project.org/package=snowFT

John M Chambers (2008). SoDA: Functions and Exampels for "Software
  for Data Analysis". R package version 1.0-3.

John M Chambers (2008) Software for Data Analysis. Springer.


-- 
Paul E. Johnson
Professor, Political Science
1541 Lilac Lane, Room 504
University of Kansas

From sahir.bhatnagar at gmail.com  Fri Feb 17 21:58:50 2012
From: sahir.bhatnagar at gmail.com (sahir bhatnagar)
Date: Fri, 17 Feb 2012 15:58:50 -0500
Subject: [Rd] executable files R package
In-Reply-To: <4F3BCBD1.1050103@gmail.com>
References: <CAEV=kBNoZ5ooTQVpQmsV-P4jbMekg=KSw==O=fwCMPGL71Dx0Q@mail.gmail.com>
	<4F3BCBD1.1050103@gmail.com>
Message-ID: <CAEV=kBOXFsqJ=opfpPh3FgnVfM8sry0ir691JJOE=nr_AZvMfA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120217/df7eda4c/attachment.pl>

From wdunlap at tibco.com  Fri Feb 17 22:17:51 2012
From: wdunlap at tibco.com (William Dunlap)
Date: Fri, 17 Feb 2012 21:17:51 +0000
Subject: [Rd] executable files R package
In-Reply-To: <CAEV=kBOXFsqJ=opfpPh3FgnVfM8sry0ir691JJOE=nr_AZvMfA@mail.gmail.com>
References: <CAEV=kBNoZ5ooTQVpQmsV-P4jbMekg=KSw==O=fwCMPGL71Dx0Q@mail.gmail.com>
	<4F3BCBD1.1050103@gmail.com>
	<CAEV=kBOXFsqJ=opfpPh3FgnVfM8sry0ir691JJOE=nr_AZvMfA@mail.gmail.com>
Message-ID: <E66794E69CFDE04D9A70842786030B9327C43F@PA-MBX04.na.tibco.com>

If you put your prebuilt.exe into a directory under the
'source' package's inst directory, say yourPkg/inst/executables/win32,
then the installed package will have them in in
yourPkg/executables/win32 and the user (via code you
write, presumably) can get the full path to the executable
in the installed package with
  system.file(package="yourPkg", "executables", "win32", "prebuilt.exe").
Paste the output of that into the command given to system().

Bill Dunlap
Spotfire, TIBCO Software
wdunlap tibco.com 

> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of sahir
> bhatnagar
> Sent: Friday, February 17, 2012 12:59 PM
> To: Duncan Murdoch
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] executable files R package
> 
> thanks,
> I will not submit to CRAN.
> 
> I am having trouble going about including the .exe files in my package.
> >From the readings I see that the .exe files must be placed in a 'src'
> folder. But I don't see how I can access those files in R, without having
> to specify its path in the R command 'system'. I would like for the user to
> only have to input a data file, which is then used in the .exe file.
> 
> My problem is the following:
> Create a function which has two user inputs i.e. datasets: D1.txt and D2.txt
> I have two '.exe' files i.e. E1.exe and E2.exe
> 
> E1 takes in D1 and then outputs a text file say "text"
> 
> then E2 takes in D2 and the "text", which outputs the result.
> 
> Can this be done (even if it means having two functions) and then assembled
> in a package, without the user having to specify the path of the .exe
> files, as well as the "text" that is outputted from running E1?
> 
> Any direction as to how I can go about creating a package that would
> include these '.exe. files? I have only found documentation on calling .C
> code in R.
> 
> Any help is much appreciated
> 
> On Wed, Feb 15, 2012 at 10:14 AM, Duncan Murdoch
> <murdoch.duncan at gmail.com>wrote:
> 
> > On 13/02/2012 2:36 PM, sahir bhatnagar wrote:
> >
> >> I am in the process of creating a package in R which calls
> >> pre-compiled C code i.e. '.exe' files in Windows.
> >>
> >> Since CRAN will not accept packages with binary code files, what are
> >> my options to meet the requirements while still including the
> >> executable file?
> >>
> >
> > I think you should ask the CRAN administrators that, but my understanding
> > is that they are unlikely to accept your package as described.  CRAN is
> > interested in platform-neutral packages, and if you have an .exe, you're
> > going to be Windows-only.
> >
> > If you include the source code for that .exe and put together the Makefile
> > to compile it, then they'd be more receptive, and someone might offer help
> > to get it to run on other platforms if it doesn't on your first attempt.
> >
> > If you don't want to include the .exe source (or can't), I think you
> > should just publish it on your own web page.
> >
> > Duncan Murdoch
> >
> >  I read section 1.5.2 of the manual which mentions three options two of
> >> which involve negotiating with CRAN administrators. The third
> >> references the package Cairo which arranges to download additional
> >> software, but I don't see how this will allow my package to get
> >> accepted.
> >>
> >> It would seem that I need to ensure that my package works under both
> >> architectures (32 and 64 bit).
> >>
> >> 1) Would this be sufficient to get it accepted?
> >> 2) If so, does anyone have any documentation in performing this task,
> >> or can someone point me in the right direction?
> >>
> >> I was told that 'arulesSequences' is an example of a CRAN package
> >> while compiles executables. Was this package accepted because it
> >> worked under both architectures? or are there other reasons.
> >>
> >> thanks
> >>
> >> ______________________________**________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/**listinfo/r-devel<https://stat.ethz.ch/mailman/listinfo/r-devel>
> >>
> >
> >
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From pgilbert902 at gmail.com  Fri Feb 17 22:23:21 2012
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Fri, 17 Feb 2012 16:23:21 -0500
Subject: [Rd] portable parallel seeds project: request for critiques
In-Reply-To: <CAErODj-KZo+Am6a30pnVrPC-STw++500=QOi-rZaMsXYWzeX+Q@mail.gmail.com>
References: <CAErODj-KZo+Am6a30pnVrPC-STw++500=QOi-rZaMsXYWzeX+Q@mail.gmail.com>
Message-ID: <4F3EC549.1040001@gmail.com>

Paul

I think (perhaps incorrectly) of the general problem being that one 
wants to run a random experiment, on a single node, or two nodes, or ten 
nodes, or any number of nodes, and reliably be able to reproduce the 
experiment without concern about how many nodes it runs on when you 
re-run it.

 From your description I don't have the impression your solution would 
do that. Am I misunderstanding?

A second problem is that you want to use a proven algorithm for 
generating the numbers. This is implicitly solved by the above, because 
you always get the same result as you do on one node with a well proven 
RNG. If you generate a string of seed and then numbers from those, do 
you have a proven RNG?

Paul

On 12-02-17 03:57 PM, Paul Johnson wrote:
> I've got another edition of my simulation replication framework.  I'm
> attaching 2 R files and pasting in the readme.
>
> I would especially like to know if I'm doing anything that breaks
> .Random.seed or other things that R's parallel uses in the
> environment.
>
> In case you don't want to wrestle with attachments, the same files are
> online in our SVN
>
> http://winstat.quant.ku.edu/svn/hpcexample/trunk/Ex66-ParallelSeedPrototype/
>
>
> ## Paul E. Johnson CRMDA<pauljohn at ku.edu>
> ## Portable Parallel Seeds Project.
> ## 2012-02-18
>
> Portable Parallel Seeds Project
>
> This is how I'm going to recommend we work with random number seeds in
> simulations. It enhances work that requires runs with random numbers,
> whether runs are in a cluster computing environment or in a single
> workstation.
>
> It is a solution for two separate problems.
>
> Problem 1. I scripted up 1000 R runs and need high quality,
> unique, replicable random streams for each one. Each simulation
> runs separately, but I need to be confident their streams are
> not correlated or overlapping. For replication, I need to be able to
> select any run, say 667, and restart it exactly as it was.
>
> Problem 2. I've written a Parallel MPI (Message Passing Interface)
> routine that launches 1000 runs and I need to assure each has
> a unique, replicatable, random stream. I need to be able to
> select any run, say 667, and restart it exactly as it was.
>
> This project develops one approach to create replicable simulations.
> It blends ideas about seed management from John M. Chambers
> Software for Data Analysis (2008) with ideas from the snowFT
> package by Hana Sevcikova and Tony R. Rossini.
>
>
> Here's my proposal.
>
> 1. Run a preliminary program to generate an array of seeds
>
> run1:   seed1.1   seed1.2   seed1.3
> run2:   seed2.1   seed2.2   seed2.3
> run3:   seed3.1   seed3.2   seed3.3
> ...      ...       ...
> run1000   seed1000.1  seed1000.2   seed1000.3
>
> This example provides 3 separate streams of random numbers within each
> run. Because we will use the L'Ecuyer "many separate streams"
> approach, we are confident that there is no correlation or overlap
> between any of the runs.
>
> The projSeeds has to have one row per project, but it is not a huge
> file. I created seeds for 2000 runs of a project that requires 2 seeds
> per run.  The saved size of the file 104443kb, which is very small. By
> comparison, a 1400x1050 jpg image would usually be twice that size.
> If you save 10,000 runs-worth of seeds, the size rises to 521,993kb,
> still pretty small.
>
> Because the seeds are saved in a file, we are sure each
> run can be replicated. We just have to teach each program
> how to use the seeds. That is step two.
>
>
> 2. Inside each run, an initialization function runs that loads the
> seeds file and takes the row of seeds that it needs.  As the
> simulation progresses, the user can ask for random numbers from the
> separate streams. When we need random draws from a particular stream,
> we set the variable "currentStream" with the function useStream().
>
> The function initSeedStreams creates several objects in
> the global environment. It sets the integer currentStream,
> as well as two list objects, startSeeds and currentSeeds.
> At the outset of the run, startSeeds and currentSeeds
> are the same thing. When we change the currentStream
> to a different stream, the currentSeeds vector is
> updated to remember where that stream was when we stopped
> drawing numbers from it.
>
>
> Now, for the proof of concept. A working example.
>
> Step 1. Create the Seeds. Review the R program
>
> seedCreator.R
>
> That creates the file "projSeeds.rda".
>
>
> Step 2. Use one row of seeds per run.
>
> Please review "controlledSeeds.R" to see an example usage
> that I've tested on a cluster.
>
> "controlledSeeds.R" can also be run on a single workstation for
> testing purposes.  There is a variable "runningInMPI" which determines
> whether the code is supposed to run on the RMPI cluster or just in a
> single workstation.
>
>
> The code for each run of the model begins by loading the
> required libraries and loading the seed file, if it exists, or
> generating a new "projSeed" object if it is not found.
>
> library(parallel)
> RNGkind("L'Ecuyer-CMRG")
> set.seed(234234)
> if (file.exists("projSeeds.rda")) {
>    load("projSeeds.rda")
> } else {
>    source("seedCreator.R")
> }
>
> ## Suppose the "run" number is:
> run<- 232
> initSeedStreams(run)	
>
> After that, R's random generator functions will draw values
> from the first random random stream that was initialized
> in projSeeds. When each repetition (run) occurs,
> R looks up the right seed for that run, and uses it.
>
> If the user wants to begin drawing observations from the
> second random stream, this command is used:
>
> useStream(2)
>
> If the user has drawn values from stream 1 already, but
> wishes to begin again at the initial point in that stream,
> use this command
>
> useStream(1, origin = TRUE)
>
>
> Question: Why is this approach better for parallel runs?
>
> Answer: After a batch of simulations, we can re-start any
> one of them and repeat it exactly. This builds on the idea
> of the snowFT package, by Hana Sevcikova and A.J. Rossini.
>
> That is different from the default approach of most R parallel
> designs, including R's own parallel, RMPI and snow.
>
> The ordinary way of controlling seeds in R parallel would initialize
> the 50 nodes, and we would lose control over seeds because runs would
> be repeatedly assigned to nodes. The aim here is to make sure that
> each particular run has a known starting point. After a batch of
> 10,000 runs, we can look and say "something funny happened on run
> 1,323" and then we can bring that back to life later, easily.
>
>
>
> Question: Why is this better than the simple old approach of
> setting the seeds within each run with a formula like
>
> set.seed(2345 + 10 * run)
>
> Answer: That does allow replication, but it does not assure
> that each run uses non-overlapping random number streams. It
> offers absolutely no assurance whatsoever that the runs are
> actually non-redundant.
>
> Nevertheless, it is a method that is widely used and recommended
> by some visible HOWTO guides.
>
>
>
> Citations
>
> Hana Sevcikova and A. J. Rossini (2010). snowFT: Fault Tolerant
>   Simple Network of Workstations. R package version 1.2-0.
>   http://CRAN.R-project.org/package=snowFT
>
> John M Chambers (2008). SoDA: Functions and Exampels for "Software
>    for Data Analysis". R package version 1.0-3.
>
> John M Chambers (2008) Software for Data Analysis. Springer.
>
>
>
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From pauljohn32 at gmail.com  Fri Feb 17 22:44:04 2012
From: pauljohn32 at gmail.com (Paul Johnson)
Date: Fri, 17 Feb 2012 15:44:04 -0600
Subject: [Rd] portable parallel seeds project: request for critiques
In-Reply-To: <4F3EC549.1040001@gmail.com>
References: <CAErODj-KZo+Am6a30pnVrPC-STw++500=QOi-rZaMsXYWzeX+Q@mail.gmail.com>
	<4F3EC549.1040001@gmail.com>
Message-ID: <CAErODj9J3G7QhQsFkVy7ToWavGHqU4Xg8wmLHz62ud4Mjh6M4Q@mail.gmail.com>

On Fri, Feb 17, 2012 at 3:23 PM, Paul Gilbert <pgilbert902 at gmail.com> wrote:
> Paul
>
> I think (perhaps incorrectly) of the general problem being that one wants to
> run a random experiment, on a single node, or two nodes, or ten nodes, or
> any number of nodes, and reliably be able to reproduce the experiment
> without concern about how many nodes it runs on when you re-run it.
>
> From your description I don't have the impression your solution would do
> that. Am I misunderstanding?
>

Well, I think my approach does that!  Each time a function runs, it grabs
a pre-specified set of seed values and initializes the R .Random.seed
appropriately.

Since I take the pre-specified seeds from the L'Ecuyer et al approach
(cite below), I believe that
means each separate stream is dependably uncorrelated and non-overlapping, both
within a particular run and across runs.

> A second problem is that you want to use a proven algorithm for generating
> the numbers. This is implicitly solved by the above, because you always get
> the same result as you do on one node with a well proven RNG. If you
> generate a string of seed and then numbers from those, do you have a proven
> RNG?
>
Luckily, I think that part was solved by people other than me:

L'Ecuyer, P., Simard, R., Chen, E. J. and Kelton, W. D. (2002) An
object-oriented random-number package with many long streams and
substreams. Operations Research 50 1073?5.
http://www.iro.umontreal.ca/~lecuyer/myftp/papers/streams00.pdf



> Paul
>
>
> On 12-02-17 03:57 PM, Paul Johnson wrote:
>>
>> I've got another edition of my simulation replication framework. ?I'm
>> attaching 2 R files and pasting in the readme.
>>
>> I would especially like to know if I'm doing anything that breaks
>> .Random.seed or other things that R's parallel uses in the
>> environment.
>>
>> In case you don't want to wrestle with attachments, the same files are
>> online in our SVN
>>
>>
>> http://winstat.quant.ku.edu/svn/hpcexample/trunk/Ex66-ParallelSeedPrototype/
>>
>>
>> ## Paul E. Johnson CRMDA<pauljohn at ku.edu>
>> ## Portable Parallel Seeds Project.
>> ## 2012-02-18
>>
>> Portable Parallel Seeds Project
>>
>> This is how I'm going to recommend we work with random number seeds in
>> simulations. It enhances work that requires runs with random numbers,
>> whether runs are in a cluster computing environment or in a single
>> workstation.
>>
>> It is a solution for two separate problems.
>>
>> Problem 1. I scripted up 1000 R runs and need high quality,
>> unique, replicable random streams for each one. Each simulation
>> runs separately, but I need to be confident their streams are
>> not correlated or overlapping. For replication, I need to be able to
>> select any run, say 667, and restart it exactly as it was.
>>
>> Problem 2. I've written a Parallel MPI (Message Passing Interface)
>> routine that launches 1000 runs and I need to assure each has
>> a unique, replicatable, random stream. I need to be able to
>> select any run, say 667, and restart it exactly as it was.
>>
>> This project develops one approach to create replicable simulations.
>> It blends ideas about seed management from John M. Chambers
>> Software for Data Analysis (2008) with ideas from the snowFT
>> package by Hana Sevcikova and Tony R. Rossini.
>>
>>
>> Here's my proposal.
>>
>> 1. Run a preliminary program to generate an array of seeds
>>
>> run1: ? seed1.1 ? seed1.2 ? seed1.3
>> run2: ? seed2.1 ? seed2.2 ? seed2.3
>> run3: ? seed3.1 ? seed3.2 ? seed3.3
>> ... ? ? ?... ? ? ? ...
>> run1000 ? seed1000.1 ?seed1000.2 ? seed1000.3
>>
>> This example provides 3 separate streams of random numbers within each
>> run. Because we will use the L'Ecuyer "many separate streams"
>> approach, we are confident that there is no correlation or overlap
>> between any of the runs.
>>
>> The projSeeds has to have one row per project, but it is not a huge
>> file. I created seeds for 2000 runs of a project that requires 2 seeds
>> per run. ?The saved size of the file 104443kb, which is very small. By
>> comparison, a 1400x1050 jpg image would usually be twice that size.
>> If you save 10,000 runs-worth of seeds, the size rises to 521,993kb,
>> still pretty small.
>>
>> Because the seeds are saved in a file, we are sure each
>> run can be replicated. We just have to teach each program
>> how to use the seeds. That is step two.
>>
>>
>> 2. Inside each run, an initialization function runs that loads the
>> seeds file and takes the row of seeds that it needs. ?As the
>> simulation progresses, the user can ask for random numbers from the
>> separate streams. When we need random draws from a particular stream,
>> we set the variable "currentStream" with the function useStream().
>>
>> The function initSeedStreams creates several objects in
>> the global environment. It sets the integer currentStream,
>> as well as two list objects, startSeeds and currentSeeds.
>> At the outset of the run, startSeeds and currentSeeds
>> are the same thing. When we change the currentStream
>> to a different stream, the currentSeeds vector is
>> updated to remember where that stream was when we stopped
>> drawing numbers from it.
>>
>>
>> Now, for the proof of concept. A working example.
>>
>> Step 1. Create the Seeds. Review the R program
>>
>> seedCreator.R
>>
>> That creates the file "projSeeds.rda".
>>
>>
>> Step 2. Use one row of seeds per run.
>>
>> Please review "controlledSeeds.R" to see an example usage
>> that I've tested on a cluster.
>>
>> "controlledSeeds.R" can also be run on a single workstation for
>> testing purposes. ?There is a variable "runningInMPI" which determines
>> whether the code is supposed to run on the RMPI cluster or just in a
>> single workstation.
>>
>>
>> The code for each run of the model begins by loading the
>> required libraries and loading the seed file, if it exists, or
>> generating a new "projSeed" object if it is not found.
>>
>> library(parallel)
>> RNGkind("L'Ecuyer-CMRG")
>> set.seed(234234)
>> if (file.exists("projSeeds.rda")) {
>> ? load("projSeeds.rda")
>> } else {
>> ? source("seedCreator.R")
>> }
>>
>> ## Suppose the "run" number is:
>> run<- 232
>> initSeedStreams(run)
>>
>> After that, R's random generator functions will draw values
>> from the first random random stream that was initialized
>> in projSeeds. When each repetition (run) occurs,
>> R looks up the right seed for that run, and uses it.
>>
>> If the user wants to begin drawing observations from the
>> second random stream, this command is used:
>>
>> useStream(2)
>>
>> If the user has drawn values from stream 1 already, but
>> wishes to begin again at the initial point in that stream,
>> use this command
>>
>> useStream(1, origin = TRUE)
>>
>>
>> Question: Why is this approach better for parallel runs?
>>
>> Answer: After a batch of simulations, we can re-start any
>> one of them and repeat it exactly. This builds on the idea
>> of the snowFT package, by Hana Sevcikova and A.J. Rossini.
>>
>> That is different from the default approach of most R parallel
>> designs, including R's own parallel, RMPI and snow.
>>
>> The ordinary way of controlling seeds in R parallel would initialize
>> the 50 nodes, and we would lose control over seeds because runs would
>> be repeatedly assigned to nodes. The aim here is to make sure that
>> each particular run has a known starting point. After a batch of
>> 10,000 runs, we can look and say "something funny happened on run
>> 1,323" and then we can bring that back to life later, easily.
>>
>>
>>
>> Question: Why is this better than the simple old approach of
>> setting the seeds within each run with a formula like
>>
>> set.seed(2345 + 10 * run)
>>
>> Answer: That does allow replication, but it does not assure
>> that each run uses non-overlapping random number streams. It
>> offers absolutely no assurance whatsoever that the runs are
>> actually non-redundant.
>>
>> Nevertheless, it is a method that is widely used and recommended
>> by some visible HOWTO guides.
>>
>>
>>
>> Citations
>>
>> Hana Sevcikova and A. J. Rossini (2010). snowFT: Fault Tolerant
>> ?Simple Network of Workstations. R package version 1.2-0.
>> ?http://CRAN.R-project.org/package=snowFT
>>
>> John M Chambers (2008). SoDA: Functions and Exampels for "Software
>> ? for Data Analysis". R package version 1.0-3.
>>
>> John M Chambers (2008) Software for Data Analysis. Springer.
>>
>>
>>
>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
Paul E. Johnson
Professor, Political Science
1541 Lilac Lane, Room 504
University of Kansas


From pgilbert902 at gmail.com  Fri Feb 17 23:52:17 2012
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Fri, 17 Feb 2012 17:52:17 -0500
Subject: [Rd] portable parallel seeds project: request for critiques
In-Reply-To: <CAErODj9J3G7QhQsFkVy7ToWavGHqU4Xg8wmLHz62ud4Mjh6M4Q@mail.gmail.com>
References: <CAErODj-KZo+Am6a30pnVrPC-STw++500=QOi-rZaMsXYWzeX+Q@mail.gmail.com>
	<4F3EC549.1040001@gmail.com>
	<CAErODj9J3G7QhQsFkVy7ToWavGHqU4Xg8wmLHz62ud4Mjh6M4Q@mail.gmail.com>
Message-ID: <4F3EDA21.6050107@gmail.com>

Ok, I guess I need to look more carefully.

Thanks,
Paul

On 12-02-17 04:44 PM, Paul Johnson wrote:
> On Fri, Feb 17, 2012 at 3:23 PM, Paul Gilbert<pgilbert902 at gmail.com>  wrote:
>> Paul
>>
>> I think (perhaps incorrectly) of the general problem being that one wants to
>> run a random experiment, on a single node, or two nodes, or ten nodes, or
>> any number of nodes, and reliably be able to reproduce the experiment
>> without concern about how many nodes it runs on when you re-run it.
>>
>>  From your description I don't have the impression your solution would do
>> that. Am I misunderstanding?
>>
>
> Well, I think my approach does that!  Each time a function runs, it grabs
> a pre-specified set of seed values and initializes the R .Random.seed
> appropriately.
>
> Since I take the pre-specified seeds from the L'Ecuyer et al approach
> (cite below), I believe that
> means each separate stream is dependably uncorrelated and non-overlapping, both
> within a particular run and across runs.
>
>> A second problem is that you want to use a proven algorithm for generating
>> the numbers. This is implicitly solved by the above, because you always get
>> the same result as you do on one node with a well proven RNG. If you
>> generate a string of seed and then numbers from those, do you have a proven
>> RNG?
>>
> Luckily, I think that part was solved by people other than me:
>
> L'Ecuyer, P., Simard, R., Chen, E. J. and Kelton, W. D. (2002) An
> object-oriented random-number package with many long streams and
> substreams. Operations Research 50 1073?5.
> http://www.iro.umontreal.ca/~lecuyer/myftp/papers/streams00.pdf
>
>
>
>> Paul
>>
>>
>> On 12-02-17 03:57 PM, Paul Johnson wrote:
>>>
>>> I've got another edition of my simulation replication framework.  I'm
>>> attaching 2 R files and pasting in the readme.
>>>
>>> I would especially like to know if I'm doing anything that breaks
>>> .Random.seed or other things that R's parallel uses in the
>>> environment.
>>>
>>> In case you don't want to wrestle with attachments, the same files are
>>> online in our SVN
>>>
>>>
>>> http://winstat.quant.ku.edu/svn/hpcexample/trunk/Ex66-ParallelSeedPrototype/
>>>
>>>
>>> ## Paul E. Johnson CRMDA<pauljohn at ku.edu>
>>> ## Portable Parallel Seeds Project.
>>> ## 2012-02-18
>>>
>>> Portable Parallel Seeds Project
>>>
>>> This is how I'm going to recommend we work with random number seeds in
>>> simulations. It enhances work that requires runs with random numbers,
>>> whether runs are in a cluster computing environment or in a single
>>> workstation.
>>>
>>> It is a solution for two separate problems.
>>>
>>> Problem 1. I scripted up 1000 R runs and need high quality,
>>> unique, replicable random streams for each one. Each simulation
>>> runs separately, but I need to be confident their streams are
>>> not correlated or overlapping. For replication, I need to be able to
>>> select any run, say 667, and restart it exactly as it was.
>>>
>>> Problem 2. I've written a Parallel MPI (Message Passing Interface)
>>> routine that launches 1000 runs and I need to assure each has
>>> a unique, replicatable, random stream. I need to be able to
>>> select any run, say 667, and restart it exactly as it was.
>>>
>>> This project develops one approach to create replicable simulations.
>>> It blends ideas about seed management from John M. Chambers
>>> Software for Data Analysis (2008) with ideas from the snowFT
>>> package by Hana Sevcikova and Tony R. Rossini.
>>>
>>>
>>> Here's my proposal.
>>>
>>> 1. Run a preliminary program to generate an array of seeds
>>>
>>> run1:   seed1.1   seed1.2   seed1.3
>>> run2:   seed2.1   seed2.2   seed2.3
>>> run3:   seed3.1   seed3.2   seed3.3
>>> ...      ...       ...
>>> run1000   seed1000.1  seed1000.2   seed1000.3
>>>
>>> This example provides 3 separate streams of random numbers within each
>>> run. Because we will use the L'Ecuyer "many separate streams"
>>> approach, we are confident that there is no correlation or overlap
>>> between any of the runs.
>>>
>>> The projSeeds has to have one row per project, but it is not a huge
>>> file. I created seeds for 2000 runs of a project that requires 2 seeds
>>> per run.  The saved size of the file 104443kb, which is very small. By
>>> comparison, a 1400x1050 jpg image would usually be twice that size.
>>> If you save 10,000 runs-worth of seeds, the size rises to 521,993kb,
>>> still pretty small.
>>>
>>> Because the seeds are saved in a file, we are sure each
>>> run can be replicated. We just have to teach each program
>>> how to use the seeds. That is step two.
>>>
>>>
>>> 2. Inside each run, an initialization function runs that loads the
>>> seeds file and takes the row of seeds that it needs.  As the
>>> simulation progresses, the user can ask for random numbers from the
>>> separate streams. When we need random draws from a particular stream,
>>> we set the variable "currentStream" with the function useStream().
>>>
>>> The function initSeedStreams creates several objects in
>>> the global environment. It sets the integer currentStream,
>>> as well as two list objects, startSeeds and currentSeeds.
>>> At the outset of the run, startSeeds and currentSeeds
>>> are the same thing. When we change the currentStream
>>> to a different stream, the currentSeeds vector is
>>> updated to remember where that stream was when we stopped
>>> drawing numbers from it.
>>>
>>>
>>> Now, for the proof of concept. A working example.
>>>
>>> Step 1. Create the Seeds. Review the R program
>>>
>>> seedCreator.R
>>>
>>> That creates the file "projSeeds.rda".
>>>
>>>
>>> Step 2. Use one row of seeds per run.
>>>
>>> Please review "controlledSeeds.R" to see an example usage
>>> that I've tested on a cluster.
>>>
>>> "controlledSeeds.R" can also be run on a single workstation for
>>> testing purposes.  There is a variable "runningInMPI" which determines
>>> whether the code is supposed to run on the RMPI cluster or just in a
>>> single workstation.
>>>
>>>
>>> The code for each run of the model begins by loading the
>>> required libraries and loading the seed file, if it exists, or
>>> generating a new "projSeed" object if it is not found.
>>>
>>> library(parallel)
>>> RNGkind("L'Ecuyer-CMRG")
>>> set.seed(234234)
>>> if (file.exists("projSeeds.rda")) {
>>>    load("projSeeds.rda")
>>> } else {
>>>    source("seedCreator.R")
>>> }
>>>
>>> ## Suppose the "run" number is:
>>> run<- 232
>>> initSeedStreams(run)
>>>
>>> After that, R's random generator functions will draw values
>>> from the first random random stream that was initialized
>>> in projSeeds. When each repetition (run) occurs,
>>> R looks up the right seed for that run, and uses it.
>>>
>>> If the user wants to begin drawing observations from the
>>> second random stream, this command is used:
>>>
>>> useStream(2)
>>>
>>> If the user has drawn values from stream 1 already, but
>>> wishes to begin again at the initial point in that stream,
>>> use this command
>>>
>>> useStream(1, origin = TRUE)
>>>
>>>
>>> Question: Why is this approach better for parallel runs?
>>>
>>> Answer: After a batch of simulations, we can re-start any
>>> one of them and repeat it exactly. This builds on the idea
>>> of the snowFT package, by Hana Sevcikova and A.J. Rossini.
>>>
>>> That is different from the default approach of most R parallel
>>> designs, including R's own parallel, RMPI and snow.
>>>
>>> The ordinary way of controlling seeds in R parallel would initialize
>>> the 50 nodes, and we would lose control over seeds because runs would
>>> be repeatedly assigned to nodes. The aim here is to make sure that
>>> each particular run has a known starting point. After a batch of
>>> 10,000 runs, we can look and say "something funny happened on run
>>> 1,323" and then we can bring that back to life later, easily.
>>>
>>>
>>>
>>> Question: Why is this better than the simple old approach of
>>> setting the seeds within each run with a formula like
>>>
>>> set.seed(2345 + 10 * run)
>>>
>>> Answer: That does allow replication, but it does not assure
>>> that each run uses non-overlapping random number streams. It
>>> offers absolutely no assurance whatsoever that the runs are
>>> actually non-redundant.
>>>
>>> Nevertheless, it is a method that is widely used and recommended
>>> by some visible HOWTO guides.
>>>
>>>
>>>
>>> Citations
>>>
>>> Hana Sevcikova and A. J. Rossini (2010). snowFT: Fault Tolerant
>>>   Simple Network of Workstations. R package version 1.2-0.
>>>   http://CRAN.R-project.org/package=snowFT
>>>
>>> John M Chambers (2008). SoDA: Functions and Exampels for "Software
>>>    for Data Analysis". R package version 1.0-3.
>>>
>>> John M Chambers (2008) Software for Data Analysis. Springer.
>>>
>>>
>>>
>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>


From savicky at cs.cas.cz  Sat Feb 18 00:06:33 2012
From: savicky at cs.cas.cz (Petr Savicky)
Date: Sat, 18 Feb 2012 00:06:33 +0100
Subject: [Rd] portable parallel seeds project: request for critiques
In-Reply-To: <CAErODj-KZo+Am6a30pnVrPC-STw++500=QOi-rZaMsXYWzeX+Q@mail.gmail.com>
References: <CAErODj-KZo+Am6a30pnVrPC-STw++500=QOi-rZaMsXYWzeX+Q@mail.gmail.com>
Message-ID: <20120217230633.GA19243@cs.cas.cz>

On Fri, Feb 17, 2012 at 02:57:26PM -0600, Paul Johnson wrote:
> I've got another edition of my simulation replication framework.  I'm
> attaching 2 R files and pasting in the readme.
> 
> I would especially like to know if I'm doing anything that breaks
> .Random.seed or other things that R's parallel uses in the
> environment.
> 
> In case you don't want to wrestle with attachments, the same files are
> online in our SVN
> 
> http://winstat.quant.ku.edu/svn/hpcexample/trunk/Ex66-ParallelSeedPrototype/
> 
> 
> ## Paul E. Johnson CRMDA <pauljohn at ku.edu>
> ## Portable Parallel Seeds Project.
> ## 2012-02-18
> 
> Portable Parallel Seeds Project
> 
> This is how I'm going to recommend we work with random number seeds in
> simulations. It enhances work that requires runs with random numbers,
> whether runs are in a cluster computing environment or in a single
> workstation.
> 
> It is a solution for two separate problems.
> 
> Problem 1. I scripted up 1000 R runs and need high quality,
> unique, replicable random streams for each one. Each simulation
> runs separately, but I need to be confident their streams are
> not correlated or overlapping. For replication, I need to be able to
> select any run, say 667, and restart it exactly as it was.
> 
> Problem 2. I've written a Parallel MPI (Message Passing Interface)
> routine that launches 1000 runs and I need to assure each has
> a unique, replicatable, random stream. I need to be able to
> select any run, say 667, and restart it exactly as it was.
> 
> This project develops one approach to create replicable simulations.
> It blends ideas about seed management from John M. Chambers
> Software for Data Analysis (2008) with ideas from the snowFT
> package by Hana Sevcikova and Tony R. Rossini.
> 
> 
> Here's my proposal.
> 
> 1. Run a preliminary program to generate an array of seeds
> 
> run1:   seed1.1   seed1.2   seed1.3
> run2:   seed2.1   seed2.2   seed2.3
> run3:   seed3.1   seed3.2   seed3.3
> ...      ...       ...
> run1000   seed1000.1  seed1000.2   seed1000.3
> 
> This example provides 3 separate streams of random numbers within each
> run. Because we will use the L'Ecuyer "many separate streams"
> approach, we are confident that there is no correlation or overlap
> between any of the runs.
> 
> The projSeeds has to have one row per project, but it is not a huge
> file. I created seeds for 2000 runs of a project that requires 2 seeds
> per run.  The saved size of the file 104443kb, which is very small. By
> comparison, a 1400x1050 jpg image would usually be twice that size.
> If you save 10,000 runs-worth of seeds, the size rises to 521,993kb,
> still pretty small.
> 
> Because the seeds are saved in a file, we are sure each
> run can be replicated. We just have to teach each program
> how to use the seeds. That is step two.

Hi.

Some of the random number generators allow as a seed a vector,
not only a single number. This can simplify generating the seeds.
There can be one seed for each of the 1000 runs and then,
the rows of the seed matrix can be

  c(seed1, 1), c(seed1, 2), ...
  c(seed2, 1), c(seed2, 2), ...
  c(seed3, 1), c(seed3, 2), ...
  ...

There could be even only one seed and the matrix can be generated as

  c(seed, 1, 1), c(seed, 1, 2), ...
  c(seed, 2, 1), c(seed, 2, 2), ...
  c(seed, 3, 1), c(seed, 3, 2), ...

If the initialization using the vector c(seed, i, j) is done
with a good quality hash function, the runs will be independent.

What is your opinion on this?

An advantage of seeding with a vector is also that there can
be significantly more initial states of the generator among
which we select by the seed than 2^32, which is the maximum
for a single integer seed.

Petr Savicky.


From pauljohn32 at gmail.com  Sat Feb 18 04:33:33 2012
From: pauljohn32 at gmail.com (Paul Johnson)
Date: Fri, 17 Feb 2012 21:33:33 -0600
Subject: [Rd] portable parallel seeds project: request for critiques
In-Reply-To: <20120217230633.GA19243@cs.cas.cz>
References: <CAErODj-KZo+Am6a30pnVrPC-STw++500=QOi-rZaMsXYWzeX+Q@mail.gmail.com>
	<20120217230633.GA19243@cs.cas.cz>
Message-ID: <CAErODj_6Zk16wwUdKB8NNeHX2+ZN+qT3Ke+pEEt2g=vk4UzAig@mail.gmail.com>

On Fri, Feb 17, 2012 at 5:06 PM, Petr Savicky <savicky at cs.cas.cz> wrote:
> On Fri, Feb 17, 2012 at 02:57:26PM -0600, Paul Johnson wrote:
> Hi.
>
> Some of the random number generators allow as a seed a vector,
> not only a single number. This can simplify generating the seeds.
> There can be one seed for each of the 1000 runs and then,
> the rows of the seed matrix can be
>
> ?c(seed1, 1), c(seed1, 2), ...
> ?c(seed2, 1), c(seed2, 2), ...
> ?c(seed3, 1), c(seed3, 2), ...
> ?...
>
Yes, I understand.

The seed things I'm using are the 6 integer values from the L'Ecuyer.
If you run the example script, the verbose option causes some to print
out.  The first 3 seeds in a saved project seeds file looks like:

> projSeeds[[1]]
[[1]]
[1]         407   376488316  1939487821  1433925148 -1040698333   579503880
[7]  -624878918

[[2]]
[1]         407 -1107332181   854177397  1773099324  1774170776  -266687360
[7]   816955059

[[3]]
[1]         407   936506900 -1924631332 -1380363206  2109234517  1585239833
[7] -1559304513

The 407 in the first position is an integer R uses to note the type of
stream for which the seed is intended, in this case R'Lecuyer.





> There could be even only one seed and the matrix can be generated as
>
> ?c(seed, 1, 1), c(seed, 1, 2), ...
> ?c(seed, 2, 1), c(seed, 2, 2), ...
> ?c(seed, 3, 1), c(seed, 3, 2), ...
>
> If the initialization using the vector c(seed, i, j) is done
> with a good quality hash function, the runs will be independent.
>
I don't have any formal proof that a "good quality hash function"
would truly create seeds from which independent streams will be drawn.

There is, however, the proof in the L'Ecuyer paper that one can take
the long stream and divide it into sections.  That's the approach I'm
taking here. Its the same approach the a parallel package in R
follows, and parallel frameworks like snow.

The different thing in my approach is that I'm saving one row of seeds
per simulation "run".  So each run can be replicated exactly.

I hope.

pj

pj


> What is your opinion on this?
>
> An advantage of seeding with a vector is also that there can
> be significantly more initial states of the generator among
> which we select by the seed than 2^32, which is the maximum
> for a single integer seed.
>
> Petr Savicky.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
Paul E. Johnson
Professor, Political Science
1541 Lilac Lane, Room 504
University of Kansas


From savicky at cs.cas.cz  Sat Feb 18 11:40:02 2012
From: savicky at cs.cas.cz (Petr Savicky)
Date: Sat, 18 Feb 2012 11:40:02 +0100
Subject: [Rd] portable parallel seeds project: request for critiques
In-Reply-To: <CAErODj_6Zk16wwUdKB8NNeHX2+ZN+qT3Ke+pEEt2g=vk4UzAig@mail.gmail.com>
References: <CAErODj-KZo+Am6a30pnVrPC-STw++500=QOi-rZaMsXYWzeX+Q@mail.gmail.com>
	<20120217230633.GA19243@cs.cas.cz>
	<CAErODj_6Zk16wwUdKB8NNeHX2+ZN+qT3Ke+pEEt2g=vk4UzAig@mail.gmail.com>
Message-ID: <20120218104002.GB2383@cs.cas.cz>

On Fri, Feb 17, 2012 at 09:33:33PM -0600, Paul Johnson wrote:
[...]
> The seed things I'm using are the 6 integer values from the L'Ecuyer.
> If you run the example script, the verbose option causes some to print
> out.  The first 3 seeds in a saved project seeds file looks like:
> 
> > projSeeds[[1]]
> [[1]]
> [1]         407   376488316  1939487821  1433925148 -1040698333   579503880
> [7]  -624878918
> 
> [[2]]
> [1]         407 -1107332181   854177397  1773099324  1774170776  -266687360
> [7]   816955059
> 
> [[3]]
> [1]         407   936506900 -1924631332 -1380363206  2109234517  1585239833
> [7] -1559304513
> 
> The 407 in the first position is an integer R uses to note the type of
> stream for which the seed is intended, in this case R'Lecuyer.

The paralel streams uses MRG32k3a generator by P.L'Ecuyer, whose original
implementation stores its internal state as double precision floating point
numbers. The vector .Random.seed consists of integers. Do you know, whether
a modified implementation of MRG32k3a is used, which works with integers
internally, or the conversion between double and integer is done whenever
the state is stored to .Random.seed?
 
> I don't have any formal proof that a "good quality hash function"
> would truly create seeds from which independent streams will be drawn.

One of the suggested ways how to generate, say, 2^16 cryptographically secure
random numbers, is to use a counter producing a sequence 1, 2, 3, ..., 2^16
and transform these values by a hash function. An example is Fortuna generator

  http://en.wikipedia.org/wiki/Fortuna_(PRNG)

which is also available on CRAN as "randaes". The length of the sequence 
is limited, since the sequence contains no collisions. If the sequence is
too long, this could allow to distinguish it from truly random numbers.
After generating 2^16 numbers, the seed is recomputed and another 2^16
numbers are generated.

Such a generator is a very good one. It is not used for simulations, since it
is slower (say by a factor of 5) than the linear generators like Mersenne
Twister, WELL or MRG family of generators. However, if it is used only for
initialization, then the speed is less important.

> There is, however, the proof in the L'Ecuyer paper that one can take
> the long stream and divide it into sections.  That's the approach I'm
> taking here. Its the same approach the a parallel package in R
> follows, and parallel frameworks like snow.

According to

  http://www.iro.umontreal.ca/~lecuyer/myftp/papers/streams00.pdf

the sectioning of the stream to substreams is done by jump ahead algorithm.
The new seed is far enough in the sequence from the previous seed, so it
is guaranteed that the sequence generated from the previous seed is shorter
than the jump and the subsequences do not overlap. However, the new seed
is computable as a function of the previous seed. If we use this strategy
to produce a matrix of seeds

  s_{1,1}, s_{1,2}, ...
  s_{2,1}, s_{2,2}, ...
  s_{3,1}, s_{2,2}, ...

then each s_{i,j} may be computed from s_{1,1} and i, j. In this case, it is
sufficient to store s_{1,1}. If we know for each run the indices i,j, then
we can compute s_{i,j} by an efficient algorithm.

> The different thing in my approach is that I'm saving one row of seeds
> per simulation "run".  So each run can be replicated exactly.
> 
> I hope.

Saving .Random.seed should be a safe strategy.

Petr Savicky.


From patrick.aboyoun at oracle.com  Thu Feb 16 23:08:50 2012
From: patrick.aboyoun at oracle.com (Patrick Aboyoun)
Date: Thu, 16 Feb 2012 14:08:50 -0800
Subject: [Rd] Unstable reproduce for potential issue with CHARSXP creation
Message-ID: <4F3D7E72.8040601@oracle.com>

I stumbled across one of those intermittent bugs where the code 
sometimes works and sometimes doesn't.  Below is an example run showing 
a failure where a CHARSXP object was not properly created (by the sub 
function?). I was able to reproduce this error on three different R 
builds in fresh R sessions, but it sometimes takes a few start up R -> 
run code -> close R iterations for the error to show itself.


 > x <- data.frame("X1" = 1)
 > colnames(x) <- sub("foo", "bar", colnames(x))
 > terms(~ ., x)
Error in terms.formula(~., x) : 'getCharCE' must be called on a CHARSXP
 > y <- data.frame("X1" = 1)
 > colnames(y) <- sub("X", "NEWX", colnames(y))
 > terms(~ ., y)
Error in terms.formula(~., y) : 'getCharCE' must be called on a CHARSXP
 > sessionInfo()
R Under development (unstable) (2012-02-15 r58359)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
  [7] LC_PAPER=C                 LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base



Cheers,
Patrick


From patrick.aboyoun at oracle.com  Sun Feb 19 18:21:30 2012
From: patrick.aboyoun at oracle.com (Patrick Aboyoun)
Date: Sun, 19 Feb 2012 12:21:30 -0500
Subject: [Rd] Unstable reproduce for potential issue with CHARSXP
	creation
In-Reply-To: <4F3D7E72.8040601@oracle.com>
References: <4F3D7E72.8040601@oracle.com>
Message-ID: <A091F73F-D936-4CBE-A2C7-1AEE74FE5C1C@oracle.com>

This issue was filed in R bugs and addresses by Prof Brian Ripley. I had neglected to name the data argument, but Brian checked in a fix to R-devel so folks who make the same mistake I did will know they supplied the wrong object type to the specials argument in the terms function.


Cheers,
Patrick


On Feb 16, 2012, at 5:08 PM, Patrick Aboyoun <patrick.aboyoun at oracle.com> wrote:

> I stumbled across one of those intermittent bugs where the code sometimes works and sometimes doesn't.  Below is an example run showing a failure where a CHARSXP object was not properly created (by the sub function?). I was able to reproduce this error on three different R builds in fresh R sessions, but it sometimes takes a few start up R -> run code -> close R iterations for the error to show itself.
> 
> 
> > x <- data.frame("X1" = 1)
> > colnames(x) <- sub("foo", "bar", colnames(x))
> > terms(~ ., x)
> Error in terms.formula(~., x) : 'getCharCE' must be called on a CHARSXP
> > y <- data.frame("X1" = 1)
> > colnames(y) <- sub("X", "NEWX", colnames(y))
> > terms(~ ., y)
> Error in terms.formula(~., y) : 'getCharCE' must be called on a CHARSXP
> > sessionInfo()
> R Under development (unstable) (2012-02-15 r58359)
> Platform: x86_64-unknown-linux-gnu (64-bit)
> 
> locale:
> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> [7] LC_PAPER=C                 LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> 
> 
> Cheers,
> Patrick
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From tlumley at uw.edu  Sun Feb 19 20:04:28 2012
From: tlumley at uw.edu (Thomas Lumley)
Date: Mon, 20 Feb 2012 08:04:28 +1300
Subject: [Rd] portable parallel seeds project: request for critiques
In-Reply-To: <CAErODj_6Zk16wwUdKB8NNeHX2+ZN+qT3Ke+pEEt2g=vk4UzAig@mail.gmail.com>
References: <CAErODj-KZo+Am6a30pnVrPC-STw++500=QOi-rZaMsXYWzeX+Q@mail.gmail.com>
	<20120217230633.GA19243@cs.cas.cz>
	<CAErODj_6Zk16wwUdKB8NNeHX2+ZN+qT3Ke+pEEt2g=vk4UzAig@mail.gmail.com>
Message-ID: <CAJ55+dJqFcO_xQTFEfnOpvSLVgGLWippK08X=0wUmcqZBRSjLw@mail.gmail.com>

On Sat, Feb 18, 2012 at 4:33 PM, Paul Johnson <pauljohn32 at gmail.com> wrote:
> On Fri, Feb 17, 2012 at 5:06 PM, Petr Savicky <savicky at cs.cas.cz> wrote:
>> On Fri, Feb 17, 2012 at 02:57:26PM -0600, Paul Johnson wrote:
>> Hi.
>>
>> Some of the random number generators allow as a seed a vector,
>> not only a single number. This can simplify generating the seeds.
>> There can be one seed for each of the 1000 runs and then,
>> the rows of the seed matrix can be
>>
>> ?c(seed1, 1), c(seed1, 2), ...
>> ?c(seed2, 1), c(seed2, 2), ...
>> ?c(seed3, 1), c(seed3, 2), ...
>> ?...
>>
> Yes, I understand.
>
> The seed things I'm using are the 6 integer values from the L'Ecuyer.
> If you run the example script, the verbose option causes some to print
> out. ?The first 3 seeds in a saved project seeds file looks like:
>
>> projSeeds[[1]]
> [[1]]
> [1] ? ? ? ? 407 ? 376488316 ?1939487821 ?1433925148 -1040698333 ? 579503880
> [7] -624878918
>
> [[2]]
> [1] ? ? ? ? 407 -1107332181 ? 854177397 ?1773099324 ?1774170776 ?-266687360
> [7] 816955059
>
> [[3]]
> [1] ? ? ? ? 407 ? 936506900 -1924631332 -1380363206 ?2109234517 ?1585239833
> [7] -1559304513
>
> The 407 in the first position is an integer R uses to note the type of
> stream for which the seed is intended, in this case R'Lecuyer.
>
>
>
>
>
>> There could be even only one seed and the matrix can be generated as
>>
>> ?c(seed, 1, 1), c(seed, 1, 2), ...
>> ?c(seed, 2, 1), c(seed, 2, 2), ...
>> ?c(seed, 3, 1), c(seed, 3, 2), ...
>>
>> If the initialization using the vector c(seed, i, j) is done
>> with a good quality hash function, the runs will be independent.
>>
> I don't have any formal proof that a "good quality hash function"
> would truly create seeds from which independent streams will be drawn.

That is essentially the *definition* of a good quality hash function,
at least in the cryptographic sense.  It maps the inputs into numbers
that are indistinguishable from uniform random except that the same
input always gives the same output.

What's harder is to prove that you *have* a good quality hash
function, but for these (non-adversarial) purposes even something like
MD4 would be fine, and certainly the SHA family.

    -thomas

-- 
Thomas Lumley
Professor of Biostatistics
University of Auckland


From pgilbert902 at gmail.com  Sun Feb 19 20:45:10 2012
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Sun, 19 Feb 2012 14:45:10 -0500
Subject: [Rd] include <R.h>
Message-ID: <4F415146.6020508@gmail.com>

I am trying to add

#include <R.h>

to a .c file in one of my package, so I can call error() without a 
complaint about implicit defined function. The src/ has a Makefile, to 
build some exec/ files that are needed. Without the include, my Makefile 
target

OBJS = $(SRC:.c=.o)

$(PKGNAME).so: $(OBJS) rpcx.h
	$(R_HOME)/bin/R CMD SHLIB  $(OBJS)

seems to work fine, and I do not need a target for the .o's, the default 
works. But when I add the include, the location of R.h does not get 
passed along. How am I suppose to specify $(R_HOME)lib/R/include so that 
it gets passed along by R CMD SHLIB ?

Paul


From edd at debian.org  Sun Feb 19 20:59:33 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 19 Feb 2012 13:59:33 -0600
Subject: [Rd] include <R.h>
In-Reply-To: <4F415146.6020508@gmail.com>
References: <4F415146.6020508@gmail.com>
Message-ID: <20289.21669.268394.103016@max.nulle.part>


On 19 February 2012 at 14:45, Paul Gilbert wrote:
| I am trying to add
| 
| #include <R.h>
| 
| to a .c file in one of my package, so I can call error() without a 

You may want to turn 'remapping' on which hides all R functions behind a
prefix of Rf_ so that error() becomes Rf_error().  Define R_NO_REMAP before
including R.h and you should be fine.

Hth, Dirk

| complaint about implicit defined function. The src/ has a Makefile, to 
| build some exec/ files that are needed. Without the include, my Makefile 
| target
| 
| OBJS = $(SRC:.c=.o)
| 
| $(PKGNAME).so: $(OBJS) rpcx.h
| 	$(R_HOME)/bin/R CMD SHLIB  $(OBJS)
| 
| seems to work fine, and I do not need a target for the .o's, the default 
| works. But when I add the include, the location of R.h does not get 
| passed along. How am I suppose to specify $(R_HOME)lib/R/include so that 
| it gets passed along by R CMD SHLIB ?
| 
| Paul
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
"Outside of a dog, a book is a man's best friend. Inside of a dog, it is too
dark to read." -- Groucho Marx


From pgilbert902 at gmail.com  Sun Feb 19 21:08:38 2012
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Sun, 19 Feb 2012 15:08:38 -0500
Subject: [Rd] include <R.h>
In-Reply-To: <20289.21669.268394.103016@max.nulle.part>
References: <4F415146.6020508@gmail.com>
	<20289.21669.268394.103016@max.nulle.part>
Message-ID: <4F4156C6.90401@gmail.com>



On 12-02-19 02:59 PM, Dirk Eddelbuettel wrote:
>
> On 19 February 2012 at 14:45, Paul Gilbert wrote:
> | I am trying to add
> |
> | #include<R.h>
> |
> | to a .c file in one of my package, so I can call error() without a
>
> You may want to turn 'remapping' on which hides all R functions behind a
> prefix of Rf_ so that error() becomes Rf_error().  Define R_NO_REMAP before
> including R.h and you should be fine.

I'm confused about why this will help the compiler find the R.h file?

Paul

>
> Hth, Dirk
>
> | complaint about implicit defined function. The src/ has a Makefile, to
> | build some exec/ files that are needed. Without the include, my Makefile
> | target
> |
> | OBJS = $(SRC:.c=.o)
> |
> | $(PKGNAME).so: $(OBJS) rpcx.h
> | 	$(R_HOME)/bin/R CMD SHLIB  $(OBJS)
> |
> | seems to work fine, and I do not need a target for the .o's, the default
> | works. But when I add the include, the location of R.h does not get
> | passed along. How am I suppose to specify $(R_HOME)lib/R/include so that
> | it gets passed along by R CMD SHLIB ?
> |
> | Paul
> |
> | ______________________________________________
> | R-devel at r-project.org mailing list
> | https://stat.ethz.ch/mailman/listinfo/r-devel
>


From edd at debian.org  Sun Feb 19 21:36:59 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 19 Feb 2012 14:36:59 -0600
Subject: [Rd] include <R.h>
In-Reply-To: <4F4156C6.90401@gmail.com>
References: <4F415146.6020508@gmail.com>
	<20289.21669.268394.103016@max.nulle.part>
	<4F4156C6.90401@gmail.com>
Message-ID: <20289.23915.634711.608570@max.nulle.part>


On 19 February 2012 at 15:08, Paul Gilbert wrote:
| 
| 
| On 12-02-19 02:59 PM, Dirk Eddelbuettel wrote:
| >
| > On 19 February 2012 at 14:45, Paul Gilbert wrote:
| > | I am trying to add
| > |
| > | #include<R.h>
| > |
| > | to a .c file in one of my package, so I can call error() without a
| >
| > You may want to turn 'remapping' on which hides all R functions behind a
| > prefix of Rf_ so that error() becomes Rf_error().  Define R_NO_REMAP before
| > including R.h and you should be fine.
| 
| I'm confused about why this will help the compiler find the R.h file?

Never mind -- my bad. 

I seem to have misread the question. Remapping helps with R's error(),
length(), ... clash with similarly defined functions from other projects.

Dirk
 
| Paul
| 
| >
| > Hth, Dirk
| >
| > | complaint about implicit defined function. The src/ has a Makefile, to
| > | build some exec/ files that are needed. Without the include, my Makefile
| > | target
| > |
| > | OBJS = $(SRC:.c=.o)
| > |
| > | $(PKGNAME).so: $(OBJS) rpcx.h
| > | 	$(R_HOME)/bin/R CMD SHLIB  $(OBJS)
| > |
| > | seems to work fine, and I do not need a target for the .o's, the default
| > | works. But when I add the include, the location of R.h does not get
| > | passed along. How am I suppose to specify $(R_HOME)lib/R/include so that
| > | it gets passed along by R CMD SHLIB ?
| > |
| > | Paul
| > |
| > | ______________________________________________
| > | R-devel at r-project.org mailing list
| > | https://stat.ethz.ch/mailman/listinfo/r-devel
| >

-- 
"Outside of a dog, a book is a man's best friend. Inside of a dog, it is too
dark to read." -- Groucho Marx


From simon.urbanek at r-project.org  Sun Feb 19 22:56:44 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sun, 19 Feb 2012 16:56:44 -0500
Subject: [Rd] include <R.h>
In-Reply-To: <4F415146.6020508@gmail.com>
References: <4F415146.6020508@gmail.com>
Message-ID: <463AE38F-71E6-4DAD-BBF5-E2A411DBD0AE@r-project.org>

Paul,

On Feb 19, 2012, at 2:45 PM, Paul Gilbert wrote:

> I am trying to add
> 
> #include <R.h>
> 
> to a .c file in one of my package, so I can call error() without a complaint about implicit defined function. The src/ has a Makefile, to build some exec/ files that are needed. Without the include, my Makefile target
> 
> OBJS = $(SRC:.c=.o)
> 
> $(PKGNAME).so: $(OBJS) rpcx.h
> 	$(R_HOME)/bin/R CMD SHLIB  $(OBJS)
> 
> seems to work fine, and I do not need a target for the .o's, the default works. But when I add the include, the location of R.h does not get passed along. How am I suppose to specify $(R_HOME)lib/R/include so that it gets passed along by R CMD SHLIB ?
> 

I assume you know that the above general approach won't work very well, so I won't go there... (you don't need Makefile to just add targets).

But your immediate problem is that you want to use R CMD SHLIB $(SRC) and not $(OBJS), otherwise you'll be missing all C*FLAGS (which includes -I that is needed for the headers) since the compilation will be done by your Makefile and not R.

Cheers,
Simon


From yintengfei at gmail.com  Sun Feb 19 23:22:24 2012
From: yintengfei at gmail.com (Tengfei Yin)
Date: Sun, 19 Feb 2012 16:22:24 -0600
Subject: [Rd] [R] semi-transparency not supported in devel R? "alpha"
 cannot be specified in qplot()
In-Reply-To: <CAPJsq9=4UTAuA=XYGFWCZRwKhtN01jcbT56+gcQUmVF2d9w=_A@mail.gmail.com>
References: <CAPJsq9nxN05K1mPrK-DE03AfxS5koEvQ9osRf0mpYa94wj9GMw@mail.gmail.com>
	<CANROs4e1GTH1BS_tGz7DyCuVn0w7HoHQjiv7Z2qeJLzrU8nXkg@mail.gmail.com>
	<CAPJsq9=4UTAuA=XYGFWCZRwKhtN01jcbT56+gcQUmVF2d9w=_A@mail.gmail.com>
Message-ID: <CAPJsq9k=b6wuNNQBd9Pi0TMcPatsb8h3r9D4ZGUG1JWSWm3opQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120219/c4f4ec3c/attachment.pl>

From pgilbert902 at gmail.com  Mon Feb 20 03:32:15 2012
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Sun, 19 Feb 2012 21:32:15 -0500
Subject: [Rd] include <R.h>
In-Reply-To: <463AE38F-71E6-4DAD-BBF5-E2A411DBD0AE@r-project.org>
References: <4F415146.6020508@gmail.com>
	<463AE38F-71E6-4DAD-BBF5-E2A411DBD0AE@r-project.org>
Message-ID: <4F41B0AF.70804@gmail.com>



On 12-02-19 04:56 PM, Simon Urbanek wrote:
> Paul,
>
> On Feb 19, 2012, at 2:45 PM, Paul Gilbert wrote:
>
>> I am trying to add
>>
>> #include<R.h>
>>
>> to a .c file in one of my package, so I can call error() without a complaint about implicit defined function. The src/ has a Makefile, to build some exec/ files that are needed. Without the include, my Makefile target
>>
>> OBJS = $(SRC:.c=.o)
>>
>> $(PKGNAME).so: $(OBJS) rpcx.h
>> 	$(R_HOME)/bin/R CMD SHLIB  $(OBJS)
>>
>> seems to work fine, and I do not need a target for the .o's, the default works. But when I add the include, the location of R.h does not get passed along. How am I suppose to specify $(R_HOME)lib/R/include so that it gets passed along by R CMD SHLIB ?
>>
>
> I assume you know that the above general approach won't work very well, so I won't go there... (you don't need Makefile to just add targets).

Simon

I'm not sure if I understand this. I know I could add targets in 
Makevars or Makerules, but do you means something else?  I also need to 
build some executables and move then into exec/, which I think also 
implies I need to change the default target in src/. Isn't a Makefile 
the only way to do that? (I know you said you won't go here, but now I' 
curious.)

> But your immediate problem is that you want to use R CMD SHLIB $(SRC) and not $(OBJS), otherwise you'll be missing all C*FLAGS (which includes -I that is needed for the headers) since the compilation will be done by your Makefile and not R.

Thanks, that fixed it!
Paul

> Cheers,
> Simon
>


From simon.urbanek at r-project.org  Mon Feb 20 03:46:23 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sun, 19 Feb 2012 21:46:23 -0500
Subject: [Rd] include <R.h>
In-Reply-To: <4F41B0AF.70804@gmail.com>
References: <4F415146.6020508@gmail.com>
	<463AE38F-71E6-4DAD-BBF5-E2A411DBD0AE@r-project.org>
	<4F41B0AF.70804@gmail.com>
Message-ID: <49E3A1E7-C028-4C41-AA89-75F423830784@r-project.org>

Paul,

On Feb 19, 2012, at 9:32 PM, Paul Gilbert wrote:

> On 12-02-19 04:56 PM, Simon Urbanek wrote:
>> Paul,
>> 
>> On Feb 19, 2012, at 2:45 PM, Paul Gilbert wrote:
>> 
>>> I am trying to add
>>> 
>>> #include<R.h>
>>> 
>>> to a .c file in one of my package, so I can call error() without a complaint about implicit defined function. The src/ has a Makefile, to build some exec/ files that are needed. Without the include, my Makefile target
>>> 
>>> OBJS = $(SRC:.c=.o)
>>> 
>>> $(PKGNAME).so: $(OBJS) rpcx.h
>>> 	$(R_HOME)/bin/R CMD SHLIB  $(OBJS)
>>> 
>>> seems to work fine, and I do not need a target for the .o's, the default works. But when I add the include, the location of R.h does not get passed along. How am I suppose to specify $(R_HOME)lib/R/include so that it gets passed along by R CMD SHLIB ?
>>> 
>> 
>> I assume you know that the above general approach won't work very well, so I won't go there... (you don't need Makefile to just add targets).
> 
> Simon
> 
> I'm not sure if I understand this. I know I could add targets in Makevars or Makerules, but do you means something else?  I also need to build some executables and move then into exec/, which I think also implies I need to change the default target in src/. Isn't a Makefile the only way to do that? (I know you said you won't go here, but now I' curious.)
> 

No, you can add arbitrary targets to Makevars - the only real difference between Makefile and Makevars is that in the former you have to write all rules by hand whereas the latter includes R rules so you don't need to create them by hand - it is still a fully functional Makefile. One benefit of Makevars is that you are not giving up the capability of your package to be built for all archs (but it also means you have to be good about cleaning up after builds - R only cleans what it knows about).

In you case your Makevars could look like

all: myexec $(SHLIB)

myexec:
	# build your desired exec files
	# put them in in inst... or wherever you need them
	# clean up all build files for myexec

where $(SHLIB) is the default target that R will build (same as R CMD SHLIB) and myexec: is your additional target that you need

Cheers,
Simon



>> But your immediate problem is that you want to use R CMD SHLIB $(SRC) and not $(OBJS), otherwise you'll be missing all C*FLAGS (which includes -I that is needed for the headers) since the compilation will be done by your Makefile and not R.
> 
> Thanks, that fixed it!
> Paul
> 
>> Cheers,
>> Simon
>> 
> 
> 


From peter.ruckdeschel at itwm.fraunhofer.de  Mon Feb 20 12:09:55 2012
From: peter.ruckdeschel at itwm.fraunhofer.de (Peter Ruckdeschel)
Date: Mon, 20 Feb 2012 12:09:55 +0100
Subject: [Rd] text(1:10, col=NA)  is not transparent
Message-ID: <4F422A03.8020402@itwm.fraunhofer.de>

Maybe I am missing something, but according to the help page
to par (section "Color Specification"), which is referred to in the
help to text argument col:

?"transparent"? or (integer) ?NA? is _transparent_,
useful for filled areas (such as the background!), and just
invisible for things like lines or text.

but:

col0 <- as.integer(NA)
is.integer(col0)
### is this coercing to "integer" necessary?
plot(1:10)
text(1:10, col=col0)
### text is plotted

##whereas
plot(1:10)
text(1:10, col="transparent")
### text is not plotted

# Of course, this is not terribly urgent, as a color value of 0 also
plot(1:10)
text(1:10, col=0)
### text is not plotted

Best, Peter


From kasperdanielhansen at gmail.com  Mon Feb 20 15:22:53 2012
From: kasperdanielhansen at gmail.com (Kasper Daniel Hansen)
Date: Mon, 20 Feb 2012 09:22:53 -0500
Subject: [Rd] text(1:10, col=NA) is not transparent
In-Reply-To: <4F422A03.8020402@itwm.fraunhofer.de>
References: <4F422A03.8020402@itwm.fraunhofer.de>
Message-ID: <CAC2h7usFquWNOfNMAc-Xd_fTxWP2JuQAWvHKVwhdtKz70bHpPQ@mail.gmail.com>

Peter,

not all devices support transparency.  My guess is that you are
plotting to a device which does not, but it is hard to know from your
email.

Kasper



On Mon, Feb 20, 2012 at 6:09 AM, Peter Ruckdeschel
<peter.ruckdeschel at itwm.fraunhofer.de> wrote:
> Maybe I am missing something, but according to the help page
> to par (section "Color Specification"), which is referred to in the
> help to text argument col:
>
> ?"transparent"? or (integer) ?NA? is _transparent_,
> useful for filled areas (such as the background!), and just
> invisible for things like lines or text.
>
> but:
>
> col0 <- as.integer(NA)
> is.integer(col0)
> ### is this coercing to "integer" necessary?
> plot(1:10)
> text(1:10, col=col0)
> ### text is plotted
>
> ##whereas
> plot(1:10)
> text(1:10, col="transparent")
> ### text is not plotted
>
> # Of course, this is not terribly urgent, as a color value of 0 also
> plot(1:10)
> text(1:10, col=0)
> ### text is not plotted
>
> Best, Peter
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From gavin.simpson at ucl.ac.uk  Mon Feb 20 17:03:51 2012
From: gavin.simpson at ucl.ac.uk (Gavin Simpson)
Date: Mon, 20 Feb 2012 16:03:51 +0000
Subject: [Rd] Controlling simplification in apply()?
Message-ID: <1329753831.4528.86.camel@prometheus.geog.ucl.ac.uk>

Dear list,

Fully according to the documented behaviour, I was bitten by apply()
simplifying results to vectors or arrays when the lengths of the
individual objects returns by FUN are the same (over simplification).

sapply() has argument simplify with default TRUE to control whether it
attempts to simplify the returned objects or not.

I do find it a little annoying that one is not able to force apply into
one behaviour or the other.

Would the be merit in apply() also having a similar argument to control
whether simplification occurs or not, say adding `simplify = TRUE` after
`...`? If there was I'd be happy to provide a first stab and contribute
updated documentation.

All the best,

Gavin
-- 
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
 Dr. Gavin Simpson             [t] +44 (0)20 7679 0522
 ECRC, UCL Geography,          [f] +44 (0)20 7679 0565
 Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk
 Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/
 UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%


From sahir.bhatnagar at gmail.com  Mon Feb 20 18:17:52 2012
From: sahir.bhatnagar at gmail.com (sahir bhatnagar)
Date: Mon, 20 Feb 2012 12:17:52 -0500
Subject: [Rd] executable files R package
In-Reply-To: <E66794E69CFDE04D9A70842786030B9327C43F@PA-MBX04.na.tibco.com>
References: <CAEV=kBNoZ5ooTQVpQmsV-P4jbMekg=KSw==O=fwCMPGL71Dx0Q@mail.gmail.com>
	<4F3BCBD1.1050103@gmail.com>
	<CAEV=kBOXFsqJ=opfpPh3FgnVfM8sry0ir691JJOE=nr_AZvMfA@mail.gmail.com>
	<E66794E69CFDE04D9A70842786030B9327C43F@PA-MBX04.na.tibco.com>
Message-ID: <CAEV=kBP1bRxTy-xt2B5-eL-KsNYT=dVS=n9Y-43A7d0m0QZJ-g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120220/ff6b5649/attachment.pl>

From ripley at stats.ox.ac.uk  Mon Feb 20 18:39:04 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 20 Feb 2012 17:39:04 +0000
Subject: [Rd] executable files R package
In-Reply-To: <CAEV=kBP1bRxTy-xt2B5-eL-KsNYT=dVS=n9Y-43A7d0m0QZJ-g@mail.gmail.com>
References: <CAEV=kBNoZ5ooTQVpQmsV-P4jbMekg=KSw==O=fwCMPGL71Dx0Q@mail.gmail.com>
	<4F3BCBD1.1050103@gmail.com>
	<CAEV=kBOXFsqJ=opfpPh3FgnVfM8sry0ir691JJOE=nr_AZvMfA@mail.gmail.com>
	<E66794E69CFDE04D9A70842786030B9327C43F@PA-MBX04.na.tibco.com>
	<CAEV=kBP1bRxTy-xt2B5-eL-KsNYT=dVS=n9Y-43A7d0m0QZJ-g@mail.gmail.com>
Message-ID: <4F428538.4090708@stats.ox.ac.uk>

On 20/02/2012 17:17, sahir bhatnagar wrote:
> thanks,
> I run into the following error message when running R CMD check
>
> "Source packages should not contain undeclared executable files"
>
> in reference to the following instruction from the help manual:
> "R CMD check will warn about them unless they are listed (one filepath per
> line) in a file BinaryFiles at the top level of the package."
>
> I created a file called 'BinaryFiles' placed in 'myPkg' directory.
> 'BinaryFiles' lists the path of the executable files that are included
> in myPkg/executables/win32. however I am still getting an error:
>
> Warning in readLines("BinaryFiles"): incomplete final line found on 'Binary
> Files'

That is a warning, not an error.  And it means that you did not create 
the file correctly: ensure that you have an EOL mark (newline or CRLF 
depending on your OS) at the end of the last line.

> -Sahir
>
> On Fri, Feb 17, 2012 at 4:17 PM, William Dunlap<wdunlap at tibco.com>  wrote:
>
>> If you put your prebuilt.exe into a directory under the
>> 'source' package's inst directory, say yourPkg/inst/executables/win32,
>> then the installed package will have them in in
>> yourPkg/executables/win32 and the user (via code you
>> write, presumably) can get the full path to the executable
>> in the installed package with
>>   system.file(package="yourPkg", "executables", "win32", "prebuilt.exe").
>> Paste the output of that into the command given to system().
>>
>> Bill Dunlap
>> Spotfire, TIBCO Software
>> wdunlap tibco.com
>>
>>> -----Original Message-----
>>> From: r-devel-bounces at r-project.org [mailto:
>> r-devel-bounces at r-project.org] On Behalf Of sahir
>>> bhatnagar
>>> Sent: Friday, February 17, 2012 12:59 PM
>>> To: Duncan Murdoch
>>> Cc: r-devel at r-project.org
>>> Subject: Re: [Rd] executable files R package
>>>
>>> thanks,
>>> I will not submit to CRAN.
>>>
>>> I am having trouble going about including the .exe files in my package.
>>> > From the readings I see that the .exe files must be placed in a 'src'
>>> folder. But I don't see how I can access those files in R, without having
>>> to specify its path in the R command 'system'. I would like for the user
>> to
>>> only have to input a data file, which is then used in the .exe file.
>>>
>>> My problem is the following:
>>> Create a function which has two user inputs i.e. datasets: D1.txt and
>> D2.txt
>>> I have two '.exe' files i.e. E1.exe and E2.exe
>>>
>>> E1 takes in D1 and then outputs a text file say "text"
>>>
>>> then E2 takes in D2 and the "text", which outputs the result.
>>>
>>> Can this be done (even if it means having two functions) and then
>> assembled
>>> in a package, without the user having to specify the path of the .exe
>>> files, as well as the "text" that is outputted from running E1?
>>>
>>> Any direction as to how I can go about creating a package that would
>>> include these '.exe. files? I have only found documentation on calling .C
>>> code in R.
>>>
>>> Any help is much appreciated
>>>
>>> On Wed, Feb 15, 2012 at 10:14 AM, Duncan Murdoch
>>> <murdoch.duncan at gmail.com>wrote:
>>>
>>>> On 13/02/2012 2:36 PM, sahir bhatnagar wrote:
>>>>
>>>>> I am in the process of creating a package in R which calls
>>>>> pre-compiled C code i.e. '.exe' files in Windows.
>>>>>
>>>>> Since CRAN will not accept packages with binary code files, what are
>>>>> my options to meet the requirements while still including the
>>>>> executable file?
>>>>>
>>>>
>>>> I think you should ask the CRAN administrators that, but my
>> understanding
>>>> is that they are unlikely to accept your package as described.  CRAN is
>>>> interested in platform-neutral packages, and if you have an .exe,
>> you're
>>>> going to be Windows-only.
>>>>
>>>> If you include the source code for that .exe and put together the
>> Makefile
>>>> to compile it, then they'd be more receptive, and someone might offer
>> help
>>>> to get it to run on other platforms if it doesn't on your first
>> attempt.
>>>>
>>>> If you don't want to include the .exe source (or can't), I think you
>>>> should just publish it on your own web page.
>>>>
>>>> Duncan Murdoch
>>>>
>>>>   I read section 1.5.2 of the manual which mentions three options two of
>>>>> which involve negotiating with CRAN administrators. The third
>>>>> references the package Cairo which arranges to download additional
>>>>> software, but I don't see how this will allow my package to get
>>>>> accepted.
>>>>>
>>>>> It would seem that I need to ensure that my package works under both
>>>>> architectures (32 and 64 bit).
>>>>>
>>>>> 1) Would this be sufficient to get it accepted?
>>>>> 2) If so, does anyone have any documentation in performing this task,
>>>>> or can someone point me in the right direction?
>>>>>
>>>>> I was told that 'arulesSequences' is an example of a CRAN package
>>>>> while compiles executables. Was this package accepted because it
>>>>> worked under both architectures? or are there other reasons.
>>>>>
>>>>> thanks
>>>>>
>>>>> ______________________________**________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/**listinfo/r-devel<
>> https://stat.ethz.ch/mailman/listinfo/r-devel>
>>>>>
>>>>
>>>>
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From peter.ruckdeschel at itwm.fraunhofer.de  Mon Feb 20 19:16:42 2012
From: peter.ruckdeschel at itwm.fraunhofer.de (Peter Ruckdeschel)
Date: Mon, 20 Feb 2012 19:16:42 +0100
Subject: [Rd] text(1:10,
 col=NA) is printed in color 1 instead of color 0 (was "is not
 transparent")
In-Reply-To: <CAC2h7usFquWNOfNMAc-Xd_fTxWP2JuQAWvHKVwhdtKz70bHpPQ@mail.gmail.com>
References: <4F422A03.8020402@itwm.fraunhofer.de>
	<CAC2h7usFquWNOfNMAc-Xd_fTxWP2JuQAWvHKVwhdtKz70bHpPQ@mail.gmail.com>
Message-ID: <4F428E0A.4000309@itwm.fraunhofer.de>

Am 20.02.2012 15:22, schrieb Kasper Daniel Hansen:
> Peter,
> 
> not all devices support transparency.  My guess is that you are
> plotting to a device which does not, but it is hard to know from your
> email.
> 
> Kasper
> 

In the meantime Kasper and I had some mail exchange offline.

@Kasper: thanks again for your explanations and hopefully it is oK
         for you if I put this clarifying online

It seems my original subject was a bit misleading, as I am not
really interested in achieving transparency (which I know is
system-dependent) but rather in the behavior, that

text(<some input>, col = NA)

should not do anything --- or, more useful, if you have vectorized input
and col is vectorized, too, the NA-coordinates are not printed (as is
what I read from the help page to par() ).

The non-printing behavior is achievable already with 0 color values, and
with named color "transparent", but not for NA-values.

This effect seems to be device independent, at least I have checked it
for the windows, pdf, and jpeg devices under Windows and in the default
graphics device under Linux.

Any suggestions welcome,
Peter

> On Mon, Feb 20, 2012 at 6:09 AM, Peter Ruckdeschel
> <peter.ruckdeschel at itwm.fraunhofer.de> wrote:
>> Maybe I am missing something, but according to the help page
>> to par (section "Color Specification"), which is referred to in the
>> help to text argument col:
>>
>> ?"transparent"? or (integer) ?NA? is _transparent_,
>> useful for filled areas (such as the background!), and just
>> invisible for things like lines or text.
>>
>> but:
>>
>> col0 <- as.integer(NA)
>> is.integer(col0)
>> ### is this coercing to "integer" necessary?
>> plot(1:10)
>> text(1:10, col=col0)
>> ### text is plotted
>>
>> ##whereas
>> plot(1:10)
>> text(1:10, col="transparent")
>> ### text is not plotted
>>
>> # Of course, this is not terribly urgent, as a color value of 0 also
>> plot(1:10)
>> text(1:10, col=0)
>> ### text is not plotted
>>
>> Best, Peter
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From sahir.bhatnagar at gmail.com  Mon Feb 20 19:20:22 2012
From: sahir.bhatnagar at gmail.com (sahir bhatnagar)
Date: Mon, 20 Feb 2012 13:20:22 -0500
Subject: [Rd] executable files R package
In-Reply-To: <4F428538.4090708@stats.ox.ac.uk>
References: <CAEV=kBNoZ5ooTQVpQmsV-P4jbMekg=KSw==O=fwCMPGL71Dx0Q@mail.gmail.com>
	<4F3BCBD1.1050103@gmail.com>
	<CAEV=kBOXFsqJ=opfpPh3FgnVfM8sry0ir691JJOE=nr_AZvMfA@mail.gmail.com>
	<E66794E69CFDE04D9A70842786030B9327C43F@PA-MBX04.na.tibco.com>
	<CAEV=kBP1bRxTy-xt2B5-eL-KsNYT=dVS=n9Y-43A7d0m0QZJ-g@mail.gmail.com>
	<4F428538.4090708@stats.ox.ac.uk>
Message-ID: <CAEV=kBMAjxpA8TmXjU7_kQhs036T7QVQmfwdRAKW5OXo_4-bDQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120220/6206d826/attachment.pl>

From ripley at stats.ox.ac.uk  Mon Feb 20 19:23:46 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 20 Feb 2012 18:23:46 +0000
Subject: [Rd] executable files R package
In-Reply-To: <CAEV=kBMAjxpA8TmXjU7_kQhs036T7QVQmfwdRAKW5OXo_4-bDQ@mail.gmail.com>
References: <CAEV=kBNoZ5ooTQVpQmsV-P4jbMekg=KSw==O=fwCMPGL71Dx0Q@mail.gmail.com>
	<4F3BCBD1.1050103@gmail.com>
	<CAEV=kBOXFsqJ=opfpPh3FgnVfM8sry0ir691JJOE=nr_AZvMfA@mail.gmail.com>
	<E66794E69CFDE04D9A70842786030B9327C43F@PA-MBX04.na.tibco.com>
	<CAEV=kBP1bRxTy-xt2B5-eL-KsNYT=dVS=n9Y-43A7d0m0QZJ-g@mail.gmail.com>
	<4F428538.4090708@stats.ox.ac.uk>
	<CAEV=kBMAjxpA8TmXjU7_kQhs036T7QVQmfwdRAKW5OXo_4-bDQ@mail.gmail.com>
Message-ID: <4F428FB2.7060500@stats.ox.ac.uk>

On 20/02/2012 18:20, sahir bhatnagar wrote:
> sorry I don't seem to be getting it. I am working on windows XP.
> I have tried several ways of writing the 'BinaryFiles' which include
>
> file("C:/myPkg/inst/executables/win32/foo.exe") '\r\n'
> file("C:/myPkg/inst/executables/win32/foo.exe") CRLF
> "C:/myPkg/inst/executables/win32/foo.exe" CRLF
>
> and variations of the above, but to no avail.

Indeed you are not. It is a file, listing one filepath per line, with 
each line (including the last) terminated by an end of line marker.

Why don't you ask your local IT support for help with creating text 
files?  It is not an R topic.

>
> On Mon, Feb 20, 2012 at 12:39 PM, Prof Brian Ripley
> <ripley at stats.ox.ac.uk <mailto:ripley at stats.ox.ac.uk>> wrote:
>
>     On 20/02/2012 17:17, sahir bhatnagar wrote:
>
>         thanks,
>         I run into the following error message when running R CMD check
>
>         "Source packages should not contain undeclared executable files"
>
>         in reference to the following instruction from the help manual:
>         "R CMD check will warn about them unless they are listed (one
>         filepath per
>         line) in a file BinaryFiles at the top level of the package."
>
>         I created a file called 'BinaryFiles' placed in 'myPkg' directory.
>         'BinaryFiles' lists the path of the executable files that are
>         included
>         in myPkg/executables/win32. however I am still getting an error:
>
>         Warning in readLines("BinaryFiles"): incomplete final line found
>         on 'Binary
>         Files'
>
>
>     That is a warning, not an error.  And it means that you did not
>     create the file correctly: ensure that you have an EOL mark (newline
>     or CRLF depending on your OS) at the end of the last line.
>
>
>         -Sahir
>
>         On Fri, Feb 17, 2012 at 4:17 PM, William
>         Dunlap<wdunlap at tibco.com <mailto:wdunlap at tibco.com>>  wrote:
>
>             If you put your prebuilt.exe into a directory under the
>             'source' package's inst directory, say
>             yourPkg/inst/executables/__win32,
>             then the installed package will have them in in
>             yourPkg/executables/win32 and the user (via code you
>             write, presumably) can get the full path to the executable
>             in the installed package with
>               system.file(package="yourPkg", "executables", "win32",
>             "prebuilt.exe").
>             Paste the output of that into the command given to system().
>
>             Bill Dunlap
>             Spotfire, TIBCO Software
>             wdunlap tibco.com <http://tibco.com>
>
>                 -----Original Message-----
>                 From: r-devel-bounces at r-project.org
>                 <mailto:r-devel-bounces at r-project.org> [mailto:
>
>             r-devel-bounces at r-project.org
>             <mailto:r-devel-bounces at r-project.org>] On Behalf Of sahir
>
>                 bhatnagar
>                 Sent: Friday, February 17, 2012 12:59 PM
>                 To: Duncan Murdoch
>                 Cc: r-devel at r-project.org <mailto:r-devel at r-project.org>
>                 Subject: Re: [Rd] executable files R package
>
>                 thanks,
>                 I will not submit to CRAN.
>
>                 I am having trouble going about including the .exe files
>                 in my package.
>                  > From the readings I see that the .exe files must be
>                 placed in a 'src'
>                 folder. But I don't see how I can access those files in
>                 R, without having
>                 to specify its path in the R command 'system'. I would
>                 like for the user
>
>             to
>
>                 only have to input a data file, which is then used in
>                 the .exe file.
>
>                 My problem is the following:
>                 Create a function which has two user inputs i.e.
>                 datasets: D1.txt and
>
>             D2.txt
>
>                 I have two '.exe' files i.e. E1.exe and E2.exe
>
>                 E1 takes in D1 and then outputs a text file say "text"
>
>                 then E2 takes in D2 and the "text", which outputs the
>                 result.
>
>                 Can this be done (even if it means having two functions)
>                 and then
>
>             assembled
>
>                 in a package, without the user having to specify the
>                 path of the .exe
>                 files, as well as the "text" that is outputted from
>                 running E1?
>
>                 Any direction as to how I can go about creating a
>                 package that would
>                 include these '.exe. files? I have only found
>                 documentation on calling .C
>                 code in R.
>
>                 Any help is much appreciated
>
>                 On Wed, Feb 15, 2012 at 10:14 AM, Duncan Murdoch
>                 <murdoch.duncan at gmail.com
>                 <mailto:murdoch.duncan at gmail.com>>__wrote:
>
>                     On 13/02/2012 2:36 PM, sahir bhatnagar wrote:
>
>                         I am in the process of creating a package in R
>                         which calls
>                         pre-compiled C code i.e. '.exe' files in Windows.
>
>                         Since CRAN will not accept packages with binary
>                         code files, what are
>                         my options to meet the requirements while still
>                         including the
>                         executable file?
>
>
>                     I think you should ask the CRAN administrators that,
>                     but my
>
>             understanding
>
>                     is that they are unlikely to accept your package as
>                     described.  CRAN is
>                     interested in platform-neutral packages, and if you
>                     have an .exe,
>
>             you're
>
>                     going to be Windows-only.
>
>                     If you include the source code for that .exe and put
>                     together the
>
>             Makefile
>
>                     to compile it, then they'd be more receptive, and
>                     someone might offer
>
>             help
>
>                     to get it to run on other platforms if it doesn't on
>                     your first
>
>             attempt.
>
>
>                     If you don't want to include the .exe source (or
>                     can't), I think you
>                     should just publish it on your own web page.
>
>                     Duncan Murdoch
>
>                       I read section 1.5.2 of the manual which mentions
>                     three options two of
>
>                         which involve negotiating with CRAN
>                         administrators. The third
>                         references the package Cairo which arranges to
>                         download additional
>                         software, but I don't see how this will allow my
>                         package to get
>                         accepted.
>
>                         It would seem that I need to ensure that my
>                         package works under both
>                         architectures (32 and 64 bit).
>
>                         1) Would this be sufficient to get it accepted?
>                         2) If so, does anyone have any documentation in
>                         performing this task,
>                         or can someone point me in the right direction?
>
>                         I was told that 'arulesSequences' is an example
>                         of a CRAN package
>                         while compiles executables. Was this package
>                         accepted because it
>                         worked under both architectures? or are there
>                         other reasons.
>
>                         thanks
>
>                         ________________________________**________________
>                         R-devel at r-project.org
>                         <mailto:R-devel at r-project.org> mailing list
>                         https://stat.ethz.ch/mailman/*__*listinfo/r-devel <https://stat.ethz.ch/mailman/**listinfo/r-devel><
>
>             https://stat.ethz.ch/mailman/__listinfo/r-devel
>             <https://stat.ethz.ch/mailman/listinfo/r-devel>>
>
>
>
>
>
>                        [[alternative HTML version deleted]]
>
>                 ________________________________________________
>                 R-devel at r-project.org <mailto:R-devel at r-project.org>
>                 mailing list
>                 https://stat.ethz.ch/mailman/__listinfo/r-devel
>                 <https://stat.ethz.ch/mailman/listinfo/r-devel>
>
>
>
>                 [[alternative HTML version deleted]]
>
>         ________________________________________________
>         R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>         https://stat.ethz.ch/mailman/__listinfo/r-devel
>         <https://stat.ethz.ch/mailman/listinfo/r-devel>
>
>
>
>     --
>     Brian D. Ripley, ripley at stats.ox.ac.uk <mailto:ripley at stats.ox.ac.uk>
>     Professor of Applied Statistics,
>     http://www.stats.ox.ac.uk/~__ripley/
>     <http://www.stats.ox.ac.uk/~ripley/>
>     University of Oxford,             Tel: +44 1865 272861
>     <tel:%2B44%201865%20272861> (self)
>     1 South Parks Road, +44 1865 272866 <tel:%2B44%201865%20272866> (PA)
>     Oxford OX1 3TG, UK                Fax: +44 1865 272595
>     <tel:%2B44%201865%20272595>
>
>


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Tue Feb 21 01:14:53 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 21 Feb 2012 00:14:53 +0000
Subject: [Rd] text(1:10,
 col=NA) is printed in color 1 instead of color 0 (was "is not
 transparent")
In-Reply-To: <4F428E0A.4000309@itwm.fraunhofer.de>
References: <4F422A03.8020402@itwm.fraunhofer.de>
	<CAC2h7usFquWNOfNMAc-Xd_fTxWP2JuQAWvHKVwhdtKz70bHpPQ@mail.gmail.com>
	<4F428E0A.4000309@itwm.fraunhofer.de>
Message-ID: <4F42E1FD.5000207@stats.ox.ac.uk>

The documentation is out of date (and contradictory for cex).
Nowadays NULL and NA for col and font correspond to the par() values, 
and for cex correspond to 1.0.

So it is in fact _plotted_ in par("col"), which by default is 1.

On 20/02/2012 18:16, Peter Ruckdeschel wrote:
> Am 20.02.2012 15:22, schrieb Kasper Daniel Hansen:
>> Peter,
>>
>> not all devices support transparency.  My guess is that you are
>> plotting to a device which does not, but it is hard to know from your
>> email.
>>
>> Kasper
>>
>
> In the meantime Kasper and I had some mail exchange offline.
>
> @Kasper: thanks again for your explanations and hopefully it is oK
>           for you if I put this clarifying online
>
> It seems my original subject was a bit misleading, as I am not
> really interested in achieving transparency (which I know is
> system-dependent) but rather in the behavior, that
>
> text(<some input>, col = NA)
>
> should not do anything --- or, more useful, if you have vectorized input
> and col is vectorized, too, the NA-coordinates are not printed (as is
> what I read from the help page to par() ).
>
> The non-printing behavior is achievable already with 0 color values, and
> with named color "transparent", but not for NA-values.
>
> This effect seems to be device independent, at least I have checked it
> for the windows, pdf, and jpeg devices under Windows and in the default
> graphics device under Linux.
>
> Any suggestions welcome,
> Peter
>
>> On Mon, Feb 20, 2012 at 6:09 AM, Peter Ruckdeschel
>> <peter.ruckdeschel at itwm.fraunhofer.de>  wrote:
>>> Maybe I am missing something, but according to the help page
>>> to par (section "Color Specification"), which is referred to in the
>>> help to text argument col:
>>>
>>> ?"transparent"? or (integer) ?NA? is _transparent_,
>>> useful for filled areas (such as the background!), and just
>>> invisible for things like lines or text.
>>>
>>> but:
>>>
>>> col0<- as.integer(NA)
>>> is.integer(col0)
>>> ### is this coercing to "integer" necessary?
>>> plot(1:10)
>>> text(1:10, col=col0)
>>> ### text is plotted
>>>
>>> ##whereas
>>> plot(1:10)
>>> text(1:10, col="transparent")
>>> ### text is not plotted
>>>
>>> # Of course, this is not terribly urgent, as a color value of 0 also
>>> plot(1:10)
>>> text(1:10, col=0)
>>> ### text is not plotted
>>>
>>> Best, Peter
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Tue Feb 21 08:09:18 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 21 Feb 2012 07:09:18 +0000
Subject: [Rd] Controlling simplification in apply()?
In-Reply-To: <1329753831.4528.86.camel@prometheus.geog.ucl.ac.uk>
References: <1329753831.4528.86.camel@prometheus.geog.ucl.ac.uk>
Message-ID: <4F43431E.6010400@stats.ox.ac.uk>

On 20/02/2012 16:03, Gavin Simpson wrote:
> Dear list,
>
> Fully according to the documented behaviour, I was bitten by apply()
> simplifying results to vectors or arrays when the lengths of the
> individual objects returns by FUN are the same (over simplification).
>
> sapply() has argument simplify with default TRUE to control whether it
> attempts to simplify the returned objects or not.
>
> I do find it a little annoying that one is not able to force apply into
> one behaviour or the other.

I think it is different.  sapply (and mapply) work on a list and return 
a list result unless simplified.  apply() works on an array and returns 
an array result (dropping dims to a vector) unless that is not possible.

We don't have an example, but you seem to want a list result from 
apply().  If that _is_ what you want, why not use lapply()?  E.g.

lapply(split(m, row(m)), max)

is the list equivalent of apply(m, 1, max) .  Also, apply() is just 
sugar around a for() loop, and a loop may do what you want.

>
> Would the be merit in apply() also having a similar argument to control
> whether simplification occurs or not, say adding `simplify = TRUE` after
> `...`? If there was I'd be happy to provide a first stab and contribute
> updated documentation.
>
> All the best,
>
> Gavin


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From b.rowlingson at lancaster.ac.uk  Tue Feb 21 13:58:25 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 21 Feb 2012 12:58:25 +0000
Subject: [Rd] Jazzing up the Task Views index page
Message-ID: <CANVKczPAoruV7iC4PHLc9PtyZmBYustZf1v4v_U-KhTtaq8yyQ@mail.gmail.com>

A little while ago here we had a short discussion about Task Views - I
think ignited by someone saying 'how many times do I have to say "have
you read the Optimisation Task View?"?' and I poured some fuel on that
fire by saying "Task Views" was a stupid name.

Anyway, I did say that Task Views were rather brilliant, but were let
down by their hidden position on the R web sites (tucked away as the
third element of a sub-menu of a CRAN mirror site linked to by the
CRAN link from the Download menu on the main R home page). The index
page is rather plain, so I designed a more engaging one. The result of
my effort is now here:

http://www.maths.lancs.ac.uk/~rowlings/R/TaskViews/

Having done that, I even considered that something like that could
replace the R Homepage. Giving new visitors an idea of the vast range
of techniques and application areas available in R would seem to be
better than the current graphic which has been there since perhaps
2004.

Comments, thoughts, flames, etc?

Barry


From savicky at cs.cas.cz  Tue Feb 21 14:04:27 2012
From: savicky at cs.cas.cz (Petr Savicky)
Date: Tue, 21 Feb 2012 14:04:27 +0100
Subject: [Rd] portable parallel seeds project: request for critiques
In-Reply-To: <CAErODj-KZo+Am6a30pnVrPC-STw++500=QOi-rZaMsXYWzeX+Q@mail.gmail.com>
References: <CAErODj-KZo+Am6a30pnVrPC-STw++500=QOi-rZaMsXYWzeX+Q@mail.gmail.com>
Message-ID: <20120221130427.GA15790@cs.cas.cz>

On Fri, Feb 17, 2012 at 02:57:26PM -0600, Paul Johnson wrote:
> I've got another edition of my simulation replication framework.  I'm
> attaching 2 R files and pasting in the readme.
> 
> I would especially like to know if I'm doing anything that breaks
> .Random.seed or other things that R's parallel uses in the
> environment.
> 
> In case you don't want to wrestle with attachments, the same files are
> online in our SVN
> 
> http://winstat.quant.ku.edu/svn/hpcexample/trunk/Ex66-ParallelSeedPrototype/

Hi.

In the description of your project in the file

  http://winstat.quant.ku.edu/svn/hpcexample/trunk/Ex66-ParallelSeedPrototype/README

you argue as follows

  Question: Why is this better than the simple old approach of
  setting the seeds within each run with a formula like
   
  set.seed(2345 + 10 * run)
   
  Answer: That does allow replication, but it does not assure
  that each run uses non-overlapping random number streams. It
  offers absolutely no assurance whatsoever that the runs are
  actually non-redundant.

The following demonstrates that the function set.seed() for
the default generator indeed allows to have correlated streams.

  step <- function(x)
  {
      x[x < 0] <- x[x < 0] + 2^32
      x <- (69069 * x + 1) %% 2^32
      x[x > 2^31] <- x[x > 2^31] - 2^32
      x
  }

  n <- 1000
  seed1 <- 124370417 # any seed
  seed2 <- step(seed1)

  set.seed(seed1)
  x <- runif(n)
  set.seed(seed2)
  y <- runif(n)

  rbind(seed1, seed2)
  table(x[-1] == y[-n])

The output is

             [,1]
  seed1 124370417
  seed2 205739774
  
  FALSE  TRUE 
      5   994 

This means that if the streams x, y are generated from the two
seeds above, then y is almost exactly equal to x shifted by 1.

What is the current state of your project?

Petr Savicky.


From ClausJonathan.Fritzemeier at uni-duesseldorf.de  Tue Feb 21 12:07:24 2012
From: ClausJonathan.Fritzemeier at uni-duesseldorf.de (Claus Jonathan Fritzemeier)
Date: Tue, 21 Feb 2012 12:07:24 +0100
Subject: [Rd] Private Variables in R5-Classes possible?
Message-ID: <4F437AEC.2060401@uni-duesseldorf.de>

Hi list,

is there a way to define some kind of private Variable?

I would like to prevent the user from manipulating fields on his own, in 
order to not destroy data structures.

The problem is, that as soon as the variable exists in the environment 
it is accessible via t$secret_value.

test <- setRefClass("test", fields=list(
secret = function(value){
cat("the function was called\n")
if(missing(value)){
if(exists("secret_value", envir=.self at .xData)){
return(get("secret_value", envir=.self at .xData, inherits = F))
}
else{
return(NULL)
}
}
assign("secret_value", value=value, , envir=.self at .xData)
}
) )

 > t <- test$new()
 > t$secret
the function was called
NULL
 > t$secret_value
Error in envRefInferField(x, what, getClass(class(x)), selfEnv) :
"secret_value" is not a valid field or method name for reference class 
?test?
 > t$secret <- "Blub"
the function was called
 > t$secret_value
[1] "Blub"


From bbolker at gmail.com  Tue Feb 21 15:09:33 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 21 Feb 2012 14:09:33 +0000
Subject: [Rd] Jazzing up the Task Views index page
References: <CANVKczPAoruV7iC4PHLc9PtyZmBYustZf1v4v_U-KhTtaq8yyQ@mail.gmail.com>
Message-ID: <loom.20120221T150452-551@post.gmane.org>

Barry Rowlingson <b.rowlingson <at> lancaster.ac.uk> writes:

> Anyway, I did say that Task Views were rather brilliant, but were let
> down by their hidden position on the R web sites (tucked away as the
> third element of a sub-menu of a CRAN mirror site linked to by the
> CRAN link from the Download menu on the main R home page). The index
> page is rather plain, so I designed a more engaging one. The result of
> my effort is now here:
> 
> http://www.maths.lancs.ac.uk/~rowlings/R/TaskViews/
> 
> Having done that, I even considered that something like that could
> replace the R Homepage. Giving new visitors an idea of the vast range
> of techniques and application areas available in R would seem to be
> better than the current graphic which has been there since perhaps
> 2004.

  I love it.  The only problem I have with it is that it's a little
harder to grasp the whole list since the titles of the individual task
views are now so spread out.

  What is it about Bayesian statistics and elephants? (Clark's book
on Bayesian models for ecology also has an elephant.) Is it the
elephant in the room no-one will talk about?  Or is it the "give
me four parameters and I'll draw you an elephant" thing?


From Achim.Zeileis at uibk.ac.at  Tue Feb 21 15:11:24 2012
From: Achim.Zeileis at uibk.ac.at (Achim Zeileis)
Date: Tue, 21 Feb 2012 15:11:24 +0100 (CET)
Subject: [Rd] Jazzing up the Task Views index page
In-Reply-To: <CANVKczPAoruV7iC4PHLc9PtyZmBYustZf1v4v_U-KhTtaq8yyQ@mail.gmail.com>
References: <CANVKczPAoruV7iC4PHLc9PtyZmBYustZf1v4v_U-KhTtaq8yyQ@mail.gmail.com>
Message-ID: <alpine.DEB.2.02.1202211451160.29008@paninaro.uibk.ac.at>

Barry,

thanks for the ideas and the suggestion of a more interesting title page 
for the task views. Just a few comments from me as the person coordinating 
the task views on CRAN:

o The design of CRAN task view presentation/installation was chosen to be 
parallel to CRAN package presentation/installation. In particular, the 
task views are mirrored with the rest of CRAN and all links refer to the 
locally available package pages. Also, installation can be done from any 
repository.

o While this is good for distributing web services, it limits the 
possibilities in terms of web design. In think that the CRAN maintainers 
do not use Javascript, for example.

o Personally, I like the images used but I could imagine that some 
maintainers would prefer different pictures (e.g., a different 
visualization of a posterior for the Bayesian task view). But if the 
maintainers choose the images, it would be harder to assure a consistent 
design, I guess.

So there are some practical caveats when implementing such an approach. 
Certainly nothing insurmountable but maybe not very straightforward 
either. In any case, I will keep the "ctv" tools in sync with the general 
approach taken by CRAN.

Best,
Z

On Tue, 21 Feb 2012, Barry Rowlingson wrote:

> A little while ago here we had a short discussion about Task Views - I
> think ignited by someone saying 'how many times do I have to say "have
> you read the Optimisation Task View?"?' and I poured some fuel on that
> fire by saying "Task Views" was a stupid name.
>
> Anyway, I did say that Task Views were rather brilliant, but were let
> down by their hidden position on the R web sites (tucked away as the
> third element of a sub-menu of a CRAN mirror site linked to by the
> CRAN link from the Download menu on the main R home page). The index
> page is rather plain, so I designed a more engaging one. The result of
> my effort is now here:
>
> http://www.maths.lancs.ac.uk/~rowlings/R/TaskViews/
>
> Having done that, I even considered that something like that could
> replace the R Homepage. Giving new visitors an idea of the vast range
> of techniques and application areas available in R would seem to be
> better than the current graphic which has been there since perhaps
> 2004.
>
> Comments, thoughts, flames, etc?
>
> Barry
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hadley at rice.edu  Tue Feb 21 15:32:01 2012
From: hadley at rice.edu (Hadley Wickham)
Date: Tue, 21 Feb 2012 15:32:01 +0100
Subject: [Rd] Jazzing up the Task Views index page
In-Reply-To: <alpine.DEB.2.02.1202211451160.29008@paninaro.uibk.ac.at>
References: <CANVKczPAoruV7iC4PHLc9PtyZmBYustZf1v4v_U-KhTtaq8yyQ@mail.gmail.com>
	<alpine.DEB.2.02.1202211451160.29008@paninaro.uibk.ac.at>
Message-ID: <CABdHhvH1fCvnpddJHpt4fAvpK1aW19fsL2mVA_xAgM0avojDoQ@mail.gmail.com>

> o While this is good for distributing web services, it limits the
> possibilities in terms of web design. In think that the CRAN maintainers do
> not use Javascript, for example.

Did you try it without js?  The jquery masonry plugin should have ok
fall-back behaviour if JS is disabled.  (Although Barry has  display:
inline in his css, which I don't think is correct)

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From hadley at rice.edu  Tue Feb 21 15:35:06 2012
From: hadley at rice.edu (Hadley Wickham)
Date: Tue, 21 Feb 2012 15:35:06 +0100
Subject: [Rd] Jazzing up the Task Views index page
In-Reply-To: <CANVKczPAoruV7iC4PHLc9PtyZmBYustZf1v4v_U-KhTtaq8yyQ@mail.gmail.com>
References: <CANVKczPAoruV7iC4PHLc9PtyZmBYustZf1v4v_U-KhTtaq8yyQ@mail.gmail.com>
Message-ID: <CABdHhvERrh1M+scf5DysBfhASzTCNQSnbLn1vYMMgFhB3vy7FA@mail.gmail.com>

> Anyway, I did say that Task Views were rather brilliant, but were let
> down by their hidden position on the R web sites (tucked away as the
> third element of a sub-menu of a CRAN mirror site linked to by the
> CRAN link from the Download menu on the main R home page). The index
> page is rather plain, so I designed a more engaging one. The result of
> my effort is now here:
>
> http://www.maths.lancs.ac.uk/~rowlings/R/TaskViews/
>
> Having done that, I even considered that something like that could
> replace the R Homepage. Giving new visitors an idea of the vast range
> of techniques and application areas available in R would seem to be
> better than the current graphic which has been there since perhaps
> 2004.
>
> Comments, thoughts, flames, etc?

I think it would be more appealing if you used the same sized image
for each category.  (And at least you should provide width and height
attributes so layout can complete before the images are loaded)

You might also want to consider using something like
http://twitter.github.com/bootstrap/ for nicer default font sizes etc.

Hadley

-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From xieyihui at gmail.com  Tue Feb 21 15:38:47 2012
From: xieyihui at gmail.com (Yihui Xie)
Date: Tue, 21 Feb 2012 08:38:47 -0600
Subject: [Rd] Jazzing up the Task Views index page
In-Reply-To: <loom.20120221T150452-551@post.gmane.org>
References: <CANVKczPAoruV7iC4PHLc9PtyZmBYustZf1v4v_U-KhTtaq8yyQ@mail.gmail.com>
	<loom.20120221T150452-551@post.gmane.org>
Message-ID: <CANROs4cFQXNMejPmnsMjHkqo5AvZ0zb63G0w7r3S1gbJRKP8zw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120221/e0506109/attachment.pl>

From bhh at xs4all.nl  Tue Feb 21 15:01:58 2012
From: bhh at xs4all.nl (Berend Hasselman)
Date: Tue, 21 Feb 2012 15:01:58 +0100
Subject: [Rd] Jazzing up the Task Views index page
In-Reply-To: <CANVKczPAoruV7iC4PHLc9PtyZmBYustZf1v4v_U-KhTtaq8yyQ@mail.gmail.com>
References: <CANVKczPAoruV7iC4PHLc9PtyZmBYustZf1v4v_U-KhTtaq8yyQ@mail.gmail.com>
Message-ID: <505400AF-CFEE-4B07-B269-07DF6A9A0157@xs4all.nl>


On 21-02-2012, at 13:58, Barry Rowlingson wrote:

> A little while ago here we had a short discussion about Task Views - I
> think ignited by someone saying 'how many times do I have to say "have
> you read the Optimisation Task View?"?' and I poured some fuel on that
> fire by saying "Task Views" was a stupid name.
> 
> Anyway, I did say that Task Views were rather brilliant, but were let
> down by their hidden position on the R web sites (tucked away as the
> third element of a sub-menu of a CRAN mirror site linked to by the
> CRAN link from the Download menu on the main R home page). The index
> page is rather plain, so I designed a more engaging one. The result of
> my effort is now here:
> 
> http://www.maths.lancs.ac.uk/~rowlings/R/TaskViews/
> 
> Having done that, I even considered that something like that could
> replace the R Homepage. Giving new visitors an idea of the vast range
> of techniques and application areas available in R would seem to be
> better than the current graphic which has been there since perhaps
> 2004.
> 
> Comments, thoughts, flames, etc?

Looks really nice. I think you did a very good job.
Two suggestions:

1. make each image the same hight.
2. make each box the same height and width. Would be more restful to the eyes. It's a bit chaotic now.

Something similar for the R home page would be very nice.

Berend


From mailinglist.honeypot at gmail.com  Tue Feb 21 17:13:29 2012
From: mailinglist.honeypot at gmail.com (Steve Lianoglou)
Date: Tue, 21 Feb 2012 11:13:29 -0500
Subject: [Rd] Why cant my S4 class have a slot named `C`?
Message-ID: <CAHA9McNhzBcZy6PkeSmV8QSb9apaq6PZc3a5-TG+uiqvnPxwig@mail.gmail.com>

Hi all,

This feature was throwing me for a loop for quite some time until I
played with the names of the slots.

Consider exhibit A:

==============
setClass("SVM",
         representation=representation(
           x='numeric',
           y='numeric',
           C='numeric',
           eps='numeric'),
         prototype=prototype(
           x=numeric(),
           y=numeric(),
           C=numeric(),
           eps=numeric()))

SVM <- function(x, y, C, eps) {
  new("SVM", x=x, y=y, C=C, eps=eps)
}

And now a call to my "constructor"

R> SVM(1:10, 1:10, 1, 0.5)
Error in .getClassFromCache(Class, where) :
  Class should be either a character-string name or a class definition

==================

This error occurs with both R-2.14.1 and R-devel


Changing the name name from `C` to `Cost` fixes it:

==================
setClass("svm",
         representation=representation(
           x='numeric',
           y='numeric',
           Cost='numeric',
           eps='numeric'),
         prototype=prototype(
           x=numeric(),
           y=numeric(),
           Cost=numeric(),
           eps=numeric()))

svm <- function(x, y, Cost, eps) {
  new("svm", x=x, y=y, Cost=Cost, eps=eps)
}

R> svm(1:10, 1:10, 1, 0.5)
An object of class "svm"
Slot "x":
 [1]  1  2  3  4  5  6  7  8  9 10

Slot "y":
 [1]  1  2  3  4  5  6  7  8  9 10

Slot "Cost":
[1] 1

Slot "eps":
[1] 0.

===================

I was fishing around the R-devel mailing list w/ that error message to
see if anything turned up but I wasn't having any luck so it took a
while to figure out what was going on.

Is this known/intended behavior? Maybe I missed it in the
documentation (not sure where that might have been)?
If it is intended, maybe a better error message would be more useful?

Thanks,
-steve

-- 
Steve Lianoglou
Graduate Student: Computational Systems Biology
?| Memorial Sloan-Kettering Cancer Center
?| Weill Medical College of Cornell University
Contact Info: http://cbio.mskcc.org/~lianos/contact


From mtmorgan at fhcrc.org  Tue Feb 21 17:54:21 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Tue, 21 Feb 2012 08:54:21 -0800
Subject: [Rd] Why cant my S4 class have a slot named `C`?
In-Reply-To: <CAHA9McNhzBcZy6PkeSmV8QSb9apaq6PZc3a5-TG+uiqvnPxwig@mail.gmail.com>
References: <CAHA9McNhzBcZy6PkeSmV8QSb9apaq6PZc3a5-TG+uiqvnPxwig@mail.gmail.com>
Message-ID: <4F43CC3D.5050508@fhcrc.org>

On 02/21/2012 08:13 AM, Steve Lianoglou wrote:
> Hi all,
>
> This feature was throwing me for a loop for quite some time until I
> played with the names of the slots.
>
> Consider exhibit A:
>
> ==============
> setClass("SVM",
>           representation=representation(
>             x='numeric',
>             y='numeric',
>             C='numeric',
>             eps='numeric'),
>           prototype=prototype(
>             x=numeric(),
>             y=numeric(),
>             C=numeric(),
>             eps=numeric()))
>
> SVM<- function(x, y, C, eps) {
>    new("SVM", x=x, y=y, C=C, eps=eps)
> }
>
> And now a call to my "constructor"
>
> R>  SVM(1:10, 1:10, 1, 0.5)
> Error in .getClassFromCache(Class, where) :
>    Class should be either a character-string name or a class definition

Hi Steve --

args(new) shows that new has a single named argument Class. R's rules of 
partial matching mean that C matches Class before the unnamed "SVM", as in

   f = function(XXX=1, ...) XXX
   f(2, X=3) # returns 3

so name your arg to new

SVM <- function(x, y, C, eps) {
     new(Class="SVM", x=x, y=y, C=C, eps=eps)
}

Martin
>
> ==================
>
> This error occurs with both R-2.14.1 and R-devel
>
>
> Changing the name name from `C` to `Cost` fixes it:
>
> ==================
> setClass("svm",
>           representation=representation(
>             x='numeric',
>             y='numeric',
>             Cost='numeric',
>             eps='numeric'),
>           prototype=prototype(
>             x=numeric(),
>             y=numeric(),
>             Cost=numeric(),
>             eps=numeric()))
>
> svm<- function(x, y, Cost, eps) {
>    new("svm", x=x, y=y, Cost=Cost, eps=eps)
> }
>
> R>  svm(1:10, 1:10, 1, 0.5)
> An object of class "svm"
> Slot "x":
>   [1]  1  2  3  4  5  6  7  8  9 10
>
> Slot "y":
>   [1]  1  2  3  4  5  6  7  8  9 10
>
> Slot "Cost":
> [1] 1
>
> Slot "eps":
> [1] 0.
>
> ===================
>
> I was fishing around the R-devel mailing list w/ that error message to
> see if anything turned up but I wasn't having any luck so it took a
> while to figure out what was going on.
>
> Is this known/intended behavior? Maybe I missed it in the
> documentation (not sure where that might have been)?
> If it is intended, maybe a better error message would be more useful?
>
> Thanks,
> -steve
>


-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From mailinglist.honeypot at gmail.com  Tue Feb 21 18:25:52 2012
From: mailinglist.honeypot at gmail.com (Steve Lianoglou)
Date: Tue, 21 Feb 2012 12:25:52 -0500
Subject: [Rd] Why cant my S4 class have a slot named `C`?
In-Reply-To: <4F43CC3D.5050508@fhcrc.org>
References: <CAHA9McNhzBcZy6PkeSmV8QSb9apaq6PZc3a5-TG+uiqvnPxwig@mail.gmail.com>
	<4F43CC3D.5050508@fhcrc.org>
Message-ID: <CAHA9McN_KLT4kVc5fLBEbMs3qGFM7zDypM87Cr0Yqz2g0tftGA@mail.gmail.com>

Hi,

On Tue, Feb 21, 2012 at 11:54 AM, Martin Morgan <mtmorgan at fhcrc.org> wrote:
[snip]

> Hi Steve --
>
> args(new) shows that new has a single named argument Class. R's rules of
> partial matching mean that C matches Class before the unnamed "SVM", as in
>
> ?f = function(XXX=1, ...) XXX
> ?f(2, X=3) # returns 3
>
> so name your arg to new
[/snip]

[facepalm]
Jeez ... I totally knew that, too ... just wasn't putting 2 and 2
together, here.

Thanks for taking the time to point that out.

-steve

-- 
Steve Lianoglou
Graduate Student: Computational Systems Biology
?| Memorial Sloan-Kettering Cancer Center
?| Weill Medical College of Cornell University
Contact Info: http://cbio.mskcc.org/~lianos/contact


From yinnerspace at gmail.com  Tue Feb 21 19:29:05 2012
From: yinnerspace at gmail.com (yindalon)
Date: Tue, 21 Feb 2012 10:29:05 -0800 (PST)
Subject: [Rd] Loading externally created LIBSVM model into R.
Message-ID: <1329848945950-4407853.post@n4.nabble.com>

I used the c binary svm-train in LIBSVM to create a model file. 
How do I load this model file into R? Is there a function in R package e1071
that accomplishes this operation?

Thanks, Yin

--
View this message in context: http://r.789695.n4.nabble.com/Loading-externally-created-LIBSVM-model-into-R-tp4407853p4407853.html
Sent from the R devel mailing list archive at Nabble.com.


From brian at braverock.com  Tue Feb 21 20:20:09 2012
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 21 Feb 2012 13:20:09 -0600
Subject: [Rd] tempdir() documentation or real bug ?
In-Reply-To: <1329850135.8901.171.camel@brian-rcg>
References: <CA+xi=qYgspXhS6hyNn_-p-ksMV-WrrkgzFYm2++qCR2rUii-8Q@mail.gmail.com>
	<1329509593.8901.116.camel@brian-rcg>
	<CA+xi=qbhnX+1rfuQ_iF_H=oeJSHWifTuEs8rcpiW8b7LSsYiXg@mail.gmail.com>
	<1329848378.8901.170.camel@brian-rcg>
	<CA+xi=qZia+=yDHXQgwmi_18raG-vig8KPpxPKVaTs-eXwBxUUw@mail.gmail.com>
	<CA+xi=qaCKDLLQWKJVgSe3z1xvntECH+_i0_zw9zqnj6C_uhcjQ@mail.gmail.com>
	<1329850135.8901.171.camel@brian-rcg>
Message-ID: <1329852009.8901.175.camel@brian-rcg>

?tempdir says

By default, ?tmpdir? will be the directory given by ?tempdir()?.
     This will be a subdirectory of the temporary directory found by
     the following rule.  The environment variables ?TMPDIR?, ?TMP? and
     ?TEMP? are checked in turn and the first found which points to a
     writable directory is used: if none succeeds ?/tmp? is used.


Unfortunately, it doesn't seem to work as advertised.

> Sys.setenv(TMPDIR='/home/brian/')
> Sys.getenv('TMPDIR')
[1] "/home/brian/"
> tempdir()
[1] "/tmp/RtmpfERGay"


> Sys.setenv(TEMP='/home/brian/')
> Sys.getenv('TEMP')
[1] "/home/brian/"
> tempdir()
[1] "/tmp/RtmpfERGay"


> Sys.setenv(TMP='/home/brian/')
> Sys.getenv('TMP')
[1] "/home/brian/"
> tempdir()
[1] "/tmp/RtmpfERGay"


Our /tmp/ directory is not very large, so I'd like to create tempdir()'s
in someplace that has space.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From simon.urbanek at r-project.org  Tue Feb 21 20:50:18 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 21 Feb 2012 14:50:18 -0500
Subject: [Rd] tempdir() documentation or real bug ?
In-Reply-To: <1329852009.8901.175.camel@brian-rcg>
References: <CA+xi=qYgspXhS6hyNn_-p-ksMV-WrrkgzFYm2++qCR2rUii-8Q@mail.gmail.com>
	<1329509593.8901.116.camel@brian-rcg>
	<CA+xi=qbhnX+1rfuQ_iF_H=oeJSHWifTuEs8rcpiW8b7LSsYiXg@mail.gmail.com>
	<1329848378.8901.170.camel@brian-rcg>
	<CA+xi=qZia+=yDHXQgwmi_18raG-vig8KPpxPKVaTs-eXwBxUUw@mail.gmail.com>
	<CA+xi=qaCKDLLQWKJVgSe3z1xvntECH+_i0_zw9zqnj6C_uhcjQ@mail.gmail.com>
	<1329850135.8901.171.camel@brian-rcg>
	<1329852009.8901.175.camel@brian-rcg>
Message-ID: <39E1487B-5E63-4818-8399-D2ECFD604DA5@r-project.org>


On Feb 21, 2012, at 2:20 PM, Brian G. Peterson wrote:

> ?tempdir says
> 
> By default, ?tmpdir? will be the directory given by ?tempdir()?.
>     This will be a subdirectory of the temporary directory found by
>     the following rule.  The environment variables ?TMPDIR?, ?TMP? and
>     ?TEMP? are checked in turn and the first found which points to a
>     writable directory is used: if none succeeds ?/tmp? is used.
> 
> 
> Unfortunately, it doesn't seem to work as advertised.
> 

It does - you are just setting the environment variable too late - the temporary directory is determined at R startup:

$ TMPDIR=/Users/urbanek R --slave -e 'print(tempdir())'
[1] "/Users/urbanek/RtmpDee89D"

Cheers,
Simon



>> Sys.setenv(TMPDIR='/home/brian/')
>> Sys.getenv('TMPDIR')
> [1] "/home/brian/"
>> tempdir()
> [1] "/tmp/RtmpfERGay"
> 
> 
>> Sys.setenv(TEMP='/home/brian/')
>> Sys.getenv('TEMP')
> [1] "/home/brian/"
>> tempdir()
> [1] "/tmp/RtmpfERGay"
> 
> 
>> Sys.setenv(TMP='/home/brian/')
>> Sys.getenv('TMP')
> [1] "/home/brian/"
>> tempdir()
> [1] "/tmp/RtmpfERGay"
> 
> 
> Our /tmp/ directory is not very large, so I'd like to create tempdir()'s
> in someplace that has space.
> 
> Regards,
> 
>   - Brian
> 
> -- 
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From bbolker at gmail.com  Tue Feb 21 22:57:23 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Tue, 21 Feb 2012 16:57:23 -0500
Subject: [Rd] prior.weights and weights()
Message-ID: <4F441343.2010702@gmail.com>


I'm wondering whether anyone has any insight into why the 'simulate'
methods for the built-in glm() families (binomial, Poisson, Gamma ...)
extract the prior weights using object$prior.weights rather than
weights(object,"prior") ?

  At first I thought this was so that things work correctly when e.g.
subset= and na.action=na.exclude are used. However, the current versions
of the functions don't seem to work particularly well when these options
are used.  A Poisson example, along with a modified function that is
na.exclude-safe, is shown below ...

  My reason for wanting this is that I'm working on a package that uses
glm-like objects that don't have list-like structure, so can't contain
$prior.weights elements.  If weights were accessed using accessors, then
we could use the existing simulate() functions ...

  If R-core agreed that this is a shortcoming of the current
implementation, all of the simulate() methods would need to be rewritten
to account for this (as far as I can see there are four, for
binomial/Poisson/Gamma/inverse Gaussian -- the base method in
simulate.lm works OK (although it generates unnecessary random deviates
corresponding to the NA values in the fitted output).

  Actually, an even better design (in my opinion) might be to use
predict(object,type="response",...) internally rather than fitted() --
this would, for free, allow the use case

simulate(object,newdata=...)

  which would simulate values from the model for a novel set of
predictor variables ... (coincidentally, this would also allow our
package to use the existing framework more easily).

  Are there any circumstances under which
predict(object,type="response") is/could be *different* from
fitted(object) for a 'glm' object ... ?

  cheers
    Ben Bolker

===========================
d <- data.frame(y=rpois(10,1),x=rep(c(1,NA),5),f=rep(1:2,each=5))
## subset AND NA omission
g <- glm(y~x,data=d,subset=(f==2),family=poisson)

length(fitted(g)) ## 2
length(weights(g)) ## 2
length(g$prior.weights) ## 2
poisson()$simulate(g,1)  ## works

## now try na.exclude
g <- glm(y~x,data=d,subset=(f==2),na.action=na.exclude,
         family=poisson)
length(fitted(g)) ## 5
length(weights(g)) ## 5
length(g$prior.weights) ## 2
poisson()$simulate(g,1)  ## fails

## here's a new, 'safe' version of the Poisson simulate function ...
simnew <- function (object, nsim) {
  wts <- weights(object)
  if (any(na.omit(wts) != 1))
    warning("ignoring prior weights")
  ftd <- na.omit(fitted(object))
  napredict(na.action(object),
            rpois(nsim * length(ftd), ftd))
}

simnew(g,1)


From xie at yihui.name  Tue Feb 21 23:23:27 2012
From: xie at yihui.name (Yihui Xie)
Date: Tue, 21 Feb 2012 16:23:27 -0600
Subject: [Rd] Jazzing up the Task Views index page
In-Reply-To: <505400AF-CFEE-4B07-B269-07DF6A9A0157@xs4all.nl>
References: <CANVKczPAoruV7iC4PHLc9PtyZmBYustZf1v4v_U-KhTtaq8yyQ@mail.gmail.com>
	<505400AF-CFEE-4B07-B269-07DF6A9A0157@xs4all.nl>
Message-ID: <CANROs4foe4ForWi-WzJXtJqdVegWp-2WTSYFaq3vnNcEMKyaeQ@mail.gmail.com>

Actually I was also thinking about the R homepage last time when Barry
brought up this task view issue. The R website seems like an extreme
outlier among websites of many other programming languages. It is so
difficult to find another website today which still uses <frameset>,
and the whole site is almost plain text. Perhaps I have been pampered
by modern web designs. I wish I could do something about it, but I do
not have much spare time, and I do not know if R core is really
willing to change it. R is good at graphics, but the graphics in R
website...

Regards,
Yihui
--
Yihui Xie <xieyihui at gmail.com>
Phone: 515-294-2465 Web: http://yihui.name
Department of Statistics, Iowa State University
2215 Snedecor Hall, Ames, IA



On Tue, Feb 21, 2012 at 8:01 AM, Berend Hasselman <bhh at xs4all.nl> wrote:
>
> On 21-02-2012, at 13:58, Barry Rowlingson wrote:
>
>> A little while ago here we had a short discussion about Task Views - I
>> think ignited by someone saying 'how many times do I have to say "have
>> you read the Optimisation Task View?"?' and I poured some fuel on that
>> fire by saying "Task Views" was a stupid name.
>>
>> Anyway, I did say that Task Views were rather brilliant, but were let
>> down by their hidden position on the R web sites (tucked away as the
>> third element of a sub-menu of a CRAN mirror site linked to by the
>> CRAN link from the Download menu on the main R home page). The index
>> page is rather plain, so I designed a more engaging one. The result of
>> my effort is now here:
>>
>> http://www.maths.lancs.ac.uk/~rowlings/R/TaskViews/
>>
>> Having done that, I even considered that something like that could
>> replace the R Homepage. Giving new visitors an idea of the vast range
>> of techniques and application areas available in R would seem to be
>> better than the current graphic which has been there since perhaps
>> 2004.
>>
>> Comments, thoughts, flames, etc?
>
> Looks really nice. I think you did a very good job.
> Two suggestions:
>
> 1. make each image the same hight.
> 2. make each box the same height and width. Would be more restful to the eyes. It's a bit chaotic now.
>
> Something similar for the R home page would be very nice.
>
> Berend
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From mathieu.ribatet at math.univ-montp2.fr  Wed Feb 22 09:23:20 2012
From: mathieu.ribatet at math.univ-montp2.fr (Mathieu Ribatet)
Date: Wed, 22 Feb 2012 09:23:20 +0100
Subject: [Rd] OpenMP and random number generation
Message-ID: <A39D2681-A25E-4BD4-933F-A3AF706A4D6E@math.univ-montp2.fr>

Dear all,

Now that R has OpenMP facilities, I'm trying to use it for my own package but I'm still wondering if it is safe to use random number generation within a OpenMP block. I looked at the R writing extension document  both on the OpenMP and Random number generation but didn't find any information about that.

Could someone tell me if it is safe or not please ?

Best,
Mathieu

----------------------------------------------------------------- 
I3M, UMR CNRS 5149
Universite Montpellier II,
4 place Eugene Bataillon
34095 Montpellier cedex 5   France
http://www.math.univ-montp2.fr/~ribatet
Tel: + 33 (0)4 67 14 41 98


From ripley at stats.ox.ac.uk  Wed Feb 22 13:23:54 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 22 Feb 2012 12:23:54 +0000
Subject: [Rd] OpenMP and random number generation
In-Reply-To: <A39D2681-A25E-4BD4-933F-A3AF706A4D6E@math.univ-montp2.fr>
References: <A39D2681-A25E-4BD4-933F-A3AF706A4D6E@math.univ-montp2.fr>
Message-ID: <4F44DE5A.7070502@stats.ox.ac.uk>

On 22/02/2012 08:23, Mathieu Ribatet wrote:
> Dear all,
>
> Now that R has OpenMP facilities,

Hmm, not exactly new.

> I'm trying to use it for my own package but I'm still wondering if it
is safe to use random number generation within a OpenMP block. I looked 
at the R writing extension document  both on the OpenMP and Random 
number generation but didn't find any information about that.
>
> Could someone tell me if it is safe or not please ?

Using threads in compiled code called from R (e.g. pthreads or OpenMP) 
is 'for experts only': we do not document which parts of R are or are 
not thread-safe except via making the sources available.  If you need to 
ask then it is not safe for you, and in particular it would be unsafe to 
call Get/PutRNGstate.

> Best,
> Mathieu
>
> -----------------------------------------------------------------
> I3M, UMR CNRS 5149
> Universite Montpellier II,
> 4 place Eugene Bataillon
> 34095 Montpellier cedex 5   France
> http://www.math.univ-montp2.fr/~ribatet
> Tel: + 33 (0)4 67 14 41 98

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From karl.forner at gmail.com  Wed Feb 22 14:52:48 2012
From: karl.forner at gmail.com (Karl Forner)
Date: Wed, 22 Feb 2012 14:52:48 +0100
Subject: [Rd] OpenMP and random number generation
In-Reply-To: <A39D2681-A25E-4BD4-933F-A3AF706A4D6E@math.univ-montp2.fr>
References: <A39D2681-A25E-4BD4-933F-A3AF706A4D6E@math.univ-montp2.fr>
Message-ID: <CAMd4_AcWCRmF6RSUdBYcrmCzpVU7jBCbJnUjZKCf7Qajhr2sKg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120222/bef3569f/attachment.pl>

From presnell at stat.ufl.edu  Wed Feb 22 16:05:22 2012
From: presnell at stat.ufl.edu (Brett Presnell)
Date: Wed, 22 Feb 2012 10:05:22 -0500
Subject: [Rd] Jazzing up the Task Views index page
In-Reply-To: <CANVKczPAoruV7iC4PHLc9PtyZmBYustZf1v4v_U-KhTtaq8yyQ@mail.gmail.com>
	(Barry Rowlingson's message of "Tue, 21 Feb 2012 12:58:25 +0000")
References: <CANVKczPAoruV7iC4PHLc9PtyZmBYustZf1v4v_U-KhTtaq8yyQ@mail.gmail.com>
Message-ID: <87k43e3o3x.fsf@stat.ufl.edu>


Regardless of the page's other merits (looks nice to me), I did enjoy
seeing my favorite teacher's (Dev Basu's) elephant in the Bayesian box.
Thanks for that.


From savicky at cs.cas.cz  Wed Feb 22 16:29:53 2012
From: savicky at cs.cas.cz (Petr Savicky)
Date: Wed, 22 Feb 2012 16:29:53 +0100
Subject: [Rd] OpenMP and random number generation
In-Reply-To: <A39D2681-A25E-4BD4-933F-A3AF706A4D6E@math.univ-montp2.fr>
References: <A39D2681-A25E-4BD4-933F-A3AF706A4D6E@math.univ-montp2.fr>
Message-ID: <20120222152953.GC630@cs.cas.cz>

Hi.

> Now that R has OpenMP facilities, I'm trying to use it for my own package but I'm still wondering if it is safe to use random number generation within a OpenMP block. I looked at the R writing extension document  both on the OpenMP and Random number generation but didn't find any information about that.

Package CORElearn (i am a coauthor) uses random number generation
under OpenMP in C++. This requires to have a separate copy of the
generator with its own memory for each thread.

Do you want to use it in C or C++?

Petr Savicky.


From jwiley.psych at gmail.com  Wed Feb 22 16:34:07 2012
From: jwiley.psych at gmail.com (Joshua Wiley)
Date: Wed, 22 Feb 2012 07:34:07 -0800
Subject: [Rd] Jazzing up the Task Views index page
In-Reply-To: <CANVKczPAoruV7iC4PHLc9PtyZmBYustZf1v4v_U-KhTtaq8yyQ@mail.gmail.com>
References: <CANVKczPAoruV7iC4PHLc9PtyZmBYustZf1v4v_U-KhTtaq8yyQ@mail.gmail.com>
Message-ID: <CANz9Z_KhdzimcFc9DO38DY0S1D3Zrf5mjM31kX3ukZ2OzfSjDA@mail.gmail.com>

Hi,

In a way, a simple text based system is clean and is consistent with
the plain text requirements of the listservs, and interacting with R
through code/text.  However, for people with different backgrounds, it
can seem unappealing.  I definitely believe your page is more
inviting.

I work at a campus statistical consulting center and we are seeing a
substantial increase in researchers and grad students using R.  We
only recently began supporting R, and one thing I have noticed in both
clients and other consultants relatively unfamiliar with R is that
they often seem to not look beyond the core.  In my opinion, this is
partly responsible for the belief that R is difficult to use or that
task X is easier to do in program Y than in R.  I believe that better
marketing and navigability of the task views (which themselves are
excellent lists of packages relevant to particular disciplines or
applications) can help this perception.

Barry, is this a test/example only or would you plan on keeping
something like that on your site even if it is not adopted for cran
task views?  If it is not adopted elsewhere and you are willing to
maintain it, I would like to link to it.

Very nice work!

Cheers,

Josh

On Tue, Feb 21, 2012 at 4:58 AM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> A little while ago here we had a short discussion about Task Views - I
> think ignited by someone saying 'how many times do I have to say "have
> you read the Optimisation Task View?"?' and I poured some fuel on that
> fire by saying "Task Views" was a stupid name.
>
> Anyway, I did say that Task Views were rather brilliant, but were let
> down by their hidden position on the R web sites (tucked away as the
> third element of a sub-menu of a CRAN mirror site linked to by the
> CRAN link from the Download menu on the main R home page). The index
> page is rather plain, so I designed a more engaging one. The result of
> my effort is now here:
>
> http://www.maths.lancs.ac.uk/~rowlings/R/TaskViews/
>
> Having done that, I even considered that something like that could
> replace the R Homepage. Giving new visitors an idea of the vast range
> of techniques and application areas available in R would seem to be
> better than the current graphic which has been there since perhaps
> 2004.
>
> Comments, thoughts, flames, etc?
>
> Barry
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
Joshua Wiley
Ph.D. Student, Health Psychology
Programmer Analyst II, Statistical Consulting Group
University of California, Los Angeles
https://joshuawiley.com/


From pauljohn32 at gmail.com  Wed Feb 22 19:17:25 2012
From: pauljohn32 at gmail.com (Paul Johnson)
Date: Wed, 22 Feb 2012 12:17:25 -0600
Subject: [Rd] portable parallel seeds project: request for critiques
In-Reply-To: <20120221130427.GA15790@cs.cas.cz>
References: <CAErODj-KZo+Am6a30pnVrPC-STw++500=QOi-rZaMsXYWzeX+Q@mail.gmail.com>
	<20120221130427.GA15790@cs.cas.cz>
Message-ID: <CAErODj-g_hBA+37LqgGiAegdqVPcCecz9a74h3zySp2-LO-KXg@mail.gmail.com>

Greetings. Answers below.

On Tue, Feb 21, 2012 at 7:04 AM, Petr Savicky <savicky at cs.cas.cz> wrote:

>
> Hi.
>
> In the description of your project in the file
>
> ?http://winstat.quant.ku.edu/svn/hpcexample/trunk/Ex66-ParallelSeedPrototype/README
>
> you argue as follows
>
> ?Question: Why is this better than the simple old approach of
> ?setting the seeds within each run with a formula like
>
> ?set.seed(2345 + 10 * run)
>
> ?Answer: That does allow replication, but it does not assure
> ?that each run uses non-overlapping random number streams. It
> ?offers absolutely no assurance whatsoever that the runs are
> ?actually non-redundant.
>
> The following demonstrates that the function set.seed() for
> the default generator indeed allows to have correlated streams.
>
> ?step <- function(x)
> ?{
> ? ? ?x[x < 0] <- x[x < 0] + 2^32
> ? ? ?x <- (69069 * x + 1) %% 2^32
> ? ? ?x[x > 2^31] <- x[x > 2^31] - 2^32
> ? ? ?x
> ?}
>
> ?n <- 1000
> ?seed1 <- 124370417 # any seed
> ?seed2 <- step(seed1)
>
> ?set.seed(seed1)
> ?x <- runif(n)
> ?set.seed(seed2)
> ?y <- runif(n)
>
> ?rbind(seed1, seed2)
> ?table(x[-1] == y[-n])
>
> The output is
>
> ? ? ? ? ? ? [,1]
> ?seed1 124370417
> ?seed2 205739774
>
> ?FALSE ?TRUE
> ? ? ?5 ? 994
>
> This means that if the streams x, y are generated from the two
> seeds above, then y is almost exactly equal to x shifted by 1.
>
> What is the current state of your project?
>
> Petr Savicky.


Thanks for the example. That is exactly the point I've been making
about the old, ordinary way of setting seeds.

I continue testing on my plan, I believe it does work. The example
implementation is successful.  I have not received any critiques that
make me think it is theoretically wrong, but I also have not received
feedback from any body who has very detailed knowledge of R's parallel
package to tell me that my approach is good.

In order for this to be easy for users, I need to put the init streams
and set current stream functions into a package, and then streamline
the process of creating the seed array.  My opinion is that CRAN is
now overflowed with too many "one function" packages, I don't want to
create another one just for these two little functions, and I may roll
it into my general purpose regression package called "rockchalk".

If I worked in a company and had money riding on this, I'd need to
hire someone from R Core to stare at the way I'm setting, saving, and
re-setting the .Random.seed variable to be completely sure there are
not complications.  Because parallel package is so new, there is
relatively little documentation on how it is supposed to work. I'm
just gazing at the source code and trying not to  break anything it
does, and trying to stop it from breaking anything I do.

One technical issue that has been raised to me is that R parallel's
implementation of the L'Ecuyer generator is based on integer valued
variables, whereas the original L'Ecuyer code uses double real
variables.  But I'm trusting the R Core on this, if they code the
generator in a way that is good enough for R itself, it is good enough
for me. (And if that's wrong, we'll all find out together :) ).

Josef Leydold (the rstream package author) has argued that R's
implementation runs more slowly than it ought to. We had some
correspondence and I tracked a few threads in forums. It appears the
approach suggested there is roadblocked by some characteristics deep
down in R and the way random streams are managed.  Packages have only
a limited, tenuous method to replace R's generators with their own
generators. Here is the comment  that L'Ecuyer and Leydold make in the
document that is distributed with rstream..  "rstream: Streams of
Random Numbers for Stochastic Simulation"

"There is one drawback in the implementation. R uses a static table to
implement access to different
kinds of random number generators. Only one slot
(RNGkind(kind="user-supplied")) has been provided
for users who want to add her own generator. This slot relies on a
pointer to a function
called user_unif_rand. Thus rstream has to abuse this slot to add
additional random number
generators. However, there are other packages on CRAN that use the
same trick (randaes, rlecuyer,
rsprng, SuppDists) or load one of these packages (Rmpi, rpvm, rpart,
snow, varSelRF). Thus if a
user loads two of these packages or adds her own uniform random number
generator, the behavior
of at least one of the packages is broken. This problem could be fixed
by some changes in the R
core system, either by adding a package variableto
RNGkind(kind="user-supplied") similar to the
.Call function, or by replacing the static table by a dynamic one.

I interpret all of this to mean that, although other approaches may
work as well or better,
the only approach that can "defend itself " in the ecology of a
running R program is an approach
that fiddles with R's own generators, rather than tries to replace
them. And that's what I'm doing.

pj

ps

Just this moment, while googling for Leydold's comments, I found a
post I had not seen before. This is neat.

Parallel Random Number Generation in C++ and R Using RngStream
Andrew Karl ? Randy Eubank ? Dennis Young
http://math.la.asu.edu/~eubank/webpage/rngStreamPaper.pdf

I think that faces the same problem L'Ecuyer and Leydold described.
The package may hang its generator on one pointer inside the R random
scheme, but there's no way to be sure it stays there.




-- 
Paul E. Johnson
Professor, Political Science
1541 Lilac Lane, Room 504
University of Kansas


From jmc at r-project.org  Wed Feb 22 20:55:28 2012
From: jmc at r-project.org (John Chambers)
Date: Wed, 22 Feb 2012 11:55:28 -0800
Subject: [Rd] Private fields in reference classes (was: Private
 Variables in R5-Classes possible?)
In-Reply-To: <4F437AEC.2060401@uni-duesseldorf.de>
References: <4F437AEC.2060401@uni-duesseldorf.de>
Message-ID: <4F454830.6020502@r-project.org>

(Can we please follow the terminology in the ?ReferenceClasses 
documentation.  Creativity is fine but here we need communication)

This has come up (once) before off-list.  It could be made part of 
reference classes via a general rewriting that would improve efficiency 
as well.  Not imminent, but it would be good to know of other 
applications, including why they are useful.

Meanwhile, it could be implemented for a subclass of reference classes, 
by adding a special field that lists the private (or public, if you 
like) fields, and then implementing  S4 methods for "$"  and "$<-" that 
check there for disallowed/allowed names.  As presumably one wants, this 
leaves  methods in the class free to use the private fields.

John

On 2/21/12 3:07 AM, Claus Jonathan Fritzemeier wrote:
> Hi list,
>
> is there a way to define some kind of private Variable?
>
> I would like to prevent the user from manipulating fields on his own, 
> in order to not destroy data structures.
>
> The problem is, that as soon as the variable exists in the environment 
> it is accessible via t$secret_value.
>
> test <- setRefClass("test", fields=list(
> secret = function(value){
> cat("the function was called\n")
> if(missing(value)){
> if(exists("secret_value", envir=.self at .xData)){
> return(get("secret_value", envir=.self at .xData, inherits = F))
> }
> else{
> return(NULL)
> }
> }
> assign("secret_value", value=value, , envir=.self at .xData)
> }
> ) )
>
> > t <- test$new()
> > t$secret
> the function was called
> NULL
> > t$secret_value
> Error in envRefInferField(x, what, getClass(class(x)), selfEnv) :
> "secret_value" is not a valid field or method name for reference class 
> ?test?
> > t$secret <- "Blub"
> the function was called
> > t$secret_value
> [1] "Blub"
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From savicky at cs.cas.cz  Wed Feb 22 22:15:09 2012
From: savicky at cs.cas.cz (Petr Savicky)
Date: Wed, 22 Feb 2012 22:15:09 +0100
Subject: [Rd] portable parallel seeds project: request for critiques
In-Reply-To: <CAErODj-g_hBA+37LqgGiAegdqVPcCecz9a74h3zySp2-LO-KXg@mail.gmail.com>
References: <CAErODj-KZo+Am6a30pnVrPC-STw++500=QOi-rZaMsXYWzeX+Q@mail.gmail.com>
	<20120221130427.GA15790@cs.cas.cz>
	<CAErODj-g_hBA+37LqgGiAegdqVPcCecz9a74h3zySp2-LO-KXg@mail.gmail.com>
Message-ID: <20120222211509.GA28963@cs.cas.cz>

On Wed, Feb 22, 2012 at 12:17:25PM -0600, Paul Johnson wrote:
[...]
> In order for this to be easy for users, I need to put the init streams
> and set current stream functions into a package, and then streamline
> the process of creating the seed array.  My opinion is that CRAN is
> now overflowed with too many "one function" packages, I don't want to
> create another one just for these two little functions, and I may roll
> it into my general purpose regression package called "rockchalk".

I am also preparing a solution to the problem. One is based on AES
used for initialization of the R base Mersenne-Twister generator,
so it only replaces set.seed() function. Another solution is based
on "rlecuyer" package. I suggest to discuss the possible solutions
off-list before submitting to CRAN.

> One technical issue that has been raised to me is that R parallel's
> implementation of the L'Ecuyer generator is based on integer valued
> variables, whereas the original L'Ecuyer code uses double real
> variables.  But I'm trusting the R Core on this, if they code the
> generator in a way that is good enough for R itself, it is good enough
> for me. (And if that's wrong, we'll all find out together :) ).

I do not know about any L'Ecuyer's generator in R base. You probably
mean the authors of the extension packages with these generators.

> Josef Leydold (the rstream package author) has argued that R's
> implementation runs more slowly than it ought to. We had some
> correspondence and I tracked a few threads in forums. It appears the
> approach suggested there is roadblocked by some characteristics deep
> down in R and the way random streams are managed.  Packages have only
> a limited, tenuous method to replace R's generators with their own
> generators.

In order to connect a user defined generator to R, there are two
obligatory entry points "user_unif_rand" and "user_unif_init".
The first allows to call the generator from runif() and the similar
functions. The second connects the generator to set.seed() function.
If there is only one extension package with a generator loaded
to an R session, then these entry points are good enough. If the
package provides several generators, like "randtoolbox", it is
possible to change between them easily using functions provided
by the package for this purpose. I think that having several
packages with generators simultaneously can be good for their
development, but this is not needed for their use in applications.

There are also two other entry points "user_unif_nseed" and
"user_unif_seedloc", which allow to support the variable ".Random.seed".
A problem with this is that R converts the internal state of the
generator to ".Random.seed" by reading a specific memory location,
but does not alert the package about this event. So, if the state
requires a transformation to integer before storing to ".Random.seed",
it is not possible to do this only when needed.

In the package "rngwell19937", i included some code that tries to
determine, whether the user changed ".Random.seed" or not. The reason
is that most of the state is integer and is stored to ".Random.seed",
but the state contains also a function pointer, which is not stored.
It can be recomputed from ".Random.seed" and this recomputing is done,
if the package detects a change of ".Random.seed". This is not a nice
solution. So in "randtoolbox" we decided not to support ".Random.seed".

I understand that in the area of parallel computing, the work
with ".Random.seed" is a good paradigm, but if the generator
provides other tools for converting the state to an R object
and put it back to the active state, then ".Random.seed" is not
strictly necessary.

> Parallel Random Number Generation in C++ and R Using RngStream
> Andrew Karl ? Randy Eubank ? Dennis Young
> http://math.la.asu.edu/~eubank/webpage/rngStreamPaper.pdf

Thank you very much for this link.

All the best, Petr.


From surajg at gmail.com  Thu Feb 23 06:40:52 2012
From: surajg at gmail.com (Suraj Gupta)
Date: Thu, 23 Feb 2012 00:40:52 -0500
Subject: [Rd] Silently loading and Depends: versus NAMESPACE imports
In-Reply-To: <20260.7967.353013.815027@max.nulle.part>
References: <20237.58927.327444.422917@max.nulle.part>
	<4F0F3EC0.5060500@fhcrc.org>
	<20258.47943.798999.741944@max.nulle.part>
	<4F2419AE.5010203@statistik.tu-dortmund.de>
	<20260.7967.353013.815027@max.nulle.part>
Message-ID: <CAE9ddGDo7rf9rm6tsRdfhx+C=JHiTWwDeyV8z3jUi-bzR8mkgg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120223/a646babc/attachment.pl>

From hb at biostat.ucsf.edu  Thu Feb 23 09:14:58 2012
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Thu, 23 Feb 2012 00:14:58 -0800
Subject: [Rd] R devel [and R 2.14.1 patched]: R CMD build now sources
	~/.Rprofile
Message-ID: <CAFDcVCR5fChbvsiFPyVYsexgsS3n=SQ=FuFHk4tBNWgoVavvtQ@mail.gmail.com>

I'd like to follow up on this one.  It may be that I have
misunderstood something, but on both R devel (2012-02-22 r58452) and R
2.14.1 patched (2012-02-18 r58394) I can't seem to avoid loading
~/.Rprofile when I run 'R CMD <cmd>', e.g. R CMD build.  For me, the
loading of ~/.Rprofile by 'R CMD' started a few weeks ago, and I
haven't seen it before.  More details below.  It seems incorrect that
for instance 'R CMD check' should load the users ~/.Rprofile file by
default.  Is this a bug or intended?

/Henrik


On Wed, Feb 8, 2012 at 5:31 PM, Henrik Bengtsson <hb at biostat.ucsf.edu> wrote:
> I've just noticed that with a recent R devel on Windows, R CMD build
> sources ~/.Rprofile, e.g.
>
>> RCMD build
> Running ~/.Rprofile
>
>> R CMD build
> Running ~/.Rprofile
>
> FYI R --no-init-file & R --vanilla still avoid this.
>
>> sessionInfo()
> R Under development (unstable) (2012-02-08 r58297)
> Platform: x86_64-pc-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>>
>
> /Henrik


From ligges at statistik.tu-dortmund.de  Thu Feb 23 10:59:31 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 23 Feb 2012 10:59:31 +0100
Subject: [Rd] Silently loading and Depends: versus NAMESPACE imports
In-Reply-To: <CAE9ddGDo7rf9rm6tsRdfhx+C=JHiTWwDeyV8z3jUi-bzR8mkgg@mail.gmail.com>
References: <20237.58927.327444.422917@max.nulle.part>
	<4F0F3EC0.5060500@fhcrc.org>
	<20258.47943.798999.741944@max.nulle.part>
	<4F2419AE.5010203@statistik.tu-dortmund.de>
	<20260.7967.353013.815027@max.nulle.part>
	<CAE9ddGDo7rf9rm6tsRdfhx+C=JHiTWwDeyV8z3jUi-bzR8mkgg@mail.gmail.com>
Message-ID: <4F460E03.1000604@statistik.tu-dortmund.de>



On 23.02.2012 06:40, Suraj Gupta wrote:
> Dirk - I'm having the same issue.  Could you provide the details of your
> solution?

By moving the startup message generation to .onAttach?

Uwe Ligges


>
> On Sat, Jan 28, 2012 at 11:15 AM, Dirk Eddelbuettel<edd at debian.org>  wrote:
>
>>
>> On 28 January 2012 at 16:52, Uwe Ligges wrote:
>> |
>> |
>> | On 27.01.2012 15:57, Dirk Eddelbuettel wrote:
>> |>
>> |>  On 12 January 2012 at 12:12, Herv? Pag?s wrote:
>> |>  | Hi Dirk,
>> |>  |
>> |>  | On 01/11/2012 11:42 AM, Dirk Eddelbuettel wrote:
>> |>  |>
>> |>  |>   R CMD check really hates it when my .onLoad() function contains
>> |>  |>        suppressMessages(library(foo))
>> |>  |
>> |>  | Note that you can always fool 'R CMD check' by doing something like:
>> |>  |
>> |>  |      sillyname<- library
>> |>  |      suppressMessages(sillyname("foo"))
>> |>  |
>> |>  | Also isn't suppressPackageStartupMessages() more appropriate?
>> |>  |
>> |>  |>
>> |>  |>   However, _and for non-public packages not going to CRAN_ I prefer
>> doing this
>> |>  |>   over using explicit Depends or import statements in the NAMESPACE
>> file as the
>> |>  |>   latter do not give me an ability to make the loading less verbose.
>>   With the
>> |>  |>   R universe of packages being as vast as at is, a simple
>> (non-public) package
>> |>  |>   I have loads about five or six other packages explicitly, each of
>> which loads
>> |>  |>   even more.  The net result is totally intimidating _sixty lines
>> full_ of
>> |>  |>   verbose noise that is meaningful to me as an R programmer, but not
>> for the
>> |>  |>   colleagues expected to use the packages. It looks rather
>> uninviting, frankly.
>> |>  |>
>> |>  |>   How do I use imports via NAMESPACE, and yet keep the noise level
>> down to zero?
>> |>  |
>> |>  | If you only need to import foo (i.e. and actually don't need to
>> attach
>> |>  | it to the search path) then putting foo in Imports and using import
>> |>  | statements in NAMESPACE will keep the noise level down to zero.
>> |>
>> |>  I don't think so.
>> |>
>> |>  I have an internal package, call it fooUtils, that (among other
>> things) needs
>> |>  to figure at startup whether it runs on this or that OS.
>> |>
>> |>  So that package fooUtils does
>> |>
>> |>       .onLoad<- function(libname, pkgname) {
>> |>
>> |>           if (.Platform$OS.type == "windows") {
>> |>               packageStartupMessage("Running on Windows")
>> |>              # [... more stuff here ... ]
>> |>           } else if (.Platform$OS.type == "unix") {
>> |>               packageStartupMessage("Running on Linux")
>> |>              # [... more stuff here ... ]
>> |>           } else {
>> |>               warning("Platform ", .Platform$OS.type, " not recognised")
>> |>               drives<- NULL
>> |>           }
>> |>
>> |>           # ....
>> |>
>> |>       }
>> |
>> | Are you sure you want the messages in .onLoad rather than .onAttach?
>>
>> Thanks Uwe -- looks like that was exactly the hint I needed.
>>
>> By splitting the task across onLoad and onAttach I seem to be able to get
>> want I need even if the package is "tickled" via NAMESPACE's importFrom.
>>
>> Dirk
>>
>> | See ?.onLoad and its "Good practice" section:
>> |
>> | "Loading a namespace should where possible be silent, with startup
>> | messages given by .onAttach. These messages (and any essential ones from
>> | .onLoad) should use packageStartupMessage so they can be silenced where
>> | they would be a distraction."
>> |
>> | Best,
>> | Uwe
>> |
>> |
>> |
>> |>
>> |>  and contrary to your claim, this is not silent as soon as I do
>> |>
>> |>
>> |>      importFrom(fooUtils, someThing)
>> |>
>> |>
>> |>  the messages above pop up. While I can suppress them for 'normal'
>> loads via
>> |>
>> |>      suppressMessages(library(fooUtils))
>> |>
>> |>  or
>> |>
>> |>      suppressPackageStartupMessages(library(fooUtils))
>> |>
>> |>
>> |>  I cannot suppress them via NAMESPACE imports.
>> |>
>> |>  Dirk
>> |>
>> |>  | So I guess your question is: how do we suppress package startup
>> messages
>> |>  | for packages listed in Depends?
>> |>  |
>> |>  | Cheers,
>> |>  | H.
>> |>  |
>> |>  |>
>> |>  |>   Dirk
>> |>  |>
>> |>  |
>> |>  |
>> |>  | --
>> |>  | Herv? Pag?s
>> |>  |
>> |>  | Program in Computational Biology
>> |>  | Division of Public Health Sciences
>> |>  | Fred Hutchinson Cancer Research Center
>> |>  | 1100 Fairview Ave. N, M1-B514
>> |>  | P.O. Box 19024
>> |>  | Seattle, WA 98109-1024
>> |>  |
>> |>  | E-mail: hpages at fhcrc.org
>> |>  | Phone:  (206) 667-5791
>> |>  | Fax:    (206) 667-1319
>> |>
>>
>> --
>> "Outside of a dog, a book is a man's best friend. Inside of a dog, it is
>> too
>> dark to read." -- Groucho Marx
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From karl.forner at gmail.com  Thu Feb 23 19:06:39 2012
From: karl.forner at gmail.com (Karl Forner)
Date: Thu, 23 Feb 2012 19:06:39 +0100
Subject: [Rd] RcppProgress: progress monitoring and interrupting c++ code,
 request for comments
Message-ID: <CAMd4_Ac_yopBn198S3dVOcX4FuQuob7SQzb=X-k1NadvSWf7Lg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120223/52101856/attachment.pl>

From hb at biostat.ucsf.edu  Fri Feb 24 01:31:44 2012
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Thu, 23 Feb 2012 16:31:44 -0800
Subject: [Rd] R devel [and R 2.14.1 patched]: R CMD build now sources
	~/.Rprofile
In-Reply-To: <CAFDcVCR5fChbvsiFPyVYsexgsS3n=SQ=FuFHk4tBNWgoVavvtQ@mail.gmail.com>
References: <CAFDcVCR5fChbvsiFPyVYsexgsS3n=SQ=FuFHk4tBNWgoVavvtQ@mail.gmail.com>
Message-ID: <CAFDcVCTZik4Bt7KjKr5tAJdSPHVCa02gFQsk3LYd4U3b_=4LYQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120223/178e3696/attachment.pl>

From surajg at gmail.com  Fri Feb 24 06:27:29 2012
From: surajg at gmail.com (Suraj Gupta)
Date: Fri, 24 Feb 2012 00:27:29 -0500
Subject: [Rd] Silently loading and Depends: versus NAMESPACE imports
In-Reply-To: <4F460E03.1000604@statistik.tu-dortmund.de>
References: <20237.58927.327444.422917@max.nulle.part>
	<4F0F3EC0.5060500@fhcrc.org>
	<20258.47943.798999.741944@max.nulle.part>
	<4F2419AE.5010203@statistik.tu-dortmund.de>
	<20260.7967.353013.815027@max.nulle.part>
	<CAE9ddGDo7rf9rm6tsRdfhx+C=JHiTWwDeyV8z3jUi-bzR8mkgg@mail.gmail.com>
	<4F460E03.1000604@statistik.tu-dortmund.de>
Message-ID: <CAE9ddGCXf8J55mx=n4JZEyX3CXq0UB4rDzAjwJKCmVbhw-eroQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120224/fe099c79/attachment.pl>

From hpages at fhcrc.org  Fri Feb 24 07:45:12 2012
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Thu, 23 Feb 2012 22:45:12 -0800
Subject: [Rd] Silently loading and Depends: versus NAMESPACE imports
In-Reply-To: <20260.7967.353013.815027@max.nulle.part>
References: <20237.58927.327444.422917@max.nulle.part>
	<4F0F3EC0.5060500@fhcrc.org>
	<20258.47943.798999.741944@max.nulle.part>
	<4F2419AE.5010203@statistik.tu-dortmund.de>
	<20260.7967.353013.815027@max.nulle.part>
Message-ID: <4F4731F8.5090709@fhcrc.org>

On 01/28/2012 08:15 AM, Dirk Eddelbuettel wrote:
>
> On 28 January 2012 at 16:52, Uwe Ligges wrote:
> |
> |
> | On 27.01.2012 15:57, Dirk Eddelbuettel wrote:
> |>
> |>  On 12 January 2012 at 12:12, Herv? Pag?s wrote:
> |>  | Hi Dirk,
> |>  |
> |>  | On 01/11/2012 11:42 AM, Dirk Eddelbuettel wrote:
> |>  |>
> |>  |>   R CMD check really hates it when my .onLoad() function contains
> |>  |>        suppressMessages(library(foo))
> |>  |
> |>  | Note that you can always fool 'R CMD check' by doing something like:
> |>  |
> |>  |      sillyname<- library
> |>  |      suppressMessages(sillyname("foo"))
> |>  |
> |>  | Also isn't suppressPackageStartupMessages() more appropriate?
> |>  |
> |>  |>
> |>  |>   However, _and for non-public packages not going to CRAN_ I prefer doing this
> |>  |>   over using explicit Depends or import statements in the NAMESPACE file as the
> |>  |>   latter do not give me an ability to make the loading less verbose.  With the
> |>  |>   R universe of packages being as vast as at is, a simple (non-public) package
> |>  |>   I have loads about five or six other packages explicitly, each of which loads
> |>  |>   even more.  The net result is totally intimidating _sixty lines full_ of
> |>  |>   verbose noise that is meaningful to me as an R programmer, but not for the
> |>  |>   colleagues expected to use the packages. It looks rather uninviting, frankly.
> |>  |>
> |>  |>   How do I use imports via NAMESPACE, and yet keep the noise level down to zero?
> |>  |
> |>  | If you only need to import foo (i.e. and actually don't need to attach
> |>  | it to the search path) then putting foo in Imports and using import
> |>  | statements in NAMESPACE will keep the noise level down to zero.
> |>
> |>  I don't think so.
> |>
> |>  I have an internal package, call it fooUtils, that (among other things) needs
> |>  to figure at startup whether it runs on this or that OS.
> |>
> |>  So that package fooUtils does
> |>
> |>       .onLoad<- function(libname, pkgname) {
> |>
> |>           if (.Platform$OS.type == "windows") {
> |>               packageStartupMessage("Running on Windows")
> |>       	# [... more stuff here ... ]
> |>           } else if (.Platform$OS.type == "unix") {
> |>               packageStartupMessage("Running on Linux")
> |>       	# [... more stuff here ... ]
> |>           } else {
> |>               warning("Platform ", .Platform$OS.type, " not recognised")
> |>               drives<- NULL
> |>           }
> |>
> |>           # ....
> |>
> |>       }
> |
> | Are you sure you want the messages in .onLoad rather than .onAttach?

Yep. Since in your original post you didn't say that the package
you import had its startup message in the wrong place (.onLoad),
I assumed it was in the right place (.onAttach).

>
> Thanks Uwe -- looks like that was exactly the hint I needed.
>
> By splitting the task across onLoad and onAttach I seem to be able to get
> want I need even if the package is "tickled" via NAMESPACE's importFrom.

Are you saying you have some control over the package you import so you
could fix it?

H.

>
> Dirk
>
> | See ?.onLoad and its "Good practice" section:
> |
> | "Loading a namespace should where possible be silent, with startup
> | messages given by .onAttach. These messages (and any essential ones from
> | .onLoad) should use packageStartupMessage so they can be silenced where
> | they would be a distraction."
> |
> | Best,
> | Uwe
> |
> |
> |
> |>
> |>  and contrary to your claim, this is not silent as soon as I do
> |>
> |>
> |>      importFrom(fooUtils, someThing)
> |>
> |>
> |>  the messages above pop up. While I can suppress them for 'normal' loads via
> |>
> |>      suppressMessages(library(fooUtils))
> |>
> |>  or
> |>
> |>      suppressPackageStartupMessages(library(fooUtils))
> |>
> |>
> |>  I cannot suppress them via NAMESPACE imports.
> |>
> |>  Dirk
> |>
> |>  | So I guess your question is: how do we suppress package startup messages
> |>  | for packages listed in Depends?
> |>  |
> |>  | Cheers,
> |>  | H.
> |>  |
> |>  |>
> |>  |>   Dirk
> |>  |>
> |>  |
> |>  |
> |>  | --
> |>  | Herv? Pag?s
> |>  |
> |>  | Program in Computational Biology
> |>  | Division of Public Health Sciences
> |>  | Fred Hutchinson Cancer Research Center
> |>  | 1100 Fairview Ave. N, M1-B514
> |>  | P.O. Box 19024
> |>  | Seattle, WA 98109-1024
> |>  |
> |>  | E-mail: hpages at fhcrc.org
> |>  | Phone:  (206) 667-5791
> |>  | Fax:    (206) 667-1319
> |>
>


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From jorismeys at gmail.com  Fri Feb 24 11:24:35 2012
From: jorismeys at gmail.com (Joris Meys)
Date: Fri, 24 Feb 2012 11:24:35 +0100
Subject: [Rd] function remains loaded in the search space after detaching
	the package
Message-ID: <CAO1zAVbj-3ZS6zjPM9iR2+v_jZpccQNLqLsd4pm-jc7Yu6Jh2A@mail.gmail.com>

I ran into some very irritating behaviour I don't understand.  Let me
illustrate with the package gdata() and the function
print.object_size() :

> print(object.size(iris),units='Kb')
6.3 Kb
> getAnywhere(print.object_size)
A single object matching ?print.object_size? was found
It was found in the following places
  registered S3 method for print from namespace utils
  namespace:utils
with value
...

All is well. So now I load gdata

> require(gdata)
Loading required package: gdata
...
The following object(s) are masked from ?package:utils?:

    object.size

OK, this is what I would expect:

> print(object.size(iris),units='Kb')
[1] 6424
> getAnywhere(print.object_size)
2 differing objects matching ?print.object_size? were found
in the following places
  registered S3 method for print from namespace utils
  namespace:gdata
  namespace:utils
Use [] to view one of them

Now I detach gdata again

> detach(package:gdata)

But the function print.object_size is still the default for object_size objects!

> print(object.size(iris),units='Kb')
[1] 6424

And it can still be found as well:

> getAnywhere(print.object_size)
2 differing objects matching ?print.object_size? were found
in the following places
  registered S3 method for print from namespace utils
  namespace:gdata
  namespace:utils
Use [] to view one of them

Am I missing something?

Cheers
Joris

-- 
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Mathematical Modelling, Statistics and Bio-Informatics

tel : +32 9 264 59 87
Joris.Meys at Ugent.be
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php


From maechler at stat.math.ethz.ch  Fri Feb 24 12:20:15 2012
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 24 Feb 2012 12:20:15 +0100
Subject: [Rd] function remains loaded in the search space after
	detaching	the package
In-Reply-To: <CAO1zAVbj-3ZS6zjPM9iR2+v_jZpccQNLqLsd4pm-jc7Yu6Jh2A@mail.gmail.com>
References: <CAO1zAVbj-3ZS6zjPM9iR2+v_jZpccQNLqLsd4pm-jc7Yu6Jh2A@mail.gmail.com>
Message-ID: <20295.29295.713484.449385@stat.math.ethz.ch>

>>>>> Joris Meys <jorismeys at gmail.com>
>>>>>     on Fri, 24 Feb 2012 11:24:35 +0100 writes:

    > I ran into some very irritating behaviour I don't
    > understand.  Let me illustrate with the package gdata()
    > and the function print.object_size() :

    >> print(object.size(iris),units='Kb')
    > 6.3 Kb
    >> getAnywhere(print.object_size)
    > A single object matching ?print.object_size? was found It
    > was found in the following places registered S3 method for
    > print from namespace utils namespace:utils with value ...

    > All is well. So now I load gdata

    >> require(gdata)
    > Loading required package: gdata ...  The following
    > object(s) are masked from ?package:utils?:

    >     object.size

    > OK, this is what I would expect:

    >> print(object.size(iris),units='Kb')
    > [1] 6424
    >> getAnywhere(print.object_size)
    > 2 differing objects matching ?print.object_size? were
    > found in the following places registered S3 method for
    > print from namespace utils namespace:gdata namespace:utils
    > Use [] to view one of them

    > Now I detach gdata again

    >> detach(package:gdata)

    > But the function print.object_size is still the default
    > for object_size objects!

    >> print(object.size(iris),units='Kb')
    > [1] 6424

    > And it can still be found as well:

    >> getAnywhere(print.object_size)
    > 2 differing objects matching ?print.object_size? were
    > found in the following places registered S3 method for
    > print from namespace utils namespace:gdata namespace:utils
    > Use [] to view one of them

    > Am I missing something?

Yes:  the argument  'unload'   of detach().

In general: Now that every package has a namespace,
you (and others) should learn the difference between 
attaching and loading - and hence  detach()ing and unloading
a package with its namespace.

 ?detach
 ?library

etc should give a good start.

Martin Maechler, ETH Zurich


From jorismeys at gmail.com  Fri Feb 24 12:26:06 2012
From: jorismeys at gmail.com (Joris Meys)
Date: Fri, 24 Feb 2012 12:26:06 +0100
Subject: [Rd] function remains loaded in the search space after
 detaching the package
In-Reply-To: <20295.29295.713484.449385@stat.math.ethz.ch>
References: <CAO1zAVbj-3ZS6zjPM9iR2+v_jZpccQNLqLsd4pm-jc7Yu6Jh2A@mail.gmail.com>
	<20295.29295.713484.449385@stat.math.ethz.ch>
Message-ID: <CAO1zAVbcTxB-92vNy6KDqKe_+DRtm5MGuZMn-=sN_2S4P8GRUQ@mail.gmail.com>

Aaargh... I should RTFM more closely.  Thanks for pointing this out.

On Fri, Feb 24, 2012 at 12:20 PM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>>>>>> Joris Meys <jorismeys at gmail.com>
>>>>>> ? ? on Fri, 24 Feb 2012 11:24:35 +0100 writes:
>
> ? ?> I ran into some very irritating behaviour I don't
> ? ?> understand. ?Let me illustrate with the package gdata()
> ? ?> and the function print.object_size() :
>
> ? ?>> print(object.size(iris),units='Kb')
> ? ?> 6.3 Kb
> ? ?>> getAnywhere(print.object_size)
> ? ?> A single object matching ?print.object_size? was found It
> ? ?> was found in the following places registered S3 method for
> ? ?> print from namespace utils namespace:utils with value ...
>
> ? ?> All is well. So now I load gdata
>
> ? ?>> require(gdata)
> ? ?> Loading required package: gdata ... ?The following
> ? ?> object(s) are masked from ?package:utils?:
>
> ? ?> ? ? object.size
>
> ? ?> OK, this is what I would expect:
>
> ? ?>> print(object.size(iris),units='Kb')
> ? ?> [1] 6424
> ? ?>> getAnywhere(print.object_size)
> ? ?> 2 differing objects matching ?print.object_size? were
> ? ?> found in the following places registered S3 method for
> ? ?> print from namespace utils namespace:gdata namespace:utils
> ? ?> Use [] to view one of them
>
> ? ?> Now I detach gdata again
>
> ? ?>> detach(package:gdata)
>
> ? ?> But the function print.object_size is still the default
> ? ?> for object_size objects!
>
> ? ?>> print(object.size(iris),units='Kb')
> ? ?> [1] 6424
>
> ? ?> And it can still be found as well:
>
> ? ?>> getAnywhere(print.object_size)
> ? ?> 2 differing objects matching ?print.object_size? were
> ? ?> found in the following places registered S3 method for
> ? ?> print from namespace utils namespace:gdata namespace:utils
> ? ?> Use [] to view one of them
>
> ? ?> Am I missing something?
>
> Yes: ?the argument ?'unload' ? of detach().
>
> In general: Now that every package has a namespace,
> you (and others) should learn the difference between
> attaching and loading - and hence ?detach()ing and unloading
> a package with its namespace.
>
> ??detach
> ??library
>
> etc should give a good start.
>
> Martin Maechler, ETH Zurich



-- 
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Mathematical Modelling, Statistics and Bio-Informatics

tel : +32 9 264 59 87
Joris.Meys at Ugent.be
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php


From ligges at statistik.tu-dortmund.de  Fri Feb 24 12:56:37 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 24 Feb 2012 12:56:37 +0100
Subject: [Rd] Silently loading and Depends: versus NAMESPACE imports
In-Reply-To: <4F4731F8.5090709@fhcrc.org>
References: <20237.58927.327444.422917@max.nulle.part>
	<4F0F3EC0.5060500@fhcrc.org>
	<20258.47943.798999.741944@max.nulle.part>
	<4F2419AE.5010203@statistik.tu-dortmund.de>
	<20260.7967.353013.815027@max.nulle.part>
	<4F4731F8.5090709@fhcrc.org>
Message-ID: <4F477AF5.50104@statistik.tu-dortmund.de>



On 24.02.2012 07:45, Herv? Pag?s wrote:
> On 01/28/2012 08:15 AM, Dirk Eddelbuettel wrote:
>>
>> On 28 January 2012 at 16:52, Uwe Ligges wrote:
>> |
>> |
>> | On 27.01.2012 15:57, Dirk Eddelbuettel wrote:
>> |>
>> |> On 12 January 2012 at 12:12, Herv? Pag?s wrote:
>> |> | Hi Dirk,
>> |> |
>> |> | On 01/11/2012 11:42 AM, Dirk Eddelbuettel wrote:
>> |> |>
>> |> |> R CMD check really hates it when my .onLoad() function contains
>> |> |> suppressMessages(library(foo))
>> |> |
>> |> | Note that you can always fool 'R CMD check' by doing something like:
>> |> |
>> |> | sillyname<- library
>> |> | suppressMessages(sillyname("foo"))
>> |> |
>> |> | Also isn't suppressPackageStartupMessages() more appropriate?
>> |> |
>> |> |>
>> |> |> However, _and for non-public packages not going to CRAN_ I
>> prefer doing this
>> |> |> over using explicit Depends or import statements in the
>> NAMESPACE file as the
>> |> |> latter do not give me an ability to make the loading less
>> verbose. With the
>> |> |> R universe of packages being as vast as at is, a simple
>> (non-public) package
>> |> |> I have loads about five or six other packages explicitly, each
>> of which loads
>> |> |> even more. The net result is totally intimidating _sixty lines
>> full_ of
>> |> |> verbose noise that is meaningful to me as an R programmer, but
>> not for the
>> |> |> colleagues expected to use the packages. It looks rather
>> uninviting, frankly.
>> |> |>
>> |> |> How do I use imports via NAMESPACE, and yet keep the noise level
>> down to zero?
>> |> |
>> |> | If you only need to import foo (i.e. and actually don't need to
>> attach
>> |> | it to the search path) then putting foo in Imports and using import
>> |> | statements in NAMESPACE will keep the noise level down to zero.
>> |>
>> |> I don't think so.
>> |>
>> |> I have an internal package, call it fooUtils, that (among other
>> things) needs
>> |> to figure at startup whether it runs on this or that OS.
>> |>
>> |> So that package fooUtils does
>> |>
>> |> .onLoad<- function(libname, pkgname) {
>> |>
>> |> if (.Platform$OS.type == "windows") {
>> |> packageStartupMessage("Running on Windows")
>> |> # [... more stuff here ... ]
>> |> } else if (.Platform$OS.type == "unix") {
>> |> packageStartupMessage("Running on Linux")
>> |> # [... more stuff here ... ]
>> |> } else {
>> |> warning("Platform ", .Platform$OS.type, " not recognised")
>> |> drives<- NULL
>> |> }
>> |>
>> |> # ....
>> |>
>> |> }
>> |
>> | Are you sure you want the messages in .onLoad rather than .onAttach?
>
> Yep. Since in your original post you didn't say that the package
> you import had its startup message in the wrong place (.onLoad),
> I assumed it was in the right place (.onAttach).
>
>>
>> Thanks Uwe -- looks like that was exactly the hint I needed.
>>
>> By splitting the task across onLoad and onAttach I seem to be able to get
>> want I need even if the package is "tickled" via NAMESPACE's importFrom.
>
> Are you saying you have some control over the package you import so you
> could fix it?

Yes, Dirk had control but did not mention in that message. At least, at 
the time of writing, I was able to guess the real name of the packages 
Dirk was referring to given I had seen other communication off list.

Uwe


>
> H.
>
>>
>> Dirk
>>
>> | See ?.onLoad and its "Good practice" section:
>> |
>> | "Loading a namespace should where possible be silent, with startup
>> | messages given by .onAttach. These messages (and any essential ones
>> from
>> | .onLoad) should use packageStartupMessage so they can be silenced where
>> | they would be a distraction."
>> |
>> | Best,
>> | Uwe
>> |
>> |
>> |
>> |>
>> |> and contrary to your claim, this is not silent as soon as I do
>> |>
>> |>
>> |> importFrom(fooUtils, someThing)
>> |>
>> |>
>> |> the messages above pop up. While I can suppress them for 'normal'
>> loads via
>> |>
>> |> suppressMessages(library(fooUtils))
>> |>
>> |> or
>> |>
>> |> suppressPackageStartupMessages(library(fooUtils))
>> |>
>> |>
>> |> I cannot suppress them via NAMESPACE imports.
>> |>
>> |> Dirk
>> |>
>> |> | So I guess your question is: how do we suppress package startup
>> messages
>> |> | for packages listed in Depends?
>> |> |
>> |> | Cheers,
>> |> | H.
>> |> |
>> |> |>
>> |> |> Dirk
>> |> |>
>> |> |
>> |> |
>> |> | --
>> |> | Herv? Pag?s
>> |> |
>> |> | Program in Computational Biology
>> |> | Division of Public Health Sciences
>> |> | Fred Hutchinson Cancer Research Center
>> |> | 1100 Fairview Ave. N, M1-B514
>> |> | P.O. Box 19024
>> |> | Seattle, WA 98109-1024
>> |> |
>> |> | E-mail: hpages at fhcrc.org
>> |> | Phone: (206) 667-5791
>> |> | Fax: (206) 667-1319
>> |>
>>
>
>


From ripley at stats.ox.ac.uk  Fri Feb 24 13:08:13 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 24 Feb 2012 12:08:13 +0000
Subject: [Rd] function remains loaded in the search space after
 detaching the package
In-Reply-To: <20295.29295.713484.449385@stat.math.ethz.ch>
References: <CAO1zAVbj-3ZS6zjPM9iR2+v_jZpccQNLqLsd4pm-jc7Yu6Jh2A@mail.gmail.com>
	<20295.29295.713484.449385@stat.math.ethz.ch>
Message-ID: <4F477DAD.2050201@stats.ox.ac.uk>

On 24/02/2012 11:20, Martin Maechler wrote:
>>>>>> Joris Meys<jorismeys at gmail.com>
>>>>>>      on Fri, 24 Feb 2012 11:24:35 +0100 writes:
>
>      >  I ran into some very irritating behaviour I don't
>      >  understand.  Let me illustrate with the package gdata()
>      >  and the function print.object_size() :
>
>      >>  print(object.size(iris),units='Kb')
>      >  6.3 Kb
>      >>  getAnywhere(print.object_size)
>      >  A single object matching ?print.object_size? was found It
>      >  was found in the following places registered S3 method for
>      >  print from namespace utils namespace:utils with value ...
>
>      >  All is well. So now I load gdata
>
>      >>  require(gdata)
>      >  Loading required package: gdata ...  The following
>      >  object(s) are masked from ?package:utils?:
>
>      >      object.size
>
>      >  OK, this is what I would expect:
>
>      >>  print(object.size(iris),units='Kb')
>      >  [1] 6424
>      >>  getAnywhere(print.object_size)
>      >  2 differing objects matching ?print.object_size? were
>      >  found in the following places registered S3 method for
>      >  print from namespace utils namespace:gdata namespace:utils
>      >  Use [] to view one of them
>
>      >  Now I detach gdata again
>
>      >>  detach(package:gdata)
>
>      >  But the function print.object_size is still the default
>      >  for object_size objects!
>
>      >>  print(object.size(iris),units='Kb')
>      >  [1] 6424
>
>      >  And it can still be found as well:
>
>      >>  getAnywhere(print.object_size)
>      >  2 differing objects matching ?print.object_size? were
>      >  found in the following places registered S3 method for
>      >  print from namespace utils namespace:gdata namespace:utils
>      >  Use [] to view one of them
>
>      >  Am I missing something?
>
> Yes:  the argument  'unload'   of detach().
>
> In general: Now that every package has a namespace,
> you (and others) should learn the difference between
> attaching and loading - and hence  detach()ing and unloading
> a package with its namespace.
>
>   ?detach
>   ?library
>
> etc should give a good start.

A very good point, but actually there is more to this one.  'gdata' 
registers an S3 method which overwrites the one from utils.  Unloading a 
namespace does not unregister its methods (and registration has no 
stack, so there is no way R knows what was there before).

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From jorismeys at gmail.com  Fri Feb 24 13:25:53 2012
From: jorismeys at gmail.com (Joris Meys)
Date: Fri, 24 Feb 2012 13:25:53 +0100
Subject: [Rd] function remains loaded in the search space after
 detaching the package
In-Reply-To: <4F477DAD.2050201@stats.ox.ac.uk>
References: <CAO1zAVbj-3ZS6zjPM9iR2+v_jZpccQNLqLsd4pm-jc7Yu6Jh2A@mail.gmail.com>
	<20295.29295.713484.449385@stat.math.ethz.ch>
	<4F477DAD.2050201@stats.ox.ac.uk>
Message-ID: <CAO1zAVboAimGfvdT0whSd_eDYFpn7RdQK7K2msw9Q+-ycS58jg@mail.gmail.com>

Indeed, when trying :

> detach('package:gdata',unload=TRUE)
> print(object.size(iris),units='Kb')
[1] 6424

However, when I do :
> unloadNamespace('gdata')
> gc()
         used (Mb) gc trigger (Mb) max used (Mb)
Ncells 380471 10.2     667722 17.9   597831 16.0
Vcells 353363  2.7     905753  7.0   902804  6.9

The function used is still print.object_size from gdata

> print(object.size(iris),units='Kb')
[1] 6424

But it can't be found any more...

> getAnywhere('print.object_size')
A single object matching ?print.object_size? was found
It was found in the following places
  registered S3 method for print from namespace utils
  namespace:utils
with value
... (here is indeed the code of the original print.object_size)

This is not some kind of behaviour one would expect. I have no clue
how to solve this, but I believe it's safe to say that there's room
for improvement somewhere to avoid calling a function that's
apparently not in the search space. Any other ideas?

Cheers
Joris

On Fri, Feb 24, 2012 at 1:08 PM, Prof Brian Ripley
<ripley at stats.ox.ac.uk> wrote:
> On 24/02/2012 11:20, Martin Maechler wrote:
>>>>>>>
>>>>>>> Joris Meys<jorismeys at gmail.com>
>>>>>>> ? ? on Fri, 24 Feb 2012 11:24:35 +0100 writes:
>>
>>
>> ? ? > ?I ran into some very irritating behaviour I don't
>> ? ? > ?understand. ?Let me illustrate with the package gdata()
>> ? ? > ?and the function print.object_size() :
>>
>> ? ? >> ?print(object.size(iris),units='Kb')
>> ? ? > ?6.3 Kb
>> ? ? >> ?getAnywhere(print.object_size)
>> ? ? > ?A single object matching ?print.object_size? was found It
>> ? ? > ?was found in the following places registered S3 method for
>> ? ? > ?print from namespace utils namespace:utils with value ...
>>
>> ? ? > ?All is well. So now I load gdata
>>
>> ? ? >> ?require(gdata)
>> ? ? > ?Loading required package: gdata ... ?The following
>> ? ? > ?object(s) are masked from ?package:utils?:
>>
>> ? ? > ? ? ?object.size
>>
>> ? ? > ?OK, this is what I would expect:
>>
>> ? ? >> ?print(object.size(iris),units='Kb')
>> ? ? > ?[1] 6424
>> ? ? >> ?getAnywhere(print.object_size)
>> ? ? > ?2 differing objects matching ?print.object_size? were
>> ? ? > ?found in the following places registered S3 method for
>> ? ? > ?print from namespace utils namespace:gdata namespace:utils
>> ? ? > ?Use [] to view one of them
>>
>> ? ? > ?Now I detach gdata again
>>
>> ? ? >> ?detach(package:gdata)
>>
>> ? ? > ?But the function print.object_size is still the default
>> ? ? > ?for object_size objects!
>>
>> ? ? >> ?print(object.size(iris),units='Kb')
>> ? ? > ?[1] 6424
>>
>> ? ? > ?And it can still be found as well:
>>
>> ? ? >> ?getAnywhere(print.object_size)
>> ? ? > ?2 differing objects matching ?print.object_size? were
>> ? ? > ?found in the following places registered S3 method for
>> ? ? > ?print from namespace utils namespace:gdata namespace:utils
>> ? ? > ?Use [] to view one of them
>>
>> ? ? > ?Am I missing something?
>>
>> Yes: ?the argument ?'unload' ? of detach().
>>
>> In general: Now that every package has a namespace,
>> you (and others) should learn the difference between
>> attaching and loading - and hence ?detach()ing and unloading
>> a package with its namespace.
>>
>> ??detach
>> ??library
>>
>> etc should give a good start.
>
>
> A very good point, but actually there is more to this one. ?'gdata'
> registers an S3 method which overwrites the one from utils. ?Unloading a
> namespace does not unregister its methods (and registration has no stack, so
> there is no way R knows what was there before).
>
> --
> Brian D. Ripley, ? ? ? ? ? ? ? ? ?ripley at stats.ox.ac.uk
> Professor of Applied Statistics, ?http://www.stats.ox.ac.uk/~ripley/
> University of Oxford, ? ? ? ? ? ? Tel: ?+44 1865 272861 (self)
> 1 South Parks Road, ? ? ? ? ? ? ? ? ? ? +44 1865 272866 (PA)
> Oxford OX1 3TG, UK ? ? ? ? ? ? ? ?Fax: ?+44 1865 272595



-- 
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Mathematical Modelling, Statistics and Bio-Informatics

tel : +32 9 264 59 87
Joris.Meys at Ugent.be
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php


From edd at debian.org  Fri Feb 24 14:33:12 2012
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 24 Feb 2012 07:33:12 -0600
Subject: [Rd] Silently loading and Depends: versus NAMESPACE imports
In-Reply-To: <CAE9ddGCXf8J55mx=n4JZEyX3CXq0UB4rDzAjwJKCmVbhw-eroQ@mail.gmail.com>
References: <20237.58927.327444.422917@max.nulle.part>
	<4F0F3EC0.5060500@fhcrc.org>
	<20258.47943.798999.741944@max.nulle.part>
	<4F2419AE.5010203@statistik.tu-dortmund.de>
	<20260.7967.353013.815027@max.nulle.part>
	<CAE9ddGDo7rf9rm6tsRdfhx+C=JHiTWwDeyV8z3jUi-bzR8mkgg@mail.gmail.com>
	<4F460E03.1000604@statistik.tu-dortmund.de>
	<CAE9ddGCXf8J55mx=n4JZEyX3CXq0UB4rDzAjwJKCmVbhw-eroQ@mail.gmail.com>
Message-ID: <20295.37272.595195.206946@max.nulle.part>


On 24 February 2012 at 00:27, Suraj Gupta wrote:
| I don't think that is it. ?My startup message is currently in .onAttach and I
| still see startup message from packages that I have moved from Imports to
| Depends.
| Dirk?

There are / were are few issues intertwined in my case, and yours may differ:

 - are the messages from your code / packages and you startup messages ?

 - are they from imported packages ?

 - are they from R (reported 'foo being shadowed' or 'generic bar defined')

In my case a combination of using .onAttach and .onLoad (instead of just
.onLoad) together with import directives in a NAMESPACE file solved the
issue, as had been suggested on this list.

Dirk

-- 
"Outside of a dog, a book is a man's best friend. Inside of a dog, it is too
dark to read." -- Groucho Marx


From ripley at stats.ox.ac.uk  Fri Feb 24 15:01:10 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 24 Feb 2012 14:01:10 +0000 (GMT)
Subject: [Rd] function remains loaded in the search space after
 detaching the package
In-Reply-To: <CAO1zAVboAimGfvdT0whSd_eDYFpn7RdQK7K2msw9Q+-ycS58jg@mail.gmail.com>
References: <CAO1zAVbj-3ZS6zjPM9iR2+v_jZpccQNLqLsd4pm-jc7Yu6Jh2A@mail.gmail.com>
	<20295.29295.713484.449385@stat.math.ethz.ch>
	<4F477DAD.2050201@stats.ox.ac.uk>
	<CAO1zAVboAimGfvdT0whSd_eDYFpn7RdQK7K2msw9Q+-ycS58jg@mail.gmail.com>
Message-ID: <alpine.LFD.2.02.1202241248160.8848@toucan.stats.ox.ac.uk>

On Fri, 24 Feb 2012, Joris Meys wrote:

> Indeed, when trying :
>
>> detach('package:gdata',unload=TRUE)
>> print(object.size(iris),units='Kb')
> [1] 6424
>
> However, when I do :
>> unloadNamespace('gdata')
>> gc()
>         used (Mb) gc trigger (Mb) max used (Mb)
> Ncells 380471 10.2     667722 17.9   597831 16.0
> Vcells 353363  2.7     905753  7.0   902804  6.9
>
> The function used is still print.object_size from gdata
>
>> print(object.size(iris),units='Kb')
> [1] 6424
>
> But it can't be found any more...
>
>> getAnywhere('print.object_size')
> A single object matching ?print.object_size? was found
> It was found in the following places
>  registered S3 method for print from namespace utils
>  namespace:utils
> with value
> ... (here is indeed the code of the original print.object_size)

As

getS3method('print', 'object_size')

would have confirmed the expectations of a 'one' with a less sketchy
understanding of R.

> This is not some kind of behaviour one would expect. I have no clue
> how to solve this, but I believe it's safe to say that there's room
> for improvement somewhere to avoid calling a function that's
> apparently not in the search space. Any other ideas?

R relies very heavily on 'calling a function that's apparently not in 
the search space': that's much of the point of namespaces.

Professor Ripley

> Cheers
> Joris
>
> On Fri, Feb 24, 2012 at 1:08 PM, Prof Brian Ripley
> <ripley at stats.ox.ac.uk> wrote:
>> On 24/02/2012 11:20, Martin Maechler wrote:
>>>>>>>>
>>>>>>>> Joris Meys<jorismeys at gmail.com>
>>>>>>>> ? ? on Fri, 24 Feb 2012 11:24:35 +0100 writes:
>>>
>>>
>>> ? ? > ?I ran into some very irritating behaviour I don't
>>> ? ? > ?understand. ?Let me illustrate with the package gdata()
>>> ? ? > ?and the function print.object_size() :
>>>
>>> ? ? >> ?print(object.size(iris),units='Kb')
>>> ? ? > ?6.3 Kb
>>> ? ? >> ?getAnywhere(print.object_size)
>>> ? ? > ?A single object matching ?print.object_size? was found It
>>> ? ? > ?was found in the following places registered S3 method for
>>> ? ? > ?print from namespace utils namespace:utils with value ...
>>>
>>> ? ? > ?All is well. So now I load gdata
>>>
>>> ? ? >> ?require(gdata)
>>> ? ? > ?Loading required package: gdata ... ?The following
>>> ? ? > ?object(s) are masked from ?package:utils?:
>>>
>>> ? ? > ? ? ?object.size
>>>
>>> ? ? > ?OK, this is what I would expect:
>>>
>>> ? ? >> ?print(object.size(iris),units='Kb')
>>> ? ? > ?[1] 6424
>>> ? ? >> ?getAnywhere(print.object_size)
>>> ? ? > ?2 differing objects matching ?print.object_size? were
>>> ? ? > ?found in the following places registered S3 method for
>>> ? ? > ?print from namespace utils namespace:gdata namespace:utils
>>> ? ? > ?Use [] to view one of them
>>>
>>> ? ? > ?Now I detach gdata again
>>>
>>> ? ? >> ?detach(package:gdata)
>>>
>>> ? ? > ?But the function print.object_size is still the default
>>> ? ? > ?for object_size objects!
>>>
>>> ? ? >> ?print(object.size(iris),units='Kb')
>>> ? ? > ?[1] 6424
>>>
>>> ? ? > ?And it can still be found as well:
>>>
>>> ? ? >> ?getAnywhere(print.object_size)
>>> ? ? > ?2 differing objects matching ?print.object_size? were
>>> ? ? > ?found in the following places registered S3 method for
>>> ? ? > ?print from namespace utils namespace:gdata namespace:utils
>>> ? ? > ?Use [] to view one of them
>>>
>>> ? ? > ?Am I missing something?
>>>
>>> Yes: ?the argument ?'unload' ? of detach().
>>>
>>> In general: Now that every package has a namespace,
>>> you (and others) should learn the difference between
>>> attaching and loading - and hence ?detach()ing and unloading
>>> a package with its namespace.
>>>
>>> ??detach
>>> ??library
>>>
>>> etc should give a good start.
>>
>>
>> A very good point, but actually there is more to this one. ?'gdata'
>> registers an S3 method which overwrites the one from utils. ?Unloading a
>> namespace does not unregister its methods (and registration has no stack, so
>> there is no way R knows what was there before).
>>
>> --
>> Brian D. Ripley, ? ? ? ? ? ? ? ? ?ripley at stats.ox.ac.uk
>> Professor of Applied Statistics, ?http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford, ? ? ? ? ? ? Tel: ?+44 1865 272861 (self)
>> 1 South Parks Road, ? ? ? ? ? ? ? ? ? ? +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK ? ? ? ? ? ? ? ?Fax: ?+44 1865 272595
>
>
>
> -- 
> Joris Meys
> Statistical consultant
>
> Ghent University
> Faculty of Bioscience Engineering
> Department of Mathematical Modelling, Statistics and Bio-Informatics
>
> tel : +32 9 264 59 87
> Joris.Meys at Ugent.be
> -------------------------------
> Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jorismeys at gmail.com  Fri Feb 24 16:09:45 2012
From: jorismeys at gmail.com (Joris Meys)
Date: Fri, 24 Feb 2012 16:09:45 +0100
Subject: [Rd] function remains loaded in the search space after
 detaching the package
In-Reply-To: <alpine.LFD.2.02.1202241248160.8848@toucan.stats.ox.ac.uk>
References: <CAO1zAVbj-3ZS6zjPM9iR2+v_jZpccQNLqLsd4pm-jc7Yu6Jh2A@mail.gmail.com>
	<20295.29295.713484.449385@stat.math.ethz.ch>
	<4F477DAD.2050201@stats.ox.ac.uk>
	<CAO1zAVboAimGfvdT0whSd_eDYFpn7RdQK7K2msw9Q+-ycS58jg@mail.gmail.com>
	<alpine.LFD.2.02.1202241248160.8848@toucan.stats.ox.ac.uk>
Message-ID: <CAO1zAVYjhO7rn0HUukfBkvXdgLP_d+kLRMa09VAhsW7HLyhiwg@mail.gmail.com>

2012/2/24 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
>
> As
>
> getS3method('print', 'object_size')
>
> would have confirmed the expectations of a 'one' with a less sketchy
> understanding of R.
>
Yes, getS3method() sends you -not very surprisingly- to the one from
gdata. I realized, as print(object.size(iris)) gets that one as well,
and even in my sketchy understanding of R I suspect that both actions
have a similar underlying mechanism. But that's not my point.

Why would I have to expect the gdata version is still used (under the
correct assumption that I haven't been writing on the R source code
myself)? As a maybe-not-so-smart basic user of R, I would expect that
detach() and eventually unloadNamespace() would revert the effect of
library() (and loadNamespace() ). Apparently they don't.

The only way to reverse the action of require(gdata) seems to be to
restart R. That's at least what my limited brain could understand from
the valuable information given by both you and Martin. Seemingly
having to restart an application to undo an action, even in the
presence of functions with names that make you believe they revert a
former action, might in general be conceived as rather unexpected by
somebody with the same sketchy understanding of R as me. I would be
delighted if you could explain to me which part of R I understand
wrongly to come to this silly observation.

Sincerely,
Joris



-- 
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Mathematical Modelling, Statistics and Bio-Informatics

tel : +32 9 264 59 87
Joris.Meys at Ugent.be
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php


From ripley at stats.ox.ac.uk  Fri Feb 24 16:42:50 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 24 Feb 2012 15:42:50 +0000 (GMT)
Subject: [Rd] function remains loaded in the search space after
 detaching the package
In-Reply-To: <CAO1zAVYjhO7rn0HUukfBkvXdgLP_d+kLRMa09VAhsW7HLyhiwg@mail.gmail.com>
References: <CAO1zAVbj-3ZS6zjPM9iR2+v_jZpccQNLqLsd4pm-jc7Yu6Jh2A@mail.gmail.com>
	<20295.29295.713484.449385@stat.math.ethz.ch>
	<4F477DAD.2050201@stats.ox.ac.uk>
	<CAO1zAVboAimGfvdT0whSd_eDYFpn7RdQK7K2msw9Q+-ycS58jg@mail.gmail.com>
	<alpine.LFD.2.02.1202241248160.8848@toucan.stats.ox.ac.uk>
	<CAO1zAVYjhO7rn0HUukfBkvXdgLP_d+kLRMa09VAhsW7HLyhiwg@mail.gmail.com>
Message-ID: <alpine.LFD.2.02.1202241537320.14608@toucan.stats.ox.ac.uk>

fortunes::fortune('WTFM') applies.  As already pointed out, ?detach 
says

      If a package has a namespace, detaching it does not by default
      unload the namespace (and may not even with ?unload=TRUE?), and
      detaching will not in general unload any dynamically loaded
      compiled code (DLLs).  Further, registered S3 methods from the
      namespace will not be removed.  If you use ?library? on a package
      whose namespace is loaded, it attaches the exports of the already
      loaded namespace.  So detaching and re-attaching a package may not
      refresh some or all components of the package, and is inadvisable.

And that is explicitly mentioned on ?unloadNamespace ....

On Fri, 24 Feb 2012, Joris Meys wrote:

> 2012/2/24 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
>>
>> As
>>
>> getS3method('print', 'object_size')
>>
>> would have confirmed the expectations of a 'one' with a less sketchy
>> understanding of R.
>>
> Yes, getS3method() sends you -not very surprisingly- to the one from
> gdata. I realized, as print(object.size(iris)) gets that one as well,
> and even in my sketchy understanding of R I suspect that both actions
> have a similar underlying mechanism. But that's not my point.
>
> Why would I have to expect the gdata version is still used (under the
> correct assumption that I haven't been writing on the R source code
> myself)? As a maybe-not-so-smart basic user of R, I would expect that
> detach() and eventually unloadNamespace() would revert the effect of
> library() (and loadNamespace() ). Apparently they don't.
>
> The only way to reverse the action of require(gdata) seems to be to
> restart R. That's at least what my limited brain could understand from
> the valuable information given by both you and Martin. Seemingly
> having to restart an application to undo an action, even in the
> presence of functions with names that make you believe they revert a
> former action, might in general be conceived as rather unexpected by
> somebody with the same sketchy understanding of R as me. I would be
> delighted if you could explain to me which part of R I understand
> wrongly to come to this silly observation.

>
> Sincerely,
> Joris
>
>
>
> -- 
> Joris Meys
> Statistical consultant
>
> Ghent University
> Faculty of Bioscience Engineering
> Department of Mathematical Modelling, Statistics and Bio-Informatics
>
> tel : +32 9 264 59 87
> Joris.Meys at Ugent.be
> -------------------------------
> Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jorismeys at gmail.com  Fri Feb 24 16:55:55 2012
From: jorismeys at gmail.com (Joris Meys)
Date: Fri, 24 Feb 2012 16:55:55 +0100
Subject: [Rd] function remains loaded in the search space after
 detaching the package
In-Reply-To: <alpine.LFD.2.02.1202241537320.14608@toucan.stats.ox.ac.uk>
References: <CAO1zAVbj-3ZS6zjPM9iR2+v_jZpccQNLqLsd4pm-jc7Yu6Jh2A@mail.gmail.com>
	<20295.29295.713484.449385@stat.math.ethz.ch>
	<4F477DAD.2050201@stats.ox.ac.uk>
	<CAO1zAVboAimGfvdT0whSd_eDYFpn7RdQK7K2msw9Q+-ycS58jg@mail.gmail.com>
	<alpine.LFD.2.02.1202241248160.8848@toucan.stats.ox.ac.uk>
	<CAO1zAVYjhO7rn0HUukfBkvXdgLP_d+kLRMa09VAhsW7HLyhiwg@mail.gmail.com>
	<alpine.LFD.2.02.1202241537320.14608@toucan.stats.ox.ac.uk>
Message-ID: <CAO1zAVYVDahW4G-gU0o4ZXrgb-_RZ7OGu7M2-ivXuGCMFEQqDA@mail.gmail.com>

Maybe I should rephrase:

As mentioned by Martin, by you and by TFM (which I read),
unloadNamespaces does not remove registered S3 methods. I got the
message before. As to why it has to be this way, the people that WTFM
didn't really add much information to TFM for those who RTFM (nor do
they have to). I merely wondered why it had to be that way out of
interest, but maybe formulated my question in a less clear and more
offensive way.

So:

Given the fact that S3 methods are not removed by unloading a namespace:

 - What is the reason for this, as I would naively assume removing
them when unloading a namespace seems more useful?
 - How do you remove them without having to restart R?

Sincerely,
Joris

2012/2/24 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
> fortunes::fortune('WTFM') applies. ?As already pointed out, ?detach says
>
> ? ? If a package has a namespace, detaching it does not by default
> ? ? unload the namespace (and may not even with ?unload=TRUE?), and
> ? ? detaching will not in general unload any dynamically loaded
> ? ? compiled code (DLLs). ?Further, registered S3 methods from the
> ? ? namespace will not be removed. ?If you use ?library? on a package
> ? ? whose namespace is loaded, it attaches the exports of the already
> ? ? loaded namespace. ?So detaching and re-attaching a package may not
> ? ? refresh some or all components of the package, and is inadvisable.
>
> And that is explicitly mentioned on ?unloadNamespace ....
>
>
> On Fri, 24 Feb 2012, Joris Meys wrote:
>
>> 2012/2/24 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
>>>
>>>
>>> As
>>>
>>> getS3method('print', 'object_size')
>>>
>>> would have confirmed the expectations of a 'one' with a less sketchy
>>> understanding of R.
>>>
>> Yes, getS3method() sends you -not very surprisingly- to the one from
>> gdata. I realized, as print(object.size(iris)) gets that one as well,
>> and even in my sketchy understanding of R I suspect that both actions
>> have a similar underlying mechanism. But that's not my point.
>>
>> Why would I have to expect the gdata version is still used (under the
>> correct assumption that I haven't been writing on the R source code
>> myself)? As a maybe-not-so-smart basic user of R, I would expect that
>> detach() and eventually unloadNamespace() would revert the effect of
>> library() (and loadNamespace() ). Apparently they don't.
>>
>> The only way to reverse the action of require(gdata) seems to be to
>> restart R. That's at least what my limited brain could understand from
>> the valuable information given by both you and Martin. Seemingly
>> having to restart an application to undo an action, even in the
>> presence of functions with names that make you believe they revert a
>> former action, might in general be conceived as rather unexpected by
>> somebody with the same sketchy understanding of R as me. I would be
>> delighted if you could explain to me which part of R I understand
>> wrongly to come to this silly observation.
>
>
>>
>> Sincerely,
>> Joris
>>
>>
>>
>> --
>> Joris Meys
>> Statistical consultant
>>
>> Ghent University
>> Faculty of Bioscience Engineering
>> Department of Mathematical Modelling, Statistics and Bio-Informatics
>>
>> tel : +32 9 264 59 87
>> Joris.Meys at Ugent.be
>> -------------------------------
>> Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php
>>
>
> --
> Brian D. Ripley, ? ? ? ? ? ? ? ? ?ripley at stats.ox.ac.uk
> Professor of Applied Statistics, ?http://www.stats.ox.ac.uk/~ripley/
> University of Oxford, ? ? ? ? ? ? Tel: ?+44 1865 272861 (self)
> 1 South Parks Road, ? ? ? ? ? ? ? ? ? ? +44 1865 272866 (PA)
> Oxford OX1 3TG, UK ? ? ? ? ? ? ? ?Fax: ?+44 1865 272595



-- 
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Mathematical Modelling, Statistics and Bio-Informatics

tel : +32 9 264 59 87
Joris.Meys at Ugent.be
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php


From ligges at statistik.tu-dortmund.de  Fri Feb 24 17:08:59 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 24 Feb 2012 17:08:59 +0100
Subject: [Rd] function remains loaded in the search space after
 detaching the package
In-Reply-To: <CAO1zAVYVDahW4G-gU0o4ZXrgb-_RZ7OGu7M2-ivXuGCMFEQqDA@mail.gmail.com>
References: <CAO1zAVbj-3ZS6zjPM9iR2+v_jZpccQNLqLsd4pm-jc7Yu6Jh2A@mail.gmail.com>
	<20295.29295.713484.449385@stat.math.ethz.ch>
	<4F477DAD.2050201@stats.ox.ac.uk>
	<CAO1zAVboAimGfvdT0whSd_eDYFpn7RdQK7K2msw9Q+-ycS58jg@mail.gmail.com>
	<alpine.LFD.2.02.1202241248160.8848@toucan.stats.ox.ac.uk>
	<CAO1zAVYjhO7rn0HUukfBkvXdgLP_d+kLRMa09VAhsW7HLyhiwg@mail.gmail.com>
	<alpine.LFD.2.02.1202241537320.14608@toucan.stats.ox.ac.uk>
	<CAO1zAVYVDahW4G-gU0o4ZXrgb-_RZ7OGu7M2-ivXuGCMFEQqDA@mail.gmail.com>
Message-ID: <4F47B61B.5090905@statistik.tu-dortmund.de>



On 24.02.2012 16:55, Joris Meys wrote:
> Maybe I should rephrase:
>
> As mentioned by Martin, by you and by TFM (which I read),
> unloadNamespaces does not remove registered S3 methods. I got the
> message before. As to why it has to be this way, the people that WTFM
> didn't really add much information to TFM for those who RTFM (nor do
> they have to). I merely wondered why it had to be that way out of
> interest, but maybe formulated my question in a less clear and more
> offensive way.
>
> So:
>
> Given the fact that S3 methods are not removed by unloading a namespace:
>
>   - What is the reason for this, as I would naively assume removing
> them when unloading a namespace seems more useful?

Because there are no mechanisms implemented that keep the old 
information, i.e. before things got registered.


>   - How do you remove them without having to restart R?

That is not possible.

Uwe Ligges


> Sincerely,
> Joris
>
> 2012/2/24 Prof Brian Ripley<ripley at stats.ox.ac.uk>:
>> fortunes::fortune('WTFM') applies.  As already pointed out, ?detach says
>>
>>      If a package has a namespace, detaching it does not by default
>>      unload the namespace (and may not even with ?unload=TRUE?), and
>>      detaching will not in general unload any dynamically loaded
>>      compiled code (DLLs).  Further, registered S3 methods from the
>>      namespace will not be removed.  If you use ?library? on a package
>>      whose namespace is loaded, it attaches the exports of the already
>>      loaded namespace.  So detaching and re-attaching a package may not
>>      refresh some or all components of the package, and is inadvisable.
>>
>> And that is explicitly mentioned on ?unloadNamespace ....
>>
>>
>> On Fri, 24 Feb 2012, Joris Meys wrote:
>>
>>> 2012/2/24 Prof Brian Ripley<ripley at stats.ox.ac.uk>:
>>>>
>>>>
>>>> As
>>>>
>>>> getS3method('print', 'object_size')
>>>>
>>>> would have confirmed the expectations of a 'one' with a less sketchy
>>>> understanding of R.
>>>>
>>> Yes, getS3method() sends you -not very surprisingly- to the one from
>>> gdata. I realized, as print(object.size(iris)) gets that one as well,
>>> and even in my sketchy understanding of R I suspect that both actions
>>> have a similar underlying mechanism. But that's not my point.
>>>
>>> Why would I have to expect the gdata version is still used (under the
>>> correct assumption that I haven't been writing on the R source code
>>> myself)? As a maybe-not-so-smart basic user of R, I would expect that
>>> detach() and eventually unloadNamespace() would revert the effect of
>>> library() (and loadNamespace() ). Apparently they don't.
>>>
>>> The only way to reverse the action of require(gdata) seems to be to
>>> restart R. That's at least what my limited brain could understand from
>>> the valuable information given by both you and Martin. Seemingly
>>> having to restart an application to undo an action, even in the
>>> presence of functions with names that make you believe they revert a
>>> former action, might in general be conceived as rather unexpected by
>>> somebody with the same sketchy understanding of R as me. I would be
>>> delighted if you could explain to me which part of R I understand
>>> wrongly to come to this silly observation.
>>
>>
>>>
>>> Sincerely,
>>> Joris
>>>
>>>
>>>
>>> --
>>> Joris Meys
>>> Statistical consultant
>>>
>>> Ghent University
>>> Faculty of Bioscience Engineering
>>> Department of Mathematical Modelling, Statistics and Bio-Informatics
>>>
>>> tel : +32 9 264 59 87
>>> Joris.Meys at Ugent.be
>>> -------------------------------
>>> Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php
>>>
>>
>> --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
>
>


From surajg at gmail.com  Fri Feb 24 18:02:40 2012
From: surajg at gmail.com (Suraj Gupta)
Date: Fri, 24 Feb 2012 12:02:40 -0500
Subject: [Rd] Silently loading and Depends: versus NAMESPACE imports
In-Reply-To: <20295.37272.595195.206946@max.nulle.part>
References: <20237.58927.327444.422917@max.nulle.part>
	<4F0F3EC0.5060500@fhcrc.org>
	<20258.47943.798999.741944@max.nulle.part>
	<4F2419AE.5010203@statistik.tu-dortmund.de>
	<20260.7967.353013.815027@max.nulle.part>
	<CAE9ddGDo7rf9rm6tsRdfhx+C=JHiTWwDeyV8z3jUi-bzR8mkgg@mail.gmail.com>
	<4F460E03.1000604@statistik.tu-dortmund.de>
	<CAE9ddGCXf8J55mx=n4JZEyX3CXq0UB4rDzAjwJKCmVbhw-eroQ@mail.gmail.com>
	<20295.37272.595195.206946@max.nulle.part>
Message-ID: <CAE9ddGAsqeoDGvcimckBQWwopRtqUVwE_wPr5Rg86b_f-cok2Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120224/be2ded7c/attachment.pl>

From ligges at statistik.tu-dortmund.de  Fri Feb 24 18:40:18 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 24 Feb 2012 18:40:18 +0100
Subject: [Rd] Silently loading and Depends: versus NAMESPACE imports
In-Reply-To: <CAE9ddGAsqeoDGvcimckBQWwopRtqUVwE_wPr5Rg86b_f-cok2Q@mail.gmail.com>
References: <20237.58927.327444.422917@max.nulle.part>
	<4F0F3EC0.5060500@fhcrc.org>
	<20258.47943.798999.741944@max.nulle.part>
	<4F2419AE.5010203@statistik.tu-dortmund.de>
	<20260.7967.353013.815027@max.nulle.part>
	<CAE9ddGDo7rf9rm6tsRdfhx+C=JHiTWwDeyV8z3jUi-bzR8mkgg@mail.gmail.com>
	<4F460E03.1000604@statistik.tu-dortmund.de>
	<CAE9ddGCXf8J55mx=n4JZEyX3CXq0UB4rDzAjwJKCmVbhw-eroQ@mail.gmail.com>
	<20295.37272.595195.206946@max.nulle.part>
	<CAE9ddGAsqeoDGvcimckBQWwopRtqUVwE_wPr5Rg86b_f-cok2Q@mail.gmail.com>
Message-ID: <4F47CB82.4030904@statistik.tu-dortmund.de>



On 24.02.2012 18:02, Suraj Gupta wrote:
> Sorry, let me provide the details:
> My package has a .onAttach function (not a .onLoad).  The .onAttach
> constructs a startup message and delivers it via packageStartupMessage().
>   I've pasted the code below.  My package has a number of other packages
> in Depends and Imports.  Some of the packages in Imports have startup
> message (not R message, but package specific messages).
>
> For example I have PerformanceAnalytics in Imports and it shows:
> "Econometric tools for performance and risk analysis.
> ..."


And nothing happenms once you start it via

  suppressPackageStartupMessages( library("PerformanceAnalytics"))

right?

Uwe Ligges

>
> googoleVis shows:
> "Please read the Google Visualisation&  Maps API Terms of Use
> before you use the package:
> ..."
>
> my .onAttach is pretty simple:
> .onAttach<- function(...)
> {
>      mylib = dirname( system.file( package = "spear" ) )
>      ver   = packageDescription( "spear" , lib = mylib )$Version
>      builddate = packageDescription( "spear" , lib = mylib )$Date
>      startupMessage = ""
>      startupMessage = paste( startupMessage , "\n\n\n" , sep = "" )
>      startupMessage = paste( startupMessage ,
> "--------------------------------------------------------------------------------------------------------------------\n"
> , sep = "" )
>      startupMessage = paste( startupMessage , "SPEAR\n" , sep = "" )
>      startupMessage = paste( startupMessage , paste( "(Version " , ver , ",
> built: " , builddate , ")\n\n" , sep = "" ) , sep = "" )
>      startupMessage = paste( startupMessage , "MY MESSAGE HERE...left out
> for brevity" , sep = "" )
>      packageStartupMessage( startupMessage )
> }
>
>
>
>
>
>
> On Fri, Feb 24, 2012 at 8:33 AM, Dirk Eddelbuettel<edd at debian.org>  wrote:
>
>>
>> On 24 February 2012 at 00:27, Suraj Gupta wrote:
>> | I don't think that is it.  My startup message is currently in .onAttach
>> and I
>> | still see startup message from packages that I have moved from Imports to
>> | Depends.
>> | Dirk?
>>
>> There are / were are few issues intertwined in my case, and yours may
>> differ:
>>
>>   - are the messages from your code / packages and you startup messages ?
>>
>>   - are they from imported packages ?
>>
>>   - are they from R (reported 'foo being shadowed' or 'generic bar defined')
>>
>> In my case a combination of using .onAttach and .onLoad (instead of just
>> .onLoad) together with import directives in a NAMESPACE file solved the
>> issue, as had been suggested on this list.
>>
>> Dirk
>>
>> --
>> "Outside of a dog, a book is a man's best friend. Inside of a dog, it is
>> too
>> dark to read." -- Groucho Marx
>>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From surajg at gmail.com  Fri Feb 24 18:48:14 2012
From: surajg at gmail.com (Suraj Gupta)
Date: Fri, 24 Feb 2012 12:48:14 -0500
Subject: [Rd] Silently loading and Depends: versus NAMESPACE imports
In-Reply-To: <4F47CB82.4030904@statistik.tu-dortmund.de>
References: <20237.58927.327444.422917@max.nulle.part>
	<4F0F3EC0.5060500@fhcrc.org>
	<20258.47943.798999.741944@max.nulle.part>
	<4F2419AE.5010203@statistik.tu-dortmund.de>
	<20260.7967.353013.815027@max.nulle.part>
	<CAE9ddGDo7rf9rm6tsRdfhx+C=JHiTWwDeyV8z3jUi-bzR8mkgg@mail.gmail.com>
	<4F460E03.1000604@statistik.tu-dortmund.de>
	<CAE9ddGCXf8J55mx=n4JZEyX3CXq0UB4rDzAjwJKCmVbhw-eroQ@mail.gmail.com>
	<20295.37272.595195.206946@max.nulle.part>
	<CAE9ddGAsqeoDGvcimckBQWwopRtqUVwE_wPr5Rg86b_f-cok2Q@mail.gmail.com>
	<4F47CB82.4030904@statistik.tu-dortmund.de>
Message-ID: <CAE9ddGB=bnnPOWgCxFMcirSpwvrkwuGKGx_ybYDXPqge5+FfQQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120224/0a84d69d/attachment.pl>

From surajg at gmail.com  Fri Feb 24 18:48:57 2012
From: surajg at gmail.com (Suraj Gupta)
Date: Fri, 24 Feb 2012 12:48:57 -0500
Subject: [Rd] Silently loading and Depends: versus NAMESPACE imports
In-Reply-To: <CAE9ddGB=bnnPOWgCxFMcirSpwvrkwuGKGx_ybYDXPqge5+FfQQ@mail.gmail.com>
References: <20237.58927.327444.422917@max.nulle.part>
	<4F0F3EC0.5060500@fhcrc.org>
	<20258.47943.798999.741944@max.nulle.part>
	<4F2419AE.5010203@statistik.tu-dortmund.de>
	<20260.7967.353013.815027@max.nulle.part>
	<CAE9ddGDo7rf9rm6tsRdfhx+C=JHiTWwDeyV8z3jUi-bzR8mkgg@mail.gmail.com>
	<4F460E03.1000604@statistik.tu-dortmund.de>
	<CAE9ddGCXf8J55mx=n4JZEyX3CXq0UB4rDzAjwJKCmVbhw-eroQ@mail.gmail.com>
	<20295.37272.595195.206946@max.nulle.part>
	<CAE9ddGAsqeoDGvcimckBQWwopRtqUVwE_wPr5Rg86b_f-cok2Q@mail.gmail.com>
	<4F47CB82.4030904@statistik.tu-dortmund.de>
	<CAE9ddGB=bnnPOWgCxFMcirSpwvrkwuGKGx_ybYDXPqge5+FfQQ@mail.gmail.com>
Message-ID: <CAE9ddGA012VuGmVXpS1gLA+-FnTYNsxxeX=cdthbq5wK8y9EAA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120224/34fbdfee/attachment.pl>

From ligges at statistik.tu-dortmund.de  Fri Feb 24 18:49:11 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 24 Feb 2012 18:49:11 +0100
Subject: [Rd] Silently loading and Depends: versus NAMESPACE imports
In-Reply-To: <CAE9ddGB=bnnPOWgCxFMcirSpwvrkwuGKGx_ybYDXPqge5+FfQQ@mail.gmail.com>
References: <20237.58927.327444.422917@max.nulle.part>
	<4F0F3EC0.5060500@fhcrc.org>
	<20258.47943.798999.741944@max.nulle.part>
	<4F2419AE.5010203@statistik.tu-dortmund.de>
	<20260.7967.353013.815027@max.nulle.part>
	<CAE9ddGDo7rf9rm6tsRdfhx+C=JHiTWwDeyV8z3jUi-bzR8mkgg@mail.gmail.com>
	<4F460E03.1000604@statistik.tu-dortmund.de>
	<CAE9ddGCXf8J55mx=n4JZEyX3CXq0UB4rDzAjwJKCmVbhw-eroQ@mail.gmail.com>
	<20295.37272.595195.206946@max.nulle.part>
	<CAE9ddGAsqeoDGvcimckBQWwopRtqUVwE_wPr5Rg86b_f-cok2Q@mail.gmail.com>
	<4F47CB82.4030904@statistik.tu-dortmund.de>
	<CAE9ddGB=bnnPOWgCxFMcirSpwvrkwuGKGx_ybYDXPqge5+FfQQ@mail.gmail.com>
Message-ID: <4F47CD97.30303@statistik.tu-dortmund.de>



On 24.02.2012 18:48, Suraj Gupta wrote:
> Correct, nothing happens in terms of startup messages.  No messages are
> shown.
>
> library( my package ) # Performance Analytics message shown
> search()  # PerformanceAnalytics is not in the search list since its in my
> Imports, not Depends
> suppressPackageStartupMessages**( library("PerformanceAnalytics"**)) # no
> message are shown
> search() # PerformanceAnalytics is now in the seach list beneath R_Global
> as expected


OK, and can you please elaborate what is your problem finally?

Uwe Ligges



>
> 2012/2/24 Uwe Ligges<ligges at statistik.tu-dortmund.de>
>
>>
>>
>> On 24.02.2012 18:02, Suraj Gupta wrote:
>>
>>> Sorry, let me provide the details:
>>> My package has a .onAttach function (not a .onLoad).  The .onAttach
>>> constructs a startup message and delivers it via packageStartupMessage().
>>>   I've pasted the code below.  My package has a number of other packages
>>> in Depends and Imports.  Some of the packages in Imports have startup
>>> message (not R message, but package specific messages).
>>>
>>> For example I have PerformanceAnalytics in Imports and it shows:
>>> "Econometric tools for performance and risk analysis.
>>> ..."
>>>
>>
>>
>> And nothing happenms once you start it via
>>
>>   suppressPackageStartupMessages**( library("PerformanceAnalytics"**))
>>
>> right?
>>
>> Uwe Ligges
>>
>>
>>> googoleVis shows:
>>> "Please read the Google Visualisation&   Maps API Terms of Use
>>>
>>> before you use the package:
>>> ..."
>>>
>>> my .onAttach is pretty simple:
>>> .onAttach<- function(...)
>>> {
>>>      mylib = dirname( system.file( package = "spear" ) )
>>>      ver   = packageDescription( "spear" , lib = mylib )$Version
>>>      builddate = packageDescription( "spear" , lib = mylib )$Date
>>>      startupMessage = ""
>>>      startupMessage = paste( startupMessage , "\n\n\n" , sep = "" )
>>>      startupMessage = paste( startupMessage ,
>>> "-----------------------------**------------------------------**
>>> ------------------------------**---------------------------\n"
>>> , sep = "" )
>>>      startupMessage = paste( startupMessage , "SPEAR\n" , sep = "" )
>>>      startupMessage = paste( startupMessage , paste( "(Version " , ver , ",
>>> built: " , builddate , ")\n\n" , sep = "" ) , sep = "" )
>>>      startupMessage = paste( startupMessage , "MY MESSAGE HERE...left out
>>> for brevity" , sep = "" )
>>>      packageStartupMessage( startupMessage )
>>> }
>>>
>>>
>>>
>>>
>>>
>>>
>>> On Fri, Feb 24, 2012 at 8:33 AM, Dirk Eddelbuettel<edd at debian.org>
>>>   wrote:
>>>
>>>
>>>> On 24 February 2012 at 00:27, Suraj Gupta wrote:
>>>> | I don't think that is it.  My startup message is currently in .onAttach
>>>> and I
>>>> | still see startup message from packages that I have moved from Imports
>>>> to
>>>> | Depends.
>>>> | Dirk?
>>>>
>>>> There are / were are few issues intertwined in my case, and yours may
>>>> differ:
>>>>
>>>>   - are the messages from your code / packages and you startup messages ?
>>>>
>>>>   - are they from imported packages ?
>>>>
>>>>   - are they from R (reported 'foo being shadowed' or 'generic bar
>>>> defined')
>>>>
>>>> In my case a combination of using .onAttach and .onLoad (instead of just
>>>> .onLoad) together with import directives in a NAMESPACE file solved the
>>>> issue, as had been suggested on this list.
>>>>
>>>> Dirk
>>>>
>>>> --
>>>> "Outside of a dog, a book is a man's best friend. Inside of a dog, it is
>>>> too
>>>> dark to read." -- Groucho Marx
>>>>
>>>>
>>>         [[alternative HTML version deleted]]
>>>
>>>
>>> ______________________________**________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/**listinfo/r-devel<https://stat.ethz.ch/mailman/listinfo/r-devel>
>>>
>>
>


From surajg at gmail.com  Fri Feb 24 18:52:10 2012
From: surajg at gmail.com (Suraj Gupta)
Date: Fri, 24 Feb 2012 12:52:10 -0500
Subject: [Rd] Silently loading and Depends: versus NAMESPACE imports
In-Reply-To: <4F47CD97.30303@statistik.tu-dortmund.de>
References: <20237.58927.327444.422917@max.nulle.part>
	<4F0F3EC0.5060500@fhcrc.org>
	<20258.47943.798999.741944@max.nulle.part>
	<4F2419AE.5010203@statistik.tu-dortmund.de>
	<20260.7967.353013.815027@max.nulle.part>
	<CAE9ddGDo7rf9rm6tsRdfhx+C=JHiTWwDeyV8z3jUi-bzR8mkgg@mail.gmail.com>
	<4F460E03.1000604@statistik.tu-dortmund.de>
	<CAE9ddGCXf8J55mx=n4JZEyX3CXq0UB4rDzAjwJKCmVbhw-eroQ@mail.gmail.com>
	<20295.37272.595195.206946@max.nulle.part>
	<CAE9ddGAsqeoDGvcimckBQWwopRtqUVwE_wPr5Rg86b_f-cok2Q@mail.gmail.com>
	<4F47CB82.4030904@statistik.tu-dortmund.de>
	<CAE9ddGB=bnnPOWgCxFMcirSpwvrkwuGKGx_ybYDXPqge5+FfQQ@mail.gmail.com>
	<4F47CD97.30303@statistik.tu-dortmund.de>
Message-ID: <CAE9ddGDmME-c=M7zGwdAAMWjN+vD0gd_+ozjsRnNBCSV2Xr02A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120224/ebaba63c/attachment.pl>

From ligges at statistik.tu-dortmund.de  Fri Feb 24 18:53:50 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 24 Feb 2012 18:53:50 +0100
Subject: [Rd] Silently loading and Depends: versus NAMESPACE imports
In-Reply-To: <CAE9ddGDmME-c=M7zGwdAAMWjN+vD0gd_+ozjsRnNBCSV2Xr02A@mail.gmail.com>
References: <20237.58927.327444.422917@max.nulle.part>
	<4F0F3EC0.5060500@fhcrc.org>
	<20258.47943.798999.741944@max.nulle.part>
	<4F2419AE.5010203@statistik.tu-dortmund.de>
	<20260.7967.353013.815027@max.nulle.part>
	<CAE9ddGDo7rf9rm6tsRdfhx+C=JHiTWwDeyV8z3jUi-bzR8mkgg@mail.gmail.com>
	<4F460E03.1000604@statistik.tu-dortmund.de>
	<CAE9ddGCXf8J55mx=n4JZEyX3CXq0UB4rDzAjwJKCmVbhw-eroQ@mail.gmail.com>
	<20295.37272.595195.206946@max.nulle.part>
	<CAE9ddGAsqeoDGvcimckBQWwopRtqUVwE_wPr5Rg86b_f-cok2Q@mail.gmail.com>
	<4F47CB82.4030904@statistik.tu-dortmund.de>
	<CAE9ddGB=bnnPOWgCxFMcirSpwvrkwuGKGx_ybYDXPqge5+FfQQ@mail.gmail.com>
	<4F47CD97.30303@statistik.tu-dortmund.de>
	<CAE9ddGDmME-c=M7zGwdAAMWjN+vD0gd_+ozjsRnNBCSV2Xr02A@mail.gmail.com>
Message-ID: <4F47CEAE.7040601@statistik.tu-dortmund.de>



On 24.02.2012 18:52, Suraj Gupta wrote:
> My problem is the same problem that Dirk first asked about.  I want to
> reduce the verbose noise.  I want my Imports to not show any startup
> messages when I load my own package.

Are you going to pull me? Use suppressPackageStartupMessages()!

Uwe Ligges





>
> 2012/2/24 Uwe Ligges<ligges at statistik.tu-dortmund.de>
>
>>
>>
>> On 24.02.2012 18:48, Suraj Gupta wrote:
>>
>>> Correct, nothing happens in terms of startup messages.  No messages are
>>> shown.
>>>
>>> library( my package ) # Performance Analytics message shown
>>> search()  # PerformanceAnalytics is not in the search list since its in my
>>> Imports, not Depends
>>> suppressPackageStartupMessages****( library("PerformanceAnalytics"****))
>>> # no
>>>
>>> message are shown
>>> search() # PerformanceAnalytics is now in the seach list beneath R_Global
>>> as expected
>>>
>>
>>
>> OK, and can you please elaborate what is your problem finally?
>>
>> Uwe Ligges
>>
>>
>>
>>
>>> 2012/2/24 Uwe Ligges<ligges at statistik.tu-**dortmund.de<ligges at statistik.tu-dortmund.de>
>>>>
>>>
>>>
>>>>
>>>> On 24.02.2012 18:02, Suraj Gupta wrote:
>>>>
>>>>   Sorry, let me provide the details:
>>>>> My package has a .onAttach function (not a .onLoad).  The .onAttach
>>>>> constructs a startup message and delivers it via
>>>>> packageStartupMessage().
>>>>>   I've pasted the code below.  My package has a number of other packages
>>>>> in Depends and Imports.  Some of the packages in Imports have startup
>>>>> message (not R message, but package specific messages).
>>>>>
>>>>> For example I have PerformanceAnalytics in Imports and it shows:
>>>>> "Econometric tools for performance and risk analysis.
>>>>> ..."
>>>>>
>>>>>
>>>>
>>>> And nothing happenms once you start it via
>>>>
>>>>   suppressPackageStartupMessages****( library("PerformanceAnalytics"**
>>>> **))
>>>>
>>>> right?
>>>>
>>>> Uwe Ligges
>>>>
>>>>
>>>>   googoleVis shows:
>>>>> "Please read the Google Visualisation&    Maps API Terms of Use
>>>>>
>>>>> before you use the package:
>>>>> ..."
>>>>>
>>>>> my .onAttach is pretty simple:
>>>>> .onAttach<- function(...)
>>>>> {
>>>>>      mylib = dirname( system.file( package = "spear" ) )
>>>>>      ver   = packageDescription( "spear" , lib = mylib )$Version
>>>>>      builddate = packageDescription( "spear" , lib = mylib )$Date
>>>>>      startupMessage = ""
>>>>>      startupMessage = paste( startupMessage , "\n\n\n" , sep = "" )
>>>>>      startupMessage = paste( startupMessage ,
>>>>> "-----------------------------****----------------------------**--**
>>>>> ------------------------------****---------------------------\**n"
>>>>>
>>>>> , sep = "" )
>>>>>      startupMessage = paste( startupMessage , "SPEAR\n" , sep = "" )
>>>>>      startupMessage = paste( startupMessage , paste( "(Version " , ver ,
>>>>> ",
>>>>> built: " , builddate , ")\n\n" , sep = "" ) , sep = "" )
>>>>>      startupMessage = paste( startupMessage , "MY MESSAGE HERE...left out
>>>>> for brevity" , sep = "" )
>>>>>      packageStartupMessage( startupMessage )
>>>>> }
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> On Fri, Feb 24, 2012 at 8:33 AM, Dirk Eddelbuettel<edd at debian.org>
>>>>>   wrote:
>>>>>
>>>>>
>>>>>   On 24 February 2012 at 00:27, Suraj Gupta wrote:
>>>>>> | I don't think that is it.  My startup message is currently in
>>>>>> .onAttach
>>>>>> and I
>>>>>> | still see startup message from packages that I have moved from
>>>>>> Imports
>>>>>> to
>>>>>> | Depends.
>>>>>> | Dirk?
>>>>>>
>>>>>> There are / were are few issues intertwined in my case, and yours may
>>>>>> differ:
>>>>>>
>>>>>>   - are the messages from your code / packages and you startup messages
>>>>>> ?
>>>>>>
>>>>>>   - are they from imported packages ?
>>>>>>
>>>>>>   - are they from R (reported 'foo being shadowed' or 'generic bar
>>>>>> defined')
>>>>>>
>>>>>> In my case a combination of using .onAttach and .onLoad (instead of
>>>>>> just
>>>>>> .onLoad) together with import directives in a NAMESPACE file solved the
>>>>>> issue, as had been suggested on this list.
>>>>>>
>>>>>> Dirk
>>>>>>
>>>>>> --
>>>>>> "Outside of a dog, a book is a man's best friend. Inside of a dog, it
>>>>>> is
>>>>>> too
>>>>>> dark to read." -- Groucho Marx
>>>>>>
>>>>>>
>>>>>>          [[alternative HTML version deleted]]
>>>>>
>>>>>
>>>>> ______________________________****________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/****listinfo/r-devel<https://stat.ethz.ch/mailman/**listinfo/r-devel>
>>>>> <https://**stat.ethz.ch/mailman/listinfo/**r-devel<https://stat.ethz.ch/mailman/listinfo/r-devel>
>>>>>>
>>>>>
>>>>>
>>>>
>>>
>


From ligges at statistik.tu-dortmund.de  Fri Feb 24 18:57:44 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 24 Feb 2012 18:57:44 +0100
Subject: [Rd] Silently loading and Depends: versus NAMESPACE imports
In-Reply-To: <4F47CEAE.7040601@statistik.tu-dortmund.de>
References: <20237.58927.327444.422917@max.nulle.part>
	<4F0F3EC0.5060500@fhcrc.org>
	<20258.47943.798999.741944@max.nulle.part>
	<4F2419AE.5010203@statistik.tu-dortmund.de>
	<20260.7967.353013.815027@max.nulle.part>
	<CAE9ddGDo7rf9rm6tsRdfhx+C=JHiTWwDeyV8z3jUi-bzR8mkgg@mail.gmail.com>
	<4F460E03.1000604@statistik.tu-dortmund.de>
	<CAE9ddGCXf8J55mx=n4JZEyX3CXq0UB4rDzAjwJKCmVbhw-eroQ@mail.gmail.com>
	<20295.37272.595195.206946@max.nulle.part>
	<CAE9ddGAsqeoDGvcimckBQWwopRtqUVwE_wPr5Rg86b_f-cok2Q@mail.gmail.com>
	<4F47CB82.4030904@statistik.tu-dortmund.de>
	<CAE9ddGB=bnnPOWgCxFMcirSpwvrkwuGKGx_ybYDXPqge5+FfQQ@mail.gmail.com>
	<4F47CD97.30303@statistik.tu-dortmund.de>
	<CAE9ddGDmME-c=M7zGwdAAMWjN+vD0gd_+ozjsRnNBCSV2Xr02A@mail.gmail.com>
	<4F47CEAE.7040601@statistik.tu-dortmund.de>
Message-ID: <4F47CF98.4030404@statistik.tu-dortmund.de>



On 24.02.2012 18:53, Uwe Ligges wrote:
>
>
> On 24.02.2012 18:52, Suraj Gupta wrote:
>> My problem is the same problem that Dirk first asked about. I want to
>> reduce the verbose noise. I want my Imports to not show any startup
>> messages when I load my own package.
>
> Are you going to pull me? Use suppressPackageStartupMessages()!

... and for other packages such as PerformanceAnalytics: Tell those 
maintainers to move there packageStartupMessage code to .onAttach!

Uwe Ligges


> Uwe Ligges
>
>
>
>
>
>>
>> 2012/2/24 Uwe Ligges<ligges at statistik.tu-dortmund.de>
>>
>>>
>>>
>>> On 24.02.2012 18:48, Suraj Gupta wrote:
>>>
>>>> Correct, nothing happens in terms of startup messages. No messages are
>>>> shown.
>>>>
>>>> library( my package ) # Performance Analytics message shown
>>>> search() # PerformanceAnalytics is not in the search list since its
>>>> in my
>>>> Imports, not Depends
>>>> suppressPackageStartupMessages****(
>>>> library("PerformanceAnalytics"****))
>>>> # no
>>>>
>>>> message are shown
>>>> search() # PerformanceAnalytics is now in the seach list beneath
>>>> R_Global
>>>> as expected
>>>>
>>>
>>>
>>> OK, and can you please elaborate what is your problem finally?
>>>
>>> Uwe Ligges
>>>
>>>
>>>
>>>
>>>> 2012/2/24 Uwe
>>>> Ligges<ligges at statistik.tu-**dortmund.de<ligges at statistik.tu-dortmund.de>
>>>>
>>>>>
>>>>
>>>>
>>>>>
>>>>> On 24.02.2012 18:02, Suraj Gupta wrote:
>>>>>
>>>>> Sorry, let me provide the details:
>>>>>> My package has a .onAttach function (not a .onLoad). The .onAttach
>>>>>> constructs a startup message and delivers it via
>>>>>> packageStartupMessage().
>>>>>> I've pasted the code below. My package has a number of other packages
>>>>>> in Depends and Imports. Some of the packages in Imports have startup
>>>>>> message (not R message, but package specific messages).
>>>>>>
>>>>>> For example I have PerformanceAnalytics in Imports and it shows:
>>>>>> "Econometric tools for performance and risk analysis.
>>>>>> ..."
>>>>>>
>>>>>>
>>>>>
>>>>> And nothing happenms once you start it via
>>>>>
>>>>> suppressPackageStartupMessages****( library("PerformanceAnalytics"**
>>>>> **))
>>>>>
>>>>> right?
>>>>>
>>>>> Uwe Ligges
>>>>>
>>>>>
>>>>> googoleVis shows:
>>>>>> "Please read the Google Visualisation& Maps API Terms of Use
>>>>>>
>>>>>> before you use the package:
>>>>>> ..."
>>>>>>
>>>>>> my .onAttach is pretty simple:
>>>>>> .onAttach<- function(...)
>>>>>> {
>>>>>> mylib = dirname( system.file( package = "spear" ) )
>>>>>> ver = packageDescription( "spear" , lib = mylib )$Version
>>>>>> builddate = packageDescription( "spear" , lib = mylib )$Date
>>>>>> startupMessage = ""
>>>>>> startupMessage = paste( startupMessage , "\n\n\n" , sep = "" )
>>>>>> startupMessage = paste( startupMessage ,
>>>>>> "-----------------------------****----------------------------**--**
>>>>>> ------------------------------****---------------------------\**n"
>>>>>>
>>>>>> , sep = "" )
>>>>>> startupMessage = paste( startupMessage , "SPEAR\n" , sep = "" )
>>>>>> startupMessage = paste( startupMessage , paste( "(Version " , ver ,
>>>>>> ",
>>>>>> built: " , builddate , ")\n\n" , sep = "" ) , sep = "" )
>>>>>> startupMessage = paste( startupMessage , "MY MESSAGE HERE...left out
>>>>>> for brevity" , sep = "" )
>>>>>> packageStartupMessage( startupMessage )
>>>>>> }
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> On Fri, Feb 24, 2012 at 8:33 AM, Dirk Eddelbuettel<edd at debian.org>
>>>>>> wrote:
>>>>>>
>>>>>>
>>>>>> On 24 February 2012 at 00:27, Suraj Gupta wrote:
>>>>>>> | I don't think that is it. My startup message is currently in
>>>>>>> .onAttach
>>>>>>> and I
>>>>>>> | still see startup message from packages that I have moved from
>>>>>>> Imports
>>>>>>> to
>>>>>>> | Depends.
>>>>>>> | Dirk?
>>>>>>>
>>>>>>> There are / were are few issues intertwined in my case, and yours
>>>>>>> may
>>>>>>> differ:
>>>>>>>
>>>>>>> - are the messages from your code / packages and you startup
>>>>>>> messages
>>>>>>> ?
>>>>>>>
>>>>>>> - are they from imported packages ?
>>>>>>>
>>>>>>> - are they from R (reported 'foo being shadowed' or 'generic bar
>>>>>>> defined')
>>>>>>>
>>>>>>> In my case a combination of using .onAttach and .onLoad (instead of
>>>>>>> just
>>>>>>> .onLoad) together with import directives in a NAMESPACE file
>>>>>>> solved the
>>>>>>> issue, as had been suggested on this list.
>>>>>>>
>>>>>>> Dirk
>>>>>>>
>>>>>>> --
>>>>>>> "Outside of a dog, a book is a man's best friend. Inside of a
>>>>>>> dog, it
>>>>>>> is
>>>>>>> too
>>>>>>> dark to read." -- Groucho Marx
>>>>>>>
>>>>>>>
>>>>>>> [[alternative HTML version deleted]]
>>>>>>
>>>>>>
>>>>>> ______________________________****________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/****listinfo/r-devel<https://stat.ethz.ch/mailman/**listinfo/r-devel>
>>>>>>
>>>>>> <https://**stat.ethz.ch/mailman/listinfo/**r-devel<https://stat.ethz.ch/mailman/listinfo/r-devel>
>>>>>>
>>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From surajg at gmail.com  Fri Feb 24 19:00:19 2012
From: surajg at gmail.com (Suraj Gupta)
Date: Fri, 24 Feb 2012 13:00:19 -0500
Subject: [Rd] Silently loading and Depends: versus NAMESPACE imports
In-Reply-To: <4F47CF98.4030404@statistik.tu-dortmund.de>
References: <20237.58927.327444.422917@max.nulle.part>
	<4F0F3EC0.5060500@fhcrc.org>
	<20258.47943.798999.741944@max.nulle.part>
	<4F2419AE.5010203@statistik.tu-dortmund.de>
	<20260.7967.353013.815027@max.nulle.part>
	<CAE9ddGDo7rf9rm6tsRdfhx+C=JHiTWwDeyV8z3jUi-bzR8mkgg@mail.gmail.com>
	<4F460E03.1000604@statistik.tu-dortmund.de>
	<CAE9ddGCXf8J55mx=n4JZEyX3CXq0UB4rDzAjwJKCmVbhw-eroQ@mail.gmail.com>
	<20295.37272.595195.206946@max.nulle.part>
	<CAE9ddGAsqeoDGvcimckBQWwopRtqUVwE_wPr5Rg86b_f-cok2Q@mail.gmail.com>
	<4F47CB82.4030904@statistik.tu-dortmund.de>
	<CAE9ddGB=bnnPOWgCxFMcirSpwvrkwuGKGx_ybYDXPqge5+FfQQ@mail.gmail.com>
	<4F47CD97.30303@statistik.tu-dortmund.de>
	<CAE9ddGDmME-c=M7zGwdAAMWjN+vD0gd_+ozjsRnNBCSV2Xr02A@mail.gmail.com>
	<4F47CEAE.7040601@statistik.tu-dortmund.de>
	<4F47CF98.4030404@statistik.tu-dortmund.de>
Message-ID: <CAE9ddGCE2swTj5NYAFhSx-LPvM-fc1iibLCb1HHPyfiYrjw8wQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120224/82ca7bba/attachment.pl>

From pauljohn32 at gmail.com  Sat Feb 25 19:16:07 2012
From: pauljohn32 at gmail.com (Paul Johnson)
Date: Sat, 25 Feb 2012 12:16:07 -0600
Subject: [Rd] Unexpected behavior in factor level ordering
Message-ID: <CAErODj8A_79ayLAfPhQRSy5L+8p1TR+jLGbqZ3=eD_yLDkAFpQ@mail.gmail.com>

Hello, Everybody:

This may not be a "bug", but for me it is an unexpected outcome. A
factor variable's levels
do not retain their ordering after the levels function is used.  I
supply an example in which
a factor with values "BC" "AD" (in that order) is unintentionally
re-alphabetized by the levels
function.

To me, this is very bad behavior. Would you agree?


# Paul Johnson 2012-02-05

x <- c("AD","BC","AD","BC","AD","BC")
xf <- factor(x, levels=c("BC", "AD"), labels=c("Before Christ","After Christ"))
y <- rnorm(6)

m1 <- lm (y ~ xf )

plot(y ~ xf)

abline (m1)
## Just a little problem the line does not "go through" the box
## plot in the right spot because contrasts(xf) is 0,1 but
## the plot uses xf in 1,2.

xlevels <- levels(xf)
newdf <- data.frame(xf=xlevels)

ypred <- predict(m1, newdata=newdf)

##Watch now: the plot comes out "reversed", AC before BC
plot(ypred ~ newdf$xf)

## Ah. Now I see:

levels(newdf$xf)
## Why doesnt newdf$xf respect the ordering of the levels?




-- 
Paul E. Johnson
Professor, Political Science
1541 Lilac Lane, Room 504
University of Kansas


From ligges at statistik.tu-dortmund.de  Sat Feb 25 19:25:49 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sat, 25 Feb 2012 19:25:49 +0100
Subject: [Rd] Unexpected behavior in factor level ordering
In-Reply-To: <CAErODj8A_79ayLAfPhQRSy5L+8p1TR+jLGbqZ3=eD_yLDkAFpQ@mail.gmail.com>
References: <CAErODj8A_79ayLAfPhQRSy5L+8p1TR+jLGbqZ3=eD_yLDkAFpQ@mail.gmail.com>
Message-ID: <4F4927AD.2090102@statistik.tu-dortmund.de>



On 25.02.2012 19:16, Paul Johnson wrote:
> Hello, Everybody:
>
> This may not be a "bug", but for me it is an unexpected outcome. A
> factor variable's levels
> do not retain their ordering after the levels function is used.  I
> supply an example in which
> a factor with values "BC" "AD" (in that order) is unintentionally
> re-alphabetized by the levels
> function.
>
> To me, this is very bad behavior. Would you agree?
>
>
> # Paul Johnson 2012-02-05
>
> x<- c("AD","BC","AD","BC","AD","BC")
> xf<- factor(x, levels=c("BC", "AD"), labels=c("Before Christ","After Christ"))
> y<- rnorm(6)
>
> m1<- lm (y ~ xf )
>
> plot(y ~ xf)
>
> abline (m1)
> ## Just a little problem the line does not "go through" the box
> ## plot in the right spot because contrasts(xf) is 0,1 but
> ## the plot uses xf in 1,2.
>
> xlevels<- levels(xf)
> newdf<- data.frame(xf=xlevels)
>
> ypred<- predict(m1, newdata=newdf)
>
> ##Watch now: the plot comes out "reversed", AC before BC
> plot(ypred ~ newdf$xf)
>
> ## Ah. Now I see:
>
> levels(newdf$xf)
> ## Why doesnt newdf$xf respect the ordering of the levels?


Because xlevels was a character and you coerced it to a factor by 
calling data.frame(xf=xlevels) on it without telling anything about the 
orderiung, hence it got sorted lexicographically.

Uwe Ligges


>
>
>


From mtmorgan at fhcrc.org  Sun Feb 26 07:39:49 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Sat, 25 Feb 2012 22:39:49 -0800
Subject: [Rd] improved error message when existing implicit S4 generic is
	not imported?
Message-ID: <4F49D3B5.5010507@fhcrc.org>

pkgA's NAMESPACE has

   importFrom(graphics, plot)
   exportClasses("A")
   exportMethods("plot")

R/foo.R has

   setClass("A")
   setMethod("plot", "A", function(x, y, ...) {})

During R CMD INSTALL pkgA_1.0.tar.gz we are told

** preparing package for lazy loading
Creating a generic function for 'plot' from package 'graphics' in 
package 'pkgA'
** help
No man pages found in package  ?pkgA?
*** installing help indices
** building package indices
** testing if installed package can be loaded

* DONE (pkgA)

pkgB has in its DESCRIPTION

   Depends; pkgA

with NAMESPACE

   importFrom(graphics, plot)
   exportClasses("B")
   exportMethods("plot")

R/bar.R has

   setClass("B")
   setMethod("plot", "B", function(x, y, ...) {})

During R CMD INSTALL pkgB_1.0.tar.gz we are told

** preparing package for lazy loading
** help

i.e., no implicit generic created (because graphics::plot already has an 
implicit generic created, when the pkgA dependency was attached?). and also

** testing if installed package can be loaded
Error : Functions for exporting methods must have been made generic, 
explicitly or implicitly; not true when loading 'pkgB' for 'plot'
Error: loading failed
Execution halted
ERROR: loading failed

which doesn't seem accurate, rather "'pkgB' does not import S4 implicit 
generic for 'plot' created by 'pkgA'"

 > sessionInfo()
R Under development (unstable) (2012-02-25 r58492)
Platform: x86_64-unknown-linux-gnu (64-bit)

Martin
-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From mtmorgan at fhcrc.org  Sun Feb 26 18:19:38 2012
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Sun, 26 Feb 2012 09:19:38 -0800
Subject: [Rd] Comments on R_exts section 1.6.6,
 Namespaces with S4 classes and methods
Message-ID: <4F4A69AA.9030604@fhcrc.org>

 > R.version.string
[1] "R Under development (unstable) (2012-02-26 r58493)"

In the recent addition "It is important if you export S4 methods that 
the corresponding generics are available: the requirementa on this are 
stricter as from R 2.15.0. You may for example need to import plot from 
graphics to make visible a function to be converted into its implicit 
generic. But it is better practice to make use of the generics exported 
by stats4 as this enables multiple packages to unambiguously set methods 
on those generics."

(note typo on 'requirementa')

I agree that existing generics should be reused.

The advice points to a very unsatisfactory contortion -- use the generic 
from stats4 for a function in graphics!

It is unclear whether the advice is 'use the implicit generic from 
stats4 whenever wanting to define an S4 method on graphics::plot' or 'if 
a package your package depends on creates a generic, use that generic 
instead of creating your own'. The former introduces artificial 
dependencies on stats4, the latter allows for several independently 
defined S4 generics on plot. Neither is satisfactory.

Dozens of Bioconductor packages importFrom(graphics, plot) and 
exportMethods(plot), in addition to other common functions. Our solution 
has been to create a package BiocGenerics whose purpose is to create and 
document otherwise implicit generics of base packages (see ?BiocGenerics 
for a list of generics). Packages then Import: BiocGenerics and 
importFrom(BiocGenerics, plot). This kind of approach, whatever 
limitations of current implementation, seems much better, providing some 
consistency in documentation and application while limiting artificial 
dependencies (to just one, BiocGenerics). Is a methodsGenerics package 
in base R an appropriate direction?


Somewhat earlier in section 1.6.6, the advice offered is "If the generic 
function is not local to this package, either because it was imported as 
a generic function or because the non-generic version has been made 
generic solely to add S4 methods to it (as for functions such as plot in 
the example above), it can be declared via either or both of export or 
exportMethods, but the latter is clearer (and is used in the stats4 
example above)."

I agree that for an explicit generic defined in another package it makes 
sense to exportMethods. When a package creates a generic (as stats4 
does) the better advice is (a) to create an explicit generic via 
setGeneric("plot") (as stats4 does) and (b) to document and export the 
generic, as the generic has consequences above and beyond the method.


Finally, primitive functions are currently singled out for special 
treatment in several sub-clauses of section 1.6.6. Aggregating these 
sub-clauses into a separate paragraph on primitives would be clearer.

Martin
-- 
Computational Biology
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N. PO Box 19024 Seattle, WA 98109

Location: M1-B861
Telephone: 206 667-2793


From ripley at stats.ox.ac.uk  Mon Feb 27 09:22:09 2012
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 27 Feb 2012 08:22:09 +0000
Subject: [Rd] improved error message when existing implicit S4 generic
 is not imported?
In-Reply-To: <4F49D3B5.5010507@fhcrc.org>
References: <4F49D3B5.5010507@fhcrc.org>
Message-ID: <4F4B3D31.50400@stats.ox.ac.uk>

I think the message is accurate [*]: you do however need to have a clear 
understanding of the scoping issues involved, and no message is going to 
give you that.

In short, implicit generics are converted (or not) into explicit 
functions to be dumped during the dump-for-lazy-loading phase of R CMD 
INSTALL: loading the namespace finds whatever function of that name is 
in scope at that time, and once there are multiple functions of the same 
name around, different ones may be in scope at different times.

To take one recent example from CRAN:

> library(VGAM) # fine, as VGAM loads stats4 via Depends:

and in another session

> loadNamespace('VGAM')
Error: Functions for exporting methods must have been made generic, 
explicitly or implicitly; not true when loading ?VGAM? for ?AIC?, ?logLik?

since the visible function AIC() when the namespace alone is loaded is 
the one in stats, not the one in stats4 which was visible when the 
package was dumped for lazy-loading.

I have little idea how one could express all the possibilities for user 
error in an error message like this: as the CRAN maintainers have found, 
some package authors cannot comprehend even several-paragraph 
explanations tailored to their specific errors.  But I might have 
written something like:

The function 'plot' found when exporting methods from the namespace 
'pkgB' is not an S4 generic.

Hopefully such experiences will encourage people to write NAMESPACE 
files more carefully, and also to import generics from e.g. stats4 which 
was long ago provided for that purpose.  (Re another message: stats4 
*is* "methodsGenerics" for base packages.)


[*]  at least now that it tells you which namespace is involved, unlike 
the original version ....



On 26/02/2012 06:39, Martin Morgan wrote:
> pkgA's NAMESPACE has
>
> importFrom(graphics, plot)
> exportClasses("A")
> exportMethods("plot")
>
> R/foo.R has
>
> setClass("A")
> setMethod("plot", "A", function(x, y, ...) {})
>
> During R CMD INSTALL pkgA_1.0.tar.gz we are told
>
> ** preparing package for lazy loading
> Creating a generic function for 'plot' from package 'graphics' in
> package 'pkgA'
> ** help
> No man pages found in package ?pkgA?
> *** installing help indices
> ** building package indices
> ** testing if installed package can be loaded
>
> * DONE (pkgA)
>
> pkgB has in its DESCRIPTION
>
> Depends; pkgA
>
> with NAMESPACE
>
> importFrom(graphics, plot)
> exportClasses("B")
> exportMethods("plot")
>
> R/bar.R has
>
> setClass("B")
> setMethod("plot", "B", function(x, y, ...) {})
>
> During R CMD INSTALL pkgB_1.0.tar.gz we are told
>
> ** preparing package for lazy loading
> ** help
>
> i.e., no implicit generic created (because graphics::plot already has an
> implicit generic created, when the pkgA dependency was attached?). and also
>
> ** testing if installed package can be loaded
> Error : Functions for exporting methods must have been made generic,
> explicitly or implicitly; not true when loading 'pkgB' for 'plot'
> Error: loading failed
> Execution halted
> ERROR: loading failed
>
> which doesn't seem accurate, rather "'pkgB' does not import S4 implicit
> generic for 'plot' created by 'pkgA'"
>
>  > sessionInfo()
> R Under development (unstable) (2012-02-25 r58492)
> Platform: x86_64-unknown-linux-gnu (64-bit)
>
> Martin


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From mdowle at mdowle.plus.com  Mon Feb 27 10:59:43 2012
From: mdowle at mdowle.plus.com (Matthew Dowle)
Date: Mon, 27 Feb 2012 09:59:43 -0000
Subject: [Rd] Identical copy of base function
Message-ID: <144b5f48a1aa59e2bbcd8b96a3990edd.squirrel@webmail.plus.net>


Hello,

Regarding this in R-devel/NEWS/New features :

o  ?library(pkg)? no longer warns about a conflict with a function from
?package:base? if the function is an identical copy of the base one but
with a different environment.

Why would one want an identical copy in a different environment? I'm
thinking I may be missing out on a trick here.

Matthew


From maechler at stat.math.ethz.ch  Mon Feb 27 13:03:31 2012
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 27 Feb 2012 13:03:31 +0100
Subject: [Rd] Identical copy of base function
In-Reply-To: <144b5f48a1aa59e2bbcd8b96a3990edd.squirrel@webmail.plus.net>
References: <144b5f48a1aa59e2bbcd8b96a3990edd.squirrel@webmail.plus.net>
Message-ID: <20299.28947.791010.435828@stat.math.ethz.ch>

>>>>> Matthew Dowle <mdowle at mdowle.plus.com>
>>>>>     on Mon, 27 Feb 2012 09:59:43 +0000 writes:

    > Hello,

    > Regarding this in R-devel/NEWS/New features :

    > o 'library(pkg)' no longer warns about a conflict with a
    > function from 'package:base' if the function is an
    > identical copy of the base one but with a different
    > environment.

    > Why would one want an identical copy in a different
    > environment? I'm thinking I may be missing out on a trick
    > here.

Yes, you are ;-)   The trick is called ``namespace'' :

One example which lead me to implement the above:

The Matrix package has had an identical copy of 'det' for a
while now, but of course  in the Matrix namespace.
Because of that, the call to determinant() inside det() will
correctly dispatch Matrix methods for determinant(), whereas
base::det() would not. 

Martin


From bbolker at gmail.com  Mon Feb 27 14:10:43 2012
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 27 Feb 2012 13:10:43 +0000
Subject: [Rd] prior.weights and weights()
References: <4F441343.2010702@gmail.com>
Message-ID: <loom.20120227T140634-60@post.gmane.org>

Ben Bolker <bbolker <at> gmail.com> writes:

  Bump?  (Quoting with "> " removed to make Gmane happy)

  I've since realized that it will be harder to use the
built-in $simulate methods in my application than I thought,
but I'm still curious about this issue (and might still be
able to use them with a slight hack-around if simulate()
methods internally used predict(object,type="response",...))
but I'm still curious about this issue.

  And I still think I have shown below that $simulate() doesn't work
properly with na.action=na.exclude ...

  Ben Bolker

=======================
I'm wondering whether anyone has any insight into why the 'simulate'
methods for the built-in glm() families (binomial, Poisson, Gamma ...)
extract the prior weights using object$prior.weights rather than
weights(object,"prior") ?

  At first I thought this was so that things work correctly when e.g.
subset= and na.action=na.exclude are used. However, the current versions
of the functions don't seem to work particularly well when these options
are used.  A Poisson example, along with a modified function that is
na.exclude-safe, is shown below ...

  My reason for wanting this is that I'm working on a package that uses
glm-like objects that don't have list-like structure, so can't contain
$prior.weights elements.  If weights were accessed using accessors, then
we could use the existing simulate() functions ...

  If R-core agreed that this is a shortcoming of the current
implementation, all of the simulate() methods would need to be rewritten
to account for this (as far as I can see there are four, for
binomial/Poisson/Gamma/inverse Gaussian -- the base method in
simulate.lm works OK (although it generates unnecessary random deviates
corresponding to the NA values in the fitted output).

  Actually, an even better design (in my opinion) might be to use
predict(object,type="response",...) internally rather than fitted() --
this would, for free, allow the use case

simulate(object,newdata=...)

  which would simulate values from the model for a novel set of
predictor variables ... (coincidentally, this would also allow our
package to use the existing framework more easily).

  Are there any circumstances under which
predict(object,type="response") is/could be *different* from
fitted(object) for a 'glm' object ... ?

  cheers
    Ben Bolker

===========================
d <- data.frame(y=rpois(10,1),x=rep(c(1,NA),5),f=rep(1:2,each=5))
## subset AND NA omission
g <- glm(y~x,data=d,subset=(f==2),family=poisson)

length(fitted(g)) ## 2
length(weights(g)) ## 2
length(g$prior.weights) ## 2
poisson()$simulate(g,1)  ## works

## now try na.exclude
g <- glm(y~x,data=d,subset=(f==2),na.action=na.exclude,
         family=poisson)
length(fitted(g)) ## 5
length(weights(g)) ## 5
length(g$prior.weights) ## 2
poisson()$simulate(g,1)  ## fails

## here's a new, 'safe' version of the Poisson simulate function ...
simnew <- function (object, nsim) {
  wts <- weights(object)
  if (any(na.omit(wts) != 1))
    warning("ignoring prior weights")
  ftd <- na.omit(fitted(object))
  napredict(na.action(object),
            rpois(nsim * length(ftd), ftd))
}

simnew(g,1)


From jeffrey.ryan at lemnica.com  Mon Feb 27 14:39:32 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Mon, 27 Feb 2012 07:39:32 -0600
Subject: [Rd] Identical copy of base function
In-Reply-To: <20299.28947.791010.435828@stat.math.ethz.ch>
References: <144b5f48a1aa59e2bbcd8b96a3990edd.squirrel@webmail.plus.net>
	<20299.28947.791010.435828@stat.math.ethz.ch>
Message-ID: <CABDUZc_sm=kRjLpxAA+96pgrLoexKAn72ktZfwMAmXZM2j5HeQ@mail.gmail.com>

Doesn't this also mean that if Matrix is loaded first, det() will be
calling Matrix::determinant, which could be quite surprising change in
behavior from expectation?

This seems rather dangerous and 'untrustworthy' to me - unless I am
missing some other hidden mechanism involved here.

I haven't read the code yet, and I am sure Matrix will "do the right
thing", but I have strong reservations about this behavior when
applied to the general universe of R and CRAN.

Jeff

On Mon, Feb 27, 2012 at 6:03 AM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>>>>>> Matthew Dowle <mdowle at mdowle.plus.com>
>>>>>> ? ? on Mon, 27 Feb 2012 09:59:43 +0000 writes:
>
> ? ?> Hello,
>
> ? ?> Regarding this in R-devel/NEWS/New features :
>
> ? ?> o 'library(pkg)' no longer warns about a conflict with a
> ? ?> function from 'package:base' if the function is an
> ? ?> identical copy of the base one but with a different
> ? ?> environment.
>
> ? ?> Why would one want an identical copy in a different
> ? ?> environment? I'm thinking I may be missing out on a trick
> ? ?> here.
>
> Yes, you are ;-) ? The trick is called ``namespace'' :
>
> One example which lead me to implement the above:
>
> The Matrix package has had an identical copy of 'det' for a
> while now, but of course ?in the Matrix namespace.
> Because of that, the call to determinant() inside det() will
> correctly dispatch Matrix methods for determinant(), whereas
> base::det() would not.
>
> Martin
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From maechler at stat.math.ethz.ch  Mon Feb 27 16:19:05 2012
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 27 Feb 2012 16:19:05 +0100
Subject: [Rd] Identical copy of base function
In-Reply-To: <CABDUZc_sm=kRjLpxAA+96pgrLoexKAn72ktZfwMAmXZM2j5HeQ@mail.gmail.com>
References: <144b5f48a1aa59e2bbcd8b96a3990edd.squirrel@webmail.plus.net>
	<20299.28947.791010.435828@stat.math.ethz.ch>
	<CABDUZc_sm=kRjLpxAA+96pgrLoexKAn72ktZfwMAmXZM2j5HeQ@mail.gmail.com>
Message-ID: <20299.40681.439249.565831@stat.math.ethz.ch>

>>>>> Jeffrey Ryan <jeffrey.ryan at lemnica.com>
>>>>>     on Mon, 27 Feb 2012 07:39:32 -0600 writes:

    > Doesn't this also mean that if Matrix is loaded first,
    > det() will be calling Matrix::determinant, which could be
    > quite surprising change in behavior from expectation?


    > This seems rather dangerous and 'untrustworthy' to me -
    > unless I am missing some other hidden mechanism involved here.

The only change in R-devel is that library() does not warn about
*conflicts* in such a case.
This behavior (and the R code in library()'s checkConflicts())
is completely analogous to  
     importFrom("base", det)
     export(det)
but as you surely know, we can not (yet?) import from base.

So again: No changed behavior of R, just some warnings less in a
case where they are typically inappropriate.

    > I haven't read the code yet, and I am sure Matrix will "do
    > the right thing", but I have strong reservations about
    > this behavior when applied to the general universe of R
    > and CRAN.

    > Jeff

    > On Mon, Feb 27, 2012 at 6:03 AM, Martin Maechler
    > <maechler at stat.math.ethz.ch> wrote:
    >>>>>>> Matthew Dowle <mdowle at mdowle.plus.com> ? ? on Mon,
    >>>>>>> 27 Feb 2012 09:59:43 +0000 writes:
    >> 
    >> ? ?> Hello,
    >> 
    >> ? ?> Regarding this in R-devel/NEWS/New features :
    >> 
    >> ? ?> o 'library(pkg)' no longer warns about a conflict
    >> with a ? ?> function from 'package:base' if the function
    >> is an ? ?> identical copy of the base one but with a
    >> different ? ?> environment.
    >> 
    >> ? ?> Why would one want an identical copy in a different
    >> ? ?> environment? I'm thinking I may be missing out on a
    >> trick ? ?> here.
    >> 
    >> Yes, you are ;-) ? The trick is called ``namespace'' :
    >> 
    >> One example which lead me to implement the above:
    >> 
    >> The Matrix package has had an identical copy of 'det' for
    >> a while now, but of course ?in the Matrix namespace.
    >> Because of that, the call to determinant() inside det()
    >> will correctly dispatch Matrix methods for determinant(),
    >> whereas base::det() would not.
    >> 
    >> Martin
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel



    > -- 
    > Jeffrey Ryan jeffrey.ryan at lemnica.com

    > www.lemnica.com www.esotericR.com

    > R/Finance 2012: Applied Finance with R www.RinFinance.com

    > See you in Chicago!!!!


From jeffrey.ryan at lemnica.com  Mon Feb 27 16:34:39 2012
From: jeffrey.ryan at lemnica.com (Jeffrey Ryan)
Date: Mon, 27 Feb 2012 09:34:39 -0600
Subject: [Rd] Identical copy of base function
In-Reply-To: <20299.40681.439249.565831@stat.math.ethz.ch>
References: <144b5f48a1aa59e2bbcd8b96a3990edd.squirrel@webmail.plus.net>
	<20299.28947.791010.435828@stat.math.ethz.ch>
	<CABDUZc_sm=kRjLpxAA+96pgrLoexKAn72ktZfwMAmXZM2j5HeQ@mail.gmail.com>
	<20299.40681.439249.565831@stat.math.ethz.ch>
Message-ID: <CABDUZc_=jaMEziYiP_wnR08VtVUAV0_Bc63jLTKqbmWYpq-Fuw@mail.gmail.com>

On Mon, Feb 27, 2012 at 9:19 AM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>>>>>> Jeffrey Ryan <jeffrey.ryan at lemnica.com>
>>>>>> ? ? on Mon, 27 Feb 2012 07:39:32 -0600 writes:
>
> ? ?> Doesn't this also mean that if Matrix is loaded first,
> ? ?> det() will be calling Matrix::determinant, which could be
> ? ?> quite surprising change in behavior from expectation?
>
>
> ? ?> This seems rather dangerous and 'untrustworthy' to me -
> ? ?> unless I am missing some other hidden mechanism involved here.
>
> The only change in R-devel is that library() does not warn about
> *conflicts* in such a case.

Yes, I understand that is only the warning here - but what, aside from
hiding a conflict (which the user may *indeed* care about), does this
accomplish?

To me, a conflict is something to be aware of - hiding it is where I
become concerned.

Without warning, one R script may run differently now depending on
packages loaded, and not just package functions explicitly called by
the script.  Without the warning I can envision countless hours
attempting to debug errors - if one is lucky enough to note the change
in behavior.

Behavioral changes can also related to performance.  I had seen this
previously with some cbind behavior when the S4 variant from
package:methods overwrote the (much faster) base::cbind by a package
which I will not name (and has since been fixed).

Jeff

> This behavior (and the R code in library()'s checkConflicts())
> is completely analogous to
> ? ? importFrom("base", det)
> ? ? export(det)
> but as you surely know, we can not (yet?) import from base.
>
> So again: No changed behavior of R, just some warnings less in a
> case where they are typically inappropriate.
>
> ? ?> I haven't read the code yet, and I am sure Matrix will "do
> ? ?> the right thing", but I have strong reservations about
> ? ?> this behavior when applied to the general universe of R
> ? ?> and CRAN.
>
> ? ?> Jeff
>
> ? ?> On Mon, Feb 27, 2012 at 6:03 AM, Martin Maechler
> ? ?> <maechler at stat.math.ethz.ch> wrote:
> ? ?>>>>>>> Matthew Dowle <mdowle at mdowle.plus.com> ? ? on Mon,
> ? ?>>>>>>> 27 Feb 2012 09:59:43 +0000 writes:
> ? ?>>
> ? ?>> ? ?> Hello,
> ? ?>>
> ? ?>> ? ?> Regarding this in R-devel/NEWS/New features :
> ? ?>>
> ? ?>> ? ?> o 'library(pkg)' no longer warns about a conflict
> ? ?>> with a ? ?> function from 'package:base' if the function
> ? ?>> is an ? ?> identical copy of the base one but with a
> ? ?>> different ? ?> environment.
> ? ?>>
> ? ?>> ? ?> Why would one want an identical copy in a different
> ? ?>> ? ?> environment? I'm thinking I may be missing out on a
> ? ?>> trick ? ?> here.
> ? ?>>
> ? ?>> Yes, you are ;-) ? The trick is called ``namespace'' :
> ? ?>>
> ? ?>> One example which lead me to implement the above:
> ? ?>>
> ? ?>> The Matrix package has had an identical copy of 'det' for
> ? ?>> a while now, but of course ?in the Matrix namespace.
> ? ?>> Because of that, the call to determinant() inside det()
> ? ?>> will correctly dispatch Matrix methods for determinant(),
> ? ?>> whereas base::det() would not.
> ? ?>>
> ? ?>> Martin
> ? ?>>
> ? ?>> ______________________________________________
> ? ?>> R-devel at r-project.org mailing list
> ? ?>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>
> ? ?> --
> ? ?> Jeffrey Ryan jeffrey.ryan at lemnica.com
>
> ? ?> www.lemnica.com www.esotericR.com
>
> ? ?> R/Finance 2012: Applied Finance with R www.RinFinance.com
>
> ? ?> See you in Chicago!!!!
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com
www.esotericR.com

R/Finance 2012: Applied Finance with R
www.RinFinance.com

See you in Chicago!!!!


From patrick.aboyoun at oracle.com  Mon Feb 27 17:41:50 2012
From: patrick.aboyoun at oracle.com (Patrick Aboyoun)
Date: Mon, 27 Feb 2012 08:41:50 -0800
Subject: [Rd] Conflict from saved implicit generics in methods package for
 rcond, norm, backsolve
Message-ID: <4F4BB24E.8090401@oracle.com>

This issue ties loosely into other recent S4 topics on this board.

The methods package defines a number of implicit generics for linear 
algebra related functions (rcond, norm, backsolve) that, when used, 
interfere with base package operations. Here is the cut-and-paste 
version of the code the illustrates the problem:

# rcond
x1 <- cbind(1, 1:10)
rcond(x1)
setGeneric("rcond")
rcond(x1)

# norm
example(norm)
setGeneric("norm")
example(norm)

# backsolve
example(backsolve)
setGeneric("backsolve")
example(backsolve)


Here is an example run:

R> # rcond
R> x1 <- cbind(1, 1:10)
R> rcond(x1)
[1] 0.05278005
R> setGeneric("rcond")
Creating a generic function for 'rcond' from 'base' in the global 
environment
     (from the saved implicit definition)
[1] "rcond"
R> rcond(x1)
Error in match.arg(norm) : argument "norm" is missing, with no default
R>
R> # norm
R> example(norm)

normR> (x1 <- cbind(1,1:10))
       [,1] [,2]
  [1,]    1    1
  [2,]    1    2
  [3,]    1    3
  [4,]    1    4
  [5,]    1    5
  [6,]    1    6
  [7,]    1    7
  [8,]    1    8
  [9,]    1    9
[10,]    1   10

normR> norm(x1)
[1] 55

normR> norm(x1, "I")
[1] 11

normR> norm(x1, "M")
[1] 10

normR> stopifnot(all.equal(norm(x1, "F"),
norm+                     sqrt(sum(x1^2))))

normR> hilbert <- function(n) { i <- 1:n; 1 / outer(i - 1, i, "+") }

normR> h9 <- hilbert(9)

normR> ## all 4 types of norm:
normR> (nTyp <- eval(formals(base::norm)$type))
[1] "O" "I" "F" "M"

normR> sapply(nTyp, norm, x=h9)
        O        I        F        M
2.828968 2.828968 1.755872 1.000000
R> setGeneric("norm")
[1] "norm"
R> example(norm)

normR> (x1 <- cbind(1,1:10))
       [,1] [,2]
  [1,]    1    1
  [2,]    1    2
  [3,]    1    3
  [4,]    1    4
  [5,]    1    5
  [6,]    1    6
  [7,]    1    7
  [8,]    1    8
  [9,]    1    9
[10,]    1   10

normR> norm(x1)
Error in base::norm(x, type, ...) :
   argument "type" is missing, with no default
R>
R> # backsolve
R> example(backsolve)

bckslvR> ## upper triangular matrix 'r':
bckslvR> r <- rbind(c(1,2,3),
bckslv+            c(0,1,1),
bckslv+            c(0,0,2))

bckslvR> ( y <- backsolve(r, x <- c(8,4,2)) ) # -1 3 1
[1] -1  3  1

bckslvR> r %*% y # == x = (8,4,2)
      [,1]
[1,]    8
[2,]    4
[3,]    2

bckslvR> backsolve(r, x, transpose = TRUE) # 8 -12 -5
[1]   8 -12  -5
R> setGeneric("backsolve")
[1] "backsolve"
R> example(backsolve)

bckslvR> ## upper triangular matrix 'r':
bckslvR> r <- rbind(c(1,2,3),
bckslv+            c(0,1,1),
bckslv+            c(0,0,2))

bckslvR> ( y <- backsolve(r, x <- c(8,4,2)) ) # -1 3 1
Error in base::backsolve(r, x, k = k, upper.tri = upper.tri, transpose = 
transpose,  :
   argument "k" is missing, with no default
R> sessionInfo()
R Under development (unstable) (2012-02-25 r58492)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] tools_2.15.0


The controversial bit is how to address the issue:
a) patch them in the methods package
b) patch them and move them along with related implicit generics such as 
chol2inv from the methods package to the Matrix package
c) remove them along with similar implicit generics from the methods package


Patrick


From b.rowlingson at lancaster.ac.uk  Mon Feb 27 19:07:59 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 27 Feb 2012 18:07:59 +0000
Subject: [Rd] Jazzing up the Task Views index page
In-Reply-To: <CANz9Z_KhdzimcFc9DO38DY0S1D3Zrf5mjM31kX3ukZ2OzfSjDA@mail.gmail.com>
References: <CANVKczPAoruV7iC4PHLc9PtyZmBYustZf1v4v_U-KhTtaq8yyQ@mail.gmail.com>
	<CANz9Z_KhdzimcFc9DO38DY0S1D3Zrf5mjM31kX3ukZ2OzfSjDA@mail.gmail.com>
Message-ID: <CANVKczNeuOGiKn8rZLZ8msv_0io21M9bC-FcodRR8bB6Yhd=Ug@mail.gmail.com>

On Wed, Feb 22, 2012 at 3:34 PM, Joshua Wiley <jwiley.psych at gmail.com> wrote:

> Barry, is this a test/example only or would you plan on keeping
> something like that on your site even if it is not adopted for cran
> task views? ?If it is not adopted elsewhere and you are willing to
> maintain it, I would like to link to it.

 It's really only a test, partly for fun, partly to try and kick up
some of the dust on the R web pages.

 There's been a few comments about that, for sure. The main R web
pages are becoming secondary to other community sites for information
on R and packages and so on. I know it is essentially maintained by
the developers primarily for the developers (as is R itself) but at
some point the users will take over - as they are with the community
sites springing up. However, it would be nice if www.r-project.org
took you to a lively, engaging web site with twitter feeds and google
+1 buttons and latest news postings. And didn't use framesets.

 There's also the issue of CRAN and its mirrors. Mirror technology is
so last century - the way to do these things now is via CDNs - content
delivery networks. You do magic redirection via http 302 responses, or
metalinks. It enables better logging, better resilience. All it needs
is a running instance of MirrorBrain. Or just stick .nyud.net on the
end of the URL and have everything magically cached and proxied by the
Coral cache network.

 The inertia to all this is 'well, it works okay at the moment'. But
why is 'okay' okay, when 'better' is better?

 Anyway, how many of you played 'Top Trumps' when you were kids? My
Task Views index reminded me of it, so I just spent an hour grabbing
some stats and formatting them:

http://www.maths.lancs.ac.uk/~rowlings/R/TaskViews/card.html

The inaugural Task Views Top Trumps World Championship will be held in
Nashville in June...

Barry


From engstrom at ebi.ac.uk  Tue Feb 28 11:04:30 2012
From: engstrom at ebi.ac.uk (=?iso-8859-1?Q?P=E4r_Engstr=F6m?=)
Date: Tue, 28 Feb 2012 10:04:30 +0000
Subject: [Rd] Unexpected behaviour for RowSideColors in function heatmap
Message-ID: <2357666E-86E2-4805-AD50-010588BE11B7@ebi.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120228/c1826820/attachment.pl>

From macrakis at alum.mit.edu  Tue Feb 28 20:43:59 2012
From: macrakis at alum.mit.edu (Stavros Macrakis)
Date: Tue, 28 Feb 2012 14:43:59 -0500
Subject: [Rd] Fetching email in R (IMAP)
Message-ID: <CACLVabUQXTE=VFHfPSVoLRyHsaGXKU7BPeYmUyBXXcHLSqor+g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120228/91d00806/attachment.pl>

From hb at biostat.ucsf.edu  Wed Feb 29 03:13:53 2012
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Tue, 28 Feb 2012 18:13:53 -0800
Subject: [Rd] Typo in NEWS: -as-cran should be --as-cran
Message-ID: <CAFDcVCT4Qn=pwhgJCHXg0m3ng9qmp8mJ1z-1JQYxZNQTFUE+0A@mail.gmail.com>

Under 'CHANGES IN R VERSION 2.14.2' in NEWS, there is:

"R CMD check has a new option -as-cran to turn on most of the
customizations that CRAN uses for its incoming checks."

"-as-cran" should be "--as-cran".

/Henrik


From pdalgd at gmail.com  Wed Feb 29 11:21:10 2012
From: pdalgd at gmail.com (peter dalgaard)
Date: Wed, 29 Feb 2012 11:21:10 +0100
Subject: [Rd] Typo in NEWS: -as-cran should be --as-cran
In-Reply-To: <CAFDcVCT4Qn=pwhgJCHXg0m3ng9qmp8mJ1z-1JQYxZNQTFUE+0A@mail.gmail.com>
References: <CAFDcVCT4Qn=pwhgJCHXg0m3ng9qmp8mJ1z-1JQYxZNQTFUE+0A@mail.gmail.com>
Message-ID: <05F8E2DD-B862-459D-BE2E-97D01ABA05A4@gmail.com>


On Feb 29, 2012, at 03:13 , Henrik Bengtsson wrote:

> Under 'CHANGES IN R VERSION 2.14.2' in NEWS, there is:
> 
> "R CMD check has a new option -as-cran to turn on most of the
> customizations that CRAN uses for its incoming checks."
> 
> "-as-cran" should be "--as-cran".

Where do you see that?

The sources have
      
      \item \command{R CMD check} has a new option \option{--as-cran} to
      turn on most of the customizations that CRAN uses for its incoming
      checks.

but there has been issues with LaTeX converting "--" to en-dash. (We saw it with the style files used for The R Journal, but that is hardly the case this time.)

> 
> /Henrik
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard, Professor
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From zzxing at yahoo.com  Wed Feb 29 13:36:50 2012
From: zzxing at yahoo.com (zisheng xing)
Date: Wed, 29 Feb 2012 04:36:50 -0800 (PST)
Subject: [Rd] missing value break my if clause and crash my program
Message-ID: <1330519010.98298.YahooMailClassic@web88609.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20120229/2472a5a0/attachment.pl>

From hb at biostat.ucsf.edu  Wed Feb 29 18:12:18 2012
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Wed, 29 Feb 2012 09:12:18 -0800
Subject: [Rd] Typo in NEWS: -as-cran should be --as-cran
In-Reply-To: <05F8E2DD-B862-459D-BE2E-97D01ABA05A4@gmail.com>
References: <CAFDcVCT4Qn=pwhgJCHXg0m3ng9qmp8mJ1z-1JQYxZNQTFUE+0A@mail.gmail.com>
	<05F8E2DD-B862-459D-BE2E-97D01ABA05A4@gmail.com>
Message-ID: <CAFDcVCQzQknLnAL_B2SARKH8KUBt045t3pwB+H=-ovk_0Fb6cw@mail.gmail.com>

On Wed, Feb 29, 2012 at 2:21 AM, peter dalgaard <pdalgd at gmail.com> wrote:
>
> On Feb 29, 2012, at 03:13 , Henrik Bengtsson wrote:
>
>> Under 'CHANGES IN R VERSION 2.14.2' in NEWS, there is:
>>
>> "R CMD check has a new option -as-cran to turn on most of the
>> customizations that CRAN uses for its incoming checks."
>>
>> "-as-cran" should be "--as-cran".
>
> Where do you see that?

http://cran.r-project.org/bin/windows/base/NEWS.R-2.14.2rc.html
http://cran.r-project.org/bin/windows/base/NEWS.R-devel.html

and with R version 2.14.2 RC (2012-02-26 r58511):

> tail(head(news(), n=7), n=1)
Changes in version 2.14.2:

UTILITIES

    o   R CMD check has a new option -as-cran to turn on most of the
         customizations that CRAN uses for its incoming checks.


BTW, with R Under development (unstable) (2012-02-29 r58531) [on Win7]
news() gives:
> news()
Error: invalid version specification 'CHANGES IN R-devel'


/Henrik

PS. Thxs you all for the new release.

>
> The sources have
>
> ? ? ?\item \command{R CMD check} has a new option \option{--as-cran} to
> ? ? ?turn on most of the customizations that CRAN uses for its incoming
> ? ? ?checks.
>
> but there has been issues with LaTeX converting "--" to en-dash. (We saw it with the style files used for The R Journal, but that is hardly the case this time.)
>
>>
>> /Henrik
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> --
> Peter Dalgaard, Professor
> Center for Statistics, Copenhagen Business School
> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
> Phone: (+45)38153501
> Email: pd.mes at cbs.dk ?Priv: PDalgd at gmail.com
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From spencer.graves at prodsyse.com  Wed Feb 29 18:37:51 2012
From: spencer.graves at prodsyse.com (Spencer Graves)
Date: Wed, 29 Feb 2012 09:37:51 -0800
Subject: [Rd] Replace back slashes with forward slashes?
Message-ID: <4F4E626F.6050805@prodsyse.com>

Hello, All:


       What can people tell me about converting back slashes to forward 
slashes in character strings?


       Several years ago, Prof. Ripley provided a solution, which I lost 
and have not been able to find.


       Below please find a function to do this.  I do not find this very 
satisfactory, however, because it uses "scan" and therefore operates on 
an input not a character string.  Unless someone suggests something 
better, I plan to add this to the "sos" package and issue a new release 
very soon.  (The new release is needed, because the RSiteSearch 
capability has been modified in a way that breaks the current "findFn" 
core of "sos".)


       Thanks,
       Spencer

back2forwardslash <- function (nmax = 1, pattern = "\\", replacement = 
"/") {
     x <- scan(what = character(), quote = pattern, nmax = nmax)
     x. <- gsub(pattern, replacement, x, fixed = TRUE)
     paste(x., collapse = " ")
}

(x <- back2forwardslash())
c:\Users\

# nmax must be one more than the number of embedded blanks
(x3 <- back2forwardslash(3))
c:\u\a b\c d


-- 
Spencer Graves, PE, PhD
President and Chief Technology Officer
Structure Inspection and Monitoring, Inc.
751 Emerson Ct.
San Jos?, CA 95126
ph:  408-655-4567
web:  www.structuremonitoring.com


From simon.urbanek at r-project.org  Wed Feb 29 19:04:12 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 29 Feb 2012 13:04:12 -0500
Subject: [Rd] Replace back slashes with forward slashes?
In-Reply-To: <4F4E626F.6050805@prodsyse.com>
References: <4F4E626F.6050805@prodsyse.com>
Message-ID: <CB641CDA-51A7-4F42-BB36-E074911F2372@r-project.org>


On Feb 29, 2012, at 12:37 PM, Spencer Graves wrote:

> Hello, All:
> 
> 
>      What can people tell me about converting back slashes to forward slashes in character strings?
> 
> 

That's it's trivially done with

gsub("\\", "/", x, fixed=TRUE)

Where x is the character string (and I suppose you are aware of it since you are using it below).

The rest of this e-mail makes absolutely no sense to me -- what exactly are you taking about? What else do you want to achieve?

Cheers,
Simon






>      Several years ago, Prof. Ripley provided a solution, which I lost and have not been able to find.
> 
> 
>      Below please find a function to do this.  I do not find this very satisfactory, however, because it uses "scan" and therefore operates on an input not a character string.  Unless someone suggests something better, I plan to add this to the "sos" package and issue a new release very soon.  (The new release is needed, because the RSiteSearch capability has been modified in a way that breaks the current "findFn" core of "sos".)
> 
> 
>      Thanks,
>      Spencer
> 
> back2forwardslash <- function (nmax = 1, pattern = "\\", replacement = "/") {
>    x <- scan(what = character(), quote = pattern, nmax = nmax)
>    x. <- gsub(pattern, replacement, x, fixed = TRUE)
>    paste(x., collapse = " ")
> }
> 
> (x <- back2forwardslash())
> c:\Users\
> 
> # nmax must be one more than the number of embedded blanks
> (x3 <- back2forwardslash(3))
> c:\u\a b\c d
> 
> 
> -- 
> Spencer Graves, PE, PhD
> President and Chief Technology Officer
> Structure Inspection and Monitoring, Inc.
> 751 Emerson Ct.
> San Jos?, CA 95126
> ph:  408-655-4567
> web:  www.structuremonitoring.com
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From spencer.graves at prodsyse.com  Wed Feb 29 19:19:16 2012
From: spencer.graves at prodsyse.com (Spencer Graves)
Date: Wed, 29 Feb 2012 10:19:16 -0800
Subject: [Rd] Replace back slashes with forward slashes?
In-Reply-To: <CB641CDA-51A7-4F42-BB36-E074911F2372@r-project.org>
References: <4F4E626F.6050805@prodsyse.com>
	<CB641CDA-51A7-4F42-BB36-E074911F2372@r-project.org>
Message-ID: <4F4E6C24.5000901@prodsyse.com>

Hi, Simon:

On 2/29/2012 10:04 AM, Simon Urbanek wrote:
> On Feb 29, 2012, at 12:37 PM, Spencer Graves wrote:
>
>> Hello, All:
>>
>>
>>       What can people tell me about converting back slashes to forward slashes in character strings?
>>
>>
> That's it's trivially done with
>
> gsub("\\", "/", x, fixed=TRUE)
>
> Where x is the character string (and I suppose you are aware of it since you are using it below).

       It does not work for me.  Consider the following:


 > x <- 'c:\Users\'
Error: '\U' used without hex digits in character string starting "c:\U"


       This is one reason I needed to use "scan".  Even if I could get 
past this, consider the following:


 > x <- '\t'
 > gsub('\\', '/', x, fixed=TRUE)
[1] "\t"


       It seems far from trivial, which is why I wrote this function and 
am looking for a better one.


       Thanks for the reply.


       Spencer
>
> The rest of this e-mail makes absolutely no sense to me -- what exactly are you taking about? What else do you want to achieve?
>
> Cheers,
> Simon
>
>
>
>
>
>
>>       Several years ago, Prof. Ripley provided a solution, which I lost and have not been able to find.
>>
>>
>>       Below please find a function to do this.  I do not find this very satisfactory, however, because it uses "scan" and therefore operates on an input not a character string.  Unless someone suggests something better, I plan to add this to the "sos" package and issue a new release very soon.  (The new release is needed, because the RSiteSearch capability has been modified in a way that breaks the current "findFn" core of "sos".)
>>
>>
>>       Thanks,
>>       Spencer
>>
>> back2forwardslash<- function (nmax = 1, pattern = "\\", replacement = "/") {
>>     x<- scan(what = character(), quote = pattern, nmax = nmax)
>>     x.<- gsub(pattern, replacement, x, fixed = TRUE)
>>     paste(x., collapse = " ")
>> }
>>
>> (x<- back2forwardslash())
>> c:\Users\
>>
>> # nmax must be one more than the number of embedded blanks
>> (x3<- back2forwardslash(3))
>> c:\u\a b\c d
>>
>>
>> -- 
>> Spencer Graves, PE, PhD
>> President and Chief Technology Officer
>> Structure Inspection and Monitoring, Inc.
>> 751 Emerson Ct.
>> San Jos?, CA 95126
>> ph:  408-655-4567
>> web:  www.structuremonitoring.com
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
Spencer Graves, PE, PhD
President and Chief Technology Officer
Structure Inspection and Monitoring, Inc.
751 Emerson Ct.
San Jos?, CA 95126
ph:  408-655-4567
web:  www.structuremonitoring.com


From ligges at statistik.tu-dortmund.de  Wed Feb 29 19:24:09 2012
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 29 Feb 2012 19:24:09 +0100
Subject: [Rd] Replace back slashes with forward slashes?
In-Reply-To: <4F4E6C24.5000901@prodsyse.com>
References: <4F4E626F.6050805@prodsyse.com>
	<CB641CDA-51A7-4F42-BB36-E074911F2372@r-project.org>
	<4F4E6C24.5000901@prodsyse.com>
Message-ID: <4F4E6D49.2040106@statistik.tu-dortmund.de>



On 29.02.2012 19:19, Spencer Graves wrote:
> Hi, Simon:
>
> On 2/29/2012 10:04 AM, Simon Urbanek wrote:
>> On Feb 29, 2012, at 12:37 PM, Spencer Graves wrote:
>>
>>> Hello, All:
>>>
>>>
>>> What can people tell me about converting back slashes to forward
>>> slashes in character strings?
>>>
>>>
>> That's it's trivially done with
>>
>> gsub("\\", "/", x, fixed=TRUE)
>>
>> Where x is the character string (and I suppose you are aware of it
>> since you are using it below).
>
> It does not work for me. Consider the following:
>
>
>  > x <- 'c:\Users\'
> Error: '\U' used without hex digits in character string starting "c:\U"


This is something your editor could do much better than R.

Uwe



>
> This is one reason I needed to use "scan". Even if I could get past
> this, consider the following:
>
>
>  > x <- '\t'
>  > gsub('\\', '/', x, fixed=TRUE)
> [1] "\t"
>
>
> It seems far from trivial, which is why I wrote this function and am
> looking for a better one.
>
>
> Thanks for the reply.
>
>
> Spencer
>>
>> The rest of this e-mail makes absolutely no sense to me -- what
>> exactly are you taking about? What else do you want to achieve?
>>
>> Cheers,
>> Simon
>>
>>
>>
>>
>>
>>
>>> Several years ago, Prof. Ripley provided a solution, which I lost and
>>> have not been able to find.
>>>
>>>
>>> Below please find a function to do this. I do not find this very
>>> satisfactory, however, because it uses "scan" and therefore operates
>>> on an input not a character string. Unless someone suggests something
>>> better, I plan to add this to the "sos" package and issue a new
>>> release very soon. (The new release is needed, because the
>>> RSiteSearch capability has been modified in a way that breaks the
>>> current "findFn" core of "sos".)
>>>
>>>
>>> Thanks,
>>> Spencer
>>>
>>> back2forwardslash<- function (nmax = 1, pattern = "\\", replacement =
>>> "/") {
>>> x<- scan(what = character(), quote = pattern, nmax = nmax)
>>> x.<- gsub(pattern, replacement, x, fixed = TRUE)
>>> paste(x., collapse = " ")
>>> }
>>>
>>> (x<- back2forwardslash())
>>> c:\Users\
>>>
>>> # nmax must be one more than the number of embedded blanks
>>> (x3<- back2forwardslash(3))
>>> c:\u\a b\c d
>>>
>>>
>>> --
>>> Spencer Graves, PE, PhD
>>> President and Chief Technology Officer
>>> Structure Inspection and Monitoring, Inc.
>>> 751 Emerson Ct.
>>> San Jos?, CA 95126
>>> ph: 408-655-4567
>>> web: www.structuremonitoring.com
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>


From simon.urbanek at r-project.org  Wed Feb 29 19:24:34 2012
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 29 Feb 2012 13:24:34 -0500
Subject: [Rd] Replace back slashes with forward slashes?
In-Reply-To: <4F4E6C24.5000901@prodsyse.com>
References: <4F4E626F.6050805@prodsyse.com>
	<CB641CDA-51A7-4F42-BB36-E074911F2372@r-project.org>
	<4F4E6C24.5000901@prodsyse.com>
Message-ID: <93BA6F44-4FB9-4B20-8005-63F7030513C6@r-project.org>


On Feb 29, 2012, at 1:19 PM, Spencer Graves wrote:

> Hi, Simon:
> 
> On 2/29/2012 10:04 AM, Simon Urbanek wrote:
>> On Feb 29, 2012, at 12:37 PM, Spencer Graves wrote:
>> 
>>> Hello, All:
>>> 
>>> 
>>>      What can people tell me about converting back slashes to forward slashes in character strings?
>>> 
>>> 
>> That's it's trivially done with
>> 
>> gsub("\\", "/", x, fixed=TRUE)
>> 
>> Where x is the character string (and I suppose you are aware of it since you are using it below).
> 
>      It does not work for me.  Consider the following:
> 
> 
> > x <- 'c:\Users\'
> Error: '\U' used without hex digits in character string starting "c:\U"
> 

But that has nothing to do with strings - it is an user error since you are not creating a valid string in R (not that backslash needs to be escaped in R -- just like in C and many other languages). You probably meant to write

> x <- "c:\\users\\"
> cat(x,"\n")
c:\users\ 
> gsub("\\","/",x,fixed=TRUE)
[1] "c:/users/"

Cheers,
Simon



> 
>      This is one reason I needed to use "scan".  Even if I could get past this, consider the following:
> 
> 
> > x <- '\t'
> > gsub('\\', '/', x, fixed=TRUE)
> [1] "\t"
> 
> 
>      It seems far from trivial, which is why I wrote this function and am looking for a better one.
> 
> 
>      Thanks for the reply.
> 
> 
>      Spencer
>> 
>> The rest of this e-mail makes absolutely no sense to me -- what exactly are you taking about? What else do you want to achieve?
>> 
>> Cheers,
>> Simon
>> 
>> 
>> 
>> 
>> 
>> 
>>>      Several years ago, Prof. Ripley provided a solution, which I lost and have not been able to find.
>>> 
>>> 
>>>      Below please find a function to do this.  I do not find this very satisfactory, however, because it uses "scan" and therefore operates on an input not a character string.  Unless someone suggests something better, I plan to add this to the "sos" package and issue a new release very soon.  (The new release is needed, because the RSiteSearch capability has been modified in a way that breaks the current "findFn" core of "sos".)
>>> 
>>> 
>>>      Thanks,
>>>      Spencer
>>> 
>>> back2forwardslash<- function (nmax = 1, pattern = "\\", replacement = "/") {
>>>    x<- scan(what = character(), quote = pattern, nmax = nmax)
>>>    x.<- gsub(pattern, replacement, x, fixed = TRUE)
>>>    paste(x., collapse = " ")
>>> }
>>> 
>>> (x<- back2forwardslash())
>>> c:\Users\
>>> 
>>> # nmax must be one more than the number of embedded blanks
>>> (x3<- back2forwardslash(3))
>>> c:\u\a b\c d
>>> 
>>> 
>>> -- 
>>> Spencer Graves, PE, PhD
>>> President and Chief Technology Officer
>>> Structure Inspection and Monitoring, Inc.
>>> 751 Emerson Ct.
>>> San Jos?, CA 95126
>>> ph:  408-655-4567
>>> web:  www.structuremonitoring.com
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
> 
> 
> -- 
> Spencer Graves, PE, PhD
> President and Chief Technology Officer
> Structure Inspection and Monitoring, Inc.
> 751 Emerson Ct.
> San Jos?, CA 95126
> ph:  408-655-4567
> web:  www.structuremonitoring.com
> 
> 


From hb at biostat.ucsf.edu  Wed Feb 29 20:11:03 2012
From: hb at biostat.ucsf.edu (Henrik Bengtsson)
Date: Wed, 29 Feb 2012 11:11:03 -0800
Subject: [Rd] Alternative to .Internal(.dfltStop(msg, call))?
Message-ID: <CAFDcVCRLEuJicx2C3u-RMLHCnd368+eg44_YiVZ38cULa4yDoA@mail.gmail.com>

Hi,

I'm looking for a way to generate a "full stop" that will not be
caught by signal handlers, cf. .Internal(.dfltStop(msg, call)).

RATIONALE:
In the R.oo package I have throw() which (leaving out some details)
basically does what stop() does but appends a stack trace string to
the error message that shows up at the R prompt.  Example:

bar <- function() throw("A foo error");
foo <- function() bar();
> foo()
Error: A foo error
at foo()
at bar()

versus

bar <- function() stop("A foo error");
foo <- function() bar();
> stop("A foo error")
Error: A foo error


CURRENT SOLUTION:
throw() does this in a way such that the stack trace is *not* part of
the getMessage() of the 'error' condition object, which is important
when catching the error in signal handlers. Here is a stub what is
done, leaving out the details how to retrieve the stack trace (call
history):

throw <- function(msg, ...) {
  cond <- simpleError(msg);
  signalCondition(cond);

  # A dummy stracktrack / call history
  stackTraceStr <- "at foo()\nat bar()\n";
  call <- NULL; # Also a dummy for this example

   # If the condition is not caught, do a "full stop" showing error
message and stacktrace
  fullmsg <- paste(msg, "\n", stackTraceStr, sep="");
 .Internal(.dfltStop(fullmsg, call));
} # throw()


QUESTION:
Is it possible to achieve this without using an .Internal() call?
Note that stop() will use the same message string for both
signalCondition() and .Internal(.dfltStop(...)), cf.

> base::stop
function (..., call. = TRUE, domain = NULL)
{
...
        message <- conditionMessage(cond)
        call <- conditionCall(cond)
        .Internal(.signalCondition(cond, message, call))
        .Internal(.dfltStop(message, call))
...
}


ALTERNATIVE?:
Is there an alternative way to have the stack trace/traceback() being
automatically displayed after the error message being displayed at the
prompt?


/Henrik


