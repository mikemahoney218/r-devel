From ecjbosu at aol.com  Thu Nov  1 04:04:43 2007
From: ecjbosu at aol.com (Joe W. Byers)
Date: Wed, 31 Oct 2007 22:04:43 -0500
Subject: [Rd] RPM Key in Readme file
Message-ID: <fgbfod$2qs$1@ger.gmane.org>

The readme file on the cran website for linux EL5 contains the following
RPMS for Red Hat Enterprise Linux created by Bob Kinney
<rhel_cran at hmdc.harvard.edu>.  The RPMS are signed with the following
key available from pgp.mit.edu

Type bits /keyID    Date       User ID
pub  1024D/99B62126 2004/11/18 HMDC Linux Support 
<linux_support at latte.harvard.edu>

I went ot pgp.mit.edu and could not find the key.

Any suggestions?

Have a Happy Halloween all.

Joe


From marc_schwartz at comcast.net  Thu Nov  1 04:29:58 2007
From: marc_schwartz at comcast.net (Marc Schwartz)
Date: Wed, 31 Oct 2007 22:29:58 -0500
Subject: [Rd] RPM Key in Readme file
In-Reply-To: <fgbfod$2qs$1@ger.gmane.org>
References: <fgbfod$2qs$1@ger.gmane.org>
Message-ID: <1193887798.29591.4.camel@Bellerophon.localdomain>

On Wed, 2007-10-31 at 22:04 -0500, Joe W. Byers wrote: 
> The readme file on the cran website for linux EL5 contains the following
> RPMS for Red Hat Enterprise Linux created by Bob Kinney
> <rhel_cran at hmdc.harvard.edu>.  The RPMS are signed with the following
> key available from pgp.mit.edu
> 
> Type bits /keyID    Date       User ID
> pub  1024D/99B62126 2004/11/18 HMDC Linux Support 
> <linux_support at latte.harvard.edu>
> 
> I went ot pgp.mit.edu and could not find the key.
> 
> Any suggestions?
> 
> Have a Happy Halloween all.
> 
> Joe

Joe,

How did you search?

Using gpg:

$ gpg --keyserver pgp.mit.edu --search-keys
"linux_support at latte.harvard.edu"
gpg: searching for "linux_support at latte.harvard.edu" from hkp server
pgp.mit.edu
(1)     HMDC Linux Support <linux_support at latte.harvard.edu>
          1024 bit DSA key 99B62126, created: 2004-11-18
Enter number(s), N)ext, or Q)uit > 1
gpg: requesting key 99B62126 from hkp server pgp.mit.edu
gpg: key 99B62126: public key "HMDC Linux Support
<linux_support at latte.harvard.edu>" imported
gpg: Total number processed: 1
gpg:               imported: 1



Using the web site with the e-mail address as the search string:

http://pgp.mit.edu:11371/pks/lookup?search=linux_support%40latte.harvard.edu&op=vindex&fingerprint=on


Public Key Server -- Verbose Index ``linux_support at latte.harvard.edu ''
Type bits /keyID    Date       User ID
pub  1024D/99B62126 2004/11/18 HMDC Linux Support <linux_support at latte.harvard.edu>
     Key fingerprint = 352A C4ED 6B3C C121 53FA  61AE C8E0 D236 99B6 2126
sig        99B62126             HMDC Linux Support <linux_support at latte.harvard.edu>


HTH,

Marc Schwartz


From marc_schwartz at comcast.net  Thu Nov  1 04:27:10 2007
From: marc_schwartz at comcast.net (Marc Schwartz)
Date: Wed, 31 Oct 2007 22:27:10 -0500
Subject: [Rd] RPM Key in Readme file
In-Reply-To: <fgbfod$2qs$1@ger.gmane.org>
References: <fgbfod$2qs$1@ger.gmane.org>
Message-ID: <1193887630.29364.1.camel@Bellerophon.localdomain>

On Wed, 2007-10-31 at 22:04 -0500, Joe W. Byers wrote: 
> The readme file on the cran website for linux EL5 contains the following
> RPMS for Red Hat Enterprise Linux created by Bob Kinney
> <rhel_cran at hmdc.harvard.edu>.  The RPMS are signed with the following
> key available from pgp.mit.edu
> 
> Type bits /keyID    Date       User ID
> pub  1024D/99B62126 2004/11/18 HMDC Linux Support 
> <linux_support at latte.harvard.edu>
> 
> I went ot pgp.mit.edu and could not find the key.
> 
> Any suggestions?
> 
> Have a Happy Halloween all.
> 
> Joe

Joe,

How did you search?

Using gpg:

$ gpg --keyserver pgp.mit.edu --search-keys "linux_support at latte.harvard.edu"
gpg: searching for "linux_support at latte.harvard.edu" from hkp server pgp.mit.edu
(1)     HMDC Linux Support <linux_support at latte.harvard.edu>
          1024 bit DSA key 99B62126, created: 2004-11-18
Enter number(s), N)ext, or Q)uit > 1
gpg: requesting key 99B62126 from hkp server pgp.mit.edu
gpg: key 99B62126: public key "HMDC Linux Support <linux_support at latte.harvard.edu>" imported
gpg: Total number processed: 1
gpg:               imported: 1


Using the web site, with the e-mail address as the search string:

Public Key Server -- Verbose Index ``linux_support at latte.harvard.edu ''
Type bits /keyID    Date       User ID
pub  1024D/99B62126 2004/11/18 HMDC Linux Support <linux_support at latte.harvard.edu>
     Key fingerprint = 352A C4ED 6B3C C121 53FA  61AE C8E0 D236 99B6 2126
sig        99B62126             HMDC Linux Support <linux_support at latte.harvard.edu>

HTH,

Marc Schwartz


From marc_schwartz at comcast.net  Thu Nov  1 04:49:32 2007
From: marc_schwartz at comcast.net (Marc Schwartz)
Date: Wed, 31 Oct 2007 22:49:32 -0500
Subject: [Rd] RPM Key in Readme file
In-Reply-To: <47294984.1000006@aol.com>
References: <fgbfod$2qs$1@ger.gmane.org>
	<1193887798.29591.4.camel@Bellerophon.localdomain>
	<47294984.1000006@aol.com>
Message-ID: <1193888972.29591.13.camel@Bellerophon.localdomain>

On Wed, 2007-10-31 at 22:35 -0500, Joe W. Byers wrote:
> Marc Schwartz wrote: 
> > On Wed, 2007-10-31 at 22:04 -0500, Joe W. Byers wrote: 
> >   
> > > The readme file on the cran website for linux EL5 contains the following
> > > RPMS for Red Hat Enterprise Linux created by Bob Kinney
> > > <rhel_cran at hmdc.harvard.edu>.  The RPMS are signed with the following
> > > key available from pgp.mit.edu
> > > 
> > > Type bits /keyID    Date       User ID
> > > pub  1024D/99B62126 2004/11/18 HMDC Linux Support 
> > > <linux_support at latte.harvard.edu>
> > > 
> > > I went ot pgp.mit.edu and could not find the key.
> > > 
> > > Any suggestions?
> > > 
> > > Have a Happy Halloween all.
> > > 
> > > Joe
> > >     
> > 
> > Joe,
> > 
> > How did you search?
> > 
> > Using gpg:
> > 
> > $ gpg --keyserver pgp.mit.edu --search-keys
> > "linux_support at latte.harvard.edu"
> > gpg: searching for "linux_support at latte.harvard.edu" from hkp server
> > pgp.mit.edu
> > (1)     HMDC Linux Support <linux_support at latte.harvard.edu>
> >           1024 bit DSA key 99B62126, created: 2004-11-18
> > Enter number(s), N)ext, or Q)uit > 1
> > gpg: requesting key 99B62126 from hkp server pgp.mit.edu
> > gpg: key 99B62126: public key "HMDC Linux Support
> > <linux_support at latte.harvard.edu>" imported
> > gpg: Total number processed: 1
> > gpg:               imported: 1
> > 
> > 
> > 
> > Using the web site with the e-mail address as the search string:
> > 
> > http://pgp.mit.edu:11371/pks/lookup?search=linux_support%40latte.harvard.edu&op=vindex&fingerprint=on
> > 
> > 
> > Public Key Server -- Verbose Index ``linux_support at latte.harvard.edu ''
> > Type bits /keyID    Date       User ID
> > pub  1024D/99B62126 2004/11/18 HMDC Linux Support <linux_support at latte.harvard.edu>
> >      Key fingerprint = 352A C4ED 6B3C C121 53FA  61AE C8E0 D236 99B6 2126
> > sig        99B62126             HMDC Linux Support <linux_support at latte.harvard.edu>
> > 
> > 
> > HTH,
> > 
> > Marc Schwartz
> > 
> > 
> >   
> I just used the search engine with HMDC and 99B.  I also went to the
> full list and looked by date as well as the two searches.  I could
> have just completely missed it.  I think I searched linux as well.
> 
> I did not turn verbose on  though.  
> 
> Sorry about this.
> 
> Joe

You cannot search using just part of the Key ID. Also, if you want to
search on the Key ID, which is of course a hex number, you need to
prefix it with '0x'.  So:

http://pgp.mit.edu:11371/pks/lookup?search=0x99B62126&op=index

Public Key Server -- Index ``0x99B62126 ''
Type bits /keyID    Date       User ID
pub  1024D/99B62126 2004/11/18 HMDC Linux Support <linux_support at latte.harvard.edu>


You can however search using part of the User ID:

http://pgp.mit.edu:11371/pks/lookup?search=HMDC&op=index

Public Key Server -- Index ``HMDC ''
Type bits /keyID    Date       User ID
pub  1024D/99B62126 2004/11/18 HMDC Linux Support <linux_support at latte.harvard.edu>


HTH,

Marc


From tplate at acm.org  Thu Nov  1 17:00:09 2007
From: tplate at acm.org (tplate at acm.org)
Date: Thu,  1 Nov 2007 17:00:09 +0100 (CET)
Subject: [Rd] daylight saving / time zone issues with as.POSIXlt/as.POSIXct
	(PR#10392)
Message-ID: <20071101160009.80FC7282EFF4@mail.pubhealth.ku.dk>

Running under Windows XP 64 bit, as.POSIXlt()/as.POSIXct() seem
to think that US time zones (EST5EDT, MST7MDT) switched from daylight
savings back to standard time on Oct 28, 2007, whereas the switch
is actually on Sun Nov 04, 2007.

Examples:

 > Sys.timezone()
[1] "Mountain Daylight Time"
 > as.POSIXct("2007-10-30 12:38:47")
[1] "2007-10-30 12:38:47 Mountain Daylight Time"
 > # *** Should report 2007-10-30 14:38:47 EDT:
 > as.POSIXlt(as.POSIXct("2007-10-30 12:38:47"), "EST5EDT")
[1] "2007-10-30 13:38:47 EST"
 > Sys.time()
[1] "2007-11-01 09:22:28 Mountain Daylight Time"

 > # Bad behavior is manifested in different ways with TZ="MST7MDT"
 > Sys.setenv(TZ="MST7MDT")
 > # *** Should report "12:38:47 MDT"
 > as.POSIXct("2007-10-30 12:38:47")
[1] "2007-10-30 12:38:47 MST"
 > as.POSIXlt(as.POSIXct("2007-10-30 12:38:47"), "EST5EDT")
[1] "2007-10-30 14:38:47 EST"
 > # *** Should report "2007-11-01 09:23:09 MDT"
 > Sys.time()
[1] "2007-11-01 08:23:09 MST"
 >
 > sessionInfo()
R version 2.6.0 Patched (2007-10-11 r43143)
i386-pc-mingw32

locale:
LC_COLLATE=English_United States.1252;LC_CTYPE=English_United States.1252;LC_MONETARY=English_United States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base
 >


Furthermore, with the timezone "Mountain Daylight Time"
(which is the default I get when I start R), the switch
appears to be on Nov 5 in 2006, whereas it actually was
on Oct 29 in 2006.

 > # New R session
 > Sys.timezone()
[1] "Mountain Daylight Time"
 > # *** wrong switch in 2006 ***
 > as.POSIXct("2006-10-30 12:38:47")+(-4:7)*(24*3600)
  [1] "2006-10-26 12:38:47 Mountain Daylight Time"
  [2] "2006-10-27 12:38:47 Mountain Daylight Time"
  [3] "2006-10-28 12:38:47 Mountain Daylight Time"
  [4] "2006-10-29 12:38:47 Mountain Daylight Time"
  [5] "2006-10-30 12:38:47 Mountain Daylight Time"
  [6] "2006-10-31 12:38:47 Mountain Daylight Time"
  [7] "2006-11-01 12:38:47 Mountain Daylight Time"
  [8] "2006-11-02 12:38:47 Mountain Daylight Time"
  [9] "2006-11-03 12:38:47 Mountain Daylight Time"
[10] "2006-11-04 12:38:47 Mountain Daylight Time"
[11] "2006-11-05 11:38:47 Mountain Standard Time"
[12] "2006-11-06 11:38:47 Mountain Standard Time"
 > as.POSIXct("2007-10-30 12:38:47")+(-4:7)*(24*3600)
  [1] "2007-10-26 12:38:47 Mountain Daylight Time"
  [2] "2007-10-27 12:38:47 Mountain Daylight Time"
  [3] "2007-10-28 12:38:47 Mountain Daylight Time"
  [4] "2007-10-29 12:38:47 Mountain Daylight Time"
  [5] "2007-10-30 12:38:47 Mountain Daylight Time"
  [6] "2007-10-31 12:38:47 Mountain Daylight Time"
  [7] "2007-11-01 12:38:47 Mountain Daylight Time"
  [8] "2007-11-02 12:38:47 Mountain Daylight Time"
  [9] "2007-11-03 12:38:47 Mountain Daylight Time"
[10] "2007-11-04 11:38:47 Mountain Standard Time"
[11] "2007-11-05 11:38:47 Mountain Standard Time"
[12] "2007-11-06 11:38:47 Mountain Standard Time"
 > Sys.setenv(TZ="MST7MDT")
 > Sys.timezone()
[1] "MST"
 > as.POSIXct("2006-10-30 12:38:47")+(-4:7)*(24*3600)
  [1] "2006-10-26 13:38:47 MDT" "2006-10-27 13:38:47 MDT"
  [3] "2006-10-28 13:38:47 MDT" "2006-10-29 12:38:47 MST"
  [5] "2006-10-30 12:38:47 MST" "2006-10-31 12:38:47 MST"
  [7] "2006-11-01 12:38:47 MST" "2006-11-02 12:38:47 MST"
  [9] "2006-11-03 12:38:47 MST" "2006-11-04 12:38:47 MST"
[11] "2006-11-05 12:38:47 MST" "2006-11-06 12:38:47 MST"
 > # *** wrong switch in 2007 ***
 > as.POSIXct("2007-10-30 12:38:47")+(-4:7)*(24*3600)
  [1] "2007-10-26 13:38:47 MDT" "2007-10-27 13:38:47 MDT"
  [3] "2007-10-28 12:38:47 MST" "2007-10-29 12:38:47 MST"
  [5] "2007-10-30 12:38:47 MST" "2007-10-31 12:38:47 MST"
  [7] "2007-11-01 12:38:47 MST" "2007-11-02 12:38:47 MST"
  [9] "2007-11-03 12:38:47 MST" "2007-11-04 12:38:47 MST"
[11] "2007-11-05 12:38:47 MST" "2007-11-06 12:38:47 MST"
 >

I see this behavior on all the Windows systems I have tried:
Windows XP 64 bit, Windows XP 32 bit Pro, Windows XP home,
Windows 2000, with a variety of R versions.  The systems
have all relevant Windows updates applied (unless some were
inadvertently missed) and the systems otherwise appear to
behave correctly with respect to times and timezones.

I do not see this problem on Ubuntu Linux systems.

-- Tony Plate


From p.dalgaard at biostat.ku.dk  Thu Nov  1 18:23:31 2007
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 01 Nov 2007 18:23:31 +0100
Subject: [Rd] daylight saving / time zone issues with
 as.POSIXlt/as.POSIXct (PR#10392)
In-Reply-To: <20071101160009.80FC7282EFF4@mail.pubhealth.ku.dk>
References: <20071101160009.80FC7282EFF4@mail.pubhealth.ku.dk>
Message-ID: <472A0B93.8070301@biostat.ku.dk>

tplate at acm.org wrote:
> Running under Windows XP 64 bit, as.POSIXlt()/as.POSIXct() seem
> to think that US time zones (EST5EDT, MST7MDT) switched from daylight
> savings back to standard time on Oct 28, 2007, whereas the switch
> is actually on Sun Nov 04, 2007.
>
>   
Not Our Problem. (This sort of thing never is. We are wholly dependent 
on the OS for this information). Check out

http://support.microsoft.com/kb/933360

> Examples:
>
>  > Sys.timezone()
> [1] "Mountain Daylight Time"
>  > as.POSIXct("2007-10-30 12:38:47")
> [1] "2007-10-30 12:38:47 Mountain Daylight Time"
>  > # *** Should report 2007-10-30 14:38:47 EDT:
>  > as.POSIXlt(as.POSIXct("2007-10-30 12:38:47"), "EST5EDT")
> [1] "2007-10-30 13:38:47 EST"
>  > Sys.time()
> [1] "2007-11-01 09:22:28 Mountain Daylight Time"
>
>  > # Bad behavior is manifested in different ways with TZ="MST7MDT"
>  > Sys.setenv(TZ="MST7MDT")
>  > # *** Should report "12:38:47 MDT"
>  > as.POSIXct("2007-10-30 12:38:47")
> [1] "2007-10-30 12:38:47 MST"
>  > as.POSIXlt(as.POSIXct("2007-10-30 12:38:47"), "EST5EDT")
> [1] "2007-10-30 14:38:47 EST"
>  > # *** Should report "2007-11-01 09:23:09 MDT"
>  > Sys.time()
> [1] "2007-11-01 08:23:09 MST"
>  >
>  > sessionInfo()
> R version 2.6.0 Patched (2007-10-11 r43143)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United States.1252;LC_MONETARY=English_United States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>  >
>
>
> Furthermore, with the timezone "Mountain Daylight Time"
> (which is the default I get when I start R), the switch
> appears to be on Nov 5 in 2006, whereas it actually was
> on Oct 29 in 2006.
>
>  > # New R session
>  > Sys.timezone()
> [1] "Mountain Daylight Time"
>  > # *** wrong switch in 2006 ***
>  > as.POSIXct("2006-10-30 12:38:47")+(-4:7)*(24*3600)
>   [1] "2006-10-26 12:38:47 Mountain Daylight Time"
>   [2] "2006-10-27 12:38:47 Mountain Daylight Time"
>   [3] "2006-10-28 12:38:47 Mountain Daylight Time"
>   [4] "2006-10-29 12:38:47 Mountain Daylight Time"
>   [5] "2006-10-30 12:38:47 Mountain Daylight Time"
>   [6] "2006-10-31 12:38:47 Mountain Daylight Time"
>   [7] "2006-11-01 12:38:47 Mountain Daylight Time"
>   [8] "2006-11-02 12:38:47 Mountain Daylight Time"
>   [9] "2006-11-03 12:38:47 Mountain Daylight Time"
> [10] "2006-11-04 12:38:47 Mountain Daylight Time"
> [11] "2006-11-05 11:38:47 Mountain Standard Time"
> [12] "2006-11-06 11:38:47 Mountain Standard Time"
>  > as.POSIXct("2007-10-30 12:38:47")+(-4:7)*(24*3600)
>   [1] "2007-10-26 12:38:47 Mountain Daylight Time"
>   [2] "2007-10-27 12:38:47 Mountain Daylight Time"
>   [3] "2007-10-28 12:38:47 Mountain Daylight Time"
>   [4] "2007-10-29 12:38:47 Mountain Daylight Time"
>   [5] "2007-10-30 12:38:47 Mountain Daylight Time"
>   [6] "2007-10-31 12:38:47 Mountain Daylight Time"
>   [7] "2007-11-01 12:38:47 Mountain Daylight Time"
>   [8] "2007-11-02 12:38:47 Mountain Daylight Time"
>   [9] "2007-11-03 12:38:47 Mountain Daylight Time"
> [10] "2007-11-04 11:38:47 Mountain Standard Time"
> [11] "2007-11-05 11:38:47 Mountain Standard Time"
> [12] "2007-11-06 11:38:47 Mountain Standard Time"
>  > Sys.setenv(TZ="MST7MDT")
>  > Sys.timezone()
> [1] "MST"
>  > as.POSIXct("2006-10-30 12:38:47")+(-4:7)*(24*3600)
>   [1] "2006-10-26 13:38:47 MDT" "2006-10-27 13:38:47 MDT"
>   [3] "2006-10-28 13:38:47 MDT" "2006-10-29 12:38:47 MST"
>   [5] "2006-10-30 12:38:47 MST" "2006-10-31 12:38:47 MST"
>   [7] "2006-11-01 12:38:47 MST" "2006-11-02 12:38:47 MST"
>   [9] "2006-11-03 12:38:47 MST" "2006-11-04 12:38:47 MST"
> [11] "2006-11-05 12:38:47 MST" "2006-11-06 12:38:47 MST"
>  > # *** wrong switch in 2007 ***
>  > as.POSIXct("2007-10-30 12:38:47")+(-4:7)*(24*3600)
>   [1] "2007-10-26 13:38:47 MDT" "2007-10-27 13:38:47 MDT"
>   [3] "2007-10-28 12:38:47 MST" "2007-10-29 12:38:47 MST"
>   [5] "2007-10-30 12:38:47 MST" "2007-10-31 12:38:47 MST"
>   [7] "2007-11-01 12:38:47 MST" "2007-11-02 12:38:47 MST"
>   [9] "2007-11-03 12:38:47 MST" "2007-11-04 12:38:47 MST"
> [11] "2007-11-05 12:38:47 MST" "2007-11-06 12:38:47 MST"
>  >
>
> I see this behavior on all the Windows systems I have tried:
> Windows XP 64 bit, Windows XP 32 bit Pro, Windows XP home,
> Windows 2000, with a variety of R versions.  The systems
> have all relevant Windows updates applied (unless some were
> inadvertently missed) and the systems otherwise appear to
> behave correctly with respect to times and timezones.
>
> I do not see this problem on Ubuntu Linux systems.
>
> -- Tony Plate
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>   


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From p.dalgaard at biostat.ku.dk  Thu Nov  1 18:25:16 2007
From: p.dalgaard at biostat.ku.dk (p.dalgaard at biostat.ku.dk)
Date: Thu,  1 Nov 2007 18:25:16 +0100 (CET)
Subject: [Rd] daylight saving / time zone issues with
	as.POSIXlt/as.POSIXct (PR#10393)
Message-ID: <20071101172516.4319C282EFF1@mail.pubhealth.ku.dk>

tplate at acm.org wrote:
> Running under Windows XP 64 bit, as.POSIXlt()/as.POSIXct() seem
> to think that US time zones (EST5EDT, MST7MDT) switched from daylight
> savings back to standard time on Oct 28, 2007, whereas the switch
> is actually on Sun Nov 04, 2007.
>
>  =20
Not Our Problem. (This sort of thing never is. We are wholly dependent=20
on the OS for this information). Check out

http://support.microsoft.com/kb/933360

> Examples:
>
>  > Sys.timezone()
> [1] "Mountain Daylight Time"
>  > as.POSIXct("2007-10-30 12:38:47")
> [1] "2007-10-30 12:38:47 Mountain Daylight Time"
>  > # *** Should report 2007-10-30 14:38:47 EDT:
>  > as.POSIXlt(as.POSIXct("2007-10-30 12:38:47"), "EST5EDT")
> [1] "2007-10-30 13:38:47 EST"
>  > Sys.time()
> [1] "2007-11-01 09:22:28 Mountain Daylight Time"
>
>  > # Bad behavior is manifested in different ways with TZ=3D"MST7MDT"
>  > Sys.setenv(TZ=3D"MST7MDT")
>  > # *** Should report "12:38:47 MDT"
>  > as.POSIXct("2007-10-30 12:38:47")
> [1] "2007-10-30 12:38:47 MST"
>  > as.POSIXlt(as.POSIXct("2007-10-30 12:38:47"), "EST5EDT")
> [1] "2007-10-30 14:38:47 EST"
>  > # *** Should report "2007-11-01 09:23:09 MDT"
>  > Sys.time()
> [1] "2007-11-01 08:23:09 MST"
>  >
>  > sessionInfo()
> R version 2.6.0 Patched (2007-10-11 r43143)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=3DEnglish_United States.1252;LC_CTYPE=3DEnglish_United State=
s.1252;LC_MONETARY=3DEnglish_United States.1252;LC_NUMERIC=3DC;LC_TIME=3D=
English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>  >
>
>
> Furthermore, with the timezone "Mountain Daylight Time"
> (which is the default I get when I start R), the switch
> appears to be on Nov 5 in 2006, whereas it actually was
> on Oct 29 in 2006.
>
>  > # New R session
>  > Sys.timezone()
> [1] "Mountain Daylight Time"
>  > # *** wrong switch in 2006 ***
>  > as.POSIXct("2006-10-30 12:38:47")+(-4:7)*(24*3600)
>   [1] "2006-10-26 12:38:47 Mountain Daylight Time"
>   [2] "2006-10-27 12:38:47 Mountain Daylight Time"
>   [3] "2006-10-28 12:38:47 Mountain Daylight Time"
>   [4] "2006-10-29 12:38:47 Mountain Daylight Time"
>   [5] "2006-10-30 12:38:47 Mountain Daylight Time"
>   [6] "2006-10-31 12:38:47 Mountain Daylight Time"
>   [7] "2006-11-01 12:38:47 Mountain Daylight Time"
>   [8] "2006-11-02 12:38:47 Mountain Daylight Time"
>   [9] "2006-11-03 12:38:47 Mountain Daylight Time"
> [10] "2006-11-04 12:38:47 Mountain Daylight Time"
> [11] "2006-11-05 11:38:47 Mountain Standard Time"
> [12] "2006-11-06 11:38:47 Mountain Standard Time"
>  > as.POSIXct("2007-10-30 12:38:47")+(-4:7)*(24*3600)
>   [1] "2007-10-26 12:38:47 Mountain Daylight Time"
>   [2] "2007-10-27 12:38:47 Mountain Daylight Time"
>   [3] "2007-10-28 12:38:47 Mountain Daylight Time"
>   [4] "2007-10-29 12:38:47 Mountain Daylight Time"
>   [5] "2007-10-30 12:38:47 Mountain Daylight Time"
>   [6] "2007-10-31 12:38:47 Mountain Daylight Time"
>   [7] "2007-11-01 12:38:47 Mountain Daylight Time"
>   [8] "2007-11-02 12:38:47 Mountain Daylight Time"
>   [9] "2007-11-03 12:38:47 Mountain Daylight Time"
> [10] "2007-11-04 11:38:47 Mountain Standard Time"
> [11] "2007-11-05 11:38:47 Mountain Standard Time"
> [12] "2007-11-06 11:38:47 Mountain Standard Time"
>  > Sys.setenv(TZ=3D"MST7MDT")
>  > Sys.timezone()
> [1] "MST"
>  > as.POSIXct("2006-10-30 12:38:47")+(-4:7)*(24*3600)
>   [1] "2006-10-26 13:38:47 MDT" "2006-10-27 13:38:47 MDT"
>   [3] "2006-10-28 13:38:47 MDT" "2006-10-29 12:38:47 MST"
>   [5] "2006-10-30 12:38:47 MST" "2006-10-31 12:38:47 MST"
>   [7] "2006-11-01 12:38:47 MST" "2006-11-02 12:38:47 MST"
>   [9] "2006-11-03 12:38:47 MST" "2006-11-04 12:38:47 MST"
> [11] "2006-11-05 12:38:47 MST" "2006-11-06 12:38:47 MST"
>  > # *** wrong switch in 2007 ***
>  > as.POSIXct("2007-10-30 12:38:47")+(-4:7)*(24*3600)
>   [1] "2007-10-26 13:38:47 MDT" "2007-10-27 13:38:47 MDT"
>   [3] "2007-10-28 12:38:47 MST" "2007-10-29 12:38:47 MST"
>   [5] "2007-10-30 12:38:47 MST" "2007-10-31 12:38:47 MST"
>   [7] "2007-11-01 12:38:47 MST" "2007-11-02 12:38:47 MST"
>   [9] "2007-11-03 12:38:47 MST" "2007-11-04 12:38:47 MST"
> [11] "2007-11-05 12:38:47 MST" "2007-11-06 12:38:47 MST"
>  >
>
> I see this behavior on all the Windows systems I have tried:
> Windows XP 64 bit, Windows XP 32 bit Pro, Windows XP home,
> Windows 2000, with a variety of R versions.  The systems
> have all relevant Windows updates applied (unless some were
> inadvertently missed) and the systems otherwise appear to
> behave correctly with respect to times and timezones.
>
> I do not see this problem on Ubuntu Linux systems.
>
> -- Tony Plate
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>  =20


--=20
   O__  ---- Peter Dalgaard             =D8ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327=
918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327=
907


From byron.ellis at gmail.com  Thu Nov  1 20:00:27 2007
From: byron.ellis at gmail.com (Byron Ellis)
Date: Thu, 1 Nov 2007 12:00:27 -0700
Subject: [Rd] Curry: proposed new functional programming, er, function.
Message-ID: <7098abec0711011200va3851o811f60bb100616ce@mail.gmail.com>

Hi all (especially R-core) I suppose,

With the introduction of the new functional programming functions into
base I thought I'd ask for a Curry() function. I use a simple one that
looks this:

Curry = function(FUN,...) { .orig = list(...);function(...)
do.call(FUN,c(.orig,list(...))) }

This comes in really handy when using say, heatmap():

heatmap(mydata,hclustfun=Curry(hclust,method="average"))

or other functions where there are ... arguments, but it's not clear
where they should end up.

-- 
Byron Ellis (byron.ellis at gmail.com)
"Oook" -- The Librarian


From ecjbosu at aol.com  Thu Nov  1 04:51:15 2007
From: ecjbosu at aol.com (Joe W. Byers)
Date: Wed, 31 Oct 2007 22:51:15 -0500
Subject: [Rd] RPM Key in Readme file
In-Reply-To: <1193888972.29591.13.camel@Bellerophon.localdomain>
References: <fgbfod$2qs$1@ger.gmane.org>	
	<1193887798.29591.4.camel@Bellerophon.localdomain>	
	<47294984.1000006@aol.com>
	<1193888972.29591.13.camel@Bellerophon.localdomain>
Message-ID: <47294D33.5070808@aol.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20071031/463ea3e4/attachment.pl 

From ripley at stats.ox.ac.uk  Fri Nov  2 05:58:12 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 2 Nov 2007 04:58:12 +0000 (GMT)
Subject: [Rd] daylight saving / time zone issues with
 as.POSIXlt/as.POSIXct (PR#10392)
In-Reply-To: <472A0B93.8070301@biostat.ku.dk>
References: <20071101160009.80FC7282EFF4@mail.pubhealth.ku.dk>
	<472A0B93.8070301@biostat.ku.dk>
Message-ID: <Pine.LNX.4.64.0711011731170.26881@gannet.stats.ox.ac.uk>

On Thu, 1 Nov 2007, Peter Dalgaard wrote:

> tplate at acm.org wrote:
>> Running under Windows XP 64 bit, as.POSIXlt()/as.POSIXct() seem
>> to think that US time zones (EST5EDT, MST7MDT) switched from daylight
>> savings back to standard time on Oct 28, 2007, whereas the switch
>> is actually on Sun Nov 04, 2007.
>>
>>
> Not Our Problem. (This sort of thing never is. We are wholly dependent
> on the OS for this information). Check out
>
> http://support.microsoft.com/kb/933360

I think this may well be a long-standing Windows bug that US users have 
not had to suffer before.  From ?as.POSIXlt

      Where OSes describe their valid timezones can be obscure.  The
      help for 'tzset' (or '_tzset' on Windows) can be helpful, but it
      can also be inaccurate.  There is a cumbersome POSIX specification
      (listed under environment variable 'TZ' at <URL:...>
      which is often at least partially supported, but there may be
      other more user-friendly ways to specify timezones. Windows
      documents a specification of the form 'GST-1GDT', but seems always
      to apply the US rules for changing to/from DST with such a
      specification.

Recent versions of Microsoft documentation acknowledge this, e.g.

http://msdn2.microsoft.com/en-us/library/90s5c885(vs.80).aspx

says

  dzn

     Three-letter daylight-saving-time zone such as PDT. If daylight saving
     time is never in effect in the locality, set TZ without a value for
     dzn.  The C run-time library assumes the United States' rules for
     implementing the calculation of daylight saving time (DST).

Now, AFAIK the 'C run-time library' has not been updated to follow US 
politics.


>> Examples:
>>
>> > Sys.timezone()
>> [1] "Mountain Daylight Time"
>> > as.POSIXct("2007-10-30 12:38:47")
>> [1] "2007-10-30 12:38:47 Mountain Daylight Time"
>> > # *** Should report 2007-10-30 14:38:47 EDT:
>> > as.POSIXlt(as.POSIXct("2007-10-30 12:38:47"), "EST5EDT")
>> [1] "2007-10-30 13:38:47 EST"
>> > Sys.time()
>> [1] "2007-11-01 09:22:28 Mountain Daylight Time"
>>
>> > # Bad behavior is manifested in different ways with TZ="MST7MDT"
>> > Sys.setenv(TZ="MST7MDT")
>> > # *** Should report "12:38:47 MDT"
>> > as.POSIXct("2007-10-30 12:38:47")
>> [1] "2007-10-30 12:38:47 MST"
>> > as.POSIXlt(as.POSIXct("2007-10-30 12:38:47"), "EST5EDT")
>> [1] "2007-10-30 14:38:47 EST"
>> > # *** Should report "2007-11-01 09:23:09 MDT"
>> > Sys.time()
>> [1] "2007-11-01 08:23:09 MST"
>> >
>> > sessionInfo()
>> R version 2.6.0 Patched (2007-10-11 r43143)
>> i386-pc-mingw32
>>
>> locale:
>> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United States.1252;LC_MONETARY=English_United States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> >
>>
>>
>> Furthermore, with the timezone "Mountain Daylight Time"
>> (which is the default I get when I start R), the switch
>> appears to be on Nov 5 in 2006, whereas it actually was
>> on Oct 29 in 2006.
>>
>> > # New R session
>> > Sys.timezone()
>> [1] "Mountain Daylight Time"
>> > # *** wrong switch in 2006 ***
>> > as.POSIXct("2006-10-30 12:38:47")+(-4:7)*(24*3600)
>>   [1] "2006-10-26 12:38:47 Mountain Daylight Time"
>>   [2] "2006-10-27 12:38:47 Mountain Daylight Time"
>>   [3] "2006-10-28 12:38:47 Mountain Daylight Time"
>>   [4] "2006-10-29 12:38:47 Mountain Daylight Time"
>>   [5] "2006-10-30 12:38:47 Mountain Daylight Time"
>>   [6] "2006-10-31 12:38:47 Mountain Daylight Time"
>>   [7] "2006-11-01 12:38:47 Mountain Daylight Time"
>>   [8] "2006-11-02 12:38:47 Mountain Daylight Time"
>>   [9] "2006-11-03 12:38:47 Mountain Daylight Time"
>> [10] "2006-11-04 12:38:47 Mountain Daylight Time"
>> [11] "2006-11-05 11:38:47 Mountain Standard Time"
>> [12] "2006-11-06 11:38:47 Mountain Standard Time"
>> > as.POSIXct("2007-10-30 12:38:47")+(-4:7)*(24*3600)
>>   [1] "2007-10-26 12:38:47 Mountain Daylight Time"
>>   [2] "2007-10-27 12:38:47 Mountain Daylight Time"
>>   [3] "2007-10-28 12:38:47 Mountain Daylight Time"
>>   [4] "2007-10-29 12:38:47 Mountain Daylight Time"
>>   [5] "2007-10-30 12:38:47 Mountain Daylight Time"
>>   [6] "2007-10-31 12:38:47 Mountain Daylight Time"
>>   [7] "2007-11-01 12:38:47 Mountain Daylight Time"
>>   [8] "2007-11-02 12:38:47 Mountain Daylight Time"
>>   [9] "2007-11-03 12:38:47 Mountain Daylight Time"
>> [10] "2007-11-04 11:38:47 Mountain Standard Time"
>> [11] "2007-11-05 11:38:47 Mountain Standard Time"
>> [12] "2007-11-06 11:38:47 Mountain Standard Time"
>> > Sys.setenv(TZ="MST7MDT")
>> > Sys.timezone()
>> [1] "MST"
>> > as.POSIXct("2006-10-30 12:38:47")+(-4:7)*(24*3600)
>>   [1] "2006-10-26 13:38:47 MDT" "2006-10-27 13:38:47 MDT"
>>   [3] "2006-10-28 13:38:47 MDT" "2006-10-29 12:38:47 MST"
>>   [5] "2006-10-30 12:38:47 MST" "2006-10-31 12:38:47 MST"
>>   [7] "2006-11-01 12:38:47 MST" "2006-11-02 12:38:47 MST"
>>   [9] "2006-11-03 12:38:47 MST" "2006-11-04 12:38:47 MST"
>> [11] "2006-11-05 12:38:47 MST" "2006-11-06 12:38:47 MST"
>> > # *** wrong switch in 2007 ***
>> > as.POSIXct("2007-10-30 12:38:47")+(-4:7)*(24*3600)
>>   [1] "2007-10-26 13:38:47 MDT" "2007-10-27 13:38:47 MDT"
>>   [3] "2007-10-28 12:38:47 MST" "2007-10-29 12:38:47 MST"
>>   [5] "2007-10-30 12:38:47 MST" "2007-10-31 12:38:47 MST"
>>   [7] "2007-11-01 12:38:47 MST" "2007-11-02 12:38:47 MST"
>>   [9] "2007-11-03 12:38:47 MST" "2007-11-04 12:38:47 MST"
>> [11] "2007-11-05 12:38:47 MST" "2007-11-06 12:38:47 MST"
>> >
>>
>> I see this behavior on all the Windows systems I have tried:
>> Windows XP 64 bit, Windows XP 32 bit Pro, Windows XP home,
>> Windows 2000, with a variety of R versions.  The systems
>> have all relevant Windows updates applied (unless some were
>> inadvertently missed) and the systems otherwise appear to
>> behave correctly with respect to times and timezones.
>>
>> I do not see this problem on Ubuntu Linux systems.
>>
>> -- Tony Plate
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From r.hankin at noc.soton.ac.uk  Fri Nov  2 15:11:36 2007
From: r.hankin at noc.soton.ac.uk (Robin Hankin)
Date: Fri, 2 Nov 2007 14:11:36 +0000
Subject: [Rd] vignettes and papers
Message-ID: <5A5972FD-DD8A-498D-8849-80D9A41F80F8@noc.soton.ac.uk>

Hello everyone

Lots of my packages have been the subject of
journal articles either in JSS or Rnews or (in one
case) elsewhere.

I would like to add these articles
to my packages as vignettes.

Reproducing the papers exactly requires a number
of files [such as style files or PDFs] to be included in
  the inst/doc directory to pass R CMD check.

A vanilla .Rnw file seems to be a good idea,
but loses some of the nice JSS typesetting.

What is Best Practice here?

And are there ethical or other issues that I should
be aware of  before including copies of Rnews
or JSS papers verbatim in an R package?



--
Robin Hankin
Uncertainty Analyst
National Oceanography Centre, Southampton
European Way, Southampton SO14 3ZH, UK
  tel  023-8059-7743


From oehl_list at gmx.de  Fri Nov  2 15:53:27 2007
From: oehl_list at gmx.de (=?iso-8859-1?Q?=22Jens_Oehlschl=E4gel=22?=)
Date: Fri, 02 Nov 2007 15:53:27 +0100
Subject: [Rd] applying duplicated, unique and match to lists?
Message-ID: <20071102145327.89440@gmx.net>

Dear R developers,

While improving duplicated.array() and friends and developing equivalents for the new ff package for large datasets I came across two questions:

1) is it safe to use duplicated.default(), unique.default() and match() on arbitrary lists? If so, we can speed up duplicated.array and friends considerably by using list() instead of paste(collapse="\r")

2) while duplicated.default() is very fast even on lists, match() is very slow on lists. Why is the internal conversion to character necessary? If the hashtable behind duplicated() in unique.c work for lists, why can't we use them for match()? If conversion to character is unavoidable, a better scaling alternative could be serializing and compressing to md5: even with final identity check agains unlikely collisions this is much faster in many cases (break even seems to be for quite small list elements like 2 doubles).

1) the new versions should also work for lists with a dim attribute (old versions has as.vector() which does not work for lists)
Factor 10 speedup for row duplicates (here atomic matrices)
>   system.time(duplicated(x, hashFUN=function(x)paste(x, collapse="\r")))
   user  system elapsed 
   2.37    0.02    2.45 
>   system.time(duplicated(x, hashFUN=md5))
   user  system elapsed 
   0.51    0.00    0.51 
>   system.time(duplicated(x, hashFUN=list))
   user  system elapsed 
   0.17    0.00    0.17

2) Speedup potential for list matching (md5 results below)
> x <- as.list(runif(100000))
> system.time(duplicated(x))
   user  system elapsed 
   0.01    0.00    0.02 
> system.time(match(x,x))
   user  system elapsed 
   2.01    0.00    2.03

Please find below more comments and tests, new code for duplicated.array() and friends, suggestions for new classes 'hash' (requiring digest) and 'id' (and if you are curious: first code drafts for the respective ff methods).

Best regards



Jens Oehlschl?gel


----


# Hashing of large objects in ff
# (c) 2007 Jens Oehlsch?gel
# Licence: GPL2
# Created: 2007-10-30
# Last changed: 2007-10-30

require(digest) # digest maintainer: Dirk Eddelbuettel <edd at debian.org>

# { --- available hash functions ---

# perfect projection: list
# NOTE that the 'easiest hash function' is 'list'
# it is faster than everything else when calculating duplicated or unique, but it is extremely slow for 'match' (currently, R-2.6.0)
# thus for matching list elements, it is faster converting the list elements with md5

# no projection for vectors only
none <- function(x)x

# concatenation of as.character as currently (R-2.6.1) in duplicated.array, match.array (pairs of projections may erroneously apear as identical when the vectors are very similar, RAM expensive)
pasteid <- function(x)paste(x, collapse="\r")

# perfectly identity preserving projection (but even more RAM expensive)
id1 <- function(x)paste(.Call("R_serialize", x, NULL, FALSE, NULL, PACKAGE = "base")[-(1:14)], collapse="")

# 32 byte projection
md5 <- function(x).Call("digest", .Call("R_serialize", x, NULL, FALSE, NULL, PACKAGE = "base"), 1L, -1L, 14L, PACKAGE = "digest")

# 40 byte projection
sha1 <- function(x).Call("digest", .Call("R_serialize", x, NULL, FALSE, NULL, PACKAGE = "base"), 2L, -1L, 14L, PACKAGE = "digest")

# 8 byte projection: more collisions
crc32 <- function(x).Call("digest", .Call("R_serialize", x, NULL, FALSE, NULL, PACKAGE = "base"), 3L, -1L, 14L, PACKAGE = "digest")


#! \name{md5}
#! \alias{md5}
#! \title{ faster shortcut functions for in-memory digest }
#! \description{
#!   These functions project (serialize or hash) their input object and return a string. Because they avoid any R overhead they are better suitable for sapply() than using the more general function 'digest'
#! }
#! \usage{
#! md5(x)
#! sha1(x)
#! crc32(x)
#! id1(x)
#! }
#! %- maybe also 'usage' for other objects documented here.
#! \arguments{
#!   \item{x}{ a fully serializable R object }
#! }
#! \value{
#!   character scalar
#! }
#! \seealso{ \code{\link{digest}}, \code{\link[base]{serialize}} }
#! \examples{
#!   md5(pi)
#!   sha1(pi)
#!   crc32(pi)
#!   id1(pi)
#!
#!   dontshow{
#!     if (!identical(paste(serialize(list(str="a string", double=pi), connection=NULL)[-(1:14)], collapse=""), id1(list(str="a string", double=pi))))
#!       stop("something has changed in serialization, please fix the internal .Calls in function 'id1', 'md5, 'sha1', 'crc32'")
#!
#!     if (!identical(digest(list(str="a string", double=pi), algo="md5"), md5(list(str="a string", double=pi))))
#!       stop("something has changed in package 'digest' or in serialization, please fix the internal .Calls in function 'md5'")
#!
#!     if (!identical(digest(list(str="a string", double=pi), algo="sha1"), sha1(list(str="a string", double=pi))))
#!       stop("something has changed in package 'digest' or in serialization, please fix the internal .Calls in function 'sha1'")
#!
#!     if (!identical(digest(list(str="a string", double=pi), algo="crc32"), crc32(list(str="a string", double=pi))))
#!       stop("something has changed in package 'digest' or in serialization, please fix the internal .Calls in function 'crc32'")
#!   }
#! }
#! \keyword{misc}

# } --- available hash functions ---



if (FALSE){

  # current (R-2.6.0) versions of duplicated.* and unique.* can fail for very similar rows
  x <- matrix(1, 2, 2)
  x[1,1] <- 1 + 1e-15
  x[2,1] <- 1 + 2e-15
  x[1,1]==x[2,1]
  duplicated(x)
  apply(x, 1, paste, collapse="\r")
  # is using md5 is safer?
  apply(x, 1, md5)

  # atomic data
  n <- 10000
  x <- matrix(runif(n*20),n,20)
  x <- x[rep(1:nrow(x),rep(2,nrow(x))),]

  # using list or md5 is faster than pasteid or digest or even serialize via id1
  system.time(apply(x, 1, pasteid))
  system.time(apply(x, 1, digest))
  system.time(apply(x, 1, id1))
  system.time(apply(x, 1, md5))
  system.time(apply(x, 1, list))

  # using md5 takes less RAM for strings
  object.size(x)
  object.size(apply(x, 1, pasteid))
  object.size(apply(x, 1, md5))
  object.size(apply(x, 1, id1))
  object.size(apply(x, 1, list))

  # atomic matrix performance
  system.time(duplicated(x, hashFUN=pasteid))
  system.time(duplicated(x, hashFUN=id1))
  system.time(duplicated(x, hashFUN=md5))
  system.time(duplicated(x, hashFUN=list))

  # list data
  n <- 1000
  x <- matrix(as.list(runif(n*20)),n,20)
  x <- x[rep(1:nrow(x),rep(2,nrow(x))),]

  # list matrix performance
  system.time(duplicated(x, hashFUN=pasteid))
  system.time(duplicated(x, hashFUN=id1))
  system.time(duplicated(x, hashFUN=md5))
  system.time(duplicated(x, hashFUN=list))


  n <- 100000
  # match works fine for atomic and list character data
  x <- as.character(runif(n))
  system.time(duplicated(x))
  system.time(match(x,x))
  y <- as.list(x)
  system.time(duplicated(y))
  system.time(match(y,y))

  # but is very slow for numeric (double and integer) lists (although duplicated on numeric lists is fast, doesn't use match the same hashtable?)
  x <- runif(n)
  system.time(duplicated(x))
  system.time(match(x,x))
  y <- as.list(x)
  system.time(duplicated(y))
  system.time(match(y,y))
  # try some alternatives
  system.time({z <- sapply(y, id1); zt <- sapply(y, id1); match(z,zt)})
  system.time({z <- sapply(y, md5); zt <- sapply(y, md5); match(z,zt)})
  system.time({z <- sapply(y, md5); zt <- sapply(y, md5); pos<-match(z,zt); all(sapply(seq(along=pos), function(i)identical(z[i],zt[pos[i]])))})

  n <- 100000
  m <- 50
  # even worse: lists with vectors of numeric
  x <- matrix(runif(n), m)
  y <- lapply(1:ncol(x), function(i)x[,i])
  system.time(duplicated(y))
  system.time(match(y,y))
  # is so slow that md5 converting can speed up match considerably, even with final identity check (break-even is at m=2, for longer vectors md5 is faster)
  system.time({z <- sapply(y, md5); zt <- sapply(y, md5); match(z,z)})
  system.time({z <- sapply(y, md5); zt <- sapply(y, md5); pos<-match(z,zt); all(sapply(seq(along=pos), function(i)identical(z[i],zt[pos[i]])))})

  # less impressive but still so for strings
  x <- matrix(as.character(runif(n)), m)
  y <- lapply(1:ncol(x), function(i)x[,i])
  system.time(duplicated(y))
  system.time(match(y,y))
  # is so slow that md5 converting speeds up match
  system.time({z <- lapply(y, md5); match(z,zt)})
  system.time({z <- sapply(y, md5); zt <- sapply(y, md5); pos<-match(z,zt); all(sapply(seq(along=pos), function(i)identical(z[i],zt[pos[i]])))})

  rm(x)


}


duplicated.matrix <- duplicated.array <-
function (x, incomparables = FALSE, fromLast = FALSE, MARGIN = 1, hashFUN=list, ...)
{
    if (!is.logical(incomparables) || incomparables)
        .NotYetUsed("incomparables != FALSE")
    ndim <- length(dim(x))
    if (length(MARGIN) > ndim || any(MARGIN > ndim))
        stop("MARGIN = ", MARGIN, " is invalid for dim = ", dim(x))
    temp <- apply(x, MARGIN, hashFUN)
    d <- dim(temp)
    dn <- dimnames(temp)
    dim(temp) <- NULL   # we had as.vector here, but that fails for lists with dim attributes
    res <- duplicated(temp, fromLast = fromLast)
    dim(res) <- d
    dimnames(res) <- dn
    res
}

duplicated.data.frame <-
function (x, incomparables = FALSE, fromLast = FALSE, hashFUN=list, ...)
{
    if (!is.logical(incomparables) || incomparables)
        .NotYetUsed("incomparables != FALSE")
    ndim <- length(dim(x))
    temp <- apply(x, 1, hashFUN)
    d <- dim(temp)
    dn <- dimnames(temp)
    dim(temp) <- NULL  # we had as.vector here, but that fails for lists with dim attributes
    res <- duplicated(temp, fromLast = fromLast)
    dim(res) <- d
    dimnames(res) <- dn
    res
}

unique.matrix <- unique.array <-
function (x, incomparables = FALSE, fromLast = FALSE, MARGIN = 1, hashFUN=list, ...)
{
    if (!is.logical(incomparables) || incomparables)
        .NotYetUsed("incomparables != FALSE")
    ndim <- length(dim(x))
    if (length(MARGIN) > 1 || any(MARGIN > ndim))
        stop("MARGIN = ", MARGIN, " is invalid for dim = ", dim(x))
    temp <- apply(x, MARGIN, hashFUN)
    args <- rep(alist(a = ), ndim)
    names(args) <- NULL
    dim(temp) <- NULL  # we had as.vector here, but that fails for lists with dim attributes
    args[[MARGIN]] <- !duplicated(temp, fromLast = fromLast)
    do.call("[", c(list(x = x), args, list(drop = FALSE)))
}

unique.data.frame <-
function (x, incomparables = FALSE, fromLast = FALSE, hashFUN=list, ...)
{
    if (!is.logical(incomparables) || incomparables)
        .NotYetUsed("incomparables != FALSE")
    x[!duplicated(x, fromLast = fromLast, hashFUN = hashFUN), , drop = FALSE]
}


# like duplicated but return hash value instead of logical
hash <- function(x, ...)
    UseMethod("hash")

hash.default <- function(x, hashFUN=md5, ...)
    sapply(x, hashFUN)

hash.matrix <- hash.array <-
function (x, MARGIN = 1, hashFUN=md5, ...)
{
    ndim <- length(dim(x))
    if (length(MARGIN) > ndim || any(MARGIN > ndim))
        stop("MARGIN = ", MARGIN, " is invalid for dim = ", dim(x))
    apply(x, MARGIN, hashFUN)
}

hash.data.frame <-
function (x, hashFUN=md5, ...)
{
    ndim <- length(dim(x))
    apply(x, 1, hashFUN)
}


# like duplicated but return the position of first occurence instead of logical
id <- function(x, ...)
    UseMethod("id")

id.default <- function(x, fromLast = FALSE, hashFUN=NULL, ...){
  if (is.null(hashFUN)){
    if (is.list(x)) x <- sapply(x, md5)  # fix the slow performance of match on lists (R-2.6.0) by converting to md5
    d <- (1:length(x))[!duplicated(x, fromLast = fromLast)]
    d[match(x,x[d])]
  }else{
    x <- lapply(x, hashFUN)
    d <- (1:length(x))[!duplicated(x, fromLast = fromLast)]
    d[match(x,x[d])]
  }
}

id.matrix <- id.array <-
function (x, fromLast = FALSE, MARGIN = 1, hashFUN=md5, ...)
{
    ndim <- length(dim(x))
    nmarg <- length(MARGIN)
    if (nmarg > ndim || any(MARGIN > ndim))
        stop("MARGIN = ", MARGIN, " is invalid for dim = ", dim(x))
    h <- apply(x, MARGIN, hashFUN)
    d <- (1:length(h))[!duplicated(h, fromLast = fromLast)]
    i <- d[match(h,h[d])]
    dim(i) <- dim(h)
    dimnames(i) <- dimnames(h)
    i
}

id.data.frame <-
function (x, fromLast = FALSE, hashFUN=md5, ...)
{
    h <- apply(x, 1, hashFUN)
    d <- (1:length(h))[!duplicated(h, fromLast = fromLast)]
    d[match(h,h[d])]
}




if (FALSE){
  n <- 10000

  # test duplicated
  x <- matrix(runif(n*20),n,20)
  x <- x[rep(1:nrow(x),rep(2,nrow(x))),]

  d1 <- duplicated.matrix(x, hashFUN=list)
  d2 <- duplicated.matrix(x, hashFUN=md5)
  all.equal(d1,d2)
  table(d1)
  rm(d1,d2)

  system.time(duplicated.matrix(x, hashFUN=list))
  system.time(duplicated.matrix(x, hashFUN=md5))

  x <- matrix(as.list(runif(n*20)),n,20)
  x <- x[rep(1:nrow(x),rep(2,nrow(x))),]

  d1 <- duplicated.matrix(x, hashFUN=list)
  d2 <- duplicated.matrix(x, hashFUN=md5)
  all.equal(d1,d2)
  table(d1)
  rm(d1,d2)

  system.time(duplicated.matrix(x, hashFUN=list))
  system.time(duplicated.matrix(x, hashFUN=md5))

  # test unique
  x <- matrix(runif(n*20),n,20)
  x <- x[rep(1:nrow(x),rep(2,nrow(x))),]

  d1 <- unique.matrix(x, hashFUN=list)
  d2 <- unique.matrix(x, hashFUN=md5)
  all.equal(d1,d2)
  dim(d1)
  rm(d1,d2)

  system.time(unique.matrix(x, hashFUN=list))
  system.time(unique.matrix(x, hashFUN=md5))

  x <- matrix(as.list(runif(n*20)),n,20)
  x <- x[rep(1:nrow(x),rep(2,nrow(x))),]

  d1 <- unique.matrix(x, hashFUN=list)
  d2 <- unique.matrix(x, hashFUN=md5)
  all.equal(d1,d2)
  all.equal(md5(d1),md5(d2))
  dim(d1)
  rm(d1,d2)

  system.time(unique.matrix(x, hashFUN=list))
  system.time(unique.matrix(x, hashFUN=md5))

  # test id
  x <- matrix(runif(n*20),n,20)
  x <- x[rep(1:nrow(x),rep(2,nrow(x))),]

  d1 <- id.matrix(x, hashFUN=md5)
  d2 <- id.matrix(x, hashFUN=list)
  all.equal(d1,d2)
  length(unique(d1))
  rm(d1,d2)

  system.time(id.matrix(x, hashFUN=md5))
  system.time(id.matrix(x, hashFUN=list))


  x <- matrix(as.list(runif(n*20)),n,20)
  x <- x[rep(1:nrow(x),rep(2,nrow(x))),]

  d1 <- id.matrix(x, hashFUN=md5)
  d2 <- id.matrix(x, hashFUN=list)
  all.equal(d1,d2)
  length(unique(d1))
  rm(d1,d2)

  system.time(id.matrix(x, hashFUN=md5))
  system.time(id.matrix(x, hashFUN=list))


}



# BTW, the following are methods for the upcoming package/class 'ff'
# they limit the chunk size of RAM needed for reading the data from disk
# yet they assume that the result fits into RAM (and is returned as such)
# they rely on ffapply which helps with chunked indexing

hash.ff <- function (x, MARGIN = NULL, hashFUN=md5
, return.ff = FALSE
, ...   # passed to ffapply
)
{
    if (!is.logical(return.ff) || return.ff)
        .NotYetUsed("return.ff = TRUE")
    d <- dim(x)
    if (is.null(MARGIN))
      MARGIN <- if (is.null(d)) integer() else 1L
    nmarg <- length(MARGIN)
    if (nmarg){
      ndim <- length(d)
      if (nmarg > ndim || any(MARGIN > ndim))
          stop("MARGIN = ", MARGIN, " is invalid for dim = ", d)
      if (nmarg==ndim){
        ret <- apply(x[], MARGIN, hashFUN)
      }else{
        args <- rep(alist(a = ), ndim)
        names(args) <- NULL
        ret <- ffapply(x, {
          args[MARGIN] <- lapply(seq(along=MARGIN), function(i)i1[i]:i2[i])
          temp <- do.call("[", c(list(x = x), args, list(drop = FALSE)))
          apply(temp, MARGIN, hashFUN)
        }, margin=MARGIN, return="unlist", ...)
        if (nmarg>1){
          dim(ret) <- d[MARGIN]
          dimnames(ret) <- dimnames(x)[MARGIN]
        }
      }
    }else{
      ret <- ffapply(x, sapply(x[i1:i2], hashFUN), return="unlist", ...)
    }
    ret
}


# xx this is yet without a final identity check agains md5 collisions
duplicated.ff <-
function (x, incomparables = FALSE, fromLast = FALSE, MARGIN = 1, hashFUN=md5
, return.ff = FALSE
, ...   # passed to ffapply
)
{
    if (!is.logical(incomparables) || incomparables)
        .NotYetUsed("incomparables != FALSE")
    if (!is.logical(return.ff) || return.ff)
        .NotYetUsed("return.ff = TRUE")
    d <- dim(x)
    if (is.null(MARGIN))
      MARGIN <- if (is.null(d)) integer() else 1L
    ndim <- length(d)
    nmarg <- length(MARGIN)
    if (nmarg > ndim || any(MARGIN > ndim))
        stop("MARGIN = ", MARGIN, " is invalid for dim = ", dim(x))
    if (nmarg){
      if (nmarg==ndim){ # no hashFUN needed
        h <- aperm(x[], MARGIN)
      }else{
        h <- hash(x, MARGIN=MARGIN, return.ff=return.ff, hashFUN=hashFUN, ...)
      }
      d <- dim(h)
      dn <- dimnames(h)
      dim(h) <- NULL
      dup <- duplicated(h, fromLast = fromLast)
      dim(dup) <- d
      dimnames(dup) <- dn
    }else{
      # yet no RAM savings in this case
      n <- length(x)                                  # 1:length(n) WOULD be expanded
      dup <- duplicated(x[1:n], fromLast = fromLast)  # 1:n is NOT expanded and returns a simple vector (faster than as.vector(x[]))
    }
    dup
}


# xx this is yet without a final identity check agains md5 collisions
unique.ff <-
function (x, incomparables = FALSE, fromLast = FALSE, MARGIN = NULL, hashFUN=md5
, return.ff = FALSE
, ...   # passed to ffapply
)
{
    if (!is.logical(incomparables) || incomparables)
        .NotYetUsed("incomparables != FALSE")
    if (!is.logical(return.ff) || return.ff)
        .NotYetUsed("return.ff = TRUE")
    d <- dim(x)
    if (is.null(MARGIN))
      MARGIN <- if (is.null(d)) integer() else 1L
    ndim <- length(d)
    nmarg <- length(MARGIN)
    if (nmarg > 1 || any(MARGIN > ndim))
        stop("MARGIN = ", MARGIN, " is invalid for dim = ", dim(x))
    if (nmarg){
      if (nmarg==ndim){ # no hashFUN needed
        h <- aperm(x[], MARGIN)
      }else{
        h <- hash(x, MARGIN=MARGIN, return.ff=return.ff, hashFUN=hashFUN, ...)
      }
      d <- dim(h)
      dn <- dimnames(h)
      dim(h) <- NULL
      args <- rep(alist(a = ), ndim)
      names(args) <- NULL
      args[[MARGIN]] <- !duplicated(h, fromLast = fromLast)
      do.call("[", c(list(x = x), args, list(drop = FALSE)))
    }else{
      # yet no RAM savings in this case
      n <- length(x)
      unique(x[1:n], fromLast = fromLast) # 1:n is NOT expanded and returns a simple vector (faster than as.vector(x[]))
    }
}



# xx this is yet without a final identity check agains md5 collisions
id.ff <- function (x, fromLast = FALSE, MARGIN = NULL, hashFUN=NULL
, return.ff = FALSE
, ...   # passed to ffapply
)
{
    if (!is.logical(return.ff) || return.ff)
        .NotYetUsed("return.ff = TRUE")
    d <- dim(x)
    if (is.null(MARGIN))
      MARGIN <- if (is.null(d)) integer() else 1L
    nmarg <- length(MARGIN)
    if (nmarg){
      if (is.null(hashFUN))
        hashFUN <- md5
      ndim <- length(d)
      if (nmarg > ndim || any(MARGIN > ndim))
          stop("MARGIN = ", MARGIN, " is invalid for dim = ", d)
      if (nmarg==ndim){
        if (is.list(x[1]))
          h <- apply(x[], MARGIN, hashFUN)
        else
          h <- aperm(x[], MARGIN)
        dim(h) <- NULL
      }else{
        args <- rep(alist(a = ), ndim)
        names(args) <- NULL
        h <- ffapply(x, {
          args[MARGIN] <- lapply(seq(along=MARGIN), function(i)i1[i]:i2[i])
          temp <- do.call("[", c(list(x = x), args, list(drop = FALSE)))
          apply(temp, MARGIN, hashFUN)
        }, margin=MARGIN, return="unlist", ...)
      }
      nd <- (1:length(h))[!duplicated(h, fromLast = fromLast)]
      i <- nd[match(h,h[nd])]
      if (nmarg>1){
        # yet no RAM savings in this case
        dim(i) <- d[MARGIN]
        dimnames(i) <- dimnames(x)[MARGIN]
      }
    }else{
      i <- id(x, fromLast = fromLast, hashFUN=hashFUN)
    }
    i
}

# xx this is yet without a final identity check agains md5 collisions
# row identity for ff and R matrices (less overhead compared to id.ff via ffapply )
ffrowid <- function(x, ...){
  id(ffrowapply(x, apply(x[i1:i2,,drop=FALSE], 1, md5), return="unlist", use.names=FALSE, ...))
}

if (FALSE){
  a <- ff(0, dim=c(100000,10),dimorder=2:1)
  ffapply(a, a[i1:i2]<-runif(i2-i1+1))
  r <- ffrowhash(a)
}


if (FALSE){
  n <- 100000
  m <- 10
  x <- ff(0, dim=c(n,m))
  x[,dimorder=2:1] <- 1:(m*n/2)

  hash(x, MARGIN=integer()) # hash single cells, no RAM optimization
  hash(x)                   # hash rows, RAM savings because rows are read and md5ed i chunks
  duplicated(x)             #
  id(x)                     # positions of first occurences
  ffrowid(x)                # faster positions
  unique(x)                 # unique rows

}


--


From Achim.Zeileis at wu-wien.ac.at  Fri Nov  2 15:58:36 2007
From: Achim.Zeileis at wu-wien.ac.at (Achim Zeileis)
Date: Fri, 2 Nov 2007 15:58:36 +0100 (CET)
Subject: [Rd] vignettes and papers
In-Reply-To: <5A5972FD-DD8A-498D-8849-80D9A41F80F8@noc.soton.ac.uk>
Message-ID: <Pine.LNX.4.44.0711021539590.26729-100000@disco.wu-wien.ac.at>

Robin:

> Lots of my packages have been the subject of
> journal articles either in JSS or Rnews or (in one
> case) elsewhere.
>
> I would like to add these articles
> to my packages as vignettes.
>
> Reproducing the papers exactly requires a number
> of files [such as style files or PDFs] to be included in
>   the inst/doc directory to pass R CMD check.
>
> A vanilla .Rnw file seems to be a good idea,
> but loses some of the nice JSS typesetting.
>
> What is Best Practice here?
>
> And are there ethical or other issues that I should
> be aware of  before including copies of Rnews
> or JSS papers verbatim in an R package?

There are two separate issues here:
  1. Using jss.cls
     This is ok, as long as the vignette is completely
     identical with the published paper. But as some details of a
     vignette might be modified/extended/corrected/enhanced, I typically
     remove the JSS header and instead include a comment like
        A previous version to this introduction to the
        R package zoo has been published as Zeileis
        and Grothendieck (2005) in the Journal of Statistical
        Software.
     in the vignette. See
       vignette("zoo", package = "zoo")
     If you want a .cls file that provides the same commands as jss.cls
     but without the JSS header and footer, see Z.cls at
       http://statmath.wu-wien.ac.at/~zeileis/tex/
  2. Including style files in the package
     Checking whether the LaTeX sources can be compiled wasn't done
     until recently and now leads to a notification. Because I'm using
     the same infrastructure (typically Z.cls) in all of my packages,
     I don't want to maintain them in each of my packages additionally
     and currently don't supply them within the R package. My personal
     opinion is that this is not so much of a problem because people
     want to work with the R code and not the LaTeX code...but, obviously,
     there is some tension in this. Just my EUR 0.02.

hth,
Z


From luke at stat.uiowa.edu  Fri Nov  2 16:03:51 2007
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Fri, 2 Nov 2007 10:03:51 -0500 (CDT)
Subject: [Rd] Cell or PS3 Port
In-Reply-To: <47235AC1.9040302@sixfoursystems.com>
References: <47235AC1.9040302@sixfoursystems.com>
Message-ID: <Pine.LNX.4.64.0711020947280.6214@nokomis.stat.uiowa.edu>

I have been experimenting with ways of parallelizing many of the
functions in the math library.  There are two experimental packages
available in http://www.stat.uiowa.edu/~luke/R/experimental: pnmath,
based on OpenMP, and pnmath0, based on basic pthreads.  I'm not sure
to what degree the approach there would carry over to GPUs or Cell
where the additional processors are different from the main processor
and may not share memory (I forget how that works on Cell).

The first issue is that you need some modifications to the some
functions to ensure they are thread-safe.  For the most part these are
minor; a few functions would require major changes and I have not
tackled them for now (Bessel functions, wilcox, signrank I believe).
RNG functions are also not suitable for parallelization given the
dependence on the sequential underlying RNG.

It is not too hard to get parallel versions to use all available
processor cores. The challenge is to make sure that the parallel
versions don't run slower than the serial versions. They may if the
amount of data is too small.  What is too small for each function
depends on the OS and the processor/memory architecture; if memory is
not shared this gets more complicated still.  For some very simple
functions (floor, ceiling, sign) I could not see any reliable benefit
of parallelization for reasonable data sizes on the systems I was
using so I left those alone for now.

luke

On Sat, 27 Oct 2007, Ed Knutson wrote:

> Hello,
>
> I am interested in optimizing some of R's vector math functions to
> utilize the SPE units of the Cell processor (commonly found in the
> Playstation 3) and I am wondering if anyone has already done any work in
> that area.  I can't find anything using the search page or Google.
> (Admittedly it is difficult to search for information on a
> one-letter-named programming language whose contributed documentation
> intrinsically refers to "cells" frequently. :)  I'm assuming it will be
> possible to compile R under a PS3 version of Linux, since it has a ppc64
> architecture and R already runs on OS X.  Are there any known caveats to
> compiling R for a distro like Ubuntu with X11 support?
>
> I'm just going through the Cell SDK documentation at this point so it
> will be a few days before I really get into the guts of it.  Any
> information would be greatly appreciated.
>
> -Ed
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From ed at sixfoursystems.com  Fri Nov  2 17:51:41 2007
From: ed at sixfoursystems.com (Ed Knutson)
Date: Fri, 02 Nov 2007 11:51:41 -0500
Subject: [Rd] Cell or PS3 Port
In-Reply-To: <Pine.LNX.4.64.0711020947280.6214@nokomis.stat.uiowa.edu>
References: <47235AC1.9040302@sixfoursystems.com>
	<Pine.LNX.4.64.0711020947280.6214@nokomis.stat.uiowa.edu>
Message-ID: <472B559D.6090703@sixfoursystems.com>

The main core of the Cell (the PPE) uses IBM's version of hyperthreading 
to expose two logical, main CPU's to the OS, so code that is "simply" 
multi-threaded should still see an advantage.  In addition, IBM provides 
an SDK which includes workflow management as well as libraries to 
support common linear algebra and other math functions on the 
sub-processors (called SPE's).  They also provide an interface to a 
hardware RNG as well as 3 software types (2 psuedo, 1 quasi) that are 
coded for the SPE.

Each SPE has its own small, local memory store and communicates with 
main memory using a DMA queue.  It seems to be a question of breaking up 
each task into units that are small enough to offload to an SPE.  My 
initial direction will be to set up a rudimentary workflow manager.  As 
an optimized function is encountered, a sufficient number of SPE threads 
will be spawned and execution of the main thread will wait for all 
results.  As for the optimized functions, I intend to start with the 
ones who already have an analogous implementation in the IBM math libraries.

MPI has been employed by some Cell developers to allow multiple SPE's 
working on sections of the same task to communicate with each other.  I 
like the idea of this approach, since it lays the groundwork to allow 
multiple Cell (or really any) processors to be clustered.


Luke Tierney wrote:
> I have been experimenting with ways of parallelizing many of the
> functions in the math library.  There are two experimental packages
> available in http://www.stat.uiowa.edu/~luke/R/experimental: pnmath,
> based on OpenMP, and pnmath0, based on basic pthreads.  I'm not sure
> to what degree the approach there would carry over to GPUs or Cell
> where the additional processors are different from the main processor
> and may not share memory (I forget how that works on Cell).
> 
> The first issue is that you need some modifications to the some
> functions to ensure they are thread-safe.  For the most part these are
> minor; a few functions would require major changes and I have not
> tackled them for now (Bessel functions, wilcox, signrank I believe).
> RNG functions are also not suitable for parallelization given the
> dependence on the sequential underlying RNG.
> 
> It is not too hard to get parallel versions to use all available
> processor cores. The challenge is to make sure that the parallel
> versions don't run slower than the serial versions. They may if the
> amount of data is too small.  What is too small for each function
> depends on the OS and the processor/memory architecture; if memory is
> not shared this gets more complicated still.  For some very simple
> functions (floor, ceiling, sign) I could not see any reliable benefit
> of parallelization for reasonable data sizes on the systems I was
> using so I left those alone for now.


From groemp at tfh-berlin.de  Sat Nov  3 21:34:10 2007
From: groemp at tfh-berlin.de (=?UTF-8?Q?Ulrike_Gr=C3=B6mping?=)
Date: Sat, 3 Nov 2007 13:34:10 -0700 (PDT)
Subject: [Rd]  Strange behavior of pretty
Message-ID: <13566672.post@talk.nabble.com>


Dear all,

I got stuck with a weird behavior of pretty:
    pretty(c(-1,1),n=1)
yields -2, 0, 2 instead of the desired result -1 1.
Likewise, 
    pretty(c(-2,2),n=1)
yields -5, 0, 5 instead of the desired result -2 2.
With n=0, the result is the same, while with n=2 everything is as
documented.

This behavior nastily messed up some of my cube plots. Is there any chance
that this can be fixed? 

Regards, Ulrike

-- 
View this message in context: http://www.nabble.com/Strange-behavior-of-pretty-tf4744337.html#a13566672
Sent from the R devel mailing list archive at Nabble.com.


From betul.saf at gmail.com  Sat Nov  3 22:00:03 2007
From: betul.saf at gmail.com (betul)
Date: Sat, 3 Nov 2007 14:00:03 -0700 (PDT)
Subject: [Rd] ctest
In-Reply-To: <13563329.post@talk.nabble.com>
References: <13487949.post@talk.nabble.com> <13563329.post@talk.nabble.com>
Message-ID: <13566839.post@talk.nabble.com>


Thank you so much Ben...

Bet?l


Ben Bolker wrote:
> 
> 
> 
> betul wrote:
>> 
>> Hi,
>> How can I download "ctest"?
>> Thank you.
>> Bet?l SAF
>> 
> 
>  This kind of basic question belongs in R-help rather than the R-devel
> (which is for technical or development-related questions).
> Furthermore:
> 
>> library(ctest)
> Warning message:
> package 'ctest' has been merged into 'stats' 
> 
>   So you should already have it if you have R (the 'stats' package
> is included with base R).  
> 
>   If you have more specific questions about finding something,
> try the R help list.
> 
>   Ben Bolker
> 
> 

-- 
View this message in context: http://www.nabble.com/ctest-tf4718275.html#a13566839
Sent from the R devel mailing list archive at Nabble.com.


From murdoch at stats.uwo.ca  Sat Nov  3 23:10:51 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 03 Nov 2007 18:10:51 -0400
Subject: [Rd] Strange behavior of pretty
In-Reply-To: <13566672.post@talk.nabble.com>
References: <13566672.post@talk.nabble.com>
Message-ID: <472CF1EB.9020703@stats.uwo.ca>

On 03/11/2007 4:34 PM, Ulrike Gr?mping wrote:
> Dear all,
> 
> I got stuck with a weird behavior of pretty:
>     pretty(c(-1,1),n=1)
> yields -2, 0, 2 instead of the desired result -1 1.
> Likewise, 
>     pretty(c(-2,2),n=1)
> yields -5, 0, 5 instead of the desired result -2 2.

I don't think pretty() should ever return -1 1 or -2 2.  It should 
always return multiples of some round number, so it would have to 
include 0.  But I don't see why it is expanding the range.  It doesn't 
do that when the results are non-negative, e.g.

 > pretty(0:1, n=1)
[1] 0 1
 > pretty(0:2, n=1)
[1] 0 2

> With n=0, the result is the same, while with n=2 everything is as
> documented.
> 
> This behavior nastily messed up some of my cube plots. Is there any chance
> that this can be fixed? 

The documentation has been sitting for 8 years with "FIXME" notes in it, 
so I wouldn't hold my breath.

Duncan Murdoch


From ripley at stats.ox.ac.uk  Sun Nov  4 09:02:49 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 4 Nov 2007 08:02:49 +0000 (GMT)
Subject: [Rd] Strange behavior of pretty
In-Reply-To: <472CF1EB.9020703@stats.uwo.ca>
References: <13566672.post@talk.nabble.com> <472CF1EB.9020703@stats.uwo.ca>
Message-ID: <Pine.LNX.4.64.0711040800580.12590@gannet.stats.ox.ac.uk>

On Sat, 3 Nov 2007, Duncan Murdoch wrote:

> On 03/11/2007 4:34 PM, Ulrike Gr?mping wrote:
>> Dear all,
>>
>> I got stuck with a weird behavior of pretty:
>>     pretty(c(-1,1),n=1)
>> yields -2, 0, 2 instead of the desired result -1 1.
>> Likewise,
>>     pretty(c(-2,2),n=1)
>> yields -5, 0, 5 instead of the desired result -2 2.
>
> I don't think pretty() should ever return -1 1 or -2 2.  It should
> always return multiples of some round number, so it would have to
> include 0.  But I don't see why it is expanding the range.  It doesn't
> do that when the results are non-negative, e.g.
>
> > pretty(0:1, n=1)
> [1] 0 1
> > pretty(0:2, n=1)
> [1] 0 2
>
>> With n=0, the result is the same, while with n=2 everything is as
>> documented.
>>
>> This behavior nastily messed up some of my cube plots. Is there any chance
>> that this can be fixed?
>
> The documentation has been sitting for 8 years with "FIXME" notes in it,
> so I wouldn't hold my breath.

The way to make the 'chance' appreciable would be to contribute a 
(high-quality) patch.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From oehl_list at gmx.de  Mon Nov  5 13:41:50 2007
From: oehl_list at gmx.de (=?iso-8859-1?Q?=22Jens_Oehlschl=E4gel=22?=)
Date: Mon, 05 Nov 2007 13:41:50 +0100
Subject: [Rd] namespace crash on S3method("as.ff",function)
Message-ID: <20071105124150.36550@gmx.net>

Dear all,

I have defined a generic as.ff(x, ...) and a method as.ff.function(x, ...) which converts a standard R function x into a chunked version operating on large ff objects. Everything works fine, but when registering 

S3method("as.ff",function)

in NAMESPACE, the installation fails with some kind of parsing error:

  adding build stamp to DESCRIPTION
  installing NAMESPACE file and metadata
Fehler in parse(nsFile) : Unerwartetes ')' bei
348:
349: S3method("as.ff",function)
Calls: <Anonymous> -> parseNamespaceFile -> parse
Ausf?hrung angehalten
make[2]: *** [nmspace] Error 1
make[1]: *** [all] Error 2
make: *** [pkg-ff] Error 2
*** Installation of ff failed ***

Is this a bug? Any ideas?

Best regards


Jens


P.S. with as.ff() we can do things like
ffx <- as.ff(x) # as.ff.default() turns a standard R object into an ff object stored on disk
as.ff(log)(ffx) # as.ff.function() turns 'log' into a function that we can call on ffx: taking the log of an almost arbitrarily large object


> version
               _                           
platform       i386-pc-mingw32             
arch           i386                        
os             mingw32                     
system         i386, mingw32               
status                                     
major          2                           
minor          6.0                         
year           2007                        
month          10                          
day            03                          
svn rev        43063                       
language       R                           
version.string R version 2.6.0 (2007-10-03)

-- 
Psssst! Schon vom neuen GMX MultiMessenger geh?rt?
Der kann`s mit allen: http://www.gmx.net/de/go/multimessenger


From murdoch at stats.uwo.ca  Mon Nov  5 14:36:53 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 05 Nov 2007 08:36:53 -0500
Subject: [Rd] namespace crash on S3method("as.ff",function)
In-Reply-To: <20071105124150.36550@gmx.net>
References: <20071105124150.36550@gmx.net>
Message-ID: <472F1C75.3010409@stats.uwo.ca>

On 11/5/2007 7:41 AM, Jens Oehlschl?gel wrote:
> Dear all,
> 
> I have defined a generic as.ff(x, ...) and a method as.ff.function(x, ...) which converts a standard R function x into a chunked version operating on large ff objects. Everything works fine, but when registering 
> 
> S3method("as.ff",function)
> 
> in NAMESPACE, the installation fails with some kind of parsing error:
> 
>   adding build stamp to DESCRIPTION
>   installing NAMESPACE file and metadata
> Fehler in parse(nsFile) : Unerwartetes ')' bei
> 348:
> 349: S3method("as.ff",function)
> Calls: <Anonymous> -> parseNamespaceFile -> parse
> Ausf?hrung angehalten
> make[2]: *** [nmspace] Error 1
> make[1]: *** [all] Error 2
> make: *** [pkg-ff] Error 2
> *** Installation of ff failed ***
> 
> Is this a bug? Any ideas?

"function" is a reserved keyword for the parser.  Even though you don't 
execute a NAMESPACE file, it's parsed by the standard parser, and that's 
causing the problem.  (You couldn't have a function call that looked 
like that without a parse error, either.)

I don't have time to explore this today, but what I'd do is try

S3method("as.ff", `function`)

or

S3method("as.ff","function")

first, and if those don't fix it and you don't get a better suggestion, 
then report this as a design bug.

Duncan Murdoch

> Best regards
> 
> 
> Jens
> 
> 
> P.S. with as.ff() we can do things like
> ffx <- as.ff(x) # as.ff.default() turns a standard R object into an ff object stored on disk
> as.ff(log)(ffx) # as.ff.function() turns 'log' into a function that we can call on ffx: taking the log of an almost arbitrarily large object
> 
> 
>> version
>                _                           
> platform       i386-pc-mingw32             
> arch           i386                        
> os             mingw32                     
> system         i386, mingw32               
> status                                     
> major          2                           
> minor          6.0                         
> year           2007                        
> month          10                          
> day            03                          
> svn rev        43063                       
> language       R                           
> version.string R version 2.6.0 (2007-10-03)
>


From ripley at stats.ox.ac.uk  Mon Nov  5 14:42:34 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 5 Nov 2007 13:42:34 +0000 (GMT)
Subject: [Rd] namespace crash on S3method("as.ff",function)
In-Reply-To: <20071105124150.36550@gmx.net>
References: <20071105124150.36550@gmx.net>
Message-ID: <Pine.LNX.4.64.0711051335580.19513@gannet.stats.ox.ac.uk>

On Mon, 5 Nov 2007, "Jens Oehlschl?gel" wrote:

> Dear all,
>
> I have defined a generic as.ff(x, ...) and a method as.ff.function(x, ...) which converts a standard R function x into a chunked version operating on large ff objects. Everything works fine, but when registering
>
> S3method("as.ff",function)
>
> in NAMESPACE, the installation fails with some kind of parsing error:
>
>  adding build stamp to DESCRIPTION
>  installing NAMESPACE file and metadata
> Fehler in parse(nsFile) : Unerwartetes ')' bei
> 348:
> 349: S3method("as.ff",function)
> Calls: <Anonymous> -> parseNamespaceFile -> parse
> Ausf?hrung angehalten
> make[2]: *** [nmspace] Error 1
> make[1]: *** [all] Error 2
> make: *** [pkg-ff] Error 2
> *** Installation of ff failed ***
>
> Is this a bug? Any ideas?

You need to quote "function".  It falls under

   (Note that variable names may be quoted, and non-standard names such as
   @code{[<-.fractions} must be.)

since reserved words cannot be standard names.  But it could stand being 
spelt out in R-exts.

There are examples in package 'utils'.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From Fabian.Scheipl at stat.uni-muenchen.de  Mon Nov  5 16:16:53 2007
From: Fabian.Scheipl at stat.uni-muenchen.de (Fabian Scheipl)
Date: Mon, 5 Nov 2007 16:16:53 +0100
Subject: [Rd] Should numeric()/character() etc initialize with NA instead of
	0 or ""?
Message-ID: <4836bc6a0711050716p21f56e42hd9065c46ab33769c@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20071105/7b6b23c6/attachment.pl 

From ripley at stats.ox.ac.uk  Mon Nov  5 18:30:35 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 5 Nov 2007 17:30:35 +0000 (GMT)
Subject: [Rd] Should numeric()/character() etc initialize with NA
 instead of 0 or ""?
In-Reply-To: <4836bc6a0711050716p21f56e42hd9065c46ab33769c@mail.gmail.com>
References: <4836bc6a0711050716p21f56e42hd9065c46ab33769c@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0711051724110.13436@gannet.stats.ox.ac.uk>

On Mon, 5 Nov 2007, Fabian Scheipl wrote:

> Wouldn't it make programming more error-resistant if vectors were
> initialized with missing data, instad of zeroes or ""?

Lots of code relies on this.  It's common programming practice (and not 
just in R/S).

> That way, if you assign values to a vector elementwise and you miss some
> elements
> (because their indices were not selected or because the assignment didn't
> work out, see below for code examples)
> this would be immediately obvious from the value of the vector elements
> themselves
> and programming errors would be far less easy to overlook.

But using x <- rep(NA_real_, n) does this for you, and is much clearer to 
the reader. Using x <- numeric(n) is only appropriate if you want '0.0' 
elements.

> e.g.
>
> x <- numeric(n)  or
> for( i in seq(along = x) )
> {
>      try(x[i] <- function.which.might.crash( args[i] ))
> }
>
> or
>
> x <- numeric(n)
> x[condition1] <- foo(args1)
> x[condition2] <- foo(args2)
> ...
> x[conditionN] <- foo(argsN)
>
> will produce x without any NAs even if function.which.might.crash() actually
> did crash during the loop or
> if there are indices for which none of conditions 1 to N were true and you
> cannot distinguish between zeroes which
> are real results and zeroes that remained unchanged since initialization of
> the vector.
>
> In a sense, initializing with NAs would also be more consistent with
> vector(n, mode = "list"), which produces a list of n NULL-objects.
> (numeric(10) is just a wrapper for vector(10, mode="numeric"))
>
> Let me know what you think.
>
> Regards,
> Fabian
>
> 	[[alternative HTML version deleted]]

You were specifically asked not to do that.

> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From andy_liaw at merck.com  Mon Nov  5 21:48:21 2007
From: andy_liaw at merck.com (Liaw, Andy)
Date: Mon, 5 Nov 2007 15:48:21 -0500
Subject: [Rd] dot in function name taken as S3 method by package check
Message-ID: <39B6DDB9048D0F4DAD42CB26AAFF0AFA04E47C7A@usctmx1106.merck.com>

Hello everyone,

I'm trying to update the locfit package so that it passes package check
in R 2.6.0.  However, the check seems to think some of the functions
with dot in the names are S3 methods (thus warns about the format of the
\usage{} part) when they are not.  Can anyone recommend a workaround for
this?  I tried reading R-exts, but couldn't find any hint.  I'd very
much appreciate any help!

Best,
Andy

Andy Liaw, PhD
Biometrics Research    PO Box 2000 RY33-300
Merck Research Labs        Rahway, NJ 07065
andy_liaw(a)merck.com          732-594-0820



------------------------------------------------------------------------------
Notice:  This e-mail message, together with any attachme...{{dropped:15}}


From murdoch at stats.uwo.ca  Mon Nov  5 22:19:37 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 05 Nov 2007 16:19:37 -0500
Subject: [Rd] dot in function name taken as S3 method by package check
In-Reply-To: <39B6DDB9048D0F4DAD42CB26AAFF0AFA04E47C7A@usctmx1106.merck.com>
References: <39B6DDB9048D0F4DAD42CB26AAFF0AFA04E47C7A@usctmx1106.merck.com>
Message-ID: <472F88E9.8010400@stats.uwo.ca>

On 05/11/2007 3:48 PM, Liaw, Andy wrote:
> Hello everyone,
> 
> I'm trying to update the locfit package so that it passes package check
> in R 2.6.0.  However, the check seems to think some of the functions
> with dot in the names are S3 methods (thus warns about the format of the
> \usage{} part) when they are not.  Can anyone recommend a workaround for
> this?  I tried reading R-exts, but couldn't find any hint.  I'd very
> much appreciate any help!

I think you need a NAMESPACE file.  That's where you declare whether 
things are S3 methods or not.  Without a NAMESPACE, a function like 
locfit.raw could act as the locfit method for raw objects, if someone 
ever declared a locfit generic function.  Probably not what was intended.

Duncan Murdoch


From macq at llnl.gov  Tue Nov  6 02:28:37 2007
From: macq at llnl.gov (Don MacQueen)
Date: Mon, 5 Nov 2007 17:28:37 -0800
Subject: [Rd] FYI: issue with arpa/inet.h on SunOS 5.9 (old gcc?)
Message-ID: <p06230907c355359f870f@[128.115.153.6]>

This just information of my experience installing R on SunOS 5.9 
today, not a request for help.
(in case anyone cares, and if not, I apologize for the distraction)

I am building R 2.6.0 (patched; svn revision 43319, 2007-11-01) and 
encountered the problem described below.

I believe the problem is an old gcc (version 3.0.4, built some 5 
years ago), because the warnings do not occur when I specify
    CC = cc
in the environment before configuring, and building R succeeds.

Hence I'm mailing to r-devel instead of r-bugs, as suggested in the 
warning messages.

I don't have much information about the cc I used (I'm not the 
sysadmin of this or any Solaris machine), other than it resides in 
/opt/SUNWspro, and appears to be part of "Sun Studio 11", whatever 
that is.


The messages from R's configure were:

configure: WARNING: arpa/inet.h: present but cannot be compiled
configure: WARNING: arpa/inet.h:     check for missing prerequisite headers?
configure: WARNING: arpa/inet.h: see the Autoconf documentation
configure: WARNING: arpa/inet.h:     section "Present But Cannot Be Compiled"
configure: WARNING: arpa/inet.h: proceeding with the preprocessor's result
configure: WARNING: arpa/inet.h: in the future, the compiler will 
take precedence
configure: WARNING:     ## ----------------------------------- ##
configure: WARNING:     ## Report this to r-bugs at R-project.org ##
configure: WARNING:     ## ----------------------------------- ##

And then the same set of warnings for
   netdb.h
   netinet/in.h
   sys/socket.h

At the very end configure reports:

configure: WARNING: could not determine type of socket length


Then, make fails with:

In file included from /usr/include/netinet/in.h:41,
                  from /usr/include/netdb.h:98,
                  from ../../../R-patched/src/main/platform.c:1586:
/usr/include/sys/stream.h:307: parse error before "projid_t"
make[3]: *** [platform.o] Error 1
make[3]: Leaving directory `/apps/kosapps/R/R-2.6.0/build/src/main'
make[2]: *** [R] Error 2
make[2]: Leaving directory `/apps/kosapps/R/R-2.6.0/build/src/main'
make[1]: *** [R] Error 1
make[1]: Leaving directory `/apps/kosapps/R/R-2.6.0/build/src'
make: *** [R] Error 1

-- 
--------------------------------------
Don MacQueen
Environmental Protection Department
Lawrence Livermore National Laboratory
Livermore, CA, USA
925-423-1062


From A.Robinson at ms.unimelb.edu.au  Tue Nov  6 06:10:28 2007
From: A.Robinson at ms.unimelb.edu.au (Andrew Robinson)
Date: Tue, 6 Nov 2007 16:10:28 +1100
Subject: [Rd] A suggestion for an amendment to tapply
Message-ID: <20071106051028.GW71568@ms.unimelb.edu.au>

Dear R-developers,

when tapply() is invoked on factors that have empty levels, it returns
NA.  This behaviour is in accord with the tapply documentation, and is
reasonable in many cases.  However, when FUN is sum, it would also
seem reasonable to return 0 instead of NA, because "the sum of an
empty set is zero, by definition."

I'd like to raise a discussion of the possibility of an amendment to
tapply.

The attached patch changes the function so that it checks if there are
any empty levels, and if there are, replaces the corresponding NA
values with the result of applying FUN to the empty set.  Eg in the
case of sum, it replaces the NA with 0, whereas with mean, it replaces
the NA with NA, and issues a warning.

This change has the following advantage: tapply and sum work better
together.  Arguably, tapply and any other function that has a non-NA
response to the empty set will also work better together.
Furthermore, tapply shows a warning if FUN would normally show a
warning upon being evaluated on an empty set.  That deviates from
current behaviour, which might be bad, but also provides information
that might be useful to the user, so that would be good.

The attached script provides the new function in full, and
demonstrates its application in some simple test cases.

Best wishes,

Andrew
-- 
Andrew Robinson  
Department of Mathematics and Statistics            Tel: +61-3-8344-9763
University of Melbourne, VIC 3010 Australia         Fax: +61-3-8344-4599
http://www.ms.unimelb.edu.au/~andrewpr
http://blogs.mbs.edu/fishing-in-the-bay/ 
-------------- next part --------------
## The new function

my.tapply <- function (X, INDEX, FUN=NULL, ..., simplify=TRUE)
{
    FUN <- if (!is.null(FUN)) match.fun(FUN)
    if (!is.list(INDEX)) INDEX <- list(INDEX)
    nI <- length(INDEX)
    namelist <- vector("list", nI)
    names(namelist) <- names(INDEX)
    extent <- integer(nI)
    nx <- length(X)
    one <- as.integer(1)
    group <- rep.int(one, nx)#- to contain the splitting vector
    ngroup <- one
    for (i in seq.int(INDEX)) {
	index <- as.factor(INDEX[[i]])
	if (length(index) != nx)
	    stop("arguments must have same length")
	namelist[[i]] <- levels(index)#- all of them, yes !
	extent[i] <- nlevels(index)
	group <- group + ngroup * (as.integer(index) - one)
	ngroup <- ngroup * nlevels(index)
    }
    if (is.null(FUN)) return(group)
    ans <- lapply(split(X, group), FUN, ...)
    index <- as.numeric(names(ans))
    if (simplify && all(unlist(lapply(ans, length)) == 1)) {
	ansmat <- array(dim=extent, dimnames=namelist)
	ans <- unlist(ans, recursive = FALSE)
    }
    else  {
	ansmat <- array(vector("list", prod(extent)),
			dim=extent, dimnames=namelist)
    }
    ## old : ansmat[as.numeric(names(ans))] <- ans
    names(ans) <- NULL
    ansmat[index] <- ans
    if (sum(table(INDEX) < 1) > 0)
        ansmat[table(INDEX) < 1] <- do.call(FUN, list(c(NULL), ...)) 
    ansmat
}

## Check its utility

group <- factor(c(1,1,3,3), levels=c("1","2","3"))
x <- c(1,2,3,4)

## Ok with mean?

tapply(x, group, mean)
my.tapply(x, group, mean)

## Ok with sum?

tapply(x, group, sum)
my.tapply(x, group, sum)

## Check that other arguments are carried through

x <- c(NA,2,3,10)

tapply(x, group, sum, na.rm=TRUE)
tapply(x, group, mean, na.rm=TRUE)

my.tapply(x, group, sum, na.rm=TRUE)
my.tapply(x, group, mean, na.rm=TRUE)

## Check that listed groups work ok also

group.2 <- factor(c(1,2,3,3), levels=c("1","2","3"))

tapply(x, list(group, group.2), sum, na.rm=TRUE)
tapply(x, list(group, group.2), mean, na.rm=TRUE)

my.tapply(x, list(group, group.2), sum, na.rm=TRUE)
my.tapply(x, list(group, group.2), mean, na.rm=TRUE)


From Bill.Venables at csiro.au  Tue Nov  6 07:53:44 2007
From: Bill.Venables at csiro.au (Bill.Venables at csiro.au)
Date: Tue, 6 Nov 2007 16:53:44 +1000
Subject: [Rd] A suggestion for an amendment to tapply
References: <20071106051028.GW71568@ms.unimelb.edu.au>
Message-ID: <B998A44C8986644EA8029CFE6396A924D895A4@exqld2-bne.nexus.csiro.au>

Unfortunately I think it would break too much existing code.  tapply()
is an old function and many people have gotten used to the way it works
now.

This is not to suggest there could not be another argument added at the
end to indicate that you want the new behaviour, though.  e.g. 

tapply <- function (X, INDEX, FUN=NULL, ..., simplify=TRUE,
handle.empty.levels = FALSE) 

but this raises the question of what sort of time penalty the
modification might entail.  Probably not much for most situations, I
suppose.  (I know this argument name looks long, but you do need a
fairly specific argument name, or it will start to impinge on the ...
argument.)

Just some thoughts.

Bill Venables.

Bill Venables
CSIRO Laboratories
PO Box 120, Cleveland, 4163
AUSTRALIA
Office Phone (email preferred): +61 7 3826 7251
Fax (if absolutely necessary):  +61 7 3826 7304
Mobile:                         +61 4 8819 4402
Home Phone:                     +61 7 3286 7700
mailto:Bill.Venables at csiro.au
http://www.cmis.csiro.au/bill.venables/ 

-----Original Message-----
From: r-devel-bounces at r-project.org
[mailto:r-devel-bounces at r-project.org] On Behalf Of Andrew Robinson
Sent: Tuesday, 6 November 2007 3:10 PM
To: R-Devel
Subject: [Rd] A suggestion for an amendment to tapply

Dear R-developers,

when tapply() is invoked on factors that have empty levels, it returns
NA.  This behaviour is in accord with the tapply documentation, and is
reasonable in many cases.  However, when FUN is sum, it would also
seem reasonable to return 0 instead of NA, because "the sum of an
empty set is zero, by definition."

I'd like to raise a discussion of the possibility of an amendment to
tapply.

The attached patch changes the function so that it checks if there are
any empty levels, and if there are, replaces the corresponding NA
values with the result of applying FUN to the empty set.  Eg in the
case of sum, it replaces the NA with 0, whereas with mean, it replaces
the NA with NA, and issues a warning.

This change has the following advantage: tapply and sum work better
together.  Arguably, tapply and any other function that has a non-NA
response to the empty set will also work better together.
Furthermore, tapply shows a warning if FUN would normally show a
warning upon being evaluated on an empty set.  That deviates from
current behaviour, which might be bad, but also provides information
that might be useful to the user, so that would be good.

The attached script provides the new function in full, and
demonstrates its application in some simple test cases.

Best wishes,

Andrew
-- 
Andrew Robinson  
Department of Mathematics and Statistics            Tel: +61-3-8344-9763
University of Melbourne, VIC 3010 Australia         Fax: +61-3-8344-4599
http://www.ms.unimelb.edu.au/~andrewpr
http://blogs.mbs.edu/fishing-in-the-bay/ 


From ripley at stats.ox.ac.uk  Tue Nov  6 08:33:08 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 6 Nov 2007 07:33:08 +0000 (GMT)
Subject: [Rd] FYI: issue with arpa/inet.h on SunOS 5.9 (old gcc?)
In-Reply-To: <p06230907c355359f870f@[128.115.153.6]>
References: <p06230907c355359f870f@[128.115.153.6]>
Message-ID: <Pine.LNX.4.64.0711060725250.18150@gannet.stats.ox.ac.uk>

What OS was that compiler built for?  This happened when you had a 
version of gcc built for the wrong version of the OS, as gcc captures 
system headers.  (There's a warning about that in the R-admin manual.)

The 'report to' message is autogenerated by autoconf.

SunStudio 11 is a recent version of Sun's compilers, and much to be 
preferred to gcc 3.0.4 on that platform (and probably to any version of 
gcc there).

On Mon, 5 Nov 2007, Don MacQueen wrote:

> This just information of my experience installing R on SunOS 5.9
> today, not a request for help.
> (in case anyone cares, and if not, I apologize for the distraction)
>
> I am building R 2.6.0 (patched; svn revision 43319, 2007-11-01) and
> encountered the problem described below.
>
> I believe the problem is an old gcc (version 3.0.4, built some 5
> years ago), because the warnings do not occur when I specify
>    CC = cc
> in the environment before configuring, and building R succeeds.
>
> Hence I'm mailing to r-devel instead of r-bugs, as suggested in the
> warning messages.
>
> I don't have much information about the cc I used (I'm not the
> sysadmin of this or any Solaris machine), other than it resides in
> /opt/SUNWspro, and appears to be part of "Sun Studio 11", whatever
> that is.
>
>
> The messages from R's configure were:
>
> configure: WARNING: arpa/inet.h: present but cannot be compiled
> configure: WARNING: arpa/inet.h:     check for missing prerequisite headers?
> configure: WARNING: arpa/inet.h: see the Autoconf documentation
> configure: WARNING: arpa/inet.h:     section "Present But Cannot Be Compiled"
> configure: WARNING: arpa/inet.h: proceeding with the preprocessor's result
> configure: WARNING: arpa/inet.h: in the future, the compiler will
> take precedence
> configure: WARNING:     ## ----------------------------------- ##
> configure: WARNING:     ## Report this to r-bugs at R-project.org ##
> configure: WARNING:     ## ----------------------------------- ##
>
> And then the same set of warnings for
>   netdb.h
>   netinet/in.h
>   sys/socket.h
>
> At the very end configure reports:
>
> configure: WARNING: could not determine type of socket length
>
>
> Then, make fails with:
>
> In file included from /usr/include/netinet/in.h:41,
>                  from /usr/include/netdb.h:98,
>                  from ../../../R-patched/src/main/platform.c:1586:
> /usr/include/sys/stream.h:307: parse error before "projid_t"
> make[3]: *** [platform.o] Error 1
> make[3]: Leaving directory `/apps/kosapps/R/R-2.6.0/build/src/main'
> make[2]: *** [R] Error 2
> make[2]: Leaving directory `/apps/kosapps/R/R-2.6.0/build/src/main'
> make[1]: *** [R] Error 1
> make[1]: Leaving directory `/apps/kosapps/R/R-2.6.0/build/src'
> make: *** [R] Error 1
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Tue Nov  6 08:23:56 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 6 Nov 2007 07:23:56 +0000 (GMT)
Subject: [Rd] A suggestion for an amendment to tapply
In-Reply-To: <B998A44C8986644EA8029CFE6396A924D895A4@exqld2-bne.nexus.csiro.au>
References: <20071106051028.GW71568@ms.unimelb.edu.au>
	<B998A44C8986644EA8029CFE6396A924D895A4@exqld2-bne.nexus.csiro.au>
Message-ID: <Pine.LNX.4.64.0711060712300.18034@gannet.stats.ox.ac.uk>

On Tue, 6 Nov 2007, Bill.Venables at csiro.au wrote:

> Unfortunately I think it would break too much existing code.  tapply()
> is an old function and many people have gotten used to the way it works
> now.

It is also not necessarily desirable: FUN(numeric(0)) might be an error.
For example:

> Z <- data.frame(x=rnorm(10), f=rep(c("a", "b"), each=5))[1:5, ]
> tapply(Z$x, Z$f, sd)

but sd(numeric(0)) is an error.  (Similar things involving var are 'in the 
wild' and so would be broken.)

> This is not to suggest there could not be another argument added at the
> end to indicate that you want the new behaviour, though.  e.g.
>
> tapply <- function (X, INDEX, FUN=NULL, ..., simplify=TRUE,
> handle.empty.levels = FALSE)
>
> but this raises the question of what sort of time penalty the
> modification might entail.  Probably not much for most situations, I
> suppose.  (I know this argument name looks long, but you do need a
> fairly specific argument name, or it will start to impinge on the ...
> argument.)
>
> Just some thoughts.
>
> Bill Venables.
>
> Bill Venables
> CSIRO Laboratories
> PO Box 120, Cleveland, 4163
> AUSTRALIA
> Office Phone (email preferred): +61 7 3826 7251
> Fax (if absolutely necessary):  +61 7 3826 7304
> Mobile:                         +61 4 8819 4402
> Home Phone:                     +61 7 3286 7700
> mailto:Bill.Venables at csiro.au
> http://www.cmis.csiro.au/bill.venables/
>
> -----Original Message-----
> From: r-devel-bounces at r-project.org
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Andrew Robinson
> Sent: Tuesday, 6 November 2007 3:10 PM
> To: R-Devel
> Subject: [Rd] A suggestion for an amendment to tapply
>
> Dear R-developers,
>
> when tapply() is invoked on factors that have empty levels, it returns
> NA.  This behaviour is in accord with the tapply documentation, and is
> reasonable in many cases.  However, when FUN is sum, it would also
> seem reasonable to return 0 instead of NA, because "the sum of an
> empty set is zero, by definition."
>
> I'd like to raise a discussion of the possibility of an amendment to
> tapply.
>
> The attached patch changes the function so that it checks if there are
> any empty levels, and if there are, replaces the corresponding NA
> values with the result of applying FUN to the empty set.  Eg in the
> case of sum, it replaces the NA with 0, whereas with mean, it replaces
> the NA with NA, and issues a warning.
>
> This change has the following advantage: tapply and sum work better
> together.  Arguably, tapply and any other function that has a non-NA
> response to the empty set will also work better together.
> Furthermore, tapply shows a warning if FUN would normally show a
> warning upon being evaluated on an empty set.  That deviates from
> current behaviour, which might be bad, but also provides information
> that might be useful to the user, so that would be good.
>
> The attached script provides the new function in full, and
> demonstrates its application in some simple test cases.
>
> Best wishes,
>
> Andrew
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From r.turner at auckland.ac.nz  Mon Nov  5 22:59:32 2007
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Tue, 6 Nov 2007 10:59:32 +1300
Subject: [Rd] Hmisc for Mac OSX.
Message-ID: <04C9311E-2035-45E7-824C-9F0827A79932@auckland.ac.nz>


I'm not sure if this is the right target to which to direct this post,
but I couldn't think of anything more appropriate.

I just downloaded the Hmisc package to the Imac that I use.  When I  
attempted
to load it I got an error to the effect that it could not load the  
library:

/Library/Frameworks/R.framework/Versions/2.5/Resources/lib/ 
libgfortran.2.dylib

Note the ``2.5'' in the foregoing path name; I am currently running  
2.6.0, and
I suspect that this is the problem --- i.e. the Mac binary on CRAN  
was built
under 2.5.x and this does not work with 2.6.y.

I note that the source and Windoze Hmisc packages are designated as  
3.4-3, but
the Mac package is designated as 3.4-2 which would appear to imply  
that it's
a step behind.

Could the Mac binary be updated please?  Thanks.

		cheers,

			Rolf Turner


######################################################################
Attention:\ This e-mail message is privileged and confid...{{dropped:9}}


From dajmcdon at gmail.com  Tue Nov  6 02:18:46 2007
From: dajmcdon at gmail.com (Daniel McDonald)
Date: Mon, 5 Nov 2007 20:18:46 -0500
Subject: [Rd] Mac OS X Leopard and C compiling
In-Reply-To: <8fa142710711051710g5d6221e5i1b1e4b593230fdb9@mail.gmail.com>
References: <8fa142710711051710g5d6221e5i1b1e4b593230fdb9@mail.gmail.com>
Message-ID: <8fa142710711051718y66889080u8dc4e6ce61e2d64f@mail.gmail.com>

I recently bought a new Intel Mac with OSX Leopard. I reinstalled the
latest version of R and the Xcode tools. I'm trying to compile a C
source code with the R compiler in X11, and I receive the following
error message:

[Macintosh:School Work 07-08/36-711/HW 3] dajmcdon% R CMD SHLIB McDonaldHW3.c
gcc-4.0 -arch i386 -isysroot /Developer/SDKs/MacOSX10.4u.sdk
-std=gnu99 -no-cpp-precomp
-I/Library/Frameworks/R.framework/Resources/include
-I/Library/Frameworks/R.framework/Resources/include/i386  -msse3
-fPIC  -g -O2 -march=nocona -c McDonaldHW3.c -o McDonaldHW3.o
gcc-4.0 -arch i386 -isysroot /Developer/SDKs/MacOSX10.4u.sdk
-std=gnu99 -dynamiclib -Wl,-headerpad_max_install_names
-Wl,-macosx_version_min -Wl,10.3 -undefined dynamic_lookup
-single_module -multiply_defined suppress -L/usr/local/lib -o
McDonaldHW3.so McDonaldHW3.o   -F/Library/Frameworks/R.framework/..
-framework R
ld: library not found for -ldylib1.10.5.o
collect2: ld returned 1 exit status
make: *** [McDonaldHW3.so] Error 1

McDonaldHW3.c is the code I am trying to compile. It works fine on my
old machine but not on the new one. Any ideas?

Thanks,
Daniel


From kjbeath at kagi.com  Tue Nov  6 10:38:11 2007
From: kjbeath at kagi.com (Ken Beath)
Date: Tue, 6 Nov 2007 20:38:11 +1100
Subject: [Rd] Hmisc for Mac OSX.
In-Reply-To: <04C9311E-2035-45E7-824C-9F0827A79932@auckland.ac.nz>
References: <04C9311E-2035-45E7-824C-9F0827A79932@auckland.ac.nz>
Message-ID: <8E7EAF1E-F5C9-435A-BC81-7E7EB2C3C18E@kagi.com>

On 06/11/2007, at 8:59 AM, Rolf Turner wrote:

>
> I'm not sure if this is the right target to which to direct this post,
> but I couldn't think of anything more appropriate.
>

R-Sig-Mac https://stat.ethz.ch/mailman/listinfo/r-sig-mac is for mac  
specific problems

> I just downloaded the Hmisc package to the Imac that I use.  When I
> attempted
> to load it I got an error to the effect that it could not load the
> library:
>
> /Library/Frameworks/R.framework/Versions/2.5/Resources/lib/
> libgfortran.2.dylib
>
> Note the ``2.5'' in the foregoing path name; I am currently running
> 2.6.0, and
> I suspect that this is the problem --- i.e. the Mac binary on CRAN
> was built
> under 2.5.x and this does not work with 2.6.y.
>
> I note that the source and Windoze Hmisc packages are designated as
> 3.4-3, but
> the Mac package is designated as 3.4-2 which would appear to imply
> that it's
> a step behind.
>
> Could the Mac binary be updated please?  Thanks.
>

The mac binary at central CRAN is a t3.4-3, so it is probably a mirror  
problem,  CRAN works for me, but uni of melbourne has the old Hmisc,  
but it works under 2.6 anyway.

Ken


From simon.urbanek at r-project.org  Tue Nov  6 14:32:51 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 6 Nov 2007 08:32:51 -0500
Subject: [Rd] Hmisc for Mac OSX.
In-Reply-To: <04C9311E-2035-45E7-824C-9F0827A79932@auckland.ac.nz>
References: <04C9311E-2035-45E7-824C-9F0827A79932@auckland.ac.nz>
Message-ID: <93DAC05B-C227-4200-B8B1-1D21535C59B7@r-project.org>

Rolf,

On Nov 5, 2007, at 4:59 PM, Rolf Turner wrote:

> I'm not sure if this is the right target to which to direct this  
> post, but I couldn't think of anything more appropriate.
>

R-SIG-Mac, but preferably *after* you read the documentation.


> I just downloaded the Hmisc package to the Imac that I use.  When  
> I  attempted
> to load it I got an error to the effect that it could not load  
> the   library:
>
> /Library/Frameworks/R.framework/Versions/2.5/Resources/lib/ 
> libgfortran.2.dylib
>
> Note the ``2.5'' in the foregoing path name;


You are using the wrong package. It is highly likely that you're  
using custom lib path which contains old packages from your previous  
R version (see .libPaths). Please make sure you either use the  
default setup or if using custom setup you clean up your old packages  
(of install new ones in the right place).


> I am currently running  2.6.0, and I suspect that this is the  
> problem --- i.e. the Mac binary on CRAN  was built under 2.5.x and  
> this does not work with 2.6.y.
>

Hmisc binary for R 2.5.x was built under R 2.5.1. Hmisc binary for R  
2.6.0 was built under 2.6.0 - that's why there are separate  
directories for each R version.


> I note that the source and Windoze Hmisc packages are designated  
> as  3.4-3, but the Mac package is designated as 3.4-2 which would  
> appear to imply that it's a step behind.
>

I'm not quite sure I follow you,
 > available.packages()["Hmisc",]
                                                       Package
                                                       "Hmisc"
                                                       Version
                                                       "3.4-3"
[...]
                                                    Repository
"http://www.stathy.com/cran/bin/macosx/universal/contrib/2.6"

Cheers,
Simon


From simon.urbanek at r-project.org  Tue Nov  6 14:35:04 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 6 Nov 2007 08:35:04 -0500
Subject: [Rd] Mac OS X Leopard and C compiling
In-Reply-To: <8fa142710711051718y66889080u8dc4e6ce61e2d64f@mail.gmail.com>
References: <8fa142710711051710g5d6221e5i1b1e4b593230fdb9@mail.gmail.com>
	<8fa142710711051718y66889080u8dc4e6ce61e2d64f@mail.gmail.com>
Message-ID: <F29BF2F1-10E2-4686-A09F-4754C2114472@r-project.org>

Daniel,

please read R-SIG-Mac, it has all the details on Leopard support.  
There are several different fixes for this, possibly the easiest for  
you:
PKG_LIBS="-mmacosx-version-min=10.4" R CMD SHLIB ...

Cheers,
Simon

On Nov 5, 2007, at 8:18 PM, Daniel McDonald wrote:

> I recently bought a new Intel Mac with OSX Leopard. I reinstalled the
> latest version of R and the Xcode tools. I'm trying to compile a C
> source code with the R compiler in X11, and I receive the following
> error message:
>
> [Macintosh:School Work 07-08/36-711/HW 3] dajmcdon% R CMD SHLIB  
> McDonaldHW3.c
> gcc-4.0 -arch i386 -isysroot /Developer/SDKs/MacOSX10.4u.sdk
> -std=gnu99 -no-cpp-precomp
> -I/Library/Frameworks/R.framework/Resources/include
> -I/Library/Frameworks/R.framework/Resources/include/i386  -msse3
> -fPIC  -g -O2 -march=nocona -c McDonaldHW3.c -o McDonaldHW3.o
> gcc-4.0 -arch i386 -isysroot /Developer/SDKs/MacOSX10.4u.sdk
> -std=gnu99 -dynamiclib -Wl,-headerpad_max_install_names
> -Wl,-macosx_version_min -Wl,10.3 -undefined dynamic_lookup
> -single_module -multiply_defined suppress -L/usr/local/lib -o
> McDonaldHW3.so McDonaldHW3.o   -F/Library/Frameworks/R.framework/..
> -framework R
> ld: library not found for -ldylib1.10.5.o
> collect2: ld returned 1 exit status
> make: *** [McDonaldHW3.so] Error 1
>
> McDonaldHW3.c is the code I am trying to compile. It works fine on my
> old machine but not on the new one. Any ideas?
>
> Thanks,
> Daniel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From Jane_Harvill at Baylor.Edu  Tue Nov  6 16:05:04 2007
From: Jane_Harvill at Baylor.Edu (Jane_Harvill at Baylor.Edu)
Date: Tue,  6 Nov 2007 16:05:04 +0100 (CET)
Subject: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
Message-ID: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>

Full_Name: Jane L. Harvill
Version: 2.6.0
OS: Microsoft Windows XP Professional, Version 2002, Service Pack 2
Submission from: (NULL) (129.62.21.93)


PROBLEM: The ability to save the contents of an R Graphics window as a
postscript or PDf file through the drop-down menu (File -> Save As ->
Postscript, or File -> Save As -> PDF) results in the error message below being
printed to the R Console.

ERROR MESSAGE:
-----------------------------------------------------------------
Error: Invalid font type
In addition: Warning messages:
1: font family not found in PostScript font database 
2: font family not found in PostScript font database
> >
-----------------------------------------------------------------

TO RECREATE THE PROBLEM:
1.  Using the R Console, create some graph in R; for example, plot(rnorm(100)).
2.  Select File -> Save As -> PostScript  (or File -> Save As -> PDF).
3.  Supply a file name and click the "Save" button.

FOUR OTHER RELEVANT NOTES:  
1.  I checked to see if the same error results when invoking the functions
pdf(file=...) or postscript(file=...).   No error results, and the content of
the output (.ps or .pdf) file produces a duplicate of what appears in the R
Graphics window.

2.  I checked, but did not see any other bug reports in the system that are
relevant to this problem.

3.  Before I submitted this R Bug Report, I reinstalled the PostScript fonts,
and then reinstalled R Version 2.6.0.  This did not change the outcome.

4.  This problem did not exist in previous versions of R on any of my computers.
 It exists on all computers for version 2.6.0 of R.


From ligges at statistik.uni-dortmund.de  Tue Nov  6 16:54:28 2007
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Tue, 06 Nov 2007 16:54:28 +0100
Subject: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
In-Reply-To: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>
References: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>
Message-ID: <47308E34.6030901@statistik.uni-dortmund.de>

This has been reported several times before and has been fixed in 
R-patched some weeks ago.

Uwe Ligges


Jane_Harvill at Baylor.Edu wrote:
> Full_Name: Jane L. Harvill
> Version: 2.6.0
> OS: Microsoft Windows XP Professional, Version 2002, Service Pack 2
> Submission from: (NULL) (129.62.21.93)
> 
> 
> PROBLEM: The ability to save the contents of an R Graphics window as a
> postscript or PDf file through the drop-down menu (File -> Save As ->
> Postscript, or File -> Save As -> PDF) results in the error message below being
> printed to the R Console.
> 
> ERROR MESSAGE:
> -----------------------------------------------------------------
> Error: Invalid font type
> In addition: Warning messages:
> 1: font family not found in PostScript font database 
> 2: font family not found in PostScript font database
> -----------------------------------------------------------------
> 
> TO RECREATE THE PROBLEM:
> 1.  Using the R Console, create some graph in R; for example, plot(rnorm(100)).
> 2.  Select File -> Save As -> PostScript  (or File -> Save As -> PDF).
> 3.  Supply a file name and click the "Save" button.
> 
> FOUR OTHER RELEVANT NOTES:  
> 1.  I checked to see if the same error results when invoking the functions
> pdf(file=...) or postscript(file=...).   No error results, and the content of
> the output (.ps or .pdf) file produces a duplicate of what appears in the R
> Graphics window.
> 
> 2.  I checked, but did not see any other bug reports in the system that are
> relevant to this problem.
> 
> 3.  Before I submitted this R Bug Report, I reinstalled the PostScript fonts,
> and then reinstalled R Version 2.6.0.  This did not change the outcome.
> 
> 4.  This problem did not exist in previous versions of R on any of my computers.
>  It exists on all computers for version 2.6.0 of R.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From sgiannerini at gmail.com  Tue Nov  6 16:59:48 2007
From: sgiannerini at gmail.com (Simone Giannerini)
Date: Tue, 6 Nov 2007 16:59:48 +0100
Subject: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
In-Reply-To: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>
References: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>
Message-ID: <3c12769c0711060759t1c12c4d8ie3bb1d3eb308b075@mail.gmail.com>

I have experienced the same behaviour (intermittently) on two
different WinXP machines.
Also savePlot() appears to be affected but not postscript() nor pdf()
as you mentioned.



On 11/6/07, Jane_Harvill at baylor.edu <Jane_Harvill at baylor.edu> wrote:
> Full_Name: Jane L. Harvill
> Version: 2.6.0
> OS: Microsoft Windows XP Professional, Version 2002, Service Pack 2
> Submission from: (NULL) (129.62.21.93)
>
>
> PROBLEM: The ability to save the contents of an R Graphics window as a
> postscript or PDf file through the drop-down menu (File -> Save As ->
> Postscript, or File -> Save As -> PDF) results in the error message below being
> printed to the R Console.
>
> ERROR MESSAGE:
> -----------------------------------------------------------------
> Error: Invalid font type
> In addition: Warning messages:
> 1: font family not found in PostScript font database
> 2: font family not found in PostScript font database
> > >
> -----------------------------------------------------------------
>
> TO RECREATE THE PROBLEM:
> 1.  Using the R Console, create some graph in R; for example, plot(rnorm(100)).
> 2.  Select File -> Save As -> PostScript  (or File -> Save As -> PDF).
> 3.  Supply a file name and click the "Save" button.
>
> FOUR OTHER RELEVANT NOTES:
> 1.  I checked to see if the same error results when invoking the functions
> pdf(file=...) or postscript(file=...).   No error results, and the content of
> the output (.ps or .pdf) file produces a duplicate of what appears in the R
> Graphics window.
>
> 2.  I checked, but did not see any other bug reports in the system that are
> relevant to this problem.
>
> 3.  Before I submitted this R Bug Report, I reinstalled the PostScript fonts,
> and then reinstalled R Version 2.6.0.  This did not change the outcome.
>
> 4.  This problem did not exist in previous versions of R on any of my computers.
>  It exists on all computers for version 2.6.0 of R.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
______________________________________________________

Simone Giannerini
Dipartimento di Scienze Statistiche "Paolo Fortunati"
Universita' di Bologna
Via delle belle arti 41 - 40126  Bologna,  ITALY
Tel: +39 051 2098262  Fax: +39 051 232153
http://www2.stat.unibo.it/giannerini/


From sgiannerini at gmail.com  Tue Nov  6 17:13:57 2007
From: sgiannerini at gmail.com (Simone Giannerini)
Date: Tue, 6 Nov 2007 17:13:57 +0100
Subject: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
In-Reply-To: <47308E34.6030901@statistik.uni-dortmund.de>
References: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>
	<47308E34.6030901@statistik.uni-dortmund.de>
Message-ID: <3c12769c0711060813r11cd1848o466af0b2ea72b05f@mail.gmail.com>

I looked at the list of bug fixes before writing and I found that the
only thing close to it is this

 o	postscript() was not always ignoring .Postscript.Options in
	the workspace (where it should not have occurred).

but I must admit I did not understand whether it had anything to do
with this bug report.

Thanks

Simone

On 11/6/07, Uwe Ligges <ligges at statistik.uni-dortmund.de> wrote:
> This has been reported several times before and has been fixed in
> R-patched some weeks ago.
>
> Uwe Ligges
>
>
> Jane_Harvill at Baylor.Edu wrote:
> > Full_Name: Jane L. Harvill
> > Version: 2.6.0
> > OS: Microsoft Windows XP Professional, Version 2002, Service Pack 2
> > Submission from: (NULL) (129.62.21.93)
> >
> >
> > PROBLEM: The ability to save the contents of an R Graphics window as a
> > postscript or PDf file through the drop-down menu (File -> Save As ->
> > Postscript, or File -> Save As -> PDF) results in the error message below being
> > printed to the R Console.
> >
> > ERROR MESSAGE:
> > -----------------------------------------------------------------
> > Error: Invalid font type
> > In addition: Warning messages:
> > 1: font family not found in PostScript font database
> > 2: font family not found in PostScript font database
> > -----------------------------------------------------------------
> >
> > TO RECREATE THE PROBLEM:
> > 1.  Using the R Console, create some graph in R; for example, plot(rnorm(100)).
> > 2.  Select File -> Save As -> PostScript  (or File -> Save As -> PDF).
> > 3.  Supply a file name and click the "Save" button.
> >
> > FOUR OTHER RELEVANT NOTES:
> > 1.  I checked to see if the same error results when invoking the functions
> > pdf(file=...) or postscript(file=...).   No error results, and the content of
> > the output (.ps or .pdf) file produces a duplicate of what appears in the R
> > Graphics window.
> >
> > 2.  I checked, but did not see any other bug reports in the system that are
> > relevant to this problem.
> >
> > 3.  Before I submitted this R Bug Report, I reinstalled the PostScript fonts,
> > and then reinstalled R Version 2.6.0.  This did not change the outcome.
> >
> > 4.  This problem did not exist in previous versions of R on any of my computers.
> >  It exists on all computers for version 2.6.0 of R.
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


-- 
______________________________________________________

Simone Giannerini
Dipartimento di Scienze Statistiche "Paolo Fortunati"
Universita' di Bologna
Via delle belle arti 41 - 40126  Bologna,  ITALY
Tel: +39 051 2098262  Fax: +39 051 232153
http://www2.stat.unibo.it/giannerini/


From ripley at stats.ox.ac.uk  Tue Nov  6 17:15:20 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Tue,  6 Nov 2007 17:15:20 +0100 (CET)
Subject: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
Message-ID: <20071106161520.5FFE32834616@mail.pubhealth.ku.dk>

This has been discussed extensively on R-help (with a workaround), and is 
already fixed in R-patched.

On Tue, 6 Nov 2007, Jane_Harvill at baylor.edu wrote:

> Full_Name: Jane L. Harvill
> Version: 2.6.0
> OS: Microsoft Windows XP Professional, Version 2002, Service Pack 2
> Submission from: (NULL) (129.62.21.93)
>
>
> PROBLEM: The ability to save the contents of an R Graphics window as a
> postscript or PDf file through the drop-down menu (File -> Save As ->
> Postscript, or File -> Save As -> PDF) results in the error message below being
> printed to the R Console.
>
> ERROR MESSAGE:
> -----------------------------------------------------------------
> Error: Invalid font type
> In addition: Warning messages:
> 1: font family not found in PostScript font database
> 2: font family not found in PostScript font database
>>>
> -----------------------------------------------------------------
>
> TO RECREATE THE PROBLEM:
> 1.  Using the R Console, create some graph in R; for example, plot(rnorm(100)).
> 2.  Select File -> Save As -> PostScript  (or File -> Save As -> PDF).
> 3.  Supply a file name and click the "Save" button.
>
> FOUR OTHER RELEVANT NOTES:
> 1.  I checked to see if the same error results when invoking the functions
> pdf(file=...) or postscript(file=...).   No error results, and the content of
> the output (.ps or .pdf) file produces a duplicate of what appears in the R
> Graphics window.

And once you do that, the menus work.

> 2.  I checked, but did not see any other bug reports in the system that are
> relevant to this problem.
>
> 3.  Before I submitted this R Bug Report, I reinstalled the PostScript fonts,
> and then reinstalled R Version 2.6.0.  This did not change the outcome.
>
> 4.  This problem did not exist in previous versions of R on any of my computers.
> It exists on all computers for version 2.6.0 of R.

Only on Windows ....

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Tue Nov  6 17:41:53 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 6 Nov 2007 16:41:53 +0000 (GMT)
Subject: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
In-Reply-To: <3c12769c0711060813r11cd1848o466af0b2ea72b05f@mail.gmail.com>
References: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>
	<47308E34.6030901@statistik.uni-dortmund.de>
	<3c12769c0711060813r11cd1848o466af0b2ea72b05f@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0711061637370.13662@gannet.stats.ox.ac.uk>

On Tue, 6 Nov 2007, Simone Giannerini wrote:

> I looked at the list of bug fixes before writing and I found that the
> only thing close to it is this
>
> o	postscript() was not always ignoring .Postscript.Options in
> 	the workspace (where it should not have occurred).
>
> but I must admit I did not understand whether it had anything to do
> with this bug report.

It occurs on Windows only, and the src/gnuwin32/CHANGES file says

BUG FIXES

     o   Saving a plot to Postscript or PDF required the font database
         to have been initialized: this is now done if necessary.

See also

https://mailman.stat.ethz.ch/pipermail/r-help/2007-October/142414.html

(over a month ago).

>
> Thanks
>
> Simone
>
> On 11/6/07, Uwe Ligges <ligges at statistik.uni-dortmund.de> wrote:
>> This has been reported several times before and has been fixed in
>> R-patched some weeks ago.
>>
>> Uwe Ligges
>>
>>
>> Jane_Harvill at Baylor.Edu wrote:
>>> Full_Name: Jane L. Harvill
>>> Version: 2.6.0
>>> OS: Microsoft Windows XP Professional, Version 2002, Service Pack 2
>>> Submission from: (NULL) (129.62.21.93)
>>>
>>>
>>> PROBLEM: The ability to save the contents of an R Graphics window as a
>>> postscript or PDf file through the drop-down menu (File -> Save As ->
>>> Postscript, or File -> Save As -> PDF) results in the error message below being
>>> printed to the R Console.
>>>
>>> ERROR MESSAGE:
>>> -----------------------------------------------------------------
>>> Error: Invalid font type
>>> In addition: Warning messages:
>>> 1: font family not found in PostScript font database
>>> 2: font family not found in PostScript font database
>>> -----------------------------------------------------------------
>>>
>>> TO RECREATE THE PROBLEM:
>>> 1.  Using the R Console, create some graph in R; for example, plot(rnorm(100)).
>>> 2.  Select File -> Save As -> PostScript  (or File -> Save As -> PDF).
>>> 3.  Supply a file name and click the "Save" button.
>>>
>>> FOUR OTHER RELEVANT NOTES:
>>> 1.  I checked to see if the same error results when invoking the functions
>>> pdf(file=...) or postscript(file=...).   No error results, and the content of
>>> the output (.ps or .pdf) file produces a duplicate of what appears in the R
>>> Graphics window.
>>>
>>> 2.  I checked, but did not see any other bug reports in the system that are
>>> relevant to this problem.
>>>
>>> 3.  Before I submitted this R Bug Report, I reinstalled the PostScript fonts,
>>> and then reinstalled R Version 2.6.0.  This did not change the outcome.
>>>
>>> 4.  This problem did not exist in previous versions of R on any of my computers.
>>>  It exists on all computers for version 2.6.0 of R.
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From sgiannerini at gmail.com  Tue Nov  6 18:47:22 2007
From: sgiannerini at gmail.com (Simone Giannerini)
Date: Tue, 6 Nov 2007 18:47:22 +0100
Subject: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
In-Reply-To: <Pine.LNX.4.64.0711061637370.13662@gannet.stats.ox.ac.uk>
References: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>
	<47308E34.6030901@statistik.uni-dortmund.de>
	<3c12769c0711060813r11cd1848o466af0b2ea72b05f@mail.gmail.com>
	<Pine.LNX.4.64.0711061637370.13662@gannet.stats.ox.ac.uk>
Message-ID: <3c12769c0711060947o3e7ada11hf5156314f48923bc@mail.gmail.com>

Thank you,

I am sorry for my positive contribution to the entropy of R lists ...
I missed the fact that somewhere there is a separate list of Windows
specific bug fixes.
Maybe it would be useful that this list be put in evidence close to
the other one.

Kind regards

Simone


On 11/6/07, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> On Tue, 6 Nov 2007, Simone Giannerini wrote:
>
> > I looked at the list of bug fixes before writing and I found that the
> > only thing close to it is this
> >
> > o     postscript() was not always ignoring .Postscript.Options in
> >       the workspace (where it should not have occurred).
> >
> > but I must admit I did not understand whether it had anything to do
> > with this bug report.
>
> It occurs on Windows only, and the src/gnuwin32/CHANGES file says
>
> BUG FIXES
>
>      o   Saving a plot to Postscript or PDF required the font database
>          to have been initialized: this is now done if necessary.
>
> See also
>
> https://mailman.stat.ethz.ch/pipermail/r-help/2007-October/142414.html
>
> (over a month ago).
>
> >
> > Thanks
> >
> > Simone
> >
> > On 11/6/07, Uwe Ligges <ligges at statistik.uni-dortmund.de> wrote:
> >> This has been reported several times before and has been fixed in
> >> R-patched some weeks ago.
> >>
> >> Uwe Ligges
> >>
> >>
> >> Jane_Harvill at Baylor.Edu wrote:
> >>> Full_Name: Jane L. Harvill
> >>> Version: 2.6.0
> >>> OS: Microsoft Windows XP Professional, Version 2002, Service Pack 2
> >>> Submission from: (NULL) (129.62.21.93)
> >>>
> >>>
> >>> PROBLEM: The ability to save the contents of an R Graphics window as a
> >>> postscript or PDf file through the drop-down menu (File -> Save As ->
> >>> Postscript, or File -> Save As -> PDF) results in the error message below being
> >>> printed to the R Console.
> >>>
> >>> ERROR MESSAGE:
> >>> -----------------------------------------------------------------
> >>> Error: Invalid font type
> >>> In addition: Warning messages:
> >>> 1: font family not found in PostScript font database
> >>> 2: font family not found in PostScript font database
> >>> -----------------------------------------------------------------
> >>>
> >>> TO RECREATE THE PROBLEM:
> >>> 1.  Using the R Console, create some graph in R; for example, plot(rnorm(100)).
> >>> 2.  Select File -> Save As -> PostScript  (or File -> Save As -> PDF).
> >>> 3.  Supply a file name and click the "Save" button.
> >>>
> >>> FOUR OTHER RELEVANT NOTES:
> >>> 1.  I checked to see if the same error results when invoking the functions
> >>> pdf(file=...) or postscript(file=...).   No error results, and the content of
> >>> the output (.ps or .pdf) file produces a duplicate of what appears in the R
> >>> Graphics window.
> >>>
> >>> 2.  I checked, but did not see any other bug reports in the system that are
> >>> relevant to this problem.
> >>>
> >>> 3.  Before I submitted this R Bug Report, I reinstalled the PostScript fonts,
> >>> and then reinstalled R Version 2.6.0.  This did not change the outcome.
> >>>
> >>> 4.  This problem did not exist in previous versions of R on any of my computers.
> >>>  It exists on all computers for version 2.6.0 of R.
> >>>
> >>> ______________________________________________
> >>> R-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>
> >
> >
> >
>
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>


-- 
______________________________________________________

Simone Giannerini
Dipartimento di Scienze Statistiche "Paolo Fortunati"
Universita' di Bologna
Via delle belle arti 41 - 40126  Bologna,  ITALY
Tel: +39 051 2098262  Fax: +39 051 232153
http://www2.stat.unibo.it/giannerini/


From p.dalgaard at biostat.ku.dk  Tue Nov  6 19:19:24 2007
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue, 06 Nov 2007 19:19:24 +0100
Subject: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
In-Reply-To: <3c12769c0711060947o3e7ada11hf5156314f48923bc@mail.gmail.com>
References: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>	<47308E34.6030901@statistik.uni-dortmund.de>	<3c12769c0711060813r11cd1848o466af0b2ea72b05f@mail.gmail.com>	<Pine.LNX.4.64.0711061637370.13662@gannet.stats.ox.ac.uk>
	<3c12769c0711060947o3e7ada11hf5156314f48923bc@mail.gmail.com>
Message-ID: <4730B02C.5010209@biostat.ku.dk>

Simone Giannerini wrote:
> Thank you,
>
> I am sorry for my positive contribution to the entropy of R lists ...
> I missed the fact that somewhere there is a separate list of Windows
> specific bug fixes.
>   
Well, shit happens... Never mind. Thanks for bothering in the first place.

> Maybe it would be useful that this list be put in evidence close to
> the other one.
>   
Maybe, but given the way things have been working lately, it might be 
better to emphasize

(a) check the mailinglists
(b) try R-patched
(c) if in doubt, ask, rather than report as bug

(Ideally, people would try the prerelease versions and problems like 
this would be caught before the actual release, but it seems that they 
prefer treating x.y.0 as a beta release...)

> Kind regards
>
> Simone
>   

>
> On 11/6/07, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
>   
>> On Tue, 6 Nov 2007, Simone Giannerini wrote:
>>
>>     
>>> I looked at the list of bug fixes before writing and I found that the
>>> only thing close to it is this
>>>
>>> o     postscript() was not always ignoring .Postscript.Options in
>>>       the workspace (where it should not have occurred).
>>>
>>> but I must admit I did not understand whether it had anything to do
>>> with this bug report.
>>>       
>> It occurs on Windows only, and the src/gnuwin32/CHANGES file says
>>
>> BUG FIXES
>>
>>      o   Saving a plot to Postscript or PDF required the font database
>>          to have been initialized: this is now done if necessary.
>>
>> See also
>>
>> https://mailman.stat.ethz.ch/pipermail/r-help/2007-October/142414.html
>>
>> (over a month ago).
>>
>>     
>>> Thanks
>>>
>>> Simone
>>>
>>> On 11/6/07, Uwe Ligges <ligges at statistik.uni-dortmund.de> wrote:
>>>       
>>>> This has been reported several times before and has been fixed in
>>>> R-patched some weeks ago.
>>>>
>>>> Uwe Ligges
>>>>
>>>>
>>>> Jane_Harvill at Baylor.Edu wrote:
>>>>         
>>>>> Full_Name: Jane L. Harvill
>>>>> Version: 2.6.0
>>>>> OS: Microsoft Windows XP Professional, Version 2002, Service Pack 2
>>>>> Submission from: (NULL) (129.62.21.93)
>>>>>
>>>>>
>>>>> PROBLEM: The ability to save the contents of an R Graphics window as a
>>>>> postscript or PDf file through the drop-down menu (File -> Save As ->
>>>>> Postscript, or File -> Save As -> PDF) results in the error message below being
>>>>> printed to the R Console.
>>>>>
>>>>> ERROR MESSAGE:
>>>>> -----------------------------------------------------------------
>>>>> Error: Invalid font type
>>>>> In addition: Warning messages:
>>>>> 1: font family not found in PostScript font database
>>>>> 2: font family not found in PostScript font database
>>>>> -----------------------------------------------------------------
>>>>>
>>>>> TO RECREATE THE PROBLEM:
>>>>> 1.  Using the R Console, create some graph in R; for example, plot(rnorm(100)).
>>>>> 2.  Select File -> Save As -> PostScript  (or File -> Save As -> PDF).
>>>>> 3.  Supply a file name and click the "Save" button.
>>>>>
>>>>> FOUR OTHER RELEVANT NOTES:
>>>>> 1.  I checked to see if the same error results when invoking the functions
>>>>> pdf(file=...) or postscript(file=...).   No error results, and the content of
>>>>> the output (.ps or .pdf) file produces a duplicate of what appears in the R
>>>>> Graphics window.
>>>>>
>>>>> 2.  I checked, but did not see any other bug reports in the system that are
>>>>> relevant to this problem.
>>>>>
>>>>> 3.  Before I submitted this R Bug Report, I reinstalled the PostScript fonts,
>>>>> and then reinstalled R Version 2.6.0.  This did not change the outcome.
>>>>>
>>>>> 4.  This problem did not exist in previous versions of R on any of my computers.
>>>>>  It exists on all computers for version 2.6.0 of R.
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>           
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>         
>>>
>>>       
>> --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>
>>     
>
>
>   


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From h.wickham at gmail.com  Tue Nov  6 20:09:16 2007
From: h.wickham at gmail.com (hadley wickham)
Date: Tue, 6 Nov 2007 13:09:16 -0600
Subject: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
In-Reply-To: <4730B02C.5010209@biostat.ku.dk>
References: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>
	<47308E34.6030901@statistik.uni-dortmund.de>
	<3c12769c0711060813r11cd1848o466af0b2ea72b05f@mail.gmail.com>
	<Pine.LNX.4.64.0711061637370.13662@gannet.stats.ox.ac.uk>
	<3c12769c0711060947o3e7ada11hf5156314f48923bc@mail.gmail.com>
	<4730B02C.5010209@biostat.ku.dk>
Message-ID: <f8e6ff050711061109w4c16ba61q5fbc8f9145ed0e25@mail.gmail.com>

> (Ideally, people would try the prerelease versions and problems like
> this would be caught before the actual release, but it seems that they
> prefer treating x.y.0 as a beta release...)

The one time I did do this and complained about a change (trailing
commas now throw an error), no one responded.  But this is a rather
mild compared to the vitriolic response many (most?) "bug" reports
receive.

If you want people to report bugs, you need to provide a more
receptive atmosphere.

Hadley

-- 
http://had.co.nz/


From ripley at stats.ox.ac.uk  Tue Nov  6 21:26:54 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 6 Nov 2007 20:26:54 +0000 (GMT)
Subject: [Rd] [R] help needed: taking a function out of a package and it
 can not find some funtions
In-Reply-To: <987887.36154.qm@web53705.mail.re2.yahoo.com>
References: <987887.36154.qm@web53705.mail.re2.yahoo.com>
Message-ID: <Pine.LNX.4.64.0711062012270.23714@auk.stats>

I do wonder when you would consider something a programming question 
unsuitable for R-help?  See the posting guide.

At least my answer needs to be on R-devel.

On Tue, 6 Nov 2007, Jason Liao wrote:

>
> I tried to modify the R function bw.SJ (from the stats package) for my 
> own use. But if I just get the source code and run directly (without any 
> modification), it can no longer find some key functions called within 
> it.

That's not what I find.  The missing objects are not functions for me.

> I understand this has something to do with searching path which I do 
> not understand well. Can anyone tell me how to modify the source code of 
> an R function and still make it part of an existing package?

You don't want to do that.  The issue is being in the stats namespace, and 
if you need to ask how to add a function to that namespace, you don't know 
enough to be doing so.

You can get away (or at least, I did) with modifying the source of bw.SJ 
as follows:

     SDh <- function(x, h, n, d) .C(stats:::R_band_phi4_bin, as.integer(n),
         as.integer(length(x)), as.double(d), x, as.double(h),
         u = double(1))$u
     TDh <- function(x, h, n, d) .C(stats:::R_band_phi6_bin, as.integer(n),
         as.integer(length(x)), as.double(d), x, as.double(h),
         u = double(1))$u
     Z <- .C(stats:::R_band_den_bin, as.integer(n), as.integer(nb), d = double(1),
         x, cnt = integer(nb))

Alternatively, you don't need the function to be in the stats namespace, 
just to have the stats namespace as its environment. Again, that is 
something that is not recommended, but

environment(my.bw.SJ) <- environment(bw.SJ)

would do it.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From j.van_den_hoff at fzd.de  Tue Nov  6 21:55:05 2007
From: j.van_den_hoff at fzd.de (Joerg van den Hoff)
Date: Tue, 6 Nov 2007 21:55:05 +0100
Subject: [Rd] strange `nls' behaviour
Message-ID: <20071106205505.GI12352@kati.fz-rossendorf.de>

dear list,

I stumbled over the follwing strange behaviour/error when
using `nls' which I'm tempted (despite the implied "dangers")
to call a bug:

I've written a driver for `nls' which allows specifying the
model and the data vectors using arbitrary symbols.
these are internally mapped to consistent names, which
poses a slight complication when using `deriv' to provide
analytic derivatives. the following fragment gives the idea:
#-----------------------------------------
f <- function(n = 4) {

   x <- 1:n

   y <- 2 * exp(-1*x) + 2; 
   y <- rnorm(y,y, 0.01*y)

   model <- y ~ a * exp (-b*x) + c

   fitfunc <- deriv(model[[3]], c("a", "b", "c"), c("a", "b", "c", "x"))
   res1 <- nls(y ~ fitfunc(a, b, c, x), start = c(a=1, b=1, c=1))

   call.fitfunc <- 
   c(list(fitfunc), as.name("a"), as.name("b"), as.name("c"), as.name("x"))
   call.fitfunc <- as.call(call.fitfunc)
   frml <- as.formula("y ~ eval(call.fitfunc)")
   res2 <- nls(frml, start = c(a=1, b=1, c=1))

   list(res1 = res1, res2 = res2)
}
#-----------------------------------------

the first call to `nls' is the standard way of calling `nls'
when knowing all the names. the second call (yielding `res2')
uses a constructed formula in `frml' (which in this example
is of course not necessary, but in the general case 'a,b,c,x,y' are
not a priori known names).

here is the problem: the call

f(4)

using 4 data points
runs fine/consistently, as does every call with n > 5.

BUT: for n = 5 (i.e. issuing f(5))
the second fit leads to the error message:

"Error in model.frame(formula, rownames, variables, varnames, extras, extranames,  : 
	invalid type (language) for variable 'call.fitfunc'"

I cornered this to a spot in `nls' where a model frame is constructed in variable `mf'.
the parsing/constructing here seems simply to be messed up for n = 5: `call.fitfunc'
is interpreted as variable.

I, moreover, empirically noted that the problem occurs when the total number
of parameters plus dependent/independent variables equals the number of data points
(in the present example a,b,c,x,y).

so it is not the 'magic' number of 5 but rather the identity of data vector length
and number of variables in the model which leads to the problem.


this is with 2.5.0 (which hopefully is not considered ancient) and MacOSX 10.4.10.

any ideas?

thanks

joerg


From kamil at ualberta.ca  Wed Nov  7 00:30:26 2007
From: kamil at ualberta.ca (kamil Marcinkowski)
Date: Tue, 6 Nov 2007 16:30:26 -0700
Subject: [Rd] R 2.6.0 make check fails on SGI origin 350 and
Message-ID: <42665B36-6FE2-48A4-A1C4-09F67D61A28C@ualberta.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20071106/bb16feb2/attachment.pl 

From ripley at stats.ox.ac.uk  Wed Nov  7 00:46:34 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 6 Nov 2007 23:46:34 +0000 (GMT)
Subject: [Rd] R 2.6.0 make check fails on SGI origin 350 and
In-Reply-To: <42665B36-6FE2-48A4-A1C4-09F67D61A28C@ualberta.ca>
References: <42665B36-6FE2-48A4-A1C4-09F67D61A28C@ualberta.ca>
Message-ID: <Pine.LNX.4.64.0711062341250.30885@gannet.stats.ox.ac.uk>

We need to see the d-p-q-r-tests.Rout file, and perhaps ask for some more 
runs (unfortunately that line number is after massaging).  Can you make it 
available to us?  Or at least a portion containing the quoted line (which 
should only occur once)?

On Tue, 6 Nov 2007, kamil Marcinkowski wrote:

> Hello
>
> I am trying to install R 2.6.0 on a SGI Origin 350 running IRIX 6.5
> 6.5.28f
>
> R was configured with the following options:
>
>> --x-includes=/usr/include/X11
>> --x-libraries=/usr/lib/X11
>> --includedir=/usr/freeware/include
>> --includedir=/usr/freeware/lib32
>> --includedir=/usr/freeware/lib64
>> --with-readline=no
>> --with-iconv=no
>> CC=cc
>
>
> gmake complied successfully, however gmake check failed on d-p-q-r-
> tests.R .
>
>> running code in 'd-p-q-r-tests.R' ... OK
>> comparing 'd-p-q-r-tests.Rout' to './d-p-q-r-tests.Rout.save' ...
>> 959c959
>> < [1] "Mean scaled  difference: NaN"
>> ---
>>> [1] TRUE
>> gmake[3]: *** [d-p-q-r-tests.Rout] Error 1
>> gmake[3]: Leaving directory `/usr/global/R-build/R-2.6.0/tests'
>> gmake[2]: *** [test-Specific] Error 2
>> gmake[2]: Leaving directory `/usr/global/R-build/R-2.6.0/tests'
>> gmake[1]: *** [test-all-basics] Error 1
>> gmake[1]: Leaving directory `/usr/global/R-build/R-2.6.0/tests'
>> gmake: *** [check] Error 2
>
>
> Any ideas would be appreciated.
>
> Cheers,
>
> Kamil
>
> Kamil Marcinkowski                   Westgrid System Administrator
> kamil at ualberta.ca                     University of Alberta site
>  Tel.780 492-0354                     Research Computing Support
> Fax.780 492-1729                     Academic ICT
> Edmonton, Alberta, CANADA    University of Alberta
>
>
> "This communication is intended for the use of the recipient to which
> it is
> addressed, and may contain confidential, personal, and/or privileged
> information.  Please contact us immediately if you are not the intended
> recipient of this communication.  If you are not the intended
> recipient of
> this communication, do not copy, distribute, or take action on it. Any
> communication received in error, or subsequent reply, should be
> deleted or
> destroyed."
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From A.Robinson at ms.unimelb.edu.au  Wed Nov  7 02:43:46 2007
From: A.Robinson at ms.unimelb.edu.au (Andrew Robinson)
Date: Wed, 7 Nov 2007 12:43:46 +1100
Subject: [Rd] A suggestion for an amendment to tapply
In-Reply-To: <Pine.LNX.4.64.0711060712300.18034@gannet.stats.ox.ac.uk>
References: <20071106051028.GW71568@ms.unimelb.edu.au>
	<B998A44C8986644EA8029CFE6396A924D895A4@exqld2-bne.nexus.csiro.au>
	<Pine.LNX.4.64.0711060712300.18034@gannet.stats.ox.ac.uk>
Message-ID: <20071107014346.GK71568@ms.unimelb.edu.au>

These are important concerns.  It seems to me that adding an argument
as suggested by Bill will allow the user to side-step the problem
identified by Brian.

Bill, under what kinds of circumstances would you anticipate a
significant time penalty?  I would be happy to check those out with
some simulations.

If the timing seems acceptable, I can write a patch for tapply.R and
tapply.Rd if anyone in the core is willing to consider them.  Please
contact me on or off list if so.

Best wishes to all,

Andrew




On Tue, Nov 06, 2007 at 07:23:56AM +0000, Prof Brian Ripley wrote:
> On Tue, 6 Nov 2007, Bill.Venables at csiro.au wrote:
> 
> >Unfortunately I think it would break too much existing code.  tapply()
> >is an old function and many people have gotten used to the way it works
> >now.
> 
> It is also not necessarily desirable: FUN(numeric(0)) might be an error.
> For example:
> 
> >Z <- data.frame(x=rnorm(10), f=rep(c("a", "b"), each=5))[1:5, ]
> >tapply(Z$x, Z$f, sd)
> 
> but sd(numeric(0)) is an error.  (Similar things involving var are 'in the 
> wild' and so would be broken.)
> 
> >This is not to suggest there could not be another argument added at the
> >end to indicate that you want the new behaviour, though.  e.g.
> >
> >tapply <- function (X, INDEX, FUN=NULL, ..., simplify=TRUE,
> >handle.empty.levels = FALSE)
> >
> >but this raises the question of what sort of time penalty the
> >modification might entail.  Probably not much for most situations, I
> >suppose.  (I know this argument name looks long, but you do need a
> >fairly specific argument name, or it will start to impinge on the ...
> >argument.)
> >
> >Just some thoughts.
> >
> >Bill Venables.
> >
> >Bill Venables
> >CSIRO Laboratories
> >PO Box 120, Cleveland, 4163
> >AUSTRALIA
> >Office Phone (email preferred): +61 7 3826 7251
> >Fax (if absolutely necessary):  +61 7 3826 7304
> >Mobile:                         +61 4 8819 4402
> >Home Phone:                     +61 7 3286 7700
> >mailto:Bill.Venables at csiro.au
> >http://www.cmis.csiro.au/bill.venables/
> >
> >-----Original Message-----
> >From: r-devel-bounces at r-project.org
> >[mailto:r-devel-bounces at r-project.org] On Behalf Of Andrew Robinson
> >Sent: Tuesday, 6 November 2007 3:10 PM
> >To: R-Devel
> >Subject: [Rd] A suggestion for an amendment to tapply
> >
> >Dear R-developers,
> >
> >when tapply() is invoked on factors that have empty levels, it returns
> >NA.  This behaviour is in accord with the tapply documentation, and is
> >reasonable in many cases.  However, when FUN is sum, it would also
> >seem reasonable to return 0 instead of NA, because "the sum of an
> >empty set is zero, by definition."
> >
> >I'd like to raise a discussion of the possibility of an amendment to
> >tapply.
> >
> >The attached patch changes the function so that it checks if there are
> >any empty levels, and if there are, replaces the corresponding NA
> >values with the result of applying FUN to the empty set.  Eg in the
> >case of sum, it replaces the NA with 0, whereas with mean, it replaces
> >the NA with NA, and issues a warning.
> >
> >This change has the following advantage: tapply and sum work better
> >together.  Arguably, tapply and any other function that has a non-NA
> >response to the empty set will also work better together.
> >Furthermore, tapply shows a warning if FUN would normally show a
> >warning upon being evaluated on an empty set.  That deviates from
> >current behaviour, which might be bad, but also provides information
> >that might be useful to the user, so that would be good.
> >
> >The attached script provides the new function in full, and
> >demonstrates its application in some simple test cases.
> >
> >Best wishes,
> >
> >Andrew
> >
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-- 
Andrew Robinson  
Department of Mathematics and Statistics            Tel: +61-3-8344-9763
University of Melbourne, VIC 3010 Australia         Fax: +61-3-8344-4599
http://www.ms.unimelb.edu.au/~andrewpr
http://blogs.mbs.edu/fishing-in-the-bay/


From jli3 at ncsu.edu  Wed Nov  7 06:46:01 2007
From: jli3 at ncsu.edu (Jiangtian Li)
Date: Wed, 7 Nov 2007 00:46:01 -0500 (EST)
Subject: [Rd] problem in linking to libR.so with R 2.5.0
Message-ID: <40465.152.14.86.171.1194414361.squirrel@webmail.ncsu.edu>

Dear All,

I tried to write a C++ program that uses R internals and I encounter
"undefined reference" error when linking to libR.so. Here is an small
example of the program test.cpp:

extern "C" {
#include <config.h>
#include <IOStuff.h>

int main(int argc, char** argv)
{
  R_IoBufferInit(&R_ConsoleIob);
  return 0;
}
}

I built it using:
g++ -o test -I/dir/to/R-2.5.0/src/include -L/dir/to/R-2.5.0/lib/R/lib -lR
test.cpp

and I got the error message:

/tmp/cc4zxrqh.o(.text+0x20): In function `main':
test.cpp: undefined reference to `R_ConsoleIob'
/tmp/cc4zxrqh.o(.text+0x25):test.cpp: undefined reference to `R_IoBufferInit'
collect2: ld returned 1 exit status

I installed R 2.5.0 on Fedora Core 4 with gcc 4.0.2 and configured with
--prefix=/dir/to/R-2.5.0 --enable-R-shlib

I did that with R 2.2.1 and can build without problem. Any suggestion on
how to link to libR.so in later R versions? Your help is very appreciated.

Best regards,
Jiangtian


From ripley at stats.ox.ac.uk  Wed Nov  7 08:04:41 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 7 Nov 2007 07:04:41 +0000 (GMT)
Subject: [Rd] problem in linking to libR.so with R 2.5.0
In-Reply-To: <40465.152.14.86.171.1194414361.squirrel@webmail.ncsu.edu>
References: <40465.152.14.86.171.1194414361.squirrel@webmail.ncsu.edu>
Message-ID: <Pine.LNX.4.64.0711070700110.3462@gannet.stats.ox.ac.uk>

IOStuff.h is not a public header, and neither are the entry points within 
it.  See 'Writing R Extensions'.  One is in the category:

   Entry points that are where possible (Windows and some modern Unix
   compilers/loaders when using @R{} as a shared library) not exported.


On Wed, 7 Nov 2007, Jiangtian Li wrote:

> Dear All,
>
> I tried to write a C++ program that uses R internals and I encounter
> "undefined reference" error when linking to libR.so. Here is an small
> example of the program test.cpp:
>
> extern "C" {
> #include <config.h>
> #include <IOStuff.h>
>
> int main(int argc, char** argv)
> {
>  R_IoBufferInit(&R_ConsoleIob);
>  return 0;
> }
> }
>
> I built it using:
> g++ -o test -I/dir/to/R-2.5.0/src/include -L/dir/to/R-2.5.0/lib/R/lib -lR
> test.cpp

You need -I/dir/to/R-2.5.0/include to get the public headers.

> and I got the error message:
>
> /tmp/cc4zxrqh.o(.text+0x20): In function `main':
> test.cpp: undefined reference to `R_ConsoleIob'
> /tmp/cc4zxrqh.o(.text+0x25):test.cpp: undefined reference to `R_IoBufferInit'
> collect2: ld returned 1 exit status
>
> I installed R 2.5.0 on Fedora Core 4 with gcc 4.0.2 and configured with
> --prefix=/dir/to/R-2.5.0 --enable-R-shlib
>
> I did that with R 2.2.1 and can build without problem. Any suggestion on
> how to link to libR.so in later R versions? Your help is very appreciated.
>
> Best regards,
> Jiangtian
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From p.dalgaard at biostat.ku.dk  Wed Nov  7 08:15:17 2007
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed, 07 Nov 2007 08:15:17 +0100
Subject: [Rd] A suggestion for an amendment to tapply
In-Reply-To: <20071107014346.GK71568@ms.unimelb.edu.au>
References: <20071106051028.GW71568@ms.unimelb.edu.au>	<B998A44C8986644EA8029CFE6396A924D895A4@exqld2-bne.nexus.csiro.au>	<Pine.LNX.4.64.0711060712300.18034@gannet.stats.ox.ac.uk>
	<20071107014346.GK71568@ms.unimelb.edu.au>
Message-ID: <47316605.20503@biostat.ku.dk>

Andrew Robinson wrote:
> These are important concerns.  It seems to me that adding an argument
> as suggested by Bill will allow the user to side-step the problem
> identified by Brian.
>
> Bill, under what kinds of circumstances would you anticipate a
> significant time penalty?  I would be happy to check those out with
> some simulations.
>
> If the timing seems acceptable, I can write a patch for tapply.R and
> tapply.Rd if anyone in the core is willing to consider them.  Please
> contact me on or off list if so.
>
>   

There's another concern: tapply (et al.) has the ... args passed on to 
FUN which means that you have to be really careful with argument names.

Could I just interject that we already have

 > airquality$Month <- factor(airquality$Month,levels=4:9) # April not there
 > unlist(lapply(
+    split(airquality$Ozone, airquality$Month, drop=F),sum, na.rm=T))
   4    5    6    7    8    9
   0  614  265 1537 1559  912

(splitting on multiple factors gets a  bit involved, though)

> Best wishes to all,
>
> Andrew
>
>
>
>
> On Tue, Nov 06, 2007 at 07:23:56AM +0000, Prof Brian Ripley wrote:
>   
>> On Tue, 6 Nov 2007, Bill.Venables at csiro.au wrote:
>>
>>     
>>> Unfortunately I think it would break too much existing code.  tapply()
>>> is an old function and many people have gotten used to the way it works
>>> now.
>>>       
>> It is also not necessarily desirable: FUN(numeric(0)) might be an error.
>> For example:
>>
>>     
>>> Z <- data.frame(x=rnorm(10), f=rep(c("a", "b"), each=5))[1:5, ]
>>> tapply(Z$x, Z$f, sd)
>>>       
>> but sd(numeric(0)) is an error.  (Similar things involving var are 'in the 
>> wild' and so would be broken.)
>>
>>     
>>> This is not to suggest there could not be another argument added at the
>>> end to indicate that you want the new behaviour, though.  e.g.
>>>
>>> tapply <- function (X, INDEX, FUN=NULL, ..., simplify=TRUE,
>>> handle.empty.levels = FALSE)
>>>
>>> but this raises the question of what sort of time penalty the
>>> modification might entail.  Probably not much for most situations, I
>>> suppose.  (I know this argument name looks long, but you do need a
>>> fairly specific argument name, or it will start to impinge on the ...
>>> argument.)
>>>
>>> Just some thoughts.
>>>
>>> Bill Venables.
>>>
>>> Bill Venables
>>> CSIRO Laboratories
>>> PO Box 120, Cleveland, 4163
>>> AUSTRALIA
>>> Office Phone (email preferred): +61 7 3826 7251
>>> Fax (if absolutely necessary):  +61 7 3826 7304
>>> Mobile:                         +61 4 8819 4402
>>> Home Phone:                     +61 7 3286 7700
>>> mailto:Bill.Venables at csiro.au
>>> http://www.cmis.csiro.au/bill.venables/
>>>
>>> -----Original Message-----
>>> From: r-devel-bounces at r-project.org
>>> [mailto:r-devel-bounces at r-project.org] On Behalf Of Andrew Robinson
>>> Sent: Tuesday, 6 November 2007 3:10 PM
>>> To: R-Devel
>>> Subject: [Rd] A suggestion for an amendment to tapply
>>>
>>> Dear R-developers,
>>>
>>> when tapply() is invoked on factors that have empty levels, it returns
>>> NA.  This behaviour is in accord with the tapply documentation, and is
>>> reasonable in many cases.  However, when FUN is sum, it would also
>>> seem reasonable to return 0 instead of NA, because "the sum of an
>>> empty set is zero, by definition."
>>>
>>> I'd like to raise a discussion of the possibility of an amendment to
>>> tapply.
>>>
>>> The attached patch changes the function so that it checks if there are
>>> any empty levels, and if there are, replaces the corresponding NA
>>> values with the result of applying FUN to the empty set.  Eg in the
>>> case of sum, it replaces the NA with 0, whereas with mean, it replaces
>>> the NA with NA, and issues a warning.
>>>
>>> This change has the following advantage: tapply and sum work better
>>> together.  Arguably, tapply and any other function that has a non-NA
>>> response to the empty set will also work better together.
>>> Furthermore, tapply shows a warning if FUN would normally show a
>>> warning upon being evaluated on an empty set.  That deviates from
>>> current behaviour, which might be bad, but also provides information
>>> that might be useful to the user, so that would be good.
>>>
>>> The attached script provides the new function in full, and
>>> demonstrates its application in some simple test cases.
>>>
>>> Best wishes,
>>>
>>> Andrew
>>>
>>>       
>> -- 
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>     
>
>   


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From sgiannerini at gmail.com  Wed Nov  7 10:51:34 2007
From: sgiannerini at gmail.com (Simone Giannerini)
Date: Wed, 7 Nov 2007 10:51:34 +0100
Subject: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
In-Reply-To: <4730B02C.5010209@biostat.ku.dk>
References: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>
	<47308E34.6030901@statistik.uni-dortmund.de>
	<3c12769c0711060813r11cd1848o466af0b2ea72b05f@mail.gmail.com>
	<Pine.LNX.4.64.0711061637370.13662@gannet.stats.ox.ac.uk>
	<3c12769c0711060947o3e7ada11hf5156314f48923bc@mail.gmail.com>
	<4730B02C.5010209@biostat.ku.dk>
Message-ID: <3c12769c0711070151u18c95d9ch58a08780b4d232c1@mail.gmail.com>

[snip]
> Maybe, but given the way things have been working lately, it might be
> better to emphasize
>
> (a) check the mailinglists
> (b) try R-patched
> (c) if in doubt, ask, rather than report as bug
>
> (Ideally, people would try the prerelease versions and problems like
> this would be caught before the actual release, but it seems that they
> prefer treating x.y.0 as a beta release...)
>

I am sorry but I do not agree with point (b) for the very simple fact
that the average Windows user do not know how to compile the source
code and might not even want to learn how to do it. The point is that
since (if I am correct) the great majority of  R users go Windows you
would miss an important part of potential bug reports by requiring
point (b) whereas (a) and (c) would suffice IMHO.
Maybe if there were Win binaries of the prerelease version available
some time before the release you would get much more feedback but I am
just guessing.

Regards

Simone



>
> >
> > On 11/6/07, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> >
> >> On Tue, 6 Nov 2007, Simone Giannerini wrote:
> >>
> >>
> >>> I looked at the list of bug fixes before writing and I found that the
> >>> only thing close to it is this
> >>>
> >>> o     postscript() was not always ignoring .Postscript.Options in
> >>>       the workspace (where it should not have occurred).
> >>>
> >>> but I must admit I did not understand whether it had anything to do
> >>> with this bug report.
> >>>
> >> It occurs on Windows only, and the src/gnuwin32/CHANGES file says
> >>
> >> BUG FIXES
> >>
> >>      o   Saving a plot to Postscript or PDF required the font database
> >>          to have been initialized: this is now done if necessary.
> >>
> >> See also
> >>
> >> https://mailman.stat.ethz.ch/pipermail/r-help/2007-October/142414.html
> >>
> >> (over a month ago).
> >>
> >>
> >>> Thanks
> >>>
> >>> Simone
> >>>
> >>> On 11/6/07, Uwe Ligges <ligges at statistik.uni-dortmund.de> wrote:
> >>>
> >>>> This has been reported several times before and has been fixed in
> >>>> R-patched some weeks ago.
> >>>>
> >>>> Uwe Ligges
> >>>>
> >>>>
> >>>> Jane_Harvill at Baylor.Edu wrote:
> >>>>
> >>>>> Full_Name: Jane L. Harvill
> >>>>> Version: 2.6.0
> >>>>> OS: Microsoft Windows XP Professional, Version 2002, Service Pack 2
> >>>>> Submission from: (NULL) (129.62.21.93)
> >>>>>
> >>>>>
> >>>>> PROBLEM: The ability to save the contents of an R Graphics window as a
> >>>>> postscript or PDf file through the drop-down menu (File -> Save As ->
> >>>>> Postscript, or File -> Save As -> PDF) results in the error message below being
> >>>>> printed to the R Console.
> >>>>>
> >>>>> ERROR MESSAGE:
> >>>>> -----------------------------------------------------------------
> >>>>> Error: Invalid font type
> >>>>> In addition: Warning messages:
> >>>>> 1: font family not found in PostScript font database
> >>>>> 2: font family not found in PostScript font database
> >>>>> -----------------------------------------------------------------
> >>>>>
> >>>>> TO RECREATE THE PROBLEM:
> >>>>> 1.  Using the R Console, create some graph in R; for example, plot(rnorm(100)).
> >>>>> 2.  Select File -> Save As -> PostScript  (or File -> Save As -> PDF).
> >>>>> 3.  Supply a file name and click the "Save" button.
> >>>>>
> >>>>> FOUR OTHER RELEVANT NOTES:
> >>>>> 1.  I checked to see if the same error results when invoking the functions
> >>>>> pdf(file=...) or postscript(file=...).   No error results, and the content of
> >>>>> the output (.ps or .pdf) file produces a duplicate of what appears in the R
> >>>>> Graphics window.
> >>>>>
> >>>>> 2.  I checked, but did not see any other bug reports in the system that are
> >>>>> relevant to this problem.
> >>>>>
> >>>>> 3.  Before I submitted this R Bug Report, I reinstalled the PostScript fonts,
> >>>>> and then reinstalled R Version 2.6.0.  This did not change the outcome.
> >>>>>
> >>>>> 4.  This problem did not exist in previous versions of R on any of my computers.
> >>>>>  It exists on all computers for version 2.6.0 of R.
> >>>>>
> >>>>> ______________________________________________
> >>>>> R-devel at r-project.org mailing list
> >>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>>>>
> >>>> ______________________________________________
> >>>> R-devel at r-project.org mailing list
> >>>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>>>
> >>>>
> >>>
> >>>
> >> --
> >> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> >> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> >> University of Oxford,             Tel:  +44 1865 272861 (self)
> >> 1 South Parks Road,                     +44 1865 272866 (PA)
> >> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> >>
> >>
> >
> >
> >
>
>
> --
>    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>  (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907
>
>
>



-- 
______________________________________________________

Simone Giannerini
Dipartimento di Scienze Statistiche "Paolo Fortunati"
Universita' di Bologna
Via delle belle arti 41 - 40126  Bologna,  ITALY
Tel: +39 051 2098262  Fax: +39 051 232153
http://www2.stat.unibo.it/giannerini/


From ripley at stats.ox.ac.uk  Wed Nov  7 11:05:38 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 7 Nov 2007 10:05:38 +0000 (GMT)
Subject: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
In-Reply-To: <3c12769c0711070151u18c95d9ch58a08780b4d232c1@mail.gmail.com>
References: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>
	<47308E34.6030901@statistik.uni-dortmund.de>
	<3c12769c0711060813r11cd1848o466af0b2ea72b05f@mail.gmail.com>
	<Pine.LNX.4.64.0711061637370.13662@gannet.stats.ox.ac.uk>
	<3c12769c0711060947o3e7ada11hf5156314f48923bc@mail.gmail.com>
	<4730B02C.5010209@biostat.ku.dk>
	<3c12769c0711070151u18c95d9ch58a08780b4d232c1@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0711071002300.5485@gannet.stats.ox.ac.uk>

On Wed, 7 Nov 2007, Simone Giannerini wrote:

> [snip]
>> Maybe, but given the way things have been working lately, it might be
>> better to emphasize
>>
>> (a) check the mailinglists
>> (b) try R-patched
>> (c) if in doubt, ask, rather than report as bug
>>
>> (Ideally, people would try the prerelease versions and problems like
>> this would be caught before the actual release, but it seems that they
>> prefer treating x.y.0 as a beta release...)
>>
>
> I am sorry but I do not agree with point (b) for the very simple fact
> that the average Windows user do not know how to compile the source
> code and might not even want to learn how to do it. The point is that
> since (if I am correct) the great majority of  R users go Windows you
> would miss an important part of potential bug reports by requiring
> point (b) whereas (a) and (c) would suffice IMHO.
> Maybe if there were Win binaries of the prerelease version available
> some time before the release you would get much more feedback but I am
> just guessing.

Windows binaries of R-patched are available all the time via
http://cran.r-project.org/bin/windows/base/

They are not always current, but only occasionally are they more than a 
day or two old.

Same for R-devel.

The biggest plus point about recommending trying R-patched is that is 
often the solution to the problem (as here, although there is also a 
workaround).


>
> Regards
>
> Simone
>
>
>
>>
>>>
>>> On 11/6/07, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
>>>
>>>> On Tue, 6 Nov 2007, Simone Giannerini wrote:
>>>>
>>>>
>>>>> I looked at the list of bug fixes before writing and I found that the
>>>>> only thing close to it is this
>>>>>
>>>>> o     postscript() was not always ignoring .Postscript.Options in
>>>>>       the workspace (where it should not have occurred).
>>>>>
>>>>> but I must admit I did not understand whether it had anything to do
>>>>> with this bug report.
>>>>>
>>>> It occurs on Windows only, and the src/gnuwin32/CHANGES file says
>>>>
>>>> BUG FIXES
>>>>
>>>>      o   Saving a plot to Postscript or PDF required the font database
>>>>          to have been initialized: this is now done if necessary.
>>>>
>>>> See also
>>>>
>>>> https://mailman.stat.ethz.ch/pipermail/r-help/2007-October/142414.html
>>>>
>>>> (over a month ago).
>>>>
>>>>
>>>>> Thanks
>>>>>
>>>>> Simone
>>>>>
>>>>> On 11/6/07, Uwe Ligges <ligges at statistik.uni-dortmund.de> wrote:
>>>>>
>>>>>> This has been reported several times before and has been fixed in
>>>>>> R-patched some weeks ago.
>>>>>>
>>>>>> Uwe Ligges
>>>>>>
>>>>>>
>>>>>> Jane_Harvill at Baylor.Edu wrote:
>>>>>>
>>>>>>> Full_Name: Jane L. Harvill
>>>>>>> Version: 2.6.0
>>>>>>> OS: Microsoft Windows XP Professional, Version 2002, Service Pack 2
>>>>>>> Submission from: (NULL) (129.62.21.93)
>>>>>>>
>>>>>>>
>>>>>>> PROBLEM: The ability to save the contents of an R Graphics window as a
>>>>>>> postscript or PDf file through the drop-down menu (File -> Save As ->
>>>>>>> Postscript, or File -> Save As -> PDF) results in the error message below being
>>>>>>> printed to the R Console.
>>>>>>>
>>>>>>> ERROR MESSAGE:
>>>>>>> -----------------------------------------------------------------
>>>>>>> Error: Invalid font type
>>>>>>> In addition: Warning messages:
>>>>>>> 1: font family not found in PostScript font database
>>>>>>> 2: font family not found in PostScript font database
>>>>>>> -----------------------------------------------------------------
>>>>>>>
>>>>>>> TO RECREATE THE PROBLEM:
>>>>>>> 1.  Using the R Console, create some graph in R; for example, plot(rnorm(100)).
>>>>>>> 2.  Select File -> Save As -> PostScript  (or File -> Save As -> PDF).
>>>>>>> 3.  Supply a file name and click the "Save" button.
>>>>>>>
>>>>>>> FOUR OTHER RELEVANT NOTES:
>>>>>>> 1.  I checked to see if the same error results when invoking the functions
>>>>>>> pdf(file=...) or postscript(file=...).   No error results, and the content of
>>>>>>> the output (.ps or .pdf) file produces a duplicate of what appears in the R
>>>>>>> Graphics window.
>>>>>>>
>>>>>>> 2.  I checked, but did not see any other bug reports in the system that are
>>>>>>> relevant to this problem.
>>>>>>>
>>>>>>> 3.  Before I submitted this R Bug Report, I reinstalled the PostScript fonts,
>>>>>>> and then reinstalled R Version 2.6.0.  This did not change the outcome.
>>>>>>>
>>>>>>> 4.  This problem did not exist in previous versions of R on any of my computers.
>>>>>>>  It exists on all computers for version 2.6.0 of R.
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>
>>>>>>
>>>>>
>>>>>
>>>> --
>>>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>>>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>>>> University of Oxford,             Tel:  +44 1865 272861 (self)
>>>> 1 South Parks Road,                     +44 1865 272866 (PA)
>>>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>>>
>>>>
>>>
>>>
>>>
>>
>>
>> --
>>    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>>   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>>  (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
>> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907
>>
>>
>>
>
>
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From P.Dalgaard at biostat.ku.dk  Wed Nov  7 11:51:01 2007
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed, 07 Nov 2007 11:51:01 +0100
Subject: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
In-Reply-To: <1194430870.1205.92.camel@biol102145.oulu.fi>
References: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>	
	<47308E34.6030901@statistik.uni-dortmund.de>	
	<3c12769c0711060813r11cd1848o466af0b2ea72b05f@mail.gmail.com>	
	<Pine.LNX.4.64.0711061637370.13662@gannet.stats.ox.ac.uk>	
	<3c12769c0711060947o3e7ada11hf5156314f48923bc@mail.gmail.com>	
	<4730B02C.5010209@biostat.ku.dk>	
	<3c12769c0711070151u18c95d9ch58a08780b4d232c1@mail.gmail.com>
	<1194430870.1205.92.camel@biol102145.oulu.fi>
Message-ID: <47319895.8020900@biostat.ku.dk>

Jari Oksanen wrote:
> On Wed, 2007-11-07 at 10:51 +0100, Simone Giannerini wrote:
>   
>> [snip] (this is from pd = Peter Dalgaard)
>>     
>>> Maybe, but given the way things have been working lately, it might be
>>> better to emphasize
>>>
>>> (a) check the mailinglists
>>> (b) try R-patched
>>> (c) if in doubt, ask, rather than report as bug
>>>
>>> (Ideally, people would try the prerelease versions and problems like
>>> this would be caught before the actual release, but it seems that they
>>> prefer treating x.y.0 as a beta release...)
>>>
>>>       
>> I am sorry but I do not agree with point (b) for the very simple fact
>> that the average Windows user do not know how to compile the source
>> code and might not even want to learn how to do it. The point is that
>> since (if I am correct) the great majority of  R users go Windows you
>> would miss an important part of potential bug reports by requiring
>> point (b) whereas (a) and (c) would suffice IMHO.
>> Maybe if there were Win binaries of the prerelease version available
>> some time before the release you would get much more feedback but I am
>> just guessing.
>>     
>
> First I must say that patched Windows binaries are available from CRAN
> with one extra click -- Linux and poor MacOS users must use 'svn co' to
> check out the patched version from the repository and compile from the
> sources. The attribute "poor" for MacOS users was there because this is
> a bigger step for Mac users than Linux users (who can easily get and
> install all tools they need and tend to have a different kind of
> mentality). 
>   
Actually, they can download

ftp://ftp.stat.math.ethz.ch/Software/R/R-patched.tar.bz2

They do have to build it (and know how to) though.

(Fedora incorporated patches in their RPM updates for a while, which I
was beginning to believe was a good idea, all things considered, but
they haven't done it (yet?) for 2.6.0.)

> Then I must say that I do not like this policy either. I think that is
> fair to file a bug report against the latest release version in good
> faith without being chastised and condemned. I know (like pd says above)
> that some people really do treat x.y.0 as beta releases: a friend of
> mine over here even refuses to install R x.x.0 versions just for this
> reason (in fact, he's pd's mate, too, but perhaps pd can talk him over
> to try x.x.0 versions). Filing a bug report against latest x.x.1
> shouldn't be too bad either.
>   
Of course that strategy just means that .0 becomes the alpha release and
.1 the beta....

> I guess the problem here is that R bug reports are linked to the Rd
> mailing list, and reports on "alredy fixed" bugs really are irritating.
> In more loosely connected bug reporting systems you simply could mark a
> bug as a duplicate of #xxxx and mark it as resolved without generating
> awfully lot of mail. Then it would be humanly possible to adopt a more
> neutral way of answering to people who reported bugs in latest releases.
> Probably that won't happen in the current environment.
>   
Someone still needs to do that, manually. But yes, a new bug tracker has
been on the wish list for a while.
It is not entirely trivial to set one up, though.


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From r.turner at auckland.ac.nz  Tue Nov  6 20:09:02 2007
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Wed, 7 Nov 2007 08:09:02 +1300
Subject: [Rd] Hmisc for Mac OSX.
In-Reply-To: <97C8C254-31BC-4166-BF19-514C42934B79@efs.mq.edu.au>
References: <04C9311E-2035-45E7-824C-9F0827A79932@auckland.ac.nz>
	<97C8C254-31BC-4166-BF19-514C42934B79@efs.mq.edu.au>
Message-ID: <DA0554AF-4521-4D13-9C08-1DF06B518A9E@auckland.ac.nz>


On 6/11/2007, at 10:35 PM, Ken Beath wrote:

> On 06/11/2007, at 8:59 AM, Rolf Turner wrote:
>
>>
>> I'm not sure if this is the right target to which to direct this  
>> post,
>> but I couldn't think of anything more appropriate.
>>
>
> R-Sig-Mac https://stat.ethz.ch/mailman/listinfo/r-sig-mac is for  
> mac specific problems

	Duhhhh!  Of course.  Why didn't I think of that!
>
>> I just downloaded the Hmisc package to the Imac that I use.  When I
>> attempted
>> to load it I got an error to the effect that it could not load the
>> library:
>>
>> /Library/Frameworks/R.framework/Versions/2.5/Resources/lib/
>> libgfortran.2.dylib
>>
>> Note the ``2.5'' in the foregoing path name; I am currently running
>> 2.6.0, and
>> I suspect that this is the problem --- i.e. the Mac binary on CRAN
>> was built
>> under 2.5.x and this does not work with 2.6.y.
>>
>> I note that the source and Windoze Hmisc packages are designated as
>> 3.4-3, but
>> the Mac package is designated as 3.4-2 which would appear to imply
>> that it's
>> a step behind.
>>
>> Could the Mac binary be updated please?  Thanks.
>>
>
> The mac binary at central CRAN is a t3.4-3, so it is probably a  
> mirror problem,
> CRAN works for me, but uni of melbourne has the old Hmisc, but it  
> works under 2.6 anyway.

	I was using the Queensland/Brisbane mirror, and the package that I  
downloaded
	certainly did *not* work!  But this morning it appears to have been  
updated
	to 3.4-3 and that does work.  So all is well.

	Thanks.

		cheers,

			Rolf Turner

######################################################################
Attention:\ This e-mail message is privileged and confid...{{dropped:9}}


From kamil at ualberta.ca  Wed Nov  7 01:02:56 2007
From: kamil at ualberta.ca (kamil Marcinkowski)
Date: Tue, 6 Nov 2007 17:02:56 -0700
Subject: [Rd] R 2.6.0 make check fails on SGI origin 350 and
In-Reply-To: <Pine.LNX.4.64.0711062341250.30885@gannet.stats.ox.ac.uk>
References: <42665B36-6FE2-48A4-A1C4-09F67D61A28C@ualberta.ca>
	<Pine.LNX.4.64.0711062341250.30885@gannet.stats.ox.ac.uk>
Message-ID: <A8521DA1-CFA8-4B2D-896B-690AF301E122@ualberta.ca>

Hello Prof Brian Ripley and list

There is no "d-p-q-r-tests.Rout"  file, the following files do exists  
and are being sent as attachments:
./tests/d-p-q-r-tests.R ,  ./tests/d-p-q-r-tests.Rout.save , ./tests/d- 
p-q-r-tests.Rout.fail .






Cheers,

Kamil


Kamil Marcinkowski                   Westgrid System Administrator
kamil at ualberta.ca                     University of Alberta site
  Tel.780 492-0354                     Research Computing Support
Fax.780 492-1729                     Academic ICT
Edmonton, Alberta, CANADA    University of Alberta


"This communication is intended for the use of the recipient to which  
it is
addressed, and may contain confidential, personal, and/or privileged
information.  Please contact us immediately if you are not the intended
recipient of this communication.  If you are not the intended  
recipient of
this communication, do not copy, distribute, or take action on it. Any
communication received in error, or subsequent reply, should be  
deleted or
destroyed."



On 6-Nov-07, at 4:46 PM, Prof Brian Ripley wrote:

> We need to see the d-p-q-r-tests.Rout file, and perhaps ask for some  
> more runs (unfortunately that line number is after massaging).  Can  
> you make it available to us?  Or at least a portion containing the  
> quoted line (which should only occur once)?
>
> On Tue, 6 Nov 2007, kamil Marcinkowski wrote:
>
>> Hello
>>
>> I am trying to install R 2.6.0 on a SGI Origin 350 running IRIX 6.5
>> 6.5.28f
>>
>> R was configured with the following options:
>>
>>> --x-includes=/usr/include/X11
>>> --x-libraries=/usr/lib/X11
>>> --includedir=/usr/freeware/include
>>> --includedir=/usr/freeware/lib32
>>> --includedir=/usr/freeware/lib64
>>> --with-readline=no
>>> --with-iconv=no
>>> CC=cc
>>
>>
>> gmake complied successfully, however gmake check failed on d-p-q-r-
>> tests.R .
>>
>>> running code in 'd-p-q-r-tests.R' ... OK
>>> comparing 'd-p-q-r-tests.Rout' to './d-p-q-r-tests.Rout.save' ...
>>> 959c959
>>> < [1] "Mean scaled  difference: NaN"
>>> ---
>>>> [1] TRUE
>>> gmake[3]: *** [d-p-q-r-tests.Rout] Error 1
>>> gmake[3]: Leaving directory `/usr/global/R-build/R-2.6.0/tests'
>>> gmake[2]: *** [test-Specific] Error 2
>>> gmake[2]: Leaving directory `/usr/global/R-build/R-2.6.0/tests'
>>> gmake[1]: *** [test-all-basics] Error 1
>>> gmake[1]: Leaving directory `/usr/global/R-build/R-2.6.0/tests'
>>> gmake: *** [check] Error 2
>>
>>
>> Any ideas would be appreciated.
>>
>> Cheers,
>>
>> Kamil
>>
>> Kamil Marcinkowski                   Westgrid System Administrator
>> kamil at ualberta.ca                     University of Alberta site
>> Tel.780 492-0354                     Research Computing Support
>> Fax.780 492-1729                     Academic ICT
>> Edmonton, Alberta, CANADA    University of Alberta
>>
>>
>> "This communication is intended for the use of the recipient to which
>> it is
>> addressed, and may contain confidential, personal, and/or privileged
>> information.  Please contact us immediately if you are not the  
>> intended
>> recipient of this communication.  If you are not the intended
>> recipient of
>> this communication, do not copy, distribute, or take action on it.  
>> Any
>> communication received in error, or subsequent reply, should be
>> deleted or
>> destroyed."
>>
>>
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>


From jari.oksanen at oulu.fi  Wed Nov  7 11:21:10 2007
From: jari.oksanen at oulu.fi (Jari Oksanen)
Date: Wed, 07 Nov 2007 12:21:10 +0200
Subject: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
In-Reply-To: <3c12769c0711070151u18c95d9ch58a08780b4d232c1@mail.gmail.com>
References: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>
	<47308E34.6030901@statistik.uni-dortmund.de>
	<3c12769c0711060813r11cd1848o466af0b2ea72b05f@mail.gmail.com>
	<Pine.LNX.4.64.0711061637370.13662@gannet.stats.ox.ac.uk>
	<3c12769c0711060947o3e7ada11hf5156314f48923bc@mail.gmail.com>
	<4730B02C.5010209@biostat.ku.dk>
	<3c12769c0711070151u18c95d9ch58a08780b4d232c1@mail.gmail.com>
Message-ID: <1194430870.1205.92.camel@biol102145.oulu.fi>


On Wed, 2007-11-07 at 10:51 +0100, Simone Giannerini wrote:
> [snip] (this is from pd = Peter Dalgaard)
> > Maybe, but given the way things have been working lately, it might be
> > better to emphasize
> >
> > (a) check the mailinglists
> > (b) try R-patched
> > (c) if in doubt, ask, rather than report as bug
> >
> > (Ideally, people would try the prerelease versions and problems like
> > this would be caught before the actual release, but it seems that they
> > prefer treating x.y.0 as a beta release...)
> >
> 
> I am sorry but I do not agree with point (b) for the very simple fact
> that the average Windows user do not know how to compile the source
> code and might not even want to learn how to do it. The point is that
> since (if I am correct) the great majority of  R users go Windows you
> would miss an important part of potential bug reports by requiring
> point (b) whereas (a) and (c) would suffice IMHO.
> Maybe if there were Win binaries of the prerelease version available
> some time before the release you would get much more feedback but I am
> just guessing.

First I must say that patched Windows binaries are available from CRAN
with one extra click -- Linux and poor MacOS users must use 'svn co' to
check out the patched version from the repository and compile from the
sources. The attribute "poor" for MacOS users was there because this is
a bigger step for Mac users than Linux users (who can easily get and
install all tools they need and tend to have a different kind of
mentality). 

Then I must say that I do not like this policy either. I think that is
fair to file a bug report against the latest release version in good
faith without being chastised and condemned. I know (like pd says above)
that some people really do treat x.y.0 as beta releases: a friend of
mine over here even refuses to install R x.x.0 versions just for this
reason (in fact, he's pd's mate, too, but perhaps pd can talk him over
to try x.x.0 versions). Filing a bug report against latest x.x.1
shouldn't be too bad either.

I guess the problem here is that R bug reports are linked to the Rd
mailing list, and reports on "alredy fixed" bugs really are irritating.
In more loosely connected bug reporting systems you simply could mark a
bug as a duplicate of #xxxx and mark it as resolved without generating
awfully lot of mail. Then it would be humanly possible to adopt a more
neutral way of answering to people who reported bugs in latest releases.
Probably that won't happen in the current environment.

Cheers, Jari Oksanen

PS. Please Mr Moderator, don't treat me so mean (*): I've subscribed to
this group although you regularly reject my mail as coming from a
"non-member". 

(*) an extract from a classic song "Mr R jumped the rabbit".
-- 
Jari Oksanen <jari.oksanen at oulu.fi>


From simon.urbanek at r-project.org  Wed Nov  7 16:43:20 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 7 Nov 2007 10:43:20 -0500
Subject: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
In-Reply-To: <1194430870.1205.92.camel@biol102145.oulu.fi>
References: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>
	<47308E34.6030901@statistik.uni-dortmund.de>
	<3c12769c0711060813r11cd1848o466af0b2ea72b05f@mail.gmail.com>
	<Pine.LNX.4.64.0711061637370.13662@gannet.stats.ox.ac.uk>
	<3c12769c0711060947o3e7ada11hf5156314f48923bc@mail.gmail.com>
	<4730B02C.5010209@biostat.ku.dk>
	<3c12769c0711070151u18c95d9ch58a08780b4d232c1@mail.gmail.com>
	<1194430870.1205.92.camel@biol102145.oulu.fi>
Message-ID: <E70CD982-D954-497B-B387-B14A1281BB5C@r-project.org>


On Nov 7, 2007, at 5:21 AM, Jari Oksanen wrote:

>
> On Wed, 2007-11-07 at 10:51 +0100, Simone Giannerini wrote:
>> [snip] (this is from pd = Peter Dalgaard)
>>> Maybe, but given the way things have been working lately, it might  
>>> be
>>> better to emphasize
>>>
>>> (a) check the mailinglists
>>> (b) try R-patched
>>> (c) if in doubt, ask, rather than report as bug
>>>
>>> (Ideally, people would try the prerelease versions and problems like
>>> this would be caught before the actual release, but it seems that  
>>> they
>>> prefer treating x.y.0 as a beta release...)
>>>
>>
>> I am sorry but I do not agree with point (b) for the very simple  
>> fact that the average Windows user do not know how to compile the  
>> source code and might not even want to learn how to do it. The  
>> point is that since (if I am correct) the great majority of  R  
>> users go Windows you would miss an important part of potential bug  
>> reports by requiring point (b) whereas (a) and (c) would suffice  
>> IMHO.
>> Maybe if there were Win binaries of the prerelease version  
>> available some time before the release you would get much more  
>> feedback but I am just guessing.
>
> First I must say that patched Windows binaries are available from  
> CRAN with one extra click -- Linux and poor MacOS users must use  
> 'svn co' to check out the patched version from the repository and  
> compile from the sources. The attribute "poor" for MacOS users was  
> there because this is a bigger step for Mac users than Linux users  
> (who can easily get and install all tools they need and tend to have  
> a different kind of mentality).
>

Ehm, you didn't even bother to look at the CRAN page, right?

Why am I bothering to build nightly builds of R-patched, and R-devel  
nightly and even garnishing them with a full installer so they can be  
installed just like the release version if people don't bother to read  
just a single web page ...

[Insert the usual "please do your homework" part here that may be  
considered "vitriolic" ... (vitriol is a very useful substance by the  
way ...)]

Cheers,
Simon


From macq at llnl.gov  Wed Nov  7 17:16:58 2007
From: macq at llnl.gov (Don MacQueen)
Date: Wed, 7 Nov 2007 08:16:58 -0800
Subject: [Rd] FYI: issue with arpa/inet.h on SunOS 5.9 (old gcc?)
In-Reply-To: <Pine.LNX.4.64.0711060725250.18150@gannet.stats.ox.ac.uk>
References: <p06230907c355359f870f@[128.115.153.6]>
	<Pine.LNX.4.64.0711060725250.18150@gannet.stats.ox.ac.uk>
Message-ID: <p06230903c3578464ff52@[128.115.153.6]>

Of course. It was built for Solaris 2.7.
(I did look at R-admin, but not carefully and thoroughly enough.)

Thank you.
-Don

At 7:33 AM +0000 11/6/07, Prof Brian Ripley wrote:
>What OS was that compiler built for?  This happened when you had a 
>version of gcc built for the wrong version of the OS, as gcc 
>captures system headers.  (There's a warning about that in the 
>R-admin manual.)
>
>The 'report to' message is autogenerated by autoconf.
>
>SunStudio 11 is a recent version of Sun's compilers, and much to be 
>preferred to gcc 3.0.4 on that platform (and probably to any version 
>of gcc there).
>
>On Mon, 5 Nov 2007, Don MacQueen wrote:
>
>>This just information of my experience installing R on SunOS 5.9
>>today, not a request for help.
>>(in case anyone cares, and if not, I apologize for the distraction)
>>
>>I am building R 2.6.0 (patched; svn revision 43319, 2007-11-01) and
>>encountered the problem described below.
>>
>>I believe the problem is an old gcc (version 3.0.4, built some 5
>>years ago), because the warnings do not occur when I specify
>>    CC = cc
>>in the environment before configuring, and building R succeeds.
>>
>>Hence I'm mailing to r-devel instead of r-bugs, as suggested in the
>>warning messages.
>>
>>I don't have much information about the cc I used (I'm not the
>>sysadmin of this or any Solaris machine), other than it resides in
>>/opt/SUNWspro, and appears to be part of "Sun Studio 11", whatever
>>that is.
>>
>>
>>The messages from R's configure were:
>>
>>configure: WARNING: arpa/inet.h: present but cannot be compiled
>>configure: WARNING: arpa/inet.h:     check for missing prerequisite headers?
>>configure: WARNING: arpa/inet.h: see the Autoconf documentation
>>configure: WARNING: arpa/inet.h:     section "Present But Cannot Be Compiled"
>>configure: WARNING: arpa/inet.h: proceeding with the preprocessor's result
>>configure: WARNING: arpa/inet.h: in the future, the compiler will
>>take precedence
>>configure: WARNING:     ## ----------------------------------- ##
>>configure: WARNING:     ## Report this to r-bugs at R-project.org ##
>>configure: WARNING:     ## ----------------------------------- ##
>>
>>And then the same set of warnings for
>>   netdb.h
>>   netinet/in.h
>>   sys/socket.h
>>
>>At the very end configure reports:
>>
>>configure: WARNING: could not determine type of socket length
>>
>>
>>Then, make fails with:
>>
>>In file included from /usr/include/netinet/in.h:41,
>>                  from /usr/include/netdb.h:98,
>>                  from ../../../R-patched/src/main/platform.c:1586:
>>/usr/include/sys/stream.h:307: parse error before "projid_t"
>>make[3]: *** [platform.o] Error 1
>>make[3]: Leaving directory `/apps/kosapps/R/R-2.6.0/build/src/main'
>>make[2]: *** [R] Error 2
>>make[2]: Leaving directory `/apps/kosapps/R/R-2.6.0/build/src/main'
>>make[1]: *** [R] Error 1
>>make[1]: Leaving directory `/apps/kosapps/R/R-2.6.0/build/src'
>>make: *** [R] Error 1
>>
>
>--
>Brian D. Ripley,                  ripley at stats.ox.ac.uk
>Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>University of Oxford,             Tel:  +44 1865 272861 (self)
>1 South Parks Road,                     +44 1865 272866 (PA)
>Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-- 
--------------------------------------
Don MacQueen
Environmental Protection Department
Lawrence Livermore National Laboratory
Livermore, CA, USA
925-423-1062


From ripley at stats.ox.ac.uk  Wed Nov  7 17:20:11 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 7 Nov 2007 16:20:11 +0000 (GMT)
Subject: [Rd] FYI: issue with arpa/inet.h on SunOS 5.9 (old gcc?)
In-Reply-To: <p06230903c3578464ff52@[128.115.153.6]>
References: <p06230907c355359f870f@[128.115.153.6]>
	<Pine.LNX.4.64.0711060725250.18150@gannet.stats.ox.ac.uk>
	<p06230903c3578464ff52@[128.115.153.6]>
Message-ID: <Pine.LNX.4.64.0711071618430.3839@gannet.stats.ox.ac.uk>

On Wed, 7 Nov 2007, Don MacQueen wrote:

> Of course. It was built for Solaris 2.7.
> (I did look at R-admin, but not carefully and thoroughly enough.)

Good to know (and I didn't expect you to know it was in the manual, was 
just pointing out where to look for further help).

>
> Thank you.
> -Don
>
> At 7:33 AM +0000 11/6/07, Prof Brian Ripley wrote:
>> What OS was that compiler built for?  This happened when you had a version 
>> of gcc built for the wrong version of the OS, as gcc captures system 
>> headers.  (There's a warning about that in the R-admin manual.)
>> 
>> The 'report to' message is autogenerated by autoconf.
>> 
>> SunStudio 11 is a recent version of Sun's compilers, and much to be 
>> preferred to gcc 3.0.4 on that platform (and probably to any version of gcc 
>> there).
>> 
>> On Mon, 5 Nov 2007, Don MacQueen wrote:
>> 
>>> This just information of my experience installing R on SunOS 5.9
>>> today, not a request for help.
>>> (in case anyone cares, and if not, I apologize for the distraction)
>>> 
>>> I am building R 2.6.0 (patched; svn revision 43319, 2007-11-01) and
>>> encountered the problem described below.
>>> 
>>> I believe the problem is an old gcc (version 3.0.4, built some 5
>>> years ago), because the warnings do not occur when I specify
>>>    CC = cc
>>> in the environment before configuring, and building R succeeds.
>>> 
>>> Hence I'm mailing to r-devel instead of r-bugs, as suggested in the
>>> warning messages.
>>> 
>>> I don't have much information about the cc I used (I'm not the
>>> sysadmin of this or any Solaris machine), other than it resides in
>>> /opt/SUNWspro, and appears to be part of "Sun Studio 11", whatever
>>> that is.
>>> 
>>> 
>>> The messages from R's configure were:
>>> 
>>> configure: WARNING: arpa/inet.h: present but cannot be compiled
>>> configure: WARNING: arpa/inet.h:     check for missing prerequisite 
>>> headers?
>>> configure: WARNING: arpa/inet.h: see the Autoconf documentation
>>> configure: WARNING: arpa/inet.h:     section "Present But Cannot Be 
>>> Compiled"
>>> configure: WARNING: arpa/inet.h: proceeding with the preprocessor's result
>>> configure: WARNING: arpa/inet.h: in the future, the compiler will
>>> take precedence
>>> configure: WARNING:     ## ----------------------------------- ##
>>> configure: WARNING:     ## Report this to r-bugs at R-project.org ##
>>> configure: WARNING:     ## ----------------------------------- ##
>>> 
>>> And then the same set of warnings for
>>>   netdb.h
>>>   netinet/in.h
>>>   sys/socket.h
>>> 
>>> At the very end configure reports:
>>> 
>>> configure: WARNING: could not determine type of socket length
>>> 
>>> 
>>> Then, make fails with:
>>> 
>>> In file included from /usr/include/netinet/in.h:41,
>>>                  from /usr/include/netdb.h:98,
>>>                  from ../../../R-patched/src/main/platform.c:1586:
>>> /usr/include/sys/stream.h:307: parse error before "projid_t"
>>> make[3]: *** [platform.o] Error 1
>>> make[3]: Leaving directory `/apps/kosapps/R/R-2.6.0/build/src/main'
>>> make[2]: *** [R] Error 2
>>> make[2]: Leaving directory `/apps/kosapps/R/R-2.6.0/build/src/main'
>>> make[1]: *** [R] Error 1
>>> make[1]: Leaving directory `/apps/kosapps/R/R-2.6.0/build/src'
>>> make: *** [R] Error 1
>>> 
>> 
>> --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From maechler at stat.math.ethz.ch  Wed Nov  7 17:54:35 2007
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 7 Nov 2007 17:54:35 +0100
Subject: [Rd] mean mailing list moderator ..
In-Reply-To: <1194430870.1205.92.camel@biol102145.oulu.fi>
References: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>
	<47308E34.6030901@statistik.uni-dortmund.de>
	<3c12769c0711060813r11cd1848o466af0b2ea72b05f@mail.gmail.com>
	<Pine.LNX.4.64.0711061637370.13662@gannet.stats.ox.ac.uk>
	<3c12769c0711060947o3e7ada11hf5156314f48923bc@mail.gmail.com>
	<4730B02C.5010209@biostat.ku.dk>
	<3c12769c0711070151u18c95d9ch58a08780b4d232c1@mail.gmail.com>
	<1194430870.1205.92.camel@biol102145.oulu.fi>
Message-ID: <18225.60875.997836.316927@stat.math.ethz.ch>

Hi Jari,

(and interested readers)

>>>>> "JO" == Jari Oksanen <jari.oksanen at oulu.fi>
>>>>>     on Wed, 07 Nov 2007 12:21:10 +0200 writes:

  [..........................]
  [...some very good stuff...]
  [..........................]

    JO> Cheers, Jari Oksanen

    JO> PS. Please Mr Moderator, don't treat me so mean (*): I've subscribed to
    JO> this group although you regularly reject my mail as coming from a
    JO> "non-member". 

More than a year ago, I had changed R-devel policy to  

1) subscribers can post freely
2) everything else is on "hold" for moderator approval +)
3) ``spam-suspicious e-mails'' are also put "on hold".

Now your problem is that you are subscribed under a different
e-mail address than the one you are currently sending mail from
(and also use in your sig. below).
To the mailing list software (mailman) this is equivalent to a
non-subscriber.

+) the moderator can   **manually**  add non-subscriber
   addresses to a list which is treated as "allowed to post"
   and I could do this next time ...
   but my general attitude is that r-devel subscribers should
   make these things work...

Best regards,
Martin

    JO> (*) an extract from a classic song "Mr R jumped the rabbit".
    JO> -- 
    JO> Jari Oksanen <jari.oksanen at oulu.fi>


From maechler at stat.math.ethz.ch  Wed Nov  7 18:09:22 2007
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 7 Nov 2007 18:09:22 +0100
Subject: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
In-Reply-To: <1194430870.1205.92.camel@biol102145.oulu.fi>
References: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>
	<47308E34.6030901@statistik.uni-dortmund.de>
	<3c12769c0711060813r11cd1848o466af0b2ea72b05f@mail.gmail.com>
	<Pine.LNX.4.64.0711061637370.13662@gannet.stats.ox.ac.uk>
	<3c12769c0711060947o3e7ada11hf5156314f48923bc@mail.gmail.com>
	<4730B02C.5010209@biostat.ku.dk>
	<3c12769c0711070151u18c95d9ch58a08780b4d232c1@mail.gmail.com>
	<1194430870.1205.92.camel@biol102145.oulu.fi>
Message-ID: <18225.61762.374071.459792@stat.math.ethz.ch>

>>>>> "JO" == Jari Oksanen <jari.oksanen at oulu.fi>
>>>>>     on Wed, 07 Nov 2007 12:21:10 +0200 writes:

    JO> On Wed, 2007-11-07 at 10:51 +0100, Simone Giannerini wrote:
    >> [snip] (this is from pd = Peter Dalgaard)
    >> > Maybe, but given the way things have been working lately, it might be
    >> > better to emphasize
    >> >
    >> > (a) check the mailinglists
    >> > (b) try R-patched
    >> > (c) if in doubt, ask, rather than report as bug
    >> >
    >> > (Ideally, people would try the prerelease versions and problems like
    >> > this would be caught before the actual release, but it seems that they
    >> > prefer treating x.y.0 as a beta release...)
    >> >
    >> 
    >> I am sorry but I do not agree with point (b) for the very simple fact
    >> that the average Windows user do not know how to compile the source
    >> code and might not even want to learn how to do it. The point is that
    >> since (if I am correct) the great majority of  R users go Windows you
    >> would miss an important part of potential bug reports by requiring
    >> point (b) whereas (a) and (c) would suffice IMHO.
    >> Maybe if there were Win binaries of the prerelease version available
    >> some time before the release you would get much more feedback but I am
    >> just guessing.

    JO> First I must say that patched Windows binaries are available from CRAN
    [............]

    JO> Then I must say that I do not like this policy either. I think that is
    JO> fair to file a bug report against the latest release version in good
    JO> faith without being chastised and condemned. 

I agree in principle.
If you do that without any of [abc] above, you do produce a bit
of work to at least one R-core member who has to deal with the
bug report (in the jitterbug archive) in addition to the usual
time consumption (of someone answering) which is unavoidable and
hence ok.

I think we as R developers should more graciously accept such
false positives in order to get more true positives...


    JO> I know (like pd says above) that some people really do
    JO> treat x.y.0 as beta releases: a friend of mine over here
    JO> even refuses to install R x.x.0 versions just for this
    JO> reason (in fact, he's pd's mate, too, but perhaps pd can
    JO> talk him over to try x.x.0 versions). Filing a bug
    JO> report against latest x.x.1 shouldn't be too bad either.

well, given past experience, I think people *should* adopt  c)
in such and more cases, i.e. rather "ask" than "report a bug",
also in light of what you say below, but when people don't, they
still should be handled politely ..

    JO> I guess the problem here is that R bug reports are linked to the Rd
    JO> mailing list, and reports on "alredy fixed" bugs really are irritating.
    JO> In more loosely connected bug reporting systems you simply could mark a
    JO> bug as a duplicate of #xxxx and mark it as resolved without generating
    JO> awfully lot of mail. Then it would be humanly possible to adopt a more
    JO> neutral way of answering to people who reported bugs in latest releases.
    JO> Probably that won't happen in the current environment.

    JO> Cheers, Jari Oksanen

Martin Maechler


From jfox at mcmaster.ca  Wed Nov  7 18:17:11 2007
From: jfox at mcmaster.ca (John Fox)
Date: Wed, 7 Nov 2007 12:17:11 -0500
Subject: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
In-Reply-To: <18225.61762.374071.459792@stat.math.ethz.ch>
Message-ID: <6buhm2$4q4upp@toip7.srvr.bell.ca>

Dear Martin, Jari, et al.,

Another relevant point (which I haven't seen in this discussion -- perhaps I
missed it) is that one can read the CHANGES and NEWS files on CRAN without
downloading or installing R-patched.

Regards,
 John


> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Martin Maechler
> Sent: Wednesday, November 07, 2007 12:09 PM
> To: Jari Oksanen
> Cc: r-devel at r-project.org; Peter Dalgaard
> Subject: Re: [Rd] Saving Graphics File as .ps or .pdf (PR#10403)
> 
> >>>>> "JO" == Jari Oksanen <jari.oksanen at oulu.fi>
> >>>>>     on Wed, 07 Nov 2007 12:21:10 +0200 writes:
> 
>     JO> On Wed, 2007-11-07 at 10:51 +0100, Simone Giannerini wrote:
>     >> [snip] (this is from pd = Peter Dalgaard)
>     >> > Maybe, but given the way things have been working 
> lately, it might be
>     >> > better to emphasize
>     >> >
>     >> > (a) check the mailinglists
>     >> > (b) try R-patched
>     >> > (c) if in doubt, ask, rather than report as bug
>     >> >
>     >> > (Ideally, people would try the prerelease versions 
> and problems like
>     >> > this would be caught before the actual release, but 
> it seems that they
>     >> > prefer treating x.y.0 as a beta release...)
>     >> >
>     >> 
>     >> I am sorry but I do not agree with point (b) for the 
> very simple fact
>     >> that the average Windows user do not know how to 
> compile the source
>     >> code and might not even want to learn how to do it. 
> The point is that
>     >> since (if I am correct) the great majority of  R users 
> go Windows you
>     >> would miss an important part of potential bug reports 
> by requiring
>     >> point (b) whereas (a) and (c) would suffice IMHO.
>     >> Maybe if there were Win binaries of the prerelease 
> version available
>     >> some time before the release you would get much more 
> feedback but I am
>     >> just guessing.
> 
>     JO> First I must say that patched Windows binaries are 
> available from CRAN
>     [............]
> 
>     JO> Then I must say that I do not like this policy 
> either. I think that is
>     JO> fair to file a bug report against the latest release 
> version in good
>     JO> faith without being chastised and condemned. 
> 
> I agree in principle.
> If you do that without any of [abc] above, you do produce a 
> bit of work to at least one R-core member who has to deal 
> with the bug report (in the jitterbug archive) in addition to 
> the usual time consumption (of someone answering) which is 
> unavoidable and hence ok.
> 
> I think we as R developers should more graciously accept such 
> false positives in order to get more true positives...
> 
> 
>     JO> I know (like pd says above) that some people really do
>     JO> treat x.y.0 as beta releases: a friend of mine over here
>     JO> even refuses to install R x.x.0 versions just for this
>     JO> reason (in fact, he's pd's mate, too, but perhaps pd can
>     JO> talk him over to try x.x.0 versions). Filing a bug
>     JO> report against latest x.x.1 shouldn't be too bad either.
> 
> well, given past experience, I think people *should* adopt  
> c) in such and more cases, i.e. rather "ask" than "report a 
> bug", also in light of what you say below, but when people 
> don't, they still should be handled politely ..
> 
>     JO> I guess the problem here is that R bug reports are 
> linked to the Rd
>     JO> mailing list, and reports on "alredy fixed" bugs 
> really are irritating.
>     JO> In more loosely connected bug reporting systems you 
> simply could mark a
>     JO> bug as a duplicate of #xxxx and mark it as resolved 
> without generating
>     JO> awfully lot of mail. Then it would be humanly 
> possible to adopt a more
>     JO> neutral way of answering to people who reported bugs 
> in latest releases.
>     JO> Probably that won't happen in the current environment.
> 
>     JO> Cheers, Jari Oksanen
> 
> Martin Maechler
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hin-tak.leung at cimr.cam.ac.uk  Wed Nov  7 19:51:54 2007
From: hin-tak.leung at cimr.cam.ac.uk (Hin-Tak Leung)
Date: Wed, 07 Nov 2007 18:51:54 +0000
Subject: [Rd] mean mailing list moderator ..
In-Reply-To: <18225.60875.997836.316927@stat.math.ethz.ch>
References: <20071106150504.8746A283462E@mail.pubhealth.ku.dk>	<47308E34.6030901@statistik.uni-dortmund.de>	<3c12769c0711060813r11cd1848o466af0b2ea72b05f@mail.gmail.com>	<Pine.LNX.4.64.0711061637370.13662@gannet.stats.ox.ac.uk>	<3c12769c0711060947o3e7ada11hf5156314f48923bc@mail.gmail.com>	<4730B02C.5010209@biostat.ku.dk>	<3c12769c0711070151u18c95d9ch58a08780b4d232c1@mail.gmail.com>	<1194430870.1205.92.camel@biol102145.oulu.fi>
	<18225.60875.997836.316927@stat.math.ethz.ch>
Message-ID: <4732094A.1080102@cimr.cam.ac.uk>

There is a simple solution to this kind of problem - for my
non-day-job-related software stuff, I usually subscribe under
my sourceforge address. Sourceforge's is simple re-direction service
so I actually cannot post from it; but I like incoming e-mails to go
through sourceforge for a double spam filter. So e-mails come in through
sourceforge but replied under my real address if I do, and it get held
occasionally in the past depending on the mailing list policies.

The solution I found is this: subscribe both addresses, but disabling 
delivery to the real-one. (this can be done by the user, no admin 
required). This way I can post from the real one, but receive 
twice-filtered mailing-list e-mails through an alias.

(For R-devel, I am receiving and posting from my day-job address,
if you are wondering...)

Martin Maechler wrote:
> Hi Jari,
> 
> (and interested readers)
> 
>>>>>> "JO" == Jari Oksanen <jari.oksanen at oulu.fi>
>>>>>>     on Wed, 07 Nov 2007 12:21:10 +0200 writes:
> 
>   [..........................]
>   [...some very good stuff...]
>   [..........................]
> 
>     JO> Cheers, Jari Oksanen
> 
>     JO> PS. Please Mr Moderator, don't treat me so mean (*): I've subscribed to
>     JO> this group although you regularly reject my mail as coming from a
>     JO> "non-member". 
> 
> More than a year ago, I had changed R-devel policy to  
> 
> 1) subscribers can post freely
> 2) everything else is on "hold" for moderator approval +)
> 3) ``spam-suspicious e-mails'' are also put "on hold".
> 
> Now your problem is that you are subscribed under a different
> e-mail address than the one you are currently sending mail from
> (and also use in your sig. below).
> To the mailing list software (mailman) this is equivalent to a
> non-subscriber.
> 
> +) the moderator can   **manually**  add non-subscriber
>    addresses to a list which is treated as "allowed to post"
>    and I could do this next time ...
>    but my general attitude is that r-devel subscribers should
>    make these things work...
> 
> Best regards,
> Martin
> 
>     JO> (*) an extract from a classic song "Mr R jumped the rabbit".
>     JO> -- 
>     JO> Jari Oksanen <jari.oksanen at oulu.fi>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From A.Robinson at ms.unimelb.edu.au  Thu Nov  8 00:45:27 2007
From: A.Robinson at ms.unimelb.edu.au (Andrew Robinson)
Date: Thu, 8 Nov 2007 10:45:27 +1100
Subject: [Rd] A suggestion for an amendment to tapply
In-Reply-To: <47316605.20503@biostat.ku.dk>
References: <20071106051028.GW71568@ms.unimelb.edu.au>
	<B998A44C8986644EA8029CFE6396A924D895A4@exqld2-bne.nexus.csiro.au>
	<Pine.LNX.4.64.0711060712300.18034@gannet.stats.ox.ac.uk>
	<20071107014346.GK71568@ms.unimelb.edu.au>
	<47316605.20503@biostat.ku.dk>
Message-ID: <20071107234527.GG71568@ms.unimelb.edu.au>

On Wed, Nov 07, 2007 at 08:15:17AM +0100, Peter Dalgaard wrote:
> Andrew Robinson wrote:
> >These are important concerns.  It seems to me that adding an argument
> >as suggested by Bill will allow the user to side-step the problem
> >identified by Brian.
> >
> >Bill, under what kinds of circumstances would you anticipate a
> >significant time penalty?  I would be happy to check those out with
> >some simulations.
> >
> >If the timing seems acceptable, I can write a patch for tapply.R and
> >tapply.Rd if anyone in the core is willing to consider them.  Please
> >contact me on or off list if so.
> >
> >  
> 
> There's another concern: tapply (et al.) has the ... args passed on to 
> FUN which means that you have to be really careful with argument names.
> 
> Could I just interject that we already have
> 
> > airquality$Month <- factor(airquality$Month,levels=4:9) # April not there
> > unlist(lapply(
> +    split(airquality$Ozone, airquality$Month, drop=F),sum, na.rm=T))
>   4    5    6    7    8    9
>   0  614  265 1537 1559  912
> 
> (splitting on multiple factors gets a  bit involved, though)

For that matter, we have

airquality$Month <- factor(airquality$Month,levels=4:9)
air.sum <- tapply(airquality$Ozone, airquality$Month, sum, na.rm=T)
air.sum[is.na(air.sum)] <- 0

which is equivalent to what I ended up using whilst fiddling with tapply.

Andrew

 
> >Best wishes to all,
> >
> >Andrew
> >
> >
> >
> >
> >On Tue, Nov 06, 2007 at 07:23:56AM +0000, Prof Brian Ripley wrote:
> >  
> >>On Tue, 6 Nov 2007, Bill.Venables at csiro.au wrote:
> >>
> >>    
> >>>Unfortunately I think it would break too much existing code.  tapply()
> >>>is an old function and many people have gotten used to the way it works
> >>>now.
> >>>      
> >>It is also not necessarily desirable: FUN(numeric(0)) might be an error.
> >>For example:
> >>
> >>    
> >>>Z <- data.frame(x=rnorm(10), f=rep(c("a", "b"), each=5))[1:5, ]
> >>>tapply(Z$x, Z$f, sd)
> >>>      
> >>but sd(numeric(0)) is an error.  (Similar things involving var are 'in 
> >>the wild' and so would be broken.)
> >>
> >>    
> >>>This is not to suggest there could not be another argument added at the
> >>>end to indicate that you want the new behaviour, though.  e.g.
> >>>
> >>>tapply <- function (X, INDEX, FUN=NULL, ..., simplify=TRUE,
> >>>handle.empty.levels = FALSE)
> >>>
> >>>but this raises the question of what sort of time penalty the
> >>>modification might entail.  Probably not much for most situations, I
> >>>suppose.  (I know this argument name looks long, but you do need a
> >>>fairly specific argument name, or it will start to impinge on the ...
> >>>argument.)
> >>>
> >>>Just some thoughts.
> >>>
> >>>Bill Venables.
> >>>
> >>>Bill Venables
> >>>CSIRO Laboratories
> >>>PO Box 120, Cleveland, 4163
> >>>AUSTRALIA
> >>>Office Phone (email preferred): +61 7 3826 7251
> >>>Fax (if absolutely necessary):  +61 7 3826 7304
> >>>Mobile:                         +61 4 8819 4402
> >>>Home Phone:                     +61 7 3286 7700
> >>>mailto:Bill.Venables at csiro.au
> >>>http://www.cmis.csiro.au/bill.venables/
> >>>
> >>>-----Original Message-----
> >>>From: r-devel-bounces at r-project.org
> >>>[mailto:r-devel-bounces at r-project.org] On Behalf Of Andrew Robinson
> >>>Sent: Tuesday, 6 November 2007 3:10 PM
> >>>To: R-Devel
> >>>Subject: [Rd] A suggestion for an amendment to tapply
> >>>
> >>>Dear R-developers,
> >>>
> >>>when tapply() is invoked on factors that have empty levels, it returns
> >>>NA.  This behaviour is in accord with the tapply documentation, and is
> >>>reasonable in many cases.  However, when FUN is sum, it would also
> >>>seem reasonable to return 0 instead of NA, because "the sum of an
> >>>empty set is zero, by definition."
> >>>
> >>>I'd like to raise a discussion of the possibility of an amendment to
> >>>tapply.
> >>>
> >>>The attached patch changes the function so that it checks if there are
> >>>any empty levels, and if there are, replaces the corresponding NA
> >>>values with the result of applying FUN to the empty set.  Eg in the
> >>>case of sum, it replaces the NA with 0, whereas with mean, it replaces
> >>>the NA with NA, and issues a warning.
> >>>
> >>>This change has the following advantage: tapply and sum work better
> >>>together.  Arguably, tapply and any other function that has a non-NA
> >>>response to the empty set will also work better together.
> >>>Furthermore, tapply shows a warning if FUN would normally show a
> >>>warning upon being evaluated on an empty set.  That deviates from
> >>>current behaviour, which might be bad, but also provides information
> >>>that might be useful to the user, so that would be good.
> >>>
> >>>The attached script provides the new function in full, and
> >>>demonstrates its application in some simple test cases.
> >>>
> >>>Best wishes,
> >>>
> >>>Andrew
> >>>
> >>>      
> >>-- 
> >>Brian D. Ripley,                  ripley at stats.ox.ac.uk
> >>Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> >>University of Oxford,             Tel:  +44 1865 272861 (self)
> >>1 South Parks Road,                     +44 1865 272866 (PA)
> >>Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> >>    
> >
> >  
> 
> 
> -- 
>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
> (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907

-- 
Andrew Robinson  
Department of Mathematics and Statistics            Tel: +61-3-8344-9763
University of Melbourne, VIC 3010 Australia         Fax: +61-3-8344-4599
http://www.ms.unimelb.edu.au/~andrewpr
http://blogs.mbs.edu/fishing-in-the-bay/


From smckinney at bccrc.ca  Thu Nov  8 02:00:23 2007
From: smckinney at bccrc.ca (Steven McKinney)
Date: Wed, 7 Nov 2007 17:00:23 -0800
Subject: [Rd] 64-bit R-build on Mac OS X 10.4 - make check failures
Message-ID: <0BE438149FF2254DB4199E2682C8DFEB0328A08E@crcmail1.BCCRC.CA>

Hi all,

I compiled 64-bit R on an Apple Mac G5 running OS X, but it failed 
make check.  Simon Urbanek suggested I post results to R-devel.

> On Nov 6, 2007, at 10:23 PM, Steven McKinney wrote:
> 

> > Hi Simon,
> >
> > Would you be able to give more guidance on how to compile 64-bit 
> > libiconv for Tiger,
> 
> You can get the sources from Apple and compile it:
> http://www.opensource.apple.com/darwinsource/tarballs/other/libiconv-13.2.tar.gz
> 
> If you want to save yourself the hassle, my 64-bit build can be 
> obtained and installed as follows:
> curl -s http://r.research.att.com/libiconv-quad.tar.gz | \
> sudo tar fvxz - -C /usr/lib

Many thanks to Simon Urbanek for providing a 64-bit libiconv for
use on the Apple Mac OS X platform.  This allowed compilation
on the Mac without having to use the '--without-iconv' switch
(for those of us who are not yet proficient at compiling 64-bit
libraries on the Mac).

Compilation of 64-bit R succeeded, but make check did not.

First failure was in ok-errors.R, and generated this output
in ok-errors.Rout.fail

   > ## bad infinite recursion / on.exit / ... interactions
   > bar <- function() 1+1
   > foo <- function() { on.exit(bar()); foo() }
   > foo() # now simple "infinite recursion"
   
    *** caught segfault ***
   address 0x7fffeff7ffe30, cause 'memory not mapped'
   
   Traceback:
    1: foo()
    2: foo()
    3: foo()
   ...
   2154: foo()
   2155: foo()
   2156: foo()
   aborting ...

Second error was in d-p-q-r-tests.Rout from this test:
   ## dbeta(*, ncp):
   a <- rlnorm(100)
   stopifnot(All.eq(a, dbeta(0, 1, a, ncp=0)),
             dbeta(0, 0.9, 2.2, ncp = c(0, a)) == Inf
             )
   ## the first gave 0, the 2nd NaN in R <= 2.3.0

and generated this
output in d-p-q-r-tests.Rout.fail

   > 
   > ## dbeta(*, ncp):
   > a <- rlnorm(100)
   > stopifnot(All.eq(a, dbeta(0, 1, a, ncp=0)),
   +           dbeta(0, 0.9, 2.2, ncp = c(0, a)) == Inf
   +           )
   Error: dbeta(0, 0.9, 2.2, ncp = c(0, a)) == Inf is not all TRUE
   In addition: Warning message:
   In dnbeta(x, shape1, shape2, ncp, log) : NaNs produced
   Execution halted

Everything else passed, so I'm not sure how serious these failures are.

I'd appreciate any suggestions about how to figure out what caused these 
failures (an inappropriate file somewhere in the path, a possible
bug, improper compilation commands etc.) 


version information of compiled R (compilation information at end):


> sessionInfo()
R version 2.6.0 Patched (2007-10-29 r43302) 
powerpc64-apple-darwin8.10.0 

locale:
C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] lme4_0.99875-8    Matrix_0.999375-3 lattice_0.17-2   

loaded via a namespace (and not attached):
[1] grid_2.6.0      rcompgen_0.1-17
> R.Version()
$platform
[1] "powerpc64-apple-darwin8.10.0"

$arch
[1] "powerpc64"

$os
[1] "darwin8.10.0"

$system
[1] "powerpc64, darwin8.10.0"

$status
[1] "Patched"

$major
[1] "2"

$minor
[1] "6.0"

$year
[1] "2007"

$month
[1] "10"

$day
[1] "29"

$`svn rev`
[1] "43302"

$language
[1] "R"

$version.string
[1] "R version 2.6.0 Patched (2007-10-29 r43302)"

> .Platform
$OS.type
[1] "unix"

$file.sep
[1] "/"

$dynlib.ext
[1] ".so"

$GUI
[1] "X11"

$endian
[1] "big"

$pkgType
[1] "source"

$path.sep
[1] ":"

$r_arch
[1] ""

> 

I built 64-bit R on Mac OS X 10.4.10 with these commands:

export PATH='/usr/local/lib64/X11/bin:/usr/local/lib64/X11/etc:/usr/local/lib64/X11/include:/usr/local/lib64/X11/lib:/usr/lib:/usr/bin:/usr/local/sbin:/usr/local/bin:/bin:/usr/sbin:/sbin:/usr/local/teTeX/bin/powerpc-apple-darwin-current:~/perl:~/bin'

./configure --host=powerpc64-apple-darwin8.10.0 --build=powerpc64-apple-darwin8.10.0 \
--prefix=/usr/local/lib64 'CC=gcc-4.0 -arch ppc64' 'CXX=g++ -arch ppc64' \
'FC=gfortran-4.0 -arch ppc64' 'F77=gfortran-4.0 -arch ppc64' \
'CFLAGS=-g -O3 -mtune=G5 -mcpu=G5' 'FFLAGS=-g -O3 -mtune=G5 -mcpu=G5' \
'LDFLAGS=-arch ppc64 -m64 -L/usr/local/lib' 'CXXFLAGS=-g -O3 -mtune=G5 -mcpu=G5' \
'FCFLAGS=-g -O3 -mtune=G5 -mcpu=G5' --disable-R-framework --enable-R-shlib \
'--with-blas=-framework vecLib' --with-lapack 1> configure.R.ppc64.out.20071107.Run01.txt 2>&1

sudo make 1> make.R.ppc64.out.20071107.Run01.txt  2>&1

sudo make check 1> make.check.R.ppc64.out.20071107.Run01.txt  2>&1




Steve McKinney


From ripley at stats.ox.ac.uk  Thu Nov  8 08:22:48 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 8 Nov 2007 07:22:48 +0000 (GMT)
Subject: [Rd] 64-bit R-build on Mac OS X 10.4 - make check failures
In-Reply-To: <0BE438149FF2254DB4199E2682C8DFEB0328A08E@crcmail1.BCCRC.CA>
References: <0BE438149FF2254DB4199E2682C8DFEB0328A08E@crcmail1.BCCRC.CA>
Message-ID: <Pine.LNX.4.64.0711080714420.31016@gannet.stats.ox.ac.uk>

I am not sure why Simon thought you should ask here (and not on R-sig-mac, 
say): it is almost certain these are problems with your system not R. 
For the first, use your debugger to find where the segfault occurred (it 
might be inadequate stack space).  For the second, look at the values of 
dbeta(0, 0.9, 2.2, ncp = c(0, a)), and trace the C code to find out why 
you are not getting Inf (it is probably a broken libm function).

I'd be worried about the first: the second is probably esoteric.

On Wed, 7 Nov 2007, Steven McKinney wrote:

> Hi all,
>
> I compiled 64-bit R on an Apple Mac G5 running OS X, but it failed
> make check.  Simon Urbanek suggested I post results to R-devel.
>
>> On Nov 6, 2007, at 10:23 PM, Steven McKinney wrote:
>>
>
>>> Hi Simon,
>>>
>>> Would you be able to give more guidance on how to compile 64-bit
>>> libiconv for Tiger,
>>
>> You can get the sources from Apple and compile it:
>> http://www.opensource.apple.com/darwinsource/tarballs/other/libiconv-13.2.tar.gz
>>
>> If you want to save yourself the hassle, my 64-bit build can be
>> obtained and installed as follows:
>> curl -s http://r.research.att.com/libiconv-quad.tar.gz | \
>> sudo tar fvxz - -C /usr/lib
>
> Many thanks to Simon Urbanek for providing a 64-bit libiconv for
> use on the Apple Mac OS X platform.  This allowed compilation
> on the Mac without having to use the '--without-iconv' switch
> (for those of us who are not yet proficient at compiling 64-bit
> libraries on the Mac).
>
> Compilation of 64-bit R succeeded, but make check did not.
>
> First failure was in ok-errors.R, and generated this output
> in ok-errors.Rout.fail
>
>   > ## bad infinite recursion / on.exit / ... interactions
>   > bar <- function() 1+1
>   > foo <- function() { on.exit(bar()); foo() }
>   > foo() # now simple "infinite recursion"
>
>    *** caught segfault ***
>   address 0x7fffeff7ffe30, cause 'memory not mapped'
>
>   Traceback:
>    1: foo()
>    2: foo()
>    3: foo()
>   ...
>   2154: foo()
>   2155: foo()
>   2156: foo()
>   aborting ...
>
> Second error was in d-p-q-r-tests.Rout from this test:
>   ## dbeta(*, ncp):
>   a <- rlnorm(100)
>   stopifnot(All.eq(a, dbeta(0, 1, a, ncp=0)),
>             dbeta(0, 0.9, 2.2, ncp = c(0, a)) == Inf
>             )
>   ## the first gave 0, the 2nd NaN in R <= 2.3.0
>
> and generated this
> output in d-p-q-r-tests.Rout.fail
>
>   >
>   > ## dbeta(*, ncp):
>   > a <- rlnorm(100)
>   > stopifnot(All.eq(a, dbeta(0, 1, a, ncp=0)),
>   +           dbeta(0, 0.9, 2.2, ncp = c(0, a)) == Inf
>   +           )
>   Error: dbeta(0, 0.9, 2.2, ncp = c(0, a)) == Inf is not all TRUE
>   In addition: Warning message:
>   In dnbeta(x, shape1, shape2, ncp, log) : NaNs produced
>   Execution halted
>
> Everything else passed, so I'm not sure how serious these failures are.
>
> I'd appreciate any suggestions about how to figure out what caused these
> failures (an inappropriate file somewhere in the path, a possible
> bug, improper compilation commands etc.)
>
>
> version information of compiled R (compilation information at end):
>
>
>> sessionInfo()
> R version 2.6.0 Patched (2007-10-29 r43302)
> powerpc64-apple-darwin8.10.0
>
> locale:
> C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] lme4_0.99875-8    Matrix_0.999375-3 lattice_0.17-2
>
> loaded via a namespace (and not attached):
> [1] grid_2.6.0      rcompgen_0.1-17
>> R.Version()
> $platform
> [1] "powerpc64-apple-darwin8.10.0"
>
> $arch
> [1] "powerpc64"
>
> $os
> [1] "darwin8.10.0"
>
> $system
> [1] "powerpc64, darwin8.10.0"
>
> $status
> [1] "Patched"
>
> $major
> [1] "2"
>
> $minor
> [1] "6.0"
>
> $year
> [1] "2007"
>
> $month
> [1] "10"
>
> $day
> [1] "29"
>
> $`svn rev`
> [1] "43302"
>
> $language
> [1] "R"
>
> $version.string
> [1] "R version 2.6.0 Patched (2007-10-29 r43302)"
>
>> .Platform
> $OS.type
> [1] "unix"
>
> $file.sep
> [1] "/"
>
> $dynlib.ext
> [1] ".so"
>
> $GUI
> [1] "X11"
>
> $endian
> [1] "big"
>
> $pkgType
> [1] "source"
>
> $path.sep
> [1] ":"
>
> $r_arch
> [1] ""
>
>>
>
> I built 64-bit R on Mac OS X 10.4.10 with these commands:
>
> export PATH='/usr/local/lib64/X11/bin:/usr/local/lib64/X11/etc:/usr/local/lib64/X11/include:/usr/local/lib64/X11/lib:/usr/lib:/usr/bin:/usr/local/sbin:/usr/local/bin:/bin:/usr/sbin:/sbin:/usr/local/teTeX/bin/powerpc-apple-darwin-current:~/perl:~/bin'
>
> ./configure --host=powerpc64-apple-darwin8.10.0 --build=powerpc64-apple-darwin8.10.0 \
> --prefix=/usr/local/lib64 'CC=gcc-4.0 -arch ppc64' 'CXX=g++ -arch ppc64' \
> 'FC=gfortran-4.0 -arch ppc64' 'F77=gfortran-4.0 -arch ppc64' \
> 'CFLAGS=-g -O3 -mtune=G5 -mcpu=G5' 'FFLAGS=-g -O3 -mtune=G5 -mcpu=G5' \
> 'LDFLAGS=-arch ppc64 -m64 -L/usr/local/lib' 'CXXFLAGS=-g -O3 -mtune=G5 -mcpu=G5' \
> 'FCFLAGS=-g -O3 -mtune=G5 -mcpu=G5' --disable-R-framework --enable-R-shlib \
> '--with-blas=-framework vecLib' --with-lapack 1> configure.R.ppc64.out.20071107.Run01.txt 2>&1
>
> sudo make 1> make.R.ppc64.out.20071107.Run01.txt  2>&1
>
> sudo make check 1> make.check.R.ppc64.out.20071107.Run01.txt  2>&1
>
>
>
>
> Steve McKinney
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From jerome.lemaitre.1 at ulaval.ca  Tue Nov  6 15:05:22 2007
From: jerome.lemaitre.1 at ulaval.ca (jerome.lemaitre.1 at ulaval.ca)
Date: Tue,  6 Nov 2007 15:05:22 +0100 (CET)
Subject: [Rd] R crashes when I open R files in R (PR#10402)
Message-ID: <20071106140523.08BC0283461C@mail.pubhealth.ku.dk>

Full_Name: Jerome Lemaitre
Version: 2.6.0
OS: Windows XP
Submission from: (NULL) (132.203.202.117)


Hello,

I have recently downloaded the 2.6.0 version of R and I experience troubles that
never happened to me with previous versions. 

I open an R session with an R shortcut in "My documents/Analyses". However, when
I want to open R files such script using "File/open script" R crashes. I have
made some tests and it appears that the software is more prone to crash when the
script in not located in the same folder as the R shortcut. For example, my
script may be in a subfolder: "My documents/Analyses/GLM". 

I hope you will find an easy way to fix this.

Thank you very much.

Sincerely,


From bornkamp at statistik.uni-dortmund.de  Wed Nov  7 13:30:23 2007
From: bornkamp at statistik.uni-dortmund.de (bornkamp at statistik.uni-dortmund.de)
Date: Wed,  7 Nov 2007 13:30:23 +0100 (CET)
Subject: [Rd] Documentation bug in kruskal.test (PR#10404)
Message-ID: <20071107123023.7B25F2834612@mail.pubhealth.ku.dk>

Full_Name: Bj??rn Bornkamp
Version: 2.6.0
OS: Windows XP
Submission from: (NULL) (129.217.207.144)


The literature reference in the documentation for the function kruskal.test is:

Myles Hollander & Douglas A. Wolfe (1973), Nonparametric statistical inference.
New York: John Wiley & Sons. Pages 115??120. 

But I believe it should be

Myles Hollander & Douglas A. Wolfe (1973), Nonparametric statistical methods.
New York: John Wiley & Sons. Pages 115??120. 

There is a different book from Jean Gibbons called "Nonparametric statistical
inference", but I believe it does not describe the corrected Kruskal Wallis test
statistic, when there are ties in the data...


From christoph.bonitz at gmail.com  Wed Nov  7 18:15:13 2007
From: christoph.bonitz at gmail.com (christoph.bonitz at gmail.com)
Date: Wed,  7 Nov 2007 18:15:13 +0100 (CET)
Subject: [Rd] Misleading error message for quartz.save (PR#10406)
Message-ID: <20071107171513.F0878282EFF6@mail.pubhealth.ku.dk>

Full_Name: Christoph Bonitz
Version: 2.5.1
OS: Mac OS 10.4
Submission from: (NULL) (84.112.127.131)


When trying something like this:

quartz.save("/path/and/filename.pdf",type=pdf)
(notice: type=pdf instead of the correct type="pdf")

the error message is:

"Filename must be a string."

The filename actually *is* a string, the *file type* isn't, therefore the
message is misleading. Change to something like

"File type must be a string"


From maechler at stat.math.ethz.ch  Thu Nov  8 10:18:31 2007
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 8 Nov 2007 10:18:31 +0100
Subject: [Rd] R 2.6.0 make check fails on SGI origin 350 and
In-Reply-To: <A8521DA1-CFA8-4B2D-896B-690AF301E122@ualberta.ca>
References: <42665B36-6FE2-48A4-A1C4-09F67D61A28C@ualberta.ca>
	<Pine.LNX.4.64.0711062341250.30885@gannet.stats.ox.ac.uk>
	<A8521DA1-CFA8-4B2D-896B-690AF301E122@ualberta.ca>
Message-ID: <18226.54375.972183.286953@stat.math.ethz.ch>


>>>>> "kM" == kamil Marcinkowski <kamil at ualberta.ca>
>>>>>     on Tue, 6 Nov 2007 17:02:56 -0700 writes:

    kM> Hello Prof Brian Ripley and list
    kM> There is no "d-p-q-r-tests.Rout" file, the following files do exists
    kM> and are being sent as attachments:

    kM> ./tests/d-p-q-r-tests.R ,
    kM> ./tests/d-p-q-r-tests.Rout.save , 
    kM> ./tests/d-p-q-r-tests.Rout.fail .

Thank you , Kamil.

It's only the  ....fail  one that is interesting to us (the
other two are part of the R sources!).

However, for attachments to make it through the anti-virus
anti-spam filters, you need to give them  MIME-type
'text/*' typically 'text/plain'
whereas many e-mail programs nowadays just blindly put
'application/octet-stream' ... the same format that viruses are
often using as well.

One way to help your e-mail software to use the proper mime
type, may be to rename the file to something like
   d-p-q-r-tests_Rout_fail.txt
			  ^^^^
With regards,
Martin Maechler, ETH Zurich


From murdoch at stats.uwo.ca  Thu Nov  8 12:09:58 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 08 Nov 2007 06:09:58 -0500
Subject: [Rd] R crashes when I open R files in R (PR#10402)
In-Reply-To: <20071106140523.08BC0283461C@mail.pubhealth.ku.dk>
References: <20071106140523.08BC0283461C@mail.pubhealth.ku.dk>
Message-ID: <4732EE86.3080302@stats.uwo.ca>

On 06/11/2007 9:05 AM, jerome.lemaitre.1 at ulaval.ca wrote:
> Full_Name: Jerome Lemaitre
> Version: 2.6.0
> OS: Windows XP
> Submission from: (NULL) (132.203.202.117)
> 
> 
> Hello,
> 
> I have recently downloaded the 2.6.0 version of R and I experience troubles that
> never happened to me with previous versions. 
> 
> I open an R session with an R shortcut in "My documents/Analyses". However, when
> I want to open R files such script using "File/open script" R crashes. I have
> made some tests and it appears that the software is more prone to crash when the
> script in not located in the same folder as the R shortcut. For example, my
> script may be in a subfolder: "My documents/Analyses/GLM". 
> 
> I hope you will find an easy way to fix this.

We need to reproduce it first.  I tried to follow your instructions, and 
didn't see a problem.  Could you please give complete details of a 
reproducible way to cause the crash, starting from an R session with an 
empty workspace?  Please be specific about the directory name, the file 
names, and the contents of the file you are trying to open.

Duncan Murdoch


From simon.urbanek at r-project.org  Thu Nov  8 14:27:34 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 8 Nov 2007 08:27:34 -0500
Subject: [Rd] 64-bit R-build on Mac OS X 10.4 - make check failures
In-Reply-To: <Pine.LNX.4.64.0711080714420.31016@gannet.stats.ox.ac.uk>
References: <0BE438149FF2254DB4199E2682C8DFEB0328A08E@crcmail1.BCCRC.CA>
	<Pine.LNX.4.64.0711080714420.31016@gannet.stats.ox.ac.uk>
Message-ID: <47E21C54-3744-48E5-A782-5B5354653373@r-project.org>


On Nov 8, 2007, at 2:22 AM, Prof Brian Ripley wrote:

> I am not sure why Simon thought you should ask here

mainly because of the d-p-q-r-test - I was wondering whether it falls  
in the category of too strict tests or is a more serious issue. I  
can't look into it myself right now, so I was hoping someone might  
have an idea ...

Thanks,
Simon


> (and not on R-sig-mac,
> say): it is almost certain these are problems with your system not R.
> For the first, use your debugger to find where the segfault  
> occurred (it
> might be inadequate stack space).  For the second, look at the  
> values of
> dbeta(0, 0.9, 2.2, ncp = c(0, a)), and trace the C code to find out  
> why
> you are not getting Inf (it is probably a broken libm function).
>
> I'd be worried about the first: the second is probably esoteric.
>
> On Wed, 7 Nov 2007, Steven McKinney wrote:
>
>> Hi all,
>>
>> I compiled 64-bit R on an Apple Mac G5 running OS X, but it failed
>> make check.  Simon Urbanek suggested I post results to R-devel.
>>
>>> On Nov 6, 2007, at 10:23 PM, Steven McKinney wrote:
>>>
>>
>>>> Hi Simon,
>>>>
>>>> Would you be able to give more guidance on how to compile 64-bit
>>>> libiconv for Tiger,
>>>
>>> You can get the sources from Apple and compile it:
>>> http://www.opensource.apple.com/darwinsource/tarballs/other/ 
>>> libiconv-13.2.tar.gz
>>>
>>> If you want to save yourself the hassle, my 64-bit build can be
>>> obtained and installed as follows:
>>> curl -s http://r.research.att.com/libiconv-quad.tar.gz | \
>>> sudo tar fvxz - -C /usr/lib
>>
>> Many thanks to Simon Urbanek for providing a 64-bit libiconv for
>> use on the Apple Mac OS X platform.  This allowed compilation
>> on the Mac without having to use the '--without-iconv' switch
>> (for those of us who are not yet proficient at compiling 64-bit
>> libraries on the Mac).
>>
>> Compilation of 64-bit R succeeded, but make check did not.
>>
>> First failure was in ok-errors.R, and generated this output
>> in ok-errors.Rout.fail
>>
>>> ## bad infinite recursion / on.exit / ... interactions
>>> bar <- function() 1+1
>>> foo <- function() { on.exit(bar()); foo() }
>>> foo() # now simple "infinite recursion"
>>
>>    *** caught segfault ***
>>   address 0x7fffeff7ffe30, cause 'memory not mapped'
>>
>>   Traceback:
>>    1: foo()
>>    2: foo()
>>    3: foo()
>>   ...
>>   2154: foo()
>>   2155: foo()
>>   2156: foo()
>>   aborting ...
>>
>> Second error was in d-p-q-r-tests.Rout from this test:
>>   ## dbeta(*, ncp):
>>   a <- rlnorm(100)
>>   stopifnot(All.eq(a, dbeta(0, 1, a, ncp=0)),
>>             dbeta(0, 0.9, 2.2, ncp = c(0, a)) == Inf
>>             )
>>   ## the first gave 0, the 2nd NaN in R <= 2.3.0
>>
>> and generated this
>> output in d-p-q-r-tests.Rout.fail
>>
>>>
>>> ## dbeta(*, ncp):
>>> a <- rlnorm(100)
>>> stopifnot(All.eq(a, dbeta(0, 1, a, ncp=0)),
>>   +           dbeta(0, 0.9, 2.2, ncp = c(0, a)) == Inf
>>   +           )
>>   Error: dbeta(0, 0.9, 2.2, ncp = c(0, a)) == Inf is not all TRUE
>>   In addition: Warning message:
>>   In dnbeta(x, shape1, shape2, ncp, log) : NaNs produced
>>   Execution halted
>>
>> Everything else passed, so I'm not sure how serious these failures  
>> are.
>>
>> I'd appreciate any suggestions about how to figure out what caused  
>> these
>> failures (an inappropriate file somewhere in the path, a possible
>> bug, improper compilation commands etc.)
>>
>>
>> version information of compiled R (compilation information at end):
>>
>>
>>> sessionInfo()
>> R version 2.6.0 Patched (2007-10-29 r43302)
>> powerpc64-apple-darwin8.10.0
>>
>> locale:
>> C
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] lme4_0.99875-8    Matrix_0.999375-3 lattice_0.17-2
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.6.0      rcompgen_0.1-17
>>> R.Version()
>> $platform
>> [1] "powerpc64-apple-darwin8.10.0"
>>
>> $arch
>> [1] "powerpc64"
>>
>> $os
>> [1] "darwin8.10.0"
>>
>> $system
>> [1] "powerpc64, darwin8.10.0"
>>
>> $status
>> [1] "Patched"
>>
>> $major
>> [1] "2"
>>
>> $minor
>> [1] "6.0"
>>
>> $year
>> [1] "2007"
>>
>> $month
>> [1] "10"
>>
>> $day
>> [1] "29"
>>
>> $`svn rev`
>> [1] "43302"
>>
>> $language
>> [1] "R"
>>
>> $version.string
>> [1] "R version 2.6.0 Patched (2007-10-29 r43302)"
>>
>>> .Platform
>> $OS.type
>> [1] "unix"
>>
>> $file.sep
>> [1] "/"
>>
>> $dynlib.ext
>> [1] ".so"
>>
>> $GUI
>> [1] "X11"
>>
>> $endian
>> [1] "big"
>>
>> $pkgType
>> [1] "source"
>>
>> $path.sep
>> [1] ":"
>>
>> $r_arch
>> [1] ""
>>
>>>
>>
>> I built 64-bit R on Mac OS X 10.4.10 with these commands:
>>
>> export PATH='/usr/local/lib64/X11/bin:/usr/local/lib64/X11/etc:/ 
>> usr/local/lib64/X11/include:/usr/local/lib64/X11/lib:/usr/lib:/usr/ 
>> bin:/usr/local/sbin:/usr/local/bin:/bin:/usr/sbin:/sbin:/usr/local/ 
>> teTeX/bin/powerpc-apple-darwin-current:~/perl:~/bin'
>>
>> ./configure --host=powerpc64-apple-darwin8.10.0 --build=powerpc64- 
>> apple-darwin8.10.0 \
>> --prefix=/usr/local/lib64 'CC=gcc-4.0 -arch ppc64' 'CXX=g++ -arch  
>> ppc64' \
>> 'FC=gfortran-4.0 -arch ppc64' 'F77=gfortran-4.0 -arch ppc64' \
>> 'CFLAGS=-g -O3 -mtune=G5 -mcpu=G5' 'FFLAGS=-g -O3 -mtune=G5 - 
>> mcpu=G5' \
>> 'LDFLAGS=-arch ppc64 -m64 -L/usr/local/lib' 'CXXFLAGS=-g -O3 - 
>> mtune=G5 -mcpu=G5' \
>> 'FCFLAGS=-g -O3 -mtune=G5 -mcpu=G5' --disable-R-framework --enable- 
>> R-shlib \
>> '--with-blas=-framework vecLib' --with-lapack 1>  
>> configure.R.ppc64.out.20071107.Run01.txt 2>&1
>>
>> sudo make 1> make.R.ppc64.out.20071107.Run01.txt  2>&1
>>
>> sudo make check 1> make.check.R.ppc64.out.20071107.Run01.txt  2>&1
>>
>>
>>
>>
>> Steve McKinney
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From kamil at ualberta.ca  Thu Nov  8 17:41:05 2007
From: kamil at ualberta.ca (kamil Marcinkowski)
Date: Thu, 8 Nov 2007 09:41:05 -0700
Subject: [Rd] R 2.6.0 make check fails on SGI origin 350 and
In-Reply-To: <18226.54375.972183.286953@stat.math.ethz.ch>
References: <42665B36-6FE2-48A4-A1C4-09F67D61A28C@ualberta.ca>
	<Pine.LNX.4.64.0711062341250.30885@gannet.stats.ox.ac.uk>
	<A8521DA1-CFA8-4B2D-896B-690AF301E122@ualberta.ca>
	<18226.54375.972183.286953@stat.math.ethz.ch>
Message-ID: <6B3A01D9-B6A9-483A-9EA6-013BA8743BDD@ualberta.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20071108/f5e0108c/attachment.pl 

From maechler at stat.math.ethz.ch  Thu Nov  8 18:43:57 2007
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 8 Nov 2007 18:43:57 +0100
Subject: [Rd] R 2.6.0 make check fails on SGI origin 350 and
In-Reply-To: <6B3A01D9-B6A9-483A-9EA6-013BA8743BDD@ualberta.ca>
References: <42665B36-6FE2-48A4-A1C4-09F67D61A28C@ualberta.ca>
	<Pine.LNX.4.64.0711062341250.30885@gannet.stats.ox.ac.uk>
	<A8521DA1-CFA8-4B2D-896B-690AF301E122@ualberta.ca>
	<18226.54375.972183.286953@stat.math.ethz.ch>
	<6B3A01D9-B6A9-483A-9EA6-013BA8743BDD@ualberta.ca>
Message-ID: <18227.19165.686297.222253@stat.math.ethz.ch>

Thanks a lot Kamil,
for the confirmation:

>>>>> "kM" == kamil Marcinkowski <kamil at ualberta.ca>
>>>>>     on Thu, 8 Nov 2007 09:41:05 -0700 writes:

    kM> Hello list
    kM> Here are the results of the tests on R 2.6.0 patched:

    >> R version 2.6.0 Patched (2007-11-05 r43362)
    >> Copyright (C) 2007 The R Foundation for Statistical Computing
    >> ISBN 3-900051-07-0

    kM> ...

    >> >  str(.Machine, digits=7)
    >> List of 18
    >> $ double.eps           : num 2.220446e-16
    >> $ double.neg.eps       : num 1.110223e-16
    >> $ double.xmin          : num 2.225074e-308
    >> $ double.xmax          : num 1.797693e+308
    >> $ double.base          : int 2
    >> $ double.digits        : int 53
    >> $ double.rounding      : int 2
    >> $ double.guard         : int 0
    >> $ double.ulp.digits    : int -52
    >> $ double.neg.ulp.digits: int -53
    >> $ double.exponent      : int 11
    >> $ double.min.exp       : int -1022
    >> $ double.max.exp       : int 1024
    >> $ integer.max          : int 2147483647
    >> $ sizeof.long          : int 4
    >> $ sizeof.longlong      : int 8
    >> $ sizeof.longdouble    : int 16
    >> $ sizeof.pointer       : int 4
    >> 

    >> > dpois( 10, 10^(-290:-310), log=TRUE)
    >> [1] -6692.601 -6715.627 -6738.653 -6761.679 -6784.705 -6807.730 -6830.756
    >> [8] -6853.782 -6876.808 -6899.834 -6922.860 -6945.886 -6968.911 -6991.937
    >> [15] -7014.963 -7037.989 -7061.015 -7084.041     -Inf      -Inf      -Inf
    >> 


    >> > All.eq(dpois(  10*1:2, 3e-308, log=TRUE), c(-7096.08037610806,  
    >> -14204.2875435307))
    >> Error: could not find function "All.eq"


    kM> I copied the All.eq function from d-p-q-r-tests.R file  and rerun he  
    kM> test:

    >> > All.eq <- function(x,y) {
    >> all.equal.numeric(x,y, tolerance= 64*.Machine$double.eps,
    >> scale = max(0, mean(abs(x), na.rm=TRUE)))
    >> }
    >> + + + >
    >> > All.eq(dpois(  10*1:2, 3e-308, log=TRUE), c(-7096.08037610806,  
    >> -14204.2875435307))
    >> [1] TRUE

Very good. 

So after, the SGI only has slight problems with so-called
denormalized numbers; this is not considered a big problem
and the next versions of R will have the check above, instead of
the one that gave an error.

Thank you again for your feedback!
Regards,
Martin Maechler, ETH Zurich


    kM> Cheers,

    kM> Kamil

    kM> Kamil Marcinkowski                   Westgrid System Administrator
    kM> kamil at ualberta.ca                     University of Alberta site
    kM> Tel.780 492-0354                     Research Computing Support
    kM> Fax.780 492-1729                     Academic ICT
    kM> Edmonton, Alberta, CANADA    University of Alberta


From tkeitt at gmail.com  Thu Nov  8 19:56:15 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Thu, 8 Nov 2007 12:56:15 -0600
Subject: [Rd] Can a package override the default color palette?
Message-ID: <6262c54c0711081056g27ca1edemeadcae59e2a8b74b@mail.gmail.com>

Is it is possible for a package to override the default color palette
used by "image". I've tried a few different ways, but was curious if
there is an approved method.

THK

-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/


From simon.debernard at altrabio.com  Thu Nov  8 18:05:03 2007
From: simon.debernard at altrabio.com (simon.debernard at altrabio.com)
Date: Thu,  8 Nov 2007 18:05:03 +0100 (CET)
Subject: [Rd] small performance enhancement suggestion (PR#10409)
Message-ID: <20071108170503.E66DC282EFF8@mail.pubhealth.ku.dk>

Full_Name: Simon de Bernard
Version: 
OS: 
Submission from: (NULL) (140.77.34.213)


In src/main/dotcode.c, function RObjToCPtr, test for naok should be transferred
outside of the loops...


From kingsley.oteng-amoako at macquarie.com  Thu Nov  8 23:55:08 2007
From: kingsley.oteng-amoako at macquarie.com (kingsley.oteng-amoako at macquarie.com)
Date: Thu,  8 Nov 2007 23:55:08 +0100 (CET)
Subject: [Rd] Col.names parameter in write.csv (PR#10411)
Message-ID: <20071108225508.63D54282EFF1@mail.pubhealth.ku.dk>

Full_Name: Kingsley Oteng-Amoako
Version: 2.5.1
OS: Windows 5.1.2600 (Windows XP)
Submission from: (NULL) (203.185.215.144)


The col.names=false in the write.csv command does not work as documented.
Attempting to write a vector to a csv file without column headers does not work
as documented. 

The col.names=false feature on the write.table command does however work and it
can thus be coerced into behaving like the write.csv command - which suggests
that there is  a simple error with the write.csv command code.


From P.Dalgaard at biostat.ku.dk  Fri Nov  9 11:23:35 2007
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri, 09 Nov 2007 11:23:35 +0100
Subject: [Rd] Col.names parameter in write.csv (PR#10411)
In-Reply-To: <20071108225508.63D54282EFF1@mail.pubhealth.ku.dk>
References: <20071108225508.63D54282EFF1@mail.pubhealth.ku.dk>
Message-ID: <47343527.9000703@biostat.ku.dk>

kingsley.oteng-amoako at macquarie.com wrote:
> Full_Name: Kingsley Oteng-Amoako
> Version: 2.5.1
> OS: Windows 5.1.2600 (Windows XP)
> Submission from: (NULL) (203.185.215.144)
>
>
> The col.names=false in the write.csv command does not work as documented.
> Attempting to write a vector to a csv file without column headers does not work
> as documented. 
>
> The col.names=false feature on the write.table command does however work and it
> can thus be coerced into behaving like the write.csv command - which suggests
> that there is  a simple error with the write.csv command code.
>   
No, this is exacly as documented:


    'write.csv' and 'write.csv2' provide convenience wrappers for
     writing CSV files.  They set 'sep', 'dec' and 'qmethod', and
     'col.names' to 'NA' if 'row.names = TRUE' and 'TRUE' otherwise.
.....
     These wrappers are deliberately inflexible: they are designed to
     ensure that the correct conventions are used to write a valid
     file. Attempts to change 'col.names', 'sep', 'dec' or 'qmethod'
     are ignored, with a warning.

(I forget whether the warning bit is new in 2.6.x, though)

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From ripley at stats.ox.ac.uk  Fri Nov  9 12:05:13 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Fri,  9 Nov 2007 12:05:13 +0100 (CET)
Subject: [Rd] Col.names parameter in write.csv (PR#10411)
Message-ID: <20071109110513.F3A42282EFF8@mail.pubhealth.ku.dk>

On Fri, 9 Nov 2007, Peter Dalgaard wrote:

> kingsley.oteng-amoako at macquarie.com wrote:
>> Full_Name: Kingsley Oteng-Amoako
>> Version: 2.5.1
>> OS: Windows 5.1.2600 (Windows XP)
>> Submission from: (NULL) (203.185.215.144)
>>
>>
>> The col.names=false in the write.csv command does not work as documented.
>> Attempting to write a vector to a csv file without column headers does not work
>> as documented.
>>
>> The col.names=false feature on the write.table command does however work and it
>> can thus be coerced into behaving like the write.csv command - which suggests
>> that there is  a simple error with the write.csv command code.
>>
> No, this is exacly as documented:
>
>
>    'write.csv' and 'write.csv2' provide convenience wrappers for
>     writing CSV files.  They set 'sep', 'dec' and 'qmethod', and
>     'col.names' to 'NA' if 'row.names = TRUE' and 'TRUE' otherwise.
> .....
>     These wrappers are deliberately inflexible: they are designed to
>     ensure that the correct conventions are used to write a valid
>     file. Attempts to change 'col.names', 'sep', 'dec' or 'qmethod'
>     are ignored, with a warning.
>
> (I forget whether the warning bit is new in 2.6.x, though)

It is unchanged since June 2005, and appeared in this form in R 2.2.0.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From William.Fulton at ubs.com  Fri Nov  9 12:18:39 2007
From: William.Fulton at ubs.com (William.Fulton at ubs.com)
Date: Fri, 9 Nov 2007 11:18:39 -0000
Subject: [Rd] Building Rdll.lib with Visual C++
Message-ID: <E81FF08A6B0BD24CB237041DEF7FAEB308A7C503@NLDNC101PEX1.ubsw.net>

>From the R-2.6.0/doc/README.packages it says:

  Using Visual C++
  ================

  You may if you prefer use Visual C++ to make the DLLs (unless they use
  Fortran source!). The notes here were tested with VC++6.

  First build the import library Rdll.lib by

	make R.exp
  ...

In the installation (R-2.6.0-win32.exe) there is no Makefile with an
R.exp target that I could find and I get (using Cygwin's make):

$ pwd
/c/Program Files/R/R-2.6.0/src/gnuwin32
$ make R.exp
make: *** No rule to make target `R.exp'.  Stop.

I found a R.exp target in the gnuwin32/Makefile after extracting the
files in R-2.6.0.tar.gz. However, attempting to use this target fails,
it looks like it is attempting to build the object files in R.dll first.
Do I have to go figure out how to build R from Source in order to get
the Rdll.lib file or am I doing something fundamentally wrong?

Perhaps the maintainers would consider shipping Rdll.lib in the future
with the distribution like the equivalent .lib file is done for building
extensions for Perl, Ruby, Tcl, Python etc.

William
Visit our website at http://www.ubs.com

This message contains confidential information and is in...{{dropped:28}}


From ripley at stats.ox.ac.uk  Fri Nov  9 13:17:12 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 9 Nov 2007 12:17:12 +0000 (GMT)
Subject: [Rd] Building Rdll.lib with Visual C++
In-Reply-To: <E81FF08A6B0BD24CB237041DEF7FAEB308A7C503@NLDNC101PEX1.ubsw.net>
References: <E81FF08A6B0BD24CB237041DEF7FAEB308A7C503@NLDNC101PEX1.ubsw.net>
Message-ID: <Pine.LNX.4.64.0711091211040.23116@gannet.stats.ox.ac.uk>

On Fri, 9 Nov 2007, William.Fulton at ubs.com wrote:

>> From the R-2.6.0/doc/README.packages it says:
>
>  Using Visual C++
>  ================
>
>  You may if you prefer use Visual C++ to make the DLLs (unless they use
>  Fortran source!). The notes here were tested with VC++6.
>
>  First build the import library Rdll.lib by
>
> 	make R.exp
>  ...
>
> In the installation (R-2.6.0-win32.exe) there is no Makefile with an
> R.exp target that I could find and I get (using Cygwin's make):
>
> $ pwd
> /c/Program Files/R/R-2.6.0/src/gnuwin32
> $ make R.exp
> make: *** No rule to make target `R.exp'.  Stop.
>
> I found a R.exp target in the gnuwin32/Makefile after extracting the
> files in R-2.6.0.tar.gz. However, attempting to use this target fails,
> it looks like it is attempting to build the object files in R.dll first.
> Do I have to go figure out how to build R from Source in order to get
> the Rdll.lib file or am I doing something fundamentally wrong?

You do (although it only involves RTFM).  Alternatively, you could be less 
selective in your reading, and note it also says

   (Another, less reliable, way to make R.exp is to use pexports.exe from
   mingw-utils.)

The reason for the comment is that some earlier versions of pexports.exe 
used to choke, but it seems to work on all recent versions.

> Perhaps the maintainers would consider shipping Rdll.lib in the future
> with the distribution like the equivalent .lib file is done for building
> extensions for Perl, Ruby, Tcl, Python etc.

But they are built with VC++, and R is not.  No such file is needed to 
build extensions for R using the recommended tools.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch at stats.uwo.ca  Fri Nov  9 16:47:06 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 09 Nov 2007 10:47:06 -0500
Subject: [Rd] R crashes when I open R files in R (PR#10402)
In-Reply-To: <003801c822e5$8f14f670$ad3ee350$@lemaitre.1@ulaval.ca>
References: <20071106140523.08BC0283461C@mail.pubhealth.ku.dk>
	<4732EE86.3080302@stats.uwo.ca>
	<003801c822e5$8f14f670$ad3ee350$@lemaitre.1@ulaval.ca>
Message-ID: <473480FA.4010304@stats.uwo.ca>

On 11/9/2007 10:31 AM, J?r?me Lema?tre wrote:
> Dear Duncan,
> 
> I thank you very much for your attention and I apologize for the few
> information. Here is some more... I have made some tests and I think that I
> have found the problem.
> The thing is that R crashes when both of the followings happen:

Thanks, I can reproduce it now.  Looks as though we've got a buffer 
somewhere that's too short.

I'll track it down and fix it.

Duncan Murdoch

> 
> 1) The name of the script (a file saved as R file, e.g. "test.R" through the
> command "File/Save as" in a R session) has more than 5 characters.
> Capitalization, numbers of letters do not seem to matter.
> 
> 2) The location of the script is in a subfolder of third order as compared
> to the R session.
> 
> 
> For example, my R session is in:
> C:\Documents and Settings\Administrateur\Mes documents\Analyses\AnalysesGUD\
> 
> So I'm able to open any R file, whatever the number of character in its
> name, if it is located in
> C:\Documents and Settings\Administrateur\Mes documents\Analyses\AnalysesGUD\
> 
> Or in
> C:\Documents and Settings\Administrateur\Mes
> documents\Analyses\AnalysesGUD\PourArticle\
> 
> Or in 
> C:\Documents and Settings\Administrateur\Mes
> documents\Analyses\AnalysesGUD\PourArticle\Analyses\
> 
> However, it crashes if the name of the R file has more than 5 characters and
> is located in
> C:\Documents and Settings\Administrateur\Mes
> documents\Analyses\AnalysesGUD\PourArticle\Analyses\ModeleDensiT\
> 
> And other subfolders.
> 
> I hope this is enough and that you'll be able to find a way to solve that. 
> Thank you very much for your help.
> 
> 
> 
> 
> J?r?me
> 
> ============
> J?r?me Lema?tre
> Chaire de recherche industrielle CRSNG - Universit? Laval en sylviculture et
> faune
> D?partement de biologie,
> Pavillon Alexandre-Vachon, Local 2044
> Universit? Laval
> Qu?bec, QC  G1K 7P4
> Canada
> (418) 656-2131 #2917
> 
> 
> 
> 
> -----Message d'origine-----
> De : Duncan Murdoch [mailto:murdoch at stats.uwo.ca] 
> Envoy? : 8 novembre 2007 06:10
> ? : jerome.lemaitre.1 at ulaval.ca
> Cc : r-devel at stat.math.ethz.ch; R-bugs at biostat.ku.dk
> Objet : Re: [Rd] R crashes when I open R files in R (PR#10402)
> 
> On 06/11/2007 9:05 AM, jerome.lemaitre.1 at ulaval.ca wrote:
>> Full_Name: Jerome Lemaitre
>> Version: 2.6.0
>> OS: Windows XP
>> Submission from: (NULL) (132.203.202.117)
>> 
>> 
>> Hello,
>> 
>> I have recently downloaded the 2.6.0 version of R and I experience
> troubles that
>> never happened to me with previous versions. 
>> 
>> I open an R session with an R shortcut in "My documents/Analyses".
> However, when
>> I want to open R files such script using "File/open script" R crashes. I
> have
>> made some tests and it appears that the software is more prone to crash
> when the
>> script in not located in the same folder as the R shortcut. For example,
> my
>> script may be in a subfolder: "My documents/Analyses/GLM". 
>> 
>> I hope you will find an easy way to fix this.
> 
> We need to reproduce it first.  I tried to follow your instructions, and 
> didn't see a problem.  Could you please give complete details of a 
> reproducible way to cause the crash, starting from an R session with an 
> empty workspace?  Please be specific about the directory name, the file 
> names, and the contents of the file you are trying to open.
> 
> Duncan Murdoch
> 
>


From jerome.lemaitre.1 at ulaval.ca  Fri Nov  9 16:31:11 2007
From: jerome.lemaitre.1 at ulaval.ca (=?iso-8859-1?B?Suly9G1lIExlbWHudHJl?=)
Date: Fri, 9 Nov 2007 10:31:11 -0500
Subject: [Rd] R crashes when I open R files in R (PR#10402)
In-Reply-To: <4732EE86.3080302@stats.uwo.ca>
References: <20071106140523.08BC0283461C@mail.pubhealth.ku.dk>
	<4732EE86.3080302@stats.uwo.ca>
Message-ID: <003801c822e5$8f14f670$ad3ee350$@lemaitre.1@ulaval.ca>

Dear Duncan,

I thank you very much for your attention and I apologize for the few
information. Here is some more... I have made some tests and I think that I
have found the problem.
The thing is that R crashes when both of the followings happen:

1) The name of the script (a file saved as R file, e.g. "test.R" through the
command "File/Save as" in a R session) has more than 5 characters.
Capitalization, numbers of letters do not seem to matter.

2) The location of the script is in a subfolder of third order as compared
to the R session.


For example, my R session is in:
C:\Documents and Settings\Administrateur\Mes documents\Analyses\AnalysesGUD\

So I'm able to open any R file, whatever the number of character in its
name, if it is located in
C:\Documents and Settings\Administrateur\Mes documents\Analyses\AnalysesGUD\

Or in
C:\Documents and Settings\Administrateur\Mes
documents\Analyses\AnalysesGUD\PourArticle\

Or in 
C:\Documents and Settings\Administrateur\Mes
documents\Analyses\AnalysesGUD\PourArticle\Analyses\

However, it crashes if the name of the R file has more than 5 characters and
is located in
C:\Documents and Settings\Administrateur\Mes
documents\Analyses\AnalysesGUD\PourArticle\Analyses\ModeleDensiT\

And other subfolders.

I hope this is enough and that you'll be able to find a way to solve that. 
Thank you very much for your help.




J?r?me

============
J?r?me Lema?tre
Chaire de recherche industrielle CRSNG - Universit? Laval en sylviculture et
faune
D?partement de biologie,
Pavillon Alexandre-Vachon, Local 2044
Universit? Laval
Qu?bec, QC  G1K 7P4
Canada
(418) 656-2131 #2917




-----Message d'origine-----
De?: Duncan Murdoch [mailto:murdoch at stats.uwo.ca] 
Envoy??: 8 novembre 2007 06:10
??: jerome.lemaitre.1 at ulaval.ca
Cc?: r-devel at stat.math.ethz.ch; R-bugs at biostat.ku.dk
Objet?: Re: [Rd] R crashes when I open R files in R (PR#10402)

On 06/11/2007 9:05 AM, jerome.lemaitre.1 at ulaval.ca wrote:
> Full_Name: Jerome Lemaitre
> Version: 2.6.0
> OS: Windows XP
> Submission from: (NULL) (132.203.202.117)
> 
> 
> Hello,
> 
> I have recently downloaded the 2.6.0 version of R and I experience
troubles that
> never happened to me with previous versions. 
> 
> I open an R session with an R shortcut in "My documents/Analyses".
However, when
> I want to open R files such script using "File/open script" R crashes. I
have
> made some tests and it appears that the software is more prone to crash
when the
> script in not located in the same folder as the R shortcut. For example,
my
> script may be in a subfolder: "My documents/Analyses/GLM". 
> 
> I hope you will find an easy way to fix this.

We need to reproduce it first.  I tried to follow your instructions, and 
didn't see a problem.  Could you please give complete details of a 
reproducible way to cause the crash, starting from an R session with an 
empty workspace?  Please be specific about the directory name, the file 
names, and the contents of the file you are trying to open.

Duncan Murdoch


From marc_schwartz at comcast.net  Fri Nov  9 18:41:02 2007
From: marc_schwartz at comcast.net (Marc Schwartz)
Date: Fri, 09 Nov 2007 11:41:02 -0600
Subject: [Rd] make check-all fails on F8
Message-ID: <1194630062.15847.63.camel@Bellerophon.localdomain>

Hi all,

Clean install of F8 yesterday. This was not an upgrade, as I did some
re-partitioning of my HD to remove Windows (finally...) and no-longer
have a dual-boot laptop.

Using R 2.6.0 patched from SVN (rev 43319), which was the last rev that
I had on F7 and which passed all tests, I am now getting errors when
running make check-all on F8.

I have isolated the problem to the regression tests.

I have attached the two relevant files here. When running make
check-all, I get:

...
running regression tests
make[3]: Entering directory `/home/marcs/R.Files/SourceCode/SVN/tests'
running code in 'reg-tests-1.R' ... OK
running code in 'reg-tests-2.R' ... OK
comparing 'reg-tests-2.Rout' to './reg-tests-2.Rout.save' ... OK
running code in 'reg-IO.R' ... OK
comparing 'reg-IO.Rout' to './reg-IO.Rout.save' ...44c44
< In readLines("testIO.R") : incomplete final line found on 'testIO.R'
---
> In readLines("testIO.R") : incomplete final line found on 'testIO.R' 
88c88
< In readLines("testIO.R") : incomplete final line found on 'testIO.R'
---
> In readLines("testIO.R") : incomplete final line found on 'testIO.R' 
111c111
< In readLines("testIO.R") : incomplete final line found on 'testIO.R'
---
> In readLines("testIO.R") : incomplete final line found on 'testIO.R' 
134c134
< In readLines("testIO.R") : incomplete final line found on 'testIO.R'
---
> In readLines("testIO.R") : incomplete final line found on 'testIO.R' 
make[3]: *** [reg-IO.Rout] Error 1
make[3]: Leaving directory `/home/marcs/R.Files/SourceCode/SVN/tests'
make[2]: *** [test-Reg] Error 2
make[2]: Leaving directory `/home/marcs/R.Files/SourceCode/SVN/tests'
make[1]: *** [test-all-basics] Error 1
make[1]: Leaving directory `/home/marcs/R.Files/SourceCode/SVN/tests'
make: *** [check-all] Error 2



If I just run a diff on these two files, I get:

$ diff reg-IO.Rout.save reg-IO.Rout.fail
2c2
< R version 2.6.0 Under development (unstable) (2007-05-22 r41673)
---
> R version 2.6.0 Patched (2007-11-01 r43319)
59c59
< In readLines("testIO.R") : incomplete final line found on 'testIO.R' 
---
> In readLines("testIO.R") : incomplete final line found on 'testIO.R'
103c103
< In readLines("testIO.R") : incomplete final line found on 'testIO.R' 
---
> In readLines("testIO.R") : incomplete final line found on 'testIO.R'
126c126
< In readLines("testIO.R") : incomplete final line found on 'testIO.R' 
---
> In readLines("testIO.R") : incomplete final line found on 'testIO.R'
149c149
< In readLines("testIO.R") : incomplete final line found on 'testIO.R' 
---
> In readLines("testIO.R") : incomplete final line found on 'testIO.R'



I thought that I was going blind, as I did not see any differences.
However, it is blindingly subtle. On the 'save' version of the file,
there is a space character ' ' at the end of the line, whereas on the
'fail' version of the line, it ends at the single quote character.

I verified this using hex mode in Emacs. In the 'save' version of the
file, the line, after the single quote, ends with '200a', whereas in the
'fail' version of the file, the line ends with '0a'.

I went back to my last F7 backup to check the same files from my last
build.

In the 'save' version of the file, the same lines also end with '200a'.
In the 'pass' version of the file, the line ends with '0a', which is the
same as the 'fail' version of the file on F8.

So on F7, despite the differences in line ends, make check-all passed.

I have been looking ("tunnel vision") at this now for several hours
going back to last night, and am probably missing something basic here,
but is this the result of a change in the behavior of diff on F8, or is
something else going on that I am just missing?

Thanks,

Marc Schwartz

-------------- next part --------------

R version 2.6.0 Patched (2007-11-01 r43319)
Copyright (C) 2007 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ## NB: this file must be a DOS (CRLF) format file
> 
> ## Keep comments and original formatting
> options(keep.source=TRUE)
> 
> ## simple tests that multiple lines are read correctly
> print(2+3)
[1] 5
> print(4+5)
[1] 9
> 
> ## generate some files to source
> 
> z <- c("#line 1", "2+3", "ls()", "pi", "# last line")
> 
> ## ========  LF file
> cat(z, file="testIO.R", sep="\n")
> readLines("testIO.R")
[1] "#line 1"     "2+3"         "ls()"        "pi"          "# last line"
> source("testIO.R", echo=TRUE)

> #line 1
> 2+3
[1] 5

> ls()
[1] "z"

> pi
[1] 3.141593
> unlink("testIO.R")
> 
> ## ======== LF file, incomplete final line
> zz <- file("testIO.R", "wt")
> cat(z, file=zz, sep="\n")
> cat("5+6", file=zz)
> close(zz)
> readLines("testIO.R")
[1] "#line 1"     "2+3"         "ls()"        "pi"          "# last line"
[6] "5+6"        
Warning message:
In readLines("testIO.R") : incomplete final line found on 'testIO.R'
> source("testIO.R", echo=TRUE)

> #line 1
> 2+3
[1] 5

> ls()
[1] "z"  "zz"

> pi
[1] 3.141593

> # last line
> 5+6
[1] 11
> unlink("testIO.R")
> 
> ## ======== CRLF file
> cat(z, file="testIO.R", sep="\r\n")
> source("testIO.R", echo=TRUE)

> #line 1
> 2+3
[1] 5

> ls()
[1] "z"  "zz"

> pi
[1] 3.141593
> readLines("testIO.R")
[1] "#line 1"     "2+3"         "ls()"        "pi"          "# last line"
> unlink("testIO.R")
> 
> ## ======== CRLF file, incomplete final line
> zz <- file("testIO.R", "wt")
> cat(z, file=zz, sep="\r\n")
> cat("5+6", file=zz)
> close(zz)
> readLines("testIO.R")
[1] "#line 1"     "2+3"         "ls()"        "pi"          "# last line"
[6] "5+6"        
Warning message:
In readLines("testIO.R") : incomplete final line found on 'testIO.R'
> source("testIO.R", echo=TRUE)

> #line 1
> 2+3
[1] 5

> ls()
[1] "z"  "zz"

> pi
[1] 3.141593

> # last line
> 5+6
[1] 11
> unlink("testIO.R")
> 
> ## ======== CR file
> cat(z, file="testIO.R", sep="\r")
> readLines("testIO.R")
[1] "#line 1"     "2+3"         "ls()"        "pi"          "# last line"
Warning message:
In readLines("testIO.R") : incomplete final line found on 'testIO.R'
> source("testIO.R", echo=TRUE)

> #line 1
> 2+3
[1] 5

> ls()
[1] "z"  "zz"

> pi
[1] 3.141593
> unlink("testIO.R")
> 
> ## ======== CR file, incomplete final line
> zz <- file("testIO.R", "wt")
> cat(z, file=zz, sep="\r")
> cat("\r5+6", file=zz)
> close(zz)
> readLines("testIO.R")
[1] "#line 1"     "2+3"         "ls()"        "pi"          "# last line"
[6] "5+6"        
Warning message:
In readLines("testIO.R") : incomplete final line found on 'testIO.R'
> source("testIO.R", echo=TRUE)

> #line 1
> 2+3
[1] 5

> ls()
[1] "z"  "zz"

> pi
[1] 3.141593

> # last line
> 5+6
[1] 11
> unlink("testIO.R")
> 
> ## end of reg-IO.R: the next line has no EOL chars
> 2 + 2
[1] 4
> 
-------------- next part --------------

R version 2.6.0 Under development (unstable) (2007-05-22 r41673)
Copyright (C) 2007 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ## NB: this file must be a DOS (CRLF) format file
> 
> ## Keep comments and original formatting
> options(keep.source=TRUE)
> 
> ## simple tests that multiple lines are read correctly
> print(2+3)
[1] 5
> print(4+5)
[1] 9
> 
> ## generate some files to source
> 
> z <- c("#line 1", "2+3", "ls()", "pi", "# last line")
> 
> ## ========  LF file
> cat(z, file="testIO.R", sep="\n")
> readLines("testIO.R")
[1] "#line 1"     "2+3"         "ls()"        "pi"          "# last line"
> source("testIO.R", echo=TRUE)

> #line 1
> 2+3
[1] 5

> ls()
[1] "z"

> pi
[1] 3.141593
> unlink("testIO.R")
> 
> ## ======== LF file, incomplete final line
> zz <- file("testIO.R", "wt")
> cat(z, file=zz, sep="\n")
> cat("5+6", file=zz)
> close(zz)
> readLines("testIO.R")
[1] "#line 1"     "2+3"         "ls()"        "pi"          "# last line"
[6] "5+6"        
Warning message:
In readLines("testIO.R") : incomplete final line found on 'testIO.R' 
> source("testIO.R", echo=TRUE)

> #line 1
> 2+3
[1] 5

> ls()
[1] "z"  "zz"

> pi
[1] 3.141593

> # last line
> 5+6
[1] 11
> unlink("testIO.R")
> 
> ## ======== CRLF file
> cat(z, file="testIO.R", sep="\r\n")
> source("testIO.R", echo=TRUE)

> #line 1
> 2+3
[1] 5

> ls()
[1] "z"  "zz"

> pi
[1] 3.141593
> readLines("testIO.R")
[1] "#line 1"     "2+3"         "ls()"        "pi"          "# last line"
> unlink("testIO.R")
> 
> ## ======== CRLF file, incomplete final line
> zz <- file("testIO.R", "wt")
> cat(z, file=zz, sep="\r\n")
> cat("5+6", file=zz)
> close(zz)
> readLines("testIO.R")
[1] "#line 1"     "2+3"         "ls()"        "pi"          "# last line"
[6] "5+6"        
Warning message:
In readLines("testIO.R") : incomplete final line found on 'testIO.R' 
> source("testIO.R", echo=TRUE)

> #line 1
> 2+3
[1] 5

> ls()
[1] "z"  "zz"

> pi
[1] 3.141593

> # last line
> 5+6
[1] 11
> unlink("testIO.R")
> 
> ## ======== CR file
> cat(z, file="testIO.R", sep="\r")
> readLines("testIO.R")
[1] "#line 1"     "2+3"         "ls()"        "pi"          "# last line"
Warning message:
In readLines("testIO.R") : incomplete final line found on 'testIO.R' 
> source("testIO.R", echo=TRUE)

> #line 1
> 2+3
[1] 5

> ls()
[1] "z"  "zz"

> pi
[1] 3.141593
> unlink("testIO.R")
> 
> ## ======== CR file, incomplete final line
> zz <- file("testIO.R", "wt")
> cat(z, file=zz, sep="\r")
> cat("\r5+6", file=zz)
> close(zz)
> readLines("testIO.R")
[1] "#line 1"     "2+3"         "ls()"        "pi"          "# last line"
[6] "5+6"        
Warning message:
In readLines("testIO.R") : incomplete final line found on 'testIO.R' 
> source("testIO.R", echo=TRUE)

> #line 1
> 2+3
[1] 5

> ls()
[1] "z"  "zz"

> pi
[1] 3.141593

> # last line
> 5+6
[1] 11
> unlink("testIO.R")
> 
> ## end of reg-IO.R: the next line has no EOL chars
> 2 + 2
[1] 4
> 

From kamil at ualberta.ca  Fri Nov  9 19:20:22 2007
From: kamil at ualberta.ca (kamil Marcinkowski)
Date: Fri, 9 Nov 2007 11:20:22 -0700
Subject: [Rd] R 2.6.0 make check fails on SGI origin 350 and
In-Reply-To: <18227.19165.686297.222253@stat.math.ethz.ch>
References: <42665B36-6FE2-48A4-A1C4-09F67D61A28C@ualberta.ca>
	<Pine.LNX.4.64.0711062341250.30885@gannet.stats.ox.ac.uk>
	<A8521DA1-CFA8-4B2D-896B-690AF301E122@ualberta.ca>
	<18226.54375.972183.286953@stat.math.ethz.ch>
	<6B3A01D9-B6A9-483A-9EA6-013BA8743BDD@ualberta.ca>
	<18227.19165.686297.222253@stat.math.ethz.ch>
Message-ID: <39B05A63-0B09-4C15-983C-4FCC51641A0B@ualberta.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20071109/e733d76c/attachment.pl 

From murdoch at stats.uwo.ca  Fri Nov  9 21:08:44 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 09 Nov 2007 15:08:44 -0500
Subject: [Rd] R crashes when I open R files in R (PR#10402)
In-Reply-To: <473480FA.4010304@stats.uwo.ca>
References: <20071106140523.08BC0283461C@mail.pubhealth.ku.dk>	<4732EE86.3080302@stats.uwo.ca>	<003801c822e5$8f14f670$ad3ee350$@lemaitre.1@ulaval.ca>
	<473480FA.4010304@stats.uwo.ca>
Message-ID: <4734BE4C.6010907@stats.uwo.ca>

On 11/9/2007 10:47 AM, Duncan Murdoch wrote:
> On 11/9/2007 10:31 AM, J?r?me Lema?tre wrote:
>> Dear Duncan,
>> 
>> I thank you very much for your attention and I apologize for the few
>> information. Here is some more... I have made some tests and I think that I
>> have found the problem.
>> The thing is that R crashes when both of the followings happen:
> 
> Thanks, I can reproduce it now.  Looks as though we've got a buffer 
> somewhere that's too short.
> 
> I'll track it down and fix it.

Found and fixed.  The title for the editor window allows for fewer 
characters than a long pathname; we were miscounting the available space 
and overrunning the buffer.

This should be fixed in tomorrow's build of R-patched.

Duncan Murdoch


From tcallawa at redhat.com  Fri Nov  9 22:45:05 2007
From: tcallawa at redhat.com (Tom "spot" Callaway)
Date: Fri, 09 Nov 2007 16:45:05 -0500
Subject: [Rd] make check-all fails on F8
In-Reply-To: <1194630062.15847.63.camel@Bellerophon.localdomain>
References: <1194630062.15847.63.camel@Bellerophon.localdomain>
Message-ID: <1194644705.12686.39.camel@localhost.localdomain>


On Fri, 2007-11-09 at 11:41 -0600, Marc Schwartz wrote:

> I have been looking ("tunnel vision") at this now for several hours
> going back to last night, and am probably missing something basic here,
> but is this the result of a change in the behavior of diff on F8, or is
> something else going on that I am just missing?

https://bugzilla.redhat.com/show_bug.cgi?id=363831

It's a bug in diff. There's a fixed package in that bug report.

~spot


From marc_schwartz at comcast.net  Fri Nov  9 23:29:40 2007
From: marc_schwartz at comcast.net (Marc Schwartz)
Date: Fri, 09 Nov 2007 16:29:40 -0600
Subject: [Rd] make check-all fails on F8
In-Reply-To: <1194644705.12686.39.camel@localhost.localdomain>
References: <1194630062.15847.63.camel@Bellerophon.localdomain>
	<1194644705.12686.39.camel@localhost.localdomain>
Message-ID: <1194647380.15847.81.camel@Bellerophon.localdomain>


On Fri, 2007-11-09 at 16:45 -0500, Tom "spot" Callaway wrote:
> On Fri, 2007-11-09 at 11:41 -0600, Marc Schwartz wrote:
> 
> > I have been looking ("tunnel vision") at this now for several hours
> > going back to last night, and am probably missing something basic here,
> > but is this the result of a change in the behavior of diff on F8, or is
> > something else going on that I am just missing?
> 
> https://bugzilla.redhat.com/show_bug.cgi?id=363831
> 
> It's a bug in diff. There's a fixed package in that bug report.
> 
> ~spot

Thanks Tom.

It looks like the new RPM has not yet hit the mirrors, so I got it
directly from Koji at:

http://koji.fedoraproject.org/koji/buildinfo?buildID=23465

I installed:

  diffutils-2.8.1-19.fc8.i386.rpm

I'll run the full make check-all in a bit (takes over an hour), but for
a quick check, I ran:

$ make test-Reg
running regression tests
make[1]: Entering directory `/home/marcs/R.Files/SourceCode/SVN/tests'
running code in 'reg-tests-1.R' ... OK
running code in 'reg-tests-2.R' ... OK
comparing 'reg-tests-2.Rout' to './reg-tests-2.Rout.save' ... OK
running code in 'reg-IO.R' ... OK
comparing 'reg-IO.Rout' to './reg-IO.Rout.save' ... OK
running code in 'reg-IO2.R' ... OK
comparing 'reg-IO2.Rout' to './reg-IO2.Rout.save' ... OK
running code in 'reg-plot.R' ... OK
comparing 'reg-plot.Rout' to './reg-plot.Rout.save' ... OK
comparing 'reg-plot.ps' to './reg-plot.ps.save' ... OK
running code in 'reg-S4.R' ... OK
comparing 'reg-S4.Rout' to './reg-S4.Rout.save' ... OK
make[1]: Leaving directory `/home/marcs/R.Files/SourceCode/SVN/tests'
make[1]: Entering directory `/home/marcs/R.Files/SourceCode/SVN/tests'
running code in 'reg-tests-3.R' ... OK
comparing 'reg-tests-3.Rout' to './reg-tests-3.Rout.save' ... OK
make[1]: Leaving directory `/home/marcs/R.Files/SourceCode/SVN/tests'


So at least the aforementioned issue has been resolved.

I added a comment to the above Bugzilla report, confirming that the -19
version seems to resolve the problem.

If anything else pops up, I'll post back.

Thanks again,

Marc


From ripley at stats.ox.ac.uk  Sat Nov 10 09:50:10 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 10 Nov 2007 08:50:10 +0000 (GMT)
Subject: [Rd] C/C++ 'assert' should not be used in R packages
Message-ID: <Pine.LNX.4.64.0711071638510.7944@gannet.stats.ox.ac.uk>

Please don't use 'assert' in R packages.  If called, this means that an 
error in your code aborts the whole R process, including your user's work. 
I see several R packages doing this, and one of them called 'assert' on me 
earlier in the week.

We provide 'error': please do use it to return control to the user when 
your code misbehaves.

Similarly 'exit' and 'abort' should never be used in R packages.


Sometimes it is not under your control: I sometimes see an rgl failure at

R: indirect_vertex_array.c:659: emit_DrawArrays_old: Assertion 
`elements_per_request >= count' failed.

that is coming from the Mesa GL libraries.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From jputz at teainc.org  Fri Nov  9 21:55:08 2007
From: jputz at teainc.org (jputz at teainc.org)
Date: Fri,  9 Nov 2007 21:55:08 +0100 (CET)
Subject: [Rd] years() in chron package not working in R 2.6.0 (PR#10415)
Message-ID: <20071109205508.90299282EFF7@mail.pubhealth.ku.dk>

I loaded package chron in a newly installed version of R 2.6.0 and the
years() function would not work.  (This worked in 2.5).

=20

> x<-as.Date("2006-01-01")

> years(x)

NULL

=20

>sessionInfo()

R version 2.6.0 (2007-10-03)=20

i386-pc-mingw32=20

=20

locale:

LC_COLLATE=3DEnglish_United States.1252;LC_CTYPE=3DEnglish_United
States.1252;LC_MONETARY=3DEnglish_United
States.1252;LC_NUMERIC=3DC;LC_TIME=3DEnglish_United States.1252

=20

attached base packages:

[1] tcltk     stats     graphics  grDevices utils     datasets  methods
base=20=20=20=20=20

=20

other attached packages:

[1] fCalendar_260.72  fEcofin_260.72    fUtilities_260.72 zoo_1.4-0
spatial_7.2-36=20=20=20

[6] RUnit_0.4.17      MASS_7.2-36       chron_2.3-15=20=20=20=20=20

=20

loaded via a namespace (and not attached):

[1] grid_2.6.0     lattice_0.16-5 tools_2.6.0=20=20=20

=20

Thanks.

=20

John Putz

Sr. Energy Analyst

The Energy Authority

425-460-1137 (o)

206-910-5229 (c)

=20


	[[alternative HTML version deleted]]


From murdoch at stats.uwo.ca  Sat Nov 10 12:38:17 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 10 Nov 2007 06:38:17 -0500
Subject: [Rd] C/C++ 'assert' should not be used in R packages
In-Reply-To: <Pine.LNX.4.64.0711071638510.7944@gannet.stats.ox.ac.uk>
References: <Pine.LNX.4.64.0711071638510.7944@gannet.stats.ox.ac.uk>
Message-ID: <47359829.8090909@stats.uwo.ca>

Prof Brian Ripley wrote:
> Please don't use 'assert' in R packages.  If called, this means that an 
> error in your code aborts the whole R process, including your user's work. 
> I see several R packages doing this, and one of them called 'assert' on me 
> earlier in the week.
>   
I partly disagree about this.  If assert() is triggered, it clearly 
indicates a bug in the package.  If it just generated an R error, most 
users would ignore it, and not report it to the package maintainer. 

It may well be that when an assertion fails, none of the subsequent 
calculations are reliable, in which case returning control to the user 
could result in data corruption.  That's worse than losing a session, 
because at least when you lose a session, you know it.

Could we write our own implementation of assert() that displays an R 
error and unloads the package?  I think I could do something like that 
in Windows by calling FreeLibrary to unload the DLL, but I'd prefer a 
cross-platform solution.
> We provide 'error': please do use it to return control to the user when 
> your code misbehaves.
>
> Similarly 'exit' and 'abort' should never be used in R packages.
>
>
> Sometimes it is not under your control: I sometimes see an rgl failure at
>
> R: indirect_vertex_array.c:659: emit_DrawArrays_old: Assertion 
> `elements_per_request >= count' failed.
>
> that is coming from the Mesa GL libraries.
>   
I'd say that's a bug, either in Mesa GL or in rgl.  If you can make it 
reproducible, I'll try to track it down.

Duncan Murdoch


From ggrothendieck at gmail.com  Sat Nov 10 14:11:16 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat, 10 Nov 2007 08:11:16 -0500
Subject: [Rd] years() in chron package not working in R 2.6.0 (PR#10415)
In-Reply-To: <20071109205508.90299282EFF7@mail.pubhealth.ku.dk>
References: <20071109205508.90299282EFF7@mail.pubhealth.ku.dk>
Message-ID: <971536df0711100511n4db7de36jc2a2b55affcb51a8@mail.gmail.com>

In chron, ?year says x must be a "dates" object and its not in the code below.

On Nov 9, 2007 3:55 PM,  <jputz at teainc.org> wrote:
> I loaded package chron in a newly installed version of R 2.6.0 and the
> years() function would not work.  (This worked in 2.5).
>
> =20
>
> > x<-as.Date("2006-01-01")
>
> > years(x)
>
> NULL
>
> =20
>
> >sessionInfo()
>
> R version 2.6.0 (2007-10-03)=20
>
> i386-pc-mingw32=20
>
> =20
>
> locale:
>
> LC_COLLATE=3DEnglish_United States.1252;LC_CTYPE=3DEnglish_United
> States.1252;LC_MONETARY=3DEnglish_United
> States.1252;LC_NUMERIC=3DC;LC_TIME=3DEnglish_United States.1252
>
> =20
>
> attached base packages:
>
> [1] tcltk     stats     graphics  grDevices utils     datasets  methods
> base=20=20=20=20=20
>
> =20
>
> other attached packages:
>
> [1] fCalendar_260.72  fEcofin_260.72    fUtilities_260.72 zoo_1.4-0
> spatial_7.2-36=20=20=20
>
> [6] RUnit_0.4.17      MASS_7.2-36       chron_2.3-15=20=20=20=20=20
>
> =20
>
> loaded via a namespace (and not attached):
>
> [1] grid_2.6.0     lattice_0.16-5 tools_2.6.0=20=20=20
>
> =20
>
> Thanks.
>
> =20
>
> John Putz
>
> Sr. Energy Analyst
>
> The Energy Authority
>
> 425-460-1137 (o)
>
> 206-910-5229 (c)
>
> =20
>
>
>        [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From murdoch at stats.uwo.ca  Sat Nov 10 18:27:24 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 10 Nov 2007 12:27:24 -0500
Subject: [Rd] C/C++ 'assert' should not be used in R packages
In-Reply-To: <47359829.8090909@stats.uwo.ca>
References: <Pine.LNX.4.64.0711071638510.7944@gannet.stats.ox.ac.uk>
	<47359829.8090909@stats.uwo.ca>
Message-ID: <4735E9FC.9060902@stats.uwo.ca>

On 10/11/2007 6:38 AM, Duncan Murdoch wrote:
> Prof Brian Ripley wrote:
>> Please don't use 'assert' in R packages.  If called, this means that an 
>> error in your code aborts the whole R process, including your user's work. 
>> I see several R packages doing this, and one of them called 'assert' on me 
>> earlier in the week.
>>   
> I partly disagree about this.  If assert() is triggered, it clearly 
> indicates a bug in the package.  If it just generated an R error, most 
> users would ignore it, and not report it to the package maintainer. 
> 
> It may well be that when an assertion fails, none of the subsequent 
> calculations are reliable, in which case returning control to the user 
> could result in data corruption.  That's worse than losing a session, 
> because at least when you lose a session, you know it.
> 
> Could we write our own implementation of assert() that displays an R 
> error and unloads the package?  I think I could do something like that 
> in Windows by calling FreeLibrary to unload the DLL, but I'd prefer a 
> cross-platform solution.

I've put an implementation of this into rgl (svn only for now, not on 
CRAN).  I didn't bother with the FreeLibrary call, the error message 
asks the user to inform the maintainer.

It won't help with the Mesa GL problem below, as that's not rgl code, 
but at least now I won't feel bad about including assert()'s in my code.

Duncan Murdoch

>> We provide 'error': please do use it to return control to the user when 
>> your code misbehaves.
>>
>> Similarly 'exit' and 'abort' should never be used in R packages.
>>
>>
>> Sometimes it is not under your control: I sometimes see an rgl failure at
>>
>> R: indirect_vertex_array.c:659: emit_DrawArrays_old: Assertion 
>> `elements_per_request >= count' failed.
>>
>> that is coming from the Mesa GL libraries.
>>   
> I'd say that's a bug, either in Mesa GL or in rgl.  If you can make it 
> reproducible, I'll try to track it down.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From duncan at wald.ucdavis.edu  Sat Nov 10 19:00:32 2007
From: duncan at wald.ucdavis.edu (Duncan Temple Lang)
Date: Sun, 11 Nov 2007 07:00:32 +1300
Subject: [Rd] C/C++ 'assert' should not be used in R packages
In-Reply-To: <47359829.8090909@stats.uwo.ca>
References: <Pine.LNX.4.64.0711071638510.7944@gannet.stats.ox.ac.uk>
	<47359829.8090909@stats.uwo.ca>
Message-ID: <4735F1C0.8050601@wald.ucdavis.edu>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1



Duncan Murdoch wrote:
> Prof Brian Ripley wrote:
>> Please don't use 'assert' in R packages.  If called, this means that an 
>> error in your code aborts the whole R process, including your user's work. 
>> I see several R packages doing this, and one of them called 'assert' on me 
>> earlier in the week.
>>   
> I partly disagree about this.  If assert() is triggered, it clearly 
> indicates a bug in the package.  If it just generated an R error, most 
> users would ignore it, and not report it to the package maintainer. 
> 
> It may well be that when an assertion fails, none of the subsequent 
> calculations are reliable, in which case returning control to the user 
> could result in data corruption.  That's worse than losing a session, 
> because at least when you lose a session, you know it.
> 
> Could we write our own implementation of assert() that displays an R 
> error and unloads the package?  I think I could do something like that 
> in Windows by calling FreeLibrary to unload the DLL, but I'd prefer a 
> cross-platform solution.

I am not sure why you think we need to discard the DLL.
What if we want to access variables and routines merely to find out
the resulting state after the assert().
And it is not clear whether you mean any "subsequent calculations"
or any "subsequent calculations using code within this DLL"
might be unreliable.

But regardless of that and the assumption that users will ignore this
error, why would you want to call FreeLibrary? Since R has induced the
DLL to be loaded either directly or indirectly, R holds a handle to the
DLL. If you don't use R's cross-platform facilities for releasing the
DLL (either at the R or C-level), you will corrupt the session,
specifically in the list of assumed-live DLLs.

 D.


>> We provide 'error': please do use it to return control to the user when 
>> your code misbehaves.
>>
>> Similarly 'exit' and 'abort' should never be used in R packages.
>>
>>
>> Sometimes it is not under your control: I sometimes see an rgl failure at
>>
>> R: indirect_vertex_array.c:659: emit_DrawArrays_old: Assertion 
>> `elements_per_request >= count' failed.
>>
>> that is coming from the Mesa GL libraries.
>>   
> I'd say that's a bug, either in Mesa GL or in rgl.  If you can make it 
> reproducible, I'll try to track it down.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (Darwin)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFHNfHA9p/Jzwa2QP4RAo2BAJkB5QaFLOW5fcR6QE9JSXpIWAcEUwCggMYK
2WBnl5jDgTUayU5wk8hnQj4=
=91by
-----END PGP SIGNATURE-----


From murdoch at stats.uwo.ca  Sat Nov 10 19:05:54 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 10 Nov 2007 13:05:54 -0500
Subject: [Rd] C/C++ 'assert' should not be used in R packages
In-Reply-To: <4735F1C0.8050601@wald.ucdavis.edu>
References: <Pine.LNX.4.64.0711071638510.7944@gannet.stats.ox.ac.uk>
	<47359829.8090909@stats.uwo.ca> <4735F1C0.8050601@wald.ucdavis.edu>
Message-ID: <4735F302.501@stats.uwo.ca>

On 10/11/2007 1:00 PM, Duncan Temple Lang wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> 
> 
> Duncan Murdoch wrote:
>> Prof Brian Ripley wrote:
>>> Please don't use 'assert' in R packages.  If called, this means that an 
>>> error in your code aborts the whole R process, including your user's work. 
>>> I see several R packages doing this, and one of them called 'assert' on me 
>>> earlier in the week.
>>>   
>> I partly disagree about this.  If assert() is triggered, it clearly 
>> indicates a bug in the package.  If it just generated an R error, most 
>> users would ignore it, and not report it to the package maintainer. 
>>
>> It may well be that when an assertion fails, none of the subsequent 
>> calculations are reliable, in which case returning control to the user 
>> could result in data corruption.  That's worse than losing a session, 
>> because at least when you lose a session, you know it.
>>
>> Could we write our own implementation of assert() that displays an R 
>> error and unloads the package?  I think I could do something like that 
>> in Windows by calling FreeLibrary to unload the DLL, but I'd prefer a 
>> cross-platform solution.
> 
> I am not sure why you think we need to discard the DLL.

The package author has asserted that it is no longer safe to run.  They 
are shutting down R, and Brian finds that too extreme.

> What if we want to access variables and routines merely to find out
> the resulting state after the assert().
> And it is not clear whether you mean any "subsequent calculations"
> or any "subsequent calculations using code within this DLL"
> might be unreliable.

How could I know why a package author decided a shutdown is needed?  It 
depends on the author.

> 
> But regardless of that and the assumption that users will ignore this
> error, why would you want to call FreeLibrary? Since R has induced the
> DLL to be loaded either directly or indirectly, R holds a handle to the
> DLL. If you don't use R's cross-platform facilities for releasing the
> DLL (either at the R or C-level), you will corrupt the session,
> specifically in the list of assumed-live DLLs.

As I said, I'd prefer a cross-platform solution.

Duncan Murdoch
> 
>  D.
> 
> 
>>> We provide 'error': please do use it to return control to the user when 
>>> your code misbehaves.
>>>
>>> Similarly 'exit' and 'abort' should never be used in R packages.
>>>
>>>
>>> Sometimes it is not under your control: I sometimes see an rgl failure at
>>>
>>> R: indirect_vertex_array.c:659: emit_DrawArrays_old: Assertion 
>>> `elements_per_request >= count' failed.
>>>
>>> that is coming from the Mesa GL libraries.
>>>   
>> I'd say that's a bug, either in Mesa GL or in rgl.  If you can make it 
>> reproducible, I'll try to track it down.
>>
>> Duncan Murdoch
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.7 (Darwin)
> Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
> 
> iD8DBQFHNfHA9p/Jzwa2QP4RAo2BAJkB5QaFLOW5fcR6QE9JSXpIWAcEUwCggMYK
> 2WBnl5jDgTUayU5wk8hnQj4=
> =91by
> -----END PGP SIGNATURE-----


From duncan at wald.ucdavis.edu  Sat Nov 10 20:44:09 2007
From: duncan at wald.ucdavis.edu (Duncan Temple Lang)
Date: Sun, 11 Nov 2007 08:44:09 +1300
Subject: [Rd] C/C++ 'assert' should not be used in R packages
In-Reply-To: <4735F302.501@stats.uwo.ca>
References: <Pine.LNX.4.64.0711071638510.7944@gannet.stats.ox.ac.uk>
	<47359829.8090909@stats.uwo.ca>
	<4735F1C0.8050601@wald.ucdavis.edu> <4735F302.501@stats.uwo.ca>
Message-ID: <47360A09.2070509@wald.ucdavis.edu>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1



Duncan Murdoch wrote:
> On 10/11/2007 1:00 PM, Duncan Temple Lang wrote:
> 
> 
> Duncan Murdoch wrote:
>>>> Prof Brian Ripley wrote:
>>>>> Please don't use 'assert' in R packages.  If called, this means that
>>>>> an error in your code aborts the whole R process, including your
>>>>> user's work. I see several R packages doing this, and one of them
>>>>> called 'assert' on me earlier in the week.
>>>>>   
>>>> I partly disagree about this.  If assert() is triggered, it clearly
>>>> indicates a bug in the package.  If it just generated an R error,
>>>> most users would ignore it, and not report it to the package maintainer.
>>>> It may well be that when an assertion fails, none of the subsequent
>>>> calculations are reliable, in which case returning control to the
>>>> user could result in data corruption.  That's worse than losing a
>>>> session, because at least when you lose a session, you know it.
>>>>
>>>> Could we write our own implementation of assert() that displays an R
>>>> error and unloads the package?  I think I could do something like
>>>> that in Windows by calling FreeLibrary to unload the DLL, but I'd
>>>> prefer a cross-platform solution.
> 
> I am not sure why you think we need to discard the DLL.


I don't think this is worth spending much time on other than to
encourage you not to use FreeLibrary or its equivalents on
other systems and to use the R mechanisms.

However, just to clarify.

> 
>> The package author has asserted that it is no longer safe to run.  

run _what_ ?  The R session? The computer? ....
 The object is important here.

assert() typically means that something unexpected in that routine
or in our case the sequence of calls from .C/.Call/...
So to assume that the session is no longer safe seems to be a large leap
from this particular invocation is unsafe to run to normal completion.
As with most things, it is a matter of scope and a simple mechanism
such as assert() leaves the intentions of the programmer unclear.

But of course it should not terminate the R session.  Nor should
R package developers link to libraries that make call the C routine
exit()  as this too will terminate the R session. One can use
techniques to mask such calls to exit() in some circumstances.

>> They
>> are shutting down R, and Brian finds that too extreme.
> 

> What if we want to access variables and routines merely to find out
> the resulting state after the assert().
> And it is not clear whether you mean any "subsequent calculations"
> or any "subsequent calculations using code within this DLL"
> might be unreliable.
> 
>> How could I know why a package author decided a shutdown is needed?  It
>> depends on the author.
> 
> 
> But regardless of that and the assumption that users will ignore this
> error, why would you want to call FreeLibrary? Since R has induced the
> DLL to be loaded either directly or indirectly, R holds a handle to the
> DLL. If you don't use R's cross-platform facilities for releasing the
> DLL (either at the R or C-level), you will corrupt the session,
> specifically in the list of assumed-live DLLs.
> 
>> As I said, I'd prefer a cross-platform solution.
> 
>> Duncan Murdoch
> 
>  D.
> 
> 
>>>>> We provide 'error': please do use it to return control to the user
>>>>> when your code misbehaves.
>>>>>
>>>>> Similarly 'exit' and 'abort' should never be used in R packages.
>>>>>
>>>>>
>>>>> Sometimes it is not under your control: I sometimes see an rgl
>>>>> failure at
>>>>>
>>>>> R: indirect_vertex_array.c:659: emit_DrawArrays_old: Assertion
>>>>> `elements_per_request >= count' failed.
>>>>>
>>>>> that is coming from the Mesa GL libraries.
>>>>>   
>>>> I'd say that's a bug, either in Mesa GL or in rgl.  If you can make
>>>> it reproducible, I'll try to track it down.
>>>>
>>>> Duncan Murdoch
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (Darwin)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFHNgoJ9p/Jzwa2QP4RAkeQAJ0Y0sMwWmb0k0u+3YI2lPXwBklpFQCfbCbk
sY72JmcqQ78DQClVxIJKoKU=
=3ZzG
-----END PGP SIGNATURE-----


From simon.urbanek at r-project.org  Sat Nov 10 22:27:38 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sat, 10 Nov 2007 16:27:38 -0500
Subject: [Rd] C/C++ 'assert' should not be used in R packages
In-Reply-To: <4735F302.501@stats.uwo.ca>
References: <Pine.LNX.4.64.0711071638510.7944@gannet.stats.ox.ac.uk>
	<47359829.8090909@stats.uwo.ca>
	<4735F1C0.8050601@wald.ucdavis.edu> <4735F302.501@stats.uwo.ca>
Message-ID: <AF618CB3-93F7-439C-AEBC-F84E3904E0CB@r-project.org>


On Nov 10, 2007, at 1:05 PM, Duncan Murdoch wrote:

> On 10/11/2007 1:00 PM, Duncan Temple Lang wrote:
>> -----BEGIN PGP SIGNED MESSAGE-----
>> Hash: SHA1
>>
>>
>>
>> Duncan Murdoch wrote:
>>> Prof Brian Ripley wrote:
>>>> Please don't use 'assert' in R packages.  If called, this means  
>>>> that an
>>>> error in your code aborts the whole R process, including your  
>>>> user's work.
>>>> I see several R packages doing this, and one of them called  
>>>> 'assert' on me
>>>> earlier in the week.
>>>>
>>> I partly disagree about this.  If assert() is triggered, it clearly
>>> indicates a bug in the package.  If it just generated an R error,  
>>> most
>>> users would ignore it, and not report it to the package maintainer.
>>>
>>> It may well be that when an assertion fails, none of the subsequent
>>> calculations are reliable, in which case returning control to the  
>>> user
>>> could result in data corruption.  That's worse than losing a  
>>> session,
>>> because at least when you lose a session, you know it.
>>>
>>> Could we write our own implementation of assert() that displays an R
>>> error and unloads the package?  I think I could do something like  
>>> that
>>> in Windows by calling FreeLibrary to unload the DLL, but I'd  
>>> prefer a
>>> cross-platform solution.
>>
>> I am not sure why you think we need to discard the DLL.
>
> The package author has asserted that it is no longer safe to run.   
> They are shutting down R, and Brian finds that too extreme.
>

Me too. A package should never intentionally close the R session. If  
it does, it is a very severe design bug in the package (IMHO).  
Anything you use assert for can be gracefully handled (as opposed to  
let's say a segfault), so there is no excuse for killing the whole  
process at all (deliberately wiping all user's work is rude to put it  
mildly). Even if it might be unsafe to run anything, I'd still want  
to attempt to save my data.

Cheers,
Simon


>> What if we want to access variables and routines merely to find out
>> the resulting state after the assert().
>> And it is not clear whether you mean any "subsequent calculations"
>> or any "subsequent calculations using code within this DLL"
>> might be unreliable.
>
> How could I know why a package author decided a shutdown is  
> needed?  It
> depends on the author.
>
>>
>> But regardless of that and the assumption that users will ignore this
>> error, why would you want to call FreeLibrary? Since R has induced  
>> the
>> DLL to be loaded either directly or indirectly, R holds a handle  
>> to the
>> DLL. If you don't use R's cross-platform facilities for releasing the
>> DLL (either at the R or C-level), you will corrupt the session,
>> specifically in the list of assumed-live DLLs.
>
> As I said, I'd prefer a cross-platform solution.
>
> Duncan Murdoch
>>
>>  D.
>>
>>
>>>> We provide 'error': please do use it to return control to the  
>>>> user when
>>>> your code misbehaves.
>>>>
>>>> Similarly 'exit' and 'abort' should never be used in R packages.
>>>>
>>>>
>>>> Sometimes it is not under your control: I sometimes see an rgl  
>>>> failure at
>>>>
>>>> R: indirect_vertex_array.c:659: emit_DrawArrays_old: Assertion
>>>> `elements_per_request >= count' failed.
>>>>
>>>> that is coming from the Mesa GL libraries.
>>>>
>>> I'd say that's a bug, either in Mesa GL or in rgl.  If you can  
>>> make it
>>> reproducible, I'll try to track it down.
>>>
>>> Duncan Murdoch
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> -----BEGIN PGP SIGNATURE-----
>> Version: GnuPG v1.4.7 (Darwin)
>> Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
>>
>> iD8DBQFHNfHA9p/Jzwa2QP4RAo2BAJkB5QaFLOW5fcR6QE9JSXpIWAcEUwCggMYK
>> 2WBnl5jDgTUayU5wk8hnQj4=
>> =91by
>> -----END PGP SIGNATURE-----
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From murdoch at stats.uwo.ca  Sat Nov 10 23:38:03 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 10 Nov 2007 17:38:03 -0500
Subject: [Rd] C/C++ 'assert' should not be used in R packages
In-Reply-To: <AF618CB3-93F7-439C-AEBC-F84E3904E0CB@r-project.org>
References: <Pine.LNX.4.64.0711071638510.7944@gannet.stats.ox.ac.uk>	<47359829.8090909@stats.uwo.ca>	<4735F1C0.8050601@wald.ucdavis.edu>
	<4735F302.501@stats.uwo.ca>
	<AF618CB3-93F7-439C-AEBC-F84E3904E0CB@r-project.org>
Message-ID: <473632CB.8050001@stats.uwo.ca>

On 10/11/2007 4:27 PM, Simon Urbanek wrote:
> On Nov 10, 2007, at 1:05 PM, Duncan Murdoch wrote:
> 
>> On 10/11/2007 1:00 PM, Duncan Temple Lang wrote:
>>> -----BEGIN PGP SIGNED MESSAGE-----
>>> Hash: SHA1
>>>
>>>
>>>
>>> Duncan Murdoch wrote:
>>>> Prof Brian Ripley wrote:
>>>>> Please don't use 'assert' in R packages.  If called, this means  
>>>>> that an
>>>>> error in your code aborts the whole R process, including your  
>>>>> user's work.
>>>>> I see several R packages doing this, and one of them called  
>>>>> 'assert' on me
>>>>> earlier in the week.
>>>>>
>>>> I partly disagree about this.  If assert() is triggered, it clearly
>>>> indicates a bug in the package.  If it just generated an R error,  
>>>> most
>>>> users would ignore it, and not report it to the package maintainer.
>>>>
>>>> It may well be that when an assertion fails, none of the subsequent
>>>> calculations are reliable, in which case returning control to the  
>>>> user
>>>> could result in data corruption.  That's worse than losing a  
>>>> session,
>>>> because at least when you lose a session, you know it.
>>>>
>>>> Could we write our own implementation of assert() that displays an R
>>>> error and unloads the package?  I think I could do something like  
>>>> that
>>>> in Windows by calling FreeLibrary to unload the DLL, but I'd  
>>>> prefer a
>>>> cross-platform solution.
>>> I am not sure why you think we need to discard the DLL.
>> The package author has asserted that it is no longer safe to run.   
>> They are shutting down R, and Brian finds that too extreme.
>>
> 
> Me too. A package should never intentionally close the R session. If  
> it does, it is a very severe design bug in the package (IMHO).  
> Anything you use assert for can be gracefully handled (as opposed to  
> let's say a segfault), so there is no excuse for killing the whole  
> process at all (deliberately wiping all user's work is rude to put it  
> mildly). Even if it might be unsafe to run anything, I'd still want  
> to attempt to save my data.

Perhaps I use assert() differently than you, but the way I use it is to 
assert assumptions that I believe will always be true.

If one of those assertions fails, it means that my program is operating 
in a way that I did not foresee.  I can't recover gracefully from that, 
because at that point my basic assumptions about the program have been 
proven to be incorrect.  I have no basis for reasoning.  It is by 
definition a bug.

Now, it's possible that this bug has corrupted R and it really would be 
best for the user to discard all his work, but I agree that's unlikely. 
  That's why I proposed that R should offer a way to handle an assertion 
failure that limits the shutdown to just my package.

I don't offer a guarantee that my work won't corrupt a user's data, but 
I do work hard to avoid that.  Allowing my package to tell the user that 
it is now unsafe to use is one way to do so.  That's what assert() is for.

In a standalone program, an (uncaught) assertion failure will cause the 
RTL to shut down the process.  I think R should support a version of 
that, but limit the shutdown to the package that has failed.   The 
version of assert() that I put together for rgl this morning doesn't 
attempt to shut down rgl, because that's really something that R should 
be responsible for.  All it does is issue a dire warning to the user.

Offline, Brian mentioned that some packages use assert() for input 
validation.  That's an incorrect use of it, and those packages should 
use error(), as Brian suggested.

Duncan Murdoch


From bill at insightful.com  Sun Nov 11 02:04:28 2007
From: bill at insightful.com (Bill Dunlap)
Date: Sat, 10 Nov 2007 17:04:28 -0800 (PST)
Subject: [Rd] C/C++ 'assert' should not be used in R packages
In-Reply-To: <47359829.8090909@stats.uwo.ca>
References: <Pine.LNX.4.64.0711071638510.7944@gannet.stats.ox.ac.uk>
	<47359829.8090909@stats.uwo.ca>
Message-ID: <Pine.GSO.4.56.0711101650190.18407@durian.statsci.com>

On Sat, 10 Nov 2007, Duncan Murdoch wrote:

> Prof Brian Ripley wrote:
> > Please don't use 'assert' in R packages.  If called, this means that an
> > error in your code aborts the whole R process, including your user's work.
> > I see several R packages doing this, and one of them called 'assert' on me
> > earlier in the week.
> >
> I partly disagree about this.  If assert() is triggered, it clearly
> indicates a bug in the package.  If it just generated an R error, most
> users would ignore it, and not report it to the package maintainer.
>
> It may well be that when an assertion fails, none of the subsequent
> calculations are reliable, in which case returning control to the user
> could result in data corruption.  That's worse than losing a session,
> because at least when you lose a session, you know it.

I would think one would want to call assert() before doing something
that might corrupt the session.  Sometimes you cannot arrange to
do that, but most times you can.

I think it would be nice to have a class of "programmer errors",
as opposed to "user errors".  (A user error is when the user enters
inappropriate data for the function and a programmer error is
when the inputs are appropriate but the code in the package is bad.)
Supply functions at the R and C levels (assert() and Rf_assert(),
respectively?) to throw such errors.  They would work about the
same as stop() and Rf_error() do (longjmp to main input loop),
but would print something like
   'Internal/programmer error, report to authorities: n<0'
instead of
   'Error: n is negative'
If the message automatically included the package name, file name,
and line number for C code, so much the better, but the text of the message
should identify it.

You could install a special error handler for that class of errors
if you wished.

> Could we write our own implementation of assert() that displays an R
> error and unloads the package?  I think I could do something like that
> in Windows by calling FreeLibrary to unload the DLL, but I'd prefer a
> cross-platform solution.

----------------------------------------------------------------------------
Bill Dunlap
Insightful Corporation
bill at insightful dot com
360-428-8146

 "All statements in this message represent the opinions of the author and do
 not necessarily reflect Insightful Corporation policy or position."


From murdoch at stats.uwo.ca  Sun Nov 11 03:38:11 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 10 Nov 2007 21:38:11 -0500
Subject: [Rd] C/C++ 'assert' should not be used in R packages
In-Reply-To: <Pine.GSO.4.56.0711101650190.18407@durian.statsci.com>
References: <Pine.LNX.4.64.0711071638510.7944@gannet.stats.ox.ac.uk>
	<47359829.8090909@stats.uwo.ca>
	<Pine.GSO.4.56.0711101650190.18407@durian.statsci.com>
Message-ID: <47366B13.8020205@stats.uwo.ca>

Bill Dunlap wrote:
> On Sat, 10 Nov 2007, Duncan Murdoch wrote:
>
>   
>> Prof Brian Ripley wrote:
>>     
>>> Please don't use 'assert' in R packages.  If called, this means that an
>>> error in your code aborts the whole R process, including your user's work.
>>> I see several R packages doing this, and one of them called 'assert' on me
>>> earlier in the week.
>>>
>>>       
>> I partly disagree about this.  If assert() is triggered, it clearly
>> indicates a bug in the package.  If it just generated an R error, most
>> users would ignore it, and not report it to the package maintainer.
>>
>> It may well be that when an assertion fails, none of the subsequent
>> calculations are reliable, in which case returning control to the user
>> could result in data corruption.  That's worse than losing a session,
>> because at least when you lose a session, you know it.
>>     
>
> I would think one would want to call assert() before doing something
> that might corrupt the session.  Sometimes you cannot arrange to
> do that, but most times you can.
>   
Sometimes assertions fail because the session is already corrupted.  The 
thing about assertions is that they aren't supposed to fail.
> I think it would be nice to have a class of "programmer errors",
> as opposed to "user errors".  (A user error is when the user enters
> inappropriate data for the function and a programmer error is
> when the inputs are appropriate but the code in the package is bad.)
> Supply functions at the R and C levels (assert() and Rf_assert(),
> respectively?) to throw such errors.  They would work about the
> same as stop() and Rf_error() do (longjmp to main input loop),
> but would print something like
>    'Internal/programmer error, report to authorities: n<0'
> instead of
>    'Error: n is negative'
> If the message automatically included the package name, file name,
> and line number for C code, so much the better, but the text of the message
> should identify it.
>
> You could install a special error handler for that class of errors
> if you wished.
>   
I think that would be a good idea.

Duncan Murdoch
>   
>> Could we write our own implementation of assert() that displays an R
>> error and unloads the package?  I think I could do something like that
>> in Windows by calling FreeLibrary to unload the DLL, but I'd prefer a
>> cross-platform solution.
>>     
>
> ----------------------------------------------------------------------------
> Bill Dunlap
> Insightful Corporation
> bill at insightful dot com
> 360-428-8146
>
>  "All statements in this message represent the opinions of the author and do
>  not necessarily reflect Insightful Corporation policy or position."
>


From simon.urbanek at r-project.org  Sun Nov 11 04:01:04 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sat, 10 Nov 2007 22:01:04 -0500
Subject: [Rd] C/C++ 'assert' should not be used in R packages
In-Reply-To: <473632CB.8050001@stats.uwo.ca>
References: <Pine.LNX.4.64.0711071638510.7944@gannet.stats.ox.ac.uk>	<47359829.8090909@stats.uwo.ca>	<4735F1C0.8050601@wald.ucdavis.edu>
	<4735F302.501@stats.uwo.ca>
	<AF618CB3-93F7-439C-AEBC-F84E3904E0CB@r-project.org>
	<473632CB.8050001@stats.uwo.ca>
Message-ID: <1FD599A6-A273-42EF-A5D7-B62B61CAA1E1@r-project.org>


On Nov 10, 2007, at 5:38 PM, Duncan Murdoch wrote:

> On 10/11/2007 4:27 PM, Simon Urbanek wrote:
>> On Nov 10, 2007, at 1:05 PM, Duncan Murdoch wrote:
>>> On 10/11/2007 1:00 PM, Duncan Temple Lang wrote:
>>>> -----BEGIN PGP SIGNED MESSAGE-----
>>>> Hash: SHA1
>>>>
>>>>
>>>>
>>>> Duncan Murdoch wrote:
>>>>> Prof Brian Ripley wrote:
>>>>>> Please don't use 'assert' in R packages.  If called, this  
>>>>>> means  that an
>>>>>> error in your code aborts the whole R process, including your   
>>>>>> user's work.
>>>>>> I see several R packages doing this, and one of them called   
>>>>>> 'assert' on me
>>>>>> earlier in the week.
>>>>>>
>>>>> I partly disagree about this.  If assert() is triggered, it  
>>>>> clearly
>>>>> indicates a bug in the package.  If it just generated an R  
>>>>> error,  most
>>>>> users would ignore it, and not report it to the package  
>>>>> maintainer.
>>>>>
>>>>> It may well be that when an assertion fails, none of the  
>>>>> subsequent
>>>>> calculations are reliable, in which case returning control to  
>>>>> the  user
>>>>> could result in data corruption.  That's worse than losing a   
>>>>> session,
>>>>> because at least when you lose a session, you know it.
>>>>>
>>>>> Could we write our own implementation of assert() that displays  
>>>>> an R
>>>>> error and unloads the package?  I think I could do something  
>>>>> like  that
>>>>> in Windows by calling FreeLibrary to unload the DLL, but I'd   
>>>>> prefer a
>>>>> cross-platform solution.
>>>> I am not sure why you think we need to discard the DLL.
>>> The package author has asserted that it is no longer safe to  
>>> run.   They are shutting down R, and Brian finds that too extreme.
>>>
>> Me too. A package should never intentionally close the R session.  
>> If  it does, it is a very severe design bug in the package  
>> (IMHO).  Anything you use assert for can be gracefully handled (as  
>> opposed to  let's say a segfault), so there is no excuse for  
>> killing the whole  process at all (deliberately wiping all user's  
>> work is rude to put it  mildly). Even if it might be unsafe to run  
>> anything, I'd still want  to attempt to save my data.
>
> Perhaps I use assert() differently than you, but the way I use it  
> is to assert assumptions that I believe will always be true.
>
> If one of those assertions fails, it means that my program is  
> operating in a way that I did not foresee.  I can't recover  
> gracefully from that, because at that point my basic assumptions  
> about the program have been proven to be incorrect.  I have no  
> basis for reasoning.  It is by definition a bug.
>
> Now, it's possible that this bug has corrupted R and it really  
> would be best for the user to discard all his work, but I agree  
> that's unlikely.  That's why I proposed that R should offer a way  
> to handle an assertion failure that limits the shutdown to just my  
> package.
>
> I don't offer a guarantee that my work won't corrupt a user's data,  
> but I do work hard to avoid that.  Allowing my package to tell the  
> user that it is now unsafe to use is one way to do so.

I agree with everything so far...


>   That's what assert() is for.
>

No, that's the part I don't agree with. assert() is for a stand-alone  
program, not for modules. Using assert takes down whole R despite the  
fact that R itself is highly likely fine. It's the same as if you  
proposed that an error in a program should take the whole OS down,  
because you want to really alert the user. (I know, some OSes really  
do this, but not the ones I'd want to use ... :P)


> In a standalone program, an (uncaught) assertion failure will cause  
> the RTL to shut down the process.  I think R should support a  
> version of that, but limit the shutdown to the package that has  
> failed.   The version of assert() that I put together for rgl this  
> morning doesn't attempt to shut down rgl, because that's really  
> something that R should be responsible for.  All it does is issue a  
> dire warning to the user.
>

Again, I fully agree with that.

Cheers,
Simon


From lupi at unimol.it  Sun Nov 11 18:50:05 2007
From: lupi at unimol.it (lupi at unimol.it)
Date: Sun, 11 Nov 2007 18:50:05 +0100 (CET)
Subject: [Rd] savePlot bug in R 2.6.0? (PR#10420)
Message-ID: <20071111175005.2F723282EFF7@mail.pubhealth.ku.dk>

Full_Name: Claudio Lupi
Version: 2.6.0
OS: Windows XP
Submission from: (NULL) (85.18.14.35)


Try the following:

xy <- matrix(rnorm(20),10,2)
plot(xy)
savePlot("c:/xy", type="pdf")
savePlot("c:/xy", type="eps")

This used to work fine with previous R versions. Instead, with R 2.6.0 I get:

> xy <- matrix(rnorm(20),10,2)
> plot(xy)
> savePlot("c:/xy", type="pdf")
Error in savePlot("c:/xy", type = "pdf") : Invalid font type
In addition: Warning messages:
1: In savePlot("c:/xy", type = "pdf") :
  font family not found in PostScript font database
2: In savePlot("c:/xy", type = "pdf") :
  font family not found in PostScript font database
> savePlot("c:/xy", type="eps")
Error in savePlot("c:/xy", type = "eps") : Invalid font type
In addition: Warning messages:
1: In savePlot("c:/xy", type = "eps") :
  font family not found in PostScript font database
2: In savePlot("c:/xy", type = "eps") :
  font family not found in PostScript font database
> 

savePlot works fine with type = "bmp".


From samytlctoo at yahoo.com  Sun Nov 11 03:48:56 2007
From: samytlctoo at yahoo.com (samy hafid)
Date: Sat, 10 Nov 2007 18:48:56 -0800 (PST)
Subject: [Rd]  e1071:svm - default epsilon = 0.1 (NOT 0.5) (PR#5671)
Message-ID: <209065.17113.qm@web59203.mail.re1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20071110/05c9f38b/attachment.pl 

From ripley at stats.ox.ac.uk  Mon Nov 12 09:41:56 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 12 Nov 2007 08:41:56 +0000 (GMT)
Subject: [Rd] savePlot bug in R 2.6.0? (PR#10420)
In-Reply-To: <20071111175005.2F723282EFF7@mail.pubhealth.ku.dk>
References: <20071111175005.2F723282EFF7@mail.pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.64.0711120838220.11099@gannet.stats.ox.ac.uk>

This is the same as PR#10403.  See

https://stat.ethz.ch/pipermail/r-devel/2007-November/047352.html

which links to a workaround: it has long been fixed in R-patched.


On Sun, 11 Nov 2007, lupi at unimol.it wrote:

> Full_Name: Claudio Lupi
> Version: 2.6.0
> OS: Windows XP
> Submission from: (NULL) (85.18.14.35)
>
>
> Try the following:
>
> xy <- matrix(rnorm(20),10,2)
> plot(xy)
> savePlot("c:/xy", type="pdf")
> savePlot("c:/xy", type="eps")
>
> This used to work fine with previous R versions. Instead, with R 2.6.0 I get:
>
>> xy <- matrix(rnorm(20),10,2)
>> plot(xy)
>> savePlot("c:/xy", type="pdf")
> Error in savePlot("c:/xy", type = "pdf") : Invalid font type
> In addition: Warning messages:
> 1: In savePlot("c:/xy", type = "pdf") :
>  font family not found in PostScript font database
> 2: In savePlot("c:/xy", type = "pdf") :
>  font family not found in PostScript font database
>> savePlot("c:/xy", type="eps")
> Error in savePlot("c:/xy", type = "eps") : Invalid font type
> In addition: Warning messages:
> 1: In savePlot("c:/xy", type = "eps") :
>  font family not found in PostScript font database
> 2: In savePlot("c:/xy", type = "eps") :
>  font family not found in PostScript font database
>>
>
> savePlot works fine with type = "bmp".
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From William.Fulton at ubs.com  Mon Nov 12 12:00:17 2007
From: William.Fulton at ubs.com (William.Fulton at ubs.com)
Date: Mon, 12 Nov 2007 11:00:17 -0000
Subject: [Rd] Building Rdll.lib with Visual C++
In-Reply-To: <Pine.LNX.4.64.0711091211040.23116@gannet.stats.ox.ac.uk>
References: <E81FF08A6B0BD24CB237041DEF7FAEB308A7C503@NLDNC101PEX1.ubsw.net>
	<Pine.LNX.4.64.0711091211040.23116@gannet.stats.ox.ac.uk>
Message-ID: <E81FF08A6B0BD24CB237041DEF7FAEB308A7C90D@NLDNC101PEX1.ubsw.net>

 

>-----Original Message-----
>From: Prof Brian Ripley
>Sent: 09 November 2007 12:17
>To: Fulton, William
>Cc: R-devel at r-project.org
>Subject: Re: [Rd] Building Rdll.lib with Visual C++
>
>On Fri, 9 Nov 2007, William.Fulton at ubs.com wrote:
>
>>> From the R-2.6.0/doc/README.packages it says:
>>
>>  Using Visual C++
>>  ================
>>
>>  You may if you prefer use Visual C++ to make the DLLs (unless they 
>> use  Fortran source!). The notes here were tested with VC++6.
>>
>>  First build the import library Rdll.lib by
>>
>> 	make R.exp
>>  ...
>>
>> In the installation (R-2.6.0-win32.exe) there is no Makefile with an 
>> R.exp target that I could find and I get (using Cygwin's make):
>>
>> $ pwd
>> /c/Program Files/R/R-2.6.0/src/gnuwin32 $ make R.exp
>> make: *** No rule to make target `R.exp'.  Stop.
>>
>> I found a R.exp target in the gnuwin32/Makefile after extracting the 
>> files in R-2.6.0.tar.gz. However, attempting to use this 
>target fails, 
>> it looks like it is attempting to build the object files in 
>R.dll first.
>> Do I have to go figure out how to build R from Source in 
>order to get 
>> the Rdll.lib file or am I doing something fundamentally wrong?
>
>You do (although it only involves RTFM).  Alternatively, you 
>could be less selective in your reading, and note it also says
>
>   (Another, less reliable, way to make R.exp is to use 
>pexports.exe from
>   mingw-utils.)
>
>The reason for the comment is that some earlier versions of 
>pexports.exe used to choke, but it seems to work on all recent 
>versions.
>
>> Perhaps the maintainers would consider shipping Rdll.lib in 
>the future 
>> with the distribution like the equivalent .lib file is done for 
>> building extensions for Perl, Ruby, Tcl, Python etc.
>
>But they are built with VC++, and R is not.  No such file is 
>needed to build extensions for R using the recommended tools.
>

I've read the build instructions and as I feared, R inflicts the same
sort of pain on users for building from source for Windows as another
project I work on! As an aside, I've just discovered the mingw cross
compilers which now makes building for Windows super easy given the ease
with which packages can be installed on Ubuntu/Debian.

I opted for the pexports route given your helpful comments on the recent
versions working. It's all working and I've also sent a patch for
README.packages to the R-windows email address clarifying some of these
points.

William
Visit our website at http://www.ubs.com

This message contains confidential information and is in...{{dropped:28}}


From hpages at fhcrc.org  Tue Nov 13 09:36:25 2007
From: hpages at fhcrc.org (hpages at fhcrc.org)
Date: Tue, 13 Nov 2007 00:36:25 -0800
Subject: [Rd] slots of type "double"
Message-ID: <1194942985.4739620919f16@webmail.fhcrc.org>

Hi,

Any idea why S4 doesn't allow slots of type "double"?

  > setClass("A", representation(a="double"))
  Error in makePrototypeFromClassDef(properties, ClassDef, immediate, where) : 
    in making the prototype for class "A" elements of the prototype failed to
match the corresponding slot class: a (class ?double? )

"numeric", "integer", "character", "complex", "raw", etc... they all work
but "double" doesn't. Any reason for this strange exception?

Thanks!
H.


From oehl_list at gmx.de  Tue Nov 13 14:35:59 2007
From: oehl_list at gmx.de (=?iso-8859-1?Q?=22Jens_Oehlschl=E4gel=22?=)
Date: Tue, 13 Nov 2007 14:35:59 +0100
Subject: [Rd] How to overload the assignment operator?
Message-ID: <20071113133559.270580@gmx.net>

Dear all,

what is the proper way to make the assignment operator generic and define methods depending on the class of the assigned value?

Best regards


Jens Oehlschl?gel

P.S. I vaguely remember that this was possible in S+. In R I tried to no avail: 

  # using this like h<-1:3 gives Error: in `<-.default`(h, 1:3) : invalid (do_set) left-hand side to assignment
  "<-.default" <- get("<-") 

  # using this does fail on subassignments like: h <- 1:3 ; h[1] <- 7 (h still is 1:3)
  "<-.default" <- function(x, value){
    assign(deparse(substitute(x)), value, parent.frame())
    invisible(x)
  }

  # this seems to work
  "<-" <- function(x, value){
    UseMethod("<-", value)
  }

  # whenever the assigned value has class 'ff' I want to do execute something like
  "<-.ff" <- function(x, value){
    y <- clone(value)
    assign(deparse(substitute(x)), y, parent.frame())
    y
  }


> version
               _                           
platform       i386-pc-mingw32             
arch           i386                        
os             mingw32                     
system         i386, mingw32               
status                                     
major          2                           
minor          6.0                         
year           2007                        
month          10                          
day            03                          
svn rev        43063                       
language       R                           
version.string R version 2.6.0 (2007-10-03)

--


From Matthias.Kohl at stamats.de  Tue Nov 13 14:52:53 2007
From: Matthias.Kohl at stamats.de (Matthias Kohl)
Date: Tue, 13 Nov 2007 14:52:53 +0100
Subject: [Rd] How to overload the assignment operator?
In-Reply-To: <20071113133559.270580@gmx.net>
References: <20071113133559.270580@gmx.net>
Message-ID: <4739AC35.1080209@stamats.de>

are you looking for "setReplaceMethod"?
hth
Matthias

Jens Oehlschl?gel wrote:
> Dear all,
>
> what is the proper way to make the assignment operator generic and define methods depending on the class of the assigned value?
>
> Best regards
>
>
> Jens Oehlschl?gel
>
> P.S. I vaguely remember that this was possible in S+. In R I tried to no avail: 
>
>   # using this like h<-1:3 gives Error: in `<-.default`(h, 1:3) : invalid (do_set) left-hand side to assignment
>   "<-.default" <- get("<-") 
>
>   # using this does fail on subassignments like: h <- 1:3 ; h[1] <- 7 (h still is 1:3)
>   "<-.default" <- function(x, value){
>     assign(deparse(substitute(x)), value, parent.frame())
>     invisible(x)
>   }
>
>   # this seems to work
>   "<-" <- function(x, value){
>     UseMethod("<-", value)
>   }
>
>   # whenever the assigned value has class 'ff' I want to do execute something like
>   "<-.ff" <- function(x, value){
>     y <- clone(value)
>     assign(deparse(substitute(x)), y, parent.frame())
>     y
>   }
>
>
>   
>> version
>>     
>                _                           
> platform       i386-pc-mingw32             
> arch           i386                        
> os             mingw32                     
> system         i386, mingw32               
> status                                     
> major          2                           
> minor          6.0                         
> year           2007                        
> month          10                          
> day            03                          
> svn rev        43063                       
> language       R                           
> version.string R version 2.6.0 (2007-10-03)
>
> --
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From osklyar at ebi.ac.uk  Tue Nov 13 15:07:57 2007
From: osklyar at ebi.ac.uk (Oleg Sklyar)
Date: Tue, 13 Nov 2007 14:07:57 +0000
Subject: [Rd] How to overload the assignment operator?
In-Reply-To: <4739AC35.1080209@stamats.de>
References: <20071113133559.270580@gmx.net>  <4739AC35.1080209@stamats.de>
Message-ID: <1194962877.6631.6.camel@maitai.windows.ebi.ac.uk>

I think the question is not about setReplaceMethod, here is the idea:

## setReplaceMethod-like situation:

> names(x) <- c("a","b")

## the question of interest

> class(x)
[1] myClass
> y <- x ## this to run a user-defined clone method for class 'myClass'

Why is this important - if x contains data that actually needs to be
duplicated this would come handy. I'd like to know the solution as well.
Maybe it's my ignorance that I don't know the answer and the response
will be RTFM - fine, just point out where :)

Best,
Oleg



On Tue, 2007-11-13 at 14:52 +0100, Matthias Kohl wrote:
> are you looking for "setReplaceMethod"?
> hth
> Matthias
> 
> Jens Oehlschl?gel wrote:
> > Dear all,
> >
> > what is the proper way to make the assignment operator generic and define methods depending on the class of the assigned value?
> >
> > Best regards
> >
> >
> > Jens Oehlschl?gel
> >
> > P.S. I vaguely remember that this was possible in S+. In R I tried to no avail: 
> >
> >   # using this like h<-1:3 gives Error: in `<-.default`(h, 1:3) : invalid (do_set) left-hand side to assignment
> >   "<-.default" <- get("<-") 
> >
> >   # using this does fail on subassignments like: h <- 1:3 ; h[1] <- 7 (h still is 1:3)
> >   "<-.default" <- function(x, value){
> >     assign(deparse(substitute(x)), value, parent.frame())
> >     invisible(x)
> >   }
> >
> >   # this seems to work
> >   "<-" <- function(x, value){
> >     UseMethod("<-", value)
> >   }
> >
> >   # whenever the assigned value has class 'ff' I want to do execute something like
> >   "<-.ff" <- function(x, value){
> >     y <- clone(value)
> >     assign(deparse(substitute(x)), y, parent.frame())
> >     y
> >   }
> >
> >
> >   
> >> version
> >>     
> >                _                           
> > platform       i386-pc-mingw32             
> > arch           i386                        
> > os             mingw32                     
> > system         i386, mingw32               
> > status                                     
> > major          2                           
> > minor          6.0                         
> > year           2007                        
> > month          10                          
> > day            03                          
> > svn rev        43063                       
> > language       R                           
> > version.string R version 2.6.0 (2007-10-03)
> >
> > --
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
-- 
Dr Oleg Sklyar * EBI-EMBL, Cambridge CB10 1SD, UK * +44-1223-494466


From oehl_list at gmx.de  Tue Nov 13 15:19:05 2007
From: oehl_list at gmx.de (=?iso-8859-1?Q?=22Jens_Oehlschl=E4gel=22?=)
Date: Tue, 13 Nov 2007 15:19:05 +0100
Subject: [Rd] How to overload the assignment operator?
Message-ID: <20071113141905.267830@gmx.net>

Thanks Matthias,

> are you looking for "setReplaceMethod"?

So far the package I m writing has avoided using anything from S4 and the implications of touching S4 are not clear to me. The package aims on providing an alternative to 'atomic' data stored in ram, i.e. large atomic data stored on disk. I need some advice how to do this maximally performant, which probably means pure S3!?

Best regards


Jens Oehlschl?gel
--


From simon.urbanek at r-project.org  Tue Nov 13 15:23:53 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 13 Nov 2007 09:23:53 -0500
Subject: [Rd] slots of type "double"
In-Reply-To: <1194942985.4739620919f16@webmail.fhcrc.org>
References: <1194942985.4739620919f16@webmail.fhcrc.org>
Message-ID: <2BBF01A3-5F39-4750-B42E-12605674F49E@r-project.org>


On Nov 13, 2007, at 3:36 AM, hpages at fhcrc.org wrote:

> Any idea why S4 doesn't allow slots of type "double"?
>

Type (as in storage type and "double" is a storage type) has nothing  
to do with classes. You cannot create slots for types, only for classes.


>> setClass("A", representation(a="double"))
>  Error in makePrototypeFromClassDef(properties, ClassDef, immediate,  
> where) :
>    in making the prototype for class "A" elements of the prototype  
> failed to
> match the corresponding slot class: a (class ?double? )
>
> "numeric", "integer", "character", "complex", "raw", etc... they all  
> work but "double" doesn't. Any reason for this strange exception?
>

AFAICS there is no way to create an object of the class "double" (save  
for 'faking' it by creating an informal S3 object), so such definition  
is useless. And given this fact, even the internal code is unable to  
create it, so it doesn't match the signature. Note:

 > a=new("double")
 > class(a)
[1] "numeric"
 > is(a,"double")
[1] FALSE

I think it comes from the fact that there is an S4 definition for the  
class "double" which is not valid. That is probably a bug and the  
class definition should be removed.

Cheers,
Simon


From simon.urbanek at r-project.org  Tue Nov 13 15:52:37 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 13 Nov 2007 09:52:37 -0500
Subject: [Rd] How to overload the assignment operator?
In-Reply-To: <20071113141905.267830@gmx.net>
References: <20071113141905.267830@gmx.net>
Message-ID: <3AE74023-B7C7-4E36-A2E5-FC407D666A48@r-project.org>


On Nov 13, 2007, at 9:19 AM, Jens Oehlschl?gel wrote:

> Thanks Matthias,
>
>> are you looking for "setReplaceMethod"?
>
> So far the package I m writing has avoided using anything from S4  
> and the implications of touching S4 are not clear to me. The package  
> aims on providing an alternative to 'atomic' data stored in ram,  
> i.e. large atomic data stored on disk. I need some advice how to do  
> this maximally performant, which probably means pure S3!?
>

You cannot use S3 here, because you want to dispatch on the *second*  
argument.

I don't think you want to do what you described - you would slow down  
everything in R considerably just by making `<-` a generic (and in  
fact you cannot do that for a good reason).

Why don't you take the external pointer approach that many others take  
to provide proxy objects to external data? (DB access, mem-mapped  
files, cross-language objects, etc.) That allows you to define your  
storage semantics very efficiently in C. You can still choose to  
define any syntactic sugar you want in either S3 or S4.

Cheers,
Simon


From ripley at stats.ox.ac.uk  Tue Nov 13 16:04:43 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 13 Nov 2007 15:04:43 +0000 (GMT)
Subject: [Rd] How to overload the assignment operator?
In-Reply-To: <20071113141905.267830@gmx.net>
References: <20071113141905.267830@gmx.net>
Message-ID: <Pine.LNX.4.64.0711131429420.9317@gannet.stats.ox.ac.uk>

On Tue, 13 Nov 2007, "Jens Oehlschl?gel" wrote:

> Thanks Matthias,
>
>> are you looking for "setReplaceMethod"?
>
> So far the package I m writing has avoided using anything from S4 and 
> the implications of touching S4 are not clear to me. The package aims on 
> providing an alternative to 'atomic' data stored in ram, i.e. large 
> atomic data stored on disk. I need some advice how to do this maximally 
> performant, which probably means pure S3!?

setReplaceMethod() is just syntactic sugar for setting an S4 method on a 
replacement function (read the function definition to see so).  You can 
set S3 replacement methods, and the S4 mechanism just piggy-backs on that.

I think the conceptual problem is that the assignment operator does not 
actually do any copying: it creates a binding of a symbol to a value. 
Any copying which occurs happens when the value is (potentially) changed. 
There is no provision for that to depend on the class (rather than the 
type) of the object.  Since external pointers are never duplicated, you 
ought to be able to take advantage of that to design the copying semantics 
you want.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ggrothendieck at gmail.com  Tue Nov 13 16:18:06 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 13 Nov 2007 10:18:06 -0500
Subject: [Rd] How to overload the assignment operator?
In-Reply-To: <20071113141905.267830@gmx.net>
References: <20071113141905.267830@gmx.net>
Message-ID: <971536df0711130718u290ff19cw4428c81e7ee175ab@mail.gmail.com>

Check out the g.data package in case that's what you are looking for.  It
uses promises until the data is actually used.

On Nov 13, 2007 9:19 AM, "Jens Oehlschl?gel" <oehl_list at gmx.de> wrote:
> Thanks Matthias,
>
> > are you looking for "setReplaceMethod"?
>
> So far the package I m writing has avoided using anything from S4 and the implications of touching S4 are not clear to me. The package aims on providing an alternative to 'atomic' data stored in ram, i.e. large atomic data stored on disk. I need some advice how to do this maximally performant, which probably means pure S3!?
>
> Best regards
>
>
> Jens Oehlschl?gel
>
> --
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ripley at stats.ox.ac.uk  Tue Nov 13 16:37:16 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 13 Nov 2007 15:37:16 +0000 (GMT)
Subject: [Rd] slots of type "double"
In-Reply-To: <2BBF01A3-5F39-4750-B42E-12605674F49E@r-project.org>
References: <1194942985.4739620919f16@webmail.fhcrc.org>
	<2BBF01A3-5F39-4750-B42E-12605674F49E@r-project.org>
Message-ID: <Pine.LNX.4.64.0711131448370.9317@gannet.stats.ox.ac.uk>

On Tue, 13 Nov 2007, Simon Urbanek wrote:

>
> On Nov 13, 2007, at 3:36 AM, hpages at fhcrc.org wrote:
>
>> Any idea why S4 doesn't allow slots of type "double"?
>>
>
> Type (as in storage type and "double" is a storage type) has nothing
> to do with classes. You cannot create slots for types, only for classes.

Unfortunately not in the world of the 'methods' package (which seems to 
differ here from the Green Book and S-PLUS).  There's a basic class 
"double" (and also "single") defined in BasicClasses.R.  It say:

> getClass("double")

No Slots, prototype of class "numeric"

Extends: "vector", "numeric"

> getClass("numeric")

No Slots, prototype of class "numeric"

Extends: "vector"

Known Subclasses: "double", "integer"

So it is an otherwise unspecified subclass of "numeric".

Now when you do

> a <- new("numeric", pi)
> a
[1] 3.141593
> class(a)
[1] "numeric"

you are in fact calling class() on a REALSXP, and that is set up to report 
"numeric" (the implicit class comes from mode not type, except for 
"integer").

Anther area of confusion is that as.numeric, as.double and as.real are 
three names for the same thing, but is.numeric and is.double are not the 
same.  So we end up with

> x <- 1:3
> is.numeric(x)
[1] TRUE
> identical(x, as.numeric(x))
[1] FALSE
> x <- pi
> is.numeric(x)
[1] TRUE
> identical(x, as.numeric(x))
[1] TRUE

Basically I think class() is wrong (it should use "double"), but it was 
not my choice and it was presumably done to agree with the Green Book.

I agree that it would be best to remove the "double" and "single" S4 
classes.  At least in the version of S-PLUS I have left, "double" does not 
exist -- "single" does but is a distinct storage type.


>
>
>>> setClass("A", representation(a="double"))
>>  Error in makePrototypeFromClassDef(properties, ClassDef, immediate,
>> where) :
>>    in making the prototype for class "A" elements of the prototype
>> failed to
>> match the corresponding slot class: a (class ?double? )
>>
>> "numeric", "integer", "character", "complex", "raw", etc... they all
>> work but "double" doesn't. Any reason for this strange exception?
>>
>
> AFAICS there is no way to create an object of the class "double" (save
> for 'faking' it by creating an informal S3 object), so such definition
> is useless. And given this fact, even the internal code is unable to
> create it, so it doesn't match the signature. Note:
>
> > a=new("double")
> > class(a)
> [1] "numeric"
> > is(a,"double")
> [1] FALSE
>
> I think it comes from the fact that there is an S4 definition for the
> class "double" which is not valid. That is probably a bug and the
> class definition should be removed.
>
> Cheers,
> Simon
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From oehl_list at gmx.de  Tue Nov 13 16:57:03 2007
From: oehl_list at gmx.de (=?iso-8859-1?Q?=22Jens_Oehlschl=E4gel=22?=)
Date: Tue, 13 Nov 2007 16:57:03 +0100
Subject: [Rd] How to overload the assignment operator?
Message-ID: <20071113155703.57610@gmx.net>

Thank you Brian,

> setReplaceMethod() is just syntactic sugar for setting an S4 method on a 
> replacement function (read the function definition to see so).  You can 
> set S3 replacement methods, and the S4 mechanism just piggy-backs on that.

So I understand that setReplaceMethod will not help.

> I think the conceptual problem is that the assignment operator does not 
> actually do any copying: it creates a binding of a symbol to a value. 
> Any copying which occurs happens when the value is (potentially) changed. 

I would be even happier if the cloning would only occur on any attempt to change the external pointer / proxy-object. 

> There is no provision for that to depend on the class (rather than the 
> type) of the object.  

Mh, unless the internal copying mechanism would call a clone generic for non-atomic objects

> Since external pointers are never duplicated, you 
> ought to be able to take advantage of that to design the copying semantics 
> you want.

How that? How do I know that any user has assigned/modified the external pointer (or a proxy object containing the external pointer) such that I can invoke the cloning?

Best regards


Jens Oehlschl?gel
--


From oehl_list at gmx.de  Tue Nov 13 17:00:23 2007
From: oehl_list at gmx.de (=?iso-8859-1?Q?=22Jens_Oehlschl=E4gel=22?=)
Date: Tue, 13 Nov 2007 17:00:23 +0100
Subject: [Rd] How to overload the assignment operator?
Message-ID: <20071113160023.247410@gmx.net>

Thanks Simon,

> You cannot use S3 here, because you want to dispatch on the *second*  
> argument.

"<-" <- function(x, value)UseMethod("<-", value)
DOES dispatch on the second argument (see the dispatchsecond example below)

> Why don't you take the external pointer approach that many others take  
> to provide proxy objects to external data? (DB access, mem-mapped  
> files, cross-language objects, etc.) That allows you to define your  
> storage semantics very efficiently in C. You can still choose to  
> define any syntactic sugar you want in either S3 or S4.

I AM using the external pointer approach and this works verly well - if one tolerates that the external data is not duplicated when the proxy object is copied. I was wondering however, if it is possible to perfectly mimic R's copying semantics: duplicate external object (and the external pointer) on assignment (or even better only on modify after assignment).

Best regards

Jens Oehlschl?gel

> dispatchsecond <- function(first, second)
+ UseMethod("dispatchsecond", second)
> 
> dispatchsecond.default <- function(first, second){
+ cat("here default\n")
+ }
> 
> dispatchsecond.ff <- function(first, second){
+ cat("here ff\n")
+ }
> 
> default <- 1
> ff <- 1
> class(ff) <- "ff"
> 
> dispatchsecond(1,default)
here default
> dispatchsecond(1,ff)
here ff
> 
--


From joehl at gmx.de  Tue Nov 13 16:39:02 2007
From: joehl at gmx.de (=?iso-8859-1?Q?=22Jens_Oehlschl=E4gel=22?=)
Date: Tue, 13 Nov 2007 16:39:02 +0100
Subject: [Rd] How to overload the assignment operator?
Message-ID: <20071113153902.57630@gmx.net>

Thanks Simon,

> You cannot use S3 here, because you want to dispatch on the *second*  
> argument.

"<-" <- function(x, value)UseMethod("<-", value)
DOES dispatch on the second argument (see the dispatchsecond example below)

> Why don't you take the external pointer approach that many others take  
> to provide proxy objects to external data? (DB access, mem-mapped  
> files, cross-language objects, etc.) That allows you to define your  
> storage semantics very efficiently in C. You can still choose to  
> define any syntactic sugar you want in either S3 or S4.

I AM using the external pointer approach and this works verly well - if one tolerates that the external data is not duplicated when the proxy object is copied. I was wondering however, if it is possible to perfectly mimic R's copying semantics: duplicate external object (and the external pointer) on assignment (or even better only on modify after assignment).

Best regards

Jens Oehlschl?gel

> dispatchsecond <- function(first, second)
+ UseMethod("dispatchsecond", second)
> 
> dispatchsecond.default <- function(first, second){
+ cat("here default\n")
+ }
> 
> dispatchsecond.ff <- function(first, second){
+ cat("here ff\n")
+ }
> 
> default <- 1
> ff <- 1
> class(ff) <- "ff"
> 
> dispatchsecond(1,default)
here default
> dispatchsecond(1,ff)
here ff
> 
--


From jmc at r-project.org  Tue Nov 13 19:12:03 2007
From: jmc at r-project.org (John Chambers)
Date: Tue, 13 Nov 2007 10:12:03 -0800
Subject: [Rd] slots of type "double"
In-Reply-To: <Pine.LNX.4.64.0711131448370.9317@gannet.stats.ox.ac.uk>
References: <1194942985.4739620919f16@webmail.fhcrc.org>	<2BBF01A3-5F39-4750-B42E-12605674F49E@r-project.org>
	<Pine.LNX.4.64.0711131448370.9317@gannet.stats.ox.ac.uk>
Message-ID: <4739E8F3.5040302@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20071113/f13be655/attachment.pl 

From ripley at stats.ox.ac.uk  Tue Nov 13 19:19:02 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 13 Nov 2007 18:19:02 +0000 (GMT)
Subject: [Rd] slots of type "double"
In-Reply-To: <4739E8F3.5040302@r-project.org>
References: <1194942985.4739620919f16@webmail.fhcrc.org>
	<2BBF01A3-5F39-4750-B42E-12605674F49E@r-project.org>
	<Pine.LNX.4.64.0711131448370.9317@gannet.stats.ox.ac.uk>
	<4739E8F3.5040302@r-project.org>
Message-ID: <Pine.LNX.4.64.0711131816130.11720@gannet.stats.ox.ac.uk>

On Tue, 13 Nov 2007, John Chambers wrote:

> What's the proposal here?  To eliminate "double" as a class?  No objection

Eliminate "double" and "single".

> from this corner.  As I remember, it was put in early in the implementation 
> of methods, when I was confused about what R intended in this area (well, I'm 
> not totally unconfused even now).
>
> If this is the proposal, we could implement it in r-devel and see if there 
> are complaints.

I was going to propose so after running some tests over CRAN/BioC (which 
will take a few hours).

Brian

> Prof Brian Ripley wrote:
>> On Tue, 13 Nov 2007, Simon Urbanek wrote:
>>
>> 
>>> On Nov 13, 2007, at 3:36 AM, hpages at fhcrc.org wrote:
>>>
>>> 
>>>> Any idea why S4 doesn't allow slots of type "double"?
>>>>
>>>> 
>>> Type (as in storage type and "double" is a storage type) has nothing
>>> to do with classes. You cannot create slots for types, only for classes.
>>> 
>> 
>> Unfortunately not in the world of the 'methods' package (which seems to 
>> differ here from the Green Book and S-PLUS).  There's a basic class 
>> "double" (and also "single") defined in BasicClasses.R.  It say:
>>
>> 
>>> getClass("double")
>>> 
>> 
>> No Slots, prototype of class "numeric"
>> 
>> Extends: "vector", "numeric"
>>
>> 
>>> getClass("numeric")
>>> 
>> 
>> No Slots, prototype of class "numeric"
>> 
>> Extends: "vector"
>> 
>> Known Subclasses: "double", "integer"
>> 
>> So it is an otherwise unspecified subclass of "numeric".
>> 
>> Now when you do
>>
>> 
>>> a <- new("numeric", pi)
>>> a
>>> 
>> [1] 3.141593
>> 
>>> class(a)
>>> 
>> [1] "numeric"
>> 
>> you are in fact calling class() on a REALSXP, and that is set up to report 
>> "numeric" (the implicit class comes from mode not type, except for 
>> "integer").
>> 
>> Anther area of confusion is that as.numeric, as.double and as.real are 
>> three names for the same thing, but is.numeric and is.double are not the 
>> same.  So we end up with
>>
>> 
>>> x <- 1:3
>>> is.numeric(x)
>>> 
>> [1] TRUE
>> 
>>> identical(x, as.numeric(x))
>>> 
>> [1] FALSE
>> 
>>> x <- pi
>>> is.numeric(x)
>>> 
>> [1] TRUE
>> 
>>> identical(x, as.numeric(x))
>>> 
>> [1] TRUE
>> 
>> Basically I think class() is wrong (it should use "double"), but it was not 
>> my choice and it was presumably done to agree with the Green Book.
>> 
>> I agree that it would be best to remove the "double" and "single" S4 
>> classes.  At least in the version of S-PLUS I have left, "double" does not 
>> exist -- "single" does but is a distinct storage type.
>> 
>>
>>
>>> 
>>>>> setClass("A", representation(a="double"))
>>>>>
>>>>  Error in makePrototypeFromClassDef(properties, ClassDef, immediate,
>>>> where) :
>>>>    in making the prototype for class "A" elements of the prototype
>>>> failed to
>>>> match the corresponding slot class: a (class ?double? )
>>>> 
>>>> "numeric", "integer", "character", "complex", "raw", etc... they all
>>>> work but "double" doesn't. Any reason for this strange exception?
>>>>
>>>> 
>>> AFAICS there is no way to create an object of the class "double" (save
>>> for 'faking' it by creating an informal S3 object), so such definition
>>> is useless. And given this fact, even the internal code is unable to
>>> create it, so it doesn't match the signature. Note:
>>>
>>> 
>>>> a=new("double")
>>>> class(a)
>>>> 
>>> [1] "numeric"
>>> 
>>>> is(a,"double")
>>>> 
>>> [1] FALSE
>>> 
>>> I think it comes from the fact that there is an S4 definition for the
>>> class "double" which is not valid. That is probably a bug and the
>>> class definition should be removed.
>>> 
>>> Cheers,
>>> Simon
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>> 
>>
>>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Tue Nov 13 21:05:16 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 13 Nov 2007 20:05:16 +0000 (GMT)
Subject: [Rd] How to overload the assignment operator?
In-Reply-To: <20071113155703.57610@gmx.net>
References: <20071113155703.57610@gmx.net>
Message-ID: <Pine.LNX.4.64.0711131959350.14849@gannet.stats.ox.ac.uk>

On Tue, 13 Nov 2007, "Jens Oehlschl?gel" wrote:

> Thank you Brian,
>
>> setReplaceMethod() is just syntactic sugar for setting an S4 method on a
>> replacement function (read the function definition to see so).  You can
>> set S3 replacement methods, and the S4 mechanism just piggy-backs on that.
>
> So I understand that setReplaceMethod will not help.
>
>> I think the conceptual problem is that the assignment operator does not
>> actually do any copying: it creates a binding of a symbol to a value.
>> Any copying which occurs happens when the value is (potentially) changed.
>
> I would be even happier if the cloning would only occur on any attempt to change the external pointer / proxy-object.
>
>> There is no provision for that to depend on the class (rather than the
>> type) of the object.
>
> Mh, unless the internal copying mechanism would call a clone generic for non-atomic objects

But as I said, there is no provision for that.  Nor is there going to be. 
One reason is performance, as Simon has hinted.  Another is consistency: 
duplication might well be called from places where class is being ignored.

>> Since external pointers are never duplicated, you
>> ought to be able to take advantage of that to design the copying semantics
>> you want.
>
> How that? How do I know that any user has assigned/modified the external pointer (or a proxy object containing the external pointer) such that I can invoke the cloning?

I don't even know what you want to do.  But I don't think copying is the 
place to find out if a user changed an object: presumably it was done via 
your interface.


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From kamil at ualberta.ca  Tue Nov 13 23:36:35 2007
From: kamil at ualberta.ca (kamil Marcinkowski)
Date: Tue, 13 Nov 2007 15:36:35 -0700
Subject: [Rd] R 2.6.0 make check fails on SGI origin 350 and
In-Reply-To: <39B05A63-0B09-4C15-983C-4FCC51641A0B@ualberta.ca>
References: <42665B36-6FE2-48A4-A1C4-09F67D61A28C@ualberta.ca>
	<Pine.LNX.4.64.0711062341250.30885@gannet.stats.ox.ac.uk>
	<A8521DA1-CFA8-4B2D-896B-690AF301E122@ualberta.ca>
	<18226.54375.972183.286953@stat.math.ethz.ch>
	<6B3A01D9-B6A9-483A-9EA6-013BA8743BDD@ualberta.ca>
	<18227.19165.686297.222253@stat.math.ethz.ch>
	<39B05A63-0B09-4C15-983C-4FCC51641A0B@ualberta.ca>
Message-ID: <64596DC1-C0A3-4671-B7AE-CEB5EA5DFADE@ualberta.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20071113/548c1a0e/attachment.pl 

From ripley at stats.ox.ac.uk  Wed Nov 14 00:06:43 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 13 Nov 2007 23:06:43 +0000 (GMT)
Subject: [Rd] R 2.6.0 make check fails on SGI origin 350 and
In-Reply-To: <64596DC1-C0A3-4671-B7AE-CEB5EA5DFADE@ualberta.ca>
References: <42665B36-6FE2-48A4-A1C4-09F67D61A28C@ualberta.ca>
	<Pine.LNX.4.64.0711062341250.30885@gannet.stats.ox.ac.uk>
	<A8521DA1-CFA8-4B2D-896B-690AF301E122@ualberta.ca>
	<18226.54375.972183.286953@stat.math.ethz.ch>
	<6B3A01D9-B6A9-483A-9EA6-013BA8743BDD@ualberta.ca>
	<18227.19165.686297.222253@stat.math.ethz.ch>
	<39B05A63-0B09-4C15-983C-4FCC51641A0B@ualberta.ca>
	<64596DC1-C0A3-4671-B7AE-CEB5EA5DFADE@ualberta.ca>
Message-ID: <Pine.LNX.4.64.0711132259350.19784@gannet.stats.ox.ac.uk>

The perl-related warnings have gone in R-devel: we now take the view that 
since we need perl to make the test suite, perl >= 5.8.0 is compulsory. 
(5.6.1 is now over 7 years' old, and 5.8.0 is more than 5.)

The make check failure is in reg-tests-1.R and so will show up in 
reg-tests-1.Rout.fail.  What is at the bottom of that file?

The rest seem to indicate infelicities in how IEC60559 arithmetic is 
handled, e.g the particular NaN that represents NA not being propagated 
correctly and non-use of denormalized numbers.

On Tue, 13 Nov 2007, kamil Marcinkowski wrote:

> Hello list
>
> Thank you for your help with the d-p-q-r-tests on Irix.
>
> After patching d-p-q-r-tests.R, and d-p-q-r-tests.Rout.save file to
> reflect the
> change, d-p-q-r tests succeed but  make check still fails:
>
>> comparing 'complex.Rout' to './complex.Rout.save' ...188c188
>> < [1] 0+0i
>> ---
>>> [1] 1.6789e-308+0i
>>  OK
>> running code in 'print-tests.R' ... OK
>> comparing 'print-tests.Rout' to './print-tests.Rout.save' ...256c256
>> < [1] 9
>> ---
>>> [1] 11
>> 260c260
>> < [1]  0.000000e+00 2.225074e-308 2.225074e-308 2.227299e-308
>> 2.447581e-308
>> ---
>>> [1] 2.002566e-308 2.222849e-308 2.225074e-308 2.225074e-308
>> 2.225074e-308 2.227299e-308 2.447581e-308
>> 266c266
>> < [1]  0.000000e+00  0.000000e+00  0.000000e+00 2.447581e-308
>> 1.566452e-306 1.253162e-305
>> ---
>>> [1] 2.002566e-308 2.447581e-308 1.281643e-306 1.566452e-306
>> 1.025314e-305 1.253162e-305
>> 269,273c269,273
>> < [1,]  0e+00  0e+00  0.0e+00  0.00e+00  0.000e+00  0.0000e+00
>> 0.00000e+00
>> < [2,]  0e+00  0e+00  0.0e+00  0.00e+00  0.000e+00  0.0000e+00
>> 0.00000e+00
>> < [3,]  0e+00  0e+00  0.0e+00  0.00e+00  0.000e+00  0.0000e+00
>> 0.00000e+00
>> < [4,]  0e+00  0e+00 2.4e-308 2.45e-308 2.448e-308 2.4476e-308
>> 2.44758e-308
>> < [5,] 2e-306 2e-306 1.6e-306 1.57e-306 1.566e-306 1.5665e-306
>> 1.56645e-306
>> ---
>>> [1,] 2e-308 2e-308 2.0e-308 2.00e-308 2.003e-308 2.0026e-308
>> 2.00257e-308
>>> [2,] 2e-308 2e-308 2.4e-308 2.45e-308 2.448e-308 2.4476e-308
>> 2.44758e-308
>>> [3,] 1e-306 1e-306 1.3e-306 1.28e-306 1.282e-306 1.2816e-306
>> 1.28164e-306
>>> [4,] 2e-306 2e-306 1.6e-306 1.57e-306 1.566e-306 1.5665e-306
>> 1.56645e-306
>>> [5,] 1e-305 1e-305 1.0e-305 1.03e-305 1.025e-305 1.0253e-305
>> 1.02531e-305
>> 355c355
>> < 4.141593+  1i 4.341593+ 10i      NaN+NaNi      Inf+  0i     -Inf
>> +NaNi      NaN+Infi
>> ---
>>> 4.141593+  1i 4.341593+ 10i            NA      Inf+  0i     -Inf
>> +NaNi      NaN+Infi
>> 358c358
>> < [1,] 4.141593+ 1i NaN+NaNi -Inf+NaNi
>> ---
>>> [1,] 4.141593+ 1i     NA -Inf+NaNi
>> 364c364
>> < [3,] NaN+      NaNi  NaN+     Infi
>> ---
>>> [3,]             NA  NaN+     Infi
>>  OK
>> running code in 'datasets.R' ... OK
>> comparing 'datasets.Rout' to './datasets.Rout.save' ... OK
>> running code in 'lapack.R' ... OK
>> comparing 'lapack.Rout' to './lapack.Rout.save' ... OK
>> gmake[3]: Leaving directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/tests'
>> gmake[2]: Leaving directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/tests'
>> gmake[2]: Entering directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/tests'
>> running regression tests
>> gmake[3]: Entering directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/tests'
>> running code in 'reg-tests-1.R' ...gmake[3]: *** [reg-tests-1.Rout]
>> Error 1
>> gmake[3]: Leaving directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/tests'
>> gmake[2]: *** [test-Reg] Error 2
>> gmake[2]: Leaving directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/tests'
>> gmake[1]: *** [test-all-basics] Error 1
>> gmake[1]: Leaving directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/tests'
>> gmake: *** [check] Error 2
>>
>
>
> Also since we are using perl 5.6 on the system; the documentation
> system did not build.
>
>> root at nexus:104#	perl -v
>> This is perl, v5.6.1 built for irix-n32
>
>
> configure output:
>> checking for perl... /usr/sbin/perl
>> checking whether perl version is at least 5.8.0... Perl v5.8.0
>> required--this is only v5.6.1, stopped at -e line 1.
>> no
>> configure: WARNING: you cannot build the object documentation system
>
>
> The following errors occurred during gmake check:
>
>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> you need Perl version 5 to build the R object docs
>> gmake[5]: *** [Rdfiles] Error 1
>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> file ../../library/base/R-ex cannot be opened at ../../share/perl/
>> massage-Examples.pl line 129.
>> running code in 'base-Ex.R' ... OK
>> collecting examples for package 'tools' ...
>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> you need Perl version 5 to build the R object docs
>> gmake[5]: *** [Rdfiles] Error 1
>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> file ../../library/tools/R-ex cannot be opened at ../../share/perl/
>> massage-Examples.pl line 129.
>> running code in 'tools-Ex.R' ... OK
>> collecting examples for package 'utils' ...
>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> you need Perl version 5 to build the R object docs
>> gmake[5]: *** [Rdfiles] Error 1
>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> file ../../library/utils/R-ex cannot be opened at ../../share/perl/
>> massage-Examples.pl line 129.
>> running code in 'utils-Ex.R' ... OK
>> collecting examples for package 'grDevices' ...
>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> you need Perl version 5 to build the R object docs
>> gmake[5]: *** [Rdfiles] Error 1
>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> file ../../library/grDevices/R-ex cannot be opened at ../../share/
>> perl/massage-Examples.pl line 129.
>> running code in 'grDevices-Ex.R' ... OK
>> collecting examples for package 'graphics' ...
>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> you need Perl version 5 to build the R object docs
>> gmake[5]: *** [Rdfiles] Error 1
>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> file ../../library/graphics/R-ex cannot be opened at ../../share/
>> perl/massage-Examples.pl line 129.
>> running code in 'graphics-Ex.R' ... OK
>> collecting examples for package 'stats' ...
>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> you need Perl version 5 to build the R object docs
>> gmake[5]: *** [Rdfiles] Error 1
>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> file ../../library/stats/R-ex cannot be opened at ../../share/perl/
>> massage-Examples.pl line 129.
>> running code in 'stats-Ex.R' ... OK
>> collecting examples for package 'datasets' ...
>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> you need Perl version 5 to build the R object docs
>> gmake[5]: *** [Rdfiles] Error 1
>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> file ../../library/datasets/R-ex cannot be opened at ../../share/
>> perl/massage-Examples.pl line 129.
>> running code in 'datasets-Ex.R' ... OK
>> collecting examples for package 'methods' ...
>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> you need Perl version 5 to build the R object docs
>> gmake[5]: *** [Rdfiles] Error 1
>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> file ../../library/methods/R-ex cannot be opened at ../../share/perl/
>> massage-Examples.pl line 129.
>> running code in 'methods-Ex.R' ... OK
>> collecting examples for package 'grid' ...
>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> you need Perl version 5 to build the R object docs
>> gmake[5]: *** [Rdfiles] Error 1
>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> file ../../library/grid/R-ex cannot be opened at ../../share/perl/
>> massage-Examples.pl line 129.
>> running code in 'grid-Ex.R' ... OK
>> collecting examples for package 'splines' ...
>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> you need Perl version 5 to build the R object docs
>> gmake[5]: *** [Rdfiles] Error 1
>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> file ../../library/splines/R-ex cannot be opened at ../../share/perl/
>> massage-Examples.pl line 129.
>> running code in 'splines-Ex.R' ... OK
>> collecting examples for package 'stats4' ...
>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> you need Perl version 5 to build the R object docs
>> gmake[5]: *** [Rdfiles] Error 1
>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> file ../../library/stats4/R-ex cannot be opened at ../../share/perl/
>> massage-Examples.pl line 129.
>> running code in 'stats4-Ex.R' ... OK
>> collecting examples for package 'tcltk' ...
>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>> patched-11-08-07/src/library'
>> you need Perl version 5 to build the R object docs
>> gmake[5]: *** [Rdfiles] Error 1
>
>
> I figure these errors are just the inability to create documentation,
> but mention them in case they may be relevant or important.
>
> Thanks,
>
> Kamil
>
> Kamil Marcinkowski                   Westgrid System Administrator
> kamil at ualberta.ca                     University of Alberta site
>  Tel.780 492-0354                     Research Computing Support
> Fax.780 492-1729                     Academic ICT
> Edmonton, Alberta, CANADA    University of Alberta
>
>
> "This communication is intended for the use of the recip...{{dropped:18}}
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From kamil at ualberta.ca  Wed Nov 14 01:04:16 2007
From: kamil at ualberta.ca (kamil Marcinkowski)
Date: Tue, 13 Nov 2007 17:04:16 -0700
Subject: [Rd] R 2.6.0 make check fails on SGI origin 350 and
In-Reply-To: <Pine.LNX.4.64.0711132259350.19784@gannet.stats.ox.ac.uk>
References: <42665B36-6FE2-48A4-A1C4-09F67D61A28C@ualberta.ca>
	<Pine.LNX.4.64.0711062341250.30885@gannet.stats.ox.ac.uk>
	<A8521DA1-CFA8-4B2D-896B-690AF301E122@ualberta.ca>
	<18226.54375.972183.286953@stat.math.ethz.ch>
	<6B3A01D9-B6A9-483A-9EA6-013BA8743BDD@ualberta.ca>
	<18227.19165.686297.222253@stat.math.ethz.ch>
	<39B05A63-0B09-4C15-983C-4FCC51641A0B@ualberta.ca>
	<64596DC1-C0A3-4671-B7AE-CEB5EA5DFADE@ualberta.ca>
	<Pine.LNX.4.64.0711132259350.19784@gannet.stats.ox.ac.uk>
Message-ID: <A22187A3-26C9-4F02-8016-131353D6F0C9@ualberta.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20071113/e3180132/attachment.pl 

From ripley at stats.ox.ac.uk  Wed Nov 14 08:09:16 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 14 Nov 2007 07:09:16 +0000 (GMT)
Subject: [Rd] R 2.6.0 make check fails on SGI origin 350 and
In-Reply-To: <A22187A3-26C9-4F02-8016-131353D6F0C9@ualberta.ca>
References: <42665B36-6FE2-48A4-A1C4-09F67D61A28C@ualberta.ca>
	<Pine.LNX.4.64.0711062341250.30885@gannet.stats.ox.ac.uk>
	<A8521DA1-CFA8-4B2D-896B-690AF301E122@ualberta.ca>
	<18226.54375.972183.286953@stat.math.ethz.ch>
	<6B3A01D9-B6A9-483A-9EA6-013BA8743BDD@ualberta.ca>
	<18227.19165.686297.222253@stat.math.ethz.ch>
	<39B05A63-0B09-4C15-983C-4FCC51641A0B@ualberta.ca>
	<64596DC1-C0A3-4671-B7AE-CEB5EA5DFADE@ualberta.ca>
	<Pine.LNX.4.64.0711132259350.19784@gannet.stats.ox.ac.uk>
	<A22187A3-26C9-4F02-8016-131353D6F0C9@ualberta.ca>
Message-ID: <Pine.LNX.4.64.0711140701390.5265@gannet.stats.ox.ac.uk>

On Tue, 13 Nov 2007, kamil Marcinkowski wrote:

> Hello List, Prof Brian Ripley
>
> How would the inefficiencies in IEC60559 arithmetic handling affect a user,
> Slow computations or compromised data and calculations?

Just a loss of accuracy.  There have been systems in which using extreme 
values causes a large loss of speed, but you are unlikely to encounter 
one.

> Here are the last 50 lines of the reg-tests-1.Rout.fail file.

This shows a bug in the systems' strptime.  This looks like the bug 
mentioned (with a fix) in the R-admin manual under IRIX.


>
>> root at nexus:70# tail -50 reg-tests-1.Rout.fail
>>> ## first two gave error in 1.8.1
>>> 
>>> 
>>> ## PR#4558 part 2
>>> x <- seq(as.POSIXct("2004-03-25"), as.POSIXct("2004-03-31"), by="DSTdays")
>>> stopifnot(length(x) == 7)
>>> ## was length 6 in the UK time zone.
>>> 
>>> 
>>> ## PR#6702 c/rbind on list matrices
>>> A <- matrix(as.list(1:4), 2, 2)
>>> (res <- cbind(A, A))
>>     [,1] [,2] [,3] [,4]
>> [1,] 1    3    1    3
>> [2,] 2    4    2    4
>>> stopifnot(typeof(res) == "list")
>>> (res <- rbind(A, A))
>>     [,1] [,2]
>> [1,] 1    3
>> [2,] 2    4
>> [3,] 1    3
>> [4,] 2    4
>>> stopifnot(typeof(res) == "list")
>>> ## were not implemented in 1.8.1
>>> 
>>> 
>>> ## Date objects with NA's
>>> (t1 <- strptime(c("6. Aug. 1930", "3. Nov. 1925", "28. Mar. 1959",
>> +                  NA, paste(1:29," Feb. 1960", sep=".")),
>> +                format = "%d. %b. %Y"))
>> [1] "1930-08-06 MST7MDT" "1925-11-03 MST7MDT" "1959-03-28 MST7MDT"
>> [4] NA                   "1960-02-01 MST7MDT" "1960-02-02 MST7MDT"
>> [7] "1960-02-03 MST7MDT" "1960-02-04 MST7MDT" "1960-02-05 MST7MDT"
>> [10] "1960-02-06 MST7MDT" "1960-02-07 MST7MDT" "1960-02-08 MST7MDT"
>> [13] "1960-02-09 MST7MDT" "1960-02-10 MST7MDT" "1960-02-11 MST7MDT"
>> [16] "1960-02-12 MST7MDT" "1960-02-13 MST7MDT" "1960-02-14 MST7MDT"
>> [19] "1960-02-15 MST7MDT" "1960-02-16 MST7MDT" "1960-02-17 MST7MDT"
>> [22] "1960-02-18 MST7MDT" "1960-02-19 MST7MDT" "1960-02-20 MST7MDT"
>> [25] "1960-02-21 MST7MDT" "1960-02-22 MST7MDT" "1960-02-23 MST7MDT"
>> [28] "1960-02-24 MST7MDT" "1960-02-25 MST7MDT" "1960-02-26 MST7MDT"
>> [31] "1960-02-27 MST7MDT" "1960-02-28 MST7MDT" "1960-02-29 MST7MDT"
>>> stopifnot(6 == length(print(s1 <- summary(t1))),
>> +           s1== summary(as.POSIXct(t1)),
>> +           6 == length(print(format(as.Date(s1)))) )
>>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>>     NA      NA      NA      NA      NA      NA
>>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>>     NA      NA      NA      NA      NA      NA
>> Error: s1 == summary(as.POSIXct(t1)) is not all TRUE
>> Execution halted
>> 
>
>
>
> Cheers,
>
> Kamil
>
> Kamil Marcinkowski                   Westgrid System Administrator
> kamil at ualberta.ca                     University of Alberta site
> Tel.780 492-0354                     Research Computing Support
> Fax.780 492-1729                     Academic ICT
> Edmonton, Alberta, CANADA    University of Alberta
>
>
> "This communication is intended for the use of the recipient to which it is
> addressed, and may contain confidential, personal, and/or privileged
> information.  Please contact us immediately if you are not the intended
> recipient of this communication.  If you are not the intended recipient of
> this communication, do not copy, distribute, or take action on it. Any
> communication received in error, or subsequent reply, should be deleted or
> destroyed."
>
>
>
> On 13-Nov-07, at 4:06 PM, Prof Brian Ripley wrote:
>
>> The perl-related warnings have gone in R-devel: we now take the view that 
>> since we need perl to make the test suite, perl >= 5.8.0 is compulsory. 
>> (5.6.1 is now over 7 years' old, and 5.8.0 is more than 5.)
>> 
>> The make check failure is in reg-tests-1.R and so will show up in 
>> reg-tests-1.Rout.fail.  What is at the bottom of that file?
>> 
>> The rest seem to indicate infelicities in how IEC60559 arithmetic is 
>> handled, e.g the particular NaN that represents NA not being propagated 
>> correctly and non-use of denormalized numbers.
>> 
>> On Tue, 13 Nov 2007, kamil Marcinkowski wrote:
>> 
>>> Hello list
>>> 
>>> Thank you for your help with the d-p-q-r-tests on Irix.
>>> 
>>> After patching d-p-q-r-tests.R, and d-p-q-r-tests.Rout.save file to
>>> reflect the
>>> change, d-p-q-r tests succeed but  make check still fails:
>>> 
>>>> comparing 'complex.Rout' to './complex.Rout.save' ...188c188
>>>> < [1] 0+0i
>>>> ---
>>>>> [1] 1.6789e-308+0i
>>>> OK
>>>> running code in 'print-tests.R' ... OK
>>>> comparing 'print-tests.Rout' to './print-tests.Rout.save' ...256c256
>>>> < [1] 9
>>>> ---
>>>>> [1] 11
>>>> 260c260
>>>> < [1]  0.000000e+00 2.225074e-308 2.225074e-308 2.227299e-308
>>>> 2.447581e-308
>>>> ---
>>>>> [1] 2.002566e-308 2.222849e-308 2.225074e-308 2.225074e-308
>>>> 2.225074e-308 2.227299e-308 2.447581e-308
>>>> 266c266
>>>> < [1]  0.000000e+00  0.000000e+00  0.000000e+00 2.447581e-308
>>>> 1.566452e-306 1.253162e-305
>>>> ---
>>>>> [1] 2.002566e-308 2.447581e-308 1.281643e-306 1.566452e-306
>>>> 1.025314e-305 1.253162e-305
>>>> 269,273c269,273
>>>> < [1,]  0e+00  0e+00  0.0e+00  0.00e+00  0.000e+00  0.0000e+00
>>>> 0.00000e+00
>>>> < [2,]  0e+00  0e+00  0.0e+00  0.00e+00  0.000e+00  0.0000e+00
>>>> 0.00000e+00
>>>> < [3,]  0e+00  0e+00  0.0e+00  0.00e+00  0.000e+00  0.0000e+00
>>>> 0.00000e+00
>>>> < [4,]  0e+00  0e+00 2.4e-308 2.45e-308 2.448e-308 2.4476e-308
>>>> 2.44758e-308
>>>> < [5,] 2e-306 2e-306 1.6e-306 1.57e-306 1.566e-306 1.5665e-306
>>>> 1.56645e-306
>>>> ---
>>>>> [1,] 2e-308 2e-308 2.0e-308 2.00e-308 2.003e-308 2.0026e-308
>>>> 2.00257e-308
>>>>> [2,] 2e-308 2e-308 2.4e-308 2.45e-308 2.448e-308 2.4476e-308
>>>> 2.44758e-308
>>>>> [3,] 1e-306 1e-306 1.3e-306 1.28e-306 1.282e-306 1.2816e-306
>>>> 1.28164e-306
>>>>> [4,] 2e-306 2e-306 1.6e-306 1.57e-306 1.566e-306 1.5665e-306
>>>> 1.56645e-306
>>>>> [5,] 1e-305 1e-305 1.0e-305 1.03e-305 1.025e-305 1.0253e-305
>>>> 1.02531e-305
>>>> 355c355
>>>> < 4.141593+  1i 4.341593+ 10i      NaN+NaNi      Inf+  0i     -Inf
>>>> +NaNi      NaN+Infi
>>>> ---
>>>>> 4.141593+  1i 4.341593+ 10i            NA      Inf+  0i     -Inf
>>>> +NaNi      NaN+Infi
>>>> 358c358
>>>> < [1,] 4.141593+ 1i NaN+NaNi -Inf+NaNi
>>>> ---
>>>>> [1,] 4.141593+ 1i     NA -Inf+NaNi
>>>> 364c364
>>>> < [3,] NaN+      NaNi  NaN+     Infi
>>>> ---
>>>>> [3,]             NA  NaN+     Infi
>>>> OK
>>>> running code in 'datasets.R' ... OK
>>>> comparing 'datasets.Rout' to './datasets.Rout.save' ... OK
>>>> running code in 'lapack.R' ... OK
>>>> comparing 'lapack.Rout' to './lapack.Rout.save' ... OK
>>>> gmake[3]: Leaving directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/tests'
>>>> gmake[2]: Leaving directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/tests'
>>>> gmake[2]: Entering directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/tests'
>>>> running regression tests
>>>> gmake[3]: Entering directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/tests'
>>>> running code in 'reg-tests-1.R' ...gmake[3]: *** [reg-tests-1.Rout]
>>>> Error 1
>>>> gmake[3]: Leaving directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/tests'
>>>> gmake[2]: *** [test-Reg] Error 2
>>>> gmake[2]: Leaving directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/tests'
>>>> gmake[1]: *** [test-all-basics] Error 1
>>>> gmake[1]: Leaving directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/tests'
>>>> gmake: *** [check] Error 2
>>>> 
>>> 
>>> 
>>> Also since we are using perl 5.6 on the system; the documentation
>>> system did not build.
>>> 
>>>> root at nexus:104#	perl -v
>>>> This is perl, v5.6.1 built for irix-n32
>>> 
>>> 
>>> configure output:
>>>> checking for perl... /usr/sbin/perl
>>>> checking whether perl version is at least 5.8.0... Perl v5.8.0
>>>> required--this is only v5.6.1, stopped at -e line 1.
>>>> no
>>>> configure: WARNING: you cannot build the object documentation system
>>> 
>>> 
>>> The following errors occurred during gmake check:
>>> 
>>>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> you need Perl version 5 to build the R object docs
>>>> gmake[5]: *** [Rdfiles] Error 1
>>>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> file ../../library/base/R-ex cannot be opened at ../../share/perl/
>>>> massage-Examples.pl line 129.
>>>> running code in 'base-Ex.R' ... OK
>>>> collecting examples for package 'tools' ...
>>>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> you need Perl version 5 to build the R object docs
>>>> gmake[5]: *** [Rdfiles] Error 1
>>>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> file ../../library/tools/R-ex cannot be opened at ../../share/perl/
>>>> massage-Examples.pl line 129.
>>>> running code in 'tools-Ex.R' ... OK
>>>> collecting examples for package 'utils' ...
>>>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> you need Perl version 5 to build the R object docs
>>>> gmake[5]: *** [Rdfiles] Error 1
>>>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> file ../../library/utils/R-ex cannot be opened at ../../share/perl/
>>>> massage-Examples.pl line 129.
>>>> running code in 'utils-Ex.R' ... OK
>>>> collecting examples for package 'grDevices' ...
>>>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> you need Perl version 5 to build the R object docs
>>>> gmake[5]: *** [Rdfiles] Error 1
>>>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> file ../../library/grDevices/R-ex cannot be opened at ../../share/
>>>> perl/massage-Examples.pl line 129.
>>>> running code in 'grDevices-Ex.R' ... OK
>>>> collecting examples for package 'graphics' ...
>>>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> you need Perl version 5 to build the R object docs
>>>> gmake[5]: *** [Rdfiles] Error 1
>>>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> file ../../library/graphics/R-ex cannot be opened at ../../share/
>>>> perl/massage-Examples.pl line 129.
>>>> running code in 'graphics-Ex.R' ... OK
>>>> collecting examples for package 'stats' ...
>>>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> you need Perl version 5 to build the R object docs
>>>> gmake[5]: *** [Rdfiles] Error 1
>>>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> file ../../library/stats/R-ex cannot be opened at ../../share/perl/
>>>> massage-Examples.pl line 129.
>>>> running code in 'stats-Ex.R' ... OK
>>>> collecting examples for package 'datasets' ...
>>>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> you need Perl version 5 to build the R object docs
>>>> gmake[5]: *** [Rdfiles] Error 1
>>>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> file ../../library/datasets/R-ex cannot be opened at ../../share/
>>>> perl/massage-Examples.pl line 129.
>>>> running code in 'datasets-Ex.R' ... OK
>>>> collecting examples for package 'methods' ...
>>>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> you need Perl version 5 to build the R object docs
>>>> gmake[5]: *** [Rdfiles] Error 1
>>>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> file ../../library/methods/R-ex cannot be opened at ../../share/perl/
>>>> massage-Examples.pl line 129.
>>>> running code in 'methods-Ex.R' ... OK
>>>> collecting examples for package 'grid' ...
>>>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> you need Perl version 5 to build the R object docs
>>>> gmake[5]: *** [Rdfiles] Error 1
>>>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> file ../../library/grid/R-ex cannot be opened at ../../share/perl/
>>>> massage-Examples.pl line 129.
>>>> running code in 'grid-Ex.R' ... OK
>>>> collecting examples for package 'splines' ...
>>>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> you need Perl version 5 to build the R object docs
>>>> gmake[5]: *** [Rdfiles] Error 1
>>>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> file ../../library/splines/R-ex cannot be opened at ../../share/perl/
>>>> massage-Examples.pl line 129.
>>>> running code in 'splines-Ex.R' ... OK
>>>> collecting examples for package 'stats4' ...
>>>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> you need Perl version 5 to build the R object docs
>>>> gmake[5]: *** [Rdfiles] Error 1
>>>> gmake[5]: Leaving directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> file ../../library/stats4/R-ex cannot be opened at ../../share/perl/
>>>> massage-Examples.pl line 129.
>>>> running code in 'stats4-Ex.R' ... OK
>>>> collecting examples for package 'tcltk' ...
>>>> gmake[5]: Entering directory `/usr/global/R-build/R-2.6.0-
>>>> patched-11-08-07/src/library'
>>>> you need Perl version 5 to build the R object docs
>>>> gmake[5]: *** [Rdfiles] Error 1
>>> 
>>> 
>>> I figure these errors are just the inability to create documentation,
>>> but mention them in case they may be relevant or important.
>>> 
>>> Thanks,
>>> 
>>> Kamil
>>> 
>>> Kamil Marcinkowski                   Westgrid System Administrator
>>> kamil at ualberta.ca                     University of Alberta site
>>> Tel.780 492-0354                     Research Computing Support
>>> Fax.780 492-1729                     Academic ICT
>>> Edmonton, Alberta, CANADA    University of Alberta
>>> 
>>> 
>>> "This communication is intended for the use of the recip...{{dropped:18}}
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>> 
>> -- 
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>> 
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Wed Nov 14 09:09:16 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 14 Nov 2007 08:09:16 +0000 (GMT)
Subject: [Rd] slots of type "double"
In-Reply-To: <Pine.LNX.4.64.0711131816130.11720@gannet.stats.ox.ac.uk>
References: <1194942985.4739620919f16@webmail.fhcrc.org>
	<2BBF01A3-5F39-4750-B42E-12605674F49E@r-project.org>
	<Pine.LNX.4.64.0711131448370.9317@gannet.stats.ox.ac.uk>
	<4739E8F3.5040302@r-project.org>
	<Pine.LNX.4.64.0711131816130.11720@gannet.stats.ox.ac.uk>
Message-ID: <Pine.LNX.4.64.0711140746220.11794@gannet.stats.ox.ac.uk>

On Tue, 13 Nov 2007, Prof Brian Ripley wrote:

> On Tue, 13 Nov 2007, John Chambers wrote:
>
>> What's the proposal here?  To eliminate "double" as a class?  No objection
>
> Eliminate "double" and "single".
>
>> from this corner.  As I remember, it was put in early in the 
>> implementation of methods, when I was confused about what R intended in 
>> this area (well, I'm not totally unconfused even now).
>> 
>> If this is the proposal, we could implement it in r-devel and see if 
>> there are complaints.
>
> I was going to propose so after running some tests over CRAN/BioC (which 
> will take a few hours).

Which showed up problems in packages Matrix and matlab.

Matrix clearly has a different view of these classes:

## "atomic vectors" (-> ?is.atomic ) --
## ---------------  those that we want to convert from old-style "matrix"
setClassUnion("atomicVector", ## numeric = {integer, double} but all 3 
should *directly* be atomic
               members = c("logical", "integer", "double", "numeric",
                           "complex", "raw", "character"))

If I remove "double" there, I get an error in an example:

> stopifnot(is(scm, "sparseVector"),
+           identical(cm, as.numeric(scm)))
Error in as(x at x, mode) :
   no method or default for coercing "numeric" to "double"

and looking at the code suggests that "double" is used as the class name 
in several places.


Package matlab is simpler: test mkconstarray.R fails at

   > test.mkconstarray(list(class.type = "double", value = pi, size = 4), 
rep(pi, 4))
   Error in as(value, match.arg(class.type)) :
     no method or default for coercing "numeric" to "double"

and needs the author to rectify his confusion between "class" and "type".

I'd like to give the Matrix authors a chance to look into this before 
making the change.  Loking at the packages has reinforced my impression 
that having "double" as an S4 class is only adding confusion, so the 
change is desirable.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From bhs2 at mevik.net  Wed Nov 14 13:01:21 2007
From: bhs2 at mevik.net (=?iso-8859-1?q?Bj=F8rn-Helge_Mevik?=)
Date: Wed, 14 Nov 2007 13:01:21 +0100
Subject: [Rd] When to use LazyLoad, LazyData and ZipData?
Message-ID: <m0prydkpda.fsf@bar.nemo-project.org>

Dear developeRs,

I've searched the documentation, FAQ, and mailing lists, but haven't
found the answer(*) to the following:

When should one specify LazyLoad, LazyData, and ZipData?

And what is the default if they are left unspecified?


(*)Except that
1) If the package you are writing uses the methods package, specify
LazyLoad: yes, and
2) The optional ZipData field controls whether the automatic Windows
build will zip up the data directory or no: set this to no if your
package will not work with a zipped data directory.

-- 
Sincerely,
Bj?rn-Helge Mevik


From murdoch at stats.uwo.ca  Wed Nov 14 13:58:03 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 14 Nov 2007 07:58:03 -0500
Subject: [Rd] When to use LazyLoad, LazyData and ZipData?
In-Reply-To: <m0prydkpda.fsf@bar.nemo-project.org>
References: <m0prydkpda.fsf@bar.nemo-project.org>
Message-ID: <473AF0DB.9020801@stats.uwo.ca>

On 11/14/2007 7:01 AM, Bj?rn-Helge Mevik wrote:
> Dear developeRs,
> 
> I've searched the documentation, FAQ, and mailing lists, but haven't
> found the answer(*) to the following:
> 
> When should one specify LazyLoad, LazyData, and ZipData?
> 
> And what is the default if they are left unspecified?
> 
> 
> (*)Except that
> 1) If the package you are writing uses the methods package, specify
> LazyLoad: yes, and
> 2) The optional ZipData field controls whether the automatic Windows
> build will zip up the data directory or no: set this to no if your
> package will not work with a zipped data directory.

I think that you shouldn't care about these things, and should accept 
the default for them unless one of those two pieces of advice applies to 
you.  Let the package install code decide on what values to use.

If you want to know the current defaults, look at the INSTALL script in 
R_HOME/bin, but don't expect them to stay the same as versions change. 
For example, lazy loading saves memory but may take extra time; the code 
chooses a tradeoff based on the amount of data involved, and the details 
of that choice could easily change.

Duncan Murdoch


From ripley at stats.ox.ac.uk  Wed Nov 14 13:58:47 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 14 Nov 2007 12:58:47 +0000 (GMT)
Subject: [Rd] When to use LazyLoad, LazyData and ZipData?
In-Reply-To: <m0prydkpda.fsf@bar.nemo-project.org>
References: <m0prydkpda.fsf@bar.nemo-project.org>
Message-ID: <Pine.LNX.4.64.0711141251420.31696@gannet.stats.ox.ac.uk>

On Wed, 14 Nov 2007, Bj?rn-Helge Mevik wrote:

> Dear developeRs,
>
> I've searched the documentation, FAQ, and mailing lists, but haven't
> found the answer(*) to the following:
>
> When should one specify LazyLoad, LazyData, and ZipData?

Preferably always, and I would suggest all should be 'yes' if your package 
will work with them.

> And what is the default if they are left unspecified?

It varies by R version and platform.  But as a guide

LazyLoad: yes for all but small packages (those with less than
   25Kb of R code)
LazyData: no
ZipData: yes on Windows if there is more than 100Kb of data and no
   duplicate namestems (e.g. foo.R and foo.tab).

> (*)Except that
> 1) If the package you are writing uses the methods package, specify
> LazyLoad: yes, and
> 2) The optional ZipData field controls whether the automatic Windows
> build will zip up the data directory or no: set this to no if your
> package will not work with a zipped data directory.


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From maechler at stat.math.ethz.ch  Wed Nov 14 14:23:12 2007
From: maechler at stat.math.ethz.ch (Martin =?iso-8859-1?Q?M=E4chler?=)
Date: Wed, 14 Nov 2007 14:23:12 +0100 (CET)
Subject: [Rd] slots of type "double"
In-Reply-To: <Pine.LNX.4.64.0711140746220.11794@gannet.stats.ox.ac.uk>
References: <1194942985.4739620919f16@webmail.fhcrc.org>
	<2BBF01A3-5F39-4750-B42E-12605674F49E@r-project.org>
	<Pine.LNX.4.64.0711131448370.9317@gannet.stats.ox.ac.uk>
	<4739E8F3.5040302@r-project.org>
	<Pine.LNX.4.64.0711131816130.11720@gannet.stats.ox.ac.uk>
	<Pine.LNX.4.64.0711140746220.11794@gannet.stats.ox.ac.uk>
Message-ID: <51526.147.88.200.209.1195046592.squirrel@webmail.stat.ethz.ch>

On Wed, November 14, 2007 09:09, Prof Brian Ripley wrote:
> On Tue, 13 Nov 2007, Prof Brian Ripley wrote:
>
>> On Tue, 13 Nov 2007, John Chambers wrote:
>>
>>> What's the proposal here?  To eliminate "double" as a class?  No
>>> objection
>>
>> Eliminate "double" and "single".
>>
>>> from this corner.  As I remember, it was put in early in the
>>> implementation of methods, when I was confused about what R intended in
>>> this area (well, I'm not totally unconfused even now).
>>>
>>> If this is the proposal, we could implement it in r-devel and see if
>>> there are complaints.
>>
>> I was going to propose so after running some tests over CRAN/BioC (which
>> will take a few hours).
>
> Which showed up problems in packages Matrix and matlab.
>
> Matrix clearly has a different view of these classes:
>
> ## "atomic vectors" (-> ?is.atomic ) --
> ## ---------------  those that we want to convert from old-style "matrix"
> setClassUnion("atomicVector", ## numeric = {integer, double} but all 3
> should *directly* be atomic
>                members = c("logical", "integer", "double", "numeric",
>                            "complex", "raw", "character"))
>
> If I remove "double" there, I get an error in an example:
>
>> stopifnot(is(scm, "sparseVector"),
> +           identical(cm, as.numeric(scm)))
> Error in as(x at x, mode) :
>    no method or default for coercing "numeric" to "double"
>
> and looking at the code suggests that "double" is used as the class name
> in several places.
>
>
> Package matlab is simpler: test mkconstarray.R fails at
>
>    > test.mkconstarray(list(class.type = "double", value = pi, size = 4),
> rep(pi, 4))
>    Error in as(value, match.arg(class.type)) :
>      no method or default for coercing "numeric" to "double"
>
> and needs the author to rectify his confusion between "class" and "type".
>
> I'd like to give the Matrix authors a chance to look into this before
> making the change.  Loking at the packages has reinforced my impression
> that having "double" as an S4 class is only adding confusion, so the
> change is desirable.

I think (without having had time to check all implications) that I agree
quite a bit.  I don't think that I was not partly confused about things,
either as they were in Matrix when I "entered the project" or as they
turned out to work or fail, when we started to use those class definitions
quite a few R versions back, when also "methods" / "base" may have behaved
a bit differently than now.
I must admit that I did not program according to documented behavior, but
rather to work behavior :-) ;-)

I'm very busy the rest of this week, in out'of'town meetings,
so won't be able to comment much more.
Martin


From ggrothendieck at gmail.com  Wed Nov 14 14:31:11 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 14 Nov 2007 08:31:11 -0500
Subject: [Rd] When to use LazyLoad, LazyData and ZipData?
In-Reply-To: <m0prydkpda.fsf@bar.nemo-project.org>
References: <m0prydkpda.fsf@bar.nemo-project.org>
Message-ID: <971536df0711140531v17fe3d5fi38ef6e6cfdf58f67@mail.gmail.com>

On Nov 14, 2007 7:01 AM, Bj?rn-Helge Mevik <bhs2 at mevik.net> wrote:
> Dear developeRs,
>
> I've searched the documentation, FAQ, and mailing lists, but haven't
> found the answer(*) to the following:
>
> When should one specify LazyLoad, LazyData, and ZipData?
>
> And what is the default if they are left unspecified?
>
>
> (*)Except that
> 1) If the package you are writing uses the methods package, specify
> LazyLoad: yes, and
> 2) The optional ZipData field controls whether the automatic Windows
> build will zip up the data directory or no: set this to no if your
> package will not work with a zipped data directory.

There is some information and links regarding LazyLoad on the proto
package home page,
http://r-proto.googlecode.com, in the last section entitled Avoiding R
Bugs in point #1.


From bhs2 at mevik.net  Wed Nov 14 14:35:28 2007
From: bhs2 at mevik.net (=?iso-8859-1?q?Bj=F8rn-Helge_Mevik?=)
Date: Wed, 14 Nov 2007 14:35:28 +0100
Subject: [Rd] When to use LazyLoad, LazyData and ZipData?
In-Reply-To: <473AF0DB.9020801@stats.uwo.ca> (Duncan Murdoch's message of
	"Wed, 14 Nov 2007 07:58:03 -0500")
References: <m0prydkpda.fsf@bar.nemo-project.org>
	<473AF0DB.9020801@stats.uwo.ca>
Message-ID: <m0k5olkl0f.fsf@bar.nemo-project.org>

Duncan Murdoch wrote:

> On 11/14/2007 7:01 AM, Bj?rn-Helge Mevik wrote:
>
>> When should one specify LazyLoad, LazyData, and ZipData?
>
> I think that you shouldn't care about these things, and should accept
> the default for them unless one of those two pieces of advice applies
> to you.  Let the package install code decide on what values to use.

Thank you.  That seems like a reasonable strategy. :-)

The only small `snag' I can see is how to document the usage of data
sets.  As I understand from `Writing R Extensions' (`The \usage entry
is always bar or (for packages which do not use lazy-loading of data)
data(bar).')  It is preferrable to use \usage{bar} when LazyData is
true, and \usage{data(bar)} otherwise.  Since data(bar) always works,
I guess the best strategy (when leaving LazyData to its default) is to
use \usage{data(bar)}.

> If you want to know the current defaults, look at the INSTALL script
> in R_HOME/bin,

Ah.  I should have thought about that. :-)

-- 
Bj?rn-Helge Mevik


From rpeng at jhsph.edu  Wed Nov 14 15:33:29 2007
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Wed, 14 Nov 2007 09:33:29 -0500
Subject: [Rd] isOpen on closed connections
Message-ID: <473B0739.3090507@jhsph.edu>

As far as I can tell, 'isOpen' cannot return FALSE in the case when 'rw = ""'. 
If the connection has already been closed by 'close' or some other function, 
then isOpen will produce an error.  The problem is that when isOpen calls 
'getConnection', the connection cannot be found and 'getConnection' produces an 
error.  The check to see if it is open is never actually done.

This came up in some code where I'm trying to clean up connections after 
successfully opening them.  The problem is that if I try to close a connection 
that has already been closed, I get an error (because 'getConnection' cannot 
find it).  But then there's no way for me to find out if a connection has 
already been closed.  Perhaps there's another approach I should be taking?  The 
context is basically,

con <- file("foo", "w")

tryCatch({
	## Do stuff that might fail
	writeLines(stuff, con)
	close(con)

	file.copy("foo", "bar")
}, finally = {
	close(con)
})

So the problem is that if the block in the 'tryCatch' succeeds, the 'finally' 
will produce an error.

I'm not exactly sure of what I'd want since it seems modifying 'getConnection' 
would not be a great idea as it is used elsewhere.

-roger
-- 
Roger D. Peng  |  http://www.biostat.jhsph.edu/~rpeng/


From Max.Kuhn at pfizer.com  Wed Nov 14 15:34:13 2007
From: Max.Kuhn at pfizer.com (Kuhn, Max)
Date: Wed, 14 Nov 2007 09:34:13 -0500
Subject: [Rd] package installation order
Message-ID: <71257D09F114DA4A8E134DEAC70F25D30A2029AA@groamrexm03.amer.pfizer.com>

I have roughly 80 or so packages sources. These were obtained by taking
a snapshot of certain CRAN packages a few months ago using 

   install.packages(
      pkgs = pckNames,
      destdir = "/home/max",
      repos = "http://cran.r-project.org"
      dependencies = c("Depends", "Imports", "Suggests"))

We need to install these versions of the packages across a few different
architectures/systems (linux, solaris, 32- and 64-bit). Right now, we
are constrained to version 2.5.1 (I know, I know). 

Right now, I'd use 

   tarList <- list.files()
   tarList <- grep(".tar.gz", tarList, fixed = TRUE, value = TRUE)
   install.packages (tarList, repos = NULL)
	
to install, but the package dependencies are ignored. For example, XML
gets installed after other packages that depend on it.

I've looked through ?install.packages and I have tried using 

   install.packages (
      tarList, repos = NULL, 
      dependencies = c("Depends", "Imports", "Suggests"))

but this did not appear to change the install ordering. 

Is there a simpler way to do this rather than trial and error?

Thanks,

Max

> sessionInfo()
R version 2.5.1 (2007-06-27) 
i686-pc-linux-gnu 

locale:
C

attached base packages:
[1] "stats"     "graphics"  "grDevices" "utils"     "datasets"
"methods"  
[7] "base"     


From edd at debian.org  Wed Nov 14 15:57:47 2007
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 14 Nov 2007 08:57:47 -0600
Subject: [Rd] package installation order
In-Reply-To: <71257D09F114DA4A8E134DEAC70F25D30A2029AA@groamrexm03.amer.pfizer.com>
References: <71257D09F114DA4A8E134DEAC70F25D30A2029AA@groamrexm03.amer.pfizer.com>
Message-ID: <18235.3307.38745.255091@ron.nulle.part>


Hi Max,

On 14 November 2007 at 09:34, Kuhn, Max wrote:
| I have roughly 80 or so packages sources. These were obtained by taking
| a snapshot of certain CRAN packages a few months ago using 
| 
|    install.packages(
|       pkgs = pckNames,
|       destdir = "/home/max",
|       repos = "http://cran.r-project.org"
|       dependencies = c("Depends", "Imports", "Suggests"))
| 
| We need to install these versions of the packages across a few different
| architectures/systems (linux, solaris, 32- and 64-bit). Right now, we
| are constrained to version 2.5.1 (I know, I know). 
| 
| Right now, I'd use 
| 
|    tarList <- list.files()
|    tarList <- grep(".tar.gz", tarList, fixed = TRUE, value = TRUE)
|    install.packages (tarList, repos = NULL)
| 	
| to install, but the package dependencies are ignored. For example, XML
| gets installed after other packages that depend on it.
| 
| I've looked through ?install.packages and I have tried using 
| 
|    install.packages (
|       tarList, repos = NULL, 
|       dependencies = c("Depends", "Imports", "Suggests"))
| 
| but this did not appear to change the install ordering. 
| 
| Is there a simpler way to do this rather than trial and error?

When trying to package the by-now-gargantuan Rmetrics for Debian (which is
still ongoing), I looked around for some Depends builders. Turns out that
BioC has this.   E.g. the following worked for:

## > install.packages("Biobase", repo="http://www.bioconductor.org")
## > repos <- Biobase:::biocReposList()
## > install.packages("pkgDepTools", repos=repos["bioc"])
## > library(pkgDepTools)
## Loading required package: graph
## Loading required package: RBGL
## > CRANdeps <- makeDepGraph(repos["cran"], type="source")
## > getInstallOrder("Rmetrics", CRANdeps, needed.only=FALSE)

worked for me.  I meant to add some code for Graphviz visualization (or look
for it, Seth et al probably already wrote it) but what you get from
getInstallOrder() should suit your needs here.

Hth, Dirk

-- 
Three out of two people have difficulties with fractions.


From ripley at stats.ox.ac.uk  Wed Nov 14 16:37:07 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 14 Nov 2007 15:37:07 +0000 (GMT)
Subject: [Rd] package installation order
In-Reply-To: <71257D09F114DA4A8E134DEAC70F25D30A2029AA@groamrexm03.amer.pfizer.com>
References: <71257D09F114DA4A8E134DEAC70F25D30A2029AA@groamrexm03.amer.pfizer.com>
Message-ID: <Pine.LNX.4.64.0711141531050.10789@gannet.stats.ox.ac.uk>

On Wed, 14 Nov 2007, Kuhn, Max wrote:

> I have roughly 80 or so packages sources. These were obtained by taking
> a snapshot of certain CRAN packages a few months ago using
>
>   install.packages(
>      pkgs = pckNames,
>      destdir = "/home/max",
>      repos = "http://cran.r-project.org"
>      dependencies = c("Depends", "Imports", "Suggests"))
>
> We need to install these versions of the packages across a few different
> architectures/systems (linux, solaris, 32- and 64-bit). Right now, we
> are constrained to version 2.5.1 (I know, I know).
>
> Right now, I'd use
>
>   tarList <- list.files()
>   tarList <- grep(".tar.gz", tarList, fixed = TRUE, value = TRUE)
>   install.packages (tarList, repos = NULL)

You need the information from available.packages() to do the ordering, so 
you need a non-NULL repository.  This works if you convert your local 
collection into a local repository. You will need a PACKAGES file, but 
tools::write_PACKAGES can re-create one for you.

There are also dependency tools in package tools and on BioC.

> to install, but the package dependencies are ignored. For example, XML
> gets installed after other packages that depend on it.
>
> I've looked through ?install.packages and I have tried using
>
>   install.packages (
>      tarList, repos = NULL,
>      dependencies = c("Depends", "Imports", "Suggests"))
>
> but this did not appear to change the install ordering.
>
> Is there a simpler way to do this rather than trial and error?
>
> Thanks,
>
> Max

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From Max.Kuhn at pfizer.com  Wed Nov 14 16:39:43 2007
From: Max.Kuhn at pfizer.com (Kuhn, Max)
Date: Wed, 14 Nov 2007 10:39:43 -0500
Subject: [Rd] package installation order
In-Reply-To: <18235.3307.38745.255091@ron.nulle.part>
Message-ID: <71257D09F114DA4A8E134DEAC70F25D30A25B687@groamrexm03.amer.pfizer.com>

Dirk,

Thanks for the email. 

> When trying to package the by-now-gargantuan Rmetrics for Debian
(which is
> still ongoing), I looked around for some Depends builders. Turns out
that
> BioC has this.   E.g. the following worked for:
> 
> ## > install.packages("Biobase", repo="http://www.bioconductor.org")
> ## > repos <- Biobase:::biocReposList()
> ## > install.packages("pkgDepTools", repos=repos["bioc"])
> ## > library(pkgDepTools)
> ## Loading required package: graph
> ## Loading required package: RBGL
> ## > CRANdeps <- makeDepGraph(repos["cran"], type="source")
> ## > getInstallOrder("Rmetrics", CRANdeps, needed.only=FALSE)
> 
> worked for me.  I meant to add some code for Graphviz visualization
(or look
> for it, Seth et al probably already wrote it) but what you get from
> getInstallOrder() should suit your needs here.

That should approximate it. The dependencies for some packages will have
changed since my snapshot. Next time I'll get the CRAN dependencies when
I get the packages.

Max


From Max.Kuhn at pfizer.com  Wed Nov 14 17:35:05 2007
From: Max.Kuhn at pfizer.com (Kuhn, Max)
Date: Wed, 14 Nov 2007 11:35:05 -0500
Subject: [Rd] package installation order
In-Reply-To: <Pine.LNX.4.64.0711141531050.10789@gannet.stats.ox.ac.uk>
Message-ID: <71257D09F114DA4A8E134DEAC70F25D30A25B7BE@groamrexm03.amer.pfizer.com>

Professor Ripley,

> You need the information from available.packages() to do the ordering,
so 
> you need a non-NULL repository.  This works if you convert your local 
> collection into a local repository. You will need a PACKAGES file, but

> tools::write_PACKAGES can re-create one for you.
> 
> There are also dependency tools in package tools and on BioC.

This is probably a better option for me given that my source files are a
little out of date. I couldn't get it to work though.

I put the tar.gz files into a sub-directory (./src/contrib)

I ran write_PACAKGES referencing that directory and type = "source" and
verbose = TRUE. No error messages were given and it resulted in PACKAGES
and PACKAGES.gz files that appeared to have all the right info in it.

I figured out the package names by parsing the names of the tar.gz
files.

I then ran 

   install.packages(pckList[1:3],
      repos = "/home/max/tmp/r-2.5.1-pkgs-updated/src/contrib",
      contriburl = "/home/max/tmp/r-2.5.1-pkgs-updated/src/contrib",
      type = "source")

No packages were installed and I had the warnings:

Warning: unable to access index for repository
/home/max/tmp/r-2.5.1-pkgs-updated/src/contrib
Warning message:
packages 'Cairo', 'Design', 'ElemStatLearn' are not available in:
install.packages(pckList[1:3], repos =
"/home/max/tmp/r-2.5.1-pkgs-updated/src/contrib",  

(those particular packages are in ./src/contrib.) I also tried different
variations of using the file names etc.

I'm assuming that I don't have a proper repository. Am I missing
something obvious here and/or is there some documentation on what the
elements of a repository are?

Thanks again,

Max


From ripley at stats.ox.ac.uk  Wed Nov 14 17:43:05 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 14 Nov 2007 16:43:05 +0000 (GMT)
Subject: [Rd] package installation order
In-Reply-To: <71257D09F114DA4A8E134DEAC70F25D30A25B7BE@groamrexm03.amer.pfizer.com>
References: <71257D09F114DA4A8E134DEAC70F25D30A25B7BE@groamrexm03.amer.pfizer.com>
Message-ID: <Pine.LNX.4.64.0711141636270.26553@gannet.stats.ox.ac.uk>

On Wed, 14 Nov 2007, Kuhn, Max wrote:

> Professor Ripley,
>
>> You need the information from available.packages() to do the ordering,
> so
>> you need a non-NULL repository.  This works if you convert your local
>> collection into a local repository. You will need a PACKAGES file, but
>
>> tools::write_PACKAGES can re-create one for you.
>>
>> There are also dependency tools in package tools and on BioC.
>
> This is probably a better option for me given that my source files are a
> little out of date. I couldn't get it to work though.
>
> I put the tar.gz files into a sub-directory (./src/contrib)
>
> I ran write_PACAKGES referencing that directory and type = "source" and
> verbose = TRUE. No error messages were given and it resulted in PACKAGES
> and PACKAGES.gz files that appeared to have all the right info in it.
>
> I figured out the package names by parsing the names of the tar.gz
> files.
>
> I then ran
>
>   install.packages(pckList[1:3],
>      repos = "/home/max/tmp/r-2.5.1-pkgs-updated/src/contrib",
>      contriburl = "/home/max/tmp/r-2.5.1-pkgs-updated/src/contrib",
>      type = "source")

It does say 'URL(s)', hence

repos = "file:///home/max/tmp/r-2.5.1-pkgs-updated"

is I think all you need.  Here's a (working) example local to me:

> install.packages("yags", repos="file:///data/ftp/pub/RWin")


>
> No packages were installed and I had the warnings:
>
> Warning: unable to access index for repository
> /home/max/tmp/r-2.5.1-pkgs-updated/src/contrib
> Warning message:
> packages 'Cairo', 'Design', 'ElemStatLearn' are not available in:
> install.packages(pckList[1:3], repos =
> "/home/max/tmp/r-2.5.1-pkgs-updated/src/contrib",
>
> (those particular packages are in ./src/contrib.) I also tried different
> variations of using the file names etc.
>
> I'm assuming that I don't have a proper repository. Am I missing
> something obvious here and/or is there some documentation on what the
> elements of a repository are?

There is, in the R-admin manual.

> Thanks again,
>
> Max
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From Max.Kuhn at pfizer.com  Wed Nov 14 18:10:10 2007
From: Max.Kuhn at pfizer.com (Kuhn, Max)
Date: Wed, 14 Nov 2007 12:10:10 -0500
Subject: [Rd] package installation order
In-Reply-To: <Pine.LNX.4.64.0711141636270.26553@gannet.stats.ox.ac.uk>
Message-ID: <71257D09F114DA4A8E134DEAC70F25D30A25B862@groamrexm03.amer.pfizer.com>

Professor Ripley,

> It does say 'URL(s)', hence
>
> repos = "file:///home/max/tmp/r-2.5.1-pkgs-updated"

That works. Thanks for your expertise.

Max


From bussiere at numtech.fr  Wed Nov 14 10:05:49 2007
From: bussiere at numtech.fr (Pierre-Henri BUSSIERE)
Date: Wed, 14 Nov 2007 10:05:49 +0100
Subject: [Rd] Help about nnet library
Message-ID: <473ABA6D.5010101@numtech.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20071114/199b187f/attachment.pl 

From dusa.adrian at gmail.com  Wed Nov 14 14:49:54 2007
From: dusa.adrian at gmail.com (Adrian Dusa)
Date: Wed, 14 Nov 2007 15:49:54 +0200
Subject: [Rd] library path in Rd link
Message-ID: <200711141549.54176.dusa.adrian@gmail.com>


Dear all,

When creating new functions in a package, there is a "See also" component in 
the Rd file.
Usually one uses \link{otherfun}, if the other function is from the same 
package, or \link[otherpackage]{otherfun} otherwise.

The trouble is that I install new packages not in the default R library 
folder, but into some other subfolder in my home, so the link searches 
for "otherpackage" in my home subfolder.

Is there a method to create links to functions from the base package, for 
example (which is installed by default in the normal library folder)?

Thank you,
Adrian


-- 
Adrian Dusa
Romanian Social Data Archive
1, Schitu Magureanu Bd
050025 Bucharest sector 5
Romania
Tel./Fax: +40 21 3126618 \
          +40 21 3120210 / int.101


From murdoch at stats.uwo.ca  Wed Nov 14 22:36:15 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 14 Nov 2007 16:36:15 -0500
Subject: [Rd] library path in Rd link
In-Reply-To: <200711141549.54176.dusa.adrian@gmail.com>
References: <200711141549.54176.dusa.adrian@gmail.com>
Message-ID: <473B6A4F.2070208@stats.uwo.ca>

On 11/14/2007 8:49 AM, Adrian Dusa wrote:
> Dear all,
> 
> When creating new functions in a package, there is a "See also" component in 
> the Rd file.
> Usually one uses \link{otherfun}, if the other function is from the same 
> package, or \link[otherpackage]{otherfun} otherwise.
> 
> The trouble is that I install new packages not in the default R library 
> folder, but into some other subfolder in my home, so the link searches 
> for "otherpackage" in my home subfolder.
> 
> Is there a method to create links to functions from the base package, for 
> example (which is installed by default in the normal library folder)?

I believe this is normally automatic in platforms other than Windows. 
On Windows, the answer is no.

The problem is that in most cases R isn't in charge of the help file 
viewing.  There isn't a good way to make a link from an HTML file to a 
location that isn't known in advance, for example.

On Unix-alikes, the workaround is to build soft links to all the 
packages in a standard location; but soft links don't work on Windows 
(and we don't want to get into the almost-undocumented hard links that 
exist on some Windows file systems).

Duncan Murdoch


From maechler at stat.math.ethz.ch  Wed Nov 14 22:40:41 2007
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 14 Nov 2007 22:40:41 +0100
Subject: [Rd] slots of type "double"
In-Reply-To: <51526.147.88.200.209.1195046592.squirrel@webmail.stat.ethz.ch>
References: <1194942985.4739620919f16@webmail.fhcrc.org>
	<2BBF01A3-5F39-4750-B42E-12605674F49E@r-project.org>
	<Pine.LNX.4.64.0711131448370.9317@gannet.stats.ox.ac.uk>
	<4739E8F3.5040302@r-project.org>
	<Pine.LNX.4.64.0711131816130.11720@gannet.stats.ox.ac.uk>
	<Pine.LNX.4.64.0711140746220.11794@gannet.stats.ox.ac.uk>
	<51526.147.88.200.209.1195046592.squirrel@webmail.stat.ethz.ch>
Message-ID: <18235.27481.789824.663953@stat.math.ethz.ch>

still found a bit time for more remarks.

>>>>> "MM" == Martin M?chler <maechler at stat.math.ethz.ch>
>>>>>     on Wed, 14 Nov 2007 14:23:12 +0100 (CET) writes:

    MM> On Wed, November 14, 2007 09:09, Prof Brian Ripley
    MM> wrote:
    >> On Tue, 13 Nov 2007, Prof Brian Ripley wrote:
    >> 
    >>> On Tue, 13 Nov 2007, John Chambers wrote:
    >>> 
    >>>> What's the proposal here?  To eliminate "double" as a
    >>>> class?  No objection
    >>> 
    >>> Eliminate "double" and "single".
    >>> 
    >>>> from this corner.  As I remember, it was put in early
    >>>> in the implementation of methods, when I was confused
    >>>> about what R intended in this area (well, I'm not
    >>>> totally unconfused even now).
    >>>> 
    >>>> If this is the proposal, we could implement it in
    >>>> r-devel and see if there are complaints.
    >>> 
    >>> I was going to propose so after running some tests over
    >>> CRAN/BioC (which will take a few hours).
    >> 
    >> Which showed up problems in packages Matrix and matlab.


    >> Matrix clearly has a different view of these classes:
    >> 
    >> ## "atomic vectors" (-> ?is.atomic ) -- ##
    >> --------------- those that we want to convert from
    >> old-style "matrix" setClassUnion("atomicVector", ##
    >> numeric = {integer, double} but all 3 should *directly*
    >> be atomic members = c("logical", "integer", "double",
    >> "numeric", "complex", "raw", "character"))
    >> 
    >> If I remove "double" there, I get an error in an example:
    >> 
    >>> stopifnot(is(scm, "sparseVector"),
    >> + identical(cm, as.numeric(scm))) Error in as(x at x, mode)
    >> : no method or default for coercing "numeric" to "double"
    >> 
    >> and looking at the code suggests that "double" is used as
    >> the class name in several places.

yes.
As you mention and I had in the comment above,
I've worked from the premise of something like a class union of

 numeric = {integer, double} 

-- which corresponds to S3's    is.numeric()  which we all know
   differs from the semantic of as.numeric()

and now know why I had done so {empty lines deleted}:

  > showClass("numeric")
  No Slots, prototype of class "numeric"
  Extends: "vector"
  Known Subclasses: "double", "integer"

  > showClass("double")
  No Slots, prototype of class "numeric"
  Extends: "vector", "numeric"

  > showClass("integer")
  No Slots, prototype of class "integer"
  Extends: "vector", "numeric"

which you partially also mentioned in your initial posting.

As a 2nd thought I wonder if we should not keep this current
scheme and fix its behavior where needed (the problem the OP had):
The notion of   numeric := union(double, integer)
does now appeal to me again;
in particular since eliminating "double"  in the S4 world  will
not eliminate it from other places, and the basic problem of
is.numeric / as.numeric  inconsistency is - I think - not
something we'd want to eliminate, just because it would break too
much existing code (and books on S and R).

Of course I may have overlooked other reasonings;
as mentioned, I'm quite a bit time limited at the moment.
Martin

  [....]

    >> I'd like to give the Matrix authors a chance to look into
    >> this before making the change.  

Thanks, indeed!

    >> Loking at the packages has reinforced my impression that
    >> having "double" as an S4 class is only adding confusion,
    >> so the change is desirable.

well or maybe it's just the lack of comprehensive documentation
of S4 classes as in 'methods' in R -- where I think JMC did want
to do a few things slightly differently than they are in S-PLUS..


    MM> I think (without having had time to check all
    MM> implications) that I agree quite a bit.  I don't think
    MM> that I was not partly confused about things, either as
    MM> they were in Matrix when I "entered the project" or as
    MM> they turned out to work or fail, when we started to use
    MM> those class definitions quite a few R versions back,
    MM> when also "methods" / "base" may have behaved a bit
    MM> differently than now.  I must admit that I did not
    MM> program according to documented behavior, but rather to
    MM> work behavior :-) ;-)

    MM> I'm very busy the rest of this week, in out'of'town
    MM> meetings, so won't be able to comment much more.  Martin


From ripley at stats.ox.ac.uk  Wed Nov 14 22:47:08 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 14 Nov 2007 21:47:08 +0000 (GMT)
Subject: [Rd] library path in Rd link
In-Reply-To: <200711141549.54176.dusa.adrian@gmail.com>
References: <200711141549.54176.dusa.adrian@gmail.com>
Message-ID: <Pine.LNX.4.64.0711142132320.1433@gannet.stats.ox.ac.uk>

On Wed, 14 Nov 2007, Adrian Dusa wrote:

>
> Dear all,
>
> When creating new functions in a package, there is a "See also" component in
> the Rd file.
> Usually one uses \link{otherfun}, if the other function is from the same
> package, or \link[otherpackage]{otherfun} otherwise.

I think you have misread the manual here:

   There are two other forms of optional argument specified as
   \link[pkg]{foo} and \link[pkg:bar]{foo} to link to the package pkg, to
   files foo.html and bar.html respectively. These are rarely needed,
   perhaps to refer to not-yet-installed packages (but there the HTML
   help system will resolve the link at run time) or in the normally
   undesirable event that more than one package offers help on a topic
   (in which case the present package has precedence so this is only
   needed to refer to other packages)

Note: 'rarely needed'.

> The trouble is that I install new packages not in the default R library
> folder, but into some other subfolder in my home, so the link searches
> for "otherpackage" in my home subfolder.
>
> Is there a method to create links to functions from the base package, for
> example (which is installed by default in the normal library folder)?

What OS is this?  (As I recall you used Linux last time you posted.)

In any case, on all OSes you will be able to do cross-library links to the 
base package without having to do anything further (and CRAN packages are 
full of them).  On Unix-alikes the help files are all linked into a single 
virtual library, and on Windows links to the base package (and a few 
others) from other libraries are fixed up on installation by 
link.html.help (see its help).

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From mike.preuss at cs.uni-dortmund.de  Wed Nov 14 22:47:25 2007
From: mike.preuss at cs.uni-dortmund.de (Mike Preuss)
Date: Wed, 14 Nov 2007 22:47:25 +0100
Subject: [Rd] stats package,
	optim and other optimization methods: more parameters?
Message-ID: <473B6CED.5070301@cs.uni-dortmund.de>

Dear R developers,

concerning the stats package,
is there a way to access more of the 'internal'
parameters of the optim() methods (e.g. BFGS),
without me rewriting optim code and using it as
an internal, patched stats package? It may not
sound useful to you, but for me it is important
to be able to change the parameters as I want
to apply parameter tuning methods. Currently,
I'm doing so only on the very limited parameter
set available via the control parameter, but
e.g. for the CG and BFGS methods, this is practically
empty. But there are internally set parameters
(e.g. for the line searches), just they are not
accessible from the outside.

Best wishes and many thanks,

Mike Preuss


From ripley at stats.ox.ac.uk  Wed Nov 14 23:00:16 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 14 Nov 2007 22:00:16 +0000 (GMT)
Subject: [Rd] stats package,
 optim and other optimization methods: more parameters?
In-Reply-To: <473B6CED.5070301@cs.uni-dortmund.de>
References: <473B6CED.5070301@cs.uni-dortmund.de>
Message-ID: <Pine.LNX.4.64.0711142154020.1433@gannet.stats.ox.ac.uk>

On Wed, 14 Nov 2007, Mike Preuss wrote:

> Dear R developers,
>
> concerning the stats package,
> is there a way to access more of the 'internal'
> parameters of the optim() methods (e.g. BFGS),
> without me rewriting optim code and using it as
> an internal, patched stats package? It may not
> sound useful to you, but for me it is important
> to be able to change the parameters as I want
> to apply parameter tuning methods. Currently,
> I'm doing so only on the very limited parameter
> set available via the control parameter, but
> e.g. for the CG and BFGS methods, this is practically
> empty. But there are internally set parameters
> (e.g. for the line searches), just they are not
> accessible from the outside.

Why don't you read the C code to find out?

You probably also need to read the reference to understand the choices 
made, and why the author didn't feel it useful to make them accessible.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From mike.preuss at cs.uni-dortmund.de  Wed Nov 14 23:19:57 2007
From: mike.preuss at cs.uni-dortmund.de (Mike Preuss)
Date: Wed, 14 Nov 2007 23:19:57 +0100
Subject: [Rd] stats package,
 optim and other optimization methods: more  parameters?
In-Reply-To: <Pine.LNX.4.64.0711142154020.1433@gannet.stats.ox.ac.uk>
References: <473B6CED.5070301@cs.uni-dortmund.de>
	<Pine.LNX.4.64.0711142154020.1433@gannet.stats.ox.ac.uk>
Message-ID: <473B748D.7090005@cs.uni-dortmund.de>

Dear Brian,

thanks for the hint. But my question is more
concerned with the technical procedure. Of
course, I can change the C code locally. And
then use a locally changed package. But then
nobody else beside myself can use it, right?
If changes were made in the official code
(and it's not really changing the code, only
adding some parameters to the interface),
my experiments could be repeated by others.

And if the official code is then changed
again, I'd have to update the local code
every time. Or is that unlikely? Or am I
missing some important point here?

Best, Mike



Prof Brian Ripley wrote:
> On Wed, 14 Nov 2007, Mike Preuss wrote:
> 
>> Dear R developers,
>>
>> concerning the stats package,
>> is there a way to access more of the 'internal'
>> parameters of the optim() methods (e.g. BFGS),
>> without me rewriting optim code and using it as
>> an internal, patched stats package? It may not
>> sound useful to you, but for me it is important
>> to be able to change the parameters as I want
>> to apply parameter tuning methods. Currently,
>> I'm doing so only on the very limited parameter
>> set available via the control parameter, but
>> e.g. for the CG and BFGS methods, this is practically
>> empty. But there are internally set parameters
>> (e.g. for the line searches), just they are not
>> accessible from the outside.
> 
> Why don't you read the C code to find out?
> 
> You probably also need to read the reference to understand the choices
> made, and why the author didn't feel it useful to make them accessible.
>


From ripley at stats.ox.ac.uk  Thu Nov 15 00:21:39 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 14 Nov 2007 23:21:39 +0000 (GMT)
Subject: [Rd] library path in Rd link
In-Reply-To: <200711150109.02826.dusa.adrian@gmail.com>
References: <200711141549.54176.dusa.adrian@gmail.com>
	<Pine.LNX.4.64.0711142132320.1433@gannet.stats.ox.ac.uk>
	<200711150109.02826.dusa.adrian@gmail.com>
Message-ID: <Pine.LNX.4.64.0711142309470.1433@gannet.stats.ox.ac.uk>

On Thu, 15 Nov 2007, Adrian Dusa wrote:

> Dear Prof. Ripley,
>
> On Wednesday 14 November 2007, Prof Brian Ripley wrote:
>> On Wed, 14 Nov 2007, Adrian Dusa wrote:
>>> Dear all,
>>>
>>> When creating new functions in a package, there is a "See also" component
>>> in the Rd file.
>>> Usually one uses \link{otherfun}, if the other function is from the same
>>> package, or \link[otherpackage]{otherfun} otherwise.
>>
>> I think you have misread the manual here:
>>
>>    There are two other forms of optional argument specified as
>>    \link[pkg]{foo} and \link[pkg:bar]{foo} to link to the package pkg, to
>>    files foo.html and bar.html respectively. These are rarely needed,
>>    perhaps to refer to not-yet-installed packages (but there the HTML
>>    help system will resolve the link at run time) or in the normally
>>    undesirable event that more than one package offers help on a topic
>>    (in which case the present package has precedence so this is only
>>    needed to refer to other packages)
>>
>> Note: 'rarely needed'.
>
> Ah-haa, thanks for the clarification. I could have directly used
> \code{\link{anova}}
> to refer to the anova() from package stats which is also installed by default
> in the same installation folder as the base package.
>
>
>>> The trouble is that I install new packages not in the default R library
>>> folder, but into some other subfolder in my home, so the link searches
>>> for "otherpackage" in my home subfolder.
>>>
>>> Is there a method to create links to functions from the base package, for
>>> example (which is installed by default in the normal library folder)?
>>
>> What OS is this?  (As I recall you used Linux last time you posted.)
>
> Linux it is, I only thought the question should be platform independent.
>
>> In any case, on all OSes you will be able to do cross-library links to the
>> base package without having to do anything further (and CRAN packages are
>> full of them).  On Unix-alikes the help files are all linked into a single
>> virtual library, and on Windows links to the base package (and a few
>> others) from other libraries are fixed up on installation by
>> link.html.help (see its help).
>
> Indeed, link.html.help() resolves all the links under Windows (where I
> suspected the biggest trouble would be). It is strangely under Linux that I
> am not able to resolve the links (most surely I do something wrong).
>
> Using as above:
> \code{\link{anova}}
>
> the html help file directs to
> file:///home/adi/myRlibrary/stats/html/anova.html

I hope it is actually ../../stats/html/anova.html and the browser is 
interpreting that as a full URL.

> instead of
> file:///usr/lib/R/library/stats/html/anova.html

But at run time help.start() creates links into a subdirectory of 
tempdir().  As in

> help.start()
Making links in per-session dir ...
If '/home/ripley/bin/firefox' is already running, it is *not*
     restarted, and you must switch to its window.
Otherwise, be patient ...

and without that

> help("anova", htmlhelp=TRUE)
Help for 'anova' is shown in browser /home/ripley/bin/firefox ...
Use
         help("anova", htmlhelp = FALSE)
or
         options(htmlhelp = FALSE)
to revert.
Warning message:
In .show_help_on_topic_as_HTML(file, topic) :
   Using non-linked HTML file: style sheet and hyperlinks may be incorrect

and note the last line.

(In case anyone wonders about the browser path: I am running 32-bit 
Firefox on x86_64 Linux.)

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch at stats.uwo.ca  Thu Nov 15 00:44:13 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 14 Nov 2007 18:44:13 -0500
Subject: [Rd] library path in Rd link
In-Reply-To: <200711150109.00697.dusa.adrian@gmail.com>
References: <200711141549.54176.dusa.adrian@gmail.com>
	<473B6A4F.2070208@stats.uwo.ca>
	<200711150109.00697.dusa.adrian@gmail.com>
Message-ID: <473B884D.6050602@stats.uwo.ca>

On 14/11/2007 6:09 PM, Adrian Dusa wrote:
> On Wednesday 14 November 2007, Duncan Murdoch wrote:
>> On 11/14/2007 8:49 AM, Adrian Dusa wrote:
>>> [...]
>>>
>>> Is there a method to create links to functions from the base package, for
>>> example (which is installed by default in the normal library folder)?
>> I believe this is normally automatic in platforms other than Windows.
>> On Windows, the answer is no.
> 
> This is what I thought, too. But if I link for example to function anova() in 
> pacakge stats, the html link after installing the new package is:
> 
> file:///home/adi/myRlibrary/stats/html/anova.html
> 
> where the stats package is by default installed in:
> 
> /usr/lib/R/library/
> 
> (indeed my question was related to Windows too, not only on Linux)
> 
> 
>> The problem is that in most cases R isn't in charge of the help file
>> viewing.  There isn't a good way to make a link from an HTML file to a
>> location that isn't known in advance, for example.
>>
>> On Unix-alikes, the workaround is to build soft links to all the
>> packages in a standard location; but soft links don't work on Windows
>> (and we don't want to get into the almost-undocumented hard links that
>> exist on some Windows file systems).
> 
> I understand, thank you. I learned from Prof. Ripley's answer that Windows has 
> link.html.help() function to resolve the html help files from all installed 
> packages.

I didn't know about that; I mainly use the CHMHELP files.  They don't 
support this, being precompiled when the binary package is built. 
Another reason to switch.

The link is probably "../../stats/html/anova.html", and is just being 
displayed by your browser that way.  This is correct:  R installs soft 
links to all packages in one place.  The HTML code doesn't get fixed up 
the way it needs to be on Windows.

Are you browsing the files from outside of R?  As far as I know (and I 
rarely use Unix so this may be out of date info) the links are set up in 
a temporary directoy when you call .libPaths(), and are removed at the 
end of your session.  I don't know if calling library(foo, 
lib.loc="mine") is enough to link the foo help into the system.

Duncan Murdoch


From dusa.adrian at gmail.com  Thu Nov 15 00:44:33 2007
From: dusa.adrian at gmail.com (Adrian Dusa)
Date: Thu, 15 Nov 2007 01:44:33 +0200
Subject: [Rd] library path in Rd link
In-Reply-To: <Pine.LNX.4.64.0711142309470.1433@gannet.stats.ox.ac.uk>
References: <200711141549.54176.dusa.adrian@gmail.com>
	<200711150109.02826.dusa.adrian@gmail.com>
	<Pine.LNX.4.64.0711142309470.1433@gannet.stats.ox.ac.uk>
Message-ID: <200711150144.33561.dusa.adrian@gmail.com>

On Thursday 15 November 2007, Prof Brian Ripley wrote:
> [...]
> >
> > Using as above:
> > \code{\link{anova}}
> >
> > the html help file directs to
> > file:///home/adi/myRlibrary/stats/html/anova.html
>
> I hope it is actually ../../stats/html/anova.html and the browser is
> interpreting that as a full URL.
>
> > instead of
> > file:///usr/lib/R/library/stats/html/anova.html
>
> But at run time help.start() creates links into a subdirectory of
> tempdir().  As in
>
> > help.start()

I got it.
Perhaps it would be useful to have another startup option, something like:
options(htmlLinksResolve=TRUE)

that one could use in the .First() function from .Rprofile

I tried using help.start() in .Rprofile, but it throws a (probably obvious) 
error:
Error: could not find function "help.start"


For my personal purposes, all questions have been answered though.
Thank you very much,
Adrian


-- 
Adrian Dusa
Romanian Social Data Archive
1, Schitu Magureanu Bd
050025 Bucharest sector 5
Romania
Tel./Fax: +40 21 3126618 \
          +40 21 3120210 / int.101


From murdoch at stats.uwo.ca  Thu Nov 15 00:54:50 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 14 Nov 2007 18:54:50 -0500
Subject: [Rd] library path in Rd link
In-Reply-To: <200711150144.33561.dusa.adrian@gmail.com>
References: <200711141549.54176.dusa.adrian@gmail.com>	<200711150109.02826.dusa.adrian@gmail.com>	<Pine.LNX.4.64.0711142309470.1433@gannet.stats.ox.ac.uk>
	<200711150144.33561.dusa.adrian@gmail.com>
Message-ID: <473B8ACA.20508@stats.uwo.ca>

On 14/11/2007 6:44 PM, Adrian Dusa wrote:
> On Thursday 15 November 2007, Prof Brian Ripley wrote:
>> [...]
>>> Using as above:
>>> \code{\link{anova}}
>>>
>>> the html help file directs to
>>> file:///home/adi/myRlibrary/stats/html/anova.html
>> I hope it is actually ../../stats/html/anova.html and the browser is
>> interpreting that as a full URL.
>>
>>> instead of
>>> file:///usr/lib/R/library/stats/html/anova.html
>> But at run time help.start() creates links into a subdirectory of
>> tempdir().  As in
>>
>>> help.start()
> 
> I got it.
> Perhaps it would be useful to have another startup option, something like:
> options(htmlLinksResolve=TRUE)
> 
> that one could use in the .First() function from .Rprofile
> 
> I tried using help.start() in .Rprofile, but it throws a (probably obvious) 
> error:
> Error: could not find function "help.start"

That's just because .Rprofile is run before most packages are attached; 
you should be able to say utils::help.start() to get it to run.

> 
> 
> For my personal purposes, all questions have been answered though.
> Thank you very much,
> Adrian
> 
>


From dusa.adrian at gmail.com  Thu Nov 15 01:00:49 2007
From: dusa.adrian at gmail.com (Adrian Dusa)
Date: Thu, 15 Nov 2007 02:00:49 +0200
Subject: [Rd] library path in Rd link
In-Reply-To: <473B884D.6050602@stats.uwo.ca>
References: <200711141549.54176.dusa.adrian@gmail.com>
	<200711150109.00697.dusa.adrian@gmail.com>
	<473B884D.6050602@stats.uwo.ca>
Message-ID: <200711150200.49346.dusa.adrian@gmail.com>

On Thursday 15 November 2007, Duncan Murdoch wrote:
> [...]
> >
> > I understand, thank you. I learned from Prof. Ripley's answer that
> > Windows has link.html.help() function to resolve the html help files from
> > all installed packages.
>
> I didn't know about that; I mainly use the CHMHELP files.  They don't
> support this, being precompiled when the binary package is built.
> Another reason to switch.
>
> The link is probably "../../stats/html/anova.html", and is just being
> displayed by your browser that way.  This is correct:  R installs soft
> links to all packages in one place.  The HTML code doesn't get fixed up
> the way it needs to be on Windows.

It is true, the link was "../../" (my misunderstanding)


> Are you browsing the files from outside of R?  As far as I know (and I
> rarely use Unix so this may be out of date info) the links are set up in
> a temporary directoy when you call .libPaths(), and are removed at the
> end of your session.  I don't know if calling library(foo,
> lib.loc="mine") is enough to link the foo help into the system.

I use:
options(htmlhelp=TRUE)
options(browser="firefox")

I just tried
library(myPackage, lib.loc="myRlibrary")

but I still get

Warning message:
In .show_help_on_topic_as_HTML(file, topic) :
  Using non-linked HTML file: style sheet and hyperlinks may be incorrect

so it seems foo help is not linked into the system.
But there are (at least on Linux) two more than acceptable solutions:

- soft link the folders from /usr/lib/R/library/ to myRlibrary/
(your suggestion, I like it very much and it makes me a happy Linux user)

- use help.start() which links all packages help in a tmp directory
(Prof.Ripley's solution)

Best regards,
Adrian

-- 
Adrian Dusa
Romanian Social Data Archive
1, Schitu Magureanu Bd
050025 Bucharest sector 5
Romania
Tel./Fax: +40 21 3126618 \
          +40 21 3120210 / int.101


From dusa.adrian at gmail.com  Thu Nov 15 01:11:30 2007
From: dusa.adrian at gmail.com (Adrian Dusa)
Date: Thu, 15 Nov 2007 02:11:30 +0200
Subject: [Rd] library path in Rd link
In-Reply-To: <473B8ACA.20508@stats.uwo.ca>
References: <200711141549.54176.dusa.adrian@gmail.com>
	<200711150144.33561.dusa.adrian@gmail.com>
	<473B8ACA.20508@stats.uwo.ca>
Message-ID: <200711150211.30874.dusa.adrian@gmail.com>

On Thursday 15 November 2007, Duncan Murdoch wrote:
> [...]
> > I tried using help.start() in .Rprofile, but it throws a (probably
> > obvious) error:
> > Error: could not find function "help.start"
>
> That's just because .Rprofile is run before most packages are attached;
> you should be able to say utils::help.start() to get it to run.

Smooth :o)


-- 
Adrian Dusa
Romanian Social Data Archive
1, Schitu Magureanu Bd
050025 Bucharest sector 5
Romania
Tel./Fax: +40 21 3126618 \
          +40 21 3120210 / int.101


From ggrothendieck at gmail.com  Thu Nov 15 01:44:25 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 14 Nov 2007 19:44:25 -0500
Subject: [Rd] library path in Rd link
In-Reply-To: <473B6A4F.2070208@stats.uwo.ca>
References: <200711141549.54176.dusa.adrian@gmail.com>
	<473B6A4F.2070208@stats.uwo.ca>
Message-ID: <971536df0711141644v1d78c57chccd63094ac22911f@mail.gmail.com>

On Nov 14, 2007 4:36 PM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>
> On Unix-alikes, the workaround is to build soft links to all the
> packages in a standard location; but soft links don't work on Windows
> (and we don't want to get into the almost-undocumented hard links that
> exist on some Windows file systems).

Symbolic links are available on Windows Vista:

C:\> mklink /?
Creates a symbolic link.

MKLINK [[/D] | [/H] | [/J]] Link Target

        /D      Creates a directory symbolic link.  Default is a file
                symbolic link.
        /H      Creates a hard link instead of a symbolic link.
        /J      Creates a Directory Junction.
        Link    specifies the new symbolic link name.
        Target  specifies the path (relative or absolute) that the new link
                refers to.


From roger at ysidro.econ.uiuc.edu  Thu Nov 15 02:22:19 2007
From: roger at ysidro.econ.uiuc.edu (roger koenker)
Date: Wed, 14 Nov 2007 19:22:19 -0600
Subject: [Rd] faqs
Message-ID: <D4F43809-6D74-4FA4-92AB-0A9248072A1A@ysidro.econ.uiuc.edu>

An extremely modest proposal:

It would be nice if packages could have a FAQ and if

	faq(package.name)

would produce this faq.  And if, by default

	faq()
	FAQ()

would produce the admirable R faq...  Apologies in advance
if there is already a mechanism like this, but help.search()
didn't reveal anything.

url:    www.econ.uiuc.edu/~roger                Roger Koenker
email   rkoenker at uiuc.edu                       Department of Economics
vox:    217-333-4558                            University of Illinois
fax:    217-244-6678                            Champaign, IL 61820


From ggrothendieck at gmail.com  Thu Nov 15 02:53:17 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 14 Nov 2007 20:53:17 -0500
Subject: [Rd] faqs
In-Reply-To: <D4F43809-6D74-4FA4-92AB-0A9248072A1A@ysidro.econ.uiuc.edu>
References: <D4F43809-6D74-4FA4-92AB-0A9248072A1A@ysidro.econ.uiuc.edu>
Message-ID: <971536df0711141753r5753c3c5i6faf438bd65ebc03@mail.gmail.com>

Another possibility is to just place it at the end of the vignette.
That is where it is in the proto package:

http://cran.r-project.org/doc/vignettes/proto/proto.pdf

Package documentation is already quite scattered and adding
a faq() command would add just one more thing one has
to do.  Here are some places one might look already for
documentation:

package?mypackage
vignette(...)
library(help = mypackage)
?mycommand
home page
WISHLIST file
NEWS file
THANKS file
svn log

I personally would give a much higher priority to a standardized
place to find change information.  Some packages provide it.
Some don't which is very frustrating since you see a new version
and have no idea what has changed.  If they do document it you
often have to download the source just to get at the change information.



On Nov 14, 2007 8:22 PM, roger koenker <roger at ysidro.econ.uiuc.edu> wrote:
> An extremely modest proposal:
>
> It would be nice if packages could have a FAQ and if
>
>        faq(package.name)
>
> would produce this faq.  And if, by default
>
>        faq()
>        FAQ()
>
> would produce the admirable R faq...  Apologies in advance
> if there is already a mechanism like this, but help.search()
> didn't reveal anything.
>
> url:    www.econ.uiuc.edu/~roger                Roger Koenker
> email   rkoenker at uiuc.edu                       Department of Economics
> vox:    217-333-4558                            University of Illinois
> fax:    217-244-6678                            Champaign, IL 61820
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From murdoch at stats.uwo.ca  Thu Nov 15 04:00:15 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 14 Nov 2007 22:00:15 -0500
Subject: [Rd] library path in Rd link
In-Reply-To: <971536df0711141644v1d78c57chccd63094ac22911f@mail.gmail.com>
References: <200711141549.54176.dusa.adrian@gmail.com>	
	<473B6A4F.2070208@stats.uwo.ca>
	<971536df0711141644v1d78c57chccd63094ac22911f@mail.gmail.com>
Message-ID: <473BB63F.2000907@stats.uwo.ca>

On 14/11/2007 7:44 PM, Gabor Grothendieck wrote:
> On Nov 14, 2007 4:36 PM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> On Unix-alikes, the workaround is to build soft links to all the
>> packages in a standard location; but soft links don't work on Windows
>> (and we don't want to get into the almost-undocumented hard links that
>> exist on some Windows file systems).
> 
> Symbolic links are available on Windows Vista:

Does this work on FAT file systems, e.g. on a USB drive?  It used to be 
that they only worked on NTFS.

Duncan Murdoch

> 
> C:\> mklink /?
> Creates a symbolic link.
> 
> MKLINK [[/D] | [/H] | [/J]] Link Target
> 
>         /D      Creates a directory symbolic link.  Default is a file
>                 symbolic link.
>         /H      Creates a hard link instead of a symbolic link.
>         /J      Creates a Directory Junction.
>         Link    specifies the new symbolic link name.
>         Target  specifies the path (relative or absolute) that the new link
>                 refers to.


From murdoch at stats.uwo.ca  Thu Nov 15 04:15:45 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 14 Nov 2007 22:15:45 -0500
Subject: [Rd] faqs
In-Reply-To: <971536df0711141753r5753c3c5i6faf438bd65ebc03@mail.gmail.com>
References: <D4F43809-6D74-4FA4-92AB-0A9248072A1A@ysidro.econ.uiuc.edu>
	<971536df0711141753r5753c3c5i6faf438bd65ebc03@mail.gmail.com>
Message-ID: <473BB9E1.4020001@stats.uwo.ca>

On 14/11/2007 8:53 PM, Gabor Grothendieck wrote:
> Another possibility is to just place it at the end of the vignette.
> That is where it is in the proto package:
> 
> http://cran.r-project.org/doc/vignettes/proto/proto.pdf
> 
> Package documentation is already quite scattered and adding
> a faq() command would add just one more thing one has
> to do.  Here are some places one might look already for
> documentation:
> 
> package?mypackage

Or just ?mypackage.  Writing R Extensions recommends package?mypackage, 
with ?mypackage also working if that name isn't taken.  However, the 
advice is ignored more than it is followed.

> vignette(...)
> library(help = mypackage)
> ?mycommand
> home page
> WISHLIST file
> NEWS file
> THANKS file
> svn log
> 
> I personally would give a much higher priority to a standardized
> place to find change information.  Some packages provide it.
> Some don't which is very frustrating since you see a new version
> and have no idea what has changed.  If they do document it you
> often have to download the source just to get at the change information.

Where do you put it?  I put it in inst/ChangeLog, which ends up 
installed in the package root as ChangeLog.

Whenever this has come up in the past, there have been several 
proposals, but no consensus.  So, to encourage consensus, I've got a 
proposal:

Why don't we vote on a location, with every voter agreeing to follow the 
majority?  The only condition I'd put on it is that it should be 
something that gets installed, hence somewhere in inst, but I'd be happy 
to change the name if ChangeLog doesn't win.

My vote is for inst/ChangeLog.

Duncan Murdoch

> 
> 
> 
> On Nov 14, 2007 8:22 PM, roger koenker <roger at ysidro.econ.uiuc.edu> wrote:
>> An extremely modest proposal:
>>
>> It would be nice if packages could have a FAQ and if
>>
>>        faq(package.name)
>>
>> would produce this faq.  And if, by default
>>
>>        faq()
>>        FAQ()
>>
>> would produce the admirable R faq...  Apologies in advance
>> if there is already a mechanism like this, but help.search()
>> didn't reveal anything.
>>
>> url:    www.econ.uiuc.edu/~roger                Roger Koenker
>> email   rkoenker at uiuc.edu                       Department of Economics
>> vox:    217-333-4558                            University of Illinois
>> fax:    217-244-6678                            Champaign, IL 61820
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From seth at userprimary.net  Thu Nov 15 05:38:18 2007
From: seth at userprimary.net (Seth Falcon)
Date: Wed, 14 Nov 2007 20:38:18 -0800
Subject: [Rd] package installation order
In-Reply-To: <18235.3307.38745.255091@ron.nulle.part> (Dirk Eddelbuettel's
	message of "Wed\, 14 Nov 2007 08\:57\:47 -0600")
References: <71257D09F114DA4A8E134DEAC70F25D30A2029AA@groamrexm03.amer.pfizer.com>
	<18235.3307.38745.255091@ron.nulle.part>
Message-ID: <m2lk90kts5.fsf@userprimary.net>

Dirk Eddelbuettel <edd at debian.org> writes:
> When trying to package the by-now-gargantuan Rmetrics for Debian (which is
> still ongoing), I looked around for some Depends builders. Turns out that
> BioC has this.   E.g. the following worked for:
>
> ## > install.packages("Biobase", repo="http://www.bioconductor.org")
> ## > repos <- Biobase:::biocReposList()
> ## > install.packages("pkgDepTools", repos=repos["bioc"])
> ## > library(pkgDepTools)
> ## Loading required package: graph
> ## Loading required package: RBGL
> ## > CRANdeps <- makeDepGraph(repos["cran"], type="source")
> ## > getInstallOrder("Rmetrics", CRANdeps, needed.only=FALSE)
>
> worked for me.  I meant to add some code for Graphviz visualization (or look
> for it, Seth et al probably already wrote it) but what you get from
> getInstallOrder() should suit your needs here.

makeDepGraph returns a graphNEL instance and Rgraphviz knows how to
plot those.  The entire graph will likely not produce a particularly
compelling visualization.  But you can subset the graph according to a
particular package's dependencies, etc.

+ seth

-- 
Seth Falcon | seth at userprimary.net | blog: http://userprimary.net/user/


From seth at userprimary.net  Thu Nov 15 06:08:53 2007
From: seth at userprimary.net (Seth Falcon)
Date: Wed, 14 Nov 2007 21:08:53 -0800
Subject: [Rd] isOpen on closed connections
In-Reply-To: <473B0739.3090507@jhsph.edu> (Roger D. Peng's message of "Wed\,
	14 Nov 2007 09\:33\:29 -0500")
References: <473B0739.3090507@jhsph.edu>
Message-ID: <m2hcjoksd6.fsf@userprimary.net>

"Roger D. Peng" <rpeng at jhsph.edu> writes:

> As far as I can tell, 'isOpen' cannot return FALSE in the case when 'rw = ""'. 
> If the connection has already been closed by 'close' or some other function, 
> then isOpen will produce an error.  The problem is that when isOpen calls 
> 'getConnection', the connection cannot be found and 'getConnection' produces an 
> error.  The check to see if it is open is never actually done.

I see this too with R-devel (r43376) {from Nov 6th}.

    con = file("example1", "w")
    isOpen(con)

    [1] TRUE

    showConnections()

      description class  mode text   isopen   can read can write
    3 "example1"  "file" "w"  "text" "opened" "no"     "yes"    

    close(con)
    isOpen(con)

    Error in isOpen(con) : invalid connection

    ## printing also fails
    con
    Error in summary.connection(x) : invalid connection

> This came up in some code where I'm trying to clean up connections after 
> successfully opening them.  The problem is that if I try to close a connection 
> that has already been closed, I get an error (because 'getConnection' cannot 
> find it).  But then there's no way for me to find out if a connection has 
> already been closed.  Perhaps there's another approach I should be taking?  The 
> context is basically,
>
> con <- file("foo", "w")
>
> tryCatch({
> 	## Do stuff that might fail
> 	writeLines(stuff, con)
> 	close(con)
>
> 	file.copy("foo", "bar")
> }, finally = {
> 	close(con)
> })

This doesn't address isOpen, but why do you have the call to close
inside the tryCatch block?  Isn't the idea that finally will always be
run and so you can be reasonably sure that close gets called once?

If your real world code is more complicated, perhaps you can make use
of a work around like:

myIsOpen = function(con) tryCatch(isOpen(con), error=function(e) FALSE)

You could do similar with myClose and "close" a connection as many
times as you'd like :-)

+ seth

-- 
Seth Falcon | seth at userprimary.net | blog: http://userprimary.net/user/


From ggrothendieck at gmail.com  Thu Nov 15 05:55:05 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 14 Nov 2007 23:55:05 -0500
Subject: [Rd] faqs
In-Reply-To: <473BB9E1.4020001@stats.uwo.ca>
References: <D4F43809-6D74-4FA4-92AB-0A9248072A1A@ysidro.econ.uiuc.edu>
	<971536df0711141753r5753c3c5i6faf438bd65ebc03@mail.gmail.com>
	<473BB9E1.4020001@stats.uwo.ca>
Message-ID: <971536df0711142055t652a618jbac4b5f23af48652@mail.gmail.com>

inst/NEWS would have the advantage of consistency with R itself
which also has a NEWS file.


On Nov 14, 2007 10:15 PM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 14/11/2007 8:53 PM, Gabor Grothendieck wrote:
> > Another possibility is to just place it at the end of the vignette.
> > That is where it is in the proto package:
> >
> > http://cran.r-project.org/doc/vignettes/proto/proto.pdf
> >
> > Package documentation is already quite scattered and adding
> > a faq() command would add just one more thing one has
> > to do.  Here are some places one might look already for
> > documentation:
> >
> > package?mypackage
>
> Or just ?mypackage.  Writing R Extensions recommends package?mypackage,
> with ?mypackage also working if that name isn't taken.  However, the
> advice is ignored more than it is followed.
>
> > vignette(...)
> > library(help = mypackage)
> > ?mycommand
> > home page
> > WISHLIST file
> > NEWS file
> > THANKS file
> > svn log
> >
> > I personally would give a much higher priority to a standardized
> > place to find change information.  Some packages provide it.
> > Some don't which is very frustrating since you see a new version
> > and have no idea what has changed.  If they do document it you
> > often have to download the source just to get at the change information.
>
> Where do you put it?  I put it in inst/ChangeLog, which ends up
> installed in the package root as ChangeLog.
>
> Whenever this has come up in the past, there have been several
> proposals, but no consensus.  So, to encourage consensus, I've got a
> proposal:
>
> Why don't we vote on a location, with every voter agreeing to follow the
> majority?  The only condition I'd put on it is that it should be
> something that gets installed, hence somewhere in inst, but I'd be happy
> to change the name if ChangeLog doesn't win.
>
> My vote is for inst/ChangeLog.
>
> Duncan Murdoch
>
>
> >
> >
> >
> > On Nov 14, 2007 8:22 PM, roger koenker <roger at ysidro.econ.uiuc.edu> wrote:
> >> An extremely modest proposal:
> >>
> >> It would be nice if packages could have a FAQ and if
> >>
> >>        faq(package.name)
> >>
> >> would produce this faq.  And if, by default
> >>
> >>        faq()
> >>        FAQ()
> >>
> >> would produce the admirable R faq...  Apologies in advance
> >> if there is already a mechanism like this, but help.search()
> >> didn't reveal anything.
> >>
> >> url:    www.econ.uiuc.edu/~roger                Roger Koenker
> >> email   rkoenker at uiuc.edu                       Department of Economics
> >> vox:    217-333-4558                            University of Illinois
> >> fax:    217-244-6678                            Champaign, IL 61820
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From ggrothendieck at gmail.com  Thu Nov 15 05:59:34 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 14 Nov 2007 23:59:34 -0500
Subject: [Rd] library path in Rd link
In-Reply-To: <473BB63F.2000907@stats.uwo.ca>
References: <200711141549.54176.dusa.adrian@gmail.com>
	<473B6A4F.2070208@stats.uwo.ca>
	<971536df0711141644v1d78c57chccd63094ac22911f@mail.gmail.com>
	<473BB63F.2000907@stats.uwo.ca>
Message-ID: <971536df0711142059i402a9e48k7f8c2ba1276fe485@mail.gmail.com>

I think that's right -- it only works on NTFS systems.  This page
refers to it as an NTFS symbolic link:
http://en.wikipedia.org/wiki/NTFS_symbolic_link

On Nov 14, 2007 10:00 PM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 14/11/2007 7:44 PM, Gabor Grothendieck wrote:
> > On Nov 14, 2007 4:36 PM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> >> On Unix-alikes, the workaround is to build soft links to all the
> >> packages in a standard location; but soft links don't work on Windows
> >> (and we don't want to get into the almost-undocumented hard links that
> >> exist on some Windows file systems).
> >
> > Symbolic links are available on Windows Vista:
>
> Does this work on FAT file systems, e.g. on a USB drive?  It used to be
> that they only worked on NTFS.
>
> Duncan Murdoch
>
>
> >
> > C:\> mklink /?
> > Creates a symbolic link.
> >
> > MKLINK [[/D] | [/H] | [/J]] Link Target
> >
> >         /D      Creates a directory symbolic link.  Default is a file
> >                 symbolic link.
> >         /H      Creates a hard link instead of a symbolic link.
> >         /J      Creates a Directory Junction.
> >         Link    specifies the new symbolic link name.
> >         Target  specifies the path (relative or absolute) that the new link
> >                 refers to.
>
>


From ripley at stats.ox.ac.uk  Thu Nov 15 08:18:42 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 15 Nov 2007 07:18:42 +0000 (GMT)
Subject: [Rd] isOpen on closed connections
In-Reply-To: <m2hcjoksd6.fsf@userprimary.net>
References: <473B0739.3090507@jhsph.edu> <m2hcjoksd6.fsf@userprimary.net>
Message-ID: <Pine.LNX.4.64.0711150714150.11152@gannet.stats.ox.ac.uk>

I think the confusion here is over close(): that closes *and destroys* a 
connection, so it no longer exists.

isOpen applies to existing connections: you cannot close but not destroy 
them at R level, but C code can (and does).  You will see it in use in the 
utils package.


On Wed, 14 Nov 2007, Seth Falcon wrote:

> "Roger D. Peng" <rpeng at jhsph.edu> writes:
>
>> As far as I can tell, 'isOpen' cannot return FALSE in the case when 'rw = ""'.
>> If the connection has already been closed by 'close' or some other function,
>> then isOpen will produce an error.  The problem is that when isOpen calls
>> 'getConnection', the connection cannot be found and 'getConnection' produces an
>> error.  The check to see if it is open is never actually done.
>
> I see this too with R-devel (r43376) {from Nov 6th}.
>
>    con = file("example1", "w")
>    isOpen(con)
>
>    [1] TRUE
>
>    showConnections()
>
>      description class  mode text   isopen   can read can write
>    3 "example1"  "file" "w"  "text" "opened" "no"     "yes"
>
>    close(con)
>    isOpen(con)
>
>    Error in isOpen(con) : invalid connection
>
>    ## printing also fails
>    con
>    Error in summary.connection(x) : invalid connection
>
>> This came up in some code where I'm trying to clean up connections after
>> successfully opening them.  The problem is that if I try to close a connection
>> that has already been closed, I get an error (because 'getConnection' cannot
>> find it).  But then there's no way for me to find out if a connection has
>> already been closed.  Perhaps there's another approach I should be taking?  The
>> context is basically,
>>
>> con <- file("foo", "w")
>>
>> tryCatch({
>> 	## Do stuff that might fail
>> 	writeLines(stuff, con)
>> 	close(con)
>>
>> 	file.copy("foo", "bar")
>> }, finally = {
>> 	close(con)
>> })
>
> This doesn't address isOpen, but why do you have the call to close
> inside the tryCatch block?  Isn't the idea that finally will always be
> run and so you can be reasonably sure that close gets called once?
>
> If your real world code is more complicated, perhaps you can make use
> of a work around like:
>
> myIsOpen = function(con) tryCatch(isOpen(con), error=function(e) FALSE)
>
> You could do similar with myClose and "close" a connection as many
> times as you'd like :-)
>
> + seth
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Thu Nov 15 08:22:09 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 15 Nov 2007 07:22:09 +0000 (GMT)
Subject: [Rd] library path in Rd link
In-Reply-To: <200711150144.33561.dusa.adrian@gmail.com>
References: <200711141549.54176.dusa.adrian@gmail.com>
	<200711150109.02826.dusa.adrian@gmail.com>
	<Pine.LNX.4.64.0711142309470.1433@gannet.stats.ox.ac.uk>
	<200711150144.33561.dusa.adrian@gmail.com>
Message-ID: <Pine.LNX.4.64.0711150658040.11152@gannet.stats.ox.ac.uk>

On Thu, 15 Nov 2007, Adrian Dusa wrote:

> On Thursday 15 November 2007, Prof Brian Ripley wrote:
>> [...]
>>>
>>> Using as above:
>>> \code{\link{anova}}
>>>
>>> the html help file directs to
>>> file:///home/adi/myRlibrary/stats/html/anova.html
>>
>> I hope it is actually ../../stats/html/anova.html and the browser is
>> interpreting that as a full URL.
>>
>>> instead of
>>> file:///usr/lib/R/library/stats/html/anova.html
>>
>> But at run time help.start() creates links into a subdirectory of
>> tempdir().  As in
>>
>>> help.start()
>
> I got it.
> Perhaps it would be useful to have another startup option, something like:
> options(htmlLinksResolve=TRUE)
>
> that one could use in the .First() function from .Rprofile

You could have a function to run there, essentially (from help.start())

     .Script("sh", "help-links.sh",
             paste(tempdir(), paste(.libPaths(), collapse = " ")))

and perhaps (it is a lot slower)

     utils::make.packages.html()

The problem is that even the first can be slow on a network-mounted file 
system with a lot of packages installed, do we don't want to do it by 
default.

> I tried using help.start() in .Rprofile, but it throws a (probably obvious)
> error:
> Error: could not find function "help.start"

Duncan has answered that.

> For my personal purposes, all questions have been answered though.
> Thank you very much,
> Adrian
>
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From hb at stat.berkeley.edu  Thu Nov 15 09:33:24 2007
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Thu, 15 Nov 2007 00:33:24 -0800
Subject: [Rd] isOpen on closed connections
In-Reply-To: <Pine.LNX.4.64.0711150714150.11152@gannet.stats.ox.ac.uk>
References: <473B0739.3090507@jhsph.edu> <m2hcjoksd6.fsf@userprimary.net>
	<Pine.LNX.4.64.0711150714150.11152@gannet.stats.ox.ac.uk>
Message-ID: <59d7961d0711150033u463b206agf23ab77eea87983c@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20071115/3f7d124b/attachment.pl 

From ripley at stats.ox.ac.uk  Thu Nov 15 10:13:26 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 15 Nov 2007 09:13:26 +0000 (GMT)
Subject: [Rd] library path in Rd link
In-Reply-To: <Pine.LNX.4.64.0711150658040.11152@gannet.stats.ox.ac.uk>
References: <200711141549.54176.dusa.adrian@gmail.com>
	<200711150109.02826.dusa.adrian@gmail.com>
	<Pine.LNX.4.64.0711142309470.1433@gannet.stats.ox.ac.uk>
	<200711150144.33561.dusa.adrian@gmail.com>
	<Pine.LNX.4.64.0711150658040.11152@gannet.stats.ox.ac.uk>
Message-ID: <Pine.LNX.4.64.0711150905060.25358@gannet.stats.ox.ac.uk>

On Thu, 15 Nov 2007, Prof Brian Ripley wrote:

> On Thu, 15 Nov 2007, Adrian Dusa wrote:
>
>> On Thursday 15 November 2007, Prof Brian Ripley wrote:
>>> [...]
>>>>
>>>> Using as above:
>>>> \code{\link{anova}}
>>>>
>>>> the html help file directs to
>>>> file:///home/adi/myRlibrary/stats/html/anova.html
>>>
>>> I hope it is actually ../../stats/html/anova.html and the browser is
>>> interpreting that as a full URL.
>>>
>>>> instead of
>>>> file:///usr/lib/R/library/stats/html/anova.html
>>>
>>> But at run time help.start() creates links into a subdirectory of
>>> tempdir().  As in
>>>
>>>> help.start()
>>
>> I got it.
>> Perhaps it would be useful to have another startup option, something like:
>> options(htmlLinksResolve=TRUE)
>>
>> that one could use in the .First() function from .Rprofile
>
> You could have a function to run there, essentially (from help.start())
>
>     .Script("sh", "help-links.sh",
>             paste(tempdir(), paste(.libPaths(), collapse = " ")))
>
> and perhaps (it is a lot slower)
>
>     utils::make.packages.html()

It transpires that currently you do need both: although the script is 
passed the library locations it does not make use of them, leaving the 
linking to make.packages.html.  (That used not to be the case.)

> The problem is that even the first can be slow on a network-mounted file
> system with a lot of packages installed, do we don't want to do it by
> default.

So speed is the problem: I am seeing about 4 secs on a system with 1450 
packages on the local disc, and 33 secs on a slower system with a 
network-mounted FS.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From gregor.gorjanc at bfro.uni-lj.si  Thu Nov 15 10:13:40 2007
From: gregor.gorjanc at bfro.uni-lj.si (Gregor Gorjanc)
Date: Thu, 15 Nov 2007 09:13:40 +0000 (UTC)
Subject: [Rd] faqs
References: <D4F43809-6D74-4FA4-92AB-0A9248072A1A@ysidro.econ.uiuc.edu>
	<971536df0711141753r5753c3c5i6faf438bd65ebc03@mail.gmail.com>
	<473BB9E1.4020001@stats.uwo.ca>
	<971536df0711142055t652a618jbac4b5f23af48652@mail.gmail.com>
Message-ID: <loom.20071115T091239-83@post.gmane.org>

Gabor Grothendieck <ggrothendieck <at> gmail.com> writes:
> inst/NEWS would have the advantage of consistency with R itself
> which also has a NEWS file.
> 
...
> > My vote is for inst/ChangeLog.

I wote for inst/NEWS, while inst/ChangeLog can also be present to show more
details such as svn log.

Gregor


From bhs2 at mevik.net  Thu Nov 15 10:36:45 2007
From: bhs2 at mevik.net (=?iso-8859-1?q?Bj=F8rn-Helge_Mevik?=)
Date: Thu, 15 Nov 2007 10:36:45 +0100
Subject: [Rd] When to use LazyLoad, LazyData and ZipData?
In-Reply-To: <Pine.LNX.4.64.0711141251420.31696@gannet.stats.ox.ac.uk> (Brian
	Ripley's message of "Wed, 14 Nov 2007 12:58:47 +0000 (GMT)")
References: <m0prydkpda.fsf@bar.nemo-project.org>
	<Pine.LNX.4.64.0711141251420.31696@gannet.stats.ox.ac.uk>
Message-ID: <m0ejer6eaa.fsf@bar.nemo-project.org>

Prof Brian Ripley wrote:

> On Wed, 14 Nov 2007, Bj?rn-Helge Mevik wrote:
>
>> When should one specify LazyLoad, LazyData, and ZipData?
>
> Preferably always, and I would suggest all should be 'yes' if your
> package will work with them.

Thank you!  After reading this, and the very nice R-news article
pointed to by Gabor Grothendieck, I've switched to specifying the
directives in my packages.

-- 
Bj?rn-Helge Mevik


From dusa.adrian at gmail.com  Thu Nov 15 11:51:40 2007
From: dusa.adrian at gmail.com (Adrian Dusa)
Date: Thu, 15 Nov 2007 12:51:40 +0200
Subject: [Rd] library path in Rd link
In-Reply-To: <Pine.LNX.4.64.0711150905060.25358@gannet.stats.ox.ac.uk>
References: <200711141549.54176.dusa.adrian@gmail.com>
	<Pine.LNX.4.64.0711150658040.11152@gannet.stats.ox.ac.uk>
	<Pine.LNX.4.64.0711150905060.25358@gannet.stats.ox.ac.uk>
Message-ID: <200711151251.41034.dusa.adrian@gmail.com>

On Thursday 15 November 2007, Prof Brian Ripley wrote:
> [...]
> >>>> help.start()
> >>
> >> I got it.
> >> Perhaps it would be useful to have another startup option, something
> >> like: options(htmlLinksResolve=TRUE)
> >>
> >> that one could use in the .First() function from .Rprofile
> >
> > You could have a function to run there, essentially (from help.start())
> >
> >     .Script("sh", "help-links.sh",
> >             paste(tempdir(), paste(.libPaths(), collapse = " ")))
> >
> > and perhaps (it is a lot slower)
> >
> >     utils::make.packages.html()
>
> It transpires that currently you do need both: although the script is
> passed the library locations it does not make use of them, leaving the
> linking to make.packages.html.  (That used not to be the case.)
>
> > The problem is that even the first can be slow on a network-mounted file
> > system with a lot of packages installed, do we don't want to do it by
> > default.
>
> So speed is the problem: I am seeing about 4 secs on a system with 1450
> packages on the local disc, and 33 secs on a slower system with
> network-mounted FS.

Completely understandable, it's not going to be automatic. Users who don't 
suffer from these restrictions could manually make use of the script.

Thank you very much,
Adrian


-- 
Adrian Dusa
Romanian Social Data Archive
1, Schitu Magureanu Bd
050025 Bucharest sector 5
Romania
Tel./Fax: +40 21 3126618 \
          +40 21 3120210 / int.101


From rpeng at jhsph.edu  Thu Nov 15 13:48:18 2007
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Thu, 15 Nov 2007 07:48:18 -0500
Subject: [Rd] isOpen on closed connections
In-Reply-To: <Pine.LNX.4.64.0711150714150.11152@gannet.stats.ox.ac.uk>
References: <473B0739.3090507@jhsph.edu> <m2hcjoksd6.fsf@userprimary.net>
	<Pine.LNX.4.64.0711150714150.11152@gannet.stats.ox.ac.uk>
Message-ID: <473C4012.3030909@jhsph.edu>

Upon further consideration, I realized there is a philosophical element 
here---if a connection is closed and hence does not exist, is it open?

The practical issue for me is that when you do something like

close(con)

the 'con' object is still lying around and is essentially undefined.  For 
example, if I do

close(con)
con <- "hello"

then it seems logical to me that 'isOpen' would return an error.  But it feels 
natural to me that a sequence like

close(con)
isOpen(con)  ## FALSE?

would not lead to an error.  Perhaps my expectations are not reasonable and I'd 
appreciate being corrected.

Given Brian's comment, one solution would be to allowing closing but not 
destroying connections at the R level (maybe via an option?), but that is a 
change in semantics and I'm not sure if this problem really comes up that much.

-roger

Prof Brian Ripley wrote:
> I think the confusion here is over close(): that closes *and destroys* a 
> connection, so it no longer exists.
> 
> isOpen applies to existing connections: you cannot close but not destroy 
> them at R level, but C code can (and does).  You will see it in use in 
> the utils package.
> 
> 
> On Wed, 14 Nov 2007, Seth Falcon wrote:
> 
>> "Roger D. Peng" <rpeng at jhsph.edu> writes:
>>
>>> As far as I can tell, 'isOpen' cannot return FALSE in the case when 
>>> 'rw = ""'.
>>> If the connection has already been closed by 'close' or some other 
>>> function,
>>> then isOpen will produce an error.  The problem is that when isOpen 
>>> calls
>>> 'getConnection', the connection cannot be found and 'getConnection' 
>>> produces an
>>> error.  The check to see if it is open is never actually done.
>>
>> I see this too with R-devel (r43376) {from Nov 6th}.
>>
>>    con = file("example1", "w")
>>    isOpen(con)
>>
>>    [1] TRUE
>>
>>    showConnections()
>>
>>      description class  mode text   isopen   can read can write
>>    3 "example1"  "file" "w"  "text" "opened" "no"     "yes"
>>
>>    close(con)
>>    isOpen(con)
>>
>>    Error in isOpen(con) : invalid connection
>>
>>    ## printing also fails
>>    con
>>    Error in summary.connection(x) : invalid connection
>>
>>> This came up in some code where I'm trying to clean up connections after
>>> successfully opening them.  The problem is that if I try to close a 
>>> connection
>>> that has already been closed, I get an error (because 'getConnection' 
>>> cannot
>>> find it).  But then there's no way for me to find out if a connection 
>>> has
>>> already been closed.  Perhaps there's another approach I should be 
>>> taking?  The
>>> context is basically,
>>>
>>> con <- file("foo", "w")
>>>
>>> tryCatch({
>>>     ## Do stuff that might fail
>>>     writeLines(stuff, con)
>>>     close(con)
>>>
>>>     file.copy("foo", "bar")
>>> }, finally = {
>>>     close(con)
>>> })
>>
>> This doesn't address isOpen, but why do you have the call to close
>> inside the tryCatch block?  Isn't the idea that finally will always be
>> run and so you can be reasonably sure that close gets called once?
>>
>> If your real world code is more complicated, perhaps you can make use
>> of a work around like:
>>
>> myIsOpen = function(con) tryCatch(isOpen(con), error=function(e) FALSE)
>>
>> You could do similar with myClose and "close" a connection as many
>> times as you'd like :-)
>>
>> + seth
>>
>>
> 

-- 
Roger D. Peng  |  http://www.biostat.jhsph.edu/~rpeng/


From ripley at stats.ox.ac.uk  Thu Nov 15 14:27:03 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 15 Nov 2007 13:27:03 +0000 (GMT)
Subject: [Rd] slots of type "double"
In-Reply-To: <18235.27481.789824.663953@stat.math.ethz.ch>
References: <1194942985.4739620919f16@webmail.fhcrc.org>
	<2BBF01A3-5F39-4750-B42E-12605674F49E@r-project.org>
	<Pine.LNX.4.64.0711131448370.9317@gannet.stats.ox.ac.uk>
	<4739E8F3.5040302@r-project.org>
	<Pine.LNX.4.64.0711131816130.11720@gannet.stats.ox.ac.uk>
	<Pine.LNX.4.64.0711140746220.11794@gannet.stats.ox.ac.uk>
	<51526.147.88.200.209.1195046592.squirrel@webmail.stat.ethz.ch>
	<18235.27481.789824.663953@stat.math.ethz.ch>
Message-ID: <Pine.LNX.4.64.0711142147280.1433@gannet.stats.ox.ac.uk>

In-line omments near the end:

On Wed, 14 Nov 2007, Martin Maechler wrote:

> still found a bit time for more remarks.
>
>>>>>> "MM" == Martin M?chler <maechler at stat.math.ethz.ch>
>>>>>>     on Wed, 14 Nov 2007 14:23:12 +0100 (CET) writes:
>
>    MM> On Wed, November 14, 2007 09:09, Prof Brian Ripley
>    MM> wrote:
>    >> On Tue, 13 Nov 2007, Prof Brian Ripley wrote:
>    >>
>    >>> On Tue, 13 Nov 2007, John Chambers wrote:
>    >>>
>    >>>> What's the proposal here?  To eliminate "double" as a
>    >>>> class?  No objection
>    >>>
>    >>> Eliminate "double" and "single".
>    >>>
>    >>>> from this corner.  As I remember, it was put in early
>    >>>> in the implementation of methods, when I was confused
>    >>>> about what R intended in this area (well, I'm not
>    >>>> totally unconfused even now).
>    >>>>
>    >>>> If this is the proposal, we could implement it in
>    >>>> r-devel and see if there are complaints.
>    >>>
>    >>> I was going to propose so after running some tests over
>    >>> CRAN/BioC (which will take a few hours).
>    >>
>    >> Which showed up problems in packages Matrix and matlab.
>
>
>    >> Matrix clearly has a different view of these classes:
>    >>
>    >> ## "atomic vectors" (-> ?is.atomic ) -- ##
>    >> --------------- those that we want to convert from
>    >> old-style "matrix" setClassUnion("atomicVector", ##
>    >> numeric = {integer, double} but all 3 should *directly*
>    >> be atomic members = c("logical", "integer", "double",
>    >> "numeric", "complex", "raw", "character"))
>    >>
>    >> If I remove "double" there, I get an error in an example:
>    >>
>    >>> stopifnot(is(scm, "sparseVector"),
>    >> + identical(cm, as.numeric(scm))) Error in as(x at x, mode)
>    >> : no method or default for coercing "numeric" to "double"
>    >>
>    >> and looking at the code suggests that "double" is used as
>    >> the class name in several places.
>
> yes.
> As you mention and I had in the comment above,
> I've worked from the premise of something like a class union of
>
> numeric = {integer, double}
>
> -- which corresponds to S3's    is.numeric()  which we all know
>   differs from the semantic of as.numeric()

(It predates S3 classes, being in the Blue Book.  And what as.numeric does 
in R differs from the Blue Book description, although for a long time the 
R help gave the BB version.  But S also differs, at least in recent 
years.)

> and now know why I had done so {empty lines deleted}:
>
>  > showClass("numeric")
>  No Slots, prototype of class "numeric"
>  Extends: "vector"
>  Known Subclasses: "double", "integer"
>
>  > showClass("double")
>  No Slots, prototype of class "numeric"
>  Extends: "vector", "numeric"
>
>  > showClass("integer")
>  No Slots, prototype of class "integer"
>  Extends: "vector", "numeric"
>
> which you partially also mentioned in your initial posting.

(I posted output from getClass, as showClass is not in the Green Book, 
although I actually used showClass first.)

> As a 2nd thought I wonder if we should not keep this current
> scheme and fix its behavior where needed (the problem the OP had):
> The notion of   numeric := union(double, integer)
> does now appeal to me again;

I don't believe we can get from here to there without massive upheaval. 
"numeric" is not a virtual class, and making "double" the basic class and 
"numeric" a virtual one would break tons of code (and writeups).

> in particular since eliminating "double"  in the S4 world  will
> not eliminate it from other places, and the basic problem of
> is.numeric / as.numeric  inconsistency is - I think - not
> something we'd want to eliminate, just because it would break too
> much existing code (and books on S and R).

(I do wonder if any of those books do get to that level of detail, and if 
they do what system they describe, given the divergence from the Blue 
Book.  I checked that the VR ones do not. I tend to agree with the BB 
comment that the storage type only matters in external interfaces, 
although that perhaps undervalues +/-Inf which may not have been 
available back then.)

I may be wrong, but I believe class "double" does not exist in the (strict 
sense) S4 world: it was certainly not in S-PLUS 6.2.

With a clean-sheet design we might well do things differently, and I think 
it would be possible for Matrix to make use of a class union of "numeric" 
and "integer".  But the name "numeric" is already taken and we are going 
to have to live with three names [*] for the same concept, and setting S3 
methods on as.double and S4 ones on as.numeric (because it would be too 
painful to change either).

Brian

[*] numeric, double, real.  My proposal to remove 'real' met with 
objections.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From simon.urbanek at r-project.org  Thu Nov 15 15:57:23 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 15 Nov 2007 09:57:23 -0500
Subject: [Rd] faqs
In-Reply-To: <971536df0711142055t652a618jbac4b5f23af48652@mail.gmail.com>
References: <D4F43809-6D74-4FA4-92AB-0A9248072A1A@ysidro.econ.uiuc.edu>
	<971536df0711141753r5753c3c5i6faf438bd65ebc03@mail.gmail.com>
	<473BB9E1.4020001@stats.uwo.ca>
	<971536df0711142055t652a618jbac4b5f23af48652@mail.gmail.com>
Message-ID: <4ACB4F00-5E33-4ADD-B6BD-80324ACAAFCA@r-project.org>


On Nov 14, 2007, at 11:55 PM, Gabor Grothendieck wrote:

> inst/NEWS would have the advantage of consistency with R itself  
> which also has a NEWS file.
>

I vote for NEWS for reasons above plus because that's what I use in my  
packages already ;).
IMHO it should be installed automatically if present, i.e. it  
shouldn't be necessary to have it in inst/NEWS, just plain NEWS should  
suffice.

Cheers,
Simon


>
> On Nov 14, 2007 10:15 PM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> On 14/11/2007 8:53 PM, Gabor Grothendieck wrote:
>>> Another possibility is to just place it at the end of the vignette.
>>> That is where it is in the proto package:
>>>
>>> http://cran.r-project.org/doc/vignettes/proto/proto.pdf
>>>
>>> Package documentation is already quite scattered and adding
>>> a faq() command would add just one more thing one has
>>> to do.  Here are some places one might look already for
>>> documentation:
>>>
>>> package?mypackage
>>
>> Or just ?mypackage.  Writing R Extensions recommends package? 
>> mypackage,
>> with ?mypackage also working if that name isn't taken.  However, the
>> advice is ignored more than it is followed.
>>
>>> vignette(...)
>>> library(help = mypackage)
>>> ?mycommand
>>> home page
>>> WISHLIST file
>>> NEWS file
>>> THANKS file
>>> svn log
>>>
>>> I personally would give a much higher priority to a standardized
>>> place to find change information.  Some packages provide it.
>>> Some don't which is very frustrating since you see a new version
>>> and have no idea what has changed.  If they do document it you
>>> often have to download the source just to get at the change  
>>> information.
>>
>> Where do you put it?  I put it in inst/ChangeLog, which ends up
>> installed in the package root as ChangeLog.
>>
>> Whenever this has come up in the past, there have been several
>> proposals, but no consensus.  So, to encourage consensus, I've got a
>> proposal:
>>
>> Why don't we vote on a location, with every voter agreeing to  
>> follow the
>> majority?  The only condition I'd put on it is that it should be
>> something that gets installed, hence somewhere in inst, but I'd be  
>> happy
>> to change the name if ChangeLog doesn't win.
>>
>> My vote is for inst/ChangeLog.
>>
>> Duncan Murdoch
>>
>>
>>>
>>>
>>>
>>> On Nov 14, 2007 8:22 PM, roger koenker  
>>> <roger at ysidro.econ.uiuc.edu> wrote:
>>>> An extremely modest proposal:
>>>>
>>>> It would be nice if packages could have a FAQ and if
>>>>
>>>>       faq(package.name)
>>>>
>>>> would produce this faq.  And if, by default
>>>>
>>>>       faq()
>>>>       FAQ()
>>>>
>>>> would produce the admirable R faq...  Apologies in advance
>>>> if there is already a mechanism like this, but help.search()
>>>> didn't reveal anything.
>>>>
>>>> url:    www.econ.uiuc.edu/~roger                Roger Koenker
>>>> email   rkoenker at uiuc.edu                       Department of  
>>>> Economics
>>>> vox:    217-333-4558                            University of  
>>>> Illinois
>>>> fax:    217-244-6678                            Champaign, IL 61820
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From murdoch at stats.uwo.ca  Thu Nov 15 16:53:28 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 15 Nov 2007 10:53:28 -0500
Subject: [Rd] NEWS file (was  faqs)
In-Reply-To: <4ACB4F00-5E33-4ADD-B6BD-80324ACAAFCA@r-project.org>
References: <D4F43809-6D74-4FA4-92AB-0A9248072A1A@ysidro.econ.uiuc.edu>
	<971536df0711141753r5753c3c5i6faf438bd65ebc03@mail.gmail.com>
	<473BB9E1.4020001@stats.uwo.ca>
	<971536df0711142055t652a618jbac4b5f23af48652@mail.gmail.com>
	<4ACB4F00-5E33-4ADD-B6BD-80324ACAAFCA@r-project.org>
Message-ID: <473C6B78.5090605@stats.uwo.ca>

On 11/15/2007 9:57 AM, Simon Urbanek wrote:
> On Nov 14, 2007, at 11:55 PM, Gabor Grothendieck wrote:
> 
>> inst/NEWS would have the advantage of consistency with R itself  
>> which also has a NEWS file.
>>
> 
> I vote for NEWS for reasons above plus because that's what I use in my  
> packages already ;).
> IMHO it should be installed automatically if present, i.e. it  
> shouldn't be necessary to have it in inst/NEWS, just plain NEWS should  
> suffice.

And you're volunteering to make that change?

Duncan

> 
> Cheers,
> Simon
> 
> 
>>
>> On Nov 14, 2007 10:15 PM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>>> On 14/11/2007 8:53 PM, Gabor Grothendieck wrote:
>>>> Another possibility is to just place it at the end of the vignette.
>>>> That is where it is in the proto package:
>>>>
>>>> http://cran.r-project.org/doc/vignettes/proto/proto.pdf
>>>>
>>>> Package documentation is already quite scattered and adding
>>>> a faq() command would add just one more thing one has
>>>> to do.  Here are some places one might look already for
>>>> documentation:
>>>>
>>>> package?mypackage
>>>
>>> Or just ?mypackage.  Writing R Extensions recommends package? 
>>> mypackage,
>>> with ?mypackage also working if that name isn't taken.  However, the
>>> advice is ignored more than it is followed.
>>>
>>>> vignette(...)
>>>> library(help = mypackage)
>>>> ?mycommand
>>>> home page
>>>> WISHLIST file
>>>> NEWS file
>>>> THANKS file
>>>> svn log
>>>>
>>>> I personally would give a much higher priority to a standardized
>>>> place to find change information.  Some packages provide it.
>>>> Some don't which is very frustrating since you see a new version
>>>> and have no idea what has changed.  If they do document it you
>>>> often have to download the source just to get at the change  
>>>> information.
>>>
>>> Where do you put it?  I put it in inst/ChangeLog, which ends up
>>> installed in the package root as ChangeLog.
>>>
>>> Whenever this has come up in the past, there have been several
>>> proposals, but no consensus.  So, to encourage consensus, I've got a
>>> proposal:
>>>
>>> Why don't we vote on a location, with every voter agreeing to  
>>> follow the
>>> majority?  The only condition I'd put on it is that it should be
>>> something that gets installed, hence somewhere in inst, but I'd be  
>>> happy
>>> to change the name if ChangeLog doesn't win.
>>>
>>> My vote is for inst/ChangeLog.
>>>
>>> Duncan Murdoch
>>>
>>>
>>>>
>>>>
>>>>
>>>> On Nov 14, 2007 8:22 PM, roger koenker  
>>>> <roger at ysidro.econ.uiuc.edu> wrote:
>>>>> An extremely modest proposal:
>>>>>
>>>>> It would be nice if packages could have a FAQ and if
>>>>>
>>>>>       faq(package.name)
>>>>>
>>>>> would produce this faq.  And if, by default
>>>>>
>>>>>       faq()
>>>>>       FAQ()
>>>>>
>>>>> would produce the admirable R faq...  Apologies in advance
>>>>> if there is already a mechanism like this, but help.search()
>>>>> didn't reveal anything.
>>>>>
>>>>> url:    www.econ.uiuc.edu/~roger                Roger Koenker
>>>>> email   rkoenker at uiuc.edu                       Department of  
>>>>> Economics
>>>>> vox:    217-333-4558                            University of  
>>>>> Illinois
>>>>> fax:    217-244-6678                            Champaign, IL 61820
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>


From simon.urbanek at r-project.org  Thu Nov 15 17:30:01 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 15 Nov 2007 11:30:01 -0500
Subject: [Rd] NEWS file (was  faqs)
In-Reply-To: <473C6B78.5090605@stats.uwo.ca>
References: <D4F43809-6D74-4FA4-92AB-0A9248072A1A@ysidro.econ.uiuc.edu>
	<971536df0711141753r5753c3c5i6faf438bd65ebc03@mail.gmail.com>
	<473BB9E1.4020001@stats.uwo.ca>
	<971536df0711142055t652a618jbac4b5f23af48652@mail.gmail.com>
	<4ACB4F00-5E33-4ADD-B6BD-80324ACAAFCA@r-project.org>
	<473C6B78.5090605@stats.uwo.ca>
Message-ID: <80BEBDD4-6222-499D-A9E8-AC091DC91278@r-project.org>


On Nov 15, 2007, at 10:53 AM, Duncan Murdoch wrote:

> On 11/15/2007 9:57 AM, Simon Urbanek wrote:
>> On Nov 14, 2007, at 11:55 PM, Gabor Grothendieck wrote:
>>> inst/NEWS would have the advantage of consistency with R itself   
>>> which also has a NEWS file.
>>>
>> I vote for NEWS for reasons above plus because that's what I use in  
>> my  packages already ;).
>> IMHO it should be installed automatically if present, i.e. it   
>> shouldn't be necessary to have it in inst/NEWS, just plain NEWS  
>> should  suffice.
>
> And you're volunteering to make that change?
>

Yup, in R-devel now (43464). However, there are other candidate files  
as well and we don't do anything with the NEWS file just yet ... any  
further ideas?

Cheers,
Simon

>
>> Cheers,
>> Simon
>>>
>>> On Nov 14, 2007 10:15 PM, Duncan Murdoch <murdoch at stats.uwo.ca>  
>>> wrote:
>>>> On 14/11/2007 8:53 PM, Gabor Grothendieck wrote:
>>>>> Another possibility is to just place it at the end of the  
>>>>> vignette.
>>>>> That is where it is in the proto package:
>>>>>
>>>>> http://cran.r-project.org/doc/vignettes/proto/proto.pdf
>>>>>
>>>>> Package documentation is already quite scattered and adding
>>>>> a faq() command would add just one more thing one has
>>>>> to do.  Here are some places one might look already for
>>>>> documentation:
>>>>>
>>>>> package?mypackage
>>>>
>>>> Or just ?mypackage.  Writing R Extensions recommends package?  
>>>> mypackage,
>>>> with ?mypackage also working if that name isn't taken.  However,  
>>>> the
>>>> advice is ignored more than it is followed.
>>>>
>>>>> vignette(...)
>>>>> library(help = mypackage)
>>>>> ?mycommand
>>>>> home page
>>>>> WISHLIST file
>>>>> NEWS file
>>>>> THANKS file
>>>>> svn log
>>>>>
>>>>> I personally would give a much higher priority to a standardized
>>>>> place to find change information.  Some packages provide it.
>>>>> Some don't which is very frustrating since you see a new version
>>>>> and have no idea what has changed.  If they do document it you
>>>>> often have to download the source just to get at the change   
>>>>> information.
>>>>
>>>> Where do you put it?  I put it in inst/ChangeLog, which ends up
>>>> installed in the package root as ChangeLog.
>>>>
>>>> Whenever this has come up in the past, there have been several
>>>> proposals, but no consensus.  So, to encourage consensus, I've  
>>>> got a
>>>> proposal:
>>>>
>>>> Why don't we vote on a location, with every voter agreeing to   
>>>> follow the
>>>> majority?  The only condition I'd put on it is that it should be
>>>> something that gets installed, hence somewhere in inst, but I'd  
>>>> be  happy
>>>> to change the name if ChangeLog doesn't win.
>>>>
>>>> My vote is for inst/ChangeLog.
>>>>
>>>> Duncan Murdoch
>>>>
>>>>
>>>>>
>>>>>
>>>>>
>>>>> On Nov 14, 2007 8:22 PM, roger koenker  <roger at ysidro.econ.uiuc.edu 
>>>>> > wrote:
>>>>>> An extremely modest proposal:
>>>>>>
>>>>>> It would be nice if packages could have a FAQ and if
>>>>>>
>>>>>>      faq(package.name)
>>>>>>
>>>>>> would produce this faq.  And if, by default
>>>>>>
>>>>>>      faq()
>>>>>>      FAQ()
>>>>>>
>>>>>> would produce the admirable R faq...  Apologies in advance
>>>>>> if there is already a mechanism like this, but help.search()
>>>>>> didn't reveal anything.
>>>>>>
>>>>>> url:    www.econ.uiuc.edu/~roger                Roger Koenker
>>>>>> email   rkoenker at uiuc.edu                       Department of   
>>>>>> Economics
>>>>>> vox:    217-333-4558                            University of   
>>>>>> Illinois
>>>>>> fax:    217-244-6678                            Champaign, IL  
>>>>>> 61820
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>
>


From ggrothendieck at gmail.com  Thu Nov 15 16:51:46 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 15 Nov 2007 10:51:46 -0500
Subject: [Rd] faqs
In-Reply-To: <4ACB4F00-5E33-4ADD-B6BD-80324ACAAFCA@r-project.org>
References: <D4F43809-6D74-4FA4-92AB-0A9248072A1A@ysidro.econ.uiuc.edu>
	<971536df0711141753r5753c3c5i6faf438bd65ebc03@mail.gmail.com>
	<473BB9E1.4020001@stats.uwo.ca>
	<971536df0711142055t652a618jbac4b5f23af48652@mail.gmail.com>
	<4ACB4F00-5E33-4ADD-B6BD-80324ACAAFCA@r-project.org>
Message-ID: <971536df0711150751i61a60bc8y8074eb0796c7b483@mail.gmail.com>

On Nov 15, 2007 9:57 AM, Simon Urbanek <simon.urbanek at r-project.org> wrote:
>
> On Nov 14, 2007, at 11:55 PM, Gabor Grothendieck wrote:
>
> > inst/NEWS would have the advantage of consistency with R itself
> > which also has a NEWS file.
> >
>
> I vote for NEWS for reasons above plus because that's what I use in my
> packages already ;).
> IMHO it should be installed automatically if present, i.e. it
> shouldn't be necessary to have it in inst/NEWS, just plain NEWS should
> suffice.
>

I agree that that would be desirable.


From Mark.Bravington at csiro.au  Thu Nov 15 22:52:52 2007
From: Mark.Bravington at csiro.au (Mark.Bravington at csiro.au)
Date: Fri, 16 Nov 2007 08:52:52 +1100
Subject: [Rd] isOpen on closed connections
References: <473B0739.3090507@jhsph.edu>
	<m2hcjoksd6.fsf@userprimary.net><Pine.LNX.4.64.0711150714150.11152@gannet.stats.ox.ac.uk>
	<473C4012.3030909@jhsph.edu>
Message-ID: <D79013E40FEF254AAF0D72DFC94F2748545CCE@extas4-hba.tas.csiro.au>

I'd support a change, to having a closed-but-not-invalid status for a
'rw' connection, and to have a usable 'isOpen'. The suggestion of
relying on user-code to always "housekeep" after calling 'close', eg by
setting to NULL, seems a bit risky as a guideline for R as a whole (one
can never tell what convention a different author's code might follow).
And the 'myOpen' solution will work (I'm about to use it myself) but
cumbersome if everyone has to do it. With things as they are, I can
foresee a stream of "why does.../RTFM" emails...

Perhaps the more fundamental issue is whether 'getConnection' should
actually throw an error. 
I'm getting bitten by this in R 2.6.1-- I use 'getConnection' in an
'on.exit' statement (where I can't be sure of the state of the
connection), and it's throwing an error instead of returning NULL as it
used to (and as the documentation still states).

-- 
Mark Bravington
CSIRO Mathematical & Information Sciences
Marine Laboratory
Castray Esplanade
Hobart 7001
TAS

ph (+61) 3 6232 5118
fax (+61) 3 6232 5012
mob (+61) 438 315 623
 

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Roger D. Peng
> Sent: Thursday, 15 November 2007 11:48 PM
> To: Prof Brian Ripley
> Cc: R-devel mailing list
> Subject: Re: [Rd] isOpen on closed connections
> 
> Upon further consideration, I realized there is a 
> philosophical element here---if a connection is closed and 
> hence does not exist, is it open?
> 
> The practical issue for me is that when you do something like
> 
> close(con)
> 
> the 'con' object is still lying around and is essentially 
> undefined.  For example, if I do
> 
> close(con)
> con <- "hello"
> 
> then it seems logical to me that 'isOpen' would return an 
> error.  But it feels natural to me that a sequence like
> 
> close(con)
> isOpen(con)  ## FALSE?
> 
> would not lead to an error.  Perhaps my expectations are not 
> reasonable and I'd appreciate being corrected.
> 
> Given Brian's comment, one solution would be to allowing 
> closing but not destroying connections at the R level (maybe 
> via an option?), but that is a change in semantics and I'm 
> not sure if this problem really comes up that much.
> 
> -roger
> 
> Prof Brian Ripley wrote:
> > I think the confusion here is over close(): that closes 
> *and destroys* 
> > a connection, so it no longer exists.
> > 
> > isOpen applies to existing connections: you cannot close but not 
> > destroy them at R level, but C code can (and does).  You 
> will see it 
> > in use in the utils package.
> > 
> > 
> > On Wed, 14 Nov 2007, Seth Falcon wrote:
> > 
> >> "Roger D. Peng" <rpeng at jhsph.edu> writes:
> >>
> >>> As far as I can tell, 'isOpen' cannot return FALSE in the 
> case when 
> >>> 'rw = ""'.
> >>> If the connection has already been closed by 'close' or 
> some other 
> >>> function, then isOpen will produce an error.  The problem is that 
> >>> when isOpen calls 'getConnection', the connection cannot be found 
> >>> and 'getConnection'
> >>> produces an
> >>> error.  The check to see if it is open is never actually done.
> >>
> >> I see this too with R-devel (r43376) {from Nov 6th}.
> >>
> >>    con = file("example1", "w")
> >>    isOpen(con)
> >>
> >>    [1] TRUE
> >>
> >>    showConnections()
> >>
> >>      description class  mode text   isopen   can read can write
> >>    3 "example1"  "file" "w"  "text" "opened" "no"     "yes"
> >>
> >>    close(con)
> >>    isOpen(con)
> >>
> >>    Error in isOpen(con) : invalid connection
> >>
> >>    ## printing also fails
> >>    con
> >>    Error in summary.connection(x) : invalid connection
> >>
> >>> This came up in some code where I'm trying to clean up 
> connections 
> >>> after successfully opening them.  The problem is that if I try to 
> >>> close a connection that has already been closed, I get an error 
> >>> (because 'getConnection'
> >>> cannot
> >>> find it).  But then there's no way for me to find out if a 
> >>> connection has already been closed.  Perhaps there's another 
> >>> approach I should be taking?  The context is basically,
> >>>
> >>> con <- file("foo", "w")
> >>>
> >>> tryCatch({
> >>>     ## Do stuff that might fail
> >>>     writeLines(stuff, con)
> >>>     close(con)
> >>>
> >>>     file.copy("foo", "bar")
> >>> }, finally = {
> >>>     close(con)
> >>> })
> >>
> >> This doesn't address isOpen, but why do you have the call to close 
> >> inside the tryCatch block?  Isn't the idea that finally 
> will always 
> >> be run and so you can be reasonably sure that close gets 
> called once?
> >>
> >> If your real world code is more complicated, perhaps you 
> can make use 
> >> of a work around like:
> >>
> >> myIsOpen = function(con) tryCatch(isOpen(con), error=function(e) 
> >> FALSE)
> >>
> >> You could do similar with myClose and "close" a connection as many 
> >> times as you'd like :-)
> >>
> >> + seth
> >>
> >>
> > 
> 
> --
> Roger D. Peng  |  http://www.biostat.jhsph.edu/~rpeng/
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From statmobile at gmail.com  Thu Nov 15 23:10:14 2007
From: statmobile at gmail.com (statmobile at gmail.com)
Date: Thu, 15 Nov 2007 17:10:14 -0500
Subject: [Rd] Nested SEXP functions
Message-ID: <20071115221014.GA5576@bjl>

Hey All,

I was wondering if I could solicit a little advice.  I have been
experiencing some quirkiness in my C code through .Call.
Unfortunately, my program is rather large, so I'm trying to create a
brief example.  Yet before I do, I thought maybe a conceptual question
would be sufficient.

Basically, I'm writing up a multidimensional Gaussian likelihood (with
spatial covariances and other enhancements).  What I'm noticing is
that when I have nested SEXP functions I get inconsistent results.

Here is what I am essentially trying to accomplish when looking at the
Gaussian kernel:

l(beta) = (y-X*beta)^T V^{-1} (y-X*beta)

Now in order to accomplish this, I wrote various linear algebra
subroutines to handle the R objects, we'll call this:

SEXP XtimesY(SEXP X,SEXP Y); // X*Y
SEXP XminusY(SEXP X,SEXP Y); // X-Y
SEXP tX(SEXP X); // X^T
SEXP mycholinv(SEXP V); // Use cholesky decomposition for inverse

Now, what I'm noticing is that if I call each routine individually
such as:

pt1=XtimesY(X,beta); // X*beta
pt2=Xminus(Y,pt1); // Y-X*beta
pt3=tX(pt2); // (Y-X*beta)^T
pt4=mycholinv(V); //V^{-1}
pt5=XtimesY(pt2,pt4); // (Y-X*beta)^T V^{-1}
result=XtimesY(pt5,pt2); //(y-X*beta)^T V^{-1} (y-X*beta)

Then the result is correct.  But if instead I want to save some lines
of code, and I use:

result=XtimesY(XtimesY(tX(XminusY(Y,XtimesY(X,beta))),mycholinv(V)),XminusY(Y,XtimesY(X,beta)))

I don't always get the same result.  Now my question is, should I
expect weird and ugly things to happen when nesting SEXP functions
such as this?  Or is it even highly discouraged in general in C to do
something like this?

If this should work, then I'll need to go through each one of the
functions and try to diagnose where the problem lies.  Yet if it
shouldn't work, I'll stick with the first approach I have going now.

Thanks in advance for your input!


From osklyar at ebi.ac.uk  Fri Nov 16 00:53:53 2007
From: osklyar at ebi.ac.uk (Oleg Sklyar)
Date: Thu, 15 Nov 2007 23:53:53 +0000
Subject: [Rd] Nested SEXP functions
In-Reply-To: <20071115221014.GA5576@bjl>
References: <20071115221014.GA5576@bjl>
Message-ID: <1195170833.9317.12.camel@carbon>

You assume that when you call any of those functions its arguments are
protected (as it is the case when the function is called from within R).
However, I do not see why they would be if you do not do it explicitly.
Therefore, it is very likely that a result of one function, used in turn
in a call to the other one, is garbage collected on the way and what you
get can be totally wrong. The more R API calls you have within each of
those functions, the more likely it is that the unprotected argument is
garbage collected as the events are triggered within some of those
calls.

One should be very careful about protecting things in .Call interface.
Now here is what I mean in a coding example:

## R CODE #####
z1 = .Call("interfaceCFun1", as.numeric(x)) # OK
z2 = .Call("interfaceCFun12", as.numeric(x)) # Can be !OK

SEXP f1(SEXP);

// C code
SEXP interfaceCFun(SEXP x) {
  / /x is protected, so it prints smth and returns new var to R
  return f1(x);
}
SEXP interfaceCFun2(SEXP x) {
  // for first call to f1 it prints smth of x and returns new var
  // to the second call, however in the second call the argument is no
  // more x, it is no more protected and can be released by GC, so it is
  // no clear what it is going to print there!
  return f1(f1(x));

  // this would be correct:
  SEXP y;
  PROTECT(y=f1(x));
  // now when we print in the following function we have memory
protected
  y = f1(y)
  UNPROTECT(1);
  return y;
}

SEXP f1(SEXP x) {
  Rprintf("\n"); // can possibly trigger garbage collector
  Rprintf(REAL(x)[0]);
  return allocVector(REALSXP,2);
}

Best,

 Oleg


On Thu, 2007-11-15 at 17:10 -0500, statmobile at gmail.com wrote:
> Hey All,
> 
> I was wondering if I could solicit a little advice.  I have been
> experiencing some quirkiness in my C code through .Call.
> Unfortunately, my program is rather large, so I'm trying to create a
> brief example.  Yet before I do, I thought maybe a conceptual question
> would be sufficient.
> 
> Basically, I'm writing up a multidimensional Gaussian likelihood (with
> spatial covariances and other enhancements).  What I'm noticing is
> that when I have nested SEXP functions I get inconsistent results.
> 
> Here is what I am essentially trying to accomplish when looking at the
> Gaussian kernel:
> 
> l(beta) = (y-X*beta)^T V^{-1} (y-X*beta)
> 
> Now in order to accomplish this, I wrote various linear algebra
> subroutines to handle the R objects, we'll call this:
> 
> SEXP XtimesY(SEXP X,SEXP Y); // X*Y
> SEXP XminusY(SEXP X,SEXP Y); // X-Y
> SEXP tX(SEXP X); // X^T
> SEXP mycholinv(SEXP V); // Use cholesky decomposition for inverse
> 
> Now, what I'm noticing is that if I call each routine individually
> such as:
> 
> pt1=XtimesY(X,beta); // X*beta
> pt2=Xminus(Y,pt1); // Y-X*beta
> pt3=tX(pt2); // (Y-X*beta)^T
> pt4=mycholinv(V); //V^{-1}
> pt5=XtimesY(pt2,pt4); // (Y-X*beta)^T V^{-1}
> result=XtimesY(pt5,pt2); //(y-X*beta)^T V^{-1} (y-X*beta)
> 
> Then the result is correct.  But if instead I want to save some lines
> of code, and I use:
> 
> result=XtimesY(XtimesY(tX(XminusY(Y,XtimesY(X,beta))),mycholinv(V)),XminusY(Y,XtimesY(X,beta)))
> 
> I don't always get the same result.  Now my question is, should I
> expect weird and ugly things to happen when nesting SEXP functions
> such as this?  Or is it even highly discouraged in general in C to do
> something like this?
> 
> If this should work, then I'll need to go through each one of the
> functions and try to diagnose where the problem lies.  Yet if it
> shouldn't work, I'll stick with the first approach I have going now.
> 
> Thanks in advance for your input!
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From statmobile at gmail.com  Fri Nov 16 03:16:38 2007
From: statmobile at gmail.com (statmobile at gmail.com)
Date: Thu, 15 Nov 2007 21:16:38 -0500
Subject: [Rd] Nested SEXP functions
In-Reply-To: <1195170833.9317.12.camel@carbon>
References: <20071115221014.GA5576@bjl> <1195170833.9317.12.camel@carbon>
Message-ID: <20071116021637.GA6389@bjl>

On Thu, Nov 15, 2007 at 11:53:53PM +0000, Oleg Sklyar wrote:
> You assume that when you call any of those functions its arguments are
> protected (as it is the case when the function is called from within R).
> However, I do not see why they would be if you do not do it explicitly.
> Therefore, it is very likely that a result of one function, used in turn
> in a call to the other one, is garbage collected on the way and what you
> get can be totally wrong. The more R API calls you have within each of
> those functions, the more likely it is that the unprotected argument is
> garbage collected as the events are triggered within some of those
> calls.
> 
> One should be very careful about protecting things in .Call interface.
> Now here is what I mean in a coding example:

Oleg,

Ah Ha!!!  I was sure that I protected everything within each one of
the modular functions, so I couldn't understand why my results were
similar to a garbage collection issue.  That is, on small examples I
would get the right result, but on large data it would keep failing
with wild numbers.

What you say makes complete sense, and is completely consistent with
the documentation.  I appreciate the examples and how they emphasize
your point, and I'm even more grateful that you saved me the effort of
having to write sample code to ask my question.

After reading your advice, I just realized something.  Instead of
doing this all within my main program, I could reduce the annoying
steps in my main code by writing the Gaussian kernel as another
modular function.  It would essentially accomplish the same goal!

Thanks!



> 
> ## R CODE #####
> z1 = .Call("interfaceCFun1", as.numeric(x)) # OK
> z2 = .Call("interfaceCFun12", as.numeric(x)) # Can be !OK
> 
> SEXP f1(SEXP);
> 
> // C code
> SEXP interfaceCFun(SEXP x) {
>   / /x is protected, so it prints smth and returns new var to R
>   return f1(x);
> }
> SEXP interfaceCFun2(SEXP x) {
>   // for first call to f1 it prints smth of x and returns new var
>   // to the second call, however in the second call the argument is no
>   // more x, it is no more protected and can be released by GC, so it is
>   // no clear what it is going to print there!
>   return f1(f1(x));
> 
>   // this would be correct:
>   SEXP y;
>   PROTECT(y=f1(x));
>   // now when we print in the following function we have memory
> protected
>   y = f1(y)
>   UNPROTECT(1);
>   return y;
> }
> 
> SEXP f1(SEXP x) {
>   Rprintf("\n"); // can possibly trigger garbage collector
>   Rprintf(REAL(x)[0]);
>   return allocVector(REALSXP,2);
> }
> 
> Best,
> 
>  Oleg
> 
> 
> On Thu, 2007-11-15 at 17:10 -0500, statmobile at gmail.com wrote:
> > Hey All,
> > 
> > I was wondering if I could solicit a little advice.  I have been
> > experiencing some quirkiness in my C code through .Call.
> > Unfortunately, my program is rather large, so I'm trying to create a
> > brief example.  Yet before I do, I thought maybe a conceptual question
> > would be sufficient.
> > 
> > Basically, I'm writing up a multidimensional Gaussian likelihood (with
> > spatial covariances and other enhancements).  What I'm noticing is
> > that when I have nested SEXP functions I get inconsistent results.
> > 
> > Here is what I am essentially trying to accomplish when looking at the
> > Gaussian kernel:
> > 
> > l(beta) = (y-X*beta)^T V^{-1} (y-X*beta)
> > 
> > Now in order to accomplish this, I wrote various linear algebra
> > subroutines to handle the R objects, we'll call this:
> > 
> > SEXP XtimesY(SEXP X,SEXP Y); // X*Y
> > SEXP XminusY(SEXP X,SEXP Y); // X-Y
> > SEXP tX(SEXP X); // X^T
> > SEXP mycholinv(SEXP V); // Use cholesky decomposition for inverse
> > 
> > Now, what I'm noticing is that if I call each routine individually
> > such as:
> > 
> > pt1=XtimesY(X,beta); // X*beta
> > pt2=Xminus(Y,pt1); // Y-X*beta
> > pt3=tX(pt2); // (Y-X*beta)^T
> > pt4=mycholinv(V); //V^{-1}
> > pt5=XtimesY(pt2,pt4); // (Y-X*beta)^T V^{-1}
> > result=XtimesY(pt5,pt2); //(y-X*beta)^T V^{-1} (y-X*beta)
> > 
> > Then the result is correct.  But if instead I want to save some lines
> > of code, and I use:
> > 
> > result=XtimesY(XtimesY(tX(XminusY(Y,XtimesY(X,beta))),mycholinv(V)),XminusY(Y,XtimesY(X,beta)))
> > 
> > I don't always get the same result.  Now my question is, should I
> > expect weird and ugly things to happen when nesting SEXP functions
> > such as this?  Or is it even highly discouraged in general in C to do
> > something like this?
> > 
> > If this should work, then I'll need to go through each one of the
> > functions and try to diagnose where the problem lies.  Yet if it
> > shouldn't work, I'll stick with the first approach I have going now.
> > 
> > Thanks in advance for your input!
> > 
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ripley at stats.ox.ac.uk  Fri Nov 16 11:20:36 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 16 Nov 2007 10:20:36 +0000 (GMT)
Subject: [Rd] NEWS file (was  faqs)
In-Reply-To: <80BEBDD4-6222-499D-A9E8-AC091DC91278@r-project.org>
References: <D4F43809-6D74-4FA4-92AB-0A9248072A1A@ysidro.econ.uiuc.edu>
	<971536df0711141753r5753c3c5i6faf438bd65ebc03@mail.gmail.com>
	<473BB9E1.4020001@stats.uwo.ca>
	<971536df0711142055t652a618jbac4b5f23af48652@mail.gmail.com>
	<4ACB4F00-5E33-4ADD-B6BD-80324ACAAFCA@r-project.org>
	<473C6B78.5090605@stats.uwo.ca>
	<80BEBDD4-6222-499D-A9E8-AC091DC91278@r-project.org>
Message-ID: <Pine.LNX.4.64.0711161011570.23566@auk.stats>

On Thu, 15 Nov 2007, Simon Urbanek wrote:

>
> On Nov 15, 2007, at 10:53 AM, Duncan Murdoch wrote:
>
>> On 11/15/2007 9:57 AM, Simon Urbanek wrote:
>>> On Nov 14, 2007, at 11:55 PM, Gabor Grothendieck wrote:
>>>> inst/NEWS would have the advantage of consistency with R itself
>>>> which also has a NEWS file.
>>>>
>>> I vote for NEWS for reasons above plus because that's what I use in
>>> my  packages already ;).
>>> IMHO it should be installed automatically if present, i.e. it
>>> shouldn't be necessary to have it in inst/NEWS, just plain NEWS
>>> should  suffice.
>>
>> And you're volunteering to make that change?
>>
>
> Yup, in R-devel now (43464). However, there are other candidate files
> as well and we don't do anything with the NEWS file just yet ... any
> further ideas?

We've recommended inst/NEWS for some time (some people are late to this 
party), and tens of packages have it. However, a further tens of packages 
have a top-level NEWS, and I would assume that (at least some of) the 
authors were deliberately not installing it and so will now need to rename 
it.

I think the writeup needs to make clear what happens if you have both NEWS 
and inst/NEWS (some packages do).

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From friedrich.leisch at stat.uni-muenchen.de  Fri Nov 16 11:43:54 2007
From: friedrich.leisch at stat.uni-muenchen.de (friedrich.leisch at stat.uni-muenchen.de)
Date: Fri, 16 Nov 2007 11:43:54 +0100
Subject: [Rd] NEWS file (was  faqs)
In-Reply-To: <Pine.LNX.4.64.0711161011570.23566@auk.stats>
References: <D4F43809-6D74-4FA4-92AB-0A9248072A1A@ysidro.econ.uiuc.edu>
	<971536df0711141753r5753c3c5i6faf438bd65ebc03@mail.gmail.com>
	<473BB9E1.4020001@stats.uwo.ca>
	<971536df0711142055t652a618jbac4b5f23af48652@mail.gmail.com>
	<4ACB4F00-5E33-4ADD-B6BD-80324ACAAFCA@r-project.org>
	<473C6B78.5090605@stats.uwo.ca>
	<80BEBDD4-6222-499D-A9E8-AC091DC91278@r-project.org>
	<Pine.LNX.4.64.0711161011570.23566@auk.stats>
Message-ID: <18237.29802.854939.260829@lxh5.stat.uni-muenchen.de>

>>>>> On Fri, 16 Nov 2007 10:20:36 +0000 (GMT),
>>>>> Prof Brian Ripley (PBR) wrote:

  > On Thu, 15 Nov 2007, Simon Urbanek wrote:
  >> 
  >> On Nov 15, 2007, at 10:53 AM, Duncan Murdoch wrote:
  >> 
  >>> On 11/15/2007 9:57 AM, Simon Urbanek wrote:
  >>>> On Nov 14, 2007, at 11:55 PM, Gabor Grothendieck wrote:
  >>>>> inst/NEWS would have the advantage of consistency with R itself
  >>>>> which also has a NEWS file.
  >>>>> 
  >>>> I vote for NEWS for reasons above plus because that's what I use in
  >>>> my  packages already ;).
  >>>> IMHO it should be installed automatically if present, i.e. it
  >>>> shouldn't be necessary to have it in inst/NEWS, just plain NEWS
  >>>> should  suffice.
  >>> 
  >>> And you're volunteering to make that change?
  >>> 
  >> 
  >> Yup, in R-devel now (43464). However, there are other candidate files
  >> as well and we don't do anything with the NEWS file just yet ... any
  >> further ideas?

  > We've recommended inst/NEWS for some time (some people are late to this 
  > party), and tens of packages have it. However, a further tens of packages 
  > have a top-level NEWS, and I would assume that (at least some of) the 
  > authors were deliberately not installing it and so will now need to rename 
  > it.

  > I think the writeup needs to make clear what happens if you have both NEWS 
  > and inst/NEWS (some packages do).

As most having both are by me I also checked the rest: In all cases
on CRAN they are identical copies. I have a soft link in all my
packages from inst/NEWS to top level (such that it gets installed, but
it is also easily found in the sources).

If we install the top-level NEWS file I would remove the link (but as
Brian said, we've been there before).

Best,
Fritz


From bolker at ufl.edu  Fri Nov 16 16:02:30 2007
From: bolker at ufl.edu (Ben Bolker)
Date: Fri, 16 Nov 2007 07:02:30 -0800 (PST)
Subject: [Rd] re sponses to issues on r-devel
Message-ID: <13752138.post@talk.nabble.com>



  I'm probably going to get in trouble for this, but ... 

  What is the best way to get 'important' issues resolved
by R-core?  There is a category of 'issues' (I won't call
them bugs or problems, although arguably they are so)
that appear on R-devel and sink without ever receiving an
explicit acknowledgment.  These problems tend to be:
 * non-trivial 
 * outside of the main current interests (perhaps) of R-core

  I'm thinking in this case of Petr Savicky's series of posts

http://www.nabble.com/bug-in-detection-of-zero-state-for-Mersenne-Twister-%28PR-10362%29-tf4670916.html#a13343487
http://www.nabble.com/initial-scrambling-of-seed-in-do_setseed---RNG_Init-tf4504008.html#a12845234
http://www.nabble.com/all-zeroes-in-Mersenne-Twister-state-may-remain-undetected-tf4626354.html#a13210502
http://www.nabble.com/predictable-bit-patterns-in-runif%28n%29-shortly-after-set.seed-tf4641681.html#a13257396

all between Sept 23 and October 15.   One of these was posted as a bug, but
the rest are just
"ideas".  However, they are very thoroughly documented ideas (with suggested
patches),
and it would be a shame if they fell between the cracks.  They might be on
R-core's "to do" list already  -- or
someone may have replied off-list -- or R-core might have read the posts and
decided
that they are not worth worrying about -- or R-core might go through the
archives
looking for these kinds of unresolved issues from time to time.

   Arguably the best solution to this kind of problem is just persistence by
the 'R-cortex' (OED:
 {dag}1. fig. The external part; the outer shell or husk. Obs.) [by which I
mean the people like
Petr who are capable of finding, diagnosing and creating useful patches],
re-posting
to R-devel every month or so if issues remain unresolved.  My *personal*
feeling
is that posting these kinds of issues as bugs, where they can be remembered
and dealt with,
is a good idea, but I'm prepared to be shouted down ...

  Is this a problem?  Is there a solution?

   (Please don't blame Petr for these comments, I'm just using his ideas as
an example)

   cheers
    Ben Bolker
-- 
View this message in context: http://www.nabble.com/responses-to-issues-on-r-devel-tf4806780.html#a13752138
Sent from the R devel mailing list archive at Nabble.com.


From dankoc at gmail.com  Fri Nov 16 21:49:09 2007
From: dankoc at gmail.com (Charles Danko)
Date: Fri, 16 Nov 2007 15:49:09 -0500
Subject: [Rd] Returning vectors of two different data types back to R
	environment (from C).
Message-ID: <8adccabf0711161249n763c3290o1ec4bab4bea1a104@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20071116/7fb141fd/attachment.pl 

From Roger.Bivand at nhh.no  Fri Nov 16 22:00:41 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 16 Nov 2007 22:00:41 +0100 (CET)
Subject: [Rd] Returning vectors of two different data types back to R
 environment (from C).
In-Reply-To: <8adccabf0711161249n763c3290o1ec4bab4bea1a104@mail.gmail.com>
References: <8adccabf0711161249n763c3290o1ec4bab4bea1a104@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0711162158560.9311@reclus.nhh.no>

On Fri, 16 Nov 2007, Charles Danko wrote:

> Hello,
>
> Quick question.
>
> I have written a C function - I would like to make it return two vectors to
> the R environment - one STRSXP vector, and one INTSXP vector.  Is this
> possible/ easy to do using the API?
>
> I looked, but could not find the answer to this  question in the "Writing R
> Extensions" guide.

Put them in a list? The SEXP function in the .Call() interface then 
returns a list wich you unpack on the R side. There are plenty of examples 
in the base code and in numerous contributed packages.

>
> Thanks very much for your help!
> Charles
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From b.rowlingson at lancaster.ac.uk  Fri Nov 16 22:07:13 2007
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 16 Nov 2007 21:07:13 +0000
Subject: [Rd] Returning vectors of two different data types back to R
 environment (from C).
In-Reply-To: <8adccabf0711161249n763c3290o1ec4bab4bea1a104@mail.gmail.com>
References: <8adccabf0711161249n763c3290o1ec4bab4bea1a104@mail.gmail.com>
Message-ID: <473E0681.8040508@lancaster.ac.uk>

Charles Danko wrote:
> Hello,
> 
> Quick question.
> 
> I have written a C function - I would like to make it return two vectors to
> the R environment - one STRSXP vector, and one INTSXP vector.  Is this
> possible/ easy to do using the API?
> 
> I looked, but could not find the answer to this  question in the "Writing R
> Extensions" guide.

  How does any R function return two different-typed values back to its 
caller? With a list - like list(foo=1,bar='baz'). Construct an R list in 
your C code and return that... R Extensions should tell you how!

Barry


From dusa.adrian at gmail.com  Thu Nov 15 00:09:00 2007
From: dusa.adrian at gmail.com (Adrian Dusa)
Date: Thu, 15 Nov 2007 01:09:00 +0200
Subject: [Rd] library path in Rd link
In-Reply-To: <473B6A4F.2070208@stats.uwo.ca>
References: <200711141549.54176.dusa.adrian@gmail.com>
	<473B6A4F.2070208@stats.uwo.ca>
Message-ID: <200711150109.00697.dusa.adrian@gmail.com>

On Wednesday 14 November 2007, Duncan Murdoch wrote:
> On 11/14/2007 8:49 AM, Adrian Dusa wrote:
> > [...]
> >
> > Is there a method to create links to functions from the base package, for
> > example (which is installed by default in the normal library folder)?
>
> I believe this is normally automatic in platforms other than Windows.
> On Windows, the answer is no.

This is what I thought, too. But if I link for example to function anova() in 
pacakge stats, the html link after installing the new package is:

file:///home/adi/myRlibrary/stats/html/anova.html

where the stats package is by default installed in:

/usr/lib/R/library/

(indeed my question was related to Windows too, not only on Linux)


> The problem is that in most cases R isn't in charge of the help file
> viewing.  There isn't a good way to make a link from an HTML file to a
> location that isn't known in advance, for example.
>
> On Unix-alikes, the workaround is to build soft links to all the
> packages in a standard location; but soft links don't work on Windows
> (and we don't want to get into the almost-undocumented hard links that
> exist on some Windows file systems).

I understand, thank you. I learned from Prof. Ripley's answer that Windows has 
link.html.help() function to resolve the html help files from all installed 
packages.

Best wishes,
Adrian


-- 
Adrian Dusa
Romanian Social Data Archive
1, Schitu Magureanu Bd
050025 Bucharest sector 5
Romania
Tel./Fax: +40 21 3126618 \
          +40 21 3120210 / int.101


From hb at stat.berkeley.edu  Sat Nov 17 00:58:47 2007
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Fri, 16 Nov 2007 15:58:47 -0800
Subject: [Rd] C/C++ 'assert' should not be used in R packages
In-Reply-To: <AF618CB3-93F7-439C-AEBC-F84E3904E0CB@r-project.org>
References: <Pine.LNX.4.64.0711071638510.7944@gannet.stats.ox.ac.uk>
	<47359829.8090909@stats.uwo.ca> <4735F1C0.8050601@wald.ucdavis.edu>
	<4735F302.501@stats.uwo.ca>
	<AF618CB3-93F7-439C-AEBC-F84E3904E0CB@r-project.org>
Message-ID: <59d7961d0711161558y7381f693q5933d9da53850847@mail.gmail.com>

On Nov 10, 2007 1:27 PM, Simon Urbanek <simon.urbanek at r-project.org> wrote:
>
>
> On Nov 10, 2007, at 1:05 PM, Duncan Murdoch wrote:
>
> > On 10/11/2007 1:00 PM, Duncan Temple Lang wrote:
> >> -----BEGIN PGP SIGNED MESSAGE-----
> >> Hash: SHA1
> >>
> >>
> >>
> >> Duncan Murdoch wrote:
> >>> Prof Brian Ripley wrote:
> >>>> Please don't use 'assert' in R packages.  If called, this means
> >>>> that an
> >>>> error in your code aborts the whole R process, including your
> >>>> user's work.
> >>>> I see several R packages doing this, and one of them called
> >>>> 'assert' on me
> >>>> earlier in the week.
> >>>>
> >>> I partly disagree about this.  If assert() is triggered, it clearly
> >>> indicates a bug in the package.  If it just generated an R error,
> >>> most
> >>> users would ignore it, and not report it to the package maintainer.
> >>>
> >>> It may well be that when an assertion fails, none of the subsequent
> >>> calculations are reliable, in which case returning control to the
> >>> user
> >>> could result in data corruption.  That's worse than losing a
> >>> session,
> >>> because at least when you lose a session, you know it.
> >>>
> >>> Could we write our own implementation of assert() that displays an R
> >>> error and unloads the package?  I think I could do something like
> >>> that
> >>> in Windows by calling FreeLibrary to unload the DLL, but I'd
> >>> prefer a
> >>> cross-platform solution.
> >>
> >> I am not sure why you think we need to discard the DLL.
> >
> > The package author has asserted that it is no longer safe to run.
> > They are shutting down R, and Brian finds that too extreme.
> >
>
> Me too. A package should never intentionally close the R session. If
> it does, it is a very severe design bug in the package (IMHO).
> Anything you use assert for can be gracefully handled (as opposed to
> let's say a segfault), so there is no excuse for killing the whole
> process at all (deliberately wiping all user's work is rude to put it
> mildly).

Oh, I normally try to wipe the harddrive too when I'm at it ;)

/H

> Even if it might be unsafe to run anything, I'd still want
> to attempt to save my data.
>
> Cheers,
> Simon
>
>
>
> >> What if we want to access variables and routines merely to find out
> >> the resulting state after the assert().
> >> And it is not clear whether you mean any "subsequent calculations"
> >> or any "subsequent calculations using code within this DLL"
> >> might be unreliable.
> >
> > How could I know why a package author decided a shutdown is
> > needed?  It
> > depends on the author.
> >
> >>
> >> But regardless of that and the assumption that users will ignore this
> >> error, why would you want to call FreeLibrary? Since R has induced
> >> the
> >> DLL to be loaded either directly or indirectly, R holds a handle
> >> to the
> >> DLL. If you don't use R's cross-platform facilities for releasing the
> >> DLL (either at the R or C-level), you will corrupt the session,
> >> specifically in the list of assumed-live DLLs.
> >
> > As I said, I'd prefer a cross-platform solution.
> >
> > Duncan Murdoch
> >>
> >>  D.
> >>
> >>
> >>>> We provide 'error': please do use it to return control to the
> >>>> user when
> >>>> your code misbehaves.
> >>>>
> >>>> Similarly 'exit' and 'abort' should never be used in R packages.
> >>>>
> >>>>
> >>>> Sometimes it is not under your control: I sometimes see an rgl
> >>>> failure at
> >>>>
> >>>> R: indirect_vertex_array.c:659: emit_DrawArrays_old: Assertion
> >>>> `elements_per_request >= count' failed.
> >>>>
> >>>> that is coming from the Mesa GL libraries.
> >>>>
> >>> I'd say that's a bug, either in Mesa GL or in rgl.  If you can
> >>> make it
> >>> reproducible, I'll try to track it down.
> >>>
> >>> Duncan Murdoch
> >>>
> >>> ______________________________________________
> >>> R-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >> -----BEGIN PGP SIGNATURE-----
> >> Version: GnuPG v1.4.7 (Darwin)
> >> Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
> >>
> >> iD8DBQFHNfHA9p/Jzwa2QP4RAo2BAJkB5QaFLOW5fcR6QE9JSXpIWAcEUwCggMYK
> >> 2WBnl5jDgTUayU5wk8hnQj4=
> >> =91by
> >> -----END PGP SIGNATURE-----
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From statmobile at gmail.com  Sat Nov 17 01:32:49 2007
From: statmobile at gmail.com (statmobile at gmail.com)
Date: Fri, 16 Nov 2007 19:32:49 -0500
Subject: [Rd] Returning vectors of two different data types back to
	R	environment (from C).
In-Reply-To: <8adccabf0711161249n763c3290o1ec4bab4bea1a104@mail.gmail.com>
References: <8adccabf0711161249n763c3290o1ec4bab4bea1a104@mail.gmail.com>
Message-ID: <20071117003249.GA10518@bjl>

On Fri, Nov 16, 2007 at 03:49:09PM -0500, Charles Danko wrote:
> Hello,
> 
> Quick question.
> 
> I have written a C function - I would like to make it return two vectors to
> the R environment - one STRSXP vector, and one INTSXP vector.  Is this
> possible/ easy to do using the API?
> 
> I looked, but could not find the answer to this  question in the "Writing R
> Extensions" guide.

Yes, it's really quite reasonable to do, although it's not documented
in detail in the R-extensions manual.  As stated earlier, this will
only work with .Call and SEXP functions where you can handle R objects
within C.  

In Section 5.9 "Evaluating R expressions in C" it has an example using
lists in C.  Basically, lists are VECSXP objects so you can search for
that in R-exts.

Also, I would recommend looking at 5.7.6 "Handling lists" and the
function: 

SEXP getListElement(SEXP list, char *str)

You should look for that, and then grep the source files for
examples.  If you don't have grep to search the files, then I would
recommend the R gonzui site:

http://rgonzui.nakama.ne.jp/

Personally, I found the source code for det() to be a useful example,
you can search for that on R gonzui.

Good Luck


From osklyar at ebi.ac.uk  Sat Nov 17 01:53:11 2007
From: osklyar at ebi.ac.uk (Oleg Sklyar)
Date: Sat, 17 Nov 2007 00:53:11 +0000
Subject: [Rd] Returning vectors of two different data types back to
	R	environment (from C).
In-Reply-To: <8adccabf0711161249n763c3290o1ec4bab4bea1a104@mail.gmail.com>
References: <8adccabf0711161249n763c3290o1ec4bab4bea1a104@mail.gmail.com>
Message-ID: <1195260791.6220.4.camel@carbon>

SEXP x,y,res;
PROTECT(res = allocVector(VECSXP, 2));
SET_VECTOR_ELT(res, 0, x = allocVector(REALSXP, 20)); 
SET_VECTOR_ELT(res, 1, y = allocVector(INTSXP, 10)); 
// code with x,y goes here

UNPROTECT(1);
return res;

On Fri, 2007-11-16 at 15:49 -0500, Charles Danko wrote:
> Hello,
> 
> Quick question.
> 
> I have written a C function - I would like to make it return two vectors to
> the R environment - one STRSXP vector, and one INTSXP vector.  Is this
> possible/ easy to do using the API?
> 
> I looked, but could not find the answer to this  question in the "Writing R
> Extensions" guide.
> 
> Thanks very much for your help!
> Charles
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ggrothendieck at gmail.com  Sat Nov 17 05:12:12 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 16 Nov 2007 23:12:12 -0500
Subject: [Rd] faqs
In-Reply-To: <971536df0711150751i61a60bc8y8074eb0796c7b483@mail.gmail.com>
References: <D4F43809-6D74-4FA4-92AB-0A9248072A1A@ysidro.econ.uiuc.edu>
	<971536df0711141753r5753c3c5i6faf438bd65ebc03@mail.gmail.com>
	<473BB9E1.4020001@stats.uwo.ca>
	<971536df0711142055t652a618jbac4b5f23af48652@mail.gmail.com>
	<4ACB4F00-5E33-4ADD-B6BD-80324ACAAFCA@r-project.org>
	<971536df0711150751i61a60bc8y8074eb0796c7b483@mail.gmail.com>
Message-ID: <971536df0711162012q38d7f268y3627cc565646f75c@mail.gmail.com>

On Nov 15, 2007 10:51 AM, Gabor Grothendieck <ggrothendieck at gmail.com> wrote:
> On Nov 15, 2007 9:57 AM, Simon Urbanek <simon.urbanek at r-project.org> wrote:
> >
> > On Nov 14, 2007, at 11:55 PM, Gabor Grothendieck wrote:
> >
> > > inst/NEWS would have the advantage of consistency with R itself
> > > which also has a NEWS file.
> > >
> >
> > I vote for NEWS for reasons above plus because that's what I use in my
> > packages already ;).
> > IMHO it should be installed automatically if present, i.e. it
> > shouldn't be necessary to have it in inst/NEWS, just plain NEWS should
> > suffice.
> >
>
> I agree that that would be desirable.

Also it would be nice if the HTML files here:

http://cran.r-project.org/src/contrib/Descriptions/

each had a link to the NEWS file so one could get the news on a
package prior to
installing it.


From vincent.goulet at act.ulaval.ca  Sat Nov 17 22:08:01 2007
From: vincent.goulet at act.ulaval.ca (Vincent Goulet)
Date: Sat, 17 Nov 2007 16:08:01 -0500
Subject: [Rd] Matrix exponential in R
Message-ID: <8D223180-88D9-4F65-A0CE-AAE9C541DE43@act.ulaval.ca>

Dear developeRs,

The topic has been raised quite a few times in r-devel and r-help  
before: calculation of matrix exponentials in R. We needed it in the  
actuar package at the C level and ended up cooking up our own solution  
based on expm() of package Matrix (which is itself based on Octave's).

If there is interest from the R Core Team, we (my colleague in CC and  
I) are offering to contribute an expm() function to base R, with the  
corresponding C function part of the R API for package authors to use.  
We feel this would be a welcome addition to base R.

Please share your thoughts.

Best,

---
   Vincent Goulet, Associate Professor
   ?cole d'actuariat
   Universit? Laval, Qu?bec
   Vincent.Goulet at act.ulaval.ca   http://vgoulet.act.ulaval.ca


From p.dalgaard at biostat.ku.dk  Sun Nov 18 22:37:45 2007
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sun, 18 Nov 2007 22:37:45 +0100
Subject: [Rd] 2.6.1 scheduled for November 26
Message-ID: <4740B0A9.9000207@biostat.ku.dk>

This is to announce that we plan to release R version 2.6.1 on Monday,
November 26, 2007. 

The current experience is that beta releases receive very little end-user testing and that most bugs are not found until (shortly) after release. Accordingly, we have decided this time to skip the beta phase and go directly for one week of RC (Release Candidate) versions. The main bugs to get rid of are the scrollbare issue with Tcl/Tk on X11, the Windows issue of saving to PDF+PostScript. and build issues on Mac OSX Leopard.

The source tarballs will be made available daily (barring build troubles) by a cron job running at 4AM CET, and the tarballs can be picked up at 

http://cran.r-project.org/src/base-prerelease/

a little later. 

	For the Core Team
	Peter Dalgaard


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From karl at huftis.org  Mon Nov 19 11:45:28 2007
From: karl at huftis.org (karl at huftis.org)
Date: Mon, 19 Nov 2007 11:45:28 +0100 (CET)
Subject: [Rd] segfault on functions with 'source' attribute set to a boolean
	or a number (PR#10437)
Message-ID: <20071119104528.9B7D1283461C@mail.pubhealth.ku.dk>

Full_Name: Karl Ove Hufthammer
Version: 2.6.0
OS: Linux (Fedora 7)
Submission from: (NULL) (129.177.61.84)


When viewing a function that has its 'source' attribute set to a boolean or a
numeric, R crashes with a segfault. (Setting 'source' to a character vector does
not make R crash, however.)

Steps to reproduce:

> attr(lm,"source")=FALSE
> lm

 *** caught segfault ***
address 0x18, cause 'memory not mapped'


From miguez at uiuc.edu  Mon Nov 19 16:37:41 2007
From: miguez at uiuc.edu (Fernando Miguez)
Date: Mon, 19 Nov 2007 09:37:41 -0600
Subject: [Rd] R CMD check in Windows
Message-ID: <4741ADC5.50207@uiuc.edu>

Hi all,

R CMD check does not work for me under Windows. This is the error

R CMD check mypackage.tar.gz
* checking for working latex ... OK
tar: and: Not found in archive
tar: Settings/miguez/ ... /00_pkg_src: Not found in archive
tar: Error exit delayed from previous errors
Error: cannot untar mypackage.tar.gz

I know tar is available because R CMD build created the tarball in the 
first place and man tar works.

I'm mostly working in Linux but if I can fix this it would be nice. Ok 
now I'm thinking that I might have an old version of perl installed and 
this might be the problem. Any suggestions/explanations are welcome.

Thanks!

Fernando


From murdoch at stats.uwo.ca  Mon Nov 19 16:50:06 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 19 Nov 2007 10:50:06 -0500
Subject: [Rd] R CMD check in Windows
In-Reply-To: <4741ADC5.50207@uiuc.edu>
References: <4741ADC5.50207@uiuc.edu>
Message-ID: <4741B0AE.3080105@stats.uwo.ca>

On 11/19/2007 10:37 AM, Fernando Miguez wrote:
> Hi all,
> 
> R CMD check does not work for me under Windows. This is the error
> 
> R CMD check mypackage.tar.gz
> * checking for working latex ... OK
> tar: and: Not found in archive
> tar: Settings/miguez/ ... /00_pkg_src: Not found in archive
> tar: Error exit delayed from previous errors
> Error: cannot untar mypackage.tar.gz
> 
> I know tar is available because R CMD build created the tarball in the 
> first place and man tar works.
> 
> I'm mostly working in Linux but if I can fix this it would be nice. Ok 
> now I'm thinking that I might have an old version of perl installed and 
> this might be the problem. Any suggestions/explanations are welcome.

Old/bad versions of some utility are the likely cause.  The Rtools 
collection contains a custom version of tar; if your PATH is finding a 
different one first, that could be the trouble.

Take a look at the "Windows Toolset" section of the admin manual, and 
make sure you follow the instructions about path order (and the rest, too).

It is possible to use a different PATH than the one in the manual, but 
there are many more choices that fail than there are that succeed.

Duncan Murdoch


From ripley at stats.ox.ac.uk  Mon Nov 19 16:50:27 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Mon, 19 Nov 2007 16:50:27 +0100 (CET)
Subject: [Rd] (PR#10437) segfault on functions with 'source' attribute
Message-ID: <20071119155027.19DFE2834610@mail.pubhealth.ku.dk>

I am not sure why you would want to do that, but the C code does assume 
source attributes were put there by R, and changing tests from !isNull to 
isString in a few places will fix that.

If there is a character vector "source" attribute it should be used: that 
is the point of such attributes.


On Mon, 19 Nov 2007, karl at huftis.org wrote:

> Full_Name: Karl Ove Hufthammer
> Version: 2.6.0
> OS: Linux (Fedora 7)
> Submission from: (NULL) (129.177.61.84)
>
>
> When viewing a function that has its 'source' attribute set to a boolean or a
> numeric, R crashes with a segfault. (Setting 'source' to a character vector does
> not make R crash, however.)
>
> Steps to reproduce:
>
>> attr(lm,"source")=FALSE
>> lm
>
> *** caught segfault ***
> address 0x18, cause 'memory not mapped'
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From edd at debian.org  Mon Nov 19 16:54:22 2007
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 19 Nov 2007 09:54:22 -0600
Subject: [Rd] More Rgraphviz help needed (Was: package installation order)
In-Reply-To: <m2lk90kts5.fsf@userprimary.net>
References: <71257D09F114DA4A8E134DEAC70F25D30A2029AA@groamrexm03.amer.pfizer.com>
	<18235.3307.38745.255091@ron.nulle.part>
	<m2lk90kts5.fsf@userprimary.net>
Message-ID: <18241.45486.784639.457624@ron.nulle.part>


On 14 November 2007 at 20:38, Seth Falcon wrote:
| Dirk Eddelbuettel <edd at debian.org> writes:
| > When trying to package the by-now-gargantuan Rmetrics for Debian (which is
| > still ongoing), I looked around for some Depends builders. Turns out that
| > BioC has this.   E.g. the following worked for:
| >
| > ## > install.packages("Biobase", repo="http://www.bioconductor.org")
| > ## > repos <- Biobase:::biocReposList()
| > ## > install.packages("pkgDepTools", repos=repos["bioc"])
| > ## > library(pkgDepTools)
| > ## Loading required package: graph
| > ## Loading required package: RBGL
| > ## > CRANdeps <- makeDepGraph(repos["cran"], type="source")
| > ## > getInstallOrder("Rmetrics", CRANdeps, needed.only=FALSE)
| >
| > worked for me.  I meant to add some code for Graphviz visualization (or look
| > for it, Seth et al probably already wrote it) but what you get from
| > getInstallOrder() should suit your needs here.
| 
| makeDepGraph returns a graphNEL instance and Rgraphviz knows how to
| plot those.  The entire graph will likely not produce a particularly
| compelling visualization.  But you can subset the graph according to a
| particular package's dependencies, etc.

Yes indeed!!  That was pretty straightforward just by following some code
inside getInstallOrder. And using "twopi" is good enough for the 40-some
packages in the graph.

But now I need the icing on the cake:  Given such a dependency graph, how can
I color further subgraphs according to some criterion: I'd love to select a
sub-list (of, say, new packages, or of packages that satisfy some other
criterion) and have their node plotted in a different color.   The help pages
clearly indicate that this should be possible, but they are also a little
terse on how one would do this...   Any pointers anywhere?

Dirk

-- 
Three out of two people have difficulties with fractions.


From ripley at stats.ox.ac.uk  Mon Nov 19 17:02:46 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 19 Nov 2007 16:02:46 +0000 (GMT)
Subject: [Rd] R CMD check in Windows
In-Reply-To: <4741B0AE.3080105@stats.uwo.ca>
References: <4741ADC5.50207@uiuc.edu> <4741B0AE.3080105@stats.uwo.ca>
Message-ID: <Pine.LNX.4.64.0711191559540.17128@gannet.stats.ox.ac.uk>

My guess is the that problem is that the current directory is under
c:\Documents and Settings\miguel, and that is not supported.

Try using a directory without spaces in its name.

On Mon, 19 Nov 2007, Duncan Murdoch wrote:

> On 11/19/2007 10:37 AM, Fernando Miguez wrote:
>> Hi all,
>>
>> R CMD check does not work for me under Windows. This is the error
>>
>> R CMD check mypackage.tar.gz
>> * checking for working latex ... OK
>> tar: and: Not found in archive
>> tar: Settings/miguez/ ... /00_pkg_src: Not found in archive
>> tar: Error exit delayed from previous errors
>> Error: cannot untar mypackage.tar.gz
>>
>> I know tar is available because R CMD build created the tarball in the
>> first place and man tar works.
>>
>> I'm mostly working in Linux but if I can fix this it would be nice. Ok
>> now I'm thinking that I might have an old version of perl installed and
>> this might be the problem. Any suggestions/explanations are welcome.
>
> Old/bad versions of some utility are the likely cause.  The Rtools
> collection contains a custom version of tar; if your PATH is finding a
> different one first, that could be the trouble.
>
> Take a look at the "Windows Toolset" section of the admin manual, and
> make sure you follow the instructions about path order (and the rest, too).
>
> It is possible to use a different PATH than the one in the manual, but
> there are many more choices that fail than there are that succeed.
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From wjunger at ims.uerj.br  Mon Nov 19 17:19:08 2007
From: wjunger at ims.uerj.br (wjunger at ims.uerj.br)
Date: Mon, 19 Nov 2007 14:19:08 -0200 (BRST)
Subject: [Rd] Cairo device in dev.copy2eps
Message-ID: <59475.201.19.91.25.1195489148.squirrel@mail.ims.uerj.br>

Hi everybody,

It would be nice to have Cairo device included in dev.copy2eps() in
order to avoid RGtk2 developers to use a hacked version of the function.
I was arealdy done in dev.print().

Best regards.
Washington


R 2.6.0
OS Kubuntu 7.10
kernel 2.6.22

-- 
Washington Leite Junger
wjunger at ims.uerj.br
Departamento de Epidemiologia
Instituto de Medicina Social
Universidade do Estado do Rio de Janeiro
http://www.ims.uerj.br/ares-rio


From maechler at stat.math.ethz.ch  Mon Nov 19 18:28:12 2007
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 19 Nov 2007 18:28:12 +0100
Subject: [Rd] NEWS file (was  faqs)
In-Reply-To: <80BEBDD4-6222-499D-A9E8-AC091DC91278@r-project.org>
References: <D4F43809-6D74-4FA4-92AB-0A9248072A1A@ysidro.econ.uiuc.edu>
	<971536df0711141753r5753c3c5i6faf438bd65ebc03@mail.gmail.com>
	<473BB9E1.4020001@stats.uwo.ca>
	<971536df0711142055t652a618jbac4b5f23af48652@mail.gmail.com>
	<4ACB4F00-5E33-4ADD-B6BD-80324ACAAFCA@r-project.org>
	<473C6B78.5090605@stats.uwo.ca>
	<80BEBDD4-6222-499D-A9E8-AC091DC91278@r-project.org>
Message-ID: <18241.51116.624403.781256@stat.math.ethz.ch>


    SU> On Nov 15, 2007, at 10:53 AM, Duncan Murdoch wrote:

    >> On 11/15/2007 9:57 AM, Simon Urbanek wrote:
    >>> On Nov 14, 2007, at 11:55 PM, Gabor Grothendieck wrote:
    >>>> inst/NEWS would have the advantage of consistency with
    >>>> R itself which also has a NEWS file.
    >>>> 
    >>> I vote for NEWS for reasons above plus because that's
    >>> what I use in my packages already ;).  IMHO it should be
    >>> installed automatically if present, i.e. it shouldn't be
    >>> necessary to have it in inst/NEWS, just plain NEWS
    >>> should suffice.
    >> 
    >> And you're volunteering to make that change?
    >> 

    SU> Yup, in R-devel now (43464). However, there are other candidate files  
    SU> as well and we don't do anything with the NEWS file just
    SU> yet ... any further ideas?

Yes, I think  'NEWS' and 'ChangeLog' are typically used a bit
differently, and I would be very happy if we could install
either (and both) if present...

I'm sorry for coming this late to the thread...
Martin


    SU> Cheers, Simon

    >> 
    >>> Cheers, Simon
    >>>> 
    >>>> On Nov 14, 2007 10:15 PM, Duncan Murdoch
    >>>> <murdoch at stats.uwo.ca> wrote:
    >>>>> On 14/11/2007 8:53 PM, Gabor Grothendieck wrote:
>>>>> Another possibility is to just place it at the end of the
>>>>> vignette.
>>>>> That is where it is in the proto package:
    >>>>>> 
>>>>> http://cran.r-project.org/doc/vignettes/proto/proto.pdf
    >>>>>> 
>>>>> Package documentation is already quite scattered and
    >>>>>> adding
>>>>> a faq() command would add just one more thing one has
>>>>> to do.  Here are some places one might look already for
>>>>> documentation:
    >>>>>> 
>>>>> package?mypackage
    >>>>> 
    >>>>> Or just ?mypackage.  Writing R Extensions recommends
    >>>>> package?  mypackage, with ?mypackage also working if
    >>>>> that name isn't taken.  However, the advice is ignored
    >>>>> more than it is followed.
    >>>>> 
>>>>> vignette(...)
>>>>> library(help = mypackage)
>>>>> ?mycommand
>>>>> home page
>>>>> WISHLIST file
>>>>> NEWS file
>>>>> THANKS file
>>>>> svn log
    >>>>>> 
>>>>> I personally would give a much higher priority to a
    >>>>>> standardized
>>>>> place to find change information.  Some packages provide
    >>>>>> it.
>>>>> Some don't which is very frustrating since you see a new
    >>>>>> version
>>>>> and have no idea what has changed.  If they do document it
    >>>>>> you
>>>>> often have to download the source just to get at the
    >>>>>> change
>>>>> information.
    >>>>> 
    >>>>> Where do you put it?  I put it in inst/ChangeLog,
    >>>>> which ends up installed in the package root as
    >>>>> ChangeLog.
    >>>>> 
    >>>>> Whenever this has come up in the past, there have been
    >>>>> several proposals, but no consensus.  So, to encourage
    >>>>> consensus, I've got a proposal:
    >>>>> 
    >>>>> Why don't we vote on a location, with every voter
    >>>>> agreeing to follow the majority?  The only condition
    >>>>> I'd put on it is that it should be something that gets
    >>>>> installed, hence somewhere in inst, but I'd be happy
    >>>>> to change the name if ChangeLog doesn't win.
    >>>>> 
    >>>>> My vote is for inst/ChangeLog.
    >>>>> 
    >>>>> Duncan Murdoch
    >>>>> 
    >>>>> 
    >>>>>> 
>>>>>
>>>>>
>>>>> On Nov 14, 2007 8:22 PM, roger koenker  <roger at ysidro.econ.uiuc.edu 
>>>>> > wrote:
>>>>>> An extremely modest proposal:
>>>>>>
>>>>>> It would be nice if packages could have a FAQ and if
>>>>>>
>>>>>>      faq(package.name)
>>>>>>
>>>>>> would produce this faq.  And if, by default
>>>>>>
>>>>>>      faq()
>>>>>>      FAQ()
>>>>>>
>>>>>> would produce the admirable R faq...  Apologies in advance
>>>>>> if there is already a mechanism like this, but help.search()
>>>>>> didn't reveal anything.
>>>>>>
>>>>>> url:    www.econ.uiuc.edu/~roger                Roger Koenker
>>>>>> email   rkoenker at uiuc.edu                       Department of   
>>>>>> Economics
>>>>>> vox:    217-333-4558                            University of   
>>>>>> Illinois
>>>>>> fax:    217-244-6678                            Champaign, IL  
>>>>>> 61820
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>
>

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From kchine at ebi.ac.uk  Mon Nov 19 22:42:20 2007
From: kchine at ebi.ac.uk (kchine at ebi.ac.uk)
Date: Mon, 19 Nov 2007 21:42:20 -0000 (GMT)
Subject: [Rd] biocep project - R for the Web and the Virtual R Workbench
Message-ID: <33033.172.188.210.62.1195508540.squirrel@webmail.ebi.ac.uk>

Dear all,

I have been writing during last year at the European Bioinformatics
Institute a general unified open source solution for R integration. This
work is now available via this link:
http://www.ebi.ac.uk/microarray-srv/frontendapp/
The different frameworks and tools of the biocep project are now robust
enough for production use. The different APIs are finalized but the
documentation is incomplete.
the last version of the biocep README file can be found here :
http://www.ebi.ac.uk/microarray-srv/frontendapp/BIOCEP_README.txt

Here are the major use cases I dealt with :

- Generate java mappings for R Objects (Standard/S4).
- Generate java mappings for selected packages' functions
(Generic/TypeInfoed).
- Use R and the R packages as a Java Toolkit via a Rich, High level,
Object-Oriented API.
- Deploy and use R as a remote component.
- Expose automatically R packages and the R API as JAX-WS stateless or
statefull Web Services.
- Use R within a resource pooling infrastructure for scalable, web
oriented, data analysis applications.
- Use the Remote Resources Pooling framework (RPF) to deploy and use
distributed computational resources (non R based, native libraries with
JNI support or java code)
- Use R for parallel computing via  a Java API or Web Services.
- Create and use Remote R Instances from within R (snow' like fucntions :
makeCluster, clusterEvalQ, clusterExport, clusterApply,  stopCluster ..)
- Use the R API from within an applet (book, use and release a Remote R
Instance via HTTP Tunneling)
- Use R to generate Graphics on the fly for thin web clients
- Use R from within a Workbench that includes an advanced script editor, 
a Spreadsheet View fully connected to R data and functions, an R Object
Inspector,
composable and dockable Views, interactive R devices, clonable R Graphics..
- Use the Workbench from within a browser or via Java Web Start to access
a pool of Remote R Instances
- Use the Workbench to control on demand any Remote R Instance
- Provide a packaging for R Based Desktop applications that enables Web
based, one click installation (Embedded R for Windows, detected R for
other operating systems)

This work uses extensively a large number of existing open source projects
as is or patched.

The public SVN url/login/pasword for the biocep project are in the README
file

You may want to try the Virtual R Workbench on your local machine, use the
following link :  
http://www.ebi.ac.uk/microarray-srv/frontendapp/rworkbench.jnlp
or type 'javaws
http://www.ebi.ac.uk/microarray-srv/frontendapp/rworkbench.jnlp' from the
command line.
This is a one click installation process for Windows and Mac OS X. (You
need to preinstall R on Mac OS X while on Widows an embedded R 2.6 can be
deployed and used)
The Java Web Start installer creates an RWorkbench directory in your home
dir with all the files required. You may continue launching the
application via the url (good for fetching updates automatically)
or use the RWorkbench/VRWorkbench.txt to Run the application off line.
rename it to VRWorkbench.bat on Windows or type 'source VRWorkbench.txt'
on Mac OS X command line.
use the sources of biocep to run the R Workbench on Unix-like operating
systems.

Best wishes,

Karim


From ripley at stats.ox.ac.uk  Tue Nov 20 09:32:08 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 20 Nov 2007 08:32:08 +0000 (GMT)
Subject: [Rd] Cairo device in dev.copy2eps
In-Reply-To: <59475.201.19.91.25.1195489148.squirrel@mail.ims.uerj.br>
References: <59475.201.19.91.25.1195489148.squirrel@mail.ims.uerj.br>
Message-ID: <Pine.LNX.4.64.0711200815230.1373@gannet.stats.ox.ac.uk>

It is not as simple as that.  There are two Cairo devices, neither in 
package RGtk2.  That in package Cairo is not by default a screen device 
(it defaults to type="png").  CairoX11 and CairoWin are screen devices.
OTOH, package cairoDevice has a device called Cairo that defaults to a 
screen device but need not be.

Please do mention packages when you talk about non-base functions to avoid 
this sort of confusion.

It seems a better solution is to ask the current device, which will be 
done in R 2.7.0.

On Mon, 19 Nov 2007, wjunger at ims.uerj.br wrote:

> Hi everybody,
>
> It would be nice to have Cairo device included in dev.copy2eps() in
> order to avoid RGtk2 developers to use a hacked version of the function.
> I was arealdy done in dev.print().

What does this have to do with RGtk2?

> Best regards.
> Washington
>
>
> R 2.6.0
> OS Kubuntu 7.10
> kernel 2.6.22
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From wjunger at ims.uerj.br  Tue Nov 20 21:28:44 2007
From: wjunger at ims.uerj.br (Washington Leite Junger)
Date: Tue, 20 Nov 2007 18:28:44 -0200
Subject: [Rd] Cairo device in dev.copy2eps
In-Reply-To: <Pine.LNX.4.64.0711200815230.1373@gannet.stats.ox.ac.uk>
References: <59475.201.19.91.25.1195489148.squirrel@mail.ims.uerj.br>
	<Pine.LNX.4.64.0711200815230.1373@gannet.stats.ox.ac.uk>
Message-ID: <4743437C.9010009@ims.uerj.br>

Sorry for the confusion.
The Cairo device I made reference to is the one implemented in the
cairoDevice package.
Its relation to the RGtk2 package is due to the straightforward manner
the Cairo device (in cairoDevice) can be embedded in the applications
developed using RGtk2.

Thanks for the satisfactory reply.

Best.
Washington



Prof Brian Ripley wrote:
> It is not as simple as that.  There are two Cairo devices, neither in
> package RGtk2.  That in package Cairo is not by default a screen
> device (it defaults to type="png").  CairoX11 and CairoWin are screen
> devices.
> OTOH, package cairoDevice has a device called Cairo that defaults to a
> screen device but need not be.
>
> Please do mention packages when you talk about non-base functions to
> avoid this sort of confusion.
>
> It seems a better solution is to ask the current device, which will be
> done in R 2.7.0.
>
> On Mon, 19 Nov 2007, wjunger at ims.uerj.br wrote:
>
>> Hi everybody,
>>
>> It would be nice to have Cairo device included in dev.copy2eps() in
>> order to avoid RGtk2 developers to use a hacked version of the function.
>> I was arealdy done in dev.print().
>
> What does this have to do with RGtk2?
>
>> Best regards.
>> Washington
>>
>>
>> R 2.6.0
>> OS Kubuntu 7.10
>> kernel 2.6.22
>>
>>
>

-- 
Washington Leite Junger
wjunger at ims.uerj.br
Departamento de Epidemiologia
Instituto de Medicina Social
Universidade do Estado do Rio de Janeiro
http://www.ims.uerj.br/ares-rio


From ggrothendieck at gmail.com  Wed Nov 21 06:39:14 2007
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 21 Nov 2007 00:39:14 -0500
Subject: [Rd] faqs
In-Reply-To: <971536df0711162012q38d7f268y3627cc565646f75c@mail.gmail.com>
References: <D4F43809-6D74-4FA4-92AB-0A9248072A1A@ysidro.econ.uiuc.edu>
	<971536df0711141753r5753c3c5i6faf438bd65ebc03@mail.gmail.com>
	<473BB9E1.4020001@stats.uwo.ca>
	<971536df0711142055t652a618jbac4b5f23af48652@mail.gmail.com>
	<4ACB4F00-5E33-4ADD-B6BD-80324ACAAFCA@r-project.org>
	<971536df0711150751i61a60bc8y8074eb0796c7b483@mail.gmail.com>
	<971536df0711162012q38d7f268y3627cc565646f75c@mail.gmail.com>
Message-ID: <971536df0711202139p5e7e48b3o2ee280c02ea52938@mail.gmail.com>

And one other thing.  In the GNU docs it says that if your NEWS file gets too
big you can create an ONEWS file for the really old stuff.   Is ONEWS supported
too?

On Nov 16, 2007 11:12 PM, Gabor Grothendieck <ggrothendieck at gmail.com> wrote:
>
> On Nov 15, 2007 10:51 AM, Gabor Grothendieck <ggrothendieck at gmail.com> wrote:
> > On Nov 15, 2007 9:57 AM, Simon Urbanek <simon.urbanek at r-project.org> wrote:
> > >
> > > On Nov 14, 2007, at 11:55 PM, Gabor Grothendieck wrote:
> > >
> > > > inst/NEWS would have the advantage of consistency with R itself
> > > > which also has a NEWS file.
> > > >
> > >
> > > I vote for NEWS for reasons above plus because that's what I use in my
> > > packages already ;).
> > > IMHO it should be installed automatically if present, i.e. it
> > > shouldn't be necessary to have it in inst/NEWS, just plain NEWS should
> > > suffice.
> > >
> >
> > I agree that that would be desirable.
>
> Also it would be nice if the HTML files here:
>
> http://cran.r-project.org/src/contrib/Descriptions/
>
> each had a link to the NEWS file so one could get the news on a
> package prior to
> installing it.
>


From gasper.cankar at ric.si  Wed Nov 21 13:11:47 2007
From: gasper.cankar at ric.si (Gasper Cankar)
Date: Wed, 21 Nov 2007 13:11:47 +0100
Subject: [Rd] Color coding
Message-ID: <05FDD1814AFFAB408E15A0ABF3AAE6D80BADF3@intra2003.ric.si>

I'm probably not the first with this idea so I guess that there's a
complex issue behind it but since I couldn't find an answer I just
though to ask:

Wouldn't it be nice to have color coded objects as output of ls()
statement? Functions of one color and rest with other (at least). So
when I issue an ls() I could visually discern different types of
objects.

I often find myself opening old files and spending time figuring which
is which. I know this just means I'm not aoranized, but still...color
coding would help.

Regards to everyone,

___________________
Gasper Cankar
researcher
National Examinations Centre (Ric)
gasper.cankar at ric.si
tel. +386 1 54 84 682
fax. +386 1 54 84 601


From karl at huftis.org  Tue Nov 20 11:30:27 2007
From: karl at huftis.org (karl at huftis.org)
Date: Tue, 20 Nov 2007 11:30:27 +0100 (CET)
Subject: [Rd] (PR#10437) segfault on functions with 'source' attribute
Message-ID: <20071120103028.2A510283416B@mail.pubhealth.ku.dk>

For the record: The reason I used attr(myfun, "source") = FALSE, is that I 
misread the example 'Tidying R Code' in 'Writing R Extensions', which calls 
for attr(myfun, "source") = NULL.

Somehow setting 'source' to FALSE seems more natural to me than 
setting it to NULL.

ripley at stats.ox.ac.uk:

> I am not sure why you would want to do that, but the C code does assume
> source attributes were put there by R, and changing tests from !isNull to
> isString in a few places will fix that.

-- 
Karl Ove Hufthammer


From ripley at stats.ox.ac.uk  Wed Nov 21 16:18:31 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 21 Nov 2007 15:18:31 +0000 (GMT)
Subject: [Rd] (PR#10437) segfault on functions with 'source' attribute
In-Reply-To: <20071120103028.2A510283416B@mail.pubhealth.ku.dk>
References: <20071120103028.2A510283416B@mail.pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.64.0711211516100.15091@gannet.stats.ox.ac.uk>

On Tue, 20 Nov 2007, karl at huftis.org wrote:

> For the record: The reason I used attr(myfun, "source") = FALSE, is that I
> misread the example 'Tidying R Code' in 'Writing R Extensions', which calls
> for attr(myfun, "source") = NULL.
>
> Somehow setting 'source' to FALSE seems more natural to me than
> setting it to NULL.

attr(myfun, "source") <- NULL does not 'set it to NULL', it removes the 
attribute.

> ripley at stats.ox.ac.uk:
>
>> I am not sure why you would want to do that, but the C code does assume
>> source attributes were put there by R, and changing tests from !isNull to
>> isString in a few places will fix that.
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From byron.ellis at gmail.com  Wed Nov 21 19:15:04 2007
From: byron.ellis at gmail.com (Byron Ellis)
Date: Wed, 21 Nov 2007 10:15:04 -0800
Subject: [Rd] Color coding
In-Reply-To: <05FDD1814AFFAB408E15A0ABF3AAE6D80BADF3@intra2003.ric.si>
References: <05FDD1814AFFAB408E15A0ABF3AAE6D80BADF3@intra2003.ric.si>
Message-ID: <7098abec0711211015i104914cevb802922884eb9a17@mail.gmail.com>

Unfortunately, the problem is the way the R output is set up---there's
no portable way (at the moment) to tag output with different
attributes.

On Nov 21, 2007 4:11 AM, Gasper Cankar <gasper.cankar at ric.si> wrote:
> I'm probably not the first with this idea so I guess that there's a
> complex issue behind it but since I couldn't find an answer I just
> though to ask:
>
> Wouldn't it be nice to have color coded objects as output of ls()
> statement? Functions of one color and rest with other (at least). So
> when I issue an ls() I could visually discern different types of
> objects.
>
> I often find myself opening old files and spending time figuring which
> is which. I know this just means I'm not aoranized, but still...color
> coding would help.
>
> Regards to everyone,
>
> ___________________
> Gasper Cankar
> researcher
> National Examinations Centre (Ric)
> gasper.cankar at ric.si
> tel. +386 1 54 84 682
> fax. +386 1 54 84 601
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Byron Ellis (byron.ellis at gmail.com)
"Oook" -- The Librarian


From ripley at stats.ox.ac.uk  Wed Nov 21 19:20:24 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 21 Nov 2007 18:20:24 +0000 (GMT)
Subject: [Rd] Color coding
In-Reply-To: <05FDD1814AFFAB408E15A0ABF3AAE6D80BADF3@intra2003.ric.si>
References: <05FDD1814AFFAB408E15A0ABF3AAE6D80BADF3@intra2003.ric.si>
Message-ID: <Pine.LNX.4.64.0711211520140.15091@gannet.stats.ox.ac.uk>

On Wed, 21 Nov 2007, Gasper Cankar wrote:

> I'm probably not the first with this idea so I guess that there's a
> complex issue behind it but since I couldn't find an answer I just
> though to ask:
>
> Wouldn't it be nice to have color coded objects as output of ls()
> statement? Functions of one color and rest with other (at least). So
> when I issue an ls() I could visually discern different types of
> objects.
>
> I often find myself opening old files and spending time figuring which
> is which. I know this just means I'm not aoranized, but still...color
> coding would help.

You haven't mentioned your platform: you would have to be working in a 
console which supported this, and e.g. the Windows GUI console does not.

Once you know the escape codes to change colour, it would be easy to write 
a listing function which did this.  You would almost certainly have to 
write some C code to find out what the codes are for the current terminal 
(on a modern system via the terminfo database): the GNU ls (part of 
coreutils) would provide you example code.

So, this is project for a package: are you volunteering?

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From groemp at tfh-berlin.de  Thu Nov 22 11:28:21 2007
From: groemp at tfh-berlin.de (=?UTF-8?Q?Ulrike_Gr=C3=B6mping?=)
Date: Thu, 22 Nov 2007 02:28:21 -0800 (PST)
Subject: [Rd]  R CMD check problem on R 2.6.1 RC
Message-ID: <13894334.post@talk.nabble.com>


Dear R-developers,

I'm experiencing a problem with having an example run under R 2.6.1 RC
(downloaded and installed today, r43513), which does not occur on R 2.6.0:
The new version of package relaimpo does list package survey under
"Depends", and an example directly (i.e. not only from within a function of
relaimpo) uses function svydesign from package survey. Package survey is
installed and available when working from within the new R-installation.
However, under R CMD check, the example fails with the message "could not
find function svydesign" (backtranslated from German). It does work fine
under all previous versions of R that I tested (2.3.1, 2.5.1, 2.6.0). 

It may be of interest that function boot from package boot (also listed
under Depends, called from within functions of package relaimpo) works
without problems.

Regards, Ulrike
-- 
View this message in context: http://www.nabble.com/R-CMD-check-problem-on-R-2.6.1-RC-tf4855530.html#a13894334
Sent from the R devel mailing list archive at Nabble.com.


From groemp at tfh-berlin.de  Thu Nov 22 15:26:39 2007
From: groemp at tfh-berlin.de (=?UTF-8?Q?Ulrike_Gr=C3=B6mping?=)
Date: Thu, 22 Nov 2007 06:26:39 -0800 (PST)
Subject: [Rd] R CMD check problem on R 2.6.1 RC
In-Reply-To: <13894334.post@talk.nabble.com>
References: <13894334.post@talk.nabble.com>
Message-ID: <13897482.post@talk.nabble.com>


I suppose I should add that this is under Windows (XP).
Regards, Ulrike


Ulrike Gr?mping wrote:
> 
> Dear R-developers,
> 
> I'm experiencing a problem with having an example run under R 2.6.1 RC
> (downloaded and installed today, r43513), which does not occur on R 2.6.0:
> The new version of package relaimpo does list package survey under
> "Depends", and an example directly (i.e. not only from within a function
> of relaimpo) uses function svydesign from package survey. Package survey
> is installed and available when working from within the new
> R-installation. However, under R CMD check, the example fails with the
> message "could not find function svydesign" (backtranslated from German).
> It does work fine under all previous versions of R that I tested (2.3.1,
> 2.5.1, 2.6.0). 
> 
> It may be of interest that function boot from package boot (also listed
> under Depends, called from within functions of package relaimpo) works
> without problems.
> 
> Regards, Ulrike
> 

-- 
View this message in context: http://www.nabble.com/R-CMD-check-problem-on-R-2.6.1-RC-tf4855530.html#a13897482
Sent from the R devel mailing list archive at Nabble.com.


From murdoch at stats.uwo.ca  Thu Nov 22 15:54:53 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 22 Nov 2007 09:54:53 -0500
Subject: [Rd] R CMD check problem on R 2.6.1 RC
In-Reply-To: <13897482.post@talk.nabble.com>
References: <13894334.post@talk.nabble.com> <13897482.post@talk.nabble.com>
Message-ID: <4745983D.8030700@stats.uwo.ca>

On 11/22/2007 9:26 AM, Ulrike Gr?mping wrote:
> I suppose I should add that this is under Windows (XP).
> Regards, Ulrike
> 
> 
> Ulrike Gr?mping wrote:
>> 
>> Dear R-developers,
>> 
>> I'm experiencing a problem with having an example run under R 2.6.1 RC
>> (downloaded and installed today, r43513), which does not occur on R 2.6.0:
>> The new version of package relaimpo does list package survey under
>> "Depends", and an example directly (i.e. not only from within a function
>> of relaimpo) uses function svydesign from package survey. Package survey
>> is installed and available when working from within the new
>> R-installation. However, under R CMD check, the example fails with the
>> message "could not find function svydesign" (backtranslated from German).
>> It does work fine under all previous versions of R that I tested (2.3.1,
>> 2.5.1, 2.6.0). 
>> 
>> It may be of interest that function boot from package boot (also listed
>> under Depends, called from within functions of package relaimpo) works
>> without problems.

I just tried running R CMD check on relaimpo_1.2-2.tar.gz from CRAN, and 
it gave no error, only the warning

* checking R code for possible problems ... NOTE
calc.relimp.default: no visible global function definition for
   'pmvdcalc'

You didn't say whether this is the "new version" you were testing.  If 
it is, then I'd guess that you have survey installed in a place that R 
CMD check doesn't know about.  Do you normally have two libraries in 
your .libPaths()?

If you were trying something newer than 1.2-2, then I think you'll have 
to make it available somewhere for us to try if you want us to diagnose 
the problem.

Duncan Murdoch


From murdoch at stats.uwo.ca  Thu Nov 22 18:16:59 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 22 Nov 2007 12:16:59 -0500
Subject: [Rd] R CMD check problem on R 2.6.1 RC
In-Reply-To: <4745983D.8030700@stats.uwo.ca>
References: <13894334.post@talk.nabble.com> <13897482.post@talk.nabble.com>
	<4745983D.8030700@stats.uwo.ca>
Message-ID: <4745B98B.9090304@stats.uwo.ca>

On 11/22/2007 10:11 AM, Ulrike Gr?mping wrote:
 > Hi Duncan,
 >
 > yes, I am talking about a new version (currently called 1.99, to be 
made 2.0 on release). I don't think I should attach the file in a note 
to the list - should I ?
 >
 > I've just attached the tar-file for you. Please let me know if I 
should put it somewhere else.

Sending it to me was fine.  I hope you don't mind me taking the 
conversation back to the list.

I don't get an error with 1.99 either, other than this one which isn't 
your fault:

 > * checking DESCRIPTION meta-information ... WARNING
 > Unknown encoding with non-ASCII data
 > Fields with non-ASCII values:
 >   Packaged
 > See the information on DESCRIPTION files in section 'Creating R
 > packages' of the 'Writing R Extensions' manual.

This came because R CMD build put the o-umlaut in your name into the 
Packaged field, i.e. DESCRIPTION has this:

Packaged: Thu Nov 22 16:06:24 2007; Gr?mping

I would call this a bug in our build script, but not one that is serious 
enough to fix before 2.6.1 gets released.

In the check log I see at least one use of svydesign with a warning but 
no error:

 > ### create design with clusters
 > des <- svydesign(id=~subj,data=dat)
Warning in svydesign(id = ~subj, data = dat) :
   No weights or probabilities supplied, assuming equal probability

So I'd come back to guessing that you have survey installed in a 
non-standard place, and R CMD check isn't finding it.

Duncan Murdoch


From groemp at tfh-berlin.de  Thu Nov 22 18:41:58 2007
From: groemp at tfh-berlin.de (=?UTF-8?Q?Ulrike_Gr=C3=B6mping?=)
Date: Thu, 22 Nov 2007 09:41:58 -0800 (PST)
Subject: [Rd] R CMD check problem on R 2.6.1 RC
In-Reply-To: <4745B98B.9090304@stats.uwo.ca>
References: <13894334.post@talk.nabble.com> <13897482.post@talk.nabble.com>
	<4745983D.8030700@stats.uwo.ca> <4745B98B.9090304@stats.uwo.ca>
Message-ID: <13900659.post@talk.nabble.com>




Duncan Murdoch-2 wrote:
> 
> On 11/22/2007 10:11 AM, Ulrike Gr?mping wrote:
>  > Hi Duncan,
>  >
>  > yes, I am talking about a new version (currently called 1.99, to be 
> made 2.0 on release). I don't think I should attach the file in a note 
> to the list - should I ?
>  >
>  > I've just attached the tar-file for you. Please let me know if I 
> should put it somewhere else.
> 
> Sending it to me was fine.  I hope you don't mind me taking the 
> conversation back to the list.
> 
> I don't get an error with 1.99 either, other than this one which isn't 
> your fault:
> 
>  > * checking DESCRIPTION meta-information ... WARNING
>  > Unknown encoding with non-ASCII data
>  > Fields with non-ASCII values:
>  >   Packaged
>  > See the information on DESCRIPTION files in section 'Creating R
>  > packages' of the 'Writing R Extensions' manual.
> 
> This came because R CMD build put the o-umlaut in your name into the 
> Packaged field, i.e. DESCRIPTION has this:
> 
> Packaged: Thu Nov 22 16:06:24 2007; Gr?mping
> 
> I would call this a bug in our build script, but not one that is serious 
> enough to fix before 2.6.1 gets released.
> 
> In the check log I see at least one use of svydesign with a warning but 
> no error:
> 
>  > ### create design with clusters
>  > des <- svydesign(id=~subj,data=dat)
> Warning in svydesign(id = ~subj, data = dat) :
>    No weights or probabilities supplied, assuming equal probability
> 
> So I'd come back to guessing that you have survey installed in a 
> non-standard place, and R CMD check isn't finding it.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

Actually, survey sits in the very same library with all other packages, and
boot (called from within a relaimpo function) works fine. 
I just fixed the encoding warning (adding "Encoding: latin1" to the
description file), and tried R CMD check once more. Surprisingly, the check
now also ran all examples without errors - I can only guess that there has
been an issue with a path with some nonstandard character in the way (though
survey is not located in such a path). Anyway, it works now.

Regards, Ulrike
-- 
View this message in context: http://www.nabble.com/R-CMD-check-problem-on-R-2.6.1-RC-tf4855530.html#a13900659
Sent from the R devel mailing list archive at Nabble.com.


From leviwaldron at gmail.com  Thu Nov 22 20:00:53 2007
From: leviwaldron at gmail.com (leviwaldron at gmail.com)
Date: Thu, 22 Nov 2007 20:00:53 +0100 (CET)
Subject: [Rd] package gsl assumes incorrect gcc version during install
	(PR#10451)
Message-ID: <20071122190053.A34C5283416A@mail.pubhealth.ku.dk>

Full_Name: Levi Waldron
Version: 2.5.1
OS: Ubuntu Gutsy
Submission from: (NULL) (206.248.157.88)


I installed libgsl0-dev then tried to install the gsl cran package,
unsuccessfully (see output below).  As a workaround I created a symbolic link to
/usr/bin/gcc-4.2, ie:

sudo ln -s /usr/bin/gcc-4.1 /usr/bin/gcc-4.2

The correct behavior of the gsl package should be to use the executable
'/usr/bin/gcc' which is already linked to the current gcc version.


> install.packages("gsl",dependencies=T) 
Warning in install.packages("gsl", dependencies = T) : 
         argument 'lib' is missing: using '/usr/local/lib/R/site-library'
--- Please select a CRAN mirror for use in this session ---
Loading Tcl/Tk interface ... done
trying URL 'http://probability.ca/cran/src/contrib/gsl_1.8-8.tar.gz'
Content type 'application/x-tar' length 59084 bytes
opened URL
==================================================
downloaded 57Kb

* Installing *source* package 'gsl' ...
checking for gcc... gcc
checking for C compiler default output... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables... 
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ANSI C... none needed
checking for gsl_sf_airy_Ai_e in -lgsl... yes
checking how to run the C preprocessor... gcc -E
checking for egrep... grep -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking gsl/gsl_version.h usability... yes
checking gsl/gsl_version.h presence... yes
checking for gsl/gsl_version.h... yes
checking if GSL version >= 1.8... yes
configure: creating ./config.status
** libs
gcc-4.2 -std=gnu99 -I/usr/share/R/include -I/usr/share/R/include      -fpic  -g
-O2 -c airy.c -o airy.o
/bin/bash: gcc-4.2: command not found
make: *** [airy.o] Error 127
chmod: cannot access `/usr/local/lib/R/site-library/gsl/libs/*': No such file or
directory
ERROR: compilation failed for package 'gsl'
** Removing '/usr/local/lib/R/site-library/gsl'

The downloaded packages are in
        /tmp/RtmpW60zFl/downloaded_packages
Warning message:
installation of package 'gsl' had non-zero exit status in:
install.packages("gsl", dependencies = T) 

> version
               _                           
platform       i486-pc-linux-gnu           
arch           i486                        
os             linux-gnu                   
system         i486, linux-gnu             
status                                     
major          2                           
minor          5.1                         
year           2007                        
month          06                          
day            27                          
svn rev        42083                       
language       R                           
version.string R version 2.5.1 (2007-06-27)
>


From rjvbertin at gmail.com  Fri Nov 23 12:00:28 2007
From: rjvbertin at gmail.com (rjvbertin at gmail.com)
Date: Fri, 23 Nov 2007 12:00:28 +0100 (CET)
Subject: [Rd] MacOSX 10.4.11 update breaks tests/lapack.R (R 2.6.0)?
	(PR#10454)
Message-ID: <20071123110028.3F9082834156@mail.pubhealth.ku.dk>

Hello,

It seems the recent Mac OS X 10.4.11 update installed a new
libBLAS.dylib in the Accelerate framework which either contains a bug
itself or exposes a bug somewhere in R's lapack code on the PowerPC G4
and G5.
My build of R 2.6.0 executed the tests/lapack.R code succesfully when
I upgraded when 2.6.0 was released. After the OS update, it now
crashes. This happens both with the version I built using Apple's gcc
4.0.1 and gfortran 4.2.2, and with the version built completely with
gcc 4.2.2 .

> R

R version 2.6.0 (2007-10-03)
Copyright (C) 2007 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

##> source("R-2.6.0/tests/lapack.R", echo=TRUE, verbose=TRUE)
'envir' chosen:<environment: R_GlobalEnv>
encoding = "native.enc" chosen
--> parsed 40 expressions; now eval(.)ing them:

>>>> eval(expression_nr. 1 )
                 =================

##> ## tests of R functions based on the lapack module
##>
##> options(digits=4)
curr.fun: symbol options
 .. after 'expression(options(digits=4))'

<SNIP>

##> sm[] <- as.complex(sm)
curr.fun: symbol <-
 .. after 'expression(sm[] <- as.complex(sm))'

>>>> eval(expression_nr. 35 )
                 =================

##> Ceigenok(sm, eigen(sm))

 *** caught bus error ***
address 0x1, cause 'invalid alignment'

Traceback:
 1: .Call("La_rs_cmplx", x, only.values, PACKAGE = "base")
 2: eigen(sm)
 3: apply(A, 2, function(x) x * sign(Re(x[1])))
 4: fixsign(E$vectors)
 5: print(fixsign(E$vectors))
 6: Ceigenok(sm, eigen(sm))
 7: eval.with.vis(expr, envir, enclos)
 8: eval.with.vis(ei, envir)
 9: source("~/cworks/new/R-2.6.0/tests/lapack.R", echo = TRUE, verbose = TRUE)

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace

*************** OS X Crash report:
Date/Time:      2007-11-23 11:19:19.135 +0100
OS Version:     10.4.11 (Build 8S165)
Report Version: 4

Command: R
Path:    /Library/Frameworks/R.framework/Resources/bin/exec/R
Parent:  tcsh [2437]

Version: ??? (???)

PID:    3167
Thread: 0

Exception:  EXC_BAD_ACCESS (0x0001)
Codes:      KERN_PROTECTION_FAILURE (0x0002) at 0x00000001

Thread 0 Crashed:
0   libBLAS.dylib    	0x920fc374 atl_f77wrap_zdotc__ + 80
1   libBLAS.dylib    	0x920f7864 zdotc_ + 60
2   libRlapack.dylib 	0x013701a0 zhetd2_ + 960
3   libRlapack.dylib 	0x0136fcdc zhetrd_ + 1900
4   libRlapack.dylib 	0x01370ad8 zheev_ + 1016
5   lapack.so        	0x010a4038 modLa_rs_cmplx + 392
6   libR.dylib       	0x003c99e8 La_rs_cmplx + 72
7   libR.dylib       	0x00372380 do_dotcall + 16864
8   libR.dylib       	0x003a170c Rf_eval + 1804
9   libR.dylib       	0x003a14dc Rf_eval + 1244
10  libR.dylib       	0x003a45f4 do_set + 980
11  libR.dylib       	0x003a14dc Rf_eval + 1244
12  libR.dylib       	0x003a2b08 do_begin + 104
13  libR.dylib       	0x003a14dc Rf_eval + 1244
14  libR.dylib       	0x003a14dc Rf_eval + 1244
15  libR.dylib       	0x003a2b08 do_begin + 104
16  libR.dylib       	0x003a14dc Rf_eval + 1244
17  libR.dylib       	0x003a14dc Rf_eval + 1244
18  libR.dylib       	0x003a2b08 do_begin + 104
19  libR.dylib       	0x003a14dc Rf_eval + 1244
20  libR.dylib       	0x003a4f58 Rf_applyClosure + 728
21  libR.dylib       	0x003a13f0 Rf_eval + 1008
22  libR.dylib       	0x003a62c8 forcePromise + 184
23  libR.dylib       	0x003a12c8 Rf_eval + 712
24  libR.dylib       	0x003a1650 Rf_eval + 1616
25  libR.dylib       	0x003a2714 Rf_DispatchOrEval + 244
26  libR.dylib       	0x0049d190 do_subset3 + 384
27  libR.dylib       	0x003a14dc Rf_eval + 1244
28  libR.dylib       	0x003a62c8 forcePromise + 184
29  libR.dylib       	0x003a12c8 Rf_eval + 712
30  libR.dylib       	0x003a1650 Rf_eval + 1616
31  libR.dylib       	0x003a62c8 forcePromise + 184
32  libR.dylib       	0x003a12c8 Rf_eval + 712
33  libR.dylib       	0x003a1650 Rf_eval + 1616
34  libR.dylib       	0x003a2488 Rf_evalList + 168
35  libR.dylib       	0x003a15a8 Rf_eval + 1448
36  libR.dylib       	0x003a45f4 do_set + 980
37  libR.dylib       	0x003a14dc Rf_eval + 1244
38  libR.dylib       	0x003a2b08 do_begin + 104
39  libR.dylib       	0x003a14dc Rf_eval + 1244
40  libR.dylib       	0x003a4f58 Rf_applyClosure + 728
41  libR.dylib       	0x003a13f0 Rf_eval + 1008
42  libR.dylib       	0x003a3cdc applydefine + 60
43  libR.dylib       	0x003a14dc Rf_eval + 1244
44  libR.dylib       	0x003a2b08 do_begin + 104
45  libR.dylib       	0x003a14dc Rf_eval + 1244
46  libR.dylib       	0x003a4f58 Rf_applyClosure + 728
47  libR.dylib       	0x003a13f0 Rf_eval + 1008
48  libR.dylib       	0x003a62c8 forcePromise + 184
49  libR.dylib       	0x003a12c8 Rf_eval + 712
50  libR.dylib       	0x003eafac do_usemethod + 1228
51  libR.dylib       	0x003a14dc Rf_eval + 1244
52  libR.dylib       	0x003a4f58 Rf_applyClosure + 728
53  libR.dylib       	0x003a13f0 Rf_eval + 1008
54  libR.dylib       	0x003a2b08 do_begin + 104
55  libR.dylib       	0x003a14dc Rf_eval + 1244
56  libR.dylib       	0x003a4f58 Rf_applyClosure + 728
57  libR.dylib       	0x003a13f0 Rf_eval + 1008
58  libR.dylib       	0x003a1eac do_eval + 1868
59  libR.dylib       	0x003e7d2c do_internal + 636
60  libR.dylib       	0x003a14dc Rf_eval + 1244
61  libR.dylib       	0x003a4f58 Rf_applyClosure + 728
62  libR.dylib       	0x003a13f0 Rf_eval + 1008
63  libR.dylib       	0x003a45f4 do_set + 980
64  libR.dylib       	0x003a14dc Rf_eval + 1244
65  libR.dylib       	0x003a2b08 do_begin + 104
66  libR.dylib       	0x003a14dc Rf_eval + 1244
67  libR.dylib       	0x003a31ac do_for + 572
68  libR.dylib       	0x003a14dc Rf_eval + 1244
69  libR.dylib       	0x003a2b08 do_begin + 104
70  libR.dylib       	0x003a14dc Rf_eval + 1244
71  libR.dylib       	0x003a4f58 Rf_applyClosure + 728
72  libR.dylib       	0x003a13f0 Rf_eval + 1008
73  libR.dylib       	0x003cf7cc Rf_ReplIteration + 332
74  libR.dylib       	0x003cff04 run_Rmainloop + 212
75  R                	0x00001d80 main + 48
76  R                	0x00001a9c _start + 760
77  R                	0x000017a0 start + 48

Thread 0 crashed with PPC Thread State 64:
  srr0: 0x00000000920fc374 srr1: 0x000000000000f030
    vrsave: 0x0000000000000000
    cr: 0x28002224          xer: 0x0000000000000004   lr:
0x00000000920f7864  ctr: 0x00000000920f7828
    r0: 0x000000003fd60f2c   r1: 0x00000000bfff24c0   r2:
0x0000000001384074   r3: 0x0000000002afe818
    r4: 0x0000000001384074   r5: 0x000000003ff00000   r6:
0x0000000001384074   r7: 0x0000000000000001
    r8: 0x00000000bfff24f8   r9: 0x0000000000000005  r10:
0x0000000000000000  r11: 0x0000000001385110
   r12: 0x00000000920f7828  r13: 0x00000000bfff2570  r14:
0x0000000000000004  r15: 0x0000000001384074
   r16: 0x000000000137fde8  r17: 0x00000000bfff256c  r18:
0x0000000002b098e8  r19: 0x00000000bfff2839
   r20: 0x0000000001384074  r21: 0x00000000019c7db0  r22:
0x0000000000000006  r23: 0x00000000bfff283c
   r24: 0x0000000002afe818  r25: 0x00000000bfff2688  r26:
0x0000000000000005  r27: 0x00000000fffffffa
   r28: 0x0000000000000001  r29: 0x000000000113e708  r30:
0x00000000bfff256c  r31: 0x000000000136fde8

Binary Images Description:
    0x1000 -     0x1fff R 	/Library/Frameworks/R.framework/Resources/bin/exec/R
    0x4000 -     0x5fff libRblas.dylib
	/Library/Frameworks/R.framework/Resources/lib/libRblas.dylib
   0x3c000 -    0x48fff libgcc_s.1.dylib
	/usr/local/gnu/gcc/4.2.2/lib/libgcc_s.1.dylib
   0xb5000 -    0xecfff libreadline.5.1.dylib
	/usr/local/lib/libreadline.5.1.dylib
  0x24a000 -   0x24ffff methods.so
	/Library/Frameworks/R.framework/Resources/library/methods/libs/methods.so
  0x2e9000 -   0x551fff libR.dylib
	/Library/Frameworks/R.framework/Resources/lib/libR.dylib
  0x5d2000 -   0x65dfff libgfortran.2.dylib
	/usr/local/gnu/gcc/4.2.2/lib/libgfortran.2.dylib
 0x1008000 -  0x102dfff grDevices.so
	/Library/Frameworks/R.framework/Resources/library/grDevices/libs/grDevices.so
 0x10a2000 -  0x10a8fff lapack.so
	/Library/Frameworks/R.framework/Resources/modules/lapack.so
 0x1205000 -  0x125dfff stats.so
	/Library/Frameworks/R.framework/Resources/library/stats/libs/stats.so
 0x1266000 -  0x1384fff libRlapack.dylib
	/Library/Frameworks/R.framework/Resources/lib/libRlapack.dylib
0x8fe00000 - 0x8fe52fff dyld 46.16	/usr/lib/dyld
0x90000000 - 0x901bcfff libSystem.B.dylib 	/usr/lib/libSystem.B.dylib
0x90214000 - 0x90219fff libmathCommon.A.dylib
	/usr/lib/system/libmathCommon.A.dylib
0x9021b000 - 0x90268fff com.apple.CoreText 1.0.4
(???)	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreText.framework/Versions/A/CoreText
0x90293000 - 0x90344fff ATS
	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ATS.framework/Versions/A/ATS
0x90373000 - 0x9072efff com.apple.CoreGraphics 1.258.77
(???)	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/CoreGraphics.framework/Versions/A/CoreGraphics
0x907bb000 - 0x90894fff com.apple.CoreFoundation 6.4.8
(368.31)	/System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation
0x908dd000 - 0x908ddfff com.apple.CoreServices 10.4
(???)	/System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices
0x908df000 - 0x909e1fff libicucore.A.dylib 	/usr/lib/libicucore.A.dylib
0x90a3b000 - 0x90abffff libobjc.A.dylib 	/usr/lib/libobjc.A.dylib
0x90ae9000 - 0x90b5bfff com.apple.framework.IOKit 1.4
(???)	/System/Library/Frameworks/IOKit.framework/Versions/A/IOKit
0x90b71000 - 0x90b83fff libauto.dylib 	/usr/lib/libauto.dylib
0x90b8a000 - 0x90e61fff com.apple.CoreServices.CarbonCore
681.17	/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CarbonCore.framework/Versions/A/CarbonCore
0x90ec7000 - 0x90f47fff com.apple.CoreServices.OSServices
4.1	/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/OSServices.framework/Versions/A/OSServices
0x90f91000 - 0x90fd3fff com.apple.CFNetwork 4.0
(129.22)	/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CFNetwork.framework/Versions/A/CFNetwork
0x90fe8000 - 0x91000fff com.apple.WebServices 1.1.2
(1.1.0)	/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/WebServicesCore.framework/Versions/A/WebServicesCore
0x91010000 - 0x91091fff com.apple.SearchKit
1.0.7	/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/SearchKit.framework/Versions/A/SearchKit
0x910d7000 - 0x91100fff com.apple.Metadata 10.4.4
(121.36)	/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/Metadata.framework/Versions/A/Metadata
0x91111000 - 0x9111ffff libz.1.dylib 	/usr/lib/libz.1.dylib
0x91122000 - 0x912ddfff com.apple.security 4.6
(29770)	/System/Library/Frameworks/Security.framework/Versions/A/Security
0x913dc000 - 0x913e5fff com.apple.DiskArbitration
2.1.2	/System/Library/Frameworks/DiskArbitration.framework/Versions/A/DiskArbitration
0x913ec000 - 0x913f4fff libbsm.dylib 	/usr/lib/libbsm.dylib
0x913f8000 - 0x91420fff com.apple.SystemConfiguration
1.8.3	/System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration
0x91433000 - 0x9143efff libgcc_s.1.dylib 	/usr/lib/libgcc_s.1.dylib
0x91443000 - 0x914befff com.apple.audio.CoreAudio
3.0.5	/System/Library/Frameworks/CoreAudio.framework/Versions/A/CoreAudio
0x914fb000 - 0x914fbfff com.apple.ApplicationServices 10.4
(???)	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/ApplicationServices
0x914fd000 - 0x91535fff com.apple.AE 1.5
(297)	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/AE.framework/Versions/A/AE
0x91550000 - 0x91622fff com.apple.ColorSync
4.4.9	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ColorSync.framework/Versions/A/ColorSync
0x91675000 - 0x91706fff com.apple.print.framework.PrintCore 4.6
(177.13)	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/PrintCore.framework/Versions/A/PrintCore
0x9174d000 - 0x91804fff com.apple.QD 3.10.25
(???)	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/QD.framework/Versions/A/QD
0x91841000 - 0x9189ffff com.apple.HIServices 1.5.3
(???)	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/HIServices.framework/Versions/A/HIServices
0x918ce000 - 0x918effff com.apple.LangAnalysis
1.6.1	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/LangAnalysis.framework/Versions/A/LangAnalysis
0x91903000 - 0x91928fff com.apple.FindByContent
1.5	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/FindByContent.framework/Versions/A/FindByContent
0x9193b000 - 0x9197dfff com.apple.LaunchServices
182	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/LaunchServices
0x91999000 - 0x919adfff com.apple.speech.synthesis.framework
3.3	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/SpeechSynthesis.framework/Versions/A/SpeechSynthesis
0x919bb000 - 0x91a01fff com.apple.ImageIO.framework
1.5.6	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/ImageIO
0x91a18000 - 0x91adffff libcrypto.0.9.7.dylib 	/usr/lib/libcrypto.0.9.7.dylib
0x91b2d000 - 0x91b42fff libcups.2.dylib 	/usr/lib/libcups.2.dylib
0x91b47000 - 0x91b65fff libJPEG.dylib
	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libJPEG.dylib
0x91b6b000 - 0x91c22fff libJP2.dylib
	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libJP2.dylib
0x91c71000 - 0x91c75fff libGIF.dylib
	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libGIF.dylib
0x91c77000 - 0x91ce1fff libRaw.dylib
	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libRaw.dylib
0x91ce6000 - 0x91d23fff libTIFF.dylib
	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libTIFF.dylib
0x91d2a000 - 0x91d44fff libPng.dylib
	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libPng.dylib
0x91d49000 - 0x91d4cfff libRadiance.dylib
	/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources/libRadiance.dylib
0x91d4e000 - 0x91e2cfff libxml2.2.dylib 	/usr/lib/libxml2.2.dylib
0x91e4c000 - 0x91e4cfff com.apple.Accelerate 1.2.2 (Accelerate
1.2.2)	/System/Library/Frameworks/Accelerate.framework/Versions/A/Accelerate
0x91e4e000 - 0x91f33fff com.apple.vImage
2.4	/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vImage.framework/Versions/A/vImage
0x91f3b000 - 0x91f5afff com.apple.Accelerate.vecLib 3.2.2 (vecLib
3.2.2)	/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/vecLib
0x91fc6000 - 0x92034fff libvMisc.dylib
	/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvMisc.dylib
0x9203f000 - 0x920d4fff libvDSP.dylib
	/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libvDSP.dylib
0x920ee000 - 0x92676fff libBLAS.dylib
	/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib
0x926a9000 - 0x929d4fff libLAPACK.dylib
	/System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib
0x92a04000 - 0x92af2fff libiconv.2.dylib 	/usr/lib/libiconv.2.dylib
0x92af5000 - 0x92b7dfff com.apple.DesktopServices
1.3.6	/System/Library/PrivateFrameworks/DesktopServicesPriv.framework/Versions/A/DesktopServicesPriv
0x92bbe000 - 0x92de9fff com.apple.Foundation 6.4.9
(567.36)	/System/Library/Frameworks/Foundation.framework/Versions/C/Foundation
0x92f16000 - 0x92f34fff libGL.dylib
	/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib
0x92f3f000 - 0x92f99fff libGLU.dylib
	/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLU.dylib
0x92fe5000 - 0x92ff5fff com.apple.speech.recognition.framework
3.4	/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/SpeechRecognition.framework/Versions/A/SpeechRecognition
0x9324e000 - 0x9326bfff com.apple.audio.SoundManager
3.9	/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/CarbonSound.framework/Versions/A/CarbonSound
0x93293000 - 0x935a1fff com.apple.HIToolbox 1.4.10
(???)	/System/Library/Frameworks/Carbon.framework/Versions/A/Frameworks/HIToolbox.framework/Versions/A/HIToolbox
0x936f1000 - 0x936fdfff com.apple.opengl
1.4.7	/System/Library/Frameworks/OpenGL.framework/Versions/A/OpenGL
0x93799000 - 0x93dccfff com.apple.AppKit 6.4.9
(824.44)	/System/Library/Frameworks/AppKit.framework/Versions/C/AppKit
0x94159000 - 0x941cbfff com.apple.CoreData 91
(92.1)	/System/Library/Frameworks/CoreData.framework/Versions/A/CoreData
0x94204000 - 0x942c9fff com.apple.audio.toolbox.AudioToolbox
1.4.7	/System/Library/Frameworks/AudioToolbox.framework/Versions/A/AudioToolbox
0x9431c000 - 0x9431cfff com.apple.audio.units.AudioUnit
1.4	/System/Library/Frameworks/AudioUnit.framework/Versions/A/AudioUnit
0x9431e000 - 0x944defff com.apple.QuartzCore
1.4.12	/System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore
0x94528000 - 0x94565fff libsqlite3.0.dylib 	/usr/lib/libsqlite3.0.dylib
0x9456d000 - 0x945bdfff libGLImage.dylib
	/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGLImage.dylib
0x945c6000 - 0x945e0fff com.apple.CoreVideo
1.4.2	/System/Library/Frameworks/CoreVideo.framework/Versions/A/CoreVideo
0x945f1000 - 0x94611fff libmx.A.dylib 	/usr/lib/libmx.A.dylib
0x97093000 - 0x970c1fff libncurses.5.4.dylib 	/usr/lib/libncurses.5.4.dylib
0x97b13000 - 0x97b32fff com.apple.vecLib 3.2.2 (vecLib
3.2.2)	/System/Library/Frameworks/vecLib.framework/Versions/A/vecLib

Model: PowerBook5,4, BootROM 4.8.6f0, 1 processors, PowerPC G4  (1.1),
1.5 GHz, 1 GB
Graphics: ATI Mobility Radeon 9700, ATY,RV360M11, AGP, 128 MB
Memory Module: SODIMM0/J25LOWER, 512 MB, DDR SDRAM, PC2700U-25330
Memory Module: SODIMM1/J25UPPER, 512 MB, DDR SDRAM, PC2700U-25330
AirPort: AirPort Extreme, 405.1 (3.90.34.0.p18)
Modem: Jump, V.92, Version 1.0
Bluetooth: Version 1.9.5f4, 2 service, 0 devices, 1 incoming serial ports
Network Service: Built-in Ethernet, Ethernet, en0
PCI Card: TXN,PCIXXXX-00, cardbus, PC Card
Parallel ATA Device: MATSHITACD-RW  CW-8123
Parallel ATA Device: HTE721080G9AT00, 74.53 GB
USB Device: Bluetooth USB Host Controller, Apple, Inc., Up to 12 Mb/sec, 500 mA


From twoutopias at gmail.com  Thu Nov 22 22:25:03 2007
From: twoutopias at gmail.com (twoutopias at gmail.com)
Date: Thu, 22 Nov 2007 22:25:03 +0100 (CET)
Subject: [Rd] bug in getGraphicsEvent (PR#10453)
Message-ID: <20071122212503.ABE56283460C@mail.pubhealth.ku.dk>

Full_Name: Seth Roberts
Version: 2.6.0
OS: Windows XP
Submission from: (NULL) (71.139.162.236)


Using getGraphicsEvent produces stack imbalance warnings. This started after I
installed 2.6.0; it did not happen with 2.5.1. 

Running the example given in the user manual (retrieved via ?getGraphicsEvent)
produces the following errors:

Key <2>
Key <1>
Buttons  0  at  0.991317 0.9942029 
Warning: stack imbalance in 'getGraphicsEvent', 7 then 17
Warning: stack imbalance in '.Internal', 6 then 16
[1] "Done"

I wrote the following program:

function () 
{plot(1:5)
getGraphicsEvent(onKeybd=get.key)
}

get.key
function(key){key}

running the program, switching to the graphics window and typing "4" produced:

Waiting for input
Warning: stack imbalance in 'getGraphicsEvent', 13 then 14
Warning: stack imbalance in '.Internal', 12 then 13
Warning: stack imbalance in '{', 6 then 7
[1] "4"


From sgiannerini at gmail.com  Fri Nov 23 18:33:00 2007
From: sgiannerini at gmail.com (Simone Giannerini)
Date: Fri, 23 Nov 2007 18:33:00 +0100
Subject: [Rd] Bug in pacf -- Proposed patch
Message-ID: <3c12769c0711230933v161382bfjd19efdc9872ea4df@mail.gmail.com>

Dear all,

following the thread

http://tolstoy.newcastle.edu.au/R/e2/devel/07/09/4338.html

regarding the bug in the partial autocorrelation function for
multivariate time series.
I have prepared a web page with patches and relevant information.

http://www2.stat.unibo.it/giannerini/R/pacf.htm

Please do not hesitate to contact me for further clarifications

regards

Simone

-- 
______________________________________________________

Simone Giannerini
Dipartimento di Scienze Statistiche "Paolo Fortunati"
Universita' di Bologna
Via delle belle arti 41 - 40126  Bologna,  ITALY
Tel: +39 051 2098262  Fax: +39 051 232153
http://www2.stat.unibo.it/giannerini/


From sgiannerini at gmail.com  Fri Nov 23 18:35:31 2007
From: sgiannerini at gmail.com (sgiannerini at gmail.com)
Date: Fri, 23 Nov 2007 18:35:31 +0100 (CET)
Subject: [Rd] Bug in pacf -- Proposed patch (PR#10455)
Message-ID: <20071123173531.8712F2834156@mail.pubhealth.ku.dk>

Dear all,

following the thread

http://tolstoy.newcastle.edu.au/R/e2/devel/07/09/4338.html

regarding the bug in the partial autocorrelation function for
multivariate time series.
I have prepared a web page with patches and relevant information.

http://www2.stat.unibo.it/giannerini/R/pacf.htm

Please do not hesitate to contact me for further clarifications

regards

Simone

-- 
______________________________________________________

Simone Giannerini
Dipartimento di Scienze Statistiche "Paolo Fortunati"
Universita' di Bologna
Via delle belle arti 41 - 40126  Bologna,  ITALY
Tel: +39 051 2098262  Fax: +39 051 232153
http://www2.stat.unibo.it/giannerini/


From edd at debian.org  Fri Nov 23 19:28:34 2007
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 23 Nov 2007 12:28:34 -0600
Subject: [Rd] package gsl assumes incorrect gcc version during
	install	(PR#10451)
In-Reply-To: <20071122190053.A34C5283416A@mail.pubhealth.ku.dk>
References: <20071122190053.A34C5283416A@mail.pubhealth.ku.dk>
Message-ID: <18247.7122.801858.296939@ron.nulle.part>


On 22 November 2007 at 20:00, leviwaldron at gmail.com wrote:
| Full_Name: Levi Waldron
| Version: 2.5.1
| OS: Ubuntu Gutsy
| Submission from: (NULL) (206.248.157.88)
| 
| 
| I installed libgsl0-dev then tried to install the gsl cran package,
| unsuccessfully (see output below).  As a workaround I created a symbolic link to
| /usr/bin/gcc-4.2, ie:
| 
| sudo ln -s /usr/bin/gcc-4.1 /usr/bin/gcc-4.2

I would strongly advise not to do that. 

| The correct behavior of the gsl package should be to use the executable
| '/usr/bin/gcc' which is already linked to the current gcc version.

No. You misunderstand. It has nothing to do with the package. 

When R is built, it 'stores' its compiler version etc in the file
Makeconf. The Debian (and hence Ubuntu) packages store that file for you as
/etc/R/Makeconf via a link; the file is as always in $RHOME/etc/Makeconf.

This file defines a variable CC for the compiler. All you need to do is to
set it back to 'gcc' from its value 'gcc-4.2'.  

This really is a local admin issue (ie you need to fix it) and not a problem 
with R, or gsl.

If you got R from Ubuntu, file a bug report _with Ubuntu_ as they seem to
have forgotten to switch from gcc-4.2 (which we use in Debian as default) to
gcc-4.1 (which is Ubuntu's default).
  
| > install.packages("gsl",dependencies=T) 
| Warning in install.packages("gsl", dependencies = T) : 
|          argument 'lib' is missing: using '/usr/local/lib/R/site-library'
| --- Please select a CRAN mirror for use in this session ---
| Loading Tcl/Tk interface ... done
| trying URL 'http://probability.ca/cran/src/contrib/gsl_1.8-8.tar.gz'
| Content type 'application/x-tar' length 59084 bytes
| opened URL
| ==================================================
| downloaded 57Kb
| 
| * Installing *source* package 'gsl' ...
| checking for gcc... gcc
| checking for C compiler default output... a.out
| checking whether the C compiler works... yes
| checking whether we are cross compiling... no
| checking for suffix of executables... 
| checking for suffix of object files... o
| checking whether we are using the GNU C compiler... yes
| checking whether gcc accepts -g... yes
| checking for gcc option to accept ANSI C... none needed
| checking for gsl_sf_airy_Ai_e in -lgsl... yes
| checking how to run the C preprocessor... gcc -E
| checking for egrep... grep -E
| checking for ANSI C header files... yes
| checking for sys/types.h... yes
| checking for sys/stat.h... yes
| checking for stdlib.h... yes
| checking for string.h... yes
| checking for memory.h... yes
| checking for strings.h... yes
| checking for inttypes.h... yes
| checking for stdint.h... yes
| checking for unistd.h... yes
| checking gsl/gsl_version.h usability... yes
| checking gsl/gsl_version.h presence... yes
| checking for gsl/gsl_version.h... yes
| checking if GSL version >= 1.8... yes
| configure: creating ./config.status
| ** libs
| gcc-4.2 -std=gnu99 -I/usr/share/R/include -I/usr/share/R/include      -fpic  -g
| -O2 -c airy.c -o airy.o
| /bin/bash: gcc-4.2: command not found
| make: *** [airy.o] Error 127
| chmod: cannot access `/usr/local/lib/R/site-library/gsl/libs/*': No such file or
| directory
| ERROR: compilation failed for package 'gsl'
| ** Removing '/usr/local/lib/R/site-library/gsl'
| 
| The downloaded packages are in
|         /tmp/RtmpW60zFl/downloaded_packages
| Warning message:
| installation of package 'gsl' had non-zero exit status in:
| install.packages("gsl", dependencies = T) 
| 
| > version
|                _                           
| platform       i486-pc-linux-gnu           
| arch           i486                        
| os             linux-gnu                   
| system         i486, linux-gnu             
| status                                     
| major          2                           
| minor          5.1                         
| year           2007                        
| month          06                          
| day            27                          
| svn rev        42083                       
| language       R                           
| version.string R version 2.5.1 (2007-06-27)

Also note that CRAN has prebuilt versions of the current R release, ie 2.6.0,
for Ubuntu Gutsy, see $CRAN/bin/linux/ubuntu

The CRAN version of R for Ubuntu is quite possibly of better quality than the
distro's version.

Dirk

| >
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Three out of two people have difficulties with fractions.


From edd at debian.org  Fri Nov 23 19:30:16 2007
From: edd at debian.org (edd at debian.org)
Date: Fri, 23 Nov 2007 19:30:16 +0100 (CET)
Subject: [Rd] package gsl assumes incorrect gcc version during install
	(PR#10456)
Message-ID: <20071123183016.CB3352834611@mail.pubhealth.ku.dk>


On 22 November 2007 at 20:00, leviwaldron at gmail.com wrote:
| Full_Name: Levi Waldron
| Version: 2.5.1
| OS: Ubuntu Gutsy
| Submission from: (NULL) (206.248.157.88)
| 
| 
| I installed libgsl0-dev then tried to install the gsl cran package,
| unsuccessfully (see output below).  As a workaround I created a symbolic link to
| /usr/bin/gcc-4.2, ie:
| 
| sudo ln -s /usr/bin/gcc-4.1 /usr/bin/gcc-4.2

I would strongly advise not to do that. 

| The correct behavior of the gsl package should be to use the executable
| '/usr/bin/gcc' which is already linked to the current gcc version.

No. You misunderstand. It has nothing to do with the package. 

When R is built, it 'stores' its compiler version etc in the file
Makeconf. The Debian (and hence Ubuntu) packages store that file for you as
/etc/R/Makeconf via a link; the file is as always in $RHOME/etc/Makeconf.

This file defines a variable CC for the compiler. All you need to do is to
set it back to 'gcc' from its value 'gcc-4.2'.  

This really is a local admin issue (ie you need to fix it) and not a problem 
with R, or gsl.

If you got R from Ubuntu, file a bug report _with Ubuntu_ as they seem to
have forgotten to switch from gcc-4.2 (which we use in Debian as default) to
gcc-4.1 (which is Ubuntu's default).
  
| > install.packages("gsl",dependencies=T) 
| Warning in install.packages("gsl", dependencies = T) : 
|          argument 'lib' is missing: using '/usr/local/lib/R/site-library'
| --- Please select a CRAN mirror for use in this session ---
| Loading Tcl/Tk interface ... done
| trying URL 'http://probability.ca/cran/src/contrib/gsl_1.8-8.tar.gz'
| Content type 'application/x-tar' length 59084 bytes
| opened URL
| ==================================================
| downloaded 57Kb
| 
| * Installing *source* package 'gsl' ...
| checking for gcc... gcc
| checking for C compiler default output... a.out
| checking whether the C compiler works... yes
| checking whether we are cross compiling... no
| checking for suffix of executables... 
| checking for suffix of object files... o
| checking whether we are using the GNU C compiler... yes
| checking whether gcc accepts -g... yes
| checking for gcc option to accept ANSI C... none needed
| checking for gsl_sf_airy_Ai_e in -lgsl... yes
| checking how to run the C preprocessor... gcc -E
| checking for egrep... grep -E
| checking for ANSI C header files... yes
| checking for sys/types.h... yes
| checking for sys/stat.h... yes
| checking for stdlib.h... yes
| checking for string.h... yes
| checking for memory.h... yes
| checking for strings.h... yes
| checking for inttypes.h... yes
| checking for stdint.h... yes
| checking for unistd.h... yes
| checking gsl/gsl_version.h usability... yes
| checking gsl/gsl_version.h presence... yes
| checking for gsl/gsl_version.h... yes
| checking if GSL version >= 1.8... yes
| configure: creating ./config.status
| ** libs
| gcc-4.2 -std=gnu99 -I/usr/share/R/include -I/usr/share/R/include      -fpic  -g
| -O2 -c airy.c -o airy.o
| /bin/bash: gcc-4.2: command not found
| make: *** [airy.o] Error 127
| chmod: cannot access `/usr/local/lib/R/site-library/gsl/libs/*': No such file or
| directory
| ERROR: compilation failed for package 'gsl'
| ** Removing '/usr/local/lib/R/site-library/gsl'
| 
| The downloaded packages are in
|         /tmp/RtmpW60zFl/downloaded_packages
| Warning message:
| installation of package 'gsl' had non-zero exit status in:
| install.packages("gsl", dependencies = T) 
| 
| > version
|                _                           
| platform       i486-pc-linux-gnu           
| arch           i486                        
| os             linux-gnu                   
| system         i486, linux-gnu             
| status                                     
| major          2                           
| minor          5.1                         
| year           2007                        
| month          06                          
| day            27                          
| svn rev        42083                       
| language       R                           
| version.string R version 2.5.1 (2007-06-27)

Also note that CRAN has prebuilt versions of the current R release, ie 2.6.0,
for Ubuntu Gutsy, see $CRAN/bin/linux/ubuntu

The CRAN version of R for Ubuntu is quite possibly of better quality than the
distro's version.

Dirk

| >
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Three out of two people have difficulties with fractions.


From simon.urbanek at r-project.org  Fri Nov 23 20:07:14 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 23 Nov 2007 14:07:14 -0500
Subject: [Rd] MacOSX 10.4.11 update breaks tests/lapack.R (R 2.6.0)?
	(PR#10454)
In-Reply-To: <20071123110028.3F9082834156@mail.pubhealth.ku.dk>
References: <20071123110028.3F9082834156@mail.pubhealth.ku.dk>
Message-ID: <E77F7953-E208-43A2-AA14-4876391E52FC@r-project.org>

Ren?,

On Nov 23, 2007, at 6:00 AM, rjvbertin at gmail.com wrote:

> It seems the recent Mac OS X 10.4.11 update installed a new  
> libBLAS.dylib in the Accelerate framework which either contains a  
> bug itself or exposes a bug somewhere in R's lapack code on the  
> PowerPC G4 and G5.
> My build of R 2.6.0 executed the tests/lapack.R code succesfully  
> when I upgraded when 2.6.0 was released. After the OS update, it  
> now crashes. This happens both with the version I built using  
> Apple's gcc 4.0.1 and gfortran 4.2.2, and with the version built  
> completely with gcc 4.2.2 .
>

this is almost certainly a problem with the complex ABI (i.e. the  
Fortran compiler and vecLib/ALTAS disagree). Normally R detects  
complex ABI mismatch and either enables a work-around (vecLib) or  
disables BLAS (others). If the ABI changed between versions, you'll  
have to re-compile R. If the problem still persists after a re- 
compile, please send me your config.log.

Cheers,
Simon


>> R
>
> R version 2.6.0 (2007-10-03)
> Copyright (C) 2007 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
>
> ##> source("R-2.6.0/tests/lapack.R", echo=TRUE, verbose=TRUE)
> 'envir' chosen:<environment: R_GlobalEnv>
> encoding = "native.enc" chosen
> --> parsed 40 expressions; now eval(.)ing them:
>
>>>>> eval(expression_nr. 1 )
>                  =================
>
> ##> ## tests of R functions based on the lapack module
> ##>
> ##> options(digits=4)
> curr.fun: symbol options
>  .. after 'expression(options(digits=4))'
>
> <SNIP>
>
> ##> sm[] <- as.complex(sm)
> curr.fun: symbol <-
>  .. after 'expression(sm[] <- as.complex(sm))'
>
>>>>> eval(expression_nr. 35 )
>                  =================
>
> ##> Ceigenok(sm, eigen(sm))
>
>  *** caught bus error ***
> address 0x1, cause 'invalid alignment'
>
> Traceback:
>  1: .Call("La_rs_cmplx", x, only.values, PACKAGE = "base")
>  2: eigen(sm)
>  3: apply(A, 2, function(x) x * sign(Re(x[1])))
>  4: fixsign(E$vectors)
>  5: print(fixsign(E$vectors))
>  6: Ceigenok(sm, eigen(sm))
>  7: eval.with.vis(expr, envir, enclos)
>  8: eval.with.vis(ei, envir)
>  9: source("~/cworks/new/R-2.6.0/tests/lapack.R", echo = TRUE,  
> verbose = TRUE)
>
> Possible actions:
> 1: abort (with core dump, if enabled)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
>
> *************** OS X Crash report:
> Date/Time:      2007-11-23 11:19:19.135 +0100
> OS Version:     10.4.11 (Build 8S165)
> Report Version: 4
>
> Command: R
> Path:    /Library/Frameworks/R.framework/Resources/bin/exec/R
> Parent:  tcsh [2437]
>
> Version: ??? (???)
>
> PID:    3167
> Thread: 0
>
> Exception:  EXC_BAD_ACCESS (0x0001)
> Codes:      KERN_PROTECTION_FAILURE (0x0002) at 0x00000001
>
> Thread 0 Crashed:
> 0   libBLAS.dylib    	0x920fc374 atl_f77wrap_zdotc__ + 80
> 1   libBLAS.dylib    	0x920f7864 zdotc_ + 60
> 2   libRlapack.dylib 	0x013701a0 zhetd2_ + 960
> 3   libRlapack.dylib 	0x0136fcdc zhetrd_ + 1900
> 4   libRlapack.dylib 	0x01370ad8 zheev_ + 1016
> 5   lapack.so        	0x010a4038 modLa_rs_cmplx + 392
> 6   libR.dylib       	0x003c99e8 La_rs_cmplx + 72
> 7   libR.dylib       	0x00372380 do_dotcall + 16864
> 8   libR.dylib       	0x003a170c Rf_eval + 1804
> 9   libR.dylib       	0x003a14dc Rf_eval + 1244
> 10  libR.dylib       	0x003a45f4 do_set + 980
> 11  libR.dylib       	0x003a14dc Rf_eval + 1244
> 12  libR.dylib       	0x003a2b08 do_begin + 104
> 13  libR.dylib       	0x003a14dc Rf_eval + 1244
> 14  libR.dylib       	0x003a14dc Rf_eval + 1244
> 15  libR.dylib       	0x003a2b08 do_begin + 104
> 16  libR.dylib       	0x003a14dc Rf_eval + 1244
> 17  libR.dylib       	0x003a14dc Rf_eval + 1244
> 18  libR.dylib       	0x003a2b08 do_begin + 104
> 19  libR.dylib       	0x003a14dc Rf_eval + 1244
> 20  libR.dylib       	0x003a4f58 Rf_applyClosure + 728
> 21  libR.dylib       	0x003a13f0 Rf_eval + 1008
> 22  libR.dylib       	0x003a62c8 forcePromise + 184
> 23  libR.dylib       	0x003a12c8 Rf_eval + 712
> 24  libR.dylib       	0x003a1650 Rf_eval + 1616
> 25  libR.dylib       	0x003a2714 Rf_DispatchOrEval + 244
> 26  libR.dylib       	0x0049d190 do_subset3 + 384
> 27  libR.dylib       	0x003a14dc Rf_eval + 1244
> 28  libR.dylib       	0x003a62c8 forcePromise + 184
> 29  libR.dylib       	0x003a12c8 Rf_eval + 712
> 30  libR.dylib       	0x003a1650 Rf_eval + 1616
> 31  libR.dylib       	0x003a62c8 forcePromise + 184
> 32  libR.dylib       	0x003a12c8 Rf_eval + 712
> 33  libR.dylib       	0x003a1650 Rf_eval + 1616
> 34  libR.dylib       	0x003a2488 Rf_evalList + 168
> 35  libR.dylib       	0x003a15a8 Rf_eval + 1448
> 36  libR.dylib       	0x003a45f4 do_set + 980
> 37  libR.dylib       	0x003a14dc Rf_eval + 1244
> 38  libR.dylib       	0x003a2b08 do_begin + 104
> 39  libR.dylib       	0x003a14dc Rf_eval + 1244
> 40  libR.dylib       	0x003a4f58 Rf_applyClosure + 728
> 41  libR.dylib       	0x003a13f0 Rf_eval + 1008
> 42  libR.dylib       	0x003a3cdc applydefine + 60
> 43  libR.dylib       	0x003a14dc Rf_eval + 1244
> 44  libR.dylib       	0x003a2b08 do_begin + 104
> 45  libR.dylib       	0x003a14dc Rf_eval + 1244
> 46  libR.dylib       	0x003a4f58 Rf_applyClosure + 728
> 47  libR.dylib       	0x003a13f0 Rf_eval + 1008
> 48  libR.dylib       	0x003a62c8 forcePromise + 184
> 49  libR.dylib       	0x003a12c8 Rf_eval + 712
> 50  libR.dylib       	0x003eafac do_usemethod + 1228
> 51  libR.dylib       	0x003a14dc Rf_eval + 1244
> 52  libR.dylib       	0x003a4f58 Rf_applyClosure + 728
> 53  libR.dylib       	0x003a13f0 Rf_eval + 1008
> 54  libR.dylib       	0x003a2b08 do_begin + 104
> 55  libR.dylib       	0x003a14dc Rf_eval + 1244
> 56  libR.dylib       	0x003a4f58 Rf_applyClosure + 728
> 57  libR.dylib       	0x003a13f0 Rf_eval + 1008
> 58  libR.dylib       	0x003a1eac do_eval + 1868
> 59  libR.dylib       	0x003e7d2c do_internal + 636
> 60  libR.dylib       	0x003a14dc Rf_eval + 1244
> 61  libR.dylib       	0x003a4f58 Rf_applyClosure + 728
> 62  libR.dylib       	0x003a13f0 Rf_eval + 1008
> 63  libR.dylib       	0x003a45f4 do_set + 980
> 64  libR.dylib       	0x003a14dc Rf_eval + 1244
> 65  libR.dylib       	0x003a2b08 do_begin + 104
> 66  libR.dylib       	0x003a14dc Rf_eval + 1244
> 67  libR.dylib       	0x003a31ac do_for + 572
> 68  libR.dylib       	0x003a14dc Rf_eval + 1244
> 69  libR.dylib       	0x003a2b08 do_begin + 104
> 70  libR.dylib       	0x003a14dc Rf_eval + 1244
> 71  libR.dylib       	0x003a4f58 Rf_applyClosure + 728
> 72  libR.dylib       	0x003a13f0 Rf_eval + 1008
> 73  libR.dylib       	0x003cf7cc Rf_ReplIteration + 332
> 74  libR.dylib       	0x003cff04 run_Rmainloop + 212
> 75  R                	0x00001d80 main + 48
> 76  R                	0x00001a9c _start + 760
> 77  R                	0x000017a0 start + 48
>
> Thread 0 crashed with PPC Thread State 64:
>   srr0: 0x00000000920fc374 srr1: 0x000000000000f030
>     vrsave: 0x0000000000000000
>     cr: 0x28002224          xer: 0x0000000000000004   lr:
> 0x00000000920f7864  ctr: 0x00000000920f7828
>     r0: 0x000000003fd60f2c   r1: 0x00000000bfff24c0   r2:
> 0x0000000001384074   r3: 0x0000000002afe818
>     r4: 0x0000000001384074   r5: 0x000000003ff00000   r6:
> 0x0000000001384074   r7: 0x0000000000000001
>     r8: 0x00000000bfff24f8   r9: 0x0000000000000005  r10:
> 0x0000000000000000  r11: 0x0000000001385110
>    r12: 0x00000000920f7828  r13: 0x00000000bfff2570  r14:
> 0x0000000000000004  r15: 0x0000000001384074
>    r16: 0x000000000137fde8  r17: 0x00000000bfff256c  r18:
> 0x0000000002b098e8  r19: 0x00000000bfff2839
>    r20: 0x0000000001384074  r21: 0x00000000019c7db0  r22:
> 0x0000000000000006  r23: 0x00000000bfff283c
>    r24: 0x0000000002afe818  r25: 0x00000000bfff2688  r26:
> 0x0000000000000005  r27: 0x00000000fffffffa
>    r28: 0x0000000000000001  r29: 0x000000000113e708  r30:
> 0x00000000bfff256c  r31: 0x000000000136fde8
>
> Binary Images Description:
>     0x1000 -     0x1fff R 	/Library/Frameworks/R.framework/ 
> Resources/bin/exec/R
>     0x4000 -     0x5fff libRblas.dylib
> 	/Library/Frameworks/R.framework/Resources/lib/libRblas.dylib
>    0x3c000 -    0x48fff libgcc_s.1.dylib
> 	/usr/local/gnu/gcc/4.2.2/lib/libgcc_s.1.dylib
>    0xb5000 -    0xecfff libreadline.5.1.dylib
> 	/usr/local/lib/libreadline.5.1.dylib
>   0x24a000 -   0x24ffff methods.so
> 	/Library/Frameworks/R.framework/Resources/library/methods/libs/ 
> methods.so
>   0x2e9000 -   0x551fff libR.dylib
> 	/Library/Frameworks/R.framework/Resources/lib/libR.dylib
>   0x5d2000 -   0x65dfff libgfortran.2.dylib
> 	/usr/local/gnu/gcc/4.2.2/lib/libgfortran.2.dylib
>  0x1008000 -  0x102dfff grDevices.so
> 	/Library/Frameworks/R.framework/Resources/library/grDevices/libs/ 
> grDevices.so
>  0x10a2000 -  0x10a8fff lapack.so
> 	/Library/Frameworks/R.framework/Resources/modules/lapack.so
>  0x1205000 -  0x125dfff stats.so
> 	/Library/Frameworks/R.framework/Resources/library/stats/libs/stats.so
>  0x1266000 -  0x1384fff libRlapack.dylib
> 	/Library/Frameworks/R.framework/Resources/lib/libRlapack.dylib
> 0x8fe00000 - 0x8fe52fff dyld 46.16	/usr/lib/dyld
> 0x90000000 - 0x901bcfff libSystem.B.dylib 	/usr/lib/libSystem.B.dylib
> 0x90214000 - 0x90219fff libmathCommon.A.dylib
> 	/usr/lib/system/libmathCommon.A.dylib
> 0x9021b000 - 0x90268fff com.apple.CoreText 1.0.4
> (???)	/System/Library/Frameworks/ApplicationServices.framework/ 
> Versions/A/Frameworks/CoreText.framework/Versions/A/CoreText
> 0x90293000 - 0x90344fff ATS
> 	/System/Library/Frameworks/ApplicationServices.framework/Versions/ 
> A/Frameworks/ATS.framework/Versions/A/ATS
> 0x90373000 - 0x9072efff com.apple.CoreGraphics 1.258.77
> (???)	/System/Library/Frameworks/ApplicationServices.framework/ 
> Versions/A/Frameworks/CoreGraphics.framework/Versions/A/CoreGraphics
> 0x907bb000 - 0x90894fff com.apple.CoreFoundation 6.4.8
> (368.31)	/System/Library/Frameworks/CoreFoundation.framework/ 
> Versions/A/CoreFoundation
> 0x908dd000 - 0x908ddfff com.apple.CoreServices 10.4
> (???)	/System/Library/Frameworks/CoreServices.framework/Versions/A/ 
> CoreServices
> 0x908df000 - 0x909e1fff libicucore.A.dylib 	/usr/lib/ 
> libicucore.A.dylib
> 0x90a3b000 - 0x90abffff libobjc.A.dylib 	/usr/lib/libobjc.A.dylib
> 0x90ae9000 - 0x90b5bfff com.apple.framework.IOKit 1.4
> (???)	/System/Library/Frameworks/IOKit.framework/Versions/A/IOKit
> 0x90b71000 - 0x90b83fff libauto.dylib 	/usr/lib/libauto.dylib
> 0x90b8a000 - 0x90e61fff com.apple.CoreServices.CarbonCore
> 681.17	/System/Library/Frameworks/CoreServices.framework/Versions/A/ 
> Frameworks/CarbonCore.framework/Versions/A/CarbonCore
> 0x90ec7000 - 0x90f47fff com.apple.CoreServices.OSServices
> 4.1	/System/Library/Frameworks/CoreServices.framework/Versions/A/ 
> Frameworks/OSServices.framework/Versions/A/OSServices
> 0x90f91000 - 0x90fd3fff com.apple.CFNetwork 4.0
> (129.22)	/System/Library/Frameworks/CoreServices.framework/Versions/ 
> A/Frameworks/CFNetwork.framework/Versions/A/CFNetwork
> 0x90fe8000 - 0x91000fff com.apple.WebServices 1.1.2
> (1.1.0)	/System/Library/Frameworks/CoreServices.framework/Versions/ 
> A/Frameworks/WebServicesCore.framework/Versions/A/WebServicesCore
> 0x91010000 - 0x91091fff com.apple.SearchKit
> 1.0.7	/System/Library/Frameworks/CoreServices.framework/Versions/A/ 
> Frameworks/SearchKit.framework/Versions/A/SearchKit
> 0x910d7000 - 0x91100fff com.apple.Metadata 10.4.4
> (121.36)	/System/Library/Frameworks/CoreServices.framework/Versions/ 
> A/Frameworks/Metadata.framework/Versions/A/Metadata
> 0x91111000 - 0x9111ffff libz.1.dylib 	/usr/lib/libz.1.dylib
> 0x91122000 - 0x912ddfff com.apple.security 4.6
> (29770)	/System/Library/Frameworks/Security.framework/Versions/A/ 
> Security
> 0x913dc000 - 0x913e5fff com.apple.DiskArbitration
> 2.1.2	/System/Library/Frameworks/DiskArbitration.framework/Versions/ 
> A/DiskArbitration
> 0x913ec000 - 0x913f4fff libbsm.dylib 	/usr/lib/libbsm.dylib
> 0x913f8000 - 0x91420fff com.apple.SystemConfiguration
> 1.8.3	/System/Library/Frameworks/SystemConfiguration.framework/ 
> Versions/A/SystemConfiguration
> 0x91433000 - 0x9143efff libgcc_s.1.dylib 	/usr/lib/libgcc_s.1.dylib
> 0x91443000 - 0x914befff com.apple.audio.CoreAudio
> 3.0.5	/System/Library/Frameworks/CoreAudio.framework/Versions/A/ 
> CoreAudio
> 0x914fb000 - 0x914fbfff com.apple.ApplicationServices 10.4
> (???)	/System/Library/Frameworks/ApplicationServices.framework/ 
> Versions/A/ApplicationServices
> 0x914fd000 - 0x91535fff com.apple.AE 1.5
> (297)	/System/Library/Frameworks/ApplicationServices.framework/ 
> Versions/A/Frameworks/AE.framework/Versions/A/AE
> 0x91550000 - 0x91622fff com.apple.ColorSync
> 4.4.9	/System/Library/Frameworks/ApplicationServices.framework/ 
> Versions/A/Frameworks/ColorSync.framework/Versions/A/ColorSync
> 0x91675000 - 0x91706fff com.apple.print.framework.PrintCore 4.6
> (177.13)	/System/Library/Frameworks/ApplicationServices.framework/ 
> Versions/A/Frameworks/PrintCore.framework/Versions/A/PrintCore
> 0x9174d000 - 0x91804fff com.apple.QD 3.10.25
> (???)	/System/Library/Frameworks/ApplicationServices.framework/ 
> Versions/A/Frameworks/QD.framework/Versions/A/QD
> 0x91841000 - 0x9189ffff com.apple.HIServices 1.5.3
> (???)	/System/Library/Frameworks/ApplicationServices.framework/ 
> Versions/A/Frameworks/HIServices.framework/Versions/A/HIServices
> 0x918ce000 - 0x918effff com.apple.LangAnalysis
> 1.6.1	/System/Library/Frameworks/ApplicationServices.framework/ 
> Versions/A/Frameworks/LangAnalysis.framework/Versions/A/LangAnalysis
> 0x91903000 - 0x91928fff com.apple.FindByContent
> 1.5	/System/Library/Frameworks/ApplicationServices.framework/ 
> Versions/A/Frameworks/FindByContent.framework/Versions/A/FindByContent
> 0x9193b000 - 0x9197dfff com.apple.LaunchServices
> 182	/System/Library/Frameworks/ApplicationServices.framework/ 
> Versions/A/Frameworks/LaunchServices.framework/Versions/A/ 
> LaunchServices
> 0x91999000 - 0x919adfff com.apple.speech.synthesis.framework
> 3.3	/System/Library/Frameworks/ApplicationServices.framework/ 
> Versions/A/Frameworks/SpeechSynthesis.framework/Versions/A/ 
> SpeechSynthesis
> 0x919bb000 - 0x91a01fff com.apple.ImageIO.framework
> 1.5.6	/System/Library/Frameworks/ApplicationServices.framework/ 
> Versions/A/Frameworks/ImageIO.framework/Versions/A/ImageIO
> 0x91a18000 - 0x91adffff libcrypto.0.9.7.dylib 	/usr/lib/libcrypto. 
> 0.9.7.dylib
> 0x91b2d000 - 0x91b42fff libcups.2.dylib 	/usr/lib/libcups.2.dylib
> 0x91b47000 - 0x91b65fff libJPEG.dylib
> 	/System/Library/Frameworks/ApplicationServices.framework/Versions/ 
> A/Frameworks/ImageIO.framework/Versions/A/Resources/libJPEG.dylib
> 0x91b6b000 - 0x91c22fff libJP2.dylib
> 	/System/Library/Frameworks/ApplicationServices.framework/Versions/ 
> A/Frameworks/ImageIO.framework/Versions/A/Resources/libJP2.dylib
> 0x91c71000 - 0x91c75fff libGIF.dylib
> 	/System/Library/Frameworks/ApplicationServices.framework/Versions/ 
> A/Frameworks/ImageIO.framework/Versions/A/Resources/libGIF.dylib
> 0x91c77000 - 0x91ce1fff libRaw.dylib
> 	/System/Library/Frameworks/ApplicationServices.framework/Versions/ 
> A/Frameworks/ImageIO.framework/Versions/A/Resources/libRaw.dylib
> 0x91ce6000 - 0x91d23fff libTIFF.dylib
> 	/System/Library/Frameworks/ApplicationServices.framework/Versions/ 
> A/Frameworks/ImageIO.framework/Versions/A/Resources/libTIFF.dylib
> 0x91d2a000 - 0x91d44fff libPng.dylib
> 	/System/Library/Frameworks/ApplicationServices.framework/Versions/ 
> A/Frameworks/ImageIO.framework/Versions/A/Resources/libPng.dylib
> 0x91d49000 - 0x91d4cfff libRadiance.dylib
> 	/System/Library/Frameworks/ApplicationServices.framework/Versions/ 
> A/Frameworks/ImageIO.framework/Versions/A/Resources/libRadiance.dylib
> 0x91d4e000 - 0x91e2cfff libxml2.2.dylib 	/usr/lib/libxml2.2.dylib
> 0x91e4c000 - 0x91e4cfff com.apple.Accelerate 1.2.2 (Accelerate
> 1.2.2)	/System/Library/Frameworks/Accelerate.framework/Versions/A/ 
> Accelerate
> 0x91e4e000 - 0x91f33fff com.apple.vImage
> 2.4	/System/Library/Frameworks/Accelerate.framework/Versions/A/ 
> Frameworks/vImage.framework/Versions/A/vImage
> 0x91f3b000 - 0x91f5afff com.apple.Accelerate.vecLib 3.2.2 (vecLib
> 3.2.2)	/System/Library/Frameworks/Accelerate.framework/Versions/A/ 
> Frameworks/vecLib.framework/Versions/A/vecLib
> 0x91fc6000 - 0x92034fff libvMisc.dylib
> 	/System/Library/Frameworks/Accelerate.framework/Versions/A/ 
> Frameworks/vecLib.framework/Versions/A/libvMisc.dylib
> 0x9203f000 - 0x920d4fff libvDSP.dylib
> 	/System/Library/Frameworks/Accelerate.framework/Versions/A/ 
> Frameworks/vecLib.framework/Versions/A/libvDSP.dylib
> 0x920ee000 - 0x92676fff libBLAS.dylib
> 	/System/Library/Frameworks/Accelerate.framework/Versions/A/ 
> Frameworks/vecLib.framework/Versions/A/libBLAS.dylib
> 0x926a9000 - 0x929d4fff libLAPACK.dylib
> 	/System/Library/Frameworks/Accelerate.framework/Versions/A/ 
> Frameworks/vecLib.framework/Versions/A/libLAPACK.dylib
> 0x92a04000 - 0x92af2fff libiconv.2.dylib 	/usr/lib/libiconv.2.dylib
> 0x92af5000 - 0x92b7dfff com.apple.DesktopServices
> 1.3.6	/System/Library/PrivateFrameworks/ 
> DesktopServicesPriv.framework/Versions/A/DesktopServicesPriv
> 0x92bbe000 - 0x92de9fff com.apple.Foundation 6.4.9
> (567.36)	/System/Library/Frameworks/Foundation.framework/Versions/C/ 
> Foundation
> 0x92f16000 - 0x92f34fff libGL.dylib
> 	/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/ 
> libGL.dylib
> 0x92f3f000 - 0x92f99fff libGLU.dylib
> 	/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/ 
> libGLU.dylib
> 0x92fe5000 - 0x92ff5fff com.apple.speech.recognition.framework
> 3.4	/System/Library/Frameworks/Carbon.framework/Versions/A/ 
> Frameworks/SpeechRecognition.framework/Versions/A/SpeechRecognition
> 0x9324e000 - 0x9326bfff com.apple.audio.SoundManager
> 3.9	/System/Library/Frameworks/Carbon.framework/Versions/A/ 
> Frameworks/CarbonSound.framework/Versions/A/CarbonSound
> 0x93293000 - 0x935a1fff com.apple.HIToolbox 1.4.10
> (???)	/System/Library/Frameworks/Carbon.framework/Versions/A/ 
> Frameworks/HIToolbox.framework/Versions/A/HIToolbox
> 0x936f1000 - 0x936fdfff com.apple.opengl
> 1.4.7	/System/Library/Frameworks/OpenGL.framework/Versions/A/OpenGL
> 0x93799000 - 0x93dccfff com.apple.AppKit 6.4.9
> (824.44)	/System/Library/Frameworks/AppKit.framework/Versions/C/AppKit
> 0x94159000 - 0x941cbfff com.apple.CoreData 91
> (92.1)	/System/Library/Frameworks/CoreData.framework/Versions/A/ 
> CoreData
> 0x94204000 - 0x942c9fff com.apple.audio.toolbox.AudioToolbox
> 1.4.7	/System/Library/Frameworks/AudioToolbox.framework/Versions/A/ 
> AudioToolbox
> 0x9431c000 - 0x9431cfff com.apple.audio.units.AudioUnit
> 1.4	/System/Library/Frameworks/AudioUnit.framework/Versions/A/ 
> AudioUnit
> 0x9431e000 - 0x944defff com.apple.QuartzCore
> 1.4.12	/System/Library/Frameworks/QuartzCore.framework/Versions/A/ 
> QuartzCore
> 0x94528000 - 0x94565fff libsqlite3.0.dylib 	/usr/lib/ 
> libsqlite3.0.dylib
> 0x9456d000 - 0x945bdfff libGLImage.dylib
> 	/System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/ 
> libGLImage.dylib
> 0x945c6000 - 0x945e0fff com.apple.CoreVideo
> 1.4.2	/System/Library/Frameworks/CoreVideo.framework/Versions/A/ 
> CoreVideo
> 0x945f1000 - 0x94611fff libmx.A.dylib 	/usr/lib/libmx.A.dylib
> 0x97093000 - 0x970c1fff libncurses.5.4.dylib 	/usr/lib/libncurses. 
> 5.4.dylib
> 0x97b13000 - 0x97b32fff com.apple.vecLib 3.2.2 (vecLib
> 3.2.2)	/System/Library/Frameworks/vecLib.framework/Versions/A/vecLib
>
> Model: PowerBook5,4, BootROM 4.8.6f0, 1 processors, PowerPC G4  (1.1),
> 1.5 GHz, 1 GB
> Graphics: ATI Mobility Radeon 9700, ATY,RV360M11, AGP, 128 MB
> Memory Module: SODIMM0/J25LOWER, 512 MB, DDR SDRAM, PC2700U-25330
> Memory Module: SODIMM1/J25UPPER, 512 MB, DDR SDRAM, PC2700U-25330
> AirPort: AirPort Extreme, 405.1 (3.90.34.0.p18)
> Modem: Jump, V.92, Version 1.0
> Bluetooth: Version 1.9.5f4, 2 service, 0 devices, 1 incoming serial  
> ports
> Network Service: Built-in Ethernet, Ethernet, en0
> PCI Card: TXN,PCIXXXX-00, cardbus, PC Card
> Parallel ATA Device: MATSHITACD-RW  CW-8123
> Parallel ATA Device: HTE721080G9AT00, 74.53 GB
> USB Device: Bluetooth USB Host Controller, Apple, Inc., Up to 12 Mb/ 
> sec, 500 mA
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From smckinney at bccrc.ca  Sat Nov 24 02:05:21 2007
From: smckinney at bccrc.ca (smckinney at bccrc.ca)
Date: Sat, 24 Nov 2007 02:05:21 +0100 (CET)
Subject: [Rd] Bug in package stats function ar() (PR#10459)
Message-ID: <20071124010521.AEE0B282EFF7@mail.pubhealth.ku.dk>

Full_Name: Steven McKinney
Version: 2.6.0
OS: OS X
Submission from: (NULL) (142.103.207.10)



Function ar() in package "stats" is showing
a quirky bug.  Some calls to ar() run to
completion, others throw an error.

The bug is reproducible by several people on different
machines, however, the ar() function itself ends
up throwing the error sporadically.  Several calls to
ar() may be necessary to trip the error condition.

Code to reproduce:

x<-ts(c(-0.2052083,-0.3764986,-0.3762448,0.3740089,0.2737568,2.8235722,-1.7783313,0.2728676,-0.3273164),start=c(1978,3),frequency=4,end=c(1980,3))
# ar function
res.ar<-ar(x,aic=TRUE,demean=F)
# call "ar" again and ............
res.ar<-ar(x,aic=TRUE,demean=F)


Example output:
(Note that on this attempt the first call to ar()
 tripped the error.)

> x<-ts(c(-0.2052083,-0.3764986,-0.3762448,0.3740089,0.2737568,2.8235722,-
+ 1.7783313,0.2728676,-0.3273164),start=c(1978,3),frequency=4,end=c(1980,3))
> 
> # ar function
> res.ar<-ar(x,aic=TRUE,demean=F)
Error in if (order > 0) coefs[order, 1:order] else numeric(0) : 
  missing value where TRUE/FALSE needed
In addition: Warning messages:
1: In log(var.pred) : NaNs produced
2: In if (order > 0) coefs[order, 1:order] else numeric(0) :
  the condition has length > 1 and only the first element will be used
> 
> # call "ar" again and ............
> res.ar<-ar(x,aic=TRUE,demean=F)
> x
           Qtr1       Qtr2       Qtr3       Qtr4
1978                       -0.2052083 -0.3764986
1979 -0.3762448  0.3740089  0.2737568  2.8235722
1980 -1.7783313  0.2728676 -0.3273164           
> res.ar<-ar(x,aic=TRUE,demean=F)
> res.ar$resid
           Qtr1       Qtr2       Qtr3       Qtr4
1978                       -0.2052083 -0.3764986
1979 -0.3762448  0.3740089  0.2737568  2.8235722
1980 -1.7783313  0.2728676 -0.3273164           
> res.ar<-ar(x,aic=TRUE,demean=F)
> res.ar$resid
           Qtr1       Qtr2       Qtr3       Qtr4
1978                       -0.2052083 -0.3764986
1979 -0.3762448  0.3740089  0.2737568  2.8235722
1980 -1.7783313  0.2728676 -0.3273164           
> res.ar<-ar(x,aic=TRUE,demean=F)
> res.ar<-ar(x,aic=TRUE,demean=F)
> res.ar<-ar(x,aic=TRUE,demean=F)
> res.ar<-ar(x,aic=TRUE,demean=F)
> res.ar<-ar(x,aic=TRUE,demean=F)
> res.ar<-ar(x,aic=TRUE,demean=F)
> res.ar<-ar(x,aic=TRUE,demean=F)
Error in if (order > 0) coefs[order, 1:order] else numeric(0) : 
  missing value where TRUE/FALSE needed
In addition: Warning message:
In if (order > 0) coefs[order, 1:order] else numeric(0) :
  the condition has length > 1 and only the first element will be used
> res.ar<-ar(x,aic=TRUE,demean=F)
Error in if (order > 0) coefs[order, 1:order] else numeric(0) : 
  missing value where TRUE/FALSE needed
In addition: Warning messages:
1: In log(var.pred) : NaNs produced
2: In if (order > 0) coefs[order, 1:order] else numeric(0) :
  the condition has length > 1 and only the first element will be used
> res.ar<-ar(x,aic=TRUE,demean=F)
> res.ar<-ar(x,aic=TRUE,demean=F)
> sessionInfo()
R version 2.6.0 (2007-10-03) 
powerpc-apple-darwin8.10.1 

locale:
C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     
> 


###-----------------------------------------------------------------

Also seen in R 2.5.0:

> x<-ts(c(-0.2052083,-0.3764986,-0.3762448,0.3740089,0.2737568,2.8235722,-1.7783313,0.2728676,-0.3273164),start=c(1978,3),frequency=4,end=c(1980,3))
> # ar function
> res.ar<-ar(x,aic=TRUE,demean=F)
> # call "ar" again and ............
> res.ar<-ar(x,aic=TRUE,demean=F)
> res.ar<-ar(x,aic=TRUE,demean=F)
> res.ar<-ar(x,aic=TRUE,demean=F)
> res.ar<-ar(x,aic=TRUE,demean=F)
> res.ar<-ar(x,aic=TRUE,demean=F)
Error in if (order > 0) coefs[order, 1:order] else numeric(0) : 
        missing value where TRUE/FALSE needed
In addition: Warning message:
the condition has length > 1 and only the first element will be used in: if
(order > 0) coefs[order, 1:order] else numeric(0) 
> sessionInfo()
R version 2.5.0 (2007-04-23) 
x86_64-redhat-linux-gnu 

locale:
LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=en_US.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_P
APER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C

attached base packages:
[1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[7] "base"     
> 

###-----------------------------------------------------------------

However, if I lengthen the input vector 

x<-ts(c(-0.2052083,-0.3764986,-0.3762448,0.3740089,0.2737568,2.8235722,-1.7783313,0.2728676,-0.3273164,
  -0.2052083,-0.3764986,-0.3762448,0.3740089,0.2737568,2.8235722,-1.7783313,0.2728676,-0.3273164),start=c(1978,3),frequency=4,end=c(1982,3))

I can not trip the error, so perhaps it is due to the short length of
the user's input data.



###-----------------------------------------------------------------

Nov 23, 2007 original email from R-help

[R] help pleaseeeeeeeee


Dears Sirs

During my computational work I encountered unexpected behavior when calling
"ar" function, namely
# time series
x<-ts(c(-0.2052083,-0.3764986,-0.3762448,0.3740089,0.2737568,2.8235722,-
1.7783313,0.2728676,-0.3273164),start=c(1978,3),frequency=4,end=c(1980,3))

# ar function
res.ar<-ar(x,aic=TRUE,demean=F)

# call "ar" again and ............
res.ar<-ar(x,aic=TRUE,demean=F)
Error in if (order > 0) coefs[order, 1:order] else numeric(0) :
  missing value where TRUE/FALSE needed
In addition: Warning messages:
1: In log(var.pred) : NaNs produced
2: In if (order > 0) coefs[order, 1:order] else numeric(0) :
  the condition has length > 1 and only the first element will be used

For me it is mysterious why sometimes it works and others it does not,
perhaps I am doing something wrong and stupid :-(

If anyone had already had this problem could you please tell me how you have
solved it?

Thank you for your time.

Best Regards,

Clara Cordeiro



x<-ts(c(-0.2052083,-0.3764986,-0.3762448,0.3740089,0.2737568,2.8235722,-1.7783313,0.2728676,-0.3273164,
  -0.2052083,-0.3764986,-0.3762448,0.3740089,0.2737568,2.8235722,-1.7783313,0.2728676,-0.3273164),start=c(1978,3),frequency=4,end=c(1982,3))


From antonio.fabio at gmail.com  Sat Nov 24 11:15:45 2007
From: antonio.fabio at gmail.com (Antonio, Fabio Di Narzo)
Date: Sat, 24 Nov 2007 11:15:45 +0100
Subject: [Rd] unexpected result from reshape
Message-ID: <b0808fdc0711240215q570af347p271c48a798bed05a@mail.gmail.com>

Hi all.
I have unexpected reshape results on datasets with certain variable
names. Here a reproducible example:

d <- matrix(seq_len(7*7), 1, 7*7)
vnames <- c('acc','ppeGross','CF','ROA','DeltaSales','invTA','DeltaRevDeltaRec')
varying <- unlist(lapply(vnames, paste, 1:7, sep='.'))
d <- data.frame(d)
names(d) <- varying
d1 <- reshape(d, varying=varying, direction="long")
d[,'ppeGross.2'] == d1[d1$time==2,'ppeGross'] #This is FALSE!
##Try to compare d and d1: values are wrong from the 2nd column

##Changing variable names makes thinks go right:
vnames <- letters[1:7]
varying <- unlist(lapply(vnames, paste, 1:7, sep='.'))
names(d) <- varying
d1 <- reshape(d, varying=varying, direction="long")
d[,'b.2'] == d1[d1$time==2,'b'] #This is TRUE, as expected
##Try to compare d and d1 now: they look right

Any hint on what's wrong here? By now, my workarond is changing
variable names before reshaping, than re-assign old variable names
back after reshape.

Best regards,
Antonio, Fabio Di Narzo.

> R.version
               _
platform       i686-pc-linux-gnu
arch           i686
os             linux-gnu
system         i686, linux-gnu
status
major          2
minor          6.0
year           2007
month          10
day            03
svn rev        43063
language       R
version.string R version 2.6.0 (2007-10-03)


From antonio.fabio at gmail.com  Sat Nov 24 11:50:18 2007
From: antonio.fabio at gmail.com (Antonio, Fabio Di Narzo)
Date: Sat, 24 Nov 2007 11:50:18 +0100
Subject: [Rd] unexpected result from reshape
In-Reply-To: <b0808fdc0711240215q570af347p271c48a798bed05a@mail.gmail.com>
References: <b0808fdc0711240215q570af347p271c48a798bed05a@mail.gmail.com>
Message-ID: <b0808fdc0711240250q11515ccdr7c42239d157e6c6c@mail.gmail.com>

I got the problem: dataframe columns are re-ordered alfabetically, but
variable names aren't reordered accordingly in the resulting
dataframe. The problem disappears by specifying the 'varying' argument
as a named list:

d <- matrix(seq_len(7*7), 1, 7*7)
vnames <- c('acc','ppeGross','CF','ROA','DeltaSales','invTA','DeltaRevDeltaRec')
vnames.all <- unlist(lapply(vnames, paste, 1:7, sep='.'))
varying <- split(vnames.all, rep(vnames, each=7))
d <- data.frame(d)
names(d) <- vnames.all
d1 <- reshape(d, varying=varying, direction="long")
d
d1
#Now is ok

2007/11/24, Antonio, Fabio Di Narzo <antonio.fabio at gmail.com>:
> Hi all.
> I have unexpected reshape results on datasets with certain variable
> names. Here a reproducible example:
>
> d <- matrix(seq_len(7*7), 1, 7*7)
> vnames <- c('acc','ppeGross','CF','ROA','DeltaSales','invTA','DeltaRevDeltaRec')
> varying <- unlist(lapply(vnames, paste, 1:7, sep='.'))
> d <- data.frame(d)
> names(d) <- varying
> d1 <- reshape(d, varying=varying, direction="long")
> d[,'ppeGross.2'] == d1[d1$time==2,'ppeGross'] #This is FALSE!
> ##Try to compare d and d1: values are wrong from the 2nd column
>
> ##Changing variable names makes thinks go right:
> vnames <- letters[1:7]
> varying <- unlist(lapply(vnames, paste, 1:7, sep='.'))
> names(d) <- varying
> d1 <- reshape(d, varying=varying, direction="long")
> d[,'b.2'] == d1[d1$time==2,'b'] #This is TRUE, as expected
> ##Try to compare d and d1 now: they look right
>
> Any hint on what's wrong here? By now, my workarond is changing
> variable names before reshaping, than re-assign old variable names
> back after reshape.
>
> Best regards,
> Antonio, Fabio Di Narzo.
>
> > R.version
>                _
> platform       i686-pc-linux-gnu
> arch           i686
> os             linux-gnu
> system         i686, linux-gnu
> status
> major          2
> minor          6.0
> year           2007
> month          10
> day            03
> svn rev        43063
> language       R
> version.string R version 2.6.0 (2007-10-03)
>


-- 
Antonio, Fabio Di Narzo
Ph.D. student at
Department of Statistical Sciences
University of Bologna, Italy


From antonio.fabio at gmail.com  Sat Nov 24 12:35:25 2007
From: antonio.fabio at gmail.com (Antonio, Fabio Di Narzo)
Date: Sat, 24 Nov 2007 12:35:25 +0100
Subject: [Rd] patch proposal for plot.ts
Message-ID: <b0808fdc0711240335h373aa3aaq34f70604df89dd9a@mail.gmail.com>

Hi all.
Currently, if you try:

> lag.plot(1:10)

you get superposed labels '1' and '10'. Things go worse in more extreme cases:

x <- ts(1:10)
x1 <- lag(x, 4)
plot(x1, x)

This is due to a mistake in plot.ts. My suggestion is the following
really minimal patch to plot.ts:

@@ -530,7 +530,7 @@ plot.ts <-
                text(xy, labels =
                     if(is.character(xy.labels)) xy.labels
                     else if(all(tsp(x) == tsp(y))) formatC(time(x), width = 1)
-                    else seq_along(x),
+                    else seq_along(xy$x),
                     col = col, cex = cex)
            if(xy.lines)
                lines(xy, col = col, lty = lty, lwd = lwd,

Best regards,
Antonio.

-- 
Antonio, Fabio Di Narzo
Ph.D. student at
Department of Statistical Sciences
University of Bologna, Italy
-------------- next part --------------
A non-text attachment was scrubbed...
Name: plot.ts.patch
Type: text/x-patch
Size: 473 bytes
Desc: not available
Url : https://stat.ethz.ch/pipermail/r-devel/attachments/20071124/7ef12719/attachment.bin 

From maechler at stat.math.ethz.ch  Sat Nov 24 14:45:22 2007
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Sat, 24 Nov 2007 14:45:22 +0100
Subject: [Rd] patch proposal for plot.ts
In-Reply-To: <b0808fdc0711240335h373aa3aaq34f70604df89dd9a@mail.gmail.com>
References: <b0808fdc0711240335h373aa3aaq34f70604df89dd9a@mail.gmail.com>
Message-ID: <18248.10994.493021.230803@ada-stat.math.ethz.ch>

>>>>> Antonio, Fabio Di Narzo <antonio.fabio at gmail.com>
>>>>>     on Sat, 24 Nov 2007 12:35:25 +0100 writes:

    > Hi all.  Currently, if you try:

    >> lag.plot(1:10)

    > you get superposed labels '1' and '10'. Things go worse in
    > more extreme cases:

    >      x <- ts(1:10)
    >      x1 <- lag(x, 4)
    >      plot(x1, x)

    > This is due to a mistake in plot.ts. 

I agree, It seems pretty clear to you have uncovered a -
somewaht rarely tirggered bug there...

    > My suggestion is the following
    > really minimal patch to plot.ts:

     @@ -530,7 +530,7 @@ plot.ts <-
		     text(xy, labels =
			  if(is.character(xy.labels)) xy.labels
			  else if(all(tsp(x) == tsp(y))) formatC(time(x), width = 1)
     -                    else seq_along(x),
     +                    else seq_along(xy$x),
			  col = col, cex = cex)
		 if(xy.lines)
		     lines(xy, col = col, lty = lty, lwd = lwd,

>      Best regards,
>      Antonio.

Thank you very much, Antonio, for the nice compact report and
patch!

This will be fixed in R 2.7.0 and maybe even in 2.6.1

Martin Maechler, ETH Zurich


From bolker at ufl.edu  Sat Nov 24 17:45:16 2007
From: bolker at ufl.edu (Ben Bolker)
Date: Sat, 24 Nov 2007 08:45:16 -0800 (PST)
Subject: [Rd] Bug in package stats function ar() (PR#10459)
In-Reply-To: <20071124010521.AEE0B282EFF7@mail.pubhealth.ku.dk>
References: <20071124010521.AEE0B282EFF7@mail.pubhealth.ku.dk>
Message-ID: <13926484.post@talk.nabble.com>




Steven McKinney wrote:
> 
> Full_Name: Steven McKinney
> Version: 2.6.0
> OS: OS X
> Submission from: (NULL) (142.103.207.10)
> 
> 
> 
> Function ar() in package "stats" is showing
> a quirky bug.  Some calls to ar() run to
> completion, others throw an error.
> 
> The bug is reproducible by several people on different
> machines, however, the ar() function itself ends
> up throwing the error sporadically.  Several calls to
> ar() may be necessary to trip the error condition.
> 
> Code to reproduce:
> 
> x<-ts(c(-0.2052083,-0.3764986,-0.3762448,0.3740089,0.2737568,2.8235722,-1.7783313,0.2728676,-0.3273164),start=c(1978,3),frequency=4,end=c(1980,3))
> # ar function
> res.ar<-ar(x,aic=TRUE,demean=F)
> # call "ar" again and ............
> res.ar<-ar(x,aic=TRUE,demean=F)
> 
> 
> Example output:
> (Note that on this attempt the first call to ar()
>  tripped the error.)
> 
>> x<-ts(c(-0.2052083,-0.3764986,-0.3762448,0.3740089,0.2737568,2.8235722,-
> +
> 1.7783313,0.2728676,-0.3273164),start=c(1978,3),frequency=4,end=c(1980,3))
>> 
> 

 Slightly more detail: in the "eureka" function, in stats/src/eureka.f, the
last
element of "vars" in the return list is bogus and varies among calls; if it
comes out to NaN or NA it triggers the bug.

  Haven't spent any more time yet tracking this down, but hope that
will save someone a few minutes.

   Ben Bolker
-- 
View this message in context: http://www.nabble.com/Bug-in-package-stats-function-ar%28%29-%28PR-10459%29-tf4864536.html#a13926484
Sent from the R devel mailing list archive at Nabble.com.


From p.dalgaard at biostat.ku.dk  Sat Nov 24 18:57:50 2007
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sat, 24 Nov 2007 18:57:50 +0100
Subject: [Rd] unexpected result from reshape
In-Reply-To: <b0808fdc0711240215q570af347p271c48a798bed05a@mail.gmail.com>
References: <b0808fdc0711240215q570af347p271c48a798bed05a@mail.gmail.com>
Message-ID: <4748661E.8070309@biostat.ku.dk>

Antonio, Fabio Di Narzo wrote:
> Hi all.
> I have unexpected reshape results on datasets with certain variable
> names. Here a reproducible example:
>
> d <- matrix(seq_len(7*7), 1, 7*7)
> vnames <- c('acc','ppeGross','CF','ROA','DeltaSales','invTA','DeltaRevDeltaRec')
> varying <- unlist(lapply(vnames, paste, 1:7, sep='.'))
> d <- data.frame(d)
> names(d) <- varying
> d1 <- reshape(d, varying=varying, direction="long")
> d[,'ppeGross.2'] == d1[d1$time==2,'ppeGross'] #This is FALSE!
> ##Try to compare d and d1: values are wrong from the 2nd column
>
> ##Changing variable names makes thinks go right:
> vnames <- letters[1:7]
> varying <- unlist(lapply(vnames, paste, 1:7, sep='.'))
> names(d) <- varying
> d1 <- reshape(d, varying=varying, direction="long")
> d[,'b.2'] == d1[d1$time==2,'b'] #This is TRUE, as expected
> ##Try to compare d and d1 now: they look right
>
> Any hint on what's wrong here? By now, my workarond is changing
> variable names before reshaping, than re-assign old variable names
> back after reshape.
>
> Best regards,
> Antonio, Fabio Di Narzo.
>   
Ouch. This was dumb (*): The problem is the guess() function using 
split(nms, nn[,1]), which implicitly runs factor(nn[,1]) and so gives 
out the groups in the order of sort(unique(nn[,1])), but later on we 
just use unique(nn[,1]).

Fortunately, this is wrong enough and trivial enough to fix, that it can 
make it into 2.6.1.

    -pd

(*) I think I wrote it, so I can say so.
>   
>> R.version
>>     
>                _
> platform       i686-pc-linux-gnu
> arch           i686
> os             linux-gnu
> system         i686, linux-gnu
> status
> major          2
> minor          6.0
> year           2007
> month          10
> day            03
> svn rev        43063
> language       R
> version.string R version 2.6.0 (2007-10-03)
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>   


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From murdoch at stats.uwo.ca  Sat Nov 24 22:08:31 2007
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 24 Nov 2007 16:08:31 -0500
Subject: [Rd] Bug in package stats function ar() (PR#10459)
In-Reply-To: <13926484.post@talk.nabble.com>
References: <20071124010521.AEE0B282EFF7@mail.pubhealth.ku.dk>
	<13926484.post@talk.nabble.com>
Message-ID: <474892CF.602@stats.uwo.ca>

On 24/11/2007 11:45 AM, Ben Bolker wrote:
> 
> 
> Steven McKinney wrote:
>> Full_Name: Steven McKinney
>> Version: 2.6.0
>> OS: OS X
>> Submission from: (NULL) (142.103.207.10)
>>
>>
>>
>> Function ar() in package "stats" is showing
>> a quirky bug.  Some calls to ar() run to
>> completion, others throw an error.
>>
>> The bug is reproducible by several people on different
>> machines, however, the ar() function itself ends
>> up throwing the error sporadically.  Several calls to
>> ar() may be necessary to trip the error condition.
>>
>> Code to reproduce:
>>
>> x<-ts(c(-0.2052083,-0.3764986,-0.3762448,0.3740089,0.2737568,2.8235722,-1.7783313,0.2728676,-0.3273164),start=c(1978,3),frequency=4,end=c(1980,3))
>> # ar function
>> res.ar<-ar(x,aic=TRUE,demean=F)
>> # call "ar" again and ............
>> res.ar<-ar(x,aic=TRUE,demean=F)
>>
>>
>> Example output:
>> (Note that on this attempt the first call to ar()
>>  tripped the error.)
>>
>>> x<-ts(c(-0.2052083,-0.3764986,-0.3762448,0.3740089,0.2737568,2.8235722,-
>> +
>> 1.7783313,0.2728676,-0.3273164),start=c(1978,3),frequency=4,end=c(1980,3))
> 
>  Slightly more detail: in the "eureka" function, in stats/src/eureka.f, the
> last
> element of "vars" in the return list is bogus and varies among calls; if it
> comes out to NaN or NA it triggers the bug.
> 
>   Haven't spent any more time yet tracking this down, but hope that
> will save someone a few minutes.

Thanks, I'll take a look.

Duncan Murdoch


From maechler at stat.math.ethz.ch  Sat Nov 24 22:41:56 2007
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Sat, 24 Nov 2007 22:41:56 +0100
Subject: [Rd] Bug in package stats function ar() (PR#10459)
In-Reply-To: <474892CF.602@stats.uwo.ca>
References: <20071124010521.AEE0B282EFF7@mail.pubhealth.ku.dk>
	<13926484.post@talk.nabble.com> <474892CF.602@stats.uwo.ca>
Message-ID: <18248.39588.281267.134511@ada-stat.math.ethz.ch>

>>>>> "DM" == Duncan Murdoch <murdoch at stats.uwo.ca>
>>>>>     on Sat, 24 Nov 2007 16:08:31 -0500 writes:

    DM> On 24/11/2007 11:45 AM, Ben Bolker wrote:
    >> 
    >> 
    >> Steven McKinney wrote:
    >>> Full_Name: Steven McKinney Version: 2.6.0 OS: OS X
    >>> Submission from: (NULL) (142.103.207.10)
    >>> 
    >>> 
    >>> 
    >>> Function ar() in package "stats" is showing a quirky
    >>> bug.  Some calls to ar() run to completion, others throw
    >>> an error.
    >>> 
    >>> The bug is reproducible by several people on different
    >>> machines, however, the ar() function itself ends up
    >>> throwing the error sporadically.  Several calls to ar()
    >>> may be necessary to trip the error condition.
    >>> 
    >>> Code to reproduce:
    >>> 
    >>> x<-ts(c(-0.2052083,-0.3764986,-0.3762448,0.3740089,0.2737568,2.8235722,-1.7783313,0.2728676,-0.3273164),start=c(1978,3),frequency=4,end=c(1980,3))
    >>> # ar function res.ar<-ar(x,aic=TRUE,demean=F) # call
    >>> "ar" again and ............
    >>> res.ar<-ar(x,aic=TRUE,demean=F)
    >>> 
    >>> 
    >>> Example output: (Note that on this attempt the first
    >>> call to ar() tripped the error.)
    >>> 
    >>>> x<-ts(c(-0.2052083,-0.3764986,-0.3762448,0.3740089,0.2737568,2.8235722,-
    >>> +
    >>> 1.7783313,0.2728676,-0.3273164),start=c(1978,3),frequency=4,end=c(1980,3))
    >> 
    >> Slightly more detail: in the "eureka" function, in
    >> stats/src/eureka.f, the last element of "vars" in the
    >> return list is bogus and varies among calls; if it comes
    >> out to NaN or NA it triggers the bug.
    >> 
    >> Haven't spent any more time yet tracking this down, but
    >> hope that will save someone a few minutes.

    DM> Thanks, I'll take a look.

I did too.
It seems pretty obvious that we have to require  

      order.max < n.used
i.e.  order.max <= n.used-1
whereas in the current example, order.max == n.used == 9

I have a small fix which solves the problem and seems to pass
make check...

Martin


From bolker at ufl.edu  Sun Nov 25 05:39:10 2007
From: bolker at ufl.edu (Ben Bolker)
Date: Sat, 24 Nov 2007 20:39:10 -0800 (PST)
Subject: [Rd]  r-forge http server down?
Message-ID: <13932760.post@talk.nabble.com>


Trying to go to http://r-forge.r-project.org/ produces:

An error occured in the logger. ERROR: could not access status of
transaction 0 DETAIL: could not write to file "pg_subtrans/025C" at offset
122880: No space left on device

however,

 update.packages(repos="http://r-forge.r-project.org")

works.

 Ben Bolker
-- 
View this message in context: http://www.nabble.com/r-forge-http-server-down--tf4869110.html#a13932760
Sent from the R devel mailing list archive at Nabble.com.


From pcd at wikitex.org  Mon Nov 26 09:22:04 2007
From: pcd at wikitex.org (Peter Danenberg)
Date: Mon, 26 Nov 2007 02:22:04 -0600
Subject: [Rd] pcalg: labels
Message-ID: <20071126082204.GA8893@klutometis.wikitex.org>

I never got a response from pcalg's maintainer, so I thought I'd
publisher a patch here that allows you to specify optional
node-labels; when no labels are specified, `plot' falls back on the
default behaviour of labelling nodes sequentially.
-------------- next part --------------
diff -Naur pcalg-orig/R/pcalg.R pcalg/R/pcalg.R
--- pcalg-orig/R/pcalg.R	2007-03-22 03:20:49.000000000 -0700
+++ pcalg/R/pcalg.R	2007-11-26 00:07:24.000000000 -0800
@@ -292,14 +292,25 @@
 	  })
 
 setMethod("plot", signature(x = "pcAlgo"),
-	  function(x, y, main = NULL, zvalue.lwd = FALSE, lwd.max = 7, ...)
+	  function(x, y, main = NULL, zvalue.lwd = FALSE, lwd.max = 7,
+		   labels = NULL, ...)
       {
 	if(is.null(main))
 	    main <- deparse(x at call)
+        attrs <- list()
+        nodeAttrs <- list()
+        if (!is.null(labels)) {
+          attrs$node <- list(shape = "ellipse", fixedsize = FALSE)
+          names(labels) <- nodes(x at graph)
+          nodeAttrs$label <- labels
+        }
         if (zvalue.lwd & numEdges(x at graph)!=0) {
           lwd.Matrix <- x at zMin
           lwd.Matrix <- ceiling(lwd.max*lwd.Matrix/max(lwd.Matrix))
-          z <- agopen(x at graph,name="lwdGraph")
+          z <- agopen(x at graph,
+                      name="lwdGraph",
+                      nodeAttrs = nodeAttrs,
+                      attrs = attrs)
           eLength <- length(z at AgEdge)
           for (i in 1:eLength) {
             x <- as.numeric(z at AgEdge[[i]]@head)
@@ -308,7 +319,8 @@
           }
           plot(z, main = main, ...)
         } else {
-          plot(x at graph, main = main, ...)
+          plot(x at graph, nodeAttrs = nodeAttrs, main = main,
+               attrs = attrs, ...)
         }
       })
 

From m.pacey at lancaster.ac.uk  Mon Nov 26 15:45:04 2007
From: m.pacey at lancaster.ac.uk (m.pacey at lancaster.ac.uk)
Date: Mon, 26 Nov 2007 15:45:04 +0100 (CET)
Subject: [Rd] Problem with configure's detection of glob on 2.6.0 (PR#10468)
Message-ID: <20071126144504.26352282EFF8@mail.pubhealth.ku.dk>

Full_Name: Mike Pacey
Version: 2.6.0
OS: SuSe Linux 9.3 x86_64
Submission from: (NULL) (194.80.32.10)



A "vanilla" version of R configures and compiles without a problem on my system.
Switching to using the PGI compiler configures correctly (see the values at the
bottom fo thismessage), but compilation aborts with:

pgcc -I../../src/extra/zlib -I../../src/extra/bzip2 -I../../src/extra/pcre  -I.
-I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H   
-Mvect=sse -Mscalarsse -Mcache_align -O2 -Kieee -c platform.c -o platform.o
PGC-S-0040-Illegal use of symbol, glob_t (platform.c: 1141)
PGC-W-0156-Type not specified, 'int' assumed (platform.c: 1141)
PGC-W-0095-Type cast required for this conversion (platform.c: 1168)
PGC/x86-64 Linux 7.0-2: compilation completed with severe errors
make[3]: *** [platform.o] Error 2


Running a diff on ./src/include/config.h files from both installs highlights a
difference in the #define settings. For the vanilla install I get:

/* Define to 1 if you have the `glob' function. */
#define HAVE_GLOB 1

/* Define to 1 if you have the <glob.h> header file. */
#define HAVE_GLOB_H 1

For the PGI version of the install I get:

/* Define to 1 if you have the `glob' function. */
/* #undef HAVE_GLOB */

/* Define to 1 if you have the <glob.h> header file. */
#define HAVE_GLOB_H 1

I was a little puzzled as to why the latter would have the glob header file but
not glob itself, so I modified the config.h file so that HAVE_GLOB was #defined
to 1. The result compiles and passes the "make check" tests.

Have I missed something or is configure/autoconf doing something odd with glob
detection?

-----

Flags/variables for the PGI install are:
export CC=pgcc
export CFLAGS="-Mvect=sse -Mscalarsse -Mcache_align -O2 -Kieee"
export F77=pgf77
export FFLAGS="-Mvect=sse -Mscalarsse -Mcache_align -O2 -Kieee"
export CXX=pgCC
export CXXFLAGS="-Mvect=sse -Mscalarsse -Mcache_align -O2 -Kieee"
export FC=pgf95
export FCFLAGS="-Mvect=sse -Mscalarsse -Mcache_align -O2 -Kieee"
export SHLIB_CXXLDFLAGS=-shared
export SHLIB_LDFLAGS=-shared
./configure --prefix=/usr/local/packages/R-2.6.0-acml \
--with-blas="-lacml" --x-includes=/usr/X11R6/include
--x-libraries=/usr/X11R6/lib64


From ripley at stats.ox.ac.uk  Mon Nov 26 16:55:14 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Mon, 26 Nov 2007 16:55:14 +0100 (CET)
Subject: [Rd] Problem with configure's detection of glob on 2.6.0
	(PR#10468)
Message-ID: <20071126155514.B65ED282EFF8@mail.pubhealth.ku.dk>

I've no idea about the glob detection, but clearly this is the first 
system that allegedly lacks glob that we have encountered: the file needs 
to be

#if defined(HAVE_GLOB) || defined(Win32)
     glob_t globbuf;
#endif

Have fixed that for 2.6.1 patched.

On Mon, 26 Nov 2007, m.pacey at lancaster.ac.uk wrote:

> Full_Name: Mike Pacey
> Version: 2.6.0
> OS: SuSe Linux 9.3 x86_64
> Submission from: (NULL) (194.80.32.10)
>
>
>
> A "vanilla" version of R configures and compiles without a problem on my system.
> Switching to using the PGI compiler configures correctly (see the values at the
> bottom fo thismessage), but compilation aborts with:
>
> pgcc -I../../src/extra/zlib -I../../src/extra/bzip2 -I../../src/extra/pcre  -I.
> -I../../src/include -I../../src/include -I/usr/local/include -DHAVE_CONFIG_H
> -Mvect=sse -Mscalarsse -Mcache_align -O2 -Kieee -c platform.c -o platform.o
> PGC-S-0040-Illegal use of symbol, glob_t (platform.c: 1141)
> PGC-W-0156-Type not specified, 'int' assumed (platform.c: 1141)
> PGC-W-0095-Type cast required for this conversion (platform.c: 1168)
> PGC/x86-64 Linux 7.0-2: compilation completed with severe errors
> make[3]: *** [platform.o] Error 2
>
>
> Running a diff on ./src/include/config.h files from both installs highlights a
> difference in the #define settings. For the vanilla install I get:
>
> /* Define to 1 if you have the `glob' function. */
> #define HAVE_GLOB 1
>
> /* Define to 1 if you have the <glob.h> header file. */
> #define HAVE_GLOB_H 1
>
> For the PGI version of the install I get:
>
> /* Define to 1 if you have the `glob' function. */
> /* #undef HAVE_GLOB */
>
> /* Define to 1 if you have the <glob.h> header file. */
> #define HAVE_GLOB_H 1
>
> I was a little puzzled as to why the latter would have the glob header file but
> not glob itself, so I modified the config.h file so that HAVE_GLOB was #defined
> to 1. The result compiles and passes the "make check" tests.
>
> Have I missed something or is configure/autoconf doing something odd with glob
> detection?
>
> -----
>
> Flags/variables for the PGI install are:
> export CC=pgcc
> export CFLAGS="-Mvect=sse -Mscalarsse -Mcache_align -O2 -Kieee"
> export F77=pgf77
> export FFLAGS="-Mvect=sse -Mscalarsse -Mcache_align -O2 -Kieee"
> export CXX=pgCC
> export CXXFLAGS="-Mvect=sse -Mscalarsse -Mcache_align -O2 -Kieee"
> export FC=pgf95
> export FCFLAGS="-Mvect=sse -Mscalarsse -Mcache_align -O2 -Kieee"
> export SHLIB_CXXLDFLAGS=-shared
> export SHLIB_LDFLAGS=-shared
> ./configure --prefix=/usr/local/packages/R-2.6.0-acml \
> --with-blas="-lacml" --x-includes=/usr/X11R6/include
> --x-libraries=/usr/X11R6/lib64
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From vincent.remacle at ulb.ac.be  Mon Nov 26 17:05:03 2007
From: vincent.remacle at ulb.ac.be (vincent.remacle at ulb.ac.be)
Date: Mon, 26 Nov 2007 17:05:03 +0100 (CET)
Subject: [Rd] Levy (PR#10469)
Message-ID: <20071126160503.D235C2834170@mail.pubhealth.ku.dk>

Full_Name: Vincent Remacle
Version: 2.5.1
OS: Windows XP
Submission from: (NULL) (81.246.37.50)


>  fit = vglm(x ~ 1, levy(idelta=2,igamma=2),trace=TRUE) 
Error: cannot allocate vector of size 30.5 Mb
In addition: Warning messages:
1: NaNs produced in: log(x) 
2: Reached total allocation of 1015Mb: see help(memory.size) in: colnames(qr$qr)
<- colnames(x)[qr$pivot] 
3: Reached total allocation of 1015Mb: see help(memory.size) in: colnames(qr$qr)
<- colnames(x)[qr$pivot] 
4: Reached total allocation of 1015Mb: see help(memory.size) in: colnames(qr$qr)
<- colnames(x)[qr$pivot] 
5: Reached total allocation of 1015Mb: see help(memory.size) in: colnames(qr$qr)
<- colnames(x)[qr$pivot] 
>


From tomas.larsson at gm.com  Mon Nov 26 18:25:10 2007
From: tomas.larsson at gm.com (tomas.larsson at gm.com)
Date: Mon, 26 Nov 2007 18:25:10 +0100 (CET)
Subject: [Rd] colnames slow (PR#10470)
Message-ID: <20071126172510.A8817282EFF8@mail.pubhealth.ku.dk>

Full_Name: Tomas Larsson
Version: 2.6.0
OS: Windows XP
Submission from: (NULL) (198.208.251.24)


This is not a bug, it is a performance issue but I think it should have an easy
fix.

I have a large matrix (about 2,000,000 by 20), when I type colnames(x) it takes
a long time to get the result.  However, if I select just the first couple of
rows of the matrix I don't have to wait for the result. See below for example.

> system.time(colnames(x))
   user  system elapsed 
   9.98    0.00   10.00 
> system.time(colnames(x[1:2,]))
   user  system elapsed 
   0.01    0.00    0.02 

Sincerely,

Tomas


From ligges at statistik.uni-dortmund.de  Mon Nov 26 22:14:07 2007
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon, 26 Nov 2007 22:14:07 +0100
Subject: [Rd] colnames slow (PR#10470)
In-Reply-To: <20071126172510.A8817282EFF8@mail.pubhealth.ku.dk>
References: <20071126172510.A8817282EFF8@mail.pubhealth.ku.dk>
Message-ID: <474B371F.8070203@statistik.uni-dortmund.de>



tomas.larsson at gm.com wrote:
> Full_Name: Tomas Larsson
> Version: 2.6.0
> OS: Windows XP
> Submission from: (NULL) (198.208.251.24)
> 
> 
> This is not a bug, it is a performance issue but I think it should have an easy
> fix.
> 
> I have a large matrix (about 2,000,000 by 20), when I type colnames(x) it takes
> a long time to get the result.  However, if I select just the first couple of
> rows of the matrix I don't have to wait for the result. See below for example.
> 
>> system.time(colnames(x))
>    user  system elapsed 
>    9.98    0.00   10.00 
>> system.time(colnames(x[1:2,]))
>    user  system elapsed 
>    0.01    0.00    0.02 


Documentation in the released version of R (2.6.1) tells us:

For a data frame, 'rownames'
      and 'colnames' are calls to 'row.names' and 'names' respectively,
      but the latter are preferred.

and on my machine I get:

system.time(names(x))
    user  system elapsed
       0       0       0


Uwe Ligges



> Sincerely,
> 
> Tomas
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.uni-dortmund.de  Mon Nov 26 22:20:30 2007
From: ligges at statistik.uni-dortmund.de (Uwe Ligges)
Date: Mon, 26 Nov 2007 22:20:30 +0100
Subject: [Rd] Levy (PR#10469)
In-Reply-To: <20071126160503.D235C2834170@mail.pubhealth.ku.dk>
References: <20071126160503.D235C2834170@mail.pubhealth.ku.dk>
Message-ID: <474B389E.9040504@statistik.uni-dortmund.de>



vincent.remacle at ulb.ac.be wrote:
> Full_Name: Vincent Remacle
> Version: 2.5.1

Please see the FAQs on how to report bugs. R-2.5.1 is two releases older 
than required.


> OS: Windows XP
> Submission from: (NULL) (81.246.37.50)
> 
> 
>>  fit = vglm(x ~ 1, levy(idelta=2,igamma=2),trace=TRUE) 

- What is x? We could not reproduce in case we need to.
- vglm() is not a function that ships with R.
Please tell us which contributed packages you are using (I am assuming 
VGAM).
- Please note that bugs in contributed packages are to be reported to 
the package maintainers, not to R-bugs.


> Error: cannot allocate vector of size 30.5 Mb
> In addition: Warning messages:
> 1: NaNs produced in: log(x) 
> 2: Reached total allocation of 1015Mb: see help(memory.size) in: colnames(qr$qr)
> <- colnames(x)[qr$pivot] 
> 3: Reached total allocation of 1015Mb: see help(memory.size) in: colnames(qr$qr)
> <- colnames(x)[qr$pivot] 
> 4: Reached total allocation of 1015Mb: see help(memory.size) in: colnames(qr$qr)
> <- colnames(x)[qr$pivot] 
> 5: Reached total allocation of 1015Mb: see help(memory.size) in: colnames(qr$qr)
> <- colnames(x)[qr$pivot] 

Why do you think that it is a bug in R (or a contributed packages) that 
you do not have the required amount of RAM in your machine?

Uwe Ligges



> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hpages at fhcrc.org  Mon Nov 26 23:59:49 2007
From: hpages at fhcrc.org (Herve Pages)
Date: Mon, 26 Nov 2007 14:59:49 -0800
Subject: [Rd] Change in write.dcf() that breaks existing code
Message-ID: <474B4FE5.2050300@fhcrc.org>

Hi,

When writing a DCF file one record at a time, the records used
to be separated by an empty line in R-2.5, but not in R-2.6:

  x <- data.frame(aa=letters[1:3], ii=1:3)

With R-2.5:

  > x <- data.frame(aa=letters[1:3], ii=1:3)
  > for (i in seq_len(nrow(x))) write.dcf(x[i, ,drop=FALSE])
  aa: a
  ii: 1

  aa: b
  ii: 2

  aa: c
  ii: 3

With R-2.6:

  > for (i in seq_len(nrow(x))) write.dcf(x[i, ,drop=FALSE])
  aa: a
  ii: 1
  aa: b
  ii: 2
  aa: c
  ii: 3

Unfortunately, because of this change, code that used to be OK
now produces broken DCF files.
To add to the frustration, nothing is mentioned in the man page
or in the NEWS file:

  CHANGES IN R VERSION 2.6.0

    o	write.dcf() no longer writes NA fields (PR#9796), and works
	correctly on empty descriptions.

Although it seems that it was a deliberate choice. Found in base/R/dcf.R:
    ...
    if(length(eor)) {
        ## Newline for end of record.
        ## Note that we do not write a trailing blank line.
        eor[ diff(c(col(out))[is_not_empty]) >= 1 ] <- "\n"
    }
    ...

What's the benefit of this change?

Cheers,
H.


From zliu at fau.edu  Tue Nov 27 19:10:18 2007
From: zliu at fau.edu (zliu at fau.edu)
Date: Tue, 27 Nov 2007 19:10:18 +0100 (CET)
Subject: [Rd] Postscript saving failed. (PR#10473)
Message-ID: <20071127181018.259B52834158@mail.pubhealth.ku.dk>

Full_Name: Zhihua Liu
Version: 2.6.0
OS: 
Submission from: (NULL) (66.176.38.107)


When I produced a .ps graph in the screen, I had problem to save them. The
following warnings show up: 

Error: Invalid font type
In addition: Warning messages:
1: font family not found in PostScript font database 
2: font family not found in PostScript font database 

But it works fine with R 2.5.0.


From ripley at stats.ox.ac.uk  Tue Nov 27 20:40:33 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Tue, 27 Nov 2007 20:40:33 +0100 (CET)
Subject: [Rd] Postscript saving failed. (PR#10473)
Message-ID: <20071127194033.CCA432834156@mail.pubhealth.ku.dk>

This was fixed in R 2.6.1 (in fact it was fixed in R-patched on 
October 4th).

Please upgrade (as the R FAQ and the R posting guide both asked you to 
do before posting).

On Tue, 27 Nov 2007, zliu at fau.edu wrote:

> Full_Name: Zhihua Liu
> Version: 2.6.0
> OS:
> Submission from: (NULL) (66.176.38.107)
>
>
> When I produced a .ps graph in the screen, I had problem to save them. The
> following warnings show up:
>
> Error: Invalid font type
> In addition: Warning messages:
> 1: font family not found in PostScript font database
> 2: font family not found in PostScript font database
>
> But it works fine with R 2.5.0.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From p.dalgaard at biostat.ku.dk  Tue Nov 27 20:41:55 2007
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue, 27 Nov 2007 20:41:55 +0100
Subject: [Rd] Postscript saving failed. (PR#10473)
In-Reply-To: <20071127181018.259B52834158@mail.pubhealth.ku.dk>
References: <20071127181018.259B52834158@mail.pubhealth.ku.dk>
Message-ID: <474C7303.10709@biostat.ku.dk>

zliu at fau.edu wrote:
> Full_Name: Zhihua Liu
> Version: 2.6.0
> OS: 
> Submission from: (NULL) (66.176.38.107)
>
>
> When I produced a .ps graph in the screen, I had problem to save them. The
> following warnings show up: 
>
> Error: Invalid font type
> In addition: Warning messages:
> 1: font family not found in PostScript font database 
> 2: font family not found in PostScript font database 
>
> But it works fine with R 2.5.0.
>
>   
...as well as 2.6.1!



-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From pkensche at cmbi.ru.nl  Wed Nov 28 09:25:31 2007
From: pkensche at cmbi.ru.nl (pkensche at cmbi.ru.nl)
Date: Wed, 28 Nov 2007 09:25:31 +0100 (CET)
Subject: [Rd] hash access to data.frame uses prefix? (PR#10474)
Message-ID: <20071128082531.9DEC62834156@mail.pubhealth.ku.dk>

Full_Name: Philip Kensche
Version: R version 2.5.0 (2007-04-23)
OS: Linux
Submission from: (NULL) (131.174.146.31)


I want to access a row of a data.frame() by using the row names as hash keys.
This works fine for most keys.

Now consider the following data.frame().

> x <- data.frame(v=c(V40="a", V411="b"))

> x
     v
V40  a
V411 b

If I query for "V41", which does not exist in the data.frame() the call does not
return NA as I would expect but the row "V411".

> x[ "V41", ]
[1] b
Levels: a b

If there the prefix is not unique the query does not return a results, i.e.

> x <- data.frame(v=c(V412="a", V411="b"))

> x
     v
V412 a
V411 b

> x[ "V41", ]
[1] <NA>
Levels: a b


sessionInfo() output:
> sessionInfo()
R version 2.5.0 (2007-04-23)
i686-pc-linux-gnu

locale:
LC_CTYPE=en_US;LC_NUMERIC=C;LC_TIME=en_US;LC_COLLATE=en_US;LC_MONETARY=en_US;LC_MESSAGES=en_US;LC_PAPER=en_US;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US;LC_IDENTIFICATION=C

attached base packages:
[1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"
[7] "base"

other attached packages:
 lattice
"0.15-4"


From ripley at stats.ox.ac.uk  Wed Nov 28 10:40:15 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Wed, 28 Nov 2007 10:40:15 +0100 (CET)
Subject: [Rd] hash access to data.frame uses prefix? (PR#10474)
Message-ID: <20071128094015.B30E5283416B@mail.pubhealth.ku.dk>

Exact matching has preference over partial matching: see ?pmatch.

Your version of R is three versions obsolete: the latest version explains 
this in detail under ?`[.data.frame` and ?`[` (and maybe 2.5.0 does too).

Please do your homework before sending non-bugs to R-bugs.


On Wed, 28 Nov 2007, pkensche at cmbi.ru.nl wrote:

> Full_Name: Philip Kensche
> Version: R version 2.5.0 (2007-04-23)
> OS: Linux
> Submission from: (NULL) (131.174.146.31)
>
>
> I want to access a row of a data.frame() by using the row names as hash keys.

Hmm, you mean you use character vector indices.  No hashing is involved.

> This works fine for most keys.
>
> Now consider the following data.frame().
>
>> x <- data.frame(v=c(V40="a", V411="b"))
>
>> x
>     v
> V40  a
> V411 b
>
> If I query for "V41", which does not exist in the data.frame() the call 
> does not return NA as I would expect but the row "V411".
>
>> x[ "V41", ]
> [1] b
> Levels: a b
>
> If there the prefix is not unique the query does not return a results, i.e.
>
>> x <- data.frame(v=c(V412="a", V411="b"))
>
>> x
>     v
> V412 a
> V411 b
>
>> x[ "V41", ]
> [1] <NA>
> Levels: a b
>
>
> sessionInfo() output:
>> sessionInfo()
> R version 2.5.0 (2007-04-23)
> i686-pc-linux-gnu
>
> locale:
> LC_CTYPE=en_US;LC_NUMERIC=C;LC_TIME=en_US;LC_COLLATE=en_US;LC_MONETARY=en_US;LC_MESSAGES=en_US;LC_PAPER=en_US;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US;LC_IDENTIFICATION=C
>
> attached base packages:
> [1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"
> [7] "base"
>
> other attached packages:
> lattice
> "0.15-4"
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Wed Nov 28 10:50:15 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Wed, 28 Nov 2007 10:50:15 +0100 (CET)
Subject: [Rd] hash access to data.frame uses prefix? (PR#10474)
Message-ID: <20071128095015.720E2283416B@mail.pubhealth.ku.dk>

If you do want only exact matching, use match().  E.g. in your example

x[match("V41", row.names(x)), ]

will give NA as you expected for a construction documented to do something 
else.

On Wed, 28 Nov 2007, Prof Brian Ripley wrote:

> Exact matching has preference over partial matching: see ?pmatch.
>
> Your version of R is three versions obsolete: the latest version explains 
> this in detail under ?`[.data.frame` and ?`[` (and maybe 2.5.0 does too).
>
> Please do your homework before sending non-bugs to R-bugs.
>
>
> On Wed, 28 Nov 2007, pkensche at cmbi.ru.nl wrote:
>
>> Full_Name: Philip Kensche
>> Version: R version 2.5.0 (2007-04-23)
>> OS: Linux
>> Submission from: (NULL) (131.174.146.31)
>> 
>> 
>> I want to access a row of a data.frame() by using the row names as hash 
>> keys.
>
> Hmm, you mean you use character vector indices.  No hashing is involved.
>
>> This works fine for most keys.
>> 
>> Now consider the following data.frame().
>> 
>>> x <- data.frame(v=c(V40="a", V411="b"))
>> 
>>> x
>>     v
>> V40  a
>> V411 b
>> 
>> If I query for "V41", which does not exist in the data.frame() the call 
>> does not return NA as I would expect but the row "V411".
>> 
>>> x[ "V41", ]
>> [1] b
>> Levels: a b
>> 
>> If there the prefix is not unique the query does not return a results, i.e.
>> 
>>> x <- data.frame(v=c(V412="a", V411="b"))
>> 
>>> x
>>     v
>> V412 a
>> V411 b
>> 
>>> x[ "V41", ]
>> [1] <NA>
>> Levels: a b
>> 
>> 
>> sessionInfo() output:
>>> sessionInfo()
>> R version 2.5.0 (2007-04-23)
>> i686-pc-linux-gnu
>> 
>> locale:
>> LC_CTYPE=en_US;LC_NUMERIC=C;LC_TIME=en_US;LC_COLLATE=en_US;LC_MONETARY=en_US;LC_MESSAGES=en_US;LC_PAPER=en_US;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US;LC_IDENTIFICATION=C
>> 
>> attached base packages:
>> [1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"
>> [7] "base"
>> 
>> other attached packages:
>> lattice
>> "0.15-4"
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From maechler at stat.math.ethz.ch  Wed Nov 28 15:55:14 2007
From: maechler at stat.math.ethz.ch (maechler at stat.math.ethz.ch)
Date: Wed, 28 Nov 2007 15:55:14 +0100 (CET)
Subject: [Rd] colnames slow (PR#10470)
Message-ID: <20071128145515.005B92834156@mail.pubhealth.ku.dk>

>>>>> "UweL" == Uwe Ligges <ligges at statistik.uni-dortmund.de>
>>>>>     on Mon, 26 Nov 2007 22:14:07 +0100 writes:

    UweL> tomas.larsson at gm.com wrote:
    >> Full_Name: Tomas Larsson
    >> Version: 2.6.0
    >> OS: Windows XP
    >> Submission from: (NULL) (198.208.251.24)
    >> 
    >> 
    >> This is not a bug, it is a performance issue but I think it should have an easy
    >> fix.
    >> 
    >> I have a large matrix (about 2,000,000 by 20), when I type colnames(x) it takes
    >> a long time to get the result.  However, if I select just the first couple of
    >> rows of the matrix I don't have to wait for the result. See below for example.

    >>> system.time(colnames(x))
    >> user  system elapsed 
    >> 9.98    0.00   10.00 

    >>> system.time(colnames(x[1:2,]))
    >> user  system elapsed 
    >> 0.01    0.00    0.02 

    UweL> Documentation in the released version of R (2.6.1) tells us:

    UweL> For a data frame, 'rownames'
    UweL> and 'colnames' are calls to 'row.names' and 'names' respectively,
    UweL> but the latter are preferred.

aaah, so we do have a something close to a bug,
since the above is only correct if "are" is interpreted in quite
a wide sense :

Both colnames() and rownames() call dimnames() 
which is a (.Primitive) generic and the data.frame method simply
is
    function (x) list(row.names(x), names(x))
So, in fact, both colnames() and rownames() 
each call *both* row.names() and names() even though only one of
them is needed.

This is indeed suboptimal in the case where colnames() is of
length 20 and rownames() is of length 2'000'000  ... not really
an atypical case.

And that (last paragraph) is also true when 'x' is a matrix and
not a data.frame. However, there's a bit more to it...

    UweL> and on my machine I get:

    UweL> system.time(names(x))
    UweL> user  system elapsed
    UweL> 0       0       0

yes.  But what if his 'x'  really *was* a matrix (and not a data frame)?

The speed of colnames(x) in such a case depends quite a bit if the
matrix has non-NULL rownames.  Ideally I think it should not,
and hence partly agree with Tomas.

HOWEVER, there's more to it.
If 'x' *was* a matrix --- and this proves to me that it was not
       	       	          in Tomas' case ---
even though colnames() seems like a waste (of memory, copying),
it is infact still very fast in newer versions of R ... most probably
because 'character' vectors are hashed now and much less memory
allocation is happening than in earlier versions of R. 

The only case that is slow is for a *data frame* with
"empty" i.e. automatic rownames.  Watch this :

m <- matrix(pi, 2e6, 20,
            dimnames=list(LETTERS[sample(26,2e6,replace=TRUE)], letters[1:20]))
system.time(for(i in 1:100) cc <- colnames(m))
## 0.001  -- very fast
## ditto for this:
system.time(for(i in 1:100) dd <- dimnames(m))

## HOWEVER:
system.time(dm <- as.data.frame(m)) ## takes more than a second
##    user  system elapsed
##   2.462   1.379   3.842

## Quite a bit slower (x 1000 !) than for the matrix above, but still ok:
system.time(for(i in 1:100) c2 <- colnames(dm))
##    user  system elapsed
##   1.202   0.638   1.842
stopifnot(identical(c2, cc))

## ditto
system.time(for(i in 1:100) d2 <- dimnames(dm))
##    user  system elapsed
##   1.143   0.626   1.769
stopifnot(identical(d2, dd))

###---- BUT  now: What happens if we have "empty" rownames  ???

## m0 :=  {m  with empty rownames} :
m0 <- m
dimnames(m0) <- list(NULL, colnames(m0))

## and ditto for the data frames:
## dm0 :=  {dm  with empty rownames, i.e. "internal/automatic 1:N rownames}:
system.time(dm0 <- as.data.frame(m0))
##    user  system elapsed
##   1.677   1.241   2.922

system.time(c3 <- colnames(dm0))
##    user  system elapsed
##   5.208   0.047   5.261

###---> OOOPS!  One single call to colnames(.)
###  needs more than  100  calls in the non-empty rownames case

## repeated calls become faster  ..... and ....
system.time(c3 <- colnames(dm0))
##    user  system elapsed
##   3.109   0.000   3.110
## ..... faster  ......and even much faster
system.time(c3 <- colnames(dm0))
##    user  system elapsed
##   0.913   0.007   0.922

## Note: repeated calls to dimnames(.) here become faster :
system.time(d3 <- dimnames(dm0))

## Note indeed, that  names()  is lightning fast in comparison:
system.time(for(i in 1:100) c4 <- names(dm0)) ## is 'immediate' (0 sec)
##    user  system elapsed
##   0.001   0.000   0.000   --- 100 x ~1000  times faster


----------------------------------------------

All things considered,  I'd currently propose to add 

    if(is.data.frame(x) && do.NULL)
	return(names(x))

to the beginning of 'colnames'.  
We have such clause already at the beginning of 
'colnames<-'
....  all of which would suggest to make these generic, but we
have been there before and consciously decided against doing so,
on the ground  that 'dimnames' is already generic and 
colnames(.) and rownames(.) should really be equivalent to
dimnames(.)[[j]]  for j=1 or 2, respectively.


Martin Maechler, ETH Zurich


From timh at insightful.com  Wed Nov 28 19:30:13 2007
From: timh at insightful.com (timh at insightful.com)
Date: Wed, 28 Nov 2007 19:30:13 +0100 (CET)
Subject: [Rd] help("R_LIBS") brings up the wrong help file (PR#10475)
Message-ID: <20071128183013.8F0332834158@mail.pubhealth.ku.dk>

Doing
	help("R_LIBS")
brings up a help file (the same one as help(library)),
but the help file doesn't mention R_LIBS.
It does have a link to .libPaths, which does document R_LIBS.

The quickest fix would be for help("R_LIBS") to bring up the .libPaths
help file.


--please do not edit the information below--

Version:
 platform = i386-pc-mingw32
 arch = i386
 os = mingw32
 system = i386, mingw32
 status = 
 major = 2
 minor = 5.0
 year = 2007
 month = 04
 day = 23
 svn rev = 41293
 language = R
 version.string = R version 2.5.0 (2007-04-23)

Windows XP (build 2600) Service Pack 2.0

Locale:
LC_COLLATE=English_United States.1252;LC_CTYPE=English_United States.1252;LC_MONETARY=English_United States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252

Search Path:
 .GlobalEnv, package:stats, package:graphics, package:grDevices, package:utils, package:datasets, package:methods, Autoloads, package:base


From kate at few.vu.nl  Wed Nov 28 20:26:44 2007
From: kate at few.vu.nl (Katharine Mullen)
Date: Wed, 28 Nov 2007 20:26:44 +0100 (CET)
Subject: [Rd] help("R_LIBS") brings up the wrong help file (PR#10475)
In-Reply-To: <20071128183013.8F0332834158@mail.pubhealth.ku.dk>
References: <20071128183013.8F0332834158@mail.pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.56.0711282023050.10291@laurel.few.vu.nl>

help(R_LIBS) is the same as help(.libPaths) for me.

It appears you're running 2.5.0 - you could try updating, and then see if
the issue still exists.

---
platform       x86_64-unknown-linux-gnu
arch           x86_64
os             linux-gnu
system         x86_64, linux-gnu
status
major          2
minor          6.1
year           2007
month          11
day            26
svn rev        43537
language       R
version.string R version 2.6.1 (2007-11-26)


On Wed, 28 Nov 2007 timh at insightful.com wrote:

> Doing
> 	help("R_LIBS")
> brings up a help file (the same one as help(library)),
> but the help file doesn't mention R_LIBS.
> It does have a link to .libPaths, which does document R_LIBS.
>
> The quickest fix would be for help("R_LIBS") to bring up the .libPaths
> help file.
>
>
> --please do not edit the information below--
>
> Version:
>  platform = i386-pc-mingw32
>  arch = i386
>  os = mingw32
>  system = i386, mingw32
>  status =
>  major = 2
>  minor = 5.0
>  year = 2007
>  month = 04
>  day = 23
>  svn rev = 41293
>  language = R
>  version.string = R version 2.5.0 (2007-04-23)
>
> Windows XP (build 2600) Service Pack 2.0
>
> Locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United States.1252;LC_MONETARY=English_United States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>
> Search Path:
>  .GlobalEnv, package:stats, package:graphics, package:grDevices, package:utils, package:datasets, package:methods, Autoloads, package:base
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ripley at stats.ox.ac.uk  Thu Nov 29 04:45:17 2007
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Thu, 29 Nov 2007 04:45:17 +0100 (CET)
Subject: [Rd] help("R_LIBS") brings up the wrong help file (PR#10475)
Message-ID: <20071129034517.6ED512834155@mail.pubhealth.ku.dk>

It brings up ?.libPaths in R 2.5.1 and later (that is, the last three 
releases of R).

On Wed, 28 Nov 2007, timh at insightful.com wrote:

> Doing
> 	help("R_LIBS")
> brings up a help file (the same one as help(library)),
> but the help file doesn't mention R_LIBS.
> It does have a link to .libPaths, which does document R_LIBS.
>
> The quickest fix would be for help("R_LIBS") to bring up the .libPaths
> help file.
>
>
> --please do not edit the information below--
>
> Version:
> platform = i386-pc-mingw32
> arch = i386
> os = mingw32
> system = i386, mingw32
> status =
> major = 2
> minor = 5.0
> year = 2007
> month = 04
> day = 23
> svn rev = 41293
> language = R
> version.string = R version 2.5.0 (2007-04-23)
>
> Windows XP (build 2600) Service Pack 2.0
>
> Locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United States.1252;LC_MONETARY=English_United States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>
> Search Path:
> .GlobalEnv, package:stats, package:graphics, package:grDevices, package:utils, package:datasets, package:methods, Autoloads, package:base
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Thu Nov 29 11:10:20 2007
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 29 Nov 2007 10:10:20 +0000 (GMT)
Subject: [Rd] Building R-devel under Windows
Message-ID: <Pine.LNX.4.64.0711291003240.29346@gannet.stats.ox.ac.uk>

Building R under gcc 3.4.5 on Windows will no longer be supported as from 
R 2.7.0.  The default settings in the trunk (R-devel) are for the new 
version of Rtools,

http://www.murdoch-sutherland.com/Rtools/Rtools27.exe

in which gcc is 4.2.1.  This also contains gcc-sjlj.exe, so can be used to 
build R 2.6.x as well.  It will become the default Rtools.exe in due 
course.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From davison at stats.ox.ac.uk  Thu Nov 29 12:34:18 2007
From: davison at stats.ox.ac.uk (Dan Davison)
Date: Thu, 29 Nov 2007 11:34:18 +0000
Subject: [Rd] ?eigen documentation suggestion
Message-ID: <20071129113418.GA11773@stats.ox.ac.uk>

from ?eigen

symmetric: if 'TRUE', the matrix is assumed to be symmetric (or
          Hermitian if complex) and only its lower triangle is used. If
          'symmetric' is not specified, the matrix is inspected for
          symmetry.


I think that could mislead a naive reader as it suggests that, with symmetric=TRUE,
the result of eigen() (vectors and values) depends only on the lower-triangular values, 
and thus not on the values on the diagonal (that's not true for the eigenvalues).

I suggest that changing it to 

"... and only its lower triangle is used when computing the eigenvectors."

would be more accurate, perhaps even with a reminder about the trace - sum of eigenvalues
relationship.

Dan


From saleem at cs.st-andrews.ac.uk  Wed Nov 28 22:55:22 2007
From: saleem at cs.st-andrews.ac.uk (saleem at cs.st-andrews.ac.uk)
Date: Wed, 28 Nov 2007 22:55:22 +0100 (CET)
Subject: [Rd] R install problem on MacOS 10.5.1 (PR#10476)
Message-ID: <20071128215522.AF9F42834155@mail.pubhealth.ku.dk>

Full_Name: Saleem Bhatti
Version: 2.6.1
OS: MacOSX 10.5.1
Submission from: (NULL) (81.187.216.162)


Using R-2.6.1.dmg to do an automated install on MacOS 10.5.1.

Installation fails with following text.

Installation had errors.
Install failed.
The Installer could not install some files in "/".
Contact the software manufacturer for assistance.

See window capture at:

  http://www.cs.st-andrews.ac.uk/~saleem/tmp/r2.6.1-install_problem_on_MacOS_10.5.1.png

Cheers,
--/Saleem


From carlos at necsi.org  Tue Nov 27 17:25:25 2007
From: carlos at necsi.org (carlos at necsi.org)
Date: Tue, 27 Nov 2007 17:25:25 +0100 (CET)
Subject: [Rd] Problem with points/lines (PR#10472)
Message-ID: <20071127162525.F0836283416B@mail.pubhealth.ku.dk>

Full_Name: Carlos Gershenson
Version: 2.6.1
OS: MacOSX
Submission from: (NULL) (24.128.48.138)


Hi,

Try this out:

x<-1:10
y<-x/2
plot(table(x))
points(table(y))
#or lines(table(y))

No matter what's the value of y, it prints out in the coordinates of x... this
happens only with tables, not with simple plot(x), points(y), and table(y) works
fine


From fjbuch at gmail.com  Thu Nov 29 05:05:30 2007
From: fjbuch at gmail.com (Farrel Buchinsky)
Date: Wed, 28 Nov 2007 23:05:30 -0500
Subject: [Rd] reading and writing to Google spreadsheets
Message-ID: <bd93cdad0711282005m61d63f77i6890fc67117707f8@mail.gmail.com>

Have you ever collaborated? Google Spreadsheets is fantastic to
collaborate with. Rather than sending excel spreadsheets backwards and
forwards, I would rather use shared Google Spreadsheets. I do not want
the intermediate step of exporting a Google Spreadsheet as an xls
file. I do not know how to make use of the Google Spreadsheet API
(http://code.google.com/apis/spreadsheets/overview.html)
but from the little knowledge that I have I can see that this would be
the way to enable R to talk to Google. How much work would it be for
this to be incorporated into RODBC?

Google Spreadsheets has some phenomenal functionality that uses Google
Search engine to populate the columns in a spreadsheet with data. Can
you imagine the power of using the Spreadsheet to get the data and R
to merge it with ones own research data and then analyze the merged
data.

Check this http://googlesystem.blogspot.com/2007/11/connecting-data-using-google.html

-- 
Farrel Buchinsky


From simon.urbanek at r-project.org  Thu Nov 29 15:44:11 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 29 Nov 2007 09:44:11 -0500
Subject: [Rd] R install problem on MacOS 10.5.1 (PR#10476)
In-Reply-To: <20071128215522.AF9F42834155@mail.pubhealth.ku.dk>
References: <20071128215522.AF9F42834155@mail.pubhealth.ku.dk>
Message-ID: <FA8783E7-C438-4DCC-B5AA-A1F55BE5C3B5@r-project.org>


On Nov 28, 2007, at 4:55 PM, saleem at cs.st-andrews.ac.uk wrote:

> Full_Name: Saleem Bhatti
> Version: 2.6.1
> OS: MacOSX 10.5.1
> Submission from: (NULL) (81.187.216.162)
>
>
> Using R-2.6.1.dmg to do an automated install on MacOS 10.5.1.
>
> Installation fails with following text.
>
> Installation had errors.
> Install failed.
> The Installer could not install some files in "/".
> Contact the software manufacturer for assistance.
>
> See window capture at:
>
>  http://www.cs.st-andrews.ac.uk/~saleem/tmp/r2.6.1-install_problem_on_MacOS_10.5.1.png
>

That is not very helpful ;) - can you send me the full installer log,  
please?

Also the screen shot doesn't look like automated install (that is just  
one command line) - what do you mean exactly?

Cheers,
Simon


From P.Dalgaard at biostat.ku.dk  Thu Nov 29 16:36:03 2007
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 29 Nov 2007 16:36:03 +0100
Subject: [Rd] Problem with points/lines (PR#10472)
In-Reply-To: <20071127162525.F0836283416B@mail.pubhealth.ku.dk>
References: <20071127162525.F0836283416B@mail.pubhealth.ku.dk>
Message-ID: <474EDC63.7090107@biostat.ku.dk>

carlos at necsi.org wrote:
> Full_Name: Carlos Gershenson
> Version: 2.6.1
> OS: MacOSX
> Submission from: (NULL) (24.128.48.138)
>
>
> Hi,
>
> Try this out:
>
> x<-1:10
> y<-x/2
> plot(table(x))
> points(table(y))
> #or lines(table(y))
>
> No matter what's the value of y, it prints out in the coordinates of x... this
> happens only with tables, not with simple plot(x), points(y), and table(y) works
> fine
>
>   
The real issue is that we have a plot method for tables, which tries to
be smart about using numerical entry names. There's no similar points
method, nor a lines method, so in those cases you get the default
method, namely to plot the table values (all ones) against the *index*,
i.e.,1:n. This shows the effect quite clearly:

plot(table(x^2)
lines(table(x))

(This is not a bug, since noone has promised you that lines and point
methods should exist. It could be taken as an enhancement request.)
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>   


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From gavin.simpson at ucl.ac.uk  Thu Nov 29 17:03:48 2007
From: gavin.simpson at ucl.ac.uk (Gavin Simpson)
Date: Thu, 29 Nov 2007 16:03:48 +0000
Subject: [Rd] Problem with points/lines (PR#10472)
In-Reply-To: <474EDC63.7090107@biostat.ku.dk>
References: <20071127162525.F0836283416B@mail.pubhealth.ku.dk>
	<474EDC63.7090107@biostat.ku.dk>
Message-ID: <1196352228.29290.111.camel@gsimpson.geog.ucl.ac.uk>

On Thu, 2007-11-29 at 16:36 +0100, Peter Dalgaard wrote:
> carlos at necsi.org wrote:
> > Full_Name: Carlos Gershenson
> > Version: 2.6.1
> > OS: MacOSX
> > Submission from: (NULL) (24.128.48.138)
> >
> >
> > Hi,
> >
> > Try this out:
> >
> > x<-1:10
> > y<-x/2
> > plot(table(x))
> > points(table(y))
> > #or lines(table(y))
> >
> > No matter what's the value of y, it prints out in the coordinates of x... this
> > happens only with tables, not with simple plot(x), points(y), and table(y) works
> > fine
> >
> >   
> The real issue is that we have a plot method for tables, which tries to
> be smart about using numerical entry names. There's no similar points
> method, nor a lines method, so in those cases you get the default
> method, namely to plot the table values (all ones) against the *index*,
> i.e.,1:n. This shows the effect quite clearly:
> 
> plot(table(x^2)
> lines(table(x))
> 
> (This is not a bug, since noone has promised you that lines and point
> methods should exist. It could be taken as an enhancement request.)

Peter,

Re: your final statement above, would an enhancement request be looked
upon favourably by R Core for inclusion in R if some code and
documentation were supplied?

I replied earlier in the week to Carlos' query on R-Help (seems this has
taken 2 days to get the R-Devel?) with some quickly knocked together
code for points.table and Axis.table methods that were based in large
part on the code in plot.table. I reproduce these below. They were based
on printing the source plot.table at the prompt, not from interrogation
of the SVN version.

If considered for inclusion, I'd be happy to get these in better shape
and write appropriate Rd files as required?

All the best,

G

## points and Axis methods for objects of class "table"
## Gavin Simpson 2007 based in large part on plot.table
`points.table` <- function (x, type = "h", ...)
{
     rnk <- length(dim(x))
     if (rnk == 0)
         stop("invalid table 'x'")
     if (rnk == 1) {
         nx <- dimnames(x)[[1]]
         ow <- options(warn = -1)
         is.num <- !any(is.na(xx <- as.numeric(nx)))
         options(ow)
         x0 <- if (is.num)
             xx
         else seq.int(x)
         points(x0, unclass(x), type = type, ...)
     }
     else stop("only for 1-D table")
}

`Axis.table` <- function(x, at, ..., labels)
{
     rnk <- length(dim(x))
     if (rnk == 0)
         stop("invalid table 'x'")
     if (rnk == 1) {
         nx <- dimnames(x)[[1]]
         ow <- options(warn = -1)
         is.num <- !any(is.na(xx <- as.numeric(nx)))
         options(ow)
         x0 <- if (is.num)
             xx
         else seq.int(x)
         if(missing(at))
             at <- x0
         if(missing(labels))
             labels <- nx
         xaxt <- if (length(as <- list(...))) {
             if (!is.null(as$axes) && !as$axes)
                 "n"
             else as$xaxt
         }
         axis(1, at = at, labels = labels, xaxt = xaxt)
     }
     else stop("only for 1-D table")
}

## example to run with:
set.seed(1234)
x <- sample(1:10, 30, replace = TRUE)
y <- x / 2
plot(table(x), type = "p")
points(table(y), col = "red", type = "p", pch = 2)

## And if you need to redraw axes
## need to use Axis() as it is a generic version of axis()
plot(table(x), type = "p", axes = FALSE)
points(table(y), col = "red", type = "p", pch = 2)
Axis(table(y))

-- 
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
 Dr. Gavin Simpson             [t] +44 (0)20 7679 0522
 ECRC, UCL Geography,          [f] +44 (0)20 7679 0565
 Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk
 Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/
 UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%


From P.Dalgaard at biostat.ku.dk  Thu Nov 29 17:34:21 2007
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 29 Nov 2007 17:34:21 +0100
Subject: [Rd] Problem with points/lines (PR#10472)
In-Reply-To: <1196352228.29290.111.camel@gsimpson.geog.ucl.ac.uk>
References: <20071127162525.F0836283416B@mail.pubhealth.ku.dk>	
	<474EDC63.7090107@biostat.ku.dk>
	<1196352228.29290.111.camel@gsimpson.geog.ucl.ac.uk>
Message-ID: <474EEA0D.1030601@biostat.ku.dk>

Gavin Simpson wrote:
> On Thu, 2007-11-29 at 16:36 +0100, Peter Dalgaard wrote:
>   
>> carlos at necsi.org wrote:
>>     
>>> Full_Name: Carlos Gershenson
>>> Version: 2.6.1
>>> OS: MacOSX
>>> Submission from: (NULL) (24.128.48.138)
>>>
>>>
>>> Hi,
>>>
>>> Try this out:
>>>
>>> x<-1:10
>>> y<-x/2
>>> plot(table(x))
>>> points(table(y))
>>> #or lines(table(y))
>>>
>>> No matter what's the value of y, it prints out in the coordinates of x... this
>>> happens only with tables, not with simple plot(x), points(y), and table(y) works
>>> fine
>>>
>>>   
>>>       
>> The real issue is that we have a plot method for tables, which tries to
>> be smart about using numerical entry names. There's no similar points
>> method, nor a lines method, so in those cases you get the default
>> method, namely to plot the table values (all ones) against the *index*,
>> i.e.,1:n. This shows the effect quite clearly:
>>
>> plot(table(x^2)
>> lines(table(x))
>>
>> (This is not a bug, since noone has promised you that lines and point
>> methods should exist. It could be taken as an enhancement request.)
>>     
>
> Peter,
>
> Re: your final statement above, would an enhancement request be looked
> upon favourably by R Core for inclusion in R if some code and
> documentation were supplied?
>   
As always, there is a risk that it falls through the cracks before
someone gets around to looking at it.

Your code look sane though, and as far as I can see, you do not even
have to do much in terms of documentation since it could be wedged into
the existing plot.table() help page.

For now, we could file under "wishlist". As you know, items on the
wishlist do in fact get fulfilled sometimes.

    -p
> I replied earlier in the week to Carlos' query on R-Help (seems this has
> taken 2 days to get the R-Devel?) with some quickly knocked together
> code for points.table and Axis.table methods that were based in large
> part on the code in plot.table. I reproduce these below. They were based
> on printing the source plot.table at the prompt, not from interrogation
> of the SVN version.
>
> If considered for inclusion, I'd be happy to get these in better shape
> and write appropriate Rd files as required?
>
> All the best,
>
> G
>
> ## points and Axis methods for objects of class "table"
> ## Gavin Simpson 2007 based in large part on plot.table
> `points.table` <- function (x, type = "h", ...)
> {
>      rnk <- length(dim(x))
>      if (rnk == 0)
>          stop("invalid table 'x'")
>      if (rnk == 1) {
>          nx <- dimnames(x)[[1]]
>          ow <- options(warn = -1)
>          is.num <- !any(is.na(xx <- as.numeric(nx)))
>          options(ow)
>          x0 <- if (is.num)
>              xx
>          else seq.int(x)
>          points(x0, unclass(x), type = type, ...)
>      }
>      else stop("only for 1-D table")
> }
>
> `Axis.table` <- function(x, at, ..., labels)
> {
>      rnk <- length(dim(x))
>      if (rnk == 0)
>          stop("invalid table 'x'")
>      if (rnk == 1) {
>          nx <- dimnames(x)[[1]]
>          ow <- options(warn = -1)
>          is.num <- !any(is.na(xx <- as.numeric(nx)))
>          options(ow)
>          x0 <- if (is.num)
>              xx
>          else seq.int(x)
>          if(missing(at))
>              at <- x0
>          if(missing(labels))
>              labels <- nx
>          xaxt <- if (length(as <- list(...))) {
>              if (!is.null(as$axes) && !as$axes)
>                  "n"
>              else as$xaxt
>          }
>          axis(1, at = at, labels = labels, xaxt = xaxt)
>      }
>      else stop("only for 1-D table")
> }
>
> ## example to run with:
> set.seed(1234)
> x <- sample(1:10, 30, replace = TRUE)
> y <- x / 2
> plot(table(x), type = "p")
> points(table(y), col = "red", type = "p", pch = 2)
>
> ## And if you need to redraw axes
> ## need to use Axis() as it is a generic version of axis()
> plot(table(x), type = "p", axes = FALSE)
> points(table(y), col = "red", type = "p", pch = 2)
> Axis(table(y))
>
>   


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From maechler at stat.math.ethz.ch  Thu Nov 29 17:46:38 2007
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 29 Nov 2007 17:46:38 +0100
Subject: [Rd] ?eigen documentation suggestion
In-Reply-To: <20071129113418.GA11773@stats.ox.ac.uk>
References: <20071129113418.GA11773@stats.ox.ac.uk>
Message-ID: <18254.60654.667672.388353@stat.math.ethz.ch>

>>>>> "DD" == Dan Davison <davison at stats.ox.ac.uk>
>>>>>     on Thu, 29 Nov 2007 11:34:18 +0000 writes:

    DD> from ?eigen
    DD> symmetric: if 'TRUE', the matrix is assumed to be symmetric (or
    DD> Hermitian if complex) and only its lower triangle is used. If
    DD> 'symmetric' is not specified, the matrix is inspected for
    DD> symmetry.


    DD> I think that could mislead a naive reader as it suggests that, with symmetric=TRUE,
    DD> the result of eigen() (vectors and values) depends only on the lower-triangular values, 
    DD> and thus not on the values on the diagonal (that's not true for the eigenvalues).

Well, that all depends on what you think when you read 
"lower triangle".

For many of us, this can include the diagonal or not, and we
don't know if it is not specified further.

?lower.tri  -- shows the option to include the diagonal.

Consequently, I'd suggest to replace

       "only its lower triangle is used"
with   "only its lower triangle (diagonal included) is used"

Martin Maechler, ETH Zurich

    DD> I suggest that changing it to 

    DD> "... and only its lower triangle is used when computing the eigenvectors."

    DD> would be more accurate, perhaps even with a reminder about the trace - sum of eigenvalues
    DD> relationship.

    DD> Dan

    DD> ______________________________________________
    DD> R-devel at r-project.org mailing list
    DD> https://stat.ethz.ch/mailman/listinfo/r-devel


From gavin.simpson at ucl.ac.uk  Thu Nov 29 18:19:29 2007
From: gavin.simpson at ucl.ac.uk (Gavin Simpson)
Date: Thu, 29 Nov 2007 17:19:29 +0000
Subject: [Rd] Problem with points/lines (PR#10472)
In-Reply-To: <474EEA0D.1030601@biostat.ku.dk>
References: <20071127162525.F0836283416B@mail.pubhealth.ku.dk>
	<474EDC63.7090107@biostat.ku.dk>
	<1196352228.29290.111.camel@gsimpson.geog.ucl.ac.uk>
	<474EEA0D.1030601@biostat.ku.dk>
Message-ID: <1196356769.29290.120.camel@gsimpson.geog.ucl.ac.uk>

On Thu, 2007-11-29 at 17:34 +0100, Peter Dalgaard wrote:
> Gavin Simpson wrote:
> > On Thu, 2007-11-29 at 16:36 +0100, Peter Dalgaard wrote:
> >   
> >> carlos at necsi.org wrote:
> >>     
> >>> Full_Name: Carlos Gershenson
> >>> Version: 2.6.1
> >>> OS: MacOSX
> >>> Submission from: (NULL) (24.128.48.138)
> >>>
> >>>
> >>> Hi,
> >>>
> >>> Try this out:
> >>>
> >>> x<-1:10
> >>> y<-x/2
> >>> plot(table(x))
> >>> points(table(y))
> >>> #or lines(table(y))
> >>>
> >>> No matter what's the value of y, it prints out in the coordinates of x... this
> >>> happens only with tables, not with simple plot(x), points(y), and table(y) works
> >>> fine
> >>>
> >>>   
> >>>       
> >> The real issue is that we have a plot method for tables, which tries to
> >> be smart about using numerical entry names. There's no similar points
> >> method, nor a lines method, so in those cases you get the default
> >> method, namely to plot the table values (all ones) against the *index*,
> >> i.e.,1:n. This shows the effect quite clearly:
> >>
> >> plot(table(x^2)
> >> lines(table(x))
> >>
> >> (This is not a bug, since noone has promised you that lines and point
> >> methods should exist. It could be taken as an enhancement request.)
> >>     
> >
> > Peter,
> >
> > Re: your final statement above, would an enhancement request be looked
> > upon favourably by R Core for inclusion in R if some code and
> > documentation were supplied?
> >   
> As always, there is a risk that it falls through the cracks before
> someone gets around to looking at it.
> 
> Your code look sane though, and as far as I can see, you do not even
> have to do much in terms of documentation since it could be wedged into
> the existing plot.table() help page.
> 
> For now, we could file under "wishlist". As you know, items on the
> wishlist do in fact get fulfilled sometimes.
> 
>     -p

OK. I'll prepare a patch against the R development SVN for the Rd file
and take another look at the code I wrote. Can you refile this bug under
"wishlist" or do I need to submit another bug report to achieve this?

All the best,

G

> > I replied earlier in the week to Carlos' query on R-Help (seems this has
> > taken 2 days to get the R-Devel?) with some quickly knocked together
> > code for points.table and Axis.table methods that were based in large
> > part on the code in plot.table. I reproduce these below. They were based
> > on printing the source plot.table at the prompt, not from interrogation
> > of the SVN version.
> >
> > If considered for inclusion, I'd be happy to get these in better shape
> > and write appropriate Rd files as required?
> >
> > All the best,
> >
> > G
> >
> > ## points and Axis methods for objects of class "table"
> > ## Gavin Simpson 2007 based in large part on plot.table
> > `points.table` <- function (x, type = "h", ...)
> > {
> >      rnk <- length(dim(x))
> >      if (rnk == 0)
> >          stop("invalid table 'x'")
> >      if (rnk == 1) {
> >          nx <- dimnames(x)[[1]]
> >          ow <- options(warn = -1)
> >          is.num <- !any(is.na(xx <- as.numeric(nx)))
> >          options(ow)
> >          x0 <- if (is.num)
> >              xx
> >          else seq.int(x)
> >          points(x0, unclass(x), type = type, ...)
> >      }
> >      else stop("only for 1-D table")
> > }
> >
> > `Axis.table` <- function(x, at, ..., labels)
> > {
> >      rnk <- length(dim(x))
> >      if (rnk == 0)
> >          stop("invalid table 'x'")
> >      if (rnk == 1) {
> >          nx <- dimnames(x)[[1]]
> >          ow <- options(warn = -1)
> >          is.num <- !any(is.na(xx <- as.numeric(nx)))
> >          options(ow)
> >          x0 <- if (is.num)
> >              xx
> >          else seq.int(x)
> >          if(missing(at))
> >              at <- x0
> >          if(missing(labels))
> >              labels <- nx
> >          xaxt <- if (length(as <- list(...))) {
> >              if (!is.null(as$axes) && !as$axes)
> >                  "n"
> >              else as$xaxt
> >          }
> >          axis(1, at = at, labels = labels, xaxt = xaxt)
> >      }
> >      else stop("only for 1-D table")
> > }
> >
> > ## example to run with:
> > set.seed(1234)
> > x <- sample(1:10, 30, replace = TRUE)
> > y <- x / 2
> > plot(table(x), type = "p")
> > points(table(y), col = "red", type = "p", pch = 2)
> >
> > ## And if you need to redraw axes
> > ## need to use Axis() as it is a generic version of axis()
> > plot(table(x), type = "p", axes = FALSE)
> > points(table(y), col = "red", type = "p", pch = 2)
> > Axis(table(y))
> >
> >   
> 
> 
> -- 
>    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>  (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907
> 
> 
-- 
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
 Dr. Gavin Simpson             [t] +44 (0)20 7679 0522
 ECRC, UCL Geography,          [f] +44 (0)20 7679 0565
 Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk
 Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/
 UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%


From P.Dalgaard at biostat.ku.dk  Fri Nov 30 10:24:29 2007
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri, 30 Nov 2007 10:24:29 +0100
Subject: [Rd] Problem with points/lines (PR#10472)
In-Reply-To: <1196356769.29290.120.camel@gsimpson.geog.ucl.ac.uk>
References: <20071127162525.F0836283416B@mail.pubhealth.ku.dk>	
	<474EDC63.7090107@biostat.ku.dk>	
	<1196352228.29290.111.camel@gsimpson.geog.ucl.ac.uk>	
	<474EEA0D.1030601@biostat.ku.dk>
	<1196356769.29290.120.camel@gsimpson.geog.ucl.ac.uk>
Message-ID: <474FD6CD.3050708@biostat.ku.dk>

Gavin Simpson wrote:
> On Thu, 2007-11-29 at 17:34 +0100, Peter Dalgaard wrote:
>   
>> Gavin Simpson wrote:
>>     
>>> On Thu, 2007-11-29 at 16:36 +0100, Peter Dalgaard wrote:
>>>   
>>>       
>>>> carlos at necsi.org wrote:
>>>>     
>>>>         
>>>>> Full_Name: Carlos Gershenson
>>>>> Version: 2.6.1
>>>>> OS: MacOSX
>>>>> Submission from: (NULL) (24.128.48.138)
>>>>>
>>>>>
>>>>> Hi,
>>>>>
>>>>> Try this out:
>>>>>
>>>>> x<-1:10
>>>>> y<-x/2
>>>>> plot(table(x))
>>>>> points(table(y))
>>>>> #or lines(table(y))
>>>>>
>>>>> No matter what's the value of y, it prints out in the coordinates of x... this
>>>>> happens only with tables, not with simple plot(x), points(y), and table(y) works
>>>>> fine
>>>>>
>>>>>   
>>>>>       
>>>>>           
>>>> The real issue is that we have a plot method for tables, which tries to
>>>> be smart about using numerical entry names. There's no similar points
>>>> method, nor a lines method, so in those cases you get the default
>>>> method, namely to plot the table values (all ones) against the *index*,
>>>> i.e.,1:n. This shows the effect quite clearly:
>>>>
>>>> plot(table(x^2)
>>>> lines(table(x))
>>>>
>>>> (This is not a bug, since noone has promised you that lines and point
>>>> methods should exist. It could be taken as an enhancement request.)
>>>>     
>>>>         
>>> Peter,
>>>
>>> Re: your final statement above, would an enhancement request be looked
>>> upon favourably by R Core for inclusion in R if some code and
>>> documentation were supplied?
>>>   
>>>       
>> As always, there is a risk that it falls through the cracks before
>> someone gets around to looking at it.
>>
>> Your code look sane though, and as far as I can see, you do not even
>> have to do much in terms of documentation since it could be wedged into
>> the existing plot.table() help page.
>>
>> For now, we could file under "wishlist". As you know, items on the
>> wishlist do in fact get fulfilled sometimes.
>>
>>     -p
>>     
>
> OK. I'll prepare a patch against the R development SVN for the Rd file
> and take another look at the code I wrote. Can you refile this bug under
> "wishlist" or do I need to submit another bug report to achieve this?
>   
It's been moved there already by someone ( who also attached a comment
which may sound harsher than meant...)

    -p
> All the best,
>
> G
>
>   
>>> I replied earlier in the week to Carlos' query on R-Help (seems this has
>>> taken 2 days to get the R-Devel?) with some quickly knocked together
>>> code for points.table and Axis.table methods that were based in large
>>> part on the code in plot.table. I reproduce these below. They were based
>>> on printing the source plot.table at the prompt, not from interrogation
>>> of the SVN version.
>>>
>>> If considered for inclusion, I'd be happy to get these in better shape
>>> and write appropriate Rd files as required?
>>>
>>> All the best,
>>>
>>> G
>>>
>>> ## points and Axis methods for objects of class "table"
>>> ## Gavin Simpson 2007 based in large part on plot.table
>>> `points.table` <- function (x, type = "h", ...)
>>> {
>>>      rnk <- length(dim(x))
>>>      if (rnk == 0)
>>>          stop("invalid table 'x'")
>>>      if (rnk == 1) {
>>>          nx <- dimnames(x)[[1]]
>>>          ow <- options(warn = -1)
>>>          is.num <- !any(is.na(xx <- as.numeric(nx)))
>>>          options(ow)
>>>          x0 <- if (is.num)
>>>              xx
>>>          else seq.int(x)
>>>          points(x0, unclass(x), type = type, ...)
>>>      }
>>>      else stop("only for 1-D table")
>>> }
>>>
>>> `Axis.table` <- function(x, at, ..., labels)
>>> {
>>>      rnk <- length(dim(x))
>>>      if (rnk == 0)
>>>          stop("invalid table 'x'")
>>>      if (rnk == 1) {
>>>          nx <- dimnames(x)[[1]]
>>>          ow <- options(warn = -1)
>>>          is.num <- !any(is.na(xx <- as.numeric(nx)))
>>>          options(ow)
>>>          x0 <- if (is.num)
>>>              xx
>>>          else seq.int(x)
>>>          if(missing(at))
>>>              at <- x0
>>>          if(missing(labels))
>>>              labels <- nx
>>>          xaxt <- if (length(as <- list(...))) {
>>>              if (!is.null(as$axes) && !as$axes)
>>>                  "n"
>>>              else as$xaxt
>>>          }
>>>          axis(1, at = at, labels = labels, xaxt = xaxt)
>>>      }
>>>      else stop("only for 1-D table")
>>> }
>>>
>>> ## example to run with:
>>> set.seed(1234)
>>> x <- sample(1:10, 30, replace = TRUE)
>>> y <- x / 2
>>> plot(table(x), type = "p")
>>> points(table(y), col = "red", type = "p", pch = 2)
>>>
>>> ## And if you need to redraw axes
>>> ## need to use Axis() as it is a generic version of axis()
>>> plot(table(x), type = "p", axes = FALSE)
>>> points(table(y), col = "red", type = "p", pch = 2)
>>> Axis(table(y))
>>>
>>>   
>>>       
>> -- 
>>    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>>   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>>  (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
>> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907
>>
>>
>>     


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark          Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)                  FAX: (+45) 35327907


From simon.urbanek at r-project.org  Fri Nov 30 16:38:14 2007
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 30 Nov 2007 10:38:14 -0500
Subject: [Rd] R install problem on MacOS 10.5.1 (PR#10476)
In-Reply-To: <DFEB308E-090E-49D0-97D7-72C8994BAA94@cs.st-andrews.ac.uk>
References: <20071128215522.AF9F42834155@mail.pubhealth.ku.dk>
	<FA8783E7-C438-4DCC-B5AA-A1F55BE5C3B5@r-project.org>
	<DFEB308E-090E-49D0-97D7-72C8994BAA94@cs.st-andrews.ac.uk>
Message-ID: <2D5435B7-0B47-4603-9209-8259252F77B4@r-project.org>

On Nov 30, 2007, at 9:34 AM, Saleem Bhatti wrote:

> Hello;
>
> Thanks for your reply.
>
> On 29 Nov 2007, at 14:44, Simon Urbanek wrote:
>
>>
>> On Nov 28, 2007, at 4:55 PM, saleem at cs.st-andrews.ac.uk wrote:
>>
>>> Full_Name: Saleem Bhatti
>>> Version: 2.6.1
>>> OS: MacOSX 10.5.1
>>> Submission from: (NULL) (81.187.216.162)
>>>
>>>
>>> Using R-2.6.1.dmg to do an automated install on MacOS 10.5.1.
>>>
>>> Installation fails with following text.
>>>
>>> Installation had errors.
>>> Install failed.
>>> The Installer could not install some files in "/".
>>> Contact the software manufacturer for assistance.
>>>
>>> See window capture at:
>>>
>>> http://www.cs.st-andrews.ac.uk/~saleem/tmp/r2.6.1-install_problem_on_MacOS_10.5.1.png
>>>
>>
>> That is not very helpful ;) - can you send me the full installer  
>> log, please?
>
> I thought it might not be very useful, but I did not know where I  
> would find more information - apologies. Where will I find the  
> installer log?
>

Window -> Installer Log
You can then use Save ... to save it in a file.


>>
>>
>> Also the screen shot doesn't look like automated install (that is  
>> just one command line) - what do you mean exactly?
>
> The installer that runs from R-2.6.1.dmg.
>

Well, yes, but you said "automated install" - so how were you running  
an "automated" install? For me automated install is run via /usr/sbin/ 
installer utility and that doesn't have any UI, so I was wondering  
what are you using exactly?

Thanks,
Simon


From saleem at cs.st-andrews.ac.uk  Fri Nov 30 15:34:37 2007
From: saleem at cs.st-andrews.ac.uk (Saleem Bhatti)
Date: Fri, 30 Nov 2007 14:34:37 +0000
Subject: [Rd] R install problem on MacOS 10.5.1 (PR#10476)
In-Reply-To: <FA8783E7-C438-4DCC-B5AA-A1F55BE5C3B5@r-project.org>
References: <20071128215522.AF9F42834155@mail.pubhealth.ku.dk>
	<FA8783E7-C438-4DCC-B5AA-A1F55BE5C3B5@r-project.org>
Message-ID: <DFEB308E-090E-49D0-97D7-72C8994BAA94@cs.st-andrews.ac.uk>

Hello;

Thanks for your reply.

On 29 Nov 2007, at 14:44, Simon Urbanek wrote:

>
> On Nov 28, 2007, at 4:55 PM, saleem at cs.st-andrews.ac.uk wrote:
>
>> Full_Name: Saleem Bhatti
>> Version: 2.6.1
>> OS: MacOSX 10.5.1
>> Submission from: (NULL) (81.187.216.162)
>>
>>
>> Using R-2.6.1.dmg to do an automated install on MacOS 10.5.1.
>>
>> Installation fails with following text.
>>
>> Installation had errors.
>> Install failed.
>> The Installer could not install some files in "/".
>> Contact the software manufacturer for assistance.
>>
>> See window capture at:
>>
>> http://www.cs.st-andrews.ac.uk/~saleem/tmp/r2.6.1-install_problem_on_MacOS_10.5.1.png
>>
>
> That is not very helpful ;) - can you send me the full installer  
> log, please?

I thought it might not be very useful, but I did not know where I  
would find more information - apologies. Where will I find the  
installer log?

>
>
> Also the screen shot doesn't look like automated install (that is  
> just one command line) - what do you mean exactly?

The installer that runs from R-2.6.1.dmg.

Cheers,
--/Saleem


>
>
> Cheers,
> Simon
>


From saleem at cs.st-andrews.ac.uk  Fri Nov 30 17:22:50 2007
From: saleem at cs.st-andrews.ac.uk (Saleem Bhatti)
Date: Fri, 30 Nov 2007 16:22:50 +0000
Subject: [Rd] R install problem on MacOS 10.5.1 (PR#10476)
In-Reply-To: <2D5435B7-0B47-4603-9209-8259252F77B4@r-project.org>
References: <20071128215522.AF9F42834155@mail.pubhealth.ku.dk>
	<FA8783E7-C438-4DCC-B5AA-A1F55BE5C3B5@r-project.org>
	<DFEB308E-090E-49D0-97D7-72C8994BAA94@cs.st-andrews.ac.uk>
	<2D5435B7-0B47-4603-9209-8259252F77B4@r-project.org>
Message-ID: <31D76F0C-C569-4247-8834-7EB675F15055@cs.st-andrews.ac.uk>

Simon;

On 30 Nov 2007, at 15:38, Simon Urbanek wrote:

> Window -> Installer Log
> You can then use Save ... to save it in a file.

OK - file is attached.

> Well, yes, but you said "automated install" - so how were you  
> running an "automated" install? For me automated install is run via / 
> usr/sbin/installer utility and that doesn't have any UI, so I was  
> wondering what are you using exactly?

My apologies for the confusion.

Cheers,
--/Saleem



-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: R-2.6.1-Installer_Log 30-Nov-2007.txt
Url: https://stat.ethz.ch/pipermail/r-devel/attachments/20071130/c5e1cf5a/attachment.txt 
-------------- next part --------------




From J.J.Goeman at lumc.nl  Fri Nov 30 19:39:58 2007
From: J.J.Goeman at lumc.nl (J.J.Goeman at lumc.nl)
Date: Fri, 30 Nov 2007 19:39:58 +0100
Subject: [Rd] Puzzling message: "no man files in this package"
Message-ID: <68735E80D5EB7C4F8477BF00C450D38E02F25507@mailc.lumcnet.prod.intern>

 Dear R developers,

When building/checking my package (in R 2.6.1 under windows) I run into
some messages that I do not completely understand and that do not give
me precise enough leads to pinpoint where the error in my package is. I
would be very grateful for any suggestions. Did anyone else encounter
the same problem before? 

When building or installing the package, I get the message (no error or
warning, just a message) "no man files in this package", instead of the
usual "installing man source files". This puzzles me greatly, as I have
a "man" subdirectory with several .Rd files, all of which seem to be
properly handled later on in the install/build process, when the
"Building/Updating help files" step seems to go fine for all Rd files.
Both install and build run to conclusion without reporting formal errors
or warnings.

Next, Rcmd check gives me a lot of nice OK's (even: * checking Rd files
... OK), and then

* checking Rd cross-references ... WARNING
Error in Rd_db(package, lib.loc = lib.loc) : 
  directory 'M:/R/packages/penalized.Rcheck/penalized' does not contain
Rd objects
Calls: <Anonymous> -> .build_Rd_xref_db -> Rd_db
Execution halted

Again puzzling! I get the impression that the error message is not meant
for me (I'm not the one who is supposed to put Rd objects into
M:/R/packages/penalized.Rcheck/penalized, am I?), but that the error
somehow prevents me from seeing the real warning.

The same warning with error is repeated several times at "checking for
code/documentation mismatches" and at "checking Rd \usage sections".

It's obvious that there is something wrong in my .Rd files. But I can't
find any mistakes by just looking through them, and the error messages
don't mean much to me. Did I overlook something obvious?

The complete install and build output is given below.

Thanks in advance,

Jelle




************************
*** Rcmd install:
************************

installing R.css in M:/R/packages/penalized.Rcheck


---------- Making package penalized ------------
  adding build stamp to DESCRIPTION
  installing NAMESPACE file and metadata
  installing R files
  installing inst files
  installing data files
  preparing package penalized for lazy loading
Loading required package: survival
Loading required package: splines
Creating a new generic function for "coefficients" in "penalized"
Creating a new generic function for "residuals" in "penalized"
Creating a new generic function for "fitted.values" in "penalized"
Creating a new generic function for "weights" in "penalized"
Creating a new generic function for "plot" in "penalized"
Creating a new generic function for "as.matrix" in "penalized"
Creating a new generic function for "time" in "penalized"
Creating a new generic function for "as.list" in "penalized"
  no man files in this package
  installing indices
  not zipping data
  installing help
 >>> Building/Updating help pages for package 'penalized'
     Formats: text html latex example chm 
  breslow                           text    html    latex
  contrasts                         text    html    latex   example
  cvl                               text    html    latex   example
  nki70                             text    html    latex
  penalized                         text    html    latex   example
  penfit                            text    html    latex
  plotpath                          text    html    latex   example
  adding MD5 sums

* DONE (penalized)


************************
*** Rcmd check:
************************

* using log directory 'M:/R/packages/penalized.Rcheck'
* using R version 2.6.1 (2007-11-26)
* checking for file 'penalized/DESCRIPTION' ... OK
* this is package 'penalized' version '0.9-17'
* checking package name space information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking whether package 'penalized' can be installed ... OK
* checking package directory ... OK
* checking for portable file names ... OK
* checking DESCRIPTION meta-information ... OK
* checking top-level files ... OK
* checking index information ... OK
* checking package subdirectories ... OK
* checking R files for non-ASCII characters ... OK
* checking R files for syntax errors ... OK
* checking whether the package can be loaded ... OK
* checking whether the package can be loaded with stated dependencies
... OK
* checking whether the name space can be loaded with stated dependencies
... OK
* checking for unstated dependencies in R code ... OK
* checking S3 generic/method consistency ... OK
* checking replacement functions ... OK
* checking foreign function calls ... OK
* checking R code for possible problems ... OK
* checking Rd files ... OK
* checking Rd cross-references ... WARNING
Error in Rd_db(package, lib.loc = lib.loc) : 
  directory 'M:/R/packages/penalized.Rcheck/penalized' does not contain
Rd objects
Calls: <Anonymous> -> .build_Rd_xref_db -> Rd_db
Execution halted
* checking for missing documentation entries ... OK
* checking for code/documentation mismatches ... WARNING
Error in tools::codoc(package = "penalized") : 
  directory 'M:/R/packages/penalized.Rcheck/penalized' does not contain
Rd sources
Execution halted
Error in tools::codocData(package = "penalized") : 
  directory 'M:/R/packages/penalized.Rcheck/penalized' does not contain
Rd sources
Execution halted
Error in tools::codocClasses(package = "penalized") : 
  directory 'M:/R/packages/penalized.Rcheck/penalized' does not contain
Rd sources
Execution halted
* checking Rd \usage sections ... WARNING
Error in tools::checkDocFiles(package = "penalized") : 
  directory 'M:/R/packages/penalized.Rcheck/penalized' does not contain
Rd sources
Execution halted
Functions with \usage entries need to have the appropriate \alias
entries,
and all their arguments documented.
The \usage entries must correspond to syntactically valid R code.
See the chapter 'Writing R documentation files' in manual 'Writing R
Extensions'.
Error in tools::checkDocStyle(package = "penalized") : 
  directory 'M:/R/packages/penalized.Rcheck/penalized' does not contain
Rd sources
Execution halted
The \usage entries for S3 methods should use the \method markup and not
their full name.
See the chapter 'Writing R documentation files' in manual 'Writing R
Extensions'.
* checking data for non-ASCII characters ... OK
* creating penalized-Ex.R ... OK
* checking examples ... OK
* checking package vignettes in 'inst/doc' ... OK
* creating penalized-manual.tex ... OK
* checking penalized-manual.tex ... OK





www.msbi.nl/goeman 


From racinej at mcmaster.ca  Fri Nov 30 19:40:12 2007
From: racinej at mcmaster.ca (racinej at mcmaster.ca)
Date: Fri, 30 Nov 2007 19:40:12 +0100 (CET)
Subject: [Rd] Trivial formatting typo in summary(lm()) (PR#10480)
Message-ID: <20071130184012.B2447282EF48@mail.pubhealth.ku.dk>

Full_Name: Jeffrey Racine
Version: 2.6.1 and previous...
OS: FreeBSD
Submission from: (NULL) (130.113.139.86)


Hi.

I almost feel bad reporting this, but here goes.

The summary() for lm() (and possibly others?) uses a capitalized `S' in Multiple
R-Squared but a lowercase `s' in Adjusted R-squared. For instance,

Residual standard error: 0.5608 on 202 degrees of freedom
Multiple R-Squared: 0.2308,     Adjusted R-squared: 0.2232 
F-statistic:  30.3 on 2 and 202 DF,  p-value: 3.103e-12 

Perhaps they both ought to be lowercase? Again, truly trivial but perhaps it
adds to the overall polish...

-- Jeff


From adrian_d at eskimo.com  Fri Nov 30 21:55:06 2007
From: adrian_d at eskimo.com (adrian_d at eskimo.com)
Date: Fri, 30 Nov 2007 21:55:06 +0100 (CET)
Subject: [Rd] dataframe does not expand as.Dates objects (PR#10481)
Message-ID: <20071130205506.1B43F282EFF6@mail.pubhealth.ku.dk>

Full_Name: Adrian Dragulescu
Version: 2.6.0
OS: Windows
Submission from: (NULL) (216.99.178.65)


>   data.frame(x=1:10, y="A")  # expands fine
    x y
1   1 A
2   2 A
3   3 A
4   4 A
5   5 A
6   6 A
7   7 A
8   8 A
9   9 A
10 10 A
> 
>   data.frame(x=1:10, z=as.Date("2007-01-01"))  # get an error
Error in data.frame(x = 1:10, z = as.Date("2007-01-01")) : 
  arguments imply differing number of rows: 10, 1
>  

I always have to write a "rep" for date objects.  It is not the end of the world
but it would be nice if dates would behave like characters or numbers. 

Thank you.


