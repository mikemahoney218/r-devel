From richcalaway at revolution-computing.com  Tue Sep  1 01:20:15 2009
From: richcalaway at revolution-computing.com (richcalaway at revolution-computing.com)
Date: Tue,  1 Sep 2009 01:20:15 +0200 (CEST)
Subject: [Rd] xy.coords assumes lists will have x and y components,
	but doesn't check (PR#13936)
Message-ID: <20090831232015.6AB6B282EF52@mail.pubhealth.ku.dk>

Full_Name: Richard  Calaway
Version: 2.9.2
OS: Mac OS X 10.5.3
Submission from: (NULL) (65.47.30.18)


Here's my sessionInfo():

> sessionInfo()
R version 2.9.2 (2009-08-24) 
i386-apple-darwin8.11.1 

locale:
en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     


Currently, if you pass a list without x and y components to plot, you get an
error from plot.window and some warnings about "no non-missing arguments" to max
and min, and an empty graphics window:

> x <- list(fred=rnorm(10), joe=runif(10))
> plot(x)
Error in plot.window(...) : need finite 'xlim' values
In addition: Warning messages:
1: In min(x) : no non-missing arguments to min; returning Inf
2: In max(x) : no non-missing arguments to max; returning -Inf
3: In min(x) : no non-missing arguments to min; returning Inf
4: In max(x) : no non-missing arguments to max; returning -Inf
> traceback()
4: plot.window(...)
3: localWindow(xlim, ylim, log, asp, ...)
2: plot.default(x)
1: plot(x)

With the included patch, xy.coords returns an error and plot.window is never
called:

> plot(x)
Error in xy.coords(x, y, xlabel, ylabel, log) : 
  cannot find components 'x' and 'y'

Index: xyz.coords.R
===================================================================
--- xyz.coords.R        (revision 49504)
+++ xyz.coords.R        (working copy)
@@ -62,11 +62,15 @@
            }
        }
        else if(is.list(x)) {
-           xlab <- paste(ylab, "$x", sep="")
-           ylab <- paste(ylab, "$y", sep="")
-           y <- x[["y"]]
-           x <- x[["x"]]
-       }
+        if (!is.null(x[["x"]]) && !is.null(x[["y"]])) {
+               xlab <- paste(ylab, "$x", sep="")
+               ylab <- paste(ylab, "$y", sep="")
+               y <- x[["y"]]
+               x <- x[["x"]]
+           } else {
+            stop("cannot find components 'x' and 'y'")
+        }
+    }
        else {
            if(is.factor(x)) x <- as.numeric(x)
            xlab <- "Index"
@@ -155,14 +159,18 @@
            }
        }
        else if(is.list(x)) {
-           zlab <- paste(xlab,"$z",sep="")
-           ylab <- paste(xlab,"$y",sep="")
-           xlab <- paste(xlab,"$x",sep="")
-           y <- x[["y"]]
-           z <- x[["z"]]
-           x <- x[["x"]]
-       }
+        if (!is.null(x[["x"]]) && !is.null(x[["y"]])) {
+            zlab <- paste(xlab,"$z",sep="")
+               ylab <- paste(xlab,"$y",sep="")
+               xlab <- paste(xlab,"$x",sep="")
+               y <- x[["y"]]
+               z <- x[["z"]]
+               x <- x[["x"]]
+           } else {
+            stop("cannot find components 'x' and 'y'")
+        }
     }
+    }
 
     ## Only x, y
     if(!is.null(y) && is.null(z)) {


From richcalaway at revolution-computing.com  Tue Sep  1 01:45:09 2009
From: richcalaway at revolution-computing.com (richcalaway at revolution-computing.com)
Date: Tue,  1 Sep 2009 01:45:09 +0200 (CEST)
Subject: [Rd] setRepositories() doesn't allow graceful cancellation from GUI
	menu (PR#13937)
Message-ID: <20090831234509.9C7AE282EF52@mail.pubhealth.ku.dk>

Full_Name: Richard  Calaway
Version: 2.9.2
OS: Windows Vista
Submission from: (NULL) (65.47.30.18)


If you call setRepositories(graphics=TRUE), or, equivalently, choose "Select
repositories..." from RGui's Packages menu, and then click "Cancel", you are
dropped to the command line menu. Choosing "Cancel" should drop you back to the
top-level prompt. Also, the command-line menu doesn't specify how to cancel. The
following patch clears up both problems:

Index: packages.R
===================================================================
--- packages.R  (revision 49504)
+++ packages.R  (working copy)
@@ -639,7 +639,7 @@
     }
 
     default <- a[["default"]]
-
+    nc <- length(default)
     if(length(ind)) res <- as.integer(ind)
     else {
         res <- integer(0L)
@@ -654,20 +654,19 @@
                                                    multiple = TRUE,
"Repositori
es"),
                              a[, 1L])
         }
-        if(!length(res)) {
+        else {
             ## text-mode fallback
             cat(gettext("--- Please select repositories for use in this
session
 ---\n"))
-            nc <- length(default)
             cat("", paste(seq_len(nc), ": ",
                           ifelse(default, "+", " "), " ", a[, 1L],
                           sep=""),
                 "", sep="\n")
-            cat(gettext("Enter one or more numbers separated by spaces\n"))
+            cat(gettext("Enter one or more numbers separated by spaces, or 0
to
 cancel\n"))
             res <- scan("", what=0, quiet=TRUE, nlines=1L)
-            if(!length(res) || (length(res) == 1L && !res[1L]))
-                return(invisible())
-            res <- res[1 <= res && res <= nc]
         }
+        if(!length(res) || (length(res) == 1L && !res[1L]))
+            return(invisible())
+        res <- res[1 <= res && res <= nc]
     }
     if(length(res)) {
         repos <- a[["URL"]]


From richcalaway at revolution-computing.com  Tue Sep  1 02:18:47 2009
From: richcalaway at revolution-computing.com (Rich Calaway)
Date: Mon, 31 Aug 2009 17:18:47 -0700
Subject: [Rd] Strange interaction of browser() and warnings
Message-ID: <004201ca2a99$c68b47e0$53a1d7a0$@com>

Hi, DevelopeRs,

Consider the following simple function:

myFun <- function(){
	print(log(-1))
	browser()
	print("Bye!")
}

With default settings (in particular, options(warn=0)), if you call this
function and then type only standard browser commands (cont, n, where Q) at
the browser prompt, you see the warning message from printing log(-1)
printed after the final "Bye!":

> myFun()
[1] NaN
Called from: myFun()
Browse[1]> c
[1] "Bye!"
Warning message:
In log(-1) : NaNs produced

However, if you type an ordinary R expression at the browser prompt, you see
the warning message after that expression's output, while still at the
browser prompt:


> myFun()
[1] NaN
Called from: myFun()
Browse[1]> print(2)
[1] 2
Warning message:
In log(-1) : NaNs produced
Browse[1]>

This looks like a bug to me, but admit that I just might not understand
what's going on. So, is it a bug?





Rich Calaway
Documentation Manager
REvolution Computing, Inc.
richcalaway at revolution-computing.com
206-577-4778 x3204


From sever at hsuhh.de  Tue Sep  1 12:10:57 2009
From: sever at hsuhh.de (Krunoslav Sever)
Date: Tue, 01 Sep 2009 12:10:57 +0200
Subject: [Rd] Unexpected behaviour initializing S4 class
Message-ID: <4A9CF331.6070404@hsuhh.de>

Hello all!

I am not sure if this is known or even intended, but please consider the 
following simple example code:

# set up a simple S4 class with single slot
setClass("b", representation = representation(x = "numeric"))

# provide initialize method
setMethod("initialize",
   signature(.Object = "b"),
   function(.Object,...) b.initialize(.Object,...)
)

# actual implementation of initialize method external
b.initialize <- function(kl, x = numeric(),...) {
   kl at x <- x
   kl
}

# this gives an error in R-2.9.2
test <- new("b", x = 1:2, k = 3, y = 2)

What apparently happens is that the k=3 part in ... for b.initialize is
assigned to kl while the initial "b" object that should be assigned to 
kl ends up in "..." of b.initialize.

I assume this is due to the naming similarity of k and kl, probably 
confusing the matching algorithm: if another first argument for 
b.initialize is used (not starting with k), everything is fine.

Other workarounds:
- in setMethod write "kl = .Object" instead of simply ".Object"
- this does not happen if the contents of b.initialize are directly 
moved to the setMethod call, even if k is renamed to, say, .O

This happened to me in a case where b is a subclass of another class 
which has a slot named k, so the "offending" k = 3 is not artificial here.

I hope some dev here can look into the switching effect: this cannot 
possibly be intended?

Here my sessioninfo():
 > sessionInfo()
R version 2.9.2 (2009-08-24)
i686-pc-linux-gnu

locale:
LC_CTYPE=de_DE.UTF-8;LC_NUMERIC=C;LC_TIME=de_DE.UTF-8;LC_COLLATE=de_DE.UTF-8;LC_MONETARY=C;LC_MESSAGES=de_DE.UTF-8;LC_PAPER=de_DE.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=de_DE.UTF-8;LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

Best
   Kruno


From mtmorgan at fhcrc.org  Tue Sep  1 13:43:21 2009
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Tue, 01 Sep 2009 04:43:21 -0700
Subject: [Rd] Unexpected behaviour initializing S4 class
In-Reply-To: <4A9CF331.6070404@hsuhh.de>
References: <4A9CF331.6070404@hsuhh.de>
Message-ID: <4A9D08D9.1060205@fhcrc.org>

Hi Kruno --

Krunoslav Sever wrote:
> Hello all!
> 
> I am not sure if this is known or even intended, but please consider the
> following simple example code:
> 
> # set up a simple S4 class with single slot
> setClass("b", representation = representation(x = "numeric"))
> 
> # provide initialize method
> setMethod("initialize",
>   signature(.Object = "b"),
>   function(.Object,...) b.initialize(.Object,...)
> )
> 
> # actual implementation of initialize method external
> b.initialize <- function(kl, x = numeric(),...) {
>   kl at x <- x
>   kl
> }
> 
> # this gives an error in R-2.9.2
> test <- new("b", x = 1:2, k = 3, y = 2)
> 
> What apparently happens is that the k=3 part in ... for b.initialize is
> assigned to kl while the initial "b" object that should be assigned to
> kl ends up in "..." of b.initialize.

This is R argument matching at work

> f <- function(.Object, ...) g(.Object, ...)
> g <- function(kl, x, ...) match.call()
> f(1, x=2, k=3)
g(kl = 3, x = 2, .Object)

specifically partial matching of named arguments taking precedence of
positional matching of unnamed arguments.

> I assume this is due to the naming similarity of k and kl, probably
> confusing the matching algorithm: if another first argument for
> b.initialize is used (not starting with k), everything is fine.
> 
> Other workarounds:
> - in setMethod write "kl = .Object" instead of simply ".Object"

yes, this avoids mixing matching by name and by position.

Martin Morgan

> - this does not happen if the contents of b.initialize are directly
> moved to the setMethod call, even if k is renamed to, say, .O
> This happened to me in a case where b is a subclass of another class
> which has a slot named k, so the "offending" k = 3 is not artificial here.
> 
> I hope some dev here can look into the switching effect: this cannot
> possibly be intended?
> 
> Here my sessioninfo():
>> sessionInfo()
> R version 2.9.2 (2009-08-24)
> i686-pc-linux-gnu
> 
> locale:
> LC_CTYPE=de_DE.UTF-8;LC_NUMERIC=C;LC_TIME=de_DE.UTF-8;LC_COLLATE=de_DE.UTF-8;LC_MONETARY=C;LC_MESSAGES=de_DE.UTF-8;LC_PAPER=de_DE.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=de_DE.UTF-8;LC_IDENTIFICATION=C
> 
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> Best
>   Kruno
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ml-it-r-devel at epigenomics.com  Tue Sep  1 14:27:58 2009
From: ml-it-r-devel at epigenomics.com (ml-it-r-devel at epigenomics.com)
Date: Tue, 01 Sep 2009 14:27:58 +0200
Subject: [Rd] R devel repository tarball naming issue
Message-ID: <h7j40e$n4p$1@perl.epigenomics.epi>


Hi,

we noticed that since some time after Aug 24th the daily snapshots provided on
ftp://ftp.stat.math.ethz.ch/Software/R/

no longer have their default tarball file name

but dropped the date stamp, i.e. R-devel_.tar.bz2

Same for R-patched snapshots.

Could one of the maintainers please take a look. We rely on the default naming convention
for automatic builds.

Regards,

  Matthias

-- 
Matthias Burger                     Project Manager/ Biostatistician
Epigenomics AG    Kleine Praesidentenstr. 1    10178 Berlin, Germany
phone:+49-30-24345-0                            fax:+49-30-24345-555
http://www.epigenomics.com           matthias.burger at epigenomics.com
--
Epigenomics AG Berlin           Amtsgericht Charlottenburg HRB 75861
Vorstand:                           Geert Nygaard (CEO/Vorsitzender)
                                            Oliver Schacht PhD (CFO)
Aufsichtsrat:   Prof. Dr. Dr. hc. Rolf Krebs (Chairman/Vorsitzender)


From gvsteen at yahoo.com  Tue Sep  1 23:41:54 2009
From: gvsteen at yahoo.com (gvsteen at yahoo.com)
Date: Tue, 1 Sep 2009 14:41:54 -0700 (PDT)
Subject: [Rd] Including a binary Python Interpreter into a binary R-package
	for MS Windows
Message-ID: <57821.94131.qm@web65608.mail.ac4.yahoo.com>

2009/8/30 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
[snip]
> Guido van Steen wrote:
[snip]
>> Something that interests me too: What about R's policy with respect to
>> including binary files? I saw that developers should include a file
[snip]
> Please do not include binary files and carefully watch for licenses of those
> files (e.g. if GPL'ed, you need to ship sources!). If pyhthon is required, I
> highly suggest to state it in the SystemDependencies and be fine with it -
> users can learn to install phython themselves, I'm pretty sure.

Hi Uwe, 

Note: I will send this email cc. to the R-devel list, which I joined today. I think it may be of interest to other people as well. 

Thank you for your answer, although it disappointed me a bit. I had already spent quite some time building a stand-alone windows binary of a new package "write2xls". This package provides the same R interface to Python as the other package "dataframes2xls". As you know it enable users to create xls files. The special thing about "write2xls" is that it does not have any dependencies at all. It is so-to-speak a turn-key solution. 

Of course I should have read a bit more before I started. Only after your mail I read the pdf-file "Writing R Extensions". It says "A source package if possible should not contain binary executable files: they are not portable, and a security risk if they are of the appropriate architecture. R CMD check will warn about them unless they are listed (one filepath per line) in a file 'BinaryFiles' at the top level of the package or bundle. Note that CRAN will no longer accept submissions containing binary files even if they are listed." 

So, yes, you are right. I was actually hoping that CRAN could make some exceptions, but after some thinking I fully understand that many people would object to this for good reasons: R code depending on a C compiler will not work without a C Compiler either. For security reasons we cannot allow packages to install a binary C compiler. So, yes, I understand the reasons but still it is a pity. 

The current situation is that many MS Windows users can not easily use "dataframes2xls". There are a few reasons:  

* Most users of MS Windows will be unfamiliar with Python, which will make them reluctant to install Python. 

* Installing Python will be impossible on many MS Windows platforms due to limited user rights. 

* Downloading a standard Python installer takes about 15 Megabytes. My newly created "write2xls" package just contains 1.3 MB. 

So only few R users can benefit from "dataframes2xls". An alternative to "dataframes2xls" is "write.xls". "dataframes2xls" is technically superior, as it allows the specification of proper formatting and fonts. "dataframes2xls" also exists longer. However, "write.xls" is available to many more R users because it depends on Perl, which is installed as a part of the R-tools. 

So, I think it would be a pity not to provide "write2xls", since I have it readily available now. Therefore, I will probably be hosting "write2xls" on a different repository, as long as no Python Interpreter is included in the R-tools. Does anyone know of a alternative repository, which does accept "trustworthy" R packages with a binary Python Interpreter. 

Thanks! 

Best wishes, 

Guido van Steen 

P.S. For those who are interested or who would like to test it, at the moment "write2xls" can be downloaded as "http://www.heppel.net/write2xls_0.4.4.9.zip". The "source" package is available as "http://www.heppel.net/write2xls_0.4.4.9.tar.gz". 

P.P.S. I think that on MS Windows the combination of R and the R tools is just as much a potential security risk as allowing to include a Python Interpreter in a binary package. The R website should pay more serious attention to this.  

P.P.P.S. Uwe also brings up the issue of licensing. However, this is not a problem at all. The Python license is one of the most permissive licenses around. For the Python Interpreter that I included in the "write2xls" package, I used pyMingW, which is distributed under an MIT license. It is a version of Python compiled by the MinGW compiler. Thanks to this pyMingW distribution I also avoid the need of any Microsoft-owned dlls. "dataframes2xls" and "write2xls" are also distributed under a MIT license.


From ggrothendieck at gmail.com  Wed Sep  2 00:06:38 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 1 Sep 2009 18:06:38 -0400
Subject: [Rd] Including a binary Python Interpreter into a binary
	R-package for MS Windows
In-Reply-To: <57821.94131.qm@web65608.mail.ac4.yahoo.com>
References: <57821.94131.qm@web65608.mail.ac4.yahoo.com>
Message-ID: <971536df0909011506v7d876fefn430417c57f76df62@mail.gmail.com>

On Tue, Sep 1, 2009 at 5:41 PM, <gvsteen at yahoo.com> wrote:
> 2009/8/30 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
> [snip]
>> Guido van Steen wrote:
> [snip]
>>> Something that interests me too: What about R's policy with respect to
>>> including binary files? I saw that developers should include a file
> [snip]
>> Please do not include binary files and carefully watch for licenses of those
>> files (e.g. if GPL'ed, you need to ship sources!). If pyhthon is required, I
>> highly suggest to state it in the SystemDependencies and be fine with it -
>> users can learn to install phython themselves, I'm pretty sure.
>
> Hi Uwe,
>
> Note: I will send this email cc. to the R-devel list, which I joined today. I think it may be of interest to other people as well.
>
> Thank you for your answer, although it disappointed me a bit. I had already spent quite some time building a stand-alone windows binary of a new package "write2xls". This package provides the same R interface to Python as the other package "dataframes2xls". As you know it enable users to create xls files. The special thing about "write2xls" is that it does not have any dependencies at all. It is so-to-speak a turn-key solution.
>
> Of course I should have read a bit more before I started. Only after your mail I read the pdf-file "Writing R Extensions". It says "A source package if possible should not contain binary executable files: they are not portable, and a security risk if they are of the appropriate architecture. R CMD check will warn about them unless they are listed (one filepath per line) in a file 'BinaryFiles' at the top level of the package or bundle. Note that CRAN will no longer accept submissions containing binary files even if they are listed."
>
> So, yes, you are right. I was actually hoping that CRAN could make some exceptions, but after some thinking I fully understand that many people would object to this for good reasons: R code depending on a C compiler will not work without a C Compiler either. For security reasons we cannot allow packages to install a binary C compiler. So, yes, I understand the reasons but still it is a pity.
>
> The current situation is that many MS Windows users can not easily use "dataframes2xls". There are a few reasons:
>
> * Most users of MS Windows will be unfamiliar with Python, which will make them reluctant to install Python.
>
> * Installing Python will be impossible on many MS Windows platforms due to limited user rights.
>
> * Downloading a standard Python installer takes about 15 Megabytes. My newly created "write2xls" package just contains 1.3 MB.
>

Note that the rSymPy package has an entire Jython interpreter
in it and provided your software is only R and pure python you
should be able to run it off that.

Of course this just trades one dependency for another, i.e. it
does not require python since that's included but it does require
java; however, most people have java installed already since a lot
of the free software out there requires java.  See:
http://rsympy.googlecode.com

Note that since java jar files are source files and since java itself
is not included it was possible to do that without any binaries.


From gvsteen at yahoo.com  Wed Sep  2 01:09:01 2009
From: gvsteen at yahoo.com (gvsteen at yahoo.com)
Date: Tue, 1 Sep 2009 16:09:01 -0700 (PDT)
Subject: [Rd] Including a binary Python Interpreter into a binary
	R-package for MS Windows
In-Reply-To: <971536df0909011506v7d876fefn430417c57f76df62@mail.gmail.com>
Message-ID: <412717.16156.qm@web65616.mail.ac4.yahoo.com>

Hi Gabor, 

Thank you very much! That is an excelent idea! 

I had not thought about Jython at all. Moreover, I always had the impression that the latest Jython distribution was based on Python 2.2. But I just saw that they upgraded to 2.5 a few months ago. This is quite fortunate because both "dataframes2xls" and "write2xls" depend on Python 2.4 or better. 

An R user will not notice much of a 15 MB download. And for most MS Windows users Java is an even more common thing than Perl. 

I will definitely check this out! 

Thanks a lot!!! 

Best wishes, 

Guido 

--- On Wed, 9/2/09, Gabor Grothendieck <ggrothendieck at gmail.com> wrote:

> From: Gabor Grothendieck <ggrothendieck at gmail.com>
> Subject: Re: [Rd] Including a binary Python Interpreter into a binary  R-package for MS Windows
> To: gvsteen at yahoo.com
> Cc: Uwe.Ligges at r-project.org, r-devel at r-project.org
> Date: Wednesday, September 2, 2009, 12:06 AM
> On Tue, Sep 1, 2009 at 5:41 PM,
> <gvsteen at yahoo.com>
> wrote:
> > 2009/8/30 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
> > [snip]
> >> Guido van Steen wrote:
> > [snip]
> >>> Something that interests me too: What about
> R's policy with respect to
> >>> including binary files? I saw that developers
> should include a file
> > [snip]
> >> Please do not include binary files and carefully
> watch for licenses of those
> >> files (e.g. if GPL'ed, you need to ship sources!).
> If pyhthon is required, I
> >> highly suggest to state it in the
> SystemDependencies and be fine with it -
> >> users can learn to install phython themselves, I'm
> pretty sure.
> >
> > Hi Uwe,
> >
> > Note: I will send this email cc. to the R-devel list,
> which I joined today. I think it may be of interest to other
> people as well.
> >
> > Thank you for your answer, although it disappointed me
> a bit. I had already spent quite some time building a
> stand-alone windows binary of a new package "write2xls".
> This package provides the same R interface to Python as the
> other package "dataframes2xls". As you know it enable users
> to create xls files. The special thing about "write2xls" is
> that it does not have any dependencies at all. It is
> so-to-speak a turn-key solution.
> >
> > Of course I should have read a bit more before I
> started. Only after your mail I read the pdf-file "Writing R
> Extensions". It says "A source package if possible should
> not contain binary executable files: they are not portable,
> and a security risk if they are of the appropriate
> architecture. R CMD check will warn about them unless they
> are listed (one filepath per line) in a file 'BinaryFiles'
> at the top level of the package or bundle. Note that CRAN
> will no longer accept submissions containing binary files
> even if they are listed."
> >
> > So, yes, you are right. I was actually hoping that
> CRAN could make some exceptions, but after some thinking I
> fully understand that many people would object to this for
> good reasons: R code depending on a C compiler will not work
> without a C Compiler either. For security reasons we cannot
> allow packages to install a binary C compiler. So, yes, I
> understand the reasons but still it is a pity.
> >
> > The current situation is that many MS Windows users
> can not easily use "dataframes2xls". There are a few
> reasons:
> >
> > * Most users of MS Windows will be unfamiliar with
> Python, which will make them reluctant to install Python.
> >
> > * Installing Python will be impossible on many MS
> Windows platforms due to limited user rights.
> >
> > * Downloading a standard Python installer takes about
> 15 Megabytes. My newly created "write2xls" package just
> contains 1.3 MB.
> >
> 
> Note that the rSymPy package has an entire Jython
> interpreter
> in it and provided your software is only R and pure python
> you
> should be able to run it off that.
> 
> Of course this just trades one dependency for another, i.e.
> it
> does not require python since that's included but it does
> require
> java; however, most people have java installed already
> since a lot
> of the free software out there requires java.? See:
> http://rsympy.googlecode.com
> 
> Note that since java jar files are source files and since
> java itself
> is not included it was possible to do that without any
> binaries.
> 





From MSilva at specificmedia.com  Wed Sep  2 03:05:42 2009
From: MSilva at specificmedia.com (Matias Silva)
Date: Tue, 1 Sep 2009 18:05:42 -0700
Subject: [Rd] Installing rJava RJDBC bad interpreter: Permission denied
Message-ID: <1D39027E38D41B4C91702F159EF19160239ECCCA37@west-corp-ex02.specificmedia.local>

Trying to install the above two packages via the "install.packages("package_name")" command and
the "R CMD INSTALL file.tar.gz".

I receive the following error either way "sh: ./configure: /bin/sh: bad interpreter: Permission denied".
I have tried to chmod and chown permissions and also ran dos2unix in hopes that there is a CRLF
in some of the tar.gz files, but that doesn't seem to fix the problem.? I'm looking for any help
I can get.? I have tried the r-help and r-packages list.  I have tried this with the compiled
version of R and the RPM version of R.

* Installing *source* package ?rJava? ...
sh: ./configure: /bin/sh: bad interpreter: Permission denied
ERROR: configuration failed for package ?rJava?
* Removing ?/usr/lib64/R/library/rJava?
* Installing *source* package ?RJDBC? ...
** R
** preparing package for lazy loading
Error : package 'rJava' required by 'RJDBC' could not be found
ERROR: lazy loading failed for package ?RJDBC?
* Removing ?/usr/lib64/R/library/RJDBC?

I'm using the rpm version of R found here http://cran.cnr.berkeley.edu/bin/linux/redhat/el5/x86_64
I ran the "R CMD javareconf" as root and set the JAVA_HOME environment variable.

Here is my system configuration:
OS: CentOS 5.2 x86_64

JDK: java version "1.6.0_12"
Java(TM) SE Runtime Environment (build 1.6.0_12-b04)
Java HotSpot(TM) 64-Bit Server VM (build 11.2-b01, mixed mode)

R: 2.9.1
rJava: rJava_0.7-0.tar.gz
RJDBC: RJDBC_0.1-5.tar.gz

Thanks for your time and knowledge.

Best,
Matt


From Pin.Ng at nau.edu  Wed Sep  2 03:49:01 2009
From: Pin.Ng at nau.edu (Pin Tian Ng)
Date: Tue, 1 Sep 2009 18:49:01 -0700
Subject: [Rd] License of Port3 library for R
Message-ID: <C6C31D1D.A1E0%Pin.Ng@nau.edu>

      I developed some code that called subroutines from the Port3 Library
(http://www-out.bell-labs.com/project/PORT/).  I?m thinking about making it
available as an R package.  But I?m not sure if their NON-EXCLUSIVE SOURCE
CODE LICENSE AGREEMENT (
http://www-out.bell-labs.com/topic/swdist/licenses/nesource.txt ) permits
this.  I tried contacting the contact person listed on the website.  Not
surprisingly, the recipient doesn't exist at Lucent anymore.  Any advice on
this will be appreciated.


Pin Ng
Associate Professor of Economics
The W. A. Franke College of Business
Northern Arizona University
P.O. Box 15066
Flagstaff, AZ 86011-5066
(Phone) 928-523-8726
(Fax) 928-523-7331
(Email) Pin.Ng at nau.edu
(URL) http://www.cba.nau.edu/pin-ng

 


From asr at ufl.edu  Wed Sep  2 08:53:16 2009
From: asr at ufl.edu (Allen S. Rout)
Date: Wed, 02 Sep 2009 02:53:16 -0400
Subject: [Rd] Dependencies of  packages' CHECK....
Message-ID: <44wpf1vmp6dnn.fsf@crepe.osg.ufl.edu>




I'm working to automate the building of RPM packages for CRAN &c.  In
the process, I'm trying to get a sense of the correct dependencies.

It's my sense that R CMD CHECK is the Right Way to check to see if a
package is built properly.  But according to Writing R Extensions, I
could reasonably expect anything in Suggests or Imports to be used by
CHECK.  In RPM parlance, this turns all of those packages into a
'build requires'.

In other words, to check properly, I need to treat Suggests and
Imports as Depends.

This is a short road to -lots- of installed packages. :) ggplot2,
which was the initial itch I was trying to scratch, 'Depends' only on
R.  But if I have to recursively expand according to these 'build
requires', I need 63 packages.  And more painfully, I have to leave
CRAN and go grok Bioconductor.  Yow.


So: does this seem silly, or is that just The Way It is? 


- Allen S. Rout


From b.rowlingson at lancaster.ac.uk  Wed Sep  2 09:44:14 2009
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 2 Sep 2009 08:44:14 +0100
Subject: [Rd] License of Port3 library for R
In-Reply-To: <C6C31D1D.A1E0%Pin.Ng@nau.edu>
References: <C6C31D1D.A1E0%Pin.Ng@nau.edu>
Message-ID: <d8ad40b50909020044o53318b23n65684e7fd5d5c9f7@mail.gmail.com>

On Wed, Sep 2, 2009 at 2:49 AM, Pin Tian Ng<Pin.Ng at nau.edu> wrote:
> ? ? ?I developed some code that called subroutines from the Port3 Library
> (http://www-out.bell-labs.com/project/PORT/). ?I?m thinking about making it
> available as an R package. ?But I?m not sure if their NON-EXCLUSIVE SOURCE
> CODE LICENSE AGREEMENT (
> http://www-out.bell-labs.com/topic/swdist/licenses/nesource.txt ) permits
> this.

 It looks like a single-user, no-redistribution, no copying license.
You could write a package that calls Port3 subroutines, but you
couldn't distribute Port3 source or binaries with it - users would
have to go get it themselves, and then probably they'd have to compile
it.

 It seems though that some of Port3 is derived from Public Domain
sources - see here:

http://www-out.bell-labs.com/project/PORT/doc/README

 and you could include those files.

>?I tried contacting the contact person listed on the website. ?Not
> surprisingly, the recipient doesn't exist at Lucent anymore. ?Any advice on
> this will be appreciated.

 I'd recommend you rewrite your code to call subroutines from freely
available and redistributable code libraries - in many cases you can
use internal R subroutines, or there's the GSL:

http://www.gnu.org/software/gsl/

Barry


From ligges at statistik.tu-dortmund.de  Wed Sep  2 09:52:22 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 02 Sep 2009 09:52:22 +0200
Subject: [Rd] Dependencies of  packages' CHECK....
In-Reply-To: <44wpf1vmp6dnn.fsf@crepe.osg.ufl.edu>
References: <44wpf1vmp6dnn.fsf@crepe.osg.ufl.edu>
Message-ID: <4A9E2436.8070709@statistik.tu-dortmund.de>



Allen S. Rout wrote:
> 
> 
> I'm working to automate the building of RPM packages for CRAN &c.  In
> the process, I'm trying to get a sense of the correct dependencies.
> 
> It's my sense that R CMD CHECK is the Right Way to check to see if a
> package is built properly.  But according to Writing R Extensions, I
> could reasonably expect anything in Suggests or Imports to be used by
> CHECK.  In RPM parlance, this turns all of those packages into a
> 'build requires'.
> 
> In other words, to check properly, I need to treat Suggests and
> Imports as Depends.
> 
> This is a short road to -lots- of installed packages. :) ggplot2,
> which was the initial itch I was trying to scratch, 'Depends' only on
> R.  But if I have to recursively expand according to these 'build
> requires', I need 63 packages.  And more painfully, I have to leave
> CRAN and go grok Bioconductor.  Yow.
> 
> 
> So: does this seem silly, or is that just The Way It is? 


Yes, it is the way it is says the Windows binary package maintainer.

Best,
Uwe Ligges




> 
> - Allen S. Rout
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch at stats.uwo.ca  Wed Sep  2 12:43:56 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 02 Sep 2009 06:43:56 -0400
Subject: [Rd] [R] R and GNU gcc for OpenMP
In-Reply-To: <4A9E7117.5860.00D0.0@commerce.nsw.gov.au>
References: <4A9E7117.5860.00D0.0@commerce.nsw.gov.au>
Message-ID: <4A9E4C6C.9090307@stats.uwo.ca>

Debabrata Midya wrote:
> Dear R users,
>  
> Thanks in advance.
>
>
>
> I am using R 2.9.1 on Windows XP.
>  
> May I request you to assist me on the following:
>  
> I have downloaded Rtools29.exe and installed it today 02 Sep 2009 and I have also provided the appropriate path variable for Rtools.
>  
> I have checked the version of gcc compiler in Rtools.exe is 4.2.1.
>  
> I have checked (in  http://gcc.gnu.org/) the latest available gcc compiler is 4.4.1. My objective is to use latest gnu gcc for openMP and I like to link it to R (by creating *.dll).
>  
> How can I use latest version of gcc for openMP? And at the same time I like to use Rtools as well.
>   

I have moved this response to the R-devel mailing list, it's not really 
appropriate for R-help.

Generally speaking the compiler used for a .dll need not be the same one 
used for the rest of an application, so R won't care if you work out how 
to use gcc 4.4.1 to build your dll.  However:

  - The scripts for building packages are written and tested against gcc 
4.2.1; you may need to tweak them to work with a different compiler.
  - As far as I know, there's no gcc 4.4.1 available for Windows, but 
4.4.0 is available on the MinGW site.  So if you really need 4.4.1 you 
may need to compile it yourself.

So this is a pretty difficult project.   You can ask on the R-devel 
mailing list for help, but there aren't many people who will be able to 
help you, so you may be pretty much on your own.

Duncan Murdoch
>  
> Once again, thank you very much for the time you have given.
>  
> I am looking forward for your reply.
>  
> Regards,
>  
> Deb
>  
> ******************************************************************************
>
> This email message, including any attached files, is confidential and
> intended solely for the use of the individual or entity to whom it is
> addressed. 
>
> The NSW Department of Commerce prohibits the right to publish, 
> copy, distribute or disclose any information contained in this email, 
> or its attachments, by any party other than the intended recipient. 
> If you have received this email in error please notify the sender and
> delete it from your system.
>
> No employee or agent is authorised to conclude any binding 
> agreement on behalf of the NSW Department of Commerce by email. The
> views or opinions presented in this email are solely those of the author
> and do not necessarily represent those of the Department, 
> except where the sender expressly, and with authority, states them to be
> the views of NSW Department of Commerce.  
>
> The NSW Department of Commerce accepts no liability for any loss or
> damage arising from the use of this email and recommends that the
> recipient check this email and any attached files for the presence of
> viruses. 
>
> ******************************************************************************
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-help at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>


From romain.francois at dbmail.com  Wed Sep  2 12:55:57 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Wed, 02 Sep 2009 12:55:57 +0200
Subject: [Rd] How to ship R scripts with R packages ?
Message-ID: <4A9E4F3D.5070704@dbmail.com>

Hello,

(This is a remix of this previous thread: 
https://stat.ethz.ch/pipermail/r-devel/2009-August/054264.html , but 
with a concrete example)

I am developing some packages that contain scripts (for Rscript) and 
would like to know what is the best/recommended way to ship these scripts.

An example is the "ant" package (R capable version of apache ant, see 
http://tr.im/xHLs). The package has a ant.R script in the exec directory 
and here is how I use it :

$ `Rscript -e "cat( system.file( 'exec', 'ant.R', package = 'ant' ) ) " `

... not so pretty. Meanwhile, "Writing R extensions" talks about the 
exec directory, but it is not clear if I can use it this way or how.

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/xHLs : R capable version of ant
|- http://tr.im/xHiZ : Tip: get java home from R with rJava
`- http://tr.im/xkMc : Combine R CMD build and junit


From murdoch at stats.uwo.ca  Wed Sep  2 13:13:26 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 02 Sep 2009 07:13:26 -0400
Subject: [Rd] How to ship R scripts with R packages ?
In-Reply-To: <4A9E4F3D.5070704@dbmail.com>
References: <4A9E4F3D.5070704@dbmail.com>
Message-ID: <4A9E5356.4020907@stats.uwo.ca>

Romain Francois wrote:
> Hello,
>
> (This is a remix of this previous thread: 
> https://stat.ethz.ch/pipermail/r-devel/2009-August/054264.html , but 
> with a concrete example)
>
> I am developing some packages that contain scripts (for Rscript) and 
> would like to know what is the best/recommended way to ship these scripts.
>
> An example is the "ant" package (R capable version of apache ant, see 
> http://tr.im/xHLs). The package has a ant.R script in the exec directory 
> and here is how I use it :
>
> $ `Rscript -e "cat( system.file( 'exec', 'ant.R', package = 'ant' ) ) " `
>
> ... not so pretty. Meanwhile, "Writing R extensions" talks about the 
> exec directory, but it is not clear if I can use it this way or how.
>
>   

I think exec is a reasonable place to put the script.  If you don't want 
to type that long command above, why not put it in a small function in 
the package?  E.g. define

antR <- function() cat( system.file( 'exec', 'ant.R', package = 'ant' ) )

then you can run it with
 
Rscript -e "ant::antR()"

Duncan Murdoch


> Romain
>
>


From simon.urbanek at r-project.org  Wed Sep  2 14:12:24 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 2 Sep 2009 08:12:24 -0400
Subject: [Rd] Installing rJava RJDBC bad interpreter: Permission denied
In-Reply-To: <1D39027E38D41B4C91702F159EF19160239ECCCA37@west-corp-ex02.specificmedia.local>
References: <1D39027E38D41B4C91702F159EF19160239ECCCA37@west-corp-ex02.specificmedia.local>
Message-ID: <ED58EC2B-E9AC-4FB3-95DD-C09E6876793E@r-project.org>


On Sep 1, 2009, at 21:05 , Matias Silva wrote:

> Trying to install the above two packages via the  
> "install.packages("package_name")" command and
> the "R CMD INSTALL file.tar.gz".
>
> I receive the following error either way "sh: ./configure: /bin/sh:  
> bad interpreter: Permission denied".
> I have tried to chmod and chown permissions and also ran dos2unix in  
> hopes that there is a CRLF
> in some of the tar.gz files, but that doesn't seem to fix the problem.

The problem is in your system not the packages. Please read the error  
message carefully - it says your /bin/sh is broken. Fix it and all  
should be well.

Cheers,
S


> I'm looking for any help
> I can get.  I have tried the r-help and r-packages list.  I have  
> tried this with the compiled
> version of R and the RPM version of R.
>
> * Installing *source* package ?rJava? ...
> sh: ./configure: /bin/sh: bad interpreter: Permission denied
> ERROR: configuration failed for package ?rJava?
> * Removing ?/usr/lib64/R/library/rJava?
> * Installing *source* package ?RJDBC? ...
> ** R
> ** preparing package for lazy loading
> Error : package 'rJava' required by 'RJDBC' could not be found
> ERROR: lazy loading failed for package ?RJDBC?
> * Removing ?/usr/lib64/R/library/RJDBC?
>
> I'm using the rpm version of R found here http://cran.cnr.berkeley.edu/bin/linux/redhat/el5/x86_64
> I ran the "R CMD javareconf" as root and set the JAVA_HOME  
> environment variable.
>
> Here is my system configuration:
> OS: CentOS 5.2 x86_64
>
> JDK: java version "1.6.0_12"
> Java(TM) SE Runtime Environment (build 1.6.0_12-b04)
> Java HotSpot(TM) 64-Bit Server VM (build 11.2-b01, mixed mode)
>
> R: 2.9.1
> rJava: rJava_0.7-0.tar.gz
> RJDBC: RJDBC_0.1-5.tar.gz
>
> Thanks for your time and knowledge.
>
> Best,
> Matt
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From romain.francois at dbmail.com  Wed Sep  2 14:13:38 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Wed, 02 Sep 2009 14:13:38 +0200
Subject: [Rd] How to ship R scripts with R packages ?
In-Reply-To: <4A9E5356.4020907@stats.uwo.ca>
References: <4A9E4F3D.5070704@dbmail.com> <4A9E5356.4020907@stats.uwo.ca>
Message-ID: <4A9E6172.8000201@dbmail.com>

On 09/02/2009 01:13 PM, Duncan Murdoch wrote:
>
> Romain Francois wrote:
>> Hello,
>>
>> (This is a remix of this previous thread:
>> https://stat.ethz.ch/pipermail/r-devel/2009-August/054264.html , but
>> with a concrete example)
>>
>> I am developing some packages that contain scripts (for Rscript) and
>> would like to know what is the best/recommended way to ship these
>> scripts.
>>
>> An example is the "ant" package (R capable version of apache ant, see
>> http://tr.im/xHLs). The package has a ant.R script in the exec
>> directory and here is how I use it :
>>
>> $ `Rscript -e "cat( system.file( 'exec', 'ant.R', package = 'ant' ) ) " `
>>
>> ... not so pretty. Meanwhile, "Writing R extensions" talks about the
>> exec directory, but it is not clear if I can use it this way or how.
>>
>
> I think exec is a reasonable place to put the script. If you don't want
> to type that long command above, why not put it in a small function in
> the package? E.g. define
>
> antR <- function() cat( system.file( 'exec', 'ant.R', package = 'ant' ) )
>
> then you can run it with
>
> Rscript -e "ant::antR()"
>
> Duncan Murdoch

Yes. I'd have to do a bit more work to call the script with parameters. 
Something like this perhaps:

antR <- function( run = FALSE){
	rscript    <- file.path( R.home(), "bin", "Rscript" )
	ant.script <- system.file( 'exec', 'ant.R', package = 'ant' )
	cmd <- sprintf( '"%s" "%s" %s',
		rscript, ant.script, paste( commandArgs( TRUE), collapse = " " )
	
	if( run ){
		system( cmd )
	} else {
		run
	}
}

...

I guess i am looking for a mechanism similar to the dispatch of CMD, but 
able to dispatch within exec directories of packages :

$ R CMD exec ant ant.R

or maybe a --package switch in Rscript:

$ Rscript --package ant ant.R

or a Rexec script similar to Rscript :

$ Rexec ant/ant.R

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/xHLs : R capable version of ant
|- http://tr.im/xHiZ : Tip: get java home from R with rJava
`- http://tr.im/xkMc : Combine R CMD build and junit


From simon.urbanek at r-project.org  Wed Sep  2 14:21:54 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 2 Sep 2009 08:21:54 -0400
Subject: [Rd] Dependencies of  packages' CHECK....
In-Reply-To: <44wpf1vmp6dnn.fsf@crepe.osg.ufl.edu>
References: <44wpf1vmp6dnn.fsf@crepe.osg.ufl.edu>
Message-ID: <4059DBC9-C918-4D26-956E-C6627A1BB079@r-project.org>

Allen,

On Sep 2, 2009, at 2:53 , Allen S. Rout wrote:

> I'm working to automate the building of RPM packages for CRAN &c.   
> In the process, I'm trying to get a sense of the correct dependencies.
>
> It's my sense that R CMD CHECK is the Right Way to check to see if a  
> package is built properly.  But according to Writing R Extensions, I  
> could reasonably expect anything in Suggests or Imports to be used  
> by CHECK.  In RPM parlance, this turns all of those packages into a  
> 'build requires'.
>
> In other words, to check properly, I need to treat Suggests and  
> Imports as Depends.
>
> This is a short road to -lots- of installed packages. :) ggplot2,  
> which was the initial itch I was trying to scratch, 'Depends' only  
> on R.  But if I have to recursively expand according to these 'build  
> requires', I need 63 packages.  And more painfully, I have to leave  
> CRAN and go grok Bioconductor.  Yow.
>
>
> So: does this seem silly, or is that just The Way It is?
>

Think about it - if you want to check all the functionality properly,  
you have to install all packages. If you omit some of them, the  
functionality related to those packages clearly cannot be tested even  
if it's just in the conditional suggests branch. You can decide to run  
checks without forcing suggests (see _R_CHECK_FORCE_SUGGESTS_) at the  
risk of not checking the advanced functionality - that's up to you,  
but you'll be skipping parts of the code.

However, as a binary maintainer, you'll have to install all CRAN and  
parts of BioC anyway, so in practice this is not an issue at all.

Cheers,
Simon


From ivo_welch at brown.edu  Wed Sep  2 15:05:13 2009
From: ivo_welch at brown.edu (ivo_welch at brown.edu)
Date: Wed,  2 Sep 2009 15:05:13 +0200 (CEST)
Subject: [Rd] Links in Doc to plots for 3d (PR#13939)
Message-ID: <20090902130514.2A0802831FFA@mail.pubhealth.ku.dk>

Full_Name: ivo welch
Version: 2.9.2
OS: OSX
Submission from: (NULL) (128.148.61.243)



could you please add in the "See also" section of "plot" a link to "persp for 3d
plots", and in the "persp" See also section links to

cloud() in package "lattice"
plot3d() in package "rgl"
scatterplot3d() in package "scatterplot3d"

I was stymied for a long time about what I should use where.

regards,

/iaw


From hadley at rice.edu  Wed Sep  2 15:08:20 2009
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 2 Sep 2009 08:08:20 -0500
Subject: [Rd] Tracebacks & try
Message-ID: <f8e6ff050909020608v3e59065bre2749c4e5822e636@mail.gmail.com>

Hi all,

The help for traceback states:

  Errors which are caught _via_ 'try' or 'tryCatch' do not generate
  a traceback, so what is printed is the call sequence for the last
  uncaught error, and not necessarily for the last error.

Is there any way to get a traceback (or something similar) for an
error raised inside a try block?

Regards,

Hadley


-- 
http://had.co.nz/


From ripley at stats.ox.ac.uk  Wed Sep  2 15:15:02 2009
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 2 Sep 2009 14:15:02 +0100 (BST)
Subject: [Rd] [R] R and GNU gcc for OpenMP
In-Reply-To: <4A9E4C6C.9090307@stats.uwo.ca>
References: <4A9E7117.5860.00D0.0@commerce.nsw.gov.au>
	<4A9E4C6C.9090307@stats.uwo.ca>
Message-ID: <alpine.LFD.2.00.0909021412110.30523@gannet.stats.ox.ac.uk>

On Wed, 2 Sep 2009, Duncan Murdoch wrote:

> Debabrata Midya wrote:
>> Dear R users,
>>  Thanks in advance.
>> 
>> 
>> 
>> I am using R 2.9.1 on Windows XP.
>>  May I request you to assist me on the following:
>>  I have downloaded Rtools29.exe and installed it today 02 Sep 2009 and I 
>> have also provided the appropriate path variable for Rtools.
>>  I have checked the version of gcc compiler in Rtools.exe is 4.2.1.
>>  I have checked (in  http://gcc.gnu.org/) the latest available gcc compiler 
>> is 4.4.1. My objective is to use latest gnu gcc for openMP and I like to 
>> link it to R (by creating *.dll).
>>  How can I use latest version of gcc for openMP? And at the same time I 
>> like to use Rtools as well.
>> 
>
> I have moved this response to the R-devel mailing list, it's not really 
> appropriate for R-help.
>
> Generally speaking the compiler used for a .dll need not be the same one used 
> for the rest of an application, so R won't care if you work out how to use 
> gcc 4.4.1 to build your dll.  However:
>
> - The scripts for building packages are written and tested against gcc 
> 4.2.1; you may need to tweak them to work with a different compiler.
> - As far as I know, there's no gcc 4.4.1 available for Windows, but 4.4.0 is 
> available on the MinGW site.  So if you really need 4.4.1 you may need to 
> compile it yourself.
>
> So this is a pretty difficult project.   You can ask on the R-devel mailing 
> list for help, but there aren't many people who will be able to help you, so 
> you may be pretty much on your own.

To add to this:

- The MinGW gcc 4.4.0 is too buggy to build R successfully.

- I don't see that you need 4.4.0 to use OpenMP: I have used it with 
4.2.1. (And note: that is not an offer of help to do so.)

>
> Duncan Murdoch
>>  Once again, thank you very much for the time you have given.
>>  I am looking forward for your reply.
>>  Regards,
>>  Deb


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From MSilva at specificmedia.com  Wed Sep  2 18:04:38 2009
From: MSilva at specificmedia.com (Matias Silva)
Date: Wed, 2 Sep 2009 09:04:38 -0700
Subject: [Rd] Installing rJava RJDBC bad interpreter: Permission denied
In-Reply-To: <ED58EC2B-E9AC-4FB3-95DD-C09E6876793E@r-project.org>
References: <1D39027E38D41B4C91702F159EF19160239ECCCA37@west-corp-ex02.specificmedia.local>,
	<ED58EC2B-E9AC-4FB3-95DD-C09E6876793E@r-project.org>
Message-ID: <1D39027E38D41B4C91702F159EF19160239E4D6333@west-corp-ex02.specificmedia.local>

Hi Simon, thanks for responding, I really appreciate it.  If there is a problem with /bin/sh then I could not install 
any packages(??).  I installed a DBI package successfully.  I have also tried this on 3 different machines - 2 CentOS 5.3 
and 1 RHEL 5.3.  I can try this using Ubuntu later today.

What has me baffled is the unknown characters surrounding the package name " ?rJava?" and "?RJDBC?" and thats
what I think is causing the problem with /bin/sh.

Thanks,
Matt
________________________________________
From: Simon Urbanek [simon.urbanek at r-project.org]
Sent: Wednesday, September 02, 2009 5:12 AM
To: Matias Silva
Cc: r-devel at r-project.org
Subject: Re: [Rd] Installing rJava RJDBC bad interpreter: Permission denied

On Sep 1, 2009, at 21:05 , Matias Silva wrote:

> Trying to install the above two packages via the
> "install.packages("package_name")" command and
> the "R CMD INSTALL file.tar.gz".
>
> I receive the following error either way "sh: ./configure: /bin/sh:
> bad interpreter: Permission denied".
> I have tried to chmod and chown permissions and also ran dos2unix in
> hopes that there is a CRLF
> in some of the tar.gz files, but that doesn't seem to fix the problem.

The problem is in your system not the packages. Please read the error
message carefully - it says your /bin/sh is broken. Fix it and all
should be well.

Cheers,
S


> I'm looking for any help
> I can get.  I have tried the r-help and r-packages list.  I have
> tried this with the compiled
> version of R and the RPM version of R.
>
> * Installing *source* package ?rJava? ...
> sh: ./configure: /bin/sh: bad interpreter: Permission denied
> ERROR: configuration failed for package ?rJava?
> * Removing ?/usr/lib64/R/library/rJava?
> * Installing *source* package ?RJDBC? ...
> ** R
> ** preparing package for lazy loading
> Error : package 'rJava' required by 'RJDBC' could not be found
> ERROR: lazy loading failed for package ?RJDBC?
> * Removing ?/usr/lib64/R/library/RJDBC?
>
> I'm using the rpm version of R found here http://cran.cnr.berkeley.edu/bin/linux/redhat/el5/x86_64
> I ran the "R CMD javareconf" as root and set the JAVA_HOME
> environment variable.
>
> Here is my system configuration:
> OS: CentOS 5.2 x86_64
>
> JDK: java version "1.6.0_12"
> Java(TM) SE Runtime Environment (build 1.6.0_12-b04)
> Java HotSpot(TM) 64-Bit Server VM (build 11.2-b01, mixed mode)
>
> R: 2.9.1
> rJava: rJava_0.7-0.tar.gz
> RJDBC: RJDBC_0.1-5.tar.gz
>
> Thanks for your time and knowledge.
>
> Best,
> Matt
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

From wdunlap at tibco.com  Wed Sep  2 19:03:16 2009
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 2 Sep 2009 10:03:16 -0700
Subject: [Rd] Installing rJava RJDBC bad interpreter: Permission denied
In-Reply-To: <1D39027E38D41B4C91702F159EF19160239E4D6333@west-corp-ex02.specificmedia.local>
References: <1D39027E38D41B4C91702F159EF19160239ECCCA37@west-corp-ex02.specificmedia.local>,
	<ED58EC2B-E9AC-4FB3-95DD-C09E6876793E@r-project.org>
	<1D39027E38D41B4C91702F159EF19160239E4D6333@west-corp-ex02.specificmedia.local>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D70001B734F5@NA-PA-VBE03.na.tibco.com>


> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Matias Silva
> Sent: Wednesday, September 02, 2009 9:05 AM
> To: Simon Urbanek
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] Installing rJava RJDBC bad interpreter: 
> Permission denied
> 
> Hi Simon, thanks for responding, I really appreciate it.  If 
> there is a problem with /bin/sh then I could not install 
> any packages(??).  I installed a DBI package successfully.  I 
> have also tried this on 3 different machines - 2 CentOS 5.3 
> and 1 RHEL 5.3.  I can try this using Ubuntu later today.

Most packages installations don't invoke /bin/sh but RJDBC
has a configure file that does.  Can you run a sh script called
/tmp/junk.sh containing

#!/bin/sh
echo Hello at `date`

with the commands

chmod +x /tmp/junk.sh
sh -c /tmp/junk.sh

or

/tmp/junk.sh

?

> What has me baffled is the unknown characters surrounding the 
> package name " ?rJava?" and "?RJDBC?" and thats
> what I think is causing the problem with /bin/sh.

I think those are quotes put on by R's sQuote() function and are
typically seen in error and warning messages.  Some
xtem's don't know how to render them correctly.
Set LANG to C before starting R to avoid them.

> 
> Thanks,
> Matt
> ________________________________________
> From: Simon Urbanek [simon.urbanek at r-project.org]
> Sent: Wednesday, September 02, 2009 5:12 AM
> To: Matias Silva
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] Installing rJava RJDBC bad interpreter: 
> Permission denied
> 
> On Sep 1, 2009, at 21:05 , Matias Silva wrote:
> 
> > Trying to install the above two packages via the
> > "install.packages("package_name")" command and
> > the "R CMD INSTALL file.tar.gz".
> >
> > I receive the following error either way "sh: ./configure: /bin/sh:
> > bad interpreter: Permission denied".
> > I have tried to chmod and chown permissions and also ran dos2unix in
> > hopes that there is a CRLF
> > in some of the tar.gz files, but that doesn't seem to fix 
> the problem.
> 
> The problem is in your system not the packages. Please read the error
> message carefully - it says your /bin/sh is broken. Fix it and all
> should be well.
> 
> Cheers,
> S
> 
> 
> > I'm looking for any help
> > I can get.  I have tried the r-help and r-packages list.  I have
> > tried this with the compiled
> > version of R and the RPM version of R.
> >
> > * Installing *source* package ?rJava? ...
> > sh: ./configure: /bin/sh: bad interpreter: Permission denied
> > ERROR: configuration failed for package ?rJava?
> > * Removing ?/usr/lib64/R/library/rJava?
> > * Installing *source* package ?RJDBC? ...
> > ** R
> > ** preparing package for lazy loading
> > Error : package 'rJava' required by 'RJDBC' could not be found
> > ERROR: lazy loading failed for package ?RJDBC?
> > * Removing ?/usr/lib64/R/library/RJDBC?
> >
> > I'm using the rpm version of R found here 
> http://cran.cnr.berkeley.edu/bin/linux/redhat/el5/x86_64
> > I ran the "R CMD javareconf" as root and set the JAVA_HOME
> > environment variable.
> >
> > Here is my system configuration:
> > OS: CentOS 5.2 x86_64
> >
> > JDK: java version "1.6.0_12"
> > Java(TM) SE Runtime Environment (build 1.6.0_12-b04)
> > Java HotSpot(TM) 64-Bit Server VM (build 11.2-b01, mixed mode)
> >
> > R: 2.9.1
> > rJava: rJava_0.7-0.tar.gz
> > RJDBC: RJDBC_0.1-5.tar.gz
> >
> > Thanks for your time and knowledge.
> >
> > Best,
> > Matt
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From Franclim.Carreiro at zionsbancorp.com  Wed Sep  2 20:32:02 2009
From: Franclim.Carreiro at zionsbancorp.com (Frank Carreiro)
Date: Wed, 2 Sep 2009 12:32:02 -0600
Subject: [Rd] Trouble building R 2.9.2 under solaris 10
Message-ID: <B42F6960C528A24D89DB24042949F58B0576386CC9@UTEXVS01.zbc.internal>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090902/908edf79/attachment.pl>

From simon.urbanek at r-project.org  Wed Sep  2 20:30:03 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 2 Sep 2009 14:30:03 -0400
Subject: [Rd] Including a binary Python Interpreter into a binary
	R-package for MS Windows
In-Reply-To: <57821.94131.qm@web65608.mail.ac4.yahoo.com>
References: <57821.94131.qm@web65608.mail.ac4.yahoo.com>
Message-ID: <4E686DAA-D228-48A2-8587-83574EBDE13C@r-project.org>

On Sep 1, 2009, at 17:41 , gvsteen at yahoo.com wrote:

> 2009/8/30 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
> [snip]
>> Guido van Steen wrote:
> [snip]
>>> Something that interests me too: What about R's policy with  
>>> respect to
>>> including binary files? I saw that developers should include a file
> [snip]
>> Please do not include binary files and carefully watch for licenses  
>> of those
>> files (e.g. if GPL'ed, you need to ship sources!). If pyhthon is  
>> required, I
>> highly suggest to state it in the SystemDependencies and be fine  
>> with it -
>> users can learn to install phython themselves, I'm pretty sure.
>
> Hi Uwe,
>
> Note: I will send this email cc. to the R-devel list, which I joined  
> today. I think it may be of interest to other people as well.
>
> Thank you for your answer, although it disappointed me a bit. I had  
> already spent quite some time building a stand-alone windows binary  
> of a new package "write2xls". This package provides the same R  
> interface to Python as the other package "dataframes2xls". As you  
> know it enable users to create xls files. The special thing about  
> "write2xls" is that it does not have any dependencies at all. It is  
> so-to-speak a turn-key solution.
>
> Of course I should have read a bit more before I started. Only after  
> your mail I read the pdf-file "Writing R Extensions". It says "A  
> source package if possible should not contain binary executable  
> files: they are not portable, and a security risk if they are of the  
> appropriate architecture. R CMD check will warn about them unless  
> they are listed (one filepath per line) in a file 'BinaryFiles' at  
> the top level of the package or bundle. Note that CRAN will no  
> longer accept submissions containing binary files even if they are  
> listed."
>
> So, yes, you are right. I was actually hoping that CRAN could make  
> some exceptions,

Just for other people - it is in general not necessary to make such  
exceptions because it's easy to pull any necessary binary dependencies  
at build or run time where needed and there are examples of packages  
that do exactly that (e.g. RGtk2 for run-time dependency installation  
of GTK+ and Cairo for build-time dependency installation). The rule on  
CRAN is just to make sure that the package can be compiled purely from  
sources and binaries are rather a convenience (Python can be equally  
well compiled form sources). Uwe's comment was about the necessity to  
make all sources available for GPL licensed packages in either case.

Cheers,
Simon



> but after some thinking I fully understand that many people would  
> object to this for good reasons: R code depending on a C compiler  
> will not work without a C Compiler either. For security reasons we  
> cannot allow packages to install a binary C compiler. So, yes, I  
> understand the reasons but still it is a pity.
>
> The current situation is that many MS Windows users can not easily  
> use "dataframes2xls". There are a few reasons:
>
> * Most users of MS Windows will be unfamiliar with Python, which  
> will make them reluctant to install Python.
>
> * Installing Python will be impossible on many MS Windows platforms  
> due to limited user rights.
>
> * Downloading a standard Python installer takes about 15 Megabytes.  
> My newly created "write2xls" package just contains 1.3 MB.
>
> So only few R users can benefit from "dataframes2xls". An  
> alternative to "dataframes2xls" is "write.xls". "dataframes2xls" is  
> technically superior, as it allows the specification of proper  
> formatting and fonts. "dataframes2xls" also exists longer. However,  
> "write.xls" is available to many more R users because it depends on  
> Perl, which is installed as a part of the R-tools.
>
> So, I think it would be a pity not to provide "write2xls", since I  
> have it readily available now. Therefore, I will probably be hosting  
> "write2xls" on a different repository, as long as no Python  
> Interpreter is included in the R-tools. Does anyone know of a  
> alternative repository, which does accept "trustworthy" R packages  
> with a binary Python Interpreter.
>
> Thanks!
>
> Best wishes,
>
> Guido van Steen
>
> P.S. For those who are interested or who would like to test it, at  
> the moment "write2xls" can be downloaded as "http://www.heppel.net/write2xls_0.4.4.9.zip 
> ". The "source" package is available as "http://www.heppel.net/write2xls_0.4.4.9.tar.gz 
> ".
>
> P.P.S. I think that on MS Windows the combination of R and the R  
> tools is just as much a potential security risk as allowing to  
> include a Python Interpreter in a binary package. The R website  
> should pay more serious attention to this.
>
> P.P.P.S. Uwe also brings up the issue of licensing. However, this is  
> not a problem at all. The Python license is one of the most  
> permissive licenses around. For the Python Interpreter that I  
> included in the "write2xls" package, I used pyMingW, which is  
> distributed under an MIT license. It is a version of Python compiled  
> by the MinGW compiler. Thanks to this pyMingW distribution I also  
> avoid the need of any Microsoft-owned dlls. "dataframes2xls" and  
> "write2xls" are also distributed under a MIT license.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From macrakis at alum.mit.edu  Wed Sep  2 20:39:27 2009
From: macrakis at alum.mit.edu (Stavros Macrakis)
Date: Wed, 2 Sep 2009 14:39:27 -0400
Subject: [Rd] Documentation for is.atomic and is.recursive
Message-ID: <8b356f880909021139pa07d922q1f1c28a0fb70cdbe@mail.gmail.com>

The documentation for is.atomic and is.recursive is inconsistent with
their behavior in R 2.9.1 Windows.

? is.atomic

???? 'is.atomic' returns 'TRUE' if 'x' is an atomic vector (or 'NULL')
???? and 'FALSE' otherwise.
???? ...
???? 'is.atomic' is true for the atomic vector types ('"logical"',
???? '"integer"', '"numeric"', '"complex"', '"character"' and '"raw"')
???? and 'NULL'.

This description implies that is.atomic(x) implies is.vector(x)
(assuming that an "atomic vector type" is a subset of a "vector
type").? But in fact that is not true for values with class
attributes:

is.atomic(factor(3)) => TRUE
is.vector(factor(3)) => FALSE

is.atomic(table(3)) => TRUE
is.vector(factor(3)) => FALSE

It appears, then, that is.atomic requires only that unclass(x) be an
atomic vector, not that x be an atomic vector.

There is also another case where is.atomic(x) != is.vector(unclass(x)):

is.atomic(NULL) => TRUE
is.vector(NULL) => FALSE

It would be useful to make the documentation consistent with the
implementation. (Presumably by updating the documentation, not
changing the behavior.)

The documentation continues:

???? 'is.recursive' returns 'TRUE' if 'x' has a recursive (list-like)
???? structure and 'FALSE' otherwise.
???? ...
???? Most types of language objects are regarded as recursive: those
???? which are not are the atomic vector types, 'NULL' and symbols (as
???? given by 'as.name').

But is.recursive(as.name('foo')) == is.recursive(quote(foo)) == FALSE.

Again, it would be useful to make the documentation consistent with
the implementation.

To summarize all this in a table of the most common datatypes:

outerl <-
? function(f, a, b)
??? structure(outer(a,b,Vectorize(f)),
????????????? dimnames=list(a,b))

outerl(function(x,f)(match.fun(f))(x),
?????? list(3,factor(c("a","b")),NULL,function()3,as.name("foo"),environment()),
?????? list("class","mode","storage.mode","is.vector","is.atomic","is.recursive"))

????????????? class???????? mode????????? storage.mode? is.vector
is.atomic is.recursive
3???????????? "numeric"???? "numeric"???? "double"????? "TRUE"
"TRUE"??? "FALSE"????       <<< OK
1:2?????????? "factor"????? "numeric"???? "integer"???? "FALSE"
"TRUE"??? "FALSE"????         <<< inconsistent
NULL????????? "NULL"??????? "NULL"??????? "NULL"??????? "FALSE"
"TRUE"??? "FALSE"????     <<< inconsistent
function ()?? "function"??? "function"??? "function"??? "FALSE"
"FALSE"?? "TRUE"?????     <<< OK
foo?????????? "name"??????? "name"??????? "symbol"????? "FALSE"
"FALSE"?? "FALSE"????      <<< inconsistent
<environment> "environment" "environment" "environment" "FALSE"
"FALSE"?? "TRUE"?????<<< OK

Thanks,

           -s


From macrakis at alum.mit.edu  Wed Sep  2 20:54:45 2009
From: macrakis at alum.mit.edu (Stavros Macrakis)
Date: Wed, 2 Sep 2009 14:54:45 -0400
Subject: [Rd] Documentation for is.atomic and is.recursive
In-Reply-To: <8b356f880909021139pa07d922q1f1c28a0fb70cdbe@mail.gmail.com>
References: <8b356f880909021139pa07d922q1f1c28a0fb70cdbe@mail.gmail.com>
Message-ID: <8b356f880909021154r22b8d14ajd7627fcf3263b444@mail.gmail.com>

On Wed, Sep 2, 2009 at 2:39 PM, Stavros Macrakis<macrakis at alum.mit.edu> wrote:

> ???? Most types of language objects are regarded as recursive: those
> ???? which are not are the atomic vector types, 'NULL' and symbols (as
> ???? given by 'as.name').
>
> But is.recursive(as.name('foo')) == is.recursive(quote(foo)) == FALSE.

Sorry, this *is* consistent with the behavior.  But if we read "the
atomic vector types, 'NULL' and symbols" as a list of mutually
exclusive categories, then is.atomic(NULL)==FALSE is inconsistent.

              -s


From ripley at stats.ox.ac.uk  Wed Sep  2 21:01:19 2009
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 2 Sep 2009 20:01:19 +0100 (BST)
Subject: [Rd] Trouble building R 2.9.2 under solaris 10
In-Reply-To: <B42F6960C528A24D89DB24042949F58B0576386CC9@UTEXVS01.zbc.internal>
References: <B42F6960C528A24D89DB24042949F58B0576386CC9@UTEXVS01.zbc.internal>
Message-ID: <alpine.LFD.2.00.0909021959080.7791@gannet.stats.ox.ac.uk>

Please read the posting guide and the R-admin manual.

This is a symptom of a misconfigured compiler/system headers, and you 
have not told us what you are using.  It is not an R issue, so please 
consult your OS support line (and almost certianly you are not using a 
Sun compiler here): maybe you should?).

On Wed, 2 Sep 2009, Frank Carreiro wrote:

> I've been trying to compile 2.9.2 under solaris 10 the last couple days without success.  configure runs fine and I'm using GNU Make.  We're trying to build under 64 bit (and I'm wondering if this might be part of our problem).  Here is the output from the make...
>
>
> ld: warning: file /usr/local/lib/libiconv.so: attempted multiple inclusion of file
> Undefined                       first referenced
> symbol                             in file
> __builtin_isnan                     libR.a(plot.o)
> ld: fatal: Symbol referencing errors. No output written to R.bin
> collect2: ld returned 1 exit status
> make[3]: *** [R.bin] Error 1
> make[3]: Leaving directory `/usr/local/src/R-2.9.2/src/main'
> make[2]: *** [R] Error 2
> make[2]: Leaving directory `/usr/local/src/R-2.9.2/src/main'
> make[1]: *** [R] Error 1
> make[1]: Leaving directory `/usr/local/src/R-2.9.2/src'
> make: *** [R] Error 1
>
> I'm curious what I'm doing wrong here.
>
> I'm running USE_PGXS=1 make to compile everything
>
> Thanks!
>
> Frank
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From h.wickham at gmail.com  Wed Sep  2 21:02:06 2009
From: h.wickham at gmail.com (hadley wickham)
Date: Wed, 2 Sep 2009 14:02:06 -0500
Subject: [Rd] Documentation for is.atomic and is.recursive
In-Reply-To: <8b356f880909021154r22b8d14ajd7627fcf3263b444@mail.gmail.com>
References: <8b356f880909021139pa07d922q1f1c28a0fb70cdbe@mail.gmail.com> 
	<8b356f880909021154r22b8d14ajd7627fcf3263b444@mail.gmail.com>
Message-ID: <f8e6ff050909021202g6c16d013rc1698b2170cd041d@mail.gmail.com>

On Wed, Sep 2, 2009 at 1:54 PM, Stavros Macrakis<macrakis at alum.mit.edu> wrote:
> On Wed, Sep 2, 2009 at 2:39 PM, Stavros Macrakis<macrakis at alum.mit.edu> wrote:
>
>> ???? Most types of language objects are regarded as recursive: those
>> ???? which are not are the atomic vector types, 'NULL' and symbols (as
>> ???? given by 'as.name').
>>
>> But is.recursive(as.name('foo')) == is.recursive(quote(foo)) == FALSE.
>
> Sorry, this *is* consistent with the behavior. ?But if we read "the
> atomic vector types, 'NULL' and symbols" as a list of mutually
> exclusive categories, then is.atomic(NULL)==FALSE is inconsistent.

And the sentence could be more clearly written as:

Most types of language objects are regarded as recursive, except for
atomic vector types, 'NULL' and symbols (as given by 'as.name').

Hadley


-- 
http://had.co.nz/


From Franclim.Carreiro at zionsbancorp.com  Wed Sep  2 21:36:39 2009
From: Franclim.Carreiro at zionsbancorp.com (Frank Carreiro)
Date: Wed, 2 Sep 2009 13:36:39 -0600
Subject: [Rd] Trouble building R 2.9.2 under solaris 10
In-Reply-To: <alpine.LFD.2.00.0909021959080.7791@gannet.stats.ox.ac.uk>
Message-ID: <B42F6960C528A24D89DB24042949F58B0576386CFA@UTEXVS01.zbc.internal>

My apologies.  I've been through sevearl other forums the last few days working through this.  I forgot my manners.

I'll read the guide.  FYI... I'm using the /usr/sfw/bin/gcc compiler.  Version 3.4.3 along with GNU Make from sunfreeware.com 

I figured it's not an R issue as the documentation from CRAN suggested Solaris was supported.

I'll poke into the compiler and see what I can come up with.

 

-----Original Message-----
From: Prof Brian Ripley [mailto:ripley at stats.ox.ac.uk] 
Sent: Wednesday, September 02, 2009 1:01 PM
To: Frank Carreiro
Cc: r-devel at r-project.org
Subject: Re: [Rd] Trouble building R 2.9.2 under solaris 10

Please read the posting guide and the R-admin manual.

This is a symptom of a misconfigured compiler/system headers, and you have not told us what you are using.  It is not an R issue, so please consult your OS support line (and almost certianly you are not using a Sun compiler here): maybe you should?).

On Wed, 2 Sep 2009, Frank Carreiro wrote:

> I've been trying to compile 2.9.2 under solaris 10 the last couple days without success.  configure runs fine and I'm using GNU Make.  We're trying to build under 64 bit (and I'm wondering if this might be part of our problem).  Here is the output from the make...
>
>
> ld: warning: file /usr/local/lib/libiconv.so: attempted multiple inclusion of file
> Undefined                       first referenced
> symbol                             in file
> __builtin_isnan                     libR.a(plot.o)
> ld: fatal: Symbol referencing errors. No output written to R.bin
> collect2: ld returned 1 exit status
> make[3]: *** [R.bin] Error 1
> make[3]: Leaving directory `/usr/local/src/R-2.9.2/src/main'
> make[2]: *** [R] Error 2
> make[2]: Leaving directory `/usr/local/src/R-2.9.2/src/main'
> make[1]: *** [R] Error 1
> make[1]: Leaving directory `/usr/local/src/R-2.9.2/src'
> make: *** [R] Error 1
>
> I'm curious what I'm doing wrong here.
>
> I'm running USE_PGXS=1 make to compile everything
>
> Thanks!
>
> Frank
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch at stats.uwo.ca  Wed Sep  2 21:37:11 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 02 Sep 2009 15:37:11 -0400
Subject: [Rd] Documentation for is.atomic and is.recursive
In-Reply-To: <8b356f880909021139pa07d922q1f1c28a0fb70cdbe@mail.gmail.com>
References: <8b356f880909021139pa07d922q1f1c28a0fb70cdbe@mail.gmail.com>
Message-ID: <4A9EC967.3080507@stats.uwo.ca>

On 9/2/2009 2:39 PM, Stavros Macrakis wrote:
> The documentation for is.atomic and is.recursive is inconsistent with
> their behavior in R 2.9.1 Windows.
> 
> ? is.atomic
> 
>      'is.atomic' returns 'TRUE' if 'x' is an atomic vector (or 'NULL')
>      and 'FALSE' otherwise.
>      ...
>      'is.atomic' is true for the atomic vector types ('"logical"',
>      '"integer"', '"numeric"', '"complex"', '"character"' and '"raw"')
>      and 'NULL'.
> 
> This description implies that is.atomic(x) implies is.vector(x)
> (assuming that an "atomic vector type" is a subset of a "vector
> type").  But in fact that is not true for values with class
> attributes:

I don't see is.vector mentioned there.  The description of is.vector on 
its own man page implies the behaviour below; I think the description of 
is.atomic that you quote above is also consistent with the behaviour.

One could argue that in R's pre-history we should have had is.atomic 
imply is.vector, but that's not how things are documented, and I think 
we're pretty much stuck with the definitions we've got on low level 
functions like those.


> 
> is.atomic(factor(3)) => TRUE
> is.vector(factor(3)) => FALSE
> 
> is.atomic(table(3)) => TRUE
> is.vector(factor(3)) => FALSE
> 
> It appears, then, that is.atomic requires only that unclass(x) be an
> atomic vector, not that x be an atomic vector.
> 
> There is also another case where is.atomic(x) != is.vector(unclass(x)):
> 
> is.atomic(NULL) => TRUE
> is.vector(NULL) => FALSE
> 
> It would be useful to make the documentation consistent with the
> implementation. (Presumably by updating the documentation, not
> changing the behavior.)
> 
> The documentation continues:
> 
>      'is.recursive' returns 'TRUE' if 'x' has a recursive (list-like)
>      structure and 'FALSE' otherwise.
>      ...
>      Most types of language objects are regarded as recursive: those
>      which are not are the atomic vector types, 'NULL' and symbols (as
>      given by 'as.name').
> 
> But is.recursive(as.name('foo')) == is.recursive(quote(foo)) == FALSE.

That's what it says should happen.  symbols such as as.name('foo') are 
not recursive.

Duncan Murdoch

> 
> Again, it would be useful to make the documentation consistent with
> the implementation.
> 
> To summarize all this in a table of the most common datatypes:
> 
> outerl <-
>   function(f, a, b)
>     structure(outer(a,b,Vectorize(f)),
>               dimnames=list(a,b))
> 
> outerl(function(x,f)(match.fun(f))(x),
>        list(3,factor(c("a","b")),NULL,function()3,as.name("foo"),environment()),
>        list("class","mode","storage.mode","is.vector","is.atomic","is.recursive"))
> 
>               class         mode          storage.mode  is.vector
> is.atomic is.recursive
> 3             "numeric"     "numeric"     "double"      "TRUE"
> "TRUE"    "FALSE"           <<< OK
> 1:2           "factor"      "numeric"     "integer"     "FALSE"
> "TRUE"    "FALSE"             <<< inconsistent
> NULL          "NULL"        "NULL"        "NULL"        "FALSE"
> "TRUE"    "FALSE"         <<< inconsistent
> function ()   "function"    "function"    "function"    "FALSE"
> "FALSE"   "TRUE"          <<< OK
> foo           "name"        "name"        "symbol"      "FALSE"
> "FALSE"   "FALSE"          <<< inconsistent
> <environment> "environment" "environment" "environment" "FALSE"
> "FALSE"   "TRUE"     <<< OK
> 
> Thanks,
> 
>            -s
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From luke at stat.uiowa.edu  Wed Sep  2 22:04:57 2009
From: luke at stat.uiowa.edu (luke at stat.uiowa.edu)
Date: Wed, 2 Sep 2009 15:04:57 -0500 (CDT)
Subject: [Rd] Tracebacks & try
In-Reply-To: <f8e6ff050909020608v3e59065bre2749c4e5822e636@mail.gmail.com>
References: <f8e6ff050909020608v3e59065bre2749c4e5822e636@mail.gmail.com>
Message-ID: <alpine.OSX.2.00.0909021504080.1230@luke-tierneys-macbook-pro-15.local>

You can use a calling handler along with sys.calls, something like

     f <- function() g()
     g <- function() stop("A")

     tryCatch(withCallingHandlers(f(),
 				 error = function(e) {
 						  e$calls <- sys.calls()
 				     signalCondition(e)
 				 }),
 	     error = function(e) e)

Best,

luke

On Wed, 2 Sep 2009, Hadley Wickham wrote:

> Hi all,
>
> The help for traceback states:
>
>  Errors which are caught _via_ 'try' or 'tryCatch' do not generate
>  a traceback, so what is printed is the call sequence for the last
>  uncaught error, and not necessarily for the last error.
>
> Is there any way to get a traceback (or something similar) for an
> error raised inside a try block?
>
> Regards,
>
> Hadley
>
>
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From macrakis at alum.mit.edu  Wed Sep  2 22:10:08 2009
From: macrakis at alum.mit.edu (Stavros Macrakis)
Date: Wed, 2 Sep 2009 16:10:08 -0400
Subject: [Rd] Documentation for is.atomic and is.recursive
In-Reply-To: <4A9EC967.3080507@stats.uwo.ca>
References: <8b356f880909021139pa07d922q1f1c28a0fb70cdbe@mail.gmail.com>
	<4A9EC967.3080507@stats.uwo.ca>
Message-ID: <8b356f880909021310l3805de62g2c2467db9a1591d2@mail.gmail.com>

Let us stipulate that the current wording can be construed to be correct.

I would nonetheless claim that the documentation as currently written
is at best ambiguous and confusing, and would benefit from improved
wording.

What would be lost by that?

> One could argue that in R's pre-history we should have had is.atomic imply
> is.vector, but that's not how things are documented, and I think we're
> pretty much stuck with the definitions we've got on low level functions like
> those.

I explicitly said in my mail that I was not suggesting that past
design decisions (wise or unwise) be revisited; only that they be
documented more clearly.

               -s

On Wed, Sep 2, 2009 at 3:37 PM, Duncan Murdoch<murdoch at stats.uwo.ca> wrote:
> On 9/2/2009 2:39 PM, Stavros Macrakis wrote:
>>
>> The documentation for is.atomic and is.recursive is inconsistent with
>> their behavior in R 2.9.1 Windows.
>>
>> ? is.atomic
>>
>> ? ? 'is.atomic' returns 'TRUE' if 'x' is an atomic vector (or 'NULL')
>> ? ? and 'FALSE' otherwise.
>> ? ? ...
>> ? ? 'is.atomic' is true for the atomic vector types ('"logical"',
>> ? ? '"integer"', '"numeric"', '"complex"', '"character"' and '"raw"')
>> ? ? and 'NULL'.
>>
>> This description implies that is.atomic(x) implies is.vector(x)
>> (assuming that an "atomic vector type" is a subset of a "vector
>> type"). ?But in fact that is not true for values with class
>> attributes:
>
> I don't see is.vector mentioned there. ?The description of is.vector on its
> own man page implies the behaviour below; I think the description of
> is.atomic that you quote above is also consistent with the behaviour.
>
> One could argue that in R's pre-history we should have had is.atomic imply
> is.vector, but that's not how things are documented, and I think we're
> pretty much stuck with the definitions we've got on low level functions like
> those.
>
>
>>
>> is.atomic(factor(3)) => TRUE
>> is.vector(factor(3)) => FALSE
>>
>> is.atomic(table(3)) => TRUE
>> is.vector(factor(3)) => FALSE
>>
>> It appears, then, that is.atomic requires only that unclass(x) be an
>> atomic vector, not that x be an atomic vector.
>>
>> There is also another case where is.atomic(x) != is.vector(unclass(x)):
>>
>> is.atomic(NULL) => TRUE
>> is.vector(NULL) => FALSE
>>
>> It would be useful to make the documentation consistent with the
>> implementation. (Presumably by updating the documentation, not
>> changing the behavior.)
>>
>> The documentation continues:
>>
>> ? ? 'is.recursive' returns 'TRUE' if 'x' has a recursive (list-like)
>> ? ? structure and 'FALSE' otherwise.
>> ? ? ...
>> ? ? Most types of language objects are regarded as recursive: those
>> ? ? which are not are the atomic vector types, 'NULL' and symbols (as
>> ? ? given by 'as.name').
>>
>> But is.recursive(as.name('foo')) == is.recursive(quote(foo)) == FALSE.
>
> That's what it says should happen. ?symbols such as as.name('foo') are not
> recursive.
>
> Duncan Murdoch
>
>>
>> Again, it would be useful to make the documentation consistent with
>> the implementation.
>>
>> To summarize all this in a table of the most common datatypes:
>>
>> outerl <-
>> ?function(f, a, b)
>> ? ?structure(outer(a,b,Vectorize(f)),
>> ? ? ? ? ? ? ?dimnames=list(a,b))
>>
>> outerl(function(x,f)(match.fun(f))(x),
>>
>> list(3,factor(c("a","b")),NULL,function()3,as.name("foo"),environment()),
>>
>> list("class","mode","storage.mode","is.vector","is.atomic","is.recursive"))
>>
>> ? ? ? ? ? ? ?class ? ? ? ? mode ? ? ? ? ?storage.mode ?is.vector
>> is.atomic is.recursive
>> 3 ? ? ? ? ? ? "numeric" ? ? "numeric" ? ? "double" ? ? ?"TRUE"
>> "TRUE" ? ?"FALSE" ? ? ? ? ? <<< OK
>> 1:2 ? ? ? ? ? "factor" ? ? ?"numeric" ? ? "integer" ? ? "FALSE"
>> "TRUE" ? ?"FALSE" ? ? ? ? ? ? <<< inconsistent
>> NULL ? ? ? ? ?"NULL" ? ? ? ?"NULL" ? ? ? ?"NULL" ? ? ? ?"FALSE"
>> "TRUE" ? ?"FALSE" ? ? ? ? <<< inconsistent
>> function () ? "function" ? ?"function" ? ?"function" ? ?"FALSE"
>> "FALSE" ? "TRUE" ? ? ? ? ?<<< OK
>> foo ? ? ? ? ? "name" ? ? ? ?"name" ? ? ? ?"symbol" ? ? ?"FALSE"
>> "FALSE" ? "FALSE" ? ? ? ? ?<<< inconsistent
>> <environment> "environment" "environment" "environment" "FALSE"
>> "FALSE" ? "TRUE" ? ? <<< OK
>>
>> Thanks,
>>
>> ? ? ? ? ? -s
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From MSilva at specificmedia.com  Wed Sep  2 22:30:28 2009
From: MSilva at specificmedia.com (Matias Silva)
Date: Wed, 2 Sep 2009 13:30:28 -0700
Subject: [Rd] Installing rJava RJDBC bad interpreter: Permission denied
In-Reply-To: <77EB52C6DD32BA4D87471DCD70C8D70001B734F5@NA-PA-VBE03.na.tibco.com>
References: <1D39027E38D41B4C91702F159EF19160239ECCCA37@west-corp-ex02.specificmedia.local>,
	<ED58EC2B-E9AC-4FB3-95DD-C09E6876793E@r-project.org>
	<1D39027E38D41B4C91702F159EF19160239E4D6333@west-corp-ex02.specificmedia.local>
	<77EB52C6DD32BA4D87471DCD70C8D70001B734F5@NA-PA-VBE03.na.tibco.com>
Message-ID: <1D39027E38D41B4C91702F159EF19160239ED5394C@west-corp-ex02.specificmedia.local>

William, thank you so much! /tmp has noexec in the fstab and doesn't allow any file
to be executable.  I temporary changed those settings and I was able to 
install rJava and RJDBC.

Perhaps the installation routine shouldn't use /tmp and use /var/tmp instead.

Many thanks,
Matt

-----Original Message-----
From: William Dunlap [mailto:wdunlap at tibco.com] 
Sent: Wednesday, September 02, 2009 10:03 AM
To: Matias Silva; Simon Urbanek
Cc: r-devel at r-project.org
Subject: RE: [Rd] Installing rJava RJDBC bad interpreter: Permission denied


> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Matias Silva
> Sent: Wednesday, September 02, 2009 9:05 AM
> To: Simon Urbanek
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] Installing rJava RJDBC bad interpreter: 
> Permission denied
> 
> Hi Simon, thanks for responding, I really appreciate it.  If 
> there is a problem with /bin/sh then I could not install 
> any packages(??).  I installed a DBI package successfully.  I 
> have also tried this on 3 different machines - 2 CentOS 5.3 
> and 1 RHEL 5.3.  I can try this using Ubuntu later today.

Most packages installations don't invoke /bin/sh but RJDBC
has a configure file that does.  Can you run a sh script called
/tmp/junk.sh containing

#!/bin/sh
echo Hello at `date`

with the commands

chmod +x /tmp/junk.sh
sh -c /tmp/junk.sh

or

/tmp/junk.sh

?

> What has me baffled is the unknown characters surrounding the 
> package name " ?rJava?" and "?RJDBC?" and thats
> what I think is causing the problem with /bin/sh.

I think those are quotes put on by R's sQuote() function and are
typically seen in error and warning messages.  Some
xtem's don't know how to render them correctly.
Set LANG to C before starting R to avoid them.

> 
> Thanks,
> Matt
> ________________________________________
> From: Simon Urbanek [simon.urbanek at r-project.org]
> Sent: Wednesday, September 02, 2009 5:12 AM
> To: Matias Silva
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] Installing rJava RJDBC bad interpreter: 
> Permission denied
> 
> On Sep 1, 2009, at 21:05 , Matias Silva wrote:
> 
> > Trying to install the above two packages via the
> > "install.packages("package_name")" command and
> > the "R CMD INSTALL file.tar.gz".
> >
> > I receive the following error either way "sh: ./configure: /bin/sh:
> > bad interpreter: Permission denied".
> > I have tried to chmod and chown permissions and also ran dos2unix in
> > hopes that there is a CRLF
> > in some of the tar.gz files, but that doesn't seem to fix 
> the problem.
> 
> The problem is in your system not the packages. Please read the error
> message carefully - it says your /bin/sh is broken. Fix it and all
> should be well.
> 
> Cheers,
> S
> 
> 
> > I'm looking for any help
> > I can get.  I have tried the r-help and r-packages list.  I have
> > tried this with the compiled
> > version of R and the RPM version of R.
> >
> > * Installing *source* package ?rJava? ...
> > sh: ./configure: /bin/sh: bad interpreter: Permission denied
> > ERROR: configuration failed for package ?rJava?
> > * Removing ?/usr/lib64/R/library/rJava?
> > * Installing *source* package ?RJDBC? ...
> > ** R
> > ** preparing package for lazy loading
> > Error : package 'rJava' required by 'RJDBC' could not be found
> > ERROR: lazy loading failed for package ?RJDBC?
> > * Removing ?/usr/lib64/R/library/RJDBC?
> >
> > I'm using the rpm version of R found here 
> http://cran.cnr.berkeley.edu/bin/linux/redhat/el5/x86_64
> > I ran the "R CMD javareconf" as root and set the JAVA_HOME
> > environment variable.
> >
> > Here is my system configuration:
> > OS: CentOS 5.2 x86_64
> >
> > JDK: java version "1.6.0_12"
> > Java(TM) SE Runtime Environment (build 1.6.0_12-b04)
> > Java HotSpot(TM) 64-Bit Server VM (build 11.2-b01, mixed mode)
> >
> > R: 2.9.1
> > rJava: rJava_0.7-0.tar.gz
> > RJDBC: RJDBC_0.1-5.tar.gz
> >
> > Thanks for your time and knowledge.
> >
> > Best,
> > Matt
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From murdoch at stats.uwo.ca  Wed Sep  2 23:30:00 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 02 Sep 2009 17:30:00 -0400
Subject: [Rd] Documentation for is.atomic and is.recursive
In-Reply-To: <8b356f880909021310l3805de62g2c2467db9a1591d2@mail.gmail.com>
References: <8b356f880909021139pa07d922q1f1c28a0fb70cdbe@mail.gmail.com>	
	<4A9EC967.3080507@stats.uwo.ca>
	<8b356f880909021310l3805de62g2c2467db9a1591d2@mail.gmail.com>
Message-ID: <4A9EE3D8.7040008@stats.uwo.ca>

On 02/09/2009 4:10 PM, Stavros Macrakis wrote:
> Let us stipulate that the current wording can be construed to be correct.

I'd rather just state that the current wording is correct, without the 
weasel words.

> I would nonetheless claim that the documentation as currently written
> is at best ambiguous and confusing, and would benefit from improved
> wording.

A claim that documentation would benefit from improved wording is a 
tautology.  A claim that the documentation is ambiguous requires more 
evidence than you've offered.  You have demonstrated that someone could 
be confused when reading it, but that isn't necessarily our responsibility.

Duncan Murdoch

> 
> What would be lost by that?
> 
>> One could argue that in R's pre-history we should have had is.atomic imply
>> is.vector, but that's not how things are documented, and I think we're
>> pretty much stuck with the definitions we've got on low level functions like
>> those.
> 
> I explicitly said in my mail that I was not suggesting that past
> design decisions (wise or unwise) be revisited; only that they be
> documented more clearly.
> 
>                -s
> 
> On Wed, Sep 2, 2009 at 3:37 PM, Duncan Murdoch<murdoch at stats.uwo.ca> wrote:
>> On 9/2/2009 2:39 PM, Stavros Macrakis wrote:
>>> The documentation for is.atomic and is.recursive is inconsistent with
>>> their behavior in R 2.9.1 Windows.
>>>
>>> ? is.atomic
>>>
>>>     'is.atomic' returns 'TRUE' if 'x' is an atomic vector (or 'NULL')
>>>     and 'FALSE' otherwise.
>>>     ...
>>>     'is.atomic' is true for the atomic vector types ('"logical"',
>>>     '"integer"', '"numeric"', '"complex"', '"character"' and '"raw"')
>>>     and 'NULL'.
>>>
>>> This description implies that is.atomic(x) implies is.vector(x)
>>> (assuming that an "atomic vector type" is a subset of a "vector
>>> type").  But in fact that is not true for values with class
>>> attributes:
>> I don't see is.vector mentioned there.  The description of is.vector on its
>> own man page implies the behaviour below; I think the description of
>> is.atomic that you quote above is also consistent with the behaviour.
>>
>> One could argue that in R's pre-history we should have had is.atomic imply
>> is.vector, but that's not how things are documented, and I think we're
>> pretty much stuck with the definitions we've got on low level functions like
>> those.
>>
>>
>>> is.atomic(factor(3)) => TRUE
>>> is.vector(factor(3)) => FALSE
>>>
>>> is.atomic(table(3)) => TRUE
>>> is.vector(factor(3)) => FALSE
>>>
>>> It appears, then, that is.atomic requires only that unclass(x) be an
>>> atomic vector, not that x be an atomic vector.
>>>
>>> There is also another case where is.atomic(x) != is.vector(unclass(x)):
>>>
>>> is.atomic(NULL) => TRUE
>>> is.vector(NULL) => FALSE
>>>
>>> It would be useful to make the documentation consistent with the
>>> implementation. (Presumably by updating the documentation, not
>>> changing the behavior.)
>>>
>>> The documentation continues:
>>>
>>>     'is.recursive' returns 'TRUE' if 'x' has a recursive (list-like)
>>>     structure and 'FALSE' otherwise.
>>>     ...
>>>     Most types of language objects are regarded as recursive: those
>>>     which are not are the atomic vector types, 'NULL' and symbols (as
>>>     given by 'as.name').
>>>
>>> But is.recursive(as.name('foo')) == is.recursive(quote(foo)) == FALSE.
>> That's what it says should happen.  symbols such as as.name('foo') are not
>> recursive.
>>
>> Duncan Murdoch
>>
>>> Again, it would be useful to make the documentation consistent with
>>> the implementation.
>>>
>>> To summarize all this in a table of the most common datatypes:
>>>
>>> outerl <-
>>>  function(f, a, b)
>>>    structure(outer(a,b,Vectorize(f)),
>>>              dimnames=list(a,b))
>>>
>>> outerl(function(x,f)(match.fun(f))(x),
>>>
>>> list(3,factor(c("a","b")),NULL,function()3,as.name("foo"),environment()),
>>>
>>> list("class","mode","storage.mode","is.vector","is.atomic","is.recursive"))
>>>
>>>              class         mode          storage.mode  is.vector
>>> is.atomic is.recursive
>>> 3             "numeric"     "numeric"     "double"      "TRUE"
>>> "TRUE"    "FALSE"           <<< OK
>>> 1:2           "factor"      "numeric"     "integer"     "FALSE"
>>> "TRUE"    "FALSE"             <<< inconsistent
>>> NULL          "NULL"        "NULL"        "NULL"        "FALSE"
>>> "TRUE"    "FALSE"         <<< inconsistent
>>> function ()   "function"    "function"    "function"    "FALSE"
>>> "FALSE"   "TRUE"          <<< OK
>>> foo           "name"        "name"        "symbol"      "FALSE"
>>> "FALSE"   "FALSE"          <<< inconsistent
>>> <environment> "environment" "environment" "environment" "FALSE"
>>> "FALSE"   "TRUE"     <<< OK
>>>
>>> Thanks,
>>>
>>>           -s
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>


From hpages at fhcrc.org  Thu Sep  3 00:21:11 2009
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Wed, 02 Sep 2009 15:21:11 -0700
Subject: [Rd] R devel repository tarball naming issue
In-Reply-To: <h7j40e$n4p$1@perl.epigenomics.epi>
References: <h7j40e$n4p$1@perl.epigenomics.epi>
Message-ID: <4A9EEFD7.3030000@fhcrc.org>

Hi,

Same here, we rely on these snapshots for the Bioconductor build system.

   ftp://ftp.stat.math.ethz.ch/Software/R/

Now there seems to be a file (or symlink) named R-devel.tar.gz (note
that the files with a broken name e.g. R-devel_.tar.gz are still here).
The problem is that after download and extraction I get:

   biocbuild at wilson2:~/src> cat R-devel/SVN-REVISION
   Revision: unknown

so I have no way to know when this snapshot has been created.
It used to be that R-devel.tar.gz is in fact a symlink to the
latest R-devel_YYYY-MM-DD.tar.gz located in the same folder but
that doesn't seem to be the case here. Where are the
R-devel_YYYY-MM-DD.tar.gz tarballs for the last 10 days?

Could someone please have a look?

Thanks in advance,
H.


ml-it-r-devel at epigenomics.com wrote:
> Hi,
> 
> we noticed that since some time after Aug 24th the daily snapshots provided on
> ftp://ftp.stat.math.ethz.ch/Software/R/
> 
> no longer have their default tarball file name
> 
> but dropped the date stamp, i.e. R-devel_.tar.bz2
> 
> Same for R-patched snapshots.
> 
> Could one of the maintainers please take a look. We rely on the default naming convention
> for automatic builds.
> 
> Regards,
> 
>   Matthias
> 

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From tplate at acm.org  Thu Sep  3 00:50:18 2009
From: tplate at acm.org (Tony Plate)
Date: Wed, 02 Sep 2009 16:50:18 -0600
Subject: [Rd] Documentation for is.atomic and is.recursive
In-Reply-To: <4A9EE3D8.7040008@stats.uwo.ca>
References: <8b356f880909021139pa07d922q1f1c28a0fb70cdbe@mail.gmail.com>		<4A9EC967.3080507@stats.uwo.ca>	<8b356f880909021310l3805de62g2c2467db9a1591d2@mail.gmail.com>
	<4A9EE3D8.7040008@stats.uwo.ca>
Message-ID: <4A9EF6AA.1010204@acm.org>

Duncan Murdoch wrote:
> On 02/09/2009 4:10 PM, Stavros Macrakis wrote:
>> Let us stipulate that the current wording can be construed to be 
>> correct.
>
> I'd rather just state that the current wording is correct, without the 
> weasel words.
>
>> I would nonetheless claim that the documentation as currently written
>> is at best ambiguous and confusing, and would benefit from improved
>> wording.
>
> A claim that documentation would benefit from improved wording is a 
> tautology.  A claim that the documentation is ambiguous requires more 
> evidence than you've offered.  You have demonstrated that someone 
> could be confused when reading it, but that isn't necessarily our 
> responsibility.
>
> Duncan Murdoch
>
I suspect the confusion comes from the mistaken, but very 
understandable, interpretation that the phrase "'x' is a vector" in the 
documentation should somehow equate with the R function call 
'is.vector(x)'.  Similar potentially misleading wording appears in the 
"Description" for ?is.vector:
   "|is.vector| returns |TRUE| if |x| is a vector (of mode logical, 
integer, real, complex, character, raw or list if not specified) or 
expression and |FALSE|".
However, the Details for ?is.vector do clarify, saying:
  "|is.vector| returns |FALSE| if |x| has any attributes except names."

Here are some concrete suggestions for improving the documentation:
(1) In the Details or Note section for ?is.atomic, add the paragraph:
"is.atomic is unaffected by the presence of attributes on 'x', unlike 
is.vector (which would probably be better named is.bare.vector).  
is.atomic(x) merely tests whether the data mode of x is an atomic vector 
type, and ignores whether or not x has attributes.  The behavior of 
is.vector(x) is quite different -- it tests whether x is a bare vector.  
is.vector can be TRUE for lists and expressions as well as atomic vector 
types, but if there are attributes other than names on x, is.vector(x) 
returns FALSE."

(2) In the Description section for ?is.vector, change
  "|is.vector| returns |TRUE| if |x| is a vector (of mode logical, 
integer, real, complex, character, raw or list if not specified) or 
expression"
to
  "|is.vector| returns |TRUE| if |x| is a bare vector (of mode logical, 
integer, real, complex, character, raw or list if not specified, with no 
attributes other than names), or expression with no attributes other 
than names"

-- Tony Plate

>>
>> What would be lost by that?
>>
>>> One could argue that in R's pre-history we should have had is.atomic 
>>> imply
>>> is.vector, but that's not how things are documented, and I think we're
>>> pretty much stuck with the definitions we've got on low level 
>>> functions like
>>> those.
>>
>> I explicitly said in my mail that I was not suggesting that past
>> design decisions (wise or unwise) be revisited; only that they be
>> documented more clearly.
>>
>>                -s
>>
>> On Wed, Sep 2, 2009 at 3:37 PM, Duncan Murdoch<murdoch at stats.uwo.ca> 
>> wrote:
>>> On 9/2/2009 2:39 PM, Stavros Macrakis wrote:
>>>> The documentation for is.atomic and is.recursive is inconsistent with
>>>> their behavior in R 2.9.1 Windows.
>>>>
>>>> ? is.atomic
>>>>
>>>>     'is.atomic' returns 'TRUE' if 'x' is an atomic vector (or 'NULL')
>>>>     and 'FALSE' otherwise.
>>>>     ...
>>>>     'is.atomic' is true for the atomic vector types ('"logical"',
>>>>     '"integer"', '"numeric"', '"complex"', '"character"' and '"raw"')
>>>>     and 'NULL'.
>>>>
>>>> This description implies that is.atomic(x) implies is.vector(x)
>>>> (assuming that an "atomic vector type" is a subset of a "vector
>>>> type").  But in fact that is not true for values with class
>>>> attributes:
>>> I don't see is.vector mentioned there.  The description of is.vector 
>>> on its
>>> own man page implies the behaviour below; I think the description of
>>> is.atomic that you quote above is also consistent with the behaviour.
>>>
>>> One could argue that in R's pre-history we should have had is.atomic 
>>> imply
>>> is.vector, but that's not how things are documented, and I think we're
>>> pretty much stuck with the definitions we've got on low level 
>>> functions like
>>> those.
>>>
>>>
>>>> is.atomic(factor(3)) => TRUE
>>>> is.vector(factor(3)) => FALSE
>>>>
>>>> is.atomic(table(3)) => TRUE
>>>> is.vector(factor(3)) => FALSE
>>>>
>>>> It appears, then, that is.atomic requires only that unclass(x) be an
>>>> atomic vector, not that x be an atomic vector.
>>>>
>>>> There is also another case where is.atomic(x) != 
>>>> is.vector(unclass(x)):
>>>>
>>>> is.atomic(NULL) => TRUE
>>>> is.vector(NULL) => FALSE
>>>>
>>>> It would be useful to make the documentation consistent with the
>>>> implementation. (Presumably by updating the documentation, not
>>>> changing the behavior.)
>>>>
>>>> The documentation continues:
>>>>
>>>>     'is.recursive' returns 'TRUE' if 'x' has a recursive (list-like)
>>>>     structure and 'FALSE' otherwise.
>>>>     ...
>>>>     Most types of language objects are regarded as recursive: those
>>>>     which are not are the atomic vector types, 'NULL' and symbols (as
>>>>     given by 'as.name').
>>>>
>>>> But is.recursive(as.name('foo')) == is.recursive(quote(foo)) == FALSE.
>>> That's what it says should happen.  symbols such as as.name('foo') 
>>> are not
>>> recursive.
>>>
>>> Duncan Murdoch
>>>
>>>> Again, it would be useful to make the documentation consistent with
>>>> the implementation.
>>>>
>>>> To summarize all this in a table of the most common datatypes:
>>>>
>>>> outerl <-
>>>>  function(f, a, b)
>>>>    structure(outer(a,b,Vectorize(f)),
>>>>              dimnames=list(a,b))
>>>>
>>>> outerl(function(x,f)(match.fun(f))(x),
>>>>
>>>> list(3,factor(c("a","b")),NULL,function()3,as.name("foo"),environment()), 
>>>>
>>>>
>>>> list("class","mode","storage.mode","is.vector","is.atomic","is.recursive")) 
>>>>
>>>>
>>>>              class         mode          storage.mode  is.vector
>>>> is.atomic is.recursive
>>>> 3             "numeric"     "numeric"     "double"      "TRUE"
>>>> "TRUE"    "FALSE"           <<< OK
>>>> 1:2           "factor"      "numeric"     "integer"     "FALSE"
>>>> "TRUE"    "FALSE"             <<< inconsistent
>>>> NULL          "NULL"        "NULL"        "NULL"        "FALSE"
>>>> "TRUE"    "FALSE"         <<< inconsistent
>>>> function ()   "function"    "function"    "function"    "FALSE"
>>>> "FALSE"   "TRUE"          <<< OK
>>>> foo           "name"        "name"        "symbol"      "FALSE"
>>>> "FALSE"   "FALSE"          <<< inconsistent
>>>> <environment> "environment" "environment" "environment" "FALSE"
>>>> "FALSE"   "TRUE"     <<< OK
>>>>
>>>> Thanks,
>>>>
>>>>           -s
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From murdoch at stats.uwo.ca  Thu Sep  3 02:02:45 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 02 Sep 2009 20:02:45 -0400
Subject: [Rd] Documentation for is.atomic and is.recursive
In-Reply-To: <4A9EF6AA.1010204@acm.org>
References: <8b356f880909021139pa07d922q1f1c28a0fb70cdbe@mail.gmail.com>		<4A9EC967.3080507@stats.uwo.ca>	<8b356f880909021310l3805de62g2c2467db9a1591d2@mail.gmail.com>
	<4A9EE3D8.7040008@stats.uwo.ca> <4A9EF6AA.1010204@acm.org>
Message-ID: <4A9F07A5.8090807@stats.uwo.ca>

On 02/09/2009 6:50 PM, Tony Plate wrote:
> Duncan Murdoch wrote:
>> On 02/09/2009 4:10 PM, Stavros Macrakis wrote:
>>> Let us stipulate that the current wording can be construed to be 
>>> correct.
>> I'd rather just state that the current wording is correct, without the 
>> weasel words.
>>
>>> I would nonetheless claim that the documentation as currently written
>>> is at best ambiguous and confusing, and would benefit from improved
>>> wording.
>> A claim that documentation would benefit from improved wording is a 
>> tautology.  A claim that the documentation is ambiguous requires more 
>> evidence than you've offered.  You have demonstrated that someone 
>> could be confused when reading it, but that isn't necessarily our 
>> responsibility.
>>
>> Duncan Murdoch
>>
> I suspect the confusion comes from the mistaken, but very 
> understandable, interpretation that the phrase "'x' is a vector" in the 
> documentation should somehow equate with the R function call 
> 'is.vector(x)'.  Similar potentially misleading wording appears in the 
> "Description" for ?is.vector:
>    "|is.vector| returns |TRUE| if |x| is a vector (of mode logical, 
> integer, real, complex, character, raw or list if not specified) or 
> expression and |FALSE|".
> However, the Details for ?is.vector do clarify, saying:
>   "|is.vector| returns |FALSE| if |x| has any attributes except names."
> 
> Here are some concrete suggestions for improving the documentation:
> (1) In the Details or Note section for ?is.atomic, add the paragraph:
> "is.atomic is unaffected by the presence of attributes on 'x', unlike 
> is.vector (which would probably be better named is.bare.vector).  
> is.atomic(x) merely tests whether the data mode of x is an atomic vector 
> type, and ignores whether or not x has attributes.  The behavior of 
> is.vector(x) is quite different -- it tests whether x is a bare vector.  
> is.vector can be TRUE for lists and expressions as well as atomic vector 
> types, but if there are attributes other than names on x, is.vector(x) 
> returns FALSE."
> 
> (2) In the Description section for ?is.vector, change
>   "|is.vector| returns |TRUE| if |x| is a vector (of mode logical, 
> integer, real, complex, character, raw or list if not specified) or 
> expression"
> to
>   "|is.vector| returns |TRUE| if |x| is a bare vector (of mode logical, 
> integer, real, complex, character, raw or list if not specified, with no 
> attributes other than names), or expression with no attributes other 
> than names"

Thanks for the suggestions.  I don't like your first one for a number of 
reasons:  too wordy, not quite right in its description of is.vector, 
editorializing about some other function's name, etc.  I'd rather leave 
the ?is.atomic page alone.

I agree that the ?is.vector page should be improved, but your suggestion 
is ambiguous:  does the "no attributes" part apply only to expressions? 
  I've just spent a few minutes, and come up with the following rewrite. 
  I'd shorten the Description entry to

   \code{is.vector} returns \code{TRUE} if \code{x} is a vector of the
specified mode having no attributes other than names.  It returns 
\code{FALSE} otherwise.

and lengthen the Details to

   If \code{mode = "any"}, \code{is.vector} returns \code{TRUE} for
   modes logical, integer, real, complex, character, raw, list or
   expression. It returns \code{FALSE} if \code{x} has any attributes
   except names.  (This is incompatible with S.)  On the other hand,
   \code{as.vector} removes \emph{all} attributes including names for
   results of atomic mode.

It's not perfect, because it is ambiguous what "This" refers to, but I 
don't actually know how much of the preceding description is 
incompatible with S, or even whether that claim makes sense:  Are all 
versions of S consistent in this?  I think it's probably inappropriate 
to be trying to document S here...  Nevertheless, I've committed this 
change.

It's not easy to write good documentation.

Duncan Murdoch

> 
> -- Tony Plate
> 
>>> What would be lost by that?
>>>
>>>> One could argue that in R's pre-history we should have had is.atomic 
>>>> imply
>>>> is.vector, but that's not how things are documented, and I think we're
>>>> pretty much stuck with the definitions we've got on low level 
>>>> functions like
>>>> those.
>>> I explicitly said in my mail that I was not suggesting that past
>>> design decisions (wise or unwise) be revisited; only that they be
>>> documented more clearly.
>>>
>>>                -s
>>>
>>> On Wed, Sep 2, 2009 at 3:37 PM, Duncan Murdoch<murdoch at stats.uwo.ca> 
>>> wrote:
>>>> On 9/2/2009 2:39 PM, Stavros Macrakis wrote:
>>>>> The documentation for is.atomic and is.recursive is inconsistent with
>>>>> their behavior in R 2.9.1 Windows.
>>>>>
>>>>> ? is.atomic
>>>>>
>>>>>     'is.atomic' returns 'TRUE' if 'x' is an atomic vector (or 'NULL')
>>>>>     and 'FALSE' otherwise.
>>>>>     ...
>>>>>     'is.atomic' is true for the atomic vector types ('"logical"',
>>>>>     '"integer"', '"numeric"', '"complex"', '"character"' and '"raw"')
>>>>>     and 'NULL'.
>>>>>
>>>>> This description implies that is.atomic(x) implies is.vector(x)
>>>>> (assuming that an "atomic vector type" is a subset of a "vector
>>>>> type").  But in fact that is not true for values with class
>>>>> attributes:
>>>> I don't see is.vector mentioned there.  The description of is.vector 
>>>> on its
>>>> own man page implies the behaviour below; I think the description of
>>>> is.atomic that you quote above is also consistent with the behaviour.
>>>>
>>>> One could argue that in R's pre-history we should have had is.atomic 
>>>> imply
>>>> is.vector, but that's not how things are documented, and I think we're
>>>> pretty much stuck with the definitions we've got on low level 
>>>> functions like
>>>> those.
>>>>
>>>>
>>>>> is.atomic(factor(3)) => TRUE
>>>>> is.vector(factor(3)) => FALSE
>>>>>
>>>>> is.atomic(table(3)) => TRUE
>>>>> is.vector(factor(3)) => FALSE
>>>>>
>>>>> It appears, then, that is.atomic requires only that unclass(x) be an
>>>>> atomic vector, not that x be an atomic vector.
>>>>>
>>>>> There is also another case where is.atomic(x) != 
>>>>> is.vector(unclass(x)):
>>>>>
>>>>> is.atomic(NULL) => TRUE
>>>>> is.vector(NULL) => FALSE
>>>>>
>>>>> It would be useful to make the documentation consistent with the
>>>>> implementation. (Presumably by updating the documentation, not
>>>>> changing the behavior.)
>>>>>
>>>>> The documentation continues:
>>>>>
>>>>>     'is.recursive' returns 'TRUE' if 'x' has a recursive (list-like)
>>>>>     structure and 'FALSE' otherwise.
>>>>>     ...
>>>>>     Most types of language objects are regarded as recursive: those
>>>>>     which are not are the atomic vector types, 'NULL' and symbols (as
>>>>>     given by 'as.name').
>>>>>
>>>>> But is.recursive(as.name('foo')) == is.recursive(quote(foo)) == FALSE.
>>>> That's what it says should happen.  symbols such as as.name('foo') 
>>>> are not
>>>> recursive.
>>>>
>>>> Duncan Murdoch
>>>>
>>>>> Again, it would be useful to make the documentation consistent with
>>>>> the implementation.
>>>>>
>>>>> To summarize all this in a table of the most common datatypes:
>>>>>
>>>>> outerl <-
>>>>>  function(f, a, b)
>>>>>    structure(outer(a,b,Vectorize(f)),
>>>>>              dimnames=list(a,b))
>>>>>
>>>>> outerl(function(x,f)(match.fun(f))(x),
>>>>>
>>>>> list(3,factor(c("a","b")),NULL,function()3,as.name("foo"),environment()), 
>>>>>
>>>>>
>>>>> list("class","mode","storage.mode","is.vector","is.atomic","is.recursive")) 
>>>>>
>>>>>
>>>>>              class         mode          storage.mode  is.vector
>>>>> is.atomic is.recursive
>>>>> 3             "numeric"     "numeric"     "double"      "TRUE"
>>>>> "TRUE"    "FALSE"           <<< OK
>>>>> 1:2           "factor"      "numeric"     "integer"     "FALSE"
>>>>> "TRUE"    "FALSE"             <<< inconsistent
>>>>> NULL          "NULL"        "NULL"        "NULL"        "FALSE"
>>>>> "TRUE"    "FALSE"         <<< inconsistent
>>>>> function ()   "function"    "function"    "function"    "FALSE"
>>>>> "FALSE"   "TRUE"          <<< OK
>>>>> foo           "name"        "name"        "symbol"      "FALSE"
>>>>> "FALSE"   "FALSE"          <<< inconsistent
>>>>> <environment> "environment" "environment" "environment" "FALSE"
>>>>> "FALSE"   "TRUE"     <<< OK
>>>>>
>>>>> Thanks,
>>>>>
>>>>>           -s
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>


From saptarshi.guha at gmail.com  Thu Sep  3 04:28:05 2009
From: saptarshi.guha at gmail.com (Saptarshi Guha)
Date: Wed, 2 Sep 2009 22:28:05 -0400
Subject: [Rd] Depth of protection stack?
Message-ID: <9DA1A7F7-1DAE-4015-9224-5BAE6678576D@gmail.com>

Hello,
Is there a way, in C, to find how deep my current protection stack  
is(apart from keeping a count).
I know the  default nested size is 50,000 and because of some coding  
error i think i'm reaching it.
Is there a way to find out the current depth reached?

Thank you
Saptarshi


From ligges at statistik.tu-dortmund.de  Thu Sep  3 10:31:32 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 03 Sep 2009 10:31:32 +0200
Subject: [Rd] Including a binary Python Interpreter into a binary
 R-package for MS Windows
In-Reply-To: <57821.94131.qm@web65608.mail.ac4.yahoo.com>
References: <57821.94131.qm@web65608.mail.ac4.yahoo.com>
Message-ID: <4A9F7EE4.4020202@statistik.tu-dortmund.de>



gvsteen at yahoo.com wrote:
> 2009/8/30 Uwe Ligges <ligges at statistik.tu-dortmund.de>: [snip]
>> Guido van Steen wrote:
> [snip]
>>> Something that interests me too: What about R's policy with
>>> respect to including binary files? I saw that developers should
>>> include a file
> [snip]
>> Please do not include binary files and carefully watch for licenses
>> of those files (e.g. if GPL'ed, you need to ship sources!). If
>> pyhthon is required, I highly suggest to state it in the
>> SystemDependencies and be fine with it - users can learn to install
>> phython themselves, I'm pretty sure.
> 
> Hi Uwe,
> 
> Note: I will send this email cc. to the R-devel list, which I joined
> today. I think it may be of interest to other people as well.
> 
> Thank you for your answer, although it disappointed me a bit. I had
> already spent quite some time building a stand-alone windows binary
> of a new package "write2xls". This package provides the same R
> interface to Python as the other package "dataframes2xls". As you
> know it enable users to create xls files. The special thing about
> "write2xls" is that it does not have any dependencies at all. It is
> so-to-speak a turn-key solution.
 >
> Of course I should have read a bit more before I started. Only after
> your mail I read the pdf-file "Writing R Extensions". It says "A
> source package if possible should not contain binary executable
> files: they are not portable, and a security risk if they are of the
> appropriate architecture. R CMD check will warn about them unless
> they are listed (one filepath per line) in a file 'BinaryFiles' at
> the top level of the package or bundle. Note that CRAN will no longer
> accept submissions containing binary files even if they are listed."
 >
> So, yes, you are right. I was actually hoping that CRAN could make
> some exceptions, but after some thinking I fully understand that many
> people would object to this for good reasons: R code depending on a C
> compiler will not work without a C Compiler either. For security
> reasons we cannot allow packages to install a binary C compiler. So,
> yes, I understand the reasons but still it is a pity.
>
> The current situation is that many MS Windows users can not easily
> use "dataframes2xls". There are a few reasons:
> 
> * Most users of MS Windows will be unfamiliar with Python, which will
> make them reluctant to install Python.


Guido,

why? If you package asks them to install Python, if your package cannot 
find it in the path, they will certainly do if they find the 
functionality very useful.


> * Installing Python will be impossible on many MS Windows platforms
> due to limited user rights.

Don't know Python on Windows so well, but why can't they install it? You 
can also install R with limited user privileges.


> * Downloading a standard Python installer takes about 15 Megabytes.
> My newly created "write2xls" package just contains 1.3 MB.

Well, but much of that space is useless/wasted for non-Windows users then.


> So only few R users can benefit from "dataframes2xls". An alternative
> to "dataframes2xls" is "write.xls". "dataframes2xls" is technically
> superior, as it allows the specification of proper formatting and
> fonts. "dataframes2xls" also exists longer. However, "write.xls" is
> available to many more R users because it depends on Perl, which is
> installed as a part of the R-tools.

Most R users under Windows won't have Rtools installed, just the 
developers will have.



> So, I think it would be a pity not to provide "write2xls", since I
> have it readily available now. Therefore, I will probably be hosting
> "write2xls" on a different repository, as long as no Python
> Interpreter is included in the R-tools. Does anyone know of a
> alternative repository, which does accept "trustworthy" R packages
> with a binary Python Interpreter.


Can't you add some configure script / Makefile that allows to build the 
binary from sources that you provide in your package?

Otherwise, what you could do is to install the binary on demand from 
another side you are hosting. E.g. library("write2xls") could check if 
the required binary is available and install on demand if it is not 
available. But don't forget to look carefully into all license issues.


> 
> Thanks!
> 
> Best wishes,
> 
> Guido van Steen
> 
> P.S. For those who are interested or who would like to test it, at
> the moment "write2xls" can be downloaded as
> "http://www.heppel.net/write2xls_0.4.4.9.zip". The "source" package
> is available as "http://www.heppel.net/write2xls_0.4.4.9.tar.gz".
> 
> P.P.S. I think that on MS Windows the combination of R and the R
> tools is just as much a potential security risk as allowing to
> include a Python Interpreter in a binary package. The R website
> should pay more serious attention to this.

R tools are just required for developers, and they won't be installed on 
other platforms than Windows, I believe. Additionally, we know who built 
those tools.


> P.P.P.S. Uwe also brings up the issue of licensing. However, this is
> not a problem at all. The Python license is one of the most
> permissive licenses around. For the Python Interpreter that I
> included in the "write2xls" package, I used pyMingW, which is
> distributed under an MIT license. It is a version of Python compiled
> by the MinGW compiler. Thanks to this pyMingW distribution I also
> avoid the need of any Microsoft-owned dlls. "dataframes2xls" and
> "write2xls" are also distributed under a MIT license.

If MIT allows to ship things the way you plan to, then it's fine, but no 
binaries in sources packages on CRAN. We did quite some work to get rid 
of the packages that did (even my own package!) and won't make 
exceptions. We won't revert our decision.

Best wishes,
Uwe Ligges


From maechler at stat.math.ethz.ch  Thu Sep  3 11:29:03 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 3 Sep 2009 11:29:03 +0200
Subject: [Rd] R devel repository tarball naming issue
In-Reply-To: <4A9EEFD7.3030000@fhcrc.org>
References: <h7j40e$n4p$1@perl.epigenomics.epi>
	<4A9EEFD7.3030000@fhcrc.org>
Message-ID: <19103.35935.70973.765877@lynne.math.ethz.ch>

>>>>> "HP" == Herv? Pag?s <hpages at fhcrc.org>
>>>>>     on Wed, 02 Sep 2009 15:21:11 -0700 writes:

    HP> Hi,
    HP> Same here, we rely on these snapshots for the Bioconductor build system.

    HP> ftp://ftp.stat.math.ethz.ch/Software/R/

    HP> Now there seems to be a file (or symlink) named R-devel.tar.gz (note
    HP> that the files with a broken name e.g. R-devel_.tar.gz are still here).
    HP> The problem is that after download and extraction I get:

    HP> biocbuild at wilson2:~/src> cat R-devel/SVN-REVISION
    HP> Revision: unknown

    HP> so I have no way to know when this snapshot has been created.
    HP> It used to be that R-devel.tar.gz is in fact a symlink to the
    HP> latest R-devel_YYYY-MM-DD.tar.gz located in the same folder but
    HP> that doesn't seem to be the case here. Where are the
    HP> R-devel_YYYY-MM-DD.tar.gz tarballs for the last 10 days?

    HP> Could someone please have a look?

Yes, I now did and have fixed the problem.

It was from an OS change (from Redhat to Fedora) which I had not
checked the way I thought I had ...

I'm sorry for any inconveniences.
---
Martin Maechler, ETH Zurich


From chalabi at phys.ethz.ch  Thu Sep  3 12:44:13 2009
From: chalabi at phys.ethz.ch (Yohan Chalabi)
Date: Thu, 3 Sep 2009 12:44:13 +0200
Subject: [Rd] S4 Generics and NAMESPACE : justified warning ?
In-Reply-To: <19099.51012.936944.591938@lynne.math.ethz.ch>
References: <20090817135120.16fab862@mimi>
	<30312_1250600886_4A8AA7B5_30312_581_1_4A8AA986.3040702@fhcrc.org>
	<20090828162429.32576c07@mimi>
	<19099.51012.936944.591938@lynne.math.ethz.ch>
Message-ID: <20090903124413.10c3763c@mimi>

>>>> "MM" == Martin Maechler <maechler at stat.math.ethz.ch>
>>>> on Mon, 31 Aug 2009 14:51:16 +0200

   MM> Yes, I agree, unjustified in your case.
   MM> The question is: is there a patch which does differentiate
   MM> between your situation and Martin's scenario -- or does your
   MM> patch already do that?


Hi Martin,

Thanks for your response.

Here is an attempt to combine both views. 

To check if the generic was derived from the function it wants to
overwrite, the following patch checks if the package associated with
the generic is the same as the one where the function was defined.

regards,
Yohan

Index: src/library/base/R/namespace.R
===================================================================
--- src/library/base/R/namespace.R	(revision 49543)
+++ src/library/base/R/namespace.R	(working copy)
@@ -797,8 +797,19 @@
 	}
     }
     for (n in impnames)
-        if (exists(n, envir = impenv, inherits = FALSE))
-            warning(msg, " ", n)
+        if (exists(n, envir = impenv, inherits = FALSE)) {
+            if (.isMethodsDispatchOn() && methods:::isGeneric(n, ns)) {
+                ## warning if generic overwrites a function which
+                ## it was not derived from
+                genNs <- methods:::slot(get(n, envir = ns), "package")
+                genImpenv <- environmentName(environment(get(n, envir = impenv)))
+                genWarn1 <- (!identical(genNs, genImpenv))
+                ## warning if generic overwrites another generic
+                genWarn2 <- methods:::isGeneric(n, impenv)
+                if (genWarn1 || genWarn2)
+                    warning(msg, " ", n)
+            } else warning(msg, " ", n)
+        }
     importIntoEnv(impenv, impnames, ns, impvars)
     if (register) {
         addImports(self, ns,


From ripley at stats.ox.ac.uk  Thu Sep  3 13:30:27 2009
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Thu,  3 Sep 2009 13:30:27 +0200 (CEST)
Subject: [Rd] names<- in data.frame (PR#13916)
Message-ID: <20090903113027.EE5692832011@mail.pubhealth.ku.dk>

It does work correctly:

> names(tdf)
[1] "" ""

The thing you have overlooked is that data frames are required to have 
non-empty (not 'zero-length': yours has length 2) names, and the print 
method has created some (as data.frame will if you give unnamed 
arguments).

Please be careful to distinguish between an object and its printed 
representation.

On Fri, 28 Aug 2009, vitosmail at rambler.ru wrote:

> Full_Name: Spinu Vitalie
> Version: 2.9.0
> OS: Windows
> Submission from: (NULL) (130.115.113.15)
>
>
> In assignment of "zero length" names to data.frame:
>
>> tdf <- data.frame(rbind(c(1, 2), c(1, 2)))
>> names(tdf) <- c("", "")
>> tdf
>  structure(c("1", "1"), class = "AsIs") structure(c("2", "2"), class = "AsIs")
> 1                                      1                                      2
> 2                                      1                                      2
>
> For vectors it works nicely:
>
>> tv <- c(1, 2)
>> names(tv) <- c("", "")
>> tv
>
> 1 2
>
>
>
>
>> sessionInfo()
> R version 2.9.0 (2009-04-17)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> States.1252;LC_MONETARY=English_United
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  uti
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From romain.francois at dbmail.com  Thu Sep  3 13:47:42 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Thu, 03 Sep 2009 13:47:42 +0200
Subject: [Rd] How to ship R scripts with R packages ?
In-Reply-To: <4A9E5356.4020907@stats.uwo.ca>
References: <4A9E4F3D.5070704@dbmail.com> <4A9E5356.4020907@stats.uwo.ca>
Message-ID: <4A9FACDE.3020505@dbmail.com>

On 09/02/2009 01:13 PM, Duncan Murdoch wrote:
>
> Romain Francois wrote:
>> Hello,
>>
>> (This is a remix of this previous thread:
>> https://stat.ethz.ch/pipermail/r-devel/2009-August/054264.html , but
>> with a concrete example)
>>
>> I am developing some packages that contain scripts (for Rscript) and
>> would like to know what is the best/recommended way to ship these
>> scripts.
>>
>> An example is the "ant" package (R capable version of apache ant, see
>> http://tr.im/xHLs). The package has a ant.R script in the exec
>> directory and here is how I use it :
>>
>> $ `Rscript -e "cat( system.file( 'exec', 'ant.R', package = 'ant' ) ) " `
>>
>> ... not so pretty. Meanwhile, "Writing R extensions" talks about the
>> exec directory, but it is not clear if I can use it this way or how.
>>
>
> I think exec is a reasonable place to put the script. If you don't want
> to type that long command above, why not put it in a small function in
> the package? E.g. define
>
> antR <- function() cat( system.file( 'exec', 'ant.R', package = 'ant' ) )
>
> then you can run it with
>
> Rscript -e "ant::antR()"
>
> Duncan Murdoch

I've implemented a minimal version of this in package "exec". For example.

$ Rscript -e "exec::rscript( 'ant', 'ant.R')"

Romain

btw, exec is maintained at r-forge :

$ svn checkout svn://svn.r-forge.r-project.org/svnroot/highlight/pkg/exec


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/xMdt : update on the ant package
|- http://tr.im/xHLs : R capable version of ant
`- http://tr.im/xHiZ : Tip: get java home from R with rJava


From ct529 at york.ac.uk  Thu Sep  3 14:40:40 2009
From: ct529 at york.ac.uk (Corrado)
Date: Thu, 3 Sep 2009 13:40:40 +0100
Subject: [Rd] --enable-memory-profiling at configuration (compilation) time?
Message-ID: <200909031340.40469.ct529@york.ac.uk>

Dear Rfriends,

what is the option --enable-memory-profiling at configuration (just before build 
+ install) time?

I did not find mention of it in the R admin manual (http://cran.r-
project.org/doc/manuals/R-admin.html).

Regards
-- 
Corrado Topi

Global Climate Change & Biodiversity Indicators
Area 18,Department of Biology
University of York, York, YO10 5YW, UK
Phone: + 44 (0) 1904 328645, E-mail: ct529 at york.ac.uk


From edd at debian.org  Thu Sep  3 14:44:57 2009
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 3 Sep 2009 07:44:57 -0500
Subject: [Rd] How to ship R scripts with R packages ?
In-Reply-To: <4A9FACDE.3020505@dbmail.com>
References: <4A9E4F3D.5070704@dbmail.com> <4A9E5356.4020907@stats.uwo.ca>
	<4A9FACDE.3020505@dbmail.com>
Message-ID: <19103.47689.990868.212106@ron.nulle.part>


On 3 September 2009 at 13:47, Romain Francois wrote:
| On 09/02/2009 01:13 PM, Duncan Murdoch wrote:
| > I think exec is a reasonable place to put the script. If you don't want
| > to type that long command above, why not put it in a small function in
| > the package? E.g. define
| >
| > antR <- function() cat( system.file( 'exec', 'ant.R', package = 'ant' ) )
| >
| > then you can run it with
| >
| > Rscript -e "ant::antR()"
| >
| > Duncan Murdoch
| 
| I've implemented a minimal version of this in package "exec". For example.
| 
| $ Rscript -e "exec::rscript( 'ant', 'ant.R')"
| 
| Romain
| 
| btw, exec is maintained at r-forge :
| 
| $ svn checkout svn://svn.r-forge.r-project.org/svnroot/highlight/pkg/exec

Interesting. I should take a look. I had similar needs for Rcpp as R doesn't
provide a 'pkg-config'-alike function for add-on packages.  Rcpp provides a
header and a library for its users. These need to be found by the user's
Makefiles, so following a suggestion Simon once made, what we now do is to
provide

  Rcpp:::CxxFlags()
  Rcpp:::LdFlags()

which aren't even in the NAMESPACE file and meant to be called directly from
configure scripts or Makefiles as in (using either little

  $ r -e'Rcpp:::CxxFlags()'
  -I/usr/lib/R/site-library/Rcpp/libedd at ron:~$

  $ Rscript -e 'Rcpp:::LdFlags()'
  -L/usr/lib/R/site-library/Rcpp/lib -lRcpp -Wl,-rpath,/usr/lib/R/site-library/Rcpp/lib$

(and notice the lack of a trailing 'backslash-n').

Could there be scope for generalising this up into R proper for 2.11 or
later?

Dirk

-- 
Three out of two people have difficulties with fractions.


From murdoch at stats.uwo.ca  Thu Sep  3 14:46:27 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 03 Sep 2009 08:46:27 -0400
Subject: [Rd] How to ship R scripts with R packages ?
In-Reply-To: <4A9FACDE.3020505@dbmail.com>
References: <4A9E4F3D.5070704@dbmail.com> <4A9E5356.4020907@stats.uwo.ca>
	<4A9FACDE.3020505@dbmail.com>
Message-ID: <4A9FBAA3.1010606@stats.uwo.ca>

On 03/09/2009 7:47 AM, Romain Francois wrote:
> On 09/02/2009 01:13 PM, Duncan Murdoch wrote:
>> Romain Francois wrote:
>>> Hello,
>>>
>>> (This is a remix of this previous thread:
>>> https://stat.ethz.ch/pipermail/r-devel/2009-August/054264.html , but
>>> with a concrete example)
>>>
>>> I am developing some packages that contain scripts (for Rscript) and
>>> would like to know what is the best/recommended way to ship these
>>> scripts.
>>>
>>> An example is the "ant" package (R capable version of apache ant, see
>>> http://tr.im/xHLs). The package has a ant.R script in the exec
>>> directory and here is how I use it :
>>>
>>> $ `Rscript -e "cat( system.file( 'exec', 'ant.R', package = 'ant' ) ) " `
>>>
>>> ... not so pretty. Meanwhile, "Writing R extensions" talks about the
>>> exec directory, but it is not clear if I can use it this way or how.
>>>
>> I think exec is a reasonable place to put the script. If you don't want
>> to type that long command above, why not put it in a small function in
>> the package? E.g. define
>>
>> antR <- function() cat( system.file( 'exec', 'ant.R', package = 'ant' ) )
>>
>> then you can run it with
>>
>> Rscript -e "ant::antR()"
>>
>> Duncan Murdoch
> 
> I've implemented a minimal version of this in package "exec". For example.
> 
> $ Rscript -e "exec::rscript( 'ant', 'ant.R')"
> 
> Romain
> 
> btw, exec is maintained at r-forge :
> 
> $ svn checkout svn://svn.r-forge.r-project.org/svnroot/highlight/pkg/exec

That's a nice, simple function.  I might add an argument

dir = "exec"

rather than hard-coding that directory choice; others might keep their 
scripts somewhere else, or want to run one of the test scripts, etc.

Duncan Murdoch


From romain.francois at dbmail.com  Thu Sep  3 14:47:52 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Thu, 03 Sep 2009 14:47:52 +0200
Subject: [Rd] How to ship R scripts with R packages ?
In-Reply-To: <4A9FBAA3.1010606@stats.uwo.ca>
References: <4A9E4F3D.5070704@dbmail.com> <4A9E5356.4020907@stats.uwo.ca>
	<4A9FACDE.3020505@dbmail.com> <4A9FBAA3.1010606@stats.uwo.ca>
Message-ID: <4A9FBAF8.3060707@dbmail.com>

On 09/03/2009 02:46 PM, Duncan Murdoch wrote:
>
> On 03/09/2009 7:47 AM, Romain Francois wrote:
>> On 09/02/2009 01:13 PM, Duncan Murdoch wrote:
>>> Romain Francois wrote:
>>>> Hello,
>>>>
>>>> (This is a remix of this previous thread:
>>>> https://stat.ethz.ch/pipermail/r-devel/2009-August/054264.html , but
>>>> with a concrete example)
>>>>
>>>> I am developing some packages that contain scripts (for Rscript) and
>>>> would like to know what is the best/recommended way to ship these
>>>> scripts.
>>>>
>>>> An example is the "ant" package (R capable version of apache ant, see
>>>> http://tr.im/xHLs). The package has a ant.R script in the exec
>>>> directory and here is how I use it :
>>>>
>>>> $ `Rscript -e "cat( system.file( 'exec', 'ant.R', package = 'ant' )
>>>> ) " `
>>>>
>>>> ... not so pretty. Meanwhile, "Writing R extensions" talks about the
>>>> exec directory, but it is not clear if I can use it this way or how.
>>>>
>>> I think exec is a reasonable place to put the script. If you don't want
>>> to type that long command above, why not put it in a small function in
>>> the package? E.g. define
>>>
>>> antR <- function() cat( system.file( 'exec', 'ant.R', package = 'ant'
>>> ) )
>>>
>>> then you can run it with
>>>
>>> Rscript -e "ant::antR()"
>>>
>>> Duncan Murdoch
>>
>> I've implemented a minimal version of this in package "exec". For
>> example.
>>
>> $ Rscript -e "exec::rscript( 'ant', 'ant.R')"
>>
>> Romain
>>
>> btw, exec is maintained at r-forge :
>>
>> $ svn checkout svn://svn.r-forge.r-project.org/svnroot/highlight/pkg/exec
>
> That's a nice, simple function. I might add an argument
>
> dir = "exec"
>
> rather than hard-coding that directory choice; others might keep their
> scripts somewhere else, or want to run one of the test scripts, etc.
>
> Duncan Murdoch

Good point. The other hard coded thing is that it goes looking for the 
path of Rscript, which might not be that useful if the script is a 
python/perl/ script.

I might try to encapsulate an R equivalent to !/bin/env lookup ...

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/xMdt : update on the ant package
|- http://tr.im/xHLs : R capable version of ant
`- http://tr.im/xHiZ : Tip: get java home from R with rJava


From simon.urbanek at r-project.org  Thu Sep  3 14:57:09 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 3 Sep 2009 08:57:09 -0400
Subject: [Rd] Depth of protection stack?
In-Reply-To: <9DA1A7F7-1DAE-4015-9224-5BAE6678576D@gmail.com>
References: <9DA1A7F7-1DAE-4015-9224-5BAE6678576D@gmail.com>
Message-ID: <4BADBDE9-B52C-4A8A-AA0E-6EE6162E2B54@r-project.org>


On Sep 2, 2009, at 22:28 , Saptarshi Guha wrote:

> Hello,
> Is there a way, in C, to find how deep my current protection stack  
> is(apart from keeping a count).
> I know the  default nested size is 50,000 and because of some coding  
> error i think i'm reaching it.
> Is there a way to find out the current depth reached?
>

extern int R_PPStackTop;

(use for debugging purposes only!)

Cheers,
Simon


From hadley at rice.edu  Thu Sep  3 15:11:17 2009
From: hadley at rice.edu (Hadley Wickham)
Date: Thu, 3 Sep 2009 08:11:17 -0500
Subject: [Rd] Package names
Message-ID: <f8e6ff050909030611j76caa1cay22e07b43c75baa@mail.gmail.com>

Currently, writing R extensions states: "The ?Package? and ?Version?
fields give the name and the version of the package, respectively. The
name should consist of letters, numbers, and the dot character and
start with a letter. "

Now that _ is no longer an assignment operator, could it be added to this list?

Hadley

-- 
http://had.co.nz/


From hadley at rice.edu  Thu Sep  3 15:16:27 2009
From: hadley at rice.edu (Hadley Wickham)
Date: Thu, 3 Sep 2009 08:16:27 -0500
Subject: [Rd] clearNames and unname
Message-ID: <f8e6ff050909030616r21a29548w2181ca0bb3c8a59e@mail.gmail.com>

Just noticed these two functions (clearNames is stats and unname in
base) that do the same thing.

Hadley

-- 
http://had.co.nz/


From hadley at rice.edu  Thu Sep  3 15:17:24 2009
From: hadley at rice.edu (Hadley Wickham)
Date: Thu, 3 Sep 2009 08:17:24 -0500
Subject: [Rd] force & identity
Message-ID: <f8e6ff050909030617u232760edh208ddc6d1f14ff13@mail.gmail.com>

Similarly, force & identity are identical (although with different
semantic connotations).  Would be nice to have a see also from each.

Hadley

-- 
http://had.co.nz/


From Kurt.Hornik at wu.ac.at  Thu Sep  3 15:19:25 2009
From: Kurt.Hornik at wu.ac.at (Kurt Hornik)
Date: Thu, 3 Sep 2009 15:19:25 +0200
Subject: [Rd] Package names
In-Reply-To: <f8e6ff050909030611j76caa1cay22e07b43c75baa@mail.gmail.com>
References: <f8e6ff050909030611j76caa1cay22e07b43c75baa@mail.gmail.com>
Message-ID: <19103.49757.659669.370597@fangorn.hornik.net>

>>>>> Hadley Wickham writes:

> Currently, writing R extensions states: "The ?Package? and ?Version?
> fields give the name and the version of the package, respectively. The
> name should consist of letters, numbers, and the dot character and
> start with a letter. "

> Now that _ is no longer an assignment operator, could it be added to
> this list?

This would make it trickier to parse PACKAGE_VERSION.tar.gz et al file
names, and break lots of code based on this naming scheme.

-k

> Hadley

> -- 
> http://had.co.nz/

> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hadley at rice.edu  Thu Sep  3 15:34:15 2009
From: hadley at rice.edu (Hadley Wickham)
Date: Thu, 3 Sep 2009 08:34:15 -0500
Subject: [Rd] Package names
In-Reply-To: <19103.49757.659669.370597@fangorn.hornik.net>
References: <f8e6ff050909030611j76caa1cay22e07b43c75baa@mail.gmail.com> 
	<19103.49757.659669.370597@fangorn.hornik.net>
Message-ID: <f8e6ff050909030634q9dee750k144fa431d50f073c@mail.gmail.com>

>> Currently, writing R extensions states: "The ?Package? and ?Version?
>> fields give the name and the version of the package, respectively. The
>> name should consist of letters, numbers, and the dot character and
>> start with a letter. "
>
>> Now that _ is no longer an assignment operator, could it be added to
>> this list?
>
> This would make it trickier to parse PACKAGE_VERSION.tar.gz et al file
> names, and break lots of code based on this naming scheme.

Oh, good point.

Hadley


-- 
http://had.co.nz/


From ligges at statistik.tu-dortmund.de  Thu Sep  3 15:37:57 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 03 Sep 2009 15:37:57 +0200
Subject: [Rd] Package names
In-Reply-To: <f8e6ff050909030611j76caa1cay22e07b43c75baa@mail.gmail.com>
References: <f8e6ff050909030611j76caa1cay22e07b43c75baa@mail.gmail.com>
Message-ID: <4A9FC6B5.3030501@statistik.tu-dortmund.de>



Hadley Wickham wrote:
> Currently, writing R extensions states: "The ?Package? and ?Version?
> fields give the name and the version of the package, respectively. The
> name should consist of letters, numbers, and the dot character and
> start with a letter. "
> 
> Now that _ is no longer an assignment operator, could it be added to this list?


Hadley, it is used as the separator between packagename and version 
number in the name of a package. And (at least my) code relies on the 
fact that there is exactly one "_" in the filename.

Best,
Uwe




> Hadley
>


From hb at stat.berkeley.edu  Thu Sep  3 15:47:32 2009
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Thu, 3 Sep 2009 06:47:32 -0700
Subject: [Rd] Package names
In-Reply-To: <4A9FC6B5.3030501@statistik.tu-dortmund.de>
References: <f8e6ff050909030611j76caa1cay22e07b43c75baa@mail.gmail.com> 
	<4A9FC6B5.3030501@statistik.tu-dortmund.de>
Message-ID: <59d7961d0909030647n17259ee0o378bb0a4ef97994@mail.gmail.com>

2009/9/3 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>
>
> Hadley Wickham wrote:
>>
>> Currently, writing R extensions states: "The ?Package? and ?Version?
>> fields give the name and the version of the package, respectively. The
>> name should consist of letters, numbers, and the dot character and
>> start with a letter. "
>>
>> Now that _ is no longer an assignment operator, could it be added to this
>> list?
>
>
> Hadley, it is used as the separator between packagename and version number
> in the name of a package. And (at least my) code relies on the fact that
> there is exactly one "_" in the filename.

I agree that this opens up for potential problems, but that one should
be possible to solve using correct regular expressions, just like it
was done to allow for periods ('.') in package names.

My $.02

/Henrik

>
> Best,
> Uwe
>
>
>
>
>> Hadley
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From wwwhsd at gmail.com  Thu Sep  3 15:53:47 2009
From: wwwhsd at gmail.com (Henrique Dallazuanna)
Date: Thu, 3 Sep 2009 10:53:47 -0300
Subject: [Rd] clearNames and unname
In-Reply-To: <f8e6ff050909030616r21a29548w2181ca0bb3c8a59e@mail.gmail.com>
References: <f8e6ff050909030616r21a29548w2181ca0bb3c8a59e@mail.gmail.com>
Message-ID: <da79af330909030653k65f3b4c4p2a1fdc9ea35cea2c@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090903/d7ba3e37/attachment.pl>

From romain.francois at dbmail.com  Thu Sep  3 15:53:02 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Thu, 03 Sep 2009 15:53:02 +0200
Subject: [Rd] Rscript and default packages
Message-ID: <4A9FCA3E.7090501@dbmail.com>

Hi,

Is is possible to embed inside an R script, the name of the default 
packages to be loaded when the script is invoked with Rscript.

I know about the --default-packages argument, but I was wondering if 
there was a mechanism to embed this information within the script itself

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/xMdt : update on the ant package
|- http://tr.im/xHLs : R capable version of ant
`- http://tr.im/xHiZ : Tip: get java home from R with rJava


From maechler at stat.math.ethz.ch  Thu Sep  3 16:14:24 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 3 Sep 2009 16:14:24 +0200
Subject: [Rd] clearNames and unname
In-Reply-To: <f8e6ff050909030616r21a29548w2181ca0bb3c8a59e@mail.gmail.com>
References: <f8e6ff050909030616r21a29548w2181ca0bb3c8a59e@mail.gmail.com>
Message-ID: <19103.53056.407750.237426@lynne.math.ethz.ch>

>>>>> "HW" == Hadley Wickham <hadley at rice.edu>
>>>>>     on Thu, 3 Sep 2009 08:16:27 -0500 writes:

    HW> Just noticed these two functions (clearNames is stats and unname in
    HW> base) that do the same thing.

clearNames looks like an accident.  unname() has existed for
much longer {and as someone else said}, 
has been more general, too.

Martin


From maechler at stat.math.ethz.ch  Thu Sep  3 17:02:35 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 3 Sep 2009 17:02:35 +0200
Subject: [Rd] clearNames and unname
In-Reply-To: <19103.53056.407750.237426@lynne.math.ethz.ch>
References: <f8e6ff050909030616r21a29548w2181ca0bb3c8a59e@mail.gmail.com>
	<19103.53056.407750.237426@lynne.math.ethz.ch>
Message-ID: <19103.55947.28119.671358@lynne.math.ethz.ch>

>>>>> "MM" == Martin Maechler <maechler at stat.math.ethz.ch>
>>>>>     on Thu, 3 Sep 2009 16:14:24 +0200 writes:

>>>>> "HW" == Hadley Wickham <hadley at rice.edu>
>>>>>     on Thu, 3 Sep 2009 08:16:27 -0500 writes:

    HW> Just noticed these two functions (clearNames is stats and unname in
    HW> base) that do the same thing.

    MM> clearNames looks like an accident.  unname() has existed for
    MM> much longer {and as someone else said}, 
    MM> has been more general, too.

Hmm, the first part in the above may be wrong:
clearNames() has been part of the 'nls' package (before that
was integrated into 'stats'),
and the code of 'nls' may well have been almost as old as the
unname() function :
I see both in  R 0.90.1  (December 15, 1999).

I see only about 5 usages of clearNames() in CRAN packages, and
none in the 300+ Bioconductor "Rpacks"  packages.

Consequently, I'm proposing to deprecate  clearNames() {for
unname()}.

Martin


From murdoch at stats.uwo.ca  Thu Sep  3 17:23:51 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 03 Sep 2009 11:23:51 -0400
Subject: [Rd] Rscript and default packages
In-Reply-To: <4A9FCA3E.7090501@dbmail.com>
References: <4A9FCA3E.7090501@dbmail.com>
Message-ID: <4A9FDF87.4000801@stats.uwo.ca>

On 03/09/2009 9:53 AM, Romain Francois wrote:
> Hi,
> 
> Is is possible to embed inside an R script, the name of the default 
> packages to be loaded when the script is invoked with Rscript.
> 
> I know about the --default-packages argument, but I was wondering if 
> there was a mechanism to embed this information within the script itself


I don't understand what you'd want here that you don't get with attach() 
or require().  Why does it matter if they are default?

Duncan Murdoch


From edd at debian.org  Thu Sep  3 17:41:53 2009
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 3 Sep 2009 10:41:53 -0500
Subject: [Rd] --enable-memory-profiling at configuration (compilation)
	time?
In-Reply-To: <200909031340.40469.ct529@york.ac.uk>
References: <200909031340.40469.ct529@york.ac.uk>
Message-ID: <19103.58305.653534.100933@ron.nulle.part>


On 3 September 2009 at 13:40, Corrado wrote:
| Dear Rfriends,
| 
| what is the option --enable-memory-profiling at configuration (just before build 
| + install) time?
| 
| I did not find mention of it in the R admin manual (http://cran.r-
| project.org/doc/manuals/R-admin.html).

Try the 'R Extensions' manual which discusses profiling, both for speed and
memory use, and the latter case requires this option (which we do enable by
default on Debian / Ubuntu).

Dirk

-- 
Three out of two people have difficulties with fractions.


From rdpeng at gmail.com  Thu Sep  3 18:23:03 2009
From: rdpeng at gmail.com (Roger Peng)
Date: Thu, 3 Sep 2009 12:23:03 -0400
Subject: [Rd] force & identity
In-Reply-To: <f8e6ff050909030617u232760edh208ddc6d1f14ff13@mail.gmail.com>
References: <f8e6ff050909030617u232760edh208ddc6d1f14ff13@mail.gmail.com>
Message-ID: <66f3bd910909030923r2c93f2ddjc21cb3b6a91e3fee@mail.gmail.com>

Given that the two functions (although identical) serve different
purposes and are in a sense unrelated, it's not clear that a See Also
is needed (and in fact might be confusing).

-roger

On Thu, Sep 3, 2009 at 9:17 AM, Hadley Wickham<hadley at rice.edu> wrote:
> Similarly, force & identity are identical (although with different
> semantic connotations). ?Would be nice to have a see also from each.
>
> Hadley
>
> --
> http://had.co.nz/
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Roger D. Peng  |  http://www.biostat.jhsph.edu/~rpeng/


From bates at stat.wisc.edu  Thu Sep  3 18:24:57 2009
From: bates at stat.wisc.edu (Douglas Bates)
Date: Thu, 3 Sep 2009 11:24:57 -0500
Subject: [Rd] clearNames and unname
In-Reply-To: <19103.55947.28119.671358@lynne.math.ethz.ch>
References: <f8e6ff050909030616r21a29548w2181ca0bb3c8a59e@mail.gmail.com>
	<19103.53056.407750.237426@lynne.math.ethz.ch>
	<19103.55947.28119.671358@lynne.math.ethz.ch>
Message-ID: <40e66e0b0909030924t260c290dre22e0cca209bde7@mail.gmail.com>

On Thu, Sep 3, 2009 at 10:02 AM, Martin
Maechler<maechler at stat.math.ethz.ch> wrote:
>>>>>> "MM" == Martin Maechler <maechler at stat.math.ethz.ch>
>>>>>> ? ? on Thu, 3 Sep 2009 16:14:24 +0200 writes:
>
>>>>>> "HW" == Hadley Wickham <hadley at rice.edu>
>>>>>> ? ? on Thu, 3 Sep 2009 08:16:27 -0500 writes:
>
> ? ?HW> Just noticed these two functions (clearNames is stats and unname in
> ? ?HW> base) that do the same thing.
>
> ? ?MM> clearNames looks like an accident. ?unname() has existed for
> ? ?MM> much longer {and as someone else said},
> ? ?MM> has been more general, too.
>
> Hmm, the first part in the above may be wrong:
> clearNames() has been part of the 'nls' package (before that
> was integrated into 'stats'),
> and the code of 'nls' may well have been almost as old as the
> unname() function :
> I see both in ?R 0.90.1 ?(December 15, 1999).
>
> I see only about 5 usages of clearNames() in CRAN packages, and
> none in the 300+ Bioconductor "Rpacks" ?packages.
>
> Consequently, I'm proposing to deprecate ?clearNames() {for
> unname()}.

Fine with me.  I had forgotten that we even wrote clearNames() for the
nls package.


From saptarshi.guha at gmail.com  Thu Sep  3 18:59:13 2009
From: saptarshi.guha at gmail.com (Saptarshi Guha)
Date: Thu, 3 Sep 2009 12:59:13 -0400
Subject: [Rd] Turn of -O2 during package build
Message-ID: <1e7471d50909030959u16ecd3c2x88894d0b8c12ef76@mail.gmail.com>

Hello,
I'm using a Makevars.in file and running my code through gdb. I
understand i should turn of -O2, but R's makeconf overrides my
settings

/ln/meraki/custom/lib64/R/etc/Makeconf:112: warning: overriding
commands for target `.cc.o'

in Makevars.in

.cc.o:
	g++ -g ${PKG_CXXFLAGS} ${PKG_LIBS} ${RINC} ${RLIB} -c $< -o $@
Thank you
S.


From saptarshi.guha at gmail.com  Thu Sep  3 19:01:54 2009
From: saptarshi.guha at gmail.com (Saptarshi Guha)
Date: Thu, 3 Sep 2009 13:01:54 -0400
Subject: [Rd] Turn of -O2 during package build
In-Reply-To: <1e7471d50909030959u16ecd3c2x88894d0b8c12ef76@mail.gmail.com>
References: <1e7471d50909030959u16ecd3c2x88894d0b8c12ef76@mail.gmail.com>
Message-ID: <1e7471d50909031001u7f03c641nbfced320bde05d15@mail.gmail.com>

My own response:
use
%.o: %.cc
and not the form given below.
Regards
S

On Thu, Sep 3, 2009 at 12:59 PM, Saptarshi Guha<saptarshi.guha at gmail.com> wrote:
> Hello,
> I'm using a Makevars.in file and running my code through gdb. I
> understand i should turn of -O2, but R's makeconf overrides my
> settings
>
> /ln/meraki/custom/lib64/R/etc/Makeconf:112: warning: overriding
> commands for target `.cc.o'
>
> in Makevars.in
>
> .cc.o:
> ? ? ? ?g++ -g ${PKG_CXXFLAGS} ${PKG_LIBS} ${RINC} ${RLIB} -c $< -o $@
> Thank you
> S.
>


From hb at stat.berkeley.edu  Thu Sep  3 19:05:40 2009
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Thu, 3 Sep 2009 10:05:40 -0700
Subject: [Rd] Suggestion: Allow packages to add additional information to
	sessionInfo()
Message-ID: <59d7961d0909031005p676b5fe8m4878c1149c22dad6@mail.gmail.com>

Hi,

sessionInfo() has been proven really useful, but you still often have
to ask for additional information in order to help troubleshooting.
For instance, for troubleshooting the aroma.affymetrix, it is very
helpful to know what the current working directory is, for other
packages certain system environment variables might be useful and so
on.

One solution could be to provide support for hook functions of
sessionInfo(), which package then can register and append to the
'sessionInfo' list structure.  Does this make sense?

/Henrik


From ggrothendieck at gmail.com  Thu Sep  3 19:16:42 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 3 Sep 2009 13:16:42 -0400
Subject: [Rd] Suggestion: Allow packages to add additional information
	to sessionInfo()
In-Reply-To: <59d7961d0909031005p676b5fe8m4878c1149c22dad6@mail.gmail.com>
References: <59d7961d0909031005p676b5fe8m4878c1149c22dad6@mail.gmail.com>
Message-ID: <971536df0909031016t2658cc1dl98c11d597cb3066c@mail.gmail.com>

The danger is that it could introduce bugs into the process
of reporting bugs.

On Thu, Sep 3, 2009 at 1:05 PM, Henrik Bengtsson<hb at stat.berkeley.edu> wrote:
> Hi,
>
> sessionInfo() has been proven really useful, but you still often have
> to ask for additional information in order to help troubleshooting.
> For instance, for troubleshooting the aroma.affymetrix, it is very
> helpful to know what the current working directory is, for other
> packages certain system environment variables might be useful and so
> on.
>
> One solution could be to provide support for hook functions of
> sessionInfo(), which package then can register and append to the
> 'sessionInfo' list structure. ?Does this make sense?
>
> /Henrik
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hb at stat.berkeley.edu  Thu Sep  3 19:27:07 2009
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Thu, 3 Sep 2009 10:27:07 -0700
Subject: [Rd] Suggestion: Allow packages to add additional information
	to sessionInfo()
In-Reply-To: <971536df0909031016t2658cc1dl98c11d597cb3066c@mail.gmail.com>
References: <59d7961d0909031005p676b5fe8m4878c1149c22dad6@mail.gmail.com> 
	<971536df0909031016t2658cc1dl98c11d597cb3066c@mail.gmail.com>
Message-ID: <59d7961d0909031027t5ec2d0f5u707a140dcd3d6474@mail.gmail.com>

On Thu, Sep 3, 2009 at 10:16 AM, Gabor
Grothendieck<ggrothendieck at gmail.com> wrote:
> The danger is that it could introduce bugs into the process
> of reporting bugs.

If you mean that sessionInfo() will result in an error, that is easily
solved by a tryCatch() statement.  Timeouts are harder.  One can also
consider providing an sessionInfo(..., extras=TRUE) option.

The purpose is to save the maintainer (and those who try to help
troubleshooting) time.  There are tons of time spend on sending follow
up requests on basic things.  We took a great leap when introducing
sessionInfo() and think we can take it further.

/Henrik

>
> On Thu, Sep 3, 2009 at 1:05 PM, Henrik Bengtsson<hb at stat.berkeley.edu> wrote:
>> Hi,
>>
>> sessionInfo() has been proven really useful, but you still often have
>> to ask for additional information in order to help troubleshooting.
>> For instance, for troubleshooting the aroma.affymetrix, it is very
>> helpful to know what the current working directory is, for other
>> packages certain system environment variables might be useful and so
>> on.
>>
>> One solution could be to provide support for hook functions of
>> sessionInfo(), which package then can register and append to the
>> 'sessionInfo' list structure. ?Does this make sense?
>>
>> /Henrik
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From krcoombes at mdacc.tmc.edu  Thu Sep  3 19:38:28 2009
From: krcoombes at mdacc.tmc.edu (Kevin R. Coombes)
Date: Thu, 03 Sep 2009 12:38:28 -0500
Subject: [Rd] Suggestion: Allow packages to add additional information
 to sessionInfo()
In-Reply-To: <59d7961d0909031027t5ec2d0f5u707a140dcd3d6474@mail.gmail.com>
References: <59d7961d0909031005p676b5fe8m4878c1149c22dad6@mail.gmail.com>
	<971536df0909031016t2658cc1dl98c11d597cb3066c@mail.gmail.com>
	<59d7961d0909031027t5ec2d0f5u707a140dcd3d6474@mail.gmail.com>
Message-ID: <4A9FFF14.8010800@mdacc.tmc.edu>

[1] I agree that sessionInfo() can be taken further.
[2] I even more strongly agree that it would be a bad idea to allow 
packages to add features that cause the base sessionInfo() function to fail.

Why not add an extra function called something like 
"packageSessionInfo()" that would provide the desired hooks but keep 
them from breaking the base functionality?

(Of course, this ignores the possibility that someone could create a 
package within which they make sessionInfo into a generic and cause 
things to break through the S4 class mechanism...)

    Kevin

Henrik Bengtsson wrote:
> On Thu, Sep 3, 2009 at 10:16 AM, Gabor
> Grothendieck<ggrothendieck at gmail.com> wrote:
>   
>> The danger is that it could introduce bugs into the process
>> of reporting bugs.
>>     
>
> If you mean that sessionInfo() will result in an error, that is easily
> solved by a tryCatch() statement.  Timeouts are harder.  One can also
> consider providing an sessionInfo(..., extras=TRUE) option.
>
> The purpose is to save the maintainer (and those who try to help
> troubleshooting) time.  There are tons of time spend on sending follow
> up requests on basic things.  We took a great leap when introducing
> sessionInfo() and think we can take it further.
>
> /Henrik
>
>   
>> On Thu, Sep 3, 2009 at 1:05 PM, Henrik Bengtsson<hb at stat.berkeley.edu> wrote:
>>     
>>> Hi,
>>>
>>> sessionInfo() has been proven really useful, but you still often have
>>> to ask for additional information in order to help troubleshooting.
>>> For instance, for troubleshooting the aroma.affymetrix, it is very
>>> helpful to know what the current working directory is, for other
>>> packages certain system environment variables might be useful and so
>>> on.
>>>
>>> One solution could be to provide support for hook functions of
>>> sessionInfo(), which package then can register and append to the
>>> 'sessionInfo' list structure.  Does this make sense?
>>>
>>> /Henrik
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>       
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From romain.francois at dbmail.com  Thu Sep  3 19:52:19 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Thu, 03 Sep 2009 19:52:19 +0200
Subject: [Rd] Rscript and default packages
In-Reply-To: <4A9FDF87.4000801@stats.uwo.ca>
References: <4A9FCA3E.7090501@dbmail.com> <4A9FDF87.4000801@stats.uwo.ca>
Message-ID: <4AA00253.6060101@dbmail.com>

On 09/03/2009 05:23 PM, Duncan Murdoch wrote:
>
> On 03/09/2009 9:53 AM, Romain Francois wrote:
>> Hi,
>>
>> Is is possible to embed inside an R script, the name of the default
>> packages to be loaded when the script is invoked with Rscript.
>>
>> I know about the --default-packages argument, but I was wondering if
>> there was a mechanism to embed this information within the script itself
>
> I don't understand what you'd want here that you don't get with attach()
> or require(). Why does it matter if they are default?
>
> Duncan Murdoch

Sorry for being vague. I am more interested in not loading some packages:

$ time Rscript  -e "#"

real	0m0.224s
user	0m0.188s
sys	0m0.032s


$ time Rscript --default-packages="base" -e "#"

real	0m0.067s
user	0m0.033s
sys	0m0.016s


$ time r -e "#"

real	0m0.039s
user	0m0.032s
sys	0m0.006s

This is related to the "How to ship R scripts with R packages" thread. 
I'd like for example to ship a script that I know only requires the 
"base" package. How would I specify this from within the script.

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/xMdt : update on the ant package
|- http://tr.im/xHLs : R capable version of ant
`- http://tr.im/xHiZ : Tip: get java home from R with rJava


From hb at stat.berkeley.edu  Thu Sep  3 20:10:31 2009
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Thu, 3 Sep 2009 11:10:31 -0700
Subject: [Rd] Suggestion: Allow packages to add additional information
	to sessionInfo()
In-Reply-To: <4A9FFF14.8010800@mdacc.tmc.edu>
References: <59d7961d0909031005p676b5fe8m4878c1149c22dad6@mail.gmail.com> 
	<971536df0909031016t2658cc1dl98c11d597cb3066c@mail.gmail.com> 
	<59d7961d0909031027t5ec2d0f5u707a140dcd3d6474@mail.gmail.com> 
	<4A9FFF14.8010800@mdacc.tmc.edu>
Message-ID: <59d7961d0909031110w64b2df4en48e99c8ea5aeca1e@mail.gmail.com>

On Thu, Sep 3, 2009 at 10:38 AM, Kevin R.
Coombes<krcoombes at mdacc.tmc.edu> wrote:
> [1] I agree that sessionInfo() can be taken further.
> [2] I even more strongly agree that it would be a bad idea to allow packages
> to add features that cause the base sessionInfo() function to fail.
>
> Why not add an extra function called something like "packageSessionInfo()"
> that would provide the desired hooks but keep them from breaking the base
> functionality?

The point is that (if so) there should only be *one function* to call
for all packages, not one per package, because that would be a pain
due to dependencies.  But, sure I'm happy to start with a
package[s]SessionInfo() such that

c(sessionInfo(), extras=packagesSessionInfo())

pretty much return what I wish. Then it might be easier to argue for
incorporating the above in sessionInfo() ;)

Sorry for not getting it, but I still don't see how adding extra
information would break the base functionality?  Can you give some
examples?

As I said, timeouts can be a problem and possibly also if the hook
functions have side effects that, say, would load new packages, could
give funny results, but I also think a package developer who is
capable to setting up hook function would no how to avoid this.

With the default argument of 'extras' to be FALSE, sessionInfo() would
work as now, with the extra feature that 'extras=TRUE' can give lots
of additional useful information.

/Henrik

>
> (Of course, this ignores the possibility that someone could create a package
> within which they make sessionInfo into a generic and cause things to break
> through the S4 class mechanism...)
>
> ? Kevin
>
> Henrik Bengtsson wrote:
>>
>> On Thu, Sep 3, 2009 at 10:16 AM, Gabor
>> Grothendieck<ggrothendieck at gmail.com> wrote:
>>
>>>
>>> The danger is that it could introduce bugs into the process
>>> of reporting bugs.
>>>
>>
>> If you mean that sessionInfo() will result in an error, that is easily
>> solved by a tryCatch() statement. ?Timeouts are harder. ?One can also
>> consider providing an sessionInfo(..., extras=TRUE) option.
>>
>> The purpose is to save the maintainer (and those who try to help
>> troubleshooting) time. ?There are tons of time spend on sending follow
>> up requests on basic things. ?We took a great leap when introducing
>> sessionInfo() and think we can take it further.
>>
>> /Henrik
>>
>>
>>>
>>> On Thu, Sep 3, 2009 at 1:05 PM, Henrik Bengtsson<hb at stat.berkeley.edu>
>>> wrote:
>>>
>>>>
>>>> Hi,
>>>>
>>>> sessionInfo() has been proven really useful, but you still often have
>>>> to ask for additional information in order to help troubleshooting.
>>>> For instance, for troubleshooting the aroma.affymetrix, it is very
>>>> helpful to know what the current working directory is, for other
>>>> packages certain system environment variables might be useful and so
>>>> on.
>>>>
>>>> One solution could be to provide support for hook functions of
>>>> sessionInfo(), which package then can register and append to the
>>>> 'sessionInfo' list structure. ?Does this make sense?
>>>>
>>>> /Henrik
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hpages at fhcrc.org  Thu Sep  3 22:34:10 2009
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Thu, 03 Sep 2009 13:34:10 -0700
Subject: [Rd] R devel repository tarball naming issue
In-Reply-To: <19103.35935.70973.765877@lynne.math.ethz.ch>
References: <h7j40e$n4p$1@perl.epigenomics.epi>	<4A9EEFD7.3030000@fhcrc.org>
	<19103.35935.70973.765877@lynne.math.ethz.ch>
Message-ID: <4AA02842.3030202@fhcrc.org>

Thanks Martin! The latest snapshot (R-devel_2009-09-03.tar.gz) looks OK.

FYI the tarballs with a broken name are still here
(ftp://ftp.stat.math.ethz.ch/Software/R/):

   R-devel_.tar.bz2
   R-devel_.tar.gz

Cheers,
H.


Martin Maechler wrote:
>>>>>> "HP" == Herv? Pag?s <hpages at fhcrc.org>
>>>>>>     on Wed, 02 Sep 2009 15:21:11 -0700 writes:
> 
>     HP> Hi,
>     HP> Same here, we rely on these snapshots for the Bioconductor build system.
> 
>     HP> ftp://ftp.stat.math.ethz.ch/Software/R/
> 
>     HP> Now there seems to be a file (or symlink) named R-devel.tar.gz (note
>     HP> that the files with a broken name e.g. R-devel_.tar.gz are still here).
>     HP> The problem is that after download and extraction I get:
> 
>     HP> biocbuild at wilson2:~/src> cat R-devel/SVN-REVISION
>     HP> Revision: unknown
> 
>     HP> so I have no way to know when this snapshot has been created.
>     HP> It used to be that R-devel.tar.gz is in fact a symlink to the
>     HP> latest R-devel_YYYY-MM-DD.tar.gz located in the same folder but
>     HP> that doesn't seem to be the case here. Where are the
>     HP> R-devel_YYYY-MM-DD.tar.gz tarballs for the last 10 days?
> 
>     HP> Could someone please have a look?
> 
> Yes, I now did and have fixed the problem.
> 
> It was from an OS change (from Redhat to Fedora) which I had not
> checked the way I thought I had ...
> 
> I'm sorry for any inconveniences.
> ---
> Martin Maechler, ETH Zurich

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From macrakis at alum.mit.edu  Thu Sep  3 23:36:19 2009
From: macrakis at alum.mit.edu (Stavros Macrakis)
Date: Thu, 3 Sep 2009 17:36:19 -0400
Subject: [Rd] Documentation for is.atomic and is.recursive
In-Reply-To: <4A9EE3D8.7040008@stats.uwo.ca>
References: <8b356f880909021139pa07d922q1f1c28a0fb70cdbe@mail.gmail.com>
	<4A9EC967.3080507@stats.uwo.ca>
	<8b356f880909021310l3805de62g2c2467db9a1591d2@mail.gmail.com>
	<4A9EE3D8.7040008@stats.uwo.ca>
Message-ID: <8b356f880909031436j991fb05m4d9e7c1da646f5a0@mail.gmail.com>

On Wed, Sep 2, 2009 at 5:30 PM, Duncan Murdoch<murdoch at stats.uwo.ca> wrote:
> On 02/09/2009 4:10 PM, Stavros Macrakis wrote:
...
>> I would nonetheless claim that the documentation as currently written
>> is at best ambiguous and confusing, and would benefit from improved
>> wording.
>
> A claim that documentation would benefit from improved wording is a
> tautology. ?A claim that the documentation is ambiguous requires more
> evidence than you've offered. ?You have demonstrated that someone could be
> confused when reading it, but that isn't necessarily our responsibility.

Of course not.  I forgot.  This is r-devel: the user is always wrong,
the developer is always right.

           -s


From gvsteen at yahoo.com  Fri Sep  4 00:41:05 2009
From: gvsteen at yahoo.com (Guido van Steen)
Date: Fri, 4 Sep 2009 00:41:05 +0200
Subject: [Rd] Including a binary Python Interpreter into a binary
	R-package for	MS Windows
Message-ID: <200909032241.n83Mf544000750@smtp1.infopact.nl>

Sorry: I sent this email to R-devel at R-project.COM. So that it got bounced.

Hi Uwe, 

Thanks a lot for this answer. 

> Don't know Python on Windows so well, but why can't they
> install it? You can also install R with limited user
> privileges.

The last time I worked with Python on MS Windows was about 10 years ago. From that time I remember that you needed administrative privileges to install Python (1.5). For some reason this idea got stuck in my mind. I have just tried an ordinary user-install of Python 2.6.2 within a Virtual Machine (XP). I experienced no problems at all. So, you are right: this user-rights argument is invalid. 

> Well, but much of that space is useless/wasted for
> non-Windows users then.

This gave me to the idea to create a package with a slightly different name. It would be an MS Windows only package.  

> Most R users under Windows won't have Rtools installed,
> just the developers will have.

I did not know that. So I guess many R users also miss the Perl dependent scripts. 

> Can't you add some configure script / Makefile that allows
> to build the binary from sources that you provide in your
> package?

Well, that would make the package really bloated. I would first have to build the MinGW compiler, and then I would have to use MinGW to build Python. 

> Otherwise, what you could do is to install the binary on 
> demand from another side you are hosting. E.g. 
> library("write2xls") could check if the required binary is 
> available and install on demand if it is not available. 

This is the kind of idea I am looking for! Thanks very much! Indeed, this would circumvent the whole need of including the Python binaries in an R-package. 

I also like Gabor's idea to run Python scripts from Jython. As he explained, this makes Python available to anyone with access to Java. This might also be acceptable for those users who abhor binary downloads in general. On the other hand it might make the package slow because of longer loading times. 

> If MIT allows to ship things the way you plan to, then it's
> fine, but no binaries in sources packages on CRAN. We did
> quite some work to get rid of the packages that did (even my
> own package!) and won't make exceptions. We won't revert our
> decision.

Very good! I fully support the decision! 

Best wishes, 

Guido


From saptarshi.guha at gmail.com  Fri Sep  4 01:15:32 2009
From: saptarshi.guha at gmail.com (Saptarshi Guha)
Date: Thu, 3 Sep 2009 19:15:32 -0400
Subject: [Rd] Running an expression 1MN times using embedded R
Message-ID: <F088461E-A558-40F8-8197-9BD72759EA74@gmail.com>

Hello,
I'm evaluating this expression
expression({ for(x in 1:5){ .Call('rh_status','x')  }})
a million times from a program with R embedded in it. I have attached  
reproducible code that crashes with

Program received signal SIGSEGV, Segmentation fault.
0x00002b499ca40a6e in R_gc_internal (size_needed=0) at memory.c:1309
1309		FORWARD_NODE(R_PPStack[i]);
Current language:  auto; currently c

(bt output below)

The code crashes with R-2.8 on both OS X (10.5) and Linux (Linux  
2.6.18-128.4.1.el5 #1 SMP Thu Jul 23 19:59:19 EDT 2009 x86_64 x86_64  
x86_64 GNU/Linux)

Most of the code has been taken from the R extensions website, I would  
appreciate any pointers to why this is crashing.
  code can be found at the end of the email.



Much thanks for your time
Regards
Saptarshi






BT OUTPUT:

#0  0x00002b499ca40a6e in R_gc_internal (size_needed=0) at memory.c:1309
#1  0x00002b499ca42bc0 in Rf_cons (car=0x484ba98, cdr=0x484ba98) at  
memory.c:1766
#2  0x00002b499ca1e39d in Rf_evalList (el=0x4cd0f30, rho=0x488ca48,  
op=0x5077148) at eval.c:1489
#3  0x00002b499ca1de4d in Rf_eval (e=0x4cd1010, rho=0x488ca48) at  
eval.c:480
#4  0x00002b499ca1ea82 in do_begin (call=0x4cd1048, op=0x486a830,  
args=0x4cd1080, rho=0x488ca48) at eval.c:1174
#5  0x00002b499ca1dda6 in Rf_eval (e=0x4cd1048, rho=0x488ca48) at  
eval.c:461
#6  0x00002b499ca21720 in do_for (call=0x4cd1160, op=0x4868540,  
args=0x4cd1128, rho=0x488ca48) at eval.c:1073
#7  0x00002b499ca1dda6 in Rf_eval (e=0x4cd1160, rho=0x488ca48) at  
eval.c:461
#8  0x00002b499ca1ea82 in do_begin (call=0x4cd1198, op=0x486a830,  
args=0x4cd11d0, rho=0x488ca48) at eval.c:1174
#9  0x00002b499ca1dda6 in Rf_eval (e=0x4cd1198, rho=0x488ca48) at  
eval.c:461
#10 0x00002b499ca22494 in do_eval (call=0x49893f8, op=0x487ed08,  
args=<value optimized out>, rho=0x511ec40) at eval.c:1752
#11 0x00002b499ca4b74e in do_internal (call=<value optimized out>,  
op=<value optimized out>, args=<value optimized out>, env=0x511ec40)  
at names.c:1140
#12 0x00002b499ca1dda6 in Rf_eval (e=0x4987c90, rho=0x511ec40) at  
eval.c:461
#13 0x00002b499ca200c1 in Rf_applyClosure (call=0x4ccfca0,  
op=0x4988080, arglist=0x511ed20, rho=0x488ca48, suppliedenv=0x488ca80)  
at eval.c:667
#14 0x00002b499ca1dc78 in Rf_eval (e=0x4ccfca0, rho=0x488ca48) at  
eval.c:505
#15 0x0000000000401412 in main (argc=1, argv=0x7fff9e67c358) at  
fugu.cc:126


To compile:
g++ -g -O0 `R CMD config --cppflags` `R CMD config --ldflags` fugu.cc

//////////////
//CODE:
/////////////
#include <iostream>

#define R_NO_REMAP
#include <Rversion.h>
#include <R.h>
#include <Rdefines.h>
#include <Rinternals.h>
#include <Rinterface.h>
#include <Rembedded.h>
#include <R_ext/Boolean.h>
#include <R_ext/Parse.h>
#include <R_ext/Rdynload.h>
const int i___ = 1;
#define is_bigendian() ( (*(char*)&i___) == 0 )

extern void (*ptr_R_ShowMessage)(const char *);
extern void (*ptr_R_WriteConsole)(const char *, int);
extern int  (*ptr_R_ReadConsole)(char *, unsigned char *, int, int);
extern void (*ptr_R_WriteConsoleEx)(const char *, int , int );
SEXP rh_status(SEXP);
static uint8_t SET_STATUS = 0x02;

static R_CallMethodDef callMethods [] = {
   {"rh_status",(DL_FUNC)&rh_status,1},
   {NULL, NULL, 0}
};

uint32_t reverseUInt (uint32_t i) {
     uint8_t c1, c2, c3, c4;

     if (is_bigendian()) {
         return i;
     } else {
         c1 = i & 255;
         c2 = (i >> 8) & 255;
         c3 = (i >> 16) & 255;
         c4 = (i >> 24) & 255;

         return ((uint32_t)c1 << 24) + ((uint32_t)c2 << 16) +  
((uint32_t)c3 << 8) + c4;
     }
}


SEXP rh_status(SEXP mess){
   if(TYPEOF(mess)!=STRSXP){
     return R_NilValue;
   }
   char *status = (char*)CHAR(STRING_ELT( mess , 0));
   // fwrite(&SET_STATUS,sizeof(uint8_t),1,stderr);
   // uint32_t stle = strlen(status);
   // uint32_t len_rev =  reverseUInt(stle);
   // fwrite(&len_rev,sizeof(uint32_t),1,stderr);
   // fwrite(status,stle,1,stderr);
}

SEXP rexpress(const char* cmd)
{
   SEXP cmdSexp, cmdexpr, ans = R_NilValue;
   int i,Rerr;
   ParseStatus status;
   PROTECT(cmdSexp = Rf_allocVector(STRSXP, 1));
   SET_STRING_ELT(cmdSexp, 0, Rf_mkChar(cmd));
   cmdexpr = PROTECT(R_ParseVector(cmdSexp, -1, &status, R_NilValue));
   if (status != PARSE_OK) {
     UNPROTECT(2);
     return(R_NilValue);
   }
   for(i = 0; i < Rf_length(cmdexpr); i++)
     ans = R_tryEval(VECTOR_ELT(cmdexpr, i),NULL,&Rerr);
   UNPROTECT(2);
   return(ans);
}


int embedR(int argc, char **argv){
   structRstart rp;
   Rstart Rp = &rp;
   R_DefParams(Rp);
   Rp->NoRenviron = 0;
   Rp->R_Interactive = (Rboolean)1;
   R_SetParams(Rp);
   R_SignalHandlers=0;
   if (!getenv("R_HOME")) {
     fprintf(stderr, "R_HOME is not set. Please set all required  
environment variables before running this program.\n");
     return(-1);
   }
   int stat= Rf_initialize_R(argc,(char **) argv);
   if (stat<0) {
     fprintf(stderr,"Failed to initialize embedded R!:%d\n",stat);
     return(-2);
   }
   R_Outputfile = NULL;
   R_Consolefile = NULL;
   R_Interactive = (Rboolean)1;
   // ptr_R_ShowMessage = Re_ShowMessage;
   // ptr_R_WriteConsoleEx =Re_WriteConsoleEx;

   // ptr_R_WriteConsole = NULL;
   // ptr_R_ReadConsole = NULL;

   return(0);
}

int main(int argc, char **argv){
   if (embedR(argc,argv))
       exit(1);
   setup_Rmainloop();
   DllInfo *info = R_getEmbeddingDllInfo();
   R_registerRoutines(info, NULL, callMethods, NULL, NULL);
   SEXP runner1,runner2;

   PROTECT(runner1=rexpress("expression({ for(x in 1:5) 
{ .Call('rh_status','x')  }})"));
   if (runner1 == R_NilValue){
       UNPROTECT(1);
       exit(1);
   }
   PROTECT(runner2=Rf_lang2(Rf_install("eval"),runner1));
   if(runner2==NILSXP){
     UNPROTECT(2);
     exit(1);
   }
   int mapbuf_cnt = 0;
   for(;;){
     if(mapbuf_cnt >1000000) exit(0);
     Rf_eval(runner2 ,R_GlobalEnv);
     mapbuf_cnt++;
   }
   UNPROTECT(2);
}


From simon.urbanek at r-project.org  Fri Sep  4 01:27:15 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 3 Sep 2009 19:27:15 -0400
Subject: [Rd] Running an expression 1MN times using embedded R
In-Reply-To: <F088461E-A558-40F8-8197-9BD72759EA74@gmail.com>
References: <F088461E-A558-40F8-8197-9BD72759EA74@gmail.com>
Message-ID: <83CA908A-67BD-470A-A627-6B4D51E8414A@r-project.org>


On Sep 3, 2009, at 7:15 PM, Saptarshi Guha wrote:

> Hello,
> I'm evaluating this expression
> expression({ for(x in 1:5){ .Call('rh_status','x')  }})
> a million times from a program with R embedded in it. I have  
> attached reproducible code that crashes with
>
> Program received signal SIGSEGV, Segmentation fault.
> 0x00002b499ca40a6e in R_gc_internal (size_needed=0) at memory.c:1309
> 1309		FORWARD_NODE(R_PPStack[i]);
> Current language:  auto; currently c
>
> (bt output below)
>
> The code crashes with R-2.8 on both OS X (10.5) and Linux (Linux  
> 2.6.18-128.4.1.el5 #1 SMP Thu Jul 23 19:59:19 EDT 2009 x86_64 x86_64  
> x86_64 GNU/Linux)
>
> Most of the code has been taken from the R extensions website, I  
> would appreciate any pointers to why this is crashing.
> code can be found at the end of the email.
>

Try -Wall when compiling your code - it will tell you what's wrong:

a.cc:54: warning: control reaches end of non-void function

You simply forgot to add return to rh_status so it's returning junk  
which crashes (since it's not a valid SEXP).

Cheers,
Simon


>
>
> Much thanks for your time
> Regards
> Saptarshi
>
>
>
>
>
>
> BT OUTPUT:
>
> #0  0x00002b499ca40a6e in R_gc_internal (size_needed=0) at memory.c: 
> 1309
> #1  0x00002b499ca42bc0 in Rf_cons (car=0x484ba98, cdr=0x484ba98) at  
> memory.c:1766
> #2  0x00002b499ca1e39d in Rf_evalList (el=0x4cd0f30, rho=0x488ca48,  
> op=0x5077148) at eval.c:1489
> #3  0x00002b499ca1de4d in Rf_eval (e=0x4cd1010, rho=0x488ca48) at  
> eval.c:480
> #4  0x00002b499ca1ea82 in do_begin (call=0x4cd1048, op=0x486a830,  
> args=0x4cd1080, rho=0x488ca48) at eval.c:1174
> #5  0x00002b499ca1dda6 in Rf_eval (e=0x4cd1048, rho=0x488ca48) at  
> eval.c:461
> #6  0x00002b499ca21720 in do_for (call=0x4cd1160, op=0x4868540,  
> args=0x4cd1128, rho=0x488ca48) at eval.c:1073
> #7  0x00002b499ca1dda6 in Rf_eval (e=0x4cd1160, rho=0x488ca48) at  
> eval.c:461
> #8  0x00002b499ca1ea82 in do_begin (call=0x4cd1198, op=0x486a830,  
> args=0x4cd11d0, rho=0x488ca48) at eval.c:1174
> #9  0x00002b499ca1dda6 in Rf_eval (e=0x4cd1198, rho=0x488ca48) at  
> eval.c:461
> #10 0x00002b499ca22494 in do_eval (call=0x49893f8, op=0x487ed08,  
> args=<value optimized out>, rho=0x511ec40) at eval.c:1752
> #11 0x00002b499ca4b74e in do_internal (call=<value optimized out>,  
> op=<value optimized out>, args=<value optimized out>, env=0x511ec40)  
> at names.c:1140
> #12 0x00002b499ca1dda6 in Rf_eval (e=0x4987c90, rho=0x511ec40) at  
> eval.c:461
> #13 0x00002b499ca200c1 in Rf_applyClosure (call=0x4ccfca0,  
> op=0x4988080, arglist=0x511ed20, rho=0x488ca48,  
> suppliedenv=0x488ca80) at eval.c:667
> #14 0x00002b499ca1dc78 in Rf_eval (e=0x4ccfca0, rho=0x488ca48) at  
> eval.c:505
> #15 0x0000000000401412 in main (argc=1, argv=0x7fff9e67c358) at  
> fugu.cc:126
>
>
> To compile:
> g++ -g -O0 `R CMD config --cppflags` `R CMD config --ldflags` fugu.cc
>
> //////////////
> //CODE:
> /////////////
> #include <iostream>
>
> #define R_NO_REMAP
> #include <Rversion.h>
> #include <R.h>
> #include <Rdefines.h>
> #include <Rinternals.h>
> #include <Rinterface.h>
> #include <Rembedded.h>
> #include <R_ext/Boolean.h>
> #include <R_ext/Parse.h>
> #include <R_ext/Rdynload.h>
> const int i___ = 1;
> #define is_bigendian() ( (*(char*)&i___) == 0 )
>
> extern void (*ptr_R_ShowMessage)(const char *);
> extern void (*ptr_R_WriteConsole)(const char *, int);
> extern int  (*ptr_R_ReadConsole)(char *, unsigned char *, int, int);
> extern void (*ptr_R_WriteConsoleEx)(const char *, int , int );
> SEXP rh_status(SEXP);
> static uint8_t SET_STATUS = 0x02;
>
> static R_CallMethodDef callMethods [] = {
>  {"rh_status",(DL_FUNC)&rh_status,1},
>  {NULL, NULL, 0}
> };
>
> uint32_t reverseUInt (uint32_t i) {
>    uint8_t c1, c2, c3, c4;
>
>    if (is_bigendian()) {
>        return i;
>    } else {
>        c1 = i & 255;
>        c2 = (i >> 8) & 255;
>        c3 = (i >> 16) & 255;
>        c4 = (i >> 24) & 255;
>
>        return ((uint32_t)c1 << 24) + ((uint32_t)c2 << 16) +  
> ((uint32_t)c3 << 8) + c4;
>    }
> }
>
>
> SEXP rh_status(SEXP mess){
>  if(TYPEOF(mess)!=STRSXP){
>    return R_NilValue;
>  }
>  char *status = (char*)CHAR(STRING_ELT( mess , 0));
>  // fwrite(&SET_STATUS,sizeof(uint8_t),1,stderr);
>  // uint32_t stle = strlen(status);
>  // uint32_t len_rev =  reverseUInt(stle);
>  // fwrite(&len_rev,sizeof(uint32_t),1,stderr);
>  // fwrite(status,stle,1,stderr);
> }
>
> SEXP rexpress(const char* cmd)
> {
>  SEXP cmdSexp, cmdexpr, ans = R_NilValue;
>  int i,Rerr;
>  ParseStatus status;
>  PROTECT(cmdSexp = Rf_allocVector(STRSXP, 1));
>  SET_STRING_ELT(cmdSexp, 0, Rf_mkChar(cmd));
>  cmdexpr = PROTECT(R_ParseVector(cmdSexp, -1, &status, R_NilValue));
>  if (status != PARSE_OK) {
>    UNPROTECT(2);
>    return(R_NilValue);
>  }
>  for(i = 0; i < Rf_length(cmdexpr); i++)
>    ans = R_tryEval(VECTOR_ELT(cmdexpr, i),NULL,&Rerr);
>  UNPROTECT(2);
>  return(ans);
> }
>
>
> int embedR(int argc, char **argv){
>  structRstart rp;
>  Rstart Rp = &rp;
>  R_DefParams(Rp);
>  Rp->NoRenviron = 0;
>  Rp->R_Interactive = (Rboolean)1;
>  R_SetParams(Rp);
>  R_SignalHandlers=0;
>  if (!getenv("R_HOME")) {
>    fprintf(stderr, "R_HOME is not set. Please set all required  
> environment variables before running this program.\n");
>    return(-1);
>  }
>  int stat= Rf_initialize_R(argc,(char **) argv);
>  if (stat<0) {
>    fprintf(stderr,"Failed to initialize embedded R!:%d\n",stat);
>    return(-2);
>  }
>  R_Outputfile = NULL;
>  R_Consolefile = NULL;
>  R_Interactive = (Rboolean)1;
>  // ptr_R_ShowMessage = Re_ShowMessage;
>  // ptr_R_WriteConsoleEx =Re_WriteConsoleEx;
>
>  // ptr_R_WriteConsole = NULL;
>  // ptr_R_ReadConsole = NULL;
>
>  return(0);
> }
>
> int main(int argc, char **argv){
>  if (embedR(argc,argv))
>      exit(1);
>  setup_Rmainloop();
>  DllInfo *info = R_getEmbeddingDllInfo();
>  R_registerRoutines(info, NULL, callMethods, NULL, NULL);
>  SEXP runner1,runner2;
>
>  PROTECT(runner1=rexpress("expression({ for(x in 1:5){ .Call 
> ('rh_status','x')  }})"));
>  if (runner1 == R_NilValue){
>      UNPROTECT(1);
>      exit(1);
>  }
>  PROTECT(runner2=Rf_lang2(Rf_install("eval"),runner1));
>  if(runner2==NILSXP){
>    UNPROTECT(2);
>    exit(1);
>  }
>  int mapbuf_cnt = 0;
>  for(;;){
>    if(mapbuf_cnt >1000000) exit(0);
>    Rf_eval(runner2 ,R_GlobalEnv);
>    mapbuf_cnt++;
>  }
>  UNPROTECT(2);
> }
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From murdoch at stats.uwo.ca  Fri Sep  4 03:22:36 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 03 Sep 2009 21:22:36 -0400
Subject: [Rd] Documentation for is.atomic and is.recursive
In-Reply-To: <8b356f880909031436j991fb05m4d9e7c1da646f5a0@mail.gmail.com>
References: <8b356f880909021139pa07d922q1f1c28a0fb70cdbe@mail.gmail.com>	<4A9EC967.3080507@stats.uwo.ca>	<8b356f880909021310l3805de62g2c2467db9a1591d2@mail.gmail.com>	<4A9EE3D8.7040008@stats.uwo.ca>
	<8b356f880909031436j991fb05m4d9e7c1da646f5a0@mail.gmail.com>
Message-ID: <4AA06BDC.8050809@stats.uwo.ca>

On 03/09/2009 5:36 PM, Stavros Macrakis wrote:
> On Wed, Sep 2, 2009 at 5:30 PM, Duncan Murdoch<murdoch at stats.uwo.ca> wrote:
>> On 02/09/2009 4:10 PM, Stavros Macrakis wrote:
> ...
>>> I would nonetheless claim that the documentation as currently written
>>> is at best ambiguous and confusing, and would benefit from improved
>>> wording.
>> A claim that documentation would benefit from improved wording is a
>> tautology.  A claim that the documentation is ambiguous requires more
>> evidence than you've offered.  You have demonstrated that someone could be
>> confused when reading it, but that isn't necessarily our responsibility.
> 
> Of course not.  I forgot.  This is r-devel: the user is always wrong,
> the developer is always right.

Yes, you want r-whinge.  That's down the hall.

Duncan Murdoch


From murdoch at stats.uwo.ca  Fri Sep  4 03:32:18 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 03 Sep 2009 21:32:18 -0400
Subject: [Rd] Rscript and default packages
In-Reply-To: <4AA00253.6060101@dbmail.com>
References: <4A9FCA3E.7090501@dbmail.com> <4A9FDF87.4000801@stats.uwo.ca>
	<4AA00253.6060101@dbmail.com>
Message-ID: <4AA06E22.1020003@stats.uwo.ca>

On 03/09/2009 1:52 PM, Romain Francois wrote:
> On 09/03/2009 05:23 PM, Duncan Murdoch wrote:
>> On 03/09/2009 9:53 AM, Romain Francois wrote:
>>> Hi,
>>>
>>> Is is possible to embed inside an R script, the name of the default
>>> packages to be loaded when the script is invoked with Rscript.
>>>
>>> I know about the --default-packages argument, but I was wondering if
>>> there was a mechanism to embed this information within the script itself
>> I don't understand what you'd want here that you don't get with attach()
>> or require(). Why does it matter if they are default?
>>
>> Duncan Murdoch
> 
> Sorry for being vague. I am more interested in not loading some packages:
> 
> $ time Rscript  -e "#"
> 
> real	0m0.224s
> user	0m0.188s
> sys	0m0.032s
> 
> 
> $ time Rscript --default-packages="base" -e "#"
> 
> real	0m0.067s
> user	0m0.033s
> sys	0m0.016s
> 
> 
> $ time r -e "#"
> 
> real	0m0.039s
> user	0m0.032s
> sys	0m0.006s
> 
> This is related to the "How to ship R scripts with R packages" thread. 
> I'd like for example to ship a script that I know only requires the 
> "base" package. How would I specify this from within the script.

Okay, I get it.  I don't think there's any way to do that.  Rscript 
doesn't look at the script, it just sends it to Rterm after possibly 
setting R_DEFAULT_PACKAGES.  So your script has no way to say it just 
needs base, you need to know that before you run it.

Duncan Murdoch


From saptarshi.guha at gmail.com  Fri Sep  4 05:49:10 2009
From: saptarshi.guha at gmail.com (Saptarshi Guha)
Date: Thu, 3 Sep 2009 23:49:10 -0400
Subject: [Rd] Running an expression 1MN times using embedded R
In-Reply-To: <83CA908A-67BD-470A-A627-6B4D51E8414A@r-project.org>
References: <F088461E-A558-40F8-8197-9BD72759EA74@gmail.com> 
	<83CA908A-67BD-470A-A627-6B4D51E8414A@r-project.org>
Message-ID: <1e7471d50909032049m5fe1214aj7095c485e9f9a311@mail.gmail.com>

Oh!Thanks much. Worked perfectly.
Hadn't realized the importance of -Wall.

Regards
saptarshi


On Thu, Sep 3, 2009 at 7:27 PM, Simon
Urbanek<simon.urbanek at r-project.org> wrote:
>
> On Sep 3, 2009, at 7:15 PM, Saptarshi Guha wrote:
>
>> Hello,
>> I'm evaluating this expression
>> expression({ for(x in 1:5){ .Call('rh_status','x') ?}})
>> a million times from a program with R embedded in it. I have attached
>> reproducible code that crashes with
>>
>> Program received signal SIGSEGV, Segmentation fault.
>> 0x00002b499ca40a6e in R_gc_internal (size_needed=0) at memory.c:1309
>> 1309 ? ? ? ? ? ?FORWARD_NODE(R_PPStack[i]);
>> Current language: ?auto; currently c
>>
>> (bt output below)
>>
>> The code crashes with R-2.8 on both OS X (10.5) and Linux (Linux
>> 2.6.18-128.4.1.el5 #1 SMP Thu Jul 23 19:59:19 EDT 2009 x86_64 x86_64 x86_64
>> GNU/Linux)
>>
>> Most of the code has been taken from the R extensions website, I would
>> appreciate any pointers to why this is crashing.
>> code can be found at the end of the email.
>>
>
> Try -Wall when compiling your code - it will tell you what's wrong:
>
> a.cc:54: warning: control reaches end of non-void function
>
> You simply forgot to add return to rh_status so it's returning junk which
> crashes (since it's not a valid SEXP).
>
> Cheers,
> Simon
>
>
>>
>>
>> Much thanks for your time
>> Regards
>> Saptarshi
>>
>>
>>
>>
>>
>>
>> BT OUTPUT:
>>
>> #0 ?0x00002b499ca40a6e in R_gc_internal (size_needed=0) at memory.c:1309
>> #1 ?0x00002b499ca42bc0 in Rf_cons (car=0x484ba98, cdr=0x484ba98) at
>> memory.c:1766
>> #2 ?0x00002b499ca1e39d in Rf_evalList (el=0x4cd0f30, rho=0x488ca48,
>> op=0x5077148) at eval.c:1489
>> #3 ?0x00002b499ca1de4d in Rf_eval (e=0x4cd1010, rho=0x488ca48) at
>> eval.c:480
>> #4 ?0x00002b499ca1ea82 in do_begin (call=0x4cd1048, op=0x486a830,
>> args=0x4cd1080, rho=0x488ca48) at eval.c:1174
>> #5 ?0x00002b499ca1dda6 in Rf_eval (e=0x4cd1048, rho=0x488ca48) at
>> eval.c:461
>> #6 ?0x00002b499ca21720 in do_for (call=0x4cd1160, op=0x4868540,
>> args=0x4cd1128, rho=0x488ca48) at eval.c:1073
>> #7 ?0x00002b499ca1dda6 in Rf_eval (e=0x4cd1160, rho=0x488ca48) at
>> eval.c:461
>> #8 ?0x00002b499ca1ea82 in do_begin (call=0x4cd1198, op=0x486a830,
>> args=0x4cd11d0, rho=0x488ca48) at eval.c:1174
>> #9 ?0x00002b499ca1dda6 in Rf_eval (e=0x4cd1198, rho=0x488ca48) at
>> eval.c:461
>> #10 0x00002b499ca22494 in do_eval (call=0x49893f8, op=0x487ed08,
>> args=<value optimized out>, rho=0x511ec40) at eval.c:1752
>> #11 0x00002b499ca4b74e in do_internal (call=<value optimized out>,
>> op=<value optimized out>, args=<value optimized out>, env=0x511ec40) at
>> names.c:1140
>> #12 0x00002b499ca1dda6 in Rf_eval (e=0x4987c90, rho=0x511ec40) at
>> eval.c:461
>> #13 0x00002b499ca200c1 in Rf_applyClosure (call=0x4ccfca0, op=0x4988080,
>> arglist=0x511ed20, rho=0x488ca48, suppliedenv=0x488ca80) at eval.c:667
>> #14 0x00002b499ca1dc78 in Rf_eval (e=0x4ccfca0, rho=0x488ca48) at
>> eval.c:505
>> #15 0x0000000000401412 in main (argc=1, argv=0x7fff9e67c358) at
>> fugu.cc:126
>>
>>
>> To compile:
>> g++ -g -O0 `R CMD config --cppflags` `R CMD config --ldflags` fugu.cc
>>
>> //////////////
>> //CODE:
>> /////////////
>> #include <iostream>
>>
>> #define R_NO_REMAP
>> #include <Rversion.h>
>> #include <R.h>
>> #include <Rdefines.h>
>> #include <Rinternals.h>
>> #include <Rinterface.h>
>> #include <Rembedded.h>
>> #include <R_ext/Boolean.h>
>> #include <R_ext/Parse.h>
>> #include <R_ext/Rdynload.h>
>> const int i___ = 1;
>> #define is_bigendian() ( (*(char*)&i___) == 0 )
>>
>> extern void (*ptr_R_ShowMessage)(const char *);
>> extern void (*ptr_R_WriteConsole)(const char *, int);
>> extern int ?(*ptr_R_ReadConsole)(char *, unsigned char *, int, int);
>> extern void (*ptr_R_WriteConsoleEx)(const char *, int , int );
>> SEXP rh_status(SEXP);
>> static uint8_t SET_STATUS = 0x02;
>>
>> static R_CallMethodDef callMethods [] = {
>> ?{"rh_status",(DL_FUNC)&rh_status,1},
>> ?{NULL, NULL, 0}
>> };
>>
>> uint32_t reverseUInt (uint32_t i) {
>> ? uint8_t c1, c2, c3, c4;
>>
>> ? if (is_bigendian()) {
>> ? ? ? return i;
>> ? } else {
>> ? ? ? c1 = i & 255;
>> ? ? ? c2 = (i >> 8) & 255;
>> ? ? ? c3 = (i >> 16) & 255;
>> ? ? ? c4 = (i >> 24) & 255;
>>
>> ? ? ? return ((uint32_t)c1 << 24) + ((uint32_t)c2 << 16) + ((uint32_t)c3
>> << 8) + c4;
>> ? }
>> }
>>
>>
>> SEXP rh_status(SEXP mess){
>> ?if(TYPEOF(mess)!=STRSXP){
>> ? return R_NilValue;
>> ?}
>> ?char *status = (char*)CHAR(STRING_ELT( mess , 0));
>> ?// fwrite(&SET_STATUS,sizeof(uint8_t),1,stderr);
>> ?// uint32_t stle = strlen(status);
>> ?// uint32_t len_rev = ?reverseUInt(stle);
>> ?// fwrite(&len_rev,sizeof(uint32_t),1,stderr);
>> ?// fwrite(status,stle,1,stderr);
>> }
>>
>> SEXP rexpress(const char* cmd)
>> {
>> ?SEXP cmdSexp, cmdexpr, ans = R_NilValue;
>> ?int i,Rerr;
>> ?ParseStatus status;
>> ?PROTECT(cmdSexp = Rf_allocVector(STRSXP, 1));
>> ?SET_STRING_ELT(cmdSexp, 0, Rf_mkChar(cmd));
>> ?cmdexpr = PROTECT(R_ParseVector(cmdSexp, -1, &status, R_NilValue));
>> ?if (status != PARSE_OK) {
>> ? UNPROTECT(2);
>> ? return(R_NilValue);
>> ?}
>> ?for(i = 0; i < Rf_length(cmdexpr); i++)
>> ? ans = R_tryEval(VECTOR_ELT(cmdexpr, i),NULL,&Rerr);
>> ?UNPROTECT(2);
>> ?return(ans);
>> }
>>
>>
>> int embedR(int argc, char **argv){
>> ?structRstart rp;
>> ?Rstart Rp = &rp;
>> ?R_DefParams(Rp);
>> ?Rp->NoRenviron = 0;
>> ?Rp->R_Interactive = (Rboolean)1;
>> ?R_SetParams(Rp);
>> ?R_SignalHandlers=0;
>> ?if (!getenv("R_HOME")) {
>> ? fprintf(stderr, "R_HOME is not set. Please set all required environment
>> variables before running this program.\n");
>> ? return(-1);
>> ?}
>> ?int stat= Rf_initialize_R(argc,(char **) argv);
>> ?if (stat<0) {
>> ? fprintf(stderr,"Failed to initialize embedded R!:%d\n",stat);
>> ? return(-2);
>> ?}
>> ?R_Outputfile = NULL;
>> ?R_Consolefile = NULL;
>> ?R_Interactive = (Rboolean)1;
>> ?// ptr_R_ShowMessage = Re_ShowMessage;
>> ?// ptr_R_WriteConsoleEx =Re_WriteConsoleEx;
>>
>> ?// ptr_R_WriteConsole = NULL;
>> ?// ptr_R_ReadConsole = NULL;
>>
>> ?return(0);
>> }
>>
>> int main(int argc, char **argv){
>> ?if (embedR(argc,argv))
>> ? ? exit(1);
>> ?setup_Rmainloop();
>> ?DllInfo *info = R_getEmbeddingDllInfo();
>> ?R_registerRoutines(info, NULL, callMethods, NULL, NULL);
>> ?SEXP runner1,runner2;
>>
>> ?PROTECT(runner1=rexpress("expression({ for(x in 1:5){
>> .Call('rh_status','x') ?}})"));
>> ?if (runner1 == R_NilValue){
>> ? ? UNPROTECT(1);
>> ? ? exit(1);
>> ?}
>> ?PROTECT(runner2=Rf_lang2(Rf_install("eval"),runner1));
>> ?if(runner2==NILSXP){
>> ? UNPROTECT(2);
>> ? exit(1);
>> ?}
>> ?int mapbuf_cnt = 0;
>> ?for(;;){
>> ? if(mapbuf_cnt >1000000) exit(0);
>> ? Rf_eval(runner2 ,R_GlobalEnv);
>> ? mapbuf_cnt++;
>> ?}
>> ?UNPROTECT(2);
>> }
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
>


From gmbecker at ucdavis.edu  Fri Sep  4 07:46:37 2009
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Thu, 3 Sep 2009 22:46:37 -0700
Subject: [Rd] Missing warning when NAs are generated during coercion to
	complex
Message-ID: <c797fbfb0909032246q239f584cw8e799ec7757bcdd4@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090903/29a123b3/attachment.pl>

From gmbecker at ucdavis.edu  Fri Sep  4 07:50:09 2009
From: gmbecker at ucdavis.edu (gmbecker at ucdavis.edu)
Date: Fri,  4 Sep 2009 07:50:09 +0200 (CEST)
Subject: [Rd] Missing warning when NAs are generated during coercion to
	complex (PR#13942)
Message-ID: <20090904055009.E3AF4282EF4F@mail.pubhealth.ku.dk>

Hello all,

I ran into this today and just thought you guys should know about it.
Consider the following:

as(c("TRUE", "TRUE"), "complex") #warning about NAs
as(list("TRUE", "TRUE"), "complex") #no warning

At first I thought that it was something about it being a list, but then I
tried

as(list("TRUE", "TRUE"), "integer") #warning about NAs

which suggests that it was an oversight. Not a critical issue (though it did
give me quite a bit of headache earlier today), but figured I should report
it.

Thanks for all your hard work.

Gabe

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Fri Sep  4 10:22:13 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 04 Sep 2009 10:22:13 +0200
Subject: [Rd] Including a binary Python Interpreter into a
 binary	R-package for	MS Windows
In-Reply-To: <200909032241.n83Mf544000750@smtp1.infopact.nl>
References: <200909032241.n83Mf544000750@smtp1.infopact.nl>
Message-ID: <4AA0CE35.6070102@statistik.tu-dortmund.de>



Guido van Steen wrote:
> Sorry: I sent this email to R-devel at R-project.COM. So that it got bounced.
> 
> Hi Uwe, 
> 
> Thanks a lot for this answer. 
> 
>> Don't know Python on Windows so well, but why can't they
>> install it? You can also install R with limited user
>> privileges.
> 
> The last time I worked with Python on MS Windows was about 10 years ago. From that time I remember that you needed administrative privileges to install Python (1.5). For some reason this idea got stuck in my mind. I have just tried an ordinary user-install of Python 2.6.2 within a Virtual Machine (XP). I experienced no problems at all. So, you are right: this user-rights argument is invalid. 
> 
>> Well, but much of that space is useless/wasted for
>> non-Windows users then.
> 
> This gave me to the idea to create a package with a slightly different name. It would be an MS Windows only package.  

I see.


>> Most R users under Windows won't have Rtools installed,
>> just the developers will have.
> 
> I did not know that. So I guess many R users also miss the Perl dependent scripts. 

Right.


>> Can't you add some configure script / Makefile that allows
>> to build the binary from sources that you provide in your
>> package?
> 
> Well, that would make the package really bloated. I would first have to build the MinGW compiler, and then I would have to use MinGW to build Python. 

MinGW doesn't need to be in the package, because you do not want to ship 
the binaries.


> 
>> Otherwise, what you could do is to install the binary on 
>> demand from another side you are hosting. E.g. 
>> library("write2xls") could check if the required binary is 
>> available and install on demand if it is not available. 
> 
> This is the kind of idea I am looking for! Thanks very much! Indeed, this would circumvent the whole need of including the Python binaries in an R-package. 

... and perhaps you can even stay with one package rather than two for 
different platforms.

Best wishes,
Uwe


> I also like Gabor's idea to run Python scripts from Jython. As he explained, this makes Python available to anyone with access to Java. This might also be acceptable for those users who abhor binary downloads in general. On the other hand it might make the package slow because of longer loading times. 
> 
>> If MIT allows to ship things the way you plan to, then it's
>> fine, but no binaries in sources packages on CRAN. We did
>> quite some work to get rid of the packages that did (even my
>> own package!) and won't make exceptions. We won't revert our
>> decision.
> 
> Very good! I fully support the decision! 
> 
> Best wishes, 
> 
> Guido
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From maechler at stat.math.ethz.ch  Fri Sep  4 10:25:42 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 4 Sep 2009 10:25:42 +0200
Subject: [Rd] Documentation for is.atomic and is.recursive
In-Reply-To: <f8e6ff050909021202g6c16d013rc1698b2170cd041d@mail.gmail.com>
References: <8b356f880909021139pa07d922q1f1c28a0fb70cdbe@mail.gmail.com>
	<8b356f880909021154r22b8d14ajd7627fcf3263b444@mail.gmail.com>
	<f8e6ff050909021202g6c16d013rc1698b2170cd041d@mail.gmail.com>
Message-ID: <19104.52998.926010.520146@lynne.math.ethz.ch>

>>>>> "hw" == hadley wickham <h.wickham at gmail.com>
>>>>>     on Wed, 2 Sep 2009 14:02:06 -0500 writes:

    hw> On Wed, Sep 2, 2009 at 1:54 PM, Stavros
    hw> Macrakis<macrakis at alum.mit.edu> wrote:
    >> On Wed, Sep 2, 2009 at 2:39 PM, Stavros
    >> Macrakis<macrakis at alum.mit.edu> wrote:
    >> 
    >>> ???? Most types of language objects are regarded as
    >>> recursive: those ???? which are not are the atomic
    >>> vector types, 'NULL' and symbols (as ???? given by
    >>> 'as.name').
    >>> 
    >>> But is.recursive(as.name('foo')) ==
    >>> is.recursive(quote(foo)) == FALSE.
    >> 
    >> Sorry, this *is* consistent with the behavior. ?But if we
    >> read "the atomic vector types, 'NULL' and symbols" as a
    >> list of mutually exclusive categories, then
    >> is.atomic(NULL)==FALSE is inconsistent.

    hw> And the sentence could be more clearly written as:

    hw> Most types of language objects are regarded as
    hw> recursive, except for atomic vector types, 'NULL' and
    hw> symbols (as given by 'as.name').

yes, that's a shorter and more elegant.
But before amending that,  why 
"language objects" instead of just "R objects" or "objects" ?
  
In the context of S and R when I'd hear  "language objects",
I'd think of the results of
    expression() , formula(), substitute(), quote()
i.e., objects for which  is.language() was true.

So, I'm proposing

  Most types of objects are regarded as recursive, except for
  atomic vector types, \code{NULL} and symbols (as given by
  \code{\link{as.name}}).

--
Martin Maechler


From paterno at fnal.gov  Fri Sep  4 04:45:12 2009
From: paterno at fnal.gov (paterno at fnal.gov)
Date: Fri,  4 Sep 2009 04:45:12 +0200 (CEST)
Subject: [Rd] Apparent bug in summaryBy (PR#13941)
Message-ID: <20090904024513.0B5F9282EF4F@mail.pubhealth.ku.dk>

Full_Name: Marc Paterno
Version: 2.9.2
OS: Mac OS X 10.5.8
Submission from: (NULL) (99.53.212.55)


summaryBy() produces incorrect results when given some data  frames. Below is a
transcript of a session showing the result, in a data frame with 2 observations
of 2 variables.
-------------------
thomas:999 paterno$ R --vanilla

R version 2.9.2 (2009-08-24)
Copyright (C) 2009 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(doBy)
> tmp = read.table("moduledata_999_1.txt",header=FALSE)
> str(tmp)
'data.frame':	2 obs. of  2 variables:
 $ V1: Factor w/ 2 levels "b","c": 2 1
 $ V2: num  1 2
> tmp
  V1 V2
1  c  1
2  b  2
> summaryBy(V2~V1,tmp)
  V1 V2.mean
1  b       1
2  c       2


From marcin at galton.uchicago.edu  Fri Sep  4 07:58:54 2009
From: marcin at galton.uchicago.edu (Marcin Hitczenko)
Date: Fri, 4 Sep 2009 00:58:54 -0500 (CDT)
Subject: [Rd] calling Lapack and BLAS routines from C
Message-ID: <51649.207.181.247.22.1252043934.squirrel@galton.uchicago.edu>

Hi,

I am working on a UNIX machine and I am interfacing R and C with the .C
function. I am trying to call LAPACK and BLAS routines, but am running
into a problem where, while I am able to run the BLAS routines, I cannot
run the LAPACK routines.

I compile my .c file (at end of email) in the following way:

[mhitczen at jlogin2 ~/Cstuff]$ R CMD SHLIB testmore.c

gcc -std=gnu99 -I/home/mhitczen/R-2.9.0/include  -I/usr/local/include   
-fpic  -g -O2 -c testmore.c -o testmore.o
gcc -std=gnu99 -shared -L/usr/local/lib -o testmore.so testmore.o

However, I get the following error in R:

> dyn.load("testmore.so")
Error in dyn.load("testmore.so") :
  unable to load shared library '/home/mhitczen/Cstuff/testmore.so':
/home/mhitczen/Cstuff/testmore.so: undefined symbol: dpotrf_

This error goes away and everything works when I simply call the BLAS
routine (In the testmore.c file I simply remove funct2, leaving funct
which calls the routine "dgemm" found in the BLAS.h file).

I read the "Writing R Extensions" and created a file:
/R-2.9.0/src/Makevars that contains the line:
PKG_LIBS = $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)

What am I doing wrong? Thanks for your time and effort.

My testmore.c file is:

#include <Rinternals.h>
#include <Rmath.h>
#include <R.h>
#include <R_ext/Applic.h>
#include <R_ext/Lapack.h>
#include <R_ext/BLAS.h>
#include <R_ext/RS.h>

// FUNCTION CALLING BLAS
void funct(double *x, int *dim, double *y, double *result){

  double one=1.0; double zero =0.0;
  char *transa="N"; char *transb="N";

  F77_CALL(dgemm)
(transa,transb,dim,dim,dim,&one,x,dim,y,dim,&zero,result,dim);
}

// FUNCTION CALLING LAPACK
void funct4(double *x, int *dim, double *result){

  char *UorL="L";
  int info=0;

  F77_CALL(dpotrf)(UorL,dim,x,dim, &info);
}



Best,

Marcin Hitczenko


From htl10 at users.sourceforge.net  Thu Sep  3 17:30:15 2009
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Thu, 3 Sep 2009 15:30:15 +0000 (GMT)
Subject: [Rd] building r packages for windows on a mac/linux
In-Reply-To: <13c5a0ae0909022240q1a2a2cf0s85da02c8e027fcaf@mail.gmail.com>
Message-ID: <642085.92023.qm@web23107.mail.ird.yahoo.com>

--- On Thu, 3/9/09, Vinh Nguyen <vinhdizzo at gmail.com> wrote:

> hi hin-tak,
> 
> i'm trying to build r packages for windows on a
> mac/linux.  i guess
> this used to possible and supported, but is no longer
> supported.  i
> ran into this post of yours,
> https://stat.ethz.ch/pipermail/r-devel/2009-July/053971.html,
> and hope
> u don't mind me emailing you.
> 
> how did you set up your system to do this sort of
> thing?  i guess the
> only thing i don't get from your post is
> <win32_R_top>.  what does
> this refer to?  i do have mingw for macs, taken from
> http://crossgcc.rts-software.org/doku.php
> .  i tried compiling a
> package using your method but it didn't work, couldn't find
> things
> such as R.h.  i'm pretty sure it is the
> <win32_R_top> because i don't
> know what you are referring to with this.
> 
> i tried building R using mingw, but i got to the following
> error:
> sh: ../../../bin/Rterm.exe: cannot execute binary file
> make[2]: *** [all] Error 126
> make[1]: *** [R] Error 1
> make: *** [all] Error 2
> 
> can you guide me in the right direction?  thanks.

<win32_R_top> stands for 'windows R top directory' - you need both native R and win32 R to cross-compile R packages. (native R for executing R code, win32 R for its R.dll for the cross-compiler's linker to resolve symbols) Go back to R 2.8.x and study the cross-compile instructions and make sure that works, before attempting cross-compile with R 2.9.x .

FWIW, I just built win32 snpMatrix against R 2.9.2 last week and released that, and also managed to build the chm windows-help file for the first time.. These days, R packages for different platform only differ by the dll/so (and to a lesser extent, things like the chm file) so you just need to build the dll/so to go from one platform to another. chm file building is documented by others. 






From htl10 at users.sourceforge.net  Fri Sep  4 00:20:32 2009
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Thu, 3 Sep 2009 22:20:32 +0000 (GMT)
Subject: [Rd] building r packages for windows on a mac/linux
In-Reply-To: <13c5a0ae0909031501w79e1d90fmfaadd2191e929dea@mail.gmail.com>
Message-ID: <874077.1460.qm@web23102.mail.ird.yahoo.com>

--- On Thu, 3/9/09, Vinh Nguyen <vinhdizzo at gmail.com> wrote:

> hmmm....tried building R-2.8.0 on my
> mac, didn't work.  i think it got
> the very end before failing:
> i386-mingw32-windres --preprocessor="i386-mingw32-gcc -E
> -xc
> -DRC_INVOKED" -I
> /Users/vinh/Downloads/Rwin/R-2.8.0/include  -I 
> -i
> methods_res.rc -o methods_res.o
> i386-mingw32-gcc  -std=gnu99  -shared -s  -o
> methods.dll methods.def
> class_support.o do_substitute_direct.o init.o
> methods_list_dispatch.o
> slot.o tests.o methods_res.o 
> -L/Users/vinh/Downloads/Rwin/R-2.8.0/bin
>    -lR
>   ... DLL made
>   installing DLL
>   collecting R files
>   preparing package methods for lazy loading
>   dumping R code in package `methods'
> cp:
> /Library/Frameworks/R.framework/Resources/library/methods/libs/methods.so:
> No such file or directory
> make[4]: ***
> [/Users/vinh/Downloads/Rwin/R-2.8.0/library/methods/R/methods.rdb]
> Error 1
> make[3]: *** [all] Error 2
> make[2]: *** [pkg-methods] Error 2
> make[1]: *** [rpackage] Error 1
> make: *** [all] Error 2

It is probably wiser to use the last of 2.8 (i.e. 2.8.1patched)

That seems to be buggy - anyhow, I said to build win32 R package you need to have the win32 R.dll, I don't mean you have to build it yourself. You can just take it out of the official win32 R installer.

> 
> if i go to bin/R.exe, my wine opens R fine.  so i
> think this is OK.
> my ultimate goal would be to build a package for
> windows.  looking
> through the admin file, i don't understand how i would do
> this (even
> if i didn't get that previous error).  could u kindly
> point me in the
> direction of how to do this?  make what?

The instruction for cross-compiling R packages is in a file called "README.packages" or some such under src/gnuwin32 . The file was removed in R 2.9.x (as the content is no longer supported).

BTW, you have not shown your affiliation nor the reason why you want to go this way - and I am reluctant to do one-on-one hand-holding on annonymity. So please keep the CC:, or arrange for commercial consultancy.


    

From Friedrich.Leisch at stat.uni-muenchen.de  Fri Sep  4 11:04:20 2009
From: Friedrich.Leisch at stat.uni-muenchen.de (Friedrich Leisch)
Date: Fri, 4 Sep 2009 11:04:20 +0200
Subject: [Rd] Suggestion: Allow packages to add additional
	information	to sessionInfo()
In-Reply-To: <59d7961d0909031110w64b2df4en48e99c8ea5aeca1e@mail.gmail.com>
References: <59d7961d0909031005p676b5fe8m4878c1149c22dad6@mail.gmail.com>
	<971536df0909031016t2658cc1dl98c11d597cb3066c@mail.gmail.com>
	<59d7961d0909031027t5ec2d0f5u707a140dcd3d6474@mail.gmail.com>
	<4A9FFF14.8010800@mdacc.tmc.edu>
	<59d7961d0909031110w64b2df4en48e99c8ea5aeca1e@mail.gmail.com>
Message-ID: <19104.55316.569815.523978@ridcully.stat.uni-muenchen.de>

>>>>> On Thu, 3 Sep 2009 11:10:31 -0700,
>>>>> Henrik Bengtsson (HB) wrote:

  > On Thu, Sep 3, 2009 at 10:38 AM, Kevin R.
  > Coombes<krcoombes at mdacc.tmc.edu> wrote:
  >> [1] I agree that sessionInfo() can be taken further.
  >> [2] I even more strongly agree that it would be a bad idea to allow packages
  >> to add features that cause the base sessionInfo() function to fail.
  >> 
  >> Why not add an extra function called something like "packageSessionInfo()"
  >> that would provide the desired hooks but keep them from breaking the base
  >> functionality?

  > The point is that (if so) there should only be *one function* to call
  > for all packages, not one per package, because that would be a pain
  > due to dependencies.  But, sure I'm happy to start with a
  > package[s]SessionInfo() such that

  > c(sessionInfo(), extras=packagesSessionInfo())

  > pretty much return what I wish. Then it might be easier to argue for
  > incorporating the above in sessionInfo() ;)

  > Sorry for not getting it, but I still don't see how adding extra
  > information would break the base functionality?  Can you give some
  > examples?

  > As I said, timeouts can be a problem and possibly also if the hook
  > functions have side effects that, say, would load new packages, could
  > give funny results, but I also think a package developer who is
  > capable to setting up hook function would no how to avoid this.

  > With the default argument of 'extras' to be FALSE, sessionInfo() would
  > work as now, with the extra feature that 'extras=TRUE' can give lots
  > of additional useful information.

I think the concept of hook functions for sessionInfo() makes absolute
sense. Yes it should be optional to run them, but the default should
be pkghooks=TRUE, because I don't see why they shouldn't run OK in
99.9% of all cases. If a hook doesn't run on a certain platform that
would be a bug to me and need to be fixed. Could those who seem to
think such hooks are not a good idea elaborate on what the "danger"
really is? 

Best,
Fritz


From ripley at stats.ox.ac.uk  Fri Sep  4 11:10:27 2009
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 4 Sep 2009 10:10:27 +0100 (BST)
Subject: [Rd] calling Lapack and BLAS routines from C
In-Reply-To: <51649.207.181.247.22.1252043934.squirrel@galton.uchicago.edu>
References: <51649.207.181.247.22.1252043934.squirrel@galton.uchicago.edu>
Message-ID: <alpine.LFD.2.00.0909041007110.32167@gannet.stats.ox.ac.uk>

On Fri, 4 Sep 2009, Marcin Hitczenko wrote:

> Hi,
>
> I am working on a UNIX machine and I am interfacing R and C with the .C
> function. I am trying to call LAPACK and BLAS routines, but am running
> into a problem where, while I am able to run the BLAS routines, I cannot
> run the LAPACK routines.
>
> I compile my .c file (at end of email) in the following way:
>
> [mhitczen at jlogin2 ~/Cstuff]$ R CMD SHLIB testmore.c
>
> gcc -std=gnu99 -I/home/mhitczen/R-2.9.0/include  -I/usr/local/include
> -fpic  -g -O2 -c testmore.c -o testmore.o
> gcc -std=gnu99 -shared -L/usr/local/lib -o testmore.so testmore.o
>
> However, I get the following error in R:
>
>> dyn.load("testmore.so")
> Error in dyn.load("testmore.so") :
>  unable to load shared library '/home/mhitczen/Cstuff/testmore.so':
> /home/mhitczen/Cstuff/testmore.so: undefined symbol: dpotrf_
>
> This error goes away and everything works when I simply call the BLAS
> routine (In the testmore.c file I simply remove funct2, leaving funct
> which calls the routine "dgemm" found in the BLAS.h file).
>
> I read the "Writing R Extensions" and created a file:
> /R-2.9.0/src/Makevars that contains the line:
> PKG_LIBS = $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS)

That is not where it tells you to put the file.  It needs to be in the 
direcctory where you run the compile (normally the 'src' directory of 
a package), and in your case that seems to be ~/Cstuff.

That BLAS works is fortuitous, depending on the way you built R.

[...]

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ligges at statistik.tu-dortmund.de  Fri Sep  4 11:12:11 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 04 Sep 2009 11:12:11 +0200
Subject: [Rd] building r packages for windows on a mac/linux
In-Reply-To: <874077.1460.qm@web23102.mail.ird.yahoo.com>
References: <874077.1460.qm@web23102.mail.ird.yahoo.com>
Message-ID: <4AA0D9EB.1040004@statistik.tu-dortmund.de>

For those who have no confidential packages without license issues, want 
to build a Windows binary but do not have Windows available: please also 
note the service provided at
http://win-builder.r-project.org/

Uwe Ligges



Hin-Tak Leung wrote:
> --- On Thu, 3/9/09, Vinh Nguyen <vinhdizzo at gmail.com> wrote:
> 
>> hmmm....tried building R-2.8.0 on my
>> mac, didn't work.  i think it got
>> the very end before failing:
>> i386-mingw32-windres --preprocessor="i386-mingw32-gcc -E
>> -xc
>> -DRC_INVOKED" -I
>> /Users/vinh/Downloads/Rwin/R-2.8.0/include  -I 
>> -i
>> methods_res.rc -o methods_res.o
>> i386-mingw32-gcc  -std=gnu99  -shared -s  -o
>> methods.dll methods.def
>> class_support.o do_substitute_direct.o init.o
>> methods_list_dispatch.o
>> slot.o tests.o methods_res.o 
>> -L/Users/vinh/Downloads/Rwin/R-2.8.0/bin
>>    -lR
>>   ... DLL made
>>   installing DLL
>>   collecting R files
>>   preparing package methods for lazy loading
>>   dumping R code in package `methods'
>> cp:
>> /Library/Frameworks/R.framework/Resources/library/methods/libs/methods.so:
>> No such file or directory
>> make[4]: ***
>> [/Users/vinh/Downloads/Rwin/R-2.8.0/library/methods/R/methods.rdb]
>> Error 1
>> make[3]: *** [all] Error 2
>> make[2]: *** [pkg-methods] Error 2
>> make[1]: *** [rpackage] Error 1
>> make: *** [all] Error 2
> 
> It is probably wiser to use the last of 2.8 (i.e. 2.8.1patched)
> 
> That seems to be buggy - anyhow, I said to build win32 R package you need to have the win32 R.dll, I don't mean you have to build it yourself. You can just take it out of the official win32 R installer.
> 
>> if i go to bin/R.exe, my wine opens R fine.  so i
>> think this is OK.
>> my ultimate goal would be to build a package for
>> windows.  looking
>> through the admin file, i don't understand how i would do
>> this (even
>> if i didn't get that previous error).  could u kindly
>> point me in the
>> direction of how to do this?  make what?
> 
> The instruction for cross-compiling R packages is in a file called "README.packages" or some such under src/gnuwin32 . The file was removed in R 2.9.x (as the content is no longer supported).
> 
> BTW, you have not shown your affiliation nor the reason why you want to go this way - and I am reluctant to do one-on-one hand-holding on annonymity. So please keep the CC:, or arrange for commercial consultancy.
> 
> 
>     
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From gvsteen at yahoo.com  Fri Sep  4 11:43:22 2009
From: gvsteen at yahoo.com (Guido van Steen)
Date: Fri, 4 Sep 2009 02:43:22 -0700 (PDT)
Subject: [Rd] Including a binary Python Interpreter into a binary
	R-package for MS Windows
In-Reply-To: <4AA0CE35.6070102@statistik.tu-dortmund.de>
Message-ID: <321267.84870.qm@web65615.mail.ac4.yahoo.com>

--- On Fri, 9/4/09, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:

> MinGW doesn't need to be in the package, because you do not
> want to ship the binaries.

I meant that I would have to include the source code of MinGW, in order to build the MinGW compiler in some writeable directory of the R-user's computer. This is because without MinGW I wouldn't be able to build PyMinGW. (PyMinGW is a version of Python that - unlike the standard version of Python - does not depend on copy-righted MS dlls.) 

> ... and perhaps you can even stay with one package rather
> than two for different platforms.

Very true!

Best wishes,

Guido


From murdoch at stats.uwo.ca  Fri Sep  4 12:25:51 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 04 Sep 2009 06:25:51 -0400
Subject: [Rd] Apparent bug in summaryBy (PR#13941)
In-Reply-To: <20090904024513.0B5F9282EF4F@mail.pubhealth.ku.dk>
References: <20090904024513.0B5F9282EF4F@mail.pubhealth.ku.dk>
Message-ID: <4AA0EB2F.8040804@stats.uwo.ca>

paterno at fnal.gov wrote:
> Full_Name: Marc Paterno
> Version: 2.9.2
> OS: Mac OS X 10.5.8
> Submission from: (NULL) (99.53.212.55)
>
>
> summaryBy() produces incorrect results when given some data  frames. Below is a
> transcript of a session showing the result, in a data frame with 2 observations
> of 2 variables.
>   

This looks like a bug in the doBy package (or something it uses), not a 
bug in R.  I've cc'd the maintainer of that package to let him know 
about it. 

By the way, an easier way to create that dataframe is simply

tmp <- data.frame(V1=c("c", "b"), V2=c(1,2))

Duncan Murdoch

> -------------------
> thomas:999 paterno$ R --vanilla
>
> R version 2.9.2 (2009-08-24)
> Copyright (C) 2009 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
>   Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
>
>   
>> library(doBy)
>> tmp = read.table("moduledata_999_1.txt",header=FALSE)
>> str(tmp)
>>     
> 'data.frame':	2 obs. of  2 variables:
>  $ V1: Factor w/ 2 levels "b","c": 2 1
>  $ V2: num  1 2
>   
>> tmp
>>     
>   V1 V2
> 1  c  1
> 2  b  2
>   
>> summaryBy(V2~V1,tmp)
>>     
>   V1 V2.mean
> 1  b       1
> 2  c       2
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From hadley at rice.edu  Fri Sep  4 15:39:12 2009
From: hadley at rice.edu (Hadley Wickham)
Date: Fri, 4 Sep 2009 08:39:12 -0500
Subject: [Rd] Load a package without installing it
Message-ID: <f8e6ff050909040639r35659a8hd00d06901093dcd1@mail.gmail.com>

Hi all,

When developing a package, it's often useful to be able to reload it,
without re-installing, re-starting R and re-loading.  To do this I've
written a little script that inspects the package description and
loads dependencies, data and code - http://gist.github.com/180883.
It's obviously not very general (being tailored to my description
files) and won't work for packages containing C code, but I hope you
might find it useful nonetheless.

Any comments would be appreciated.

Hadley

-- 
http://had.co.nz/


From romain.francois at dbmail.com  Fri Sep  4 15:46:17 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Fri, 04 Sep 2009 15:46:17 +0200
Subject: [Rd] Load a package without installing it
In-Reply-To: <f8e6ff050909040639r35659a8hd00d06901093dcd1@mail.gmail.com>
References: <f8e6ff050909040639r35659a8hd00d06901093dcd1@mail.gmail.com>
Message-ID: <4AA11A29.9000203@dbmail.com>

On 09/04/2009 03:39 PM, Hadley Wickham wrote:
>
> Hi all,
>
> When developing a package, it's often useful to be able to reload it,
> without re-installing, re-starting R and re-loading.  To do this I've
> written a little script that inspects the package description and
> loads dependencies, data and code - http://gist.github.com/180883.
> It's obviously not very general (being tailored to my description
> files) and won't work for packages containing C code, but I hope you
> might find it useful nonetheless.
>
> Any comments would be appreciated.
>
> Hadley

Nice. I would guess many of us would have versions of this, it would be 
good to formalise it so that it could deal with :
- namespaces, you might want your unexported functions to be separate 
from your exported functions. It looks like your function loads 
everything into .GlobalEnv
- S4 objects, what would happen if you re-source the definition of an S4 
class and continue to manage objects created before the resourcing

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/xMdt : update on the ant package
|- http://tr.im/xHLs : R capable version of ant
`- http://tr.im/xHiZ : Tip: get java home from R with rJava


From hadley at rice.edu  Fri Sep  4 16:21:08 2009
From: hadley at rice.edu (Hadley Wickham)
Date: Fri, 4 Sep 2009 09:21:08 -0500
Subject: [Rd] Load a package without installing it
In-Reply-To: <4AA11A29.9000203@dbmail.com>
References: <f8e6ff050909040639r35659a8hd00d06901093dcd1@mail.gmail.com> 
	<4AA11A29.9000203@dbmail.com>
Message-ID: <f8e6ff050909040721g14b6f2cap4486baf3f6407213@mail.gmail.com>

> Nice. I would guess many of us would have versions of this, it would be good
> to formalise it so that it could deal with :
> - namespaces, you might want your unexported functions to be separate from
> your exported functions. It looks like your function loads everything into
> .GlobalEnv
> - S4 objects, what would happen if you re-source the definition of an S4
> class and continue to manage objects created before the resourcing

I use neither namespaces nor S4, so it's no suprise my code doesn't
handle them ;)

Hadley

-- 
http://had.co.nz/


From hadley at rice.edu  Fri Sep  4 16:20:37 2009
From: hadley at rice.edu (Hadley Wickham)
Date: Fri, 4 Sep 2009 09:20:37 -0500
Subject: [Rd] Package tests must have extension .R?
Message-ID: <f8e6ff050909040720g5b7983a4ia8f4d10cc064342b@mail.gmail.com>

Is this intentional?  .r is accept most other places.

Hadley

-- 
http://had.co.nz/


From simon.urbanek at r-project.org  Fri Sep  4 16:20:50 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 4 Sep 2009 10:20:50 -0400
Subject: [Rd] Rscript and default packages
In-Reply-To: <4AA00253.6060101@dbmail.com>
References: <4A9FCA3E.7090501@dbmail.com> <4A9FDF87.4000801@stats.uwo.ca>
	<4AA00253.6060101@dbmail.com>
Message-ID: <E240CFC0-B5A2-423A-9911-B67240BF8A74@r-project.org>


On Sep 3, 2009, at 13:52 , Romain Francois wrote:

> On 09/03/2009 05:23 PM, Duncan Murdoch wrote:
>>
>> On 03/09/2009 9:53 AM, Romain Francois wrote:
>>> Hi,
>>>
>>> Is is possible to embed inside an R script, the name of the default
>>> packages to be loaded when the script is invoked with Rscript.
>>>
>>> I know about the --default-packages argument, but I was wondering if
>>> there was a mechanism to embed this information within the script  
>>> itself
>>
>> I don't understand what you'd want here that you don't get with  
>> attach()
>> or require(). Why does it matter if they are default?
>>
>> Duncan Murdoch
>
> Sorry for being vague. I am more interested in not loading some  
> packages:
>
> $ time Rscript  -e "#"
>
> real	0m0.224s
> user	0m0.188s
> sys	0m0.032s
>
>
> $ time Rscript --default-packages="base" -e "#"
>
> real	0m0.067s
> user	0m0.033s
> sys	0m0.016s
>
>
> $ time r -e "#"
>
> real	0m0.039s
> user	0m0.032s
> sys	0m0.006s
>
> This is related to the "How to ship R scripts with R packages"  
> thread. I'd like for example to ship a script that I know only  
> requires the "base" package. How would I specify this from within  
> the script.
>

Well, what's wrong with:

#!/usr/bin/Rscript --default-packages=base

ginaz:sandbox$ time ./scr

real	0m0.045s
user	0m0.027s
sys	0m0.017s

.. as opposed to

#!/usr/bin/Rscript --default-packages=base

ginaz:sandbox$ time ./scr

real	0m0.201s
user	0m0.166s
sys	0m0.034s

Cheers,
Simon


From ggrothendieck at gmail.com  Fri Sep  4 16:25:25 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 4 Sep 2009 10:25:25 -0400
Subject: [Rd] Load a package without installing it
In-Reply-To: <f8e6ff050909040639r35659a8hd00d06901093dcd1@mail.gmail.com>
References: <f8e6ff050909040639r35659a8hd00d06901093dcd1@mail.gmail.com>
Message-ID: <971536df0909040725r481a7425r23f947749dac41bb@mail.gmail.com>

This is sufficiently useful that it would be nice to have it
as part of R itself.  For the moment, perhaps you could
make a package of it on CRAN or contribute it to some
other existing CRAN package.

On Fri, Sep 4, 2009 at 9:39 AM, Hadley Wickham<hadley at rice.edu> wrote:
> Hi all,
>
> When developing a package, it's often useful to be able to reload it,
> without re-installing, re-starting R and re-loading. ?To do this I've
> written a little script that inspects the package description and
> loads dependencies, data and code - http://gist.github.com/180883.
> It's obviously not very general (being tailored to my description
> files) and won't work for packages containing C code, but I hope you
> might find it useful nonetheless.
>
> Any comments would be appreciated.
>
> Hadley
>
> --
> http://had.co.nz/
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From murdoch at stats.uwo.ca  Fri Sep  4 16:42:48 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 04 Sep 2009 10:42:48 -0400
Subject: [Rd] Rscript and default packages
In-Reply-To: <E240CFC0-B5A2-423A-9911-B67240BF8A74@r-project.org>
References: <4A9FCA3E.7090501@dbmail.com> <4A9FDF87.4000801@stats.uwo.ca>
	<4AA00253.6060101@dbmail.com>
	<E240CFC0-B5A2-423A-9911-B67240BF8A74@r-project.org>
Message-ID: <4AA12768.9000008@stats.uwo.ca>

On 9/4/2009 10:20 AM, Simon Urbanek wrote:
> On Sep 3, 2009, at 13:52 , Romain Francois wrote:
> 
>> On 09/03/2009 05:23 PM, Duncan Murdoch wrote:
>>>
>>> On 03/09/2009 9:53 AM, Romain Francois wrote:
>>>> Hi,
>>>>
>>>> Is is possible to embed inside an R script, the name of the default
>>>> packages to be loaded when the script is invoked with Rscript.
>>>>
>>>> I know about the --default-packages argument, but I was wondering if
>>>> there was a mechanism to embed this information within the script  
>>>> itself
>>>
>>> I don't understand what you'd want here that you don't get with  
>>> attach()
>>> or require(). Why does it matter if they are default?
>>>
>>> Duncan Murdoch
>>
>> Sorry for being vague. I am more interested in not loading some  
>> packages:
>>
>> $ time Rscript  -e "#"
>>
>> real	0m0.224s
>> user	0m0.188s
>> sys	0m0.032s
>>
>>
>> $ time Rscript --default-packages="base" -e "#"
>>
>> real	0m0.067s
>> user	0m0.033s
>> sys	0m0.016s
>>
>>
>> $ time r -e "#"
>>
>> real	0m0.039s
>> user	0m0.032s
>> sys	0m0.006s
>>
>> This is related to the "How to ship R scripts with R packages"  
>> thread. I'd like for example to ship a script that I know only  
>> requires the "base" package. How would I specify this from within  
>> the script.
>>
> 
> Well, what's wrong with:
> 
> #!/usr/bin/Rscript --default-packages=base
> 
> ginaz:sandbox$ time ./scr
> 
> real	0m0.045s
> user	0m0.027s
> sys	0m0.017s
> 
> .. as opposed to
> 
> #!/usr/bin/Rscript --default-packages=base
> 
> ginaz:sandbox$ time ./scr
> 
> real	0m0.201s
> user	0m0.166s
> sys	0m0.034s

Windows doesn't support the #! invocation, but that should work on all 
the other systems that would use scripts.

Duncan Murdoch


From romain.francois at dbmail.com  Fri Sep  4 16:40:43 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Fri, 04 Sep 2009 16:40:43 +0200
Subject: [Rd] Rscript and default packages
In-Reply-To: <E240CFC0-B5A2-423A-9911-B67240BF8A74@r-project.org>
References: <4A9FCA3E.7090501@dbmail.com> <4A9FDF87.4000801@stats.uwo.ca>
	<4AA00253.6060101@dbmail.com>
	<E240CFC0-B5A2-423A-9911-B67240BF8A74@r-project.org>
Message-ID: <4AA126EB.50303@dbmail.com>

On 09/04/2009 04:20 PM, Simon Urbanek wrote:
>
>
> On Sep 3, 2009, at 13:52 , Romain Francois wrote:
>
>> On 09/03/2009 05:23 PM, Duncan Murdoch wrote:
>>>
>>> On 03/09/2009 9:53 AM, Romain Francois wrote:
>>>> Hi,
>>>>
>>>> Is is possible to embed inside an R script, the name of the default
>>>> packages to be loaded when the script is invoked with Rscript.
>>>>
>>>> I know about the --default-packages argument, but I was wondering if
>>>> there was a mechanism to embed this information within the script
>>>> itself
>>>
>>> I don't understand what you'd want here that you don't get with attach()
>>> or require(). Why does it matter if they are default?
>>>
>>> Duncan Murdoch
>>
>> Sorry for being vague. I am more interested in not loading some packages:
>>
>> $ time Rscript -e "#"
>>
>> real 0m0.224s
>> user 0m0.188s
>> sys 0m0.032s
>>
>>
>> $ time Rscript --default-packages="base" -e "#"
>>
>> real 0m0.067s
>> user 0m0.033s
>> sys 0m0.016s
>>
>>
>> $ time r -e "#"
>>
>> real 0m0.039s
>> user 0m0.032s
>> sys 0m0.006s
>>
>> This is related to the "How to ship R scripts with R packages" thread.
>> I'd like for example to ship a script that I know only requires the
>> "base" package. How would I specify this from within the script.
>>
>
> Well, what's wrong with:

Great. Just a bit of work to generate the shebang line at INSTALL time 
(Rscript is at /usr/local/bin on my machine).

... or perhaps I could use #!/bin/env

> #!/usr/bin/Rscript --default-packages=base
>
> ginaz:sandbox$ time ./scr
>
> real 0m0.045s
> user 0m0.027s
> sys 0m0.017s
>
> .. as opposed to
>
> #!/usr/bin/Rscript --default-packages=base
>
> ginaz:sandbox$ time ./scr
>
> real 0m0.201s
> user 0m0.166s
> sys 0m0.034s
>
> Cheers,
> Simon


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/xMdt : update on the ant package
|- http://tr.im/xHLs : R capable version of ant
`- http://tr.im/xHiZ : Tip: get java home from R with rJava


From mtmorgan at fhcrc.org  Fri Sep  4 16:50:25 2009
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Fri, 04 Sep 2009 07:50:25 -0700
Subject: [Rd] Suggestion: Allow packages to add additional	information
 to sessionInfo()
In-Reply-To: <19104.55316.569815.523978@ridcully.stat.uni-muenchen.de>
References: <59d7961d0909031005p676b5fe8m4878c1149c22dad6@mail.gmail.com>	<971536df0909031016t2658cc1dl98c11d597cb3066c@mail.gmail.com>	<59d7961d0909031027t5ec2d0f5u707a140dcd3d6474@mail.gmail.com>	<4A9FFF14.8010800@mdacc.tmc.edu>	<59d7961d0909031110w64b2df4en48e99c8ea5aeca1e@mail.gmail.com>
	<19104.55316.569815.523978@ridcully.stat.uni-muenchen.de>
Message-ID: <4AA12931.9030703@fhcrc.org>

Friedrich Leisch wrote:
>>>>>> On Thu, 3 Sep 2009 11:10:31 -0700,
>>>>>> Henrik Bengtsson (HB) wrote:
> 
>   > On Thu, Sep 3, 2009 at 10:38 AM, Kevin R.
>   > Coombes<krcoombes at mdacc.tmc.edu> wrote:
>   >> [1] I agree that sessionInfo() can be taken further.
>   >> [2] I even more strongly agree that it would be a bad idea to allow packages
>   >> to add features that cause the base sessionInfo() function to fail.
>   >> 
>   >> Why not add an extra function called something like "packageSessionInfo()"
>   >> that would provide the desired hooks but keep them from breaking the base
>   >> functionality?
> 
>   > The point is that (if so) there should only be *one function* to call
>   > for all packages, not one per package, because that would be a pain
>   > due to dependencies.  But, sure I'm happy to start with a
>   > package[s]SessionInfo() such that
> 
>   > c(sessionInfo(), extras=packagesSessionInfo())
> 
>   > pretty much return what I wish. Then it might be easier to argue for
>   > incorporating the above in sessionInfo() ;)
> 
>   > Sorry for not getting it, but I still don't see how adding extra
>   > information would break the base functionality?  Can you give some
>   > examples?
> 
>   > As I said, timeouts can be a problem and possibly also if the hook
>   > functions have side effects that, say, would load new packages, could
>   > give funny results, but I also think a package developer who is
>   > capable to setting up hook function would no how to avoid this.
> 
>   > With the default argument of 'extras' to be FALSE, sessionInfo() would
>   > work as now, with the extra feature that 'extras=TRUE' can give lots
>   > of additional useful information.
> 
> I think the concept of hook functions for sessionInfo() makes absolute
> sense. Yes it should be optional to run them, but the default should
> be pkghooks=TRUE, because I don't see why they shouldn't run OK in
> 99.9% of all cases. If a hook doesn't run on a certain platform that
> would be a bug to me and need to be fixed. Could those who seem to
> think such hooks are not a good idea elaborate on what the "danger"
> really is? 

In Bioconductor sessionInfo() is an essential tool for basic problem
diagnosis. Very often the culprit is a mismatch between package
versions, which are easy to spot because Bioconductor package versions
are incremented with each R release. So a brief sessionInfo() is really
good. Also, the typical exchange is 'this is my problem' 'sounds like a
package version mismatch, what is your sessionInfo()?' 'this is my
sessionInfo()' 'package x is out of date, follow the directions here...'
though sometimes the middle two steps are skipped when the user provides
sessionInfo up front.

Package dependencies in Bioconductor tend to be more complicated than on
CRAN, so a user might have a dozen loaded and attached packages.
Additional sessionInfo() for each would make it difficult to identify
the most common problem (version mismatch). Since issues are usually
with only one or two of the packages in the session, custom sessionInfo
from all would largely be irrelevant. Since the exchange typically
involves a prompt for sessionInfo() from the user, when the initial
report hints at problems with a specific package, the initial reply
might be 'what is your sessionInfo(packages="LikelyCulprit")?'. There is
also a sense in which sessionInfo() provides a useful distinction
between 'these things are R's business, to manage the search path,
locale, etc' and the business of the package maintainer.

Each Bioconductor release cycle involves maintenance of packages to
track changes in R. This will be the Achilles heal of package-specific
sessionInfo, where a well-meaning developer introduces code that becomes
incompatible in a difficult to detect way, and only rears its head at
the most important time -- when sessionInfo() would be useful for
diagnosis of problems. One not too far-fetched example from a slightly
different context was a change in the internal representation of S4
objects that caused some vignettes to print out the entire object (many
100's of pages) rather than the summary intended. Yes these are bugs,
and I guess 'package x is producing complete garbage for sessionInfo,
likely because your package is out of date. Please update your package
and provide sessionInfo again' might well serve to address the user's
original problem, but it would have been better to spot the outdated
package by looking at the version number produced by sessionInfo().

Martin Morgan

> Best,
> Fritz
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From simon.urbanek at r-project.org  Fri Sep  4 16:53:54 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 4 Sep 2009 10:53:54 -0400
Subject: [Rd] Rscript and default packages
In-Reply-To: <E240CFC0-B5A2-423A-9911-B67240BF8A74@r-project.org>
References: <4A9FCA3E.7090501@dbmail.com> <4A9FDF87.4000801@stats.uwo.ca>
	<4AA00253.6060101@dbmail.com>
	<E240CFC0-B5A2-423A-9911-B67240BF8A74@r-project.org>
Message-ID: <AF4107DE-A28C-4EA4-8F78-4A30EF5317B4@r-project.org>


On Sep 4, 2009, at 10:20 , Simon Urbanek wrote:

>
> On Sep 3, 2009, at 13:52 , Romain Francois wrote:
>
>> On 09/03/2009 05:23 PM, Duncan Murdoch wrote:
>>>
>>> On 03/09/2009 9:53 AM, Romain Francois wrote:
>>>> Hi,
>>>>
>>>> Is is possible to embed inside an R script, the name of the default
>>>> packages to be loaded when the script is invoked with Rscript.
>>>>
>>>> I know about the --default-packages argument, but I was wondering  
>>>> if
>>>> there was a mechanism to embed this information within the script  
>>>> itself
>>>
>>> I don't understand what you'd want here that you don't get with  
>>> attach()
>>> or require(). Why does it matter if they are default?
>>>
>>> Duncan Murdoch
>>
>> Sorry for being vague. I am more interested in not loading some  
>> packages:
>>
>> $ time Rscript  -e "#"
>>
>> real	0m0.224s
>> user	0m0.188s
>> sys	0m0.032s
>>
>>
>> $ time Rscript --default-packages="base" -e "#"
>>
>> real	0m0.067s
>> user	0m0.033s
>> sys	0m0.016s
>>
>>
>> $ time r -e "#"
>>
>> real	0m0.039s
>> user	0m0.032s
>> sys	0m0.006s
>>
>> This is related to the "How to ship R scripts with R packages"  
>> thread. I'd like for example to ship a script that I know only  
>> requires the "base" package. How would I specify this from within  
>> the script.
>>
>
> Well, what's wrong with:
>
> #!/usr/bin/Rscript --default-packages=base
>
> ginaz:sandbox$ time ./scr
>
> real	0m0.045s
> user	0m0.027s
> sys	0m0.017s
>
> .. as opposed to
>
> #!/usr/bin/Rscript --default-packages=base
>

oops, this one was actually just

#!/usr/bin/Rscript


> ginaz:sandbox$ time ./scr
>
> real	0m0.201s
> user	0m0.166s
> sys	0m0.034s
>
> Cheers,
> Simon
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From pleydell at supagro.inra.fr  Fri Sep  4 17:39:44 2009
From: pleydell at supagro.inra.fr (pleydell at supagro.inra.fr)
Date: Fri, 04 Sep 2009 17:39:44 +0200
Subject: [Rd] enabling core dumps
Message-ID: <20090904173944.et305vc9gon4480c@web.supagro.inra.fr>

"Writing R Extensions" says

{quotes}
If you have a crash which gives a core dump you can use something like

     gdb /path/to/R/bin/exec/R core.12345

to examine the core dump. If core dumps are disabled...
{unquotes}

sadly it doesn't go on to say how to enable if core dumps are disabled.

I understand that in bash I need to do

$ ulimit -c unlimited

but this doesn't seem to be enough, I still don't find a core file despite

  *** caught segfault ***
     address 0x20000028, cause 'memory not mapped'

    Possible actions:
     1: abort (with core dump)
     2: normal R exit
     3: exit R without saving workspace
     4: exit R saving workspace
     Selection: 1


I am running Ubuntu jaunty on a laptop. Any ideas as to what I might need to
configure next?

thanks
David






-- 
David Pleydell
UMR BGPI
CIRAD
TA A-54/K
Campus International de Baillarguet
34398 MONTPELLIER CEDEX 5
FRANCE
Tel: +33 4 99 62 48 65 - Secr?tariat : +33 4 99 62 48 21
Fax : +33 4 99 62 48 22
http://umr-bgpi.cirad.fr/trombinoscope/pleydell_d.htm
https://sites.google.com/site/drjpleydell/


From pleydell at supagro.inra.fr  Fri Sep  4 17:48:42 2009
From: pleydell at supagro.inra.fr (pleydell at supagro.inra.fr)
Date: Fri, 04 Sep 2009 17:48:42 +0200
Subject: [Rd] enabling core dumps
In-Reply-To: <20090904173944.et305vc9gon4480c@web.supagro.inra.fr>
References: <20090904173944.et305vc9gon4480c@web.supagro.inra.fr>
Message-ID: <20090904174842.rj5qh6kk93k8wg0k@web.supagro.inra.fr>

I forgot to add that I am compiling with

R CMD SHLIB buggyCode.c --ggdb

thanks
David




Quoting pleydell at supagro.inra.fr:

> "Writing R Extensions" says
>
> {quotes}
> If you have a crash which gives a core dump you can use something like
>
>     gdb /path/to/R/bin/exec/R core.12345
>
> to examine the core dump. If core dumps are disabled...
> {unquotes}
>
> sadly it doesn't go on to say how to enable if core dumps are disabled.
>
> I understand that in bash I need to do
>
> $ ulimit -c unlimited
>
> but this doesn't seem to be enough, I still don't find a core file despite
>
>  *** caught segfault ***
>     address 0x20000028, cause 'memory not mapped'
>
>    Possible actions:
>     1: abort (with core dump)
>     2: normal R exit
>     3: exit R without saving workspace
>     4: exit R saving workspace
>     Selection: 1
>
>
> I am running Ubuntu jaunty on a laptop. Any ideas as to what I might need to
> configure next?
>
> thanks
> David
>
>
>
>
>
>
> --
> David Pleydell
> UMR BGPI
> CIRAD
> TA A-54/K
> Campus International de Baillarguet
> 34398 MONTPELLIER CEDEX 5
> FRANCE
> Tel: +33 4 99 62 48 65 - Secr?tariat : +33 4 99 62 48 21
> Fax : +33 4 99 62 48 22
> http://umr-bgpi.cirad.fr/trombinoscope/pleydell_d.htm
> https://sites.google.com/site/drjpleydell/
>



-- 
David Pleydell
UMR BGPI
CIRAD
TA A-54/K
Campus International de Baillarguet
34398 MONTPELLIER CEDEX 5
FRANCE
Tel: +33 4 99 62 48 65 - Secr?tariat : +33 4 99 62 48 21
Fax : +33 4 99 62 48 22
http://umr-bgpi.cirad.fr/trombinoscope/pleydell_d.htm
https://sites.google.com/site/drjpleydell/


From mtmorgan at fhcrc.org  Fri Sep  4 17:56:56 2009
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Fri, 04 Sep 2009 08:56:56 -0700
Subject: [Rd] enabling core dumps
In-Reply-To: <20090904173944.et305vc9gon4480c@web.supagro.inra.fr>
References: <20090904173944.et305vc9gon4480c@web.supagro.inra.fr>
Message-ID: <4AA138C8.2010904@fhcrc.org>

pleydell at supagro.inra.fr wrote:
> "Writing R Extensions" says
> 
> {quotes}
> If you have a crash which gives a core dump you can use something like
> 
>      gdb /path/to/R/bin/exec/R core.12345
> 
> to examine the core dump. If core dumps are disabled...
> {unquotes}
> 
> sadly it doesn't go on to say how to enable if core dumps are disabled.
> 
> I understand that in bash I need to do
> 
> $ ulimit -c unlimited
> 
> but this doesn't seem to be enough, I still don't find a core file despite
> 
>   *** caught segfault ***
>      address 0x20000028, cause 'memory not mapped'
> 
>     Possible actions:
>      1: abort (with core dump)
>      2: normal R exit
>      3: exit R without saving workspace
>      4: exit R saving workspace
>      Selection: 1
> 
> 
> I am running Ubuntu jaunty on a laptop. Any ideas as to what I might need to
> configure next?

not really answering your question, but I find it more useful to

  R -d gdb

or

  R -d gdb -f test.R

where test.R reproduces the bug in some minimal code. A variant is

  R -d valgrind -f test.R

if the memory problem is not easy to spot.

Martin

> 
> thanks
> David
> 
> 
> 
> 
> 
>


From vqnguyen at uci.edu  Fri Sep  4 17:47:28 2009
From: vqnguyen at uci.edu (Vinh Nguyen)
Date: Fri, 4 Sep 2009 08:47:28 -0700
Subject: [Rd] building r packages for windows on a mac/linux
In-Reply-To: <4AA0D9EB.1040004@statistik.tu-dortmund.de>
References: <874077.1460.qm@web23102.mail.ird.yahoo.com>
	<4AA0D9EB.1040004@statistik.tu-dortmund.de>
Message-ID: <13c5a0ae0909040847y2948e24ar3e7cfb4f59157c2e@mail.gmail.com>

thank you professor Ligges for the build farm.  i was aware of it.
however, i'm just trying to learn how to build things myself.  thanks
to hin-tak, i did successfully cross build on R 2.8 on my mac.  i will
try to cross build r 2.9 next based on hin-tak's suggestions.

i don't know the exact reason why the R core team dropped support for
the cross build, but if it's because of the perceived 'lack of
demand,' i'd just like to note and show there is some demand (me), so
hopefully support will be back.

thanks.
vinh
--
This e-mail/fax message, including any attachments, is for the sole
use of the intended recipient(s) and may contain confidential and
privileged information. Any unauthorized review, use, disclosure or
distribution is prohibited. If you are not the intended recipient,
please contact the sender by reply e-mail/fax and destroy all copies
of the original message.



On Fri, Sep 4, 2009 at 2:12 AM, Uwe
Ligges<ligges at statistik.tu-dortmund.de> wrote:
> For those who have no confidential packages without license issues, want to
> build a Windows binary but do not have Windows available: please also note
> the service provided at
> http://win-builder.r-project.org/
>
> Uwe Ligges
>
>
>
> Hin-Tak Leung wrote:
>>
>> --- On Thu, 3/9/09, Vinh Nguyen <vinhdizzo at gmail.com> wrote:
>>
>>> hmmm....tried building R-2.8.0 on my
>>> mac, didn't work. ?i think it got
>>> the very end before failing:
>>> i386-mingw32-windres --preprocessor="i386-mingw32-gcc -E
>>> -xc
>>> -DRC_INVOKED" -I
>>> /Users/vinh/Downloads/Rwin/R-2.8.0/include ?-I -i
>>> methods_res.rc -o methods_res.o
>>> i386-mingw32-gcc ?-std=gnu99 ?-shared -s ?-o
>>> methods.dll methods.def
>>> class_support.o do_substitute_direct.o init.o
>>> methods_list_dispatch.o
>>> slot.o tests.o methods_res.o -L/Users/vinh/Downloads/Rwin/R-2.8.0/bin
>>> ? -lR
>>> ?... DLL made
>>> ?installing DLL
>>> ?collecting R files
>>> ?preparing package methods for lazy loading
>>> ?dumping R code in package `methods'
>>> cp:
>>>
>>> /Library/Frameworks/R.framework/Resources/library/methods/libs/methods.so:
>>> No such file or directory
>>> make[4]: ***
>>> [/Users/vinh/Downloads/Rwin/R-2.8.0/library/methods/R/methods.rdb]
>>> Error 1
>>> make[3]: *** [all] Error 2
>>> make[2]: *** [pkg-methods] Error 2
>>> make[1]: *** [rpackage] Error 1
>>> make: *** [all] Error 2
>>
>> It is probably wiser to use the last of 2.8 (i.e. 2.8.1patched)
>>
>> That seems to be buggy - anyhow, I said to build win32 R package you need
>> to have the win32 R.dll, I don't mean you have to build it yourself. You can
>> just take it out of the official win32 R installer.
>>
>>> if i go to bin/R.exe, my wine opens R fine. ?so i
>>> think this is OK.
>>> my ultimate goal would be to build a package for
>>> windows. ?looking
>>> through the admin file, i don't understand how i would do
>>> this (even
>>> if i didn't get that previous error). ?could u kindly
>>> point me in the
>>> direction of how to do this? ?make what?
>>
>> The instruction for cross-compiling R packages is in a file called
>> "README.packages" or some such under src/gnuwin32 . The file was removed in
>> R 2.9.x (as the content is no longer supported).
>>
>> BTW, you have not shown your affiliation nor the reason why you want to go
>> this way - and I am reluctant to do one-on-one hand-holding on annonymity.
>> So please keep the CC:, or arrange for commercial consultancy.
>>
>>
>> ? ?______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From pleydell at supagro.inra.fr  Fri Sep  4 18:11:22 2009
From: pleydell at supagro.inra.fr (pleydell at supagro.inra.fr)
Date: Fri, 04 Sep 2009 18:11:22 +0200
Subject: [Rd] enabling core dumps
In-Reply-To: <20090904174842.rj5qh6kk93k8wg0k@web.supagro.inra.fr>
References: <20090904173944.et305vc9gon4480c@web.supagro.inra.fr>
	<20090904174842.rj5qh6kk93k8wg0k@web.supagro.inra.fr>
Message-ID: <20090904181122.15h3os7s249w0o04@web.supagro.inra.fr>

> not really answering your question, but I find it more useful to
>
>  R -d gdb
>
> or
>
>  R -d gdb -f test.R
>
> where test.R reproduces the bug in some minimal code. A variant is
>
>  R -d valgrind -f test.R
>
> if the memory problem is not easy to spot.

Thanks for your reply Martin

Yes, I have used that route before, I have also been playing with the 
emacs "M-x
gdb" option as describe in the R FAQ. But having no first hand 
expertience with
core dumps I am curious why you prefer the -d flag route. Perhaps I'm 
wrong but
I thought examining a core dump enables you to backtrace from the 
moment things
went wrong, this seems to be a useful trick to have...

... if you manage to enable the core dump option that is.

cheers
David


From pleydell at supagro.inra.fr  Fri Sep  4 18:34:06 2009
From: pleydell at supagro.inra.fr (pleydell at supagro.inra.fr)
Date: Fri, 04 Sep 2009 18:34:06 +0200
Subject: [Rd] enabling core dumps
In-Reply-To: <4AA138C8.2010904@fhcrc.org>
References: <20090904173944.et305vc9gon4480c@web.supagro.inra.fr>
	<4AA138C8.2010904@fhcrc.org>
Message-ID: <20090904183406.ocxat56kepwgow4o@web.supagro.inra.fr>

To answer my own question.

My mistake was that "ulimit -c unlimited" applies to the current bash session
only. I had used this call in a bash *shell* buffer in emacs but this was
unable to affect R processes started in emacs with C-u M-x R, hence no core
files. Running the buggy code from R started in a bash shell after running
ulimit resulted in a core file being generated in the R working directory.

It's not the cleanest of emacs solutions, but at least it works.

David


From mtmorgan at fhcrc.org  Fri Sep  4 18:38:40 2009
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Fri, 04 Sep 2009 09:38:40 -0700
Subject: [Rd] enabling core dumps
In-Reply-To: <20090904181122.15h3os7s249w0o04@web.supagro.inra.fr>
References: <20090904173944.et305vc9gon4480c@web.supagro.inra.fr>	<20090904174842.rj5qh6kk93k8wg0k@web.supagro.inra.fr>
	<20090904181122.15h3os7s249w0o04@web.supagro.inra.fr>
Message-ID: <4AA14290.1060401@fhcrc.org>

pleydell at supagro.inra.fr wrote:
>> not really answering your question, but I find it more useful to
>>
>>  R -d gdb
>>
>> or
>>
>>  R -d gdb -f test.R
>>
>> where test.R reproduces the bug in some minimal code. A variant is
>>
>>  R -d valgrind -f test.R
>>
>> if the memory problem is not easy to spot.
> 
> Thanks for your reply Martin
> 
> Yes, I have used that route before, I have also been playing with the
> emacs "M-x
> gdb" option as describe in the R FAQ. But having no first hand
> expertience with
> core dumps I am curious why you prefer the -d flag route. Perhaps I'm
> wrong but
> I thought examining a core dump enables you to backtrace from the moment
> things
> went wrong, this seems to be a useful trick to have...
> 
> ... if you manage to enable the core dump option that is.

usually what happens is (# meant to be a comment char)

  % R -d gdb -f test.R
  gdb> run
  ...segfault happens, breaks into gdb
  gdb> bt # print the backtrace
  gdb> up # move up the stack, to get to 'your' frame
  gdb> l # show source listing, use -O0 compiler flag, see gdb> help dir
  gdb> print some_suspect_variable
  gdb> call Rf_PrintValue(some_suspect_sexp)
  gdb> break suspect_function
  gdb> run # restart script, but break at suspect_function

and so on, i.e., you've got all the info you need. A neat trick is to
leave gdb running, repair and R CMD SHLIB your C code, return to gdb and

  gdb> run

to restart the same script but using the new shared lib (possibly
preserving breakpoints and other debugging info you'd used in previous
sessions).

I'm a heavy emacs user but find it easier to stick with gdb from the
shell -- one less layer to get in the way, when I'm confused enough as
it is.

Martin
> 
> cheers
> David
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From pleydell at supagro.inra.fr  Fri Sep  4 18:48:06 2009
From: pleydell at supagro.inra.fr (pleydell at supagro.inra.fr)
Date: Fri, 04 Sep 2009 18:48:06 +0200
Subject: [Rd] enabling core dumps
In-Reply-To: <4AA14290.1060401@fhcrc.org>
References: <20090904173944.et305vc9gon4480c@web.supagro.inra.fr>
	<20090904174842.rj5qh6kk93k8wg0k@web.supagro.inra.fr>
	<20090904181122.15h3os7s249w0o04@web.supagro.inra.fr>
	<4AA14290.1060401@fhcrc.org>
Message-ID: <20090904184806.lawwbqgs31n48wgw@web.supagro.inra.fr>

> usually what happens is (# meant to be a comment char)
>
>  % R -d gdb -f test.R
>  gdb> run
>  ...segfault happens, breaks into gdb
>  gdb> bt # print the backtrace
>  gdb> up # move up the stack, to get to 'your' frame
>  gdb> l # show source listing, use -O0 compiler flag, see gdb> help dir
>  gdb> print some_suspect_variable
>  gdb> call Rf_PrintValue(some_suspect_sexp)
>  gdb> break suspect_function
>  gdb> run # restart script, but break at suspect_function
>
> and so on, i.e., you've got all the info you need. A neat trick is to
> leave gdb running, repair and R CMD SHLIB your C code, return to gdb and
>
>  gdb> run
>
> to restart the same script but using the new shared lib (possibly
> preserving breakpoints and other debugging info you'd used in previous
> sessions).
>
> I'm a heavy emacs user but find it easier to stick with gdb from the
> shell -- one less layer to get in the way, when I'm confused enough as
> it is.

Wow! Thanks for the detailed reply, your approach makes perfect sense...

... especially given that my core file was for some unknown reason 0 
bytes which
gdb didn't find too funny.

cheers
David


From simon.urbanek at r-project.org  Fri Sep  4 18:48:51 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 4 Sep 2009 12:48:51 -0400
Subject: [Rd] enabling core dumps
In-Reply-To: <20090904181122.15h3os7s249w0o04@web.supagro.inra.fr>
References: <20090904173944.et305vc9gon4480c@web.supagro.inra.fr>
	<20090904174842.rj5qh6kk93k8wg0k@web.supagro.inra.fr>
	<20090904181122.15h3os7s249w0o04@web.supagro.inra.fr>
Message-ID: <5424D0B7-4B4D-4439-A3EA-8F5C0A40FE38@r-project.org>

On Sep 4, 2009, at 12:11 , pleydell at supagro.inra.fr wrote:

>> not really answering your question, but I find it more useful to
>>
>> R -d gdb
>>
>> or
>>
>> R -d gdb -f test.R
>>
>> where test.R reproduces the bug in some minimal code. A variant is
>>
>> R -d valgrind -f test.R
>>
>> if the memory problem is not easy to spot.
>
> Thanks for your reply Martin
>
> Yes, I have used that route before, I have also been playing with  
> the emacs "M-x
> gdb" option as describe in the R FAQ. But having no first hand  
> expertience with
> core dumps I am curious why you prefer the -d flag route. Perhaps  
> I'm wrong but
> I thought examining a core dump enables you to backtrace from the  
> moment things
> went wrong, this seems to be a useful trick to have...
>

.. this is the same with gdb - the core dump just saves the same state  
that you have at the point where gdb comes in. The only practical  
difference (I'm aware of) is that with core dump you can repeatedly re- 
start your analysis back to the point of crash without running all the  
code that has lead to it at the cost of storing the entire memory  
content (which can be huge these days so often using gdb is sufficient  
and faster...).


> ... if you manage to enable the core dump option that is.
>

ulimit -c unlimited
is the right way, but you a) have to have rights to do than and b) the  
kernel must have core dumps enabled. On Debian I have no issue:

urbanek at corrino:~$ ulimit -c unlimited
urbanek at corrino:~$ R --slave < segfault.R

  *** caught segfault ***
address 0x3, cause 'memory not mapped'

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection: 1
aborting ...
Segmentation fault (core dumped)

Note the "core dumped" in the last line. Also some systems put core  
dumps in a dedicated directory, not in the current one. If in doubt,  
google for core dumps and your distro - this is not really an R  
issue ...

Cheers,
Simon


From asr at ufl.edu  Fri Sep  4 20:57:50 2009
From: asr at ufl.edu (Allen S. Rout)
Date: Fri, 04 Sep 2009 14:57:50 -0400
Subject: [Rd] Dependencies of  packages' CHECK....
References: <44wpf1vmp6dnn.fsf@crepe.osg.ufl.edu>
	<4059DBC9-C918-4D26-956E-C6627A1BB079@r-project.org>
Message-ID: <44wpfocpqa66p.fsf@crepe.osg.ufl.edu>



> On Sep 2, 2009, at 2:53 , Allen S. Rout wrote:
>
>> I'm working to automate the building of RPM packages for CRAN &c.
>> In the process, I'm trying to get a sense of the correct
>> dependencies.
>>
>> [...] 
>>
>> In other words, to check properly, I need to treat Suggests and
>> Imports as Depends.
>>
>> [...]
>>
>> So: does this seem silly, or is that just The Way It is?


Uwe Ligges <ligges at statistik.tu-dortmund.de> writes:

> Yes, it is the way it is says the Windows binary package maintainer.

Simon Urbanek <simon.urbanek at r-project.org> writes:

> [ ... Yep ... ] 


OK, thanks.  Clear is good. :) There followed some offline discussion
with Simon, in which he patiently relieved me of some measure of
ignorance.

I'm chewing on this so hard because I want to do things The Right Way.
Here's the Most Right I've gotten so far; Please correct and/or throw
vegetables as indicated.



1) Express binary package dependencies according to Depends and Imports.
   I'll call this the 'narrow dependency graph'. 

2) As part of the binary package build process, run CHECK
   with R_CHECK_FORCE_SUGGESTS = false. 

I'll pull nomenclature out of my ear and call these "built" but not
"checked".

3) Build all binary packages which are downstream according to all of
   Depends, Imports, Suggests, and Extends.  I'll call this the 'broad
   dependency graph'.

4) Install all the packages in the broad dependency graph.

5) for each package in the broad graph, run CHECK with
   R_CHECK_FORCE_SUGGESTS=true.

Then the affected packages are "checked".  Perhaps this can be noted
with a signature.



I'd like to get at least to "Well, that doesn't sound too stupid"
before I turn around trying to sell that evolution to the RPM-flavored
list. :)



- Allen S. Rout


From gvsteen at yahoo.com  Fri Sep  4 22:38:12 2009
From: gvsteen at yahoo.com (Guido van Steen)
Date: Fri, 4 Sep 2009 13:38:12 -0700 (PDT)
Subject: [Rd] Including a binary Python Interpreter into a binary
	R-package for MS Windows
In-Reply-To: <971536df0909031458y814cd67jf908799cc7857644@mail.gmail.com>
Message-ID: <765122.70709.qm@web65613.mail.ac4.yahoo.com>

Hi Gabor, 

--- On Thu, 9/3/09, Gabor Grothendieck <ggrothendieck at gmail.com> wrote:

> I've tried both these approaches.
> 
> See Ryacas source code to see an example of the binary
> download approach.
> It has the advantage that the software loads and runs
> faster.
> 
> Nevertheless, I moved from the binary download approach to
> the Jython approach
> for my next package, rSymPy, since Jython gives a single
> approach that works
> on all platforms and installation becomes a "no brainer"
> since its all
> self contained.

Unzipping an archive with e.g. "python.exe" and "python25.dll" should also be quite easy. Python's main modules would all be included in "python25.dll". For add-on modules you could use a modified import mechanism, so that you can place these modules one level deeper in the directory structure. 

> In fact, in most cases its just a matter of:
> install.packages("rSymPy").
> like any other package.
> 
> Thus while its true that Jython is slower but if usrs can't
> install it
> in the first place
> or its too difficult to install it no one will try it in
> the first
> place and then it
> does not matter how fast it is since it will be unused or
> less used.
> 
> One caveat is that although Jython does make installation
> much easier
> its still possible to have problems.? e.g. user does
> not have
> Java or has wrong version of Java or needs certain
> permissions.? On Vista
> they may need to run R elevated.? 

I can imagine. 

> I expect that as new
> versions of Jython
> become available (in fact a more recent one became
> available after the
> last release of rSymPy) things will further improve.
> 
> For more info on possible problems with each approach see
> the
> troubleshooting sections of Ryacas and rSymPy home pages:
> 
> http://Ryacas.googlecode.com
> http://rSymPy.googlecode.com

Thanks. I will take a look at both projects. 

Guido 





From i.aoultchenko at erasmusmc.nl  Fri Sep  4 22:54:30 2009
From: i.aoultchenko at erasmusmc.nl (Yurii Aulchenko)
Date: Fri, 4 Sep 2009 22:54:30 +0200
Subject: [Rd] asking for suggestions: interface for a C++ class
Message-ID: <91FB958D-CFB2-45CD-8EF1-2206E04C4EE6@erasmusmc.nl>

Dear All,

I would like to have an advice for designing an R library, and thought  
that R-devel may be the best place to ask given so many people who are  
highly expert in R are around.

We are at an early stage of designing an R library, which is  
effectively an interface to a C++ library providing fast access to  
large matrices stored on HDD as binary files. The core of the C++  
library is relatively sophisticated class, which we try to "mirror"  
using an S4 class in R. Basically when a new object of that class is  
initiated, the C++ constructor is called and essential elements of the  
new object are reflected as slots of the R object.

Now as you can imagine the problem is that if the R object is removed  
using say "rm" command, and not our specifically designed one, the C++  
object still hangs around in RAM until R session is terminated. This  
is not nice, and also may be a problem, as the C++ object may allocate  
large part of RAM. We can of cause replace generic "rm" and "delete"  
functions, but this is definitely not a nice solution.

Sounds like rather common problem people may face, but unfortunately I  
was not able to find a solution.

I will greatly appreciate any suggestions.

many thanks in advance,
Yurii


From seth at userprimary.net  Fri Sep  4 23:17:23 2009
From: seth at userprimary.net (Seth Falcon)
Date: Fri, 4 Sep 2009 14:17:23 -0700
Subject: [Rd] asking for suggestions: interface for a C++ class
In-Reply-To: <91FB958D-CFB2-45CD-8EF1-2206E04C4EE6@erasmusmc.nl>
References: <91FB958D-CFB2-45CD-8EF1-2206E04C4EE6@erasmusmc.nl>
Message-ID: <20090904211723.GP12397@ziti.local>

* On 2009-09-04 at 22:54 +0200 Yurii Aulchenko wrote:
> We are at an early stage of designing an R library, which is effectively an 
> interface to a C++ library providing fast access to large matrices stored 
> on HDD as binary files. The core of the C++ library is relatively 
> sophisticated class, which we try to "mirror" using an S4 class in R. 
> Basically when a new object of that class is initiated, the C++ constructor 
> is called and essential elements of the new object are reflected as slots 
> of the R object.

Have a look at external pointers as described in the Writing R
Extensions Manual.

> Now as you can imagine the problem is that if the R object is removed using 
> say "rm" command, and not our specifically designed one, the C++ object 
> still hangs around in RAM until R session is terminated. This is not nice, 
> and also may be a problem, as the C++ object may allocate large part of 
> RAM. We can of cause replace generic "rm" and "delete" functions, but this 
> is definitely not a nice solution.

You likely want a less literal translation of your C++ object into R's
S4 system.  One slot should be an external pointer which will give you
the ability to define a finalizer to clean up when the R level object
gets gc'd.

+ seth

-- 
Seth Falcon | @sfalcon | http://userprimary.net/user


From simon.urbanek at r-project.org  Fri Sep  4 23:21:49 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 4 Sep 2009 17:21:49 -0400
Subject: [Rd] asking for suggestions: interface for a C++ class
In-Reply-To: <91FB958D-CFB2-45CD-8EF1-2206E04C4EE6@erasmusmc.nl>
References: <91FB958D-CFB2-45CD-8EF1-2206E04C4EE6@erasmusmc.nl>
Message-ID: <58DF18A9-8F3F-4EDD-A073-6F994252A25B@r-project.org>

Yurii,

On Sep 4, 2009, at 16:54 , Yurii Aulchenko wrote:

> Dear All,
>
> I would like to have an advice for designing an R library, and  
> thought that R-devel may be the best place to ask given so many  
> people who are highly expert in R are around.
>
> We are at an early stage of designing an R library, which is  
> effectively an interface to a C++ library providing fast access to  
> large matrices stored on HDD as binary files.

[FWIW there are already several packages that do waht you describe -  
see e.g. ff, bigMemory, nws, ...]


> The core of the C++ library is relatively sophisticated class, which  
> we try to "mirror" using an S4 class in R. Basically when a new  
> object of that class is initiated, the C++ constructor is called and  
> essential elements of the new object are reflected as slots of the R  
> object.
>
> Now as you can imagine the problem is that if the R object is  
> removed using say "rm" command, and not our specifically designed  
> one, the C++ object still hangs around in RAM until R session is  
> terminated.

You must have some link between the S4 object and your C++ object -  
ideally an external pointer - so all you have to do is to attach a  
finalizer to it via R_RegisterCFinalizer or R_RegisterCFinalizerEx. In  
that finalizer you simply free the C++ object and all is well.

Note that R uses a garbage collector so the object won't go away  
immediately after it went out of scope - only after R thinks it needs  
to reclaim memory. You can use gc() to force garbage collection to  
test it.


> This is not nice, and also may be a problem, as the C++ object may  
> allocate large part of RAM. We can of cause replace generic "rm" and  
> "delete" functions, but this is definitely not a nice solution.
>

... and it doesn't tackle the issue - objects can go out of scope by  
other means than just rm(), e.g.:
f <- function() { ...; myGreatObject }
f()
# the great object is gone now since it was not assigned anywhere


> Sounds like rather common problem people may face, but unfortunately  
> I was not able to find a solution.
>

Cheers,
Simon


From rkoenker at uiuc.edu  Fri Sep  4 23:44:44 2009
From: rkoenker at uiuc.edu (rudjer)
Date: Fri, 4 Sep 2009 14:44:44 -0700 (PDT)
Subject: [Rd]  Viewing pdfs from inst/doc
Message-ID: <25302477.post@talk.nabble.com>


Writing R extensions says:  

In addition to the help files in Rd format, R packages allow the inclusion
of documents in arbitrary other formats. The standard location for these is
subdirectory inst/doc of a source package, the contents will be copied to
subdirectory doc when the package is installed. Pointers from package help
indices to the installed documents are automatically created. Documents in
inst/doc can be in arbitrary format, however we strongly recommend to
provide them in PDF format, such that users on all platforms can easily read
them.

My question is easily How?  The function vignette() provides a convenient
way to read properly Sweaved 
vignettes, but what about plain old pdfs that someone like me would like to
stick into inst/doc and
then view?  It seems possible to make a modified vignette function to do
this using print.vignette,
but having started down this road, I got the strong sensation of reinventing
the wheel and the
inevitably related sensation that I wasn't going to know what to call my new
wheel when it was
created.  I recognize that the current setup is supposed to encourage proper
vignettes, but sometimes
courage fails.

A related questions is whether there is a convenient substitute for a
package specific function like this:
    FAQ <- function (pkg = "quantreg") 
          file.show(file.path(system.file(package = pkg), "FAQ"))

to read the faq that I've written for the package and placed in the inst/
directory.

-- 
View this message in context: http://www.nabble.com/Viewing-pdfs-from-inst-doc-tp25302477p25302477.html
Sent from the R devel mailing list archive at Nabble.com.


From b.rowlingson at lancaster.ac.uk  Fri Sep  4 23:58:22 2009
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 4 Sep 2009 22:58:22 +0100
Subject: [Rd] Viewing pdfs from inst/doc
In-Reply-To: <25302477.post@talk.nabble.com>
References: <25302477.post@talk.nabble.com>
Message-ID: <d8ad40b50909041458x4894cc5ha7dd0a927e1d551f@mail.gmail.com>

On Fri, Sep 4, 2009 at 10:44 PM, rudjer<rkoenker at uiuc.edu> wrote:
>
> Writing R extensions says:
>
> In addition to the help files in Rd format, R packages allow the inclusion
> of documents in arbitrary other formats. The standard location for these is
> subdirectory inst/doc of a source package, the contents will be copied to
> subdirectory doc when the package is installed. Pointers from package help
> indices to the installed documents are automatically created. Documents in
> inst/doc can be in arbitrary format, however we strongly recommend to
> provide them in PDF format, such that users on all platforms can easily read
> them.
>
> My question is easily How? ?The function vignette() provides a convenient
> way to read properly Sweaved
> vignettes, but what about plain old pdfs that someone like me would like to
> stick into inst/doc and
> then view? ?It seems possible to make a modified vignette function to do
> this using print.vignette,
> but having started down this road, I got the strong sensation of reinventing
> the wheel and the
> inevitably related sensation that I wasn't going to know what to call my new
> wheel when it was
> created. ?I recognize that the current setup is supposed to encourage proper
> vignettes, but sometimes
> courage fails.
>
> A related questions is whether there is a convenient substitute for a
> package specific function like this:
> ? ?FAQ <- function (pkg = "quantreg")
> ? ? ? ? ?file.show(file.path(system.file(package = pkg), "FAQ"))
>
> to read the faq that I've written for the package and placed in the inst/
> directory.

 I think I tried to do this a little while ago, and trawling R-help
and R-dev came up with the suggestion of putting something in a demo
section. Hence I have foo/demo/bar.R which is:

pdf = system.file("doc/bar.pdf",package="foo")

if (.Platform$OS.type == "windows") {
  shell.exec(pdf)
}else{
  system(paste(shQuote(getOption("pdfviewer")), shQuote(pdf)),
            wait = FALSE)
}

 Then when a user does demo(bar) the PDF pops up. I document this in
the Rd doc for bar.

 It does seem a bit kludgy, and maybe there's a need for a package to
handle all this...

Barry


From romain.francois at dbmail.com  Sat Sep  5 08:25:49 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Sat, 05 Sep 2009 08:25:49 +0200
Subject: [Rd] Viewing pdfs from inst/doc
In-Reply-To: <d8ad40b50909041458x4894cc5ha7dd0a927e1d551f@mail.gmail.com>
References: <25302477.post@talk.nabble.com>
	<d8ad40b50909041458x4894cc5ha7dd0a927e1d551f@mail.gmail.com>
Message-ID: <4AA2046D.6020904@dbmail.com>

On 09/04/2009 11:58 PM, Barry Rowlingson wrote:
>
> On Fri, Sep 4, 2009 at 10:44 PM, rudjer<rkoenker at uiuc.edu>  wrote:
>>
>> Writing R extensions says:
>>
>> In addition to the help files in Rd format, R packages allow the inclusion
>> of documents in arbitrary other formats. The standard location for these is
>> subdirectory inst/doc of a source package, the contents will be copied to
>> subdirectory doc when the package is installed. Pointers from package help
>> indices to the installed documents are automatically created. Documents in
>> inst/doc can be in arbitrary format, however we strongly recommend to
>> provide them in PDF format, such that users on all platforms can easily read
>> them.
>>
>> My question is easily How?  The function vignette() provides a convenient
>> way to read properly Sweaved
>> vignettes, but what about plain old pdfs that someone like me would like to
>> stick into inst/doc and
>> then view?  It seems possible to make a modified vignette function to do
>> this using print.vignette,
>> but having started down this road, I got the strong sensation of reinventing
>> the wheel and the
>> inevitably related sensation that I wasn't going to know what to call my new
>> wheel when it was
>> created.  I recognize that the current setup is supposed to encourage proper
>> vignettes, but sometimes
>> courage fails.
>>
>> A related questions is whether there is a convenient substitute for a
>> package specific function like this:
>>     FAQ<- function (pkg = "quantreg")
>>           file.show(file.path(system.file(package = pkg), "FAQ"))
>>
>> to read the faq that I've written for the package and placed in the inst/
>> directory.
>
>   I think I tried to do this a little while ago, and trawling R-help
> and R-dev came up with the suggestion of putting something in a demo
> section. Hence I have foo/demo/bar.R which is:
>
> pdf = system.file("doc/bar.pdf",package="foo")
>
> if (.Platform$OS.type == "windows") {
>    shell.exec(pdf)
> }else{
>    system(paste(shQuote(getOption("pdfviewer")), shQuote(pdf)),
>              wait = FALSE)
> }
>
>   Then when a user does demo(bar) the PDF pops up. I document this in
> the Rd doc for bar.
>
>   It does seem a bit kludgy, and maybe there's a need for a package to
> handle all this...
>
> Barry

print.vignette knows that it needs to factor out the "open a pdf file" 
part, see the <FIXME> section :

 > utils:::print.vignette
function(x, ...){

     if(length(x$pdf)){
         ## <FIXME>
         ## Should really abstract this into a BioC style
         ## openPDF() along the lines of browseURL() ...
         if(.Platform$OS.type == "windows")
             shell.exec(x$pdf)
         else
             system(paste(shQuote(getOption("pdfviewer")), shQuote(x$pdf)),
                    wait = FALSE)
         ## </FIXME>
     } else {
         warning(gettextf("vignette '%s' has no PDF", x$topic),
                 call. = FALSE, domain = NA)
     }
     invisible(x)
}
<environment: namespace:utils>


You can trick the system using something like this :

fake.vignette <- function( file = system.file( "doc", vignette, package 
= package ), vignette, package, topic = vignette ){
	structure( pdf = file, topic = topic, class = "vignette" )
}

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/xMdt : update on the ant package
|- http://tr.im/xHLs : R capable version of ant
`- http://tr.im/xHiZ : Tip: get java home from R with rJava


From pleydell at supagro.inra.fr  Sat Sep  5 10:36:26 2009
From: pleydell at supagro.inra.fr (pleydell at supagro.inra.fr)
Date: Sat, 05 Sep 2009 10:36:26 +0200
Subject: [Rd] Unexpected behaviour of "next line" in gdb
Message-ID: <20090905103626.0tjsgnso2g0gcw0o@web.supagro.inra.fr>

I compile some C code using

R CMD SHLIB buggyCode.c --ggdb --O0

I thought the -O0 flag would avoid gdb ~ optimisation problems. But each time I
step through the code in gdb using "n" (next line) the executed line order is
not as expected ("looks" more like a random walk around the expected next
line). So to me it looks like there is still a gdb ~ optimisation conflict.

Does this mean I have to have a copy of R compiled from source using the -O0
flag too?

thanks
David


-- 
David Pleydell
UMR BGPI
CIRAD
TA A-54/K
Campus International de Baillarguet
34398 MONTPELLIER CEDEX 5
FRANCE
Tel: +33 4 99 62 48 65 - Secr?tariat : +33 4 99 62 48 21
Fax : +33 4 99 62 48 22
http://umr-bgpi.cirad.fr/trombinoscope/pleydell_d.htm
https://sites.google.com/site/drjpleydell/


From romain.francois at dbmail.com  Sat Sep  5 11:05:34 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Sat, 05 Sep 2009 11:05:34 +0200
Subject: [Rd] returned value of R_tryEval
Message-ID: <4AA229DE.6030907@dbmail.com>

Hello,

At the moment, R-tryEval (src/main/context.c) :

SEXP R_tryEval(SEXP e, SEXP env, int *ErrorOccurred)

would set ErrorOccurred to 1 and return NULL when an error occurs during 
the evaluation of e within env, so to know that an error occured, we can 
just look at the ErrorOccured value and not look at the returned value.

Could this be expanded so that, when an error occurs, something more 
useful than NULL is returned, such as the call stack for example.

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/xMdt : update on the ant package
|- http://tr.im/xHLs : R capable version of ant
`- http://tr.im/xHiZ : Tip: get java home from R with rJava


From pleydell at supagro.inra.fr  Sat Sep  5 11:27:33 2009
From: pleydell at supagro.inra.fr (pleydell at supagro.inra.fr)
Date: Sat, 05 Sep 2009 11:27:33 +0200
Subject: [Rd] Unexpected behaviour of "next line" in gdb
In-Reply-To: <20090905103626.0tjsgnso2g0gcw0o@web.supagro.inra.fr>
References: <20090905103626.0tjsgnso2g0gcw0o@web.supagro.inra.fr>
Message-ID: <20090905112733.w6mt6urqub4s4o44@web.supagro.inra.fr>

Looking through the archives I found this thread
http://tolstoy.newcastle.edu.au/R/e4/devel/08/02/0347.html

and so I tried

MAKEFLAGS="CFLAGS=-g -O" R CMD SHLIB ...

and this worked great.


From atp at piskorski.com  Sat Sep  5 13:15:11 2009
From: atp at piskorski.com (Andrew Piskorski)
Date: Sat, 5 Sep 2009 07:15:11 -0400
Subject: [Rd] Load a package without installing it
In-Reply-To: <f8e6ff050909040639r35659a8hd00d06901093dcd1@mail.gmail.com>
References: <f8e6ff050909040639r35659a8hd00d06901093dcd1@mail.gmail.com>
Message-ID: <20090905111511.GA47877@piskorski.com>

On Fri, Sep 04, 2009 at 08:39:12AM -0500, Hadley Wickham wrote:

> When developing a package, it's often useful to be able to reload it,
> without re-installing, re-starting R and re-loading.

Why would you ever need to restart R in such a situation?

What I do is make the code change in my package, build it from source
like so:

  R CMD INSTALL $r_lazy_arg -l ../R $Library

and then detach and re-attach it in my R session with:

  detach("package:my.pkg") ; library(my.pkg, lib.loc="/home/me/my-R-stuff/R")

That's it.  Works fine as long as your package doesn't use namespaces;
an additional command is necessary to handle namespaces but I forget
what it is.  Works fine for packages with C code too, as long as
you've correctly set up your package's .First.lib() and .Last.lib()
your to call library.dynam() library.dynam.unload().

I'm not sure whether the detach() will play nicely with package
dependencies, as I've found them annoying in other circumstances and
so tend to never use package dependencies in my code.

It'd be nice not to have to "compile" the R code at the command line
all the time and instead just have R read my source files from their
original location when I call library(), but the above isn't bad.

> To do this I've
> written a little script that inspects the package description and
> loads dependencies, data and code - http://gist.github.com/180883.
> It's obviously not very general (being tailored to my description
> files) and won't work for packages containing C code, but I hope you
> might find it useful nonetheless.

source() and load() both dump code into your top-level workspace,
right?  When I'm developing a package, I'd generally rather have R
access my package's stuff via the search path in the usual manner, not
from some other special location that Production never uses.

-- 
Andrew Piskorski <atp at piskorski.com>
http://www.piskorski.com/


From jayemerson at gmail.com  Sat Sep  5 16:01:32 2009
From: jayemerson at gmail.com (Jay Emerson)
Date: Sat, 5 Sep 2009 10:01:32 -0400
Subject: [Rd] asking for suggestions: interface for a C++ class
Message-ID: <d4588dec0909050701k2ea8d74br333d2cac759749be@mail.gmail.com>

Yuri,

Based on your brief description, we have already done this with
bigmemory, and the ff package does something very similar but with
emphasis on a wide range of atomic data types and data frame.  Unless
you are planning something different from what's been done before, you
shouldn't waste valuable time on it.  We (bigmemory)  support shared
memory and filebacked objects, and use the BOOST interprocess library
to support all platforms.  It's been a 2-3 year project with many
unanticipated problems, but it's pretty stable and a good number of
people seem to be using it at this point.

We'll be releasing a fairly major redesign this Fall, and would
appreciate suggestions and feedback.

Jay

-- 
John W. Emerson (Jay)
Associate Professor of Statistics
Department of Statistics
Yale University
http://www.stat.yale.edu/~jay


From hadley at rice.edu  Sat Sep  5 16:29:01 2009
From: hadley at rice.edu (Hadley Wickham)
Date: Sat, 5 Sep 2009 09:29:01 -0500
Subject: [Rd] Load a package without installing it
In-Reply-To: <20090905111511.GA47877@piskorski.com>
References: <f8e6ff050909040639r35659a8hd00d06901093dcd1@mail.gmail.com> 
	<20090905111511.GA47877@piskorski.com>
Message-ID: <f8e6ff050909050729k51ee4e98sf0aee4433d7d101b@mail.gmail.com>

On Sat, Sep 5, 2009 at 6:15 AM, Andrew Piskorski<atp at piskorski.com> wrote:
> On Fri, Sep 04, 2009 at 08:39:12AM -0500, Hadley Wickham wrote:
>
>> When developing a package, it's often useful to be able to reload it,
>> without re-installing, re-starting R and re-loading.
>
> Why would you ever need to restart R in such a situation?

Two comments:

 * running install is slower than just sourcing all the code

 * detach specifically warns against the use you make of it: "So
detaching and re-attaching a package may not refresh some or all
components of the package, and is inadvisable."

But if it works for you, great!

> I'm not sure whether the detach() will play nicely with package
> dependencies, as I've found them annoying in other circumstances and
> so tend to never use package dependencies in my code.

This seems a bit extreme!

Hadley

-- 
http://had.co.nz/


From ligges at statistik.tu-dortmund.de  Sat Sep  5 17:03:31 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sat, 05 Sep 2009 17:03:31 +0200
Subject: [Rd] Dependencies of  packages' CHECK....
In-Reply-To: <44wpfocpqa66p.fsf@crepe.osg.ufl.edu>
References: <44wpf1vmp6dnn.fsf@crepe.osg.ufl.edu>	<4059DBC9-C918-4D26-956E-C6627A1BB079@r-project.org>
	<44wpfocpqa66p.fsf@crepe.osg.ufl.edu>
Message-ID: <4AA27DC3.7050500@statistik.tu-dortmund.de>



Allen S. Rout wrote:
> 
>> On Sep 2, 2009, at 2:53 , Allen S. Rout wrote:
>>
>>> I'm working to automate the building of RPM packages for CRAN &c.
>>> In the process, I'm trying to get a sense of the correct
>>> dependencies.
>>>
>>> [...] 
>>>
>>> In other words, to check properly, I need to treat Suggests and
>>> Imports as Depends.
>>>
>>> [...]
>>>
>>> So: does this seem silly, or is that just The Way It is?
> 
> 
> Uwe Ligges <ligges at statistik.tu-dortmund.de> writes:
> 
>> Yes, it is the way it is says the Windows binary package maintainer.
> 
> Simon Urbanek <simon.urbanek at r-project.org> writes:
> 
>> [ ... Yep ... ] 
> 
> 
> OK, thanks.  Clear is good. :) There followed some offline discussion
> with Simon, in which he patiently relieved me of some measure of
> ignorance.
> 
> I'm chewing on this so hard because I want to do things The Right Way.
> Here's the Most Right I've gotten so far; Please correct and/or throw
> vegetables as indicated.
> 
> 
> 
> 1) Express binary package dependencies according to Depends and Imports.
>    I'll call this the 'narrow dependency graph'. 


1, 3-5 sound fine, but I do not see why you need 2).

Best wishes,
Uwe Ligges



> 2) As part of the binary package build process, run CHECK
>    with R_CHECK_FORCE_SUGGESTS = false. 
> 
> I'll pull nomenclature out of my ear and call these "built" but not
> "checked".
 >
> 3) Build all binary packages which are downstream according to all of
>    Depends, Imports, Suggests, and Extends.  I'll call this the 'broad
>    dependency graph'.
> 
> 4) Install all the packages in the broad dependency graph.
> 
> 5) for each package in the broad graph, run CHECK with
>    R_CHECK_FORCE_SUGGESTS=true.
> 
> Then the affected packages are "checked".  Perhaps this can be noted
> with a signature.
> 
> 
> 
> I'd like to get at least to "Well, that doesn't sound too stupid"
> before I turn around trying to sell that evolution to the RPM-flavored
> list. :)
> 
> 
> 
> - Allen S. Rout
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From rkoenker at uiuc.edu  Sat Sep  5 19:31:52 2009
From: rkoenker at uiuc.edu (rudjer)
Date: Sat, 5 Sep 2009 10:31:52 -0700 (PDT)
Subject: [Rd] Viewing pdfs from inst/doc
In-Reply-To: <4AA2046D.6020904@dbmail.com>
References: <25302477.post@talk.nabble.com>
	<d8ad40b50909041458x4894cc5ha7dd0a927e1d551f@mail.gmail.com>
	<4AA2046D.6020904@dbmail.com>
Message-ID: <25310670.post@talk.nabble.com>


Thanks Romain and Barry for help with this.  I've written a faux.vignette
function somewhat  along the lines of Romain's suggestion.  


Roger Koenker
-- 
View this message in context: http://www.nabble.com/Viewing-pdfs-from-inst-doc-tp25302477p25310670.html
Sent from the R devel mailing list archive at Nabble.com.


From peter.juhasz83 at gmail.com  Sat Sep  5 20:31:18 2009
From: peter.juhasz83 at gmail.com (Peter Juhasz)
Date: Sat, 5 Sep 2009 20:31:18 +0200
Subject: [Rd] Running two R instances at the same time
Message-ID: <b2050ab90909051131i15b413bci18300426406cbcea@mail.gmail.com>

Reposting from R-help:

Dear R experts,

please excuse me for writing to the mailing list without subscribing.
I have a somewhat urgent problem that relates to R.

I have to process large amounts of data with R - I'm in an
international collaboration and the data processing protocol is fixed,
that is a specific set of R commands has to be used.

I wrote a perl program that manages creation of data subsets from my
database and feeds these subsets to an R process via pipes.

This worked all right, however, I wanted to speed things up by
exploiting the fact that I have a dual-core machine. So I rewrote my
perl driver program to use two threads, each starting its own R
instance, getting data off a queue and feeding it to its R process.

This also worked, except that I noticed something very peculiar: the
processing time was almost exactly the same for both cases. I did some
tests to look at this, and it seems that R needs twice the time to do
the exact same thing if there are two instances of it running.

I don't understand how is this possible. Maybe there is an issue of
thread-safety with the R backend, meaning that the two R *interpreter*
instances are talking to the same backend that's capable of processing
only one thing at a time?

Technical details: OS was Ubuntu 9.04 running on a Core2Dou E7300, and
the R version used was the default one from the Ubuntu repository.

Please see http://www.perlmonks.org/?node_id=792460 for an extended
discussion of the problem, and especially
http://www.perlmonks.org/?node_id=793506 for excerpts of output and
actual code.

I have received several suggestions about R packages that would enable
parallel processing in some way or other, and I'm thankful for those.

However, at this point I'm interested in having two completely
unrelated R processes that run simultaneously, not in parallel
processing from within R.
I have to admit that I'm an absolute beginner when it comes to R and
this project will be finished before I could learn everything I'd need
for a pure R solution. I'm familiar with perl, however, so I'd like to
stick to that.

Thanks for your answers in advance and please excuse me if this causes
too much noise:

P?ter Juh?sz
physicist


From simon.urbanek at r-project.org  Sun Sep  6 04:49:25 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sat, 5 Sep 2009 22:49:25 -0400
Subject: [Rd] Running two R instances at the same time
In-Reply-To: <b2050ab90909051131i15b413bci18300426406cbcea@mail.gmail.com>
References: <b2050ab90909051131i15b413bci18300426406cbcea@mail.gmail.com>
Message-ID: <45D572B5-E71D-4398-989D-BAD3071295B2@r-project.org>


On Sep 5, 2009, at 2:31 PM, Peter Juhasz wrote:

> Reposting from R-help:
>
> Dear R experts,
>
> please excuse me for writing to the mailing list without subscribing.
> I have a somewhat urgent problem that relates to R.
>
> I have to process large amounts of data with R - I'm in an
> international collaboration and the data processing protocol is fixed,
> that is a specific set of R commands has to be used.
>
> I wrote a perl program that manages creation of data subsets from my
> database and feeds these subsets to an R process via pipes.
>
> This worked all right, however, I wanted to speed things up by
> exploiting the fact that I have a dual-core machine. So I rewrote my
> perl driver program to use two threads, each starting its own R
> instance, getting data off a queue and feeding it to its R process.
>
> This also worked, except that I noticed something very peculiar: the
> processing time was almost exactly the same for both cases. I did some
> tests to look at this, and it seems that R needs twice the time to do
> the exact same thing if there are two instances of it running.
>
> I don't understand how is this possible. Maybe there is an issue of
> thread-safety with the R backend, meaning that the two R *interpreter*
> instances are talking to the same backend that's capable of processing
> only one thing at a time?
>

No, are least not in R itself. Clearly there are many explanations  
(you are accessing the data in some way that is not parallelizable, R  
is already using both cores, perl does something funny that you are  
not anticipating ...), but I see too little evidence. The perl code to  
too much of a mess to really tell - why don't you just start two of  
your jobs manually in the background and clock them? For starters use  
simply
time .. &

In perl I wouldn't use threads, it should be as simple as

#!/usr/bin/perl

sub run {
     $children++;
     if (fork() == 0) {
	print "job $children started\n";
	system $_[0];
	print "job $children done\n";
	exit 0;
     }
}

run "sleep 1";
run "sleep 2";
#etc.

while ($children) { wait; $children--; }
print "Jobs done.\n";

Fino:sandbox$ ./tt
job 1 started
job 2 started
job 1 done
job 2 done
Jobs done.

(replace sleep by your R invocation ... use your imagination to  
improve it since it's admittedly very crude but helps to track it  
down ...)

Cheers,
Simon


> Technical details: OS was Ubuntu 9.04 running on a Core2Dou E7300, and
> the R version used was the default one from the Ubuntu repository.
>
> Please see http://www.perlmonks.org/?node_id=792460 for an extended
> discussion of the problem, and especially
> http://www.perlmonks.org/?node_id=793506 for excerpts of output and
> actual code.
>
> I have received several suggestions about R packages that would enable
> parallel processing in some way or other, and I'm thankful for those.
>
> However, at this point I'm interested in having two completely
> unrelated R processes that run simultaneously, not in parallel
> processing from within R.
> I have to admit that I'm an absolute beginner when it comes to R and
> this project will be finished before I could learn everything I'd need
> for a pure R solution. I'm familiar with perl, however, so I'd like to
> stick to that.
>
> Thanks for your answers in advance and please excuse me if this causes
> too much noise:
>
> P?ter Juh?sz
> physicist
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From charlie at stat.umn.edu  Sun Sep  6 18:02:04 2009
From: charlie at stat.umn.edu (Charles Geyer)
Date: Sun, 6 Sep 2009 11:02:04 -0500
Subject: [Rd] question about --with-valgrind-instrumentation=level
In-Reply-To: <mailman.9.1252231204.24560.r-devel@r-project.org>
References: <mailman.9.1252231204.24560.r-devel@r-project.org>
Message-ID: <20090906160204.GA9440@stat.umn.edu>

Does --with-valgrind-instrumentation=2 slow down R when valgrind or gctorture
are not in use?  I am thinking of compiling the R that the whole department
uses for research and teachin with --with-valgrind-instrumentation=2.  Is
that a good idea or a bad idea?
-- 
Charles Geyer
Professor, School of Statistics
University of Minnesota
charlie at stat.umn.edu


From ripley at stats.ox.ac.uk  Sun Sep  6 18:12:21 2009
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 6 Sep 2009 17:12:21 +0100 (BST)
Subject: [Rd] question about --with-valgrind-instrumentation=level
In-Reply-To: <20090906160204.GA9440@stat.umn.edu>
References: <mailman.9.1252231204.24560.r-devel@r-project.org>
	<20090906160204.GA9440@stat.umn.edu>
Message-ID: <alpine.LFD.2.00.0909061707150.20763@gannet.stats.ox.ac.uk>

On Sun, 6 Sep 2009, Charles Geyer wrote:

> Does --with-valgrind-instrumentation=2 slow down R when valgrind or gctorture
> are not in use?  I am thinking of compiling the R that the whole department
> uses for research and teachin with --with-valgrind-instrumentation=2.  Is
> that a good idea or a bad idea?

It is a slightly bad idea: it does add extra code in memory.c that 
would always be called.

This only affects R.bin (or libR.so if you use the already slower 
shared-library version), so you can so as I do and simply use a 
different version of R.bin.

There is a similar issue with memory profiling.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From charlie at stat.umn.edu  Sun Sep  6 19:50:46 2009
From: charlie at stat.umn.edu (Charles Geyer)
Date: Sun, 6 Sep 2009 12:50:46 -0500
Subject: [Rd] question about ... passed to two different functions
In-Reply-To: <mailman.9.1252231204.24560.r-devel@r-project.org>
References: <mailman.9.1252231204.24560.r-devel@r-project.org>
Message-ID: <20090906175046.GB9915@stat.umn.edu>

I have hit a problem with the design of the mcmc package I can't
figure out, possibly because I don't really understand the R function
call mechanism.  The function metrop in the mcmc package has a ... argument
that it passes to one or two user-supplied functions, which are other
arguments to metrop.  When the two functions don't have the same arguments,
this doesn't work.  Here's an example.

 library(mcmc)
 library(MASS)

 set.seed(42)

 n <- 100
 rho <- 0.5
 beta0 <- 0.25
 beta1 <- 0.5
 beta2 <- 1
 beta3 <- 1.5

 Sigma <- matrix(rho, 3, 3)
 diag(Sigma) <- 1
 Sigma <- 0.75 * Sigma
 Mu <- rep(0, 3)

 foo <- mvrnorm(n, Mu, Sigma)

 x1 <- foo[ , 1]
 x2 <- foo[ , 2]
 x3 <- foo[ , 3]

 modmat <- cbind(1, foo)

 eta <- beta0 + beta1 * x1 + beta2 * x2 + beta3 * x3
 p <- 1 / (1 + exp(- eta))
 y <- as.numeric(runif(n) < p)

 out <- glm(y ~ x1 + x2 + x3, family = binomial())
 summary(out)

 ### now we want to do a Bayesian analysis of the model, so we write
 ### a function that evaluates the log unnormalized density of the
 ### Markov chain we want to run (log likelihood + log prior)

 ludfun <- function(beta) {
     stopifnot(is.numeric(beta))
     stopifnot(length(beta) == ncol(modmat))
     eta <- as.numeric(modmat %*% beta)
     logp <- ifelse(eta < 0, eta - log1p(exp(eta)), - log1p(exp(- eta)))
     logq <- ifelse(eta < 0, - log1p(exp(eta)), - eta - log1p(exp(- eta)))
     logl <- sum(logp[y == 1]) + sum(logq[y == 0])
     val <- logl - sum(beta^2) / 2
     return(val)
 }

 beta.initial <- as.vector(out$coefficients)

 out <- metrop(ludfun, initial = beta.initial, nbatch = 20,
     blen = 10, nspac = 5, scale = 0.56789)

 ### Works fine.  Here are the Monte Carlo estimates of the posterior
 ### means for each parameter with Monte Carlo standard errors.

 apply(out$batch, 2, mean)
 sqrt(apply(out$batch, 2, function(x) initseq(x)$var.con) / out$nbatch)

 ### Now suppose I want Monte Carlo estimates of some function of
 ### the parameters other than the identity function.  I write a function
 ### outfun that does that.  Also suppose I want some extra arguments
 ### to outfun.  This example is a bit forced, but I hit on natural
 ### examples with a new function (not yet released) that works like
 ### metrop but does simulated tempering.

 outfun <- function(beta, degree) {
     stopifnot(is.numeric(beta))
     stopifnot(length(beta) == ncol(modmat))
     stopifnot(is.numeric(degree))
     stopifnot(length(degree) == 1)
     stopifnot(degree == as.integer(degree))
     stopifnot(length(degree) > 0)
     result <- NULL
     for (i in 1:degree)
         result <- c(result, beta^i)
     return(result)
 }

 out <- metrop(out, outfun = outfun, degree = 2)

 ### Oops!  Try it and you get
 ###
 ### Error in obj(state, ...) : unused argument(s) (degree = 2)

I don't understand what the problem is (mostly because of ignorance).  Because

 foo <- function(x, ...) x
 foo(x = 2, y = 3)

does work.  The error is happening when ludfun is called, and I assume
the complaint is that it doesn't have an argument "degree", but then
why doesn't the simple example just above fail?  So clearly I don't
understand what's going on.

An obvious solution is to ignore ... and just use global variables, i. e.,
define degree <- 2 in the global environment and make the signature of
outfun function(beta).  That does work.  But I don't want to have to
explain this issue on the help pages if I can actually fix the problem.

I have no idea whether one needs to look at the source code for the
mcmc package to diagnose the issue.  If one does, it's on CRAN.

-- 
Charles Geyer
Professor, School of Statistics
University of Minnesota
charlie at stat.umn.edu


From murdoch at stats.uwo.ca  Sun Sep  6 23:34:11 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 06 Sep 2009 17:34:11 -0400
Subject: [Rd] question about ... passed to two different functions
In-Reply-To: <20090906175046.GB9915@stat.umn.edu>
References: <mailman.9.1252231204.24560.r-devel@r-project.org>
	<20090906175046.GB9915@stat.umn.edu>
Message-ID: <4AA42AD3.8080905@stats.uwo.ca>

On 06/09/2009 1:50 PM, Charles Geyer wrote:
> I have hit a problem with the design of the mcmc package I can't
> figure out, possibly because I don't really understand the R function
> call mechanism.  The function metrop in the mcmc package has a ... argument
> that it passes to one or two user-supplied functions, which are other
> arguments to metrop.  When the two functions don't have the same arguments,
> this doesn't work.  Here's an example.
> 
>  library(mcmc)
>  library(MASS)
> 
>  set.seed(42)
> 
>  n <- 100
>  rho <- 0.5
>  beta0 <- 0.25
>  beta1 <- 0.5
>  beta2 <- 1
>  beta3 <- 1.5
> 
>  Sigma <- matrix(rho, 3, 3)
>  diag(Sigma) <- 1
>  Sigma <- 0.75 * Sigma
>  Mu <- rep(0, 3)
> 
>  foo <- mvrnorm(n, Mu, Sigma)
> 
>  x1 <- foo[ , 1]
>  x2 <- foo[ , 2]
>  x3 <- foo[ , 3]
> 
>  modmat <- cbind(1, foo)
> 
>  eta <- beta0 + beta1 * x1 + beta2 * x2 + beta3 * x3
>  p <- 1 / (1 + exp(- eta))
>  y <- as.numeric(runif(n) < p)
> 
>  out <- glm(y ~ x1 + x2 + x3, family = binomial())
>  summary(out)
> 
>  ### now we want to do a Bayesian analysis of the model, so we write
>  ### a function that evaluates the log unnormalized density of the
>  ### Markov chain we want to run (log likelihood + log prior)
> 
>  ludfun <- function(beta) {
>      stopifnot(is.numeric(beta))
>      stopifnot(length(beta) == ncol(modmat))
>      eta <- as.numeric(modmat %*% beta)
>      logp <- ifelse(eta < 0, eta - log1p(exp(eta)), - log1p(exp(- eta)))
>      logq <- ifelse(eta < 0, - log1p(exp(eta)), - eta - log1p(exp(- eta)))
>      logl <- sum(logp[y == 1]) + sum(logq[y == 0])
>      val <- logl - sum(beta^2) / 2
>      return(val)
>  }
> 
>  beta.initial <- as.vector(out$coefficients)
> 
>  out <- metrop(ludfun, initial = beta.initial, nbatch = 20,
>      blen = 10, nspac = 5, scale = 0.56789)
> 
>  ### Works fine.  Here are the Monte Carlo estimates of the posterior
>  ### means for each parameter with Monte Carlo standard errors.
> 
>  apply(out$batch, 2, mean)
>  sqrt(apply(out$batch, 2, function(x) initseq(x)$var.con) / out$nbatch)
> 
>  ### Now suppose I want Monte Carlo estimates of some function of
>  ### the parameters other than the identity function.  I write a function
>  ### outfun that does that.  Also suppose I want some extra arguments
>  ### to outfun.  This example is a bit forced, but I hit on natural
>  ### examples with a new function (not yet released) that works like
>  ### metrop but does simulated tempering.
> 
>  outfun <- function(beta, degree) {
>      stopifnot(is.numeric(beta))
>      stopifnot(length(beta) == ncol(modmat))
>      stopifnot(is.numeric(degree))
>      stopifnot(length(degree) == 1)
>      stopifnot(degree == as.integer(degree))
>      stopifnot(length(degree) > 0)
>      result <- NULL
>      for (i in 1:degree)
>          result <- c(result, beta^i)
>      return(result)
>  }
> 
>  out <- metrop(out, outfun = outfun, degree = 2)
> 
>  ### Oops!  Try it and you get
>  ###
>  ### Error in obj(state, ...) : unused argument(s) (degree = 2)
> 
> I don't understand what the problem is (mostly because of ignorance).  Because
> 
>  foo <- function(x, ...) x
>  foo(x = 2, y = 3)
> 
> does work.  The error is happening when ludfun is called, and I assume
> the complaint is that it doesn't have an argument "degree", but then
> why doesn't the simple example just above fail?  So clearly I don't
> understand what's going on.

The difference between foo and ludfun is that foo has a ... argument, 
and ludfun doesn't.  So when ludfun gets called with argument degree=2, 
it doesn't know what to do with it.  foo just puts it into the ... and 
ignores it.

Generally ... is very handy when there's only one function that may have 
optional arguments, but less so when you have two or more sets of 
optional arguments to handle.  You can use list(...) to get the list of 
args and spend a lot of work splitting them up, or you could tell users 
that if they want to pass optional arguments to outfun then ludfun 
should also be prepared to receive them, or you could add a parameter 
"ludcontrol" to be a list of things to pass to ludfun, and "outcontrol" 
to be a list of things to pass to outfun.  Or do away with optional 
parameters completely.


> 
> An obvious solution is to ignore ... and just use global variables, i. e.,
> define degree <- 2 in the global environment and make the signature of
> outfun function(beta).  That does work.  But I don't want to have to
> explain this issue on the help pages if I can actually fix the problem.

That's one solution.  A somewhat better one is to keep the values local, 
but still keep the signature of the function the same.  For example,

outfun <- local({  degree <- 2
                    function(beta) {
                       ...
                    }
                 })

or a function that creates outfun, e.g.

makeOutfun <- function(degree) {
   force(degree)  # make sure it gets evaluated
   function(beta) {  # Now create a function that can see it.
      ...
   }
}

These two solutions are better than a global in that you can have 
multiple outfuns with different degree values.

> 
> I have no idea whether one needs to look at the source code for the
> mcmc package to diagnose the issue.  If one does, it's on CRAN.
> 

I don't think so, but if my advice is way off base, maybe so.

Duncan Murdoch


From hb at stat.berkeley.edu  Sun Sep  6 23:57:49 2009
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Sun, 6 Sep 2009 14:57:49 -0700
Subject: [Rd] R v2.9.2 patched still referred to as RC
Message-ID: <59d7961d0909061457q3363d5d2q6aac6a7ebef95ccb@mail.gmail.com>

R v2.9.2 patched is still referred to as RC:

 http://cran.r-project.org/bin/windows/base/rpatched.html

Since v2.9.2 is already out, this should be 'pat', correct?

/Henrik


From murdoch at stats.uwo.ca  Mon Sep  7 00:56:38 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 06 Sep 2009 18:56:38 -0400
Subject: [Rd] R v2.9.2 patched still referred to as RC
In-Reply-To: <59d7961d0909061457q3363d5d2q6aac6a7ebef95ccb@mail.gmail.com>
References: <59d7961d0909061457q3363d5d2q6aac6a7ebef95ccb@mail.gmail.com>
Message-ID: <4AA43E26.3050007@stats.uwo.ca>

On 06/09/2009 5:57 PM, Henrik Bengtsson wrote:
> R v2.9.2 patched is still referred to as RC:
> 
>  http://cran.r-project.org/bin/windows/base/rpatched.html
> 
> Since v2.9.2 is already out, this should be 'pat', correct?

The label was correct:  that was still the RC version.  The problem was 
that I forgot to switch the build script back to the regular patch builds.

I've done it now, so in a few hours you should get something more useful...

Duncan Murdoch


From paul.m.mcguire.jr at att.net  Mon Sep  7 01:20:14 2009
From: paul.m.mcguire.jr at att.net (paul.m.mcguire.jr at att.net)
Date: Mon,  7 Sep 2009 01:20:14 +0200 (CEST)
Subject: [Rd] OS X PDF bug (PR#13943)
Message-ID: <20090906232014.A7894282EF2D@mail.pubhealth.ku.dk>

par(mfrow=c(2,2))
y<-1:20
plot(y,  pch="+")
plot(y,  pch="+")
plot(y,  pch="+")
plot(y,  pch="+")

produces a pdf that is viewable in Preview (copied from the  
clipboard) but fails to print.

pch default or ="." or =3 prints.

Unfortunately pch=3 doesn't fix the mfrow=c(5,6) graph that I'm  
actually trying to print,
so the bug lies somewhere deeper.

OS X 10.4.11
R 2.9.2 GUI 1.29 Tiger build 32-bit (5464)
Laserjet 5MP

Paul McGuire


From ripley at stats.ox.ac.uk  Mon Sep  7 10:40:27 2009
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Mon,  7 Sep 2009 10:40:27 +0200 (CEST)
Subject: [Rd] OS X PDF bug (PR#13943)
Message-ID: <20090907084027.8B9CB282EEFA@mail.pubhealth.ku.dk>

On Mon, 7 Sep 2009, paul.m.mcguire.jr at att.net wrote:

No graphics device is specified here: which was it?

My guess is quartz() and that this is nothing to do with R but with 
copying in Mac OS X from a quartz() window.

> par(mfrow=c(2,2))
> y<-1:20
> plot(y,  pch="+")
> plot(y,  pch="+")
> plot(y,  pch="+")
> plot(y,  pch="+")
>
> produces a pdf that is viewable in Preview (copied from the
> clipboard) but fails to print.
>
> pch default or ="." or =3 prints.
>
> Unfortunately pch=3 doesn't fix the mfrow=c(5,6) graph that I'm
> actually trying to print,
> so the bug lies somewhere deeper.

Why not use pdf()?  That works for me (but then I don't have your 
printer drivers).

> OS X 10.4.11
> R 2.9.2 GUI 1.29 Tiger build 32-bit (5464)
> Laserjet 5MP
>
> Paul McGuire

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From romain.francois at dbmail.com  Mon Sep  7 11:05:42 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Mon, 07 Sep 2009 11:05:42 +0200
Subject: [Rd] R CMD INSTALL --clean
Message-ID: <4AA4CCE6.3090003@dbmail.com>

Hello,

I am using "R CMD INSTALL --clean" so that when my package is finished 
installed, a cleanup script is executed to post-process the generated 
html index file and add some more information. The cleanup (or 
cleanup.win script eventually calls the R code below)

This works well, but it depends on the --clean switch. Is there another 
way, or can I force --clean (for example from the configure script) ?

Romain


h2 <- function( txt ){
	sprintf( "<h2>%s</h2>\n", txt )
}
link <- function( txt, href ){
	sprintf( '<a href="%s">%s</a>', href, txt )
}
line <- function( link, txt ){
	sprintf( '<tr><td width="25%%">%s</td>\n<td>%s</td></tr>\n', link, txt )
}

ooindex.file <- file.path( Sys.getenv( "R_PACKAGE_DIR" ) , "html", 
"00Index.html" )
if( file.exists( ooindex.file ) ){
	# read the 00Index.html file
	ooindex <- readLines( ooindex.file )
	bottom <- grep( "^</table>", ooindex)
	bottom <- bottom[ length(bottom) ]
	
	# add java specific things
	txt <- paste(
		'</table>\n',
		h2( "Java" ),
		'<table width="100%">\n',
		line( link( "javadoc" , "../javadoc/index.html" ), "API documentation" ),
		"</table>\n"
	 )
	ooindex[ bottom ] <- txt
	
	# write back
	cat( ooindex, file = ooindex.file, sep = "\n" )
}

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/xMdt : update on the ant package
|- http://tr.im/xHLs : R capable version of ant
`- http://tr.im/xHiZ : Tip: get java home from R with rJava


From peter.ruckdeschel at web.de  Mon Sep  7 13:27:24 2009
From: peter.ruckdeschel at web.de (Peter Ruckdeschel)
Date: Mon, 07 Sep 2009 13:27:24 +0200
Subject: [Rd] some (minor) Rd issue: line breaking in \S4method within
	\usage{}
Message-ID: <h82r04$us2$1@ger.gmane.org>

Hi,

this is perhaps not so much an issue, but as you are currently
working on the Rd parser anyway...

When you want to document specific S4 methods for an S4 generic
by \S4method{} within a \usage{} environment, and the second
(signature_list) argument is "long", be it because you use multiple
dispatch, be it because you use long class-names, (or both), one
would probably like to be able to insert line breaks within the
signature list [or at least insert line breaks at suitable places
in the corresponding generated pdf file].

AFAICS this is not possible so far, at least I get errors in
R CMD check, whenever I try something like

\S4method{<myMethod>}{<ClassOf1stArgToDispatch>,
<ClassOf2ndArgToDispatch>}(<Name1stArgToDispatch>,<Name2ndArgToDispatch>)

i.e. if I insert a line break in the Rd file after any item of the
signature_list argument to \S4method.

Using line breaks in the the third (argument_list) argument is not a
problem, though.

So my little RFE would be to ask you to allow some optional line
breaking mechanism for the second argument of \S4method, too,
if this is not too hard to achieve.

Best regards

Peter


From murdoch at stats.uwo.ca  Mon Sep  7 15:23:35 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 07 Sep 2009 09:23:35 -0400
Subject: [Rd] some (minor) Rd issue: line breaking in \S4method within
 \usage{}
In-Reply-To: <h82r04$us2$1@ger.gmane.org>
References: <h82r04$us2$1@ger.gmane.org>
Message-ID: <4AA50957.8080808@stats.uwo.ca>

On 07/09/2009 7:27 AM, Peter Ruckdeschel wrote:
> Hi,
> 
> this is perhaps not so much an issue, but as you are currently
> working on the Rd parser anyway...
> 
> When you want to document specific S4 methods for an S4 generic
> by \S4method{} within a \usage{} environment, and the second
> (signature_list) argument is "long", be it because you use multiple
> dispatch, be it because you use long class-names, (or both), one
> would probably like to be able to insert line breaks within the
> signature list [or at least insert line breaks at suitable places
> in the corresponding generated pdf file].
> 
> AFAICS this is not possible so far, at least I get errors in
> R CMD check, whenever I try something like
> 
> \S4method{<myMethod>}{<ClassOf1stArgToDispatch>,
> <ClassOf2ndArgToDispatch>}(<Name1stArgToDispatch>,<Name2ndArgToDispatch>)
> 
> i.e. if I insert a line break in the Rd file after any item of the
> signature_list argument to \S4method.
> 
> Using line breaks in the the third (argument_list) argument is not a
> problem, though.
> 
> So my little RFE would be to ask you to allow some optional line
> breaking mechanism for the second argument of \S4method, too,
> if this is not too hard to achieve.

Do you get these errors in R-devel?  (If you'd posted a real example, 
I'd try it myself, but this is your wishlist item...)

Duncan Murdoch


From atp at piskorski.com  Mon Sep  7 16:47:28 2009
From: atp at piskorski.com (Andrew Piskorski)
Date: Mon, 7 Sep 2009 10:47:28 -0400
Subject: [Rd] Running two R instances at the same time
In-Reply-To: <b2050ab90909051131i15b413bci18300426406cbcea@mail.gmail.com>
References: <b2050ab90909051131i15b413bci18300426406cbcea@mail.gmail.com>
Message-ID: <20090907144728.GA85931@piskorski.com>

On Sat, Sep 05, 2009 at 08:31:18PM +0200, Peter Juhasz wrote:

> I don't understand how is this possible. Maybe there is an issue of
> thread-safety with the R backend, meaning that the two R *interpreter*
> instances are talking to the same backend that's capable of processing
> only one thing at a time?

No.  Particularly since there is no R "backend" involved at all, not
if you're starting up the standard R from Ubuntu 9.04 (rather than
Rserve or something else unusual).  People run multiple R processes
concurrently on the same (multi-core) machine all the time, works
fine.

> Please see http://www.perlmonks.org/?node_id=792460 for an extended
> discussion of the problem, and especially
> http://www.perlmonks.org/?node_id=793506 for excerpts of output and
> actual code.

The most likely explanation seems to be that you have a bug in your
Perl code.  Have you tried using your Perl framework to fork something
OTHER than R?  Have you tried manually starting up two R processes and
running your R code that way?  And, what is the actual R code you're
running?  You don't seem to have shown it anywhere.

-- 
Andrew Piskorski <atp at piskorski.com>
http://www.piskorski.com/


From atp at piskorski.com  Mon Sep  7 20:43:22 2009
From: atp at piskorski.com (Andrew Piskorski)
Date: Mon, 7 Sep 2009 14:43:22 -0400
Subject: [Rd] Running two R instances at the same time
In-Reply-To: <b2050ab90909070836w5fc0bbc5t643dcef4b06e7dba@mail.gmail.com>
References: <b2050ab90909051131i15b413bci18300426406cbcea@mail.gmail.com>
	<20090907144728.GA85931@piskorski.com>
	<b2050ab90909070836w5fc0bbc5t643dcef4b06e7dba@mail.gmail.com>
Message-ID: <20090907184322.GA17918@piskorski.com>

On Mon, Sep 07, 2009 at 05:36:38PM +0200, Peter Juhasz wrote:

> But please see http://www.perlmonks.org/index.pl?node_id=793907 ,
> where I posted my R code in its simplest form along with an example
> run which exhibits the symptoms I originally wrote about.

Ah, your two-process serialization is probably happening during that
cenros() call then.  (You may want to run with/without that call to
confirm.)  cenros() is in the NADA package and seems to use survreg()
from the survival package.  The survival package looks bigger than
NADA and includes a bunch of C code, so perhaps one of its C
implementations is using some sort of mutex-locked system call.  If
so, it'd be interesting to know where the serialization is happening.

  http://cran.r-project.org/web/packages/NADA/index.html
  http://cran.r-project.org/web/packages/survival/index.html

You may want to run your code under strace (perhaps with -cfF) and/or
ltrace, to get a list of C-level functions that are actually being
called.  That might give you an idea of where the blocking is
occurring, and could also help the NADA or survival package
maintainers when you ask them about this.

(But, hm, haven't any of your international collaborators run across
this serialization problem before?)

-- 
Andrew Piskorski <atp at piskorski.com>
http://www.piskorski.com/


From regetz at nceas.ucsb.edu  Mon Sep  7 21:03:04 2009
From: regetz at nceas.ucsb.edu (Jim Regetz)
Date: Mon, 07 Sep 2009 12:03:04 -0700
Subject: [Rd] performance of vector subscripting via character index
Message-ID: <4AA558E8.1020807@nceas.ucsb.edu>

Hi all,

Using character indexing on a vector is quite fast up through vector 
length of 46340, then it suddenly it gets 3 orders of magnitude slower. 
This is true at least of the special case in which the index vector is 
the complete (though possibly out-of-order) set of vector names:

test <- function(n) {
     vec <- seq_len(n)
     names(vec) <- as.character(vec)
     ind <- rev(names(vec))
     system.time(vec[ind])
}

test(46340)
##    user  system elapsed
##   0.012   0.000   0.009
test(46341)
##    user  system elapsed
##  11.805   0.000  11.805


There seems to be a rebound at just over twice the value of the 
threshold above, though I'll admit I didn't have the stamina to test all 
values in between:

test(92689)
##    user  system elapsed
##  48.951   0.000  48.946
test(92690)
##    user  system elapsed
##   0.036   0.000   0.038


And then worse again...

test(139022)
##    user  system elapsed
##   0.068   0.003   0.071
test(139023)
##    user  system elapsed
## 114.239   0.000 114.279

I see this on both Ubuntu 9.04 and OS X 10.6, using R 2.9.2 in both 
cases. Has this behavior already been identified? Using 'match' instead 
of direct character indexing is a serviceable workaround ... is it in 
fact the recommended approach in this case?

Thanks,
Jim


------------------------------
James Regetz, Ph.D.
Scientific Programmer/Analyst
National Center for Ecological Analysis & Synthesis
735 State St, Suite 300
Santa Barbara, CA 93101


From charlie at stat.umn.edu  Mon Sep  7 22:39:07 2009
From: charlie at stat.umn.edu (Charles Geyer)
Date: Mon, 7 Sep 2009 15:39:07 -0500
Subject: [Rd] question about ... passed to two different functions
In-Reply-To: <mailman.13.1252317606.32760.r-devel@r-project.org>
References: <mailman.13.1252317606.32760.r-devel@r-project.org>
Message-ID: <20090907203907.GA26049@stat.umn.edu>

Many thanks to those (Martin Morgan, Duncan Murdoch) who tried to straighten
me out on ... arguments.  It didn't work until I accidentally made two examples
I thought were the same but one worked and the other didn't.  Finally I
achieved enlightenment.  The following section has been added to the
help page for the metrop function and will appear on CRAN when I get finished
with the simulated tempering function.

\section{Warning}{
If \code{outfun} is missing or not a function, then the log unnormalized
density can be defined without a \ldots argument and that works fine.
One can define it starting \code{ludfun <- function(state)} and that works
or \code{ludfun <- function(state, foo, bar)}, where \code{foo} and \code{bar}
are supplied as additional arguments to \code{metrop}.

If \code{outfun} is a function, then both it and the log unnormalized
density function can be defined without \ldots arguments \emph{if they
have exactly the same arguments list} and that works fine.  Otherwise it
doesn't work.  Start the definitions \code{ludfun <- function(state, foo)}
and \code{outfun <- function(state, bar)} and you get an error about
unused arguments.  Instead start the definitions
\code{ludfun <- function(state, foo, \ldots)}
and \code{outfun <- function(state, bar, \ldots)}, supply
\code{foo} and \code{bar} as additional arguments to \code{metrop},
and that works fine.

In short, the log unnormalized density function and \code{outfun} need
to have \ldots in their arguments list to be safe.  Sometimes it works
when \ldots is left out and sometimes it doesn't.

Of course, one can avoid this whole issue by always defining the log
unnormalized density function and \code{outfun} to have only one argument
\code{state} and use global variables (objects in the R global environment) to
specify any other information these functions need to use.  That too
follows the R way.  But some people consider that bad programming practice.
}

I hope that sums it up.  Apologies for submitting a rather stupid question
to the list.
-- 
Charles Geyer
Professor, School of Statistics
University of Minnesota
charlie at stat.umn.edu


From hkawakat at gmail.com  Tue Sep  8 09:16:53 2009
From: hkawakat at gmail.com (Hiroyuki Kawakatsu)
Date: Tue, 8 Sep 2009 08:16:53 +0100
Subject: [Rd] make check fails in r49613
Message-ID: <307b90470909080016t3a6375b9g472dac35e5e1c4b0@mail.gmail.com>

Hi,

I am reporting what seems to be a trivial error in one of the test
files (this has been failing for a few days for me):

Collecting examples for package 'tools'
Running examples in package 'tools'
Error: testing 'tools' failed
Execution halted
gmake[3]: *** [test-Examples-Base] Error 1
gmake[3]: Leaving directory `/usr/local/share/R-devel/tests/Examples'
gmake[2]: *** [test-Examples] Error 2
gmake[2]: Leaving directory `/usr/local/share/R-devel/tests'
gmake[1]: *** [test-all-basics] Error 1
gmake[1]: Leaving directory `/usr/local/share/R-devel/tests'
gmake: *** [check] Error 2

erdos# tail /usr/local/share/R-devel/tests/Examples/tools-Ex.Rout.fail
> ### ** Examples
>
> ## Build the Rd db for the (installed) base package.
> db <- Rd_db("base")
> ## Run Rd_parse on all entries in the Rd db.
> db <- lapply(db, function(txt) Rd_parse(text = txt))
Error: 'Rd_parse' is defunct.
Use 'parse_Rd' instead.
See help("Defunct")
Execution halted

> sessionInfo()
R version 2.10.0 Under development (unstable) (2009-09-07 r49613)
x86_64-unknown-freebsd9.0

locale:
[1] C

attached base packages:
[1] tools     stats     graphics  grDevices utils     datasets  methods
[8] base

h.
-- 
+---
| Hiroyuki Kawakatsu
| Business School, Dublin City University
| Dublin 9, Ireland. Tel +353 (0)1 700 7496


From peter.juhasz83 at gmail.com  Mon Sep  7 17:36:38 2009
From: peter.juhasz83 at gmail.com (Peter Juhasz)
Date: Mon, 7 Sep 2009 17:36:38 +0200
Subject: [Rd] Running two R instances at the same time
In-Reply-To: <20090907144728.GA85931@piskorski.com>
References: <b2050ab90909051131i15b413bci18300426406cbcea@mail.gmail.com>
	<20090907144728.GA85931@piskorski.com>
Message-ID: <b2050ab90909070836w5fc0bbc5t643dcef4b06e7dba@mail.gmail.com>

On Mon, Sep 7, 2009 at 4:47 PM, Andrew Piskorski<atp at piskorski.com> wrote:
> On Sat, Sep 05, 2009 at 08:31:18PM +0200, Peter Juhasz wrote:
>
>> I don't understand how is this possible. Maybe there is an issue of
>> thread-safety with the R backend, meaning that the two R *interpreter*
>> instances are talking to the same backend that's capable of processing
>> only one thing at a time?
>
> No. ?Particularly since there is no R "backend" involved at all, not
> if you're starting up the standard R from Ubuntu 9.04 (rather than
> Rserve or something else unusual). ?People run multiple R processes
> concurrently on the same (multi-core) machine all the time, works
> fine.
>
>> Please see http://www.perlmonks.org/?node_id=792460 for an extended
>> discussion of the problem, and especially
>> http://www.perlmonks.org/?node_id=793506 for excerpts of output and
>> actual code.
>
> The most likely explanation seems to be that you have a bug in your
> Perl code. ?Have you tried using your Perl framework to fork something
> OTHER than R? ?Have you tried manually starting up two R processes and
> running your R code that way? ?And, what is the actual R code you're
> running? ?You don't seem to have shown it anywhere.
>
> --
> Andrew Piskorski <atp at piskorski.com>
> http://www.piskorski.com/
>

Actually, I have ran some tests that clarified the issue somewhat.

- It is always possible that my Perl code is buggy but that doesn't
seem to play a role in this case.
- I tried to use my Perl system to start two non-R processes - it
worked as expected, they ran concurrently without ill effects.

But please see http://www.perlmonks.org/index.pl?node_id=793907 ,
where I posted my R code in its simplest form along with an example
run which exhibits the symptoms I originally wrote about.

>From that test I conclude that it is not my Perl code nor R itself
that is wrong here, but the specific package I use. That package -
NADA, from which I use the 'cenros' command - seems to be the culprit.

Please forgive my complete lack of experience when it comes to R, this
made me assume things that didn't make sense.

P?ter Juh?sz


From paul.m.mcguire.jr at att.net  Mon Sep  7 18:10:29 2009
From: paul.m.mcguire.jr at att.net (paul.m.mcguire.jr at att.net)
Date: Mon,  7 Sep 2009 18:10:29 +0200 (CEST)
Subject: [Rd] OS X PDF bug (PR#13943)
Message-ID: <20090907161029.497E9282EF4E@mail.pubhealth.ku.dk>

On Sep 7, 2009, at 4:37 AM, Prof Brian Ripley wrote:
> My guess is quartz() and that this is nothing to do with R but with  
> copying in Mac OS X from a quartz() window.

Saving to a file from the quartz window also produces a PDF
that is viewable but not printable by Preview, and Acrobat too.

I suppose it could be the printer driver, though that means that R
is guilty of putting out some pretty exotic Postscript.  I'm hoping
someone else sees this or doesn't so I can pin it down.

Paul

>> par(mfrow=c(2,2))
>> y<-1:20
>> plot(y,  pch="+")
>> plot(y,  pch="+")
>> plot(y,  pch="+")
>> plot(y,  pch="+")
>>
>> produces a pdf that is viewable in Preview (copied from the
>> clipboard) but fails to print.
>>
>> pch default or ="." or =3 prints.
>>
>> Unfortunately pch=3 doesn't fix the mfrow=c(5,6) graph that I'm
>> actually trying to print,
>> so the bug lies somewhere deeper.
>
> Why not use pdf()?  That works for me (but then I don't have your  
> printer drivers).
>
>> OS X 10.4.11
>> R 2.9.2 GUI 1.29 Tiger build 32-bit (5464)
>> Laserjet 5MP
>>
>> Paul McGuire
>
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From guillaume.yziquel at citycable.ch  Tue Sep  8 00:20:25 2009
From: guillaume.yziquel at citycable.ch (Guillaume Yziquel)
Date: Tue, 08 Sep 2009 00:20:25 +0200
Subject: [Rd] [R] Usage of OCaml/R binding.
In-Reply-To: <4AA4D30F.2060206@citycable.ch>
References: <4AA4D30F.2060206@citycable.ch>
Message-ID: <4AA58729.3060104@citycable.ch>

Hello.

Since nobody answered this on R-help@, I thought I'd push it through to 
R-devel at .

By the way, here's the webpage (in french) for the Debian package of 
Maxence Guesdon's OCaml/R bindings:

	http://yziquel.homelinux.org/topos/debian-ocamlr.html
	http://yziquel.homelinux.org/debian/pool/main/o/ocaml-r/

Guillaume Yziquel a ?crit :
> Hello.
> 
> I've been pulling together a Debian package out of Maxence Guesdon's 
> OCaml bindings for R. Will be available from my website as soon as I get 
> my router to obey me. Here's Maxence's bindings:
> 
>     http://pauillac.inria.fr/~guesdon/ocaml-r.en.html
> 
> The purpose of this software is to access R from OCaml programs.
> 
> However, my issue is that after having pulled things to a Debian 
> package, I am completely unfamiliar with the API, and I'm having trouble 
> initialising this module.
> 
> You'll find below a list of the functions accessible from Maxence 
> Guesdon's R module (there's also a Rmath module for the math library 
> which I'm not yet concerned about).
> 
> I'd specifically appreciate information on how to get started using 
> these R API functions. If you're scared about OCaml, simply look at the 
> two declarations below in the following way:
> 
>     external init_r : string array -> int = "init_r"
> 
> 'external' means that this value is to be fetched by linking C code 
> identified by the '= "init_r"' ending statement. Typically, 'external' 
> values wrap the API functions. So this value is called init_r, and takes 
> an array of strings as first argument, and yields back an integer.
> 
>     val init : ?argv:string array -> unit -> int
> 
> 'val' means that it is a standard OCaml value. It's called init. And its 
> type is 'I take an array of strings as first argument, then a unit ( 
> think of it a C void value containing nothing), and I get back an 
> integer. The '?argv:' stuff is concerned with optional arguments, so no 
> real big deal.
> 
> Documentation and examples of how the API works to embed R in an 
> application would be highly appreciated. Please forward this email to 
> R-dev if you feel it belongs there.
> 
> All the best,
> 
> Guillaume Yziquel.
> 
>> yziquel at seldon:~/sandbox/repo/debian/debian-ocaml/ocaml-r$ 
>> ocaml-batteries         Objective Caml version 3.11.1
>>
>>       _________________________________
>>      |       | |                       |
>>     [| +     | | Batteries Included  - |
>>      |_______|_|_______________________|
>>       _________________________________
>>      |                       | |       |
>>      | -    Type '#help;;'   | |     + |]
>>      |_______________________|_|_______|
>>
>>
>> # #rectypes;;
>> # #require "R";;
>> # module X = R;;
>> module X :
>>   sig
>>     external init_r : string array -> int = "init_r"
>>     val init : ?argv:string array -> unit -> int
>>     external terminate : unit -> unit = "end_r"
>>     type sexp = R.sexp
>>     type symbol = string
>>     type arg = [ `Anon of sexp | `Named of sexp * symbol ]
>>     external sexp : string -> sexp = "r_sexp_of_string"
>>     external sexp_of_symbol : symbol -> sexp = "r_sexp_of_symbol"
>>     external set_var : symbol -> sexp -> unit = "r_set_var"
>>     external r_print_value : sexp -> unit = "r_print_value"
>>     external exec : string -> arg array -> unit = "r_exec"
>>     external current_test : unit -> unit = "r_current_test"
>>     external to_bool : sexp -> bool = "bool_of_sexp"
>>     external to_int : sexp -> int = "int_of_sexp"
>>     external to_float : sexp -> float = "float_of_sexp"
>>     external to_string : sexp -> string = "string_of_sexp"
>>     external of_bool : bool -> sexp = "sexp_of_bool"
>>     external of_int : int -> sexp = "sexp_of_int"
>>     external of_float : float -> sexp = "sexp_of_float"
>>     external of_string : string -> sexp = "sexp_of_string"
>>     external to_bool_array : sexp -> bool array = "bool_array_of_sexp"
>>     external to_int_array : sexp -> int array = "int_array_of_sexp"
>>     external to_float_array : sexp -> float array = "float_array_of_sexp"
>>     external to_string_array : sexp -> string array = 
>> "string_array_of_sexp"
>>     external of_bool_array : bool array -> sexp = "sexp_of_bool_array"
>>     external of_int_array : int array -> sexp = "sexp_of_int_array"
>>     external of_float_array : float array -> sexp = "sexp_of_float_array"
>>     external of_string_array : string array -> sexp = 
>> "sexp_of_string_array"
>>     external get_attrib : sexp -> string -> sexp = "r_get_attrib"
>>     val dim : sexp -> int array
>>     val dimnames : sexp -> string array
>>   end
>> # 
> 
> 


-- 
      Guillaume Yziquel
http://yziquel.homelinux.org/


From ligges at statistik.tu-dortmund.de  Tue Sep  8 10:17:16 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 08 Sep 2009 10:17:16 +0200
Subject: [Rd] make check fails in r49613
In-Reply-To: <307b90470909080016t3a6375b9g472dac35e5e1c4b0@mail.gmail.com>
References: <307b90470909080016t3a6375b9g472dac35e5e1c4b0@mail.gmail.com>
Message-ID: <4AA6130C.8050402@statistik.tu-dortmund.de>

I have successfully build r49614 this morning. Have you tried to do a 
clean build from a fresh source directory? Do you have some library with 
old packages in your search path?

Uwe Ligges




Hiroyuki Kawakatsu wrote:
> Hi,
> 
> I am reporting what seems to be a trivial error in one of the test
> files (this has been failing for a few days for me):
> 
> Collecting examples for package 'tools'
> Running examples in package 'tools'
> Error: testing 'tools' failed
> Execution halted
> gmake[3]: *** [test-Examples-Base] Error 1
> gmake[3]: Leaving directory `/usr/local/share/R-devel/tests/Examples'
> gmake[2]: *** [test-Examples] Error 2
> gmake[2]: Leaving directory `/usr/local/share/R-devel/tests'
> gmake[1]: *** [test-all-basics] Error 1
> gmake[1]: Leaving directory `/usr/local/share/R-devel/tests'
> gmake: *** [check] Error 2
> 
> erdos# tail /usr/local/share/R-devel/tests/Examples/tools-Ex.Rout.fail
>> ### ** Examples
>>
>> ## Build the Rd db for the (installed) base package.
>> db <- Rd_db("base")
>> ## Run Rd_parse on all entries in the Rd db.
>> db <- lapply(db, function(txt) Rd_parse(text = txt))
> Error: 'Rd_parse' is defunct.
> Use 'parse_Rd' instead.
> See help("Defunct")
> Execution halted
> 
>> sessionInfo()
> R version 2.10.0 Under development (unstable) (2009-09-07 r49613)
> x86_64-unknown-freebsd9.0
> 
> locale:
> [1] C
> 
> attached base packages:
> [1] tools     stats     graphics  grDevices utils     datasets  methods
> [8] base
> 
> h.


From hkawakat at gmail.com  Tue Sep  8 12:32:26 2009
From: hkawakat at gmail.com (Hiroyuki Kawakatsu)
Date: Tue, 8 Sep 2009 11:32:26 +0100
Subject: [Rd] make check fails in r49613
In-Reply-To: <4AA6130C.8050402@statistik.tu-dortmund.de>
References: <307b90470909080016t3a6375b9g472dac35e5e1c4b0@mail.gmail.com>
	<4AA6130C.8050402@statistik.tu-dortmund.de>
Message-ID: <307b90470909080332p21559869rb8e20e3149ad803a@mail.gmail.com>

2009/9/8 Uwe Ligges wrote:
> I have successfully build r49614 this morning. Have you tried to do a clean
> build from a fresh source directory? Do you have some library with old
> packages in your search path?

Ah, thanks for this. After removing library/ and rebuilding, I now
pass -(g)make check-. I now see the message 'Extracting from parsed
Rd's' which i didn't see before. And I now vaguely recall seeing
something about the new Rd conversion mechanism.

R-admin recommends not to build in the top-level source directory
(which I do) when working with svn. Does this mean that after I check
out from svn, I now need to remove library/ every time before I do
-make- and -make check-? Or is this a one-time thing?

h.
-- 
+---
| Hiroyuki Kawakatsu
| Business School, Dublin City University
| Dublin 9, Ireland. Tel +353 (0)1 700 7496


From ligges at statistik.tu-dortmund.de  Tue Sep  8 12:36:50 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 08 Sep 2009 12:36:50 +0200
Subject: [Rd] make check fails in r49613
In-Reply-To: <307b90470909080332p21559869rb8e20e3149ad803a@mail.gmail.com>
References: <307b90470909080016t3a6375b9g472dac35e5e1c4b0@mail.gmail.com>	
	<4AA6130C.8050402@statistik.tu-dortmund.de>
	<307b90470909080332p21559869rb8e20e3149ad803a@mail.gmail.com>
Message-ID: <4AA633C2.5010905@statistik.tu-dortmund.de>



Hiroyuki Kawakatsu wrote:
> 2009/9/8 Uwe Ligges wrote:
>> I have successfully build r49614 this morning. Have you tried to do a clean
>> build from a fresh source directory? Do you have some library with old
>> packages in your search path?
> 
> Ah, thanks for this. After removing library/ and rebuilding, I now
> pass -(g)make check-. I now see the message 'Extracting from parsed
> Rd's' which i didn't see before. And I now vaguely recall seeing
> something about the new Rd conversion mechanism.
> 
> R-admin recommends not to build in the top-level source directory
> (which I do) when working with svn. Does this mean that after I check
> out from svn, I now need to remove library/ every time before I do
> -make- and -make check-? Or is this a one-time thing?


Not a one-time thing, it depends on the changes in the soucres, and most 
of the days it works, but sometimes after more serious changes not.

make clean might help, but I prefer to copy from my svn checkout to 
another directory and build there.

Uwe Ligges

> h.


From murdoch at stats.uwo.ca  Tue Sep  8 12:42:04 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 08 Sep 2009 06:42:04 -0400
Subject: [Rd] make check fails in r49613
In-Reply-To: <307b90470909080332p21559869rb8e20e3149ad803a@mail.gmail.com>
References: <307b90470909080016t3a6375b9g472dac35e5e1c4b0@mail.gmail.com>	<4AA6130C.8050402@statistik.tu-dortmund.de>
	<307b90470909080332p21559869rb8e20e3149ad803a@mail.gmail.com>
Message-ID: <4AA634FC.5050702@stats.uwo.ca>

On 08/09/2009 6:32 AM, Hiroyuki Kawakatsu wrote:
> 2009/9/8 Uwe Ligges wrote:
>> I have successfully build r49614 this morning. Have you tried to do a clean
>> build from a fresh source directory? Do you have some library with old
>> packages in your search path?
> 
> Ah, thanks for this. After removing library/ and rebuilding, I now
> pass -(g)make check-. I now see the message 'Extracting from parsed
> Rd's' which i didn't see before. And I now vaguely recall seeing
> something about the new Rd conversion mechanism.
> 
> R-admin recommends not to build in the top-level source directory
> (which I do) when working with svn. Does this mean that after I check
> out from svn, I now need to remove library/ every time before I do
> -make- and -make check-? Or is this a one-time thing?

Somewhere between.  It's usually okay to build there, but not always. 
When things get weird, it's worth doing a clean build just to check if 
you're in one of the cases where it's not okay.

Duncan Murdoch


From paboyoun at fhcrc.org  Tue Sep  8 18:14:51 2009
From: paboyoun at fhcrc.org (Patrick Aboyoun)
Date: Tue, 08 Sep 2009 09:14:51 -0700
Subject: [Rd] Reissue: Base "Object" class to use in S4 slot specification
In-Reply-To: <4A8998CD.7070708@fhcrc.org>
References: <4A8998CD.7070708@fhcrc.org>
Message-ID: <4AA682FB.2000201@fhcrc.org>

This is a reissue of a question I had asked a few weeks ago to see if 
anyone had any thoughts on the matter.

I am looking to have slot in an S4 class definition that can take any 
(S3 or S4) object. The ANY class seemed to be a good candidate, but the 
is() function definition performs an S3Case test before checking if 
methods:::.identC(class2, "ANY"). The result is the is() function does 
not consider various S3 objects to be of class ANY.

 > is(factor(), "ANY")
[1] FALSE
 > is(lm(I(1:10) ~ rnorm(10)), "ANY")
[1] FALSE
 > sessionInfo()
R version 2.10.0 Under development (unstable) (2009-09-07 r49613)
i386-apple-darwin9.8.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base    

What is the recommended base "Object" class I should define my slot to 
be so it can accept any object?



Patrick


From simon.urbanek at r-project.org  Tue Sep  8 18:39:57 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 8 Sep 2009 12:39:57 -0400
Subject: [Rd] Reissue: Base "Object" class to use in S4 slot
	specification
In-Reply-To: <4AA682FB.2000201@fhcrc.org>
References: <4A8998CD.7070708@fhcrc.org> <4AA682FB.2000201@fhcrc.org>
Message-ID: <92984B14-5FA3-4080-B935-E53BBEF4FEAD@r-project.org>


On Sep 8, 2009, at 12:14 , Patrick Aboyoun wrote:

> This is a reissue of a question I had asked a few weeks ago to see  
> if anyone had any thoughts on the matter.
>
> I am looking to have slot in an S4 class definition that can take  
> any (S3 or S4) object. The ANY class seemed to be a good candidate,  
> but the is() function definition performs an S3Case test before  
> checking if methods:::.identC(class2, "ANY"). The result is the is()  
> function does not consider various S3 objects to be of class ANY.
>

Yes, but how is that relevant to your question? A slot defined as  
"ANY" will accept any type in R:

 > setClass("foo",representation(a="ANY"))
[1] "foo"
 > new("foo",a=factor())
An object of class "foo"
Slot "a":
factor(0)
Levels:

"ANY" is not an S4 class (and neither are various other types in R),  
so is() correctly returns FALSE.

Cheers,
Simon


> > is(factor(), "ANY")
> [1] FALSE
> > is(lm(I(1:10) ~ rnorm(10)), "ANY")
> [1] FALSE
> > sessionInfo()
> R version 2.10.0 Under development (unstable) (2009-09-07 r49613)
> i386-apple-darwin9.8.0
>
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> What is the recommended base "Object" class I should define my slot  
> to be so it can accept any object?
>
>
>
> Patrick
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From simon.urbanek at r-project.org  Tue Sep  8 18:44:15 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 8 Sep 2009 12:44:15 -0400
Subject: [Rd] Reissue: Base "Object" class to use in S4 slot
	specification
In-Reply-To: <92984B14-5FA3-4080-B935-E53BBEF4FEAD@r-project.org>
References: <4A8998CD.7070708@fhcrc.org> <4AA682FB.2000201@fhcrc.org>
	<92984B14-5FA3-4080-B935-E53BBEF4FEAD@r-project.org>
Message-ID: <7F75A342-607E-4F69-B6DF-D9BA84F1B980@r-project.org>


On Sep 8, 2009, at 12:39 , Simon Urbanek wrote:

>
> On Sep 8, 2009, at 12:14 , Patrick Aboyoun wrote:
>
>> This is a reissue of a question I had asked a few weeks ago to see  
>> if anyone had any thoughts on the matter.
>>
>> I am looking to have slot in an S4 class definition that can take  
>> any (S3 or S4) object. The ANY class seemed to be a good candidate,  
>> but the is() function definition performs an S3Case test before  
>> checking if methods:::.identC(class2, "ANY"). The result is the  
>> is() function does not consider various S3 objects to be of class  
>> ANY.
>>
>
> Yes, but how is that relevant to your question? A slot defined as  
> "ANY" will accept any type in R:
>
> > setClass("foo",representation(a="ANY"))
> [1] "foo"
> > new("foo",a=factor())
> An object of class "foo"
> Slot "a":
> factor(0)
> Levels:
>
> "ANY" is not an S4 class (and neither are various other types in R),  
> so is() correctly returns FALSE.
>

Ok, sorry, the last sentence is false -  "ANY" is a virtual S4 class,  
so it will return TRUE for S4 classes and FALSE for any other object.

Cheers,
Simon


>
>
>> > is(factor(), "ANY")
>> [1] FALSE
>> > is(lm(I(1:10) ~ rnorm(10)), "ANY")
>> [1] FALSE
>> > sessionInfo()
>> R version 2.10.0 Under development (unstable) (2009-09-07 r49613)
>> i386-apple-darwin9.8.0
>>
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> What is the recommended base "Object" class I should define my slot  
>> to be so it can accept any object?
>>
>>
>>
>> Patrick
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>


From wdunlap at tibco.com  Tue Sep  8 19:08:01 2009
From: wdunlap at tibco.com (William Dunlap)
Date: Tue, 8 Sep 2009 10:08:01 -0700
Subject: [Rd] question about ... passed to two different functions
In-Reply-To: <20090907203907.GA26049@stat.umn.edu>
References: <mailman.13.1252317606.32760.r-devel@r-project.org>
	<20090907203907.GA26049@stat.umn.edu>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D70001C236D8@NA-PA-VBE03.na.tibco.com>

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Charles Geyer
> Sent: Monday, September 07, 2009 1:39 PM
> To: r-devel at r-project.org
> Subject: Re: [Rd] question about ... passed to two different functions
> 
> Many thanks to those (Martin Morgan, Duncan Murdoch) who 
> tried to straighten
> me out on ... arguments.  It didn't work until I accidentally 
> made two examples
> I thought were the same but one worked and the other didn't.  
> Finally I
> achieved enlightenment.  The following section has been added to the
> help page for the metrop function and will appear on CRAN 
> when I get finished
> with the simulated tempering function.
> 
> \section{Warning}{
> If \code{outfun} is missing or not a function, then the log 
> unnormalized
> density can be defined without a \ldots argument and that works fine.
> One can define it starting \code{ludfun <- function(state)} 
> and that works
> or \code{ludfun <- function(state, foo, bar)}, where 
> \code{foo} and \code{bar}
> are supplied as additional arguments to \code{metrop}.
> 
> If \code{outfun} is a function, then both it and the log unnormalized
> density function can be defined without \ldots arguments \emph{if they
> have exactly the same arguments list} and that works fine.  
> Otherwise it
> doesn't work.  Start the definitions \code{ludfun <- 
> function(state, foo)}
> and \code{outfun <- function(state, bar)} and you get an error about
> unused arguments.  Instead start the definitions
> \code{ludfun <- function(state, foo, \ldots)}
> and \code{outfun <- function(state, bar, \ldots)}, supply
> \code{foo} and \code{bar} as additional arguments to \code{metrop},
> and that works fine.
> 
> In short, the log unnormalized density function and \code{outfun} need
> to have \ldots in their arguments list to be safe.  Sometimes it works
> when \ldots is left out and sometimes it doesn't.
> 
> Of course, one can avoid this whole issue by always defining the log
> unnormalized density function and \code{outfun} to have only 
> one argument
> \code{state} and use global variables (objects in the R 
> global environment) to
> specify any other information these functions need to use.  That too
> follows the R way.  But some people consider that bad 
> programming practice.
> }

Instead of putting the extra inputs in the global environment
you might recommend putting them into a more private
environment.  E.g., something like
    metrop(..., outfun=local({degree=2;function(beta)beta^degree}))


Bill Dunlap
TIBCO Software Inc - Spotfire Division
wdunlap tibco.com 

> 
> I hope that sums it up.  Apologies for submitting a rather 
> stupid question
> to the list.
> -- 
> Charles Geyer
> Professor, School of Statistics
> University of Minnesota
> charlie at stat.umn.edu
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From paboyoun at fhcrc.org  Tue Sep  8 20:12:15 2009
From: paboyoun at fhcrc.org (Patrick Aboyoun)
Date: Tue, 08 Sep 2009 11:12:15 -0700
Subject: [Rd] Reissue: Base "Object" class to use in S4 slot
	specification
In-Reply-To: <7F75A342-607E-4F69-B6DF-D9BA84F1B980@r-project.org>
References: <4A8998CD.7070708@fhcrc.org> <4AA682FB.2000201@fhcrc.org>
	<92984B14-5FA3-4080-B935-E53BBEF4FEAD@r-project.org>
	<7F75A342-607E-4F69-B6DF-D9BA84F1B980@r-project.org>
Message-ID: <4AA69E7F.3030702@fhcrc.org>

Simon,
I don't want to get too deep into specific implementations here so we 
don't get stuck in the weeds. (The original issue started with a typed 
list class infrastructure in BioC's IRanges package that checked to see 
if the elements conformed to the expected class.)

To make this issue as narrow as possible for now, I'll rephrase my issue 
to be inconsistent behavior between is and extends for class ANY. All 
classes (even non-existent ones) extend ANY according to 
methods::extends, but only S4 objects are of class ANY according to 
methods::is. This could be reconciled if is() checked if 
methods:::.identC(class2, "ANY") before it performed an S3Case test.

 > is(factor(), "ANY")
[1] FALSE
 > extends("factor", "ANY")
[1] TRUE
 > is(lm(I(1:10) ~ rnorm(10)), "ANY")
[1] FALSE
 > extends("lm", "ANY")
[1] TRUE
 > sessionInfo()
R version 2.10.0 Under development (unstable) (2009-09-07 r49613)
i386-apple-darwin9.8.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base


Patrick



Simon Urbanek wrote:
>
> On Sep 8, 2009, at 12:39 , Simon Urbanek wrote:
>
>>
>> On Sep 8, 2009, at 12:14 , Patrick Aboyoun wrote:
>>
>>> This is a reissue of a question I had asked a few weeks ago to see 
>>> if anyone had any thoughts on the matter.
>>>
>>> I am looking to have slot in an S4 class definition that can take 
>>> any (S3 or S4) object. The ANY class seemed to be a good candidate, 
>>> but the is() function definition performs an S3Case test before 
>>> checking if methods:::.identC(class2, "ANY"). The result is the is() 
>>> function does not consider various S3 objects to be of class ANY.
>>>
>>
>> Yes, but how is that relevant to your question? A slot defined as 
>> "ANY" will accept any type in R:
>>
>> > setClass("foo",representation(a="ANY"))
>> [1] "foo"
>> > new("foo",a=factor())
>> An object of class "foo"
>> Slot "a":
>> factor(0)
>> Levels:
>>
>> "ANY" is not an S4 class (and neither are various other types in R), 
>> so is() correctly returns FALSE.
>>
>
> Ok, sorry, the last sentence is false -  "ANY" is a virtual S4 class, 
> so it will return TRUE for S4 classes and FALSE for any other object.
>
> Cheers,
> Simon
>
>
>>
>>
>>> > is(factor(), "ANY")
>>> [1] FALSE
>>> > is(lm(I(1:10) ~ rnorm(10)), "ANY")
>>> [1] FALSE
>>> > sessionInfo()
>>> R version 2.10.0 Under development (unstable) (2009-09-07 r49613)
>>> i386-apple-darwin9.8.0
>>>
>>> locale:
>>> [1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>> What is the recommended base "Object" class I should define my slot 
>>> to be so it can accept any object?
>>>
>>>
>>>
>>> Patrick
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>
>


From paboyoun at fhcrc.org  Tue Sep  8 21:21:48 2009
From: paboyoun at fhcrc.org (Patrick Aboyoun)
Date: Tue, 08 Sep 2009 12:21:48 -0700
Subject: [Rd] Difference between is(<<arg>>, "ANY") and extends(<<arg>>,
	"ANY")
In-Reply-To: <4AA69E7F.3030702@fhcrc.org>
References: <4A8998CD.7070708@fhcrc.org>
	<4AA682FB.2000201@fhcrc.org>	<92984B14-5FA3-4080-B935-E53BBEF4FEAD@r-project.org>	<7F75A342-607E-4F69-B6DF-D9BA84F1B980@r-project.org>
	<4AA69E7F.3030702@fhcrc.org>
Message-ID: <4AA6AECC.5030504@fhcrc.org>

Forgive the multiple posts, but I am resending a issue under a new 
subject so it doesn't get lost. There is inconsistent behavior between 
is and extends for class ANY. All classes (even non-existent ones) 
extend ANY according to methods::extends, but only S4 objects are of 
class ANY according to methods::is. This could be reconciled if is() 
checked if methods:::.identC(class2, "ANY") before it performed an 
S3Case test.

 > is(factor(), "ANY")
[1] FALSE
 > extends("factor", "ANY")
[1] TRUE
 > is(lm(I(1:10) ~ rnorm(10)), "ANY")
[1] FALSE
 > extends("lm", "ANY")
[1] TRUE
 > sessionInfo()
R version 2.10.0 Under development (unstable) (2009-09-07 r49613)
i386-apple-darwin9.8.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base


Patrick


From bownes at gmail.com  Tue Sep  8 23:23:54 2009
From: bownes at gmail.com (Bob Bownes)
Date: Tue, 8 Sep 2009 17:23:54 -0400
Subject: [Rd] Simple ./config option to disable networking
Message-ID: <6f68bf030909081423t434ed8fax43309382c7fcf440@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090908/578bb6a6/attachment.pl>

From cgenolin at u-paris10.fr  Wed Sep  9 15:14:15 2009
From: cgenolin at u-paris10.fr (Christophe Genolini)
Date: Wed, 09 Sep 2009 15:14:15 +0200
Subject: [Rd] Package that does not work until I re write the exactly the
 same code
Message-ID: <4AA7AA27.8080504@u-paris10.fr>

Hi the list,

I am writing a package in S4 and I do not manage to understand a bug.
The "R CMD check" and the "R CMD build" both work. Here is links to the 
package (not on CRAN yet for the raison that I explain bellow):

http://christophe.genolini.free.fr/aTelecharger/kml_0.5.zip
http://christophe.genolini.free.fr/aTelecharger/kml_0.5.tar.gz

Then I install the package and I try an example:

--- 8< --------------
library(kml)
dn <- as.cld(gald())
kml(dn)
# XXX ~ Fast KmL ~
# Erreur dans as.vector(x, mode) : argument 'mode' incorrect
--- 8< --------------


So I make some verifications:
--- 8< ----
class(dn)
# [1] "ClusterizLongData"
# attr(,"package")
# [1] "kml"

getMethod("kml","ClusterizLongData")
# Method Definition:
#
# function (Object, nbClusters = 2:6, nbRedrawing = 20, saveFreq = 100,
#   maxIt = 200, trajMinSize = 2, print.cal = FALSE, print.traj = FALSE,
#    imputationMethod = "copyMean", distance, power = 2, centerMethod = 
meanNA,
#    startingCond = "allMethods", distanceStartingCond = "euclidean", 
#   ...)
#{
#   nbIdFull <- nrow(Object["traj"])
# ...... [[[The full code is available below]]]
# }
# <environment: namespace:kml>
#
#Signatures:
#       Object            
# target  "ClusterizLongData"
# defined "ClusterizLongData"
--- 8< ----

Everything seems fine. The code is correct.
So I copy-and-paste the code that I get with 
getMethods("kml","ClusterizLongData") and I affect it to a function 
"func". Then I define again the method "kml".

Then I run again the example that does not work before and it works...
Any explanations?

Christophe Genolini

--- 8< --------------------------
###
### Affecting to func the code that getMethod("kml","ClusterizLongData") 
delivers
###
func <- function (Object, nbClusters = 2:6, nbRedrawing = 20, saveFreq = 
100,
    maxIt = 200, trajMinSize = 2, print.cal = FALSE, print.traj = FALSE,
    imputationMethod = "copyMean", distance, power = 2, centerMethod = 
meanNA,
    startingCond = "allMethods", distanceStartingCond = "euclidean",
    ...)
{
    nbIdFull <- nrow(Object["traj"])
    convergenceTime <- 0
    noNA <- selectSupTrajMinSize(Object, trajMinSize)
    trajNoNA <- Object["traj"][noNA, ]
    nbTime <- length(Object["time"])
    nbId <- nrow(trajNoNA)
    saveCld <- 0
    scr <- plotAll(Object, print.cal = print.cal, print.traj = print.traj,
        print.sub = FALSE, col = "black", type.mean = "n")
    if (length(startingCond) == 1) {
        if (startingCond == "allMethods") {
            startingCond <- c("maxDist", "randomAll", rep("randomK",
                nbRedrawing))[1:nbRedrawing]
        }
        else {
            startingCond <- rep(startingCond, nbRedrawing)
        }
    }
    else {
    }
    if (missing(distance)) {
        distance <- "euclidean"
    }
    if (is.character(distance)) {
        distInt <- pmatch(distance, METHODS)
    }
    else {
        distInt <- NA
    }
    if (print.traj) {
        cat(" ~ Slow KmL ~\n")
        fast <- FALSE
        screenPlot <- scr[2]
        if (!is.na(distInt)) {
            distanceSlow <- function(x, y) {
                dist(rbind(x, y), method = distance)
            }
        }
        else {
            distanceSlow <- distance
        }
    }
    else {
        screenPlot <- NA
        if (is.na(distInt)) {
            cat(" ~ Slow KmL ~\n")
            fast <- FALSE
            distanceSlow <- distance
        }
        else {
            cat(" ~ Fast KmL ~\n")
            fast <- TRUE
        }
    }
    nameObject <- deparse(substitute(Object))
    for (iRedraw in 1:nbRedrawing) {
        for (iNbClusters in nbClusters) {
            saveCld <- saveCld + 1
            clustersInit <- partitionInitialise(nbClusters = iNbClusters,
                method = startingCond[iRedraw], lengthPart = nbId,
                matrixDist = as.matrix(dist(trajNoNA, method = 
distanceStartingCond)))
            clust <- rep(NA, nbIdFull)
            if (fast) {
                resultKml <- .C("kml1", as.double(t(trajNoNA)),
                  iNbInd = as.integer(nbId), iNbTime = as.integer(nbTime),
                  iNbCluster = as.integer(iNbClusters), maxIt = 
as.integer(maxIt),
                  distance = as.integer(distInt), power = 
as.numeric(power),
                  vClusterAffectation1 = 
as.integer(clustersInit["clusters"]),
                  convergenceTime = as.integer(convergenceTime),
                  NAOK = TRUE, PACKAGE = "kml")[c(8, 9)]
                clust[noNA] <- resultKml[[1]]
            }
            else {
                resultKml <- trajKmlSlow(traj = trajNoNA, 
clusterAffectation = clustersInit,
                  nbId = nbId, nbTime = nbTime, maxIt = maxIt,
                  screenPlot = scr[2], distance = distanceSlow,
                  centerMethod = centerMethod, ...)
                clust[noNA] <- resultKml[[1]]["clusters"]
            }
            yPartition <- ordered(partition(nbClusters = iNbClusters,
                clusters = clust))
            Object["clusters"] <- clusterization(yLongData = as(Object,
                "LongData"), xPartition = yPartition, convergenceTime = 
resultKml[[2]],
                imputationMethod = imputationMethod, startingCondition = 
startingCond[iRedraw],
                algorithmUsed = "kml")
            assign(nameObject, Object, envir = parent.frame())
            cat("*")
            if (saveCld >= saveFreq) {
                save(list = nameObject, file = paste(nameObject,
                  ".Rdata", sep = ""))
                saveCld <- 0
                cat("\n")
            }
            else {
            }
            if (print.cal) {
                screen(scr[1])
                plotCriterion(Object, all = TRUE)
            }
            else {
            }
        }
    }
    save(list = nameObject, file = paste(nameObject, ".Rdata",
        sep = ""))
    return(invisible())
}


######
### setting the kml method, using the same code
###
setMethod("kml","ClusterizLongData",func)

#######
### Same example that the one that does not work at the begining of this 
mail
###
kml(dn)

--- 8< --------------------------


From hadley at rice.edu  Wed Sep  9 15:30:57 2009
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 9 Sep 2009 08:30:57 -0500
Subject: [Rd] Finding the environment of a promise
Message-ID: <f8e6ff050909090630t69a76ca7k2c4ea4cc35678d40@mail.gmail.com>

Hi all,

Is it possible to determine the environment in which a promise will be
evaluated?  e.g.

f <- function(code) { force(code) }
f({
  a <- 1
  b <- 2
})

Is there any way to tell from within f that a and b will be created in
the global environment?

Thanks,

Hadley

-- 
http://had.co.nz/


From wwwhsd at gmail.com  Wed Sep  9 15:40:15 2009
From: wwwhsd at gmail.com (Henrique Dallazuanna)
Date: Wed, 9 Sep 2009 10:40:15 -0300
Subject: [Rd] Finding the environment of a promise
In-Reply-To: <f8e6ff050909090630t69a76ca7k2c4ea4cc35678d40@mail.gmail.com>
References: <f8e6ff050909090630t69a76ca7k2c4ea4cc35678d40@mail.gmail.com>
Message-ID: <da79af330909090640x19840eefr21002757ca52c835@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090909/6356f19c/attachment.pl>

From yuri.delia at eurac.edu  Wed Sep  9 15:48:24 2009
From: yuri.delia at eurac.edu (Yuri D'Elia)
Date: Wed, 9 Sep 2009 15:48:24 +0200
Subject: [Rd] Debugging R core
Message-ID: <20090909154824.7db522ad@abz8111lx.eurac.edu>

Hi everyone. I'm working on R sources themselves (look into past
messages if interested), and need to debug/benchmark R itself.

To check R functionality, I'm running the test-suite with 'make
check-devel', but it seems to overwrite the "reference output" at each
invocation. I want to compare the output just for the first (initially
untampered) build. How can I do that?

The tests for 'base' seem to contain some obvious variable output like:

15338c15338
< [1] "/tmp/RtmpPyoUwB/ab4a764be5"    "/tmp/RtmpPyoUwB/a b c2876711c"
---
> [1] "/tmp/RtmpvIWV48/ab73b00ff2"    "/tmp/RtmpvIWV48/a b c72f0579e"
14639c14639
<   ..$ :<environment: 0x1a55800> 
---
>   ..$ :<environment: 0x2e19140> 

is this expected? (can we fix it?).

Is there any larger self-contained code I can use for benchmarking
purposes?

Thanks


From murdoch at stats.uwo.ca  Wed Sep  9 15:55:22 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 09 Sep 2009 09:55:22 -0400
Subject: [Rd] Finding the environment of a promise
In-Reply-To: <f8e6ff050909090630t69a76ca7k2c4ea4cc35678d40@mail.gmail.com>
References: <f8e6ff050909090630t69a76ca7k2c4ea4cc35678d40@mail.gmail.com>
Message-ID: <4AA7B3CA.2080702@stats.uwo.ca>

On 9/9/2009 9:30 AM, Hadley Wickham wrote:
> Hi all,
> 
> Is it possible to determine the environment in which a promise will be
> evaluated?  e.g.
> 
> f <- function(code) { force(code) }
> f({
>   a <- 1
>   b <- 2
> })
> 
> Is there any way to tell from within f that a and b will be created in
> the global environment?

I don't think so in R code, but C code to do it would be possible.  It 
needs to be in C code to avoid forcing the promise.

I think we'd be reluctant to make an R function available to do this, 
because it requires non-standard evaluation, and it's not something a 
normal function should care about.  (The promise belongs to the caller, 
not to the function:  why would the function need to play with it?  It 
should be happy with the value, or maybe a text representation of the 
promise, for labelling purposes.)

Duncan Murdoch


From hadley at rice.edu  Wed Sep  9 16:40:35 2009
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 9 Sep 2009 09:40:35 -0500
Subject: [Rd] Monkey patching +.POSIXt
Message-ID: <f8e6ff050909090740l16ee7dbanf3eb9a3b2ad43985@mail.gmail.com>

Hi all,

This summer I've been working with a grad student to bring more of the
date time classes from JODA (http://joda-time.sourceforge.net/) into
R. To make these work seamlessly with existing date time objects, we
need to patch +.POSIXt. (The ruby community uses the term
monkey-patching for this sort of ill-advised, by sometimes necessary,
internal hackery, hence the title.) The problem is I can't figure out
how to override +.POSIXt so that it gets called from +.  Simply
including a new +.POSIXt function in the package doesn't work because
(I presume) + finds and uses base::+.POSIXt. The next thing I tried
was

assignInNamespace("+.POSIXt", lubridate::`+.POSIXt`, "base")

but that doesn't seem to work either, despite the documentation: "They
do attempt to alter a copy registered as an S3 method if one is
found."  (perhaps there is a missing not there?)

In desperation, I also tried the following internal, undocumented
function, but it didn't help either:

registerS3method("+", "POSIXt", lubridate::`+.POSIXt`)

Any ideas?

Thanks,

Hadley

-- 
http://had.co.nz/


From hadley at rice.edu  Wed Sep  9 16:53:33 2009
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 9 Sep 2009 09:53:33 -0500
Subject: [Rd] Finding the environment of a promise
In-Reply-To: <4AA7B3CA.2080702@stats.uwo.ca>
References: <f8e6ff050909090630t69a76ca7k2c4ea4cc35678d40@mail.gmail.com> 
	<4AA7B3CA.2080702@stats.uwo.ca>
Message-ID: <f8e6ff050909090753w4f5f64d1ka30e480720ddebba@mail.gmail.com>

> I don't think so in R code, but C code to do it would be possible. ?It needs
> to be in C code to avoid forcing the promise.

Thanks Duncan - I thought that might be the case.

> I think we'd be reluctant to make an R function available to do this,
> because it requires non-standard evaluation, and it's not something a normal
> function should care about.

True, but there are plenty of abnormal functions in R that demonstrate
the usefulness (and danger!) of non-standard evaluation.

> ?(The promise belongs to the caller, not to the
> function: ?why would the function need to play with it? ?It should be happy
> with the value, or maybe a text representation of the promise, for labelling
> purposes.)

Is there any way to get a text representation apart from with
deparse(substitute(x))?  I think I remember asking you about this some
time ago, but it is still the case that blocks/promises don't store
srcref information?  This come up recently while trying to make a
function that would both run a block or code and save it to a separate
file (a sort of poor man's sweave when you just want to include a
small portion of your code in a report).  With blocks, the best I
could come up with was:

named_block <- function(name, code) {
  text <- deparse(substitute(code), width = 100)
  # evaluate code
  force(code)

  # construct valid filename
  filename <- gsub("[^a-z0-9]+", "-", tolower(name))
  filename <- gsub("^-|-$", "", filename)
  filename <- paste(filename, ".r", sep = "")

  out <- text[!grepl("\\{|\\}", text)]
  out <- gsub("^    ", "", out)

  writeLines(out, filename)
}


b <- 1
named_block("test", {
  # This is a comment
  a <- 1
})

print(a)

The problem of course is that this loses comments.

You can do better with functions, but it requires more typing and
messing around with environments to ensure everything is scoped
correctly:

named_block <- function(name, f) {
  text <- attr(f, "source")

  code <- text[!grepl("^function \\(\\)\\{$|\\}", text)]
  code <- gsub("^  ", "", code)

  # evaluate code
  eval(parse(text = code), env = parent.frame())

  # construct valid filename
  filename <- gsub("[^a-z0-9]+", "-", tolower(name))
  filename <- gsub("^-|-$", "", filename)
  filename <- paste(filename, ".r", sep = "")

  writeLines(code, filename)
}


b <- 1
named_block("test", function (){
  # This is a comment
  a <- 2
})


# Make sure objects created in correct environment
print(a)

-- 
http://had.co.nz/


From simon.urbanek at r-project.org  Wed Sep  9 17:09:17 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 9 Sep 2009 11:09:17 -0400
Subject: [Rd] Finding the environment of a promise
In-Reply-To: <da79af330909090640x19840eefr21002757ca52c835@mail.gmail.com>
References: <f8e6ff050909090630t69a76ca7k2c4ea4cc35678d40@mail.gmail.com>
	<da79af330909090640x19840eefr21002757ca52c835@mail.gmail.com>
Message-ID: <FCD73B2E-BF59-45B9-9685-B1E0DF641B72@r-project.org>


On Sep 9, 2009, at 9:40 , Henrique Dallazuanna wrote:

> If I understand your question, you can get the environment with  
> sys.frame:
>
> f <- function(code){
>    print(sys.frame())

^-- this will always return R_GlobalEnv (see ?sys.frame - which = 0 by  
default) regardless of the function and promise.

Also the question was about the environment of the promise, not the  
function. Technically a promise can be evaluated anywhere since it  
ignores the evaluation environment and will use its creation  
environment which is what Hadley was trying to get at (and as Duncan  
was saying it's not something that is or should be available at R  
level as it's an internal implementation detail).

Cheers,
Simon


>    force(code)
> }
>
> f({
> a <- 1
> b <- 2
> })
>
> On Wed, Sep 9, 2009 at 10:30 AM, Hadley Wickham <hadley at rice.edu>  
> wrote:
>
>> Hi all,
>>
>> Is it possible to determine the environment in which a promise will  
>> be
>> evaluated?  e.g.
>>
>> f <- function(code) { force(code) }
>> f({
>> a <- 1
>> b <- 2
>> })
>>
>> Is there any way to tell from within f that a and b will be created  
>> in
>> the global environment?
>>
>> Thanks,
>>
>> Hadley
>>
>> --
>> http://had.co.nz/
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
>
> -- 
> Henrique Dallazuanna
> Curitiba-Paran?-Brasil
> 25? 25' 40" S 49? 16' 22" O
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From wwwhsd at gmail.com  Wed Sep  9 17:11:00 2009
From: wwwhsd at gmail.com (Henrique Dallazuanna)
Date: Wed, 9 Sep 2009 12:11:00 -0300
Subject: [Rd] Finding the environment of a promise
In-Reply-To: <FCD73B2E-BF59-45B9-9685-B1E0DF641B72@r-project.org>
References: <f8e6ff050909090630t69a76ca7k2c4ea4cc35678d40@mail.gmail.com> 
	<da79af330909090640x19840eefr21002757ca52c835@mail.gmail.com> 
	<FCD73B2E-BF59-45B9-9685-B1E0DF641B72@r-project.org>
Message-ID: <da79af330909090811y1957378ap1bbe53caa896d301@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090909/88237ce1/attachment.pl>

From murdoch at stats.uwo.ca  Wed Sep  9 17:14:55 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 09 Sep 2009 11:14:55 -0400
Subject: [Rd] Finding the environment of a promise
In-Reply-To: <f8e6ff050909090753w4f5f64d1ka30e480720ddebba@mail.gmail.com>
References: <f8e6ff050909090630t69a76ca7k2c4ea4cc35678d40@mail.gmail.com>
	<4AA7B3CA.2080702@stats.uwo.ca>
	<f8e6ff050909090753w4f5f64d1ka30e480720ddebba@mail.gmail.com>
Message-ID: <4AA7C66F.8030304@stats.uwo.ca>

On 9/9/2009 10:53 AM, Hadley Wickham wrote:
>> I don't think so in R code, but C code to do it would be possible.  It needs
>> to be in C code to avoid forcing the promise.
> 
> Thanks Duncan - I thought that might be the case.
> 
>> I think we'd be reluctant to make an R function available to do this,
>> because it requires non-standard evaluation, and it's not something a normal
>> function should care about.
> 
> True, but there are plenty of abnormal functions in R that demonstrate
> the usefulness (and danger!) of non-standard evaluation.
> 
>>  (The promise belongs to the caller, not to the
>> function:  why would the function need to play with it?  It should be happy
>> with the value, or maybe a text representation of the promise, for labelling
>> purposes.)
> 
> Is there any way to get a text representation apart from with
> deparse(substitute(x))?  I think I remember asking you about this some
> time ago, but it is still the case that blocks/promises don't store
> srcref information?  This come up recently while trying to make a
> function that would both run a block or code and save it to a separate
> file (a sort of poor man's sweave when you just want to include a
> small portion of your code in a report).  With blocks, the best I
> could come up with was:

Promises don't store srcrefs, but the evaluator does (in R-devel), a 
statement at a time.  So you might be able to look back through the call 
stack to find where the call came from.  (I forget whether any of this 
is accessible from within R.  Look at the implementation of traceback() 
and browser(), which both access this information.)

Duncan Murdoch


> 
> named_block <- function(name, code) {
>   text <- deparse(substitute(code), width = 100)
>   # evaluate code
>   force(code)
> 
>   # construct valid filename
>   filename <- gsub("[^a-z0-9]+", "-", tolower(name))
>   filename <- gsub("^-|-$", "", filename)
>   filename <- paste(filename, ".r", sep = "")
> 
>   out <- text[!grepl("\\{|\\}", text)]
>   out <- gsub("^    ", "", out)
> 
>   writeLines(out, filename)
> }
> 
> 
> b <- 1
> named_block("test", {
>   # This is a comment
>   a <- 1
> })
> 
> print(a)
> 
> The problem of course is that this loses comments.
> 
> You can do better with functions, but it requires more typing and
> messing around with environments to ensure everything is scoped
> correctly:
> 
> named_block <- function(name, f) {
>   text <- attr(f, "source")
> 
>   code <- text[!grepl("^function \\(\\)\\{$|\\}", text)]
>   code <- gsub("^  ", "", code)
> 
>   # evaluate code
>   eval(parse(text = code), env = parent.frame())
> 
>   # construct valid filename
>   filename <- gsub("[^a-z0-9]+", "-", tolower(name))
>   filename <- gsub("^-|-$", "", filename)
>   filename <- paste(filename, ".r", sep = "")
> 
>   writeLines(code, filename)
> }
> 
> 
> b <- 1
> named_block("test", function (){
>   # This is a comment
>   a <- 2
> })
> 
> 
> # Make sure objects created in correct environment
> print(a)
>


From asr at ufl.edu  Wed Sep  9 20:08:54 2009
From: asr at ufl.edu (Allen S. Rout)
Date: Wed, 09 Sep 2009 14:08:54 -0400
Subject: [Rd] Dependencies of  packages' CHECK....
References: <44wpf1vmp6dnn.fsf@crepe.osg.ufl.edu>
	<4059DBC9-C918-4D26-956E-C6627A1BB079@r-project.org>
	<44wpfocpqa66p.fsf@crepe.osg.ufl.edu>
	<4AA27DC3.7050500@statistik.tu-dortmund.de>
Message-ID: <44wpfws482dop.fsf@crepe.osg.ufl.edu>

Uwe Ligges <ligges at statistik.tu-dortmund.de> writes:

>> 2) As part of the binary package build process, run CHECK
>>    with R_CHECK_FORCE_SUGGESTS = false. 


> 1, 3-5 sound fine, but I do not see why you need 2).


I suppose because it makes me feel dirty to leave the check step out
entirely, if there is some utility available from it.  But I've got a
reputation as an overengineer, so..

In any case, I agree that the earlier check doesn't add anything
except possible satisfaction by the binary-package maintainers.


- Allen S. Rout


From Mark.Bravington at csiro.au  Wed Sep  9 23:40:11 2009
From: Mark.Bravington at csiro.au (Mark.Bravington at csiro.au)
Date: Thu, 10 Sep 2009 07:40:11 +1000
Subject: [Rd] Monkey patching +.POSIXt
In-Reply-To: <f8e6ff050909090740l16ee7dbanf3eb9a3b2ad43985@mail.gmail.com>
References: <f8e6ff050909090740l16ee7dbanf3eb9a3b2ad43985@mail.gmail.com>
Message-ID: <62C82B39B8A85E4B95A18F7F7B852F87054BBBA246@exvic-mbx03.nexus.csiro.au>

Hi Hadley

> This summer I've been working with a grad student to bring more of the
> date time classes from JODA (http://joda-time.sourceforge.net/) into
> R. To make these work seamlessly with existing date time objects, we
> need to patch +.POSIXt. (The ruby community uses the term
> monkey-patching for this sort of ill-advised, by sometimes necessary,
> internal hackery, hence the title.) The problem is I can't figure out
> how to override +.POSIXt so that it gets called from +.  Simply
> including a new +.POSIXt function in the package doesn't work because
> (I presume) + finds and uses base::+.POSIXt. The next thing I tried
> was
> 
> assignInNamespace("+.POSIXt", lubridate::`+.POSIXt`, "base")
> 
> but that doesn't seem to work either, despite the documentation: "They
> do attempt to alter a copy registered as an S3 method if one is
> found."  (perhaps there is a missing not there?)
> 
> 

In this particular case, the trick is to assign the new version both into the namespace and into the environment '.__S3MethodsTable__.' inside the namespace.

Speaking as a monkey, I do this kind of thing regularly, and there is a function 'assign.to.base' in the 'mvbutils' package that does it automatically, e.g.

assign.to.base( '+.POSIXt', my.plus.POSIXt)

The '.onLoad' of mvbutils has a few examples, including as it happens '+.POSIXt'. Although the version of 'mvbutils' on CRAN is quite out-of-date, the code for 'assign.to.base' should be in there.

HTH

Mark Bravington
CSIRO, Hobart, Australia
________________________________________
From: r-devel-bounces at r-project.org [r-devel-bounces at r-project.org] On Behalf Of Hadley Wickham [hadley at rice.edu]
Sent: 10 September 2009 00:40
To: r-devel at r-project.org
Subject: [Rd] Monkey patching +.POSIXt

Hi all,

In desperation, I also tried the following internal, undocumented
function, but it didn't help either:

registerS3method("+", "POSIXt", lubridate::`+.POSIXt`)

Any ideas?

Thanks,

Hadley

--
http://had.co.nz/

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From bownes at gmail.com  Thu Sep 10 00:50:09 2009
From: bownes at gmail.com (bownes at gmail.com)
Date: Thu, 10 Sep 2009 00:50:09 +0200 (CEST)
Subject: [Rd] 'make install' fails on Solaris (PR#13946)
Message-ID: <20090909225009.9ED5E282EF51@mail.pubhealth.ku.dk>

Full_Name: Bob Bownes
Version: 2.9.2
OS: Solaris 10
Submission from: (NULL) (164.55.254.106)


The sed lines in src/unix/Makefile confuse the grep distributed with Solaris
that gets configured by ./configure. 

Switching from a separator of ':' to a separator of ',' fixes the problem.

76,77c76,77
<       @$(SED) -e "s:@rhome:$(rhome):" -e "s:@rincludedir:$(rincludedir):" \
<         -e 's:@libsprivate:$(STATIC_LIBR_PC):' \
---
>       @$(SED) -e "s, at rhome,$(rhome)," -e "s, at rincludedir,$(rincludedir)," \
>         -e 's, at libsprivate,$(STATIC_LIBR_PC),' \


From hadley at rice.edu  Thu Sep 10 02:42:15 2009
From: hadley at rice.edu (Hadley Wickham)
Date: Wed, 9 Sep 2009 19:42:15 -0500
Subject: [Rd] Monkey patching +.POSIXt
In-Reply-To: <62C82B39B8A85E4B95A18F7F7B852F87054BBBA246@exvic-mbx03.nexus.csiro.au>
References: <f8e6ff050909090740l16ee7dbanf3eb9a3b2ad43985@mail.gmail.com> 
	<62C82B39B8A85E4B95A18F7F7B852F87054BBBA246@exvic-mbx03.nexus.csiro.au>
Message-ID: <f8e6ff050909091742l4175eed3le4e070c88b04ff38@mail.gmail.com>

>
> In this particular case, the trick is to assign the new version both into the namespace and into the environment '.__S3MethodsTable__.' inside the namespace.

The problem is +.POSIXt doesn't seem to be there:

> exists("+.POSIXt", asNamespace("base")$.__S3MethodsTable__., inherits=F)
[1] FALSE


> Speaking as a monkey, I do this kind of thing regularly, and there is a function 'assign.to.base' in the 'mvbutils' package that does it automatically, e.g.
>
> assign.to.base( '+.POSIXt', my.plus.POSIXt)

I tried that too, but without any luck.

Hadley


-- 
http://had.co.nz/


From Mark.Bravington at csiro.au  Thu Sep 10 03:19:39 2009
From: Mark.Bravington at csiro.au (Mark.Bravington at csiro.au)
Date: Thu, 10 Sep 2009 11:19:39 +1000
Subject: [Rd] Monkey patching +.POSIXt
In-Reply-To: <f8e6ff050909091742l4175eed3le4e070c88b04ff38@mail.gmail.com>
References: <f8e6ff050909090740l16ee7dbanf3eb9a3b2ad43985@mail.gmail.com>
	<62C82B39B8A85E4B95A18F7F7B852F87054BBBA246@exvic-mbx03.nexus.csiro.au>
	<f8e6ff050909091742l4175eed3le4e070c88b04ff38@mail.gmail.com>
Message-ID: <62C82B39B8A85E4B95A18F7F7B852F87054BBAD048@exvic-mbx03.nexus.csiro.au>

Hmmm... 'assign.to.base( "+.POSIXt", myfun)' works on my system (2.9.1 patched on Windows, at time of writing). Could be the 'mvbutils' version, I guess. What happened when you tried it? And what if you did 'getAnywhere( "+.POSIXt")' afterwards?

I was wrong about where '+.POSIXt' lives, though-- sorry. It is directly in 'baseenv()', not in 'baseenv().__S3MethodsTable__.'.  'assign.to.base' looks in both, and in other packages as well as 'baseenv()'.

Mark

-- 
Mark Bravington
CSIRO Mathematical & Information Sciences
Marine Laboratory
Castray Esplanade
Hobart 7001
TAS

ph (+61) 3 6232 5118
fax (+61) 3 6232 5012
mob (+61) 438 315 623

Hadley Wickham wrote:
>> In this particular case, the trick is to assign the new version both
>> into the namespace and into the environment '.__S3MethodsTable__.'
>> inside the namespace.  
> 
> The problem is +.POSIXt doesn't seem to be there:
> 
>> exists("+.POSIXt", asNamespace("base")$.__S3MethodsTable__.,
>> inherits=F)
> [1] FALSE
> 
> 
>> Speaking as a monkey, I do this kind of thing regularly, and there
>> is a function 'assign.to.base' in the 'mvbutils' package that does
>> it automatically, e.g.  
>> 
>> assign.to.base( '+.POSIXt', my.plus.POSIXt)
> 
> I tried that too, but without any luck.
> 
> Hadley

From ripley at stats.ox.ac.uk  Thu Sep 10 07:07:43 2009
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 10 Sep 2009 06:07:43 +0100 (BST)
Subject: [Rd] 'make install' fails on Solaris (PR#13946)
In-Reply-To: <20090909225009.9ED5E282EF51@mail.pubhealth.ku.dk>
References: <20090909225009.9ED5E282EF51@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0909100600300.3323@gannet.stats.ox.ac.uk>

On Thu, 10 Sep 2009, bownes at gmail.com wrote:

> Full_Name: Bob Bownes
> Version: 2.9.2
> OS: Solaris 10
> Submission from: (NULL) (164.55.254.106)
>
>
> The sed lines in src/unix/Makefile confuse the grep distributed with Solaris
> that gets configured by ./configure.

Well, it calls sed not grep!  Which version was that -- it works for 
me and for several others.  I have SED = /usr/xpg4/bin/sed (see file 
Makeconf), and that is 'distributed with Solaris': perhaps you do not 
have it installed?

The danger of changing R to fix a broken OS tool is that the change 
may break on other people's tools -- better to fix the tool.


> Switching from a separator of ':' to a separator of ',' fixes the problem.
>
> 76,77c76,77
> <       @$(SED) -e "s:@rhome:$(rhome):" -e "s:@rincludedir:$(rincludedir):" \
> <         -e 's:@libsprivate:$(STATIC_LIBR_PC):' \
> ---
>>       @$(SED) -e "s, at rhome,$(rhome)," -e "s, at rincludedir,$(rincludedir)," \
>>         -e 's, at libsprivate,$(STATIC_LIBR_PC),' \

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From p.dalgaard at biostat.ku.dk  Thu Sep 10 08:34:34 2009
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 10 Sep 2009 08:34:34 +0200
Subject: [Rd] 'make install' fails on Solaris (PR#13946)
In-Reply-To: <alpine.LFD.2.00.0909100600300.3323@gannet.stats.ox.ac.uk>
References: <20090909225009.9ED5E282EF51@mail.pubhealth.ku.dk>
	<alpine.LFD.2.00.0909100600300.3323@gannet.stats.ox.ac.uk>
Message-ID: <4AA89DFA.3060003@biostat.ku.dk>

Prof Brian Ripley wrote:
> On Thu, 10 Sep 2009, bownes at gmail.com wrote:
> 
>> Full_Name: Bob Bownes
>> Version: 2.9.2
>> OS: Solaris 10
>> Submission from: (NULL) (164.55.254.106)
>>
>>
>> The sed lines in src/unix/Makefile confuse the grep distributed with 
>> Solaris
>> that gets configured by ./configure.
> 
> Well, it calls sed not grep!  Which version was that -- it works for me 
> and for several others.  I have SED = /usr/xpg4/bin/sed (see file 
> Makeconf), and that is 'distributed with Solaris': perhaps you do not 
> have it installed?
> 
> The danger of changing R to fix a broken OS tool is that the change may 
> break on other people's tools -- better to fix the tool.


Is this a tool problem at all? The most common reason for separator 
breakage is that one of the substitution strings contains the separator.

E.g., the sed line may break if  @rhome contains a colon, and after the 
fix it will break if it contains a comma...

> 
> 
>> Switching from a separator of ':' to a separator of ',' fixes the 
>> problem.
>>
>> 76,77c76,77
>> <       @$(SED) -e "s:@rhome:$(rhome):" -e 
>> "s:@rincludedir:$(rincludedir):" \
>> <         -e 's:@libsprivate:$(STATIC_LIBR_PC):' \
>> ---
>>>       @$(SED) -e "s, at rhome,$(rhome)," -e 
>>> "s, at rincludedir,$(rincludedir)," \
>>>         -e 's, at libsprivate,$(STATIC_LIBR_PC),' \
> 


-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From fscholz at u.washington.edu  Tue Sep  8 22:22:27 2009
From: fscholz at u.washington.edu (Fritz Scholz)
Date: Tue, 08 Sep 2009 13:22:27 -0700
Subject: [Rd] feature and bug in wilcox.test
Message-ID: <1252441347.5920.34.camel@leibniz>

Dear Developers Team,

I have two items:

1. wilcox.test with the paired=T option appears to delete zeros 
before ranking absolute differences.
Would it be possible to add the feature of removing
zeros after ranking, which is given in Lehmann's Nonparametrics
as the preferred choice. See also Pratt (1959), JASA 54, 655-667.
It is given in wilcoxsign_test of the coin package as an
option through the argument ties="Pratt" as opposed to
ties="HollanderWolfe" (default). I understand this this might
be more difficult for wilcox.test because of the method
for calculating the null distribution.

2. For the following two samples
Augmenters <- c(17.94,13.32,11.31,10.62,7.56,
                 5.73,5.61,5.40,3.30,3.09,.93)
Reducers <- c(7.74,5.04,1.68,0.0,-3.03,-3.09,-10.53)

I get the following strange confidence percentage of 91.46556
together with a warning message, when asking for a 95% lower bound.
I had the impression that wilcox.test would only echo back the input
confidence level.
When I ask for a 90% interval I get the same correct lower bound
without the strange percentage and without warnings. The actual 
confidence coefficient of the lower bound 3.09 is 0.9573
(conservatively) and one gets lower bound 3.3 with confidence
coefficient 0.9479 if the achievable confidence level closest to
.95 is desired.

wilcox.test(Augmenters,Reducers,conf.int=T,conf.level=.95,alternative="greater",exact=T)

	Wilcoxon rank sum test

data:  Augmenters and Reducers 
W = 66, p-value = 0.005688
alternative hypothesis: true location shift is greater than 0 
91.46556 percent confidence interval:
 3.09  Inf 
sample estimates:
difference in location 
                  7.56 

Warning message:
In switch(alternative, two.sided = { : Requested conf.level not
achievable

wilcox.test(Augmenters,Reducers,conf.int=T,conf.level=.9,alternative="two.sided",exact=T)

	Wilcoxon rank sum test

data:  Augmenters and Reducers 
W = 66, p-value = 0.01138
alternative hypothesis: true location shift is not equal to 0 
90 percent confidence interval:
  3.09 13.62 
sample estimates:
difference in location 
                  7.56 

Thanks very much for any help or fix, especially with regard to 
item 2.

Fritz Scholz
fscholz at u.washington.edu


From Gregory_B_Hill at partner.nps.gov  Wed Sep  9 23:00:47 2009
From: Gregory_B_Hill at partner.nps.gov (Greg B. Hill)
Date: Wed, 9 Sep 2009 14:00:47 -0700 (PDT)
Subject: [Rd] Problem using model.frame with argument subset in own
 function
In-Reply-To: <1249756293.2242.15.camel@graptoleberis.geog.ucl.ac.uk>
References: <1249756293.2242.15.camel@graptoleberis.geog.ucl.ac.uk>
Message-ID: <25373059.post@talk.nabble.com>


Gavin,

I ran into the same cryptic "invalid subscript type 'closure'" message in
a slightly less complicated scenario, and wanted to post the cause in 
my case (the root cause is probably the same either way).

Similarly to your case, I was subsetting a data frame. I had a list
of variable names corresponding to columns in the frame. 
Unfortunately the variable name I had assigned to this list, var, 
coincided with the name of a base package function in R for variance.

When I attempted to subset df[, var], I got the 'closure' error message,
but if I renamed the list of variable names so the collision didn't occur,
e.g. df[, vars] instead of df[, var], it worked as expected.

Sincerely, 
Greg B. Hill


Gavin Simpson wrote:
> 
> Dear List,
> 
> I am writing a formula method for a function in a package I maintain. I
> want the method to return a data.frame that potentially only contains
> some of the variables in 'data', as specified by the formula.
> 
> The problem I am having is in writing the function and wrapping it
> around model.frame. Consider the following data frame:
> 
> dat <- data.frame(A = runif(10), B = runif(10), C = runif(10))
> 
> And the wrapper function:
> 
> foo <- function(formula, data = NULL, ..., subset = NULL,
>                 na.action = na.pass) {
>     mt <- terms(formula, data = data, simplify = TRUE)
>     mf <- model.frame(formula(mt), data = data, subset = subset,
>                       na.action = na.action)
>     ## real function would do more stuff here and pass mf on to
>     ## other functions
>     mf
> }
> 
> This is how I envisage the function being called. The real world use
> would have a data.frame with tens or hundreds of components where only a
> few need to be excluded. Hence wanting formulas of the form below to
> work.
> 
> foo(~ . - B, data = dat)
> 
> The aim is to return only columns A and C in an object returned by
> model.frame. However, when I run the above, I get the following error:
> 
>> foo(~ A + B, data = dat)
> Error in xj[i] : invalid subscript type 'closure'
> 
> I've tracked this down to the line in model.frame.default
> 
>     subset <- eval(substitute(subset), data, env)
> 
> After evaluating this line, subset contains:
> 
> Browse[1]> subset
> function (x, ...) 
> UseMethod("subset")
> <environment: namespace:base>
> 
> Not NULL, and hence the error later on when calling the internal
> model.frame code.
> 
> So the question is, what am I doing wrong?
> 
> If I leave the subset argument out of the definition of foo and rely
> upon the default in model.frame.default, the function works as
> expected. 
> 
> Perhaps the question should be, how do I modify foo() to allow it to
> have a formal subset argument, passed to model.frame?
> 
> Any other suggestions gratefully accepted.
> 
> Thanks in advance,
> 
> G
> -- 
> %~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
>  Dr. Gavin Simpson             [t] +44 (0)20 7679 0522
>  ECRC, UCL Geography,          [f] +44 (0)20 7679 0565
>  Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk
>  Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/
>  UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk
> %~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
View this message in context: http://www.nabble.com/Problem-using-model.frame-with-argument-subset-in-own-function-tp24880908p25373059.html
Sent from the R devel mailing list archive at Nabble.com.


From cgenolin at u-paris10.fr  Thu Sep 10 09:47:46 2009
From: cgenolin at u-paris10.fr (Christophe Genolini)
Date: Thu, 10 Sep 2009 09:47:46 +0200
Subject: [Rd] Package that does not work until I re write the exactly
 the same code
In-Reply-To: <4AA7AA27.8080504@u-paris10.fr>
References: <4AA7AA27.8080504@u-paris10.fr>
Message-ID: <4AA8AF22.3030806@u-paris10.fr>

Martin Morgan find the solution. Before
   setMethod("kml","ClusterizLongData",func)
kml was in environment kml, After, kml is in environment global.

So, using traceback(), we find that kml use an object Partition that is 
define in another package and that was export to the global environment 
but not to kml environment.
Adding import or importForm in NAMESPACE solve the problem.

Christophe

> Hi the list,
>
> I am writing a package in S4 and I do not manage to understand a bug.
> The "R CMD check" and the "R CMD build" both work. Here is links to 
> the package (not on CRAN yet for the raison that I explain bellow):
>
> http://christophe.genolini.free.fr/aTelecharger/kml_0.5.zip
> http://christophe.genolini.free.fr/aTelecharger/kml_0.5.tar.gz
>
> Then I install the package and I try an example:
>
> --- 8< --------------
> library(kml)
> dn <- as.cld(gald())
> kml(dn)
> # XXX ~ Fast KmL ~
> # Erreur dans as.vector(x, mode) : argument 'mode' incorrect
> --- 8< --------------
>
>
> So I make some verifications:
> --- 8< ----
> class(dn)
> # [1] "ClusterizLongData"
> # attr(,"package")
> # [1] "kml"
>
> getMethod("kml","ClusterizLongData")
> # Method Definition:
> #
> # function (Object, nbClusters = 2:6, nbRedrawing = 20, saveFreq = 100,
> #   maxIt = 200, trajMinSize = 2, print.cal = FALSE, print.traj = FALSE,
> #    imputationMethod = "copyMean", distance, power = 2, centerMethod 
> = meanNA,
> #    startingCond = "allMethods", distanceStartingCond = "euclidean", 
> #   ...)
> #{
> #   nbIdFull <- nrow(Object["traj"])
> # ...... [[[The full code is available below]]]
> # }
> # <environment: namespace:kml>
> #
> #Signatures:
> #       Object            # target  "ClusterizLongData"
> # defined "ClusterizLongData"
> --- 8< ----
>
> Everything seems fine. The code is correct.
> So I copy-and-paste the code that I get with 
> getMethods("kml","ClusterizLongData") and I affect it to a function 
> "func". Then I define again the method "kml".
>
> Then I run again the example that does not work before and it works...
> Any explanations?
>
> Christophe Genolini
>
> --- 8< --------------------------
> ###
> ### Affecting to func the code that 
> getMethod("kml","ClusterizLongData") delivers
> ###
> func <- function (Object, nbClusters = 2:6, nbRedrawing = 20, saveFreq 
> = 100,
>    maxIt = 200, trajMinSize = 2, print.cal = FALSE, print.traj = FALSE,
>    imputationMethod = "copyMean", distance, power = 2, centerMethod = 
> meanNA,
>    startingCond = "allMethods", distanceStartingCond = "euclidean",
>    ...)
> {
>    nbIdFull <- nrow(Object["traj"])
>    convergenceTime <- 0
>    noNA <- selectSupTrajMinSize(Object, trajMinSize)
>    trajNoNA <- Object["traj"][noNA, ]
>    nbTime <- length(Object["time"])
>    nbId <- nrow(trajNoNA)
>    saveCld <- 0
>    scr <- plotAll(Object, print.cal = print.cal, print.traj = print.traj,
>        print.sub = FALSE, col = "black", type.mean = "n")
>    if (length(startingCond) == 1) {
>        if (startingCond == "allMethods") {
>            startingCond <- c("maxDist", "randomAll", rep("randomK",
>                nbRedrawing))[1:nbRedrawing]
>        }
>        else {
>            startingCond <- rep(startingCond, nbRedrawing)
>        }
>    }
>    else {
>    }
>    if (missing(distance)) {
>        distance <- "euclidean"
>    }
>    if (is.character(distance)) {
>        distInt <- pmatch(distance, METHODS)
>    }
>    else {
>        distInt <- NA
>    }
>    if (print.traj) {
>        cat(" ~ Slow KmL ~\n")
>        fast <- FALSE
>        screenPlot <- scr[2]
>        if (!is.na(distInt)) {
>            distanceSlow <- function(x, y) {
>                dist(rbind(x, y), method = distance)
>            }
>        }
>        else {
>            distanceSlow <- distance
>        }
>    }
>    else {
>        screenPlot <- NA
>        if (is.na(distInt)) {
>            cat(" ~ Slow KmL ~\n")
>            fast <- FALSE
>            distanceSlow <- distance
>        }
>        else {
>            cat(" ~ Fast KmL ~\n")
>            fast <- TRUE
>        }
>    }
>    nameObject <- deparse(substitute(Object))
>    for (iRedraw in 1:nbRedrawing) {
>        for (iNbClusters in nbClusters) {
>            saveCld <- saveCld + 1
>            clustersInit <- partitionInitialise(nbClusters = iNbClusters,
>                method = startingCond[iRedraw], lengthPart = nbId,
>                matrixDist = as.matrix(dist(trajNoNA, method = 
> distanceStartingCond)))
>            clust <- rep(NA, nbIdFull)
>            if (fast) {
>                resultKml <- .C("kml1", as.double(t(trajNoNA)),
>                  iNbInd = as.integer(nbId), iNbTime = as.integer(nbTime),
>                  iNbCluster = as.integer(iNbClusters), maxIt = 
> as.integer(maxIt),
>                  distance = as.integer(distInt), power = 
> as.numeric(power),
>                  vClusterAffectation1 = 
> as.integer(clustersInit["clusters"]),
>                  convergenceTime = as.integer(convergenceTime),
>                  NAOK = TRUE, PACKAGE = "kml")[c(8, 9)]
>                clust[noNA] <- resultKml[[1]]
>            }
>            else {
>                resultKml <- trajKmlSlow(traj = trajNoNA, 
> clusterAffectation = clustersInit,
>                  nbId = nbId, nbTime = nbTime, maxIt = maxIt,
>                  screenPlot = scr[2], distance = distanceSlow,
>                  centerMethod = centerMethod, ...)
>                clust[noNA] <- resultKml[[1]]["clusters"]
>            }
>            yPartition <- ordered(partition(nbClusters = iNbClusters,
>                clusters = clust))
>            Object["clusters"] <- clusterization(yLongData = as(Object,
>                "LongData"), xPartition = yPartition, convergenceTime = 
> resultKml[[2]],
>                imputationMethod = imputationMethod, startingCondition 
> = startingCond[iRedraw],
>                algorithmUsed = "kml")
>            assign(nameObject, Object, envir = parent.frame())
>            cat("*")
>            if (saveCld >= saveFreq) {
>                save(list = nameObject, file = paste(nameObject,
>                  ".Rdata", sep = ""))
>                saveCld <- 0
>                cat("\n")
>            }
>            else {
>            }
>            if (print.cal) {
>                screen(scr[1])
>                plotCriterion(Object, all = TRUE)
>            }
>            else {
>            }
>        }
>    }
>    save(list = nameObject, file = paste(nameObject, ".Rdata",
>        sep = ""))
>    return(invisible())
> }
>
>
> ######
> ### setting the kml method, using the same code
> ###
> setMethod("kml","ClusterizLongData",func)
>
> #######
> ### Same example that the one that does not work at the begining of 
> this mail
> ###
> kml(dn)
>
> --- 8< --------------------------
>


From murdoch at stats.uwo.ca  Thu Sep 10 13:41:13 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 10 Sep 2009 07:41:13 -0400
Subject: [Rd] findLineNum and setBreakpoint added
Message-ID: <4AA8E5D9.5060107@stats.uwo.ca>

I've just added a couple of functions to R-devel to help with 
debugging.  findLineNum() finds which line of which function corresponds 
to a particular line of source code; setBreakpoint() takes the output of 
findLineNum, and calls trace() to set a breakpoint there.

These rely on having source reference debug information in the code.  
This is the default for code read by source(), but not for packages.  To 
get the source references in package code, set the environment variable 
R_KEEP_PKG_SOURCE=yes, or within R, set options(keep.source.pkgs=TRUE), 
then install the package from source code.  Read ?findLineNum for 
details on how to
tell it to search within packages, rather than limiting the search to 
the global environment.

For example,

x <- " f <- function(a, b) {
             if (a > b)  {
                 a
             } else {
                 b
             }
         }"

eval(parse(text=x))  # Normally you'd use source() to read a file...

findLineNum("<text>#3")   # <text> is a dummy filename used by parse(text=)

This will print

 f step 2,3,2 in <environment: R_GlobalEnv>

and you can use

setBreakpoint("<text>#3")

to set a breakpoint there.
             
There are still some limitations (and probably bugs) in the code; I'll 
be fixing those over the next while. 

Duncan Murdoch


From bownes at gmail.com  Thu Sep 10 17:20:11 2009
From: bownes at gmail.com (Bob Bownes)
Date: Thu, 10 Sep 2009 11:20:11 -0400
Subject: [Rd] 'make install' fails on Solaris (PR#13946)
In-Reply-To: <4AA89DFA.3060003@biostat.ku.dk>
References: <20090909225009.9ED5E282EF51@mail.pubhealth.ku.dk>
	<alpine.LFD.2.00.0909100600300.3323@gannet.stats.ox.ac.uk>
	<4AA89DFA.3060003@biostat.ku.dk>
Message-ID: <6f68bf030909100820t635fd512yd01d63d9bf4f52e8@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090910/7dded8dc/attachment.pl>

From bownes at gmail.com  Thu Sep 10 17:25:22 2009
From: bownes at gmail.com (bownes at gmail.com)
Date: Thu, 10 Sep 2009 17:25:22 +0200 (CEST)
Subject: [Rd] 'make install' fails on Solaris (PR#13946)
Message-ID: <20090910152522.5D023282EF54@mail.pubhealth.ku.dk>

Sorry, typo.

Yes, it is confusing sed. And, yes, I am also using /usr/xpg4/bin/sed. Here
is the error:

bash-3.00# make install
installing doc ...
../tools/install-sh -c -m 644 ../NEWS
"/home/dev/scratch/bbownes/R/lib/R/doc"
installing doc/html ...
installing doc/html/search ...
installing doc/manual ...
installing etc ...
installing share ...
cc -I. -I../../src/include -I../../src/include  -I/usr/local/include
-DHAVE_CONFIG_H   -g -DR_HOME=3D'"/home/dev/scratch/bbownes/R/lib/R"' -o
Rscript \
  ./Rscript.c
sed: command garbled: s:@libsprivate:-L/home/dev/scratch/bbownes/R/lib/R/lib
-lRblas
-R/home/dev/forte/10.0/SUNWspro/lib/v8plus:/home/dev/forte/10.0/SUNWspro/li=
b:/opt/SUNWspro/lib/v8plus:/opt/SUNWspro/lib
-L/home/dev/forte/10.0/SUNWspro/lib/v8plus
-L/home/dev/forte/10.0/SUNWspro/prod/lib/v8plus
-L/home/dev/forte/10.0/SUNWspro/lib -L/home/dev/forte/10.0/SUNWspro/prod/lib
-L/usr/ccs/lib -lfui -lfai -lfai2 -lfsumai -lfprodai -lfminlai -lfmaxlai
-lfminvai -lfmaxvai -lfsu -lsunmath -lmtsk -lm    -lnsl -lsocket -ldl -lm
-licuuc -licui18n:
*** Error code 2
The following command caused the error:
/usr/xpg4/bin/sed -e "s:@rhome:/home/dev/scratch/bbownes/R/lib/R:" -e
"s:@rincludedir:/home/dev/scratch/bbownes/R/lib/R/include:" \
  -e 's:@libsprivate:-L/home/dev/scratch/bbownes/R/lib/R/lib -lRblas
-R/home/dev/forte/10.0/SUNWspro/lib/v8plus:/home/dev/forte/10.0/SUNWspro/li=
b:/opt/SUNWspro/lib/v8plus:/opt/SUNWspro/lib
-L/home/dev/forte/10.0/SUNWspro/lib/v8plus
-L/home/dev/forte/10.0/SUNWspro/prod/lib/v8plus
-L/home/dev/forte/10.0/SUNWspro/lib -L/home/dev/forte/10.0/SUNWspro/prod/lib
-L/usr/ccs/lib -lfui -lfai -lfai2 -lfsumai -lfprodai -lfminlai -lfmaxlai
-lfminvai -lfmaxvai -lfsu -lsunmath -lmtsk -lm    -lnsl -lsocket -ldl -lm
-licuuc -licui18n:' \
  -e 's/@VERSION/2.9.2/' ./libR.pc.in \
  > "/home/dev/scratch/bbownes/R/lib/pkgconfig/libR.pc"
make: Fatal error: Command failed for target `install-pc'
Current working directory /home/dev/scratch/bbownes/R-2.9.2/src/unix
*** Error code 1
The following command caused the error:
for d in scripts include extra appl nmath unix main modules library; do \
  (cd ${d} && make install) || exit 1; \
done
make: Fatal error: Command failed for target `install'
Current working directory /home/dev/scratch/bbownes/R-2.9.2/src
*** Error code 1
The following command caused the error:
for d in m4 tools doc etc share src tests  po; do \
  (cd ${d} && make install) || exit 1; \
done
make: Fatal error: Command failed for target `install'
bash-3.00#

and the configure that started it all:
./configure --with-readline=3Dno --with-iconv=3Dno --with-x=3Dno
--enable-static=3Dyes --enable-R-static-lib
--prefix=3D/home/dev/scratch/bbownes/R




On Thu, Sep 10, 2009 at 2:34 AM, Peter Dalgaard <p.dalgaard at biostat.ku.dk>w=
rote:

> Prof Brian Ripley wrote:
>
>> On Thu, 10 Sep 2009, bownes at gmail.com wrote:
>>
>>  Full_Name: Bob Bownes
>>> Version: 2.9.2
>>> OS: Solaris 10
>>> Submission from: (NULL) (164.55.254.106)
>>>
>>>
>>> The sed lines in src/unix/Makefile confuse the grep distributed with
>>> Solaris
>>> that gets configured by ./configure.
>>>
>>
>> Well, it calls sed not grep!  Which version was that -- it works for me
>> and for several others.  I have SED =3D /usr/xpg4/bin/sed (see file Make=
conf),
>> and that is 'distributed with Solaris': perhaps you do not have it
>> installed?
>>
>> The danger of changing R to fix a broken OS tool is that the change may
>> break on other people's tools -- better to fix the tool.
>>
>
>
> Is this a tool problem at all? The most common reason for separator
> breakage is that one of the substitution strings contains the separator.
>
> E.g., the sed line may break if  @rhome contains a colon, and after the f=
ix
> it will break if it contains a comma...
>
>
>>
>>  Switching from a separator of ':' to a separator of ',' fixes the
>>> problem.
>>>
>>> 76,77c76,77
>>> <       @$(SED) -e "s:@rhome:$(rhome):" -e "s:@rincludedir:$(rincludedi=
r):"
>>> \
>>> <         -e 's:@libsprivate:$(STATIC_LIBR_PC):' \
>>> ---
>>>
>>>>      @$(SED) -e "s, at rhome,$(rhome)," -e "s, at rincludedir,$(rincludedir)=
,"
>>>> \
>>>>        -e 's, at libsprivate,$(STATIC_LIBR_PC),' \
>>>>
>>>
>>
>
> --
>   O__  ---- Peter Dalgaard             =D8ster Farimagsgade 5, Entr.B
>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907
>

	[[alternative HTML version deleted]]


From ripley at stats.ox.ac.uk  Thu Sep 10 17:39:31 2009
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 10 Sep 2009 16:39:31 +0100 (BST)
Subject: [Rd] 'make install' fails on Solaris (PR#13946)
In-Reply-To: <6f68bf030909100820t635fd512yd01d63d9bf4f52e8@mail.gmail.com>
References: <20090909225009.9ED5E282EF51@mail.pubhealth.ku.dk>
	<alpine.LFD.2.00.0909100600300.3323@gannet.stats.ox.ac.uk>
	<4AA89DFA.3060003@biostat.ku.dk>
	<6f68bf030909100820t635fd512yd01d63d9bf4f52e8@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.0909101629420.13955@gannet.stats.ox.ac.uk>

I can see what has happened: one of the paths contains : as Peter 
suggested.  By not why, and there seem to be more wrong with it: look 
at the lines I've enclosed in ===.  There is no space after -Rblas, 
and other odd things, so changing the sed script would not help here.
As Peter say, -Wlfoo,bar is just as likely as : in there if things go 
this badly wrong.  (Of course mailer may have garbled this.)

I have

STATIC_LIBR_PC = $(BLAS_LIBS) $(FLIBS)  $(LIBINTL) -lreadline -ltermcap  $(LIBS)

and nothing strange in the expansion.

Try not using --enable-R-static-lib.

What we could do it to allow the script to fail: having libR.pc is a 
convenience, and --enable-R-static-lib is rarely used.


On Thu, 10 Sep 2009, Bob Bownes wrote:

> Sorry, typo.
> 
> Yes, it is confusing sed. And, yes, I am also using /usr/xpg4/bin/sed. Here
> is the error:
> 
> bash-3.00# make install
> installing doc ...
> ../tools/install-sh -c -m 644 ../NEWS
> "/home/dev/scratch/bbownes/R/lib/R/doc"
> installing doc/html ...
> installing doc/html/search ...
> installing doc/manual ...
> installing etc ...
> installing share ...
> cc -I. -I../../src/include -I../../src/include? -I/usr/local/include
> -DHAVE_CONFIG_H?? -g -DR_HOME='"/home/dev/scratch/bbownes/R/lib/R"' -o
> Rscript \
> ? ./Rscript.c
> sed: command garbled: s:@libsprivate:-L/home/dev/scratch/bbownes/R/lib/R/lib
===========
> -lRblas-R/home/dev/forte/10.0/SUNWspro/lib/v8plus:/home/dev/forte/10.0/SUNWspro/li
> b:/opt/SUNWspro/lib/v8plus:/opt/SUNWspro/lib
===========
> -L/home/dev/forte/10.0/SUNWspro/lib/v8plus
> -L/home/dev/forte/10.0/SUNWspro/prod/lib/v8plus
> -L/home/dev/forte/10.0/SUNWspro/lib -L/home/dev/forte/10.0/SUNWspro/prod/lib
> -L/usr/ccs/lib -lfui -lfai -lfai2 -lfsumai -lfprodai -lfminlai -lfmaxlai
> -lfminvai -lfmaxvai -lfsu -lsunmath -lmtsk -lm??? -lnsl -lsocket -ldl -lm
> -licuuc -licui18n:
> *** Error code 2
> The following command caused the error:
> /usr/xpg4/bin/sed -e "s:@rhome:/home/dev/scratch/bbownes/R/lib/R:" -e
> "s:@rincludedir:/home/dev/scratch/bbownes/R/lib/R/include:" \
> ? -e 's:@libsprivate:-L/home/dev/scratch/bbownes/R/lib/R/lib -lRblas-R/home/dev/forte/10.0/SUNWspro/lib/v8plus:/home/dev/forte/10.0/SUNWspro/li
> b:/opt/SUNWspro/lib/v8plus:/opt/SUNWspro/lib
> -L/home/dev/forte/10.0/SUNWspro/lib/v8plus
> -L/home/dev/forte/10.0/SUNWspro/prod/lib/v8plus
> -L/home/dev/forte/10.0/SUNWspro/lib -L/home/dev/forte/10.0/SUNWspro/prod/lib
> -L/usr/ccs/lib -lfui -lfai -lfai2 -lfsumai -lfprodai -lfminlai -lfmaxlai
> -lfminvai -lfmaxvai -lfsu -lsunmath -lmtsk -lm??? -lnsl -lsocket -ldl -lm
> -licuuc -licui18n:' \
> ? -e 's/@VERSION/2.9.2/' ./libR.pc.in \
> ? > "/home/dev/scratch/bbownes/R/lib/pkgconfig/libR.pc"
> make: Fatal error: Command failed for target `install-pc'
> Current working directory /home/dev/scratch/bbownes/R-2.9.2/src/unix
> *** Error code 1
> The following command caused the error:
> for d in scripts include extra appl nmath unix main modules library; do \
> ? (cd ${d} && make install) || exit 1; \
> done
> make: Fatal error: Command failed for target `install'
> Current working directory /home/dev/scratch/bbownes/R-2.9.2/src
> *** Error code 1
> The following command caused the error:
> for d in m4 tools doc etc share src tests? po; do \
> ? (cd ${d} && make install) || exit 1; \
> done
> make: Fatal error: Command failed for target `install'
> bash-3.00#
> 
> and the configure that started it all:
> ./configure --with-readline=no --with-iconv=no --with-x=no
> --enable-static=yes --enable-R-static-lib
> --prefix=/home/dev/scratch/bbownes/R
> 
> 
> 
> 
> On Thu, Sep 10, 2009 at 2:34 AM, Peter Dalgaard <p.dalgaard at biostat.ku.dk>
> wrote:
>       Prof Brian Ripley wrote:
>             On Thu, 10 Sep 2009, bownes at gmail.com wrote:
>
>                   Full_Name: Bob Bownes
>                   Version: 2.9.2
>                   OS: Solaris 10
>                   Submission from: (NULL) (164.55.254.106)
> 
>
>                   The sed lines in src/unix/Makefile
>                   confuse the grep distributed with
>                   Solaris
>                   that gets configured by ./configure.
> 
>
>             Well, it calls sed not grep! ?Which version was that
>             -- it works for me and for several others. ?I have
>             SED = /usr/xpg4/bin/sed (see file Makeconf), and
>             that is 'distributed with Solaris': perhaps you do
>             not have it installed?
>
>             The danger of changing R to fix a broken OS tool is
>             that the change may break on other people's tools --
>             better to fix the tool.
> 
> 
> 
> Is this a tool problem at all? The most common reason for separator
> breakage is that one of the substitution strings contains the
> separator.
> 
> E.g., the sed line may break if ?@rhome contains a colon, and after
> the fix it will break if it contains a comma...
> 
> 
>
>             Switching from a separator of ':' to a
>             separator of ',' fixes the problem.
>
>             76,77c76,77
>             < ? ? ? @$(SED) -e "s:@rhome:$(rhome):" -e
>             "s:@rincludedir:$(rincludedir):" \
>             < ? ? ? ? -e
>             's:@libsprivate:$(STATIC_LIBR_PC):' \
>             ---
>                   ? ? ?@$(SED) -e
>                   "s, at rhome,$(rhome)," -e
>                   "s, at rincludedir,$(rincludedir)," \
>                   ? ? ? ?-e
>                   's, at libsprivate,$(STATIC_LIBR_PC),'
>                   \
> 
> 
> 
> 
> --
> ? O__ ?---- Peter Dalgaard ? ? ? ? ? ? ?ster Farimagsgade 5, Entr.B
> ?c/ /'_ --- Dept. of Biostatistics ? ? PO Box 2099, 1014 Cph. K
> ?(*) \(*) -- University of Copenhagen ? Denmark ? ? ?Ph: ?(+45)
> 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk) ? ? ? ? ? ? ?FAX: (+45)
> 35327907
> 
> 
> 
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Thu Sep 10 17:40:35 2009
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Thu, 10 Sep 2009 17:40:35 +0200 (CEST)
Subject: [Rd] 'make install' fails on Solaris (PR#13946)
Message-ID: <20090910154035.ABB87282EF4D@mail.pubhealth.ku.dk>

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.

--27464147-1085614336-1252597171=:13955
Content-Type: TEXT/PLAIN; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 8BIT

I can see what has happened: one of the paths contains : as Peter 
suggested.  By not why, and there seem to be more wrong with it: look 
at the lines I've enclosed in ===.  There is no space after -Rblas, 
and other odd things, so changing the sed script would not help here.
As Peter say, -Wlfoo,bar is just as likely as : in there if things go 
this badly wrong.  (Of course mailer may have garbled this.)

I have

STATIC_LIBR_PC = $(BLAS_LIBS) $(FLIBS)  $(LIBINTL) -lreadline -ltermcap  $(LIBS)

and nothing strange in the expansion.

Try not using --enable-R-static-lib.

What we could do it to allow the script to fail: having libR.pc is a 
convenience, and --enable-R-static-lib is rarely used.


On Thu, 10 Sep 2009, Bob Bownes wrote:

> Sorry, typo.
> 
> Yes, it is confusing sed. And, yes, I am also using /usr/xpg4/bin/sed. Here
> is the error:
> 
> bash-3.00# make install
> installing doc ...
> ../tools/install-sh -c -m 644 ../NEWS
> "/home/dev/scratch/bbownes/R/lib/R/doc"
> installing doc/html ...
> installing doc/html/search ...
> installing doc/manual ...
> installing etc ...
> installing share ...
> cc -I. -I../../src/include -I../../src/include? -I/usr/local/include
> -DHAVE_CONFIG_H?? -g -DR_HOME='"/home/dev/scratch/bbownes/R/lib/R"' -o
> Rscript \
> ? ./Rscript.c
> sed: command garbled: s:@libsprivate:-L/home/dev/scratch/bbownes/R/lib/R/lib
===========
> -lRblas-R/home/dev/forte/10.0/SUNWspro/lib/v8plus:/home/dev/forte/10.0/SUNWspro/li
> b:/opt/SUNWspro/lib/v8plus:/opt/SUNWspro/lib
===========
> -L/home/dev/forte/10.0/SUNWspro/lib/v8plus
> -L/home/dev/forte/10.0/SUNWspro/prod/lib/v8plus
> -L/home/dev/forte/10.0/SUNWspro/lib -L/home/dev/forte/10.0/SUNWspro/prod/lib
> -L/usr/ccs/lib -lfui -lfai -lfai2 -lfsumai -lfprodai -lfminlai -lfmaxlai
> -lfminvai -lfmaxvai -lfsu -lsunmath -lmtsk -lm??? -lnsl -lsocket -ldl -lm
> -licuuc -licui18n:
> *** Error code 2
> The following command caused the error:
> /usr/xpg4/bin/sed -e "s:@rhome:/home/dev/scratch/bbownes/R/lib/R:" -e
> "s:@rincludedir:/home/dev/scratch/bbownes/R/lib/R/include:" \
> ? -e 's:@libsprivate:-L/home/dev/scratch/bbownes/R/lib/R/lib -lRblas-R/home/dev/forte/10.0/SUNWspro/lib/v8plus:/home/dev/forte/10.0/SUNWspro/li
> b:/opt/SUNWspro/lib/v8plus:/opt/SUNWspro/lib
> -L/home/dev/forte/10.0/SUNWspro/lib/v8plus
> -L/home/dev/forte/10.0/SUNWspro/prod/lib/v8plus
> -L/home/dev/forte/10.0/SUNWspro/lib -L/home/dev/forte/10.0/SUNWspro/prod/lib
> -L/usr/ccs/lib -lfui -lfai -lfai2 -lfsumai -lfprodai -lfminlai -lfmaxlai
> -lfminvai -lfmaxvai -lfsu -lsunmath -lmtsk -lm??? -lnsl -lsocket -ldl -lm
> -licuuc -licui18n:' \
> ? -e 's/@VERSION/2.9.2/' ./libR.pc.in \
> ? > "/home/dev/scratch/bbownes/R/lib/pkgconfig/libR.pc"
> make: Fatal error: Command failed for target `install-pc'
> Current working directory /home/dev/scratch/bbownes/R-2.9.2/src/unix
> *** Error code 1
> The following command caused the error:
> for d in scripts include extra appl nmath unix main modules library; do \
> ? (cd ${d} && make install) || exit 1; \
> done
> make: Fatal error: Command failed for target `install'
> Current working directory /home/dev/scratch/bbownes/R-2.9.2/src
> *** Error code 1
> The following command caused the error:
> for d in m4 tools doc etc share src tests? po; do \
> ? (cd ${d} && make install) || exit 1; \
> done
> make: Fatal error: Command failed for target `install'
> bash-3.00#
> 
> and the configure that started it all:
> ./configure --with-readline=no --with-iconv=no --with-x=no
> --enable-static=yes --enable-R-static-lib
> --prefix=/home/dev/scratch/bbownes/R
> 
> 
> 
> 
> On Thu, Sep 10, 2009 at 2:34 AM, Peter Dalgaard <p.dalgaard at biostat.ku.dk>
> wrote:
>       Prof Brian Ripley wrote:
>             On Thu, 10 Sep 2009, bownes at gmail.com wrote:
>
>                   Full_Name: Bob Bownes
>                   Version: 2.9.2
>                   OS: Solaris 10
>                   Submission from: (NULL) (164.55.254.106)
> 
>
>                   The sed lines in src/unix/Makefile
>                   confuse the grep distributed with
>                   Solaris
>                   that gets configured by ./configure.
> 
>
>             Well, it calls sed not grep! ?Which version was that
>             -- it works for me and for several others. ?I have
>             SED = /usr/xpg4/bin/sed (see file Makeconf), and
>             that is 'distributed with Solaris': perhaps you do
>             not have it installed?
>
>             The danger of changing R to fix a broken OS tool is
>             that the change may break on other people's tools --
>             better to fix the tool.
> 
> 
> 
> Is this a tool problem at all? The most common reason for separator
> breakage is that one of the substitution strings contains the
> separator.
> 
> E.g., the sed line may break if ?@rhome contains a colon, and after
> the fix it will break if it contains a comma...
> 
> 
>
>             Switching from a separator of ':' to a
>             separator of ',' fixes the problem.
>
>             76,77c76,77
>             < ? ? ? @$(SED) -e "s:@rhome:$(rhome):" -e
>             "s:@rincludedir:$(rincludedir):" \
>             < ? ? ? ? -e
>             's:@libsprivate:$(STATIC_LIBR_PC):' \
>             ---
>                   ? ? ?@$(SED) -e
>                   "s, at rhome,$(rhome)," -e
>                   "s, at rincludedir,$(rincludedir)," \
>                   ? ? ? ?-e
>                   's, at libsprivate,$(STATIC_LIBR_PC),'
>                   \
> 
> 
> 
> 
> --
> ? O__ ?---- Peter Dalgaard ? ? ? ? ? ? ?ster Farimagsgade 5, Entr.B
> ?c/ /'_ --- Dept. of Biostatistics ? ? PO Box 2099, 1014 Cph. K
> ?(*) \(*) -- University of Copenhagen ? Denmark ? ? ?Ph: ?(+45)
> 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk) ? ? ? ? ? ? ?FAX: (+45)
> 35327907
> 
> 
> 
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595
--27464147-1085614336-1252597171=:13955--


From bownes at gmail.com  Thu Sep 10 17:55:45 2009
From: bownes at gmail.com (Bob Bownes)
Date: Thu, 10 Sep 2009 11:55:45 -0400
Subject: [Rd] 'make install' fails on Solaris (PR#13946)
In-Reply-To: <alpine.LFD.2.00.0909101629420.13955@gannet.stats.ox.ac.uk>
References: <20090909225009.9ED5E282EF51@mail.pubhealth.ku.dk>
	<alpine.LFD.2.00.0909100600300.3323@gannet.stats.ox.ac.uk>
	<4AA89DFA.3060003@biostat.ku.dk>
	<6f68bf030909100820t635fd512yd01d63d9bf4f52e8@mail.gmail.com>
	<alpine.LFD.2.00.0909101629420.13955@gannet.stats.ox.ac.uk>
Message-ID: <6f68bf030909100855w7c5d4b51oc944d59849f4abbf@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090910/709bd639/attachment.pl>

From bownes at gmail.com  Thu Sep 10 18:00:24 2009
From: bownes at gmail.com (bownes at gmail.com)
Date: Thu, 10 Sep 2009 18:00:24 +0200 (CEST)
Subject: [Rd] 'make install' fails on Solaris (PR#13946)
Message-ID: <20090910160025.0A38D282EF4D@mail.pubhealth.ku.dk>

Interesting. None of my paths have ':' in them.

make install without --enable-R-static-lib works fine.



On Thu, Sep 10, 2009 at 11:39 AM, Prof Brian Ripley
<ripley at stats.ox.ac.uk>wrote:

> I can see what has happened: one of the paths contains : as Peter
> suggested.  By not why, and there seem to be more wrong with it: look at =
the
> lines I've enclosed in =3D=3D=3D.  There is no space after -Rblas, and ot=
her odd
> things, so changing the sed script would not help here.
> As Peter say, -Wlfoo,bar is just as likely as : in there if things go this
> badly wrong.  (Of course mailer may have garbled this.)
>
> I have
>
> STATIC_LIBR_PC =3D $(BLAS_LIBS) $(FLIBS)  $(LIBINTL) -lreadline -ltermcap
>  $(LIBS)
>
> and nothing strange in the expansion.
>
> Try not using --enable-R-static-lib.
>
> What we could do it to allow the script to fail: having libR.pc is a
> convenience, and --enable-R-static-lib is rarely used.
>
>
>
> On Thu, 10 Sep 2009, Bob Bownes wrote:
>
>  Sorry, typo.
>>
>> Yes, it is confusing sed. And, yes, I am also using /usr/xpg4/bin/sed.
>> Here
>> is the error:
>>
>> bash-3.00# make install
>> installing doc ...
>> ../tools/install-sh -c -m 644 ../NEWS
>> "/home/dev/scratch/bbownes/R/lib/R/doc"
>> installing doc/html ...
>> installing doc/html/search ...
>> installing doc/manual ...
>> installing etc ...
>> installing share ...
>> cc -I. -I../../src/include -I../../src/include  -I/usr/local/include
>> -DHAVE_CONFIG_H   -g -DR_HOME=3D'"/home/dev/scratch/bbownes/R/lib/R"' -o
>> Rscript \
>>   ./Rscript.c
>> sed: command garbled: s:@libsprivate
>> :-L/home/dev/scratch/bbownes/R/lib/R/lib
>>
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>
>>
>> -lRblas-R/home/dev/forte/10.0/SUNWspro/lib/v8plus:/home/dev/forte/10.0/S=
UNWspro/li
>> b:/opt/SUNWspro/lib/v8plus:/opt/SUNWspro/lib
>>
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>
>> -L/home/dev/forte/10.0/SUNWspro/lib/v8plus
>> -L/home/dev/forte/10.0/SUNWspro/prod/lib/v8plus
>> -L/home/dev/forte/10.0/SUNWspro/lib
>> -L/home/dev/forte/10.0/SUNWspro/prod/lib
>> -L/usr/ccs/lib -lfui -lfai -lfai2 -lfsumai -lfprodai -lfminlai -lfmaxlai
>> -lfminvai -lfmaxvai -lfsu -lsunmath -lmtsk -lm    -lnsl -lsocket -ldl -lm
>> -licuuc -licui18n:
>> *** Error code 2
>> The following command caused the error:
>> /usr/xpg4/bin/sed -e "s:@rhome:/home/dev/scratch/bbownes/R/lib/R:" -e
>> "s:@rincludedir:/home/dev/scratch/bbownes/R/lib/R/include:" \
>>   -e 's:@libsprivate:-L/home/dev/scratch/bbownes/R/lib/R/lib
>> -lRblas-R/home/dev/forte/10.0/SUNWspro/lib/v8plus:/home/dev/forte/10.0/S=
UNWspro/li
>> b:/opt/SUNWspro/lib/v8plus:/opt/SUNWspro/lib
>> -L/home/dev/forte/10.0/SUNWspro/lib/v8plus
>> -L/home/dev/forte/10.0/SUNWspro/prod/lib/v8plus
>> -L/home/dev/forte/10.0/SUNWspro/lib
>> -L/home/dev/forte/10.0/SUNWspro/prod/lib
>> -L/usr/ccs/lib -lfui -lfai -lfai2 -lfsumai -lfprodai -lfminlai -lfmaxlai
>> -lfminvai -lfmaxvai -lfsu -lsunmath -lmtsk -lm    -lnsl -lsocket -ldl -lm
>> -licuuc -licui18n:' \
>>   -e 's/@VERSION/2.9.2/' ./libR.pc.in \
>>   > "/home/dev/scratch/bbownes/R/lib/pkgconfig/libR.pc"
>> make: Fatal error: Command failed for target `install-pc'
>> Current working directory /home/dev/scratch/bbownes/R-2.9.2/src/unix
>> *** Error code 1
>> The following command caused the error:
>> for d in scripts include extra appl nmath unix main modules library; do \
>>   (cd ${d} && make install) || exit 1; \
>> done
>> make: Fatal error: Command failed for target `install'
>> Current working directory /home/dev/scratch/bbownes/R-2.9.2/src
>> *** Error code 1
>> The following command caused the error:
>> for d in m4 tools doc etc share src tests  po; do \
>>   (cd ${d} && make install) || exit 1; \
>> done
>> make: Fatal error: Command failed for target `install'
>> bash-3.00#
>>
>> and the configure that started it all:
>> ./configure --with-readline=3Dno --with-iconv=3Dno --with-x=3Dno
>> --enable-static=3Dyes --enable-R-static-lib
>> --prefix=3D/home/dev/scratch/bbownes/R
>>
>>
>>
>>
>> On Thu, Sep 10, 2009 at 2:34 AM, Peter Dalgaard <p.dalgaard at biostat.ku.dk
>> >
>> wrote:
>>      Prof Brian Ripley wrote:
>>            On Thu, 10 Sep 2009, bownes at gmail.com wrote:
>>
>>                  Full_Name: Bob Bownes
>>                  Version: 2.9.2
>>                  OS: Solaris 10
>>                  Submission from: (NULL) (164.55.254.106)
>>
>>
>>                  The sed lines in src/unix/Makefile
>>                  confuse the grep distributed with
>>                  Solaris
>>                  that gets configured by ./configure.
>>
>>
>>            Well, it calls sed not grep!  Which version was that
>>            -- it works for me and for several others.  I have
>>            SED =3D /usr/xpg4/bin/sed (see file Makeconf), and
>>            that is 'distributed with Solaris': perhaps you do
>>            not have it installed?
>>
>>            The danger of changing R to fix a broken OS tool is
>>            that the change may break on other people's tools --
>>            better to fix the tool.
>>
>>
>>
>> Is this a tool problem at all? The most common reason for separator
>> breakage is that one of the substitution strings contains the
>> separator.
>>
>> E.g., the sed line may break if  @rhome contains a colon, and after
>> the fix it will break if it contains a comma...
>>
>>
>>
>>            Switching from a separator of ':' to a
>>            separator of ',' fixes the problem.
>>
>>            76,77c76,77
>>            <       @$(SED) -e "s:@rhome:$(rhome):" -e
>>            "s:@rincludedir:$(rincludedir):" \
>>            <         -e
>>            's:@libsprivate:$(STATIC_LIBR_PC):' \
>>            ---
>>                       @$(SED) -e
>>                  "s, at rhome,$(rhome)," -e
>>                  "s, at rincludedir,$(rincludedir)," \
>>                         -e
>>                  's, at libsprivate,$(STATIC_LIBR_PC),'
>>                  \
>>
>>
>>
>>
>> --
>>   O__  ---- Peter Dalgaard             =D8ster Farimagsgade 5, Entr.B
>>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>>  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45)
>> 35327918
>> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45)
>> 35327907
>>
>>
>>
>>
>>
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/<http=
://www.stats.ox.ac.uk/%7Eripley/>
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>

	[[alternative HTML version deleted]]


From nashjc at uottawa.ca  Thu Sep 10 19:50:16 2009
From: nashjc at uottawa.ca (Prof. John C Nash)
Date: Thu, 10 Sep 2009 13:50:16 -0400
Subject: [Rd] Non-GPL packages for R
Message-ID: <4AA93C58.1050406@uottawa.ca>

Subject: Non-GPL packages for R

Packages that are not licensed in a way that permits re-distribution on
CRAN are frequently a source of comment and concern on R-help and other
lists. A good example of this problem is the Rdonlp2 package that has 
caused a lot of annoyance for a number of optimization users in R. They 
are also an issue for efforts like Dirk Eddelbuettel's cran2deb.

There are, however, a number of circumstances where non-GPL equivalent
packages may be important to users. This can imply that users need to
both install an R package and one or more dependencies that must be
separately obtained and licensed. One such situation is where a new
program is still under development and the license is not clear, as in
the recent work we pursued with respect to Mike Powell's BOBYQA. We
wanted to verify if this were useful before we considered distribution,
and Powell had been offering copies of his code on request. Thus we
could experiment, but not redistribute. Recently Powell's approval to
redistribute has been obtained.

We believe that it is important that non-redistributable codes be
excluded from CRAN, but that they could be available on a repository
such as r-forge. However, we would like to see a clearer indication of
the license status on r-forge. One possibility is an inclusion of a
statement and/or icon indicating such status e.g., green for GPL or
equivalent, amber for uncertain, red for restricted. Another may be a
division of directories, so that GPL-equivalent packages are kept
separate from uncertain or restricted licensed ones.

We welcome comments and suggestions on both the concept and the
technicalities.

John Nash & Ravi Varadhan


From ggrothendieck at gmail.com  Thu Sep 10 20:26:50 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 10 Sep 2009 14:26:50 -0400
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <4AA93C58.1050406@uottawa.ca>
References: <4AA93C58.1050406@uottawa.ca>
Message-ID: <971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>

The SystemRequirements: field of the DESCRIPTION file normally
lists external dependencies whether free or non-free.

On Thu, Sep 10, 2009 at 1:50 PM, Prof. John C Nash <nashjc at uottawa.ca> wrote:
> Subject: Non-GPL packages for R
>
> Packages that are not licensed in a way that permits re-distribution on
> CRAN are frequently a source of comment and concern on R-help and other
> lists. A good example of this problem is the Rdonlp2 package that has caused
> a lot of annoyance for a number of optimization users in R. They are also an
> issue for efforts like Dirk Eddelbuettel's cran2deb.
>
> There are, however, a number of circumstances where non-GPL equivalent
> packages may be important to users. This can imply that users need to
> both install an R package and one or more dependencies that must be
> separately obtained and licensed. One such situation is where a new
> program is still under development and the license is not clear, as in
> the recent work we pursued with respect to Mike Powell's BOBYQA. We
> wanted to verify if this were useful before we considered distribution,
> and Powell had been offering copies of his code on request. Thus we
> could experiment, but not redistribute. Recently Powell's approval to
> redistribute has been obtained.
>
> We believe that it is important that non-redistributable codes be
> excluded from CRAN, but that they could be available on a repository
> such as r-forge. However, we would like to see a clearer indication of
> the license status on r-forge. One possibility is an inclusion of a
> statement and/or icon indicating such status e.g., green for GPL or
> equivalent, amber for uncertain, red for restricted. Another may be a
> division of directories, so that GPL-equivalent packages are kept
> separate from uncertain or restricted licensed ones.
>
> We welcome comments and suggestions on both the concept and the
> technicalities.
>
> John Nash & Ravi Varadhan
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From luke at stat.uiowa.edu  Thu Sep 10 20:46:41 2009
From: luke at stat.uiowa.edu (luke at stat.uiowa.edu)
Date: Thu, 10 Sep 2009 13:46:41 -0500 (CDT)
Subject: [Rd] Finding the environment of a promise
In-Reply-To: <4AA7C66F.8030304@stats.uwo.ca>
References: <f8e6ff050909090630t69a76ca7k2c4ea4cc35678d40@mail.gmail.com>
	<4AA7B3CA.2080702@stats.uwo.ca>
	<f8e6ff050909090753w4f5f64d1ka30e480720ddebba@mail.gmail.com>
	<4AA7C66F.8030304@stats.uwo.ca>
Message-ID: <alpine.LFD.2.00.0909101335060.11471@nokomis.stat.uiowa.edu>

One of the (many) things on my TODO list is to add some sort of
reflection mechanism for examinging the status of bindings --
standard, active, delayed but evaluated, delayed but not yet
evaluated, etc.  The interface might have a flavor like

     bindingStatus(name, envir) returns one of "standard", "delayed",
     "delayed-evaluated"

or something along these lines.  It is important not to think in terms
of promises, which happen to exist as internal implementation devices
at the moment but might not in the future.

For cases like delayed but not yet evaluated it may make sense to also
provide access to things like the expression or code (which need not
be the same), or the environment. But there are some issues.  For
example, once a delayed assignment is evaluated the environment is no
longer needed, and dropping it povides opportunities for memory
reclamation (the interpreter does this now by setting the environment
field of a promise to NULL once the promise is evaluated).  We
wouldn't want a reflection mechanism to make tha impossible. Also, in
cases like a call f(1) there is no good reason for creating a delayed
evaluation, since the result of evaluating the argument is clear.  The
interpreter doesn't do such an optimization at this time but it might
be useful in the future, and again we would not want a reflection
mechanism to get in the way of this.

So it's worth thinking about, especially if a compelling use case is
available, but there are subtleties and it would not be a good idea to
move too hastily.

Best,

luke



On Wed, 9 Sep 2009, Duncan Murdoch wrote:

> On 9/9/2009 10:53 AM, Hadley Wickham wrote:
>>> I don't think so in R code, but C code to do it would be possible.  It 
>>> needs
>>> to be in C code to avoid forcing the promise.
>> 
>> Thanks Duncan - I thought that might be the case.
>> 
>>> I think we'd be reluctant to make an R function available to do this,
>>> because it requires non-standard evaluation, and it's not something a 
>>> normal
>>> function should care about.
>> 
>> True, but there are plenty of abnormal functions in R that demonstrate
>> the usefulness (and danger!) of non-standard evaluation.
>>
>>>  (The promise belongs to the caller, not to the
>>> function:  why would the function need to play with it?  It should be 
>>> happy
>>> with the value, or maybe a text representation of the promise, for 
>>> labelling
>>> purposes.)
>> 
>> Is there any way to get a text representation apart from with
>> deparse(substitute(x))?  I think I remember asking you about this some
>> time ago, but it is still the case that blocks/promises don't store
>> srcref information?  This come up recently while trying to make a
>> function that would both run a block or code and save it to a separate
>> file (a sort of poor man's sweave when you just want to include a
>> small portion of your code in a report).  With blocks, the best I
>> could come up with was:
>
> Promises don't store srcrefs, but the evaluator does (in R-devel), a 
> statement at a time.  So you might be able to look back through the call 
> stack to find where the call came from.  (I forget whether any of this is 
> accessible from within R.  Look at the implementation of traceback() and 
> browser(), which both access this information.)
>
> Duncan Murdoch
>
>
>> 
>> named_block <- function(name, code) {
>>   text <- deparse(substitute(code), width = 100)
>>   # evaluate code
>>   force(code)
>>
>>   # construct valid filename
>>   filename <- gsub("[^a-z0-9]+", "-", tolower(name))
>>   filename <- gsub("^-|-$", "", filename)
>>   filename <- paste(filename, ".r", sep = "")
>>
>>   out <- text[!grepl("\\{|\\}", text)]
>>   out <- gsub("^    ", "", out)
>>
>>   writeLines(out, filename)
>> }
>> 
>> 
>> b <- 1
>> named_block("test", {
>>   # This is a comment
>>   a <- 1
>> })
>> 
>> print(a)
>> 
>> The problem of course is that this loses comments.
>> 
>> You can do better with functions, but it requires more typing and
>> messing around with environments to ensure everything is scoped
>> correctly:
>> 
>> named_block <- function(name, f) {
>>   text <- attr(f, "source")
>>
>>   code <- text[!grepl("^function \\(\\)\\{$|\\}", text)]
>>   code <- gsub("^  ", "", code)
>>
>>   # evaluate code
>>   eval(parse(text = code), env = parent.frame())
>>
>>   # construct valid filename
>>   filename <- gsub("[^a-z0-9]+", "-", tolower(name))
>>   filename <- gsub("^-|-$", "", filename)
>>   filename <- paste(filename, ".r", sep = "")
>>
>>   writeLines(code, filename)
>> }
>> 
>> 
>> b <- 1
>> named_block("test", function (){
>>   # This is a comment
>>   a <- 2
>> })
>> 
>> 
>> # Make sure objects created in correct environment
>> print(a)
>> 
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From bownes at gmail.com  Thu Sep 10 21:35:15 2009
From: bownes at gmail.com (bownes at gmail.com)
Date: Thu, 10 Sep 2009 21:35:15 +0200 (CEST)
Subject: [Rd] R_SHELL=/bin/bash causes issues (PR#13949)
Message-ID: <20090910193515.C2DB1282EF4D@mail.pubhealth.ku.dk>

Full_Name: Bob Bownes
Version: 2.9.2
OS: Solaris 10
Submission from: (NULL) (164.55.254.106)


Symptom: Setting R_SHELL=/bin/bash causes make to fail.

Reproduce with:
bash-3.00# export R_SHELL=/bin/csh;./configure --with-readline=no
--with-iconv=no --with-x=no --enable-static=yes 
--prefix=/home/dev/scratch/bbownes/R
bash-3.00# make
Badly placed ()'s
*** Error code 1
The following command caused the error:
if test ! -f "./doc/FAQ" || test -f non-tarball ; then \
  (cd doc/manual && make front-matter html-non-svn) ; \
  touch non-tarball ; \
  (cd .; LC_ALL=C TZ=GMT svn info || echo "Revision: unknown") 2> /dev/null \
    | sed -n -e '/^Revision/p' -e '/^Last Changed Date/'p \
    | cut -d' ' -f1,2,3,4 > SVN-REVISION-tmp ; \
  /bin/csh ./tools/move-if-change SVN-REVISION-tmp SVN-REVISION ; \
  rm -f SVN-REVISION-tmp ; \
else \
  if test "yes" = no ; then \
    for f in SVN-REVISION; do \
      ./tools/install-sh -c -m 644 ./${f} .; \
    done \
  fi \
fi
make: Fatal error: Command failed for target `svnonly'
bash-3.00# 


Was the intention of R_SHELL to allow you to set a path to your own version of
csh?


From christos at nuverabio.com  Thu Sep 10 22:45:45 2009
From: christos at nuverabio.com (Christos Hatzis)
Date: Thu, 10 Sep 2009 16:45:45 -0400
Subject: [Rd] importing/loading package without a namespace
Message-ID: <661590E4E3E64D87B2B6028BB04EBF98@headquarters.silicoinsights>

I am developing a package that imports some functions from another package.
The imported package (qcc) does not have a namespace and this is causing
problems with loading of my package, which has a namespace.  Is there a
workaround to allow loading the namespace-less package?

I searched the archives and found a suggestion that the package should be
included in the Depends list, but this has not helped.
https://stat.ethz.ch/pipermail/bioc-devel/2007-April/001079.html

Thank you.
 
The contents of my DESCRIPTION file are:
 
Package: nvQC
Type: Package
...
Depends: R(>= 2.5.0), Biobase, qcc
Imports: affy, RColorBrewer, affyio, nvNormalize
Suggests: nvCELFiles
LazyLoad: no
LazyData: yes 
 
and those of the NAMESPACE file

export(nv.evalQC, gridQC, control.plots)
import(qcc, affy)
importFrom(RColorBrewer, brewer.pal)
importFrom(affyio, read.celfiles)
importFrom(nvNormalize, norm.options)

The output from R CMD check nvQC 

* using log directory 'C:/Iatros01/Development/RPackages/nvQC/nvQC.Rcheck'
* using R version 2.9.1 (2009-06-26)
* using session charset: ISO8859-1
* checking for file 'nvQC/DESCRIPTION' ... OK
* checking extension type ... Package
* this is package 'nvQC' version '1.0.0'
* checking package name space information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking for .dll and .exe files ... OK
* checking whether package 'nvQC' can be installed ... OK
* checking package directory ... OK
* checking for portable file names ... OK
* checking DESCRIPTION meta-information ... OK
* checking top-level files ... OK
* checking index information ... OK
* checking package subdirectories ... OK
* checking R files for non-ASCII characters ... OK
* checking R files for syntax errors ... OK
* checking whether the package can be loaded ... ERROR
Loading required package: Biobase

Welcome to Bioconductor

  Vignettes contain introductory material. To view, type
  'openVignette()'. To cite Bioconductor, see
  'citation("Biobase")' and for packages 'citation(pkgname)'.

Loading required package: qcc
Error : package 'qcc' does not have a name space
Error: package/namespace load failed for 'nvQC'
Execution halted

It looks like this package has a loading problem: see the messages for
details.

Christos Hatzis, Ph.D.
Nuvera Biosciences, Inc.
400 West Cummings Park
Suite 5350
Woburn, MA 01801
Tel: 781-938-3830
www.nuverabio.com <http://www.nuverabio.com/>


From mtmorgan at fhcrc.org  Thu Sep 10 23:11:32 2009
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Thu, 10 Sep 2009 14:11:32 -0700
Subject: [Rd] importing/loading package without a namespace
In-Reply-To: <661590E4E3E64D87B2B6028BB04EBF98@headquarters.silicoinsights>
References: <661590E4E3E64D87B2B6028BB04EBF98@headquarters.silicoinsights>
Message-ID: <4AA96B84.4040904@fhcrc.org>

Hi Christos --

Christos Hatzis wrote:
> I am developing a package that imports some functions from another package.
> The imported package (qcc) does not have a namespace and this is causing
> problems with loading of my package, which has a namespace.  Is there a
> workaround to allow loading the namespace-less package?
> 
> I searched the archives and found a suggestion that the package should be
> included in the Depends list, but this has not helped.
> https://stat.ethz.ch/pipermail/bioc-devel/2007-April/001079.html
> 
> Thank you.
>  
> The contents of my DESCRIPTION file are:
>  
> Package: nvQC
> Type: Package
> ...
> Depends: R(>= 2.5.0), Biobase, qcc
> Imports: affy, RColorBrewer, affyio, nvNormalize
> Suggests: nvCELFiles
> LazyLoad: no
> LazyData: yes 
>  
> and those of the NAMESPACE file
> 
> export(nv.evalQC, gridQC, control.plots)
> import(qcc, affy)

If I understand, qcc does not have a name space, so you cannot import()
it. The best you can do is, as you have done, Depend: qcc. In your code,
you can be unambiguous about the functions you use

  qcc::someQccFunction(<etc>)

> importFrom(RColorBrewer, brewer.pal)
> importFrom(affyio, read.celfiles)
> importFrom(nvNormalize, norm.options)
> 
> The output from R CMD check nvQC 
> 
> * using log directory 'C:/Iatros01/Development/RPackages/nvQC/nvQC.Rcheck'
> * using R version 2.9.1 (2009-06-26)
> * using session charset: ISO8859-1
> * checking for file 'nvQC/DESCRIPTION' ... OK
> * checking extension type ... Package
> * this is package 'nvQC' version '1.0.0'
> * checking package name space information ... OK
> * checking package dependencies ... OK
> * checking if this is a source package ... OK
> * checking for .dll and .exe files ... OK
> * checking whether package 'nvQC' can be installed ... OK
> * checking package directory ... OK
> * checking for portable file names ... OK
> * checking DESCRIPTION meta-information ... OK
> * checking top-level files ... OK
> * checking index information ... OK
> * checking package subdirectories ... OK
> * checking R files for non-ASCII characters ... OK
> * checking R files for syntax errors ... OK
> * checking whether the package can be loaded ... ERROR
> Loading required package: Biobase
> 
> Welcome to Bioconductor
> 
>   Vignettes contain introductory material. To view, type
>   'openVignette()'. To cite Bioconductor, see
>   'citation("Biobase")' and for packages 'citation(pkgname)'.
> 
> Loading required package: qcc
> Error : package 'qcc' does not have a name space
> Error: package/namespace load failed for 'nvQC'
> Execution halted
> 
> It looks like this package has a loading problem: see the messages for
> details.
> 
> Christos Hatzis, Ph.D.
> Nuvera Biosciences, Inc.
> 400 West Cummings Park
> Suite 5350
> Woburn, MA 01801
> Tel: 781-938-3830
> www.nuverabio.com <http://www.nuverabio.com/>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From christos.hatzis at nuverabio.com  Thu Sep 10 23:46:46 2009
From: christos.hatzis at nuverabio.com (Christos Hatzis)
Date: Thu, 10 Sep 2009 17:46:46 -0400
Subject: [Rd] importing/loading package without a namespace
In-Reply-To: <4AA96B84.4040904@fhcrc.org>
References: <661590E4E3E64D87B2B6028BB04EBF98@headquarters.silicoinsights>
	<4AA96B84.4040904@fhcrc.org>
Message-ID: <40089F7B92A2482BB1F796BEA32A61A6@headquarters.silicoinsights>

Thank you Martin.
This has worked.  It was perhaps the suggestion to explicitly call the qcc
functions in my code via qcc::

Thanks.
-Christos 

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Martin Morgan
> Sent: Thursday, September 10, 2009 5:12 PM
> To: christos at nuverabio.com
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] importing/loading package without a namespace
> 
> Hi Christos --
> 
> Christos Hatzis wrote:
> > I am developing a package that imports some functions from 
> another package.
> > The imported package (qcc) does not have a namespace and this is 
> > causing problems with loading of my package, which has a 
> namespace.  
> > Is there a workaround to allow loading the namespace-less package?
> > 
> > I searched the archives and found a suggestion that the 
> package should 
> > be included in the Depends list, but this has not helped.
> > https://stat.ethz.ch/pipermail/bioc-devel/2007-April/001079.html
> > 
> > Thank you.
> >  
> > The contents of my DESCRIPTION file are:
> >  
> > Package: nvQC
> > Type: Package
> > ...
> > Depends: R(>= 2.5.0), Biobase, qcc
> > Imports: affy, RColorBrewer, affyio, nvNormalize
> > Suggests: nvCELFiles
> > LazyLoad: no
> > LazyData: yes
> >  
> > and those of the NAMESPACE file
> > 
> > export(nv.evalQC, gridQC, control.plots) import(qcc, affy)
> 
> If I understand, qcc does not have a name space, so you 
> cannot import() it. The best you can do is, as you have done, 
> Depend: qcc. In your code, you can be unambiguous about the 
> functions you use
> 
>   qcc::someQccFunction(<etc>)
> 
> > importFrom(RColorBrewer, brewer.pal)
> > importFrom(affyio, read.celfiles)
> > importFrom(nvNormalize, norm.options)
> > 
> > The output from R CMD check nvQC
> > 
> > * using log directory 
> 'C:/Iatros01/Development/RPackages/nvQC/nvQC.Rcheck'
> > * using R version 2.9.1 (2009-06-26)
> > * using session charset: ISO8859-1
> > * checking for file 'nvQC/DESCRIPTION' ... OK
> > * checking extension type ... Package
> > * this is package 'nvQC' version '1.0.0'
> > * checking package name space information ... OK
> > * checking package dependencies ... OK
> > * checking if this is a source package ... OK
> > * checking for .dll and .exe files ... OK
> > * checking whether package 'nvQC' can be installed ... OK
> > * checking package directory ... OK
> > * checking for portable file names ... OK
> > * checking DESCRIPTION meta-information ... OK
> > * checking top-level files ... OK
> > * checking index information ... OK
> > * checking package subdirectories ... OK
> > * checking R files for non-ASCII characters ... OK
> > * checking R files for syntax errors ... OK
> > * checking whether the package can be loaded ... ERROR Loading 
> > required package: Biobase
> > 
> > Welcome to Bioconductor
> > 
> >   Vignettes contain introductory material. To view, type
> >   'openVignette()'. To cite Bioconductor, see
> >   'citation("Biobase")' and for packages 'citation(pkgname)'.
> > 
> > Loading required package: qcc
> > Error : package 'qcc' does not have a name space
> > Error: package/namespace load failed for 'nvQC'
> > Execution halted
> > 
> > It looks like this package has a loading problem: see the 
> messages for 
> > details.
> > 
> > Christos Hatzis, Ph.D.
> > Nuvera Biosciences, Inc.
> > 400 West Cummings Park
> > Suite 5350
> > Woburn, MA 01801
> > Tel: 781-938-3830
> > www.nuverabio.com <http://www.nuverabio.com/>
> > 
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>


From edd at debian.org  Fri Sep 11 00:13:17 2009
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 10 Sep 2009 17:13:17 -0500
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>
References: <4AA93C58.1050406@uottawa.ca>
	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>
Message-ID: <19113.31229.97906.452635@ron.nulle.part>


On 10 September 2009 at 14:26, Gabor Grothendieck wrote:
| The SystemRequirements: field of the DESCRIPTION file normally
| lists external dependencies whether free or non-free.

Moreover, the (aptly named) field 'License:' in DESCRIPTION is now much more
parseable and contains pertinent information. A number of more 'challenging'
packages basically pass the buck on with an entry

	    License: file LICENSE

which refers to a file in the sources one needs to read to decide.

This is e.g. at the basis of Charles' and my decision about what we think we
cannot build via cran2deb [1]: non-free, non-distributable, non-commercial or
otherwise nasty licenses.  There are a couple of packages we exclude for this
(or related reasons), and we have been meaning to summarise them with a
simple html summary from the database table we use for cran2deb, but have not
yet gotten around to it.

Just like John and Ravi, I would actually be in favour of somewhat stricter
enforcements.  If someone decides not to take part in the gift economy that
brought him or her R (and many other things, including at least 1880+ CRAN
packages with sane licenses) then we may as well decide not to waste our time
and resources on his project either and simply exclude it.  

So consider this as a qualified thumbs-up for John and Ravi's suggestion of a
clearer line in the sand.

Dirk

[1] cran2deb is at http://debian.cran.r-project.org and provides 1800+ Debian
'testing' binaries for amd64 and i386 that are continuously updated as new
packages appear on CRAN. With that 'apt-get install r-cran-foo' becomes a
reality for almost every value of foo out of the set of CRAN packages.


| 
| On Thu, Sep 10, 2009 at 1:50 PM, Prof. John C Nash <nashjc at uottawa.ca> wrote:
| > Subject: Non-GPL packages for R
| >
| > Packages that are not licensed in a way that permits re-distribution on
| > CRAN are frequently a source of comment and concern on R-help and other
| > lists. A good example of this problem is the Rdonlp2 package that has caused
| > a lot of annoyance for a number of optimization users in R. They are also an
| > issue for efforts like Dirk Eddelbuettel's cran2deb.
| >
| > There are, however, a number of circumstances where non-GPL equivalent
| > packages may be important to users. This can imply that users need to
| > both install an R package and one or more dependencies that must be
| > separately obtained and licensed. One such situation is where a new
| > program is still under development and the license is not clear, as in
| > the recent work we pursued with respect to Mike Powell's BOBYQA. We
| > wanted to verify if this were useful before we considered distribution,
| > and Powell had been offering copies of his code on request. Thus we
| > could experiment, but not redistribute. Recently Powell's approval to
| > redistribute has been obtained.
| >
| > We believe that it is important that non-redistributable codes be
| > excluded from CRAN, but that they could be available on a repository
| > such as r-forge. However, we would like to see a clearer indication of
| > the license status on r-forge. One possibility is an inclusion of a
| > statement and/or icon indicating such status e.g., green for GPL or
| > equivalent, amber for uncertain, red for restricted. Another may be a
| > division of directories, so that GPL-equivalent packages are kept
| > separate from uncertain or restricted licensed ones.
| >
| > We welcome comments and suggestions on both the concept and the
| > technicalities.
| >
| > John Nash & Ravi Varadhan
| >
| > ______________________________________________
| > R-devel at r-project.org mailing list
| > https://stat.ethz.ch/mailman/listinfo/r-devel
| >
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Three out of two people have difficulties with fractions.


From spencer.graves at prodsyse.com  Fri Sep 11 00:57:21 2009
From: spencer.graves at prodsyse.com (spencerg)
Date: Thu, 10 Sep 2009 15:57:21 -0700
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <19113.31229.97906.452635@ron.nulle.part>
References: <4AA93C58.1050406@uottawa.ca>	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>
	<19113.31229.97906.452635@ron.nulle.part>
Message-ID: <4AA98451.3040003@prodsyse.com>

      I will offer my opinion as a user and contributer to R packages 
via R-Forge and CRAN: 


           1.  How difficult would it be to split CRAN into two parts, 
depending on whether the package carried an acceptable license allowing 
free distribution?  The second might carry a name like RANC (R Archive 
Network - Commercial), and the first would retain the CRAN name. 


           2.  R-Forge allows public access to the source code, at least 
for some packages.  Moreover, users applying for R-Forge support must 
specify the license they plan to use.  Support may be denied for a 
project that does not use one of the standard public distribution 
licenses like GPL. 


      Spencer


Dirk Eddelbuettel wrote:
> On 10 September 2009 at 14:26, Gabor Grothendieck wrote:
> | The SystemRequirements: field of the DESCRIPTION file normally
> | lists external dependencies whether free or non-free.
>
> Moreover, the (aptly named) field 'License:' in DESCRIPTION is now much more
> parseable and contains pertinent information. A number of more 'challenging'
> packages basically pass the buck on with an entry
>
> 	    License: file LICENSE
>
> which refers to a file in the sources one needs to read to decide.
>
> This is e.g. at the basis of Charles' and my decision about what we think we
> cannot build via cran2deb [1]: non-free, non-distributable, non-commercial or
> otherwise nasty licenses.  There are a couple of packages we exclude for this
> (or related reasons), and we have been meaning to summarise them with a
> simple html summary from the database table we use for cran2deb, but have not
> yet gotten around to it.
>
> Just like John and Ravi, I would actually be in favour of somewhat stricter
> enforcements.  If someone decides not to take part in the gift economy that
> brought him or her R (and many other things, including at least 1880+ CRAN
> packages with sane licenses) then we may as well decide not to waste our time
> and resources on his project either and simply exclude it.  
>
> So consider this as a qualified thumbs-up for John and Ravi's suggestion of a
> clearer line in the sand.
>
> Dirk
>
> [1] cran2deb is at http://debian.cran.r-project.org and provides 1800+ Debian
> 'testing' binaries for amd64 and i386 that are continuously updated as new
> packages appear on CRAN. With that 'apt-get install r-cran-foo' becomes a
> reality for almost every value of foo out of the set of CRAN packages.
>
>
> | 
> | On Thu, Sep 10, 2009 at 1:50 PM, Prof. John C Nash <nashjc at uottawa.ca> wrote:
> | > Subject: Non-GPL packages for R
> | >
> | > Packages that are not licensed in a way that permits re-distribution on
> | > CRAN are frequently a source of comment and concern on R-help and other
> | > lists. A good example of this problem is the Rdonlp2 package that has caused
> | > a lot of annoyance for a number of optimization users in R. They are also an
> | > issue for efforts like Dirk Eddelbuettel's cran2deb.
> | >
> | > There are, however, a number of circumstances where non-GPL equivalent
> | > packages may be important to users. This can imply that users need to
> | > both install an R package and one or more dependencies that must be
> | > separately obtained and licensed. One such situation is where a new
> | > program is still under development and the license is not clear, as in
> | > the recent work we pursued with respect to Mike Powell's BOBYQA. We
> | > wanted to verify if this were useful before we considered distribution,
> | > and Powell had been offering copies of his code on request. Thus we
> | > could experiment, but not redistribute. Recently Powell's approval to
> | > redistribute has been obtained.
> | >
> | > We believe that it is important that non-redistributable codes be
> | > excluded from CRAN, but that they could be available on a repository
> | > such as r-forge. However, we would like to see a clearer indication of
> | > the license status on r-forge. One possibility is an inclusion of a
> | > statement and/or icon indicating such status e.g., green for GPL or
> | > equivalent, amber for uncertain, red for restricted. Another may be a
> | > division of directories, so that GPL-equivalent packages are kept
> | > separate from uncertain or restricted licensed ones.
> | >
> | > We welcome comments and suggestions on both the concept and the
> | > technicalities.
> | >
> | > John Nash & Ravi Varadhan
> | >
> | > ______________________________________________
> | > R-devel at r-project.org mailing list
> | > https://stat.ethz.ch/mailman/listinfo/r-devel
> | >
> | 
> | ______________________________________________
> | R-devel at r-project.org mailing list
> | https://stat.ethz.ch/mailman/listinfo/r-devel
>
>   


-- 
Spencer Graves, PE, PhD
President and Chief Operating Officer
Structure Inspection and Monitoring, Inc.
751 Emerson Ct.
San Jos?, CA 95126
ph:  408-655-4567


From nikko at hailmail.net  Fri Sep 11 01:08:55 2009
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Thu, 10 Sep 2009 16:08:55 -0700
Subject: [Rd] (no subject)
Message-ID: <1252624135.3000.1334248455@webmail.messagingengine.com>

Hi,
I would also be in favor of a stronger stance on licenses. In
industry, where we can really get in big trouble for violating a
license,
we often maintain internal repositories, or need to be careful about
filtering
what is used from CRAN. I think that is should really be a requirement
the package
authors commit to stating what the restrictions are on their packages. 

Nicholas


On 10 September 2009 at 14:26, Gabor Grothendieck wrote:
| The SystemRequirements: field of the DESCRIPTION file normally
| lists external dependencies whether free or non-free.

Moreover, the (aptly named) field 'License:' in DESCRIPTION is now much
more
parseable and contains pertinent information. A number of more
'challenging'
packages basically pass the buck on with an entry

	    License: file LICENSE

which refers to a file in the sources one needs to read to decide.

This is e.g. at the basis of Charles' and my decision about what we
think we
cannot build via cran2deb [1]: non-free, non-distributable,
non-commercial or
otherwise nasty licenses.  There are a couple of packages we exclude for
this
(or related reasons), and we have been meaning to summarise them with a
simple html summary from the database table we use for cran2deb, but
have not
yet gotten around to it.

Just like John and Ravi, I would actually be in favour of somewhat
stricter
enforcements.  If someone decides not to take part in the gift economy
that
brought him or her R (and many other things, including at least 1880+
CRAN
packages with sane licenses) then we may as well decide not to waste our
time
and resources on his project either and simply exclude it.  

So consider this as a qualified thumbs-up for John and Ravi's suggestion
of a
clearer line in the sand.

Dirk

[1] cran2deb is at http://debian.cran.r-project.org and provides 1800+
Debian
'testing' binaries for amd64 and i386 that are continuously updated as
new
packages appear on CRAN. With that 'apt-get install r-cran-foo' becomes
a
reality for almost every value of foo out of the set of CRAN packages.


| 
| On Thu, Sep 10, 2009 at 1:50 PM, Prof. John C Nash <nashjc at
uottawa.ca> wrote:
| > Subject: Non-GPL packages for R
| >
| > Packages that are not licensed in a way that permits re-distribution
on
| > CRAN are frequently a source of comment and concern on R-help and
other
| > lists. A good example of this problem is the Rdonlp2 package that
has caused
| > a lot of annoyance for a number of optimization users in R. They are
also an
| > issue for efforts like Dirk Eddelbuettel's cran2deb.
| >
| > There are, however, a number of circumstances where non-GPL
equivalent
| > packages may be important to users. This can imply that users need
to
| > both install an R package and one or more dependencies that must be
| > separately obtained and licensed. One such situation is where a new
| > program is still under development and the license is not clear, as
in
| > the recent work we pursued with respect to Mike Powell's BOBYQA. We
| > wanted to verify if this were useful before we considered
distribution,
| > and Powell had been offering copies of his code on request. Thus we
| > could experiment, but not redistribute. Recently Powell's approval
to
| > redistribute has been obtained.
| >
| > We believe that it is important that non-redistributable codes be
| > excluded from CRAN, but that they could be available on a repository
| > such as r-forge. However, we would like to see a clearer indication
of
| > the license status on r-forge. One possibility is an inclusion of a
| > statement and/or icon indicating such status e.g., green for GPL or
| > equivalent, amber for uncertain, red for restricted. Another may be
a
| > division of directories, so that GPL-equivalent packages are kept
| > separate from uncertain or restricted licensed ones.
| >
| > We welcome comments and suggestions on both the concept and the
| > technicalities.
| >
| > John Nash & Ravi Varadhan
| >
| > ______________________________________________
| > R-devel at r-project.org mailing list
| > https://stat.ethz.ch/mailman/listinfo/r-devel
| >
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel


From nikko at hailmail.net  Fri Sep 11 01:10:49 2009
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Thu, 10 Sep 2009 16:10:49 -0700
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <1252624135.3000.1334248455@webmail.messagingengine.com>
References: <1252624135.3000.1334248455@webmail.messagingengine.com>
Message-ID: <1252624249.3364.1334249703@webmail.messagingengine.com>


With header this time
On Thu, 10 Sep 2009 16:08 -0700, "Nicholas Lewin-Koh"
<nikko at hailmail.net> wrote:
> Hi,
> I would also be in favor of a stronger stance on licenses. In
> industry, where we can really get in big trouble for violating a
> license,
> we often maintain internal repositories, or need to be careful about
> filtering
> what is used from CRAN. I think that is should really be a requirement
> the package
> authors commit to stating what the restrictions are on their packages. 
> 
> Nicholas
> 
> 
> On 10 September 2009 at 14:26, Gabor Grothendieck wrote:
> | The SystemRequirements: field of the DESCRIPTION file normally
> | lists external dependencies whether free or non-free.
> 
> Moreover, the (aptly named) field 'License:' in DESCRIPTION is now much
> more
> parseable and contains pertinent information. A number of more
> 'challenging'
> packages basically pass the buck on with an entry
> 
> 	    License: file LICENSE
> 
> which refers to a file in the sources one needs to read to decide.
> 
> This is e.g. at the basis of Charles' and my decision about what we
> think we
> cannot build via cran2deb [1]: non-free, non-distributable,
> non-commercial or
> otherwise nasty licenses.  There are a couple of packages we exclude for
> this
> (or related reasons), and we have been meaning to summarise them with a
> simple html summary from the database table we use for cran2deb, but
> have not
> yet gotten around to it.
> 
> Just like John and Ravi, I would actually be in favour of somewhat
> stricter
> enforcements.  If someone decides not to take part in the gift economy
> that
> brought him or her R (and many other things, including at least 1880+
> CRAN
> packages with sane licenses) then we may as well decide not to waste our
> time
> and resources on his project either and simply exclude it.  
> 
> So consider this as a qualified thumbs-up for John and Ravi's suggestion
> of a
> clearer line in the sand.
> 
> Dirk
> 
> [1] cran2deb is at http://debian.cran.r-project.org and provides 1800+
> Debian
> 'testing' binaries for amd64 and i386 that are continuously updated as
> new
> packages appear on CRAN. With that 'apt-get install r-cran-foo' becomes
> a
> reality for almost every value of foo out of the set of CRAN packages.
> 
> 
> | 
> | On Thu, Sep 10, 2009 at 1:50 PM, Prof. John C Nash <nashjc at
> uottawa.ca> wrote:
> | > Subject: Non-GPL packages for R
> | >
> | > Packages that are not licensed in a way that permits re-distribution
> on
> | > CRAN are frequently a source of comment and concern on R-help and
> other
> | > lists. A good example of this problem is the Rdonlp2 package that
> has caused
> | > a lot of annoyance for a number of optimization users in R. They are
> also an
> | > issue for efforts like Dirk Eddelbuettel's cran2deb.
> | >
> | > There are, however, a number of circumstances where non-GPL
> equivalent
> | > packages may be important to users. This can imply that users need
> to
> | > both install an R package and one or more dependencies that must be
> | > separately obtained and licensed. One such situation is where a new
> | > program is still under development and the license is not clear, as
> in
> | > the recent work we pursued with respect to Mike Powell's BOBYQA. We
> | > wanted to verify if this were useful before we considered
> distribution,
> | > and Powell had been offering copies of his code on request. Thus we
> | > could experiment, but not redistribute. Recently Powell's approval
> to
> | > redistribute has been obtained.
> | >
> | > We believe that it is important that non-redistributable codes be
> | > excluded from CRAN, but that they could be available on a repository
> | > such as r-forge. However, we would like to see a clearer indication
> of
> | > the license status on r-forge. One possibility is an inclusion of a
> | > statement and/or icon indicating such status e.g., green for GPL or
> | > equivalent, amber for uncertain, red for restricted. Another may be
> a
> | > division of directories, so that GPL-equivalent packages are kept
> | > separate from uncertain or restricted licensed ones.
> | >
> | > We welcome comments and suggestions on both the concept and the
> | > technicalities.
> | >
> | > John Nash & Ravi Varadhan
> | >
> | > ______________________________________________
> | > R-devel at r-project.org mailing list
> | > https://stat.ethz.ch/mailman/listinfo/r-devel
> | >
> | 
> | ______________________________________________
> | R-devel at r-project.org mailing list
> | https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch at stats.uwo.ca  Fri Sep 11 01:15:08 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 10 Sep 2009 19:15:08 -0400
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <4AA98451.3040003@prodsyse.com>
References: <4AA93C58.1050406@uottawa.ca>	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>	<19113.31229.97906.452635@ron.nulle.part>
	<4AA98451.3040003@prodsyse.com>
Message-ID: <4AA9887C.2050901@stats.uwo.ca>

On 10/09/2009 6:57 PM, spencerg wrote:
>       I will offer my opinion as a user and contributer to R packages 
> via R-Forge and CRAN: 
> 
> 
>            1.  How difficult would it be to split CRAN into two parts, 
> depending on whether the package carried an acceptable license allowing 
> free distribution?  The second might carry a name like RANC (R Archive 
> Network - Commercial), and the first would retain the CRAN name. 

To this I would say, try it.  Don't ask volunteers to do some work that 
suits you; do it yourself.

Duncan Murdoch

> 
> 
>            2.  R-Forge allows public access to the source code, at least 
> for some packages.  Moreover, users applying for R-Forge support must 
> specify the license they plan to use.  Support may be denied for a 
> project that does not use one of the standard public distribution 
> licenses like GPL. 
> 
> 
>       Spencer
> 
> 
> Dirk Eddelbuettel wrote:
>> On 10 September 2009 at 14:26, Gabor Grothendieck wrote:
>> | The SystemRequirements: field of the DESCRIPTION file normally
>> | lists external dependencies whether free or non-free.
>>
>> Moreover, the (aptly named) field 'License:' in DESCRIPTION is now much more
>> parseable and contains pertinent information. A number of more 'challenging'
>> packages basically pass the buck on with an entry
>>
>> 	    License: file LICENSE
>>
>> which refers to a file in the sources one needs to read to decide.
>>
>> This is e.g. at the basis of Charles' and my decision about what we think we
>> cannot build via cran2deb [1]: non-free, non-distributable, non-commercial or
>> otherwise nasty licenses.  There are a couple of packages we exclude for this
>> (or related reasons), and we have been meaning to summarise them with a
>> simple html summary from the database table we use for cran2deb, but have not
>> yet gotten around to it.
>>
>> Just like John and Ravi, I would actually be in favour of somewhat stricter
>> enforcements.  If someone decides not to take part in the gift economy that
>> brought him or her R (and many other things, including at least 1880+ CRAN
>> packages with sane licenses) then we may as well decide not to waste our time
>> and resources on his project either and simply exclude it.  
>>
>> So consider this as a qualified thumbs-up for John and Ravi's suggestion of a
>> clearer line in the sand.
>>
>> Dirk
>>
>> [1] cran2deb is at http://debian.cran.r-project.org and provides 1800+ Debian
>> 'testing' binaries for amd64 and i386 that are continuously updated as new
>> packages appear on CRAN. With that 'apt-get install r-cran-foo' becomes a
>> reality for almost every value of foo out of the set of CRAN packages.
>>
>>
>> | 
>> | On Thu, Sep 10, 2009 at 1:50 PM, Prof. John C Nash <nashjc at uottawa.ca> wrote:
>> | > Subject: Non-GPL packages for R
>> | >
>> | > Packages that are not licensed in a way that permits re-distribution on
>> | > CRAN are frequently a source of comment and concern on R-help and other
>> | > lists. A good example of this problem is the Rdonlp2 package that has caused
>> | > a lot of annoyance for a number of optimization users in R. They are also an
>> | > issue for efforts like Dirk Eddelbuettel's cran2deb.
>> | >
>> | > There are, however, a number of circumstances where non-GPL equivalent
>> | > packages may be important to users. This can imply that users need to
>> | > both install an R package and one or more dependencies that must be
>> | > separately obtained and licensed. One such situation is where a new
>> | > program is still under development and the license is not clear, as in
>> | > the recent work we pursued with respect to Mike Powell's BOBYQA. We
>> | > wanted to verify if this were useful before we considered distribution,
>> | > and Powell had been offering copies of his code on request. Thus we
>> | > could experiment, but not redistribute. Recently Powell's approval to
>> | > redistribute has been obtained.
>> | >
>> | > We believe that it is important that non-redistributable codes be
>> | > excluded from CRAN, but that they could be available on a repository
>> | > such as r-forge. However, we would like to see a clearer indication of
>> | > the license status on r-forge. One possibility is an inclusion of a
>> | > statement and/or icon indicating such status e.g., green for GPL or
>> | > equivalent, amber for uncertain, red for restricted. Another may be a
>> | > division of directories, so that GPL-equivalent packages are kept
>> | > separate from uncertain or restricted licensed ones.
>> | >
>> | > We welcome comments and suggestions on both the concept and the
>> | > technicalities.
>> | >
>> | > John Nash & Ravi Varadhan
>> | >
>> | > ______________________________________________
>> | > R-devel at r-project.org mailing list
>> | > https://stat.ethz.ch/mailman/listinfo/r-devel
>> | >
>> | 
>> | ______________________________________________
>> | R-devel at r-project.org mailing list
>> | https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>   
> 
>


From ggrothendieck at gmail.com  Fri Sep 11 02:59:01 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 10 Sep 2009 20:59:01 -0400
Subject: [Rd] Needless updating of HTML package descriptions
Message-ID: <971536df0909101759n2132083bu7aca7279465cdd05@mail.gmail.com>

I recently installed a local package which failed because the package
was already loaded; however, then it tried to update all the HTML
package descriptions needlessly (since they had not changed due
to the failure to install).  Since updating the HTML package descriptions
can be time consuming the processing should skip the update in this case.

> utils:::menuInstallLocal()
Warning: package 'myPackage' is in use and will not be installed
updating HTML package descriptions


From romain.francois at dbmail.com  Fri Sep 11 09:07:42 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Fri, 11 Sep 2009 09:07:42 +0200
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <19113.31229.97906.452635@ron.nulle.part>
References: <4AA93C58.1050406@uottawa.ca>	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>
	<19113.31229.97906.452635@ron.nulle.part>
Message-ID: <4AA9F73E.5000507@dbmail.com>

+1

Commit to freedom if you want the free services of CRAN, etc ...

On 09/11/2009 12:13 AM, Dirk Eddelbuettel wrote:
>
>
> On 10 September 2009 at 14:26, Gabor Grothendieck wrote:
> | The SystemRequirements: field of the DESCRIPTION file normally
> | lists external dependencies whether free or non-free.
>
> Moreover, the (aptly named) field 'License:' in DESCRIPTION is now much more
> parseable and contains pertinent information. A number of more 'challenging'
> packages basically pass the buck on with an entry
>
> 	    License: file LICENSE
>
> which refers to a file in the sources one needs to read to decide.
>
> This is e.g. at the basis of Charles' and my decision about what we think we
> cannot build via cran2deb [1]: non-free, non-distributable, non-commercial or
> otherwise nasty licenses.  There are a couple of packages we exclude for this
> (or related reasons), and we have been meaning to summarise them with a
> simple html summary from the database table we use for cran2deb, but have not
> yet gotten around to it.
>
> Just like John and Ravi, I would actually be in favour of somewhat stricter
> enforcements.  If someone decides not to take part in the gift economy that
> brought him or her R (and many other things, including at least 1880+ CRAN
> packages with sane licenses) then we may as well decide not to waste our time
> and resources on his project either and simply exclude it.
>
> So consider this as a qualified thumbs-up for John and Ravi's suggestion of a
> clearer line in the sand.
>
> Dirk
>
> [1] cran2deb is at http://debian.cran.r-project.org and provides 1800+ Debian
> 'testing' binaries for amd64 and i386 that are continuously updated as new
> packages appear on CRAN. With that 'apt-get install r-cran-foo' becomes a
> reality for almost every value of foo out of the set of CRAN packages.
>
>
> |
> | On Thu, Sep 10, 2009 at 1:50 PM, Prof. John C Nash<nashjc at uottawa.ca>  wrote:
> |>  Subject: Non-GPL packages for R
> |>
> |>  Packages that are not licensed in a way that permits re-distribution on
> |>  CRAN are frequently a source of comment and concern on R-help and other
> |>  lists. A good example of this problem is the Rdonlp2 package that has caused
> |>  a lot of annoyance for a number of optimization users in R. They are also an
> |>  issue for efforts like Dirk Eddelbuettel's cran2deb.
> |>
> |>  There are, however, a number of circumstances where non-GPL equivalent
> |>  packages may be important to users. This can imply that users need to
> |>  both install an R package and one or more dependencies that must be
> |>  separately obtained and licensed. One such situation is where a new
> |>  program is still under development and the license is not clear, as in
> |>  the recent work we pursued with respect to Mike Powell's BOBYQA. We
> |>  wanted to verify if this were useful before we considered distribution,
> |>  and Powell had been offering copies of his code on request. Thus we
> |>  could experiment, but not redistribute. Recently Powell's approval to
> |>  redistribute has been obtained.
> |>
> |>  We believe that it is important that non-redistributable codes be
> |>  excluded from CRAN, but that they could be available on a repository
> |>  such as r-forge. However, we would like to see a clearer indication of
> |>  the license status on r-forge. One possibility is an inclusion of a
> |>  statement and/or icon indicating such status e.g., green for GPL or
> |>  equivalent, amber for uncertain, red for restricted. Another may be a
> |>  division of directories, so that GPL-equivalent packages are kept
> |>  separate from uncertain or restricted licensed ones.
> |>
> |>  We welcome comments and suggestions on both the concept and the
> |>  technicalities.
> |>
> |>  John Nash&  Ravi Varadhan

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/y8y0 : search the graph gallery from R
|- http://tr.im/y8wY : new R package : ant
`- http://tr.im/xMdt : update on the ant package


From maechler at stat.math.ethz.ch  Fri Sep 11 12:22:54 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 11 Sep 2009 12:22:54 +0200
Subject: [Rd] Logic ("!", "&", ...) on complex
Message-ID: <19114.9470.797624.843607@lynne.math.ethz.ch>

The documentation,  help("!") e.g.,
contains

 > Arguments:

 >     x, y: logical vectors, or objects which can be coerced to such or
 >           for which methods have been written.

and then later

 > Numeric and complex vectors will be coerced to logical values,
 > with zero being false and all non-zero values being true. 

and that is consistent with what  S-plus (3.4, 5.1, 8.0.2)
gives.

However, (nowadays at least) R internally checks and gives an
error for complex arguments,
even though   as.logical(0 + 1i)  works fine.

 > z <- complex(i=1)
 > !z
 Error in !z : invalid argument type
 > !as.logical(z)
 [1] FALSE


I'm proposing to make R's behavior consistent with its
documentation and predecessor.

Martin Maechler


From nashjc at uottawa.ca  Fri Sep 11 15:07:03 2009
From: nashjc at uottawa.ca (Prof. John C Nash)
Date: Fri, 11 Sep 2009 09:07:03 -0400
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <4AA98451.3040003@prodsyse.com>
References: <4AA93C58.1050406@uottawa.ca>	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>
	<19113.31229.97906.452635@ron.nulle.part>
	<4AA98451.3040003@prodsyse.com>
Message-ID: <4AAA4B77.8070601@uottawa.ca>

The responses to my posting yesterday seem to indicate more consensus 
than I expected:
1) CRAN should be restricted to GPL-equivalent licensed packages
2) r-forge could be left "buyer beware" using DESCRIPTION information
3) We may want a specific repository for restricted packages (RANC?)

How to proceed? A short search on Rseek did not turn up a chain of 
command for CRAN.

I'm prepared to help out with documentation etc. to move changes 
forward. They are not, in my opinion, likely to cause a lot of trouble 
for most users, and should simplify things over time.

JN


From P.Dalgaard at biostat.ku.dk  Fri Sep 11 16:37:45 2009
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri, 11 Sep 2009 16:37:45 +0200
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <4AAA4B77.8070601@uottawa.ca>
References: <4AA93C58.1050406@uottawa.ca>	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>	<19113.31229.97906.452635@ron.nulle.part>	<4AA98451.3040003@prodsyse.com>
	<4AAA4B77.8070601@uottawa.ca>
Message-ID: <4AAA60B9.2050203@biostat.ku.dk>

Prof. John C Nash wrote:
> The responses to my posting yesterday seem to indicate more consensus
> than I expected:
> 1) CRAN should be restricted to GPL-equivalent licensed packages

GPL-_compatible_ would be the word. However, this is not what has been
done in the past. There are packages with "non-commercial use" licences,
and the survival package was among them for quite a while. As far as I
know, the CRAN policy has been to ensure only that redistribution is
legal and that whatever license is used is visible to the user. People
who have responded on the list do not necessarily speak for CRAN. In the
final analysis, the maintainers must decide what is maintainable.

The problem with Rdonlp2 seems to have been that the interface packages
claimed to be LGPL2 without the main copyright holder's consent (and it
seems that he cannot grant consent for reasons of TU-Darmstadt
policies). It is hard to safeguard agaist that sort of thing. CRAN
maintainers must assume that legalities have been cleared and accept the
license in good faith.

(Even within the Free Software world there are current issues with,
e.g., incompatibilities between GPL v.2 and v.3, and also with the
Eclipse license. Don't get me started...)

> 2) r-forge could be left "buyer beware" using DESCRIPTION information
> 3) We may want a specific repository for restricted packages (RANC?)
> 
> How to proceed? A short search on Rseek did not turn up a chain of
> command for CRAN.
> 
> I'm prepared to help out with documentation etc. to move changes
> forward. They are not, in my opinion, likely to cause a lot of trouble
> for most users, and should simplify things over time.
> 
> JN
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From rgentlem at fhcrc.org  Fri Sep 11 16:48:14 2009
From: rgentlem at fhcrc.org (Robert Gentleman)
Date: Fri, 11 Sep 2009 07:48:14 -0700
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <4AAA60B9.2050203@biostat.ku.dk>
References: <4AA93C58.1050406@uottawa.ca>	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>	<19113.31229.97906.452635@ron.nulle.part>	<4AA98451.3040003@prodsyse.com>	<4AAA4B77.8070601@uottawa.ca>
	<4AAA60B9.2050203@biostat.ku.dk>
Message-ID: <4AAA632E.1080304@fhcrc.org>

Hi,

Peter Dalgaard wrote:
> Prof. John C Nash wrote:
>> The responses to my posting yesterday seem to indicate more consensus
>> than I expected:

  Umm, I had thought that it was well established that responders need 
not represent the population being surveyed.  I doubt that there is 
consensus at the level you are suggesting (certainly I don't agree) and 
as Peter indicates below the issue is: what is maintainable with the 
resources we have, not what is the best solution given unlimited resources.

   Personally, I would like to see something that was a bit easier to 
deal with programmatically that indicated when a package was GPL (or 
Open source actually) compatible and when it is not.  This could then be 
used to write a decent function to identify suspect packages so that 
users would know when they should be concerned.

   It is also the case that things are not so simple, as dependencies 
can make a package unusable even if it is itself GPL-compatible.  This 
also makes the notion of some simple split into free and non-free (or 
what ever split you want) less trivial than is being suggested.

   Robert


>> 1) CRAN should be restricted to GPL-equivalent licensed packages
> 
> GPL-_compatible_ would be the word. However, this is not what has been
> done in the past. There are packages with "non-commercial use" licences,
> and the survival package was among them for quite a while. As far as I
> know, the CRAN policy has been to ensure only that redistribution is
> legal and that whatever license is used is visible to the user. People
> who have responded on the list do not necessarily speak for CRAN. In the
> final analysis, the maintainers must decide what is maintainable.
> 
> The problem with Rdonlp2 seems to have been that the interface packages
> claimed to be LGPL2 without the main copyright holder's consent (and it
> seems that he cannot grant consent for reasons of TU-Darmstadt
> policies). It is hard to safeguard agaist that sort of thing. CRAN
> maintainers must assume that legalities have been cleared and accept the
> license in good faith.
> 
> (Even within the Free Software world there are current issues with,
> e.g., incompatibilities between GPL v.2 and v.3, and also with the
> Eclipse license. Don't get me started...)
> 
>> 2) r-forge could be left "buyer beware" using DESCRIPTION information
>> 3) We may want a specific repository for restricted packages (RANC?)
>>
>> How to proceed? A short search on Rseek did not turn up a chain of
>> command for CRAN.
>>
>> I'm prepared to help out with documentation etc. to move changes
>> forward. They are not, in my opinion, likely to cause a lot of trouble
>> for most users, and should simplify things over time.
>>
>> JN
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>


From arne.henningsen at googlemail.com  Fri Sep 11 16:48:23 2009
From: arne.henningsen at googlemail.com (Arne Henningsen)
Date: Fri, 11 Sep 2009 16:48:23 +0200
Subject: [Rd] Fortran routine affected by unrelated R code
Message-ID: <ee2a35a60909110748o89ae7basd8ff1ebc204f264e@mail.gmail.com>

Hi!

When I run "R CMD check" on the current development version of my R
package "frontier" [1], there is no difference between the output of
the test scripts in the /tests/ folder and the saved output files
(.Rout.save). However, if I change an R file in the /R/ folder, some
calls to the Fortran code (called by ".Fortran()") return different
results, although the change of the R file is not related to this,
e.g. when I add the commands 'print("abc")' or 'newVariable <- 123' to
an R file that even does not call the Fortran code. However, adding
empty lines or comments does NOT change the values returned by the
Fortran code. Different modifications of the R files lead to different
results but the same modification always leads to the same results
(hence, the results are perfectly reproducible). Since the Fortran
code does a non-linear optimization, (slightly) different results
(e.g. depending on starting values) could be expected. However, the
values passed to the Fortran code are not affected by the
modifications that alter the values returned by the Fortran code and I
cannot sea any connection between the modification of the R files and
the values returned by the Fortran code. Could this phenomenon be
caused by an error in the Fortran code, by a bug in R, or is this a
usual behavior that an expert would expect in this situation? Any
hints are welcome!

Arne

[1] http://r-forge.r-project.org/projects/frontier/

-- 
Arne Henningsen
http://www.arne-henningsen.name


From Kurt.Hornik at wu.ac.at  Fri Sep 11 16:57:42 2009
From: Kurt.Hornik at wu.ac.at (Kurt Hornik)
Date: Fri, 11 Sep 2009 16:57:42 +0200
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <4AA98451.3040003@prodsyse.com>
References: <4AA93C58.1050406@uottawa.ca>
	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>
	<19113.31229.97906.452635@ron.nulle.part>
	<4AA98451.3040003@prodsyse.com>
Message-ID: <19114.25958.220767.785610@fangorn.hornik.net>

>>>>> spencerg  writes:

>       I will offer my opinion as a user and contributer to R packages 
> via R-Forge and CRAN: 


>            1.  How difficult would it be to split CRAN into two parts, 
> depending on whether the package carried an acceptable license allowing 
> free distribution?  The second might carry a name like RANC (R Archive 
> Network - Commercial), and the first would retain the CRAN name.

You are suggesting we create and maintain an *empty* repository?

All packages on CRAN should be freely redistributable by/within CRAN.
If you find a package which is not, pls let us know---such packages must
be removed from CRAN.

I think you are mistaking the situation about "non-free" packages: these
typically restrict usage for commercial purposes.

-k


>            2.  R-Forge allows public access to the source code, at least 
> for some packages.  Moreover, users applying for R-Forge support must 
> specify the license they plan to use.  Support may be denied for a 
> project that does not use one of the standard public distribution 
> licenses like GPL. 


>       Spencer


> Dirk Eddelbuettel wrote:
>> On 10 September 2009 at 14:26, Gabor Grothendieck wrote:
>> | The SystemRequirements: field of the DESCRIPTION file normally
>> | lists external dependencies whether free or non-free.
>> 
>> Moreover, the (aptly named) field 'License:' in DESCRIPTION is now much more
>> parseable and contains pertinent information. A number of more 'challenging'
>> packages basically pass the buck on with an entry
>> 
>> License: file LICENSE
>> 
>> which refers to a file in the sources one needs to read to decide.
>> 
>> This is e.g. at the basis of Charles' and my decision about what we think we
>> cannot build via cran2deb [1]: non-free, non-distributable, non-commercial or
>> otherwise nasty licenses.  There are a couple of packages we exclude for this
>> (or related reasons), and we have been meaning to summarise them with a
>> simple html summary from the database table we use for cran2deb, but have not
>> yet gotten around to it.
>> 
>> Just like John and Ravi, I would actually be in favour of somewhat stricter
>> enforcements.  If someone decides not to take part in the gift economy that
>> brought him or her R (and many other things, including at least 1880+ CRAN
>> packages with sane licenses) then we may as well decide not to waste our time
>> and resources on his project either and simply exclude it.  
>> 
>> So consider this as a qualified thumbs-up for John and Ravi's suggestion of a
>> clearer line in the sand.
>> 
>> Dirk
>> 
>> [1] cran2deb is at http://debian.cran.r-project.org and provides 1800+ Debian
>> 'testing' binaries for amd64 and i386 that are continuously updated as new
>> packages appear on CRAN. With that 'apt-get install r-cran-foo' becomes a
>> reality for almost every value of foo out of the set of CRAN packages.
>> 
>> 
>> | 
>> | On Thu, Sep 10, 2009 at 1:50 PM, Prof. John C Nash <nashjc at uottawa.ca> wrote:
>> | > Subject: Non-GPL packages for R
>> | >
>> | > Packages that are not licensed in a way that permits re-distribution on
>> | > CRAN are frequently a source of comment and concern on R-help and other
>> | > lists. A good example of this problem is the Rdonlp2 package that has caused
>> | > a lot of annoyance for a number of optimization users in R. They are also an
>> | > issue for efforts like Dirk Eddelbuettel's cran2deb.
>> | >
>> | > There are, however, a number of circumstances where non-GPL equivalent
>> | > packages may be important to users. This can imply that users need to
>> | > both install an R package and one or more dependencies that must be
>> | > separately obtained and licensed. One such situation is where a new
>> | > program is still under development and the license is not clear, as in
>> | > the recent work we pursued with respect to Mike Powell's BOBYQA. We
>> | > wanted to verify if this were useful before we considered distribution,
>> | > and Powell had been offering copies of his code on request. Thus we
>> | > could experiment, but not redistribute. Recently Powell's approval to
>> | > redistribute has been obtained.
>> | >
>> | > We believe that it is important that non-redistributable codes be
>> | > excluded from CRAN, but that they could be available on a repository
>> | > such as r-forge. However, we would like to see a clearer indication of
>> | > the license status on r-forge. One possibility is an inclusion of a
>> | > statement and/or icon indicating such status e.g., green for GPL or
>> | > equivalent, amber for uncertain, red for restricted. Another may be a
>> | > division of directories, so that GPL-equivalent packages are kept
>> | > separate from uncertain or restricted licensed ones.
>> | >
>> | > We welcome comments and suggestions on both the concept and the
>> | > technicalities.
>> | >
>> | > John Nash & Ravi Varadhan
>> | >
>> | > ______________________________________________
>> | > R-devel at r-project.org mailing list
>> | > https://stat.ethz.ch/mailman/listinfo/r-devel
>> | >
>> | 
>> | ______________________________________________
>> | R-devel at r-project.org mailing list
>> | https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> 


> -- 
> Spencer Graves, PE, PhD
> President and Chief Operating Officer
> Structure Inspection and Monitoring, Inc.
> 751 Emerson Ct.
> San Jos?, CA 95126
> ph:  408-655-4567

> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch at stats.uwo.ca  Fri Sep 11 17:00:41 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 11 Sep 2009 11:00:41 -0400
Subject: [Rd] Fortran routine affected by unrelated R code
In-Reply-To: <ee2a35a60909110748o89ae7basd8ff1ebc204f264e@mail.gmail.com>
References: <ee2a35a60909110748o89ae7basd8ff1ebc204f264e@mail.gmail.com>
Message-ID: <4AAA6619.6050709@stats.uwo.ca>

On 9/11/2009 10:48 AM, Arne Henningsen wrote:
> Hi!
> 
> When I run "R CMD check" on the current development version of my R
> package "frontier" [1], there is no difference between the output of
> the test scripts in the /tests/ folder and the saved output files
> (.Rout.save). However, if I change an R file in the /R/ folder, some
> calls to the Fortran code (called by ".Fortran()") return different
> results, although the change of the R file is not related to this,
> e.g. when I add the commands 'print("abc")' or 'newVariable <- 123' to
> an R file that even does not call the Fortran code. However, adding
> empty lines or comments does NOT change the values returned by the
> Fortran code. Different modifications of the R files lead to different
> results but the same modification always leads to the same results
> (hence, the results are perfectly reproducible). Since the Fortran
> code does a non-linear optimization, (slightly) different results
> (e.g. depending on starting values) could be expected. However, the
> values passed to the Fortran code are not affected by the
> modifications that alter the values returned by the Fortran code and I
> cannot sea any connection between the modification of the R files and
> the values returned by the Fortran code. Could this phenomenon be
> caused by an error in the Fortran code, by a bug in R, or is this a
> usual behavior that an expert would expect in this situation? Any
> hints are welcome!

It is likely a bug in the Fortran or in R.  Since you see it from very 
simple, well-tested R code like print() and <-, I would bet pretty 
heavily on it being in the Fortran.

What it sounds like is that some part of the Fortran code depends on 
uninitialized values, or values outside the bounds of some array. The 
local variables take on values depending on what last used that portion 
of memory, so they are reproducible under identical scripts, but their 
value depends on more than the function arguments.

I don't know Fortran well enough to know if there's an easy way to 
diagnose this.  Does valgrind work for Fortran?  In the old days, it 
used to be possible to fill the unused portion of the stack with FF 
bytes:  these became NaN values in floating point, and -1 in integers, 
and would often trigger errors in functions that weren't ready for NaNs 
or negatives.  I don't know how to do that on a modern system, though.

Duncan Murdoch


From Kurt.Hornik at wu.ac.at  Fri Sep 11 17:25:33 2009
From: Kurt.Hornik at wu.ac.at (Kurt Hornik)
Date: Fri, 11 Sep 2009 17:25:33 +0200
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <4AAA4B77.8070601@uottawa.ca>
References: <4AA93C58.1050406@uottawa.ca>
	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>
	<19113.31229.97906.452635@ron.nulle.part>
	<4AA98451.3040003@prodsyse.com> <4AAA4B77.8070601@uottawa.ca>
Message-ID: <19114.27629.237533.119608@fangorn.hornik.net>

>>>>> Prof John C Nash writes:

> The responses to my posting yesterday seem to indicate more consensus 
> than I expected:
> 1) CRAN should be restricted to GPL-equivalent licensed packages
> 2) r-forge could be left "buyer beware" using DESCRIPTION information
> 3) We may want a specific repository for restricted packages (RANC?)

> How to proceed? A short search on Rseek did not turn up a chain of 
> command for CRAN.

I thought I had already explained the last time the GPL-only suggestion
came up that this will not happen for CRAN.

But again: we have invested considerable time into getting the license
specs standardized, and writing code to compute on these.  Time
permitting, R 2.10.0 will feature code that allows specifying license
filters which can be customized according to individuals' needs.  But I
see no point in physically representing one particular license profile.

Btw, there are less non-free packages on CRAN than packages which claim
to be free but have non-free installation dependencies: some would argue
that the latter is impossible from a license perspective.  I feel little
desire to start arguing about this, as being able to control package
installation by license filters will resolve matters anyway.

-k


> I'm prepared to help out with documentation etc. to move changes 
> forward. They are not, in my opinion, likely to cause a lot of trouble 
> for most users, and should simplify things over time.

> JN

> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From edd at debian.org  Fri Sep 11 17:44:42 2009
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 11 Sep 2009 10:44:42 -0500
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <4AAA60B9.2050203@biostat.ku.dk>
References: <4AA93C58.1050406@uottawa.ca>
	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>
	<19113.31229.97906.452635@ron.nulle.part>
	<4AA98451.3040003@prodsyse.com> <4AAA4B77.8070601@uottawa.ca>
	<4AAA60B9.2050203@biostat.ku.dk>
Message-ID: <19114.28778.659619.304251@ron.nulle.part>


On 11 September 2009 at 16:37, Peter Dalgaard wrote:
| who have responded on the list do not necessarily speak for CRAN. In the
| final analysis, the maintainers must decide what is maintainable.

Fully agreed. As 'maintainers' of cran2deb, Charles and I decided to 'shoot
first, ask questions later' as we clearly wanted to avoid creating any sort
of trouble for our generous CRAN hosts (currently just the Vienna master) are
effectively re-distributing our compilations (of its own content).  

So we pro-actively chose to excludes some packages.  To put some meat on this
particular bone, the current set packages blacklistes for 'nonfree-ness' is:

  sqlite> select package, explanation from blacklist_packages where nonfree;
  package               explanation
  --------------------  ----------------------------------------
  mclust                non-commercial license
  mclust02              non-commercial license
  ConvCalendar          no modification or distribution rights
  SDDA                  non-commercial CSIRO license
  conf.design           non-commercial license
  isa2                  non-commercial creative commons license
  optmatch              non-commercial license
  rankreg               non-commercial license
  realized              non-commercial license
  rngwell19937          non-commercial license
  tnet                  non-commercial creative commons license
  spatialkernel         contains non-commercial gpc code
  Bhat                  non-commercial license
  PTAk                  non-commercial license
  PredictiveRegression  non-commercial license
  RLadyBug              contains some code under non-commercial
  mapproj               non-commercial license
  mathgraph             non-commercial license
  sqlite>

| (Even within the Free Software world there are current issues with,
| e.g., incompatibilities between GPL v.2 and v.3, and also with the
| Eclipse license. Don't get me started...)

Yes. There is a potential problem with gcc 4.4 compilation of GPL-2 code. If
that comes to a boil we all (as in: GPL 2 users) are in a spot of bother.

On 11 September 2009 at 07:48, Robert Gentleman wrote:
|    It is also the case that things are not so simple, as dependencies 
| can make a package unusable even if it is itself GPL-compatible.  This 

Yes, in the case of cran2deb / CRAN there are just three blacklists because
of dependencies on nonfree CRAN content, most often it is dependencies on
other stuff incl BioC which we do not include (for mostly technical /
historical reasons; contact Charles or me offline if you'd like to work on
changing this)

  sqlite> select package,explanation from blacklist_packages where unsatisfied_dependency;
  package               explanation
  --------------------  ----------------------------------------
  ROracle               requires Oracle to build and run
  Rlsf                  requires LSF cluster/grid system librari
  Rsge                  requires SGE cluster/grid system librari
  CarbonEL              requires OS X system
  VhayuR                requires Vhayu database system
  gputools              requires Nvidia CUDA compiler and GPU-en
  klaR                  requires SVMlight which is non-free
  wgaim                 requires asreml-R
  svGUI                 requires Komodo from OpenKomodo.org whic
  RScaLAPACK            requires MPICH2 and Blacs and ScaLAPACK
  caMassClass           requires PROcess from BioConductor
  Rcplex                requires CPLEX libraries
  ADaCGH                BioC depends: tilingArray
  DAAGbio               BioC depends: limma
  GFMaps                BioC depends: affy
  GOSim                 BioC depends: GO.db
  Metabonomic           BioC depends: PROcess
  classGraph            BioC depends: Rgraphviz
  gcExplorer            BioC depends: Rgraphviz
  logilasso             BioC depends: Rgraphviz
  pcalg                 BioC depends: Rgraphviz
  celsius               BioC depends: BioBase
  multtest              BioC depends: BioBase
  hopach                BioC depends: BioBase
  GExMap                BioC depends: multtest,BioBase
  LMGene                BioC depends: multtest,BioBase
  PCS                   BioC depends: multtest,BioBase
  SubpathwayMiner       BioC depends: KEGG.db
  gene2pathway          BioC depends: KEGG.db
  PhViD                 BioC depends: LBE
  SNPMaP                BioC depends: affxparser
  qdg                   BioC depends: pcalg,Rgraphviz
  lsa                   Ohat depends: Rstem
  mpm                   BioC depends: geneplotter
  sisus                 BioC depends: annotate
  metaMA                BioC depends: limma
  clustTool             non-free depends: mclust02
  clustvarsel           non-free depends: mclust02
  SpectralGEM           non-free depends: optmatch
  bayesCGH              BioC depends: snapCGH
  crosshybDetector      missing depends: marray
  FEST                  needs MERLIN <http://www.sph.umich.edu/c
  aroma.affymetrix      BioC depends: aroma.light
  aroma.core            BioC depends: aroma.light
  aroma.apd             BioC depends: aroma.light
  sqlite>


| also makes the notion of some simple split into free and non-free (or 
| what ever split you want) less trivial than is being suggested.

That sounds like the Ostrich defense :) Nobody claimed it was easy or
non-controversial, but it seems some of us feel that it should be discussed
as the status quo may be something we can improve upon.  

E.g. I think that 'License: file LICENSE' is not good enough.  Some sort of
marker at the DESCRIPTIOn level would help.  How many levels we put into an
appropriate factor variable is open for discussion. But for argument's sake:
why don't we start with a binary toggle of whether or not one of the licenses
in http://www.r-project.org/Licenses/ aka share/licenses/ is met?

CRAN has been a huge success (and I am sure the success puts a strain on its
maintainers).  Given that it has become the 800 pound gorilla, may not use
some of that weight to nudge folks to a set of common licenses?

Dirk

-- 
Three out of two people have difficulties with fractions.


From ggrothendieck at gmail.com  Fri Sep 11 18:19:09 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 11 Sep 2009 12:19:09 -0400
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <19114.28778.659619.304251@ron.nulle.part>
References: <4AA93C58.1050406@uottawa.ca>
	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com> 
	<19113.31229.97906.452635@ron.nulle.part>
	<4AA98451.3040003@prodsyse.com> 
	<4AAA4B77.8070601@uottawa.ca> <4AAA60B9.2050203@biostat.ku.dk> 
	<19114.28778.659619.304251@ron.nulle.part>
Message-ID: <971536df0909110919o268b7034g5f2a3ef4047255df@mail.gmail.com>

One complication is that its possible that a package can use a non-free
component but can also be used without it.  The fame package could
be used with fame or without fame for a long time but more recently the
non-fame portion was factored out into the tis package.  The VhayuR
package is similar in that it can be used without Vhayu.  In that case it
can use flat files instead of the Vhayu database.

On Fri, Sep 11, 2009 at 11:44 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> On 11 September 2009 at 16:37, Peter Dalgaard wrote:
> | who have responded on the list do not necessarily speak for CRAN. In the
> | final analysis, the maintainers must decide what is maintainable.
>
> Fully agreed. As 'maintainers' of cran2deb, Charles and I decided to 'shoot
> first, ask questions later' as we clearly wanted to avoid creating any sort
> of trouble for our generous CRAN hosts (currently just the Vienna master) are
> effectively re-distributing our compilations (of its own content).
>
> So we pro-actively chose to excludes some packages. ?To put some meat on this
> particular bone, the current set packages blacklistes for 'nonfree-ness' is:
>
> ?sqlite> select package, explanation from blacklist_packages where nonfree;
> ?package ? ? ? ? ? ? ? explanation
> ?-------------------- ?----------------------------------------
> ?mclust ? ? ? ? ? ? ? ?non-commercial license
> ?mclust02 ? ? ? ? ? ? ?non-commercial license
> ?ConvCalendar ? ? ? ? ?no modification or distribution rights
> ?SDDA ? ? ? ? ? ? ? ? ?non-commercial CSIRO license
> ?conf.design ? ? ? ? ? non-commercial license
> ?isa2 ? ? ? ? ? ? ? ? ?non-commercial creative commons license
> ?optmatch ? ? ? ? ? ? ?non-commercial license
> ?rankreg ? ? ? ? ? ? ? non-commercial license
> ?realized ? ? ? ? ? ? ?non-commercial license
> ?rngwell19937 ? ? ? ? ?non-commercial license
> ?tnet ? ? ? ? ? ? ? ? ?non-commercial creative commons license
> ?spatialkernel ? ? ? ? contains non-commercial gpc code
> ?Bhat ? ? ? ? ? ? ? ? ?non-commercial license
> ?PTAk ? ? ? ? ? ? ? ? ?non-commercial license
> ?PredictiveRegression ?non-commercial license
> ?RLadyBug ? ? ? ? ? ? ?contains some code under non-commercial
> ?mapproj ? ? ? ? ? ? ? non-commercial license
> ?mathgraph ? ? ? ? ? ? non-commercial license
> ?sqlite>
>
> | (Even within the Free Software world there are current issues with,
> | e.g., incompatibilities between GPL v.2 and v.3, and also with the
> | Eclipse license. Don't get me started...)
>
> Yes. There is a potential problem with gcc 4.4 compilation of GPL-2 code. If
> that comes to a boil we all (as in: GPL 2 users) are in a spot of bother.
>
> On 11 September 2009 at 07:48, Robert Gentleman wrote:
> | ? ?It is also the case that things are not so simple, as dependencies
> | can make a package unusable even if it is itself GPL-compatible. ?This
>
> Yes, in the case of cran2deb / CRAN there are just three blacklists because
> of dependencies on nonfree CRAN content, most often it is dependencies on
> other stuff incl BioC which we do not include (for mostly technical /
> historical reasons; contact Charles or me offline if you'd like to work on
> changing this)
>
> ?sqlite> select package,explanation from blacklist_packages where unsatisfied_dependency;
> ?package ? ? ? ? ? ? ? explanation
> ?-------------------- ?----------------------------------------
> ?ROracle ? ? ? ? ? ? ? requires Oracle to build and run
> ?Rlsf ? ? ? ? ? ? ? ? ?requires LSF cluster/grid system librari
> ?Rsge ? ? ? ? ? ? ? ? ?requires SGE cluster/grid system librari
> ?CarbonEL ? ? ? ? ? ? ?requires OS X system
> ?VhayuR ? ? ? ? ? ? ? ?requires Vhayu database system
> ?gputools ? ? ? ? ? ? ?requires Nvidia CUDA compiler and GPU-en
> ?klaR ? ? ? ? ? ? ? ? ?requires SVMlight which is non-free
> ?wgaim ? ? ? ? ? ? ? ? requires asreml-R
> ?svGUI ? ? ? ? ? ? ? ? requires Komodo from OpenKomodo.org whic
> ?RScaLAPACK ? ? ? ? ? ?requires MPICH2 and Blacs and ScaLAPACK
> ?caMassClass ? ? ? ? ? requires PROcess from BioConductor
> ?Rcplex ? ? ? ? ? ? ? ?requires CPLEX libraries
> ?ADaCGH ? ? ? ? ? ? ? ?BioC depends: tilingArray
> ?DAAGbio ? ? ? ? ? ? ? BioC depends: limma
> ?GFMaps ? ? ? ? ? ? ? ?BioC depends: affy
> ?GOSim ? ? ? ? ? ? ? ? BioC depends: GO.db
> ?Metabonomic ? ? ? ? ? BioC depends: PROcess
> ?classGraph ? ? ? ? ? ?BioC depends: Rgraphviz
> ?gcExplorer ? ? ? ? ? ?BioC depends: Rgraphviz
> ?logilasso ? ? ? ? ? ? BioC depends: Rgraphviz
> ?pcalg ? ? ? ? ? ? ? ? BioC depends: Rgraphviz
> ?celsius ? ? ? ? ? ? ? BioC depends: BioBase
> ?multtest ? ? ? ? ? ? ?BioC depends: BioBase
> ?hopach ? ? ? ? ? ? ? ?BioC depends: BioBase
> ?GExMap ? ? ? ? ? ? ? ?BioC depends: multtest,BioBase
> ?LMGene ? ? ? ? ? ? ? ?BioC depends: multtest,BioBase
> ?PCS ? ? ? ? ? ? ? ? ? BioC depends: multtest,BioBase
> ?SubpathwayMiner ? ? ? BioC depends: KEGG.db
> ?gene2pathway ? ? ? ? ?BioC depends: KEGG.db
> ?PhViD ? ? ? ? ? ? ? ? BioC depends: LBE
> ?SNPMaP ? ? ? ? ? ? ? ?BioC depends: affxparser
> ?qdg ? ? ? ? ? ? ? ? ? BioC depends: pcalg,Rgraphviz
> ?lsa ? ? ? ? ? ? ? ? ? Ohat depends: Rstem
> ?mpm ? ? ? ? ? ? ? ? ? BioC depends: geneplotter
> ?sisus ? ? ? ? ? ? ? ? BioC depends: annotate
> ?metaMA ? ? ? ? ? ? ? ?BioC depends: limma
> ?clustTool ? ? ? ? ? ? non-free depends: mclust02
> ?clustvarsel ? ? ? ? ? non-free depends: mclust02
> ?SpectralGEM ? ? ? ? ? non-free depends: optmatch
> ?bayesCGH ? ? ? ? ? ? ?BioC depends: snapCGH
> ?crosshybDetector ? ? ?missing depends: marray
> ?FEST ? ? ? ? ? ? ? ? ?needs MERLIN <http://www.sph.umich.edu/c
> ?aroma.affymetrix ? ? ?BioC depends: aroma.light
> ?aroma.core ? ? ? ? ? ?BioC depends: aroma.light
> ?aroma.apd ? ? ? ? ? ? BioC depends: aroma.light
> ?sqlite>
>
>
> | also makes the notion of some simple split into free and non-free (or
> | what ever split you want) less trivial than is being suggested.
>
> That sounds like the Ostrich defense :) Nobody claimed it was easy or
> non-controversial, but it seems some of us feel that it should be discussed
> as the status quo may be something we can improve upon.
>
> E.g. I think that 'License: file LICENSE' is not good enough. ?Some sort of
> marker at the DESCRIPTIOn level would help. ?How many levels we put into an
> appropriate factor variable is open for discussion. But for argument's sake:
> why don't we start with a binary toggle of whether or not one of the licenses
> in http://www.r-project.org/Licenses/ aka share/licenses/ is met?
>
> CRAN has been a huge success (and I am sure the success puts a strain on its
> maintainers). ?Given that it has become the 800 pound gorilla, may not use
> some of that weight to nudge folks to a set of common licenses?
>
> Dirk
>
> --
> Three out of two people have difficulties with fractions.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From info at aghmed.fsnet.co.uk  Fri Sep 11 18:41:58 2009
From: info at aghmed.fsnet.co.uk (Michael Dewey)
Date: Fri, 11 Sep 2009 17:41:58 +0100
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <4AA9F73E.5000507@dbmail.com>
References: <4AA93C58.1050406@uottawa.ca>
	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>
	<19113.31229.97906.452635@ron.nulle.part>
	<4AA9F73E.5000507@dbmail.com>
Message-ID: <Zen-1Mm9CM-0002fS-D7@smarthost02.mail.zen.net.uk>

At 08:07 11/09/2009, Romain Francois wrote:

>+1
>
>Commit to freedom if you want the free services of CRAN, etc ...

It seems to me very reasonable for people to be asked to distribute 
their software via some other route if they cannot join in the spirit 
of the enterprise. So add my vote in with Romain's.

>On 09/11/2009 12:13 AM, Dirk Eddelbuettel wrote:
>>
>>
>>On 10 September 2009 at 14:26, Gabor Grothendieck wrote:
>>| The SystemRequirements: field of the DESCRIPTION file normally
>>| lists external dependencies whether free or non-free.
>>
>>Moreover, the (aptly named) field 'License:' in DESCRIPTION is now much more
>>parseable and contains pertinent information. A number of more 'challenging'
>>packages basically pass the buck on with an entry
>>
>>             License: file LICENSE
>>
>>which refers to a file in the sources one needs to read to decide.
>>
>>This is e.g. at the basis of Charles' and my decision about what we think we
>>cannot build via cran2deb [1]: non-free, non-distributable, non-commercial or
>>otherwise nasty licenses.  There are a couple of packages we exclude for this
>>(or related reasons), and we have been meaning to summarise them with a
>>simple html summary from the database table we use for cran2deb, but have not
>>yet gotten around to it.
>>
>>Just like John and Ravi, I would actually be in favour of somewhat stricter
>>enforcements.  If someone decides not to take part in the gift economy that
>>brought him or her R (and many other things, including at least 1880+ CRAN
>>packages with sane licenses) then we may as well decide not to waste our time
>>and resources on his project either and simply exclude it.
>>
>>So consider this as a qualified thumbs-up for John and Ravi's suggestion of a
>>clearer line in the sand.
>>
>>Dirk
>>
>>[1] cran2deb is at http://debian.cran.r-project.org and provides 1800+ Debian
>>'testing' binaries for amd64 and i386 that are continuously updated as new
>>packages appear on CRAN. With that 'apt-get install r-cran-foo' becomes a
>>reality for almost every value of foo out of the set of CRAN packages.
>>
>>
>>|
>>| On Thu, Sep 10, 2009 at 1:50 PM, Prof. John C 
>>Nash<nashjc at uottawa.ca>  wrote:
>>|>  Subject: Non-GPL packages for R
>>|>
>>|>  Packages that are not licensed in a way that permits re-distribution on
>>|>  CRAN are frequently a source of comment and concern on R-help and other
>>|>  lists. A good example of this problem is the Rdonlp2 package 
>>that has caused
>>|>  a lot of annoyance for a number of optimization users in R. 
>>They are also an
>>|>  issue for efforts like Dirk Eddelbuettel's cran2deb.
>>|>
>>|>  There are, however, a number of circumstances where non-GPL equivalent
>>|>  packages may be important to users. This can imply that users need to
>>|>  both install an R package and one or more dependencies that must be
>>|>  separately obtained and licensed. One such situation is where a new
>>|>  program is still under development and the license is not clear, as in
>>|>  the recent work we pursued with respect to Mike Powell's BOBYQA. We
>>|>  wanted to verify if this were useful before we considered distribution,
>>|>  and Powell had been offering copies of his code on request. Thus we
>>|>  could experiment, but not redistribute. Recently Powell's approval to
>>|>  redistribute has been obtained.
>>|>
>>|>  We believe that it is important that non-redistributable codes be
>>|>  excluded from CRAN, but that they could be available on a repository
>>|>  such as r-forge. However, we would like to see a clearer indication of
>>|>  the license status on r-forge. One possibility is an inclusion of a
>>|>  statement and/or icon indicating such status e.g., green for GPL or
>>|>  equivalent, amber for uncertain, red for restricted. Another may be a
>>|>  division of directories, so that GPL-equivalent packages are kept
>>|>  separate from uncertain or restricted licensed ones.
>>|>
>>|>  We welcome comments and suggestions on both the concept and the
>>|>  technicalities.
>>|>
>>|>  John Nash&  Ravi Varadhan
>
>--
>Romain Francois
>Professional R Enthusiast
>+33(0) 6 28 91 30 30
>http://romainfrancois.blog.free.fr
>|- http://tr.im/y8y0 : search the graph gallery from R
>|- http://tr.im/y8wY : new R package : ant
>`- http://tr.im/xMdt : update on the ant package
>
>______________________________________________
>R-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel

Michael Dewey
http://www.aghmed.fsnet.co.uk


From edd at debian.org  Fri Sep 11 18:43:38 2009
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 11 Sep 2009 11:43:38 -0500
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <971536df0909110919o268b7034g5f2a3ef4047255df@mail.gmail.com>
References: <4AA93C58.1050406@uottawa.ca>
	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>
	<19113.31229.97906.452635@ron.nulle.part>
	<4AA98451.3040003@prodsyse.com> <4AAA4B77.8070601@uottawa.ca>
	<4AAA60B9.2050203@biostat.ku.dk>
	<19114.28778.659619.304251@ron.nulle.part>
	<971536df0909110919o268b7034g5f2a3ef4047255df@mail.gmail.com>
Message-ID: <19114.32314.969955.591813@ron.nulle.part>


On 11 September 2009 at 12:19, Gabor Grothendieck wrote:
| One complication is that its possible that a package can use a non-free
| component but can also be used without it.  The fame package could
| be used with fame or without fame for a long time but more recently the
| non-fame portion was factored out into the tis package.  The VhayuR
| package is similar in that it can be used without Vhayu.  In that case it
| can use flat files instead of the Vhayu database.

So in cases where a package used to not build with 'freely available' (and
preferably available as Debian packages) tools but does so now we welcome
hints so that we can update the blacklist.  All it does, really, is to save a
few cpu cycles when we have the expectation that 'R CMD INSTALL' is almost
surely going to fail.

Dirk

-- 
Three out of two people have difficulties with fractions.


From edd at debian.org  Fri Sep 11 18:45:28 2009
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 11 Sep 2009 11:45:28 -0500
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <19114.27629.237533.119608@fangorn.hornik.net>
References: <4AA93C58.1050406@uottawa.ca>
	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>
	<19113.31229.97906.452635@ron.nulle.part>
	<4AA98451.3040003@prodsyse.com> <4AAA4B77.8070601@uottawa.ca>
	<19114.27629.237533.119608@fangorn.hornik.net>
Message-ID: <19114.32424.342575.586507@ron.nulle.part>


On 11 September 2009 at 17:25, Kurt Hornik wrote:
| I thought I had already explained the last time the GPL-only suggestion
| came up that this will not happen for CRAN.
| 
| But again: we have invested considerable time into getting the license
| specs standardized, and writing code to compute on these.  Time
| permitting, R 2.10.0 will feature code that allows specifying license
| filters which can be customized according to individuals' needs.  But I
| see no point in physically representing one particular license profile.
| 
| Btw, there are less non-free packages on CRAN than packages which claim
| to be free but have non-free installation dependencies: some would argue
| that the latter is impossible from a license perspective.  I feel little
| desire to start arguing about this, as being able to control package
| installation by license filters will resolve matters anyway.

Indeed, that would possibly solve some our (as in cran2deb) worries too.  So
a nig Thanks! for working on this, and of course for providing CRAN in the
first place.

Dirk

-- 
Three out of two people have difficulties with fractions.


From spencer.graves at prodsyse.com  Fri Sep 11 19:19:10 2009
From: spencer.graves at prodsyse.com (spencerg)
Date: Fri, 11 Sep 2009 10:19:10 -0700
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <19114.32424.342575.586507@ron.nulle.part>
References: <4AA93C58.1050406@uottawa.ca>	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>	<19113.31229.97906.452635@ron.nulle.part>	<4AA98451.3040003@prodsyse.com>
	<4AAA4B77.8070601@uottawa.ca>	<19114.27629.237533.119608@fangorn.hornik.net>
	<19114.32424.342575.586507@ron.nulle.part>
Message-ID: <4AAA868E.5010901@prodsyse.com>

Dirk Eddelbuettel wrote:
> On 11 September 2009 at 17:25, Kurt Hornik wrote:
> | I thought I had already explained the last time the GPL-only suggestion
> | came up that this will not happen for CRAN.
> | 
> | But again: we have invested considerable time into getting the license
> | specs standardized, and writing code to compute on these.  Time
> | permitting, R 2.10.0 will feature code that allows specifying license
> | filters which can be customized according to individuals' needs.  But I
> | see no point in physically representing one particular license profile.
> | 
> | Btw, there are less non-free packages on CRAN than packages which claim
> | to be free but have non-free installation dependencies: some would argue
> | that the latter is impossible from a license perspective.  I feel little
> | desire to start arguing about this, as being able to control package
> | installation by license filters will resolve matters anyway.
>
> Indeed, that would possibly solve some our (as in cran2deb) worries too.  So
> a nig Thanks! for working on this, and of course for providing CRAN in the
> first place.
>   
      I second that.  People all over the world are more quantitative 
than they would otherwise be because the R project including CRAN (and 
R-Forge) make it economically feasible for them to access and use high 
quality software to better understand their world and communicate that 
improved understanding  more effectively to others.  Knowledge is power, 
and this increased knowledge gives more people more control over their 
lives.  We are not laying brick but building a cathedral. 


      Spencer

> Dirk
>
>   


-- 
Spencer Graves, PE, PhD
President and Chief Operating Officer
Structure Inspection and Monitoring, Inc.
751 Emerson Ct.
San Jos?, CA 95126
ph:  408-655-4567


From nashjc at uottawa.ca  Fri Sep 11 19:21:39 2009
From: nashjc at uottawa.ca (John C Nash)
Date: Fri, 11 Sep 2009 13:21:39 -0400
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <19114.32424.342575.586507@ron.nulle.part>
References: <4AA93C58.1050406@uottawa.ca>	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>	<19113.31229.97906.452635@ron.nulle.part>	<4AA98451.3040003@prodsyse.com>	<4AAA4B77.8070601@uottawa.ca>	<19114.27629.237533.119608@fangorn.hornik.net>
	<19114.32424.342575.586507@ron.nulle.part>
Message-ID: <4AAA8723.4050705@uottawa.ca>

License filters will work for me. My offer stands to help on 
documentation,or to act as a "stooge" to test tools in this area. Thanks 
to those who responded. And for myself, "GPL compatible" was my intended 
expression.

JN


From arne.henningsen at googlemail.com  Fri Sep 11 20:31:02 2009
From: arne.henningsen at googlemail.com (Arne Henningsen)
Date: Fri, 11 Sep 2009 20:31:02 +0200
Subject: [Rd] Fortran routine affected by unrelated R code
In-Reply-To: <4AAA6619.6050709@stats.uwo.ca>
References: <ee2a35a60909110748o89ae7basd8ff1ebc204f264e@mail.gmail.com>
	<4AAA6619.6050709@stats.uwo.ca>
Message-ID: <ee2a35a60909111131k7cbc56e5rcacd101dc060b8f4@mail.gmail.com>

On Fri, Sep 11, 2009 at 5:00 PM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 9/11/2009 10:48 AM, Arne Henningsen wrote:
>>
>> Hi!
>>
>> When I run "R CMD check" on the current development version of my R
>> package "frontier" [1], there is no difference between the output of
>> the test scripts in the /tests/ folder and the saved output files
>> (.Rout.save). However, if I change an R file in the /R/ folder, some
>> calls to the Fortran code (called by ".Fortran()") return different
>> results, although the change of the R file is not related to this,
>> e.g. when I add the commands 'print("abc")' or 'newVariable <- 123' to
>> an R file that even does not call the Fortran code. However, adding
>> empty lines or comments does NOT change the values returned by the
>> Fortran code. Different modifications of the R files lead to different
>> results but the same modification always leads to the same results
>> (hence, the results are perfectly reproducible). Since the Fortran
>> code does a non-linear optimization, (slightly) different results
>> (e.g. depending on starting values) could be expected. However, the
>> values passed to the Fortran code are not affected by the
>> modifications that alter the values returned by the Fortran code and I
>> cannot sea any connection between the modification of the R files and
>> the values returned by the Fortran code. Could this phenomenon be
>> caused by an error in the Fortran code, by a bug in R, or is this a
>> usual behavior that an expert would expect in this situation? Any
>> hints are welcome!
>
> It is likely a bug in the Fortran or in R. ?Since you see it from very
> simple, well-tested R code like print() and <-, I would bet pretty heavily
> on it being in the Fortran.
>
> What it sounds like is that some part of the Fortran code depends on
> uninitialized values, or values outside the bounds of some array. The local
> variables take on values depending on what last used that portion of memory,
> so they are reproducible under identical scripts, but their value depends on
> more than the function arguments.
>
> I don't know Fortran well enough to know if there's an easy way to diagnose
> this. ?Does valgrind work for Fortran? ?In the old days, it used to be
> possible to fill the unused portion of the stack with FF bytes: ?these
> became NaN values in floating point, and -1 in integers, and would often
> trigger errors in functions that weren't ready for NaNs or negatives. ?I
> don't know how to do that on a modern system, though.
>
> Duncan Murdoch

Thanks for the hint, Duncan. Indeed it was an uninitialized value in
the Fortran code.

/Arne

-- 
Arne Henningsen
http://www.arne-henningsen.name


From simon.urbanek at r-project.org  Fri Sep 11 20:39:13 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 11 Sep 2009 14:39:13 -0400
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <4AAA4B77.8070601@uottawa.ca>
References: <4AA93C58.1050406@uottawa.ca>	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>
	<19113.31229.97906.452635@ron.nulle.part>
	<4AA98451.3040003@prodsyse.com> <4AAA4B77.8070601@uottawa.ca>
Message-ID: <79E11188-1C2B-4368-8764-CCA425C85F20@r-project.org>

John,

On Sep 11, 2009, at 9:07 , Prof. John C Nash wrote:

> The responses to my posting yesterday seem to indicate more  
> consensus than I expected:
> 1) CRAN should be restricted to GPL-equivalent licensed packages

I would definitely vote against that - I think this is not what the  
most people here agreed with (and the subject [non-GPL] and your  
wording [non-redistributable code] are two entirely different things).  
GPL is more restrictive than most open source licenses so with the  
above you'd throw out a lot of "real" open source packages (namely  
those with more permissive open source licenses). The point was open  
distribution as Peter pointed out so GPL-compatible licenses would be  
one possibility (although it also disallows some open source licenses).

Cheers,
Simon


> 2) r-forge could be left "buyer beware" using DESCRIPTION information
> 3) We may want a specific repository for restricted packages (RANC?)
>
> How to proceed? A short search on Rseek did not turn up a chain of  
> command for CRAN.
>
> I'm prepared to help out with documentation etc. to move changes  
> forward. They are not, in my opinion, likely to cause a lot of  
> trouble for most users, and should simplify things over time.
>
> JN
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From rkoenker at uiuc.edu  Fri Sep 11 20:48:21 2009
From: rkoenker at uiuc.edu (rudjer)
Date: Fri, 11 Sep 2009 11:48:21 -0700 (PDT)
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <4AAA8723.4050705@uottawa.ca>
References: <4AA93C58.1050406@uottawa.ca>
	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>
	<19113.31229.97906.452635@ron.nulle.part>
	<4AA98451.3040003@prodsyse.com> <4AAA4B77.8070601@uottawa.ca>
	<19114.27629.237533.119608@fangorn.hornik.net>
	<19114.32424.342575.586507@ron.nulle.part>
	<4AAA8723.4050705@uottawa.ca>
Message-ID: <25406418.post@talk.nabble.com>


Comrades,

When talk turns to the purity of the revolution, and purge of packages then
the guillotine can't be far behind.  We all remember Lenin berating the
"renegade Kautsky" for his "pragmatism," and we know where that led...

So let me put in a good word for pragmatism, and incidentally for saving one
of my 
own packages, SparseM, and perhaps eventually my neck.  Last week Kurt asked
me to look into a SparseM licensing quirk based on an inquiry from the
Fedora
folks.  SparseM is GPL except for one routine cholesky.f written at Oakridge
Lab by E. Ng and B. Peyton.  Our version of the code was redistributed in
the
package PCx which was copywrited by the U. of Chicago, who specified that
commercial users should contact someone at Argonne National Lab.  Since the
beginning we have retained this language in the License file of SparseM,
even
though the code in question was not actually developed as a part of PCx.

I contacted one of the original PCx developers who responded as follows:

	The routine you mention was distributed with PCx but not part 
	of it as you see from the legalese and not covered by the PCx 
	copyright.  I tried to interest the authors of that code 
	in legal issues in around 1997 but could not get them 
	motivated (frankly I also can't get too interested).

To which I heartily concurred.  If someone who is worried about getting sued
would like to dig into this can of worms, then fine.  But life is too short
for the rest of us.  This is quite a murky business, we shouldn't create 
incentives to make it murkier by covering up relevant language on licensing.
But surely we can also all agree that CRAN has been a fantastic success, and
adding new constraints on its operation is ill-advised.

Roger


url:    www.econ.uiuc.edu/~roger            Roger Koenker
email    rkoenker at uiuc.edu            Department of Economics
vox:     217-333-4558                University of Illinois
fax:       217-244-6678                Urbana, IL 61801

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
View this message in context: http://www.nabble.com/Non-GPL-packages-for-R-tp25387980p25406418.html
Sent from the R devel mailing list archive at Nabble.com.


From maechler at stat.math.ethz.ch  Sat Sep 12 12:56:57 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Sat, 12 Sep 2009 12:56:57 +0200
Subject: [Rd] S4 Generics and NAMESPACE : justified warning ?
In-Reply-To: <20090903124413.10c3763c@mimi>
References: <20090817135120.16fab862@mimi>
	<30312_1250600886_4A8AA7B5_30312_581_1_4A8AA986.3040702@fhcrc.org>
	<20090828162429.32576c07@mimi>
	<19099.51012.936944.591938@lynne.math.ethz.ch>
	<20090903124413.10c3763c@mimi>
Message-ID: <19115.32377.995283.673076@cmath-5.math.ethz.ch>

>>>>> "YC" == Yohan Chalabi <chalabi at phys.ethz.ch>
>>>>>     on Thu, 3 Sep 2009 12:44:13 +0200 writes:

    >>>>> "MM" == Martin Maechler <maechler at stat.math.ethz.ch>
    >>>>> on Mon, 31 Aug 2009 14:51:16 +0200

    MM> Yes, I agree, unjustified in your case.  The question
    MM> is: is there a patch which does differentiate between
    MM> your situation and Martin's scenario -- or does your
    MM> patch already do that?


    YC> Hi Martin,

    YC> Thanks for your response.

    YC> Here is an attempt to combine both views.

    YC> To check if the generic was derived from the function it
    YC> wants to overwrite, the following patch checks if the
    YC> package associated with the generic is the same as the
    YC> one where the function was defined.

    YC> regards, Yohan

    [.....]

I have now committed your proposal (+-),
and also added <R>/tests/Pkgs/ in order to allow checking such 
Namespace <-> S4 and other package dependencies.

Martin Maechler, ETH Zurich


From bates at stat.wisc.edu  Sat Sep 12 14:52:47 2009
From: bates at stat.wisc.edu (Douglas Bates)
Date: Sat, 12 Sep 2009 07:52:47 -0500
Subject: [Rd] Non-GPL packages for R
In-Reply-To: <25406418.post@talk.nabble.com>
References: <4AA93C58.1050406@uottawa.ca>
	<971536df0909101126g3b57647fv4c4d74f0eb47b0e9@mail.gmail.com>
	<19113.31229.97906.452635@ron.nulle.part>
	<4AA98451.3040003@prodsyse.com> <4AAA4B77.8070601@uottawa.ca>
	<19114.27629.237533.119608@fangorn.hornik.net>
	<19114.32424.342575.586507@ron.nulle.part>
	<4AAA8723.4050705@uottawa.ca> <25406418.post@talk.nabble.com>
Message-ID: <40e66e0b0909120552s6e662b41p8e4aec5196645f37@mail.gmail.com>

On Fri, Sep 11, 2009 at 1:48 PM, rudjer <rkoenker at uiuc.edu> wrote:
>
> Comrades,
>
> When talk turns to the purity of the revolution, and purge of packages then
> the guillotine can't be far behind. ?We all remember Lenin berating the
> "renegade Kautsky" for his "pragmatism," and we know where that led...
>
> So let me put in a good word for pragmatism, and incidentally for saving one
> of my
> own packages, SparseM, and perhaps eventually my neck. ?Last week Kurt asked
> me to look into a SparseM licensing quirk based on an inquiry from the
> Fedora
> folks. ?SparseM is GPL except for one routine cholesky.f written at Oakridge
> Lab by E. Ng and B. Peyton. ?Our version of the code was redistributed in
> the
> package PCx which was copywrited by the U. of Chicago, who specified that
> commercial users should contact someone at Argonne National Lab. ?Since the
> beginning we have retained this language in the License file of SparseM,
> even
> though the code in question was not actually developed as a part of PCx.
>
> I contacted one of the original PCx developers who responded as follows:
>
> ? ? ? ?The routine you mention was distributed with PCx but not part
> ? ? ? ?of it as you see from the legalese and not covered by the PCx
> ? ? ? ?copyright. ?I tried to interest the authors of that code
> ? ? ? ?in legal issues in around 1997 but could not get them
> ? ? ? ?motivated (frankly I also can't get too interested).
>
> To which I heartily concurred. ?If someone who is worried about getting sued
> would like to dig into this can of worms, then fine. ?But life is too short
> for the rest of us. ?This is quite a murky business, we shouldn't create
> incentives to make it murkier by covering up relevant language on licensing.
> But surely we can also all agree that CRAN has been a fantastic success, and
> adding new constraints on its operation is ill-advised.

It is unfortunately common in the numerical analysis community,
especially those still using Fortran, to have a rather vague approach
to licensing. ("I'll send a copy of my code to anyone who asks for it
but put in some language that if someone is going to get fantastically
rich from it then they owe me money too")  In the Open Source
community licensing is very important - it is what makes Open Source
software, including CRAN, possible. Most non-lawyers don't find the
study and discussion of licenses to be terribly fascinating but they
are the foundation of Open Source software. If the authors of Fortran
subroutines feel that it is too much of a bother to pay attention to
licenses (or to learn post-1950's programming languages) then
evolution will run its course and they will be left behind.  It's
annoying in that so little software from the numerical analysis
community is covered by suitable licenses but that will change.

Tim Davis's C and C++-based sparse matrix code that is incorporated in
the Matrix package is licensed under the GPL or LGPL.  Why mess around
with antiquated software and vague or non-existent licenses when there
are better alternatives?  It is painful to need to recode old Fortran
routines in modern programming languages and under real licenses but
it is the only way we will ever bring numerical analysis into the
post-Beatles era.


From nashjc at uottawa.ca  Sat Sep 12 20:40:34 2009
From: nashjc at uottawa.ca (Prof. John C Nash)
Date: Sat, 12 Sep 2009 14:40:34 -0400
Subject: [Rd] Why license filtering is important (was non-GPL ...)
In-Reply-To: <mailman.17.1252749606.29057.r-devel@r-project.org>
References: <mailman.17.1252749606.29057.r-devel@r-project.org>
Message-ID: <4AABEB22.7090000@uottawa.ca>

Using the acronym "GPL" in comments on the management of package 
repositories led the discussion well away from the issues I wanted to 
shed light upon, so I have changed the subject tag.

Examples of my concerns:

1) I use a package with a non-free component and learn how to work with 
it efficiently. I'm a retired academic, but still try to recover some 
costs of the work I do for R and other open projects by doing some 
contract and training work. A client has a problem and wants a solution. 
If there is a "non-commercial" restriction, I'm put in the awkward 
position of having to get a permission -- possibly from a defunct 
organization or one that has long forgotten how to grant such a permission.

2) There may be new tools available that ARE free software. Dirk's 
blacklist (perhaps we could have a less loaded name?) may suggest 
opportunities for gradually moving to packages that can be used without 
need to check license details. I have used such tasks in the past as 
student projects where they are relatively straightforward.

3) Many workers are not aware of the consequences of license status of 
their codes (I was not for some years). The development of CRAN and 
similar repositories has been and can be a positive force allowing for 
improvement and understanding of methods.

4) We definitely should retain the ability to access non-free codes -- 
somehow folk have misread my comments otherwise. I'll use them for 
learning and when there is no alternative, but if at all possible, I'll 
choose the free ones for production work so I don't get caught out as above.

A comment: In looking at SparseM, I first used the pdf -- it simply says 
GPL(>=2) as the license. (I'm sure I've got similar bugs in my own 
docs.) I dug deeper and found the LICENSE file, and also looked at 
cholesky.f, which is unfortunately one of the bigger files. I was hoping 
it was somewhat related to work I've done over the years on Cholesky 
decompositions in the hope I could offer a substitute as per concern (2) 
above, but it is not of the same nature as the algorithms I worked on as 
far as I can determine. Maybe someone else is able to step in on that.

And a big tip of the hat to Dirk E. and Charles B. for the cran2deb work 
-- I already admired the work. Now I've started looking at some of the 
package files for license info, I'm amazed they've got as far as they have.

JN


From edd at debian.org  Sat Sep 12 16:49:37 2009
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 12 Sep 2009 09:49:37 -0500
Subject: [Rd] DESCRIPTION/OS_type and OS X
Message-ID: <19115.46337.544164.202526@ron.nulle.part>


R Extensions (Section 1.1.1, and using the 2.9.2 version) says

      The optional `OS_type' field specifies the OS(es) for which the
  package is intended.  If present, it should be one of `unix' or
  `windows', and indicates that the package should only be installed on a
  platform with `.Platform$OS.type' having that value.

and I am wondering if 'OS_type: unix' includes OS X or not.  I am currently
updating RInside which builds on the two unixy OS variants.  Would I exclude
OS X by picking OS_type: unix ?  I don't think so but maybe this could be
made more explicit in the paragraph above.

Dirk

-- 
Three out of two people have difficulties with fractions.


From marc_schwartz at me.com  Sat Sep 12 16:52:52 2009
From: marc_schwartz at me.com (Marc Schwartz)
Date: Sat, 12 Sep 2009 09:52:52 -0500
Subject: [Rd] DESCRIPTION/OS_type and OS X
In-Reply-To: <19115.46337.544164.202526@ron.nulle.part>
References: <19115.46337.544164.202526@ron.nulle.part>
Message-ID: <6B1F9DAF-6DBE-4D16-8604-8F8606382E92@me.com>

On Sep 12, 2009, at 9:49 AM, Dirk Eddelbuettel wrote:

>
> R Extensions (Section 1.1.1, and using the 2.9.2 version) says
>
>      The optional `OS_type' field specifies the OS(es) for which the
>  package is intended.  If present, it should be one of `unix' or
>  `windows', and indicates that the package should only be installed  
> on a
>  platform with `.Platform$OS.type' having that value.
>
> and I am wondering if 'OS_type: unix' includes OS X or not.  I am  
> currently
> updating RInside which builds on the two unixy OS variants.  Would I  
> exclude
> OS X by picking OS_type: unix ?  I don't think so but maybe this  
> could be
> made more explicit in the paragraph above.
>
> Dirk

Dirk,

On OSX:

 > .Platform$OS.type
[1] "unix"


Remember that OSX is a BSD Unix derivative.

HTH,

Marc Schwartz


From edd at debian.org  Sat Sep 12 17:12:33 2009
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 12 Sep 2009 10:12:33 -0500
Subject: [Rd] DESCRIPTION/OS_type and OS X
In-Reply-To: <6B1F9DAF-6DBE-4D16-8604-8F8606382E92@me.com>
References: <19115.46337.544164.202526@ron.nulle.part>
	<6B1F9DAF-6DBE-4D16-8604-8F8606382E92@me.com>
Message-ID: <19115.47713.490278.605176@ron.nulle.part>


On 12 September 2009 at 09:52, Marc Schwartz wrote:
| On Sep 12, 2009, at 9:49 AM, Dirk Eddelbuettel wrote:
| 
| >
| > R Extensions (Section 1.1.1, and using the 2.9.2 version) says
| >
| >      The optional `OS_type' field specifies the OS(es) for which the
| >  package is intended.  If present, it should be one of `unix' or
| >  `windows', and indicates that the package should only be installed  
| > on a
| >  platform with `.Platform$OS.type' having that value.
| >
| > and I am wondering if 'OS_type: unix' includes OS X or not.  I am  
| > currently
| > updating RInside which builds on the two unixy OS variants.  Would I  
| > exclude
| > OS X by picking OS_type: unix ?  I don't think so but maybe this  
| > could be
| > made more explicit in the paragraph above.
| >
| > Dirk
| 
| Dirk,
| 
| On OSX:
| 
|  > .Platform$OS.type
| [1] "unix"

Thanks, that's exactly what I needed. Maybe one day when I grow up I can
treat myself to one of these shiny computers ...
 
| Remember that OSX is a BSD Unix derivative.

"In theory, theory and practice are the same. In practice, they are not."

Never hurts to double-check. Thanks again!

Dirk

-- 
Three out of two people have difficulties with fractions.


From saptarshi.guha at gmail.com  Sat Sep 12 20:08:19 2009
From: saptarshi.guha at gmail.com (Saptarshi Guha)
Date: Sat, 12 Sep 2009 14:08:19 -0400
Subject: [Rd] Access to integer value of BUILTINSXP/SPECIALSXP
Message-ID: <27ABB3ED-C083-46F2-8DA4-953B7D990A7D@gmail.com>

Hello,
For the BUILTINSXP and SPECIALSXP types, the R Internals page documents

"An integer giving the offset into the table of primitives/.Internals. "

What macro gives me the value of this integer? I guess something like  
this would work
had R_USEINTERNALS been defined
v->u.primsxp.offset
(where v is a SEXP of either of the above types).

What is the portable version?

Thank you
Saptarshi


From saptarshi.guha at gmail.com  Sat Sep 12 22:23:22 2009
From: saptarshi.guha at gmail.com (Saptarshi Guha)
Date: Sat, 12 Sep 2009 16:23:22 -0400
Subject: [Rd] Access to integer value of BUILTINSXP/SPECIALSXP
In-Reply-To: <27ABB3ED-C083-46F2-8DA4-953B7D990A7D@gmail.com>
References: <27ABB3ED-C083-46F2-8DA4-953B7D990A7D@gmail.com>
Message-ID: <1e7471d50909121323r47d6df57s4b23a8198004f951@mail.gmail.com>

After some reading, what i really need is something to give access to
PRIMNAME(obj).
Setting #define R_USEINTERNALS doesn't work and i'd rather not use
internals. Is the some exposed api call to get PRIMNAME?

Thank you
Saptarshi


On Sat, Sep 12, 2009 at 2:08 PM, Saptarshi Guha
<saptarshi.guha at gmail.com> wrote:
> Hello,
> For the BUILTINSXP and SPECIALSXP types, the R Internals page documents
>
> "An integer giving the offset into the table of primitives/.Internals. "
>
> What macro gives me the value of this integer? I guess something like this
> would work
> had R_USEINTERNALS been defined
> v->u.primsxp.offset
> (where v is a SEXP of either of the above types).
>
> What is the portable version?
>
> Thank you
> Saptarshi
>
>
>


From vogranovich at jumptrading.com  Mon Sep 14 19:58:11 2009
From: vogranovich at jumptrading.com (Vadim Ogranovich)
Date: Mon, 14 Sep 2009 12:58:11 -0500
Subject: [Rd] Save all objects in all environment stack
Message-ID: <22D850BC39A25742977325ADDE208E770271F72105@chiexchange02.w2k.jumptrading.com>

Dear R Developers,

I am writing a function that would save all objects in all environments 'visible' from the point where the function is called (very much like save.image, but kind of saving the entire stack).

I figured that the call
lapply (seq(0, sys.nframe()), function(i) ls(sys.frame(i), all.names=T))
will list all such objects.

However not all of them seem to be visible, see a session transcript below

## create a simple function with a 'breakpoint'
> f <- function(x) { browser() }
## call f in lapply inside an anonymous function defined on the fly
> (function(d) lapply('a', f))('d')
Called from: FUN("a"[[1L]], ...)
## Examine all frames
Browse[1]> lapply(seq(0, sys.nframe()), function(i) ls(sys.frame(i), all.names=T))
[[1]]
[1] "f"

[[2]]
[1] "d"

[[3]]
[1] "..." "FUN" "X"

[[4]]
[1] "x"

## try to get d, which is in the second entry on the list
Browse[1]> d
Error: object 'd' not found

Why 'd' is not found?

Did anyone try to write a function that, loosely speaking, saves the entire stack?

Thanks,
Vadim

Note: This email is for the confidential use of the named addressee(s) only and may contain proprietary, confidential or privileged information. If you are not the intended recipient, you are hereby notified that any review, dissemination or copying of this email is strictly prohibited, and to please notify the sender immediately and destroy this email and any attachments.  Email transmission cannot be guaranteed to be secure or error-free.  Jump Trading, therefore, does not make any guarantees as to the completeness or accuracy of this email or any attachments.  This email is for informational purposes only and does not constitute a recommendation, offer, request or solicitation of any kind to buy, sell, subscribe, redeem or perform any type of transaction of a financial product.


From abhibera at gmail.com  Tue Sep 15 09:35:30 2009
From: abhibera at gmail.com (Abhijit Bera)
Date: Tue, 15 Sep 2009 13:05:30 +0530
Subject: [Rd] Clarifications please.
In-Reply-To: <fc212e850908250541i16b1918h58187248193b4cbf@mail.gmail.com>
References: <fc212e850908250541i16b1918h58187248193b4cbf@mail.gmail.com>
Message-ID: <fc212e850909150035x21eaed9cqec74335bd7860bcc@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090915/cb0be831/attachment.pl>

From martin.kober at gmail.com  Tue Sep 15 12:00:58 2009
From: martin.kober at gmail.com (Martin Kober)
Date: Tue, 15 Sep 2009 12:00:58 +0200
Subject: [Rd] S3 objects in S4 slots
Message-ID: <116117690909150300v4a703807se7b08b94c3f1a68d@mail.gmail.com>

Hello,

I am the maintainer of the stringkernels package and have come across
a problem with using S3 objects in my S4 classes.

Specifically, I have an S4 class with a slot that takes a text corpus
as a list of character vectors. tm (version 0.5) saves corpora as
lists with a class attribute of c("VCorpus", "Corpus", "list"). I
don't actually need the class-specific attributes, I only care about
the list itself.

Here's a simplified example of my problem:

> setClass("testclass", representation(slot="list"))
[1] "testclass"
> a = list(a="1", b="2")
> class(a) = c("VCorpus", "Corpus", "list") # same as corpora in tm v0.5
> x = new("testclass", slot=a)
Error in validObject(.Object) :
  invalid class "testclass" object: 1: invalid object for slot "slot"
in class "testclass": got class "VCorpus", should be or extend class
"list"
invalid class "testclass" object: 2: invalid object for slot "slot" in
class "testclass": got class "Corpus", should be or extend class
"list"
invalid class "testclass" object: 3: invalid object for slot "slot" in
class "testclass": got class "list", should be or extend class "list"

The last line is a bit confusing here (``got class "list", should be
or extend class "list"''). There's an even more confusing error
message when I try to assign the slot later on:

> y = new("testclass")
> y at slot = a
Error in checkSlotAssignment(object, name, value) :
  c("assignment of an object of class \"VCorpus\" is not valid for
slot \"slot\" in an object of class \"testclass\"; is(value, \"list\")
is not TRUE", "assignment of an object of class \"Corpus\" is not
valid for slot \"slot\" in an object of class \"testclass\"; is(value,
\"list\") is not TRUE", "assignment of an object of class \"list\" is
not valid for slot \"slot\" in an object of class \"testclass\";
is(value, \"list\") is not TRUE")

The last part of the message claims that ``is(value, "list") is not
TRUE'', but is(a, "list") is certainly TRUE. (??)

On a side note, it does work when "list" is the first entry in class().


I tried to use setOldClass, but seemingly using list is not possible
because it does not extend oldClass, or I didn't find out how to do
it:
> setOldClass(c("VCorpus", "Corpus", "list"))
Error in setOldClass(c("VCorpus", "Corpus", "list")) :
  inconsistent old-style class information for "list"; the class is
defined but does not extend "oldClass"


Intuitively I would have thought that, because the underlying data is
of type list, it would "fit" into an object slot requiring a list,
irrespective of S3 class attributes. The only thing I can think of is
a manual solution removing the class attribute.

Is there a way to define lists with S3 class attributes such that they
are accepted as lists in S4 object slots? Or any other ways to solve
this?


Thanks in advance
Best Regards
Martin


From murdoch at stats.uwo.ca  Tue Sep 15 12:26:32 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 15 Sep 2009 06:26:32 -0400
Subject: [Rd] S3 objects in S4 slots
In-Reply-To: <116117690909150300v4a703807se7b08b94c3f1a68d@mail.gmail.com>
References: <116117690909150300v4a703807se7b08b94c3f1a68d@mail.gmail.com>
Message-ID: <4AAF6BD8.1010002@stats.uwo.ca>

Martin Kober wrote:
> Hello,
>
> I am the maintainer of the stringkernels package and have come across
> a problem with using S3 objects in my S4 classes.
>
> Specifically, I have an S4 class with a slot that takes a text corpus
> as a list of character vectors. tm (version 0.5) saves corpora as
> lists with a class attribute of c("VCorpus", "Corpus", "list"). I
> don't actually need the class-specific attributes, I only care about
> the list itself.
>
> Here's a simplified example of my problem:
>
>   
>> setClass("testclass", representation(slot="list"))
>>     
> [1] "testclass"
>   
>> a = list(a="1", b="2")
>> class(a) = c("VCorpus", "Corpus", "list") # same as corpora in tm v0.5
>> x = new("testclass", slot=a)
>>     
> Error in validObject(.Object) :
>   invalid class "testclass" object: 1: invalid object for slot "slot"
> in class "testclass": got class "VCorpus", should be or extend class
> "list"
> invalid class "testclass" object: 2: invalid object for slot "slot" in
> class "testclass": got class "Corpus", should be or extend class
> "list"
> invalid class "testclass" object: 3: invalid object for slot "slot" in
> class "testclass": got class "list", should be or extend class "list"
>
> The last line is a bit confusing here (``got class "list", should be
> or extend class "list"''). There's an even more confusing error
> message when I try to assign the slot later on:
>
>   
>> y = new("testclass")
>> y at slot = a
>>     
> Error in checkSlotAssignment(object, name, value) :
>   c("assignment of an object of class \"VCorpus\" is not valid for
> slot \"slot\" in an object of class \"testclass\"; is(value, \"list\")
> is not TRUE", "assignment of an object of class \"Corpus\" is not
> valid for slot \"slot\" in an object of class \"testclass\"; is(value,
> \"list\") is not TRUE", "assignment of an object of class \"list\" is
> not valid for slot \"slot\" in an object of class \"testclass\";
> is(value, \"list\") is not TRUE")
>
> The last part of the message claims that ``is(value, "list") is not
> TRUE'', but is(a, "list") is certainly TRUE. (??)
>
> On a side note, it does work when "list" is the first entry in class().
>
>
> I tried to use setOldClass, but seemingly using list is not possible
> because it does not extend oldClass, or I didn't find out how to do
> it:
>   
>> setOldClass(c("VCorpus", "Corpus", "list"))
>>     
> Error in setOldClass(c("VCorpus", "Corpus", "list")) :
>   inconsistent old-style class information for "list"; the class is
> defined but does not extend "oldClass"
>
>
> Intuitively I would have thought that, because the underlying data is
> of type list, it would "fit" into an object slot requiring a list,
> irrespective of S3 class attributes. The only thing I can think of is
> a manual solution removing the class attribute.
>
> Is there a way to define lists with S3 class attributes such that they
> are accepted as lists in S4 object slots? Or any other ways to solve
> this?
>   

A possible workaround is to store unclass(a) in that slot, rather than 
a.  You won't be able to use the VCorpus or Corpus methods on it, but it 
sounds as though you don't want to.

I would say checkSlotAssignment should be using some variation on 
inherits(), rather than checking for an exact class match, but probably 
the real message is that you shouldn't mix S3 and S4 systems.  Convert 
the VCorpus objects to S4 objects, or use S3 objects everywhere.

Duncan Murdoch


From maechler at stat.math.ethz.ch  Tue Sep 15 13:34:52 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 15 Sep 2009 13:34:52 +0200
Subject: [Rd] S3 objects in S4 slots
In-Reply-To: <4AAF6BD8.1010002@stats.uwo.ca>
References: <116117690909150300v4a703807se7b08b94c3f1a68d@mail.gmail.com>
	<4AAF6BD8.1010002@stats.uwo.ca>
Message-ID: <19119.31708.308427.313593@lynne.math.ethz.ch>

>>>>> Duncan Murdoch <murdoch at stats.uwo.ca>
>>>>>     on Tue, 15 Sep 2009 06:26:32 -0400 writes:

    > Martin Kober wrote:
    >> Hello,
    >> 
    >> I am the maintainer of the stringkernels package and have come across
    >> a problem with using S3 objects in my S4 classes.
    >> 
    >> Specifically, I have an S4 class with a slot that takes a text corpus
    >> as a list of character vectors. tm (version 0.5) saves corpora as
    >> lists with a class attribute of c("VCorpus", "Corpus", "list"). I
    >> don't actually need the class-specific attributes, I only care about
    >> the list itself.
    >> 
    >> Here's a simplified example of my problem:
    >> 
    >> 
    >>> setClass("testclass", representation(slot="list"))
    >>> 
    >> [1] "testclass"
    >> 
    >>> a = list(a="1", b="2")
    >>> class(a) = c("VCorpus", "Corpus", "list") # same as corpora in tm v0.5
    >>> x = new("testclass", slot=a)
    >>> 
    >> Error in validObject(.Object) :
    >> invalid class "testclass" object: 1: invalid object for slot "slot"
    >> in class "testclass": got class "VCorpus", should be or extend class
    >> "list"
    >> invalid class "testclass" object: 2: invalid object for slot "slot" in
    >> class "testclass": got class "Corpus", should be or extend class
    >> "list"
    >> invalid class "testclass" object: 3: invalid object for slot "slot" in
    >> class "testclass": got class "list", should be or extend class "list"
    >> 
    >> The last line is a bit confusing here (``got class "list", should be
    >> or extend class "list"''). There's an even more confusing error
    >> message when I try to assign the slot later on:
    >> 
    >> 
    >>> y = new("testclass")
    >>> y at slot = a
    >>> 
    >> Error in checkSlotAssignment(object, name, value) :
    >> c("assignment of an object of class \"VCorpus\" is not valid for
    >> slot \"slot\" in an object of class \"testclass\"; is(value, \"list\")
    >> is not TRUE", "assignment of an object of class \"Corpus\" is not
    >> valid for slot \"slot\" in an object of class \"testclass\"; is(value,
    >> \"list\") is not TRUE", "assignment of an object of class \"list\" is
    >> not valid for slot \"slot\" in an object of class \"testclass\";
    >> is(value, \"list\") is not TRUE")
    >> 
    >> The last part of the message claims that ``is(value, "list") is not
    >> TRUE'', but is(a, "list") is certainly TRUE. (??)
    >> 
    >> On a side note, it does work when "list" is the first entry in class().
    >> 
    >> 
    >> I tried to use setOldClass, but seemingly using list is not possible
    >> because it does not extend oldClass, or I didn't find out how to do
    >> it:
    >> 
    >>> setOldClass(c("VCorpus", "Corpus", "list"))
    >>> 
    >> Error in setOldClass(c("VCorpus", "Corpus", "list")) :
    >> inconsistent old-style class information for "list"; the class is
    >> defined but does not extend "oldClass"
    >> 
    >> 
    >> Intuitively I would have thought that, because the underlying data is
    >> of type list, it would "fit" into an object slot requiring a list,
    >> irrespective of S3 class attributes. The only thing I can think of is
    >> a manual solution removing the class attribute.
    >> 
    >> Is there a way to define lists with S3 class attributes such that they
    >> are accepted as lists in S4 object slots? Or any other ways to solve
    >> this?
    >> 

    > A possible workaround is to store unclass(a) in that slot, rather than 
    > a.  You won't be able to use the VCorpus or Corpus methods on it, but it 
    > sounds as though you don't want to.

    > I would say checkSlotAssignment should be using some variation on 
    > inherits(), rather than checking for an exact class match, but probably 
    > the real message is that you shouldn't mix S3 and S4 systems.

I don't think so.
Recent releases of R have had big improvements (instrumented by
John Chambers) in order to make exactly this (S3 classed objects as
slots of S4 objects) possible !!

    >   Convert  the VCorpus objects to S4 objects, or use S3 objects everywhere.

Well, no, at least not at all according to what I think has been the
intentions of the recent years' changes of making S3 objects
better fit into the S4 frame work.

Martin Maechler


From murdoch at stats.uwo.ca  Tue Sep 15 13:42:29 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 15 Sep 2009 07:42:29 -0400
Subject: [Rd] S3 objects in S4 slots
In-Reply-To: <19119.31708.308427.313593@lynne.math.ethz.ch>
References: <116117690909150300v4a703807se7b08b94c3f1a68d@mail.gmail.com>	<4AAF6BD8.1010002@stats.uwo.ca>
	<19119.31708.308427.313593@lynne.math.ethz.ch>
Message-ID: <4AAF7DA5.5050608@stats.uwo.ca>

On 15/09/2009 7:34 AM, Martin Maechler wrote:
>>>>>> Duncan Murdoch <murdoch at stats.uwo.ca>
>>>>>>     on Tue, 15 Sep 2009 06:26:32 -0400 writes:
> 
>     > Martin Kober wrote:
>     >> Hello,
>     >> 
>     >> I am the maintainer of the stringkernels package and have come across
>     >> a problem with using S3 objects in my S4 classes.
>     >> 
>     >> Specifically, I have an S4 class with a slot that takes a text corpus
>     >> as a list of character vectors. tm (version 0.5) saves corpora as
>     >> lists with a class attribute of c("VCorpus", "Corpus", "list"). I
>     >> don't actually need the class-specific attributes, I only care about
>     >> the list itself.
>     >> 
>     >> Here's a simplified example of my problem:
>     >> 
>     >> 
>     >>> setClass("testclass", representation(slot="list"))
>     >>> 
>     >> [1] "testclass"
>     >> 
>     >>> a = list(a="1", b="2")
>     >>> class(a) = c("VCorpus", "Corpus", "list") # same as corpora in tm v0.5
>     >>> x = new("testclass", slot=a)
>     >>> 
>     >> Error in validObject(.Object) :
>     >> invalid class "testclass" object: 1: invalid object for slot "slot"
>     >> in class "testclass": got class "VCorpus", should be or extend class
>     >> "list"
>     >> invalid class "testclass" object: 2: invalid object for slot "slot" in
>     >> class "testclass": got class "Corpus", should be or extend class
>     >> "list"
>     >> invalid class "testclass" object: 3: invalid object for slot "slot" in
>     >> class "testclass": got class "list", should be or extend class "list"
>     >> 
>     >> The last line is a bit confusing here (``got class "list", should be
>     >> or extend class "list"''). There's an even more confusing error
>     >> message when I try to assign the slot later on:
>     >> 
>     >> 
>     >>> y = new("testclass")
>     >>> y at slot = a
>     >>> 
>     >> Error in checkSlotAssignment(object, name, value) :
>     >> c("assignment of an object of class \"VCorpus\" is not valid for
>     >> slot \"slot\" in an object of class \"testclass\"; is(value, \"list\")
>     >> is not TRUE", "assignment of an object of class \"Corpus\" is not
>     >> valid for slot \"slot\" in an object of class \"testclass\"; is(value,
>     >> \"list\") is not TRUE", "assignment of an object of class \"list\" is
>     >> not valid for slot \"slot\" in an object of class \"testclass\";
>     >> is(value, \"list\") is not TRUE")
>     >> 
>     >> The last part of the message claims that ``is(value, "list") is not
>     >> TRUE'', but is(a, "list") is certainly TRUE. (??)
>     >> 
>     >> On a side note, it does work when "list" is the first entry in class().
>     >> 
>     >> 
>     >> I tried to use setOldClass, but seemingly using list is not possible
>     >> because it does not extend oldClass, or I didn't find out how to do
>     >> it:
>     >> 
>     >>> setOldClass(c("VCorpus", "Corpus", "list"))
>     >>> 
>     >> Error in setOldClass(c("VCorpus", "Corpus", "list")) :
>     >> inconsistent old-style class information for "list"; the class is
>     >> defined but does not extend "oldClass"
>     >> 
>     >> 
>     >> Intuitively I would have thought that, because the underlying data is
>     >> of type list, it would "fit" into an object slot requiring a list,
>     >> irrespective of S3 class attributes. The only thing I can think of is
>     >> a manual solution removing the class attribute.
>     >> 
>     >> Is there a way to define lists with S3 class attributes such that they
>     >> are accepted as lists in S4 object slots? Or any other ways to solve
>     >> this?
>     >> 
> 
>     > A possible workaround is to store unclass(a) in that slot, rather than 
>     > a.  You won't be able to use the VCorpus or Corpus methods on it, but it 
>     > sounds as though you don't want to.
> 
>     > I would say checkSlotAssignment should be using some variation on 
>     > inherits(), rather than checking for an exact class match, but probably 
>     > the real message is that you shouldn't mix S3 and S4 systems.
> 
> I don't think so.
> Recent releases of R have had big improvements (instrumented by
> John Chambers) in order to make exactly this (S3 classed objects as
> slots of S4 objects) possible !!

Shouldn't an object that inherits from "list" be allowed to occupy a 
slot that wants a list?

Duncan Murdoch


> 
>     >   Convert  the VCorpus objects to S4 objects, or use S3 objects everywhere.
> 
> Well, no, at least not at all according to what I think has been the
> intentions of the recent years' changes of making S3 objects
> better fit into the S4 frame work.
> 
> Martin Maechler


From abhibera at gmail.com  Tue Sep 15 15:11:45 2009
From: abhibera at gmail.com (Abhijit Bera)
Date: Tue, 15 Sep 2009 18:41:45 +0530
Subject: [Rd] Clarifications please.
In-Reply-To: <fc212e850909150035x21eaed9cqec74335bd7860bcc@mail.gmail.com>
References: <fc212e850908250541i16b1918h58187248193b4cbf@mail.gmail.com>
	<fc212e850909150035x21eaed9cqec74335bd7860bcc@mail.gmail.com>
Message-ID: <fc212e850909150611t45fcd6d2n2446d84aa08c16@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090915/209f7224/attachment.pl>

From mtmorgan at fhcrc.org  Tue Sep 15 15:23:55 2009
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Tue, 15 Sep 2009 06:23:55 -0700
Subject: [Rd] S3 objects in S4 slots
In-Reply-To: <116117690909150300v4a703807se7b08b94c3f1a68d@mail.gmail.com>
References: <116117690909150300v4a703807se7b08b94c3f1a68d@mail.gmail.com>
Message-ID: <4AAF956B.7090704@fhcrc.org>

Hi Martin Kober --

Martin Kober wrote:
> Hello,
> 
> I am the maintainer of the stringkernels package and have come across
> a problem with using S3 objects in my S4 classes.
> 
> Specifically, I have an S4 class with a slot that takes a text corpus
> as a list of character vectors. tm (version 0.5) saves corpora as
> lists with a class attribute of c("VCorpus", "Corpus", "list"). I
> don't actually need the class-specific attributes, I only care about
> the list itself.
> 
> Here's a simplified example of my problem:
> 
>> setClass("testclass", representation(slot="list"))
> [1] "testclass"
>> a = list(a="1", b="2")
>> class(a) = c("VCorpus", "Corpus", "list") # same as corpora in tm v0.5

This has the feel of a workaround, but

setOldClass(class(a)[1:2]); setIs("Corpus", "list")

helps here, first registering c('vCorpus', 'Corpus') as an S3 hierarchy
and then defining the relationship between the root of the hierarchy and
(the S4 class) 'list'.

Martin (Morgan)

>> x = new("testclass", slot=a)
> Error in validObject(.Object) :
>   invalid class "testclass" object: 1: invalid object for slot "slot"
> in class "testclass": got class "VCorpus", should be or extend class
> "list"
> invalid class "testclass" object: 2: invalid object for slot "slot" in
> class "testclass": got class "Corpus", should be or extend class
> "list"
> invalid class "testclass" object: 3: invalid object for slot "slot" in
> class "testclass": got class "list", should be or extend class "list"
> 
> The last line is a bit confusing here (``got class "list", should be
> or extend class "list"''). There's an even more confusing error
> message when I try to assign the slot later on:
> 
>> y = new("testclass")
>> y at slot = a
> Error in checkSlotAssignment(object, name, value) :
>   c("assignment of an object of class \"VCorpus\" is not valid for
> slot \"slot\" in an object of class \"testclass\"; is(value, \"list\")
> is not TRUE", "assignment of an object of class \"Corpus\" is not
> valid for slot \"slot\" in an object of class \"testclass\"; is(value,
> \"list\") is not TRUE", "assignment of an object of class \"list\" is
> not valid for slot \"slot\" in an object of class \"testclass\";
> is(value, \"list\") is not TRUE")
> 
> The last part of the message claims that ``is(value, "list") is not
> TRUE'', but is(a, "list") is certainly TRUE. (??)
> 
> On a side note, it does work when "list" is the first entry in class().
> 
> 
> I tried to use setOldClass, but seemingly using list is not possible
> because it does not extend oldClass, or I didn't find out how to do
> it:
>> setOldClass(c("VCorpus", "Corpus", "list"))
> Error in setOldClass(c("VCorpus", "Corpus", "list")) :
>   inconsistent old-style class information for "list"; the class is
> defined but does not extend "oldClass"
> 
> 
> Intuitively I would have thought that, because the underlying data is
> of type list, it would "fit" into an object slot requiring a list,
> irrespective of S3 class attributes. The only thing I can think of is
> a manual solution removing the class attribute.
> 
> Is there a way to define lists with S3 class attributes such that they
> are accepted as lists in S4 object slots? Or any other ways to solve
> this?
> 
> 
> Thanks in advance
> Best Regards
> Martin
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From jmc at r-project.org  Tue Sep 15 18:02:36 2009
From: jmc at r-project.org (John Chambers)
Date: Tue, 15 Sep 2009 09:02:36 -0700
Subject: [Rd] S3 objects in S4 slots
In-Reply-To: <4AAF956B.7090704@fhcrc.org>
References: <116117690909150300v4a703807se7b08b94c3f1a68d@mail.gmail.com>
	<4AAF956B.7090704@fhcrc.org>
Message-ID: <4AAFBA9C.5090502@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090915/6e3cb950/attachment.pl>

From pleydell at supagro.inra.fr  Tue Sep 15 20:04:51 2009
From: pleydell at supagro.inra.fr (pleydell at supagro.inra.fr)
Date: Tue, 15 Sep 2009 20:04:51 +0200
Subject: [Rd] Building R package with .c sub-routine files
Message-ID: <20090915200451.pcj3j24q168s048k@web.supagro.inra.fr>

Lets say I have two source files  file1.c and file2.c

The latter just contains sub-routines to be used by the first. i.e. in file1.c I
have the line

#include "file2.c"


Let's say "R CMD SHLIB file1.c" runs perfectly and I want to include the code in
a package, "R CMD build" also runs fine but R CMD check" gives

* checking whether package 'myPackage' can be installed ... ERROR
Installation failed.
See '/pathto/myPackage.Rcheck/00install.out' for details.

basically the compiler is trying to compile file2.c independantly of file1.c
which is not what I want and prevents a proper build

What's the easiest way to enforce the correct file dependencies when building  R
packages?

cheers
David


From murdoch at stats.uwo.ca  Tue Sep 15 20:20:49 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 15 Sep 2009 14:20:49 -0400
Subject: [Rd] Building R package with .c sub-routine files
In-Reply-To: <20090915200451.pcj3j24q168s048k@web.supagro.inra.fr>
References: <20090915200451.pcj3j24q168s048k@web.supagro.inra.fr>
Message-ID: <4AAFDB01.6020303@stats.uwo.ca>

On 9/15/2009 2:04 PM, pleydell at supagro.inra.fr wrote:
> Lets say I have two source files  file1.c and file2.c
> 
> The latter just contains sub-routines to be used by the first. i.e. in file1.c I
> have the line
> 
> #include "file2.c"

That's not the normal way to program in C:  normally you'd have a 
separate file2.h header file which is all you'd include in file1.c, and 
compile file2.c using the same header file to a separate object file.

I guess you could probably get your scheme to work by renaming file2.c 
to file2.h, but putting actual executable code into a .h file seems 
pretty strange.

Duncan Murdoch

> 
> 
> Let's say "R CMD SHLIB file1.c" runs perfectly and I want to include the code in
> a package, "R CMD build" also runs fine but R CMD check" gives
> 
> * checking whether package 'myPackage' can be installed ... ERROR
> Installation failed.
> See '/pathto/myPackage.Rcheck/00install.out' for details.
> 
> basically the compiler is trying to compile file2.c independantly of file1.c
> which is not what I want and prevents a proper build
> 
> What's the easiest way to enforce the correct file dependencies when building  R
> packages?
> 
> cheers
> David
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From kjell.konis at epfl.ch  Tue Sep 15 20:49:53 2009
From: kjell.konis at epfl.ch (Kjell Konis)
Date: Tue, 15 Sep 2009 20:49:53 +0200
Subject: [Rd] Building R package with .c sub-routine files
In-Reply-To: <20090915200451.pcj3j24q168s048k@web.supagro.inra.fr>
References: <20090915200451.pcj3j24q168s048k@web.supagro.inra.fr>
Message-ID: <D54A75FE-D6B4-4173-AFE3-A855CCD22ED4@epfl.ch>

Create a file named Makevars in the same directory and put the  
following line in it:

OBJECTS=file1.o

Then R CMD SHLIB will only compile file1.c.

Kjell

On Sep 15, 2009, at 8:04 PM, pleydell at supagro.inra.fr wrote:

> Lets say I have two source files  file1.c and file2.c
>
> The latter just contains sub-routines to be used by the first. i.e.  
> in file1.c I
> have the line
>
> #include "file2.c"
>
>
> Let's say "R CMD SHLIB file1.c" runs perfectly and I want to  
> include the code in
> a package, "R CMD build" also runs fine but R CMD check" gives
>
> * checking whether package 'myPackage' can be installed ... ERROR
> Installation failed.
> See '/pathto/myPackage.Rcheck/00install.out' for details.
>
> basically the compiler is trying to compile file2.c independantly  
> of file1.c
> which is not what I want and prevents a proper build
>
> What's the easiest way to enforce the correct file dependencies  
> when building  R
> packages?
>
> cheers
> David
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From martin.kober at gmail.com  Wed Sep 16 02:23:24 2009
From: martin.kober at gmail.com (Martin Kober)
Date: Wed, 16 Sep 2009 02:23:24 +0200
Subject: [Rd] S3 objects in S4 slots
In-Reply-To: <4AAFBA9C.5090502@r-project.org>
References: <116117690909150300v4a703807se7b08b94c3f1a68d@mail.gmail.com>
	<4AAF956B.7090704@fhcrc.org> <4AAFBA9C.5090502@r-project.org>
Message-ID: <116117690909151723o466d0f9eh772f3d6dbffd7e90@mail.gmail.com>

2009/9/15 John Chambers <jmc at r-project.org>:
> I'll look at this in more detail (though not for a few days), but the
> essence I think is that nothing in the current version allows one to say the
> S3 equivalent of
>
> setClass("VCorpus", contains = "list", ....)
>
> Seems a (minor, I hope) glitch that what Martin K.? tried didn't work:
> ?? setOldClass(c("VCorpus", "Corpus", "list"))
>
> As far as I can see, setOldClass() should understand the basic data types as
> valid superclasses.
That would be really useful.

Do you think it would be feasible to automatically assume that all S3
objects "contain" their basic data type (like a list, in this case)
for purposes of S4 class matching, when no other information is given?

At least in this specific case, the idea is that corpus objects can be
used as a list of character vectors and code does not need to know
anything about the object structure as long as only the contents of
the list are needed. So (again, in this specific case), I would
consider "defaulting" to the underlying data type optimal.

>
> Martin Morgan's code is indeed a workaround.? And as Martin Maechler
> commented, the intention is to make S3 and S4 classes play together as much
> as possible.
>

Thanks to Martin Morgan for the workaround, it works very well.

>
> Morgan wrote:
>
> Hi Martin Kober --
> Martin Kober wrote:
>
>
> Hello,
> I am the maintainer of the stringkernels package and have come across
> a problem with using S3 objects in my S4 classes.
> Specifically, I have an S4 class with a slot that takes a text corpus
> as a list of character vectors. tm (version 0.5) saves corpora as
> lists with a class attribute of c("VCorpus", "Corpus", "list"). I
> don't actually need the class-specific attributes, I only care about
> the list itself.
> Here's a simplified example of my problem:
>
>
> setClass("testclass", representation(slot="list"))
>
>
> [1] "testclass"
>
>
> a = list(a="1", b="2")
> class(a) = c("VCorpus", "Corpus", "list") # same as corpora in tm v0.5
>
>
> This has the feel of a workaround, but
> setOldClass(class(a)[1:2]); setIs("Corpus", "list")
> helps here, first registering c('vCorpus', 'Corpus') as an S3 hierarchy
> and then defining the relationship between the root of the hierarchy and
> (the S4 class) 'list'.
> Martin (Morgan)
>
>
> x = new("testclass", slot=a)
>
>
> Error in validObject(.Object) :
>   invalid class "testclass" object: 1: invalid object for slot "slot"
> in class "testclass": got class "VCorpus", should be or extend class
> "list"
> invalid class "testclass" object: 2: invalid object for slot "slot" in
> class "testclass": got class "Corpus", should be or extend class
> "list"
> invalid class "testclass" object: 3: invalid object for slot "slot" in
> class "testclass": got class "list", should be or extend class "list"
> The last line is a bit confusing here (``got class "list", should be
> or extend class "list"''). There's an even more confusing error
> message when I try to assign the slot later on:
>
>
> y = new("testclass")
> y at slot = a
>
>
> Error in checkSlotAssignment(object, name, value) :
>   c("assignment of an object of class \"VCorpus\" is not valid for
> slot \"slot\" in an object of class \"testclass\"; is(value, \"list\")
> is not TRUE", "assignment of an object of class \"Corpus\" is not
> valid for slot \"slot\" in an object of class \"testclass\"; is(value,
> \"list\") is not TRUE", "assignment of an object of class \"list\" is
> not valid for slot \"slot\" in an object of class \"testclass\";
> is(value, \"list\") is not TRUE")
> The last part of the message claims that ``is(value, "list") is not
> TRUE'', but is(a, "list") is certainly TRUE. (??)
> On a side note, it does work when "list" is the first entry in class().
> I tried to use setOldClass, but seemingly using list is not possible
> because it does not extend oldClass, or I didn't find out how to do
> it:
>
>
> setOldClass(c("VCorpus", "Corpus", "list"))
>
>
> Error in setOldClass(c("VCorpus", "Corpus", "list")) :
>   inconsistent old-style class information for "list"; the class is
> defined but does not extend "oldClass"
> Intuitively I would have thought that, because the underlying data is
> of type list, it would "fit" into an object slot requiring a list,
> irrespective of S3 class attributes. The only thing I can think of is
> a manual solution removing the class attribute.
> Is there a way to define lists with S3 class attributes such that they
> are accepted as lists in S4 object slots? Or any other ways to solve
> this?
> Thanks in advance
> Best Regards
> Martin
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From abhibera at gmail.com  Wed Sep 16 09:02:22 2009
From: abhibera at gmail.com (Abhijit Bera)
Date: Wed, 16 Sep 2009 12:32:22 +0530
Subject: [Rd] I want to get a reference to this time series object
Message-ID: <fc212e850909160002l7fc94109l83333f0d00b350ff@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090916/e4728c61/attachment.pl>

From romain.francois at dbmail.com  Wed Sep 16 09:18:55 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Wed, 16 Sep 2009 09:18:55 +0200
Subject: [Rd] I want to get a reference to this time series object
In-Reply-To: <fc212e850909160002l7fc94109l83333f0d00b350ff@mail.gmail.com>
References: <fc212e850909160002l7fc94109l83333f0d00b350ff@mail.gmail.com>
Message-ID: <4AB0915F.3040100@dbmail.com>

Hi,

Luckily, R has its own parser, so you don't have to reimplement it. Just 
parse your string 'SWX.RET[1:6,c("SBI,"SPI","SII")]' and eval the parsed 
expression(s). The R_ParseVector function will help you.

Romain

On 09/16/2009 09:02 AM, Abhijit Bera wrote:
>
> I'm trying to get a reference to this object in C
>
> SWX.RET[1:6,c("SBI,"SPI","SII")]
>
> While i am able to access and use a plain SWX.RET object, I'm getting
> confused on how to create an object with the array subscripts like above.
>
> Here is what I tried to do. It doesn't work because "[" is obviously not an
> operation or function on SWX.RET. So how do I get a reference to this
> object?
>
> #include<stdio.h>
> #include<R.h>
> #include<Rinternals.h>
> #include<Rdefines.h>
> #include<Rembedded.h>
>
> int main(int argc, char** argv)
> {
>
>      SEXP e,c,portSpec,portData,portConstr,portVal,tsAssets;
>      int errorOccurred,nx,ny,i,j;
>      double *v;
>      const char *x,*y;
>
>      Rf_initEmbeddedR(argc, argv);
>
>      // loading fPortfolio
>      PROTECT(e = lang2(install("library"), mkString("fPortfolio")));
>      R_tryEval(e, R_GlobalEnv, NULL);
>      UNPROTECT(1);
>
>
>      // creating a default portfolioSpec object
>      PROTECT(e=lang1(install("portfolioSpec")));
>      PROTECT(portSpec=R_tryEval(e,R_GlobalEnv, NULL));
>
>      // creating a portfolioData object
>
>
> PROTECT(e=lang4(install("c"),mkString("SBI"),mkString("SPI"),mkString("SII")));
>      PROTECT(c=R_tryEval(e,R_GlobalEnv,NULL));
>
>      PROTECT(e=lang3(install("["),install("SWX.RET"),c));
>      PROTECT(portData=R_tryEval(e,R_GlobalEnv,NULL));
>
>      PROTECT(e=lang2(install("print"),portData));
>      R_tryEval(e,R_GlobalEnv,NULL);
>
>
>      UNPROTECT(3);
>
>      Rf_endEmbeddedR(0);
>
>      return 0;
> }

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/yw8E : New R package : sos
|- http://tr.im/y8y0 : search the graph gallery from R
`- http://tr.im/y8wY : new R package : ant


From abhibera at gmail.com  Wed Sep 16 09:40:10 2009
From: abhibera at gmail.com (Abhijit Bera)
Date: Wed, 16 Sep 2009 13:10:10 +0530
Subject: [Rd] I want to get a reference to this time series object
In-Reply-To: <4AB0915F.3040100@dbmail.com>
References: <fc212e850909160002l7fc94109l83333f0d00b350ff@mail.gmail.com>
	<4AB0915F.3040100@dbmail.com>
Message-ID: <fc212e850909160040r6687dcd4g63b183e164ce0969@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090916/b94a04ac/attachment.pl>

From romain.francois at dbmail.com  Wed Sep 16 09:56:11 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Wed, 16 Sep 2009 09:56:11 +0200
Subject: [Rd] I want to get a reference to this time series object
In-Reply-To: <fc212e850909160040r6687dcd4g63b183e164ce0969@mail.gmail.com>
References: <fc212e850909160002l7fc94109l83333f0d00b350ff@mail.gmail.com>	
	<4AB0915F.3040100@dbmail.com>
	<fc212e850909160040r6687dcd4g63b183e164ce0969@mail.gmail.com>
Message-ID: <4AB09A1B.7020001@dbmail.com>

On 09/16/2009 09:40 AM, Abhijit Bera wrote:
> So I should use the R parser?

If you want to parse R code, yes

> Actually I'm trying to develop a JS interface for R. So I'm terribly
> confused with the design aspects. Won't parsing be slower?

sure. but I suspect SWX.RET[1:6,c("SBI,"SPI","SII")] is not the only 
expression you want your interface to deal with ?

in the code you sent, you acted as the parser, and I believe this has 
been slower than this:

 > system.time( parse( text = 'SWX.RET[1:6,c("SBI", "SPI", "SII")]' ) )
    user  system elapsed
   0.001   0.000   0.001

Do you want it to be faster than this ?

> Is there a better way to do what I'm doing other than parsing?
 >
> Regards
>
> Abhijit
>
>
> On Wed, SSep 16, 2009 at 12:48 PM, Romain Francois
> <romain.francois at dbmail.com <mailto:romain.francois at dbmail.com>> wrote:
>
>     Hi,
>
>     Luckily, R has its own parser, so you don't have to reimplement it.
>     Just parse your string 'SWX.RET[1:6,c("SBI,"SPI","SII")]' and eval
>     the parsed expression(s). The R_ParseVector function will help you.
>
>     Romain
>
>
>     On 09/16/2009 09:02 AM, Abhijit Bera wrote:
>
>
>         I'm trying to get a reference to this object in C
>
>         SWX.RET[1:6,c("SBI,"SPI","SII")]
>
>         While i am able to access and use a plain SWX.RET object, I'm
>         getting
>         confused on how to create an object with the array subscripts
>         like above.
>
>         Here is what I tried to do. It doesn't work because "[" is
>         obviously not an
>         operation or function on SWX.RET. So how do I get a reference to
>         this
>         object?
>
>         #include<stdio.h>
>         #include<R.h>
>         #include<Rinternals.h>
>         #include<Rdefines.h>
>         #include<Rembedded.h>
>
>         int main(int argc, char** argv)
>         {
>
>              SEXP e,c,portSpec,portData,portConstr,portVal,tsAssets;
>              int errorOccurred,nx,ny,i,j;
>              double *v;
>              const char *x,*y;
>
>              Rf_initEmbeddedR(argc, argv);
>
>              // loading fPortfolio
>              PROTECT(e = lang2(install("library"), mkString("fPortfolio")));
>              R_tryEval(e, R_GlobalEnv, NULL);
>              UNPROTECT(1);
>
>
>              // creating a default portfolioSpec object
>              PROTECT(e=lang1(install("portfolioSpec")));
>              PROTECT(portSpec=R_tryEval(e,R_GlobalEnv, NULL));
>
>              // creating a portfolioData object
>
>
>         PROTECT(e=lang4(install("c"),mkString("SBI"),mkString("SPI"),mkString("SII")));
>              PROTECT(c=R_tryEval(e,R_GlobalEnv,NULL));
>
>              PROTECT(e=lang3(install("["),install("SWX.RET"),c));
>              PROTECT(portData=R_tryEval(e,R_GlobalEnv,NULL));
>
>              PROTECT(e=lang2(install("print"),portData));
>              R_tryEval(e,R_GlobalEnv,NULL);
>
>
>              UNPROTECT(3);
>
>              Rf_endEmbeddedR(0);
>
>              return 0;
>         }


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/yw8E : New R package : sos
|- http://tr.im/y8y0 : search the graph gallery from R
`- http://tr.im/y8wY : new R package : ant


From jsnel at few.vu.nl  Wed Sep 16 12:02:23 2009
From: jsnel at few.vu.nl (Joris @ VU)
Date: Wed, 16 Sep 2009 12:02:23 +0200
Subject: [Rd] r-forge.r-project.org down?
Message-ID: <ad0ddd280909160302x369b4fd8i6e7a9421e6b17709@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090916/9c26917a/attachment.pl>

From maechler at stat.math.ethz.ch  Wed Sep 16 13:21:31 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 16 Sep 2009 13:21:31 +0200
Subject: [Rd] r-forge.r-project.org down?
In-Reply-To: <ad0ddd280909160302x369b4fd8i6e7a9421e6b17709@mail.gmail.com>
References: <ad0ddd280909160302x369b4fd8i6e7a9421e6b17709@mail.gmail.com>
Message-ID: <19120.51771.492664.506312@lynne.math.ethz.ch>

>>>>> "J at V" == Joris @ VU <jsnel at few.vu.nl>
>>>>>     on Wed, 16 Sep 2009 12:02:23 +0200 writes:

    J at V> Hello there fellow developers,
    J at V> Is it just me or does the r-forge server seem to be down? 

No, we've seen the problem at least in the USA and in
Switzerland as well.

    J at V> Neither http or
    J at V> the scm repositories seem to work. Does anybody have any idea when it could
    J at V> be up again?

The maintainer at WU Vienna (Stefan, Kurt, Achim) have been alerted,
(by e-mail) but if they have connection problems, maybe e-mail
is not working either...

Martin Maechler, ETH Zurich


From mtmorgan at fhcrc.org  Wed Sep 16 14:30:22 2009
From: mtmorgan at fhcrc.org (mtmorgan at fhcrc.org)
Date: Wed, 16 Sep 2009 05:30:22 -0700
Subject: [Rd] I want to get a reference to this time series object
In-Reply-To: <fc212e850909160002l7fc94109l83333f0d00b350ff@mail.gmail.com>
References: <fc212e850909160002l7fc94109l83333f0d00b350ff@mail.gmail.com>
Message-ID: <20090916053022.thhnlbo0ys4soo4c@webmail.fhcrc.org>

Quoting Abhijit Bera <abhibera at gmail.com>:

> I'm trying to get a reference to this object in C
>
> SWX.RET[1:6,c("SBI,"SPI","SII")]
>
> While i am able to access and use a plain SWX.RET object, I'm getting
> confused on how to create an object with the array subscripts like above.
>
> Here is what I tried to do. It doesn't work because "[" is obviously not an
> operation or function on SWX.RET. So how do I get a reference to this
> object?
>
> #include <stdio.h>
> #include <R.h>
> #include <Rinternals.h>
> #include <Rdefines.h>
> #include <Rembedded.h>
>
> int main(int argc, char** argv)
> {
>
>     SEXP e,c,portSpec,portData,portConstr,portVal,tsAssets;
>     int errorOccurred,nx,ny,i,j;
>     double *v;
>     const char *x,*y;
>
>     Rf_initEmbeddedR(argc, argv);
>
>     // loading fPortfolio
>     PROTECT(e = lang2(install("library"), mkString("fPortfolio")));
>     R_tryEval(e, R_GlobalEnv, NULL);
>     UNPROTECT(1);
>
>
>     // creating a default portfolioSpec object
>     PROTECT(e=lang1(install("portfolioSpec")));
>     PROTECT(portSpec=R_tryEval(e,R_GlobalEnv, NULL));
>
>     // creating a portfolioData object
>
>
> PROTECT(e=lang4(install("c"),mkString("SBI"),mkString("SPI"),mkString("SII")));


Here you might just as well construct this at the C level

       SEXP idx_j = PROTECT(NEW_CHARACTER(3));
       SET_STRING_ELT(idx_j, 0, mkChar("SBI"));
       ...

(is a PROTECT necessary on mkChar? I don't think SET_STRING_ELT will  
allocate memory).

>     PROTECT(c=R_tryEval(e,R_GlobalEnv,NULL));
>
>     PROTECT(e=lang3(install("["),install("SWX.RET"),c));

Here the call you are trying for is "["(SWX.RET, i, j) so

       SEXP idx_i = PROTECT(NEW_INTEGER(6));
       for (i = 0; i < LENGTH(idx_i); ++i)
            INTEGER(idx_i)[i] = i + 1;

       PROTECT(e = lang4(install("["), install("SWX.RET"),
                         idx_i, idx_j));

or

       PROTECT(e = lang4(install("["), install("SWX.RET"),
                         R_MissingArg, idx_j));


While it would be straight-forward to use R_ParseVector to execute a  
string representing this command, presumably your real code will want  
to represent the subscripts (and object) as C variables and not  
hard-coded or user-supplied strings.

Martin

>     PROTECT(portData=R_tryEval(e,R_GlobalEnv,NULL));
>
>     PROTECT(e=lang2(install("print"),portData));
>     R_tryEval(e,R_GlobalEnv,NULL);
>
>
>     UNPROTECT(3);
>
>     Rf_endEmbeddedR(0);
>
>     return 0;
> }
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From abhibera at gmail.com  Wed Sep 16 15:23:31 2009
From: abhibera at gmail.com (Abhijit Bera)
Date: Wed, 16 Sep 2009 13:23:31 +0000
Subject: [Rd] I want to get a reference to this time series object
In-Reply-To: <20090916053022.thhnlbo0ys4soo4c@webmail.fhcrc.org>
References: <fc212e850909160002l7fc94109l83333f0d00b350ff@mail.gmail.com>
	<20090916053022.thhnlbo0ys4soo4c@webmail.fhcrc.org>
Message-ID: <fc212e850909160623he1d5a1amd743645b199cf294@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090916/b91c2922/attachment.pl>

From abhibera at gmail.com  Wed Sep 16 15:23:31 2009
From: abhibera at gmail.com (Abhijit Bera)
Date: Wed, 16 Sep 2009 13:23:31 +0000
Subject: [Rd] I want to get a reference to this time series object
In-Reply-To: <20090916053022.thhnlbo0ys4soo4c@webmail.fhcrc.org>
References: <fc212e850909160002l7fc94109l83333f0d00b350ff@mail.gmail.com>
	<20090916053022.thhnlbo0ys4soo4c@webmail.fhcrc.org>
Message-ID: <fc212e850909160623he1d5a1amd743645b199cf294@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090916/b91c2922/attachment-0001.pl>

From pleydell at supagro.inra.fr  Wed Sep 16 16:34:32 2009
From: pleydell at supagro.inra.fr (pleydell at supagro.inra.fr)
Date: Wed, 16 Sep 2009 16:34:32 +0200
Subject: [Rd] Building R package with .c sub-routine files
In-Reply-To: <D54A75FE-D6B4-4173-AFE3-A855CCD22ED4@epfl.ch>
References: <20090915200451.pcj3j24q168s048k@web.supagro.inra.fr>
	<D54A75FE-D6B4-4173-AFE3-A855CCD22ED4@epfl.ch>
Message-ID: <20090916163432.fbnaqwqz60oo4owk@web.supagro.inra.fr>

> Create a file named Makevars in the same directory and put the  
> following line in it:
>
> OBJECTS=file1.o
>
> Then R CMD SHLIB will only compile file1.c.
>
> Kjell

Great, that's done the job nicely.

Many thanks
David


From wdunlap at tibco.com  Wed Sep 16 17:30:11 2009
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 16 Sep 2009 08:30:11 -0700
Subject: [Rd] Building R package with .c sub-routine files
In-Reply-To: <20090916163432.fbnaqwqz60oo4owk@web.supagro.inra.fr>
References: <20090915200451.pcj3j24q168s048k@web.supagro.inra.fr><D54A75FE-D6B4-4173-AFE3-A855CCD22ED4@epfl.ch>
	<20090916163432.fbnaqwqz60oo4owk@web.supagro.inra.fr>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D70001CE5850@NA-PA-VBE03.na.tibco.com>

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of 
> pleydell at supagro.inra.fr
> Sent: Wednesday, September 16, 2009 7:35 AM
> To: Kjell Konis
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] Building R package with .c sub-routine files
> 
> > Create a file named Makevars in the same directory and put the  
> > following line in it:
> >
> > OBJECTS=file1.o
> >
> > Then R CMD SHLIB will only compile file1.c.
> >
> > Kjell
> 
> Great, that's done the job nicely.

Note that this will fail if your compiler makes object
files with a different suffix, say ".obj".  Using the
conventional '.h' for included files fixes this problem
and helps others understand your code more quickly.

Bill Dunlap
TIBCO Software Inc - Spotfire Division
wdunlap tibco.com  

> 
> Many thanks
> David
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From jmc at r-project.org  Wed Sep 16 18:50:29 2009
From: jmc at r-project.org (John Chambers)
Date: Wed, 16 Sep 2009 09:50:29 -0700
Subject: [Rd] S3 objects in S4 slots
In-Reply-To: <116117690909151723o466d0f9eh772f3d6dbffd7e90@mail.gmail.com>
References: <116117690909150300v4a703807se7b08b94c3f1a68d@mail.gmail.com>	<4AAF956B.7090704@fhcrc.org>
	<4AAFBA9C.5090502@r-project.org>
	<116117690909151723o466d0f9eh772f3d6dbffd7e90@mail.gmail.com>
Message-ID: <4AB11755.3010602@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090916/f7e0a905/attachment.pl>

From mwkimpel at gmail.com  Wed Sep 16 21:51:09 2009
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Wed, 16 Sep 2009 15:51:09 -0400
Subject: [Rd] 2.10.0 Under development (unstable) (2009-09-15 r49711) just
	built segfaults on Debian Squeeze
Message-ID: <6b93d1830909161251w2148379bg963a66dbbb931487@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090916/13fb0788/attachment.pl>

From simon.urbanek at r-project.org  Wed Sep 16 22:17:59 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 16 Sep 2009 16:17:59 -0400
Subject: [Rd] 2.10.0 Under development (unstable) (2009-09-15 r49711)
	just built segfaults on Debian Squeeze
In-Reply-To: <6b93d1830909161251w2148379bg963a66dbbb931487@mail.gmail.com>
References: <6b93d1830909161251w2148379bg963a66dbbb931487@mail.gmail.com>
Message-ID: <8C23E5DA-9783-4C17-B622-A9E4F1370754@r-project.org>

Mark,

On Sep 16, 2009, at 15:51 , Mark Kimpel wrote:

> I just downloaded R-devel and when loaded it immediately segfaults.  
> I'm not
> sure how much or what sort of diagnostic info and can provide,

At the very least something like
R -d gdb
and the output of bt would be helpful. Then in general things like the  
exact compilers used are needed, especially on "testing" Linux (note  
that you probably don't want to use anything more recent then gcc 4.3  
due to bugs). Also it's a good idea to run make check before make  
install ...

The script you supplied (and the resulting R) works just fine for me  
on lenny (modulo the --prefix).

Cheers,
Simon


> but below is
> my build script, my console output, and the output of uname -r. I am
> currently dependent on the development version of a package, so I'd  
> like to
> get R-devel up and running if possible. I am sure there is more info  
> I can
> provide, but before deluging the list with unnecessary output, I  
> thought I
> would ask first what would be helpfu. Mark
>
> #Make R
> cd ~/R_HOME
> wget ftp://ftp.stat.math.ethz.ch/Software/R/R-devel.tar.gz
> tar -xzf R-devel.tar.gz
> cd ~/R_HOME/R-devel
> mkdir R-build
> cd R-build
> ../configure --prefix=/home/mkimpel/R_HOME/R-devel/R-build
> make all
> make install
>
> #####################################33
> # console output
> mkimpel-XPS ~/R_HOME/R-devel/R-build/bin: ./R
>
> R version 2.10.0 Under development (unstable) (2009-09-15 r49711)
> Copyright (C) 2009 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
>  Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
>
>
> *** caught segfault ***
> address (nil), cause 'memory not mapped'
>
> Possible actions:
> 1: abort (with core dump, if enabled)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> Selection: 2
> Save workspace image? [y/n/c]: n
>
> ######################################
> # kernel version
> mkimpel-XPS ~/R_HOME/R-devel/R-build/bin: uname -r
> 2.6.30-1-amd64
> mkimpel-XPS ~/R_HOME/R-devel/R-build/bin:
>
>
> Mark W. Kimpel MD  ** Neuroinformatics ** Dept. of Psychiatry
> Indiana University School of Medicine
>
> 15032 Hunter Court, Westfield, IN  46074
>
> (317) 490-5129 Work, & Mobile & VoiceMail
> (317) 399-1219 Skype No Voicemail please
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From p.dalgaard at biostat.ku.dk  Wed Sep 16 22:45:59 2009
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed, 16 Sep 2009 22:45:59 +0200
Subject: [Rd] 2.10.0 Under development (unstable) (2009-09-15 r49711)
 just	built segfaults on Debian Squeeze
In-Reply-To: <6b93d1830909161251w2148379bg963a66dbbb931487@mail.gmail.com>
References: <6b93d1830909161251w2148379bg963a66dbbb931487@mail.gmail.com>
Message-ID: <4AB14E87.6080608@biostat.ku.dk>

Mark Kimpel wrote:
> I just downloaded R-devel and when loaded it immediately segfaults. I'm not
> sure how much or what sort of diagnostic info and can provide, but below is
> my build script, my console output, and the output of uname -r. I am
> currently dependent on the development version of a package, so I'd like to
> get R-devel up and running if possible. I am sure there is more info I can
> provide, but before deluging the list with unnecessary output, I thought I
> would ask first what would be helpfu. Mark

Not happening for me with 49727 (SUSE 64bit).

Do you have a saved workspace in that dir by any chance?

Could you try

R --vanilla

and

R -d gdb
followed by "run" and "bt" on the segfault

> #Make R
> cd ~/R_HOME
> wget ftp://ftp.stat.math.ethz.ch/Software/R/R-devel.tar.gz
> tar -xzf R-devel.tar.gz
> cd ~/R_HOME/R-devel
> mkdir R-build
> cd R-build
> ../configure --prefix=/home/mkimpel/R_HOME/R-devel/R-build
> make all
> make install
> 
> #####################################33
> # console output
> mkimpel-XPS ~/R_HOME/R-devel/R-build/bin: ./R
> 
> R version 2.10.0 Under development (unstable) (2009-09-15 r49711)
> Copyright (C) 2009 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
> 
>   Natural language support but running in an English locale
> 
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
> 
> 
>  *** caught segfault ***
> address (nil), cause 'memory not mapped'
> 
> Possible actions:
> 1: abort (with core dump, if enabled)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> Selection: 2
> Save workspace image? [y/n/c]: n
> 
> ######################################
> # kernel version
> mkimpel-XPS ~/R_HOME/R-devel/R-build/bin: uname -r
> 2.6.30-1-amd64
> mkimpel-XPS ~/R_HOME/R-devel/R-build/bin:
> 
> 
> Mark W. Kimpel MD  ** Neuroinformatics ** Dept. of Psychiatry
> Indiana University School of Medicine
> 
> 15032 Hunter Court, Westfield, IN  46074
> 
> (317) 490-5129 Work, & Mobile & VoiceMail
> (317) 399-1219 Skype No Voicemail please
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From murdoch at stats.uwo.ca  Thu Sep 17 01:04:01 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 16 Sep 2009 19:04:01 -0400
Subject: [Rd] S3 objects in S4 slots
In-Reply-To: <4AB11755.3010602@r-project.org>
References: <116117690909150300v4a703807se7b08b94c3f1a68d@mail.gmail.com>	<4AAF956B.7090704@fhcrc.org>	<4AAFBA9C.5090502@r-project.org>	<116117690909151723o466d0f9eh772f3d6dbffd7e90@mail.gmail.com>
	<4AB11755.3010602@r-project.org>
Message-ID: <4AB16EE1.8000509@stats.uwo.ca>

On 16/09/2009 12:50 PM, John Chambers wrote:
> Martin Kober wrote:
>> 2009/9/15 John Chambers <jmc at r-project.org>:
>>   
>>> I'll look at this in more detail (though not for a few days), but the
>>> essence I think is that nothing in the current version allows one to say the
>>> S3 equivalent of
>>>
>>> setClass("VCorpus", contains = "list", ....)
>>>
>>> Seems a (minor, I hope) glitch that what Martin K.  tried didn't work:
>>>    setOldClass(c("VCorpus", "Corpus", "list"))
>>>
>>> As far as I can see, setOldClass() should understand the basic data types as
>>> valid superclasses.
>>>     
>> That would be really useful.
>>
>> Do you think it would be feasible to automatically assume that all S3
>> objects "contain" their basic data type (like a list, in this case)
>> for purposes of S4 class matching, when no other information is given?
>>   
> That doesn't seem desirable, in general, unless there's a strong 
> argument for it.
> 
> 1.  It's not always the case that S3 classes should be thought of as 
> vectors of their object type.  The classes such as "lm" that use named 
> list components instead of attributes were not intended to be used as 
> list vectors.  For example, if
>   z <- lm(....)
> then z[1:2] is not really meaningful, and is(z, "list") should probably 
> be FALSE, as it currently is. 

I would disagree about this.  We do expect z$coefficients to work, not 
just coefficients(z); the former only works because z is a list. 
Similarly, z[["coefficients"]].  Now, I wouldn't likely ever type 
z[1:2], but I can see doing computations on the names and using a 
numeric index to subset z.

  S3 classes of this style are more like S4
> classes with no data part, and object type "S4".
> 
> 2. Restricting the revision to setOldClass() leads to a clean concept, 
> and makes the S3 class more compatible with S4 classes.   The proposal 
> at the moment is to interpret the setOldClass call much like the 
> corresponding setClass() call above.  The included "list" would be 
> examined to see if it was a valid "data part" in S4 terms. That's a 
> little more general than just giving an object type.  The implementation 
> and interpretation are then simple, and the result should be consistent 
> with the treatment of similar S4 classes.
>> At least in this specific case, the idea is that corpus objects can be
>> used as a list of character vectors and code does not need to know
>> anything about the object structure as long as only the contents of
>> the list are needed. So (again, in this specific case), I would
>> consider "defaulting" to the underlying data type optimal.
>>
>>   
>>> Martin Morgan's code is indeed a workaround.  And as Martin Maechler
>>> commented, the intention is to make S3 and S4 classes play together as much
>>> as possible.

I didn't comment on this before, because I think that's a good 
intention, and I think users appreciate all the work you're doing to 
bring it about:  but I'd still stick by my advice not to mix S3 and S4. 
  As a general principle it's better to keep your programming life 
simple.  Don't take advantage of every feature the language offers, work 
within a subset, where you're sure you understand how everything works. 
  Someone like you or either Martin M. has a deep enough knowledge of S3 
and S4 and how they interact to get away with mixing them, but most 
users don't.

The original question came up because Martin K., working with S4 
objects, wanted to make use of an object from a package that used S3.  I 
still think he would have been better off to spend a little bit of time 
writing the function to convert the S3 object into an S4 object, and 
then never having to worry again about the intricacies of how S4 
inheritance interacts with S3 inheritance.

Duncan Murdoch

>>>
>>>     
>> Thanks to Martin Morgan for the workaround, it works very well.
>>
>>   
>>> Morgan wrote:
>>>
>>> Hi Martin Kober --
>>> Martin Kober wrote:
>>>
>>>
>>> Hello,
>>> I am the maintainer of the stringkernels package and have come across
>>> a problem with using S3 objects in my S4 classes.
>>> Specifically, I have an S4 class with a slot that takes a text corpus
>>> as a list of character vectors. tm (version 0.5) saves corpora as
>>> lists with a class attribute of c("VCorpus", "Corpus", "list"). I
>>> don't actually need the class-specific attributes, I only care about
>>> the list itself.
>>> Here's a simplified example of my problem:
>>>
>>>
>>> setClass("testclass", representation(slot="list"))
>>>
>>>
>>> [1] "testclass"
>>>
>>>
>>> a = list(a="1", b="2")
>>> class(a) = c("VCorpus", "Corpus", "list") # same as corpora in tm v0.5
>>>
>>>
>>> This has the feel of a workaround, but
>>> setOldClass(class(a)[1:2]); setIs("Corpus", "list")
>>> helps here, first registering c('vCorpus', 'Corpus') as an S3 hierarchy
>>> and then defining the relationship between the root of the hierarchy and
>>> (the S4 class) 'list'.
>>> Martin (Morgan)
>>>
>>>
>>> x = new("testclass", slot=a)
>>>
>>>
>>> Error in validObject(.Object) :
>>>   invalid class "testclass" object: 1: invalid object for slot "slot"
>>> in class "testclass": got class "VCorpus", should be or extend class
>>> "list"
>>> invalid class "testclass" object: 2: invalid object for slot "slot" in
>>> class "testclass": got class "Corpus", should be or extend class
>>> "list"
>>> invalid class "testclass" object: 3: invalid object for slot "slot" in
>>> class "testclass": got class "list", should be or extend class "list"
>>> The last line is a bit confusing here (``got class "list", should be
>>> or extend class "list"''). There's an even more confusing error
>>> message when I try to assign the slot later on:
>>>
>>>
>>> y = new("testclass")
>>> y at slot = a
>>>
>>>
>>> Error in checkSlotAssignment(object, name, value) :
>>>   c("assignment of an object of class \"VCorpus\" is not valid for
>>> slot \"slot\" in an object of class \"testclass\"; is(value, \"list\")
>>> is not TRUE", "assignment of an object of class \"Corpus\" is not
>>> valid for slot \"slot\" in an object of class \"testclass\"; is(value,
>>> \"list\") is not TRUE", "assignment of an object of class \"list\" is
>>> not valid for slot \"slot\" in an object of class \"testclass\";
>>> is(value, \"list\") is not TRUE")
>>> The last part of the message claims that ``is(value, "list") is not
>>> TRUE'', but is(a, "list") is certainly TRUE. (??)
>>> On a side note, it does work when "list" is the first entry in class().
>>> I tried to use setOldClass, but seemingly using list is not possible
>>> because it does not extend oldClass, or I didn't find out how to do
>>> it:
>>>
>>>
>>> setOldClass(c("VCorpus", "Corpus", "list"))
>>>
>>>
>>> Error in setOldClass(c("VCorpus", "Corpus", "list")) :
>>>   inconsistent old-style class information for "list"; the class is
>>> defined but does not extend "oldClass"
>>> Intuitively I would have thought that, because the underlying data is
>>> of type list, it would "fit" into an object slot requiring a list,
>>> irrespective of S3 class attributes. The only thing I can think of is
>>> a manual solution removing the class attribute.
>>> Is there a way to define lists with S3 class attributes such that they
>>> are accepted as lists in S4 object slots? Or any other ways to solve
>>> this?
>>> Thanks in advance
>>> Best Regards
>>> Martin
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>     
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>   
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From mwkimpel at gmail.com  Thu Sep 17 01:48:47 2009
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Wed, 16 Sep 2009 19:48:47 -0400
Subject: [Rd] 2.10.0 Under development (unstable) (2009-09-15 r49711)
	just built segfaults on Debian Squeeze
In-Reply-To: <4AB14E87.6080608@biostat.ku.dk>
References: <6b93d1830909161251w2148379bg963a66dbbb931487@mail.gmail.com>
	<4AB14E87.6080608@biostat.ku.dk>
Message-ID: <6b93d1830909161648p66b194ffm1a54eda946a17f24@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090916/3bd543df/attachment.pl>

From jmc at r-project.org  Thu Sep 17 02:07:58 2009
From: jmc at r-project.org (John Chambers)
Date: Wed, 16 Sep 2009 17:07:58 -0700
Subject: [Rd] S3 objects in S4 slots
In-Reply-To: <4AB16EE1.8000509@stats.uwo.ca>
References: <116117690909150300v4a703807se7b08b94c3f1a68d@mail.gmail.com>	<4AAF956B.7090704@fhcrc.org>	<4AAFBA9C.5090502@r-project.org>	<116117690909151723o466d0f9eh772f3d6dbffd7e90@mail.gmail.com>	<4AB11755.3010602@r-project.org>
	<4AB16EE1.8000509@stats.uwo.ca>
Message-ID: <4AB17DDE.8060901@r-project.org>

Duncan Murdoch wrote:
> On 16/09/2009 12:50 PM, John Chambers wrote:
> <snip>
>> 2. Restricting the revision to setOldClass() leads to a clean 
>> concept, and makes the S3 class more compatible with S4 classes.   
>> The proposal at the moment is to interpret the setOldClass call much 
>> like the corresponding setClass() call above.  The included "list" 
>> would be examined to see if it was a valid "data part" in S4 terms. 
>> That's a little more general than just giving an object type.  The 
>> implementation and interpretation are then simple, and the result 
>> should be consistent with the treatment of similar S4 classes.
>>> At least in this specific case, the idea is that corpus objects can be
>>> used as a list of character vectors and code does not need to know
>>> anything about the object structure as long as only the contents of
>>> the list are needed. So (again, in this specific case), I would
>>> consider "defaulting" to the underlying data type optimal.
>>>
>>>  
>>>> Martin Morgan's code is indeed a workaround.  And as Martin Maechler
>>>> commented, the intention is to make S3 and S4 classes play together 
>>>> as much
>>>> as possible.
>
> I didn't comment on this before, because I think that's a good 
> intention, and I think users appreciate all the work you're doing to 
> bring it about:  but I'd still stick by my advice not to mix S3 and 
> S4.  As a general principle it's better to keep your programming life 
> simple.  Don't take advantage of every feature the language offers, 
> work within a subset, where you're sure you understand how everything 
> works.  Someone like you or either Martin M. has a deep enough 
> knowledge of S3 and S4 and how they interact to get away with mixing 
> them, but most users don't.
>
> The original question came up because Martin K., working with S4 
> objects, wanted to make use of an object from a package that used S3.  
> I still think he would have been better off to spend a little bit of 
> time writing the function to convert the S3 object into an S4 object, 
> and then never having to worry again about the intricacies of how S4 
> inheritance interacts with S3 inheritance.

But if the S3 class lives in someone else's package we will now have two 
versions with all the well-known headaches that causes.  In  practice, 
your advice ends up being a way of discouraging the use of S4 classes 
since there are so many legacy S3 classes.

(BTW somewhat in contrast to how I felt at one time, I'm not trying to 
dump on S3 classes, after all I'm to blame for much of what's in them.  
They are a more casual way to deal with some basic ideas and have a 
lower learning barrier.  But we didn't provide the material for as 
general or as trustworthy programming with them, so one hopes that users 
will feel able to move on as they get deeper into their projects.)

Nobody is forcing people to take advantage of the increased 
compatibility but let's try to sort out any problems, as Martin Kober 
did here, rather than discouraging the effort.

John
>
> Duncan Murdoch
>
>>>>
>>>>     
>>> Thanks to Martin Morgan for the workaround, it works very well.
>>>
>>>  
>>>> Morgan wrote:
>>>>
>>>> Hi Martin Kober --
>>>> Martin Kober wrote:
>>>>
>>>>
>>>> Hello,
>>>> I am the maintainer of the stringkernels package and have come across
>>>> a problem with using S3 objects in my S4 classes.
>>>> Specifically, I have an S4 class with a slot that takes a text corpus
>>>> as a list of character vectors. tm (version 0.5) saves corpora as
>>>> lists with a class attribute of c("VCorpus", "Corpus", "list"). I
>>>> don't actually need the class-specific attributes, I only care about
>>>> the list itself.
>>>> Here's a simplified example of my problem:
>>>>
>>>>
>>>> setClass("testclass", representation(slot="list"))
>>>>
>>>>
>>>> [1] "testclass"
>>>>
>>>>
>>>> a = list(a="1", b="2")
>>>> class(a) = c("VCorpus", "Corpus", "list") # same as corpora in tm v0.5
>>>>
>>>>
>>>> This has the feel of a workaround, but
>>>> setOldClass(class(a)[1:2]); setIs("Corpus", "list")
>>>> helps here, first registering c('vCorpus', 'Corpus') as an S3 
>>>> hierarchy
>>>> and then defining the relationship between the root of the 
>>>> hierarchy and
>>>> (the S4 class) 'list'.
>>>> Martin (Morgan)
>>>>
>>>>
>>>> x = new("testclass", slot=a)
>>>>
>>>>
>>>> Error in validObject(.Object) :
>>>>   invalid class "testclass" object: 1: invalid object for slot "slot"
>>>> in class "testclass": got class "VCorpus", should be or extend class
>>>> "list"
>>>> invalid class "testclass" object: 2: invalid object for slot "slot" in
>>>> class "testclass": got class "Corpus", should be or extend class
>>>> "list"
>>>> invalid class "testclass" object: 3: invalid object for slot "slot" in
>>>> class "testclass": got class "list", should be or extend class "list"
>>>> The last line is a bit confusing here (``got class "list", should be
>>>> or extend class "list"''). There's an even more confusing error
>>>> message when I try to assign the slot later on:
>>>>
>>>>
>>>> y = new("testclass")
>>>> y at slot = a
>>>>
>>>>
>>>> Error in checkSlotAssignment(object, name, value) :
>>>>   c("assignment of an object of class \"VCorpus\" is not valid for
>>>> slot \"slot\" in an object of class \"testclass\"; is(value, \"list\")
>>>> is not TRUE", "assignment of an object of class \"Corpus\" is not
>>>> valid for slot \"slot\" in an object of class \"testclass\"; is(value,
>>>> \"list\") is not TRUE", "assignment of an object of class \"list\" is
>>>> not valid for slot \"slot\" in an object of class \"testclass\";
>>>> is(value, \"list\") is not TRUE")
>>>> The last part of the message claims that ``is(value, "list") is not
>>>> TRUE'', but is(a, "list") is certainly TRUE. (??)
>>>> On a side note, it does work when "list" is the first entry in 
>>>> class().
>>>> I tried to use setOldClass, but seemingly using list is not possible
>>>> because it does not extend oldClass, or I didn't find out how to do
>>>> it:
>>>>
>>>>
>>>> setOldClass(c("VCorpus", "Corpus", "list"))
>>>>
>>>>
>>>> Error in setOldClass(c("VCorpus", "Corpus", "list")) :
>>>>   inconsistent old-style class information for "list"; the class is
>>>> defined but does not extend "oldClass"
>>>> Intuitively I would have thought that, because the underlying data is
>>>> of type list, it would "fit" into an object slot requiring a list,
>>>> irrespective of S3 class attributes. The only thing I can think of is
>>>> a manual solution removing the class attribute.
>>>> Is there a way to define lists with S3 class attributes such that they
>>>> are accepted as lists in S4 object slots? Or any other ways to solve
>>>> this?
>>>> Thanks in advance
>>>> Best Regards
>>>> Martin
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>     
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>   
>>
>>     [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From murdoch at stats.uwo.ca  Thu Sep 17 02:07:49 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 16 Sep 2009 20:07:49 -0400
Subject: [Rd] 2.10.0 Under development (unstable) (2009-09-15 r49711)
 just built segfaults on Debian Squeeze
In-Reply-To: <6b93d1830909161648p66b194ffm1a54eda946a17f24@mail.gmail.com>
References: <6b93d1830909161251w2148379bg963a66dbbb931487@mail.gmail.com>	<4AB14E87.6080608@biostat.ku.dk>
	<6b93d1830909161648p66b194ffm1a54eda946a17f24@mail.gmail.com>
Message-ID: <4AB17DD5.3030809@stats.uwo.ca>

On 16/09/2009 7:48 PM, Mark Kimpel wrote:
> Peter,
> 
> I have not yet tried Simon's suggestion of using gcc 4.3 (just got back from
> a meeting), but running your commands produces the output below. As you can
> see, R --vanilla works, but just plain "R" doesn't. See the results of gdb
> far below.

That's helpful.  It died in the parser while trying to read your user 
profile.  I can't tell what file it was trying to read, but the order it 
tries them is as follows:

If you have R_PROFILE_USER set, it tries to read the file named there.

It tries to read .Rprofile in the current directory.

If you have HOME set, it tries to read .Rprofile in that directory.

It appears that you found a bug in the parser while trying to read that 
file:  you shouldn't be able to get a segfault, at worst you should get 
a syntax error.

Can you work out what file it read, and send me a copy?  I'd like to 
track this down.

Duncan Murdoch

> 
> I do not have a saved workspace in my R_HOME or any of its subdirectories.
> 
> Will report back on what I get with gcc 4.3 just as soon as I read the
> R-admin manual and figure out how to get configure configured....
> 
> Mark
> 
> 
> mkimpel-XPS ~/sshfs: R --vanilla
> 
> R version 2.10.0 Under development (unstable) (2009-09-15 r49711)
> Copyright (C) 2009 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
> 
>   Natural language support but running in an English locale
> 
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
> 
>> q()
> mkimpel-XPS ~/sshfs: R
> 
> R version 2.10.0 Under development (unstable) (2009-09-15 r49711)
> Copyright (C) 2009 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
> 
>   Natural language support but running in an English locale
> 
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
> 
> 
>  *** caught segfault ***
> address (nil), cause 'memory not mapped'
> 
> Possible actions:
> 1: abort (with core dump, if enabled)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> Selection: 4
> mkimpel-XPS ~/sshfs: R -d gdb
> GNU gdb (GDB) 6.8.50.20090628-cvs-debian
> Copyright (C) 2009 Free Software Foundation, Inc.
> License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html
> This is free software: you are free to change and redistribute it.
> There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
> and "show warranty" for details.
> This GDB was configured as "x86_64-linux-gnu".
> For bug reporting instructions, please see:
> <http://www.gnu.org/software/gdb/bugs/>...
> (gdb) run
> Starting program: /home/mkimpel/R_HOME/R-devel/R-build/lib64/R/bin/exec/R
> 
> R version 2.10.0 Under development (unstable) (2009-09-15 r49711)
> Copyright (C) 2009 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
> 
>   Natural language support but running in an English locale
> 
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
> 
> 
> Program received signal SIGSEGV, Segmentation fault.
> Rf_setAttrib (vec=0x12e3d68, name=0x94d450, val=0x0) at
> ../../../src/main/attrib.c:226
> 226        if (NAMED(val)) val = duplicate(val);
> (gdb) bt
> #0  Rf_setAttrib (vec=0x12e3d68, name=0x94d450, val=0x0) at
> ../../../src/main/attrib.c:226
> #1  0x000000000056264f in xxexprlist1 () at gram.y:574
> #2  Rf_yyparse () at gram.y:337
> #3  0x0000000000563469 in R_Parse1 (status=0x94d450) at gram.y:1126
> #4  0x0000000000563cfb in R_Parse1File (fp=0x1200920, gencode=1,
> status=0x7fffffffcd94, first=<value optimized out>) at gram.y:1164
> #5  0x0000000000416cb2 in R_ReplFile (fp=0x1200920, rho=0x973338,
> savestack=0, browselevel=<value optimized out>) at
> ../../../src/main/main.c:87
> #6  0x0000000000416e08 in R_LoadProfile (fparg=<value optimized out>,
> env=0x973338) at ../../../src/main/main.c:651
> #7  0x00000000004172c2 in setup_Rmainloop () at ../../../src/main/main.c:875
> #8  0x00000000004185c9 in Rf_mainloop () at ../../../src/main/main.c:967
> #9  0x0000000000415c38 in main (ac=<value optimized out>, av=<value
> optimized out>) at ../../../src/main/Rmain.c:33
> #10 0x00007ffff6ed05c6 in __libc_start_main () from /lib/libc.so.6
> #11 0x0000000000415b29 in _start () at ../sysdeps/x86_64/elf/start.S:113
> (gdb)
> 
> Mark W. Kimpel MD  ** Neuroinformatics ** Dept. of Psychiatry
> Indiana University School of Medicine
> 
> 15032 Hunter Court, Westfield, IN  46074
> 
> (317) 490-5129 Work, & Mobile & VoiceMail
> (317) 399-1219 Skype No Voicemail please
> 
> 
> On Wed, Sep 16, 2009 at 4:45 PM, Peter Dalgaard <p.dalgaard at biostat.ku.dk>wrote:
> 
>> Mark Kimpel wrote:
>>
>>> I just downloaded R-devel and when loaded it immediately segfaults. I'm
>>> not
>>> sure how much or what sort of diagnostic info and can provide, but below
>>> is
>>> my build script, my console output, and the output of uname -r. I am
>>> currently dependent on the development version of a package, so I'd like
>>> to
>>> get R-devel up and running if possible. I am sure there is more info I can
>>> provide, but before deluging the list with unnecessary output, I thought I
>>> would ask first what would be helpfu. Mark
>>>
>> Not happening for me with 49727 (SUSE 64bit).
>>
>> Do you have a saved workspace in that dir by any chance?
>>
>> Could you try
>>
>> R --vanilla
>>
>> and
>>
>> R -d gdb
>> followed by "run" and "bt" on the segfault
>>
>>  #Make R
>>> cd ~/R_HOME
>>> wget ftp://ftp.stat.math.ethz.ch/Software/R/R-devel.tar.gz
>>> tar -xzf R-devel.tar.gz
>>> cd ~/R_HOME/R-devel
>>> mkdir R-build
>>> cd R-build
>>> ../configure --prefix=/home/mkimpel/R_HOME/R-devel/R-build
>>> make all
>>> make install
>>>
>>> #####################################33
>>> # console output
>>> mkimpel-XPS ~/R_HOME/R-devel/R-build/bin: ./R
>>>
>>> R version 2.10.0 Under development (unstable) (2009-09-15 r49711)
>>> Copyright (C) 2009 The R Foundation for Statistical Computing
>>> ISBN 3-900051-07-0
>>>
>>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>>> You are welcome to redistribute it under certain conditions.
>>> Type 'license()' or 'licence()' for distribution details.
>>>
>>>  Natural language support but running in an English locale
>>>
>>> R is a collaborative project with many contributors.
>>> Type 'contributors()' for more information and
>>> 'citation()' on how to cite R or R packages in publications.
>>>
>>> Type 'demo()' for some demos, 'help()' for on-line help, or
>>> 'help.start()' for an HTML browser interface to help.
>>> Type 'q()' to quit R.
>>>
>>>
>>>  *** caught segfault ***
>>> address (nil), cause 'memory not mapped'
>>>
>>> Possible actions:
>>> 1: abort (with core dump, if enabled)
>>> 2: normal R exit
>>> 3: exit R without saving workspace
>>> 4: exit R saving workspace
>>> Selection: 2
>>> Save workspace image? [y/n/c]: n
>>>
>>> ######################################
>>> # kernel version
>>> mkimpel-XPS ~/R_HOME/R-devel/R-build/bin: uname -r
>>> 2.6.30-1-amd64
>>> mkimpel-XPS ~/R_HOME/R-devel/R-build/bin:
>>>
>>>
>>> Mark W. Kimpel MD  ** Neuroinformatics ** Dept. of Psychiatry
>>> Indiana University School of Medicine
>>>
>>> 15032 Hunter Court, Westfield, IN  46074
>>>
>>> (317) 490-5129 Work, & Mobile & VoiceMail
>>> (317) 399-1219 Skype No Voicemail please
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>> --
>>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>>  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
>> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907
>>
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> ------------------------------------------------------------------------
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From mwkimpel at gmail.com  Thu Sep 17 02:18:05 2009
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Wed, 16 Sep 2009 20:18:05 -0400
Subject: [Rd] 2.10.0 Under development (unstable) (2009-09-15 r49711)
	just built segfaults on Debian Squeeze
In-Reply-To: <A3CD7945-CDB5-4ACA-8608-EF7B10E916E5@r-project.org>
References: <6b93d1830909161251w2148379bg963a66dbbb931487@mail.gmail.com>
	<4AB14E87.6080608@biostat.ku.dk>
	<6b93d1830909161648p66b194ffm1a54eda946a17f24@mail.gmail.com>
	<A3CD7945-CDB5-4ACA-8608-EF7B10E916E5@r-project.org>
Message-ID: <6b93d1830909161718m2cc44a6dqf37f723e9660f7bc@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090916/77da1e56/attachment.pl>

From mwkimpel at gmail.com  Thu Sep 17 02:46:06 2009
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Wed, 16 Sep 2009 20:46:06 -0400
Subject: [Rd] 2.10.0 Under development (unstable) (2009-09-15 r49711)
	just built segfaults on Debian Squeeze
In-Reply-To: <4AB17DD5.3030809@stats.uwo.ca>
References: <6b93d1830909161251w2148379bg963a66dbbb931487@mail.gmail.com>
	<4AB14E87.6080608@biostat.ku.dk>
	<6b93d1830909161648p66b194ffm1a54eda946a17f24@mail.gmail.com>
	<4AB17DD5.3030809@stats.uwo.ca>
Message-ID: <6b93d1830909161746v110d7bf5ued79c024c3c7ee26@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090916/482ccba4/attachment.pl>

From murdoch at stats.uwo.ca  Thu Sep 17 03:14:13 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 16 Sep 2009 21:14:13 -0400
Subject: [Rd] 2.10.0 Under development (unstable) (2009-09-15 r49711)
 just built segfaults on Debian Squeeze
In-Reply-To: <6b93d1830909161746v110d7bf5ued79c024c3c7ee26@mail.gmail.com>
References: <6b93d1830909161251w2148379bg963a66dbbb931487@mail.gmail.com>	
	<4AB14E87.6080608@biostat.ku.dk>	
	<6b93d1830909161648p66b194ffm1a54eda946a17f24@mail.gmail.com>	
	<4AB17DD5.3030809@stats.uwo.ca>
	<6b93d1830909161746v110d7bf5ued79c024c3c7ee26@mail.gmail.com>
Message-ID: <4AB18D65.1050307@stats.uwo.ca>

On 16/09/2009 8:46 PM, Mark Kimpel wrote:
> Okay, now that I knew what to look at, I've narrowed to the problem down 
> to the line
> 'source("~/R.functions/General_Functions/my.update.packages.func.R")'

Never mind my other request, I've got it now.  I'm not sure what's going 
wrong, but I can reproduce the crash, so I should be able to track it 
down and fix it.  Thanks for all the info!

Duncan Murdoch

> 
> if just this line is commented out, R loads fine. If not, it crashes 
> reliably. Interestingly, if commented out, once R is loaded, the 
> function loads into R just fine and in facts runs as intended. So, 
> perhaps there is something in the way R is sourcing the file or with the 
> source command itself?
> 
> Thanks for helping me to figure this out, let me know if there is 
> anything specific you want me to try.
> 
> Mark
> 
> Mark W. Kimpel MD  ** Neuroinformatics ** Dept. of Psychiatry
> Indiana University School of Medicine
> 
> 15032 Hunter Court, Westfield, IN  46074
> 
> (317) 490-5129 Work, & Mobile & VoiceMail
> (317) 399-1219 Skype No Voicemail please
> 
> 
> On Wed, Sep 16, 2009 at 8:07 PM, Duncan Murdoch <murdoch at stats.uwo.ca 
> <mailto:murdoch at stats.uwo.ca>> wrote:
> 
>     On 16/09/2009 7:48 PM, Mark Kimpel wrote:
> 
>         Peter,
> 
>         I have not yet tried Simon's suggestion of using gcc 4.3 (just
>         got back from
>         a meeting), but running your commands produces the output below.
>         As you can
>         see, R --vanilla works, but just plain "R" doesn't. See the
>         results of gdb
>         far below.
> 
> 
>     That's helpful.  It died in the parser while trying to read your
>     user profile.  I can't tell what file it was trying to read, but the
>     order it tries them is as follows:
> 
>     If you have R_PROFILE_USER set, it tries to read the file named there.
> 
>     It tries to read .Rprofile in the current directory.
> 
>     If you have HOME set, it tries to read .Rprofile in that directory.
> 
>     It appears that you found a bug in the parser while trying to read
>     that file:  you shouldn't be able to get a segfault, at worst you
>     should get a syntax error.
> 
>     Can you work out what file it read, and send me a copy?  I'd like to
>     track this down.
> 
>     Duncan Murdoch
> 
> 
> 
>         I do not have a saved workspace in my R_HOME or any of its
>         subdirectories.
> 
>         Will report back on what I get with gcc 4.3 just as soon as I
>         read the
>         R-admin manual and figure out how to get configure configured....
> 
>         Mark
> 
> 
>         mkimpel-XPS ~/sshfs: R --vanilla
> 
>         R version 2.10.0 Under development (unstable) (2009-09-15 r49711)
>         Copyright (C) 2009 The R Foundation for Statistical Computing
>         ISBN 3-900051-07-0
> 
>         R is free software and comes with ABSOLUTELY NO WARRANTY.
>         You are welcome to redistribute it under certain conditions.
>         Type 'license()' or 'licence()' for distribution details.
> 
>          Natural language support but running in an English locale
> 
>         R is a collaborative project with many contributors.
>         Type 'contributors()' for more information and
>         'citation()' on how to cite R or R packages in publications.
> 
>         Type 'demo()' for some demos, 'help()' for on-line help, or
>         'help.start()' for an HTML browser interface to help.
>         Type 'q()' to quit R.
> 
>             q()
> 
>         mkimpel-XPS ~/sshfs: R
> 
>         R version 2.10.0 Under development (unstable) (2009-09-15 r49711)
>         Copyright (C) 2009 The R Foundation for Statistical Computing
>         ISBN 3-900051-07-0
> 
>         R is free software and comes with ABSOLUTELY NO WARRANTY.
>         You are welcome to redistribute it under certain conditions.
>         Type 'license()' or 'licence()' for distribution details.
> 
>          Natural language support but running in an English locale
> 
>         R is a collaborative project with many contributors.
>         Type 'contributors()' for more information and
>         'citation()' on how to cite R or R packages in publications.
> 
>         Type 'demo()' for some demos, 'help()' for on-line help, or
>         'help.start()' for an HTML browser interface to help.
>         Type 'q()' to quit R.
> 
> 
>          *** caught segfault ***
>         address (nil), cause 'memory not mapped'
> 
>         Possible actions:
>         1: abort (with core dump, if enabled)
>         2: normal R exit
>         3: exit R without saving workspace
>         4: exit R saving workspace
>         Selection: 4
>         mkimpel-XPS ~/sshfs: R -d gdb
>         GNU gdb (GDB) 6.8.50.20090628-cvs-debian
>         Copyright (C) 2009 Free Software Foundation, Inc.
>         License GPLv3+: GNU GPL version 3 or later
>         <http://gnu.org/licenses/gpl.html
>         This is free software: you are free to change and redistribute it.
>         There is NO WARRANTY, to the extent permitted by law.  Type
>         "show copying"
>         and "show warranty" for details.
>         This GDB was configured as "x86_64-linux-gnu".
>         For bug reporting instructions, please see:
>         <http://www.gnu.org/software/gdb/bugs/>...
>         (gdb) run
>         Starting program:
>         /home/mkimpel/R_HOME/R-devel/R-build/lib64/R/bin/exec/R
> 
>         R version 2.10.0 Under development (unstable) (2009-09-15 r49711)
>         Copyright (C) 2009 The R Foundation for Statistical Computing
>         ISBN 3-900051-07-0
> 
>         R is free software and comes with ABSOLUTELY NO WARRANTY.
>         You are welcome to redistribute it under certain conditions.
>         Type 'license()' or 'licence()' for distribution details.
> 
>          Natural language support but running in an English locale
> 
>         R is a collaborative project with many contributors.
>         Type 'contributors()' for more information and
>         'citation()' on how to cite R or R packages in publications.
> 
>         Type 'demo()' for some demos, 'help()' for on-line help, or
>         'help.start()' for an HTML browser interface to help.
>         Type 'q()' to quit R.
> 
> 
>         Program received signal SIGSEGV, Segmentation fault.
>         Rf_setAttrib (vec=0x12e3d68, name=0x94d450, val=0x0) at
>         ../../../src/main/attrib.c:226
>         226        if (NAMED(val)) val = duplicate(val);
>         (gdb) bt
>         #0  Rf_setAttrib (vec=0x12e3d68, name=0x94d450, val=0x0) at
>         ../../../src/main/attrib.c:226
>         #1  0x000000000056264f in xxexprlist1 () at gram.y:574
>         #2  Rf_yyparse () at gram.y:337
>         #3  0x0000000000563469 in R_Parse1 (status=0x94d450) at gram.y:1126
>         #4  0x0000000000563cfb in R_Parse1File (fp=0x1200920, gencode=1,
>         status=0x7fffffffcd94, first=<value optimized out>) at gram.y:1164
>         #5  0x0000000000416cb2 in R_ReplFile (fp=0x1200920, rho=0x973338,
>         savestack=0, browselevel=<value optimized out>) at
>         ../../../src/main/main.c:87
>         #6  0x0000000000416e08 in R_LoadProfile (fparg=<value optimized
>         out>,
>         env=0x973338) at ../../../src/main/main.c:651
>         #7  0x00000000004172c2 in setup_Rmainloop () at
>         ../../../src/main/main.c:875
>         #8  0x00000000004185c9 in Rf_mainloop () at
>         ../../../src/main/main.c:967
>         #9  0x0000000000415c38 in main (ac=<value optimized out>, av=<value
>         optimized out>) at ../../../src/main/Rmain.c:33
>         #10 0x00007ffff6ed05c6 in __libc_start_main () from /lib/libc.so.6
>         #11 0x0000000000415b29 in _start () at
>         ../sysdeps/x86_64/elf/start.S:113
>         (gdb)
> 
>         Mark W. Kimpel MD  ** Neuroinformatics ** Dept. of Psychiatry
>         Indiana University School of Medicine
> 
>         15032 Hunter Court, Westfield, IN  46074
> 
>         (317) 490-5129 Work, & Mobile & VoiceMail
>         (317) 399-1219 Skype No Voicemail please
> 
> 
>         On Wed, Sep 16, 2009 at 4:45 PM, Peter Dalgaard
>         <p.dalgaard at biostat.ku.dk <mailto:p.dalgaard at biostat.ku.dk>>wrote:
> 
>             Mark Kimpel wrote:
> 
>                 I just downloaded R-devel and when loaded it immediately
>                 segfaults. I'm
>                 not
>                 sure how much or what sort of diagnostic info and can
>                 provide, but below
>                 is
>                 my build script, my console output, and the output of
>                 uname -r. I am
>                 currently dependent on the development version of a
>                 package, so I'd like
>                 to
>                 get R-devel up and running if possible. I am sure there
>                 is more info I can
>                 provide, but before deluging the list with unnecessary
>                 output, I thought I
>                 would ask first what would be helpfu. Mark
> 
>             Not happening for me with 49727 (SUSE 64bit).
> 
>             Do you have a saved workspace in that dir by any chance?
> 
>             Could you try
> 
>             R --vanilla
> 
>             and
> 
>             R -d gdb
>             followed by "run" and "bt" on the segfault
> 
>              #Make R
> 
>                 cd ~/R_HOME
>                 wget ftp://ftp.stat.math.ethz.ch/Software/R/R-devel.tar.gz
>                 tar -xzf R-devel.tar.gz
>                 cd ~/R_HOME/R-devel
>                 mkdir R-build
>                 cd R-build
>                 ../configure --prefix=/home/mkimpel/R_HOME/R-devel/R-build
>                 make all
>                 make install
> 
>                 #####################################33
>                 # console output
>                 mkimpel-XPS ~/R_HOME/R-devel/R-build/bin: ./R
> 
>                 R version 2.10.0 Under development (unstable)
>                 (2009-09-15 r49711)
>                 Copyright (C) 2009 The R Foundation for Statistical
>                 Computing
>                 ISBN 3-900051-07-0
> 
>                 R is free software and comes with ABSOLUTELY NO WARRANTY.
>                 You are welcome to redistribute it under certain conditions.
>                 Type 'license()' or 'licence()' for distribution details.
> 
>                  Natural language support but running in an English locale
> 
>                 R is a collaborative project with many contributors.
>                 Type 'contributors()' for more information and
>                 'citation()' on how to cite R or R packages in publications.
> 
>                 Type 'demo()' for some demos, 'help()' for on-line help, or
>                 'help.start()' for an HTML browser interface to help.
>                 Type 'q()' to quit R.
> 
> 
>                  *** caught segfault ***
>                 address (nil), cause 'memory not mapped'
> 
>                 Possible actions:
>                 1: abort (with core dump, if enabled)
>                 2: normal R exit
>                 3: exit R without saving workspace
>                 4: exit R saving workspace
>                 Selection: 2
>                 Save workspace image? [y/n/c]: n
> 
>                 ######################################
>                 # kernel version
>                 mkimpel-XPS ~/R_HOME/R-devel/R-build/bin: uname -r
>                 2.6.30-1-amd64
>                 mkimpel-XPS ~/R_HOME/R-devel/R-build/bin:
> 
> 
>                 Mark W. Kimpel MD  ** Neuroinformatics ** Dept. of
>                 Psychiatry
>                 Indiana University School of Medicine
> 
>                 15032 Hunter Court, Westfield, IN  46074
> 
>                 (317) 490-5129 Work, & Mobile & VoiceMail
>                 (317) 399-1219 Skype No Voicemail please
> 
>                       [[alternative HTML version deleted]]
> 
>                 ______________________________________________
>                 R-devel at r-project.org <mailto:R-devel at r-project.org>
>                 mailing list
>                 https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
>             --
>              O__  ---- Peter Dalgaard             ?ster Farimagsgade 5,
>             Entr.B
>              c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>              (*) \(*) -- University of Copenhagen   Denmark      Ph:
>              (+45) 35327918
>             ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk
>             <mailto:p.dalgaard at biostat.ku.dk>)              FAX: (+45)
>             35327907
> 
> 
>                [[alternative HTML version deleted]]
> 
> 
> 
>         ------------------------------------------------------------------------
> 
>         ______________________________________________
>         R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>         https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
>


From murdoch at stats.uwo.ca  Thu Sep 17 03:49:39 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 16 Sep 2009 21:49:39 -0400
Subject: [Rd] 2.10.0 Under development (unstable) (2009-09-15 r49711)
 just	built segfaults on Debian Squeeze
In-Reply-To: <6b93d1830909161251w2148379bg963a66dbbb931487@mail.gmail.com>
References: <6b93d1830909161251w2148379bg963a66dbbb931487@mail.gmail.com>
Message-ID: <4AB195B3.3070702@stats.uwo.ca>

Okay, I've tracked this down, and it's a stupid error I made when trying 
to improve the error messages.  I tried to make the parser remember its 
position in a file when parsing it line by line so that it could report 
on syntax errors properly; the trouble is that when it executes one of 
those lines (like yours containing source()), it might re-enter the 
parser.  It needs to save and restore its state around that sort of call.

This will be fairly easy to fix, but I won't be able to do it until 
tomorrow.

Duncan Murdoch


On 16/09/2009 3:51 PM, Mark Kimpel wrote:
> I just downloaded R-devel and when loaded it immediately segfaults. I'm not
> sure how much or what sort of diagnostic info and can provide, but below is
> my build script, my console output, and the output of uname -r. I am
> currently dependent on the development version of a package, so I'd like to
> get R-devel up and running if possible. I am sure there is more info I can
> provide, but before deluging the list with unnecessary output, I thought I
> would ask first what would be helpfu. Mark

> #Make R
> cd ~/R_HOME
> wget ftp://ftp.stat.math.ethz.ch/Software/R/R-devel.tar.gz
> tar -xzf R-devel.tar.gz
> cd ~/R_HOME/R-devel
> mkdir R-build
> cd R-build
> ../configure --prefix=/home/mkimpel/R_HOME/R-devel/R-build
> make all
> make install
> 
> #####################################33
> # console output
> mkimpel-XPS ~/R_HOME/R-devel/R-build/bin: ./R
> 
> R version 2.10.0 Under development (unstable) (2009-09-15 r49711)
> Copyright (C) 2009 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
> 
>   Natural language support but running in an English locale
> 
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
> 
> 
>  *** caught segfault ***
> address (nil), cause 'memory not mapped'
> 
> Possible actions:
> 1: abort (with core dump, if enabled)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> Selection: 2
> Save workspace image? [y/n/c]: n
> 
> ######################################
> # kernel version
> mkimpel-XPS ~/R_HOME/R-devel/R-build/bin: uname -r
> 2.6.30-1-amd64
> mkimpel-XPS ~/R_HOME/R-devel/R-build/bin:
> 
> 
> Mark W. Kimpel MD  ** Neuroinformatics ** Dept. of Psychiatry
> Indiana University School of Medicine
> 
> 15032 Hunter Court, Westfield, IN  46074
> 
> (317) 490-5129 Work, & Mobile & VoiceMail
> (317) 399-1219 Skype No Voicemail please
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From mwkimpel at gmail.com  Thu Sep 17 04:05:19 2009
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Wed, 16 Sep 2009 22:05:19 -0400
Subject: [Rd] 2.10.0 Under development (unstable) (2009-09-15 r49711)
	just built segfaults on Debian Squeeze
In-Reply-To: <4AB195B3.3070702@stats.uwo.ca>
References: <6b93d1830909161251w2148379bg963a66dbbb931487@mail.gmail.com>
	<4AB195B3.3070702@stats.uwo.ca>
Message-ID: <6b93d1830909161905m173e57ew9f2a29734b279deb@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090916/71295c67/attachment.pl>

From g.russell at eos-solutions.com  Thu Sep 17 09:25:11 2009
From: g.russell at eos-solutions.com (g.russell at eos-solutions.com)
Date: Thu, 17 Sep 2009 09:25:11 +0200 (CEST)
Subject: [Rd] Memory-management crash with UTF-8 on Windows (PR#13955)
Message-ID: <20090917072511.BB2D9282EF51@mail.pubhealth.ku.dk>

--=_mixed 00289247C1257634_=
Content-Type: text/plain; charset="ISO-8859-1"
Content-Transfer-Encoding: quoted-printable

Dear R-Bugs,

thank you for your wonderful software, which we use a lot. We are having a =

bit of difficulty right now because it crashes sometimes with Unicode=20
characters.

Actual sessionInfo:

R version 2.9.0 (2009-04-17)=20
i386-pc-mingw32=20

locale:
LC=5FCOLLATE=3DGerman=5FGermany.1252;LC=5FCTYPE=3DGerman=5FGermany.1252;LC=
=5FMONETARY=3DGerman=5FGermany.1252;LC=5FNUMERIC=3DC;LC=5FTIME=3DGerman=5FG=
ermany.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base=20

We can crash R by reading or copy-pasting the following file into it (for=20
example, Rgui --vanilla).

I see a message "Microsoft Visual C++ Runtime Library", "Runtime Error!".=20
If you do not, please let me know and I'll try installing 2.9.2 and see if =

that fixes the problem (the list of bug fixes doesn't seem to include this =

one, but I'm not sure).

Many thanks and best wishes,

George Russell

EOS Risk Management
KG EOS Holding GmbH & Co | Steindamm 71, 20099 Hamburg  | AG Hamburg HRA=20
95 748
Tel:  +49 (0)40 2850-1574 | g.russell at eos-solutions.com
Fax:  +49 (0)40 2850-1559 | http://www.eos-solutions.com

Pers=F6nlich haftend  | EOS Holding GmbH  | AG Hamburg HRB 78 748
Gesch=E4ftsf=FChrer | Hans-Werner Scherer, Klaus Engberding, Justus=20
Hecking-Veltman, Dr. Axel Steuernagel, Dr. Andreas Witzig, Paul Leary sen.
Vorsitzender des Beirates | J=FCrgen Schulte-Laggenbeck=20

Diese E-Mail enth=E4lt vertrauliche und/oder rechtlich gesch=FCtzte=20
Informationen. Wenn Sie nicht der richtige Adressat sind oder diese E-Mail =

irrt=FCmlich erhalten haben, informieren Sie bitte sofort den Absender und =

vernichten Sie diese Mail. Das unerlaubte Kopieren sowie die unbefugte=20
Weitergabe dieser Mail ist nicht gestattet

This email may contain confidential and/or privileged in...{{dropped:16}}

--=_mixed 00289247C1257634_=--


From P.V.Dunmore at massey.ac.nz  Wed Sep 16 23:50:13 2009
From: P.V.Dunmore at massey.ac.nz (P.V.Dunmore at massey.ac.nz)
Date: Wed, 16 Sep 2009 23:50:13 +0200 (CEST)
Subject: [Rd] Bogus warning in splinefun (PR#13954)
Message-ID: <20090916215013.8D15E2831FEC@mail.pubhealth.ku.dk>

Full_Name: Paul Dunmore
Version: 2.9.2
OS: Windows
Submission from: (NULL) (99.236.3.129)


The statement rm(x,y,nx,ux,o,method,iMeth) at line 95 in splinefun.R often
throws a warning because ux is not found (it is only conditionally defined at
line 35). spline.R handles this correctly, with rm(ux) at the end of the
conditional block.


From ripley at stats.ox.ac.uk  Thu Sep 17 10:39:07 2009
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 17 Sep 2009 09:39:07 +0100 (BST)
Subject: [Rd] Memory-management crash with UTF-8 on Windows (PR#13955)
In-Reply-To: <20090917072511.BB2D9282EF51@mail.pubhealth.ku.dk>
References: <20090917072511.BB2D9282EF51@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0909170932290.16792@gannet.stats.ox.ac.uk>

Without the file, we can do nothing with this, so please put it 
somewhere accessible.  Also, we need exact reproduction instructions: 
how did you tell R this was a UTF-8 file?  If you copy-pasted it, what 
did you copy it from?

The posting guide and FAQ did ask you not to report on obsolete 
versions of R, so please do test a current version before replying 
with details of where the file is.

It would also be helpful to have your exact OS, as the error appears 
to be in MSVCRT.dll, an operating system component.

On Thu, 17 Sep 2009, g.russell at eos-solutions.com wrote:

> --=_mixed 00289247C1257634_=
> Content-Type: text/plain; charset="ISO-8859-1"
> Content-Transfer-Encoding: quoted-printable
>
> Dear R-Bugs,
>
> thank you for your wonderful software, which we use a lot. We are having a =
>
> bit of difficulty right now because it crashes sometimes with Unicode=20
> characters.
>
> Actual sessionInfo:
>
> R version 2.9.0 (2009-04-17)=20
> i386-pc-mingw32=20
>
> locale:
> LC=5FCOLLATE=3DGerman=5FGermany.1252;LC=5FCTYPE=3DGerman=5FGermany.1252;LC=
> =5FMONETARY=3DGerman=5FGermany.1252;LC=5FNUMERIC=3DC;LC=5FTIME=3DGerman=5FG=
> ermany.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base=20
>
> We can crash R by reading or copy-pasting the following file into it (for=20
> example, Rgui --vanilla).
>
> I see a message "Microsoft Visual C++ Runtime Library", "Runtime Error!".=20
> If you do not, please let me know and I'll try installing 2.9.2 and see if =
>
> that fixes the problem (the list of bug fixes doesn't seem to include this =
>
> one, but I'm not sure).
>
> Many thanks and best wishes,
>
> George Russell


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From groemping at bht-berlin.de  Thu Sep 17 14:09:50 2009
From: groemping at bht-berlin.de (Ulrike Groemping)
Date: Thu, 17 Sep 2009 05:09:50 -0700 (PDT)
Subject: [Rd]  Display image in tcl/tk information window: path to file ?
Message-ID: <25490113.post@talk.nabble.com>


Dear DevelopeRs,

for an R-Commander plugin, I want to display a pre-stored information image,
if the user presses a button. Everything works fine with the command 

tcl("image",  "create", "photo", "MaxC2.image", file="MaxC2res3image.gif")

for image creation, as long as the file entry refers to the correct location
of the file on my hard drive. How can I make this portable ? 

I currently have the image stored in the inst directory. "R CMD INSTALL
--build" moves it to the top directory in the zip file. I have no idea how
to tell R (or tcl) where to look for the file. Any help is appreciated!

Best regards,
Ulrike

*************
Ulrike Groemping
BHT Berlin


-- 
View this message in context: http://www.nabble.com/Display-image-in-tcl-tk-information-window%3A-path-to-file---tp25490113p25490113.html
Sent from the R devel mailing list archive at Nabble.com.


From romain.francois at dbmail.com  Thu Sep 17 14:15:45 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Thu, 17 Sep 2009 14:15:45 +0200
Subject: [Rd] Display image in tcl/tk information window: path to file ?
In-Reply-To: <25490113.post@talk.nabble.com>
References: <25490113.post@talk.nabble.com>
Message-ID: <4AB22871.1000508@dbmail.com>

?system.file

for example (if the file lives in inst/images of your source package)

system.file( "images", "MaxC2res3image.gif", package = "yourpackage" )

Romain

On 09/17/2009 02:09 PM, Ulrike Groemping wrote:
> Dear DevelopeRs,
>
> for an R-Commander plugin, I want to display a pre-stored information image,
> if the user presses a button. Everything works fine with the command
>
> tcl("image",  "create", "photo", "MaxC2.image", file="MaxC2res3image.gif")
>
> for image creation, as long as the file entry refers to the correct location
> of the file on my hard drive. How can I make this portable ?
>
> I currently have the image stored in the inst directory. "R CMD INSTALL
> --build" moves it to the top directory in the zip file. I have no idea how
> to tell R (or tcl) where to look for the file. Any help is appreciated!
>
> Best regards,
> Ulrike
>
> *************
> Ulrike Groemping
> BHT Berlin


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/yw8E : New R package : sos
|- http://tr.im/y8y0 : search the graph gallery from R
`- http://tr.im/y8wY : new R package : ant


From jfox at mcmaster.ca  Thu Sep 17 14:50:10 2009
From: jfox at mcmaster.ca (John Fox)
Date: Thu, 17 Sep 2009 08:50:10 -0400
Subject: [Rd] Display image in tcl/tk information window: path to file ?
In-Reply-To: <25490113.post@talk.nabble.com>
References: <25490113.post@talk.nabble.com>
Message-ID: <003801ca3795$648cbc00$2da63400$@ca>

Dear Ulrike,

If I understand correctly what you want to do, the image file is stored in
your package. If so, you can use the .path.package() function to locate your
package on the file system. For example, the Rcmdr uses the following code
to find its etc subdirectory: file.path(.path.package(package="Rcmdr")[1],
"etc").

I hope this helps,
 John

------------------------------
John Fox, Professor
Department of Sociology
McMaster University
Hamilton, Ontario, Canada
web: socserv.mcmaster.ca/jfox


> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org]
On
> Behalf Of Ulrike Groemping
> Sent: September-17-09 8:10 AM
> To: r-devel at r-project.org
> Subject: [Rd] Display image in tcl/tk information window: path to file ?
> 
> 
> Dear DevelopeRs,
> 
> for an R-Commander plugin, I want to display a pre-stored information
image,
> if the user presses a button. Everything works fine with the command
> 
> tcl("image",  "create", "photo", "MaxC2.image", file="MaxC2res3image.gif")
> 
> for image creation, as long as the file entry refers to the correct
location
> of the file on my hard drive. How can I make this portable ?
> 
> I currently have the image stored in the inst directory. "R CMD INSTALL
> --build" moves it to the top directory in the zip file. I have no idea how
> to tell R (or tcl) where to look for the file. Any help is appreciated!
> 
> Best regards,
> Ulrike
> 
> *************
> Ulrike Groemping
> BHT Berlin
> 
> 
> --
> View this message in context:
http://www.nabble.com/Display-image-in-tcl-tk-
> information-window%3A-path-to-file---tp25490113p25490113.html
> Sent from the R devel mailing list archive at Nabble.com.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ggrothendieck at gmail.com  Thu Sep 17 17:32:58 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 17 Sep 2009 11:32:58 -0400
Subject: [Rd] Windows Source Install Without Rtools
Message-ID: <971536df0909170832v3c675fb1l9a3b4403516ec391@mail.gmail.com>

Regarding this from this week:

2.10.0 PACKAGE INSTALLATION (Windows)
It is possible to install source packages without Rtools provided they
have no compiled code and no configure.win or cleanup.win script.

- what are the instructions to perform such a source install?
- I assume one still needs MiKTeX -- is that right?
- is the source install done from a tar.gz (in which case one would
need tar to create it) or directly from the source directory tree?


From g.russell at eos-solutions.com  Thu Sep 17 12:20:12 2009
From: g.russell at eos-solutions.com (g.russell at eos-solutions.com)
Date: Thu, 17 Sep 2009 12:20:12 +0200 (CEST)
Subject: [Rd] Antwort: Re: Memory-management crash with UTF-8 on Windows
	(PR#13956)
Message-ID: <20090917102012.630442831FF2@mail.pubhealth.ku.dk>

Dear Professor Ripley,
a. I apologise for not including the file. I sent the E-Mail to=20
R-bugs at r-project.org with an attachment, but the attachment evidently got=20
lost. However the text of the file is as follows:

--- CUT HERE ----
gctorture()
characters <- intToUtf8(200:300)
indices <- rep(sequence(5),10)
substrings <- substring(characters,indices,indices + 5)
factor(substrings)
--- CUT HERE ---

b. There is no Unicode file involved, the Unicode comes from the=20
"intToUtf8" function.
c. The operating system is Windows XP Professional (2002), Service Pack 2.
d. I have just tried installing R 2.9.2. This also crashes.

Best wishes,

George Russell

EOS Risk Management
KG EOS Holding GmbH & Co | Steindamm 71, 20099 Hamburg  | AG Hamburg HRA=20
95 748
Tel:  +49 (0)40 2850-1574 | g.russell at eos-solutions.com
Fax:  +49 (0)40 2850-1559 | http://www.eos-solutions.com

Pers=F6nlich haftend  | EOS Holding GmbH  | AG Hamburg HRB 78 748
Gesch=E4ftsf=FChrer | Hans-Werner Scherer, Klaus Engberding, Justus=20
Hecking-Veltman, Dr. Axel Steuernagel, Dr. Andreas Witzig, Paul Leary sen.
Vorsitzender des Beirates | J=FCrgen Schulte-Laggenbeck=20

Diese E-Mail enth=E4lt vertrauliche und/oder rechtlich gesch=FCtzte=20
Informationen. Wenn Sie nicht der richtige Adressat sind oder diese E-Mail =

irrt=FCmlich erhalten haben, informieren Sie bitte sofort den Absender und =

vernichten Sie diese Mail. Das unerlaubte Kopieren sowie die unbefugte=20
Weitergabe dieser Mail ist nicht gestattet

This email may contain confidential and/or privileged information. If you=20
are not the intended recipient or have received this email in error,=20
please notify the sender immediately and destroy this email. Any=20
unauthorized copying, disclosure or distribution of the material in this=20
email is strictly forbidden.=20



Prof Brian Ripley <ripley at stats.ox.ac.uk>=20
17.09.2009 10:39

An
g.russell at eos-solutions.com
Kopie
r-devel at stat.math.ethz.ch, R-bugs at r-project.org
Thema
Re: [Rd] Memory-management crash with UTF-8 on Windows (PR#13955)






Without the file, we can do nothing with this, so please put it=20
somewhere accessible.  Also, we need exact reproduction instructions:=20
how did you tell R this was a UTF-8 file?  If you copy-pasted it, what=20
did you copy it from?

The posting guide and FAQ did ask you not to report on obsolete=20
versions of R, so please do test a current version before replying=20
with details of where the file is.

It would also be helpful to have your exact OS, as the error appears=20
to be in MSVCRT.dll, an operating system component.

On Thu, 17 Sep 2009, g.russell at eos-solutions.com wrote:

> --=3D=5Fmixed 00289247C1257634=5F=3D
> Content-Type: text/plain; charset=3D"ISO-8859-1"
> Content-Transfer-Encoding: quoted-printable
>
> Dear R-Bugs,
>
> thank you for your wonderful software, which we use a lot. We are having =

a =3D
>
> bit of difficulty right now because it crashes sometimes with Unicode=3D20
> characters.
>
> Actual sessionInfo:
>
> R version 2.9.0 (2009-04-17)=3D20
> i386-pc-mingw32=3D20
>
> locale:
>=20
LC=3D5FCOLLATE=3D3DGerman=3D5FGermany.1252;LC=3D5FCTYPE=3D3DGerman=3D5FGerm=
any.1252;LC=3D
>=20
=3D5FMONETARY=3D3DGerman=3D5FGermany.1252;LC=3D5FNUMERIC=3D3DC;LC=3D5FTIME=
=3D3DGerman=3D5FG=3D
> ermany.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base=3D20
>
> We can crash R by reading or copy-pasting the following file into it=20
(for=3D20
> example, Rgui --vanilla).
>
> I see a message "Microsoft Visual C++ Runtime Library", "Runtime=20
Error!".=3D20
> If you do not, please let me know and I'll try installing 2.9.2 and see=20
if =3D
>
> that fixes the problem (the list of bug fixes doesn't seem to include=20
this =3D
>
> one, but I'm not sure).
>
> Many thanks and best wishes,
>
> George Russell


--=20
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From edd at debian.org  Thu Sep 17 18:19:01 2009
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 17 Sep 2009 11:19:01 -0500
Subject: [Rd] Windows Source Install Without Rtools
In-Reply-To: <971536df0909170832v3c675fb1l9a3b4403516ec391@mail.gmail.com>
References: <971536df0909170832v3c675fb1l9a3b4403516ec391@mail.gmail.com>
Message-ID: <19122.24949.329620.857305@ron.nulle.part>


On 17 September 2009 at 11:32, Gabor Grothendieck wrote:
| Regarding this from this week:
| 
| 2.10.0 PACKAGE INSTALLATION (Windows)
| It is possible to install source packages without Rtools provided they
| have no compiled code and no configure.win or cleanup.win script.
| 
| - what are the instructions to perform such a source install?
| - I assume one still needs MiKTeX -- is that right?
| - is the source install done from a tar.gz (in which case one would
| need tar to create it) or directly from the source directory tree?

You may want to stick this 

      http://developer.r-project.org/blosxom.cgi/R-devel

into your RSS reader so that you get daily summaries of changes.  

I don't follow this too religiously (as I typically only built r-devel once we have
alpha/beta/rc candidates) but even I am aware that 

      a) dynamic .Rd conversion at runtime, so Miktex may no longer be needed
    
      b) untgz.exe on Windows to read (compressed) tarballs

Dirk

-- 
Three out of two people have difficulties with fractions.


From ggrothendieck at gmail.com  Thu Sep 17 18:43:56 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 17 Sep 2009 12:43:56 -0400
Subject: [Rd] Windows Source Install Without Rtools
In-Reply-To: <19122.24949.329620.857305@ron.nulle.part>
References: <971536df0909170832v3c675fb1l9a3b4403516ec391@mail.gmail.com> 
	<19122.24949.329620.857305@ron.nulle.part>
Message-ID: <971536df0909170943p6deed018jb54b8cdd82980e45@mail.gmail.com>

Thanks. Perhaps someone in the core group can
still provide explicit information on how to install such
a package.

On Thu, Sep 17, 2009 at 12:19 PM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> On 17 September 2009 at 11:32, Gabor Grothendieck wrote:
> | Regarding this from this week:
> |
> | 2.10.0 PACKAGE INSTALLATION (Windows)
> | It is possible to install source packages without Rtools provided they
> | have no compiled code and no configure.win or cleanup.win script.
> |
> | - what are the instructions to perform such a source install?
> | - I assume one still needs MiKTeX -- is that right?
> | - is the source install done from a tar.gz (in which case one would
> | need tar to create it) or directly from the source directory tree?
>
> You may want to stick this
>
> ? ? ?http://developer.r-project.org/blosxom.cgi/R-devel
>
> into your RSS reader so that you get daily summaries of changes.
>
> I don't follow this too religiously (as I typically only built r-devel once we have
> alpha/beta/rc candidates) but even I am aware that
>
> ? ? ?a) dynamic .Rd conversion at runtime, so Miktex may no longer be needed
>
> ? ? ?b) untgz.exe on Windows to read (compressed) tarballs
>
> Dirk
>
> --
> Three out of two people have difficulties with fractions.
>


From simon.urbanek at r-project.org  Thu Sep 17 21:58:12 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 17 Sep 2009 15:58:12 -0400
Subject: [Rd] Windows Source Install Without Rtools
In-Reply-To: <971536df0909170943p6deed018jb54b8cdd82980e45@mail.gmail.com>
References: <971536df0909170832v3c675fb1l9a3b4403516ec391@mail.gmail.com>
	<19122.24949.329620.857305@ron.nulle.part>
	<971536df0909170943p6deed018jb54b8cdd82980e45@mail.gmail.com>
Message-ID: <923DDBAD-EC7A-4446-B33B-728208473003@r-project.org>


On Sep 17, 2009, at 12:43 , Gabor Grothendieck wrote:

> Thanks. Perhaps someone in the core group can
> still provide explicit information on how to install such
> a package.
>

R CMD INSTALL

(see R --help and it has been *the* way to install packages for quite  
a while so I'm not sure how more explicit we have to make it...)

Cheers,
Simon



> On Thu, Sep 17, 2009 at 12:19 PM, Dirk Eddelbuettel <edd at debian.org>  
> wrote:
>>
>> On 17 September 2009 at 11:32, Gabor Grothendieck wrote:
>> | Regarding this from this week:
>> |
>> | 2.10.0 PACKAGE INSTALLATION (Windows)
>> | It is possible to install source packages without Rtools provided  
>> they
>> | have no compiled code and no configure.win or cleanup.win script.
>> |
>> | - what are the instructions to perform such a source install?
>> | - I assume one still needs MiKTeX -- is that right?
>> | - is the source install done from a tar.gz (in which case one would
>> | need tar to create it) or directly from the source directory tree?
>>
>> You may want to stick this
>>
>>      http://developer.r-project.org/blosxom.cgi/R-devel
>>
>> into your RSS reader so that you get daily summaries of changes.
>>
>> I don't follow this too religiously (as I typically only built r- 
>> devel once we have
>> alpha/beta/rc candidates) but even I am aware that
>>
>>      a) dynamic .Rd conversion at runtime, so Miktex may no longer  
>> be needed
>>
>>      b) untgz.exe on Windows to read (compressed) tarballs
>>
>> Dirk
>>
>> --
>> Three out of two people have difficulties with fractions.
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From ggrothendieck at gmail.com  Thu Sep 17 22:09:02 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 17 Sep 2009 16:09:02 -0400
Subject: [Rd] Windows Source Install Without Rtools
In-Reply-To: <923DDBAD-EC7A-4446-B33B-728208473003@r-project.org>
References: <971536df0909170832v3c675fb1l9a3b4403516ec391@mail.gmail.com> 
	<19122.24949.329620.857305@ron.nulle.part>
	<971536df0909170943p6deed018jb54b8cdd82980e45@mail.gmail.com> 
	<923DDBAD-EC7A-4446-B33B-728208473003@r-project.org>
Message-ID: <971536df0909171309oc7a21fcs5cbe5563fb5fdcb2@mail.gmail.com>

Note that that is not currently the recommended way.

Also, what comes after INSTALL? The source .tar.gz name?
The pathname to the source directory?

On Thu, Sep 17, 2009 at 3:58 PM, Simon Urbanek
<simon.urbanek at r-project.org> wrote:
>
> On Sep 17, 2009, at 12:43 , Gabor Grothendieck wrote:
>
>> Thanks. Perhaps someone in the core group can
>> still provide explicit information on how to install such
>> a package.
>>
>
> R CMD INSTALL
>
> (see R --help and it has been *the* way to install packages for quite a
> while so I'm not sure how more explicit we have to make it...)
>
> Cheers,
> Simon
>
>
>
>> On Thu, Sep 17, 2009 at 12:19 PM, Dirk Eddelbuettel <edd at debian.org>
>> wrote:
>>>
>>> On 17 September 2009 at 11:32, Gabor Grothendieck wrote:
>>> | Regarding this from this week:
>>> |
>>> | 2.10.0 PACKAGE INSTALLATION (Windows)
>>> | It is possible to install source packages without Rtools provided they
>>> | have no compiled code and no configure.win or cleanup.win script.
>>> |
>>> | - what are the instructions to perform such a source install?
>>> | - I assume one still needs MiKTeX -- is that right?
>>> | - is the source install done from a tar.gz (in which case one would
>>> | need tar to create it) or directly from the source directory tree?
>>>
>>> You may want to stick this
>>>
>>> ? ? http://developer.r-project.org/blosxom.cgi/R-devel
>>>
>>> into your RSS reader so that you get daily summaries of changes.
>>>
>>> I don't follow this too religiously (as I typically only built r-devel
>>> once we have
>>> alpha/beta/rc candidates) but even I am aware that
>>>
>>> ? ? a) dynamic .Rd conversion at runtime, so Miktex may no longer be
>>> needed
>>>
>>> ? ? b) untgz.exe on Windows to read (compressed) tarballs
>>>
>>> Dirk
>>>
>>> --
>>> Three out of two people have difficulties with fractions.
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
>


From simon.urbanek at r-project.org  Thu Sep 17 22:27:57 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 17 Sep 2009 16:27:57 -0400
Subject: [Rd] Windows Source Install Without Rtools
In-Reply-To: <971536df0909171309oc7a21fcs5cbe5563fb5fdcb2@mail.gmail.com>
References: <971536df0909170832v3c675fb1l9a3b4403516ec391@mail.gmail.com>
	<19122.24949.329620.857305@ron.nulle.part>
	<971536df0909170943p6deed018jb54b8cdd82980e45@mail.gmail.com>
	<923DDBAD-EC7A-4446-B33B-728208473003@r-project.org>
	<971536df0909171309oc7a21fcs5cbe5563fb5fdcb2@mail.gmail.com>
Message-ID: <4F99D751-F645-4185-B255-631F9DD9C653@r-project.org>

On Sep 17, 2009, at 16:09 , Gabor Grothendieck wrote:

> Note that that is not currently the recommended way.
>

Now that would be a surprise to me - to quote R-admin: 6.3.1: "R CMD  
INSTALL works in Windows to install source packages if you have the  
source-code package files".


> Also, what comes after INSTALL? The source .tar.gz name?
> The pathname to the source directory?
>


R CMD INSTALL --help

Usage: R CMD INSTALL [options] pkgs

Install the add-on packages specified by pkgs.  The elements of pkgs can
be relative or absolute paths to directories with the package (bundle)
sources, or to gzipped package 'tar' archives.  The library tree
[...]

Cheers,
S


> On Thu, Sep 17, 2009 at 3:58 PM, Simon Urbanek
> <simon.urbanek at r-project.org> wrote:
>>
>> On Sep 17, 2009, at 12:43 , Gabor Grothendieck wrote:
>>
>>> Thanks. Perhaps someone in the core group can
>>> still provide explicit information on how to install such
>>> a package.
>>>
>>
>> R CMD INSTALL
>>
>> (see R --help and it has been *the* way to install packages for  
>> quite a
>> while so I'm not sure how more explicit we have to make it...)
>>
>> Cheers,
>> Simon
>>
>>
>>
>>> On Thu, Sep 17, 2009 at 12:19 PM, Dirk Eddelbuettel <edd at debian.org>
>>> wrote:
>>>>
>>>> On 17 September 2009 at 11:32, Gabor Grothendieck wrote:
>>>> | Regarding this from this week:
>>>> |
>>>> | 2.10.0 PACKAGE INSTALLATION (Windows)
>>>> | It is possible to install source packages without Rtools  
>>>> provided they
>>>> | have no compiled code and no configure.win or cleanup.win script.
>>>> |
>>>> | - what are the instructions to perform such a source install?
>>>> | - I assume one still needs MiKTeX -- is that right?
>>>> | - is the source install done from a tar.gz (in which case one  
>>>> would
>>>> | need tar to create it) or directly from the source directory  
>>>> tree?
>>>>
>>>> You may want to stick this
>>>>
>>>>     http://developer.r-project.org/blosxom.cgi/R-devel
>>>>
>>>> into your RSS reader so that you get daily summaries of changes.
>>>>
>>>> I don't follow this too religiously (as I typically only built r- 
>>>> devel
>>>> once we have
>>>> alpha/beta/rc candidates) but even I am aware that
>>>>
>>>>     a) dynamic .Rd conversion at runtime, so Miktex may no longer  
>>>> be
>>>> needed
>>>>
>>>>     b) untgz.exe on Windows to read (compressed) tarballs
>>>>
>>>> Dirk
>>>>
>>>> --
>>>> Three out of two people have difficulties with fractions.
>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>
>>
>
>


From ggrothendieck at gmail.com  Thu Sep 17 22:40:50 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 17 Sep 2009 16:40:50 -0400
Subject: [Rd] Windows Source Install Without Rtools
In-Reply-To: <4F99D751-F645-4185-B255-631F9DD9C653@r-project.org>
References: <971536df0909170832v3c675fb1l9a3b4403516ec391@mail.gmail.com> 
	<19122.24949.329620.857305@ron.nulle.part>
	<971536df0909170943p6deed018jb54b8cdd82980e45@mail.gmail.com> 
	<923DDBAD-EC7A-4446-B33B-728208473003@r-project.org>
	<971536df0909171309oc7a21fcs5cbe5563fb5fdcb2@mail.gmail.com> 
	<4F99D751-F645-4185-B255-631F9DD9C653@r-project.org>
Message-ID: <971536df0909171340i1c36841fj90ef3b9c5792685e@mail.gmail.com>

Maybe on other platforms but on Windows
help does not get linked properly with all
variations.

On Thu, Sep 17, 2009 at 4:27 PM, Simon Urbanek
<simon.urbanek at r-project.org> wrote:
> On Sep 17, 2009, at 16:09 , Gabor Grothendieck wrote:
>
>> Note that that is not currently the recommended way.
>>
>
> Now that would be a surprise to me - to quote R-admin: 6.3.1: "R CMD INSTALL
> works in Windows to install source packages if you have the source-code
> package files".
>
>
>> Also, what comes after INSTALL? The source .tar.gz name?
>> The pathname to the source directory?
>>
>
>
> R CMD INSTALL --help
>
> Usage: R CMD INSTALL [options] pkgs
>
> Install the add-on packages specified by pkgs. ?The elements of pkgs can
> be relative or absolute paths to directories with the package (bundle)
> sources, or to gzipped package 'tar' archives. ?The library tree
> [...]
>
> Cheers,
> S
>
>
>> On Thu, Sep 17, 2009 at 3:58 PM, Simon Urbanek
>> <simon.urbanek at r-project.org> wrote:
>>>
>>> On Sep 17, 2009, at 12:43 , Gabor Grothendieck wrote:
>>>
>>>> Thanks. Perhaps someone in the core group can
>>>> still provide explicit information on how to install such
>>>> a package.
>>>>
>>>
>>> R CMD INSTALL
>>>
>>> (see R --help and it has been *the* way to install packages for quite a
>>> while so I'm not sure how more explicit we have to make it...)
>>>
>>> Cheers,
>>> Simon
>>>
>>>
>>>
>>>> On Thu, Sep 17, 2009 at 12:19 PM, Dirk Eddelbuettel <edd at debian.org>
>>>> wrote:
>>>>>
>>>>> On 17 September 2009 at 11:32, Gabor Grothendieck wrote:
>>>>> | Regarding this from this week:
>>>>> |
>>>>> | 2.10.0 PACKAGE INSTALLATION (Windows)
>>>>> | It is possible to install source packages without Rtools provided
>>>>> they
>>>>> | have no compiled code and no configure.win or cleanup.win script.
>>>>> |
>>>>> | - what are the instructions to perform such a source install?
>>>>> | - I assume one still needs MiKTeX -- is that right?
>>>>> | - is the source install done from a tar.gz (in which case one would
>>>>> | need tar to create it) or directly from the source directory tree?
>>>>>
>>>>> You may want to stick this
>>>>>
>>>>> ? ?http://developer.r-project.org/blosxom.cgi/R-devel
>>>>>
>>>>> into your RSS reader so that you get daily summaries of changes.
>>>>>
>>>>> I don't follow this too religiously (as I typically only built r-devel
>>>>> once we have
>>>>> alpha/beta/rc candidates) but even I am aware that
>>>>>
>>>>> ? ?a) dynamic .Rd conversion at runtime, so Miktex may no longer be
>>>>> needed
>>>>>
>>>>> ? ?b) untgz.exe on Windows to read (compressed) tarballs
>>>>>
>>>>> Dirk
>>>>>
>>>>> --
>>>>> Three out of two people have difficulties with fractions.
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>
>>>
>>>
>>
>>
>
>


From murdoch at stats.uwo.ca  Thu Sep 17 23:55:32 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 17 Sep 2009 17:55:32 -0400
Subject: [Rd] Windows Source Install Without Rtools
In-Reply-To: <971536df0909171340i1c36841fj90ef3b9c5792685e@mail.gmail.com>
References: <971536df0909170832v3c675fb1l9a3b4403516ec391@mail.gmail.com>
	<19122.24949.329620.857305@ron.nulle.part>	<971536df0909170943p6deed018jb54b8cdd82980e45@mail.gmail.com>
	<923DDBAD-EC7A-4446-B33B-728208473003@r-project.org>	<971536df0909171309oc7a21fcs5cbe5563fb5fdcb2@mail.gmail.com>
	<4F99D751-F645-4185-B255-631F9DD9C653@r-project.org>
	<971536df0909171340i1c36841fj90ef3b9c5792685e@mail.gmail.com>
Message-ID: <4AB2B054.7000008@stats.uwo.ca>

On 17/09/2009 4:40 PM, Gabor Grothendieck wrote:
> Maybe on other platforms but on Windows
> help does not get linked properly with all
> variations.

I think you are thinking of building binaries, not installing packages. 
    Generally the only variation we advise against is

R CMD build --binary

Everything else should work fine, as far as I know.

Duncan Murdoch

> 
> On Thu, Sep 17, 2009 at 4:27 PM, Simon Urbanek
> <simon.urbanek at r-project.org> wrote:
>> On Sep 17, 2009, at 16:09 , Gabor Grothendieck wrote:
>>
>>> Note that that is not currently the recommended way.
>>>
>> Now that would be a surprise to me - to quote R-admin: 6.3.1: "R CMD INSTALL
>> works in Windows to install source packages if you have the source-code
>> package files".
>>
>>
>>> Also, what comes after INSTALL? The source .tar.gz name?
>>> The pathname to the source directory?
>>>
>>
>> R CMD INSTALL --help
>>
>> Usage: R CMD INSTALL [options] pkgs
>>
>> Install the add-on packages specified by pkgs.  The elements of pkgs can
>> be relative or absolute paths to directories with the package (bundle)
>> sources, or to gzipped package 'tar' archives.  The library tree
>> [...]
>>
>> Cheers,
>> S
>>
>>
>>> On Thu, Sep 17, 2009 at 3:58 PM, Simon Urbanek
>>> <simon.urbanek at r-project.org> wrote:
>>>> On Sep 17, 2009, at 12:43 , Gabor Grothendieck wrote:
>>>>
>>>>> Thanks. Perhaps someone in the core group can
>>>>> still provide explicit information on how to install such
>>>>> a package.
>>>>>
>>>> R CMD INSTALL
>>>>
>>>> (see R --help and it has been *the* way to install packages for quite a
>>>> while so I'm not sure how more explicit we have to make it...)
>>>>
>>>> Cheers,
>>>> Simon
>>>>
>>>>
>>>>
>>>>> On Thu, Sep 17, 2009 at 12:19 PM, Dirk Eddelbuettel <edd at debian.org>
>>>>> wrote:
>>>>>> On 17 September 2009 at 11:32, Gabor Grothendieck wrote:
>>>>>> | Regarding this from this week:
>>>>>> |
>>>>>> | 2.10.0 PACKAGE INSTALLATION (Windows)
>>>>>> | It is possible to install source packages without Rtools provided
>>>>>> they
>>>>>> | have no compiled code and no configure.win or cleanup.win script.
>>>>>> |
>>>>>> | - what are the instructions to perform such a source install?
>>>>>> | - I assume one still needs MiKTeX -- is that right?
>>>>>> | - is the source install done from a tar.gz (in which case one would
>>>>>> | need tar to create it) or directly from the source directory tree?
>>>>>>
>>>>>> You may want to stick this
>>>>>>
>>>>>>    http://developer.r-project.org/blosxom.cgi/R-devel
>>>>>>
>>>>>> into your RSS reader so that you get daily summaries of changes.
>>>>>>
>>>>>> I don't follow this too religiously (as I typically only built r-devel
>>>>>> once we have
>>>>>> alpha/beta/rc candidates) but even I am aware that
>>>>>>
>>>>>>    a) dynamic .Rd conversion at runtime, so Miktex may no longer be
>>>>>> needed
>>>>>>
>>>>>>    b) untgz.exe on Windows to read (compressed) tarballs
>>>>>>
>>>>>> Dirk
>>>>>>
>>>>>> --
>>>>>> Three out of two people have difficulties with fractions.
>>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>>
>>>>
>>>
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch at stats.uwo.ca  Thu Sep 17 23:57:24 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 17 Sep 2009 17:57:24 -0400
Subject: [Rd] Windows Source Install Without Rtools
In-Reply-To: <4AB2B054.7000008@stats.uwo.ca>
References: <971536df0909170832v3c675fb1l9a3b4403516ec391@mail.gmail.com>
	<19122.24949.329620.857305@ron.nulle.part>	<971536df0909170943p6deed018jb54b8cdd82980e45@mail.gmail.com>
	<923DDBAD-EC7A-4446-B33B-728208473003@r-project.org>	<971536df0909171309oc7a21fcs5cbe5563fb5fdcb2@mail.gmail.com>
	<4F99D751-F645-4185-B255-631F9DD9C653@r-project.org>
	<971536df0909171340i1c36841fj90ef3b9c5792685e@mail.gmail.com>
	<4AB2B054.7000008@stats.uwo.ca>
Message-ID: <4AB2B0C4.1010109@stats.uwo.ca>

On 17/09/2009 5:55 PM, Duncan Murdoch wrote:
> On 17/09/2009 4:40 PM, Gabor Grothendieck wrote:
>> Maybe on other platforms but on Windows
>> help does not get linked properly with all
>> variations.
> 
> I think you are thinking of building binaries, not installing packages. 
>     Generally the only variation we advise against is
> 
> R CMD build --binary
> 
> Everything else should work fine, as far as I know.

And I forgot to add:  the way HTML help is handled in the upcoming 
2.10.0 is different, so I suspect R CMD build --binary will work.  I 
haven't tested it though...

Duncan Murdoch

> 
> Duncan Murdoch
> 
>> On Thu, Sep 17, 2009 at 4:27 PM, Simon Urbanek
>> <simon.urbanek at r-project.org> wrote:
>>> On Sep 17, 2009, at 16:09 , Gabor Grothendieck wrote:
>>>
>>>> Note that that is not currently the recommended way.
>>>>
>>> Now that would be a surprise to me - to quote R-admin: 6.3.1: "R CMD INSTALL
>>> works in Windows to install source packages if you have the source-code
>>> package files".
>>>
>>>
>>>> Also, what comes after INSTALL? The source .tar.gz name?
>>>> The pathname to the source directory?
>>>>
>>> R CMD INSTALL --help
>>>
>>> Usage: R CMD INSTALL [options] pkgs
>>>
>>> Install the add-on packages specified by pkgs.  The elements of pkgs can
>>> be relative or absolute paths to directories with the package (bundle)
>>> sources, or to gzipped package 'tar' archives.  The library tree
>>> [...]
>>>
>>> Cheers,
>>> S
>>>
>>>
>>>> On Thu, Sep 17, 2009 at 3:58 PM, Simon Urbanek
>>>> <simon.urbanek at r-project.org> wrote:
>>>>> On Sep 17, 2009, at 12:43 , Gabor Grothendieck wrote:
>>>>>
>>>>>> Thanks. Perhaps someone in the core group can
>>>>>> still provide explicit information on how to install such
>>>>>> a package.
>>>>>>
>>>>> R CMD INSTALL
>>>>>
>>>>> (see R --help and it has been *the* way to install packages for quite a
>>>>> while so I'm not sure how more explicit we have to make it...)
>>>>>
>>>>> Cheers,
>>>>> Simon
>>>>>
>>>>>
>>>>>
>>>>>> On Thu, Sep 17, 2009 at 12:19 PM, Dirk Eddelbuettel <edd at debian.org>
>>>>>> wrote:
>>>>>>> On 17 September 2009 at 11:32, Gabor Grothendieck wrote:
>>>>>>> | Regarding this from this week:
>>>>>>> |
>>>>>>> | 2.10.0 PACKAGE INSTALLATION (Windows)
>>>>>>> | It is possible to install source packages without Rtools provided
>>>>>>> they
>>>>>>> | have no compiled code and no configure.win or cleanup.win script.
>>>>>>> |
>>>>>>> | - what are the instructions to perform such a source install?
>>>>>>> | - I assume one still needs MiKTeX -- is that right?
>>>>>>> | - is the source install done from a tar.gz (in which case one would
>>>>>>> | need tar to create it) or directly from the source directory tree?
>>>>>>>
>>>>>>> You may want to stick this
>>>>>>>
>>>>>>>    http://developer.r-project.org/blosxom.cgi/R-devel
>>>>>>>
>>>>>>> into your RSS reader so that you get daily summaries of changes.
>>>>>>>
>>>>>>> I don't follow this too religiously (as I typically only built r-devel
>>>>>>> once we have
>>>>>>> alpha/beta/rc candidates) but even I am aware that
>>>>>>>
>>>>>>>    a) dynamic .Rd conversion at runtime, so Miktex may no longer be
>>>>>>> needed
>>>>>>>
>>>>>>>    b) untgz.exe on Windows to read (compressed) tarballs
>>>>>>>
>>>>>>> Dirk
>>>>>>>
>>>>>>> --
>>>>>>> Three out of two people have difficulties with fractions.
>>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>
>>>>>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>


From ggrothendieck at gmail.com  Fri Sep 18 00:07:10 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 17 Sep 2009 18:07:10 -0400
Subject: [Rd] Windows Source Install Without Rtools
In-Reply-To: <4AB2B0C4.1010109@stats.uwo.ca>
References: <971536df0909170832v3c675fb1l9a3b4403516ec391@mail.gmail.com> 
	<19122.24949.329620.857305@ron.nulle.part>
	<971536df0909170943p6deed018jb54b8cdd82980e45@mail.gmail.com> 
	<923DDBAD-EC7A-4446-B33B-728208473003@r-project.org>
	<971536df0909171309oc7a21fcs5cbe5563fb5fdcb2@mail.gmail.com> 
	<4F99D751-F645-4185-B255-631F9DD9C653@r-project.org>
	<971536df0909171340i1c36841fj90ef3b9c5792685e@mail.gmail.com> 
	<4AB2B054.7000008@stats.uwo.ca> <4AB2B0C4.1010109@stats.uwo.ca>
Message-ID: <971536df0909171507s350224d2w4d831cd1ac073b79@mail.gmail.com>

Does that mean that

   Rcmd INSTALL --binary myPackage/

is still ok or should one use:

   Rcmd INSTALL myPackage/

without --binary and is this advice the same with and without Rtools?

Also, as there is potential confusion here could the combinations of flags
that are not recommended result in a warning? In the latter case at least
one knows right off that its not the thing to do and can immediately abort
and try something else if they don't want to suffer the consequences of
bad help linking.

On Thu, Sep 17, 2009 at 5:57 PM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 17/09/2009 5:55 PM, Duncan Murdoch wrote:
>>
>> On 17/09/2009 4:40 PM, Gabor Grothendieck wrote:
>>>
>>> Maybe on other platforms but on Windows
>>> help does not get linked properly with all
>>> variations.
>>
>> I think you are thinking of building binaries, not installing packages.
>> ?Generally the only variation we advise against is
>>
>> R CMD build --binary
>>
>> Everything else should work fine, as far as I know.
>
> And I forgot to add: ?the way HTML help is handled in the upcoming 2.10.0 is
> different, so I suspect R CMD build --binary will work. ?I haven't tested it
> though...
>
> Duncan Murdoch
>
>>
>> Duncan Murdoch
>>
>>> On Thu, Sep 17, 2009 at 4:27 PM, Simon Urbanek
>>> <simon.urbanek at r-project.org> wrote:
>>>>
>>>> On Sep 17, 2009, at 16:09 , Gabor Grothendieck wrote:
>>>>
>>>>> Note that that is not currently the recommended way.
>>>>>
>>>> Now that would be a surprise to me - to quote R-admin: 6.3.1: "R CMD
>>>> INSTALL
>>>> works in Windows to install source packages if you have the source-code
>>>> package files".
>>>>
>>>>
>>>>> Also, what comes after INSTALL? The source .tar.gz name?
>>>>> The pathname to the source directory?
>>>>>
>>>> R CMD INSTALL --help
>>>>
>>>> Usage: R CMD INSTALL [options] pkgs
>>>>
>>>> Install the add-on packages specified by pkgs. ?The elements of pkgs can
>>>> be relative or absolute paths to directories with the package (bundle)
>>>> sources, or to gzipped package 'tar' archives. ?The library tree
>>>> [...]
>>>>
>>>> Cheers,
>>>> S
>>>>
>>>>
>>>>> On Thu, Sep 17, 2009 at 3:58 PM, Simon Urbanek
>>>>> <simon.urbanek at r-project.org> wrote:
>>>>>>
>>>>>> On Sep 17, 2009, at 12:43 , Gabor Grothendieck wrote:
>>>>>>
>>>>>>> Thanks. Perhaps someone in the core group can
>>>>>>> still provide explicit information on how to install such
>>>>>>> a package.
>>>>>>>
>>>>>> R CMD INSTALL
>>>>>>
>>>>>> (see R --help and it has been *the* way to install packages for quite
>>>>>> a
>>>>>> while so I'm not sure how more explicit we have to make it...)
>>>>>>
>>>>>> Cheers,
>>>>>> Simon
>>>>>>
>>>>>>
>>>>>>
>>>>>>> On Thu, Sep 17, 2009 at 12:19 PM, Dirk Eddelbuettel <edd at debian.org>
>>>>>>> wrote:
>>>>>>>>
>>>>>>>> On 17 September 2009 at 11:32, Gabor Grothendieck wrote:
>>>>>>>> | Regarding this from this week:
>>>>>>>> |
>>>>>>>> | 2.10.0 PACKAGE INSTALLATION (Windows)
>>>>>>>> | It is possible to install source packages without Rtools provided
>>>>>>>> they
>>>>>>>> | have no compiled code and no configure.win or cleanup.win script.
>>>>>>>> |
>>>>>>>> | - what are the instructions to perform such a source install?
>>>>>>>> | - I assume one still needs MiKTeX -- is that right?
>>>>>>>> | - is the source install done from a tar.gz (in which case one
>>>>>>>> would
>>>>>>>> | need tar to create it) or directly from the source directory tree?
>>>>>>>>
>>>>>>>> You may want to stick this
>>>>>>>>
>>>>>>>> ? http://developer.r-project.org/blosxom.cgi/R-devel
>>>>>>>>
>>>>>>>> into your RSS reader so that you get daily summaries of changes.
>>>>>>>>
>>>>>>>> I don't follow this too religiously (as I typically only built
>>>>>>>> r-devel
>>>>>>>> once we have
>>>>>>>> alpha/beta/rc candidates) but even I am aware that
>>>>>>>>
>>>>>>>> ? a) dynamic .Rd conversion at runtime, so Miktex may no longer be
>>>>>>>> needed
>>>>>>>>
>>>>>>>> ? b) untgz.exe on Windows to read (compressed) tarballs
>>>>>>>>
>>>>>>>> Dirk
>>>>>>>>
>>>>>>>> --
>>>>>>>> Three out of two people have difficulties with fractions.
>>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>
>>>>>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
>


From murdoch at stats.uwo.ca  Fri Sep 18 00:32:18 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 17 Sep 2009 18:32:18 -0400
Subject: [Rd] Windows Source Install Without Rtools
In-Reply-To: <971536df0909171507s350224d2w4d831cd1ac073b79@mail.gmail.com>
References: <971536df0909170832v3c675fb1l9a3b4403516ec391@mail.gmail.com>
	<19122.24949.329620.857305@ron.nulle.part>
	<971536df0909170943p6deed018jb54b8cdd82980e45@mail.gmail.com>
	<923DDBAD-EC7A-4446-B33B-728208473003@r-project.org>
	<971536df0909171309oc7a21fcs5cbe5563fb5fdcb2@mail.gmail.com>
	<4F99D751-F645-4185-B255-631F9DD9C653@r-project.org>
	<971536df0909171340i1c36841fj90ef3b9c5792685e@mail.gmail.com>
	<4AB2B054.7000008@stats.uwo.ca> <4AB2B0C4.1010109@stats.uwo.ca>
	<971536df0909171507s350224d2w4d831cd1ac073b79@mail.gmail.com>
Message-ID: <4AB2B8F2.4080304@stats.uwo.ca>

Gabor Grothendieck wrote:
> Does that mean that
>
>    Rcmd INSTALL --binary myPackage/
>
> is still ok or should one use:
>   

No, that has never worked.  Please follow Simon's advice, and read the 
manual.

Duncan Murdoch
>    Rcmd INSTALL myPackage/
>
> without --binary and is this advice the same with and without Rtools?
>
> Also, as there is potential confusion here could the combinations of flags
> that are not recommended result in a warning? In the latter case at least
> one knows right off that its not the thing to do and can immediately abort
> and try something else if they don't want to suffer the consequences of
> bad help linking.
>
> On Thu, Sep 17, 2009 at 5:57 PM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>   
>> On 17/09/2009 5:55 PM, Duncan Murdoch wrote:
>>     
>>> On 17/09/2009 4:40 PM, Gabor Grothendieck wrote:
>>>       
>>>> Maybe on other platforms but on Windows
>>>> help does not get linked properly with all
>>>> variations.
>>>>         
>>> I think you are thinking of building binaries, not installing packages.
>>>  Generally the only variation we advise against is
>>>
>>> R CMD build --binary
>>>
>>> Everything else should work fine, as far as I know.
>>>       
>> And I forgot to add:  the way HTML help is handled in the upcoming 2.10.0 is
>> different, so I suspect R CMD build --binary will work.  I haven't tested it
>> though...
>>
>> Duncan Murdoch
>>
>>     
>>> Duncan Murdoch
>>>
>>>       
>>>> On Thu, Sep 17, 2009 at 4:27 PM, Simon Urbanek
>>>> <simon.urbanek at r-project.org> wrote:
>>>>         
>>>>> On Sep 17, 2009, at 16:09 , Gabor Grothendieck wrote:
>>>>>
>>>>>           
>>>>>> Note that that is not currently the recommended way.
>>>>>>
>>>>>>             
>>>>> Now that would be a surprise to me - to quote R-admin: 6.3.1: "R CMD
>>>>> INSTALL
>>>>> works in Windows to install source packages if you have the source-code
>>>>> package files".
>>>>>
>>>>>
>>>>>           
>>>>>> Also, what comes after INSTALL? The source .tar.gz name?
>>>>>> The pathname to the source directory?
>>>>>>
>>>>>>             
>>>>> R CMD INSTALL --help
>>>>>
>>>>> Usage: R CMD INSTALL [options] pkgs
>>>>>
>>>>> Install the add-on packages specified by pkgs.  The elements of pkgs can
>>>>> be relative or absolute paths to directories with the package (bundle)
>>>>> sources, or to gzipped package 'tar' archives.  The library tree
>>>>> [...]
>>>>>
>>>>> Cheers,
>>>>> S
>>>>>
>>>>>
>>>>>           
>>>>>> On Thu, Sep 17, 2009 at 3:58 PM, Simon Urbanek
>>>>>> <simon.urbanek at r-project.org> wrote:
>>>>>>             
>>>>>>> On Sep 17, 2009, at 12:43 , Gabor Grothendieck wrote:
>>>>>>>
>>>>>>>               
>>>>>>>> Thanks. Perhaps someone in the core group can
>>>>>>>> still provide explicit information on how to install such
>>>>>>>> a package.
>>>>>>>>
>>>>>>>>                 
>>>>>>> R CMD INSTALL
>>>>>>>
>>>>>>> (see R --help and it has been *the* way to install packages for quite
>>>>>>> a
>>>>>>> while so I'm not sure how more explicit we have to make it...)
>>>>>>>
>>>>>>> Cheers,
>>>>>>> Simon
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>               
>>>>>>>> On Thu, Sep 17, 2009 at 12:19 PM, Dirk Eddelbuettel <edd at debian.org>
>>>>>>>> wrote:
>>>>>>>>                 
>>>>>>>>> On 17 September 2009 at 11:32, Gabor Grothendieck wrote:
>>>>>>>>> | Regarding this from this week:
>>>>>>>>> |
>>>>>>>>> | 2.10.0 PACKAGE INSTALLATION (Windows)
>>>>>>>>> | It is possible to install source packages without Rtools provided
>>>>>>>>> they
>>>>>>>>> | have no compiled code and no configure.win or cleanup.win script.
>>>>>>>>> |
>>>>>>>>> | - what are the instructions to perform such a source install?
>>>>>>>>> | - I assume one still needs MiKTeX -- is that right?
>>>>>>>>> | - is the source install done from a tar.gz (in which case one
>>>>>>>>> would
>>>>>>>>> | need tar to create it) or directly from the source directory tree?
>>>>>>>>>
>>>>>>>>> You may want to stick this
>>>>>>>>>
>>>>>>>>>   http://developer.r-project.org/blosxom.cgi/R-devel
>>>>>>>>>
>>>>>>>>> into your RSS reader so that you get daily summaries of changes.
>>>>>>>>>
>>>>>>>>> I don't follow this too religiously (as I typically only built
>>>>>>>>> r-devel
>>>>>>>>> once we have
>>>>>>>>> alpha/beta/rc candidates) but even I am aware that
>>>>>>>>>
>>>>>>>>>   a) dynamic .Rd conversion at runtime, so Miktex may no longer be
>>>>>>>>> needed
>>>>>>>>>
>>>>>>>>>   b) untgz.exe on Windows to read (compressed) tarballs
>>>>>>>>>
>>>>>>>>> Dirk
>>>>>>>>>
>>>>>>>>> --
>>>>>>>>> Three out of two people have difficulties with fractions.
>>>>>>>>>
>>>>>>>>>                   
>>>>>>>> ______________________________________________
>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>
>>>>>>>>
>>>>>>>>                 
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>         
>>>       
>>


From ggrothendieck at gmail.com  Fri Sep 18 01:47:33 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 17 Sep 2009 19:47:33 -0400
Subject: [Rd] Windows Source Install Without Rtools
In-Reply-To: <4AB2B8F2.4080304@stats.uwo.ca>
References: <971536df0909170832v3c675fb1l9a3b4403516ec391@mail.gmail.com> 
	<971536df0909170943p6deed018jb54b8cdd82980e45@mail.gmail.com> 
	<923DDBAD-EC7A-4446-B33B-728208473003@r-project.org>
	<971536df0909171309oc7a21fcs5cbe5563fb5fdcb2@mail.gmail.com> 
	<4F99D751-F645-4185-B255-631F9DD9C653@r-project.org>
	<971536df0909171340i1c36841fj90ef3b9c5792685e@mail.gmail.com> 
	<4AB2B054.7000008@stats.uwo.ca> <4AB2B0C4.1010109@stats.uwo.ca> 
	<971536df0909171507s350224d2w4d831cd1ac073b79@mail.gmail.com> 
	<4AB2B8F2.4080304@stats.uwo.ca>
Message-ID: <971536df0909171647h1bb1b2fbr52465ef40e5e1ba1@mail.gmail.com>

I meant to write:

Rcmd INSTALL --build myPackage/

vs.

Rcmd INSTALL myPackage/

You, yourself, have mentioned the problem of linking help
pages on r-devel within the last few months:

http://tolstoy.newcastle.edu.au/R/e6/devel/09/05/1721.html

and now that this is all changing it would be helpful to have comments
on what now works best on Windows with the new change.

On Thu, Sep 17, 2009 at 6:32 PM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> Gabor Grothendieck wrote:
>>
>> Does that mean that
>>
>> ? Rcmd INSTALL --binary myPackage/
>>
>> is still ok or should one use:
>>
>
> No, that has never worked. ?Please follow Simon's advice, and read the
> manual.
>
> Duncan Murdoch
>>
>> ? Rcmd INSTALL myPackage/
>>
>> without --binary and is this advice the same with and without Rtools?
>>
>> Also, as there is potential confusion here could the combinations of flags
>> that are not recommended result in a warning? In the latter case at least
>> one knows right off that its not the thing to do and can immediately abort
>> and try something else if they don't want to suffer the consequences of
>> bad help linking.
>>
>> On Thu, Sep 17, 2009 at 5:57 PM, Duncan Murdoch <murdoch at stats.uwo.ca>
>> wrote:
>>
>>>
>>> On 17/09/2009 5:55 PM, Duncan Murdoch wrote:
>>>
>>>>
>>>> On 17/09/2009 4:40 PM, Gabor Grothendieck wrote:
>>>>
>>>>>
>>>>> Maybe on other platforms but on Windows
>>>>> help does not get linked properly with all
>>>>> variations.
>>>>>
>>>>
>>>> I think you are thinking of building binaries, not installing packages.
>>>> ?Generally the only variation we advise against is
>>>>
>>>> R CMD build --binary
>>>>
>>>> Everything else should work fine, as far as I know.
>>>>
>>>
>>> And I forgot to add: ?the way HTML help is handled in the upcoming 2.10.0
>>> is
>>> different, so I suspect R CMD build --binary will work. ?I haven't tested
>>> it
>>> though...
>>>
>>> Duncan Murdoch
>>>
>>>
>>>>
>>>> Duncan Murdoch
>>>>
>>>>
>>>>>
>>>>> On Thu, Sep 17, 2009 at 4:27 PM, Simon Urbanek
>>>>> <simon.urbanek at r-project.org> wrote:
>>>>>
>>>>>>
>>>>>> On Sep 17, 2009, at 16:09 , Gabor Grothendieck wrote:
>>>>>>
>>>>>>
>>>>>>>
>>>>>>> Note that that is not currently the recommended way.
>>>>>>>
>>>>>>>
>>>>>>
>>>>>> Now that would be a surprise to me - to quote R-admin: 6.3.1: "R CMD
>>>>>> INSTALL
>>>>>> works in Windows to install source packages if you have the
>>>>>> source-code
>>>>>> package files".
>>>>>>
>>>>>>
>>>>>>
>>>>>>>
>>>>>>> Also, what comes after INSTALL? The source .tar.gz name?
>>>>>>> The pathname to the source directory?
>>>>>>>
>>>>>>>
>>>>>>
>>>>>> R CMD INSTALL --help
>>>>>>
>>>>>> Usage: R CMD INSTALL [options] pkgs
>>>>>>
>>>>>> Install the add-on packages specified by pkgs. ?The elements of pkgs
>>>>>> can
>>>>>> be relative or absolute paths to directories with the package (bundle)
>>>>>> sources, or to gzipped package 'tar' archives. ?The library tree
>>>>>> [...]
>>>>>>
>>>>>> Cheers,
>>>>>> S
>>>>>>
>>>>>>
>>>>>>
>>>>>>>
>>>>>>> On Thu, Sep 17, 2009 at 3:58 PM, Simon Urbanek
>>>>>>> <simon.urbanek at r-project.org> wrote:
>>>>>>>
>>>>>>>>
>>>>>>>> On Sep 17, 2009, at 12:43 , Gabor Grothendieck wrote:
>>>>>>>>
>>>>>>>>
>>>>>>>>>
>>>>>>>>> Thanks. Perhaps someone in the core group can
>>>>>>>>> still provide explicit information on how to install such
>>>>>>>>> a package.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>
>>>>>>>> R CMD INSTALL
>>>>>>>>
>>>>>>>> (see R --help and it has been *the* way to install packages for
>>>>>>>> quite
>>>>>>>> a
>>>>>>>> while so I'm not sure how more explicit we have to make it...)
>>>>>>>>
>>>>>>>> Cheers,
>>>>>>>> Simon
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>>
>>>>>>>>> On Thu, Sep 17, 2009 at 12:19 PM, Dirk Eddelbuettel
>>>>>>>>> <edd at debian.org>
>>>>>>>>> wrote:
>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> On 17 September 2009 at 11:32, Gabor Grothendieck wrote:
>>>>>>>>>> | Regarding this from this week:
>>>>>>>>>> |
>>>>>>>>>> | 2.10.0 PACKAGE INSTALLATION (Windows)
>>>>>>>>>> | It is possible to install source packages without Rtools
>>>>>>>>>> provided
>>>>>>>>>> they
>>>>>>>>>> | have no compiled code and no configure.win or cleanup.win
>>>>>>>>>> script.
>>>>>>>>>> |
>>>>>>>>>> | - what are the instructions to perform such a source install?
>>>>>>>>>> | - I assume one still needs MiKTeX -- is that right?
>>>>>>>>>> | - is the source install done from a tar.gz (in which case one
>>>>>>>>>> would
>>>>>>>>>> | need tar to create it) or directly from the source directory
>>>>>>>>>> tree?
>>>>>>>>>>
>>>>>>>>>> You may want to stick this
>>>>>>>>>>
>>>>>>>>>> ?http://developer.r-project.org/blosxom.cgi/R-devel
>>>>>>>>>>
>>>>>>>>>> into your RSS reader so that you get daily summaries of changes.
>>>>>>>>>>
>>>>>>>>>> I don't follow this too religiously (as I typically only built
>>>>>>>>>> r-devel
>>>>>>>>>> once we have
>>>>>>>>>> alpha/beta/rc candidates) but even I am aware that
>>>>>>>>>>
>>>>>>>>>> ?a) dynamic .Rd conversion at runtime, so Miktex may no longer be
>>>>>>>>>> needed
>>>>>>>>>>
>>>>>>>>>> ?b) untgz.exe on Windows to read (compressed) tarballs
>>>>>>>>>>
>>>>>>>>>> Dirk
>>>>>>>>>>
>>>>>>>>>> --
>>>>>>>>>> Three out of two people have difficulties with fractions.
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>
>>>>>>>>> ______________________________________________
>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>
>>>>
>>>
>>>
>
>


From murdoch at stats.uwo.ca  Fri Sep 18 02:09:47 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 17 Sep 2009 20:09:47 -0400
Subject: [Rd] Windows Source Install Without Rtools
In-Reply-To: <971536df0909171647h1bb1b2fbr52465ef40e5e1ba1@mail.gmail.com>
References: <971536df0909170832v3c675fb1l9a3b4403516ec391@mail.gmail.com>
	<971536df0909170943p6deed018jb54b8cdd82980e45@mail.gmail.com>
	<923DDBAD-EC7A-4446-B33B-728208473003@r-project.org>
	<971536df0909171309oc7a21fcs5cbe5563fb5fdcb2@mail.gmail.com>
	<4F99D751-F645-4185-B255-631F9DD9C653@r-project.org>
	<971536df0909171340i1c36841fj90ef3b9c5792685e@mail.gmail.com>
	<4AB2B054.7000008@stats.uwo.ca> <4AB2B0C4.1010109@stats.uwo.ca>
	<971536df0909171507s350224d2w4d831cd1ac073b79@mail.gmail.com>
	<4AB2B8F2.4080304@stats.uwo.ca>
	<971536df0909171647h1bb1b2fbr52465ef40e5e1ba1@mail.gmail.com>
Message-ID: <4AB2CFCB.3040903@stats.uwo.ca>

On 17/09/2009 7:47 PM, Gabor Grothendieck wrote:
> I meant to write:
> 
> Rcmd INSTALL --build myPackage/
> 
> vs.
> 
> Rcmd INSTALL myPackage/
> 
> You, yourself, have mentioned the problem of linking help
> pages on r-devel within the last few months:

More recently than that.  This is the problem I was referring to in the 
messages you quote below.

> http://tolstoy.newcastle.edu.au/R/e6/devel/09/05/1721.html
> 
> and now that this is all changing it would be helpful to have comments
> on what now works best on Windows with the new change.

Why don't you try the new system, and report on what goes wrong?  There 
is still time to fix it, so writing advice on what doesn't work seems a 
little premature.

Duncan Murdoch

> 
> On Thu, Sep 17, 2009 at 6:32 PM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> Gabor Grothendieck wrote:
>>> Does that mean that
>>>
>>>   Rcmd INSTALL --binary myPackage/
>>>
>>> is still ok or should one use:
>>>
>> No, that has never worked.  Please follow Simon's advice, and read the
>> manual.
>>
>> Duncan Murdoch
>>>   Rcmd INSTALL myPackage/
>>>
>>> without --binary and is this advice the same with and without Rtools?
>>>
>>> Also, as there is potential confusion here could the combinations of flags
>>> that are not recommended result in a warning? In the latter case at least
>>> one knows right off that its not the thing to do and can immediately abort
>>> and try something else if they don't want to suffer the consequences of
>>> bad help linking.
>>>
>>> On Thu, Sep 17, 2009 at 5:57 PM, Duncan Murdoch <murdoch at stats.uwo.ca>
>>> wrote:
>>>
>>>> On 17/09/2009 5:55 PM, Duncan Murdoch wrote:
>>>>
>>>>> On 17/09/2009 4:40 PM, Gabor Grothendieck wrote:
>>>>>
>>>>>> Maybe on other platforms but on Windows
>>>>>> help does not get linked properly with all
>>>>>> variations.
>>>>>>
>>>>> I think you are thinking of building binaries, not installing packages.
>>>>>  Generally the only variation we advise against is
>>>>>
>>>>> R CMD build --binary
>>>>>
>>>>> Everything else should work fine, as far as I know.
>>>>>
>>>> And I forgot to add:  the way HTML help is handled in the upcoming 2.10.0
>>>> is
>>>> different, so I suspect R CMD build --binary will work.  I haven't tested
>>>> it
>>>> though...
>>>>
>>>> Duncan Murdoch
>>>>
>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>
>>>>>> On Thu, Sep 17, 2009 at 4:27 PM, Simon Urbanek
>>>>>> <simon.urbanek at r-project.org> wrote:
>>>>>>
>>>>>>> On Sep 17, 2009, at 16:09 , Gabor Grothendieck wrote:
>>>>>>>
>>>>>>>
>>>>>>>> Note that that is not currently the recommended way.
>>>>>>>>
>>>>>>>>
>>>>>>> Now that would be a surprise to me - to quote R-admin: 6.3.1: "R CMD
>>>>>>> INSTALL
>>>>>>> works in Windows to install source packages if you have the
>>>>>>> source-code
>>>>>>> package files".
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>> Also, what comes after INSTALL? The source .tar.gz name?
>>>>>>>> The pathname to the source directory?
>>>>>>>>
>>>>>>>>
>>>>>>> R CMD INSTALL --help
>>>>>>>
>>>>>>> Usage: R CMD INSTALL [options] pkgs
>>>>>>>
>>>>>>> Install the add-on packages specified by pkgs.  The elements of pkgs
>>>>>>> can
>>>>>>> be relative or absolute paths to directories with the package (bundle)
>>>>>>> sources, or to gzipped package 'tar' archives.  The library tree
>>>>>>> [...]
>>>>>>>
>>>>>>> Cheers,
>>>>>>> S
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>> On Thu, Sep 17, 2009 at 3:58 PM, Simon Urbanek
>>>>>>>> <simon.urbanek at r-project.org> wrote:
>>>>>>>>
>>>>>>>>> On Sep 17, 2009, at 12:43 , Gabor Grothendieck wrote:
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>> Thanks. Perhaps someone in the core group can
>>>>>>>>>> still provide explicit information on how to install such
>>>>>>>>>> a package.
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>> R CMD INSTALL
>>>>>>>>>
>>>>>>>>> (see R --help and it has been *the* way to install packages for
>>>>>>>>> quite
>>>>>>>>> a
>>>>>>>>> while so I'm not sure how more explicit we have to make it...)
>>>>>>>>>
>>>>>>>>> Cheers,
>>>>>>>>> Simon
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>> On Thu, Sep 17, 2009 at 12:19 PM, Dirk Eddelbuettel
>>>>>>>>>> <edd at debian.org>
>>>>>>>>>> wrote:
>>>>>>>>>>
>>>>>>>>>>> On 17 September 2009 at 11:32, Gabor Grothendieck wrote:
>>>>>>>>>>> | Regarding this from this week:
>>>>>>>>>>> |
>>>>>>>>>>> | 2.10.0 PACKAGE INSTALLATION (Windows)
>>>>>>>>>>> | It is possible to install source packages without Rtools
>>>>>>>>>>> provided
>>>>>>>>>>> they
>>>>>>>>>>> | have no compiled code and no configure.win or cleanup.win
>>>>>>>>>>> script.
>>>>>>>>>>> |
>>>>>>>>>>> | - what are the instructions to perform such a source install?
>>>>>>>>>>> | - I assume one still needs MiKTeX -- is that right?
>>>>>>>>>>> | - is the source install done from a tar.gz (in which case one
>>>>>>>>>>> would
>>>>>>>>>>> | need tar to create it) or directly from the source directory
>>>>>>>>>>> tree?
>>>>>>>>>>>
>>>>>>>>>>> You may want to stick this
>>>>>>>>>>>
>>>>>>>>>>>  http://developer.r-project.org/blosxom.cgi/R-devel
>>>>>>>>>>>
>>>>>>>>>>> into your RSS reader so that you get daily summaries of changes.
>>>>>>>>>>>
>>>>>>>>>>> I don't follow this too religiously (as I typically only built
>>>>>>>>>>> r-devel
>>>>>>>>>>> once we have
>>>>>>>>>>> alpha/beta/rc candidates) but even I am aware that
>>>>>>>>>>>
>>>>>>>>>>>  a) dynamic .Rd conversion at runtime, so Miktex may no longer be
>>>>>>>>>>> needed
>>>>>>>>>>>
>>>>>>>>>>>  b) untgz.exe on Windows to read (compressed) tarballs
>>>>>>>>>>>
>>>>>>>>>>> Dirk
>>>>>>>>>>>
>>>>>>>>>>> --
>>>>>>>>>>> Three out of two people have difficulties with fractions.
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>> ______________________________________________
>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>
>>>>>
>>>>
>>


From ggrothendieck at gmail.com  Fri Sep 18 02:36:10 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 17 Sep 2009 20:36:10 -0400
Subject: [Rd] Windows Source Install Without Rtools
In-Reply-To: <4AB2CFCB.3040903@stats.uwo.ca>
References: <971536df0909170832v3c675fb1l9a3b4403516ec391@mail.gmail.com> 
	<971536df0909171309oc7a21fcs5cbe5563fb5fdcb2@mail.gmail.com> 
	<4F99D751-F645-4185-B255-631F9DD9C653@r-project.org>
	<971536df0909171340i1c36841fj90ef3b9c5792685e@mail.gmail.com> 
	<4AB2B054.7000008@stats.uwo.ca> <4AB2B0C4.1010109@stats.uwo.ca> 
	<971536df0909171507s350224d2w4d831cd1ac073b79@mail.gmail.com> 
	<4AB2B8F2.4080304@stats.uwo.ca>
	<971536df0909171647h1bb1b2fbr52465ef40e5e1ba1@mail.gmail.com> 
	<4AB2CFCB.3040903@stats.uwo.ca>
Message-ID: <971536df0909171736xa290b35y1d3e99585785d62d@mail.gmail.com>

The software and manuals are not yet in readily accessible
form on CRAN based on the date of the feature and I would
prefer not to have to build it myself when any day now it will
be there automatically anyways.

Also, I was hoping to avoid a frustrating session of trial and error
when surely someone in the core team already knows the likely
answer. Building a package takes time and repeatedly trying it
with different flags is time consuming.

We are only discussing one line of code:

  R CMD ...something...


On Thu, Sep 17, 2009 at 8:09 PM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 17/09/2009 7:47 PM, Gabor Grothendieck wrote:
>>
>> I meant to write:
>>
>> Rcmd INSTALL --build myPackage/
>>
>> vs.
>>
>> Rcmd INSTALL myPackage/
>>
>> You, yourself, have mentioned the problem of linking help
>> pages on r-devel within the last few months:
>
> More recently than that. ?This is the problem I was referring to in the
> messages you quote below.
>
>> http://tolstoy.newcastle.edu.au/R/e6/devel/09/05/1721.html
>>
>> and now that this is all changing it would be helpful to have comments
>> on what now works best on Windows with the new change.
>
> Why don't you try the new system, and report on what goes wrong? ?There is
> still time to fix it, so writing advice on what doesn't work seems a little
> premature.
>
> Duncan Murdoch
>
>>
>> On Thu, Sep 17, 2009 at 6:32 PM, Duncan Murdoch <murdoch at stats.uwo.ca>
>> wrote:
>>>
>>> Gabor Grothendieck wrote:
>>>>
>>>> Does that mean that
>>>>
>>>> ?Rcmd INSTALL --binary myPackage/
>>>>
>>>> is still ok or should one use:
>>>>
>>> No, that has never worked. ?Please follow Simon's advice, and read the
>>> manual.
>>>
>>> Duncan Murdoch
>>>>
>>>> ?Rcmd INSTALL myPackage/
>>>>
>>>> without --binary and is this advice the same with and without Rtools?
>>>>
>>>> Also, as there is potential confusion here could the combinations of
>>>> flags
>>>> that are not recommended result in a warning? In the latter case at
>>>> least
>>>> one knows right off that its not the thing to do and can immediately
>>>> abort
>>>> and try something else if they don't want to suffer the consequences of
>>>> bad help linking.
>>>>
>>>> On Thu, Sep 17, 2009 at 5:57 PM, Duncan Murdoch <murdoch at stats.uwo.ca>
>>>> wrote:
>>>>
>>>>> On 17/09/2009 5:55 PM, Duncan Murdoch wrote:
>>>>>
>>>>>> On 17/09/2009 4:40 PM, Gabor Grothendieck wrote:
>>>>>>
>>>>>>> Maybe on other platforms but on Windows
>>>>>>> help does not get linked properly with all
>>>>>>> variations.
>>>>>>>
>>>>>> I think you are thinking of building binaries, not installing
>>>>>> packages.
>>>>>> ?Generally the only variation we advise against is
>>>>>>
>>>>>> R CMD build --binary
>>>>>>
>>>>>> Everything else should work fine, as far as I know.
>>>>>>
>>>>> And I forgot to add: ?the way HTML help is handled in the upcoming
>>>>> 2.10.0
>>>>> is
>>>>> different, so I suspect R CMD build --binary will work. ?I haven't
>>>>> tested
>>>>> it
>>>>> though...
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>
>>>>>>> On Thu, Sep 17, 2009 at 4:27 PM, Simon Urbanek
>>>>>>> <simon.urbanek at r-project.org> wrote:
>>>>>>>
>>>>>>>> On Sep 17, 2009, at 16:09 , Gabor Grothendieck wrote:
>>>>>>>>
>>>>>>>>
>>>>>>>>> Note that that is not currently the recommended way.
>>>>>>>>>
>>>>>>>>>
>>>>>>>> Now that would be a surprise to me - to quote R-admin: 6.3.1: "R CMD
>>>>>>>> INSTALL
>>>>>>>> works in Windows to install source packages if you have the
>>>>>>>> source-code
>>>>>>>> package files".
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>> Also, what comes after INSTALL? The source .tar.gz name?
>>>>>>>>> The pathname to the source directory?
>>>>>>>>>
>>>>>>>>>
>>>>>>>> R CMD INSTALL --help
>>>>>>>>
>>>>>>>> Usage: R CMD INSTALL [options] pkgs
>>>>>>>>
>>>>>>>> Install the add-on packages specified by pkgs. ?The elements of pkgs
>>>>>>>> can
>>>>>>>> be relative or absolute paths to directories with the package
>>>>>>>> (bundle)
>>>>>>>> sources, or to gzipped package 'tar' archives. ?The library tree
>>>>>>>> [...]
>>>>>>>>
>>>>>>>> Cheers,
>>>>>>>> S
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>> On Thu, Sep 17, 2009 at 3:58 PM, Simon Urbanek
>>>>>>>>> <simon.urbanek at r-project.org> wrote:
>>>>>>>>>
>>>>>>>>>> On Sep 17, 2009, at 12:43 , Gabor Grothendieck wrote:
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>> Thanks. Perhaps someone in the core group can
>>>>>>>>>>> still provide explicit information on how to install such
>>>>>>>>>>> a package.
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>> R CMD INSTALL
>>>>>>>>>>
>>>>>>>>>> (see R --help and it has been *the* way to install packages for
>>>>>>>>>> quite
>>>>>>>>>> a
>>>>>>>>>> while so I'm not sure how more explicit we have to make it...)
>>>>>>>>>>
>>>>>>>>>> Cheers,
>>>>>>>>>> Simon
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>> On Thu, Sep 17, 2009 at 12:19 PM, Dirk Eddelbuettel
>>>>>>>>>>> <edd at debian.org>
>>>>>>>>>>> wrote:
>>>>>>>>>>>
>>>>>>>>>>>> On 17 September 2009 at 11:32, Gabor Grothendieck wrote:
>>>>>>>>>>>> | Regarding this from this week:
>>>>>>>>>>>> |
>>>>>>>>>>>> | 2.10.0 PACKAGE INSTALLATION (Windows)
>>>>>>>>>>>> | It is possible to install source packages without Rtools
>>>>>>>>>>>> provided
>>>>>>>>>>>> they
>>>>>>>>>>>> | have no compiled code and no configure.win or cleanup.win
>>>>>>>>>>>> script.
>>>>>>>>>>>> |
>>>>>>>>>>>> | - what are the instructions to perform such a source install?
>>>>>>>>>>>> | - I assume one still needs MiKTeX -- is that right?
>>>>>>>>>>>> | - is the source install done from a tar.gz (in which case one
>>>>>>>>>>>> would
>>>>>>>>>>>> | need tar to create it) or directly from the source directory
>>>>>>>>>>>> tree?
>>>>>>>>>>>>
>>>>>>>>>>>> You may want to stick this
>>>>>>>>>>>>
>>>>>>>>>>>> ?http://developer.r-project.org/blosxom.cgi/R-devel
>>>>>>>>>>>>
>>>>>>>>>>>> into your RSS reader so that you get daily summaries of changes.
>>>>>>>>>>>>
>>>>>>>>>>>> I don't follow this too religiously (as I typically only built
>>>>>>>>>>>> r-devel
>>>>>>>>>>>> once we have
>>>>>>>>>>>> alpha/beta/rc candidates) but even I am aware that
>>>>>>>>>>>>
>>>>>>>>>>>> ?a) dynamic .Rd conversion at runtime, so Miktex may no longer
>>>>>>>>>>>> be
>>>>>>>>>>>> needed
>>>>>>>>>>>>
>>>>>>>>>>>> ?b) untgz.exe on Windows to read (compressed) tarballs
>>>>>>>>>>>>
>>>>>>>>>>>> Dirk
>>>>>>>>>>>>
>>>>>>>>>>>> --
>>>>>>>>>>>> Three out of two people have difficulties with fractions.
>>>>>>>>>>>>
>>>>>>>>>>>>
>>>>>>>>>>> ______________________________________________
>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>
>>>>>>
>>>>>
>>>
>
>


From liam.gretton at leicester.ac.uk  Fri Sep 18 11:10:15 2009
From: liam.gretton at leicester.ac.uk (liam.gretton at leicester.ac.uk)
Date: Fri, 18 Sep 2009 11:10:15 +0200 (CEST)
Subject: [Rd] Reading clipboard with read.delim("clipboard") crash (PR#13957)
Message-ID: <20090918091015.C9EA3282EF2D@mail.pubhealth.ku.dk>

Full_Name: Liam Gretton
Version: 2.9.2
OS: openSUSE 11.1 (x86_64)
Submission from: (NULL) (143.210.13.77)


Reading a large number of rows of delimited data via the clipboard results in a
segfault or double free error. I've tested copying from various applications,
but gedit will do.

This problem exists in the openSUSE-supplied 2.8.1, I've just built 2.9.2 to see
if it's still there, and it is.

I can provide an example delimited file which demonstrates the problem; it
contains about 18000 rows and 7 columns of data. read.delim("clipboard") tends
to fail when only reading ~1500 rows, though I haven't been able to reproduce
the point at which it fails.

Reading exactly the same data from a file using read.csv("file.csv") is
successful.

Problem reproduced as so:

Data copied to the clipboard in Gnome.

> R
R version 2.9.2 (2009-08-24)
[snip]

> data <- read.delim("clipboard")

 *** caught segfault ***
address 0x18, cause 'memory not mapped'

Traceback:
 1: file(file, "r")
 2: read.table(file = file, header = header, sep = sep, quote = quote,     dec =
dec, fill = fill, comment.char = comment.char, ...)
 3: read.delim("clipboard")

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace

On a different (but similar) openSUSE 11.1 system, the command still fails but
reports:

*** glibc detected *** /usr/local/R-2.9.2/lib64/R/bin/exec/R: double free of
corruption (!prev): 0x000000000097cb70 ***

Details of R build:

./configure --prefix=/usr/local/R-2.9.2 --enable-R-shlib --enable-mbcs
--enable-threads=posix  --with-blas  --with-lapack --with-system-zlib
--with-system-bzlib --with-system-pcre --with-gnu-ld

No additional packages installed. 'make check' passed.


From joehl at web.de  Fri Sep 18 16:15:11 2009
From: joehl at web.de (joehl at web.de)
Date: Fri, 18 Sep 2009 16:15:11 +0200 (CEST)
Subject: [Rd] basename returns "." not in filename (PR#13958)
Message-ID: <20090918141511.30E4A282EF4E@mail.pubhealth.ku.dk>

Full_Name: Jens Oehlschl?gel
Version: 2.9.2
OS: Win32
Submission from: (NULL) (85.181.152.156)


# Obviously an empty basename is allowed (if the filepath is a pure path)
> basename("/")
[1] ""

# but here we get the dot from the path
> basename("./")
[1] "."

> version
               _                           
platform       i386-pc-mingw32             
arch           i386                        
os             mingw32                     
system         i386, mingw32               
status                                     
major          2                           
minor          9.2                         
year           2009                        
month          08                          
day            24                          
svn rev        49384                       
language       R                           
version.string R version 2.9.2 (2009-08-24)


From ligges at statistik.tu-dortmund.de  Fri Sep 18 18:03:39 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 18 Sep 2009 18:03:39 +0200
Subject: [Rd] winbuilder down
Message-ID: <4AB3AF5B.8040904@statistik.tu-dortmund.de>

Dear developers,

the winbuilder service and CRAN windows binary package built service 
will be down for roughly 60 hours from now on due to a whole-weekend 
power outage in our floor.

Best wishes,
Uwe Ligges


From P.Dalgaard at biostat.ku.dk  Fri Sep 18 18:11:51 2009
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri, 18 Sep 2009 18:11:51 +0200
Subject: [Rd] basename returns "." not in filename (PR#13958)
In-Reply-To: <20090918141511.30E4A282EF4E@mail.pubhealth.ku.dk>
References: <20090918141511.30E4A282EF4E@mail.pubhealth.ku.dk>
Message-ID: <4AB3B147.80601@biostat.ku.dk>

joehl at web.de wrote:
> Full_Name: Jens Oehlschl?gel
> Version: 2.9.2
> OS: Win32
> Submission from: (NULL) (85.181.152.156)
> 
> 
> # Obviously an empty basename is allowed (if the filepath is a pure path)
>> basename("/")
> [1] ""
> 
> # but here we get the dot from the path
>> basename("./")
> [1] "."

Command line utility does likewise:

viggo:~/>basename ./
.

Point is, I gather, that trailing slashes are removed, e.g.,

viggo:~/>basename foo/
foo

So, not a bug.

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From simon.urbanek at r-project.org  Fri Sep 18 19:41:58 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 18 Sep 2009 13:41:58 -0400
Subject: [Rd] basename returns "." not in filename (PR#13958)
In-Reply-To: <4AB3B147.80601@biostat.ku.dk>
References: <20090918141511.30E4A282EF4E@mail.pubhealth.ku.dk>
	<4AB3B147.80601@biostat.ku.dk>
Message-ID: <69C8D027-4B85-4B84-85FD-3F93B0CA99BD@r-project.org>


On Sep 18, 2009, at 12:11 , Peter Dalgaard wrote:

> joehl at web.de wrote:
>> Full_Name: Jens Oehlschl?gel
>> Version: 2.9.2
>> OS: Win32
>> Submission from: (NULL) (85.181.152.156)
>>
>>
>> # Obviously an empty basename is allowed (if the filepath is a pure  
>> path)
>>> basename("/")
>> [1] ""
>>
>> # but here we get the dot from the path
>>> basename("./")
>> [1] "."
>
> Command line utility does likewise:
>
> viggo:~/>basename ./
> .
>
> Point is, I gather, that trailing slashes are removed, e.g.,
>
> viggo:~/>basename foo/
> foo
>
> So, not a bug.
>

Indeed. The rationale is that foo/bar/ specifies a directory "bar" at  
the path "/foo", hence the name is "bar" ("" would make no sense of  
course).

Cheers,
Simon


From murdoch at stats.uwo.ca  Fri Sep 18 20:11:12 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 18 Sep 2009 14:11:12 -0400
Subject: [Rd] 2.10.0 Under development (unstable) (2009-09-15 r49711)
 just	built segfaults on Debian Squeeze
In-Reply-To: <4AB195B3.3070702@stats.uwo.ca>
References: <6b93d1830909161251w2148379bg963a66dbbb931487@mail.gmail.com>
	<4AB195B3.3070702@stats.uwo.ca>
Message-ID: <4AB3CD40.3010604@stats.uwo.ca>

I've just committed (r49747) some changes that should fix the 
re-entrancy bug Mark reported the other day.  The problem was that R 
reads some files (e.g. Mark's .Rprofile) in a read-eval-print loop, and 
only parses them a few lines at a time.  This means that within that 
loop, one of the evals could cause it to start parsing something else. 
One of the changes I put in a few days ago got confused by this.

Hopefully the latest change hasn't introduced a new bug...

BTW, one of the effects of this change is that a syntax error in 
.Rprofile should now be reported on the correct line number.  In R 2.9.x 
the line number was relative to the current statement, so it was pretty 
meaningless.

Duncan Murdoch


From joehl at web.de  Fri Sep 18 21:08:15 2009
From: joehl at web.de (=?iso-8859-15?Q?Jens_Oehlschl=E4gel?=)
Date: Fri, 18 Sep 2009 21:08:15 +0200
Subject: [Rd] basename returns "." not in filename (PR#13958)
Message-ID: <1367267789@web.de>

Mmh,

> > Point is, I gather, that trailing slashes are removed, e.g.,
> >
> > viggo:~/>basename foo/
> > foo
> >
> > So, not a bug.

This unfortunately means that we cannot distinguish between 
1) a path with a filename
2) a path without a filename

For example in the next version of the ff-package we allow a user to specify a 'pattern' for all files of a ff dataframe which is path together with a fileprefix, the above means we cannot specify an empty prefix "" for the current working directory, because 

> dirname("./.")
[1] "."
> basename("./.")
[1] "."
> dirname("./")
[1] "."
> basename("./")
[1] "."

Jens Oehlschl?gel


From simon.urbanek at r-project.org  Fri Sep 18 21:30:42 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Fri, 18 Sep 2009 15:30:42 -0400
Subject: [Rd] basename returns "." not in filename (PR#13958)
In-Reply-To: <1367267789@web.de>
References: <1367267789@web.de>
Message-ID: <385E747B-2048-4C24-BCA1-B2534BEFD148@r-project.org>

Jens,

On Sep 18, 2009, at 15:08 , Jens Oehlschl?gel wrote:

> Mmh,
>
>>> Point is, I gather, that trailing slashes are removed, e.g.,
>>>
>>> viggo:~/>basename foo/
>>> foo
>>>
>>> So, not a bug.
>
> This unfortunately means that we cannot distinguish between
> 1) a path with a filename
> 2) a path without a filename
>

Of course you can - but that's unrelated to the bug report.


> For example in the next version of the ff-package we allow a user to  
> specify a 'pattern' for all files of a ff dataframe which is path  
> together with a fileprefix, the above means we cannot specify an  
> empty prefix "" for the current working directory, because
>
>> dirname("./.")
> [1] "."
>> basename("./.")
> [1] "."
>> dirname("./")
> [1] "."
>> basename("./")
> [1] "."
>

I don't see the connection - I would suggest you read the IEEE Std  
1003.1-2001 which defines the behavior of basename (and the R  
documentation for basename clearly states the behavior as well).  The  
fact that you are trying to use the wrong tool for your purpose  
doesn't mean that the tool is broken. I would advise you to ask on R- 
help how to implement your pattern specification (just FWIW it's non- 
standard and requirement of trailing slashes does lead to very nasty  
problems for the user).

Cheers,
Simon


From simon.urbanek at r-project.org  Fri Sep 18 21:35:29 2009
From: simon.urbanek at r-project.org (simon.urbanek at r-project.org)
Date: Fri, 18 Sep 2009 21:35:29 +0200 (CEST)
Subject: [Rd] basename returns "." not in filename (PR#13958)
Message-ID: <20090918193529.21C39282EFC0@mail.pubhealth.ku.dk>

Jens,

On Sep 18, 2009, at 15:08 , Jens Oehlschl=E4gel wrote:

> Mmh,
>
>>> Point is, I gather, that trailing slashes are removed, e.g.,
>>>
>>> viggo:~/>basename foo/
>>> foo
>>>
>>> So, not a bug.
>
> This unfortunately means that we cannot distinguish between
> 1) a path with a filename
> 2) a path without a filename
>

Of course you can - but that's unrelated to the bug report.


> For example in the next version of the ff-package we allow a user to =20=

> specify a 'pattern' for all files of a ff dataframe which is path =20
> together with a fileprefix, the above means we cannot specify an =20
> empty prefix "" for the current working directory, because
>
>> dirname("./.")
> [1] "."
>> basename("./.")
> [1] "."
>> dirname("./")
> [1] "."
>> basename("./")
> [1] "."
>

I don't see the connection - I would suggest you read the IEEE Std =20
1003.1-2001 which defines the behavior of basename (and the R =20
documentation for basename clearly states the behavior as well).  The =20=

fact that you are trying to use the wrong tool for your purpose =20
doesn't mean that the tool is broken. I would advise you to ask on R-=20
help how to implement your pattern specification (just FWIW it's non-=20
standard and requirement of trailing slashes does lead to very nasty =20
problems for the user).

Cheers,
Simon


From Ted.Harding at manchester.ac.uk  Fri Sep 18 23:35:37 2009
From: Ted.Harding at manchester.ac.uk ( (Ted Harding))
Date: Fri, 18 Sep 2009 22:35:37 +0100 (BST)
Subject: [Rd] basename returns "." not in filename (PR#13958)
In-Reply-To: <1367267789@web.de>
Message-ID: <XFMail.090918223537.Ted.Harding@manchester.ac.uk>

On 18-Sep-09 19:08:15, Jens Oehlschl?gel wrote:
> Mmh,
>> > Point is, I gather, that trailing slashes are removed, e.g.,
>> >
>> > viggo:~/>basename foo/
>> > foo
>> >
>> > So, not a bug.
> 
> This unfortunately means that we cannot distinguish between 
> 1) a path with a filename
> 2) a path without a filename
> 
> For example in the next version of the ff-package we allow a user to
> specify a 'pattern' for all files of a ff dataframe which is path
> together with a fileprefix, the above means we cannot specify an empty
> prefix "" for the current working directory, because 
> 
>> dirname("./.")
> [1] "."
>> basename("./.")
> [1] "."
>> dirname("./")
> [1] "."
>> basename("./")
> [1] "."
> 
> Jens Oehlschl?gel

I am getting confused by this discussion. At least on Unixoid systems,
and I believe it holds for Windows systems too, "." stands for the
current directory ("working directory").

Moreover, "./" means exactly the same as ".": If you list the files
in "./" you will get exactly the same as if you list the files in ".".

Further, "<any directory>/." means the same as "<any directory>/"
and the same as "<any directory>", so (on the same basis) "./." also
means exactly the same as ".".

Therefore the second "." in "./." is not a filename.

What the above examples of dirname and basename usage are returning
is simply a specific representation of the current working directlory.

Forgive me if I have not seen the point, but what I think I have seen
boils down to the interpretation I have given above.

Best wishes,
Ted.

--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding at manchester.ac.uk>
Fax-to-email: +44 (0)870 094 0861
Date: 18-Sep-09                                       Time: 22:35:34
------------------------------ XFMail ------------------------------


From cstrato at aon.at  Sat Sep 19 00:12:12 2009
From: cstrato at aon.at (cstrato)
Date: Sat, 19 Sep 2009 00:12:12 +0200
Subject: [Rd] Package crashes R under Windows Vista
Message-ID: <4AB405BC.7020903@aon.at>

Dear all,

Please, please I really need your help, since I am not able to solve the 
problem myself:
It seems that until now most Windows users of my Bioconductor package 
"xps" use Windows XP, but recently a user tried to use it on Windows 
Vista where it crashed R immediately. Since I assume that some users may 
migrate to the upcoming Windows 7 where the problem will be the same, I 
would appreciate any help to be able to support Vista/Windows 7, thank 
you in advance.

The problem ist that my package consists mainly of C++ code which I must 
compile with Visual C++ (Express Edition 2008), since it depends on the 
ROOT C++ framework. Windows users download and install first the ROOT 
Windows binary compiled with VC9 and then install the Windows binary of xps.

Thus package xps contains a "Makefile.win" where I use one of the 
compiler options "/MT" or "/MD", respectively, see: 
http://msdn.microsoft.com/en-us/library/2kzt1wy3.aspx

Since the Windows binary of ROOT is compiled with option "/MD" I should 
in principle use this option, however, R does not accept this option. 
Luckily, for Winodws XP I can compile xps with "/MT" and this works 
perfectly fine.

The real problem is that neither option works on Windows Vista, although 
I can run "R CMD INSTALL" in both cases. However, when loading 
"library(xps)" using Rterm.exe I get the following two cases:

1, xps compiled on Vista with option "/MD":
   new R session:
   > library(xps,lib.loc="C:/home/Rabbitus/CRAN/myRlib")
   Error in inDL(x, as.logical(local), as.logical(now), ...) :
     cannot load shared library 'C:/home/CS/CRAN/myRlib/xps/libs/xps.dll':
    LoadLibrary failure:  A DLL-Initialisationroutine failed.

Then R crashes and Vista displays a Dialogbox with the following message:
R for Windows terminal front-end does no longer function
  Anwendungszeitstempel:    4a928a5c
  Fehlermodulname:    libCore.dll_unloaded
  Fehlermodulversion:    0.0.0.0
  Fehlermodulzeitstempel:    4a4b94a1
  Ausnahmecode:    c0000005
  Ausnahmeoffset:    0413a6f0
  Betriebsystemversion:    6.0.6001.2.1.0.768.3
  Gebietsschema-ID:    1031
  Zusatzinformation 1:    b2be
  Zusatzinformation 2:    82109204b3973566ace818217390e302
  Zusatzinformation 3:    1563
  Zusatzinformation 4:    deee40b8797d25628c21b9ef47e8a50c

2, xps compiled on Vista with option "/MT":
   new R session:
   > library(xps,lib.loc="C:/home/CS/CRAN/myRlib")
   > scheme.test3 <- 
root.scheme(paste(.path.package("xps"),"schemes/SchemeTest3.root",sep="/"))
   > data.test3 <- import.data(scheme.test3, "DataTest3", 
celdir=paste(.path.package("xps"),"raw",sep="/"))

   ==========================================
   =============== STACKTRACE ===============
   ==========================================


   ==========================================
   ============= END STACKTRACE =============
   ==========================================

Then R crashes and Vista displays a Dialogbox with the following message:
R for Windows terminal front-end does no longer function
Problemsignatur:
  Problemereignisname:    APPCRASH
  Anwendungsname:    Rterm.exe
  Anwendungsversion:    2.92.49384.0
  Anwendungszeitstempel:    4a928a5c
  Fehlermodulname:    ntdll.dll
  Fehlermodulversion:    6.0.6001.18000
  Fehlermodulzeitstempel:    4791a7a6
  Ausnahmecode:    c0000005
  Ausnahmeoffset:    0006814c
  Betriebsystemversion:    6.0.6001.2.1.0.768.3
  Gebietsschema-ID:    1031
  Zusatzinformation 1:    92ec
  Zusatzinformation 2:    c556221fb8ba46fdaae5867fc20d6575
  Zusatzinformation 3:    c65f
  Zusatzinformation 4:    9d4dfe391e0e922aa627634d4d47a122


Here is the same information for Windows XP:

1, xps compiled on WinXP with option "/MD":
   new R session:
   > library(xps,lib.loc="C:/home/CS/CRAN/myRlib")

R crashes and the following Dialogbox from "Microsoft Visual C++ Runtime 
Library" is displayed:
   Runtime Error!
   Program: c:\Programme\R\R-2.9.0\bin\Rterm.exe
   R6034
   An application has made an attempt to load the C runtime library 
incorrectly.
   Please contact the application's support team for more  information.

2, xps compiled on WinXP with option "/MT":
   new R session:
   > library(xps,lib.loc="C:/home/CS/CRAN/myRlib")
Luckily, R runs w/o any  problems and this is the setting of the current 
Windows binary of "xps".

In summary, on WinXP package xps must be compiled with option "/MT" to 
be used with R.

In contrast, on Vista library(xps) does not work when compiled with 
either option:
- for option "/MT" library(xps) can be loaded but crashes R with 
"Errormodulename: "ntdll.dll"
- for option "/MD" library(xps) cannot be loaded, since the ROOT library 
"libCore.dll" cannot be loaded ("Errormodulename: "libCore.dll_unloaded")

It is important to note that on both WinXP AND Vista library "xps.dll" 
compiled with option "/MD" does work perfectly fine when running from 
within ROOT!

Please, can anybody tell me why Rterm on Vista crashes when running 
library(xps)?
It seems that for option "/MD" Rterm is not able to load the ROOT core 
library "libCore.dll", why?

Any help is greatly appreciated otherwise my package "xps" will not be 
able to run on Vista and more important, Windows 7.

Thank you in advance.
Best regards
Christian
_._._._._._._._._._._._._._._._._._
C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
V.i.e.n.n.a           A.u.s.t.r.i.a
e.m.a.i.l:        cstrato at aon.at
_._._._._._._._._._._._._._._._._._


From wdunlap at tibco.com  Sat Sep 19 00:21:53 2009
From: wdunlap at tibco.com (William Dunlap)
Date: Fri, 18 Sep 2009 15:21:53 -0700
Subject: [Rd] inconsistency in attaching attributes to NULL
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D70001CE5F94@NA-PA-VBE03.na.tibco.com>

In R-devel (svn 49628) and back to at least R 2.7.0 we get
inconsistent results when attempting to attach attributes to
a variable with the value NULL.

If we use attributes<- it finishes but changes the value to list().

   > a<-NULL
   > attributes(a)<-list(attr1="First attribute", attr2=2+2i)
   > a
   list()
   attr(,"attr1")
   [1] "First attribute"
   attr(,"attr2")
   [1] 2+2i

If we use attr<- it refuses to attach the attribute

   > b<-NULL
   > attr(b, "attr1") <- "First attribute"
   Error in attr(b, "attr1") <- "First attribute" :
     attempt to set an attribute on NULL

Is the second behavior the correct one and should attributes(x)<-list()
abort if x is NULL?

(attributes(NULL)<-list(attr="First") dies because NULL itself is not
allowed on the left side of an assignment.)

Bill Dunlap
TIBCO Software Inc - Spotfire Division
wdunlap tibco.com 


From murdoch at stats.uwo.ca  Sat Sep 19 00:33:25 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 18 Sep 2009 18:33:25 -0400
Subject: [Rd] Package crashes R under Windows Vista
In-Reply-To: <4AB405BC.7020903@aon.at>
References: <4AB405BC.7020903@aon.at>
Message-ID: <4AB40AB5.8010905@stats.uwo.ca>

On 18/09/2009 6:12 PM, cstrato wrote:
> Dear all,
> 
> Please, please I really need your help, since I am not able to solve the 
> problem myself:
> It seems that until now most Windows users of my Bioconductor package 
> "xps" use Windows XP, but recently a user tried to use it on Windows 
> Vista where it crashed R immediately. Since I assume that some users may 
> migrate to the upcoming Windows 7 where the problem will be the same, I 
> would appreciate any help to be able to support Vista/Windows 7, thank 
> you in advance.

You are requiring specific Microsoft tools to compile a package, which 
fails on one Microsoft OS, but not another.  Isn't this a question you 
should address to Microsoft?

For the record:

We support compiling in the compiler listed in the R-admin manual, which 
is available from www.murdoch-sutherland.com/Rtools.  If you choose to 
use a different compiler, you should seek support from its supplier.

Duncan Murdoch

> 
> The problem ist that my package consists mainly of C++ code which I must 
> compile with Visual C++ (Express Edition 2008), since it depends on the 
> ROOT C++ framework. Windows users download and install first the ROOT 
> Windows binary compiled with VC9 and then install the Windows binary of xps.
> 
> Thus package xps contains a "Makefile.win" where I use one of the 
> compiler options "/MT" or "/MD", respectively, see: 
> http://msdn.microsoft.com/en-us/library/2kzt1wy3.aspx
> 
> Since the Windows binary of ROOT is compiled with option "/MD" I should 
> in principle use this option, however, R does not accept this option. 
> Luckily, for Winodws XP I can compile xps with "/MT" and this works 
> perfectly fine.
> 
> The real problem is that neither option works on Windows Vista, although 
> I can run "R CMD INSTALL" in both cases. However, when loading 
> "library(xps)" using Rterm.exe I get the following two cases:
> 
> 1, xps compiled on Vista with option "/MD":
>    new R session:
>    > library(xps,lib.loc="C:/home/Rabbitus/CRAN/myRlib")
>    Error in inDL(x, as.logical(local), as.logical(now), ...) :
>      cannot load shared library 'C:/home/CS/CRAN/myRlib/xps/libs/xps.dll':
>     LoadLibrary failure:  A DLL-Initialisationroutine failed.
> 
> Then R crashes and Vista displays a Dialogbox with the following message:
> R for Windows terminal front-end does no longer function
>   Anwendungszeitstempel:    4a928a5c
>   Fehlermodulname:    libCore.dll_unloaded
>   Fehlermodulversion:    0.0.0.0
>   Fehlermodulzeitstempel:    4a4b94a1
>   Ausnahmecode:    c0000005
>   Ausnahmeoffset:    0413a6f0
>   Betriebsystemversion:    6.0.6001.2.1.0.768.3
>   Gebietsschema-ID:    1031
>   Zusatzinformation 1:    b2be
>   Zusatzinformation 2:    82109204b3973566ace818217390e302
>   Zusatzinformation 3:    1563
>   Zusatzinformation 4:    deee40b8797d25628c21b9ef47e8a50c
> 
> 2, xps compiled on Vista with option "/MT":
>    new R session:
>    > library(xps,lib.loc="C:/home/CS/CRAN/myRlib")
>    > scheme.test3 <- 
> root.scheme(paste(.path.package("xps"),"schemes/SchemeTest3.root",sep="/"))
>    > data.test3 <- import.data(scheme.test3, "DataTest3", 
> celdir=paste(.path.package("xps"),"raw",sep="/"))
> 
>    ==========================================
>    =============== STACKTRACE ===============
>    ==========================================
> 
> 
>    ==========================================
>    ============= END STACKTRACE =============
>    ==========================================
> 
> Then R crashes and Vista displays a Dialogbox with the following message:
> R for Windows terminal front-end does no longer function
> Problemsignatur:
>   Problemereignisname:    APPCRASH
>   Anwendungsname:    Rterm.exe
>   Anwendungsversion:    2.92.49384.0
>   Anwendungszeitstempel:    4a928a5c
>   Fehlermodulname:    ntdll.dll
>   Fehlermodulversion:    6.0.6001.18000
>   Fehlermodulzeitstempel:    4791a7a6
>   Ausnahmecode:    c0000005
>   Ausnahmeoffset:    0006814c
>   Betriebsystemversion:    6.0.6001.2.1.0.768.3
>   Gebietsschema-ID:    1031
>   Zusatzinformation 1:    92ec
>   Zusatzinformation 2:    c556221fb8ba46fdaae5867fc20d6575
>   Zusatzinformation 3:    c65f
>   Zusatzinformation 4:    9d4dfe391e0e922aa627634d4d47a122
> 
> 
> Here is the same information for Windows XP:
> 
> 1, xps compiled on WinXP with option "/MD":
>    new R session:
>    > library(xps,lib.loc="C:/home/CS/CRAN/myRlib")
> 
> R crashes and the following Dialogbox from "Microsoft Visual C++ Runtime 
> Library" is displayed:
>    Runtime Error!
>    Program: c:\Programme\R\R-2.9.0\bin\Rterm.exe
>    R6034
>    An application has made an attempt to load the C runtime library 
> incorrectly.
>    Please contact the application's support team for more  information.
> 
> 2, xps compiled on WinXP with option "/MT":
>    new R session:
>    > library(xps,lib.loc="C:/home/CS/CRAN/myRlib")
> Luckily, R runs w/o any  problems and this is the setting of the current 
> Windows binary of "xps".
> 
> In summary, on WinXP package xps must be compiled with option "/MT" to 
> be used with R.
> 
> In contrast, on Vista library(xps) does not work when compiled with 
> either option:
> - for option "/MT" library(xps) can be loaded but crashes R with 
> "Errormodulename: "ntdll.dll"
> - for option "/MD" library(xps) cannot be loaded, since the ROOT library 
> "libCore.dll" cannot be loaded ("Errormodulename: "libCore.dll_unloaded")
> 
> It is important to note that on both WinXP AND Vista library "xps.dll" 
> compiled with option "/MD" does work perfectly fine when running from 
> within ROOT!
> 
> Please, can anybody tell me why Rterm on Vista crashes when running 
> library(xps)?
> It seems that for option "/MD" Rterm is not able to load the ROOT core 
> library "libCore.dll", why?
> 
> Any help is greatly appreciated otherwise my package "xps" will not be 
> able to run on Vista and more important, Windows 7.
> 
> Thank you in advance.
> Best regards
> Christian
> _._._._._._._._._._._._._._._._._._
> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
> V.i.e.n.n.a           A.u.s.t.r.i.a
> e.m.a.i.l:        cstrato at aon.at
> _._._._._._._._._._._._._._._._._._
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From wdunlap at tibco.com  Sat Sep 19 00:34:32 2009
From: wdunlap at tibco.com (William Dunlap)
Date: Fri, 18 Sep 2009 15:34:32 -0700
Subject: [Rd] what should names(x) be padded with when length(x) is
	increased?
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D70001CE5F9D@NA-PA-VBE03.na.tibco.com>

R version 2.10.0 Under development (unstable) (2009-09-08 r49628)

Here are two somewhat related questions.

First, when we attach a too short names vector to a vector
the names vector is padded with NA's to the length of the
main vector:  E.g.,
   > x<-1:3
   > names(x)<-c("One","Two")
   > str(x)
    Named int [1:3] 1 2 3
    - attr(*, "names")= chr [1:3] "One" "Two" NA
I expected this length mismatch to cause an error, but I am
biassed by my long usage of S and S+.  Is the extension by
padding with NA what is wanted?

Second, if we extend a named vector with length<- the main
vector is padded with NA's but the names are padded with
empty strings.  Should those be NA's?

   > x<-1:3
   > names(x)<-c("One","Two")
   > length(x)<-4
   > str(x)
    Named int [1:4] 1 2 3 NA
    - attr(*, "names")= chr [1:4] "One" "Two" NA ""

The names "" and NA act alike in that subscript by either
returns structure(NA, names=NA_character_), but they
print differently
   > x
    One  Two <NA>
     1    2    3   NA


Bill Dunlap
TIBCO Software Inc - Spotfire Division
wdunlap tibco.com 


From ggrothendieck at gmail.com  Sat Sep 19 00:44:44 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 18 Sep 2009 18:44:44 -0400
Subject: [Rd] what should names(x) be padded with when length(x) is
	increased?
In-Reply-To: <77EB52C6DD32BA4D87471DCD70C8D70001CE5F9D@NA-PA-VBE03.na.tibco.com>
References: <77EB52C6DD32BA4D87471DCD70C8D70001CE5F9D@NA-PA-VBE03.na.tibco.com>
Message-ID: <971536df0909181544x8ef2797x80ccf5a852bda0ce@mail.gmail.com>

The graphviz site, itself, lists resources/alternatives here:
http://www.graphviz.org/Resources.php

On Fri, Sep 18, 2009 at 6:34 PM, William Dunlap <wdunlap at tibco.com> wrote:
> R version 2.10.0 Under development (unstable) (2009-09-08 r49628)
>
> Here are two somewhat related questions.
>
> First, when we attach a too short names vector to a vector
> the names vector is padded with NA's to the length of the
> main vector: ?E.g.,
> ? > x<-1:3
> ? > names(x)<-c("One","Two")
> ? > str(x)
> ? ?Named int [1:3] 1 2 3
> ? ?- attr(*, "names")= chr [1:3] "One" "Two" NA
> I expected this length mismatch to cause an error, but I am
> biassed by my long usage of S and S+. ?Is the extension by
> padding with NA what is wanted?
>
> Second, if we extend a named vector with length<- the main
> vector is padded with NA's but the names are padded with
> empty strings. ?Should those be NA's?
>
> ? > x<-1:3
> ? > names(x)<-c("One","Two")
> ? > length(x)<-4
> ? > str(x)
> ? ?Named int [1:4] 1 2 3 NA
> ? ?- attr(*, "names")= chr [1:4] "One" "Two" NA ""
>
> The names "" and NA act alike in that subscript by either
> returns structure(NA, names=NA_character_), but they
> print differently
> ? > x
> ? ?One ?Two <NA>
> ? ? 1 ? ?2 ? ?3 ? NA
>
>
> Bill Dunlap
> TIBCO Software Inc - Spotfire Division
> wdunlap tibco.com
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From chuck at sharpsteen.net  Sat Sep 19 00:32:56 2009
From: chuck at sharpsteen.net (cls59)
Date: Fri, 18 Sep 2009 15:32:56 -0700 (PDT)
Subject: [Rd] inconsistency in attaching attributes to NULL
In-Reply-To: <77EB52C6DD32BA4D87471DCD70C8D70001CE5F94@NA-PA-VBE03.na.tibco.com>
References: <77EB52C6DD32BA4D87471DCD70C8D70001CE5F94@NA-PA-VBE03.na.tibco.com>
Message-ID: <25516472.post@talk.nabble.com>




William Dunlap wrote:
> 
> In R-devel (svn 49628) and back to at least R 2.7.0 we get
> inconsistent results when attempting to attach attributes to
> a variable with the value NULL.
> 
> If we use attributes<- it finishes but changes the value to list().
> 
>    > a<-NULL
>    > attributes(a)<-list(attr1="First attribute", attr2=2+2i)
>    > a
>    list()
>    attr(,"attr1")
>    [1] "First attribute"
>    attr(,"attr2")
>    [1] 2+2i
> 
> If we use attr<- it refuses to attach the attribute
> 
>    > b<-NULL
>    > attr(b, "attr1") <- "First attribute"
>    Error in attr(b, "attr1") <- "First attribute" :
>      attempt to set an attribute on NULL
> 
> Is the second behavior the correct one and should attributes(x)<-list()
> abort if x is NULL?
> 
> (attributes(NULL)<-list(attr="First") dies because NULL itself is not
> allowed on the left side of an assignment.)
> 
> Bill Dunlap
> 
> 


It's probably an unfortunate inconsistency that you are able to set
attributes on a using attributes() <- when a is NULL. According to the R
Language Definition (Section 2.1.6: NULL):


R Language Definition wrote:
> 
> The NULL object has no type and no modifiable properties. There is only
> one NULL object in R, to which all instances refer. To test for NULL use
> is.null. You cannot set attributes on NULL. 
> 

Looks like there's a missing error message that should be there :P

-Charlie

-----
Charlie Sharpsteen
Undergraduate
Environmental Resources Engineering
Humboldt State University
-- 
View this message in context: http://www.nabble.com/inconsistency-in-attaching-attributes-to-NULL-tp25516381p25516472.html
Sent from the R devel mailing list archive at Nabble.com.


From cstrato at aon.at  Sat Sep 19 12:20:05 2009
From: cstrato at aon.at (cstrato)
Date: Sat, 19 Sep 2009 12:20:05 +0200
Subject: [Rd] Package crashes R under Windows Vista
In-Reply-To: <4AB40AB5.8010905@stats.uwo.ca>
References: <4AB405BC.7020903@aon.at> <4AB40AB5.8010905@stats.uwo.ca>
Message-ID: <4AB4B055.7080708@aon.at>

Dear Duncan,

I know that I am asking an unusual question, since MS VC++ is not 
supported, and I have of course installed the Rtools. However, asking 
support from MS is not an option for the following reason:

Looking at different VC forums everybody tells you that you should 
compile all libraries with the same option and you should not mix 
options /MD with /MT, and this is the answer I will get.

Furthermore, as I have already mentioned, library xps.dll compiled with 
/MD works perfectly fine on WinXP and Vista when used independent from 
R. The problem is that when calling library(xps) from within R, R can 
load library xps.dll, but it cannot load the libraries which are called 
from library xps.dll such as library libCore.dll.

Since the question is why can R not load a C++ library which is called 
from library xps.dll, asking this question at R-devel seems for me to be 
the only option.

Best regards
Christian


Duncan Murdoch wrote:
> On 18/09/2009 6:12 PM, cstrato wrote:
>> Dear all,
>>
>> Please, please I really need your help, since I am not able to solve 
>> the problem myself:
>> It seems that until now most Windows users of my Bioconductor package 
>> "xps" use Windows XP, but recently a user tried to use it on Windows 
>> Vista where it crashed R immediately. Since I assume that some users 
>> may migrate to the upcoming Windows 7 where the problem will be the 
>> same, I would appreciate any help to be able to support Vista/Windows 
>> 7, thank you in advance.
>
> You are requiring specific Microsoft tools to compile a package, which 
> fails on one Microsoft OS, but not another.  Isn't this a question you 
> should address to Microsoft?
>
> For the record:
>
> We support compiling in the compiler listed in the R-admin manual, 
> which is available from www.murdoch-sutherland.com/Rtools.  If you 
> choose to use a different compiler, you should seek support from its 
> supplier.
>
> Duncan Murdoch
>
>>
>> The problem ist that my package consists mainly of C++ code which I 
>> must compile with Visual C++ (Express Edition 2008), since it depends 
>> on the ROOT C++ framework. Windows users download and install first 
>> the ROOT Windows binary compiled with VC9 and then install the 
>> Windows binary of xps.
>>
>> Thus package xps contains a "Makefile.win" where I use one of the 
>> compiler options "/MT" or "/MD", respectively, see: 
>> http://msdn.microsoft.com/en-us/library/2kzt1wy3.aspx
>>
>> Since the Windows binary of ROOT is compiled with option "/MD" I 
>> should in principle use this option, however, R does not accept this 
>> option. Luckily, for Winodws XP I can compile xps with "/MT" and this 
>> works perfectly fine.
>>
>> The real problem is that neither option works on Windows Vista, 
>> although I can run "R CMD INSTALL" in both cases. However, when 
>> loading "library(xps)" using Rterm.exe I get the following two cases:
>>
>> 1, xps compiled on Vista with option "/MD":
>>    new R session:
>>    > library(xps,lib.loc="C:/home/Rabbitus/CRAN/myRlib")
>>    Error in inDL(x, as.logical(local), as.logical(now), ...) :
>>      cannot load shared library 
>> 'C:/home/CS/CRAN/myRlib/xps/libs/xps.dll':
>>     LoadLibrary failure:  A DLL-Initialisationroutine failed.
>>
>> Then R crashes and Vista displays a Dialogbox with the following 
>> message:
>> R for Windows terminal front-end does no longer function
>>   Anwendungszeitstempel:    4a928a5c
>>   Fehlermodulname:    libCore.dll_unloaded
>>   Fehlermodulversion:    0.0.0.0
>>   Fehlermodulzeitstempel:    4a4b94a1
>>   Ausnahmecode:    c0000005
>>   Ausnahmeoffset:    0413a6f0
>>   Betriebsystemversion:    6.0.6001.2.1.0.768.3
>>   Gebietsschema-ID:    1031
>>   Zusatzinformation 1:    b2be
>>   Zusatzinformation 2:    82109204b3973566ace818217390e302
>>   Zusatzinformation 3:    1563
>>   Zusatzinformation 4:    deee40b8797d25628c21b9ef47e8a50c
>>
>> 2, xps compiled on Vista with option "/MT":
>>    new R session:
>>    > library(xps,lib.loc="C:/home/CS/CRAN/myRlib")
>>    > scheme.test3 <- 
>> root.scheme(paste(.path.package("xps"),"schemes/SchemeTest3.root",sep="/")) 
>>
>>    > data.test3 <- import.data(scheme.test3, "DataTest3", 
>> celdir=paste(.path.package("xps"),"raw",sep="/"))
>>
>>    ==========================================
>>    =============== STACKTRACE ===============
>>    ==========================================
>>
>>
>>    ==========================================
>>    ============= END STACKTRACE =============
>>    ==========================================
>>
>> Then R crashes and Vista displays a Dialogbox with the following 
>> message:
>> R for Windows terminal front-end does no longer function
>> Problemsignatur:
>>   Problemereignisname:    APPCRASH
>>   Anwendungsname:    Rterm.exe
>>   Anwendungsversion:    2.92.49384.0
>>   Anwendungszeitstempel:    4a928a5c
>>   Fehlermodulname:    ntdll.dll
>>   Fehlermodulversion:    6.0.6001.18000
>>   Fehlermodulzeitstempel:    4791a7a6
>>   Ausnahmecode:    c0000005
>>   Ausnahmeoffset:    0006814c
>>   Betriebsystemversion:    6.0.6001.2.1.0.768.3
>>   Gebietsschema-ID:    1031
>>   Zusatzinformation 1:    92ec
>>   Zusatzinformation 2:    c556221fb8ba46fdaae5867fc20d6575
>>   Zusatzinformation 3:    c65f
>>   Zusatzinformation 4:    9d4dfe391e0e922aa627634d4d47a122
>>
>>
>> Here is the same information for Windows XP:
>>
>> 1, xps compiled on WinXP with option "/MD":
>>    new R session:
>>    > library(xps,lib.loc="C:/home/CS/CRAN/myRlib")
>>
>> R crashes and the following Dialogbox from "Microsoft Visual C++ 
>> Runtime Library" is displayed:
>>    Runtime Error!
>>    Program: c:\Programme\R\R-2.9.0\bin\Rterm.exe
>>    R6034
>>    An application has made an attempt to load the C runtime library 
>> incorrectly.
>>    Please contact the application's support team for more  information.
>>
>> 2, xps compiled on WinXP with option "/MT":
>>    new R session:
>>    > library(xps,lib.loc="C:/home/CS/CRAN/myRlib")
>> Luckily, R runs w/o any  problems and this is the setting of the 
>> current Windows binary of "xps".
>>
>> In summary, on WinXP package xps must be compiled with option "/MT" 
>> to be used with R.
>>
>> In contrast, on Vista library(xps) does not work when compiled with 
>> either option:
>> - for option "/MT" library(xps) can be loaded but crashes R with 
>> "Errormodulename: "ntdll.dll"
>> - for option "/MD" library(xps) cannot be loaded, since the ROOT 
>> library "libCore.dll" cannot be loaded ("Errormodulename: 
>> "libCore.dll_unloaded")
>>
>> It is important to note that on both WinXP AND Vista library 
>> "xps.dll" compiled with option "/MD" does work perfectly fine when 
>> running from within ROOT!
>>
>> Please, can anybody tell me why Rterm on Vista crashes when running 
>> library(xps)?
>> It seems that for option "/MD" Rterm is not able to load the ROOT 
>> core library "libCore.dll", why?
>>
>> Any help is greatly appreciated otherwise my package "xps" will not 
>> be able to run on Vista and more important, Windows 7.
>>
>> Thank you in advance.
>> Best regards
>> Christian
>> _._._._._._._._._._._._._._._._._._
>> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
>> V.i.e.n.n.a           A.u.s.t.r.i.a
>> e.m.a.i.l:        cstrato at aon.at
>> _._._._._._._._._._._._._._._._._._
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From saptarshi.guha at gmail.com  Sun Sep 20 04:15:30 2009
From: saptarshi.guha at gmail.com (Saptarshi Guha)
Date: Sat, 19 Sep 2009 22:15:30 -0400
Subject: [Rd] Return a list from a .Call but segfaults
Message-ID: <3048D5A8-4F01-497B-AED1-21C199D9B448@gmail.com>

Hello,
I call a function via .Call passing to it a raw vector(D) and an  
integer(I)
The vector is a series  K1,KData1, V1,VData1, K2, KData2, ...
where the integer K1 is the length of Data1 and similarly for Ki (wrt  
Datai)(similarly for V*) There 2*I such pairs( (Ki,KDatai), (Vi,VDatai))

The numbers Ki(and Vi) are written in network order.

I am returning a list of I elements each element a list of two  
elements corresponding to KData and VData (which are serialized R  
objects) .

  ll <- .Call("returnListOfKV", rawkv, numread)

When use the function with browser(), and type head(ll) i get valid  
results.
However, i get a segfault when the code runs the next line

   j <- append(j,ll)

(where j was defined as vector(mode='list') )

The code below looks alright, but it appears to crash when getting  
copied.
Now one could blame message2rexp (in kk_), but once in R, the result  
of .Call is assigned to ll, everything should be protected.
In fact, if in kk_ i simply return a VECSXP with 2 elements, no  
errors, so one could conclude that message2rexp is to blame.

Yet, when i replace the code with R code, that is using readBin and  
only calling calling C(to call message2rexp) to deserialize a raw  
vector, I get no such error.

There is something I'm missing , could someone tell me where?
Thank you for your time
Regards
Saptarshi


=== Using GDB? ====
I would like to run it through gdb, i get the following message
[Thread debugging using libthread_db enabled]
Error while reading shared library symbols:
Cannot find new threads: generic error
Cannot find new threads: generic error]

and cannot proceed.

==== Code ====
   SEXP returnListOfKV(SEXP raw,SEXP numread){

     if(TYPEOF(raw)!=RAWSXP){
       return(R_NilValue);
     }
     int num = INTEGER(numread)[0];
     char *rawdata = (char*)RAW(raw);
     SEXP KV ,rval;
     int r;
     PROTECT(rval = Rf_allocVector(VECSXP, num));
     for(int i=0;i<num;i++){
       SEXP k = R_NilValue;
       PROTECT(KV = Rf_allocVector(VECSXP, 2));

       r = reverseUInt(*((int*) rawdata)); //converts network order to  
host
       rawdata+=4; //yes, hard code size of int
       PROTECT(k= kk_(rawdata,r)); //deserializes data and returns a  
SEXP
       rawdata+= r;
       SET_VECTOR_ELT(KV,0, k);
       UNPROTECT(1);

       r = reverseUInt(*((int*) rawdata));
       rawdata+=4;
       PROTECT(k= kk_(rawdata,r));
       rawdata+=r;
       SET_VECTOR_ELT(KV,1, k);
       UNPROTECT(1);

       SET_VECTOR_ELT(rval,i,KV);
       UNPROTECT(1);
     }
     UNPROTECT(1);
     return(rval);
   }


   SEXP kk_(char *d,int n){
     SEXP k;
     REXP *rexp = new REXP();
     rexp->Clear();
     rexp->ParseFromArray(d,n);
     PROTECT(k = message2rexp(*rexp));
     delete(rexp);
     UNPROTECT(1);
     return(k);
   }

Saptarshi Guha | saptarshi.guha at gmail.com | http://www.stat.purdue.edu/~sguha


From saptarshi.guha at gmail.com  Sun Sep 20 06:04:14 2009
From: saptarshi.guha at gmail.com (Saptarshi Guha)
Date: Sun, 20 Sep 2009 00:04:14 -0400
Subject: [Rd] Return a list from a .Call but segfaults
In-Reply-To: <3048D5A8-4F01-497B-AED1-21C199D9B448@gmail.com>
References: <3048D5A8-4F01-497B-AED1-21C199D9B448@gmail.com>
Message-ID: <1e7471d50909192104w3bdfc108jef4ccada77412675@mail.gmail.com>

After some examination, this is what i found (i changed the code
somewhat, i dont modify rawdata anymore)

load("/tmp/v.Rdata")
dyn.load("/ln/meraki/custom/lib64/R/library/mylib/libs/lib.so")
v=.Call("returnListOfKV",rawkv,numread)

## v is a list of 28231 lists each of length 2
j=v[1:10000] ; u=list();u=append(u,j)
and
 j=v[1:15164] ; u=list();u=append(u,j)
both work but for n> 15164
 j=v[1:n] ; u=list();u=append(u,j)
returns
Error: protect(): protection stack overflow

I have no idea why...
Regards
Saptarshi




On Sat, Sep 19, 2009 at 10:15 PM, Saptarshi Guha
<saptarshi.guha at gmail.com> wrote:
> Hello,
> I call a function via .Call passing to it a raw vector(D) and an integer(I)
> The vector is a series ?K1,KData1, V1,VData1, K2, KData2, ...
> where the integer K1 is the length of Data1 and similarly for Ki (wrt
> Datai)(similarly for V*) There 2*I such pairs( (Ki,KDatai), (Vi,VDatai))
>
> The numbers Ki(and Vi) are written in network order.
>
> I am returning a list of I elements each element a list of two elements
> corresponding to KData and VData (which are serialized R objects) .
>
> ?ll <- .Call("returnListOfKV", rawkv, numread)
>
> When use the function with browser(), and type head(ll) i get valid results.
> However, i get a segfault when the code runs the next line
>
> ?j <- append(j,ll)
>
> (where j was defined as vector(mode='list') )
>
> The code below looks alright, but it appears to crash when getting copied.
> Now one could blame message2rexp (in kk_), but once in R, the result of
> .Call is assigned to ll, everything should be protected.
> In fact, if in kk_ i simply return a VECSXP with 2 elements, no errors, so
> one could conclude that message2rexp is to blame.
>
> Yet, when i replace the code with R code, that is using readBin and only
> calling calling C(to call message2rexp) to deserialize a raw vector, I get
> no such error.
>
> There is something I'm missing , could someone tell me where?
> Thank you for your time
> Regards
> Saptarshi
>
>
> === Using GDB? ====
> I would like to run it through gdb, i get the following message
> [Thread debugging using libthread_db enabled]
> Error while reading shared library symbols:
> Cannot find new threads: generic error
> Cannot find new threads: generic error]
>
> and cannot proceed.
>
> ==== Code ====
> ?SEXP returnListOfKV(SEXP raw,SEXP numread){
>
> ? ?if(TYPEOF(raw)!=RAWSXP){
> ? ? ?return(R_NilValue);
> ? ?}
> ? ?int num = INTEGER(numread)[0];
> ? ?char *rawdata = (char*)RAW(raw);
> ? ?SEXP KV ,rval;
> ? ?int r;
> ? ?PROTECT(rval = Rf_allocVector(VECSXP, num));
> ? ?for(int i=0;i<num;i++){
> ? ? ?SEXP k = R_NilValue;
> ? ? ?PROTECT(KV = Rf_allocVector(VECSXP, 2));
>
> ? ? ?r = reverseUInt(*((int*) rawdata)); //converts network order to host
> ? ? ?rawdata+=4; //yes, hard code size of int
> ? ? ?PROTECT(k= kk_(rawdata,r)); //deserializes data and returns a SEXP
> ? ? ?rawdata+= r;
> ? ? ?SET_VECTOR_ELT(KV,0, k);
> ? ? ?UNPROTECT(1);
>
> ? ? ?r = reverseUInt(*((int*) rawdata));
> ? ? ?rawdata+=4;
> ? ? ?PROTECT(k= kk_(rawdata,r));
> ? ? ?rawdata+=r;
> ? ? ?SET_VECTOR_ELT(KV,1, k);
> ? ? ?UNPROTECT(1);
>
> ? ? ?SET_VECTOR_ELT(rval,i,KV);
> ? ? ?UNPROTECT(1);
> ? ?}
> ? ?UNPROTECT(1);
> ? ?return(rval);
> ?}
>
>
> ?SEXP kk_(char *d,int n){
> ? ?SEXP k;
> ? ?REXP *rexp = new REXP();
> ? ?rexp->Clear();
> ? ?rexp->ParseFromArray(d,n);
> ? ?PROTECT(k = message2rexp(*rexp));
> ? ?delete(rexp);
> ? ?UNPROTECT(1);
> ? ?return(k);
> ?}
>
> Saptarshi Guha | saptarshi.guha at gmail.com |
> http://www.stat.purdue.edu/~sguha
>
>
>


From saptarshi.guha at gmail.com  Mon Sep 21 07:15:23 2009
From: saptarshi.guha at gmail.com (Saptarshi Guha)
Date: Mon, 21 Sep 2009 01:15:23 -0400
Subject: [Rd] Return a list from a .Call but segfaults
In-Reply-To: <1e7471d50909192104w3bdfc108jef4ccada77412675@mail.gmail.com>
References: <3048D5A8-4F01-497B-AED1-21C199D9B448@gmail.com> 
	<1e7471d50909192104w3bdfc108jef4ccada77412675@mail.gmail.com>
Message-ID: <1e7471d50909202215r4408690dr89746f419a7b3813@mail.gmail.com>

Apparantly , calling Rf_duplicate on the return value message2rexp solves it.
Regards
Saptarshi


On Sun, Sep 20, 2009 at 12:04 AM, Saptarshi Guha
<saptarshi.guha at gmail.com> wrote:
> After some examination, this is what i found (i changed the code
> somewhat, i dont modify rawdata anymore)
>
> load("/tmp/v.Rdata")
> dyn.load("/ln/meraki/custom/lib64/R/library/mylib/libs/lib.so")
> v=.Call("returnListOfKV",rawkv,numread)
>
> ## v is a list of 28231 lists each of length 2
> j=v[1:10000] ; u=list();u=append(u,j)
> and
> ?j=v[1:15164] ; u=list();u=append(u,j)
> both work but for n> 15164
> ?j=v[1:n] ; u=list();u=append(u,j)
> returns
> Error: protect(): protection stack overflow
>
> I have no idea why...
> Regards
> Saptarshi
>
>
>
>
> On Sat, Sep 19, 2009 at 10:15 PM, Saptarshi Guha
> <saptarshi.guha at gmail.com> wrote:
>> Hello,
>> I call a function via .Call passing to it a raw vector(D) and an integer(I)
>> The vector is a series ?K1,KData1, V1,VData1, K2, KData2, ...
>> where the integer K1 is the length of Data1 and similarly for Ki (wrt
>> Datai)(similarly for V*) There 2*I such pairs( (Ki,KDatai), (Vi,VDatai))
>>
>> The numbers Ki(and Vi) are written in network order.
>>
>> I am returning a list of I elements each element a list of two elements
>> corresponding to KData and VData (which are serialized R objects) .
>>
>> ?ll <- .Call("returnListOfKV", rawkv, numread)
>>
>> When use the function with browser(), and type head(ll) i get valid results.
>> However, i get a segfault when the code runs the next line
>>
>> ?j <- append(j,ll)
>>
>> (where j was defined as vector(mode='list') )
>>
>> The code below looks alright, but it appears to crash when getting copied.
>> Now one could blame message2rexp (in kk_), but once in R, the result of
>> .Call is assigned to ll, everything should be protected.
>> In fact, if in kk_ i simply return a VECSXP with 2 elements, no errors, so
>> one could conclude that message2rexp is to blame.
>>
>> Yet, when i replace the code with R code, that is using readBin and only
>> calling calling C(to call message2rexp) to deserialize a raw vector, I get
>> no such error.
>>
>> There is something I'm missing , could someone tell me where?
>> Thank you for your time
>> Regards
>> Saptarshi
>>
>>
>> === Using GDB? ====
>> I would like to run it through gdb, i get the following message
>> [Thread debugging using libthread_db enabled]
>> Error while reading shared library symbols:
>> Cannot find new threads: generic error
>> Cannot find new threads: generic error]
>>
>> and cannot proceed.
>>
>> ==== Code ====
>> ?SEXP returnListOfKV(SEXP raw,SEXP numread){
>>
>> ? ?if(TYPEOF(raw)!=RAWSXP){
>> ? ? ?return(R_NilValue);
>> ? ?}
>> ? ?int num = INTEGER(numread)[0];
>> ? ?char *rawdata = (char*)RAW(raw);
>> ? ?SEXP KV ,rval;
>> ? ?int r;
>> ? ?PROTECT(rval = Rf_allocVector(VECSXP, num));
>> ? ?for(int i=0;i<num;i++){
>> ? ? ?SEXP k = R_NilValue;
>> ? ? ?PROTECT(KV = Rf_allocVector(VECSXP, 2));
>>
>> ? ? ?r = reverseUInt(*((int*) rawdata)); //converts network order to host
>> ? ? ?rawdata+=4; //yes, hard code size of int
>> ? ? ?PROTECT(k= kk_(rawdata,r)); //deserializes data and returns a SEXP
>> ? ? ?rawdata+= r;
>> ? ? ?SET_VECTOR_ELT(KV,0, k);
>> ? ? ?UNPROTECT(1);
>>
>> ? ? ?r = reverseUInt(*((int*) rawdata));
>> ? ? ?rawdata+=4;
>> ? ? ?PROTECT(k= kk_(rawdata,r));
>> ? ? ?rawdata+=r;
>> ? ? ?SET_VECTOR_ELT(KV,1, k);
>> ? ? ?UNPROTECT(1);
>>
>> ? ? ?SET_VECTOR_ELT(rval,i,KV);
>> ? ? ?UNPROTECT(1);
>> ? ?}
>> ? ?UNPROTECT(1);
>> ? ?return(rval);
>> ?}
>>
>>
>> ?SEXP kk_(char *d,int n){
>> ? ?SEXP k;
>> ? ?REXP *rexp = new REXP();
>> ? ?rexp->Clear();
>> ? ?rexp->ParseFromArray(d,n);
>> ? ?PROTECT(k = message2rexp(*rexp));
>> ? ?delete(rexp);
>> ? ?UNPROTECT(1);
>> ? ?return(k);
>> ?}
>>
>> Saptarshi Guha | saptarshi.guha at gmail.com |
>> http://www.stat.purdue.edu/~sguha
>>
>>
>>
>


From Naddl84 at gmx.de  Mon Sep 21 11:27:32 2009
From: Naddl84 at gmx.de (Nadine Bethke)
Date: Mon, 21 Sep 2009 11:27:32 +0200
Subject: [Rd] R with Java
Message-ID: <20090921092732.212540@gmx.net>

Hey,
I?m a newbie in R and have a big problem. I hope, I?m in the right mailinglist, if not, sorry for this.
I want to use R in my Java application and I found out, it should work with JRI. But it doesn?t.
I installed it and in the lib-directory of R there is a folder named "JRI". But I have to tell Eclipse
that the JRI exist but I don?t know how. I read help-files and so on, but I don?t understand.
Could you give me a simple instruction how to do this?
Very very thank you.

Greets Nadine

PS: To my person, I?m living in Bingen am Rhein (Germany) and studiing IT. My diploma project is an implementation
of the Transfer-Entropy in Java with the help of R (for calculations and graphics).
-- 
GRATIS f?r alle GMX-Mitglieder: Die maxdome Movie-FLAT!


From Naddl84 at gmx.de  Mon Sep 21 11:39:37 2009
From: Naddl84 at gmx.de (Nadine Bethke)
Date: Mon, 21 Sep 2009 11:39:37 +0200
Subject: [Rd] R with Java [...]
Message-ID: <20090921093937.190200@gmx.net>

Sorry,
I forgot something...
I?m using Windows.
Greets Nadie
-- 
Jetzt kostenlos herunterladen: Internet Explorer 8 und Mozilla Firefox 3 -
sicherer, schneller und einfacher! http://portal.gmx.net/de/go/chbrowser


From simon.urbanek at r-project.org  Mon Sep 21 17:17:37 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 21 Sep 2009 11:17:37 -0400
Subject: [Rd] R with Java
In-Reply-To: <20090921092732.212540@gmx.net>
References: <20090921092732.212540@gmx.net>
Message-ID: <454724C2-4472-4CBC-BCD3-12D3E2B7DAA1@r-project.org>


On Sep 21, 2009, at 5:27 , Nadine Bethke wrote:

> Hey,
> I?m a newbie in R and have a big problem. I hope, I?m in the right  
> mailinglist, if not, sorry for this.

Please use the stats-rosuda-devel mailing list:
http://mailman.rz.uni-augsburg.de/mailman/listinfo/stats-rosuda-devel

You may want to look at the archives, because roughly this question  
has been asked before.


> I want to use R in my Java application and I found out, it should  
> work with JRI. But it doesn?t. I installed it and in the lib- 
> directory of R there is a folder named "JRI". But I have to tell  
> Eclipse that the JRI exist but I don?t know how. I read help-files  
> and so on, but I don?t understand. Could you give me a simple  
> instruction how to do this?

Not really since I don't use Eclipse, but in general you just have to  
make sure that the necessary JAR files are on your class path, then  
you have to make sure Eclipse sets the java library path to the path  
with the jri.dll and finally PATH must contain the directory of R.dll.

(Also since this is a new project, you may consider using the high- 
level REngine API instead of the low-level JRI API. In addition,  
unless you have a specific reason for using JRI (R embedding) there  
are more simple solutions such as Rserve based on the same API - but  
the choice depends on what exactly your applications is doing)

Cheers,
Simon


From mwkimpel at gmail.com  Mon Sep 21 17:27:22 2009
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Mon, 21 Sep 2009 11:27:22 -0400
Subject: [Rd] 2.10.0 Under development (unstable) (2009-09-15 r49711)
	just built segfaults on Debian Squeeze
In-Reply-To: <4AB3CD40.3010604@stats.uwo.ca>
References: <6b93d1830909161251w2148379bg963a66dbbb931487@mail.gmail.com>
	<4AB195B3.3070702@stats.uwo.ca> <4AB3CD40.3010604@stats.uwo.ca>
Message-ID: <6b93d1830909210827g1481236fn90795a66e3e26f73@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090921/f9121e98/attachment.pl>

From mtmorgan at fhcrc.org  Mon Sep 21 19:32:22 2009
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Mon, 21 Sep 2009 10:32:22 -0700
Subject: [Rd] DYLIB_EXT vs. SHLIB_EXT?
Message-ID: <4AB7B8A6.2010008@fhcrc.org>

The graph Bioconductor package wants to compile its C code to a shared
library that is named differently from the package, to avoid conflict
with graph.dll and friends from graphviz.  So recently we tried

after: $(SHLIB)
	mv $(SHLIB) BioC_graph$(DYLIB_EXT)

and useDynLib(BioC_graph) in the NAMESPACE. This fails on Mac. We then
shifted to

after: $(SHLIB)
	mv $(SHLIB) BioC_graph$(SHLIB_EXT)

which works on all platforms we have available. Have we found a robust
solution?

Thanks for any guidance,

Martin

> sessionInfo()
R version 2.10.0 Under development (unstable) (2009-09-20 r49768)
x86_64-unknown-linux-gnu

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=C              LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base


From romain.francois at dbmail.com  Tue Sep 22 08:28:24 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Tue, 22 Sep 2009 08:28:24 +0200
Subject: [Rd] cannot build R-devel (>= r49747)
Message-ID: <4AB86E88.5070304@dbmail.com>

Hello,

I've tried several times yesterday to build R-devel and I consistently 
get this error when I "make" :

mkdir -p -- ../../../library/base/R
make[3]: Leaving directory `/tmp/R-devel/src/library/profile'
make[3]: Entering directory `/tmp/R-devel/src/library/base'
building package 'base'
make[4]: Entering directory `/tmp/R-devel/src/library/base'
mkdir -p -- ../../../library/base/demo
mkdir -p -- ../../../library/base/po
make[4]: Leaving directory `/tmp/R-devel/src/library/base'
Error: unprotect_ptr: pointer not found
Execution halted
make[3]: *** [all] Error 1
make[3]: Leaving directory `/tmp/R-devel/src/library/base'
make[2]: *** [R] Error 1
make[2]: Leaving directory `/tmp/R-devel/src/library'
make[1]: *** [R] Error 1
make[1]: Leaving directory `/tmp/R-devel/src'
make: *** [R] Error 1


I tried this morning to step down and I believe this has been introduced 
by rev 49747:

-------------------------------------------------------------------------
r49747 | murdoch | 2009-09-18 14:10:55 -0400 (Fri, 18 Sep 2009) | 1 line
Changed paths:
    M /trunk/src/include/Defn.h
    M /trunk/src/include/Parse.h
    M /trunk/src/main/gram.c
    M /trunk/src/main/gram.y
    M /trunk/src/main/main.c
    M /trunk/src/main/memory.c

Allow parsing in the middle of a REPL on a file, without messing up the 
source record for the file.
-------------------------------------------------------------------------

... which makes sense since it looks like a parser issue.

I can build revision 49746.

This is a fedora 11 :

$ uname -a
Linux santorini 2.6.29.6-217.2.16.fc11.i686.PAE #1 SMP Mon Aug 24 
17:16:21 EDT 2009 i686 i686 i386 GNU/Linux

I'm not sure what I can do to help fixing this. Can someone else with a 
fedora replicate this ?

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/yw8E : New R package : sos
|- http://tr.im/y8y0 : search the graph gallery from R
`- http://tr.im/y8wY : new R package : ant


From p.dalgaard at biostat.ku.dk  Tue Sep 22 09:17:27 2009
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue, 22 Sep 2009 09:17:27 +0200
Subject: [Rd] cannot build R-devel (>= r49747)
In-Reply-To: <4AB86E88.5070304@dbmail.com>
References: <4AB86E88.5070304@dbmail.com>
Message-ID: <4AB87A07.6040605@biostat.ku.dk>

Romain Francois wrote:
> Hello,
> 
> I've tried several times yesterday to build R-devel and I consistently 
> get this error when I "make" :
> 
> mkdir -p -- ../../../library/base/R
> make[3]: Leaving directory `/tmp/R-devel/src/library/profile'
> make[3]: Entering directory `/tmp/R-devel/src/library/base'
> building package 'base'
> make[4]: Entering directory `/tmp/R-devel/src/library/base'
> mkdir -p -- ../../../library/base/demo
> mkdir -p -- ../../../library/base/po
> make[4]: Leaving directory `/tmp/R-devel/src/library/base'
> Error: unprotect_ptr: pointer not found
> Execution halted
> make[3]: *** [all] Error 1
> make[3]: Leaving directory `/tmp/R-devel/src/library/base'
> make[2]: *** [R] Error 1
> make[2]: Leaving directory `/tmp/R-devel/src/library'
> make[1]: *** [R] Error 1
> make[1]: Leaving directory `/tmp/R-devel/src'
> make: *** [R] Error 1
> 
> 
> I tried this morning to step down and I believe this has been introduced 
> by rev 49747:
> 
> -------------------------------------------------------------------------
> r49747 | murdoch | 2009-09-18 14:10:55 -0400 (Fri, 18 Sep 2009) | 1 line
> Changed paths:
>    M /trunk/src/include/Defn.h
>    M /trunk/src/include/Parse.h
>    M /trunk/src/main/gram.c
>    M /trunk/src/main/gram.y
>    M /trunk/src/main/main.c
>    M /trunk/src/main/memory.c
> 
> Allow parsing in the middle of a REPL on a file, without messing up the 
> source record for the file.
> -------------------------------------------------------------------------
> 
> ... which makes sense since it looks like a parser issue.
> 
> I can build revision 49746.
> 
> This is a fedora 11 :
> 
> $ uname -a
> Linux santorini 2.6.29.6-217.2.16.fc11.i686.PAE #1 SMP Mon Aug 24 
> 17:16:21 EDT 2009 i686 i686 i386 GNU/Linux
> 
> I'm not sure what I can do to help fixing this. Can someone else with a 
> fedora replicate this ?
> 
> Romain
> 

This could be pretty serious.

unprotect_ptr is used where the usual PROTECT/UNPROTECT mechanisms don't 
work because things do not follow strict stack discipline. The main spot 
is when the parser uses lookahead  to distinguish different constructs. 
  I don't think I have ever seen it fail like that, but a possible 
reason could be that the wrong pointer got removed from the protection 
stack. Or memory corruption in the stack itself of course. A bit odd if 
the former sort of bug should be unportable, though.

It is not happening for me on 32bit fedora 9.

It could be useful if you could drill a little further down to see 
exactly how R is invoked at the failure, incl content input file(s), and 
maybe redo the run with debugging turned on so that we can see who is 
trying to unprotect what.


-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From romain.francois at dbmail.com  Tue Sep 22 09:33:10 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Tue, 22 Sep 2009 09:33:10 +0200
Subject: [Rd] cannot build R-devel (>= r49747)
In-Reply-To: <4AB87A07.6040605@biostat.ku.dk>
References: <4AB86E88.5070304@dbmail.com> <4AB87A07.6040605@biostat.ku.dk>
Message-ID: <4AB87DB6.5070507@dbmail.com>

On 09/22/2009 09:17 AM, Peter Dalgaard wrote:
>
> Romain Francois wrote:
>> Hello,
>>
>> I've tried several times yesterday to build R-devel and I consistently
>> get this error when I "make" :
>>
>> mkdir -p -- ../../../library/base/R
>> make[3]: Leaving directory `/tmp/R-devel/src/library/profile'
>> make[3]: Entering directory `/tmp/R-devel/src/library/base'
>> building package 'base'
>> make[4]: Entering directory `/tmp/R-devel/src/library/base'
>> mkdir -p -- ../../../library/base/demo
>> mkdir -p -- ../../../library/base/po
>> make[4]: Leaving directory `/tmp/R-devel/src/library/base'
>> Error: unprotect_ptr: pointer not found
>> Execution halted
>> make[3]: *** [all] Error 1
>> make[3]: Leaving directory `/tmp/R-devel/src/library/base'
>> make[2]: *** [R] Error 1
>> make[2]: Leaving directory `/tmp/R-devel/src/library'
>> make[1]: *** [R] Error 1
>> make[1]: Leaving directory `/tmp/R-devel/src'
>> make: *** [R] Error 1
>>
>>
>> I tried this morning to step down and I believe this has been
>> introduced by rev 49747:
>>
>> -------------------------------------------------------------------------
>> r49747 | murdoch | 2009-09-18 14:10:55 -0400 (Fri, 18 Sep 2009) | 1 line
>> Changed paths:
>> M /trunk/src/include/Defn.h
>> M /trunk/src/include/Parse.h
>> M /trunk/src/main/gram.c
>> M /trunk/src/main/gram.y
>> M /trunk/src/main/main.c
>> M /trunk/src/main/memory.c
>>
>> Allow parsing in the middle of a REPL on a file, without messing up
>> the source record for the file.
>> -------------------------------------------------------------------------
>>
>> ... which makes sense since it looks like a parser issue.
>>
>> I can build revision 49746.
>>
>> This is a fedora 11 :
>>
>> $ uname -a
>> Linux santorini 2.6.29.6-217.2.16.fc11.i686.PAE #1 SMP Mon Aug 24
>> 17:16:21 EDT 2009 i686 i686 i386 GNU/Linux
>>
>> I'm not sure what I can do to help fixing this. Can someone else with
>> a fedora replicate this ?
>>
>> Romain
>>
>
> This could be pretty serious.
>
> unprotect_ptr is used where the usual PROTECT/UNPROTECT mechanisms don't
> work because things do not follow strict stack discipline. The main spot
> is when the parser uses lookahead to distinguish different constructs.

Yes. This makes sense since rev 49747 was a fix to another bug when R 
reenters the parser. See the thread :

"[Rd] 2.10.0 Under development (unstable) (2009-09-15 r49711) just	built 
segfaults on Debian Squeeze"

>  I don't think I have ever seen it fail like that, but a possible reason
> could be that the wrong pointer got removed from the protection stack.
> Or memory corruption in the stack itself of course. A bit odd if the
> former sort of bug should be unportable, though.
>
> It is not happening for me on 32bit fedora 9.

Thanks for this. I'll digg a little deeper

> It could be useful if you could drill a little further down to see
> exactly how R is invoked at the failure, incl content input file(s), and
> maybe redo the run with debugging turned on so that we can see who is
> trying to unprotect what.

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/yw8E : New R package : sos
|- http://tr.im/y8y0 : search the graph gallery from R
`- http://tr.im/y8wY : new R package : ant


From andreas.westfeld at htw-dresden.de  Mon Sep 21 19:25:16 2009
From: andreas.westfeld at htw-dresden.de (andreas.westfeld at htw-dresden.de)
Date: Mon, 21 Sep 2009 19:25:16 +0200 (CEST)
Subject: [Rd] .Random.seed not found (PR#13963)
Message-ID: <20090921172517.1D7C4282EF5A@mail.pubhealth.ku.dk>

R 2.9.1 and 2.9.2 report "not found" when I try to save .Random.seed for
later restore, however, the manual ?.Random.seed says that it still exists.
-- 
Andreas Westfeld, 0432 01CC F511 9E2B 0B57 5993 0B22 98F8 4AD8 EEEA
HTW Dresden, Fakult?t Informatik/Mathematik
Informatikrecht/Informationssicherheit, Zimmer Z337
Tel. +49-351-462-3372, http://www.htw-dresden.de/~westfeld


From dennisr at wi.mit.edu  Mon Sep 21 18:50:16 2009
From: dennisr at wi.mit.edu (dennisr at wi.mit.edu)
Date: Mon, 21 Sep 2009 18:50:16 +0200 (CEST)
Subject: [Rd] Ubuntu Hardy python-rpy package missing _rpy2092 (PR#13962)
Message-ID: <20090921165016.D229E282EF5A@mail.pubhealth.ku.dk>

Full_Name: Dennis Ristuccia
Version: R version 2.9.2 (2009-08-24)
OS: Ubuntu Hardy 8.04
Submission from: (NULL) (18.157.249.21)


Hi guys,

I'm running into an issue with the python-rpy ubuntu hardy package.

Heres the output:

root at tak ~# python
Python 2.5.2 (r252:60911, Jul 22 2009, 15:35:03) 
[GCC 4.2.4 (Ubuntu 4.2.4-1ubuntu3)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import rpy
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.5/site-packages/rpy.py", line 134, in <module>
    """ % RVERSION)
RuntimeError: No module named _rpy2092

      RPy module can not be imported. Please check if your rpy
      installation supports R 2.9.2. If you have multiple R versions
      installed, you may need to set RHOME before importing rpy. For
      example:
  
      >>> from rpy_options import set_options
      >>> set_options(RHOME='c:/progra~1/r/rw2011/')
      >>> from rpy import *
      
      
>>> 

I checked in /usr/lib/python2.5/site-packages/ and there is only _rpy2091.so -
_rpy2092.so is missing.

I experienced the same issue the last time I upgraded R from the hardy mirror
you guys have. I ended up doing some hackery by using the debian lenny
python-rpy package, I'd rather avoid that this time around.

Thanks

--
DennisR


From joseclaudio.faria at gmail.com  Tue Sep 22 03:22:32 2009
From: joseclaudio.faria at gmail.com (Jose Claudio Faria)
Date: Mon, 21 Sep 2009 22:22:32 -0300
Subject: [Rd] A couple of suggestions: source function (package base)
Message-ID: <c86bda880909211822x28dbdecfqecdf7af7adfc3767@mail.gmail.com>

Hi,

I've been calling the function "source" (package base) from Tinn-R editor to
send files, marked blocks and selections to R interpreter because it avoids a
lot of problems related with input/output synchronization in the Rgui output!

The new RGedit plugin is also using this function in this way, and we are
finishing a new version of a plugin to Vim (Vim-R-plugin2) which uses
also source().

So, I would like to propose two small changes in this function:

1. The "max.deparse" parameter could be a global option with 150 as
the default value.

   Why? It will avoid the need to send this parameter repeatedly,
which causes visual pollution in the console.

2. A new parameter (for example: "new.line") to allow the user to
define whether a new blank line between the output and the subsequent
input is desired when "echo=T".

Example, suppose I have in the editor the three lines below:

a=rnorm(10)
a
sort(a)

and I would like to send it to R interpreter (file, block or selection).

The current output is (using Vim-R-plugin2):
-------------------------------------------
> source('/tmp/.Rsource-jcfaria', echo=TRUE, max.deparse=50)

> a=rnorm(10)

> a
 [1]  0.08648104 -1.74996635  0.61027538  0.42042031 -0.02025884 -0.39891256
 [7] -0.30219635 -0.84476668  1.06341674 -0.12030620

> sort(a)
 [1] -1.74996635 -0.84476668 -0.39891256 -0.30219635 -0.12030620 -0.02025884
 [7]  0.08648104  0.42042031  0.61027538  1.06341674

>


How it could be (desired):
-------------------------
> source('/tmp/.Rsource-jcfaria', echo=TRUE)
> a=rnorm(10)
> a
 [1]  0.08648104 -1.74996635  0.61027538  0.42042031 -0.02025884 -0.39891256
 [7] -0.30219635 -0.84476668  1.06341674 -0.12030620
> sort(a)
 [1] -1.74996635 -0.84476668 -0.39891256 -0.30219635 -0.12030620 -0.02025884
 [7]  0.08648104  0.42042031  0.61027538  1.06341674
>

I think that both "new.line" and "max.deparse" could be both global options.

max.deparse = 150 (default)
new.line    = FALSE (default)

Why? To get a clearer output.

In this way the args of this function would become:
---------------------------------------------------
function (file, local = FALSE, echo = verbose, print.eval = echo,
    verbose = getOption("verbose"), prompt.echo = getOption("prompt"),
->  max.deparse.length = getOption("max.deparse"), new.line =
getOption("new.line"), <-
    chdir = FALSE, encoding = getOption("encoding"), continue.echo =
getOption("continue"),
    skip.echo = 0, keep.source = getOption("keep.source"))

For GUI/Editor developers this changes will allow to send simpler
instructions and
make nice and standard interfaces.

Is it possible to create the "new.line" argument and to put it and
"max.deparse" between the global options?

I would prefer not creating a custom version of source() because I
think that these changes would be of
benefit to other people and projects.

Thanks,
-- 
///\\\///\\\///\\\///\\\///\\\///\\\///\\\///\\\
Jose Claudio Faria
Estatistica - prof. Titular
UESC/DCET/Brasil
joseclaudio.faria at gmail.com
joseclaudio.faria at terra.com.br
///\\\///\\\///\\\///\\\///\\\///\\\///\\\///\\\


From romain.francois at dbmail.com  Tue Sep 22 10:40:26 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Tue, 22 Sep 2009 10:40:26 +0200
Subject: [Rd] cannot build R-devel (>= r49747)
In-Reply-To: <4AB87DB6.5070507@dbmail.com>
References: <4AB86E88.5070304@dbmail.com> <4AB87A07.6040605@biostat.ku.dk>
	<4AB87DB6.5070507@dbmail.com>
Message-ID: <4AB88D7A.7040408@dbmail.com>

Going a bit further. The problem happens when I "make" in the 
"src/library/base" directory at that step :

         @cat $(srcdir)/makebasedb.R | \
           R_DEFAULT_PACKAGES=NULL LC_ALL=C $(R_EXE) > /dev/null

I'm attaching the result of "make -d" in this directory.

However, this might be relevant about my setting, I have the 
"R_KEEP_PKG_SOURCE" environment variable set to "yes". And if I set it 
to "no" it builds correctly.

Romain

On 09/22/2009 09:33 AM, Romain Francois wrote:
>
> On 09/22/2009 09:17 AM, Peter Dalgaard wrote:
>>
>> Romain Francois wrote:
>>> Hello,
>>>
>>> I've tried several times yesterday to build R-devel and I consistently
>>> get this error when I "make" :
>>>
>>> mkdir -p -- ../../../library/base/R
>>> make[3]: Leaving directory `/tmp/R-devel/src/library/profile'
>>> make[3]: Entering directory `/tmp/R-devel/src/library/base'
>>> building package 'base'
>>> make[4]: Entering directory `/tmp/R-devel/src/library/base'
>>> mkdir -p -- ../../../library/base/demo
>>> mkdir -p -- ../../../library/base/po
>>> make[4]: Leaving directory `/tmp/R-devel/src/library/base'
>>> Error: unprotect_ptr: pointer not found
>>> Execution halted
>>> make[3]: *** [all] Error 1
>>> make[3]: Leaving directory `/tmp/R-devel/src/library/base'
>>> make[2]: *** [R] Error 1
>>> make[2]: Leaving directory `/tmp/R-devel/src/library'
>>> make[1]: *** [R] Error 1
>>> make[1]: Leaving directory `/tmp/R-devel/src'
>>> make: *** [R] Error 1
>>>
>>>
>>> I tried this morning to step down and I believe this has been
>>> introduced by rev 49747:
>>>
>>> -------------------------------------------------------------------------
>>>
>>> r49747 | murdoch | 2009-09-18 14:10:55 -0400 (Fri, 18 Sep 2009) | 1 line
>>> Changed paths:
>>> M /trunk/src/include/Defn.h
>>> M /trunk/src/include/Parse.h
>>> M /trunk/src/main/gram.c
>>> M /trunk/src/main/gram.y
>>> M /trunk/src/main/main.c
>>> M /trunk/src/main/memory.c
>>>
>>> Allow parsing in the middle of a REPL on a file, without messing up
>>> the source record for the file.
>>> -------------------------------------------------------------------------
>>>
>>>
>>> ... which makes sense since it looks like a parser issue.
>>>
>>> I can build revision 49746.
>>>
>>> This is a fedora 11 :
>>>
>>> $ uname -a
>>> Linux santorini 2.6.29.6-217.2.16.fc11.i686.PAE #1 SMP Mon Aug 24
>>> 17:16:21 EDT 2009 i686 i686 i386 GNU/Linux
>>>
>>> I'm not sure what I can do to help fixing this. Can someone else with
>>> a fedora replicate this ?
>>>
>>> Romain
>>>
>>
>> This could be pretty serious.
>>
>> unprotect_ptr is used where the usual PROTECT/UNPROTECT mechanisms don't
>> work because things do not follow strict stack discipline. The main spot
>> is when the parser uses lookahead to distinguish different constructs.
>
> Yes. This makes sense since rev 49747 was a fix to another bug when R
> reenters the parser. See the thread :
>
> "[Rd] 2.10.0 Under development (unstable) (2009-09-15 r49711) just built
> segfaults on Debian Squeeze"
>
>> I don't think I have ever seen it fail like that, but a possible reason
>> could be that the wrong pointer got removed from the protection stack.
>> Or memory corruption in the stack itself of course. A bit odd if the
>> former sort of bug should be unportable, though.
>>
>> It is not happening for me on 32bit fedora 9.
>
> Thanks for this. I'll digg a little deeper
>
>> It could be useful if you could drill a little further down to see
>> exactly how R is invoked at the failure, incl content input file(s), and
>> maybe redo the run with debugging turned on so that we can see who is
>> trying to unprotect what.
>



-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/yw8E : New R package : sos
|- http://tr.im/y8y0 : search the graph gallery from R
`- http://tr.im/y8wY : new R package : ant

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: make.log
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090922/116802ca/attachment.pl>

From S.J.Eglen at damtp.cam.ac.uk  Tue Sep 22 11:07:14 2009
From: S.J.Eglen at damtp.cam.ac.uk (Stephen Eglen)
Date: Tue, 22 Sep 2009 10:07:14 +0100
Subject: [Rd] typo in r-devel/R/src/library/base/man/files.Rd
Message-ID: <27410.1253610434@maps>

files.Rd has the following typo, line 57:

  LIBK points to an actual file ...

should be LINK

Stephen


From P.Dalgaard at biostat.ku.dk  Tue Sep 22 11:25:05 2009
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue, 22 Sep 2009 11:25:05 +0200
Subject: [Rd] cannot build R-devel (>= r49747)
In-Reply-To: <4AB88D7A.7040408@dbmail.com>
References: <4AB86E88.5070304@dbmail.com> <4AB87A07.6040605@biostat.ku.dk>
	<4AB87DB6.5070507@dbmail.com> <4AB88D7A.7040408@dbmail.com>
Message-ID: <4AB897F1.3060905@biostat.ku.dk>

Romain Francois wrote:

> However, this might be relevant about my setting, I have the
> "R_KEEP_PKG_SOURCE" environment variable set to "yes". And if I set it
> to "no" it builds correctly.

AHA! Yes, that makes sense

R_KEEP_PKG_SOURCE=yes make

breaks for me too with the unprotect_ptr message (SUSE 64bit this time).

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From romain.francois at dbmail.com  Tue Sep 22 11:30:29 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Tue, 22 Sep 2009 11:30:29 +0200
Subject: [Rd] cannot build R-devel (>= r49747)
In-Reply-To: <4AB897F1.3060905@biostat.ku.dk>
References: <4AB86E88.5070304@dbmail.com> <4AB87A07.6040605@biostat.ku.dk>
	<4AB87DB6.5070507@dbmail.com> <4AB88D7A.7040408@dbmail.com>
	<4AB897F1.3060905@biostat.ku.dk>
Message-ID: <4AB89935.3040104@dbmail.com>

On 09/22/2009 11:25 AM, Peter Dalgaard wrote:
>
> Romain Francois wrote:
>
>> However, this might be relevant about my setting, I have the
>> "R_KEEP_PKG_SOURCE" environment variable set to "yes". And if I set it
>> to "no" it builds correctly.
>
> AHA! Yes, that makes sense
>
> R_KEEP_PKG_SOURCE=yes make
>
> breaks for me too with the unprotect_ptr message (SUSE 64bit this time).
>

I can now track this down to these lines in gram.(y|c)

if (!isNull(ParseState.SrcFile))
     	UNPROTECT_PTR(ParseState.SrcFile);

The error occurs the first time ParseState.SrcFile is not null.

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/yw8E : New R package : sos
|- http://tr.im/y8y0 : search the graph gallery from R
`- http://tr.im/y8wY : new R package : ant


From murdoch at stats.uwo.ca  Tue Sep 22 11:41:51 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 22 Sep 2009 05:41:51 -0400
Subject: [Rd] cannot build R-devel (>= r49747)
In-Reply-To: <4AB89935.3040104@dbmail.com>
References: <4AB86E88.5070304@dbmail.com>
	<4AB87A07.6040605@biostat.ku.dk>	<4AB87DB6.5070507@dbmail.com>
	<4AB88D7A.7040408@dbmail.com>	<4AB897F1.3060905@biostat.ku.dk>
	<4AB89935.3040104@dbmail.com>
Message-ID: <4AB89BDF.2090200@stats.uwo.ca>

On 22/09/2009 5:30 AM, Romain Francois wrote:
> On 09/22/2009 11:25 AM, Peter Dalgaard wrote:
>> Romain Francois wrote:
>>
>>> However, this might be relevant about my setting, I have the
>>> "R_KEEP_PKG_SOURCE" environment variable set to "yes". And if I set it
>>> to "no" it builds correctly.
>> AHA! Yes, that makes sense
>>
>> R_KEEP_PKG_SOURCE=yes make
>>
>> breaks for me too with the unprotect_ptr message (SUSE 64bit this time).
>>
> 
> I can now track this down to these lines in gram.(y|c)
> 
> if (!isNull(ParseState.SrcFile))
>      	UNPROTECT_PTR(ParseState.SrcFile);
> 
> The error occurs the first time ParseState.SrcFile is not null.

Thanks for this info. I can track it down now.

Duncan Murdoch


From romain.francois at dbmail.com  Tue Sep 22 11:50:28 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Tue, 22 Sep 2009 11:50:28 +0200
Subject: [Rd] cannot build R-devel (>= r49747)
In-Reply-To: <4AB89BDF.2090200@stats.uwo.ca>
References: <4AB86E88.5070304@dbmail.com>
	<4AB87A07.6040605@biostat.ku.dk>	<4AB87DB6.5070507@dbmail.com>
	<4AB88D7A.7040408@dbmail.com>	<4AB897F1.3060905@biostat.ku.dk>
	<4AB89935.3040104@dbmail.com> <4AB89BDF.2090200@stats.uwo.ca>
Message-ID: <4AB89DE4.3000506@dbmail.com>

On 09/22/2009 11:41 AM, Duncan Murdoch wrote:
>
> On 22/09/2009 5:30 AM, Romain Francois wrote:
>> On 09/22/2009 11:25 AM, Peter Dalgaard wrote:
>>> Romain Francois wrote:
>>>
>>>> However, this might be relevant about my setting, I have the
>>>> "R_KEEP_PKG_SOURCE" environment variable set to "yes". And if I set it
>>>> to "no" it builds correctly.
>>> AHA! Yes, that makes sense
>>>
>>> R_KEEP_PKG_SOURCE=yes make
>>>
>>> breaks for me too with the unprotect_ptr message (SUSE 64bit this time).
>>>
>>
>> I can now track this down to these lines in gram.(y|c)
>>
>> if (!isNull(ParseState.SrcFile))
>> UNPROTECT_PTR(ParseState.SrcFile);
>>
>> The error occurs the first time ParseState.SrcFile is not null.
>
> Thanks for this info. I can track it down now.
>
> Duncan Murdoch

Good. You'll probably be able to fix it much faster.

My only guess is that some extra care is needed when UNPROTECT_PTR'ing 
environments, because if I comment this, then the same problem occurs in 
R_FinalizeSrcRefState(SrcRefState *state) at the end of the parse.

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/yw8E : New R package : sos
|- http://tr.im/y8y0 : search the graph gallery from R
`- http://tr.im/y8wY : new R package : ant


From murdoch at stats.uwo.ca  Tue Sep 22 11:56:08 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 22 Sep 2009 05:56:08 -0400
Subject: [Rd] cannot build R-devel (>= r49747)
In-Reply-To: <4AB89DE4.3000506@dbmail.com>
References: <4AB86E88.5070304@dbmail.com>
	<4AB87A07.6040605@biostat.ku.dk>	<4AB87DB6.5070507@dbmail.com>
	<4AB88D7A.7040408@dbmail.com>	<4AB897F1.3060905@biostat.ku.dk>
	<4AB89935.3040104@dbmail.com> <4AB89BDF.2090200@stats.uwo.ca>
	<4AB89DE4.3000506@dbmail.com>
Message-ID: <4AB89F38.7090605@stats.uwo.ca>

On 22/09/2009 5:50 AM, Romain Francois wrote:
> On 09/22/2009 11:41 AM, Duncan Murdoch wrote:
>> On 22/09/2009 5:30 AM, Romain Francois wrote:
>>> On 09/22/2009 11:25 AM, Peter Dalgaard wrote:
>>>> Romain Francois wrote:
>>>>
>>>>> However, this might be relevant about my setting, I have the
>>>>> "R_KEEP_PKG_SOURCE" environment variable set to "yes". And if I set it
>>>>> to "no" it builds correctly.
>>>> AHA! Yes, that makes sense
>>>>
>>>> R_KEEP_PKG_SOURCE=yes make
>>>>
>>>> breaks for me too with the unprotect_ptr message (SUSE 64bit this time).
>>>>
>>> I can now track this down to these lines in gram.(y|c)
>>>
>>> if (!isNull(ParseState.SrcFile))
>>> UNPROTECT_PTR(ParseState.SrcFile);
>>>
>>> The error occurs the first time ParseState.SrcFile is not null.
>> Thanks for this info. I can track it down now.
>>
>> Duncan Murdoch
> 
> Good. You'll probably be able to fix it much faster.
> 
> My only guess is that some extra care is needed when UNPROTECT_PTR'ing 
> environments, because if I comment this, then the same problem occurs in 
> R_FinalizeSrcRefState(SrcRefState *state) at the end of the parse.

I doubt if it has to do with the type of that object, but that object is 
treated specially, because it is a global value that can change during 
the parse.  At some point I'd guess I unprotected it twice, or failed to 
initialize it.

Duncan Murdoch


From murdoch at stats.uwo.ca  Tue Sep 22 12:25:30 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 22 Sep 2009 06:25:30 -0400
Subject: [Rd] .Random.seed not found (PR#13963)
In-Reply-To: <20090921172517.1D7C4282EF5A@mail.pubhealth.ku.dk>
References: <20090921172517.1D7C4282EF5A@mail.pubhealth.ku.dk>
Message-ID: <4AB8A61A.8080204@stats.uwo.ca>

On 21/09/2009 1:25 PM, andreas.westfeld at htw-dresden.de wrote:
> R 2.9.1 and 2.9.2 report "not found" when I try to save .Random.seed for
> later restore, however, the manual ?.Random.seed says that it still exists.

.Random.seed is created the first time you use the random number 
generators.  I'm guessing you're attempting to save it before using it.

Duncan Murdoch


From ggrothendieck at gmail.com  Tue Sep 22 14:23:00 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 22 Sep 2009 08:23:00 -0400
Subject: [Rd] A couple of suggestions: source function (package base)
In-Reply-To: <c86bda880909211822x28dbdecfqecdf7af7adfc3767@mail.gmail.com>
References: <c86bda880909211822x28dbdecfqecdf7af7adfc3767@mail.gmail.com>
Message-ID: <971536df0909220523l5b90e1b8wa26e2759c32e76dd@mail.gmail.com>

I would find that useful too particularly for running long output from Stangle.

On Mon, Sep 21, 2009 at 9:22 PM, Jose Claudio Faria
<joseclaudio.faria at gmail.com> wrote:
> Hi,
>
> I've been calling the function "source" (package base) from Tinn-R editor to
> send files, marked blocks and selections to R interpreter because it avoids a
> lot of problems related with input/output synchronization in the Rgui output!
>
> The new RGedit plugin is also using this function in this way, and we are
> finishing a new version of a plugin to Vim (Vim-R-plugin2) which uses
> also source().
>
> So, I would like to propose two small changes in this function:
>
> 1. The "max.deparse" parameter could be a global option with 150 as
> the default value.
>
> ? Why? It will avoid the need to send this parameter repeatedly,
> which causes visual pollution in the console.
>
> 2. A new parameter (for example: "new.line") to allow the user to
> define whether a new blank line between the output and the subsequent
> input is desired when "echo=T".
>
> Example, suppose I have in the editor the three lines below:
>
> a=rnorm(10)
> a
> sort(a)
>
> and I would like to send it to R interpreter (file, block or selection).
>
> The current output is (using Vim-R-plugin2):
> -------------------------------------------
>> source('/tmp/.Rsource-jcfaria', echo=TRUE, max.deparse=50)
>
>> a=rnorm(10)
>
>> a
> ?[1] ?0.08648104 -1.74996635 ?0.61027538 ?0.42042031 -0.02025884 -0.39891256
> ?[7] -0.30219635 -0.84476668 ?1.06341674 -0.12030620
>
>> sort(a)
> ?[1] -1.74996635 -0.84476668 -0.39891256 -0.30219635 -0.12030620 -0.02025884
> ?[7] ?0.08648104 ?0.42042031 ?0.61027538 ?1.06341674
>
>>
>
>
> How it could be (desired):
> -------------------------
>> source('/tmp/.Rsource-jcfaria', echo=TRUE)
>> a=rnorm(10)
>> a
> ?[1] ?0.08648104 -1.74996635 ?0.61027538 ?0.42042031 -0.02025884 -0.39891256
> ?[7] -0.30219635 -0.84476668 ?1.06341674 -0.12030620
>> sort(a)
> ?[1] -1.74996635 -0.84476668 -0.39891256 -0.30219635 -0.12030620 -0.02025884
> ?[7] ?0.08648104 ?0.42042031 ?0.61027538 ?1.06341674
>>
>
> I think that both "new.line" and "max.deparse" could be both global options.
>
> max.deparse = 150 (default)
> new.line ? ?= FALSE (default)
>
> Why? To get a clearer output.
>
> In this way the args of this function would become:
> ---------------------------------------------------
> function (file, local = FALSE, echo = verbose, print.eval = echo,
> ? ?verbose = getOption("verbose"), prompt.echo = getOption("prompt"),
> -> ?max.deparse.length = getOption("max.deparse"), new.line =
> getOption("new.line"), <-
> ? ?chdir = FALSE, encoding = getOption("encoding"), continue.echo =
> getOption("continue"),
> ? ?skip.echo = 0, keep.source = getOption("keep.source"))
>
> For GUI/Editor developers this changes will allow to send simpler
> instructions and
> make nice and standard interfaces.
>
> Is it possible to create the "new.line" argument and to put it and
> "max.deparse" between the global options?
>
> I would prefer not creating a custom version of source() because I
> think that these changes would be of
> benefit to other people and projects.
>
> Thanks,
> --
> ///\\\///\\\///\\\///\\\///\\\///\\\///\\\///\\\
> Jose Claudio Faria
> Estatistica - prof. Titular
> UESC/DCET/Brasil
> joseclaudio.faria at gmail.com
> joseclaudio.faria at terra.com.br
> ///\\\///\\\///\\\///\\\///\\\///\\\///\\\///\\\
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From jfox at mcmaster.ca  Tue Sep 22 15:15:49 2009
From: jfox at mcmaster.ca (John Fox)
Date: Tue, 22 Sep 2009 09:15:49 -0400
Subject: [Rd] Rcmdr package dependencies
Message-ID: <002001ca3b86$cda835d0$68f8a170$@ca>

Dear r-devel members,

My Rcmdr package "depends" on several other packages (tcltk, grDevices,
utils, and car) and "suggests" a number of others (abind, aplpack,
colorspace, effects, foreign, grid, Hmisc, lattice, leaps, lmtest, MASS,
mgcv, multcomp, nlme, nnet, relimp, rgl, and RODBC). The reason for the
distinction is that I don't want all of these packages to load when the
Rcmdr loads; rather, the "suggested" packages are loaded as they're needed.
But all of the packages -- both those under "depends" and those under
"suggests" -- really are necessary for all of the features of the Rcmdr to
work. For example, if the "leaps" package is absent, then the "Subset model
selection" item in the "Models" menu is suppressed.

This arrangement works reasonably well, but it makes it awkward to install
the Rcmdr. If the user issues the command install.packages("Rcmdr"), then
the "suggested" packages aren't installed. On the other hand, if the user
issues the command install.packages("Rcmdr", dependencies=TRUE), which is
what I currently recommend, then "suggested" packages are installed
recursively, causing dozens of packages, most of them actually unnecessary,
to be installed. This issue has been growing more acute, and at this point
even with a fast Internet connection it takes quite a while for all of the
dependencies to download and install.

I wonder whether I've missed something. Is there a way for me to arrange the
Rcmdr package dependencies so that only the necessary packages (those
currently listed under both "depends" and "suggests" and the packages on
which they "depend") are installed along with the Rcmdr, but the currently
"suggested" packages aren't loaded when the Rcmdr loads?

Any help would be appreciated.

John 

------------------------------
John Fox, Professor
Department of Sociology
McMaster University
Hamilton, Ontario, Canada
web: socserv.mcmaster.ca/jfox


From Timothy_Handley at nps.gov  Tue Sep 22 18:15:03 2009
From: Timothy_Handley at nps.gov (Timothy_Handley at nps.gov)
Date: Tue, 22 Sep 2009 09:15:03 -0700
Subject: [Rd] odd (erroneous?) results from gls
Message-ID: <OF2D269D6A.90BC405D-ON88257639.0058AABC-88257639.005944A2@nps.gov>


A couple weeks ago I posted a message on this topic to r-help, the response
was that this seemed like odd behavior, and that I ought to post it to one
of the developer lists. I posted to r-sig-mixed-models, but didn't get any
response. So, with good intentions, I decided to try posting once more, but
to this more general list.

The goal is (1) FYI, to make you aware of this issue, in case it is an
error in gls (2) For my information, in case I have made an error, in the
hope that one of you folks might be able to correct me. Thanks in advance
for your time.

The issue is in 2 parts.

(A) I've used gls to fit a model with two fixed effects and a corExp
object. By my count, this fitting process estimates 5 parameters:
(Intercept), l10area, newx, range, and nugget. With 118 total df, there
should be 118 - 5 = 113 residual df. However, the output from summary.gls
reports 115 residual degrees of freedom. Is this an error in summary or
gls, or is there an error in my count?

(B) Summary.gls reports logLik=-273.6. Using my count of 5 estimated
parameters, the AIC should be -2*(-273.6) + 2*5 = 557.2. However,
summary.gls reports an AIC of 559.2. If one works backwards from the
reported AIC of 559.2, it seems that gls believes it has estimated 6
parameters in the fitting process. Again, is this an error in gls, or an
error on my part?

Copied from R terminal:

>
> summary(sppl.i.ex)
Generalized least squares fit by maximum likelihood
  Model: all.all.rch ~ l10area + newx
  Data: gtemp
      AIC      BIC    logLik
  559.167 575.7911 -273.5835

Correlation Structure: Exponential spatial correlation
 Formula: ~x + y | area
 Parameter estimate(s):
     range     nugget
15.4448835  0.3741476

Coefficients:
               Value Std.Error   t-value p-value
(Intercept) 7.621306 0.7648135  9.964921  0.0000
l10area     6.332931 0.5589199 11.330659  0.0000
newx        0.066535 0.0204417  3.254857  0.0015

 Correlation:
        (Intr) l10are
l10area -0.605
newx     0.358 -0.024

Standardized residuals:
       Min         Q1        Med         Q3        Max
-3.0035983 -0.5990432 -0.2226852  0.5113270  2.4444263

Residual standard error: 2.820337
Degrees of freedom: 118 total; 115 residual

Tim Handley
Fire Effects Monitor
Santa Monica Mountains National Recreation Area
401 W. Hillcrest Dr.
Thousand Oaks, CA 91360
805-370-2347


From murdoch at stats.uwo.ca  Tue Sep 22 18:17:57 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 22 Sep 2009 12:17:57 -0400
Subject: [Rd] cannot build R-devel (>= r49747)
In-Reply-To: <4AB89DE4.3000506@dbmail.com>
References: <4AB86E88.5070304@dbmail.com>	<4AB87A07.6040605@biostat.ku.dk>	<4AB87DB6.5070507@dbmail.com>	<4AB88D7A.7040408@dbmail.com>	<4AB897F1.3060905@biostat.ku.dk>	<4AB89935.3040104@dbmail.com>
	<4AB89BDF.2090200@stats.uwo.ca> <4AB89DE4.3000506@dbmail.com>
Message-ID: <4AB8F8B5.4000609@stats.uwo.ca>

I believe this is fixed now (as of r49786).  The problem is that the 
parse code does bad things with the protection stack -- rather than 
pairing PROTECT with UNPROTECT, it does bulk unprotects by saving and 
restoring the stack pointer -- and in the new code the 
ParseState.SrcFile ended up getting released more than once.

Duncan Murdoch

On 9/22/2009 5:50 AM, Romain Francois wrote:
> On 09/22/2009 11:41 AM, Duncan Murdoch wrote:
>>
>> On 22/09/2009 5:30 AM, Romain Francois wrote:
>>> On 09/22/2009 11:25 AM, Peter Dalgaard wrote:
>>>> Romain Francois wrote:
>>>>
>>>>> However, this might be relevant about my setting, I have the
>>>>> "R_KEEP_PKG_SOURCE" environment variable set to "yes". And if I set it
>>>>> to "no" it builds correctly.
>>>> AHA! Yes, that makes sense
>>>>
>>>> R_KEEP_PKG_SOURCE=yes make
>>>>
>>>> breaks for me too with the unprotect_ptr message (SUSE 64bit this time).
>>>>
>>>
>>> I can now track this down to these lines in gram.(y|c)
>>>
>>> if (!isNull(ParseState.SrcFile))
>>> UNPROTECT_PTR(ParseState.SrcFile);
>>>
>>> The error occurs the first time ParseState.SrcFile is not null.
>>
>> Thanks for this info. I can track it down now.
>>
>> Duncan Murdoch
> 
> Good. You'll probably be able to fix it much faster.
> 
> My only guess is that some extra care is needed when UNPROTECT_PTR'ing 
> environments, because if I comment this, then the same problem occurs in 
> R_FinalizeSrcRefState(SrcRefState *state) at the end of the parse.
> 
> Romain
>


From romain.francois at dbmail.com  Tue Sep 22 19:07:37 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Tue, 22 Sep 2009 19:07:37 +0200
Subject: [Rd] cannot build R-devel (>= r49747)
In-Reply-To: <4AB8F8B5.4000609@stats.uwo.ca>
References: <4AB86E88.5070304@dbmail.com>	<4AB87A07.6040605@biostat.ku.dk>	<4AB87DB6.5070507@dbmail.com>	<4AB88D7A.7040408@dbmail.com>	<4AB897F1.3060905@biostat.ku.dk>	<4AB89935.3040104@dbmail.com>
	<4AB89BDF.2090200@stats.uwo.ca> <4AB89DE4.3000506@dbmail.com>
	<4AB8F8B5.4000609@stats.uwo.ca>
Message-ID: <4AB90459.5020005@dbmail.com>

Thanks. Works for me also now.

On 09/22/2009 06:17 PM, Duncan Murdoch wrote:
>
> I believe this is fixed now (as of r49786). The problem is that the
> parse code does bad things with the protection stack -- rather than
> pairing PROTECT with UNPROTECT, it does bulk unprotects by saving and
> restoring the stack pointer -- and in the new code the
> ParseState.SrcFile ended up getting released more than once.
>
> Duncan Murdoch
>
> On 9/22/2009 5:50 AM, Romain Francois wrote:
>> On 09/22/2009 11:41 AM, Duncan Murdoch wrote:
>>>
>>> On 22/09/2009 5:30 AM, Romain Francois wrote:
>>>> On 09/22/2009 11:25 AM, Peter Dalgaard wrote:
>>>>> Romain Francois wrote:
>>>>>
>>>>>> However, this might be relevant about my setting, I have the
>>>>>> "R_KEEP_PKG_SOURCE" environment variable set to "yes". And if I
>>>>>> set it
>>>>>> to "no" it builds correctly.
>>>>> AHA! Yes, that makes sense
>>>>>
>>>>> R_KEEP_PKG_SOURCE=yes make
>>>>>
>>>>> breaks for me too with the unprotect_ptr message (SUSE 64bit this
>>>>> time).
>>>>>
>>>>
>>>> I can now track this down to these lines in gram.(y|c)
>>>>
>>>> if (!isNull(ParseState.SrcFile))
>>>> UNPROTECT_PTR(ParseState.SrcFile);
>>>>
>>>> The error occurs the first time ParseState.SrcFile is not null.
>>>
>>> Thanks for this info. I can track it down now.
>>>
>>> Duncan Murdoch
>>
>> Good. You'll probably be able to fix it much faster.
>>
>> My only guess is that some extra care is needed when UNPROTECT_PTR'ing
>> environments, because if I comment this, then the same problem occurs
>> in R_FinalizeSrcRefState(SrcRefState *state) at the end of the parse.
>>
>> Romain


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/yw8E : New R package : sos
|- http://tr.im/y8y0 : search the graph gallery from R
`- http://tr.im/y8wY : new R package : ant


From ligges at statistik.tu-dortmund.de  Tue Sep 22 20:07:16 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 22 Sep 2009 20:07:16 +0200
Subject: [Rd] odd (erroneous?) results from gls
In-Reply-To: <OF2D269D6A.90BC405D-ON88257639.0058AABC-88257639.005944A2@nps.gov>
References: <OF2D269D6A.90BC405D-ON88257639.0058AABC-88257639.005944A2@nps.gov>
Message-ID: <4AB91254.6080609@statistik.tu-dortmund.de>



Timothy_Handley at nps.gov wrote:
> A couple weeks ago I posted a message on this topic to r-help, the response
> was that this seemed like odd behavior, and that I ought to post it to one
> of the developer lists. I posted to r-sig-mixed-models, but didn't get any
> response. So, with good intentions, I decided to try posting once more, but
> to this more general list.
> 
> The goal is (1) FYI, to make you aware of this issue, in case it is an
> error in gls (2) For my information, in case I have made an error, in the
> hope that one of you folks might be able to correct me. Thanks in advance
> for your time.
> 
> The issue is in 2 parts.
> 
> (A) I've used gls to fit a model with two fixed effects and a corExp
> object. By my count, this fitting process estimates 5 parameters:
> (Intercept), l10area, newx, range, and nugget. With 118 total df, there
> should be 118 - 5 = 113 residual df. However, the output from summary.gls
> reports 115 residual degrees of freedom. Is this an error in summary or
> gls, or is there an error in my count?


Those for the correlation structure are not counted for these residuals 
as you can find in

  nlme:::print.summary.gls

that contains the line

  cat("Degrees of freedom:", dd[["N"]], "total;", dd[["N"]] -
         dd[["p"]], "residual\n")


> (B) Summary.gls reports logLik=-273.6. Using my count of 5 estimated
> parameters, the AIC should be -2*(-273.6) + 2*5 = 557.2. However,
> summary.gls reports an AIC of 559.2. If one works backwards from the
> reported AIC of 559.2, it seems that gls believes it has estimated 6
> parameters in the fitting process. Again, is this an error in gls, or an
> error on my part?


1 additional was used for the estimation of the variance. Accordingly

nlme:::logLik.gls

contains the line

   attr(val, "df") <- p + length(coef(object[["modelStruct"]])) + 1

The AICs should be comparable at least within R and if others think 5 
rather than 6 should be used its still fine since the difference will be 
there in all models to be compared.


Best wishes,
Uwe Ligges



> Copied from R terminal:
> 
>> summary(sppl.i.ex)
> Generalized least squares fit by maximum likelihood
>   Model: all.all.rch ~ l10area + newx
>   Data: gtemp
>       AIC      BIC    logLik
>   559.167 575.7911 -273.5835
> 
> Correlation Structure: Exponential spatial correlation
>  Formula: ~x + y | area
>  Parameter estimate(s):
>      range     nugget
> 15.4448835  0.3741476
> 
> Coefficients:
>                Value Std.Error   t-value p-value
> (Intercept) 7.621306 0.7648135  9.964921  0.0000
> l10area     6.332931 0.5589199 11.330659  0.0000
> newx        0.066535 0.0204417  3.254857  0.0015
> 
>  Correlation:
>         (Intr) l10are
> l10area -0.605
> newx     0.358 -0.024
> 
> Standardized residuals:
>        Min         Q1        Med         Q3        Max
> -3.0035983 -0.5990432 -0.2226852  0.5113270  2.4444263
> 
> Residual standard error: 2.820337
> Degrees of freedom: 118 total; 115 residual
> 
> Tim Handley
> Fire Effects Monitor
> Santa Monica Mountains National Recreation Area
> 401 W. Hillcrest Dr.
> Thousand Oaks, CA 91360
> 805-370-2347
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Tue Sep 22 20:16:55 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 22 Sep 2009 20:16:55 +0200
Subject: [Rd] Rcmdr package dependencies
In-Reply-To: <002001ca3b86$cda835d0$68f8a170$@ca>
References: <002001ca3b86$cda835d0$68f8a170$@ca>
Message-ID: <4AB91497.4020505@statistik.tu-dortmund.de>



John Fox wrote:
> Dear r-devel members,
> 
> My Rcmdr package "depends" on several other packages (tcltk, grDevices,
> utils, and car) and "suggests" a number of others (abind, aplpack,
> colorspace, effects, foreign, grid, Hmisc, lattice, leaps, lmtest, MASS,
> mgcv, multcomp, nlme, nnet, relimp, rgl, and RODBC). The reason for the
> distinction is that I don't want all of these packages to load when the
> Rcmdr loads; rather, the "suggested" packages are loaded as they're needed.
> But all of the packages -- both those under "depends" and those under
> "suggests" -- really are necessary for all of the features of the Rcmdr to
> work. For example, if the "leaps" package is absent, then the "Subset model
> selection" item in the "Models" menu is suppressed.
> 
> This arrangement works reasonably well, but it makes it awkward to install
> the Rcmdr. If the user issues the command install.packages("Rcmdr"), then
> the "suggested" packages aren't installed. On the other hand, if the user
> issues the command install.packages("Rcmdr", dependencies=TRUE), which is
> what I currently recommend, then "suggested" packages are installed
> recursively, causing dozens of packages, most of them actually unnecessary,
> to be installed. This issue has been growing more acute, and at this point
> even with a fast Internet connection it takes quite a while for all of the
> dependencies to download and install.
> 
> I wonder whether I've missed something. Is there a way for me to arrange the
> Rcmdr package dependencies so that only the necessary packages (those
> currently listed under both "depends" and "suggests" and the packages on
> which they "depend") are installed along with the Rcmdr, but the currently
> "suggested" packages aren't loaded when the Rcmdr loads?



Dear John,

no, this is not possible.

Consider your package A (or Rcmdr) suggests B that suggests C.
Then A::foo uses the function B::bar which only works if C::dep is 
present. B works essentially without C but it requires C just to make 
bar work. Then this means your A::foo won't work if C is not installed 
and you won't get it with the setup mentioned above.

In summary, I fear what you want might work well *now* (by chance), but 
it does not work in general.

Best wishes,
Uwe






> Any help would be appreciated.
> 
> John 
> 
> ------------------------------
> John Fox, Professor
> Department of Sociology
> McMaster University
> Hamilton, Ontario, Canada
> web: socserv.mcmaster.ca/jfox
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ggrothendieck at gmail.com  Tue Sep 22 20:31:50 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 22 Sep 2009 14:31:50 -0400
Subject: [Rd] Rcmdr package dependencies
In-Reply-To: <002001ca3b86$cda835d0$68f8a170$@ca>
References: <002001ca3b86$cda835d0$68f8a170$@ca>
Message-ID: <971536df0909221131l5b3dc380v14b1c96c8e9fcf9c@mail.gmail.com>

Create a package called RcmdrInstall, say, with no content and have it
depend on Rcmdr.  RcmdrInstall would have all packages as dependencies
while Rcmdr would only have the essential packages as dependencies.

Install RcmdrInstall.  That would also force Rcmdr to be installed.

Now issue:

   library(Rcmdr)

as before and the non-essentials won't be loaded.

Thus the only difference between the current procedure and the new
procedure as far as the user is concerned is that they install
RcmdrInstall rather than Rcmdr.  They load and run Rcmdr in the same
way.

On Tue, Sep 22, 2009 at 9:15 AM, John Fox <jfox at mcmaster.ca> wrote:
> Dear r-devel members,
>
> My Rcmdr package "depends" on several other packages (tcltk, grDevices,
> utils, and car) and "suggests" a number of others (abind, aplpack,
> colorspace, effects, foreign, grid, Hmisc, lattice, leaps, lmtest, MASS,
> mgcv, multcomp, nlme, nnet, relimp, rgl, and RODBC). The reason for the
> distinction is that I don't want all of these packages to load when the
> Rcmdr loads; rather, the "suggested" packages are loaded as they're needed.
> But all of the packages -- both those under "depends" and those under
> "suggests" -- really are necessary for all of the features of the Rcmdr to
> work. For example, if the "leaps" package is absent, then the "Subset model
> selection" item in the "Models" menu is suppressed.
>
> This arrangement works reasonably well, but it makes it awkward to install
> the Rcmdr. If the user issues the command install.packages("Rcmdr"), then
> the "suggested" packages aren't installed. On the other hand, if the user
> issues the command install.packages("Rcmdr", dependencies=TRUE), which is
> what I currently recommend, then "suggested" packages are installed
> recursively, causing dozens of packages, most of them actually unnecessary,
> to be installed. This issue has been growing more acute, and at this point
> even with a fast Internet connection it takes quite a while for all of the
> dependencies to download and install.
>
> I wonder whether I've missed something. Is there a way for me to arrange the
> Rcmdr package dependencies so that only the necessary packages (those
> currently listed under both "depends" and "suggests" and the packages on
> which they "depend") are installed along with the Rcmdr, but the currently
> "suggested" packages aren't loaded when the Rcmdr loads?
>
> Any help would be appreciated.
>
> John
>
> ------------------------------
> John Fox, Professor
> Department of Sociology
> McMaster University
> Hamilton, Ontario, Canada
> web: socserv.mcmaster.ca/jfox
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From jfox at mcmaster.ca  Tue Sep 22 20:50:07 2009
From: jfox at mcmaster.ca (John Fox)
Date: Tue, 22 Sep 2009 14:50:07 -0400
Subject: [Rd] Rcmdr package dependencies
In-Reply-To: <4AB91497.4020505@statistik.tu-dortmund.de>
References: <002001ca3b86$cda835d0$68f8a170$@ca>
	<4AB91497.4020505@statistik.tu-dortmund.de>
Message-ID: <006a01ca3bb5$814591e0$83d0b5a0$@ca>

Dear Uwe,

> -----Original Message-----
> From: Uwe Ligges [mailto:ligges at statistik.tu-dortmund.de]
> Sent: September-22-09 2:17 PM
> To: John Fox
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] Rcmdr package dependencies
> 
> 
> 
> John Fox wrote:
> > Dear r-devel members,
> >
> > My Rcmdr package "depends" on several other packages (tcltk, grDevices,
> > utils, and car) and "suggests" a number of others (abind, aplpack,
> > colorspace, effects, foreign, grid, Hmisc, lattice, leaps, lmtest, MASS,
> > mgcv, multcomp, nlme, nnet, relimp, rgl, and RODBC). The reason for the
> > distinction is that I don't want all of these packages to load when the
> > Rcmdr loads; rather, the "suggested" packages are loaded as they're
needed.
> > But all of the packages -- both those under "depends" and those under
> > "suggests" -- really are necessary for all of the features of the Rcmdr
to
> > work. For example, if the "leaps" package is absent, then the "Subset
model
> > selection" item in the "Models" menu is suppressed.
> >
> > This arrangement works reasonably well, but it makes it awkward to
install
> > the Rcmdr. If the user issues the command install.packages("Rcmdr"),
then
> > the "suggested" packages aren't installed. On the other hand, if the
user
> > issues the command install.packages("Rcmdr", dependencies=TRUE), which
is
> > what I currently recommend, then "suggested" packages are installed
> > recursively, causing dozens of packages, most of them actually
unnecessary,
> > to be installed. This issue has been growing more acute, and at this
point
> > even with a fast Internet connection it takes quite a while for all of
the
> > dependencies to download and install.
> >
> > I wonder whether I've missed something. Is there a way for me to arrange
> the
> > Rcmdr package dependencies so that only the necessary packages (those
> > currently listed under both "depends" and "suggests" and the packages on
> > which they "depend") are installed along with the Rcmdr, but the
currently
> > "suggested" packages aren't loaded when the Rcmdr loads?
> 
> 
> 
> Dear John,
> 
> no, this is not possible.
> 
> Consider your package A (or Rcmdr) suggests B that suggests C.
> Then A::foo uses the function B::bar which only works if C::dep is
> present. B works essentially without C but it requires C just to make
> bar work. Then this means your A::foo won't work if C is not installed
> and you won't get it with the setup mentioned above.
> 
> In summary, I fear what you want might work well *now* (by chance), but
> it does not work in general.

I agree that what I want to do isn't bullet-proof. I think, however, that in
most, if not all, cases, the Rcmdr dialogs will work even if packages
suggested by currently directly suggested packages were not installed. In
fact, this is what happens when a package is installed with the default
dependencies=FALSE. If it turns out that some such indirect dependency is
actually necessary, I could add that package to those directly suggested
(were such a mechanism possible). I'd save users a lot of downloads at the
price of occasionally having to specify a dependency explicitly.

Thanks,
 John

> 
> Best wishes,
> Uwe
> 
> 
> 
> 
> 
> 
> > Any help would be appreciated.
> >
> > John
> >
> > ------------------------------
> > John Fox, Professor
> > Department of Sociology
> > McMaster University
> > Hamilton, Ontario, Canada
> > web: socserv.mcmaster.ca/jfox
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel


From jfox at mcmaster.ca  Tue Sep 22 20:54:47 2009
From: jfox at mcmaster.ca (John Fox)
Date: Tue, 22 Sep 2009 14:54:47 -0400
Subject: [Rd] Rcmdr package dependencies
In-Reply-To: <971536df0909221131l5b3dc380v14b1c96c8e9fcf9c@mail.gmail.com>
References: <002001ca3b86$cda835d0$68f8a170$@ca>
	<971536df0909221131l5b3dc380v14b1c96c8e9fcf9c@mail.gmail.com>
Message-ID: <006b01ca3bb6$28095f70$781c1e50$@ca>

Dear Gabor,

I thought of this solution but rejected it, perhaps too hastily, because it
seemed awkward. I suppose, however, that since the Rcmdr package would be
unchanged, a user could choose to install it as at present with
dependencies=TRUE, or alternatively install the RcmdrInstall package and
avoid the recursive installation of suggested packages. Maybe the idea is a
good one after all.

Thank you,
 John


> -----Original Message-----
> From: Gabor Grothendieck [mailto:ggrothendieck at gmail.com]
> Sent: September-22-09 2:32 PM
> To: John Fox
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] Rcmdr package dependencies
> 
> Create a package called RcmdrInstall, say, with no content and have it
> depend on Rcmdr.  RcmdrInstall would have all packages as dependencies
> while Rcmdr would only have the essential packages as dependencies.
> 
> Install RcmdrInstall.  That would also force Rcmdr to be installed.
> 
> Now issue:
> 
>    library(Rcmdr)
> 
> as before and the non-essentials won't be loaded.
> 
> Thus the only difference between the current procedure and the new
> procedure as far as the user is concerned is that they install
> RcmdrInstall rather than Rcmdr.  They load and run Rcmdr in the same
> way.
> 
> On Tue, Sep 22, 2009 at 9:15 AM, John Fox <jfox at mcmaster.ca> wrote:
> > Dear r-devel members,
> >
> > My Rcmdr package "depends" on several other packages (tcltk, grDevices,
> > utils, and car) and "suggests" a number of others (abind, aplpack,
> > colorspace, effects, foreign, grid, Hmisc, lattice, leaps, lmtest, MASS,
> > mgcv, multcomp, nlme, nnet, relimp, rgl, and RODBC). The reason for the
> > distinction is that I don't want all of these packages to load when the
> > Rcmdr loads; rather, the "suggested" packages are loaded as they're
needed.
> > But all of the packages -- both those under "depends" and those under
> > "suggests" -- really are necessary for all of the features of the Rcmdr
to
> > work. For example, if the "leaps" package is absent, then the "Subset
model
> > selection" item in the "Models" menu is suppressed.
> >
> > This arrangement works reasonably well, but it makes it awkward to
install
> > the Rcmdr. If the user issues the command install.packages("Rcmdr"),
then
> > the "suggested" packages aren't installed. On the other hand, if the
user
> > issues the command install.packages("Rcmdr", dependencies=TRUE), which
is
> > what I currently recommend, then "suggested" packages are installed
> > recursively, causing dozens of packages, most of them actually
unnecessary,
> > to be installed. This issue has been growing more acute, and at this
point
> > even with a fast Internet connection it takes quite a while for all of
the
> > dependencies to download and install.
> >
> > I wonder whether I've missed something. Is there a way for me to arrange
> the
> > Rcmdr package dependencies so that only the necessary packages (those
> > currently listed under both "depends" and "suggests" and the packages on
> > which they "depend") are installed along with the Rcmdr, but the
currently
> > "suggested" packages aren't loaded when the Rcmdr loads?
> >
> > Any help would be appreciated.
> >
> > John
> >
> > ------------------------------
> > John Fox, Professor
> > Department of Sociology
> > McMaster University
> > Hamilton, Ontario, Canada
> > web: socserv.mcmaster.ca/jfox
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >


From ggrothendieck at gmail.com  Tue Sep 22 21:08:33 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 22 Sep 2009 15:08:33 -0400
Subject: [Rd] Rcmdr package dependencies
In-Reply-To: <006b01ca3bb6$28095f70$781c1e50$@ca>
References: <002001ca3b86$cda835d0$68f8a170$@ca>
	<971536df0909221131l5b3dc380v14b1c96c8e9fcf9c@mail.gmail.com> 
	<006b01ca3bb6$28095f70$781c1e50$@ca>
Message-ID: <971536df0909221208g37053ef4r3bb02f9c82c5b62@mail.gmail.com>

To make it foolproof at Rcmdr's load time (i.e. in the .onLoad
function) you could check whether RcmdrInstall was available (not
necessarily loaded, just available).  If not, then you could issue a
message asking the user to install it.  This would help the user avoid
the situation where they install Rcmdr without RcmdrInstall and
thereby not have the other packages available.

On Tue, Sep 22, 2009 at 2:54 PM, John Fox <jfox at mcmaster.ca> wrote:
> Dear Gabor,
>
> I thought of this solution but rejected it, perhaps too hastily, because it
> seemed awkward. I suppose, however, that since the Rcmdr package would be
> unchanged, a user could choose to install it as at present with
> dependencies=TRUE, or alternatively install the RcmdrInstall package and
> avoid the recursive installation of suggested packages. Maybe the idea is a
> good one after all.
>
> Thank you,
> ?John
>
>
>> -----Original Message-----
>> From: Gabor Grothendieck [mailto:ggrothendieck at gmail.com]
>> Sent: September-22-09 2:32 PM
>> To: John Fox
>> Cc: r-devel at r-project.org
>> Subject: Re: [Rd] Rcmdr package dependencies
>>
>> Create a package called RcmdrInstall, say, with no content and have it
>> depend on Rcmdr. ?RcmdrInstall would have all packages as dependencies
>> while Rcmdr would only have the essential packages as dependencies.
>>
>> Install RcmdrInstall. ?That would also force Rcmdr to be installed.
>>
>> Now issue:
>>
>> ? ?library(Rcmdr)
>>
>> as before and the non-essentials won't be loaded.
>>
>> Thus the only difference between the current procedure and the new
>> procedure as far as the user is concerned is that they install
>> RcmdrInstall rather than Rcmdr. ?They load and run Rcmdr in the same
>> way.
>>
>> On Tue, Sep 22, 2009 at 9:15 AM, John Fox <jfox at mcmaster.ca> wrote:
>> > Dear r-devel members,
>> >
>> > My Rcmdr package "depends" on several other packages (tcltk, grDevices,
>> > utils, and car) and "suggests" a number of others (abind, aplpack,
>> > colorspace, effects, foreign, grid, Hmisc, lattice, leaps, lmtest, MASS,
>> > mgcv, multcomp, nlme, nnet, relimp, rgl, and RODBC). The reason for the
>> > distinction is that I don't want all of these packages to load when the
>> > Rcmdr loads; rather, the "suggested" packages are loaded as they're
> needed.
>> > But all of the packages -- both those under "depends" and those under
>> > "suggests" -- really are necessary for all of the features of the Rcmdr
> to
>> > work. For example, if the "leaps" package is absent, then the "Subset
> model
>> > selection" item in the "Models" menu is suppressed.
>> >
>> > This arrangement works reasonably well, but it makes it awkward to
> install
>> > the Rcmdr. If the user issues the command install.packages("Rcmdr"),
> then
>> > the "suggested" packages aren't installed. On the other hand, if the
> user
>> > issues the command install.packages("Rcmdr", dependencies=TRUE), which
> is
>> > what I currently recommend, then "suggested" packages are installed
>> > recursively, causing dozens of packages, most of them actually
> unnecessary,
>> > to be installed. This issue has been growing more acute, and at this
> point
>> > even with a fast Internet connection it takes quite a while for all of
> the
>> > dependencies to download and install.
>> >
>> > I wonder whether I've missed something. Is there a way for me to arrange
>> the
>> > Rcmdr package dependencies so that only the necessary packages (those
>> > currently listed under both "depends" and "suggests" and the packages on
>> > which they "depend") are installed along with the Rcmdr, but the
> currently
>> > "suggested" packages aren't loaded when the Rcmdr loads?
>> >
>> > Any help would be appreciated.
>> >
>> > John
>> >
>> > ------------------------------
>> > John Fox, Professor
>> > Department of Sociology
>> > McMaster University
>> > Hamilton, Ontario, Canada
>> > web: socserv.mcmaster.ca/jfox
>> >
>> > ______________________________________________
>> > R-devel at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-devel
>> >
>
>
>


From jfox at mcmaster.ca  Tue Sep 22 21:48:59 2009
From: jfox at mcmaster.ca (John Fox)
Date: Tue, 22 Sep 2009 15:48:59 -0400
Subject: [Rd] Rcmdr package dependencies
In-Reply-To: <971536df0909221208g37053ef4r3bb02f9c82c5b62@mail.gmail.com>
References: <002001ca3b86$cda835d0$68f8a170$@ca>
	<971536df0909221131l5b3dc380v14b1c96c8e9fcf9c@mail.gmail.com>
	<006b01ca3bb6$28095f70$781c1e50$@ca>
	<971536df0909221208g37053ef4r3bb02f9c82c5b62@mail.gmail.com>
Message-ID: <006f01ca3bbd$ba9efdc0$2fdcf940$@ca>

Dear Gabor,

At present, the Rcmdr package checks whether its dependencies are present
and offers to install them if they are not. Also at present, it installs its
dependencies with dep=TRUE, but that could be changed. I suppose that I
could simply rely on this mechanism rather than have a separate RcmdrInstall
package or advise users to install the Rcmdr itself with dep=TRUE.

Best,
 John


> -----Original Message-----
> From: Gabor Grothendieck [mailto:ggrothendieck at gmail.com]
> Sent: September-22-09 3:09 PM
> To: John Fox
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] Rcmdr package dependencies
> 
> To make it foolproof at Rcmdr's load time (i.e. in the .onLoad
> function) you could check whether RcmdrInstall was available (not
> necessarily loaded, just available).  If not, then you could issue a
> message asking the user to install it.  This would help the user avoid
> the situation where they install Rcmdr without RcmdrInstall and
> thereby not have the other packages available.
> 
> On Tue, Sep 22, 2009 at 2:54 PM, John Fox <jfox at mcmaster.ca> wrote:
> > Dear Gabor,
> >
> > I thought of this solution but rejected it, perhaps too hastily, because
it
> > seemed awkward. I suppose, however, that since the Rcmdr package would
be
> > unchanged, a user could choose to install it as at present with
> > dependencies=TRUE, or alternatively install the RcmdrInstall package and
> > avoid the recursive installation of suggested packages. Maybe the idea
is a
> > good one after all.
> >
> > Thank you,
> > ?John
> >
> >
> >> -----Original Message-----
> >> From: Gabor Grothendieck [mailto:ggrothendieck at gmail.com]
> >> Sent: September-22-09 2:32 PM
> >> To: John Fox
> >> Cc: r-devel at r-project.org
> >> Subject: Re: [Rd] Rcmdr package dependencies
> >>
> >> Create a package called RcmdrInstall, say, with no content and have it
> >> depend on Rcmdr. ?RcmdrInstall would have all packages as dependencies
> >> while Rcmdr would only have the essential packages as dependencies.
> >>
> >> Install RcmdrInstall. ?That would also force Rcmdr to be installed.
> >>
> >> Now issue:
> >>
> >> ? ?library(Rcmdr)
> >>
> >> as before and the non-essentials won't be loaded.
> >>
> >> Thus the only difference between the current procedure and the new
> >> procedure as far as the user is concerned is that they install
> >> RcmdrInstall rather than Rcmdr. ?They load and run Rcmdr in the same
> >> way.
> >>
> >> On Tue, Sep 22, 2009 at 9:15 AM, John Fox <jfox at mcmaster.ca> wrote:
> >> > Dear r-devel members,
> >> >
> >> > My Rcmdr package "depends" on several other packages (tcltk,
grDevices,
> >> > utils, and car) and "suggests" a number of others (abind, aplpack,
> >> > colorspace, effects, foreign, grid, Hmisc, lattice, leaps, lmtest,
MASS,
> >> > mgcv, multcomp, nlme, nnet, relimp, rgl, and RODBC). The reason for
the
> >> > distinction is that I don't want all of these packages to load when
the
> >> > Rcmdr loads; rather, the "suggested" packages are loaded as they're
> > needed.
> >> > But all of the packages -- both those under "depends" and those under
> >> > "suggests" -- really are necessary for all of the features of the
Rcmdr
> > to
> >> > work. For example, if the "leaps" package is absent, then the "Subset
> > model
> >> > selection" item in the "Models" menu is suppressed.
> >> >
> >> > This arrangement works reasonably well, but it makes it awkward to
> > install
> >> > the Rcmdr. If the user issues the command install.packages("Rcmdr"),
> > then
> >> > the "suggested" packages aren't installed. On the other hand, if the
> > user
> >> > issues the command install.packages("Rcmdr", dependencies=TRUE),
which
> > is
> >> > what I currently recommend, then "suggested" packages are installed
> >> > recursively, causing dozens of packages, most of them actually
> > unnecessary,
> >> > to be installed. This issue has been growing more acute, and at this
> > point
> >> > even with a fast Internet connection it takes quite a while for all
of
> > the
> >> > dependencies to download and install.
> >> >
> >> > I wonder whether I've missed something. Is there a way for me to
arrange
> >> the
> >> > Rcmdr package dependencies so that only the necessary packages (those
> >> > currently listed under both "depends" and "suggests" and the packages
on
> >> > which they "depend") are installed along with the Rcmdr, but the
> > currently
> >> > "suggested" packages aren't loaded when the Rcmdr loads?
> >> >
> >> > Any help would be appreciated.
> >> >
> >> > John
> >> >
> >> > ------------------------------
> >> > John Fox, Professor
> >> > Department of Sociology
> >> > McMaster University
> >> > Hamilton, Ontario, Canada
> >> > web: socserv.mcmaster.ca/jfox
> >> >
> >> > ______________________________________________
> >> > R-devel at r-project.org mailing list
> >> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >> >
> >
> >
> >


From ligges at statistik.tu-dortmund.de  Tue Sep 22 23:00:53 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 22 Sep 2009 23:00:53 +0200
Subject: [Rd] Rcmdr package dependencies
In-Reply-To: <006a01ca3bb5$814591e0$83d0b5a0$@ca>
References: <002001ca3b86$cda835d0$68f8a170$@ca>
	<4AB91497.4020505@statistik.tu-dortmund.de>
	<006a01ca3bb5$814591e0$83d0b5a0$@ca>
Message-ID: <4AB93B05.4020607@statistik.tu-dortmund.de>



John Fox wrote:
> Dear Uwe,
> 
>> -----Original Message-----
>> From: Uwe Ligges [mailto:ligges at statistik.tu-dortmund.de]
>> Sent: September-22-09 2:17 PM
>> To: John Fox
>> Cc: r-devel at r-project.org
>> Subject: Re: [Rd] Rcmdr package dependencies
>>
>>
>>
>> John Fox wrote:
>>> Dear r-devel members,
>>>
>>> My Rcmdr package "depends" on several other packages (tcltk, grDevices,
>>> utils, and car) and "suggests" a number of others (abind, aplpack,
>>> colorspace, effects, foreign, grid, Hmisc, lattice, leaps, lmtest, MASS,
>>> mgcv, multcomp, nlme, nnet, relimp, rgl, and RODBC). The reason for the
>>> distinction is that I don't want all of these packages to load when the
>>> Rcmdr loads; rather, the "suggested" packages are loaded as they're
> needed.
>>> But all of the packages -- both those under "depends" and those under
>>> "suggests" -- really are necessary for all of the features of the Rcmdr
> to
>>> work. For example, if the "leaps" package is absent, then the "Subset
> model
>>> selection" item in the "Models" menu is suppressed.
>>>
>>> This arrangement works reasonably well, but it makes it awkward to
> install
>>> the Rcmdr. If the user issues the command install.packages("Rcmdr"),
> then
>>> the "suggested" packages aren't installed. On the other hand, if the
> user
>>> issues the command install.packages("Rcmdr", dependencies=TRUE), which
> is
>>> what I currently recommend, then "suggested" packages are installed
>>> recursively, causing dozens of packages, most of them actually
> unnecessary,
>>> to be installed. This issue has been growing more acute, and at this
> point
>>> even with a fast Internet connection it takes quite a while for all of
> the
>>> dependencies to download and install.
>>>
>>> I wonder whether I've missed something. Is there a way for me to arrange
>> the
>>> Rcmdr package dependencies so that only the necessary packages (those
>>> currently listed under both "depends" and "suggests" and the packages on
>>> which they "depend") are installed along with the Rcmdr, but the
> currently
>>> "suggested" packages aren't loaded when the Rcmdr loads?
>>
>>
>> Dear John,
>>
>> no, this is not possible.
>>
>> Consider your package A (or Rcmdr) suggests B that suggests C.
>> Then A::foo uses the function B::bar which only works if C::dep is
>> present. B works essentially without C but it requires C just to make
>> bar work. Then this means your A::foo won't work if C is not installed
>> and you won't get it with the setup mentioned above.
>>
>> In summary, I fear what you want might work well *now* (by chance), but
>> it does not work in general.
> 
> I agree that what I want to do isn't bullet-proof. I think, however, that in
> most, if not all, cases, the Rcmdr dialogs will work even if packages
> suggested by currently directly suggested packages were not installed. In
> fact, this is what happens when a package is installed with the default
> dependencies=FALSE. If it turns out that some such indirect dependency is
> actually necessary, I could add that package to those directly suggested
> (were such a mechanism possible). I'd save users a lot of downloads at the
> price of occasionally having to specify a dependency explicitly.


Thanks for the explanation. Unfortunately the current infrastructure 
works with recursive calling with the same arguments. In this case we'd 
need some code that allows to have the first level different from the 
rest of the recursion.
Perhaps one way to go would be to install Rcmdr including its 
dependencies (only) and provide some simple function that installs its 
suggests and their dependencies afterwards if not available. Hmmm, on he 
other hand I do now want to suggest to have yet another mechanism such 
as the biocLite function that I still dislike.

Just some thoughts, best wishes,
Uwe


> Thanks,
>  John
> 
>> Best wishes,
>> Uwe
>>
>>
>>
>>
>>
>>
>>> Any help would be appreciated.
>>>
>>> John
>>>
>>> ------------------------------
>>> John Fox, Professor
>>> Department of Sociology
>>> McMaster University
>>> Hamilton, Ontario, Canada
>>> web: socserv.mcmaster.ca/jfox
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>


From seth at userprimary.net  Tue Sep 22 23:12:57 2009
From: seth at userprimary.net (Seth Falcon)
Date: Tue, 22 Sep 2009 14:12:57 -0700
Subject: [Rd] Rcmdr package dependencies
In-Reply-To: <4AB91497.4020505@statistik.tu-dortmund.de>
References: <002001ca3b86$cda835d0$68f8a170$@ca>
	<4AB91497.4020505@statistik.tu-dortmund.de>
Message-ID: <20090922211257.GB203@orange.local>

* On 2009-09-22 at 20:16 +0200 Uwe Ligges wrote:
> no, this is not possible.
> 
> Consider your package A (or Rcmdr) suggests B that suggests C.
> Then A::foo uses the function B::bar which only works if C::dep is
> present. B works essentially without C but it requires C just to
> make bar work. Then this means your A::foo won't work if C is not
> installed and you won't get it with the setup mentioned above.
> 
> In summary, I fear what you want might work well *now* (by chance),
> but it does not work in general.

In general, one would expect a given package to function when its
suggested packages are not available.  As such, it seems quite
reasonable to install a package, its Depends, Imports, and Suggests,
but not install Suggests recursively.

I think you could achieve such an installation using two calls to
install.packages:

install.packages("Rcmdr")
Rcmdr.Suggests <- strsplit(packageDescription("Rcmdr")$Suggests, ",\\s?")[[1]]
## need extra cleanup since packageDescription("blah")$Suggests
## Returns package names with versions as strings
wantPkgs <- sub("^([^ ]+).*", "\\1", Rcmdr.Suggests)
havePkgs <- installed.packages()[, "Package"]
wantPkgs <- wantPkgs[!(wantPkgs %in% havePkgs)]
install.packages(wantPkgs)

+ seth

-- 
Seth Falcon | @sfalcon | http://userprimary.net/user


From jfox at mcmaster.ca  Tue Sep 22 23:21:12 2009
From: jfox at mcmaster.ca (John Fox)
Date: Tue, 22 Sep 2009 17:21:12 -0400
Subject: [Rd] Rcmdr package dependencies
In-Reply-To: <20090922211257.GB203@orange.local>
References: <002001ca3b86$cda835d0$68f8a170$@ca>
	<4AB91497.4020505@statistik.tu-dortmund.de>
	<20090922211257.GB203@orange.local>
Message-ID: <008601ca3bca$9c439db0$d4cad910$@ca>

Dear Seth,

> -----Original Message-----
> From: Seth Falcon [mailto:seth at userprimary.net]
> Sent: September-22-09 5:13 PM
> To: Uwe Ligges
> Cc: John Fox; r-devel at r-project.org
> Subject: Re: [Rd] Rcmdr package dependencies
> 
> * On 2009-09-22 at 20:16 +0200 Uwe Ligges wrote:
> > no, this is not possible.
> >
> > Consider your package A (or Rcmdr) suggests B that suggests C.
> > Then A::foo uses the function B::bar which only works if C::dep is
> > present. B works essentially without C but it requires C just to
> > make bar work. Then this means your A::foo won't work if C is not
> > installed and you won't get it with the setup mentioned above.
> >
> > In summary, I fear what you want might work well *now* (by chance),
> > but it does not work in general.
> 
> In general, one would expect a given package to function when its
> suggested packages are not available.  As such, it seems quite
> reasonable to install a package, its Depends, Imports, and Suggests,
> but not install Suggests recursively.
> 
> I think you could achieve such an installation using two calls to
> install.packages:
> 
> install.packages("Rcmdr")
> Rcmdr.Suggests <- strsplit(packageDescription("Rcmdr")$Suggests,
> ",\\s?")[[1]]
> ## need extra cleanup since packageDescription("blah")$Suggests
> ## Returns package names with versions as strings
> wantPkgs <- sub("^([^ ]+).*", "\\1", Rcmdr.Suggests)
> havePkgs <- installed.packages()[, "Package"]
> wantPkgs <- wantPkgs[!(wantPkgs %in% havePkgs)]
> install.packages(wantPkgs)

The Rcmdr maintains a list of its dependencies, so it already does something
similar to this, but I like your version better because it queries the
Description file directly. I can't really expect a user to issue a command
like this, so I suppose that the best solution is, as at present, to have
the Rcmdr package do the checking and installation at start-up but to
install with dep=FALSE.

Thanks,
 John

> 
> + seth
> 
> --
> Seth Falcon | @sfalcon | http://userprimary.net/user


From ligges at statistik.tu-dortmund.de  Tue Sep 22 23:32:14 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 22 Sep 2009 23:32:14 +0200
Subject: [Rd] Rcmdr package dependencies
In-Reply-To: <008601ca3bca$9c439db0$d4cad910$@ca>
References: <002001ca3b86$cda835d0$68f8a170$@ca>
	<4AB91497.4020505@statistik.tu-dortmund.de>
	<20090922211257.GB203@orange.local>
	<008601ca3bca$9c439db0$d4cad910$@ca>
Message-ID: <4AB9425E.7080805@statistik.tu-dortmund.de>



John Fox wrote:
> Dear Seth,
> 
>> -----Original Message-----
>> From: Seth Falcon [mailto:seth at userprimary.net]
>> Sent: September-22-09 5:13 PM
>> To: Uwe Ligges
>> Cc: John Fox; r-devel at r-project.org
>> Subject: Re: [Rd] Rcmdr package dependencies
>>
>> * On 2009-09-22 at 20:16 +0200 Uwe Ligges wrote:
>>> no, this is not possible.
>>>
>>> Consider your package A (or Rcmdr) suggests B that suggests C.
>>> Then A::foo uses the function B::bar which only works if C::dep is
>>> present. B works essentially without C but it requires C just to
>>> make bar work. Then this means your A::foo won't work if C is not
>>> installed and you won't get it with the setup mentioned above.
>>>
>>> In summary, I fear what you want might work well *now* (by chance),
>>> but it does not work in general.
>> In general, one would expect a given package to function when its
>> suggested packages are not available.  As such, it seems quite
>> reasonable to install a package, its Depends, Imports, and Suggests,
>> but not install Suggests recursively.
>>
>> I think you could achieve such an installation using two calls to
>> install.packages:
>>
>> install.packages("Rcmdr")
>> Rcmdr.Suggests <- strsplit(packageDescription("Rcmdr")$Suggests,
>> ",\\s?")[[1]]
>> ## need extra cleanup since packageDescription("blah")$Suggests
>> ## Returns package names with versions as strings
>> wantPkgs <- sub("^([^ ]+).*", "\\1", Rcmdr.Suggests)


Nice suggestion, indeed! I think there is some code in package "tools" 
that help to resolve these issues even more convenient:


wantPkgs <- package.dependencies(available.packages()["Rcmdr",], 
depLevel = "Suggests")[["Rcmdr"]][,1]

so you do not need to have Rcmdr already installed and can rely on the R 
internal code that can strip all that version information.

Best wishes,
Uwe





>> havePkgs <- installed.packages()[, "Package"]
>> wantPkgs <- wantPkgs[!(wantPkgs %in% havePkgs)]
>> install.packages(wantPkgs)
> 
> The Rcmdr maintains a list of its dependencies, so it already does something
> similar to this, but I like your version better because it queries the
> Description file directly. I can't really expect a user to issue a command
> like this, so I suppose that the best solution is, as at present, to have
> the Rcmdr package do the checking and installation at start-up but to
> install with dep=FALSE.
> 
> Thanks,
>  John
> 
>> + seth
>>
>> --
>> Seth Falcon | @sfalcon | http://userprimary.net/user
> 
>


From jeff.hamann at forestinformatics.com  Wed Sep 23 00:12:20 2009
From: jeff.hamann at forestinformatics.com (Jeff Hamann)
Date: Tue, 22 Sep 2009 15:12:20 -0700
Subject: [Rd] Snow leopard ./configure "cannot compile a simple Fortran
	program"
Message-ID: <2DDEE2B2-CAF7-4019-84B5-742E31231447@forestinformatics.com>

I hope this is the place for this...

I have to rebuild from scratch under Snow Leopard, and when I  
attempted to build R-2.9.1, I get the following results from ./ 
configure:


checking how to get verbose linking output from fc... configure:  
WARNING: compilation failed

checking for Fortran 77 libraries of fc...
checking how to get verbose linking output from gcc -std=gnu99... -v
checking for C libraries of gcc -std=gnu99...  -lcrt1.10.6.o -L/usr/ 
local/lib -L/usr/lib/gcc/i686-apple-darwin10/4.2.1/x86_64 -L/usr/lib/ 
i686-apple-darwin10/4.2.1 -L/usr/lib/gcc/i686-apple-darwin10/4.2.1 -L/ 
usr/lib/gcc/i686-apple-darwin10/4.2.1/../../../i686-apple- 
darwin10/4.2.1 -L/usr/lib/gcc/i686-apple-darwin10/4.2.1/../../.. - 
lSystem
checking for dummy main to link with Fortran 77 libraries... rm:  
conftest.dSYM: is a directory
none
checking for Fortran 77 name-mangling scheme... configure: error:  
cannot compile a simple Fortran program
See `config.log' for more details.
Jeff-Hamanns-MacBook-Pro:R-2.9.1 hamannj

Since this seems to be a 'fortran thing' methinks I should send this  
to Apple as well?

Jeff-Hamanns-MacBook-Pro:R-2.9.1 hamannj$ uname -a
Darwin Jeff-Hamanns-MacBook-Pro.local 10.0.0 Darwin Kernel Version  
10.0.0: Fri Jul 31 22:47:34 PDT 2009; root:xnu-1456.1.25~1/ 
RELEASE_I386 i386
Jeff-Hamanns-MacBook-Pro:R-2.9.1 hamannj$


From simon.urbanek at r-project.org  Wed Sep 23 03:05:18 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 22 Sep 2009 21:05:18 -0400
Subject: [Rd] Snow leopard ./configure "cannot compile a simple Fortran
	program"
In-Reply-To: <2DDEE2B2-CAF7-4019-84B5-742E31231447@forestinformatics.com>
References: <2DDEE2B2-CAF7-4019-84B5-742E31231447@forestinformatics.com>
Message-ID: <DA27D87B-F672-4506-AE79-F5C0B9660C1D@r-project.org>

Jeff,

On Sep 22, 2009, at 6:12 PM, Jeff Hamann wrote:

> I hope this is the place for this...
>

Yes, indeed.


> I have to rebuild from scratch under Snow Leopard, and when I  
> attempted to build R-2.9.1, I get the following results from ./ 
> configure:
>
>
> checking how to get verbose linking output from fc... configure:  
> WARNING: compilation failed
>
> checking for Fortran 77 libraries of fc...

  ^^--- I think you don't have a Fortran compiler. fc is a utility on  
SL that has nothing to do with Fortran and Xcode doesn't include  
Fortran, either. Please install GNU Fortran either from CRAN
http://cran.r-project.org/bin/macosx/tools/
or if you feel brave take the Xcode 3.2 add on from
http://r.research.att.com/gfortran-42-5646.pkg

Also please don't forget to add -arch i386 or -arch x86_64 to the  
compilers when configuring R (see R for Mac FAQ) - the defaults are  
different between gcc (64-bit) and gfortran (32-bit)!

Cheers,
Simon

PS: There is usually no need to compile R from sources on OS X - see
http://r.research.att.com/
for the latest R release in both 32 and 64-bit for Leopard/Snow Leopard.


> checking how to get verbose linking output from gcc -std=gnu99... -v
> checking for C libraries of gcc -std=gnu99...  -lcrt1.10.6.o -L/usr/ 
> local/lib -L/usr/lib/gcc/i686-apple-darwin10/4.2.1/x86_64 -L/usr/lib/ 
> i686-apple-darwin10/4.2.1 -L/usr/lib/gcc/i686-apple-darwin10/4.2.1 - 
> L/usr/lib/gcc/i686-apple-darwin10/4.2.1/../../../i686-apple- 
> darwin10/4.2.1 -L/usr/lib/gcc/i686-apple-darwin10/4.2.1/../../.. - 
> lSystem
> checking for dummy main to link with Fortran 77 libraries... rm:  
> conftest.dSYM: is a directory
> none
> checking for Fortran 77 name-mangling scheme... configure: error:  
> cannot compile a simple Fortran program
> See `config.log' for more details.
> Jeff-Hamanns-MacBook-Pro:R-2.9.1 hamannj
>
> Since this seems to be a 'fortran thing' methinks I should send this  
> to Apple as well?
>
> Jeff-Hamanns-MacBook-Pro:R-2.9.1 hamannj$ uname -a
> Darwin Jeff-Hamanns-MacBook-Pro.local 10.0.0 Darwin Kernel Version  
> 10.0.0: Fri Jul 31 22:47:34 PDT 2009; root:xnu-1456.1.25~1/ 
> RELEASE_I386 i386
> Jeff-Hamanns-MacBook-Pro:R-2.9.1 hamannj$
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From vqnguyen at uci.edu  Wed Sep 23 09:39:45 2009
From: vqnguyen at uci.edu (Vinh Nguyen)
Date: Wed, 23 Sep 2009 00:39:45 -0700
Subject: [Rd] R + C + Lapack toy regression example
Message-ID: <13c5a0ae0909230039w28389d5ch72f63ce5065d0e1d@mail.gmail.com>

dear list,

since matrix manipulations is often of interest in statistical
computations, i'd like to get a working example of using Lapack for
regression.  However, i run into an error.

My matrix-lapack-example.c file:
#include <R_ext/Lapack.h>

void reg(const char* trans, const int* m, const int* n,
         const int* nrhs, double* a, const int* lda,
         double* b, const int* ldb,
         double* work, const int* lwork, int* info)
{
  F77_CALL(dgels)(trans, m, n, nrhs, a, lda, b, ldb, work, lwork, info);
}

My matrix-lapack-example.R file:
dyn.load( "matrix-lapack-example.so" )

regression <- function( X, Y ){
  m <- nrow( X )
  n <- ncol( X )
  stopifnot( m >= n , is.vector( Y ), n != length( Y ) )
  mn <- min( m, n )
  lwork <- mn + max( mn, 1 )
  ### to be used with dgels
  ### http://www.netlib.org/lapack/double/dgels.f
  rslt <- .C( "reg"
             , trans=as.character( "N" )
             , m=as.integer( m ), n=as.integer( n )
             , nrhs=as.integer( 1 ), a=as.double( X )
             , lda=as.integer( m ), b=as.double( Y )
             , ldb=as.integer( m ) , work=double( lwork )
             , lwork=as.integer( lwork )
             , info=integer( 1 ) )
  ##F77_NAME(dgels)(const char* trans, const int* m, const int* n,
  ##                const int* nrhs, double* a, const int* lda,
  ##                double* b, const int* ldb,
  ##                double* work, const int* lwork, int* info);
  return( rslt )
}

n <- 100
x <- rnorm( 100 )
y <- 2.5 + 3*x + rnorm( n )
X <- cbind( 1, x )

temp <- regression( X=X, Y=y )


dgels does linear least squares.  the C code compile fines with a
warning (ld: warning, duplicate dylib
/usr/local/lib/libgcc_s.1.dylib).  in R, i get the following when i
run regression():
> temp <- regression( X=X, Y=y )
Parameter 1 to routine DGELS  was incorrect
Mac OS BLAS parameter error in DGELS , parameter #0, (unavailable), is 0

Process R exited abnormally with code 1 at Wed Sep 23 00:21:59 2009

am i doing something wrong?  is my as.character() used wrong here?

i know R uses fortran code for lm.  but suppose i wanted to do
regression in C/C++.  is this lapack method the recommended / "best
practice" route?  i just want to know whats the recommended method for
doing matrix manipulations in C.  thanks!

vinh


From joseclaudio.faria at gmail.com  Wed Sep 23 12:47:31 2009
From: joseclaudio.faria at gmail.com (Jose Claudio Faria)
Date: Wed, 23 Sep 2009 07:47:31 -0300
Subject: [Rd] A couple of suggestions: source function (package base)
Message-ID: <c86bda880909230347v5b22b191g5f5091deaca3a985@mail.gmail.com>

The
extra "\n" is located at line 142 of the current source function:

cat("\n", dep, if (do.trunc)...

HTH,
-- 
///\\\///\\\///\\\///\\\///\\\///\\\///\\\///\\\
Jose Claudio Faria
Estatistica - prof. Titular
UESC/DCET/Brasil
joseclaudio.faria at gmail.com
///\\\///\\\///\\\///\\\///\\\///\\\///\\\///\\\


From pleydell at supagro.inra.fr  Wed Sep 23 13:44:05 2009
From: pleydell at supagro.inra.fr (pleydell at supagro.inra.fr)
Date: Wed, 23 Sep 2009 13:44:05 +0200
Subject: [Rd] Strange behaviour with global variable in C
Message-ID: <20090923134405.25tkm5ftwdw84sos@web.supagro.inra.fr>

I understand global variables can be a bad idea, but even so I would like to
understand what is going on here...

### DESCRIPTION OF PROGRAM ###

...I have a strange bug on a global variable in some C code which I am compiling
using

$ MAKEFLAGS="CFLAGS=-g -O0" R CMD SHLIB myProgram.c

the global variable in question is the log likelihood. In an old version of the
program I initialized this as

double loglik = -999999999999999

and in current versions I initialize this as

double loglik = 0.0

and long sequences of 9s do not appear anywhere in the program now (I confirmed
this using the grep command in bash)

A function called update_loglik() exists in the file loglik.c and so myProgram.c
includes the line

#include "loglik.c"

prior to the main() function.

The first line in the function update_loglik() is

loglik = 0.0;

and then later in the function there is a loop containing the line

loglik += some_value_corresponding_to_one_observation


### DESCRIPTION OF BUG ###

If I add printf("%f",loglik) at the second line of update_loglik() it prints
"0.0", BUT if I set a breakpoint here and execute

(gdb) p loglik

in gdb it prints

-999999999999999

worse, the value being added to in the loop of update_loglik() is neither that
being printed by printf nor that being printed by gdb. Moreover, if I put
update_loglik() into a loop and printf the values I get

itter 0  loglik -1242105.108051
itter 1  loglik -602880.293985
itter 2  loglik -590470.733006
itter 3  loglik -578061.172026
itter 4  loglik -565651.611046
itter 5  loglik -553242.050066
itter 6  loglik -540832.489086
itter 7  loglik -528422.928106


### A CLUE ###

This is clearly a pointer problem, in fact I believe gdb gives us a good clue

(gdb) b loglik.c:100
Breakpoint 3 at 0xb7a2eba4: file loglik.c, line 100. (2 locations)
(gdb) i b
Num     Type           Disp Enb Address    What
3       breakpoint     keep y   <MULTIPLE> 0xb7a2eba4
3.1                         y     0xb7a2eba4 in update_loglik at loglik.c:100
3.2                         y     0xb7a2895a in update_loglik at loglik.c:100

for some reason gdb associates this breakpoint with two addresses (line 100 by
the way is where I try to set loglik to 0.0, described above)

I should perhaps also add that my project is subject to bzr (bazaar) version
control, so I wonder if this almost ghost-like resurrection of the
-999999999999 is due to either gcc or gdb confusing information from current
bzr versions with previous bzr versions. This resurrection occurs even after
turning off the computer and rebooting so it shouldn't be to do with memory
leaks.

So why is gdb giving multiple addresses for a single line breakpoint and why
gdb's ghostly resurrection of a long line of 9s even after a reboot?

thanks
David


From pleydell at supagro.inra.fr  Wed Sep 23 14:06:50 2009
From: pleydell at supagro.inra.fr (pleydell at supagro.inra.fr)
Date: Wed, 23 Sep 2009 14:06:50 +0200
Subject: [Rd] Strange behaviour with global variable in C
In-Reply-To: <20090923134405.25tkm5ftwdw84sos@web.supagro.inra.fr>
References: <20090923134405.25tkm5ftwdw84sos@web.supagro.inra.fr>
Message-ID: <20090923140650.fsdazrjbcnc4g8ow@web.supagro.inra.fr>

To answer my own question...

I have two copies of my program

1) a working copy stored in $PROJECT/analysis/c
2) a packaged copy stored in $PROJECT/analysis/myPackage_1.0.2.tar.gz

I have been running a script which does the following

library(myPackage)
load(myData)
detach("package:myPackge")
dyn.load("$PROJECT/analysis/c/myProgram.so")
.C("main", ...)

The "resurrection" comes from values of loglik set in the packaged version and
not used in the working version. I had assumed detach would remove all traces
of the package but this is clearly wrong.

I wonder what over developers do when they want to switch from working with a
packaged version to a working version without restarting R and without
generating conflicts between the two?  (Perhaps I can find that in
documentation somewhere...)

David


From pleydell at supagro.inra.fr  Wed Sep 23 16:07:26 2009
From: pleydell at supagro.inra.fr (pleydell at supagro.inra.fr)
Date: Wed, 23 Sep 2009 16:07:26 +0200
Subject: [Rd] enabling core dumps
In-Reply-To: <4AA14290.1060401@fhcrc.org>
References: <20090904173944.et305vc9gon4480c@web.supagro.inra.fr>
	<20090904174842.rj5qh6kk93k8wg0k@web.supagro.inra.fr>
	<20090904181122.15h3os7s249w0o04@web.supagro.inra.fr>
	<4AA14290.1060401@fhcrc.org>
Message-ID: <20090923160726.qtfgqgygmbk0s44w@web.supagro.inra.fr>

> usually what happens is (# meant to be a comment char)
>
>  % R -d gdb -f test.R
>  gdb> run
>  ...segfault happens, breaks into gdb
>  gdb> bt # print the backtrace
>  gdb> up # move up the stack, to get to 'your' frame
>  gdb> l # show source listing, use -O0 compiler flag, see gdb> help dir
>  gdb> print some_suspect_variable
>  gdb> call Rf_PrintValue(some_suspect_sexp)
>  gdb> break suspect_function
>  gdb> run # restart script, but break at suspect_function

to continue a slightly old thread...

... If I launch gdb this way I don't have any means to navigate through
previously executed gdb lines using M-p and M-n, but following a
(gdb) run
or
(gdb) continue
I can use M-p and M-n to recall previous R commands

If I launch gdb in other ways M-p and M-n function as expected. I 
suppose there
is a confusion between gdb's M-p and ESS's M-p so that M-p only functions in
the ESS session.

I quite like running gdb using R's -d flag, but not being able to navigate
through the line history is sub-optimal. I'd be interested to hear if other
people running gdb this way encountered this problem and how they resolved it.

thanks
David


From richcalaway at revolution-computing.com  Wed Sep 23 20:45:15 2009
From: richcalaway at revolution-computing.com (richcalaway at revolution-computing.com)
Date: Wed, 23 Sep 2009 20:45:15 +0200 (CEST)
Subject: [Rd] warnings handled oddly in functions with browser calls
	(PR#13967)
Message-ID: <20090923184515.35CF42831FF2@mail.pubhealth.ku.dk>

Full_Name: Rich Calaway
Version: 2.9.2
OS: Windows Vista
Submission from: (NULL) (65.47.30.18)


Consider the following function:

myfun <- function(){
	print(log(-1))
	browser()
	print("Good-bye!")
}

In the default case, with options(warn=0), if I call this function and type
nothing but standard browser commands (c, n, where, Q) at the browser prompt,
the warning produced by log(-1) is shown at the completion of the function, as
expected:

> myfun()
[1] NaN
Called from: myfun()
Browse[1]> c
[1] "Good-bye!"
Warning message:
In log(-1) : NaNs produced


However, if I type any other sort of R expression at the browser prompt, the
warning is issued immediately after that expression's output:

> myfun()
[1] NaN
Called from: myfun()
Browse[1]> print("hello")
[1] "hello"
Warning message:
In log(-1) : NaNs produced
Browse[1]> c
[1] "Good-bye!"

The warnings should be stored until myfun() returns.

This bug has been present at least since 2.7.2, and persists in the current
R-devel build.

Here's the sessionInfo():

> sessionInfo()
R version 2.10.0 Under development (unstable) (2009-09-21 r49780) 
i386-pc-mingw32 

locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base


From richcalaway at revolution-computing.com  Wed Sep 23 21:35:16 2009
From: richcalaway at revolution-computing.com (richcalaway at revolution-computing.com)
Date: Wed, 23 Sep 2009 21:35:16 +0200 (CEST)
Subject: [Rd] Bug 13937 (setRepositories() doesn't allow graceful
	cancellation from GUI menu) (PR#13968)
Message-ID: <20090923193516.92E302831FF2@mail.pubhealth.ku.dk>

Hi, all-

This one was moved to features&FAQ, which appears to be the "works as
documented" folder, with the following note:

intentional: you do need to set repositories or interrupt R.

If this is true, there's still a bug, and in fact two of them: the graphical
menu dialog should have no Cancel button, and the choice 0 in the text menu
should send you back to the menu  until you actually choose some
repositories.
However, there are default repositories chosen for you, and cancelling
doesn't alter them, so I am not convinced that the note is true. And the
original point of my bug report remains-it just seems strange to be dropped
to a text menu when cancelling from a graphical menu. 

Rich Calaway
Documentation Manager
REvolution Computing, Inc.
richcalaway at revolution-computing.com
206-577-4778 x3204



	[[alternative HTML version deleted]]


From richcalaway at revolution-computing.com  Wed Sep 23 22:00:15 2009
From: richcalaway at revolution-computing.com (richcalaway at revolution-computing.com)
Date: Wed, 23 Sep 2009 22:00:15 +0200 (CEST)
Subject: [Rd] FW: RE: Bug 13937 (setRepositories() doesn't allow graceful
	cancellation from GUI menu) (PR#13969)
Message-ID: <20090923200016.581212831FF7@mail.pubhealth.ku.dk>

Hi, again-

But I see the behavior has been fixed in the current R-devel build, so sorry
for the noise, and thanks for keeping R such a great package!

--Rich Calaway

_____________________________________________
From: Rich Calaway [mailto:richcalaway at revolution-computing.com] 
Sent: Wednesday, September 23, 2009 12:32 PM
To: 'R-bugs at R-project.org'
Subject: RE: Bug 13937 (setRepositories() doesn't allow graceful
cancellation from GUI menu)


Hi, all-

This one was moved to features&FAQ, which appears to be the "works as
documented" folder, with the following note:

intentional: you do need to set repositories or interrupt R.

If this is true, there's still a bug, and in fact two of them: the graphical
menu dialog should have no Cancel button, and the choice 0 in the text menu
should send you back to the menu  until you actually choose some
repositories.
However, there are default repositories chosen for you, and cancelling
doesn't alter them, so I am not convinced that the note is true. And the
original point of my bug report remains-it just seems strange to be dropped
to a text menu when cancelling from a graphical menu. 

Rich Calaway
Documentation Manager
REvolution Computing, Inc.
richcalaway at revolution-computing.com
206-577-4778 x3204



	[[alternative HTML version deleted]]


From saptarshi.guha at gmail.com  Thu Sep 24 01:10:08 2009
From: saptarshi.guha at gmail.com (Saptarshi Guha)
Date: Wed, 23 Sep 2009 19:10:08 -0400
Subject: [Rd] Crash due to extreme  example
Message-ID: <79EEC4E0-1D9E-4F9A-931F-61354FA17091@gmail.com>

Hello,
I was trying this bit of code (i know it is an extreme case)

g=function(r){
   if(r==1)
	return(list(x=1))
    else
	return(list(x=g(r-1)))
    }

For z=g(500), the code runs but when I print z i.e
 >> z
I get
<environment: R_GlobalEnv>

  *** caught bus error ***
address 0x1, cause 'non-existent physical address'

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace

Running on Leopard, Macbook (intel, 4gb ram)
R version 2.9.2 (2009-08-24)


(No libraries loaded)

Saptarshi Guha | saptarshi.guha at gmail.com | http://www.stat.purdue.edu/~sguha


From murdoch at stats.uwo.ca  Thu Sep 24 01:23:04 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 23 Sep 2009 19:23:04 -0400
Subject: [Rd] Crash due to extreme  example
In-Reply-To: <79EEC4E0-1D9E-4F9A-931F-61354FA17091@gmail.com>
References: <79EEC4E0-1D9E-4F9A-931F-61354FA17091@gmail.com>
Message-ID: <4ABAADD8.6050704@stats.uwo.ca>

On 23/09/2009 7:10 PM, Saptarshi Guha wrote:
> Hello,
> I was trying this bit of code (i know it is an extreme case)
> 
> g=function(r){
>    if(r==1)
> 	return(list(x=1))
>     else
> 	return(list(x=g(r-1)))
>     }
> 
> For z=g(500), the code runs but when I print z i.e
>  >> z
> I get
> <environment: R_GlobalEnv>
> 
>   *** caught bus error ***
> address 0x1, cause 'non-existent physical address'

Thanks, an equivalent error happens here.  I'll track it down.

Duncan Murdoch

> 
> Possible actions:
> 1: abort (with core dump, if enabled)
> 2: normal R exit
> 3: exit R without saving workspace
> 
> Running on Leopard, Macbook (intel, 4gb ram)
> R version 2.9.2 (2009-08-24)
> 
> 
> (No libraries loaded)
> 
> Saptarshi Guha | saptarshi.guha at gmail.com | http://www.stat.purdue.edu/~sguha
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hb at stat.berkeley.edu  Thu Sep 24 04:08:20 2009
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Wed, 23 Sep 2009 19:08:20 -0700
Subject: [Rd] R v2.10.0: Doc clarification for cross references and where
	are we heading?
Message-ID: <59d7961d0909231908q4ba58b99gdee28c1c49ffd6bc@mail.gmail.com>

Hi,

in 'Writing R Extensions" of R v2.10.0, under Section
'Cross-references' (2009-09-07) it says:

1. "The markup \link{foo} (usually in the combination
\code{\link{foo}}) produces a hyperlink to the help for foo. Here foo
is a topic, that is the argument of \alias markup in another Rd file
(possibly in another package)."

2. "You can specify a link to a different topic than its name by
\link[=dest]{name} which links to topic dest with name name. This can
be used to refer to the documentation for S3/4 classes, for example
\code{"\link[=abc-class]{abc}"} would be a way to refer to the
documentation of an S4 class "abc" defined in your package, and
\code{"\link[=terms.object]{terms}"} to the S3 "terms" class (in
package stats). To make these easy to read, \code{"\linkS4class{abc}"}
expands to the form given above."

3. "There are two other forms of optional argument specified as
\link[pkg]{foo} and \link[pkg:bar]{foo} to link to the package pkg, to
files foo.html and bar.html respectively. These are rarely needed,
perhaps to refer to not-yet-installed packages (but there the HTML
help system will resolve the link at run time) or in the normally
undesirable event that more than one package offers help on a topic20
(in which case the present package has precedence so this is only
needed to refer to other packages). They are only in used in HTML help
(and ignored for hyperlinks in LaTeX conversions of help pages), and
link to the file rather than the topic (since there is no way to know
which topics are in which files in an uninstalled package). The *only*
reason to use these forms for base and recommended packages is to
force a reference to a package that might be further down the search
path. Because they have been frequently misused, as from R 2.10.0 the
HTML help system will look for topic foo in package pkg if it does not
find file foo.html."


Trying to summarize the above, do we have the following markups/rules?

A. \link{<topic>} - where <topic> must occur as an \alias{<topic>},
but not necessarily as an \name{<topic>}.  The link will be display as
the string <topic>.
B. \link[=<topic>]{<name>} - where <topic> must occur as an
\alias{<topic>} with a \name{<name>}.  The link will be display as the
string <name>.
C. \link{<packageName>]{<name>} - where <name> must be a \name{<name>}
in a package named <packageName>.  The link will be display as the
string <name>.
D. \link{<packageName>:<name>]{<label>} - where <name> must be a
\name{<name>} in a package named <packageName>.  The link will be
display as the string <label>.  There are no restrictions on <label>.
E. \linkS4class{<className>} expands to
\link[=<className>-class]{<className>}.  From (B) it then follows that
there must be an \alias{<className>-class} and a \name{<className>}.


Q1. Is that correct?  To me it look a bit inconsistent.

Q2. Are there more?

Q3. Will there be more?

Q4. What about

\link[=<topic>]{<label>}
\link{<packageName>:<topic>]{<label>}

where <label> can be (almost) any string?

Q4. Are (A) and (B) only supposed to be used for linking within a
package, or can it be used to link to "wherever" <topic> exist?

Q5. It sounds that (C) and (D) should be avoided.  Is that correct?

Q6. What if <topic> exist in two packages 'pkgA' and 'pkgB' and I want
to specify that I mean topic <topic> of package 'pkgA', cf namespaces
and pkgA::foo()?

Q7. I the 1st paragraph above it says "(possibly in another package)"
and in the 3rd paragraph above it is mentioned at "The only reason to
use these forms [...] is to force a reference to a package that might
be further down the search path" - is that the answer to Q4?  Will
\link{<topic>} be *dynamically* linked to whatever comes first on the
search() path - to reflect the running environment rather than the
intention of the document?

Reading between the lines, the development of Rd looks exiting.
Instead of 2nd guessing where we are heading, could someone in charge
please give some thoughts on what the plans are and an estimate on how
long it will take before we are there - what R version?


MISC:
I understand that \link[=<className>-class]{<className>} is part of
standard Rd conventions, but to the best of my knowledge
\link[=<className>.class]{<className>} is not, correct?  I would like
to suggest to write a separate paragraph for S4 classes without
mentioning S3 classes.  The following also adds to the confusion -
there exists one Rd page with \name{terms} and one with
\name{terms.object}, so it is not really clear what
\link[=terms.object]{terms} is strictly supposed to do - is it of form
\link[=<topic>]{<name>} or \link[=<topic>]{<label>}.  Maybe it is
helpful to clarify what the static/dynamic link will be and what will
be display.

Thanks

Henrik

PS. This is related to today's (Sept 23, 2009) BioConductor posts by
Gordon Smyth - "[Bioc-devel] BioC 2.5: "suspect" interpackage links";
https://stat.ethz.ch/pipermail/bioc-devel/2009-September/001975.html


From murdoch at stats.uwo.ca  Thu Sep 24 04:54:49 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 23 Sep 2009 22:54:49 -0400
Subject: [Rd] R v2.10.0: Doc clarification for cross references and
 where are we heading?
In-Reply-To: <59d7961d0909231908q4ba58b99gdee28c1c49ffd6bc@mail.gmail.com>
References: <59d7961d0909231908q4ba58b99gdee28c1c49ffd6bc@mail.gmail.com>
Message-ID: <4ABADF79.9050106@stats.uwo.ca>

On 23/09/2009 10:08 PM, Henrik Bengtsson wrote:
> Hi,
> 
> in 'Writing R Extensions" of R v2.10.0, under Section
> 'Cross-references' (2009-09-07) it says:
> 
> 1. "The markup \link{foo} (usually in the combination
> \code{\link{foo}}) produces a hyperlink to the help for foo. Here foo
> is a topic, that is the argument of \alias markup in another Rd file
> (possibly in another package)."
> 
> 2. "You can specify a link to a different topic than its name by
> \link[=dest]{name} which links to topic dest with name name. This can
> be used to refer to the documentation for S3/4 classes, for example
> \code{"\link[=abc-class]{abc}"} would be a way to refer to the
> documentation of an S4 class "abc" defined in your package, and
> \code{"\link[=terms.object]{terms}"} to the S3 "terms" class (in
> package stats). To make these easy to read, \code{"\linkS4class{abc}"}
> expands to the form given above."
> 
> 3. "There are two other forms of optional argument specified as
> \link[pkg]{foo} and \link[pkg:bar]{foo} to link to the package pkg, to
> files foo.html and bar.html respectively. These are rarely needed,
> perhaps to refer to not-yet-installed packages (but there the HTML
> help system will resolve the link at run time) or in the normally
> undesirable event that more than one package offers help on a topic20
> (in which case the present package has precedence so this is only
> needed to refer to other packages). They are only in used in HTML help
> (and ignored for hyperlinks in LaTeX conversions of help pages), and
> link to the file rather than the topic (since there is no way to know
> which topics are in which files in an uninstalled package). The *only*
> reason to use these forms for base and recommended packages is to
> force a reference to a package that might be further down the search
> path. Because they have been frequently misused, as from R 2.10.0 the
> HTML help system will look for topic foo in package pkg if it does not
> find file foo.html."
> 
> 
> Trying to summarize the above, do we have the following markups/rules?
> 
> A. \link{<topic>} - where <topic> must occur as an \alias{<topic>},
> but not necessarily as an \name{<topic>}.  The link will be display as
> the string <topic>.
> B. \link[=<topic>]{<name>} - where <topic> must occur as an
> \alias{<topic>} with a \name{<name>}.  The link will be display as the
> string <name>.
> C. \link{<packageName>]{<name>} - where <name> must be a \name{<name>}
> in a package named <packageName>.  The link will be display as the
> string <name>.
> D. \link{<packageName>:<name>]{<label>} - where <name> must be a
> \name{<name>} in a package named <packageName>.  The link will be
> display as the string <label>.  There are no restrictions on <label>.
> E. \linkS4class{<className>} expands to
> \link[=<className>-class]{<className>}.  From (B) it then follows that
> there must be an \alias{<className>-class} and a \name{<className>}.
> 
> 
> Q1. Is that correct?  To me it look a bit inconsistent.

No, \name{} is irrelevant for links.  It's the filename that matters in 
the 3rd form.

> 
> Q2. Are there more?
> 
> Q3. Will there be more?
> 
> Q4. What about
> 
> \link[=<topic>]{<label>}
> \link{<packageName>:<topic>]{<label>}
> 
> where <label> can be (almost) any string?

The first is what the 2nd form refers to.  "Name" there is what is 
displayed in the file making the link.

The second is new, as of 2.10.0, and is the fallback if a filename 
matching <topic> is not found.
> 
> Q4. Are (A) and (B) only supposed to be used for linking within a
> package, or can it be used to link to "wherever" <topic> exist?

They should work anywhere.  The difficulty arises if you link to 
something that a user doesn't have installed, or if the link is ambiguous.

> Q5. It sounds that (C) and (D) should be avoided.  Is that correct?

I think good practice is to make sure that the base of the filename 
(less .Rd) is also an alias in the file, and also the \name{} of the 
file.  The system would probably be less confusing if this were forced, 
but there are lots of files out there where it's not true.

You want the filename to be an alias because links sometimes go to 
aliases and sometimes to filenames; you want the name to match because 
that's what is displayed at the top of the page, so people might 
remember "just go to the Foo man page".

> Q6. What if <topic> exist in two packages 'pkgA' and 'pkgB' and I want
> to specify that I mean topic <topic> of package 'pkgA', cf namespaces
> and pkgA::foo()?

If you follow the good practice above, then use \link[pkgA]{topic}.  If 
you don't follow that practice, you may be out of luck, because R will 
look for the filename topic.Rd in pkgA, not \alias{topic}.  However, as 
of 2.10.0, it will fall back to the latter.

> Q7. I the 1st paragraph above it says "(possibly in another package)"
> and in the 3rd paragraph above it is mentioned at "The only reason to
> use these forms [...] is to force a reference to a package that might
> be further down the search path" - is that the answer to Q4?  Will
> \link{<topic>} be *dynamically* linked to whatever comes first on the
> search() path - to reflect the running environment rather than the
> intention of the document?

In 2.10.0, I believe this will be the case (but I'd have to check the 
code to be sure).  I'd recommend being explicit if you are worried about 
this possibility.


> Reading between the lines, the development of Rd looks exiting.
> Instead of 2nd guessing where we are heading, could someone in charge
> please give some thoughts on what the plans are and an estimate on how
> long it will take before we are there - what R version?

I don't think there's really someone "in charge", but I've been closely 
involved with this, so I'll give some thoughts.

Generally speaking, we have releases on a regular schedule, we don't 
hold them up for particular features.  So I don't think it would be 
possible to figure out when development on Rd files will be done.  It 
depends on when people have the time to do what they think needs doing, 
and to a large extent, that depends on how things get used.

Some things that are not there now, but which might be there in the 
future (i.e. later than 2.10.0):

  - Better support for the \Sexpr macros (which let the content of man 
pages depend on R code, executed just before rendering).  Right now 
there's no special support for that R code; it would make sense to 
define some functions to make writing such stuff easier.  (This is 
something that could be done in a contributed package, it needn't be in 
base R.)

  - Improved prompt() and package.skeleton() functions to take advantage 
of the above.

  - Graphs in man pages.

  - Ways to link from man pages to vignettes.  The reverse would be 
nice, but it's not possible with the current design, so that would be 
far off.

  - Some general rationalization of the whole help system.

Duncan Murdoch

> 
> MISC:
> I understand that \link[=<className>-class]{<className>} is part of
> standard Rd conventions, but to the best of my knowledge
> \link[=<className>.class]{<className>} is not, correct?  I would like
> to suggest to write a separate paragraph for S4 classes without
> mentioning S3 classes.  The following also adds to the confusion -
> there exists one Rd page with \name{terms} and one with
> \name{terms.object}, so it is not really clear what
> \link[=terms.object]{terms} is strictly supposed to do - is it of form
> \link[=<topic>]{<name>} or \link[=<topic>]{<label>}.  Maybe it is
> helpful to clarify what the static/dynamic link will be and what will
> be display.
> 
> Thanks
> 
> Henrik
> 
> PS. This is related to today's (Sept 23, 2009) BioConductor posts by
> Gordon Smyth - "[Bioc-devel] BioC 2.5: "suspect" interpackage links";
> https://stat.ethz.ch/pipermail/bioc-devel/2009-September/001975.html
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ggrothendieck at gmail.com  Thu Sep 24 05:21:12 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 23 Sep 2009 23:21:12 -0400
Subject: [Rd] R v2.10.0: Doc clarification for cross references and
	where are we heading?
In-Reply-To: <4ABADF79.9050106@stats.uwo.ca>
References: <59d7961d0909231908q4ba58b99gdee28c1c49ffd6bc@mail.gmail.com> 
	<4ABADF79.9050106@stats.uwo.ca>
Message-ID: <971536df0909232021k2ba884fey43ae89fb5fe474be@mail.gmail.com>

On Wed, Sep 23, 2009 at 10:54 PM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>
> ?- Ways to link from man pages to vignettes. ?The reverse would be nice, but
> it's not possible with the current design, so that would be far off.
>

If feasible I would like to be able to link to any text, html or pdf
file in the package.  For example, it would be nice to be able to link
to the NEWS file and pdf files that are included in the package even
if they are not vignettes, etc.


From h.wickham at gmail.com  Thu Sep 24 05:54:42 2009
From: h.wickham at gmail.com (hadley wickham)
Date: Wed, 23 Sep 2009 22:54:42 -0500
Subject: [Rd] R v2.10.0: Doc clarification for cross references and
	where are we heading?
In-Reply-To: <4ABADF79.9050106@stats.uwo.ca>
References: <59d7961d0909231908q4ba58b99gdee28c1c49ffd6bc@mail.gmail.com> 
	<4ABADF79.9050106@stats.uwo.ca>
Message-ID: <f8e6ff050909232054j7ad4a53ned1413a06b8c2123@mail.gmail.com>

> You want the filename to be an alias because links sometimes go to aliases
> and sometimes to filenames; you want the name to match because that's what
> is displayed at the top of the page, so people might remember "just go to
> the Foo man page".

It would be really good to emphasise this somewhere.  I didn't that
this was best practice.

It would be nice to have a base R function that converts a function
name to a filename - then there would be a convention for how to do
so, and perhaps some of the filename <-> function name mismatches
would be resolved.  A heuristic along the following lines might work:

  - replace . with -
  - modify the following special strings:
    * +,-,/,* to add, subtract, divide, multiply
    * [ to subset, [[ to subset2
    * $ to dollar
    * $<- dollar-assign
    * [<- subset-assign, [[ subset2-assign

Hadley

-- 
http://had.co.nz/


From romain.francois at dbmail.com  Thu Sep 24 08:14:13 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Thu, 24 Sep 2009 08:14:13 +0200
Subject: [Rd] R v2.10.0: Doc clarification for cross references
 and	where are we heading?
In-Reply-To: <971536df0909232021k2ba884fey43ae89fb5fe474be@mail.gmail.com>
References: <59d7961d0909231908q4ba58b99gdee28c1c49ffd6bc@mail.gmail.com>
	<4ABADF79.9050106@stats.uwo.ca>
	<971536df0909232021k2ba884fey43ae89fb5fe474be@mail.gmail.com>
Message-ID: <4ABB0E35.10901@dbmail.com>

On 09/24/2009 05:21 AM, Gabor Grothendieck wrote:
>
> On Wed, Sep 23, 2009 at 10:54 PM, Duncan Murdoch<murdoch at stats.uwo.ca>  wrote:
>>
>>   - Ways to link from man pages to vignettes.  The reverse would be nice, but
>> it's not possible with the current design, so that would be far off.
>
> If feasible I would like to be able to link to any text, html or pdf
> file in the package.  For example, it would be nice to be able to link
> to the NEWS file and pdf files that are included in the package even
> if they are not vignettes, etc.

I would second this wish.

Adding content to the package index (00Index.html) would be a bonus as 
well, so that we could link the files from the index page. In addition 
to those mentionned by Gabor, I'm also thinking about other forms of 
documentation that might be in a package such as unit test results, 
javadoc generated documentation of java code, doxygen generated 
documentation of c++ code, ...

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/ztCu : RGG #158:161: examples of package IDPmisc
|- http://tr.im/yw8E : New R package : sos
`- http://tr.im/y8y0 : search the graph gallery from R


From murdoch at stats.uwo.ca  Thu Sep 24 11:28:02 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 24 Sep 2009 05:28:02 -0400
Subject: [Rd] R v2.10.0: Doc clarification for cross references and
 where are we heading?
In-Reply-To: <971536df0909232021k2ba884fey43ae89fb5fe474be@mail.gmail.com>
References: <59d7961d0909231908q4ba58b99gdee28c1c49ffd6bc@mail.gmail.com>
	<4ABADF79.9050106@stats.uwo.ca>
	<971536df0909232021k2ba884fey43ae89fb5fe474be@mail.gmail.com>
Message-ID: <4ABB3BA2.3020503@stats.uwo.ca>

On 23/09/2009 11:21 PM, Gabor Grothendieck wrote:
> On Wed, Sep 23, 2009 at 10:54 PM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>>  - Ways to link from man pages to vignettes.  The reverse would be nice, but
>> it's not possible with the current design, so that would be far off.
>>
> 
> If feasible I would like to be able to link to any text, html or pdf
> file in the package.  For example, it would be nice to be able to link
> to the NEWS file and pdf files that are included in the package even
> if they are not vignettes, etc.

The \Sexpr mechanism probably allows this, though there are currently no 
built-in support functions to help you get there.  As I mentioned, that 
could all be done by code in a contributed package.

One way would be to have one help page which contains only

\Sexpr[stage=render, results=rd]{generatePage()}

and it will be 100% generated at render time, containing whatever you 
want it to contain.  (Presumably you'll have some way to communicate 
what you want through variables that generatePage() can see.)  Each time 
you link to it you'll see something different.

Duncan Murdoch


From romain.francois at dbmail.com  Thu Sep 24 11:42:40 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Thu, 24 Sep 2009 11:42:40 +0200
Subject: [Rd] R v2.10.0: Doc clarification for cross references and
 where are we heading?
In-Reply-To: <4ABB3BA2.3020503@stats.uwo.ca>
References: <59d7961d0909231908q4ba58b99gdee28c1c49ffd6bc@mail.gmail.com>	<4ABADF79.9050106@stats.uwo.ca>	<971536df0909232021k2ba884fey43ae89fb5fe474be@mail.gmail.com>
	<4ABB3BA2.3020503@stats.uwo.ca>
Message-ID: <4ABB3F10.9040505@dbmail.com>

On 09/24/2009 11:28 AM, Duncan Murdoch wrote:
>
> On 23/09/2009 11:21 PM, Gabor Grothendieck wrote:
>> On Wed, Sep 23, 2009 at 10:54 PM, Duncan Murdoch
>> <murdoch at stats.uwo.ca> wrote:
>>> - Ways to link from man pages to vignettes. The reverse would be
>>> nice, but
>>> it's not possible with the current design, so that would be far off.
>>>
>>
>> If feasible I would like to be able to link to any text, html or pdf
>> file in the package. For example, it would be nice to be able to link
>> to the NEWS file and pdf files that are included in the package even
>> if they are not vignettes, etc.
>
> The \Sexpr mechanism probably allows this, though there are currently no
> built-in support functions to help you get there. As I mentioned, that
> could all be done by code in a contributed package.
>
> One way would be to have one help page which contains only
>
> \Sexpr[stage=render, results=rd]{generatePage()}
>
> and it will be 100% generated at render time, containing whatever you
> want it to contain. (Presumably you'll have some way to communicate what
> you want through variables that generatePage() can see.) Each time you
> link to it you'll see something different.
>
> Duncan Murdoch

Brilliant. Thanks. That solves my question as well.

I did not see results = documented in ?Rd2HTML, what is allowed ?
Is \Sexpr ignored when rendering other formats (tex, ...) ?
or is there a way (similar to #ifdef) to only provide some content to 
some renderers ?

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/ztCu : RGG #158:161: examples of package IDPmisc
|- http://tr.im/yw8E : New R package : sos
`- http://tr.im/y8y0 : search the graph gallery from R


From murdoch at stats.uwo.ca  Thu Sep 24 12:04:31 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 24 Sep 2009 06:04:31 -0400
Subject: [Rd] R v2.10.0: Doc clarification for cross references and
 where are we heading?
In-Reply-To: <4ABB3F10.9040505@dbmail.com>
References: <59d7961d0909231908q4ba58b99gdee28c1c49ffd6bc@mail.gmail.com>	<4ABADF79.9050106@stats.uwo.ca>	<971536df0909232021k2ba884fey43ae89fb5fe474be@mail.gmail.com>
	<4ABB3BA2.3020503@stats.uwo.ca> <4ABB3F10.9040505@dbmail.com>
Message-ID: <4ABB442F.4040406@stats.uwo.ca>

On 24/09/2009 5:42 AM, Romain Francois wrote:
> On 09/24/2009 11:28 AM, Duncan Murdoch wrote:
>> On 23/09/2009 11:21 PM, Gabor Grothendieck wrote:
>>> On Wed, Sep 23, 2009 at 10:54 PM, Duncan Murdoch
>>> <murdoch at stats.uwo.ca> wrote:
>>>> - Ways to link from man pages to vignettes. The reverse would be
>>>> nice, but
>>>> it's not possible with the current design, so that would be far off.
>>>>
>>> If feasible I would like to be able to link to any text, html or pdf
>>> file in the package. For example, it would be nice to be able to link
>>> to the NEWS file and pdf files that are included in the package even
>>> if they are not vignettes, etc.
>> The \Sexpr mechanism probably allows this, though there are currently no
>> built-in support functions to help you get there. As I mentioned, that
>> could all be done by code in a contributed package.
>>
>> One way would be to have one help page which contains only
>>
>> \Sexpr[stage=render, results=rd]{generatePage()}
>>
>> and it will be 100% generated at render time, containing whatever you
>> want it to contain. (Presumably you'll have some way to communicate what
>> you want through variables that generatePage() can see.) Each time you
>> link to it you'll see something different.
>>
>> Duncan Murdoch
> 
> Brilliant. Thanks. That solves my question as well.
> 
> I did not see results = documented in ?Rd2HTML, what is allowed ?
> Is \Sexpr ignored when rendering other formats (tex, ...) ?
> or is there a way (similar to #ifdef) to only provide some content to 
> some renderers ?

As of yesterday, it's documented in Writing R Extensions.  \Sexpr is 
format-agnostic:  it doesn't output HTML, it outputs plain text which is 
wrapped in the appropriate HTML/LaTeX/whatever, or Rd input which is 
processed by the whole system.  So the generator would currently have to 
use sneaky methods to figure out the format, looking at which function 
called it, etc.  I imagine in the long run we'll define some state 
variables which the code can look at, but I'd rather see use-cases 
before deciding what those should be.

Duncan Murdoch


From murdoch at stats.uwo.ca  Thu Sep 24 12:20:01 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 24 Sep 2009 06:20:01 -0400
Subject: [Rd] Crash due to extreme  example
In-Reply-To: <79EEC4E0-1D9E-4F9A-931F-61354FA17091@gmail.com>
References: <79EEC4E0-1D9E-4F9A-931F-61354FA17091@gmail.com>
Message-ID: <4ABB47D1.1040103@stats.uwo.ca>

Now fixed, in R-devel and R-patched.

Duncan Murdoch

On 23/09/2009 7:10 PM, Saptarshi Guha wrote:
> Hello,
> I was trying this bit of code (i know it is an extreme case)
> 
> g=function(r){
>    if(r==1)
> 	return(list(x=1))
>     else
> 	return(list(x=g(r-1)))
>     }
> 
> For z=g(500), the code runs but when I print z i.e
>  >> z
> I get
> <environment: R_GlobalEnv>
> 
>   *** caught bus error ***
> address 0x1, cause 'non-existent physical address'
> 
> Possible actions:
> 1: abort (with core dump, if enabled)
> 2: normal R exit
> 3: exit R without saving workspace
> 
> Running on Leopard, Macbook (intel, 4gb ram)
> R version 2.9.2 (2009-08-24)
> 
> 
> (No libraries loaded)
> 
> Saptarshi Guha | saptarshi.guha at gmail.com | http://www.stat.purdue.edu/~sguha
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From romain.francois at dbmail.com  Thu Sep 24 12:29:11 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Thu, 24 Sep 2009 12:29:11 +0200
Subject: [Rd] R v2.10.0: Doc clarification for cross references and
 where are we heading?
In-Reply-To: <4ABB442F.4040406@stats.uwo.ca>
References: <59d7961d0909231908q4ba58b99gdee28c1c49ffd6bc@mail.gmail.com>	<4ABADF79.9050106@stats.uwo.ca>	<971536df0909232021k2ba884fey43ae89fb5fe474be@mail.gmail.com>
	<4ABB3BA2.3020503@stats.uwo.ca> <4ABB3F10.9040505@dbmail.com>
	<4ABB442F.4040406@stats.uwo.ca>
Message-ID: <4ABB49F7.8000606@dbmail.com>

On 09/24/2009 12:04 PM, Duncan Murdoch wrote:
 >
 > On 24/09/2009 5:42 AM, Romain Francois wrote:
 >> On 09/24/2009 11:28 AM, Duncan Murdoch wrote:
 >>> On 23/09/2009 11:21 PM, Gabor Grothendieck wrote:
 >>>> On Wed, Sep 23, 2009 at 10:54 PM, Duncan Murdoch
 >>>> <murdoch at stats.uwo.ca> wrote:
 >>>>> - Ways to link from man pages to vignettes. The reverse would be
 >>>>> nice, but
 >>>>> it's not possible with the current design, so that would be far off.
 >>>>>
 >>>> If feasible I would like to be able to link to any text, html or pdf
 >>>> file in the package. For example, it would be nice to be able to link
 >>>> to the NEWS file and pdf files that are included in the package even
 >>>> if they are not vignettes, etc.
 >>> The \Sexpr mechanism probably allows this, though there are 
currently no
 >>> built-in support functions to help you get there. As I mentioned, that
 >>> could all be done by code in a contributed package.
 >>>
 >>> One way would be to have one help page which contains only
 >>>
 >>> \Sexpr[stage=render, results=rd]{generatePage()}
 >>>
 >>> and it will be 100% generated at render time, containing whatever you
 >>> want it to contain. (Presumably you'll have some way to communicate 
what
 >>> you want through variables that generatePage() can see.) Each time you
 >>> link to it you'll see something different.
 >>>
 >>> Duncan Murdoch
 >>
 >> Brilliant. Thanks. That solves my question as well.
 >>
 >> I did not see results = documented in ?Rd2HTML, what is allowed ?
 >> Is \Sexpr ignored when rendering other formats (tex, ...) ?
 >> or is there a way (similar to #ifdef) to only provide some content to
 >> some renderers ?
 >
 > As of yesterday, it's documented in Writing R Extensions. \Sexpr is
 > format-agnostic: it doesn't output HTML, it outputs plain text which is
 > wrapped in the appropriate HTML/LaTeX/whatever, or Rd input which is
 > processed by the whole system. So the generator would currently have to
 > use sneaky methods to figure out the format, looking at which function
 > called it, etc. I imagine in the long run we'll define some state
 > variables which the code can look at, but I'd rather see use-cases
 > before deciding what those should be.
 >
 > Duncan Murdoch

Sure. One last thing, can the \Sexpr trigger some code that redirects to 
some other page ? I suppose one could just call browseURL, but this 
would bring another tab, ...

Do I need to depend on R >= 2.10.0  if I use \Sexpr ?

Gabor, would you like to team up to generate some sort of incubator 
package to take advantage of the new system ?

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/ztCu : RGG #158:161: examples of package IDPmisc
|- http://tr.im/yw8E : New R package : sos
`- http://tr.im/y8y0 : search the graph gallery from R


From murdoch at stats.uwo.ca  Thu Sep 24 13:30:59 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 24 Sep 2009 07:30:59 -0400
Subject: [Rd] R v2.10.0: Doc clarification for cross references and
 where are we heading?
In-Reply-To: <4ABB49F7.8000606@dbmail.com>
References: <59d7961d0909231908q4ba58b99gdee28c1c49ffd6bc@mail.gmail.com>	<4ABADF79.9050106@stats.uwo.ca>	<971536df0909232021k2ba884fey43ae89fb5fe474be@mail.gmail.com>
	<4ABB3BA2.3020503@stats.uwo.ca> <4ABB3F10.9040505@dbmail.com>
	<4ABB442F.4040406@stats.uwo.ca> <4ABB49F7.8000606@dbmail.com>
Message-ID: <4ABB5873.7080402@stats.uwo.ca>

On 24/09/2009 6:29 AM, Romain Francois wrote:
> On 09/24/2009 12:04 PM, Duncan Murdoch wrote:
>  >
>  > On 24/09/2009 5:42 AM, Romain Francois wrote:
>  >> On 09/24/2009 11:28 AM, Duncan Murdoch wrote:
>  >>> On 23/09/2009 11:21 PM, Gabor Grothendieck wrote:
>  >>>> On Wed, Sep 23, 2009 at 10:54 PM, Duncan Murdoch
>  >>>> <murdoch at stats.uwo.ca> wrote:
>  >>>>> - Ways to link from man pages to vignettes. The reverse would be
>  >>>>> nice, but
>  >>>>> it's not possible with the current design, so that would be far off.
>  >>>>>
>  >>>> If feasible I would like to be able to link to any text, html or pdf
>  >>>> file in the package. For example, it would be nice to be able to link
>  >>>> to the NEWS file and pdf files that are included in the package even
>  >>>> if they are not vignettes, etc.
>  >>> The \Sexpr mechanism probably allows this, though there are 
> currently no
>  >>> built-in support functions to help you get there. As I mentioned, that
>  >>> could all be done by code in a contributed package.
>  >>>
>  >>> One way would be to have one help page which contains only
>  >>>
>  >>> \Sexpr[stage=render, results=rd]{generatePage()}
>  >>>
>  >>> and it will be 100% generated at render time, containing whatever you
>  >>> want it to contain. (Presumably you'll have some way to communicate 
> what
>  >>> you want through variables that generatePage() can see.) Each time you
>  >>> link to it you'll see something different.
>  >>>
>  >>> Duncan Murdoch
>  >>
>  >> Brilliant. Thanks. That solves my question as well.
>  >>
>  >> I did not see results = documented in ?Rd2HTML, what is allowed ?
>  >> Is \Sexpr ignored when rendering other formats (tex, ...) ?
>  >> or is there a way (similar to #ifdef) to only provide some content to
>  >> some renderers ?
>  >
>  > As of yesterday, it's documented in Writing R Extensions. \Sexpr is
>  > format-agnostic: it doesn't output HTML, it outputs plain text which is
>  > wrapped in the appropriate HTML/LaTeX/whatever, or Rd input which is
>  > processed by the whole system. So the generator would currently have to
>  > use sneaky methods to figure out the format, looking at which function
>  > called it, etc. I imagine in the long run we'll define some state
>  > variables which the code can look at, but I'd rather see use-cases
>  > before deciding what those should be.
>  >
>  > Duncan Murdoch
> 
> Sure. One last thing, can the \Sexpr trigger some code that redirects to 
> some other page ? I suppose one could just call browseURL, but this 
> would bring another tab, ...
> 
> Do I need to depend on R >= 2.10.0  if I use \Sexpr ?

I think so.

Duncan Murdoch

> 
> Gabor, would you like to team up to generate some sort of incubator 
> package to take advantage of the new system ?
> 
> Romain
>


From murdoch at stats.uwo.ca  Thu Sep 24 13:33:10 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 24 Sep 2009 07:33:10 -0400
Subject: [Rd] R v2.10.0: Doc clarification for cross references and
 where are we heading?
In-Reply-To: <4ABB5873.7080402@stats.uwo.ca>
References: <59d7961d0909231908q4ba58b99gdee28c1c49ffd6bc@mail.gmail.com>	<4ABADF79.9050106@stats.uwo.ca>	<971536df0909232021k2ba884fey43ae89fb5fe474be@mail.gmail.com>
	<4ABB3BA2.3020503@stats.uwo.ca> <4ABB3F10.9040505@dbmail.com>
	<4ABB442F.4040406@stats.uwo.ca> <4ABB49F7.8000606@dbmail.com>
	<4ABB5873.7080402@stats.uwo.ca>
Message-ID: <4ABB58F6.2010906@stats.uwo.ca>

On 24/09/2009 7:30 AM, Duncan Murdoch wrote:
> On 24/09/2009 6:29 AM, Romain Francois wrote:
>> On 09/24/2009 12:04 PM, Duncan Murdoch wrote:
>>  >
>>  > On 24/09/2009 5:42 AM, Romain Francois wrote:
>>  >> On 09/24/2009 11:28 AM, Duncan Murdoch wrote:
>>  >>> On 23/09/2009 11:21 PM, Gabor Grothendieck wrote:
>>  >>>> On Wed, Sep 23, 2009 at 10:54 PM, Duncan Murdoch
>>  >>>> <murdoch at stats.uwo.ca> wrote:
>>  >>>>> - Ways to link from man pages to vignettes. The reverse would be
>>  >>>>> nice, but
>>  >>>>> it's not possible with the current design, so that would be far off.
>>  >>>>>
>>  >>>> If feasible I would like to be able to link to any text, html or pdf
>>  >>>> file in the package. For example, it would be nice to be able to link
>>  >>>> to the NEWS file and pdf files that are included in the package even
>>  >>>> if they are not vignettes, etc.
>>  >>> The \Sexpr mechanism probably allows this, though there are 
>> currently no
>>  >>> built-in support functions to help you get there. As I mentioned, that
>>  >>> could all be done by code in a contributed package.
>>  >>>
>>  >>> One way would be to have one help page which contains only
>>  >>>
>>  >>> \Sexpr[stage=render, results=rd]{generatePage()}
>>  >>>
>>  >>> and it will be 100% generated at render time, containing whatever you
>>  >>> want it to contain. (Presumably you'll have some way to communicate 
>> what
>>  >>> you want through variables that generatePage() can see.) Each time you
>>  >>> link to it you'll see something different.
>>  >>>
>>  >>> Duncan Murdoch
>>  >>
>>  >> Brilliant. Thanks. That solves my question as well.
>>  >>
>>  >> I did not see results = documented in ?Rd2HTML, what is allowed ?
>>  >> Is \Sexpr ignored when rendering other formats (tex, ...) ?
>>  >> or is there a way (similar to #ifdef) to only provide some content to
>>  >> some renderers ?
>>  >
>>  > As of yesterday, it's documented in Writing R Extensions. \Sexpr is
>>  > format-agnostic: it doesn't output HTML, it outputs plain text which is
>>  > wrapped in the appropriate HTML/LaTeX/whatever, or Rd input which is
>>  > processed by the whole system. So the generator would currently have to
>>  > use sneaky methods to figure out the format, looking at which function
>>  > called it, etc. I imagine in the long run we'll define some state
>>  > variables which the code can look at, but I'd rather see use-cases
>>  > before deciding what those should be.
>>  >
>>  > Duncan Murdoch
>>
>> Sure. One last thing, can the \Sexpr trigger some code that redirects to 
>> some other page ? I suppose one could just call browseURL, but this 
>> would bring another tab, ...

Sorry, I missed this.  The answer is no, not currently, but it could 
generate a link for the user to manually navigate there.

Duncan Murdoch
>>
>> Do I need to depend on R >= 2.10.0  if I use \Sexpr ?
> 
> I think so.
> 
> Duncan Murdoch
> 
>> Gabor, would you like to team up to generate some sort of incubator 
>> package to take advantage of the new system ?
>>
>> Romain
>>
> 
>


From bates at stat.wisc.edu  Thu Sep 24 14:50:14 2009
From: bates at stat.wisc.edu (Douglas Bates)
Date: Thu, 24 Sep 2009 07:50:14 -0500
Subject: [Rd] R + C + Lapack toy regression example
In-Reply-To: <13c5a0ae0909230039w28389d5ch72f63ce5065d0e1d@mail.gmail.com>
References: <13c5a0ae0909230039w28389d5ch72f63ce5065d0e1d@mail.gmail.com>
Message-ID: <40e66e0b0909240550g363efe4ajfa49e8bfb5a6c3ae@mail.gmail.com>

On Wed, Sep 23, 2009 at 2:39 AM, Vinh Nguyen <vqnguyen at uci.edu> wrote:
> dear list,
>
> since matrix manipulations is often of interest in statistical
> computations, i'd like to get a working example of using Lapack for
> regression. ?However, i run into an error.
>
> My matrix-lapack-example.c file:
> #include <R_ext/Lapack.h>
>
> void reg(const char* trans, const int* m, const int* n,
> ? ? ? ? const int* nrhs, double* a, const int* lda,
> ? ? ? ? double* b, const int* ldb,
> ? ? ? ? double* work, const int* lwork, int* info)
> {
> ?F77_CALL(dgels)(trans, m, n, nrhs, a, lda, b, ldb, work, lwork, info);
> }
>
> My matrix-lapack-example.R file:
> dyn.load( "matrix-lapack-example.so" )
>
> regression <- function( X, Y ){
> ?m <- nrow( X )
> ?n <- ncol( X )
> ?stopifnot( m >= n , is.vector( Y ), n != length( Y ) )
> ?mn <- min( m, n )
> ?lwork <- mn + max( mn, 1 )
> ?### to be used with dgels
> ?### http://www.netlib.org/lapack/double/dgels.f
> ?rslt <- .C( "reg"
> ? ? ? ? ? ? , trans=as.character( "N" )

In your C code you are treating that object as a C character string
(char*) but that is not what is being passed.  Look at section 5.2 of
"Writing R Extensions" - a character variable in R is passed by .C as
a char**, not a char*.

I find it much easier to use the .Call interface instead of the .C
interface for applications like this.  You do need to learn some of
the mysteries of the functions declared in Rinternals.h but, once you
do, it is much easier to pass a matrix from R with and extract all the
fussy details within the C code.  Several of the C source code files
in the Matrix package are devoted to exactly the kind of operation you
want to carry out.  Look at the function lsq_dense_QR in
Matrix/src/dense.c, for example. (Although now that I look at it
myself I see some questionable programming practices - I should have
PROTECTed the result of coerceVector but it happens that it would not
have needed protection.  Rather than coercing I should just check
isInteger on the dim attribute.)
> ? ? ? ? ? ? , m=as.integer( m ), n=as.integer( n )
> ? ? ? ? ? ? , nrhs=as.integer( 1 ), a=as.double( X )
> ? ? ? ? ? ? , lda=as.integer( m ), b=as.double( Y )
> ? ? ? ? ? ? , ldb=as.integer( m ) , work=double( lwork )
> ? ? ? ? ? ? , lwork=as.integer( lwork )
> ? ? ? ? ? ? , info=integer( 1 ) )
> ?##F77_NAME(dgels)(const char* trans, const int* m, const int* n,
> ?## ? ? ? ? ? ? ? ?const int* nrhs, double* a, const int* lda,
> ?## ? ? ? ? ? ? ? ?double* b, const int* ldb,
> ?## ? ? ? ? ? ? ? ?double* work, const int* lwork, int* info);
> ?return( rslt )
> }
>
> n <- 100
> x <- rnorm( 100 )
> y <- 2.5 + 3*x + rnorm( n )
> X <- cbind( 1, x )
>
> temp <- regression( X=X, Y=y )
>
>
> dgels does linear least squares. ?the C code compile fines with a
> warning (ld: warning, duplicate dylib
> /usr/local/lib/libgcc_s.1.dylib). ?in R, i get the following when i
> run regression():
>> temp <- regression( X=X, Y=y )
> Parameter 1 to routine DGELS ?was incorrect
> Mac OS BLAS parameter error in DGELS , parameter #0, (unavailable), is 0
>
> Process R exited abnormally with code 1 at Wed Sep 23 00:21:59 2009
>
> am i doing something wrong? ?is my as.character() used wrong here?
>
> i know R uses fortran code for lm. ?but suppose i wanted to do
> regression in C/C++. ?is this lapack method the recommended / "best
> practice" route? ?i just want to know whats the recommended method for
> doing matrix manipulations in C. ?thanks!
>
> vinh
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From saptarshi.guha at gmail.com  Thu Sep 24 17:00:06 2009
From: saptarshi.guha at gmail.com (Saptarshi Guha)
Date: Thu, 24 Sep 2009 11:00:06 -0400
Subject: [Rd] Crash due to extreme example
In-Reply-To: <4ABB47D1.1040103@stats.uwo.ca>
References: <79EEC4E0-1D9E-4F9A-931F-61354FA17091@gmail.com> 
	<4ABB47D1.1040103@stats.uwo.ca>
Message-ID: <1e7471d50909240800h659e0af1ubbe200128f48323b@mail.gmail.com>

Thanks.
 What caused problem?
Regards
Saptarshi

On Thu, Sep 24, 2009 at 6:20 AM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> Now fixed, in R-devel and R-patched.
>
> Duncan Murdoch
>
> On 23/09/2009 7:10 PM, Saptarshi Guha wrote:
>>
>> Hello,
>> I was trying this bit of code (i know it is an extreme case)
>>
>> g=function(r){
>> ? if(r==1)
>> ? ? ? ?return(list(x=1))
>> ? ?else
>> ? ? ? ?return(list(x=g(r-1)))
>> ? ?}
>>
>> For z=g(500), the code runs but when I print z i.e
>> ?>> z
>> I get
>> <environment: R_GlobalEnv>
>>
>> ?*** caught bus error ***
>> address 0x1, cause 'non-existent physical address'
>>
>> Possible actions:
>> 1: abort (with core dump, if enabled)
>> 2: normal R exit
>> 3: exit R without saving workspace
>>
>> Running on Leopard, Macbook (intel, 4gb ram)
>> R version 2.9.2 (2009-08-24)
>>
>>
>> (No libraries loaded)
>>
>> Saptarshi Guha | saptarshi.guha at gmail.com |
>> http://www.stat.purdue.edu/~sguha
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From murdoch at stats.uwo.ca  Thu Sep 24 17:31:42 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 24 Sep 2009 11:31:42 -0400
Subject: [Rd] Crash due to extreme example
In-Reply-To: <1e7471d50909240800h659e0af1ubbe200128f48323b@mail.gmail.com>
References: <79EEC4E0-1D9E-4F9A-931F-61354FA17091@gmail.com>
	<4ABB47D1.1040103@stats.uwo.ca>
	<1e7471d50909240800h659e0af1ubbe200128f48323b@mail.gmail.com>
Message-ID: <4ABB90DE.5080501@stats.uwo.ca>

On 9/24/2009 11:00 AM, Saptarshi Guha wrote:
> Thanks.
>  What caused problem?

R builds up the element name (x$x$x ...) in a fixed size buffer.  There 
was code to detect when the buffer was full and stop building the name, 
but it was buggy.  I patched the bug.

Duncan Murdoch

> Regards
> Saptarshi
> 
> On Thu, Sep 24, 2009 at 6:20 AM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> Now fixed, in R-devel and R-patched.
>>
>> Duncan Murdoch
>>
>> On 23/09/2009 7:10 PM, Saptarshi Guha wrote:
>>>
>>> Hello,
>>> I was trying this bit of code (i know it is an extreme case)
>>>
>>> g=function(r){
>>>   if(r==1)
>>>        return(list(x=1))
>>>    else
>>>        return(list(x=g(r-1)))
>>>    }
>>>
>>> For z=g(500), the code runs but when I print z i.e
>>>  >> z
>>> I get
>>> <environment: R_GlobalEnv>
>>>
>>>  *** caught bus error ***
>>> address 0x1, cause 'non-existent physical address'
>>>
>>> Possible actions:
>>> 1: abort (with core dump, if enabled)
>>> 2: normal R exit
>>> 3: exit R without saving workspace
>>>
>>> Running on Leopard, Macbook (intel, 4gb ram)
>>> R version 2.9.2 (2009-08-24)
>>>
>>>
>>> (No libraries loaded)
>>>
>>> Saptarshi Guha | saptarshi.guha at gmail.com |
>>> http://www.stat.purdue.edu/~sguha
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From vqnguyen at uci.edu  Thu Sep 24 18:47:26 2009
From: vqnguyen at uci.edu (Vinh Nguyen)
Date: Thu, 24 Sep 2009 09:47:26 -0700
Subject: [Rd] R + C + Lapack toy regression example
In-Reply-To: <40e66e0b0909240550g363efe4ajfa49e8bfb5a6c3ae@mail.gmail.com>
References: <13c5a0ae0909230039w28389d5ch72f63ce5065d0e1d@mail.gmail.com> 
	<40e66e0b0909240550g363efe4ajfa49e8bfb5a6c3ae@mail.gmail.com>
Message-ID: <13c5a0ae0909240947j9b30247j731e1486d45b86e@mail.gmail.com>

thank you William Dunlap and professor Bates for your responses.
Since the first argument is always an "N" for linear regression, i
just placed
const char* trans = "N";
in my .c file and things worked.
See some comments below.

On Thu, Sep 24, 2009 at 5:50 AM, Douglas Bates <bates at stat.wisc.edu> wrote:
> In your C code you are treating that object as a C character string
> (char*) but that is not what is being passed. ?Look at section 5.2 of
> "Writing R Extensions" - a character variable in R is passed by .C as
> a char**, not a char*.
>

so i suppose you can't get char* from R?  i tried as.raw and that
didn't work either.

> I find it much easier to use the .Call interface instead of the .C
> interface for applications like this. ?You do need to learn some of
> the mysteries of the functions declared in Rinternals.h but, once you
> do, it is much easier to pass a matrix from R with and extract all the
> fussy details within the C code. ?Several of the C source code files
> in the Matrix package are devoted to exactly the kind of operation you
> want to carry out. ?Look at the function lsq_dense_QR in
> Matrix/src/dense.c, for example. (Although now that I look at it
> myself I see some questionable programming practices - I should have
> PROTECTed the result of coerceVector but it happens that it would not
> have needed protection. ?Rather than coercing I should just check
> isInteger on the dim attribute.)

So if someone were to re-implement linear regression using C/C++ and
not fortran, would u imagine it being implemented via the .C()
function and using Lapack?  Or how would the matrix manipulations be
handled in C?

Thanks.
Vinh


From vqnguyen at uci.edu  Thu Sep 24 21:09:01 2009
From: vqnguyen at uci.edu (Vinh Nguyen)
Date: Thu, 24 Sep 2009 12:09:01 -0700
Subject: [Rd] R + C + Lapack toy regression example
In-Reply-To: <8068FC73-551E-421A-992F-FE769A7FD143@r-project.org>
References: <13c5a0ae0909230039w28389d5ch72f63ce5065d0e1d@mail.gmail.com> 
	<40e66e0b0909240550g363efe4ajfa49e8bfb5a6c3ae@mail.gmail.com> 
	<13c5a0ae0909240947j9b30247j731e1486d45b86e@mail.gmail.com> 
	<8068FC73-551E-421A-992F-FE769A7FD143@r-project.org>
Message-ID: <13c5a0ae0909241209i253ece47h6bcedac086fc76bf@mail.gmail.com>

On Thu, Sep 24, 2009 at 11:49 AM, Simon Urbanek
<simon.urbanek at r-project.org> wrote:
> As Doug pointed out you don't want to be using .C(). As for matrix
> manipulations - they are usually done directly on the objects which are
> vectors stored in column-major order.

i meant .Call().   also, sorry for the poor word choice, i meant
matrix computations, not matrix manipulations.  i guess i just want
some recommendations for future references on what C library to use if
i were doing something like re-implement linear regression
(hypothetically speaking).  i assumed it would be lapack.  is this the
recommended approach?

vinh


From baptiste.auguie at googlemail.com  Thu Sep 24 22:19:30 2009
From: baptiste.auguie at googlemail.com (baptiste auguie)
Date: Thu, 24 Sep 2009 22:19:30 +0200
Subject: [Rd] unexpected behavior of `[<-` method for class unit.arithmetic
Message-ID: <de4e29f50909241319q3a1815fcxc1539f4f362102c7@mail.gmail.com>

Dear list,

Consider the following,

library(grid)

w = unit.c(unit(1, "in"), unit(2, "in"))
w2 = w + unit(1, "mm")

w[2] <- 0
w2[2] <- 0

convertUnit(w, "mm")
#[1] 25.4mm 0mm
convertUnit(w2, "mm")
#Error in grid.Call("L_convert", x, as.integer(whatfrom),
as.integer(whatto),  :
#  INTEGER() can only be applied to a 'integer', not a 'NULL'

The last line fails, as the naive replacement has destroyed the
structure of w2 instead of having assigned a value of 0 to the second
unit element.

I've also tried,

w = unit.c(unit(1, "in"), unit(2, "in"))
w2 = w + unit(1, "mm")
w2[[2]][2] <- 0

but this time, if the structure is licit, it's the result that's not
as I intended:

convertUnit(w2,"mm")
#[1] 26.4mm 1mm

My limited understanding is that an object of class unit.arithmetic is
waiting until the last moment to actually perform its operation,
stored in a tree-like structure. With this premise, I can't think of a
good way to modify one element of a list of unit elements.

As a workaround, I can only think of the following hack where the
objects are forced to be evaluated,

w = unit.c(unit(1, "in"), unit(2, "in"))
w2 = convertUnit(w + unit(1, "mm"), "mm", valueOnly=TRUE)
w2[2] <- 0
w2 <- unit(w2, "mm")

but it clearly isn't a very desirable route.

What is the recommended way to modify one element of a unit vector?

Digging in grid/R/unit.R , I found the following comment,

# Write "[<-.unit" methods too ??

which probably explains the above. Would it be possible to add such a method,

"[<-.unit.list" <- function(x, index, value, top=TRUE, ...) {
  this.length <- length(x)
    index <- (1L:this.length)[index]

  if (top && any(index > this.length))
    stop("Index out of bounds (unit list subsetting)")
  cl <- class(x)
  result <- unclass(x)
  result[(index - 1) %% this.length + 1] <- value
  class(result) <- cl
  result
}

a = unit.c(unit(1,"mm"),unit(2,"in"))
a[2] <- unit(3,"in")
a

but for unit.arithmetic also?

Regards,

baptiste

sessionInfo()
R version 2.9.2 (2009-08-24)
i386-apple-darwin8.11.1

locale:
en_GB.UTF-8/en_GB.UTF-8/C/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  grid      methods
[8] base


From Thomas.Petzoldt at TU-Dresden.de  Thu Sep 24 23:57:13 2009
From: Thomas.Petzoldt at TU-Dresden.de (Thomas Petzoldt)
Date: Thu, 24 Sep 2009 23:57:13 +0200
Subject: [Rd] speedup approxfun (code suggestion)
Message-ID: <4ABBEB39.7000603@TU-Dresden.de>

Dear R developers,

this e-mail concerns a code suggestion to slightly change approxfun, so 
that it is more efficient when called several times.

We are using approxfun (not approx) to update external variables 
(time-series) to current time points while integrating our ODE models.

It is not uncommon for these models to take in the order of 10^4 time 
steps, and sometimes we run a model > 1000 times, so approxfun is called 
many-many times. For such applications approxfun is a serious 
performance bottleneck, so we first tried to develop own functions with 
less overhead.

Then, one of us (Karline Soetart) noticed, that in the C-code of 
R_approx, each time approxfun is called, it checks the input data for 
NAs in the x and y, as well as the validity of the method and f.

For common data sets this takes about 40% of the computation time.

While testing is of course necessary for "approx", we think that for 
"approxfun", testing could be done only once, before the function is 
created.

Testing validity of the input only once, makes approxfun about 40-45% 
faster, e.g. for:

x <- seq(0, 10000)
y <- x*2

F1<- approxfun(x, y)

system.time(
  for ( i in 1:10000)
   F1(i)
)

5.50 sec for the original approxfun
2.97 sec for the patched version


This is of course just a suggestion, but we think that a patch for 
package "stats" may be of general interest and therefore more 
appropriate than providing a modified approxfun in our own package.

The code suggestion was tested with R-devel rev. 49803 and several 
contributed packages and we found no negative side effects. Please find 
the suggested patch below and please excuse if we overlooked something.

Thanks for your consideration

Best wishes,

Karline Soetaert & Thomas Petzoldt


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: stats_approx.patch
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090924/1a50fe93/attachment.pl>

From hpages at fhcrc.org  Fri Sep 25 00:00:36 2009
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Thu, 24 Sep 2009 15:00:36 -0700
Subject: [Rd] crash with NAs in subscripted assignment of a raw vector
Message-ID: <4ABBEC04.7040202@fhcrc.org>

Hi,


   > x <- charToRaw("ABCDEFGx")
   > x[c(1:3, NA, 6)] <- x[8]

    *** caught segfault ***
   address 0x8402423f, cause 'memory not mapped'

   Possible actions:
   1: abort (with core dump, if enabled)
   2: normal R exit
   3: exit R without saving workspace
   4: exit R saving workspace


Cheers,
H.


 > sessionInfo()
R version 2.10.0 Under development (unstable) (2009-09-02 r49537)
x86_64-unknown-linux-gnu

locale:
  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
  [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
  [5] LC_MONETARY=C              LC_MESSAGES=en_CA.UTF-8
  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From p.murrell at auckland.ac.nz  Fri Sep 25 01:39:48 2009
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Fri, 25 Sep 2009 11:39:48 +1200
Subject: [Rd] unexpected behavior of `[<-` method for class
	unit.arithmetic
In-Reply-To: <de4e29f50909241319q3a1815fcxc1539f4f362102c7@mail.gmail.com>
References: <de4e29f50909241319q3a1815fcxc1539f4f362102c7@mail.gmail.com>
Message-ID: <4ABC0344.6010206@auckland.ac.nz>

Hi

The bit you found that says ...

# Write "[<-.unit" methods too ??

... is the crucial bit.

Would it be possible to add such a method?

Almost certainly, it just needs someone to repeatedly bug the person who 
can make the change :)   Thanks for the suggestion for code BTW;  I'll 
take a look at that.

In the meantime, the fact that this has only come up once before, while 
surprising, suggests that people may have written code in a different 
style.  Can you give a succinct example that demonstrates a situation 
where you want to assign to a subset of a unit (rather than, say, 
calculating values, setting some to 0, then building a unit from the 
values) ?

Paul


baptiste auguie wrote:
> Dear list,
> 
> Consider the following,
> 
> library(grid)
> 
> w = unit.c(unit(1, "in"), unit(2, "in"))
> w2 = w + unit(1, "mm")
> 
> w[2] <- 0
> w2[2] <- 0
> 
> convertUnit(w, "mm")
> #[1] 25.4mm 0mm
> convertUnit(w2, "mm")
> #Error in grid.Call("L_convert", x, as.integer(whatfrom),
> as.integer(whatto),  :
> #  INTEGER() can only be applied to a 'integer', not a 'NULL'
> 
> The last line fails, as the naive replacement has destroyed the
> structure of w2 instead of having assigned a value of 0 to the second
> unit element.
> 
> I've also tried,
> 
> w = unit.c(unit(1, "in"), unit(2, "in"))
> w2 = w + unit(1, "mm")
> w2[[2]][2] <- 0
> 
> but this time, if the structure is licit, it's the result that's not
> as I intended:
> 
> convertUnit(w2,"mm")
> #[1] 26.4mm 1mm
> 
> My limited understanding is that an object of class unit.arithmetic is
> waiting until the last moment to actually perform its operation,
> stored in a tree-like structure. With this premise, I can't think of a
> good way to modify one element of a list of unit elements.
> 
> As a workaround, I can only think of the following hack where the
> objects are forced to be evaluated,
> 
> w = unit.c(unit(1, "in"), unit(2, "in"))
> w2 = convertUnit(w + unit(1, "mm"), "mm", valueOnly=TRUE)
> w2[2] <- 0
> w2 <- unit(w2, "mm")
> 
> but it clearly isn't a very desirable route.
> 
> What is the recommended way to modify one element of a unit vector?
> 
> Digging in grid/R/unit.R , I found the following comment,
> 
> # Write "[<-.unit" methods too ??
> 
> which probably explains the above. Would it be possible to add such a method,
> 
> "[<-.unit.list" <- function(x, index, value, top=TRUE, ...) {
>   this.length <- length(x)
>     index <- (1L:this.length)[index]
> 
>   if (top && any(index > this.length))
>     stop("Index out of bounds (unit list subsetting)")
>   cl <- class(x)
>   result <- unclass(x)
>   result[(index - 1) %% this.length + 1] <- value
>   class(result) <- cl
>   result
> }
> 
> a = unit.c(unit(1,"mm"),unit(2,"in"))
> a[2] <- unit(3,"in")
> a
> 
> but for unit.arithmetic also?
> 
> Regards,
> 
> baptiste
> 
> sessionInfo()
> R version 2.9.2 (2009-08-24)
> i386-apple-darwin8.11.1
> 
> locale:
> en_GB.UTF-8/en_GB.UTF-8/C/C/en_GB.UTF-8/en_GB.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  grid      methods
> [8] base
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/


From seth at userprimary.net  Fri Sep 25 02:30:56 2009
From: seth at userprimary.net (Seth Falcon)
Date: Thu, 24 Sep 2009 17:30:56 -0700
Subject: [Rd] crash with NAs in subscripted assignment of a raw vector
In-Reply-To: <4ABBEC04.7040202@fhcrc.org>
References: <4ABBEC04.7040202@fhcrc.org>
Message-ID: <486f230c0909241730k2dbdedcem3a2d912c0a1b5507@mail.gmail.com>

2009/9/24 Herv? Pag?s <hpages at fhcrc.org>:
> ?> x <- charToRaw("ABCDEFGx")
> ?> x[c(1:3, NA, 6)] <- x[8]
>
> ? *** caught segfault ***
> ?address 0x8402423f, cause 'memory not mapped'

Thanks for the report.  I have a fix which I will commit after some testing.

-- 
Seth Falcon | @sfalcon | http://userprimary.net/user


From baptiste.auguie at googlemail.com  Fri Sep 25 10:29:05 2009
From: baptiste.auguie at googlemail.com (baptiste auguie)
Date: Fri, 25 Sep 2009 10:29:05 +0200
Subject: [Rd] unexpected behavior of `[<-` method for class
	unit.arithmetic
In-Reply-To: <4ABC0344.6010206@auckland.ac.nz>
References: <de4e29f50909241319q3a1815fcxc1539f4f362102c7@mail.gmail.com>
	<4ABC0344.6010206@auckland.ac.nz>
Message-ID: <de4e29f50909250129q1c42daa8he16d64d2215bc96@mail.gmail.com>

Dear Paul and others,

Thanks for the quick response.

2009/9/25 Paul Murrell <p.murrell at auckland.ac.nz>:
> Hi
>
> The bit you found that says ...
>
> # Write "[<-.unit" methods too ??
>
> ... is the crucial bit.
>

When I figured that, I had already written up my email so I thought
I'd ask anyway from a naive user point of view (in this regard,
perhaps the help page of unit.c could mention what common methods are
not available). The results I got can be quite surprising at first.


> Would it be possible to add such a method?
>
> Almost certainly, it just needs someone to repeatedly bug the person who can
> make the change :) ? Thanks for the suggestion for code BTW; ?I'll take a
> look at that.

I'm afraid I won't be of much help here, I merely copied and pasted
the "[.unit" method with a minimal change that seemed to make it work
for illustrative purposes. I don't really understand unit.arithmetic
and unit in general.

> In the meantime, the fact that this has only come up once before, while
> surprising, suggests that people may have written code in a different style.

Either that or people have struggled to find their own workaround
every time. I've recently hacked a fake matrix of unit objects, where
perhaps a proper implementation would find other grateful users.
(Given a list of grobs, I needed to compute rowMax and colMax of their
size in a rectangular arrangement -- see example below, also as a
recent post on r-help).

> ?Can you give a succinct example that demonstrates a situation where you
> want to assign to a subset of a unit (rather than, say, calculating values,
> setting some to 0, then building a unit from the values) ?
>

Though not as succinct as I'd like, I think the drawDetails method of
tableGrob[*] might present the problem:

drawDetails.table <- function(x, recording=TRUE){

# makeTableGrobs returns lists of grobs, and their width and height in
a rectangular layout
  lg <- with(x, makeTableGrobs(as.character(as.matrix(d)), rows, cols,
         nrow(d), ncol(d),
         equal.width = equal.width, equal.height = equal.height,
         gpar.content = gpar.content,
         gpar.col = gpar.col,
         gpar.row = gpar.row,
         gpar.fill = gpar.fill,
         gpar.rowfill = gpar.rowfill,
         gpar.colfill = gpar.colfill )  )

# now I need to add some horizontal and vertical padding to each cells,
# EXCEPT for the rownames and colnames if they are not to be shown
# whereby I convert everything to raw values, use normal vector indexing,
# and convert back to unit

  widthsv <- convertUnit(lg$widths + x$padding.h, "mm", valueOnly=TRUE)
  heightsv <- convertUnit(lg$heights + x$padding.v, "mm", valueOnly=TRUE)

  widthsv[1] <- widthsv[1] * as.numeric(x$show.rownames)
  widths <- unit(widthsv, "mm")

  heightsv[1] <- heightsv[1] * as.numeric(x$show.colnames)
  heights <- unit(heightsv, "mm")

# once this is done, I can create the layout
  cells = viewport(name="table.cells", layout =
    grid.layout(lg$nrow+1, lg$ncol+1, width=widths, height=heights) )

# and place the elements
  pushViewport(cells)
  tg <- arrangeTableGrobs(lg$lgt, lg$lgf, lg$nrow, lg$ncol, lg$widths,
lg$heights,
          padding.h = x$padding.h, padding.v = x$padding.v,
          separator=x$separator, show.box=x$show.box,
          show.csep=x$show.csep, show.rsep=x$show.rsep)
  upViewport()
}

Of course I could make the calculation of adding padding to the cells
earlier in the chain (in makeTableGrobs) but it's not really its
place.

Best,

baptiste

[*]: http://code.google.com/p/gridextra/source/browse/trunk/R/tableGrob.r

to be run as,
either,

library(grid)
source("http://gridextra.googlecode.com/svn/trunk/R/grob-utils.r")
source("http://gridextra.googlecode.com/svn/trunk/R/tableGrob.r")

grid.table(head(iris))

or simply,

Install http://gridextra.googlecode.com/files/gridextra_0.3.tar.gz

library(gridextra)
example(tableGrob)

> Paul
>
>
> baptiste auguie wrote:
>>
>> Dear list,
>>
>> Consider the following,
>>
>> library(grid)
>>
>> w = unit.c(unit(1, "in"), unit(2, "in"))
>> w2 = w + unit(1, "mm")
>>
>> w[2] <- 0
>> w2[2] <- 0
>>
>> convertUnit(w, "mm")
>> #[1] 25.4mm 0mm
>> convertUnit(w2, "mm")
>> #Error in grid.Call("L_convert", x, as.integer(whatfrom),
>> as.integer(whatto), ?:
>> # ?INTEGER() can only be applied to a 'integer', not a 'NULL'
>>
>> The last line fails, as the naive replacement has destroyed the
>> structure of w2 instead of having assigned a value of 0 to the second
>> unit element.
>>
>> I've also tried,
>>
>> w = unit.c(unit(1, "in"), unit(2, "in"))
>> w2 = w + unit(1, "mm")
>> w2[[2]][2] <- 0
>>
>> but this time, if the structure is licit, it's the result that's not
>> as I intended:
>>
>> convertUnit(w2,"mm")
>> #[1] 26.4mm 1mm
>>
>> My limited understanding is that an object of class unit.arithmetic is
>> waiting until the last moment to actually perform its operation,
>> stored in a tree-like structure. With this premise, I can't think of a
>> good way to modify one element of a list of unit elements.
>>
>> As a workaround, I can only think of the following hack where the
>> objects are forced to be evaluated,
>>
>> w = unit.c(unit(1, "in"), unit(2, "in"))
>> w2 = convertUnit(w + unit(1, "mm"), "mm", valueOnly=TRUE)
>> w2[2] <- 0
>> w2 <- unit(w2, "mm")
>>
>> but it clearly isn't a very desirable route.
>>
>> What is the recommended way to modify one element of a unit vector?
>>
>> Digging in grid/R/unit.R , I found the following comment,
>>
>> # Write "[<-.unit" methods too ??
>>
>> which probably explains the above. Would it be possible to add such a
>> method,
>>
>> "[<-.unit.list" <- function(x, index, value, top=TRUE, ...) {
>> ?this.length <- length(x)
>> ? ?index <- (1L:this.length)[index]
>>
>> ?if (top && any(index > this.length))
>> ? ?stop("Index out of bounds (unit list subsetting)")
>> ?cl <- class(x)
>> ?result <- unclass(x)
>> ?result[(index - 1) %% this.length + 1] <- value
>> ?class(result) <- cl
>> ?result
>> }
>>
>> a = unit.c(unit(1,"mm"),unit(2,"in"))
>> a[2] <- unit(3,"in")
>> a
>>
>> but for unit.arithmetic also?
>>
>> Regards,
>>
>> baptiste
>>
>> sessionInfo()
>> R version 2.9.2 (2009-08-24)
>> i386-apple-darwin8.11.1
>>
>> locale:
>> en_GB.UTF-8/en_GB.UTF-8/C/C/en_GB.UTF-8/en_GB.UTF-8
>>
>> attached base packages:
>> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?grid ? ? ?methods
>> [8] base
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> --
> Dr Paul Murrell
> Department of Statistics
> The University of Auckland
> Private Bag 92019
> Auckland
> New Zealand
> 64 9 3737599 x85392
> paul at stat.auckland.ac.nz
> http://www.stat.auckland.ac.nz/~paul/
>


From romain.francois at dbmail.com  Fri Sep 25 11:33:48 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Fri, 25 Sep 2009 11:33:48 +0200
Subject: [Rd] build time dependency
Message-ID: <4ABC8E7C.2060004@dbmail.com>

Hello,

Is there such thing as a build time dependency between packages : 
package B needs package A so that it can build, but once built it lives 
without it.

For example depending on the ant package to compile java code, or depend 
on roxygen to roxygenize the code, ...

Adding roxygen to Depends works, but then the installed package does not 
depend on it and therefore loads it for nothing. Maybe I can remove 
roxygen from the Depends as part of the ./configure[.win] ...

Romain

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/ztCu : RGG #158:161: examples of package IDPmisc
|- http://tr.im/yw8E : New R package : sos
`- http://tr.im/y8y0 : search the graph gallery from R


From asr at ufl.edu  Fri Sep 25 15:45:16 2009
From: asr at ufl.edu (Allen S. Rout)
Date: Fri, 25 Sep 2009 09:45:16 -0400
Subject: [Rd] Collision between difftime and ggplot2.
Message-ID: <44wpfr5tvjfyr.fsf@crepe.osg.ufl.edu>


It seems that there are several folks Out There with an itch to
scratch with respect to difftimes.

http://article.gmane.org/gmane.comp.lang.r.devel/19223/match=difftime

http://article.gmane.org/gmane.comp.lang.r.devel/18441/match=difftime

http://article.gmane.org/gmane.comp.lang.r.devel/10882/match=difftime

http://article.gmane.org/gmane.comp.lang.r.devel/11675/match=difftime

and I might be developing such an itch too.


What would the R devel community want out of some one, or some group,
attempting to fix some of these?  Difftime seems just functional
enough to be an attractive nuisance.



- Allen S. Rout


From h.wickham at gmail.com  Fri Sep 25 15:50:10 2009
From: h.wickham at gmail.com (hadley wickham)
Date: Fri, 25 Sep 2009 08:50:10 -0500
Subject: [Rd] Collision between difftime and ggplot2.
In-Reply-To: <44wpfr5tvjfyr.fsf@crepe.osg.ufl.edu>
References: <44wpfr5tvjfyr.fsf@crepe.osg.ufl.edu>
Message-ID: <f8e6ff050909250650h48d42c02n8c77adc06c669113@mail.gmail.com>

Hi Allen,

I've been working on this problem (among others) with a grad student
this summer.  You can see our work here -
http://github.com/hadley/lubridate/ - particularly in durations.r and
ops.durations.r.

Hadley

On Fri, Sep 25, 2009 at 8:45 AM, Allen S. Rout <asr at ufl.edu> wrote:
>
> It seems that there are several folks Out There with an itch to
> scratch with respect to difftimes.
>
> http://article.gmane.org/gmane.comp.lang.r.devel/19223/match=difftime
>
> http://article.gmane.org/gmane.comp.lang.r.devel/18441/match=difftime
>
> http://article.gmane.org/gmane.comp.lang.r.devel/10882/match=difftime
>
> http://article.gmane.org/gmane.comp.lang.r.devel/11675/match=difftime
>
> and I might be developing such an itch too.
>
>
> What would the R devel community want out of some one, or some group,
> attempting to fix some of these? ?Difftime seems just functional
> enough to be an attractive nuisance.
>
>
>
> - Allen S. Rout
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
http://had.co.nz/


From baptiste.auguie at googlemail.com  Fri Sep 25 16:09:52 2009
From: baptiste.auguie at googlemail.com (baptiste auguie)
Date: Fri, 25 Sep 2009 16:09:52 +0200
Subject: [Rd] unexpected behavior of `[<-` method for class
	unit.arithmetic
In-Reply-To: <de4e29f50909250129q1c42daa8he16d64d2215bc96@mail.gmail.com>
References: <de4e29f50909241319q3a1815fcxc1539f4f362102c7@mail.gmail.com>
	<4ABC0344.6010206@auckland.ac.nz>
	<de4e29f50909250129q1c42daa8he16d64d2215bc96@mail.gmail.com>
Message-ID: <de4e29f50909250709k6e74436bq989be4b4e64b453@mail.gmail.com>

Further to my previous message, I just dug this in lattice/R/layout.R :


rearrangeUnit <- function(x, pos, u)
{
    lx <- length(x)
    if (lx == 1)
        u
    else if (pos == 1)
        unit.c(u, x[(pos+1):lx])
    else if (pos == lx)
        unit.c(x[1:(pos-1)], u)
    else
        unit.c(x[1:(pos-1)], u, x[(pos+1):lx])
}


w = unit.c(unit(1, "in"), unit(2, "in"))
w2 = w + unit(1, "mm")

rearrangeUnit(w2, 2, unit(0, "mm"))

Definitely a much prettier trick than mine.


Best,

baptiste




2009/9/25 baptiste auguie <baptiste.auguie at googlemail.com>:
> Dear Paul and others,
>
> Thanks for the quick response.
>
> 2009/9/25 Paul Murrell <p.murrell at auckland.ac.nz>:
>> Hi
>>
>> The bit you found that says ...
>>
>> # Write "[<-.unit" methods too ??
>>
>> ... is the crucial bit.
>>
>
> When I figured that, I had already written up my email so I thought
> I'd ask anyway from a naive user point of view (in this regard,
> perhaps the help page of unit.c could mention what common methods are
> not available). The results I got can be quite surprising at first.
>
>
>> Would it be possible to add such a method?
>>
>> Almost certainly, it just needs someone to repeatedly bug the person who can
>> make the change :) ? Thanks for the suggestion for code BTW; ?I'll take a
>> look at that.
>
> I'm afraid I won't be of much help here, I merely copied and pasted
> the "[.unit" method with a minimal change that seemed to make it work
> for illustrative purposes. I don't really understand unit.arithmetic
> and unit in general.
>
>> In the meantime, the fact that this has only come up once before, while
>> surprising, suggests that people may have written code in a different style.
>
> Either that or people have struggled to find their own workaround
> every time. I've recently hacked a fake matrix of unit objects, where
> perhaps a proper implementation would find other grateful users.
> (Given a list of grobs, I needed to compute rowMax and colMax of their
> size in a rectangular arrangement -- see example below, also as a
> recent post on r-help).
>
>> ?Can you give a succinct example that demonstrates a situation where you
>> want to assign to a subset of a unit (rather than, say, calculating values,
>> setting some to 0, then building a unit from the values) ?
>>
>
> Though not as succinct as I'd like, I think the drawDetails method of
> tableGrob[*] might present the problem:
>
> drawDetails.table <- function(x, recording=TRUE){
>
> # makeTableGrobs returns lists of grobs, and their width and height in
> a rectangular layout
> ?lg <- with(x, makeTableGrobs(as.character(as.matrix(d)), rows, cols,
> ? ? ? ? nrow(d), ncol(d),
> ? ? ? ? equal.width = equal.width, equal.height = equal.height,
> ? ? ? ? gpar.content = gpar.content,
> ? ? ? ? gpar.col = gpar.col,
> ? ? ? ? gpar.row = gpar.row,
> ? ? ? ? gpar.fill = gpar.fill,
> ? ? ? ? gpar.rowfill = gpar.rowfill,
> ? ? ? ? gpar.colfill = gpar.colfill ) ?)
>
> # now I need to add some horizontal and vertical padding to each cells,
> # EXCEPT for the rownames and colnames if they are not to be shown
> # whereby I convert everything to raw values, use normal vector indexing,
> # and convert back to unit
>
> ?widthsv <- convertUnit(lg$widths + x$padding.h, "mm", valueOnly=TRUE)
> ?heightsv <- convertUnit(lg$heights + x$padding.v, "mm", valueOnly=TRUE)
>
> ?widthsv[1] <- widthsv[1] * as.numeric(x$show.rownames)
> ?widths <- unit(widthsv, "mm")
>
> ?heightsv[1] <- heightsv[1] * as.numeric(x$show.colnames)
> ?heights <- unit(heightsv, "mm")
>
> # once this is done, I can create the layout
> ?cells = viewport(name="table.cells", layout =
> ? ?grid.layout(lg$nrow+1, lg$ncol+1, width=widths, height=heights) )
>
> # and place the elements
> ?pushViewport(cells)
> ?tg <- arrangeTableGrobs(lg$lgt, lg$lgf, lg$nrow, lg$ncol, lg$widths,
> lg$heights,
> ? ? ? ? ?padding.h = x$padding.h, padding.v = x$padding.v,
> ? ? ? ? ?separator=x$separator, show.box=x$show.box,
> ? ? ? ? ?show.csep=x$show.csep, show.rsep=x$show.rsep)
> ?upViewport()
> }
>
> Of course I could make the calculation of adding padding to the cells
> earlier in the chain (in makeTableGrobs) but it's not really its
> place.
>
> Best,
>
> baptiste
>
> [*]: http://code.google.com/p/gridextra/source/browse/trunk/R/tableGrob.r
>
> to be run as,
> either,
>
> library(grid)
> source("http://gridextra.googlecode.com/svn/trunk/R/grob-utils.r")
> source("http://gridextra.googlecode.com/svn/trunk/R/tableGrob.r")
>
> grid.table(head(iris))
>
> or simply,
>
> Install http://gridextra.googlecode.com/files/gridextra_0.3.tar.gz
>
> library(gridextra)
> example(tableGrob)
>
>> Paul
>>
>>
>> baptiste auguie wrote:
>>>
>>> Dear list,
>>>
>>> Consider the following,
>>>
>>> library(grid)
>>>
>>> w = unit.c(unit(1, "in"), unit(2, "in"))
>>> w2 = w + unit(1, "mm")
>>>
>>> w[2] <- 0
>>> w2[2] <- 0
>>>
>>> convertUnit(w, "mm")
>>> #[1] 25.4mm 0mm
>>> convertUnit(w2, "mm")
>>> #Error in grid.Call("L_convert", x, as.integer(whatfrom),
>>> as.integer(whatto), ?:
>>> # ?INTEGER() can only be applied to a 'integer', not a 'NULL'
>>>
>>> The last line fails, as the naive replacement has destroyed the
>>> structure of w2 instead of having assigned a value of 0 to the second
>>> unit element.
>>>
>>> I've also tried,
>>>
>>> w = unit.c(unit(1, "in"), unit(2, "in"))
>>> w2 = w + unit(1, "mm")
>>> w2[[2]][2] <- 0
>>>
>>> but this time, if the structure is licit, it's the result that's not
>>> as I intended:
>>>
>>> convertUnit(w2,"mm")
>>> #[1] 26.4mm 1mm
>>>
>>> My limited understanding is that an object of class unit.arithmetic is
>>> waiting until the last moment to actually perform its operation,
>>> stored in a tree-like structure. With this premise, I can't think of a
>>> good way to modify one element of a list of unit elements.
>>>
>>> As a workaround, I can only think of the following hack where the
>>> objects are forced to be evaluated,
>>>
>>> w = unit.c(unit(1, "in"), unit(2, "in"))
>>> w2 = convertUnit(w + unit(1, "mm"), "mm", valueOnly=TRUE)
>>> w2[2] <- 0
>>> w2 <- unit(w2, "mm")
>>>
>>> but it clearly isn't a very desirable route.
>>>
>>> What is the recommended way to modify one element of a unit vector?
>>>
>>> Digging in grid/R/unit.R , I found the following comment,
>>>
>>> # Write "[<-.unit" methods too ??
>>>
>>> which probably explains the above. Would it be possible to add such a
>>> method,
>>>
>>> "[<-.unit.list" <- function(x, index, value, top=TRUE, ...) {
>>> ?this.length <- length(x)
>>> ? ?index <- (1L:this.length)[index]
>>>
>>> ?if (top && any(index > this.length))
>>> ? ?stop("Index out of bounds (unit list subsetting)")
>>> ?cl <- class(x)
>>> ?result <- unclass(x)
>>> ?result[(index - 1) %% this.length + 1] <- value
>>> ?class(result) <- cl
>>> ?result
>>> }
>>>
>>> a = unit.c(unit(1,"mm"),unit(2,"in"))
>>> a[2] <- unit(3,"in")
>>> a
>>>
>>> but for unit.arithmetic also?
>>>
>>> Regards,
>>>
>>> baptiste
>>>
>>> sessionInfo()
>>> R version 2.9.2 (2009-08-24)
>>> i386-apple-darwin8.11.1
>>>
>>> locale:
>>> en_GB.UTF-8/en_GB.UTF-8/C/C/en_GB.UTF-8/en_GB.UTF-8
>>>
>>> attached base packages:
>>> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?grid ? ? ?methods
>>> [8] base
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> --
>> Dr Paul Murrell
>> Department of Statistics
>> The University of Auckland
>> Private Bag 92019
>> Auckland
>> New Zealand
>> 64 9 3737599 x85392
>> paul at stat.auckland.ac.nz
>> http://www.stat.auckland.ac.nz/~paul/
>>
>


From dankoc at gmail.com  Fri Sep 25 20:01:14 2009
From: dankoc at gmail.com (Charles Danko)
Date: Fri, 25 Sep 2009 14:01:14 -0400
Subject: [Rd] Problem with dgamma function.
Message-ID: <8adccabf0909251101h4e181baey87afaa7ecc30a0e4@mail.gmail.com>

Hi, All,

I am getting some funny results trying to use R's built in
distribution functions.

In R:
> dgamma(4.775972,1.37697964405418, 0.106516604930466)
[1] 0.05585295
> dgamma(4.775972,1.37697964405418, 0.106516604930466,TRUE)  ### THIS IS JUST WRONG!
[1] 0.01710129
> log(dgamma(4.775972,1.37697964405418, 0.106516604930466))
[1] -2.885033
>

In C:
dgamma(4.775972,1.37697964405418, 0.106516604930466,TRUE)
Returns: -41.046764

dgamma(4.775972,1.37697964405418, 0.106516604930466,FALSE)
Returns: 0.000000

SESSION INFO:
R version 2.9.0 (2009-04-17)
x86_64-unknown-linux-gnu

Any indication of what I may be doing wrong is very much appreciated.

Thanks,
Charles


-- 
Postdoctoral Fellow
Cornell University
169 Biotechnology Building
Ithaca, NY 14853

Phone (Lab, 467 Biotech Bldg.): 607-255-4743
E-mail: dankoc at gmail.com


From p.dalgaard at biostat.ku.dk  Fri Sep 25 20:21:12 2009
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri, 25 Sep 2009 20:21:12 +0200
Subject: [Rd] Problem with dgamma function.
In-Reply-To: <8adccabf0909251101h4e181baey87afaa7ecc30a0e4@mail.gmail.com>
References: <8adccabf0909251101h4e181baey87afaa7ecc30a0e4@mail.gmail.com>
Message-ID: <4ABD0A18.3040804@biostat.ku.dk>

Charles Danko wrote:
> Hi, All,
> 
> I am getting some funny results trying to use R's built in
> distribution functions.
> 
> In R:
>> dgamma(4.775972,1.37697964405418, 0.106516604930466)
> [1] 0.05585295
>> dgamma(4.775972,1.37697964405418, 0.106516604930466,TRUE)  ### THIS IS JUST WRONG!
> [1] 0.01710129
>> log(dgamma(4.775972,1.37697964405418, 0.106516604930466))
> [1] -2.885033
> 
> In C:
> dgamma(4.775972,1.37697964405418, 0.106516604930466,TRUE)
> Returns: -41.046764
> 
> dgamma(4.775972,1.37697964405418, 0.106516604930466,FALSE)
> Returns: 0.000000
> 
> SESSION INFO:
> R version 2.9.0 (2009-04-17)
> x86_64-unknown-linux-gnu
> 
> Any indication of what I may be doing wrong is very much appreciated.

Not reading the documentation?

 > args(dgamma)
function (x, shape, rate = 1, scale = 1/rate, log = FALSE)
NULL
 > dgamma(4.775972,1.37697964405418,, 0.106516604930466,TRUE)
[1] -41.04676
 > dgamma(4.775972,1.37697964405418,, 0.106516604930466,FALSE)
[1] 1.491480e-18
 > log(dgamma(4.775972,1.37697964405418,, 0.106516604930466,FALSE))
[1] -41.04676
 > dgamma(4.775972,1.37697964405418,0.106516604930466,log=TRUE)
[1] -2.885033
 >

> Thanks,
> Charles
> 
> 


-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From lobry at biomserv.univ-lyon1.fr  Fri Sep 25 20:24:03 2009
From: lobry at biomserv.univ-lyon1.fr (Jean lobry)
Date: Fri, 25 Sep 2009 20:24:03 +0200
Subject: [Rd] Wish for stripchart to handle pch %in% 21:25 with bg
In-Reply-To: <mailman.19.1253872805.6451.r-devel@r-project.org>
References: <mailman.19.1253872805.6451.r-devel@r-project.org>
Message-ID: <p06002014c6e2b568c8d1@[134.214.233.27]>

Dear R-Devel,

consider :

###
x <- round(rnorm(50))
stripchart(x,  pch = 21, col = "black", bg = "pink", method = "jitter")
points(0.5, 1, pch = 21, col = "black", bg = "pink", cex = 2)
###

Under R 2.9.0 the internal color of the single point produced by points()
was honored but not the color of the points produced by stripchart().

My wish is just that the "bg" parameter for internal point color
should not be lost by the stripchart() function.

This looks somewhat similar for the entry in NEWS for R 2.7.2 stating
that:

     o	stripchart() now passes '...' to title() (as well as to
	plot.default() and axis()). (Wish of PR#12202)

A simple fix that works for me is to forward the argument ... to
the function points() in graphics:::stripchart.default(), but I
know nothing about potential side effects.

Thanks for your amazing work,

Pr. Jean Lobry
-- 
Jean R. Lobry            (lobry at biomserv.univ-lyon1.fr)
Laboratoire BBE-CNRS-UMR-5558, Univ. C. Bernard - LYON I,
43 Bd 11/11/1918, F-69622 VILLEURBANNE CEDEX, FRANCE
allo  : +33 472 43 27 56     fax    : +33 472 43 13 88
http://pbil.univ-lyon1.fr/members/lobry/


From hpages at fhcrc.org  Fri Sep 25 21:05:38 2009
From: hpages at fhcrc.org (=?UTF-8?B?SGVydsOpIFBhZ8Oocw==?=)
Date: Fri, 25 Sep 2009 12:05:38 -0700
Subject: [Rd] crash with NAs in subscripted assignment of a raw vector
In-Reply-To: <486f230c0909241730k2dbdedcem3a2d912c0a1b5507@mail.gmail.com>
References: <4ABBEC04.7040202@fhcrc.org>
	<486f230c0909241730k2dbdedcem3a2d912c0a1b5507@mail.gmail.com>
Message-ID: <4ABD1482.4050007@fhcrc.org>

Seth Falcon wrote:
> 2009/9/24 Herv? Pag?s <hpages at fhcrc.org>:
>>  > x <- charToRaw("ABCDEFGx")
>>  > x[c(1:3, NA, 6)] <- x[8]
>>
>>   *** caught segfault ***
>>  address 0x8402423f, cause 'memory not mapped'
> 
> Thanks for the report.  I have a fix which I will commit after some testing.
> 

Thanks Seth!  H.


From bates at stat.wisc.edu  Fri Sep 25 22:57:03 2009
From: bates at stat.wisc.edu (Douglas Bates)
Date: Fri, 25 Sep 2009 15:57:03 -0500
Subject: [Rd] R + C + Lapack toy regression example
In-Reply-To: <13c5a0ae0909241209i253ece47h6bcedac086fc76bf@mail.gmail.com>
References: <13c5a0ae0909230039w28389d5ch72f63ce5065d0e1d@mail.gmail.com>
	<40e66e0b0909240550g363efe4ajfa49e8bfb5a6c3ae@mail.gmail.com>
	<13c5a0ae0909240947j9b30247j731e1486d45b86e@mail.gmail.com>
	<8068FC73-551E-421A-992F-FE769A7FD143@r-project.org>
	<13c5a0ae0909241209i253ece47h6bcedac086fc76bf@mail.gmail.com>
Message-ID: <40e66e0b0909251357u52227154i376ad0419d4fcd07@mail.gmail.com>

On Thu, Sep 24, 2009 at 2:09 PM, Vinh Nguyen <vqnguyen at uci.edu> wrote:
> On Thu, Sep 24, 2009 at 11:49 AM, Simon Urbanek
> <simon.urbanek at r-project.org> wrote:
>> As Doug pointed out you don't want to be using .C(). As for matrix
>> manipulations - they are usually done directly on the objects which are
>> vectors stored in column-major order.
>
> i meant .Call(). ? also, sorry for the poor word choice, i meant
> matrix computations, not matrix manipulations. ?i guess i just want
> some recommendations for future references on what C library to use if
> i were doing something like re-implement linear regression
> (hypothetically speaking). ?i assumed it would be lapack. ?is this the
> recommended approach?

Yes, Lapack would be the recommended code for numerical linear
algebra.  If happens to be Fortran code but it is callable from C/C++.
 One big advantage of Lapack (besides its having been written by some
of the top people in the field and being very well tested) is that it
uses the BLAS (Basic Linear Algebra Subroutines) as levels 1, 2 and 3.

However, implementing linear models software is more subtle than just
the numerical part.  In fact, least squares calculations are (I think)
the only part of R where Linpack is used instead of  Lapack, by
default.  Most of the time the symbolic analysis of a linear model
formula done in R produces a model matrix with full column rank but
under some circumstances it doesn't.  (The easiest such case to
explain is a two-way layout with missing cells.)  The way these cases
are handled is to use a special pivoting algorithm in the
decomposition.  Neither Linpack nor Lapack provided a pivoting scheme
so early in the R project Ross modified the Linpack version of the QR
decomposition to use such a scheme.  It is still the one in use.


From murray.efford at otago.ac.nz  Sat Sep 26 03:34:54 2009
From: murray.efford at otago.ac.nz (Murray Efford)
Date: Sat, 26 Sep 2009 13:34:54 +1200
Subject: [Rd] Compatibility of external C code across platforms
Message-ID: <E67251526203864DABCB7237DAC8EB2D759B1D232D@MAIL2.registry.otago.ac.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090926/b72bddac/attachment.pl>

From hkawakat at gmail.com  Sat Sep 26 10:52:16 2009
From: hkawakat at gmail.com (Hiroyuki Kawakatsu)
Date: Sat, 26 Sep 2009 09:52:16 +0100
Subject: [Rd] Rtools210 missing jpeg-7?
Message-ID: <307b90470909260152j1a147131w4ef1e9703f865fc9@mail.gmail.com>

Hi,

I just built r49839 on my windoze machine with Rtools210. When I do
-make bitmapdll-, it errors saying file jpeg-7/jconfig.h not found
(apologies, I lost the exact error message). After downloading and
unpacking jpegsr7.zip, the bitmap dll builds fine. Rtools210 appears
to still install jpeg-6b, whereas the bitmap makefile (first line) is
expecting jpeg-7. Perhaps this is still experimental but either Rtools
should include jpeg-7 or the makefile should default to jpeg-6b?

documentation note: the bitmap dll paths R_HOME/bin/Rbitmap.dll in
R-admin should be updated to R_HOME/library/grDevices/libs/.

h.
-- 
+---
| Hiroyuki Kawakatsu
| Business School, Dublin City University
| Dublin 9, Ireland. Tel +353 (0)1 700 7496


From ripley at stats.ox.ac.uk  Sat Sep 26 11:40:11 2009
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 26 Sep 2009 10:40:11 +0100 (BST)
Subject: [Rd] Compatibility of external C code across platforms
In-Reply-To: <E67251526203864DABCB7237DAC8EB2D759B1D232D@MAIL2.registry.otago.ac.nz>
References: <E67251526203864DABCB7237DAC8EB2D759B1D232D@MAIL2.registry.otago.ac.nz>
Message-ID: <alpine.LFD.2.00.0909261021460.14015@gannet.stats.ox.ac.uk>

On Sat, 26 Sep 2009, Murray Efford wrote:

> A package I have written makes considerable use of external C code. 
> There appear to be no problems building a Windows binary with the 
> GNU C compiler, but now I would like to make the package available 
> for other platforms.  A stringent check of the code with the gcc 
> options '-Wall -pedantic' flags many nested functions and 
> variable-length arrays that are not allowed in ISO C.  Is it 
> essential that distributed C source code for R packages conforms to 
> ISO C in this respect?  I'm working in Windows XP with R2.9.2 and 
> Rtools 2.9.

Yes, it is essential.  R does not assume gcc, and it does not even 
assume gcc 4.x (and people are still using gcc 3.x on some platforms, 
e.g. the sunfreeware R builds).  This is why we publish test result on 
CRAN for a completely different compiler (from SunPro).

However, if is not clear which standard you mean by 'ISO C': assuming 
C99 is fairly safe, but GNU extensions from C99 are not -- nested 
functions are one such.

> [Incidentally, when I use a makevars.win file to include these gcc 
> options in Rcmd build etc. the problem with variable-length arrays 
> is not flagged; maybe my command-line gcc is a different version 
> from that in Rtools]

Well, you (and only you) can easily check that for yourself, but the 
other flags also matter, especially --std.  Because it has been needed 
for the use of the MinGW headers, R on Windows is built with 
--std=gnu99.  (Linux headers have a similar problem: using --std=c99 
disables some features we test for in configure and wish to use -- and 
there are OS features, not language extensions.)

>
> Murray Efford
> University of Otago
> Dunedin, New Zealand
> murray.efford at otago.ac.nz<mailto:murray.efford at otago.ac.nz>
>
> 	[[alternative HTML version deleted]]

Please note what the posting guide has to say about that.

>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murray.efford at otago.ac.nz  Sat Sep 26 12:25:25 2009
From: murray.efford at otago.ac.nz (Murray Efford)
Date: Sat, 26 Sep 2009 22:25:25 +1200
Subject: [Rd] Compatibility of external C code across platforms
In-Reply-To: <alpine.LFD.2.00.0909261021460.14015@gannet.stats.ox.ac.uk>
References: <E67251526203864DABCB7237DAC8EB2D759B1D232D@MAIL2.registry.otago.ac.nz>,
	<alpine.LFD.2.00.0909261021460.14015@gannet.stats.ox.ac.uk>
Message-ID: <E67251526203864DABCB7237DAC8EB2D759B1D232F@MAIL2.registry.otago.ac.nz>

Thank you. I'm much clearer on this. I now notice that the messages from gcc distinguish breaches of ISO C and ISO C90, and can see the significance.  My gcc versions were the same - the different behaviour is likely to be explained by the --std flag. And it looks like I have to re-write a lot of C to eliminate nesting of functions.  Point taken about HTML.
Murray Efford
________________________________________
From: Prof Brian Ripley [ripley at stats.ox.ac.uk]
Sent: Saturday, 26 September 2009 9:40 p.m.
To: Murray Efford
Cc: r-devel at lists.R-project.org
Subject: Re: [Rd] Compatibility of external C code across platforms

On Sat, 26 Sep 2009, Murray Efford wrote:

> A package I have written makes considerable use of external C code.
> There appear to be no problems building a Windows binary with the
> GNU C compiler, but now I would like to make the package available
> for other platforms.  A stringent check of the code with the gcc
> options '-Wall -pedantic' flags many nested functions and
> variable-length arrays that are not allowed in ISO C.  Is it
> essential that distributed C source code for R packages conforms to
> ISO C in this respect?  I'm working in Windows XP with R2.9.2 and
> Rtools 2.9.

Yes, it is essential.  R does not assume gcc, and it does not even
assume gcc 4.x (and people are still using gcc 3.x on some platforms,
e.g. the sunfreeware R builds).  This is why we publish test result on
CRAN for a completely different compiler (from SunPro).

However, if is not clear which standard you mean by 'ISO C': assuming
C99 is fairly safe, but GNU extensions from C99 are not -- nested
functions are one such.

> [Incidentally, when I use a makevars.win file to include these gcc
> options in Rcmd build etc. the problem with variable-length arrays
> is not flagged; maybe my command-line gcc is a different version
> from that in Rtools]

Well, you (and only you) can easily check that for yourself, but the
other flags also matter, especially --std.  Because it has been needed
for the use of the MinGW headers, R on Windows is built with
--std=gnu99.  (Linux headers have a similar problem: using --std=c99
disables some features we test for in configure and wish to use -- and
there are OS features, not language extensions.)

>
> Murray Efford
> University of Otago
> Dunedin, New Zealand
> murray.efford at otago.ac.nz<mailto:murray.efford at otago.ac.nz>
>
>       [[alternative HTML version deleted]]

Please note what the posting guide has to say about that.

>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

--
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From murdoch at stats.uwo.ca  Sat Sep 26 15:06:24 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 26 Sep 2009 09:06:24 -0400
Subject: [Rd] Rtools210 missing jpeg-7?
In-Reply-To: <307b90470909260152j1a147131w4ef1e9703f865fc9@mail.gmail.com>
References: <307b90470909260152j1a147131w4ef1e9703f865fc9@mail.gmail.com>
Message-ID: <4ABE11D0.80204@stats.uwo.ca>

Hiroyuki Kawakatsu wrote:
> Hi,
>
> I just built r49839 on my windoze machine with Rtools210. When I do
> -make bitmapdll-, it errors saying file jpeg-7/jconfig.h not found
> (apologies, I lost the exact error message). After downloading and
> unpacking jpegsr7.zip, the bitmap dll builds fine. Rtools210 appears
> to still install jpeg-6b, whereas the bitmap makefile (first line) is
> expecting jpeg-7. Perhaps this is still experimental but either Rtools
> should include jpeg-7 or the makefile should default to jpeg-6b?
>
> documentation note: the bitmap dll paths R_HOME/bin/Rbitmap.dll in
> R-admin should be updated to R_HOME/library/grDevices/libs/.
>
> h.
>   
Thanks.  I'm on the road for a few days, so this might not get fixed 
right away, but you've found the workaround.

Duncan Murdoch


From wdunlap at tibco.com  Sat Sep 26 18:34:37 2009
From: wdunlap at tibco.com (William Dunlap)
Date: Sat, 26 Sep 2009 09:34:37 -0700
Subject: [Rd] Compatibility of external C code across platforms
References: <E67251526203864DABCB7237DAC8EB2D759B1D232D@MAIL2.registry.otago.ac.nz>,
	<alpine.LFD.2.00.0909261021460.14015@gannet.stats.ox.ac.uk>
	<E67251526203864DABCB7237DAC8EB2D759B1D232F@MAIL2.registry.otago.ac.nz>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D700012DFE3F@NA-PA-VBE03.na.tibco.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090926/ee0678f4/attachment.pl>

From bullshit at mail.ru  Sat Sep 26 11:15:12 2009
From: bullshit at mail.ru (bullshit at mail.ru)
Date: Sat, 26 Sep 2009 11:15:12 +0200 (CEST)
Subject: [Rd] mboost_1.1-3  blackboost_fit (PR#13972)
Message-ID: <20090926091512.B7051282EF56@mail.pubhealth.ku.dk>

Full_Name: Ivan the Terrible
Version: 2.9.2
OS: Windows XP SP3
Submission from: (NULL) (89.110.13.151)


When using the method blackboost_fit of the package mboost appear following
error :
Error in party:::get_variables(obj at responses) : 
  trying to get slot "responses" from an object (class "boost_data") that is not
an S4 object

Simple test case that produce bug:

dt=expand.grid(y=c(2,3,4), x1=c(1,2), x2=c(1,2))
library(mboost)
bd=boost_dpp(y ~ .,data=dt, weights = NULL)
blackboost_fit(bd, 
               tree_controls = ctree_control(
                                             teststat     = "max",
                                             testtype     = "Teststatistic",
                                             mincriterion = 0,
                                             maxdepth     = 2
                                            ),
               fitmem = ctree_memory(
                                     bd, 
                                     TRUE
                                    ), 
               family = GaussReg(),
               control = boost_control(
                                       mstop = 2
                                      ), 
               weights = NULL
              )


Test case session on my computer:

> dt=expand.grid(y=c(2,3,4), x1=c(1,2), x2=c(1,2))
> library(mboost)
Loading required package: modeltools
Loading required package: stats4
Loading required package: party
Loading required package: survival
Loading required package: splines
Loading required package: grid
Loading required package: coin
Loading required package: mvtnorm
Loading required package: zoo

Attaching package: 'zoo'


        The following object(s) are masked from package:base :

         as.Date.numeric 

Loading required package: sandwich
Loading required package: strucchange
Loading required package: vcd
Loading required package: MASS
Loading required package: colorspace
> bd=boost_dpp(y ~ .,data=dt, weights = NULL)
> blackboost_fit(bd, 
+                tree_controls = ctree_control(
+                                              teststat     = "max",
+                                              testtype     = "Teststatistic",
+                                              mincriterion = 0,
+                                              maxdepth     = 2
+                                             ),
+                fitmem = ctree_memory(
+                                      bd, 
+                                      TRUE
+                                     ), 
+                family = GaussReg(),
+                control = boost_control(
+                                        mstop = 2
+                                       ), 
+                weights = NULL
+               )
Error in party:::get_variables(obj at responses) : 
  trying to get slot "responses" from an object (class "boost_data") that is not
an S4 object 
> sessionInfo()
R version 2.9.2 (2009-08-24) 
i386-pc-mingw32 

locale:
LC_COLLATE=Russian_Russia.1251;LC_CTYPE=Russian_Russia.1251;LC_MONETARY=Russian_Russia.1251;LC_NUMERIC=C;LC_TIME=Russian_Russia.1251

attached base packages:
[1] grid      splines   stats     graphics  grDevices utils     datasets 
methods   base     

other attached packages:
 [1] mboost_1.1-3      party_0.9-999     vcd_1.2-4         colorspace_1.0-1 
MASS_7.2-48       strucchange_1.3-7
 [7] sandwich_2.2-1    zoo_1.5-8         coin_1.0-6        mvtnorm_0.9-7    
survival_2.35-4   modeltools_0.2-16

loaded via a namespace (and not attached):
[1] lattice_0.17-25 stats4_2.9.2   
>


From francois_birgand at ncsu.edu  Fri Sep 25 22:55:17 2009
From: francois_birgand at ncsu.edu (francois_birgand at ncsu.edu)
Date: Fri, 25 Sep 2009 22:55:17 +0200 (CEST)
Subject: [Rd] xaxs disactivated when asp=1 in plots (PR#13971)
Message-ID: <20090925205517.50797282EF56@mail.pubhealth.ku.dk>

Full_Name: Fran?ois Birgand
Version: 2.9.0
OS: windows xp
Submission from: (NULL) (152.1.16.161)


When I type this sequence:

x11()
Ylim<-c(0,14)
Xlim<-c(0,14)
plot(0,0,xlim=Xlim,ylim=Ylim,col="white",main="",xlab="",ylab="",bty="n",xaxt="n",yaxt="n",xaxs="i",yaxs="i",asp=1)
abline(h=c(0,14),lwd=2,col="grey")
abline(v=c(0,14),lwd=2,col="grey")
par(new=TRUE)
abline(h=seq(0,14,by=0.2),lty=3,col="grey")
abline(h=seq(0,14,by=1),lty=1,col="grey")
abline(v=seq(0,14,by=0.2),lty=3,col="grey")
abline(v=seq(0,14,by=1),lty=1,col="grey")
par(new=TRUE)

only yaxs="i" is taken into account while xaxs="i" is ignored.  When I remove
asp=1, xaxs="i" is activated again.
Small bug but kind of bothersome...!!

Congratulations for the great work you guys are doing!
Fran?ois


From baptiste.auguie at googlemail.com  Sun Sep 27 12:49:36 2009
From: baptiste.auguie at googlemail.com (baptiste auguie)
Date: Sun, 27 Sep 2009 12:49:36 +0200
Subject: [Rd] puzzle with drawDetails for a class derived from a gTree
Message-ID: <de4e29f50909270349v2422eadcne40d228ea98da25e@mail.gmail.com>

Dear all,

I've tried all sorts of variations discussed in "R graphics" by Paul
Murrell, but I still can't understand how to write a drawDetails
method for a class derived from a gTree.
Below is a minimal, dummy example where two strings are plotted in two
separate viewports. I require the creation of the strings to be
evaluated inside the drawDetails function because my real example will
need to calculate a grob size on-the-fly (the viewport size as well,
for which I have no clue where to place the code).

The tests below present two issues:

- editing the gp component of the gTree only affects one child for some reason

- the resulting gTree doesn't appear to contain children, they seem
"hidden" from the user in the drawDetails method


Any advice will be much appreciated!

Best regards,

Baptiste

## two function that create the text grobs
make.test.right <- function(lab, col) {
 textGrob(lab, gp=gpar(col=col), name="right", vp="rightvp")
}

make.test.left <- function(lab, col) {
  textGrob(lab, gp=gpar(col=col), name="left", vp="leftvp")
}

grid.test <- function(right="right text", left="left text", col = "red",
                      edits=NULL, draw=TRUE,
                      name=NULL, gp=gpar()) {

## layout for the two children
  vp <- viewport(layout=grid.layout(1, 2))

 ## viewports, one for each child
  cvp <- vpList(viewport(layout.pos.row=1, layout.pos.col=1, name="leftvp"),
                viewport(layout.pos.row=1, layout.pos.col=2, name="rightvp"))


  x <- gTree(right=right, left=left, col=col,
             childrenvp=cvp,
             edits=edits,
             name=name, gp=gp, vp=vp,
             cl="test")
  if(draw)
    grid.draw(x)
  invisible(x)
}


drawDetails.test <- function(x, recording=TRUE) {

  x <- applyEdits(x,  x$edits)

## create the two grobs
  left <- make.test.left(x$left, x$col)
  right <- make.test.right(x$right, x$col)

## add them to the gTree
  x <- addGrob(x, right)
  x <- addGrob(x, left)

## borrowed from grid.xaxis
## draw the children only

  for(child in childNames(x))
    grid.draw(getGrob(x, child))

}

grid.test("a", "b", edits=gEdit(left="left text", col="blue"),  name="test")
# works as expected

grid.newpage()

grid.test(left="left text", right="right text",   name="test")

grid.edit("test",left="test") # OK
grid.edit("test", col="blue") # OK

grid.edit("test", right="big too?", gp=gpar(cex=2))
# here only the left grob is altered???

grid.edit("test::right",  gp=gpar(cex=2))  ## fails
## as "test" doesn't have children,  apparently

# similarly
grid.gedit("right", right="testing")
# 'gPath' (right) not found


sessionInfo()
R version 2.9.2 (2009-08-24)
i386-apple-darwin8.11.1

locale:
en_GB.UTF-8/en_GB.UTF-8/C/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  grid      methods
[8] base


From ligges at statistik.tu-dortmund.de  Sun Sep 27 17:49:03 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sun, 27 Sep 2009 17:49:03 +0200
Subject: [Rd] xaxs disactivated when asp=1 in plots (PR#13971)
In-Reply-To: <20090925205517.50797282EF56@mail.pubhealth.ku.dk>
References: <20090925205517.50797282EF56@mail.pubhealth.ku.dk>
Message-ID: <4ABF896F.6080505@statistik.tu-dortmund.de>

Not a bug, see ?plot.window that tells us:
asp:
If asp is a finite positive value then the window is set up so that one 
data unit in the x direction is equal in length to asp * one data unit 
in the y direction.

Note that in this case, par("usr") is no longer determined by, e.g., 
par("xaxs"), but rather by asp and the device's aspect ratio. (See what 
happens if you interactively resize the plot device after running the 
example below!)


Best,
Uwe Ligges



francois_birgand at ncsu.edu wrote:
> Full_Name: Fran?ois Birgand
> Version: 2.9.0
> OS: windows xp
> Submission from: (NULL) (152.1.16.161)
> 
> 
> When I type this sequence:
> 
> x11()
> Ylim<-c(0,14)
> Xlim<-c(0,14)
> plot(0,0,xlim=Xlim,ylim=Ylim,col="white",main="",xlab="",ylab="",bty="n",xaxt="n",yaxt="n",xaxs="i",yaxs="i",asp=1)
> abline(h=c(0,14),lwd=2,col="grey")
> abline(v=c(0,14),lwd=2,col="grey")
> par(new=TRUE)
> abline(h=seq(0,14,by=0.2),lty=3,col="grey")
> abline(h=seq(0,14,by=1),lty=1,col="grey")
> abline(v=seq(0,14,by=0.2),lty=3,col="grey")
> abline(v=seq(0,14,by=1),lty=1,col="grey")
> par(new=TRUE)
> 
> only yaxs="i" is taken into account while xaxs="i" is ignored.  When I remove
> asp=1, xaxs="i" is activated again.
> Small bug but kind of bothersome...!!
> 
> Congratulations for the great work you guys are doing!
> Fran?ois
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Sun Sep 27 17:51:51 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sun, 27 Sep 2009 17:51:51 +0200
Subject: [Rd] mboost_1.1-3  blackboost_fit (PR#13972)
In-Reply-To: <20090926091512.B7051282EF56@mail.pubhealth.ku.dk>
References: <20090926091512.B7051282EF56@mail.pubhealth.ku.dk>
Message-ID: <4ABF8A17.9020502@statistik.tu-dortmund.de>

Please read the FAQs about submitting bug reports. Bugs in contributed 
packages must not go to the R-bugs repository but to the corresponding 
package maintainer, CCing in this case (I do not confirmed that it is a 
bug).

Best,
Uwe Ligges




bullshit at mail.ru wrote:
> Full_Name: Ivan the Terrible
> Version: 2.9.2
> OS: Windows XP SP3
> Submission from: (NULL) (89.110.13.151)
> 
> 
> When using the method blackboost_fit of the package mboost appear following
> error :
> Error in party:::get_variables(obj at responses) : 
>   trying to get slot "responses" from an object (class "boost_data") that is not
> an S4 object
> 
> Simple test case that produce bug:
> 
> dt=expand.grid(y=c(2,3,4), x1=c(1,2), x2=c(1,2))
> library(mboost)
> bd=boost_dpp(y ~ .,data=dt, weights = NULL)
> blackboost_fit(bd, 
>                tree_controls = ctree_control(
>                                              teststat     = "max",
>                                              testtype     = "Teststatistic",
>                                              mincriterion = 0,
>                                              maxdepth     = 2
>                                             ),
>                fitmem = ctree_memory(
>                                      bd, 
>                                      TRUE
>                                     ), 
>                family = GaussReg(),
>                control = boost_control(
>                                        mstop = 2
>                                       ), 
>                weights = NULL
>               )
> 
> 
> Test case session on my computer:
> 
>> dt=expand.grid(y=c(2,3,4), x1=c(1,2), x2=c(1,2))
>> library(mboost)
> Loading required package: modeltools
> Loading required package: stats4
> Loading required package: party
> Loading required package: survival
> Loading required package: splines
> Loading required package: grid
> Loading required package: coin
> Loading required package: mvtnorm
> Loading required package: zoo
> 
> Attaching package: 'zoo'
> 
> 
>         The following object(s) are masked from package:base :
> 
>          as.Date.numeric 
> 
> Loading required package: sandwich
> Loading required package: strucchange
> Loading required package: vcd
> Loading required package: MASS
> Loading required package: colorspace
>> bd=boost_dpp(y ~ .,data=dt, weights = NULL)
>> blackboost_fit(bd, 
> +                tree_controls = ctree_control(
> +                                              teststat     = "max",
> +                                              testtype     = "Teststatistic",
> +                                              mincriterion = 0,
> +                                              maxdepth     = 2
> +                                             ),
> +                fitmem = ctree_memory(
> +                                      bd, 
> +                                      TRUE
> +                                     ), 
> +                family = GaussReg(),
> +                control = boost_control(
> +                                        mstop = 2
> +                                       ), 
> +                weights = NULL
> +               )
> Error in party:::get_variables(obj at responses) : 
>   trying to get slot "responses" from an object (class "boost_data") that is not
> an S4 object 
>> sessionInfo()
> R version 2.9.2 (2009-08-24) 
> i386-pc-mingw32 
> 
> locale:
> LC_COLLATE=Russian_Russia.1251;LC_CTYPE=Russian_Russia.1251;LC_MONETARY=Russian_Russia.1251;LC_NUMERIC=C;LC_TIME=Russian_Russia.1251
> 
> attached base packages:
> [1] grid      splines   stats     graphics  grDevices utils     datasets 
> methods   base     
> 
> other attached packages:
>  [1] mboost_1.1-3      party_0.9-999     vcd_1.2-4         colorspace_1.0-1 
> MASS_7.2-48       strucchange_1.3-7
>  [7] sandwich_2.2-1    zoo_1.5-8         coin_1.0-6        mvtnorm_0.9-7    
> survival_2.35-4   modeltools_0.2-16
> 
> loaded via a namespace (and not attached):
> [1] lattice_0.17-25 stats4_2.9.2   
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Sun Sep 27 20:27:58 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sun, 27 Sep 2009 20:27:58 +0200
Subject: [Rd] build time dependency
In-Reply-To: <4ABC8E7C.2060004@dbmail.com>
References: <4ABC8E7C.2060004@dbmail.com>
Message-ID: <4ABFAEAE.2030103@statistik.tu-dortmund.de>



Romain Francois wrote:
> Hello,
> 
> Is there such thing as a build time dependency between packages : 
> package B needs package A so that it can build, but once built it lives 
> without it.


Do you mean at a) "R CMD build" time or at b) "R CMD INSTALL" time?
For a), you probably do not need to declare it in DESCRIPTION at all 
(untested).
For b), you need to declare it. I feel uncomfortable to change the 
Depends field between source and binary version of a package. At least, 
it is not documented to work and if it works (have you tested that?), it 
might not work in some future release of R.
But since you gave at least 2 reasonable examples for a 
INSTALL-time-only dependency, you might want to contribute some patches 
to handle such a thing.

Best wishes,
Uwe






> For example depending on the ant package to compile java code, or depend 
> on roxygen to roxygenize the code, ...
> 
> Adding roxygen to Depends works, but then the installed package does not 
> depend on it and therefore loads it for nothing. Maybe I can remove 
> roxygen from the Depends as part of the ./configure[.win] ...
> 
> Romain
>


From keith at wehi.EDU.AU  Mon Sep 28 05:40:03 2009
From: keith at wehi.EDU.AU (Keith Satterley)
Date: Mon, 28 Sep 2009 13:40:03 +1000
Subject: [Rd] Windows Laptop specification query
Message-ID: <4AC03013.1030402@wehi.edu.au>

I've read some postings back in 2002/2006 about running R on multiple 
core CPUs. The answer was basically separate processes work fine, but 
parallelization needs to be implemented using snow/rmpi. Are the answers 
still the same?

I ask because we are about to order a laptop running Windows for a new 
staff member. Some advice on the following would be helpful.
It will be ordered with Vista, with a free upgrade to Windows 7. It will 
have 8GB of memory

A quad core CPU costs about AUD$1100 more than the fastest (Intel 
T9900-6M Cache, 3.06 GHz) dual core CPU.
I'm wondering if there is value in ordering the quad core. We are 
looking at a time frame of 3-4 years.

Is anyone aware of near future plans to implement some form or 
parallelization that would more or less be hidden from the normal user?
 
It is anticipated that analysis of Next Gen sequence data will be important.

I've read the Windows FAQ about running R under Vista. We will probably 
start with Vista. I've read some posts in R-devel indicating people are 
running R under Windows 7. Is it safe to assume that R will run under 
Windows 7 after it is released?

We are hoping to make use the 8GB of memory. Am I right in assuming that 
when the 64 bit version of Windows 7 is available, it will allow R users 
to make good use of the 8GB of memory. Does this happen under the 
current higher end versions of 64 bit Vista?

cheers,

Keith

========================
Keith Satterley
Bioinformatics Division
The Walter and Eliza Hall Institute of Medical Research
Parkville, Melbourne,
Victoria, Australia


From sean.oriordain at gmail.com  Mon Sep 28 08:30:05 2009
From: sean.oriordain at gmail.com (Sean O'Riordain)
Date: Mon, 28 Sep 2009 07:30:05 +0100
Subject: [Rd] Windows Laptop specification query
In-Reply-To: <4AC03013.1030402@wehi.edu.au>
References: <4AC03013.1030402@wehi.edu.au>
Message-ID: <8ed68eed0909272330k744b89f4m1add09313c5728fb@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090928/979b4865/attachment.pl>

From smyth at wehi.EDU.AU  Mon Sep 28 08:31:37 2009
From: smyth at wehi.EDU.AU (Gordon K Smyth)
Date: Mon, 28 Sep 2009 16:31:37 +1000 (AUS Eastern Standard Time)
Subject: [Rd] documentation cross references under R 2.10.0dev for Windows
In-Reply-To: <4ABADF79.9050106@stats.uwo.ca>
References: <59d7961d0909231908q4ba58b99gdee28c1c49ffd6bc@mail.gmail.com>
	<4ABADF79.9050106@stats.uwo.ca>
Message-ID: <Pine.WNT.4.64.0909281623470.5952@PC602.alpha.wehi.edu.au>

Rcmd check under R 2.10.0dev for Windows seems to be issuing a number of 
spurious warning messages about Rd cross-references.

The following warning messages appear when checking the latest 
(non-public) version of the Bioconductor package limma.  They appear only 
under Windows, not Unix or Mac.  All the flagged links appear to be ok, in 
that they specific a genuine html file, and should therefore not be marked 
as suspect or missing.

Regards
Gordon

* using R version 2.10.0 Under development (unstable) (2009-09-27 r49846)
* using session charset: ISO8859-1
* checking Rd cross-references ... WARNING
Missing link(s) in documentation object './man/01Introduction.Rd':
   '[limma:00Index]{LIMMA contents page}'

Suspect link(s) in documentation object './man/asmalist.Rd':
   '[marray:marrayNorm-class]{marrayNorm}'

Suspect link(s) in documentation object './man/asmatrix.Rd':
   '[Biobase]{exprs}'

Suspect link(s) in documentation object './man/dupcor.Rd':
   '[statmod]{mixedModel2Fit}'

Suspect link(s) in documentation object './man/EList.Rd':
   '[Biobase]{ExpressionSet-class}'

Suspect link(s) in documentation object './man/imageplot.Rd':
   '[marray]{maImage}'

Suspect link(s) in documentation object './man/intraspotCorrelation.Rd':
   '[statmod]{remlscore}'

Suspect link(s) in documentation object './man/limmaUsersGuide.Rd':
   '[Biobase]{openPDF}' '[Biobase]{openVignette}' '[base]{Sys.putenv}'

Suspect link(s) in documentation object './man/malist.Rd':
   '[marray:marrayNorm-class]{marrayNorm}'

Suspect link(s) in documentation object './man/normalizebetweenarrays.Rd':
   '[marray:maNormScale]{maNormScale}' '[affy:normalize]{normalize}'

Suspect link(s) in documentation object './man/normalizeWithinArrays.Rd':
   '[marray:maNorm]{maNorm}'

Suspect link(s) in documentation object './man/normexpfit.Rd':
   '[affy:bg.adjust]{bg.parameters}'

Suspect link(s) in documentation object './man/readgal.Rd':
   '[marray:read.Galfile]{read.Galfile}'

Suspect link(s) in documentation object './man/rglist.Rd':
   '[marray:marrayRaw-class]{marrayRaw}'



On Wed, 23 Sep 2009, Duncan Murdoch wrote:

> On 23/09/2009 10:08 PM, Henrik Bengtsson wrote:
>> Hi,
>> 
>> in 'Writing R Extensions" of R v2.10.0, under Section
>> 'Cross-references' (2009-09-07) it says:
>> 
>> 1. "The markup \link{foo} (usually in the combination
>> \code{\link{foo}}) produces a hyperlink to the help for foo. Here foo
>> is a topic, that is the argument of \alias markup in another Rd file
>> (possibly in another package)."
>> 
>> 2. "You can specify a link to a different topic than its name by
>> \link[=dest]{name} which links to topic dest with name name. This can
>> be used to refer to the documentation for S3/4 classes, for example
>> \code{"\link[=abc-class]{abc}"} would be a way to refer to the
>> documentation of an S4 class "abc" defined in your package, and
>> \code{"\link[=terms.object]{terms}"} to the S3 "terms" class (in
>> package stats). To make these easy to read, \code{"\linkS4class{abc}"}
>> expands to the form given above."
>> 
>> 3. "There are two other forms of optional argument specified as
>> \link[pkg]{foo} and \link[pkg:bar]{foo} to link to the package pkg, to
>> files foo.html and bar.html respectively. These are rarely needed,
>> perhaps to refer to not-yet-installed packages (but there the HTML
>> help system will resolve the link at run time) or in the normally
>> undesirable event that more than one package offers help on a topic20
>> (in which case the present package has precedence so this is only
>> needed to refer to other packages). They are only in used in HTML help
>> (and ignored for hyperlinks in LaTeX conversions of help pages), and
>> link to the file rather than the topic (since there is no way to know
>> which topics are in which files in an uninstalled package). The *only*
>> reason to use these forms for base and recommended packages is to
>> force a reference to a package that might be further down the search
>> path. Because they have been frequently misused, as from R 2.10.0 the
>> HTML help system will look for topic foo in package pkg if it does not
>> find file foo.html."
>> 
>> 
>> Trying to summarize the above, do we have the following markups/rules?
>> 
>> A. \link{<topic>} - where <topic> must occur as an \alias{<topic>},
>> but not necessarily as an \name{<topic>}.  The link will be display as
>> the string <topic>.
>> B. \link[=<topic>]{<name>} - where <topic> must occur as an
>> \alias{<topic>} with a \name{<name>}.  The link will be display as the
>> string <name>.
>> C. \link{<packageName>]{<name>} - where <name> must be a \name{<name>}
>> in a package named <packageName>.  The link will be display as the
>> string <name>.
>> D. \link{<packageName>:<name>]{<label>} - where <name> must be a
>> \name{<name>} in a package named <packageName>.  The link will be
>> display as the string <label>.  There are no restrictions on <label>.
>> E. \linkS4class{<className>} expands to
>> \link[=<className>-class]{<className>}.  From (B) it then follows that
>> there must be an \alias{<className>-class} and a \name{<className>}.
>> 
>> 
>> Q1. Is that correct?  To me it look a bit inconsistent.
>
> No, \name{} is irrelevant for links.  It's the filename that matters in the 
> 3rd form.
>
>> 
>> Q2. Are there more?
>> 
>> Q3. Will there be more?
>> 
>> Q4. What about
>> 
>> \link[=<topic>]{<label>}
>> \link{<packageName>:<topic>]{<label>}
>> 
>> where <label> can be (almost) any string?
>
> The first is what the 2nd form refers to.  "Name" there is what is displayed 
> in the file making the link.
>
> The second is new, as of 2.10.0, and is the fallback if a filename matching 
> <topic> is not found.
>> 
>> Q4. Are (A) and (B) only supposed to be used for linking within a
>> package, or can it be used to link to "wherever" <topic> exist?
>
> They should work anywhere.  The difficulty arises if you link to something 
> that a user doesn't have installed, or if the link is ambiguous.
>
>> Q5. It sounds that (C) and (D) should be avoided.  Is that correct?
>
> I think good practice is to make sure that the base of the filename (less 
> .Rd) is also an alias in the file, and also the \name{} of the file.  The 
> system would probably be less confusing if this were forced, but there are 
> lots of files out there where it's not true.
>
> You want the filename to be an alias because links sometimes go to aliases 
> and sometimes to filenames; you want the name to match because that's what is 
> displayed at the top of the page, so people might remember "just go to the 
> Foo man page".
>
>> Q6. What if <topic> exist in two packages 'pkgA' and 'pkgB' and I want
>> to specify that I mean topic <topic> of package 'pkgA', cf namespaces
>> and pkgA::foo()?
>
> If you follow the good practice above, then use \link[pkgA]{topic}.  If you 
> don't follow that practice, you may be out of luck, because R will look for 
> the filename topic.Rd in pkgA, not \alias{topic}.  However, as of 2.10.0, it 
> will fall back to the latter.
>
>> Q7. I the 1st paragraph above it says "(possibly in another package)"
>> and in the 3rd paragraph above it is mentioned at "The only reason to
>> use these forms [...] is to force a reference to a package that might
>> be further down the search path" - is that the answer to Q4?  Will
>> \link{<topic>} be *dynamically* linked to whatever comes first on the
>> search() path - to reflect the running environment rather than the
>> intention of the document?
>
> In 2.10.0, I believe this will be the case (but I'd have to check the code to 
> be sure).  I'd recommend being explicit if you are worried about this 
> possibility.
>
>
>> Reading between the lines, the development of Rd looks exiting.
>> Instead of 2nd guessing where we are heading, could someone in charge
>> please give some thoughts on what the plans are and an estimate on how
>> long it will take before we are there - what R version?
>
> I don't think there's really someone "in charge", but I've been closely 
> involved with this, so I'll give some thoughts.
>
> Generally speaking, we have releases on a regular schedule, we don't hold 
> them up for particular features.  So I don't think it would be possible to 
> figure out when development on Rd files will be done.  It depends on when 
> people have the time to do what they think needs doing, and to a large 
> extent, that depends on how things get used.
>
> Some things that are not there now, but which might be there in the future 
> (i.e. later than 2.10.0):
>
> - Better support for the \Sexpr macros (which let the content of man pages 
> depend on R code, executed just before rendering).  Right now there's no 
> special support for that R code; it would make sense to define some functions 
> to make writing such stuff easier.  (This is something that could be done in 
> a contributed package, it needn't be in base R.)
>
> - Improved prompt() and package.skeleton() functions to take advantage of 
> the above.
>
> - Graphs in man pages.
>
> - Ways to link from man pages to vignettes.  The reverse would be nice, but 
> it's not possible with the current design, so that would be far off.
>
> - Some general rationalization of the whole help system.
>
> Duncan Murdoch
>
>> 
>> MISC:
>> I understand that \link[=<className>-class]{<className>} is part of
>> standard Rd conventions, but to the best of my knowledge
>> \link[=<className>.class]{<className>} is not, correct?  I would like
>> to suggest to write a separate paragraph for S4 classes without
>> mentioning S3 classes.  The following also adds to the confusion -
>> there exists one Rd page with \name{terms} and one with
>> \name{terms.object}, so it is not really clear what
>> \link[=terms.object]{terms} is strictly supposed to do - is it of form
>> \link[=<topic>]{<name>} or \link[=<topic>]{<label>}.  Maybe it is
>> helpful to clarify what the static/dynamic link will be and what will
>> be display.
>> 
>> Thanks
>> 
>> Henrik
>> 
>> PS. This is related to today's (Sept 23, 2009) BioConductor posts by
>> Gordon Smyth - "[Bioc-devel] BioC 2.5: "suspect" interpackage links";
>> https://stat.ethz.ch/pipermail/bioc-devel/2009-September/001975.html
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From romain.francois at dbmail.com  Mon Sep 28 09:13:28 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Mon, 28 Sep 2009 09:13:28 +0200
Subject: [Rd] build time dependency
In-Reply-To: <4ABFAEAE.2030103@statistik.tu-dortmund.de>
References: <4ABC8E7C.2060004@dbmail.com>
	<4ABFAEAE.2030103@statistik.tu-dortmund.de>
Message-ID: <4AC06218.4010802@dbmail.com>

On 09/27/2009 08:27 PM, Uwe Ligges wrote:
>
>
>
> Romain Francois wrote:
>> Hello,
>>
>> Is there such thing as a build time dependency between packages :
>> package B needs package A so that it can build, but once built it
>> lives without it.
>
>
> Do you mean at a) "R CMD build" time or at b) "R CMD INSTALL" time?

I meant R CMD INSTALL (but probably also R CMD build --binary), I need 
to check the code to see where this overlaps.


> For a), you probably do not need to declare it in DESCRIPTION at all
> (untested).
> For b), you need to declare it. I feel uncomfortable to change the
> Depends field between source and binary version of a package. At least,
> it is not documented to work and if it works (have you tested that?), it
> might not work in some future release of R.
> But since you gave at least 2 reasonable examples for a
> INSTALL-time-only dependency, you might want to contribute some patches
> to handle such a thing.

Sure. I'll have a look to add a "InstallDependencies" (or whatever other 
spelling) field along the lines of Depends, but for INSTALL time.

Romain

>
> Best wishes,
> Uwe
>
>
>> For example depending on the ant package to compile java code, or
>> depend on roxygen to roxygenize the code, ...
>>
>> Adding roxygen to Depends works, but then the installed package does
>> not depend on it and therefore loads it for nothing. Maybe I can
>> remove roxygen from the Depends as part of the ./configure[.win] ...
>>
>> Romain
>>

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/ztCu : RGG #158:161: examples of package IDPmisc
|- http://tr.im/yw8E : New R package : sos
`- http://tr.im/y8y0 : search the graph gallery from R


From groemping at bht-berlin.de  Mon Sep 28 10:00:24 2009
From: groemping at bht-berlin.de (Ulrike Groemping)
Date: Mon, 28 Sep 2009 01:00:24 -0700 (PDT)
Subject: [Rd]  model.matrix troubles with AlgDesign
Message-ID: <25641680.post@talk.nabble.com>


Dear DevelopeRs,

in continuing with my suite of packages on experimental design, I am stuck
with an issue that appears to be related to package AlgDesign - I have tried
to get it solved by Bob Wheeler, but he seems to be stuck as well. 

Whenever AlgDesign is loaded, some of my code does not work any more. For
example, in a fresh R session: 

require(DoE.base)
fac.design(nlevels=c(2,6,2))
require(AlgDesign)
fac.design(nlevels=c(2,6,2))
> Error in nrow(aus) : object 'aus' not found 

The reason seems to be that AlgDesign creates a function
model.matrix.formula that only finds variables that are in the global
environment and variables that are in the data frame given with the formula,
but not calculation results from the intermediate calling environment. 

Results from traceback():
9: nrow(aus)
8: eval(expr, envir, enclos)
7: eval(predvars, data, env)
6: model.frame.default(object, data, xlev = xlev)
5: model.frame(object, data, xlev = xlev)
4: model.matrix.default(frml, data, ...)
3: model.matrix.formula(1:nrow(aus) ~ ., data = aus)
2: model.matrix(1:nrow(aus) ~ ., data = aus)
1: fac.design(nlevels = c(2, 6, 2))

If I reset model.matrix.formula to model.matrix.default, the problem
disappears (but AlgDesign's comfort functions for squares etc. do not work
any longer). In this particular case, I can also avoid the issue by
modifying the formula in fac.design, removing the left-hand side. But this
just means to wait for the next place where troubles occur. Between 3 and 4
of the traceback(), AlgDesign's function model.matrix.formula modifies the
formula frml using AlgDesign's function expand.formula:

model.matrix.formula <- function (frml, data = sys.frame(sys.parent()), ...) 
{
    if (!missing(data)) {
        if (!inherits(data, "data.frame")) 
            stop("data must be a data.frame")
        if (!inherits(frml, "formula")) 
            stop("frml must be a formuls")
        frml <- expand.formula(frml, colnames(data))
    }
    model.matrix.default(frml, data, ...)
}


I have looked at expand.formula as well, and I've been wondering whether a
simple fix can be found by adding environment information (which?) within
that function (I believe that the relevant portion of the code is included
below):

expand.formula <- function (frml, varNames, const = TRUE, numerics = NULL) 
{
## omitted quite a bit of code 
##...
    frml <- deparse(frml, width = 500)
    while ((0 != (pos <- findFunction("quad", frml))[1]) || (0 != 
        (pos <- findFunction("cubicS", frml))[1]) || (0 != (pos <-
findFunction("cubic", 
        frml))[1])) {
        prog <- substr(frml, pos[1], pos[2])
        strHead <- substr(frml, 1, pos[1] - 1)
        strTail <- substr(frml, pos[2] + 1, nchar(frml))
        prog <- eval(parse(text = prog))
        frml <- paste(strHead, prog, strTail, sep = "")
    }
    if (0 != (pos <- findDot(".", frml))[1]) {
        strHead <- substr(frml, 1, pos[1] - 1)
        strTail <- substr(frml, pos[2] + 1, nchar(frml))
        prog <- eval(parse(text = "doDot()"))
        frml <- paste(strHead, prog, strTail, sep = "")
    }
    if (!const) 
        frml <- paste(frml, "+0", sep = "")
    frml <- as.formula(frml)
    frml
}

Any help would be greatly appreciated.

Regards, Ulrike

-- 
View this message in context: http://www.nabble.com/model.matrix-troubles-with-AlgDesign-tp25641680p25641680.html
Sent from the R devel mailing list archive at Nabble.com.


From ripley at stats.ox.ac.uk  Mon Sep 28 10:16:23 2009
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 28 Sep 2009 09:16:23 +0100 (BST)
Subject: [Rd] Windows Laptop specification query
In-Reply-To: <8ed68eed0909272330k744b89f4m1add09313c5728fb@mail.gmail.com>
References: <4AC03013.1030402@wehi.edu.au>
	<8ed68eed0909272330k744b89f4m1add09313c5728fb@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.0909280903260.22690@gannet.stats.ox.ac.uk>

On Mon, 28 Sep 2009, Sean O'Riordain wrote:

> Good morning Keith,
>
> Have a look at
> http://cran.r-project.org/bin/windows/base/rw-FAQ.html#There-seems-to-be-a-limit-on-the-memory-it-uses_0021
>
> The short answer is that "it depends"...
> a) memory is limited under windows

Yes, but 64-bit builds can be used on Windows -- that needs commercial 
compilers and there are commercial vendors of such builds.

Even with the CRAN binary, a 64-bit version of Windows offers double 
the memory over a (vanilla) 32-bit version.

> b) R is essentially a serial program - HOWEVER it depends what you're
> actually doing - if you're working with large matrices then there are
> parallel versions of BLAS that can be used...  On a multi-core windows
> machine with lots of memory you can of course run up multiple copies of R
> and run each independently

There are several packages that parallelize their computations with 
MPI etc, and others that help with parallelization (papply, foreach, 
gputools, ....).  And apart from Rmpi/rpvm/snow there is also 
'multicore', but not on Windows.  See the R-sig-hpc list for follow up 
on such issues.

As for Vista vs Windows 7, this is not the right list but Windows 7 
behaves just like a version of Vista as far as we have explored it 
(and the current rw-FAQ includes it and Server 2008 in the Vista 
section).

Many of us have bought dual quad-core servers in the last year or so: 
that includes Uwe Ligges' winbuilder machine.  I suspect most of the 
usage is separate R jobs running simultaneously: certainly that is the 
case in my dept (where there are at least 6 8-core servers running R 
jobs).

>
> Kind regards,
> Sean
>
> On Mon, Sep 28, 2009 at 4:40 AM, Keith Satterley <keith at wehi.edu.au> wrote:
>
>> I've read some postings back in 2002/2006 about running R on multiple core
>> CPUs. The answer was basically separate processes work fine, but
>> parallelization needs to be implemented using snow/rmpi. Are the answers
>> still the same?
>>
>> I ask because we are about to order a laptop running Windows for a new
>> staff member. Some advice on the following would be helpful.
>> It will be ordered with Vista, with a free upgrade to Windows 7. It will
>> have 8GB of memory
>>
>> A quad core CPU costs about AUD$1100 more than the fastest (Intel T9900-6M
>> Cache, 3.06 GHz) dual core CPU.
>> I'm wondering if there is value in ordering the quad core. We are looking
>> at a time frame of 3-4 years.
>>
>> Is anyone aware of near future plans to implement some form or
>> parallelization that would more or less be hidden from the normal user?
>>
>> It is anticipated that analysis of Next Gen sequence data will be
>> important.
>>
>> I've read the Windows FAQ about running R under Vista. We will probably
>> start with Vista. I've read some posts in R-devel indicating people are
>> running R under Windows 7. Is it safe to assume that R will run under
>> Windows 7 after it is released?
>>
>> We are hoping to make use the 8GB of memory. Am I right in assuming that
>> when the 64 bit version of Windows 7 is available, it will allow R users to
>> make good use of the 8GB of memory. Does this happen under the current
>> higher end versions of 64 bit Vista?
>>
>> cheers,
>>
>> Keith
>>
>> ========================
>> Keith Satterley
>> Bioinformatics Division
>> The Walter and Eliza Hall Institute of Medical Research
>> Parkville, Melbourne,
>> Victoria, Australia
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From Torsten.Hothorn at stat.uni-muenchen.de  Mon Sep 28 10:23:35 2009
From: Torsten.Hothorn at stat.uni-muenchen.de (Torsten Hothorn)
Date: Mon, 28 Sep 2009 10:23:35 +0200 (CEST)
Subject: [Rd] mboost_1.1-3  blackboost_fit (PR#13972)
In-Reply-To: <4ABF8A17.9020502@statistik.tu-dortmund.de>
References: <20090926091512.B7051282EF56@mail.pubhealth.ku.dk>
	<4ABF8A17.9020502@statistik.tu-dortmund.de>
Message-ID: <alpine.DEB.2.00.0909281022100.10903@artemis.stat.uni-muenchen.de>



On Sun, 27 Sep 2009, Uwe Ligges wrote:

> Please read the FAQs about submitting bug reports. Bugs in contributed 
> packages must not go to the R-bugs repository but to the corresponding 
> package maintainer, CCing in this case (I do not confirmed that it is a bug).
>

Ivan,

   bd <- party:::ctreedpp(y ~ ., data = dt, weights = NULL)

will do the job, however, not very nicely. mboost version 2.0-0 
(available from R-forge) can do better.

Best wishes,

Torsten



> Best,
> Uwe Ligges
>
>
>
>
> bullshit at mail.ru wrote:
>> Full_Name: Ivan the Terrible
>> Version: 2.9.2
>> OS: Windows XP SP3
>> Submission from: (NULL) (89.110.13.151)
>> 
>> 
>> When using the method blackboost_fit of the package mboost appear following
>> error :
>> Error in party:::get_variables(obj at responses) :   trying to get slot 
>> "responses" from an object (class "boost_data") that is not
>> an S4 object
>> 
>> Simple test case that produce bug:
>> 
>> dt=expand.grid(y=c(2,3,4), x1=c(1,2), x2=c(1,2))
>> library(mboost)
>> bd=boost_dpp(y ~ .,data=dt, weights = NULL)
>> blackboost_fit(bd,                tree_controls = ctree_control(
>>                                              teststat     = "max",
>>                                              testtype     = 
>> "Teststatistic",
>>                                              mincriterion = 0,
>>                                              maxdepth     = 2
>>                                             ),
>>                fitmem = ctree_memory(
>>                                      bd, 
>> TRUE
>>                                     ),                family = GaussReg(),
>>                control = boost_control(
>>                                        mstop = 2
>>                                       ),                weights = NULL
>>               )
>> 
>> 
>> Test case session on my computer:
>> 
>>> dt=expand.grid(y=c(2,3,4), x1=c(1,2), x2=c(1,2))
>>> library(mboost)
>> Loading required package: modeltools
>> Loading required package: stats4
>> Loading required package: party
>> Loading required package: survival
>> Loading required package: splines
>> Loading required package: grid
>> Loading required package: coin
>> Loading required package: mvtnorm
>> Loading required package: zoo
>> 
>> Attaching package: 'zoo'
>> 
>>
>>         The following object(s) are masked from package:base :
>>
>>          as.Date.numeric 
>> Loading required package: sandwich
>> Loading required package: strucchange
>> Loading required package: vcd
>> Loading required package: MASS
>> Loading required package: colorspace
>>> bd=boost_dpp(y ~ .,data=dt, weights = NULL)
>>> blackboost_fit(bd, 
>> +                tree_controls = ctree_control(
>> +                                              teststat     = "max",
>> +                                              testtype     = 
>> "Teststatistic",
>> +                                              mincriterion = 0,
>> +                                              maxdepth     = 2
>> +                                             ),
>> +                fitmem = ctree_memory(
>> +                                      bd, + 
>> TRUE
>> +                                     ), +                family = 
>> GaussReg(),
>> +                control = boost_control(
>> +                                        mstop = 2
>> +                                       ), +                weights = NULL
>> +               )
>> Error in party:::get_variables(obj at responses) :   trying to get slot 
>> "responses" from an object (class "boost_data") that is not
>> an S4 object 
>>> sessionInfo()
>> R version 2.9.2 (2009-08-24) i386-pc-mingw32 
>> locale:
>> LC_COLLATE=Russian_Russia.1251;LC_CTYPE=Russian_Russia.1251;LC_MONETARY=Russian_Russia.1251;LC_NUMERIC=C;LC_TIME=Russian_Russia.1251
>> 
>> attached base packages:
>> [1] grid      splines   stats     graphics  grDevices utils     datasets 
>> methods   base 
>> other attached packages:
>>  [1] mboost_1.1-3      party_0.9-999     vcd_1.2-4         colorspace_1.0-1 
>> MASS_7.2-48       strucchange_1.3-7
>>  [7] sandwich_2.2-1    zoo_1.5-8         coin_1.0-6        mvtnorm_0.9-7 
>> survival_2.35-4   modeltools_0.2-16
>> 
>> loaded via a namespace (and not attached):
>> [1] lattice_0.17-25 stats4_2.9.2 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From linera27 at yahoo.co.uk  Mon Sep 28 10:59:13 2009
From: linera27 at yahoo.co.uk (Lina Rusyte)
Date: Mon, 28 Sep 2009 08:59:13 +0000 (GMT)
Subject: [Rd] =?utf-8?b?U3RhcnRpbmcgdmFsdWVzIGluIOKAnGFyaW1hLnNpbeKAnSBm?=
	=?utf-8?q?unction?=
Message-ID: <647192.61160.qm@web25606.mail.ukl.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090928/eaaf39f2/attachment.pl>

From ct529 at york.ac.uk  Mon Sep 28 11:44:06 2009
From: ct529 at york.ac.uk (Corrado)
Date: Mon, 28 Sep 2009 10:44:06 +0100
Subject: [Rd] Windows Laptop specification query
In-Reply-To: <alpine.LFD.2.00.0909280903260.22690@gannet.stats.ox.ac.uk>
References: <4AC03013.1030402@wehi.edu.au>
	<8ed68eed0909272330k744b89f4m1add09313c5728fb@mail.gmail.com>
	<alpine.LFD.2.00.0909280903260.22690@gannet.stats.ox.ac.uk>
Message-ID: <200909281044.06278.ct529@york.ac.uk>

1) Would a package compiled for Windows 32bit run on Windows 64 bit and use 
the extended memory or not?

2) As for buying a performant laptop for R, I bought a Dell M6300 mobile 
workstation which is actually portable, and installed Kubuntu 904 64 bit 
alongside the standard windows installation. When I run R I only use it in 
Linux and access the data in Windows through the file system. If I need to run 
Office because some one else is sending me document to correct, I have installed 
Windows XP Pro SP3 in a virtual machine using Virtual Box, which runs very 
fairly on the M6300, and can switch it on and off whenever I need (booting on 
the virtual machine is matter of few seconds). This setup allows for running 
64 bit R on Linux (eventually compiled with -O3 -march=native by the way, if 
you feel like experimenting) which is more performant and used the memory more 
efficiently, without loosing the interacting with your windows based colleagues. 
The virtual machine can go full screen at the click of a mouse :D and it looks 
as if you were using a native Windows machine. You can install all software 
and network clients on the virtual machine. I have not booted Windows for ages 
.... I have been using this machine fort he last 18 months. The dual core 
works great (I chose the top processor to run simulations when I am not in the 
office), and in Linux you can control the CPU frequency. The new one which 
substitutes the M6300 is the M6400 and I would go for that possibly (Linux 
supported):

http://www1.euro.dell.com/uk/en/business/Laptops/workstation-precision-m6400-
cov/pd.aspx?refid=workstation-precision-m6400-cov&s=bsd&cs=ukbsdt1


PS: I apologise for the question on memory management but I have never used R 
on Windows but some free spirit decided to release a package only for Windows 
and only pre compiled (no sources) and I need to use it to compare .... (Sorry 
for the harsh comment and the rant , but I am not sure it is really fair to 
use an open source packages and programming languages for you daily work and 
make money out of it, and the first time you release something you release it 
crappy and closed source .... even if it is legal and allowed of course .... :
( ....)

On Monday 28 September 2009 09:16:23 Prof Brian Ripley wrote:
> On Mon, 28 Sep 2009, Sean O'Riordain wrote:
> > Good morning Keith,
> >
> > Have a look at
> > http://cran.r-project.org/bin/windows/base/rw-FAQ.html#There-seems-to-be-
> >a-limit-on-the-memory-it-uses_0021
> >
> > The short answer is that "it depends"...
> > a) memory is limited under windows
>
> Yes, but 64-bit builds can be used on Windows -- that needs commercial
> compilers and there are commercial vendors of such builds.
>
> Even with the CRAN binary, a 64-bit version of Windows offers double
> the memory over a (vanilla) 32-bit version.
>
> > b) R is essentially a serial program - HOWEVER it depends what you're
> > actually doing - if you're working with large matrices then there are
> > parallel versions of BLAS that can be used...  On a multi-core windows
> > machine with lots of memory you can of course run up multiple copies of R
> > and run each independently
>
> There are several packages that parallelize their computations with
> MPI etc, and others that help with parallelization (papply, foreach,
> gputools, ....).  And apart from Rmpi/rpvm/snow there is also
> 'multicore', but not on Windows.  See the R-sig-hpc list for follow up
> on such issues.
>
> As for Vista vs Windows 7, this is not the right list but Windows 7
> behaves just like a version of Vista as far as we have explored it
> (and the current rw-FAQ includes it and Server 2008 in the Vista
> section).
>
> Many of us have bought dual quad-core servers in the last year or so:
> that includes Uwe Ligges' winbuilder machine.  I suspect most of the
> usage is separate R jobs running simultaneously: certainly that is the
> case in my dept (where there are at least 6 8-core servers running R
> jobs).
>
> > Kind regards,
> > Sean
> >
> > On Mon, Sep 28, 2009 at 4:40 AM, Keith Satterley <keith at wehi.edu.au> 
wrote:
> >> I've read some postings back in 2002/2006 about running R on multiple
> >> core CPUs. The answer was basically separate processes work fine, but
> >> parallelization needs to be implemented using snow/rmpi. Are the answers
> >> still the same?
> >>
> >> I ask because we are about to order a laptop running Windows for a new
> >> staff member. Some advice on the following would be helpful.
> >> It will be ordered with Vista, with a free upgrade to Windows 7. It will
> >> have 8GB of memory
> >>
> >> A quad core CPU costs about AUD$1100 more than the fastest (Intel
> >> T9900-6M Cache, 3.06 GHz) dual core CPU.
> >> I'm wondering if there is value in ordering the quad core. We are
> >> looking at a time frame of 3-4 years.
> >>
> >> Is anyone aware of near future plans to implement some form or
> >> parallelization that would more or less be hidden from the normal user?
> >>
> >> It is anticipated that analysis of Next Gen sequence data will be
> >> important.
> >>
> >> I've read the Windows FAQ about running R under Vista. We will probably
> >> start with Vista. I've read some posts in R-devel indicating people are
> >> running R under Windows 7. Is it safe to assume that R will run under
> >> Windows 7 after it is released?
> >>
> >> We are hoping to make use the 8GB of memory. Am I right in assuming that
> >> when the 64 bit version of Windows 7 is available, it will allow R users
> >> to make good use of the 8GB of memory. Does this happen under the
> >> current higher end versions of 64 bit Vista?
> >>
> >> cheers,
> >>
> >> Keith
> >>
> >> ========================
> >> Keith Satterley
> >> Bioinformatics Division
> >> The Walter and Eliza Hall Institute of Medical Research
> >> Parkville, Melbourne,
> >> Victoria, Australia
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> > 	[[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
Corrado Topi

Global Climate Change & Biodiversity Indicators
Area 18,Department of Biology
University of York, York, YO10 5YW, UK
Phone: + 44 (0) 1904 328645, E-mail: ct529 at york.ac.uk


From ripley at stats.ox.ac.uk  Mon Sep 28 12:01:42 2009
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 28 Sep 2009 11:01:42 +0100 (BST)
Subject: [Rd] Windows Laptop specification query
In-Reply-To: <200909281044.06278.ct529@york.ac.uk>
References: <4AC03013.1030402@wehi.edu.au>
	<8ed68eed0909272330k744b89f4m1add09313c5728fb@mail.gmail.com>
	<alpine.LFD.2.00.0909280903260.22690@gannet.stats.ox.ac.uk>
	<200909281044.06278.ct529@york.ac.uk>
Message-ID: <alpine.LFD.2.00.0909281100040.31119@toucan.stats.ox.ac.uk>

The answer to (1) is in the rw-FAQ, so see

library(fortunes)
fortune('WTFM')

On Mon, 28 Sep 2009, Corrado wrote:

> 1) Would a package compiled for Windows 32bit run on Windows 64 bit and use
> the extended memory or not?
>
> 2) As for buying a performant laptop for R, I bought a Dell M6300 mobile
> workstation which is actually portable, and installed Kubuntu 904 64 bit
> alongside the standard windows installation. When I run R I only use it in
> Linux and access the data in Windows through the file system. If I need to run
> Office because some one else is sending me document to correct, I have installed
> Windows XP Pro SP3 in a virtual machine using Virtual Box, which runs very
> fairly on the M6300, and can switch it on and off whenever I need (booting on
> the virtual machine is matter of few seconds). This setup allows for running
> 64 bit R on Linux (eventually compiled with -O3 -march=native by the way, if
> you feel like experimenting) which is more performant and used the memory more
> efficiently, without loosing the interacting with your windows based colleagues.
> The virtual machine can go full screen at the click of a mouse :D and it looks
> as if you were using a native Windows machine. You can install all software
> and network clients on the virtual machine. I have not booted Windows for ages
> .... I have been using this machine fort he last 18 months. The dual core
> works great (I chose the top processor to run simulations when I am not in the
> office), and in Linux you can control the CPU frequency. The new one which
> substitutes the M6300 is the M6400 and I would go for that possibly (Linux
> supported):
>
> http://www1.euro.dell.com/uk/en/business/Laptops/workstation-precision-m6400-
> cov/pd.aspx?refid=workstation-precision-m6400-cov&s=bsd&cs=ukbsdt1
>
>
> PS: I apologise for the question on memory management but I have never used R
> on Windows but some free spirit decided to release a package only for Windows
> and only pre compiled (no sources) and I need to use it to compare .... (Sorry
> for the harsh comment and the rant , but I am not sure it is really fair to
> use an open source packages and programming languages for you daily work and
> make money out of it, and the first time you release something you release it
> crappy and closed source .... even if it is legal and allowed of course .... :
> ( ....)
>
> On Monday 28 September 2009 09:16:23 Prof Brian Ripley wrote:
>> On Mon, 28 Sep 2009, Sean O'Riordain wrote:
>>> Good morning Keith,
>>>
>>> Have a look at
>>> http://cran.r-project.org/bin/windows/base/rw-FAQ.html#There-seems-to-be-
>>> a-limit-on-the-memory-it-uses_0021
>>>
>>> The short answer is that "it depends"...
>>> a) memory is limited under windows
>>
>> Yes, but 64-bit builds can be used on Windows -- that needs commercial
>> compilers and there are commercial vendors of such builds.
>>
>> Even with the CRAN binary, a 64-bit version of Windows offers double
>> the memory over a (vanilla) 32-bit version.
>>
>>> b) R is essentially a serial program - HOWEVER it depends what you're
>>> actually doing - if you're working with large matrices then there are
>>> parallel versions of BLAS that can be used...  On a multi-core windows
>>> machine with lots of memory you can of course run up multiple copies of R
>>> and run each independently
>>
>> There are several packages that parallelize their computations with
>> MPI etc, and others that help with parallelization (papply, foreach,
>> gputools, ....).  And apart from Rmpi/rpvm/snow there is also
>> 'multicore', but not on Windows.  See the R-sig-hpc list for follow up
>> on such issues.
>>
>> As for Vista vs Windows 7, this is not the right list but Windows 7
>> behaves just like a version of Vista as far as we have explored it
>> (and the current rw-FAQ includes it and Server 2008 in the Vista
>> section).
>>
>> Many of us have bought dual quad-core servers in the last year or so:
>> that includes Uwe Ligges' winbuilder machine.  I suspect most of the
>> usage is separate R jobs running simultaneously: certainly that is the
>> case in my dept (where there are at least 6 8-core servers running R
>> jobs).
>>
>>> Kind regards,
>>> Sean
>>>
>>> On Mon, Sep 28, 2009 at 4:40 AM, Keith Satterley <keith at wehi.edu.au>
> wrote:
>>>> I've read some postings back in 2002/2006 about running R on multiple
>>>> core CPUs. The answer was basically separate processes work fine, but
>>>> parallelization needs to be implemented using snow/rmpi. Are the answers
>>>> still the same?
>>>>
>>>> I ask because we are about to order a laptop running Windows for a new
>>>> staff member. Some advice on the following would be helpful.
>>>> It will be ordered with Vista, with a free upgrade to Windows 7. It will
>>>> have 8GB of memory
>>>>
>>>> A quad core CPU costs about AUD$1100 more than the fastest (Intel
>>>> T9900-6M Cache, 3.06 GHz) dual core CPU.
>>>> I'm wondering if there is value in ordering the quad core. We are
>>>> looking at a time frame of 3-4 years.
>>>>
>>>> Is anyone aware of near future plans to implement some form or
>>>> parallelization that would more or less be hidden from the normal user?
>>>>
>>>> It is anticipated that analysis of Next Gen sequence data will be
>>>> important.
>>>>
>>>> I've read the Windows FAQ about running R under Vista. We will probably
>>>> start with Vista. I've read some posts in R-devel indicating people are
>>>> running R under Windows 7. Is it safe to assume that R will run under
>>>> Windows 7 after it is released?
>>>>
>>>> We are hoping to make use the 8GB of memory. Am I right in assuming that
>>>> when the 64 bit version of Windows 7 is available, it will allow R users
>>>> to make good use of the 8GB of memory. Does this happen under the
>>>> current higher end versions of 64 bit Vista?
>>>>
>>>> cheers,
>>>>
>>>> Keith
>>>>
>>>> ========================
>>>> Keith Satterley
>>>> Bioinformatics Division
>>>> The Walter and Eliza Hall Institute of Medical Research
>>>> Parkville, Melbourne,
>>>> Victoria, Australia
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>> 	[[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>
> -- 
> Corrado Topi
>
> Global Climate Change & Biodiversity Indicators
> Area 18,Department of Biology
> University of York, York, YO10 5YW, UK
> Phone: + 44 (0) 1904 328645, E-mail: ct529 at york.ac.uk
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Mon Sep 28 12:01:42 2009
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 28 Sep 2009 11:01:42 +0100 (BST)
Subject: [Rd] Windows Laptop specification query
In-Reply-To: <200909281044.06278.ct529@york.ac.uk>
References: <4AC03013.1030402@wehi.edu.au>
	<8ed68eed0909272330k744b89f4m1add09313c5728fb@mail.gmail.com>
	<alpine.LFD.2.00.0909280903260.22690@gannet.stats.ox.ac.uk>
	<200909281044.06278.ct529@york.ac.uk>
Message-ID: <alpine.LFD.2.00.0909281100040.31119@toucan.stats.ox.ac.uk>

The answer to (1) is in the rw-FAQ, so see

library(fortunes)
fortune('WTFM')

On Mon, 28 Sep 2009, Corrado wrote:

> 1) Would a package compiled for Windows 32bit run on Windows 64 bit and use
> the extended memory or not?
>
> 2) As for buying a performant laptop for R, I bought a Dell M6300 mobile
> workstation which is actually portable, and installed Kubuntu 904 64 bit
> alongside the standard windows installation. When I run R I only use it in
> Linux and access the data in Windows through the file system. If I need to run
> Office because some one else is sending me document to correct, I have installed
> Windows XP Pro SP3 in a virtual machine using Virtual Box, which runs very
> fairly on the M6300, and can switch it on and off whenever I need (booting on
> the virtual machine is matter of few seconds). This setup allows for running
> 64 bit R on Linux (eventually compiled with -O3 -march=native by the way, if
> you feel like experimenting) which is more performant and used the memory more
> efficiently, without loosing the interacting with your windows based colleagues.
> The virtual machine can go full screen at the click of a mouse :D and it looks
> as if you were using a native Windows machine. You can install all software
> and network clients on the virtual machine. I have not booted Windows for ages
> .... I have been using this machine fort he last 18 months. The dual core
> works great (I chose the top processor to run simulations when I am not in the
> office), and in Linux you can control the CPU frequency. The new one which
> substitutes the M6300 is the M6400 and I would go for that possibly (Linux
> supported):
>
> http://www1.euro.dell.com/uk/en/business/Laptops/workstation-precision-m6400-
> cov/pd.aspx?refid=workstation-precision-m6400-cov&s=bsd&cs=ukbsdt1
>
>
> PS: I apologise for the question on memory management but I have never used R
> on Windows but some free spirit decided to release a package only for Windows
> and only pre compiled (no sources) and I need to use it to compare .... (Sorry
> for the harsh comment and the rant , but I am not sure it is really fair to
> use an open source packages and programming languages for you daily work and
> make money out of it, and the first time you release something you release it
> crappy and closed source .... even if it is legal and allowed of course .... :
> ( ....)
>
> On Monday 28 September 2009 09:16:23 Prof Brian Ripley wrote:
>> On Mon, 28 Sep 2009, Sean O'Riordain wrote:
>>> Good morning Keith,
>>>
>>> Have a look at
>>> http://cran.r-project.org/bin/windows/base/rw-FAQ.html#There-seems-to-be-
>>> a-limit-on-the-memory-it-uses_0021
>>>
>>> The short answer is that "it depends"...
>>> a) memory is limited under windows
>>
>> Yes, but 64-bit builds can be used on Windows -- that needs commercial
>> compilers and there are commercial vendors of such builds.
>>
>> Even with the CRAN binary, a 64-bit version of Windows offers double
>> the memory over a (vanilla) 32-bit version.
>>
>>> b) R is essentially a serial program - HOWEVER it depends what you're
>>> actually doing - if you're working with large matrices then there are
>>> parallel versions of BLAS that can be used...  On a multi-core windows
>>> machine with lots of memory you can of course run up multiple copies of R
>>> and run each independently
>>
>> There are several packages that parallelize their computations with
>> MPI etc, and others that help with parallelization (papply, foreach,
>> gputools, ....).  And apart from Rmpi/rpvm/snow there is also
>> 'multicore', but not on Windows.  See the R-sig-hpc list for follow up
>> on such issues.
>>
>> As for Vista vs Windows 7, this is not the right list but Windows 7
>> behaves just like a version of Vista as far as we have explored it
>> (and the current rw-FAQ includes it and Server 2008 in the Vista
>> section).
>>
>> Many of us have bought dual quad-core servers in the last year or so:
>> that includes Uwe Ligges' winbuilder machine.  I suspect most of the
>> usage is separate R jobs running simultaneously: certainly that is the
>> case in my dept (where there are at least 6 8-core servers running R
>> jobs).
>>
>>> Kind regards,
>>> Sean
>>>
>>> On Mon, Sep 28, 2009 at 4:40 AM, Keith Satterley <keith at wehi.edu.au>
> wrote:
>>>> I've read some postings back in 2002/2006 about running R on multiple
>>>> core CPUs. The answer was basically separate processes work fine, but
>>>> parallelization needs to be implemented using snow/rmpi. Are the answers
>>>> still the same?
>>>>
>>>> I ask because we are about to order a laptop running Windows for a new
>>>> staff member. Some advice on the following would be helpful.
>>>> It will be ordered with Vista, with a free upgrade to Windows 7. It will
>>>> have 8GB of memory
>>>>
>>>> A quad core CPU costs about AUD$1100 more than the fastest (Intel
>>>> T9900-6M Cache, 3.06 GHz) dual core CPU.
>>>> I'm wondering if there is value in ordering the quad core. We are
>>>> looking at a time frame of 3-4 years.
>>>>
>>>> Is anyone aware of near future plans to implement some form or
>>>> parallelization that would more or less be hidden from the normal user?
>>>>
>>>> It is anticipated that analysis of Next Gen sequence data will be
>>>> important.
>>>>
>>>> I've read the Windows FAQ about running R under Vista. We will probably
>>>> start with Vista. I've read some posts in R-devel indicating people are
>>>> running R under Windows 7. Is it safe to assume that R will run under
>>>> Windows 7 after it is released?
>>>>
>>>> We are hoping to make use the 8GB of memory. Am I right in assuming that
>>>> when the 64 bit version of Windows 7 is available, it will allow R users
>>>> to make good use of the 8GB of memory. Does this happen under the
>>>> current higher end versions of 64 bit Vista?
>>>>
>>>> cheers,
>>>>
>>>> Keith
>>>>
>>>> ========================
>>>> Keith Satterley
>>>> Bioinformatics Division
>>>> The Walter and Eliza Hall Institute of Medical Research
>>>> Parkville, Melbourne,
>>>> Victoria, Australia
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>> 	[[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>
> -- 
> Corrado Topi
>
> Global Climate Change & Biodiversity Indicators
> Area 18,Department of Biology
> University of York, York, YO10 5YW, UK
> Phone: + 44 (0) 1904 328645, E-mail: ct529 at york.ac.uk
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ct529 at york.ac.uk  Mon Sep 28 12:14:13 2009
From: ct529 at york.ac.uk (Corrado)
Date: Mon, 28 Sep 2009 11:14:13 +0100
Subject: [Rd] Windows Laptop specification query
In-Reply-To: <alpine.LFD.2.00.0909281100040.31119@toucan.stats.ox.ac.uk>
References: <4AC03013.1030402@wehi.edu.au>
	<200909281044.06278.ct529@york.ac.uk>
	<alpine.LFD.2.00.0909281100040.31119@toucan.stats.ox.ac.uk>
Message-ID: <200909281114.13516.ct529@york.ac.uk>

On Monday 28 September 2009 11:01:42 Prof Brian Ripley wrote:
> The answer to (1) is in the rw-FAQ, so see

Can you point me out exactly where? Since I did not find it.

-- 
Corrado Topi

Global Climate Change & Biodiversity Indicators
Area 18,Department of Biology
University of York, York, YO10 5YW, UK
Phone: + 44 (0) 1904 328645, E-mail: ct529 at york.ac.uk


From oehl_list at gmx.de  Sun Sep 27 14:40:06 2009
From: oehl_list at gmx.de (=?iso-8859-1?Q?=22Jens_Oehlschl=E4gel=22?=)
Date: Sun, 27 Sep 2009 14:40:06 +0200
Subject: [Rd] bug or feature in read.table?
Message-ID: <20090927124006.301320@gmx.net>

Hi,

I guess that the followig line in read.table 
tmp[i[i > 0L]] <- colClasses
should read
tmp[i[i > 0L]] <- colClasses[i > 0L]

Is this a bug?

Cheers
Jens Oehlschl?gel
-- 

f?r nur 19,99 Euro/mtl.!* http://portal.gmx.net/de/go/dsl02


From ramatim at bgu.ac.il  Mon Sep 28 15:09:29 2009
From: ramatim at bgu.ac.il (Michael Ramati)
Date: Mon, 28 Sep 2009 13:09:29 GMT
Subject: [Rd] lattice's mai/mar analog
In-Reply-To: <mailman.18.1254132007.21828.r-devel@r-project.org>
References: <mailman.18.1254132007.21828.r-devel@r-project.org>
Message-ID: <fa05c18161156.4ac0b589@bgu.ac.il>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090928/f9388677/attachment.pl>

From ligges at statistik.tu-dortmund.de  Mon Sep 28 16:39:06 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 28 Sep 2009 16:39:06 +0200
Subject: [Rd] build time dependency
In-Reply-To: <4AC06218.4010802@dbmail.com>
References: <4ABC8E7C.2060004@dbmail.com>	<4ABFAEAE.2030103@statistik.tu-dortmund.de>
	<4AC06218.4010802@dbmail.com>
Message-ID: <4AC0CA8A.40500@statistik.tu-dortmund.de>



Romain Francois wrote:
> On 09/27/2009 08:27 PM, Uwe Ligges wrote:
>>
>>
>>
>> Romain Francois wrote:
>>> Hello,
>>>
>>> Is there such thing as a build time dependency between packages :
>>> package B needs package A so that it can build, but once built it
>>> lives without it.
>>
>>
>> Do you mean at a) "R CMD build" time or at b) "R CMD INSTALL" time?
> 
> I meant R CMD INSTALL (but probably also R CMD build --binary), I need 
> to check the code to see where this overlaps.

Are you sure you *really* need those dependencies at INSTALL rather than 
build time? I haven't looked closely into roxygen so far, but if it is 
designed to work at INSTALL time, the task is to move this to the build 
time of the package from my point of view.

Since the roxygen author, Manuel Eugster, is in Dortmund today, I will 
discuss this point.

Best,
Uwe Ligges




> 
> 
>> For a), you probably do not need to declare it in DESCRIPTION at all
>> (untested).
>> For b), you need to declare it. I feel uncomfortable to change the
>> Depends field between source and binary version of a package. At least,
>> it is not documented to work and if it works (have you tested that?), it
>> might not work in some future release of R.
>> But since you gave at least 2 reasonable examples for a
>> INSTALL-time-only dependency, you might want to contribute some patches
>> to handle such a thing.
> 
> Sure. I'll have a look to add a "InstallDependencies" (or whatever other 
> spelling) field along the lines of Depends, but for INSTALL time.
> 
> Romain
> 
>>
>> Best wishes,
>> Uwe
>>
>>
>>> For example depending on the ant package to compile java code, or
>>> depend on roxygen to roxygenize the code, ...
>>>
>>> Adding roxygen to Depends works, but then the installed package does
>>> not depend on it and therefore loads it for nothing. Maybe I can
>>> remove roxygen from the Depends as part of the ./configure[.win] ...
>>>
>>> Romain
>>>
>


From romain.francois at dbmail.com  Mon Sep 28 20:25:10 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Mon, 28 Sep 2009 20:25:10 +0200
Subject: [Rd] build time dependency
In-Reply-To: <4AC0CA8A.40500@statistik.tu-dortmund.de>
References: <4ABC8E7C.2060004@dbmail.com>	<4ABFAEAE.2030103@statistik.tu-dortmund.de>
	<4AC06218.4010802@dbmail.com>
	<4AC0CA8A.40500@statistik.tu-dortmund.de>
Message-ID: <4AC0FF86.6000504@dbmail.com>

On 09/28/2009 04:39 PM, Uwe Ligges wrote:
> Romain Francois wrote:
>> On 09/27/2009 08:27 PM, Uwe Ligges wrote:
>>>
>>> Romain Francois wrote:
>>>> Hello,
>>>>
>>>> Is there such thing as a build time dependency between packages :
>>>> package B needs package A so that it can build, but once built it
>>>> lives without it.
>>>
>>>
>>> Do you mean at a) "R CMD build" time or at b) "R CMD INSTALL" time?
>>
>> I meant R CMD INSTALL (but probably also R CMD build --binary), I need
>> to check the code to see where this overlaps.
>
> Are you sure you *really* need those dependencies at INSTALL rather than
> build time? I haven't looked closely into roxygen so far, but if it is
> designed to work at INSTALL time, the task is to move this to the build
> time of the package from my point of view.
>
> Since the roxygen author, Manuel Eugster, is in Dortmund today, I will
> discuss this point.

Hi Uwe,

I think you are supposed to do this kind of sequence:

R CMD roxygen yourRoxygenablePackage
R CMD build yourRoxygenablePackage_roxygen

... but I don't like this because what you upload to cran is not the 
actual source but somethingalready pre-processed. (This also applies to 
packages shipping java code, most people just compile the java code on 
their machine and only supply a jar of compiled code, but that's another 
story I suppose ...)

I'd prefer the roxygenation to be part of the standard build/INSTALL 
system, so my plan is to write configure and configure.win which would 
call roxygenize to generate Rd.

I am not aware of any hook similar to configure[.win] you can use so 
that "R CMD build" does something extra. I probably just missed it.

Romain


> Best,
> Uwe Ligges
>
>
>
>
>>
>>
>>> For a), you probably do not need to declare it in DESCRIPTION at all
>>> (untested).
>>> For b), you need to declare it. I feel uncomfortable to change the
>>> Depends field between source and binary version of a package. At least,
>>> it is not documented to work and if it works (have you tested that?), it
>>> might not work in some future release of R.
>>> But since you gave at least 2 reasonable examples for a
>>> INSTALL-time-only dependency, you might want to contribute some patches
>>> to handle such a thing.
>>
>> Sure. I'll have a look to add a "InstallDependencies" (or whatever
>> other spelling) field along the lines of Depends, but for INSTALL time.
>>
>> Romain
>>
>>>
>>> Best wishes,
>>> Uwe
>>>
>>>
>>>> For example depending on the ant package to compile java code, or
>>>> depend on roxygen to roxygenize the code, ...
>>>>
>>>> Adding roxygen to Depends works, but then the installed package does
>>>> not depend on it and therefore loads it for nothing. Maybe I can
>>>> remove roxygen from the Depends as part of the ./configure[.win] ...
>>>>
>>>> Romain
>>>>
>>
>
>


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/ztCu : RGG #158:161: examples of package IDPmisc
|- http://tr.im/yw8E : New R package : sos
`- http://tr.im/y8y0 : search the graph gallery from R


From ggrothendieck at gmail.com  Tue Sep 29 01:59:48 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 28 Sep 2009 19:59:48 -0400
Subject: [Rd] Downloading R-2.10.0
Message-ID: <971536df0909281659i3e62fe17pe65efb59a68c98c5@mail.gmail.com>

For Windows, this page

http://cran.r-project.org/bin/windows/base/

gives a link to download

- R 2.9.2
- r-patched (R 2.9.2 patched)
- old releases and
- r-devel (R 2.11.0)

but there is no obvious link to R 2.10.0.  From where do we download that?


From smyth at wehi.EDU.AU  Tue Sep 29 03:17:36 2009
From: smyth at wehi.EDU.AU (Gordon K Smyth)
Date: Tue, 29 Sep 2009 11:17:36 +1000 (AUS Eastern Standard Time)
Subject: [Rd] documentation cross references under R 2.10.0dev for
	Windows
In-Reply-To: <Pine.WNT.4.64.0909281623470.5952@PC602.alpha.wehi.edu.au>
References: <59d7961d0909231908q4ba58b99gdee28c1c49ffd6bc@mail.gmail.com>
	<4ABADF79.9050106@stats.uwo.ca>
	<Pine.WNT.4.64.0909281623470.5952@PC602.alpha.wehi.edu.au>
Message-ID: <Pine.WNT.4.64.0909291108540.4488@PC602.alpha.wehi.edu.au>

With one expection, all warnings go away when I download the relevant 
Bioconductor packages as source code and re-build them (rcmd INSTALL 
--build) on my own machine.

The warnings re-appear if I install the Bioconductor packages in the 
normal way using biocLite("Biobase") etc.  I will follow this up with the 
Bioconductor people.

The one exception is the self-reference to limma:00Index.  This marked as 
a missing link, under Windows only, although it works fine.

Gordon

On Mon, 28 Sep 2009, Gordon K Smyth wrote:

> Rcmd check under R 2.10.0dev for Windows seems to be issuing a number of 
> spurious warning messages about Rd cross-references.
>
> The following warning messages appear when checking the latest (non-public) 
> version of the Bioconductor package limma.  They appear only under Windows, 
> not Unix or Mac.  All the flagged links appear to be ok, in that they 
> specific a genuine html file, and should therefore not be marked as suspect 
> or missing.
>
> Regards
> Gordon
>
> * using R version 2.10.0 Under development (unstable) (2009-09-27 r49846)
> * using session charset: ISO8859-1
> * checking Rd cross-references ... WARNING
> Missing link(s) in documentation object './man/01Introduction.Rd':
>  '[limma:00Index]{LIMMA contents page}'
>
> Suspect link(s) in documentation object './man/asmalist.Rd':
>  '[marray:marrayNorm-class]{marrayNorm}'
>
> Suspect link(s) in documentation object './man/asmatrix.Rd':
>  '[Biobase]{exprs}'
>
> Suspect link(s) in documentation object './man/dupcor.Rd':
>  '[statmod]{mixedModel2Fit}'
>
> Suspect link(s) in documentation object './man/EList.Rd':
>  '[Biobase]{ExpressionSet-class}'
>
> Suspect link(s) in documentation object './man/imageplot.Rd':
>  '[marray]{maImage}'
>
> Suspect link(s) in documentation object './man/intraspotCorrelation.Rd':
>  '[statmod]{remlscore}'
>
> Suspect link(s) in documentation object './man/limmaUsersGuide.Rd':
>  '[Biobase]{openPDF}' '[Biobase]{openVignette}' '[base]{Sys.putenv}'
>
> Suspect link(s) in documentation object './man/malist.Rd':
>  '[marray:marrayNorm-class]{marrayNorm}'
>
> Suspect link(s) in documentation object './man/normalizebetweenarrays.Rd':
>  '[marray:maNormScale]{maNormScale}' '[affy:normalize]{normalize}'
>
> Suspect link(s) in documentation object './man/normalizeWithinArrays.Rd':
>  '[marray:maNorm]{maNorm}'
>
> Suspect link(s) in documentation object './man/normexpfit.Rd':
>  '[affy:bg.adjust]{bg.parameters}'
>
> Suspect link(s) in documentation object './man/readgal.Rd':
>  '[marray:read.Galfile]{read.Galfile}'
>
> Suspect link(s) in documentation object './man/rglist.Rd':
>  '[marray:marrayRaw-class]{marrayRaw}'
>
>
>
> On Wed, 23 Sep 2009, Duncan Murdoch wrote:
>
>> On 23/09/2009 10:08 PM, Henrik Bengtsson wrote:
>>> Hi,
>>> 
>>> in 'Writing R Extensions" of R v2.10.0, under Section
>>> 'Cross-references' (2009-09-07) it says:
>>> 
>>> 1. "The markup \link{foo} (usually in the combination
>>> \code{\link{foo}}) produces a hyperlink to the help for foo. Here foo
>>> is a topic, that is the argument of \alias markup in another Rd file
>>> (possibly in another package)."
>>> 
>>> 2. "You can specify a link to a different topic than its name by
>>> \link[=dest]{name} which links to topic dest with name name. This can
>>> be used to refer to the documentation for S3/4 classes, for example
>>> \code{"\link[=abc-class]{abc}"} would be a way to refer to the
>>> documentation of an S4 class "abc" defined in your package, and
>>> \code{"\link[=terms.object]{terms}"} to the S3 "terms" class (in
>>> package stats). To make these easy to read, \code{"\linkS4class{abc}"}
>>> expands to the form given above."
>>> 
>>> 3. "There are two other forms of optional argument specified as
>>> \link[pkg]{foo} and \link[pkg:bar]{foo} to link to the package pkg, to
>>> files foo.html and bar.html respectively. These are rarely needed,
>>> perhaps to refer to not-yet-installed packages (but there the HTML
>>> help system will resolve the link at run time) or in the normally
>>> undesirable event that more than one package offers help on a topic20
>>> (in which case the present package has precedence so this is only
>>> needed to refer to other packages). They are only in used in HTML help
>>> (and ignored for hyperlinks in LaTeX conversions of help pages), and
>>> link to the file rather than the topic (since there is no way to know
>>> which topics are in which files in an uninstalled package). The *only*
>>> reason to use these forms for base and recommended packages is to
>>> force a reference to a package that might be further down the search
>>> path. Because they have been frequently misused, as from R 2.10.0 the
>>> HTML help system will look for topic foo in package pkg if it does not
>>> find file foo.html."
>>> 
>>> 
>>> Trying to summarize the above, do we have the following markups/rules?
>>> 
>>> A. \link{<topic>} - where <topic> must occur as an \alias{<topic>},
>>> but not necessarily as an \name{<topic>}.  The link will be display as
>>> the string <topic>.
>>> B. \link[=<topic>]{<name>} - where <topic> must occur as an
>>> \alias{<topic>} with a \name{<name>}.  The link will be display as the
>>> string <name>.
>>> C. \link{<packageName>]{<name>} - where <name> must be a \name{<name>}
>>> in a package named <packageName>.  The link will be display as the
>>> string <name>.
>>> D. \link{<packageName>:<name>]{<label>} - where <name> must be a
>>> \name{<name>} in a package named <packageName>.  The link will be
>>> display as the string <label>.  There are no restrictions on <label>.
>>> E. \linkS4class{<className>} expands to
>>> \link[=<className>-class]{<className>}.  From (B) it then follows that
>>> there must be an \alias{<className>-class} and a \name{<className>}.
>>> 
>>> 
>>> Q1. Is that correct?  To me it look a bit inconsistent.
>> 
>> No, \name{} is irrelevant for links.  It's the filename that matters in the 
>> 3rd form.
>> 
>>> 
>>> Q2. Are there more?
>>> 
>>> Q3. Will there be more?
>>> 
>>> Q4. What about
>>> 
>>> \link[=<topic>]{<label>}
>>> \link{<packageName>:<topic>]{<label>}
>>> 
>>> where <label> can be (almost) any string?
>> 
>> The first is what the 2nd form refers to.  "Name" there is what is 
>> displayed in the file making the link.
>> 
>> The second is new, as of 2.10.0, and is the fallback if a filename matching 
>> <topic> is not found.
>>> 
>>> Q4. Are (A) and (B) only supposed to be used for linking within a
>>> package, or can it be used to link to "wherever" <topic> exist?
>> 
>> They should work anywhere.  The difficulty arises if you link to something 
>> that a user doesn't have installed, or if the link is ambiguous.
>> 
>>> Q5. It sounds that (C) and (D) should be avoided.  Is that correct?
>> 
>> I think good practice is to make sure that the base of the filename (less 
>> .Rd) is also an alias in the file, and also the \name{} of the file.  The 
>> system would probably be less confusing if this were forced, but there are 
>> lots of files out there where it's not true.
>> 
>> You want the filename to be an alias because links sometimes go to aliases 
>> and sometimes to filenames; you want the name to match because that's what 
>> is displayed at the top of the page, so people might remember "just go to 
>> the Foo man page".
>> 
>>> Q6. What if <topic> exist in two packages 'pkgA' and 'pkgB' and I want
>>> to specify that I mean topic <topic> of package 'pkgA', cf namespaces
>>> and pkgA::foo()?
>> 
>> If you follow the good practice above, then use \link[pkgA]{topic}.  If you 
>> don't follow that practice, you may be out of luck, because R will look for 
>> the filename topic.Rd in pkgA, not \alias{topic}.  However, as of 2.10.0, 
>> it will fall back to the latter.
>> 
>>> Q7. I the 1st paragraph above it says "(possibly in another package)"
>>> and in the 3rd paragraph above it is mentioned at "The only reason to
>>> use these forms [...] is to force a reference to a package that might
>>> be further down the search path" - is that the answer to Q4?  Will
>>> \link{<topic>} be *dynamically* linked to whatever comes first on the
>>> search() path - to reflect the running environment rather than the
>>> intention of the document?
>> 
>> In 2.10.0, I believe this will be the case (but I'd have to check the code 
>> to be sure).  I'd recommend being explicit if you are worried about this 
>> possibility.
>> 
>> 
>>> Reading between the lines, the development of Rd looks exiting.
>>> Instead of 2nd guessing where we are heading, could someone in charge
>>> please give some thoughts on what the plans are and an estimate on how
>>> long it will take before we are there - what R version?
>> 
>> I don't think there's really someone "in charge", but I've been closely 
>> involved with this, so I'll give some thoughts.
>> 
>> Generally speaking, we have releases on a regular schedule, we don't hold 
>> them up for particular features.  So I don't think it would be possible to 
>> figure out when development on Rd files will be done.  It depends on when 
>> people have the time to do what they think needs doing, and to a large 
>> extent, that depends on how things get used.
>> 
>> Some things that are not there now, but which might be there in the future 
>> (i.e. later than 2.10.0):
>> 
>> - Better support for the \Sexpr macros (which let the content of man pages 
>> depend on R code, executed just before rendering).  Right now there's no 
>> special support for that R code; it would make sense to define some 
>> functions to make writing such stuff easier.  (This is something that could 
>> be done in a contributed package, it needn't be in base R.)
>> 
>> - Improved prompt() and package.skeleton() functions to take advantage of 
>> the above.
>> 
>> - Graphs in man pages.
>> 
>> - Ways to link from man pages to vignettes.  The reverse would be nice, but 
>> it's not possible with the current design, so that would be far off.
>> 
>> - Some general rationalization of the whole help system.
>> 
>> Duncan Murdoch
>> 
>>> 
>>> MISC:
>>> I understand that \link[=<className>-class]{<className>} is part of
>>> standard Rd conventions, but to the best of my knowledge
>>> \link[=<className>.class]{<className>} is not, correct?  I would like
>>> to suggest to write a separate paragraph for S4 classes without
>>> mentioning S3 classes.  The following also adds to the confusion -
>>> there exists one Rd page with \name{terms} and one with
>>> \name{terms.object}, so it is not really clear what
>>> \link[=terms.object]{terms} is strictly supposed to do - is it of form
>>> \link[=<topic>]{<name>} or \link[=<topic>]{<label>}.  Maybe it is
>>> helpful to clarify what the static/dynamic link will be and what will
>>> be display.
>>> 
>>> Thanks
>>> 
>>> Henrik
>>> 
>>> PS. This is related to today's (Sept 23, 2009) BioConductor posts by
>>> Gordon Smyth - "[Bioc-devel] BioC 2.5: "suspect" interpackage links";
>>> https://stat.ethz.ch/pipermail/bioc-devel/2009-September/001975.html
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> 
>


From seth at userprimary.net  Tue Sep 29 04:36:02 2009
From: seth at userprimary.net (Seth Falcon)
Date: Mon, 28 Sep 2009 19:36:02 -0700
Subject: [Rd] build time dependency
In-Reply-To: <4AC0FF86.6000504@dbmail.com>
References: <4ABC8E7C.2060004@dbmail.com>
	<4ABFAEAE.2030103@statistik.tu-dortmund.de>
	<4AC06218.4010802@dbmail.com>
	<4AC0CA8A.40500@statistik.tu-dortmund.de>
	<4AC0FF86.6000504@dbmail.com>
Message-ID: <486f230c0909281936t38ed0ad8jf3c7632de33bf8fb@mail.gmail.com>

On Mon, Sep 28, 2009 at 11:25 AM, Romain Francois
<romain.francois at dbmail.com> wrote:
> Hi Uwe,
>
> I think you are supposed to do this kind of sequence:
>
> R CMD roxygen yourRoxygenablePackage
> R CMD build yourRoxygenablePackage_roxygen
>
> ... but I don't like this because what you upload to cran is not the actual
> source but somethingalready pre-processed. (This also applies to packages
> shipping java code, most people just compile the java code on their machine
> and only supply a jar of compiled code, but that's another story I suppose
> ...)
>
> I'd prefer the roxygenation to be part of the standard build/INSTALL system,
> so my plan is to write configure and configure.win which would call
> roxygenize to generate Rd.

I can appreciate the desire to make the "true" sources available.  At
the same time, I think one should very carefully consider the expense
of external dependencies on a package.

One could view doc generation along the same lines as configure script
generation -- a compilation step that can be done once instead of by
all those who install and as a result reduce the depencency burden of
those wanting to install the package.  Configure scripts are almost
universally included pre-built in distribution source packages so that
users do not need to have the right version of autoconf/automake.

In other words, are you sure you want to require folks to install
roxygen (or whatever) in order to install your package? Making it easy
to do so is great, but in general if you can find a way to reduce
dependencies and have your package work, that is better. :-)

+ seth

-- 
Seth Falcon | @sfalcon | http://userprimary.net/user


From romain.francois at dbmail.com  Tue Sep 29 09:13:44 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Tue, 29 Sep 2009 09:13:44 +0200
Subject: [Rd] build time dependency
In-Reply-To: <486f230c0909281936t38ed0ad8jf3c7632de33bf8fb@mail.gmail.com>
References: <4ABC8E7C.2060004@dbmail.com>	
	<4ABFAEAE.2030103@statistik.tu-dortmund.de>	
	<4AC06218.4010802@dbmail.com>	
	<4AC0CA8A.40500@statistik.tu-dortmund.de>	
	<4AC0FF86.6000504@dbmail.com>
	<486f230c0909281936t38ed0ad8jf3c7632de33bf8fb@mail.gmail.com>
Message-ID: <4AC1B3A8.5090902@dbmail.com>

On 09/29/2009 04:36 AM, Seth Falcon wrote:
>
> On Mon, Sep 28, 2009 at 11:25 AM, Romain Francois
> <romain.francois at dbmail.com>  wrote:
>> Hi Uwe,
>>
>> I think you are supposed to do this kind of sequence:
>>
>> R CMD roxygen yourRoxygenablePackage
>> R CMD build yourRoxygenablePackage_roxygen
>>
>> ... but I don't like this because what you upload to cran is not the actual
>> source but somethingalready pre-processed. (This also applies to packages
>> shipping java code, most people just compile the java code on their machine
>> and only supply a jar of compiled code, but that's another story I suppose
>> ...)
>>
>> I'd prefer the roxygenation to be part of the standard build/INSTALL system,
>> so my plan is to write configure and configure.win which would call
>> roxygenize to generate Rd.
>
> I can appreciate the desire to make the "true" sources available.  At
> the same time, I think one should very carefully consider the expense
> of external dependencies on a package.
>
> One could view doc generation along the same lines as configure script
> generation -- a compilation step that can be done once instead of by
> all those who install and as a result reduce the depencency burden of
> those wanting to install the package.  Configure scripts are almost
> universally included pre-built in distribution source packages so that
> users do not need to have the right version of autoconf/automake.

The kind of configure[.win] scripts I am using are very simplistic and 
do not come from autoconf, etc ...

something like this to compile the java source code using the ant package :

#!/bin/bash
cd inst/java_src
"${R_HOME}/bin/Rscript" -e "ant::ant()"

> In other words, are you sure you want to require folks to install
> roxygen (or whatever) in order to install your package? Making it easy
> to do so is great, but in general if you can find a way to reduce
> dependencies and have your package work, that is better. :-)

That is exactly what I am trying to do here, those who build the package 
are not necessarily the same as those who install it, so installation 
would not depend on roxygen. And Uwe is very right that what I am 
looking for is indeed __build__ time rather than __install__ time.

> + seth
>


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/ztCu : RGG #158:161: examples of package IDPmisc
|- http://tr.im/yw8E : New R package : sos
`- http://tr.im/y8y0 : search the graph gallery from R


From ligges at statistik.tu-dortmund.de  Tue Sep 29 10:03:56 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 29 Sep 2009 10:03:56 +0200
Subject: [Rd] Downloading R-2.10.0
In-Reply-To: <971536df0909281659i3e62fe17pe65efb59a68c98c5@mail.gmail.com>
References: <971536df0909281659i3e62fe17pe65efb59a68c98c5@mail.gmail.com>
Message-ID: <4AC1BF6C.4020001@statistik.tu-dortmund.de>

Duncan is travelling and may not yet have updated his scripts to make 
alpha versions available (rather than R-devel), please be patient.

Best,
Uwe Ligges



Gabor Grothendieck wrote:
> For Windows, this page
> 
> http://cran.r-project.org/bin/windows/base/
> 
> gives a link to download
> 
> - R 2.9.2
> - r-patched (R 2.9.2 patched)
> - old releases and
> - r-devel (R 2.11.0)
> 
> but there is no obvious link to R 2.10.0.  From where do we download that?
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Tue Sep 29 10:10:55 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 29 Sep 2009 10:10:55 +0200
Subject: [Rd] build time dependency
In-Reply-To: <4AC1B3A8.5090902@dbmail.com>
References: <4ABC8E7C.2060004@dbmail.com>	
	<4ABFAEAE.2030103@statistik.tu-dortmund.de>	
	<4AC06218.4010802@dbmail.com>	
	<4AC0CA8A.40500@statistik.tu-dortmund.de>	
	<4AC0FF86.6000504@dbmail.com>
	<486f230c0909281936t38ed0ad8jf3c7632de33bf8fb@mail.gmail.com>
	<4AC1B3A8.5090902@dbmail.com>
Message-ID: <4AC1C10F.5010706@statistik.tu-dortmund.de>



Romain Francois wrote:
> On 09/29/2009 04:36 AM, Seth Falcon wrote:
>>
>> On Mon, Sep 28, 2009 at 11:25 AM, Romain Francois
>> <romain.francois at dbmail.com>  wrote:
>>> Hi Uwe,
>>>
>>> I think you are supposed to do this kind of sequence:
>>>
>>> R CMD roxygen yourRoxygenablePackage
>>> R CMD build yourRoxygenablePackage_roxygen
>>>
>>> ... but I don't like this because what you upload to cran is not the 
>>> actual
>>> source but somethingalready pre-processed. (This also applies to 
>>> packages
>>> shipping java code, most people just compile the java code on their 
>>> machine
>>> and only supply a jar of compiled code, but that's another story I 
>>> suppose
>>> ...)
>>>
>>> I'd prefer the roxygenation to be part of the standard build/INSTALL 
>>> system,
>>> so my plan is to write configure and configure.win which would call
>>> roxygenize to generate Rd.
>>
>> I can appreciate the desire to make the "true" sources available.  At
>> the same time, I think one should very carefully consider the expense
>> of external dependencies on a package.
>>
>> One could view doc generation along the same lines as configure script
>> generation -- a compilation step that can be done once instead of by
>> all those who install and as a result reduce the depencency burden of
>> those wanting to install the package.  Configure scripts are almost
>> universally included pre-built in distribution source packages so that
>> users do not need to have the right version of autoconf/automake.
> 
> The kind of configure[.win] scripts I am using are very simplistic and 
> do not come from autoconf, etc ...
> 
> something like this to compile the java source code using the ant package :
> 
> #!/bin/bash
> cd inst/java_src
> "${R_HOME}/bin/Rscript" -e "ant::ant()"
> 
>> In other words, are you sure you want to require folks to install
>> roxygen (or whatever) in order to install your package? Making it easy
>> to do so is great, but in general if you can find a way to reduce
>> dependencies and have your package work, that is better. :-)
> 
> That is exactly what I am trying to do here, those who build the package 
> are not necessarily the same as those who install it, so installation 
> would not depend on roxygen. And Uwe is very right that what I am 
> looking for is indeed __build__ time rather than __install__ time.

I think you should talk to Manuel whose intention really was the usage 
you mentioned above (i.e. before or at build time).

Best,
Uwe





>> + seth
>>
> 
>


From linera27 at yahoo.co.uk  Tue Sep 29 10:51:21 2009
From: linera27 at yahoo.co.uk (Lina Rusyte)
Date: Tue, 29 Sep 2009 08:51:21 +0000 (GMT)
Subject: [Rd] Probability of data values form empirical distribution
Message-ID: <309428.7552.qm@web25607.mail.ukl.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090929/05145757/attachment.pl>

From jpnolan at american.edu  Tue Sep 29 14:37:10 2009
From: jpnolan at american.edu (John Nolan)
Date: Tue, 29 Sep 2009 08:37:10 -0400
Subject: [Rd] Probability of data values form empirical distribution
In-Reply-To: <309428.7552.qm@web25607.mail.ukl.yahoo.com>
References: <309428.7552.qm@web25607.mail.ukl.yahoo.com>
Message-ID: <OF18B03B4B.DC73C54F-ON85257640.00455227-85257640.00455228@american.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090929/e4e62b0d/attachment.pl>

From abhibera at gmail.com  Tue Sep 29 16:28:57 2009
From: abhibera at gmail.com (Abhijit Bera)
Date: Tue, 29 Sep 2009 19:28:57 +0500
Subject: [Rd] How do I access class slots from C?
Message-ID: <fc212e850909290728j1f3a305bkf82db6dfcd42d8a9@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090929/752efe49/attachment.pl>

From romain.francois at dbmail.com  Tue Sep 29 16:52:17 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Tue, 29 Sep 2009 16:52:17 +0200
Subject: [Rd] How do I access class slots from C?
In-Reply-To: <fc212e850909290728j1f3a305bkf82db6dfcd42d8a9@mail.gmail.com>
References: <fc212e850909290728j1f3a305bkf82db6dfcd42d8a9@mail.gmail.com>
Message-ID: <4AC21F21.8030604@dbmail.com>


Hi,

There is a GET_SLOT macro in Rdefines.h

Cheers,

Romain

On 09/29/2009 04:28 PM, Abhijit Bera wrote:
>
> Hi
>
> I'm trying to implement something similar to the following R snippet using
> C. I seem to have hit the wall on accessing class slots using C.
>
> library(fPortfolio)
>
> lppData<- 100 * LPP2005.RET[, 1:6]
> ewSpec<- portfolioSpec()
> nAssets<- ncol(lppData)
> setWeights(ewSpec)<- rep(1/nAssets, times = nAssets)
>
> ewPortfolio<- feasiblePortfolio(
>     data = lppData,
>     spec = ewSpec,
>     constraints = "LongOnly")
>
> ewSpec is an object of type Portfolio Spec which has the following slots:
>
> model slot
>      type = "MV"                  a string value
>      optimize = "minRisk"         a string value
>      estimator = "covEstimator"   a function name
>      tailRisk = list()            a list
>      params =
>        list(alpha=0.05, a=1, ...) a list
> portfolio slot                   a list
>      weights = NULL               a numeric vector
>      targetReturn = NULL          a numeric value
>      targetRisk = NULL            a numeric value
>      riskFreeRate = 0             a numeric value
>      nFrontierPoints = 50         an integer value
>      status = NA)                 a integer value
> optim slot                       a list
>      solver = "solveRquadprog"    a function names
>      objective = NULL             function names
>      options = list()             a list with parameters
>      control = list()             a list with controls
>      trace = FALSE)               a logical
> messages slot:                   a list
>      list = list()                a list
>
> I want to set the weights so that I can compute a feasiblePortfolio.
> Unfortunately I cannot figure out how to do this from C.
>
> Here is what I wrote so far:
>
> #include<stdio.h>
> #include<R.h>
> #include<Rinternals.h>
> #include<Rdefines.h>
> #include<Rembedded.h>
>
> int main(int argc, char** argv)
> {
>
>      SEXP
> e,c,portSpec,portData,portConstr,portVal,portWeights,tsAssets,tsReturns,nAssets,reciprocal;
>      int errorOccurred,nx,ny,i,j;
>      double *v;
>      const char *x,*y;
>
>      Rf_initEmbeddedR(argc, argv);
>
>      // loading fPortfolio
>      PROTECT(e = lang2(install("library"), mkString("fPortfolio")));
>      R_tryEval(e, R_GlobalEnv, NULL);
>      UNPROTECT(1);
>
>
>      // creating a default portfolioSpec object
>      PROTECT(e=lang1(install("portfolioSpec")));
>      PROTECT(portSpec=R_tryEval(e,R_GlobalEnv, NULL));
>
>      // creating a portfolioData object
>
>
> PROTECT(e=lang4(install("c"),mkString("SBI"),mkString("SPI"),mkString("SII")));
>      PROTECT(tsAssets=R_tryEval(e,R_GlobalEnv,NULL));
>
>      PROTECT(e=lang4(install("["),install("SWX.RET"),R_MissingArg,tsAssets));
>      PROTECT(tsReturns=R_tryEval(e,R_GlobalEnv,NULL));
>
>      PROTECT(e=lang3(install("*"),ScalarInteger(100),tsReturns));
>      PROTECT(tsReturns=R_tryEval(e,R_GlobalEnv,NULL));
>
>      PROTECT(e=lang3(install("portfolioData"),tsReturns,portSpec));
>      PROTECT(portData=R_tryEval(e,R_GlobalEnv,NULL));
>
> // Creating a portfolio constraints string
>      PROTECT(portConstr=mkString("LongOnly"));
>
> // Setting weights
>      PROTECT(e=lang2(install("ncol"),tsReturns));
>      PROTECT(nAssets=R_tryEval(e,R_GlobalEnv,NULL));
>
>      PROTECT(e=lang3(install("/"),ScalarInteger(1),nAssets));
>      PROTECT(reciprocal=R_tryEval(e,R_GlobalEnv,NULL));
>
>      PROTECT(e=lang3(install("rep"),reciprocal,nAssets));
>      PROTECT(portWeights=R_tryEval(e,R_GlobalEnv,NULL));
>
> // Right now the program crashes here. It says: Cannot find function
> "setWeights"
> // How do I set the weights? It's a standard numeric vector. I'm confused on
> access class slots from C.
> // Not much is writted on this in the R extensions manual.
>
>      PROTECT(e=lang3(install("setWeights"),portSpec,portWeights));
>      PROTECT(portSpec=R_tryEval(e,R_GlobalEnv,NULL));
>
>      PROTECT(e=lang2(install("print"),portSpec));
>      R_tryEval(e,R_GlobalEnv,NULL);
>
>      UNPROTECT(3);
>
>      Rf_endEmbeddedR(0);
>
>      return 0;
> }
>
> Regards
> Abhijit Bera


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/ztCu : RGG #158:161: examples of package IDPmisc
|- http://tr.im/yw8E : New R package : sos
`- http://tr.im/y8y0 : search the graph gallery from R


From mrashid_9 at hotmail.com  Tue Sep 29 16:39:27 2009
From: mrashid_9 at hotmail.com (Mamun Rashid)
Date: Tue, 29 Sep 2009 14:39:27 +0000
Subject: [Rd] Problem installing RMAGEML package
Message-ID: <COL109-W44ABF7D5880A8685BF1E76C1D50@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090929/40721e0b/attachment.pl>

From simon.urbanek at r-project.org  Tue Sep 29 17:52:23 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 29 Sep 2009 11:52:23 -0400
Subject: [Rd] How do I access class slots from C?
In-Reply-To: <fc212e850909290728j1f3a305bkf82db6dfcd42d8a9@mail.gmail.com>
References: <fc212e850909290728j1f3a305bkf82db6dfcd42d8a9@mail.gmail.com>
Message-ID: <2C3C1E09-AF03-4F6F-B6C4-D5D4B8CA607A@r-project.org>

Abhijit,

as for your subject - it's GET_SLOT,
but why don't you just use ParseVector and eval instead of hand- 
crafting C code that calls the evaluator? That latter is way more  
error prone and the error-handling is a nightmare (your current code  
is inefficient anyway so you don't gain anything).

As for setWeights, you got the code wrong - if you want to mimic the R  
code then it's a call to the assignment "<-" - have a look at the  
parse result of
"setWeights(ewSpec) <- rep(1/nAssets, times = nAssets)":

   @d58774 06 LANGSXP g0c0 []
     @809008 01 SYMSXP g1c0 [MARK,gp=0x4000] "<-"
     @d59540 06 LANGSXP g0c0 []
       @1a1af34 01 SYMSXP g0c0 [] "setWeights"
       @d59498 01 SYMSXP g0c0 [] "ewSpec"
     @d58720 06 LANGSXP g0c0 []
       @814ac4 01 SYMSXP g1c0 [MARK,gp=0x4000] "rep"
       @d595b0 06 LANGSXP g0c0 []
	@80ae44 01 SYMSXP g1c0 [MARK,gp=0x4000] "/"
	@1bf8ce8 14 REALSXP g0c1 [] (len=1, tl=0) 1
	@1dbf1ac 01 SYMSXP g0c0 [MARK] "nAssets"
       TAG: @9450fc 01 SYMSXP g1c0 [MARK] "times"
       @1dbf1ac 01 SYMSXP g0c0 [MARK] "nAssets"

Again, I think you would be far better off just using parse instead...

Cheers,
Simon

PS: Your PROTECTs are way off-balance, and you don't need almost any  
of them - langX and listX protect all arguments

On Sep 29, 2009, at 10:28 , Abhijit Bera wrote:

> Hi
>
> I'm trying to implement something similar to the following R snippet  
> using
> C. I seem to have hit the wall on accessing class slots using C.
>
> library(fPortfolio)
>
> lppData <- 100 * LPP2005.RET[, 1:6]
> ewSpec <- portfolioSpec()
> nAssets <- ncol(lppData)
> setWeights(ewSpec) <- rep(1/nAssets, times = nAssets)
>
> ewPortfolio <- feasiblePortfolio(
>   data = lppData,
>   spec = ewSpec,
>   constraints = "LongOnly")
>
> ewSpec is an object of type Portfolio Spec which has the following  
> slots:
>
> model slot
>    type = "MV"                  a string value
>    optimize = "minRisk"         a string value
>    estimator = "covEstimator"   a function name
>    tailRisk = list()            a list
>    params =
>      list(alpha=0.05, a=1, ...) a list
> portfolio slot                   a list
>    weights = NULL               a numeric vector
>    targetReturn = NULL          a numeric value
>    targetRisk = NULL            a numeric value
>    riskFreeRate = 0             a numeric value
>    nFrontierPoints = 50         an integer value
>    status = NA)                 a integer value
> optim slot                       a list
>    solver = "solveRquadprog"    a function names
>    objective = NULL             function names
>    options = list()             a list with parameters
>    control = list()             a list with controls
>    trace = FALSE)               a logical
> messages slot:                   a list
>    list = list()                a list
>
> I want to set the weights so that I can compute a feasiblePortfolio.
> Unfortunately I cannot figure out how to do this from C.
>
> Here is what I wrote so far:
>
> #include <stdio.h>
> #include <R.h>
> #include <Rinternals.h>
> #include <Rdefines.h>
> #include <Rembedded.h>
>
> int main(int argc, char** argv)
> {
>
>    SEXP
> e 
> ,c 
> ,portSpec 
> ,portData 
> ,portConstr,portVal,portWeights,tsAssets,tsReturns,nAssets,reciprocal;
>    int errorOccurred,nx,ny,i,j;
>    double *v;
>    const char *x,*y;
>
>    Rf_initEmbeddedR(argc, argv);
>
>    // loading fPortfolio
>    PROTECT(e = lang2(install("library"), mkString("fPortfolio")));
>    R_tryEval(e, R_GlobalEnv, NULL);
>    UNPROTECT(1);
>
>
>    // creating a default portfolioSpec object
>    PROTECT(e=lang1(install("portfolioSpec")));
>    PROTECT(portSpec=R_tryEval(e,R_GlobalEnv, NULL));
>
>    // creating a portfolioData object
>
>
> PROTECT 
> (e 
> =lang4(install("c"),mkString("SBI"),mkString("SPI"),mkString("SII")));
>    PROTECT(tsAssets=R_tryEval(e,R_GlobalEnv,NULL));
>
>     
> PROTECT 
> (e=lang4(install("["),install("SWX.RET"),R_MissingArg,tsAssets));
>    PROTECT(tsReturns=R_tryEval(e,R_GlobalEnv,NULL));
>
>    PROTECT(e=lang3(install("*"),ScalarInteger(100),tsReturns));
>    PROTECT(tsReturns=R_tryEval(e,R_GlobalEnv,NULL));
>
>    PROTECT(e=lang3(install("portfolioData"),tsReturns,portSpec));
>    PROTECT(portData=R_tryEval(e,R_GlobalEnv,NULL));
>
> // Creating a portfolio constraints string
>    PROTECT(portConstr=mkString("LongOnly"));
>
> // Setting weights
>    PROTECT(e=lang2(install("ncol"),tsReturns));
>    PROTECT(nAssets=R_tryEval(e,R_GlobalEnv,NULL));
>
>    PROTECT(e=lang3(install("/"),ScalarInteger(1),nAssets));
>    PROTECT(reciprocal=R_tryEval(e,R_GlobalEnv,NULL));
>
>    PROTECT(e=lang3(install("rep"),reciprocal,nAssets));
>    PROTECT(portWeights=R_tryEval(e,R_GlobalEnv,NULL));
>
> // Right now the program crashes here. It says: Cannot find function
> "setWeights"
> // How do I set the weights? It's a standard numeric vector. I'm  
> confused on
> access class slots from C.
> // Not much is writted on this in the R extensions manual.
>
>    PROTECT(e=lang3(install("setWeights"),portSpec,portWeights));
>    PROTECT(portSpec=R_tryEval(e,R_GlobalEnv,NULL));
>
>    PROTECT(e=lang2(install("print"),portSpec));
>    R_tryEval(e,R_GlobalEnv,NULL);
>
>    UNPROTECT(3);
>
>    Rf_endEmbeddedR(0);
>
>    return 0;
> }
>
> Regards
> Abhijit Bera
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From mtmorgan at fhcrc.org  Tue Sep 29 18:17:51 2009
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Tue, 29 Sep 2009 09:17:51 -0700
Subject: [Rd] How do I access class slots from C?
In-Reply-To: <2C3C1E09-AF03-4F6F-B6C4-D5D4B8CA607A@r-project.org>
References: <fc212e850909290728j1f3a305bkf82db6dfcd42d8a9@mail.gmail.com>
	<2C3C1E09-AF03-4F6F-B6C4-D5D4B8CA607A@r-project.org>
Message-ID: <4AC2332F.2030108@fhcrc.org>

Simon Urbanek wrote:
> Abhijit,
> 
> as for your subject - it's GET_SLOT,
> but why don't you just use ParseVector and eval instead of hand-crafting 
> C code that calls the evaluator? That latter is way more error prone and 
> the error-handling is a nightmare (your current code is inefficient 
> anyway so you don't gain anything).

My 2 cents: constructing language calls seems much more appropriate than 
parsing expressions when the values to be used are from programming 
variables, as is likely the case in most real applications? And 
accessing slots with GET_SLOT seems to break the (hard-won) abstraction 
layer of S4, so better to call the R accessors (even when this is 
inefficient computationally) especially when using objects from packates 
whose internals you do not control.

One particular part of the code below

PROTECT(e=lang4(install("c"),mkString("SBI"),mkString("SPI"),mkString("SII"))); 


could be re-written as

   SEXP x = PROTECT(NEW_CHARACTER(3));
   SET_STRING_ELT(x, 0, mkChar("SBI"));
   etc

In the original, although the outer PROTECT is unnecessary, I wonder 
about the mString()... calls, which are not guaranteed to be evaluated 
in order and produce unprotected CHARSXPs (prior to being protected 
inside lang4). I'm not really sure about the mkChar() in the above, 
either, and whether there is an opportunity for garbage collection in 
SET_VECTOR_ELT.

Martin

> 
> As for setWeights, you got the code wrong - if you want to mimic the R 
> code then it's a call to the assignment "<-" - have a look at the parse 
> result of
> "setWeights(ewSpec) <- rep(1/nAssets, times = nAssets)":
> 
>   @d58774 06 LANGSXP g0c0 []
>     @809008 01 SYMSXP g1c0 [MARK,gp=0x4000] "<-"
>     @d59540 06 LANGSXP g0c0 []
>       @1a1af34 01 SYMSXP g0c0 [] "setWeights"
>       @d59498 01 SYMSXP g0c0 [] "ewSpec"
>     @d58720 06 LANGSXP g0c0 []
>       @814ac4 01 SYMSXP g1c0 [MARK,gp=0x4000] "rep"
>       @d595b0 06 LANGSXP g0c0 []
>     @80ae44 01 SYMSXP g1c0 [MARK,gp=0x4000] "/"
>     @1bf8ce8 14 REALSXP g0c1 [] (len=1, tl=0) 1
>     @1dbf1ac 01 SYMSXP g0c0 [MARK] "nAssets"
>       TAG: @9450fc 01 SYMSXP g1c0 [MARK] "times"
>       @1dbf1ac 01 SYMSXP g0c0 [MARK] "nAssets"
> 
> Again, I think you would be far better off just using parse instead...
> 
> Cheers,
> Simon
> 
> PS: Your PROTECTs are way off-balance, and you don't need almost any of 
> them - langX and listX protect all arguments
> 
> On Sep 29, 2009, at 10:28 , Abhijit Bera wrote:
> 
>> Hi
>>
>> I'm trying to implement something similar to the following R snippet 
>> using
>> C. I seem to have hit the wall on accessing class slots using C.
>>
>> library(fPortfolio)
>>
>> lppData <- 100 * LPP2005.RET[, 1:6]
>> ewSpec <- portfolioSpec()
>> nAssets <- ncol(lppData)
>> setWeights(ewSpec) <- rep(1/nAssets, times = nAssets)
>>
>> ewPortfolio <- feasiblePortfolio(
>>   data = lppData,
>>   spec = ewSpec,
>>   constraints = "LongOnly")
>>
>> ewSpec is an object of type Portfolio Spec which has the following slots:
>>
>> model slot
>>    type = "MV"                  a string value
>>    optimize = "minRisk"         a string value
>>    estimator = "covEstimator"   a function name
>>    tailRisk = list()            a list
>>    params =
>>      list(alpha=0.05, a=1, ...) a list
>> portfolio slot                   a list
>>    weights = NULL               a numeric vector
>>    targetReturn = NULL          a numeric value
>>    targetRisk = NULL            a numeric value
>>    riskFreeRate = 0             a numeric value
>>    nFrontierPoints = 50         an integer value
>>    status = NA)                 a integer value
>> optim slot                       a list
>>    solver = "solveRquadprog"    a function names
>>    objective = NULL             function names
>>    options = list()             a list with parameters
>>    control = list()             a list with controls
>>    trace = FALSE)               a logical
>> messages slot:                   a list
>>    list = list()                a list
>>
>> I want to set the weights so that I can compute a feasiblePortfolio.
>> Unfortunately I cannot figure out how to do this from C.
>>
>> Here is what I wrote so far:
>>
>> #include <stdio.h>
>> #include <R.h>
>> #include <Rinternals.h>
>> #include <Rdefines.h>
>> #include <Rembedded.h>
>>
>> int main(int argc, char** argv)
>> {
>>
>>    SEXP
>> e,c,portSpec,portData,portConstr,portVal,portWeights,tsAssets,tsReturns,nAssets,reciprocal; 
>>
>>    int errorOccurred,nx,ny,i,j;
>>    double *v;
>>    const char *x,*y;
>>
>>    Rf_initEmbeddedR(argc, argv);
>>
>>    // loading fPortfolio
>>    PROTECT(e = lang2(install("library"), mkString("fPortfolio")));
>>    R_tryEval(e, R_GlobalEnv, NULL);
>>    UNPROTECT(1);
>>
>>
>>    // creating a default portfolioSpec object
>>    PROTECT(e=lang1(install("portfolioSpec")));
>>    PROTECT(portSpec=R_tryEval(e,R_GlobalEnv, NULL));
>>
>>    // creating a portfolioData object
>>
>>
>> PROTECT(e=lang4(install("c"),mkString("SBI"),mkString("SPI"),mkString("SII"))); 
>>
>>    PROTECT(tsAssets=R_tryEval(e,R_GlobalEnv,NULL));
>>
>>    
>> PROTECT(e=lang4(install("["),install("SWX.RET"),R_MissingArg,tsAssets));
>>    PROTECT(tsReturns=R_tryEval(e,R_GlobalEnv,NULL));
>>
>>    PROTECT(e=lang3(install("*"),ScalarInteger(100),tsReturns));
>>    PROTECT(tsReturns=R_tryEval(e,R_GlobalEnv,NULL));
>>
>>    PROTECT(e=lang3(install("portfolioData"),tsReturns,portSpec));
>>    PROTECT(portData=R_tryEval(e,R_GlobalEnv,NULL));
>>
>> // Creating a portfolio constraints string
>>    PROTECT(portConstr=mkString("LongOnly"));
>>
>> // Setting weights
>>    PROTECT(e=lang2(install("ncol"),tsReturns));
>>    PROTECT(nAssets=R_tryEval(e,R_GlobalEnv,NULL));
>>
>>    PROTECT(e=lang3(install("/"),ScalarInteger(1),nAssets));
>>    PROTECT(reciprocal=R_tryEval(e,R_GlobalEnv,NULL));
>>
>>    PROTECT(e=lang3(install("rep"),reciprocal,nAssets));
>>    PROTECT(portWeights=R_tryEval(e,R_GlobalEnv,NULL));
>>
>> // Right now the program crashes here. It says: Cannot find function
>> "setWeights"
>> // How do I set the weights? It's a standard numeric vector. I'm 
>> confused on
>> access class slots from C.
>> // Not much is writted on this in the R extensions manual.
>>
>>    PROTECT(e=lang3(install("setWeights"),portSpec,portWeights));
>>    PROTECT(portSpec=R_tryEval(e,R_GlobalEnv,NULL));
>>
>>    PROTECT(e=lang2(install("print"),portSpec));
>>    R_tryEval(e,R_GlobalEnv,NULL);
>>
>>    UNPROTECT(3);
>>
>>    Rf_endEmbeddedR(0);
>>
>>    return 0;
>> }
>>
>> Regards
>> Abhijit Bera
>>
>>     [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From Heather.Turner at warwick.ac.uk  Tue Sep 29 18:40:24 2009
From: Heather.Turner at warwick.ac.uk (Heather Turner)
Date: Tue, 29 Sep 2009 17:40:24 +0100
Subject: [Rd] model.matrix troubles with AlgDesign
In-Reply-To: <25641680.post@talk.nabble.com>
References: <25641680.post@talk.nabble.com>
Message-ID: <4AC23878.50701@warwick.ac.uk>

Hi Ulrike,

It looks like 'aus' is created by fac.design(); is there any reason why
you can't add the variable
y <- 1:nrow(aus)
to this data frame and use y as the response in your formula?

Otherwise I think aus needs to be in the environment of frml (or frml
needs to be given the environment of aus).

Heather

Ulrike Groemping wrote:
> Dear DevelopeRs,
> 
> in continuing with my suite of packages on experimental design, I am stuck
> with an issue that appears to be related to package AlgDesign - I have tried
> to get it solved by Bob Wheeler, but he seems to be stuck as well. 
> 
> Whenever AlgDesign is loaded, some of my code does not work any more. For
> example, in a fresh R session: 
> 
> require(DoE.base)
> fac.design(nlevels=c(2,6,2))
> require(AlgDesign)
> fac.design(nlevels=c(2,6,2))
>> Error in nrow(aus) : object 'aus' not found 
> 
> The reason seems to be that AlgDesign creates a function
> model.matrix.formula that only finds variables that are in the global
> environment and variables that are in the data frame given with the formula,
> but not calculation results from the intermediate calling environment. 
> 
> Results from traceback():
> 9: nrow(aus)
> 8: eval(expr, envir, enclos)
> 7: eval(predvars, data, env)
> 6: model.frame.default(object, data, xlev = xlev)
> 5: model.frame(object, data, xlev = xlev)
> 4: model.matrix.default(frml, data, ...)
> 3: model.matrix.formula(1:nrow(aus) ~ ., data = aus)
> 2: model.matrix(1:nrow(aus) ~ ., data = aus)
> 1: fac.design(nlevels = c(2, 6, 2))
> 
> If I reset model.matrix.formula to model.matrix.default, the problem
> disappears (but AlgDesign's comfort functions for squares etc. do not work
> any longer). In this particular case, I can also avoid the issue by
> modifying the formula in fac.design, removing the left-hand side. But this
> just means to wait for the next place where troubles occur. Between 3 and 4
> of the traceback(), AlgDesign's function model.matrix.formula modifies the
> formula frml using AlgDesign's function expand.formula:
> 
> model.matrix.formula <- function (frml, data = sys.frame(sys.parent()), ...) 
> {
>     if (!missing(data)) {
>         if (!inherits(data, "data.frame")) 
>             stop("data must be a data.frame")
>         if (!inherits(frml, "formula")) 
>             stop("frml must be a formuls")
>         frml <- expand.formula(frml, colnames(data))
>     }
>     model.matrix.default(frml, data, ...)
> }
> 
> 
> I have looked at expand.formula as well, and I've been wondering whether a
> simple fix can be found by adding environment information (which?) within
> that function (I believe that the relevant portion of the code is included
> below):
> 
> expand.formula <- function (frml, varNames, const = TRUE, numerics = NULL) 
> {
> ## omitted quite a bit of code 
> ##...
>     frml <- deparse(frml, width = 500)
>     while ((0 != (pos <- findFunction("quad", frml))[1]) || (0 != 
>         (pos <- findFunction("cubicS", frml))[1]) || (0 != (pos <-
> findFunction("cubic", 
>         frml))[1])) {
>         prog <- substr(frml, pos[1], pos[2])
>         strHead <- substr(frml, 1, pos[1] - 1)
>         strTail <- substr(frml, pos[2] + 1, nchar(frml))
>         prog <- eval(parse(text = prog))
>         frml <- paste(strHead, prog, strTail, sep = "")
>     }
>     if (0 != (pos <- findDot(".", frml))[1]) {
>         strHead <- substr(frml, 1, pos[1] - 1)
>         strTail <- substr(frml, pos[2] + 1, nchar(frml))
>         prog <- eval(parse(text = "doDot()"))
>         frml <- paste(strHead, prog, strTail, sep = "")
>     }
>     if (!const) 
>         frml <- paste(frml, "+0", sep = "")
>     frml <- as.formula(frml)
>     frml
> }
> 
> Any help would be greatly appreciated.
> 
> Regards, Ulrike
>


From murdoch at stats.uwo.ca  Tue Sep 29 18:48:48 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 29 Sep 2009 12:48:48 -0400
Subject: [Rd] Downloading R-2.10.0
In-Reply-To: <4AC1BF6C.4020001@statistik.tu-dortmund.de>
References: <971536df0909281659i3e62fe17pe65efb59a68c98c5@mail.gmail.com>
	<4AC1BF6C.4020001@statistik.tu-dortmund.de>
Message-ID: <4AC23A70.9050704@stats.uwo.ca>

On 9/29/2009 4:03 AM, Uwe Ligges wrote:
> Duncan is travelling and may not yet have updated his scripts to make 
> alpha versions available (rather than R-devel), please be patient.

I'm back now, but stuck in a meeting all afternoon.  I should be able to 
get the builds started tonight, but there may be some glitches...

Duncan Murdoch

> 
> Best,
> Uwe Ligges
> 
> 
> 
> Gabor Grothendieck wrote:
>> For Windows, this page
>> 
>> http://cran.r-project.org/bin/windows/base/
>> 
>> gives a link to download
>> 
>> - R 2.9.2
>> - r-patched (R 2.9.2 patched)
>> - old releases and
>> - r-devel (R 2.11.0)
>> 
>> but there is no obvious link to R 2.10.0.  From where do we download that?
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From groemping at bht-berlin.de  Tue Sep 29 18:58:12 2009
From: groemping at bht-berlin.de (Ulrike Groemping)
Date: Tue, 29 Sep 2009 09:58:12 -0700 (PDT)
Subject: [Rd] model.matrix troubles with AlgDesign
In-Reply-To: <4AC23878.50701@warwick.ac.uk>
References: <25641680.post@talk.nabble.com> <4AC23878.50701@warwick.ac.uk>
Message-ID: <25666849.post@talk.nabble.com>


Hi Heather, 

thanks, I would be able to add the variable y <- 1:nrow(aus), I would even
be able to omit these. 
What concerns me is the fact that the presence of function
model.matrix.formula in package AlgDesign will stop model.matrix from
working as expected in further situations that I have not spotted yet. 

For the future development of package DoE.wrapper, I would like to include
AlgDesign in the Depends field, and that would mean that the package would
then stop user functions with perfectly valid code from working correctly.
So I would like to find a way to modify model.matrix.formula or
expand.formula from AlgDesign so that AlgDesign stops messing up usages of
model.matrix in other contexts. I think that the solution may perhaps lie in
assigning the right environment to frml in expand.formula, but I am not
familiar enough with assigning environments to know what the right strategy
would be.

Any suggestions ?

Regards, 
Ulrike



Heather Turner wrote:
> 
> Hi Ulrike,
> 
> It looks like 'aus' is created by fac.design(); is there any reason why
> you can't add the variable
> y <- 1:nrow(aus)
> to this data frame and use y as the response in your formula?
> 
> Otherwise I think aus needs to be in the environment of frml (or frml
> needs to be given the environment of aus).
> 
> Heather
> 
> Ulrike Groemping wrote:
>> Dear DevelopeRs,
>> 
>> in continuing with my suite of packages on experimental design, I am
>> stuck
>> with an issue that appears to be related to package AlgDesign - I have
>> tried
>> to get it solved by Bob Wheeler, but he seems to be stuck as well. 
>> 
>> Whenever AlgDesign is loaded, some of my code does not work any more. For
>> example, in a fresh R session: 
>> 
>> require(DoE.base)
>> fac.design(nlevels=c(2,6,2))
>> require(AlgDesign)
>> fac.design(nlevels=c(2,6,2))
>>> Error in nrow(aus) : object 'aus' not found 
>> 
>> The reason seems to be that AlgDesign creates a function
>> model.matrix.formula that only finds variables that are in the global
>> environment and variables that are in the data frame given with the
>> formula,
>> but not calculation results from the intermediate calling environment. 
>> 
>> Results from traceback():
>> 9: nrow(aus)
>> 8: eval(expr, envir, enclos)
>> 7: eval(predvars, data, env)
>> 6: model.frame.default(object, data, xlev = xlev)
>> 5: model.frame(object, data, xlev = xlev)
>> 4: model.matrix.default(frml, data, ...)
>> 3: model.matrix.formula(1:nrow(aus) ~ ., data = aus)
>> 2: model.matrix(1:nrow(aus) ~ ., data = aus)
>> 1: fac.design(nlevels = c(2, 6, 2))
>> 
>> If I reset model.matrix.formula to model.matrix.default, the problem
>> disappears (but AlgDesign's comfort functions for squares etc. do not
>> work
>> any longer). In this particular case, I can also avoid the issue by
>> modifying the formula in fac.design, removing the left-hand side. But
>> this
>> just means to wait for the next place where troubles occur. Between 3 and
>> 4
>> of the traceback(), AlgDesign's function model.matrix.formula modifies
>> the
>> formula frml using AlgDesign's function expand.formula:
>> 
>> model.matrix.formula <- function (frml, data = sys.frame(sys.parent()),
>> ...) 
>> {
>>     if (!missing(data)) {
>>         if (!inherits(data, "data.frame")) 
>>             stop("data must be a data.frame")
>>         if (!inherits(frml, "formula")) 
>>             stop("frml must be a formuls")
>>         frml <- expand.formula(frml, colnames(data))
>>     }
>>     model.matrix.default(frml, data, ...)
>> }
>> 
>> 
>> I have looked at expand.formula as well, and I've been wondering whether
>> a
>> simple fix can be found by adding environment information (which?) within
>> that function (I believe that the relevant portion of the code is
>> included
>> below):
>> 
>> expand.formula <- function (frml, varNames, const = TRUE, numerics =
>> NULL) 
>> {
>> ## omitted quite a bit of code 
>> ##...
>>     frml <- deparse(frml, width = 500)
>>     while ((0 != (pos <- findFunction("quad", frml))[1]) || (0 != 
>>         (pos <- findFunction("cubicS", frml))[1]) || (0 != (pos <-
>> findFunction("cubic", 
>>         frml))[1])) {
>>         prog <- substr(frml, pos[1], pos[2])
>>         strHead <- substr(frml, 1, pos[1] - 1)
>>         strTail <- substr(frml, pos[2] + 1, nchar(frml))
>>         prog <- eval(parse(text = prog))
>>         frml <- paste(strHead, prog, strTail, sep = "")
>>     }
>>     if (0 != (pos <- findDot(".", frml))[1]) {
>>         strHead <- substr(frml, 1, pos[1] - 1)
>>         strTail <- substr(frml, pos[2] + 1, nchar(frml))
>>         prog <- eval(parse(text = "doDot()"))
>>         frml <- paste(strHead, prog, strTail, sep = "")
>>     }
>>     if (!const) 
>>         frml <- paste(frml, "+0", sep = "")
>>     frml <- as.formula(frml)
>>     frml
>> }
>> 
>> Any help would be greatly appreciated.
>> 
>> Regards, Ulrike
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
View this message in context: http://www.nabble.com/model.matrix-troubles-with-AlgDesign-tp25641680p25666849.html
Sent from the R devel mailing list archive at Nabble.com.


From simon.urbanek at r-project.org  Tue Sep 29 19:00:05 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 29 Sep 2009 13:00:05 -0400
Subject: [Rd] How do I access class slots from C?
In-Reply-To: <4AC2332F.2030108@fhcrc.org>
References: <fc212e850909290728j1f3a305bkf82db6dfcd42d8a9@mail.gmail.com>
	<2C3C1E09-AF03-4F6F-B6C4-D5D4B8CA607A@r-project.org>
	<4AC2332F.2030108@fhcrc.org>
Message-ID: <F643067A-CF9C-45D3-8745-7341A0676896@r-project.org>

MArtin,

On Sep 29, 2009, at 12:17 , Martin Morgan wrote:

> Simon Urbanek wrote:
>> Abhijit,
>> as for your subject - it's GET_SLOT,
>> but why don't you just use ParseVector and eval instead of hand- 
>> crafting C code that calls the evaluator? That latter is way more  
>> error prone and the error-handling is a nightmare (your current  
>> code is inefficient anyway so you don't gain anything).
>
> My 2 cents: constructing language calls seems much more appropriate  
> than parsing expressions when the values to be used are from  
> programming variables, as is likely the case in most real  
> applications?

Yes, but not in this case - it's all just replication of a script that  
could be evaluated with one call, there are no native objects  
involved. As soon as you start using more than one eval in the C code,  
it is very likely not the right way to go. I do agree that constructed  
expressions are useful if you have a) a very short call that cannot be  
easily done at C level or b) it involves  unassigned objects generated  
in the C code -- but neither it the case here.


> And accessing slots with GET_SLOT seems to break the (hard-won)  
> abstraction layer of S4, so better to call the R accessors (even  
> when this is inefficient computationally) especially when using  
> objects from packates whose internals you do not control.
>

Agreed, again something that could be prevented with parse + eval ;).


> One particular part of the code below
>
> PROTECT 
> (e 
> =lang4(install("c"),mkString("SBI"),mkString("SPI"),mkString("SII")));
>
> could be re-written as
>
>  SEXP x = PROTECT(NEW_CHARACTER(3));
>  SET_STRING_ELT(x, 0, mkChar("SBI"));
>  etc
>
> In the original, although the outer PROTECT is unnecessary, I wonder  
> about the mString()... calls, which are not guaranteed to be  
> evaluated in order and produce unprotected CHARSXPs (prior to being  
> protected inside lang4). I'm not really sure about the mkChar() in  
> the above, either, and whether there is an opportunity for garbage  
> collection in SET_VECTOR_ELT.
>

CHARSXPs are always protected by enclosing STRSXP and  
SET_STRING_ELT(x, i, mkChar()) is always safe. And yes, the lang4 "c"  
construct is a bad idea.

Cheers,
Simon


>
>
>> As for setWeights, you got the code wrong - if you want to mimic  
>> the R code then it's a call to the assignment "<-" - have a look at  
>> the parse result of
>> "setWeights(ewSpec) <- rep(1/nAssets, times = nAssets)":
>>  @d58774 06 LANGSXP g0c0 []
>>    @809008 01 SYMSXP g1c0 [MARK,gp=0x4000] "<-"
>>    @d59540 06 LANGSXP g0c0 []
>>      @1a1af34 01 SYMSXP g0c0 [] "setWeights"
>>      @d59498 01 SYMSXP g0c0 [] "ewSpec"
>>    @d58720 06 LANGSXP g0c0 []
>>      @814ac4 01 SYMSXP g1c0 [MARK,gp=0x4000] "rep"
>>      @d595b0 06 LANGSXP g0c0 []
>>    @80ae44 01 SYMSXP g1c0 [MARK,gp=0x4000] "/"
>>    @1bf8ce8 14 REALSXP g0c1 [] (len=1, tl=0) 1
>>    @1dbf1ac 01 SYMSXP g0c0 [MARK] "nAssets"
>>      TAG: @9450fc 01 SYMSXP g1c0 [MARK] "times"
>>      @1dbf1ac 01 SYMSXP g0c0 [MARK] "nAssets"
>> Again, I think you would be far better off just using parse  
>> instead...
>> Cheers,
>> Simon
>> PS: Your PROTECTs are way off-balance, and you don't need almost  
>> any of them - langX and listX protect all arguments
>> On Sep 29, 2009, at 10:28 , Abhijit Bera wrote:
>>> Hi
>>>
>>> I'm trying to implement something similar to the following R  
>>> snippet using
>>> C. I seem to have hit the wall on accessing class slots using C.
>>>
>>> library(fPortfolio)
>>>
>>> lppData <- 100 * LPP2005.RET[, 1:6]
>>> ewSpec <- portfolioSpec()
>>> nAssets <- ncol(lppData)
>>> setWeights(ewSpec) <- rep(1/nAssets, times = nAssets)
>>>
>>> ewPortfolio <- feasiblePortfolio(
>>>  data = lppData,
>>>  spec = ewSpec,
>>>  constraints = "LongOnly")
>>>
>>> ewSpec is an object of type Portfolio Spec which has the following  
>>> slots:
>>>
>>> model slot
>>>   type = "MV"                  a string value
>>>   optimize = "minRisk"         a string value
>>>   estimator = "covEstimator"   a function name
>>>   tailRisk = list()            a list
>>>   params =
>>>     list(alpha=0.05, a=1, ...) a list
>>> portfolio slot                   a list
>>>   weights = NULL               a numeric vector
>>>   targetReturn = NULL          a numeric value
>>>   targetRisk = NULL            a numeric value
>>>   riskFreeRate = 0             a numeric value
>>>   nFrontierPoints = 50         an integer value
>>>   status = NA)                 a integer value
>>> optim slot                       a list
>>>   solver = "solveRquadprog"    a function names
>>>   objective = NULL             function names
>>>   options = list()             a list with parameters
>>>   control = list()             a list with controls
>>>   trace = FALSE)               a logical
>>> messages slot:                   a list
>>>   list = list()                a list
>>>
>>> I want to set the weights so that I can compute a feasiblePortfolio.
>>> Unfortunately I cannot figure out how to do this from C.
>>>
>>> Here is what I wrote so far:
>>>
>>> #include <stdio.h>
>>> #include <R.h>
>>> #include <Rinternals.h>
>>> #include <Rdefines.h>
>>> #include <Rembedded.h>
>>>
>>> int main(int argc, char** argv)
>>> {
>>>
>>>   SEXP
>>> e 
>>> ,c 
>>> ,portSpec 
>>> ,portData 
>>> ,portConstr 
>>> ,portVal,portWeights,tsAssets,tsReturns,nAssets,reciprocal;
>>>   int errorOccurred,nx,ny,i,j;
>>>   double *v;
>>>   const char *x,*y;
>>>
>>>   Rf_initEmbeddedR(argc, argv);
>>>
>>>   // loading fPortfolio
>>>   PROTECT(e = lang2(install("library"), mkString("fPortfolio")));
>>>   R_tryEval(e, R_GlobalEnv, NULL);
>>>   UNPROTECT(1);
>>>
>>>
>>>   // creating a default portfolioSpec object
>>>   PROTECT(e=lang1(install("portfolioSpec")));
>>>   PROTECT(portSpec=R_tryEval(e,R_GlobalEnv, NULL));
>>>
>>>   // creating a portfolioData object
>>>
>>>
>>> PROTECT 
>>> (e 
>>> = 
>>> lang4 
>>> (install("c"),mkString("SBI"),mkString("SPI"),mkString("SII")));
>>>   PROTECT(tsAssets=R_tryEval(e,R_GlobalEnv,NULL));
>>>
>>>    
>>> PROTECT 
>>> (e=lang4(install("["),install("SWX.RET"),R_MissingArg,tsAssets));
>>>   PROTECT(tsReturns=R_tryEval(e,R_GlobalEnv,NULL));
>>>
>>>   PROTECT(e=lang3(install("*"),ScalarInteger(100),tsReturns));
>>>   PROTECT(tsReturns=R_tryEval(e,R_GlobalEnv,NULL));
>>>
>>>   PROTECT(e=lang3(install("portfolioData"),tsReturns,portSpec));
>>>   PROTECT(portData=R_tryEval(e,R_GlobalEnv,NULL));
>>>
>>> // Creating a portfolio constraints string
>>>   PROTECT(portConstr=mkString("LongOnly"));
>>>
>>> // Setting weights
>>>   PROTECT(e=lang2(install("ncol"),tsReturns));
>>>   PROTECT(nAssets=R_tryEval(e,R_GlobalEnv,NULL));
>>>
>>>   PROTECT(e=lang3(install("/"),ScalarInteger(1),nAssets));
>>>   PROTECT(reciprocal=R_tryEval(e,R_GlobalEnv,NULL));
>>>
>>>   PROTECT(e=lang3(install("rep"),reciprocal,nAssets));
>>>   PROTECT(portWeights=R_tryEval(e,R_GlobalEnv,NULL));
>>>
>>> // Right now the program crashes here. It says: Cannot find function
>>> "setWeights"
>>> // How do I set the weights? It's a standard numeric vector. I'm  
>>> confused on
>>> access class slots from C.
>>> // Not much is writted on this in the R extensions manual.
>>>
>>>   PROTECT(e=lang3(install("setWeights"),portSpec,portWeights));
>>>   PROTECT(portSpec=R_tryEval(e,R_GlobalEnv,NULL));
>>>
>>>   PROTECT(e=lang2(install("print"),portSpec));
>>>   R_tryEval(e,R_GlobalEnv,NULL);
>>>
>>>   UNPROTECT(3);
>>>
>>>   Rf_endEmbeddedR(0);
>>>
>>>   return 0;
>>> }
>>>
>>> Regards
>>> Abhijit Bera
>>>
>>>    [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
> -- 
> Martin Morgan
> Computational Biology / Fred Hutchinson Cancer Research Center
> 1100 Fairview Ave. N.
> PO Box 19024 Seattle, WA 98109
>
> Location: Arnold Building M1 B861
> Phone: (206) 667-2793
>
>


From pleydell at supagro.inra.fr  Tue Sep 29 19:20:54 2009
From: pleydell at supagro.inra.fr (pleydell at supagro.inra.fr)
Date: Tue, 29 Sep 2009 19:20:54 +0200
Subject: [Rd] enabling core dumps
In-Reply-To: <20090923160726.qtfgqgygmbk0s44w@web.supagro.inra.fr>
References: <20090904173944.et305vc9gon4480c@web.supagro.inra.fr>
	<20090904174842.rj5qh6kk93k8wg0k@web.supagro.inra.fr>
	<20090904181122.15h3os7s249w0o04@web.supagro.inra.fr>
	<4AA14290.1060401@fhcrc.org>
	<20090923160726.qtfgqgygmbk0s44w@web.supagro.inra.fr>
Message-ID: <20090929192054.hgw8mw1egqsg0o0s@web.supagro.inra.fr>

> ... If I launch gdb this way I don't have any means to navigate through
> previously executed gdb lines using M-p and M-n, but following a
> (gdb) run
> or
> (gdb) continue
> I can use M-p and M-n to recall previous R commands
>
> If I launch gdb in other ways M-p and M-n function as expected. I 
> suppose there
> is a confusion between gdb's M-p and ESS's M-p so that M-p only functions in
> the ESS session.
>
> I quite like running gdb using R's -d flag, but not being able to navigate
> through the line history is sub-optimal. I'd be interested to hear if other
> people running gdb this way encountered this problem and how they 
> resolved it.

This had a one line solution (section 19.3, page 216, gdb manual)

gdb> set history save on


From edd at debian.org  Tue Sep 29 20:55:49 2009
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 29 Sep 2009 13:55:49 -0500
Subject: [Rd] How do I access class slots from C?
In-Reply-To: <fc212e850909290728j1f3a305bkf82db6dfcd42d8a9@mail.gmail.com>
References: <fc212e850909290728j1f3a305bkf82db6dfcd42d8a9@mail.gmail.com>
Message-ID: <19138.22581.659836.39730@ron.nulle.part>


This is so much fun.  The C code posted wasn't exactly legible.  So here is a
new C++ variant that I just committed to the RInside SVN as a new example.
And it mine works (against RInide and Rcpp as on CRAN):

edd at ron:~/svn/rinside/pkg/inst/examples> ./rinside_sample4
Package 'sn', 0.4-12 (2009-03-21). Type 'help(SN)' for summary information
Using the GLPK callable library version 4.37

Title:
 MV Feasible Portfolio 
 Estimator:         covEstimator 
 Solver:            solveRquadprog 
 Optimize:          minRisk 
 Constraints:       LongOnly 

Portfolio Weights:
SBI SPI SII LMI MPI ALT 
0.1 0.1 0.1 0.1 0.3 0.3 

Covariance Risk Budgets:
    SBI     SPI     SII     LMI     MPI     ALT 
-0.0038  0.1423  0.0125 -0.0058  0.4862  0.3686 

Target Return and Risks:
  mean     mu    Cov  Sigma   CVaR    VaR 
0.0548 0.0548 0.4371 0.4371 1.0751 0.6609 

Description:
 Tue Sep 29 13:43:36 2009 by user:  
             SBI	-0.00380065
             SPI	   0.142261
             SII	  0.0125242
             LMI	-0.00576251
             MPI	   0.486228
             ALT	   0.368551
edd at ron:~/svn/rinside/pkg/inst/examples> 

The final few lines are C++ accessing the result, earlier in the code I
assign the weight vector from C++ as you desired from C.  All with error
checking / exception handling and what have in under 60 lines of (IMHO more
readable) code -- see below.

Dirk

// -*- mode: C++; c-indent-level: 4; c-basic-offset: 4;  tab-width: 8; -*-
//
// Another simple example inspired by an r-devel mail by Abhijit Bera
//
// Copyright (C) 2009 Dirk Eddelbuettel and GPL'ed 

#include "RInside.h"                    // for the embedded R via RInside
#include "Rcpp.h"                       // for the R / Cpp interface used for transfer
#include <iomanip>

int main(int argc, char *argv[]) {

    try {
        RInside R(argc, argv);          // create an embedded R instance 
        SEXP ans;

        std::string txt = "suppressMessages(library(fPortfolio))";
        if (R.parseEvalQ(txt))          // load library, no return value
            throw std::runtime_error("R cannot evaluate '" + txt + "'");

        txt = "lppData <- 100 * LPP2005.RET[, 1:6]; "
	  "ewSpec <- portfolioSpec(); " 
	  "nAssets <- ncol(lppData); ";
        if (R.parseEval(txt, ans))      // prepare problem
            throw std::runtime_error("R cannot evaluate '" + txt + "'");
	
	const double dvec[6] = { 0.1, 0.1, 0.1, 0.1, 0.3, 0.3 }; // choose any weights you want
	const std::vector<double> w(dvec, &dvec[6]);

	R.assign( w, "weightsvec");	// assign STL vector to R's 'weightsvec' variable

	txt = "setWeights(ewSpec) <- weightsvec";
        if (R.parseEvalQ(txt))		// evaluate assignment
            throw std::runtime_error("R cannot evaluate '" + txt + "'");

	txt = "ewPortfolio <- feasiblePortfolio(data = lppData, spec = ewSpec, constraints = \"LongOnly\"); "
	  "print(ewPortfolio); "
	  "vec <- getCovRiskBudgets(ewPortfolio at portfolio)";
        if (R.parseEval(txt, ans))      // assign covRiskBudget weights to ans
            throw std::runtime_error("R cannot evaluate '" + txt + "'");
	RcppVector<double> V(ans);      // convert SEXP variable to an RcppMatrix
  
	R.parseEval("names(vec)", ans);	// assign columns names to ans
	RcppStringVector names(ans);   

	for (int i=0; i<names.size(); i++) {
	  std::cout << std::setw(16) << names(i) << "\t"
		    << std::setw(11) << V(i) << "\n";
        }
        
    } catch(std::exception& ex) {
        std::cerr << "Exception caught: " << ex.what() << std::endl;
    } catch(...) {
        std::cerr << "Unknown exception caught" << std::endl;
    }

    exit(0);
}



-- 
Three out of two people have difficulties with fractions.


From thomas.friedrichsmeier at ruhr-uni-bochum.de  Tue Sep 29 21:15:00 2009
From: thomas.friedrichsmeier at ruhr-uni-bochum.de (Thomas Friedrichsmeier)
Date: 29 Sep 2009 21:15:00 +0200
Subject: [Rd] Problems connecting to httpd help server with some browsers
Message-ID: <200909292115.04472.thomas.friedrichsmeier@ruhr-uni-bochum.de>

Hello, 

sorry to provide only very little testing, but with the release date nearing, 
I thought it better to report this quickly than to wait for an uncertain 
period until I find more time.

I'm observing strange problems connecting to the httpd help server with 
konqueror (KDE 4.3.1):

options (help_type="html")
options (browser="konqueror")
help ("print")

The first page opens in a konqueror window as expected. However, clicking on 
any links does not have any result. Konqueror just says "waiting for reply" 
forever. There does not even seem to be a timeout. Pointing the same browser 
instance to some other url works fine.

Trying to use lynx as a browser (since it's a terminal browser, you need open 
lynx in a separate terminal and point it to the httpd help server manually) 
causes lynx to become unresponsive.

Both konqueror and lynx are able to browse the static html files just fine.

Firefox and Opera work fine with the httpd server on the same computer.

Does anybody else see similar symptoms?

Regards
Thomas

> R.version
               _
platform       i686-pc-linux-gnu
arch           i686
os             linux-gnu
system         i686, linux-gnu
status         Under development (unstable)
major          2
minor          11.0
year           2009
month          09
day            29
svn rev        49866
language       R
version.string R version 2.11.0 Under development (unstable) (2009-09-29 
r49866)
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part.
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090929/92eb7e31/attachment.bin>

From Heather.Turner at warwick.ac.uk  Tue Sep 29 22:25:49 2009
From: Heather.Turner at warwick.ac.uk (Heather Turner)
Date: Tue, 29 Sep 2009 21:25:49 +0100
Subject: [Rd] model.matrix troubles with AlgDesign
In-Reply-To: <25666849.post@talk.nabble.com>
References: <25641680.post@talk.nabble.com> <4AC23878.50701@warwick.ac.uk>
	<25666849.post@talk.nabble.com>
Message-ID: <4AC26D4D.3010000@warwick.ac.uk>

Ah ok, I get the problem now.

I think you just need to modify model.matrix.formula as follows

 model.matrix.formula <- function (frml, data = sys.frame(sys.parent()),
 ...)
 {
     if (!missing(data)) {
         if (!inherits(data, "data.frame"))
             stop("data must be a data.frame")
         if (!inherits(frml, "formula"))
             stop("frml must be a formuls")
         env <- environment(frml)
         frml <- expand.formula(frml, colnames(data))
         environment(frml) <- env
     }
     model.matrix.default(frml, data, ...)
 }

or the equivalent could be done inside expand.formula, which might be
neater actually.

Hope that fixes it,

Heather

Ulrike Groemping wrote:
> Hi Heather, 
> 
> thanks, I would be able to add the variable y <- 1:nrow(aus), I would even
> be able to omit these. 
> What concerns me is the fact that the presence of function
> model.matrix.formula in package AlgDesign will stop model.matrix from
> working as expected in further situations that I have not spotted yet. 
> 
> For the future development of package DoE.wrapper, I would like to include
> AlgDesign in the Depends field, and that would mean that the package would
> then stop user functions with perfectly valid code from working correctly.
> So I would like to find a way to modify model.matrix.formula or
> expand.formula from AlgDesign so that AlgDesign stops messing up usages of
> model.matrix in other contexts. I think that the solution may perhaps lie in
> assigning the right environment to frml in expand.formula, but I am not
> familiar enough with assigning environments to know what the right strategy
> would be.
> 
> Any suggestions ?
> 
> Regards, 
> Ulrike
> 
> 
> 
> Heather Turner wrote:
>> Hi Ulrike,
>>
>> It looks like 'aus' is created by fac.design(); is there any reason why
>> you can't add the variable
>> y <- 1:nrow(aus)
>> to this data frame and use y as the response in your formula?
>>
>> Otherwise I think aus needs to be in the environment of frml (or frml
>> needs to be given the environment of aus).
>>
>> Heather
>>
>> Ulrike Groemping wrote:
>>> Dear DevelopeRs,
>>>
>>> in continuing with my suite of packages on experimental design, I am
>>> stuck
>>> with an issue that appears to be related to package AlgDesign - I have
>>> tried
>>> to get it solved by Bob Wheeler, but he seems to be stuck as well. 
>>>
>>> Whenever AlgDesign is loaded, some of my code does not work any more. For
>>> example, in a fresh R session: 
>>>
>>> require(DoE.base)
>>> fac.design(nlevels=c(2,6,2))
>>> require(AlgDesign)
>>> fac.design(nlevels=c(2,6,2))
>>>> Error in nrow(aus) : object 'aus' not found 
>>> The reason seems to be that AlgDesign creates a function
>>> model.matrix.formula that only finds variables that are in the global
>>> environment and variables that are in the data frame given with the
>>> formula,
>>> but not calculation results from the intermediate calling environment. 
>>>
>>> Results from traceback():
>>> 9: nrow(aus)
>>> 8: eval(expr, envir, enclos)
>>> 7: eval(predvars, data, env)
>>> 6: model.frame.default(object, data, xlev = xlev)
>>> 5: model.frame(object, data, xlev = xlev)
>>> 4: model.matrix.default(frml, data, ...)
>>> 3: model.matrix.formula(1:nrow(aus) ~ ., data = aus)
>>> 2: model.matrix(1:nrow(aus) ~ ., data = aus)
>>> 1: fac.design(nlevels = c(2, 6, 2))
>>>
>>> If I reset model.matrix.formula to model.matrix.default, the problem
>>> disappears (but AlgDesign's comfort functions for squares etc. do not
>>> work
>>> any longer). In this particular case, I can also avoid the issue by
>>> modifying the formula in fac.design, removing the left-hand side. But
>>> this
>>> just means to wait for the next place where troubles occur. Between 3 and
>>> 4
>>> of the traceback(), AlgDesign's function model.matrix.formula modifies
>>> the
>>> formula frml using AlgDesign's function expand.formula:
>>>
>>> model.matrix.formula <- function (frml, data = sys.frame(sys.parent()),
>>> ...) 
>>> {
>>>     if (!missing(data)) {
>>>         if (!inherits(data, "data.frame")) 
>>>             stop("data must be a data.frame")
>>>         if (!inherits(frml, "formula")) 
>>>             stop("frml must be a formuls")
>>>         frml <- expand.formula(frml, colnames(data))
>>>     }
>>>     model.matrix.default(frml, data, ...)
>>> }
>>>
>>>
>>> I have looked at expand.formula as well, and I've been wondering whether
>>> a
>>> simple fix can be found by adding environment information (which?) within
>>> that function (I believe that the relevant portion of the code is
>>> included
>>> below):
>>>
>>> expand.formula <- function (frml, varNames, const = TRUE, numerics =
>>> NULL) 
>>> {
>>> ## omitted quite a bit of code 
>>> ##...
>>>     frml <- deparse(frml, width = 500)
>>>     while ((0 != (pos <- findFunction("quad", frml))[1]) || (0 != 
>>>         (pos <- findFunction("cubicS", frml))[1]) || (0 != (pos <-
>>> findFunction("cubic", 
>>>         frml))[1])) {
>>>         prog <- substr(frml, pos[1], pos[2])
>>>         strHead <- substr(frml, 1, pos[1] - 1)
>>>         strTail <- substr(frml, pos[2] + 1, nchar(frml))
>>>         prog <- eval(parse(text = prog))
>>>         frml <- paste(strHead, prog, strTail, sep = "")
>>>     }
>>>     if (0 != (pos <- findDot(".", frml))[1]) {
>>>         strHead <- substr(frml, 1, pos[1] - 1)
>>>         strTail <- substr(frml, pos[2] + 1, nchar(frml))
>>>         prog <- eval(parse(text = "doDot()"))
>>>         frml <- paste(strHead, prog, strTail, sep = "")
>>>     }
>>>     if (!const) 
>>>         frml <- paste(frml, "+0", sep = "")
>>>     frml <- as.formula(frml)
>>>     frml
>>> }
>>>
>>> Any help would be greatly appreciated.
>>>
>>> Regards, Ulrike
>>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
> 

-- 
Dr H Turner
Senior Research Fellow
Dept. of Statistics
The University of Warwick
Coventry CV4 7AL
Tel: 024 76575754
Fax: 024 76524532
Url: www.warwick.ac.uk/go/heatherturner


From simon.urbanek at r-project.org  Tue Sep 29 22:50:22 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 29 Sep 2009 16:50:22 -0400
Subject: [Rd] Problems connecting to httpd help server with some browsers
In-Reply-To: <200909292115.04472.thomas.friedrichsmeier@ruhr-uni-bochum.de>
References: <200909292115.04472.thomas.friedrichsmeier@ruhr-uni-bochum.de>
Message-ID: <E73447DA-5192-4FE9-859F-E90ECC9C3B65@r-project.org>

Thomas,

On Sep 29, 2009, at 15:15 , Thomas Friedrichsmeier wrote:

> Hello,
>
> sorry to provide only very little testing, but with the release date  
> nearing, I thought it better to report this quickly than to wait for  
> an uncertain period until I find more time.
>

Yes, good thinking :).


> I'm observing strange problems connecting to the httpd help server  
> with
> konqueror (KDE 4.3.1):
>
> options (help_type="html")
> options (browser="konqueror")
> help ("print")
>
> The first page opens in a konqueror window as expected. However,  
> clicking on
> any links does not have any result. Konqueror just says "waiting for  
> reply"
> forever. There does not even seem to be a timeout. Pointing the same  
> browser
> instance to some other url works fine.
>
> Trying to use lynx as a browser (since it's a terminal browser, you  
> need open
> lynx in a separate terminal and point it to the httpd help server  
> manually)
> causes lynx to become unresponsive.
>

I don't have konqueror at hand, so I have tested and fixed the lynx  
case (lynx is acting as an HTTP/1.0 client and expects non-persistent  
connection). With some luck the fix may solve the konqueror issue as  
well (although I'd be a bit surprised if konqueror was not 1.1- 
capable..).

Thanks,
Simon


> Both konqueror and lynx are able to browse the static html files  
> just fine.
>
> Firefox and Opera work fine with the httpd server on the same  
> computer.
>
> Does anybody else see similar symptoms?
>
> Regards
> Thomas
>
>> R.version
>               _
> platform       i686-pc-linux-gnu
> arch           i686
> os             linux-gnu
> system         i686, linux-gnu
> status         Under development (unstable)
> major          2
> minor          11.0
> year           2009
> month          09
> day            29
> svn rev        49866
> language       R
> version.string R version 2.11.0 Under development (unstable)  
> (2009-09-29
> r49866)
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From jeff.horner at vanderbilt.edu  Wed Sep 30 00:27:01 2009
From: jeff.horner at vanderbilt.edu (Jeff Horner)
Date: Tue, 29 Sep 2009 17:27:01 -0500
Subject: [Rd] Problems connecting to httpd help server with some browsers
In-Reply-To: <E73447DA-5192-4FE9-859F-E90ECC9C3B65@r-project.org>
References: <200909292115.04472.thomas.friedrichsmeier@ruhr-uni-bochum.de>
	<E73447DA-5192-4FE9-859F-E90ECC9C3B65@r-project.org>
Message-ID: <4AC289B5.6070706@vanderbilt.edu>

Simon Urbanek wrote:
[...]
> I don't have konqueror at hand, so I have tested and fixed the lynx case 
> (lynx is acting as an HTTP/1.0 client and expects non-persistent 
> connection). With some luck the fix may solve the konqueror issue as 
> well (although I'd be a bit surprised if konqueror was not 1.1-capable..).

Konqueror didn't like the extra newline in the Location header:

Index: src/library/tools/R/dynamicHelp.R
===================================================================
--- src/library/tools/R/dynamicHelp.R   (revision 49890)
+++ src/library/tools/R/dynamicHelp.R   (working copy)
@@ -172,7 +172,7 @@
             return(list(payload = paste('Redirect to <a href="', file, 
'">"',
                          basename(file), '"</a>', sep=''),
                         "content-type" = 'text/html',
-                       header = paste('Location: ', file, '\n', sep=''),
+                       header = paste('Location: ', file, sep=''),
                         "status code" = 302L)) # temporary redirect
         } else if (length(file) > 1L) {
              paths <- dirname(dirname(file))


Jeff


From jeff.hamann at forestinformatics.com  Wed Sep 30 02:50:48 2009
From: jeff.hamann at forestinformatics.com (Jeff Hamann)
Date: Tue, 29 Sep 2009 17:50:48 -0700
Subject: [Rd] unable to load shared library (Symbol not found: _PQbackendPID)
Message-ID: <44FD7002-2943-4449-B98C-130724DA6AB8@forestinformatics.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090929/af54e675/attachment.pl>

From edd at debian.org  Wed Sep 30 03:21:57 2009
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 29 Sep 2009 20:21:57 -0500
Subject: [Rd] unable to load shared library (Symbol not found:
	_PQbackendPID)
In-Reply-To: <44FD7002-2943-4449-B98C-130724DA6AB8@forestinformatics.com>
References: <44FD7002-2943-4449-B98C-130724DA6AB8@forestinformatics.com>
Message-ID: <19138.45749.671652.380175@ron.nulle.part>


Jeff,

On 29 September 2009 at 17:50, Jeff Hamann wrote:
| I can't get the RPostgreSQL library to load on OSX and have no idea  
| where it's going wrong...
| 
|  > library( RPostgreSQL )
| Error in dyn.load(file, DLLpath = DLLpath, ...) :
|    unable to load shared library '/Users/hamannj/Library/R/2.9/library/ 
| RPostgreSQL/libs/i386/RPostgreSQL.so':
|    dlopen(/Users/hamannj/Library/R/2.9/library/RPostgreSQL/libs/i386/ 
| RPostgreSQL.so, 6): Symbol not found: _PQbackendPID
|    Referenced from: /Users/hamannj/Library/R/2.9/library/RPostgreSQL/ 
| libs/i386/RPostgreSQL.so
|    Expected in: flat namespace
|   in /Users/hamannj/Library/R/2.9/library/RPostgreSQL/libs/i386/ 
| RPostgreSQL.so
| Error: package/namespace load failed for 'RPostgreSQL'

As you know, questions / complaints about contributed packages should go to
the maintainer first, i.e. me. Now, I do not have access to OS X -- but Neil
(CC'ed) kindly covers that angle.  Maybe the two of you can sort this out?

| I've used this on OSX before and have had to recently rebuild... does  
| anyone know if an older archive works?

The current version works for other on OS X as far as I know.

Dirk

-- 
Three out of two people have difficulties with fractions.


From abhibera at gmail.com  Wed Sep 30 08:51:12 2009
From: abhibera at gmail.com (Abhijit Bera)
Date: Wed, 30 Sep 2009 11:51:12 +0500
Subject: [Rd] How do I access class slots from C?
In-Reply-To: <19138.22581.659836.39730@ron.nulle.part>
References: <fc212e850909290728j1f3a305bkf82db6dfcd42d8a9@mail.gmail.com>
	<19138.22581.659836.39730@ron.nulle.part>
Message-ID: <fc212e850909292351l654f0a82nc02a1fbc6254a6a9@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090930/ae1e6006/attachment.pl>

From rsparapa at mcw.edu  Tue Sep 29 23:10:12 2009
From: rsparapa at mcw.edu (rsparapa at mcw.edu)
Date: Tue, 29 Sep 2009 23:10:12 +0200 (CEST)
Subject: [Rd] build issues on Solaris (PR#13975)
Message-ID: <20090929211012.657A42831FEB@mail.pubhealth.ku.dk>

Full_Name: Rodney Sparapani
Version: 2.9.2
OS: Solaris 10
Submission from: (NULL) (141.106.121.40)


There are a few issues with building on Solaris (and UNIX in general, I
suppose).
1. on line 50686 of configure, I'm seeing some trouble:
lib=`echo ${lib}|sed -e s:${JAVA_HOME}:\$\{JAVA_HOME\}:g` 
Evidently, $lib contains colons which will confuse sed, so you can work around
this like:
lib=`echo ${lib}|sed -e s@${JAVA_HOME}@\$\{JAVA_HOME\}@g` 
2. in various Makefiles, FRONTFILES is blank which causes the error:
syntax error at line 1 : `;' unexpected 
FRONTFILES is only necessary in one Makefile:
src/library/stats/Makefile
Therefore, adding the following in that file:
.PHONY: frontfiles 

frontfiles:
	@for f in $(FRONTFILES); do \
	  if test -f $(srcdir)/$${f}; then \
	    $(INSTALL_DATA) $(srcdir)/$${f} \
	      $(top_builddir)/library/$(pkg); \
	  fi; \
	done

with the associated change of front to frontfiles a few lines above.  And
changing:
share/make/basepkg.mk 
as follows:
front:
#	@for f in $(FRONTFILES); do \
#	  if test -f $(srcdir)/$${f}; then \
#	    $(INSTALL_DATA) $(srcdir)/$${f} \
#	      $(top_builddir)/library/$(pkg); \
#	  fi; \
#	done
fixes that problem.
3. If you try to configure after a make distclean, I get the error:
config.status: error: cannot find input file: etc/Makefile.in
You can workaround this, by starting all over with a fresh unpacking of that
tgzball.


From romain.francois at dbmail.com  Wed Sep 30 09:07:06 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Wed, 30 Sep 2009 09:07:06 +0200
Subject: [Rd] How do I access class slots from C?
In-Reply-To: <fc212e850909292351l654f0a82nc02a1fbc6254a6a9@mail.gmail.com>
References: <fc212e850909290728j1f3a305bkf82db6dfcd42d8a9@mail.gmail.com>	<19138.22581.659836.39730@ron.nulle.part>
	<fc212e850909292351l654f0a82nc02a1fbc6254a6a9@mail.gmail.com>
Message-ID: <4AC3039A.7000002@dbmail.com>

On 09/30/2009 08:51 AM, Abhijit Bera wrote:
>
> Hi
>
> Thanks all of you for your suggestions. I will put up my code shortly based
> on your suggestions.
>
> I wonder how the parsing and eval will work when most of my data comes in
> from an external source like a DB?  Probably it would be more efficient to
> make an object? Hmmmm... maybe it has to be a mix of parsing and eval?

What's in the database ? Is this the data or the R code ? What's wrong 
with writing your own set of R functions and evaluate calls to these 
functions instead of basically replicate this in C or C++ or whatever.

Dirk's code certainly is nicer, but would you really do it like that in 
real life ?

Romain

> Yes, the lang4 c idea sucks. mkstring is better.
>
> Regards
>
> Abhijit
>
>
> On Tue, Sep 29, 2009 at 11:55 PM, Dirk Eddelbuettel<edd at debian.org>  wrote:
>
>>
>> This is so much fun.  The C code posted wasn't exactly legible.  So here is
>> a
>> new C++ variant that I just committed to the RInside SVN as a new example.
>> And it mine works (against RInide and Rcpp as on CRAN):
>>
>> edd at ron:~/svn/rinside/pkg/inst/examples>  ./rinside_sample4
>> Package 'sn', 0.4-12 (2009-03-21). Type 'help(SN)' for summary information
>> Using the GLPK callable library version 4.37
>>
>> Title:
>>   MV Feasible Portfolio
>>   Estimator:         covEstimator
>>   Solver:            solveRquadprog
>>   Optimize:          minRisk
>>   Constraints:       LongOnly
>>
>> Portfolio Weights:
>> SBI SPI SII LMI MPI ALT
>> 0.1 0.1 0.1 0.1 0.3 0.3
>>
>> Covariance Risk Budgets:
>>     SBI     SPI     SII     LMI     MPI     ALT
>> -0.0038  0.1423  0.0125 -0.0058  0.4862  0.3686
>>
>> Target Return and Risks:
>>   mean     mu    Cov  Sigma   CVaR    VaR
>> 0.0548 0.0548 0.4371 0.4371 1.0751 0.6609
>>
>> Description:
>>   Tue Sep 29 13:43:36 2009 by user:
>>              SBI        -0.00380065
>>              SPI           0.142261
>>              SII          0.0125242
>>              LMI        -0.00576251
>>              MPI           0.486228
>>              ALT           0.368551
>> edd at ron:~/svn/rinside/pkg/inst/examples>
>>
>> The final few lines are C++ accessing the result, earlier in the code I
>> assign the weight vector from C++ as you desired from C.  All with error
>> checking / exception handling and what have in under 60 lines of (IMHO more
>> readable) code -- see below.
>>
>> Dirk
>>
>> // -*- mode: C++; c-indent-level: 4; c-basic-offset: 4;  tab-width: 8; -*-
>> //
>> // Another simple example inspired by an r-devel mail by Abhijit Bera
>> //
>> // Copyright (C) 2009 Dirk Eddelbuettel and GPL'ed
>>
>> #include "RInside.h"                    // for the embedded R via RInside
>> #include "Rcpp.h"                       // for the R / Cpp interface used
>> for transfer
>> #include<iomanip>
>>
>> int main(int argc, char *argv[]) {
>>
>>     try {
>>         RInside R(argc, argv);          // create an embedded R instance
>>         SEXP ans;
>>
>>         std::string txt = "suppressMessages(library(fPortfolio))";
>>         if (R.parseEvalQ(txt))          // load library, no return value
>>             throw std::runtime_error("R cannot evaluate '" + txt + "'");
>>
>>         txt = "lppData<- 100 * LPP2005.RET[, 1:6]; "
>>           "ewSpec<- portfolioSpec(); "
>>           "nAssets<- ncol(lppData); ";
>>         if (R.parseEval(txt, ans))      // prepare problem
>>             throw std::runtime_error("R cannot evaluate '" + txt + "'");
>>
>>         const double dvec[6] = { 0.1, 0.1, 0.1, 0.1, 0.3, 0.3 }; // choose
>> any weights you want
>>         const std::vector<double>  w(dvec,&dvec[6]);
>>
>>         R.assign( w, "weightsvec");     // assign STL vector to R's
>> 'weightsvec' variable
>>
>>         txt = "setWeights(ewSpec)<- weightsvec";
>>         if (R.parseEvalQ(txt))          // evaluate assignment
>>             throw std::runtime_error("R cannot evaluate '" + txt + "'");
>>
>>         txt = "ewPortfolio<- feasiblePortfolio(data = lppData, spec =
>> ewSpec, constraints = \"LongOnly\"); "
>>           "print(ewPortfolio); "
>>           "vec<- getCovRiskBudgets(ewPortfolio at portfolio)";
>>         if (R.parseEval(txt, ans))      // assign covRiskBudget weights to
>> ans
>>             throw std::runtime_error("R cannot evaluate '" + txt + "'");
>>         RcppVector<double>  V(ans);      // convert SEXP variable to an
>> RcppMatrix
>>
>>         R.parseEval("names(vec)", ans); // assign columns names to ans
>>         RcppStringVector names(ans);
>>
>>         for (int i=0; i<names.size(); i++) {
>>           std::cout<<  std::setw(16)<<  names(i)<<  "\t"
>>                     <<  std::setw(11)<<  V(i)<<  "\n";
>>         }
>>
>>     } catch(std::exception&  ex) {
>>         std::cerr<<  "Exception caught: "<<  ex.what()<<  std::endl;
>>     } catch(...) {
>>         std::cerr<<  "Unknown exception caught"<<  std::endl;
>>     }
>>
>>     exit(0);
>> }



-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/ztCu : RGG #158:161: examples of package IDPmisc
|- http://tr.im/yw8E : New R package : sos
`- http://tr.im/y8y0 : search the graph gallery from R


From thomas.friedrichsmeier at ruhr-uni-bochum.de  Wed Sep 30 09:34:40 2009
From: thomas.friedrichsmeier at ruhr-uni-bochum.de (Thomas Friedrichsmeier)
Date: 30 Sep 2009 09:34:40 +0200
Subject: [Rd] Problems connecting to httpd help server with some browsers
In-Reply-To: <4AC289B5.6070706@vanderbilt.edu>
References: <200909292115.04472.thomas.friedrichsmeier@ruhr-uni-bochum.de>
	<E73447DA-5192-4FE9-859F-E90ECC9C3B65@r-project.org>
	<4AC289B5.6070706@vanderbilt.edu>
Message-ID: <200909300934.45449.thomas.friedrichsmeier@ruhr-uni-bochum.de>

On Wednesday 30 September 2009, Jeff Horner wrote:
> Simon Urbanek wrote:
> [...]
> 
> > I don't have konqueror at hand, so I have tested and fixed the lynx case
> > (lynx is acting as an HTTP/1.0 client and expects non-persistent
> > connection). With some luck the fix may solve the konqueror issue as
> > well (although I'd be a bit surprised if konqueror was not
> > 1.1-capable..).
> 
> Konqueror didn't like the extra newline in the Location header:

I can confirm that the lynx issue is solved in r49893, but the issue in 
konqueror persists. Applying Jeff's patch solves that, here, while firefox, 
opera and lynx continue to work.

Regards
Thomas
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part.
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090930/fe11e140/attachment.bin>

From abhibera at gmail.com  Wed Sep 30 09:45:17 2009
From: abhibera at gmail.com (Abhijit Bera)
Date: Wed, 30 Sep 2009 12:45:17 +0500
Subject: [Rd] How do I access class slots from C?
In-Reply-To: <4AC3039A.7000002@dbmail.com>
References: <fc212e850909290728j1f3a305bkf82db6dfcd42d8a9@mail.gmail.com>
	<19138.22581.659836.39730@ron.nulle.part>
	<fc212e850909292351l654f0a82nc02a1fbc6254a6a9@mail.gmail.com>
	<4AC3039A.7000002@dbmail.com>
Message-ID: <fc212e850909300045w72c270acl4d76215248d3af3d@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090930/97b9e848/attachment.pl>

From abhibera at gmail.com  Wed Sep 30 09:51:04 2009
From: abhibera at gmail.com (Abhijit Bera)
Date: Wed, 30 Sep 2009 12:51:04 +0500
Subject: [Rd] How do I access class slots from C?
In-Reply-To: <fc212e850909300045w72c270acl4d76215248d3af3d@mail.gmail.com>
References: <fc212e850909290728j1f3a305bkf82db6dfcd42d8a9@mail.gmail.com>
	<19138.22581.659836.39730@ron.nulle.part>
	<fc212e850909292351l654f0a82nc02a1fbc6254a6a9@mail.gmail.com>
	<4AC3039A.7000002@dbmail.com>
	<fc212e850909300045w72c270acl4d76215248d3af3d@mail.gmail.com>
Message-ID: <fc212e850909300051p7d70fbe7u8bde173e827561d1@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090930/22a9b977/attachment.pl>

From romain.francois at dbmail.com  Wed Sep 30 09:54:50 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Wed, 30 Sep 2009 09:54:50 +0200
Subject: [Rd] How do I access class slots from C?
In-Reply-To: <fc212e850909300045w72c270acl4d76215248d3af3d@mail.gmail.com>
References: <fc212e850909290728j1f3a305bkf82db6dfcd42d8a9@mail.gmail.com>	
	<19138.22581.659836.39730@ron.nulle.part>	
	<fc212e850909292351l654f0a82nc02a1fbc6254a6a9@mail.gmail.com>	
	<4AC3039A.7000002@dbmail.com>
	<fc212e850909300045w72c270acl4d76215248d3af3d@mail.gmail.com>
Message-ID: <4AC30ECA.8000102@dbmail.com>

On 09/30/2009 09:45 AM, Abhijit Bera wrote:
> Hi
>
> I'm pulling financial datasets from a DB, converting it to a timeseries
> object then creating a returns object out of it.

Right, so the data is in the database.

> I plan to embed R into an application, which is why I'm taking this
> route of using C.

Sure. My point is (take it or leave it) since you are already using some 
R packages (fPortfolio, etc ...) why don't you just write one that 
contains a set of simple utility functions that are only aimed at 
simplifying your C code, and call these from C.

I'd find this much easier to code, document and test ... but eventually 
you should do what __you__ find easier/better

Romain

> Regards
>
> Abhijit
>
> On Wed, Sep 30, 2009 at 12:07 PM, Romain Francois
> <romain.francois at dbmail.com <mailto:romain.francois at dbmail.com>> wrote:
>
>     On 09/30/2009 08:51 AM, Abhijit Bera wrote:
>
>
>         Hi
>
>         Thanks all of you for your suggestions. I will put up my code
>         shortly based
>         on your suggestions.
>
>         I wonder how the parsing and eval will work when most of my data
>         comes in
>         from an external source like a DB?  Probably it would be more
>         efficient to
>         make an object? Hmmmm... maybe it has to be a mix of parsing and
>         eval?
>
>
>     What's in the database ? Is this the data or the R code ? What's
>     wrong with writing your own set of R functions and evaluate calls to
>     these functions instead of basically replicate this in C or C++ or
>     whatever.
>
>     Dirk's code certainly is nicer, but would you really do it like that
>     in real life ?
>
>     Romain
>
>
>         Yes, the lang4 c idea sucks. mkstring is better.
>
>         Regards
>
>         Abhijit
>
>
>         On Tue, Sep 29, 2009 at 11:55 PM, Dirk
>         Eddelbuettel<edd at debian.org <mailto:edd at debian.org>>  wrote:
>
>
>             This is so much fun.  The C code posted wasn't exactly
>             legible.  So here is
>             a
>             new C++ variant that I just committed to the RInside SVN as
>             a new example.
>             And it mine works (against RInide and Rcpp as on CRAN):
>
>             edd at ron:~/svn/rinside/pkg/inst/examples>  ./rinside_sample4
>             Package 'sn', 0.4-12 (2009-03-21). Type 'help(SN)' for
>             summary information
>             Using the GLPK callable library version 4.37
>
>             Title:
>               MV Feasible Portfolio
>               Estimator:         covEstimator
>               Solver:            solveRquadprog
>               Optimize:          minRisk
>               Constraints:       LongOnly
>
>             Portfolio Weights:
>             SBI SPI SII LMI MPI ALT
>             0.1 0.1 0.1 0.1 0.3 0.3
>
>             Covariance Risk Budgets:
>                 SBI     SPI     SII     LMI     MPI     ALT
>             -0.0038  0.1423  0.0125 -0.0058  0.4862  0.3686
>
>             Target Return and Risks:
>               mean     mu    Cov  Sigma   CVaR    VaR
>             0.0548 0.0548 0.4371 0.4371 1.0751 0.6609
>
>             Description:
>               Tue Sep 29 13:43:36 2009 by user:
>                          SBI        -0.00380065
>                          SPI           0.142261
>                          SII          0.0125242
>                          LMI        -0.00576251
>                          MPI           0.486228
>                          ALT           0.368551
>             edd at ron:~/svn/rinside/pkg/inst/examples>
>
>             The final few lines are C++ accessing the result, earlier in
>             the code I
>             assign the weight vector from C++ as you desired from C.
>               All with error
>             checking / exception handling and what have in under 60
>             lines of (IMHO more
>             readable) code -- see below.
>
>             Dirk
>
>             // -*- mode: C++; c-indent-level: 4; c-basic-offset: 4;
>               tab-width: 8; -*-
>             //
>             // Another simple example inspired by an r-devel mail by
>             Abhijit Bera
>             //
>             // Copyright (C) 2009 Dirk Eddelbuettel and GPL'ed
>
>             #include "RInside.h"                    // for the embedded
>             R via RInside
>             #include "Rcpp.h"                       // for the R / Cpp
>             interface used
>             for transfer
>             #include<iomanip>
>
>             int main(int argc, char *argv[]) {
>
>                 try {
>                     RInside R(argc, argv);          // create an
>             embedded R instance
>                     SEXP ans;
>
>                     std::string txt =
>             "suppressMessages(library(fPortfolio))";
>                     if (R.parseEvalQ(txt))          // load library, no
>             return value
>                         throw std::runtime_error("R cannot evaluate '" +
>             txt + "'");
>
>                     txt = "lppData<- 100 * LPP2005.RET[, 1:6]; "
>             "ewSpec<- portfolioSpec(); "
>             "nAssets<- ncol(lppData); ";
>                     if (R.parseEval(txt, ans))      // prepare problem
>                         throw std::runtime_error("R cannot evaluate '" +
>             txt + "'");
>
>                     const double dvec[6] = { 0.1, 0.1, 0.1, 0.1, 0.3,
>             0.3 }; // choose
>             any weights you want
>                     const std::vector<double>  w(dvec,&dvec[6]);
>
>                     R.assign( w, "weightsvec");     // assign STL vector
>             to R's
>             'weightsvec' variable
>
>                     txt = "setWeights(ewSpec)<- weightsvec";
>                     if (R.parseEvalQ(txt))          // evaluate assignment
>                         throw std::runtime_error("R cannot evaluate '" +
>             txt + "'");
>
>                     txt = "ewPortfolio<- feasiblePortfolio(data =
>             lppData, spec =
>             ewSpec, constraints = \"LongOnly\"); "
>             "print(ewPortfolio); "
>             "vec<- getCovRiskBudgets(ewPortfolio at portfolio)";
>                     if (R.parseEval(txt, ans))      // assign
>             covRiskBudget weights to
>             ans
>                         throw std::runtime_error("R cannot evaluate '" +
>             txt + "'");
>                     RcppVector<double>  V(ans);      // convert SEXP
>             variable to an
>             RcppMatrix
>
>                     R.parseEval("names(vec)", ans); // assign columns
>             names to ans
>                     RcppStringVector names(ans);
>
>                     for (int i=0; i<names.size(); i++) {
>                       std::cout<<  std::setw(16)<<  names(i)<< "\t"
>             <<  std::setw(11)<<  V(i)<< "\n";
>                     }
>
>                 } catch(std::exception&  ex) {
>                     std::cerr<< "Exception caught: "<<  ex.what()<<
>               std::endl;
>                 } catch(...) {
>                     std::cerr<< "Unknown exception caught"<<  std::endl;
>                 }
>
>                 exit(0);
>             }


-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/ztCu : RGG #158:161: examples of package IDPmisc
|- http://tr.im/yw8E : New R package : sos
`- http://tr.im/y8y0 : search the graph gallery from R


From romain.francois at dbmail.com  Wed Sep 30 10:12:32 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Wed, 30 Sep 2009 10:12:32 +0200
Subject: [Rd] How do I access class slots from C?
In-Reply-To: <fc212e850909300051p7d70fbe7u8bde173e827561d1@mail.gmail.com>
References: <fc212e850909290728j1f3a305bkf82db6dfcd42d8a9@mail.gmail.com>	
	<19138.22581.659836.39730@ron.nulle.part>	
	<fc212e850909292351l654f0a82nc02a1fbc6254a6a9@mail.gmail.com>	
	<4AC3039A.7000002@dbmail.com>	
	<fc212e850909300045w72c270acl4d76215248d3af3d@mail.gmail.com>
	<fc212e850909300051p7d70fbe7u8bde173e827561d1@mail.gmail.com>
Message-ID: <4AC312F0.8070108@dbmail.com>

On 09/30/2009 09:51 AM, Abhijit Bera wrote:
> Hi Romain
>
> I got what ur saying. Good idea. First I convert the data into a
> timeseries and return object using C, then I pass it onto an R function
> which I have written, I call the R function from my C code, it evaluates
> and then I process the values returned by it in my C code. Much simpler
> that way. So, I can do away with all these confusing constructs. :)
>
> What about performance? You think I will see a difference if I follow a
> C only approach of creating all the objects?

Essentially you are not using a C only approach, even in your original 
example, since you call functions from fPortfolio (btw, R has to look 
down the search path each time to find the function, so you can make 
this more efficient, ...)

It might even be faster like this since you only need to parse the R 
functions once, so you pay the (not so expensive btw) price of parsing 
once.

Combine this with an approach that caches the references to the 
functions, so you only pay the price of searching through R search path 
once, and you're set.

Anyway, chances are the code from fPorfolio you call will be what costs 
the most, after all that is what is actually working here. Before 
converting your R script to C, did you do some profiling to identify 
what takes the most time ?

Romain

> Regards
>
> Abhijit
>
> On Wed, Sep 30, 2009 at 12:45 PM, Abhijit Bera <abhibera at gmail.com
> <mailto:abhibera at gmail.com>> wrote:
>
>     Hi
>
>     I'm pulling financial datasets from a DB, converting it to a
>     timeseries object then creating a returns object out of it.
>
>     I plan to embed R into an application, which is why I'm taking this
>     route of using C.
>
>     Regards
>
>     Abhijit
>
>
>     On Wed, Sep 30, 2009 at 12:07 PM, Romain Francois
>     <romain.francois at dbmail.com <mailto:romain.francois at dbmail.com>> wrote:
>
>         On 09/30/2009 08:51 AM, Abhijit Bera wrote:
>
>
>             Hi
>
>             Thanks all of you for your suggestions. I will put up my
>             code shortly based
>             on your suggestions.
>
>             I wonder how the parsing and eval will work when most of my
>             data comes in
>             from an external source like a DB?  Probably it would be
>             more efficient to
>             make an object? Hmmmm... maybe it has to be a mix of parsing
>             and eval?
>
>
>         What's in the database ? Is this the data or the R code ? What's
>         wrong with writing your own set of R functions and evaluate
>         calls to these functions instead of basically replicate this in
>         C or C++ or whatever.
>
>         Dirk's code certainly is nicer, but would you really do it like
>         that in real life ?
>
>         Romain
>
>
>             Yes, the lang4 c idea sucks. mkstring is better.
>
>             Regards
>
>             Abhijit
>
>
>             On Tue, Sep 29, 2009 at 11:55 PM, Dirk
>             Eddelbuettel<edd at debian.org <mailto:edd at debian.org>>  wrote:
>
>
>                 This is so much fun.  The C code posted wasn't exactly
>                 legible.  So here is
>                 a
>                 new C++ variant that I just committed to the RInside SVN
>                 as a new example.
>                 And it mine works (against RInide and Rcpp as on CRAN):
>
>                 edd at ron:~/svn/rinside/pkg/inst/examples>  ./rinside_sample4
>                 Package 'sn', 0.4-12 (2009-03-21). Type 'help(SN)' for
>                 summary information
>                 Using the GLPK callable library version 4.37
>
>                 Title:
>                   MV Feasible Portfolio
>                   Estimator:         covEstimator
>                   Solver:            solveRquadprog
>                   Optimize:          minRisk
>                   Constraints:       LongOnly
>
>                 Portfolio Weights:
>                 SBI SPI SII LMI MPI ALT
>                 0.1 0.1 0.1 0.1 0.3 0.3
>
>                 Covariance Risk Budgets:
>                     SBI     SPI     SII     LMI     MPI     ALT
>                 -0.0038  0.1423  0.0125 -0.0058  0.4862  0.3686
>
>                 Target Return and Risks:
>                   mean     mu    Cov  Sigma   CVaR    VaR
>                 0.0548 0.0548 0.4371 0.4371 1.0751 0.6609
>
>                 Description:
>                   Tue Sep 29 13:43:36 2009 by user:
>                              SBI        -0.00380065
>                              SPI           0.142261
>                              SII          0.0125242
>                              LMI        -0.00576251
>                              MPI           0.486228
>                              ALT           0.368551
>                 edd at ron:~/svn/rinside/pkg/inst/examples>
>
>                 The final few lines are C++ accessing the result,
>                 earlier in the code I
>                 assign the weight vector from C++ as you desired from C.
>                   All with error
>                 checking / exception handling and what have in under 60
>                 lines of (IMHO more
>                 readable) code -- see below.
>
>                 Dirk
>
>                 // -*- mode: C++; c-indent-level: 4; c-basic-offset: 4;
>                   tab-width: 8; -*-
>                 //
>                 // Another simple example inspired by an r-devel mail by
>                 Abhijit Bera
>                 //
>                 // Copyright (C) 2009 Dirk Eddelbuettel and GPL'ed
>
>                 #include "RInside.h"                    // for the
>                 embedded R via RInside
>                 #include "Rcpp.h"                       // for the R /
>                 Cpp interface used
>                 for transfer
>                 #include<iomanip>
>
>                 int main(int argc, char *argv[]) {
>
>                     try {
>                         RInside R(argc, argv);          // create an
>                 embedded R instance
>                         SEXP ans;
>
>                         std::string txt =
>                 "suppressMessages(library(fPortfolio))";
>                         if (R.parseEvalQ(txt))          // load library,
>                 no return value
>                             throw std::runtime_error("R cannot evaluate
>                 '" + txt + "'");
>
>                         txt = "lppData<- 100 * LPP2005.RET[, 1:6]; "
>                 "ewSpec<- portfolioSpec(); "
>                 "nAssets<- ncol(lppData); ";
>                         if (R.parseEval(txt, ans))      // prepare problem
>                             throw std::runtime_error("R cannot evaluate
>                 '" + txt + "'");
>
>                         const double dvec[6] = { 0.1, 0.1, 0.1, 0.1,
>                 0.3, 0.3 }; // choose
>                 any weights you want
>                         const std::vector<double>  w(dvec,&dvec[6]);
>
>                         R.assign( w, "weightsvec");     // assign STL
>                 vector to R's
>                 'weightsvec' variable
>
>                         txt = "setWeights(ewSpec)<- weightsvec";
>                         if (R.parseEvalQ(txt))          // evaluate
>                 assignment
>                             throw std::runtime_error("R cannot evaluate
>                 '" + txt + "'");
>
>                         txt = "ewPortfolio<- feasiblePortfolio(data =
>                 lppData, spec =
>                 ewSpec, constraints = \"LongOnly\"); "
>                 "print(ewPortfolio); "
>                 "vec<- getCovRiskBudgets(ewPortfolio at portfolio)";
>                         if (R.parseEval(txt, ans))      // assign
>                 covRiskBudget weights to
>                 ans
>                             throw std::runtime_error("R cannot evaluate
>                 '" + txt + "'");
>                         RcppVector<double>  V(ans);      // convert SEXP
>                 variable to an
>                 RcppMatrix
>
>                         R.parseEval("names(vec)", ans); // assign
>                 columns names to ans
>                         RcppStringVector names(ans);
>
>                         for (int i=0; i<names.size(); i++) {
>                           std::cout<<  std::setw(16)<<  names(i)<< "\t"
>                 <<  std::setw(11)<<  V(i)<< "\n";
>                         }
>
>                     } catch(std::exception&  ex) {
>                         std::cerr<< "Exception caught: "<<  ex.what()<<
>                   std::endl;
>                     } catch(...) {
>                         std::cerr<< "Unknown exception caught"<<  std::endl;
>                     }
>
>                     exit(0);
>                 }

-- 
Romain Francois
Professional R Enthusiast
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/ztCu : RGG #158:161: examples of package IDPmisc
|- http://tr.im/yw8E : New R package : sos
`- http://tr.im/y8y0 : search the graph gallery from R


From stefan.evert at uos.de  Wed Sep 30 11:11:48 2009
From: stefan.evert at uos.de (Stefan Evert)
Date: Wed, 30 Sep 2009 11:11:48 +0200
Subject: [Rd] R 2.9.2 crashes when sorting latin1-encoded strings
Message-ID: <C935923C-760E-4830-B483-324DA608E66A@uos.de>

Hi everyone!

I think I stumbled over a bug in the latest R 2.9.2 patched for OS X:

> R version 2.9.2 Patched (2009-09-24 r49861)
> i386-apple-darwin9.8.0


When I try to sort latin1-encoded character vectors, R sometimes  
crashes with a segmentation fault.  I'm running OS X 10.5.8 and have  
observed this behaviour both with the i386 and x86_64 builds, in the  
R.app GUI as well as on the command line.

Here's a minimal example that reliably triggers the crash on my machine:

=====
print(sessionInfo())

words <- c("aa", "ab", "a\xfc", "a\xe4", "b\xe4", "b\xfc", "\xe4\xfc")
str(words)

print(table(Encoding(words)))
Encoding(words) <- "latin1"  # this is the correct encoding!
print(table(Encoding(words)))

N <- 1000
words <- rep(words, length.out=N)

print(N)
for (i in 1:N) {
x <- words[1:i]
# the following line will crash for some i, depending on the particular
# strings in <words> and the subset selected for <x> above
order(x)
}
=====

The output I get from this code is appended at the end of the mail.  
Note that R incorrectly declares the latin1 strings in <word> to have  
UTF-8 encoding (this seems wrong to me because the \x escapes insert  
raw bytes into the string). The crash only occurs if the correct  
"latin1" encoding (or "unknown") is explicitly specified. Otherwise  
the string handling code appears to ignore everything after the first  
invalid multibyte character.

I haven't been able to trigger the bug without some kind of loop.  The  
crash always occurs at the same iteration, but this changes depending  
on the contents of <words> and the specific subset selected in each  
loop iteration.  Also note that the 64-bit version of R gives a  
different error message.  If I omit the unrelated statement  
"print(N)", the 64-bit version segfaults and the 32-bit version just  
hangs with high CPU load. All this suggests to me that there must be  
some insidious memory corruption or stack/range overflow in the  
internal ordering code.

Can other people reproduce this problem on different platforms and  
possibly with different versions of R?


BTW, I ran into the crash when trying to read.delim() a file in latin1  
encoding, using either encoding="latin1" or fileEncoding="latin1", and  
then converting it back and forth between a character vector and a  
factor.  I still don't understand what's going on there.  The  
behaviour of read.delim() seems to depend very much on my locale  
settings when running R, which is rather unpleasant.  Is there a way  
to find out how strings are stored internally (i.e. getting the exact  
byte representation) and whether R believes them to be in UTF-8 or  
latin1 encoding?


Best regards,
Stefan Evert

[ stefan.evert at uos.de | http://purl.org/stefan.evert ]





Output of sample code on my machine:

> > print(sessionInfo())
> R version 2.9.2 Patched (2009-09-24 r49861)
> i386-apple-darwin9.8.0
>
> locale:
> en_GB/en_GB/C/C/en_GB/en_GB
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> >
> > words <- c("aa", "ab", "a\xfc", "a\xe4", "b\xe4", "b\xfc",  
> "\xe4\xfc")
> > str(words)
> chr [1:7] "aa" "ab" "a\xfc" "a\xe4" "b\xe4" "b\xfc" ...
> > print(table(Encoding(words)))
>
> unknown   UTF-8
>     2       5
> >
> > Encoding(words) <- "latin1"  # this is the correct encoding!
> > print(table(Encoding(words)))
>
> latin1 unknown
>     5       2
> >
> > N <- 1000
> > words <- rep(words, length.out=N)
> >
> > print(N)
> [1] 1000
> > for (i in 1:N) {
> +   x <- words[1:i]
> +   # the following line will crash for some i, depending on the  
> particular
> +   # strings in <words> and the subset selected for <x> above
> +   order(x)
> + }
>
> *** caught bus error ***
> address 0x86, cause 'non-existent physical address'
>
> Traceback:
> 1: order(x)
> aborting ...
> Bus error

64-bit version:

> > print(sessionInfo())
> R version 2.9.2 Patched (2009-09-24 r49861)
> x86_64-apple-darwin9.8.0
>
> locale:
> en_GB/en_GB/C/C/en_GB/en_GB
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> >
> > words <- c("aa", "ab", "a\xfc", "a\xe4", "b\xe4", "b\xfc",  
> "\xe4\xfc")
> > str(words)
> chr [1:7] "aa" "ab" "a\xfc" "a\xe4" "b\xe4" "b\xfc" ...
> > print(table(Encoding(words)))
>
> unknown   UTF-8
>     2       5
> >
> > Encoding(words) <- "latin1"  # this is the correct encoding!
> > print(table(Encoding(words)))
>
> latin1 unknown
>     5       2
> >
> > N <- 1000
> > words <- rep(words, length.out=N)
> >
> > print(N)
> [1] 1000
> > for (i in 1:N) {
> +   x <- words[1:i]
> +   # the following line will crash for some i, depending on the  
> particular
> +   # strings in <words> and the subset selected for <x> above
> +   order(x)
> + }
> Error in order(x) : 'translateCharUTF8' must be called on a CHARSXP
> Execution halted
>


From simon.urbanek at r-project.org  Wed Sep 30 15:33:53 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 30 Sep 2009 09:33:53 -0400
Subject: [Rd] Problems connecting to httpd help server with some browsers
In-Reply-To: <4AC289B5.6070706@vanderbilt.edu>
References: <200909292115.04472.thomas.friedrichsmeier@ruhr-uni-bochum.de>
	<E73447DA-5192-4FE9-859F-E90ECC9C3B65@r-project.org>
	<4AC289B5.6070706@vanderbilt.edu>
Message-ID: <793369FE-802C-40E0-8493-5626ECEA1EF7@r-project.org>

Thanks, Jeff, good catch. Now committed.
Simon

On Sep 29, 2009, at 18:27 , Jeff Horner wrote:

> Simon Urbanek wrote:
> [...]
>> I don't have konqueror at hand, so I have tested and fixed the lynx  
>> case (lynx is acting as an HTTP/1.0 client and expects non- 
>> persistent connection). With some luck the fix may solve the  
>> konqueror issue as well (although I'd be a bit surprised if  
>> konqueror was not 1.1-capable..).
>
> Konqueror didn't like the extra newline in the Location header:
>
> Index: src/library/tools/R/dynamicHelp.R
> ===================================================================
> --- src/library/tools/R/dynamicHelp.R   (revision 49890)
> +++ src/library/tools/R/dynamicHelp.R   (working copy)
> @@ -172,7 +172,7 @@
>            return(list(payload = paste('Redirect to <a href="',  
> file, '">"',
>                         basename(file), '"</a>', sep=''),
>                        "content-type" = 'text/html',
> -                       header = paste('Location: ', file, '\n',  
> sep=''),
> +                       header = paste('Location: ', file, sep=''),
>                        "status code" = 302L)) # temporary redirect
>        } else if (length(file) > 1L) {
>             paths <- dirname(dirname(file))
>
>
> Jeff
>
>


From pengyu.ut at gmail.com  Wed Sep 30 16:13:28 2009
From: pengyu.ut at gmail.com (Peng Yu)
Date: Wed, 30 Sep 2009 09:13:28 -0500
Subject: [Rd] How to compile R with command completion?
In-Reply-To: <4AC361CA.3010206@fhcrc.org>
References: <366c6f340909291134w1b253caeje00a3054ef35e619@mail.gmail.com>
	<4AC27267.2060007@gmail.com>
	<366c6f340909291946u545c024fyf0ac54e002e3927@mail.gmail.com>
	<4AC2D2E8.8040208@fhcrc.org>
	<366c6f340909300526s3470a4eep63c92eb67f24270b@mail.gmail.com>
	<4AC361CA.3010206@fhcrc.org>
Message-ID: <366c6f340909300713v5354d451p26cd8e86ff678e@mail.gmail.com>

I compiled R-2.9.2 from source on Cent OS. But the compile R program
does not support command completion.

I get the following configure output that is related to readline. Why
'rl_completion_matches' doesn't exist? How should I make R support
command completion?

===================
checking readline/history.h usability... yes
checking readline/history.h presence... yes
checking for readline/history.h... yes
checking readline/readline.h usability... yes
checking readline/readline.h presence... yes
checking for readline/readline.h... yes
checking for rl_callback_read_char in -lreadline... no
checking for main in -lncurses... yes
checking for rl_callback_read_char in -lreadline... yes
checking for history_truncate_file... yes
checking whether rl_completion_matches exists and is declared... no


checking readline/history.h usability... yes
checking readline/history.h presence... yes
checking for readline/history.h... yes
checking readline/readline.h usability... yes
checking readline/readline.h presence... yes
checking for readline/readline.h... yes
checking for rl_callback_read_char in -lreadline... no
checking for main in -lncurses... yes
checking for rl_callback_read_char in -lreadline... yes
checking for history_truncate_file... yes
checking whether rl_completion_matches exists and is declared... no
=====================


Here is my sessionInfo() of the compiled R.
=========================
$ R

R version 2.9.2 (2009-08-24)
Copyright (C) 2009 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> sessionInfo()
R version 2.9.2 (2009-08-24)
x86_64-unknown-linux-gnu

locale:
LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base


From simon.urbanek at r-project.org  Wed Sep 30 16:55:04 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 30 Sep 2009 10:55:04 -0400
Subject: [Rd] R 2.9.2 crashes when sorting latin1-encoded strings
In-Reply-To: <C935923C-760E-4830-B483-324DA608E66A@uos.de>
References: <C935923C-760E-4830-B483-324DA608E66A@uos.de>
Message-ID: <0698E3AF-B43C-405C-BDF5-AAA930A21CD8@r-project.org>

Stefan,

On Sep 30, 2009, at 5:11 , Stefan Evert wrote:

> Hi everyone!
>
> I think I stumbled over a bug in the latest R 2.9.2 patched for OS X:
>
>> R version 2.9.2 Patched (2009-09-24 r49861)
>> i386-apple-darwin9.8.0
>
>
> When I try to sort latin1-encoded character vectors, R sometimes  
> crashes with a segmentation fault.  I'm running OS X 10.5.8 and have  
> observed this behaviour both with the i386 and x86_64 builds, in the  
> R.app GUI as well as on the command line.
>
> Here's a minimal example that reliably triggers the crash on my  
> machine:
>
> =====
> print(sessionInfo())
>
> words <- c("aa", "ab", "a\xfc", "a\xe4", "b\xe4", "b\xfc", "\xe4\xfc")
> str(words)
>
> print(table(Encoding(words)))
> Encoding(words) <- "latin1"  # this is the correct encoding!
> print(table(Encoding(words)))
>
> N <- 1000
> words <- rep(words, length.out=N)
>
> print(N)
> for (i in 1:N) {
> x <- words[1:i]
> # the following line will crash for some i, depending on the  
> particular
> # strings in <words> and the subset selected for <x> above
> order(x)
> }
> =====
>
> The output I get from this code is appended at the end of the mail.  
> Note that R incorrectly declares the latin1 strings in <word> to  
> have UTF-8 encoding (this seems wrong to me because the \x escapes  
> insert raw bytes into the string).

It is correct, because you're in a UTF-8 locale (see l10n_info()) so  
all strings are UTF-8 by default - you're just manually creating a  
string that is not valid in UTF-8.


> The crash only occurs if the correct "latin1" encoding (or  
> "unknown") is explicitly specified. Otherwise the string handling  
> code appears to ignore everything after the first invalid multibyte  
> character.
>
> I haven't been able to trigger the bug without some kind of loop.   
> The crash always occurs at the same iteration, but this changes  
> depending on the contents of <words> and the specific subset  
> selected in each loop iteration.  Also note that the 64-bit version  
> of R gives a different error message.  If I omit the unrelated  
> statement "print(N)", the 64-bit version segfaults and the 32-bit  
> version just hangs with high CPU load. All this suggests to me that  
> there must be some insidious memory corruption or stack/range  
> overflow in the internal ordering code.
>

Yup:

Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: 13 at address: 0x0000000000000000
0x0000000100167e0d in R_gc_internal (size_needed=1) at ../../../../ 
R-2.9-branch/src/main/memory.c:1327
1327	    PROCESS_NODES();
(gdb) bt
#0  0x0000000100167e0d in R_gc_internal (size_needed=1) at ../../../../ 
R-2.9-branch/src/main/memory.c:1327
#1  0x000000010016a2bf in Rf_allocVector (type=607, length=0)  
at ../../../../R-2.9-branch/src/main/memory.c:1991
#2  0x000000010016aa65 in R_alloc (nelem=<value temporarily  
unavailable, due to optimizations>, eltsize=<value temporarily  
unavailable, due to optimizations>) at ../../../../R-2.9-branch/src/ 
main/memory.c:1669
#3  0x000000010020f316 in Rf_translateCharUTF8 (x=<value temporarily  
unavailable, due to optimizations>) at ../../../../R-2.9-branch/src/ 
main/sysutils.c:858
#4  0x0000000100216140 in Rf_Scollate (a=0x1023c1518, b=0x0)  
at ../../../../R-2.9-branch/src/main/util.c:1691
#5  0x00000001001f894e in orderVector1 (indx=<value temporarily  
unavailable, due to optimizations>, n=<value temporarily unavailable,  
due to optimizations>, key=0x11b024c00, nalast=TRUE, decreasing=FALSE,  
rho=0x1020a4778) at ../../../../R-2.9-branch/src/main/sort.c:846
#6  0x00000001001f9605 in orderVector [inlined] () at ../../../../ 
R-2.9-branch/src/main/sort.c:888
#7  do_order (call=<value temporarily unavailable, due to  
optimizations>, op=<value temporarily unavailable, due to  
optimizations>, args=0x11843fc38, rho=<value temporarily unavailable,  
due to optimizations>) at ../../../../R-2.9-branch/src/main/sort.c:891

Note that b=0x0 in the call to Rf_Scollate -- seems like some array  
overflow in the sorting code... will need some more investigation ...


In the meantime I can offer you a work-around -- working with non- 
native strings (latin1 in your case) is very expensive because they  
get converted all the time into the native locale, so you want to run
words<-iconv(words,"latin1","")

and then proceed - it's faster and doesn't crash ;).


> Can other people reproduce this problem on different platforms and  
> possibly with different versions of R?
>
>
> BTW, I ran into the crash when trying to read.delim() a file in  
> latin1 encoding, using either encoding="latin1" or  
> fileEncoding="latin1", and then converting it back and forth between  
> a character vector and a factor.  I still don't understand what's  
> going on there.  The behaviour of read.delim() seems to depend very  
> much on my locale settings when running R, which is rather unpleasant.

?? The whole point of a locale is that it declares how you are going  
to interact with the system. Handling of strings is entirely different  
depending on the encoding used by the locale - and that is the point  
of locales. When you are dealing with text (e.g. as files) you must  
always take the encoding into account and by default they are assumed  
to be in the same encoding as your locale - you really wouldn't want R  
to suddenly read all files as let's say eucJP even though your locale  
is UTF-8 ...


>  Is there a way to find out how strings are stored internally (i.e.  
> getting the exact byte representation) and whether R believes them  
> to be in UTF-8 or latin1 encoding?
>

charToRaw() will show you the raw bytes and you define using  
Encoding() how you want the string to be interpreted (supported is  
UTF-8, latin1 and unknown). If the encoding is known, R will convert  
it where needed. Normally R uses the native encoding of the locale  
you're running in. If you are dealing with files from other locales,  
you have to tell R accordingly - in most cases it's better to re- 
encode the strings (?iconv) than to work with the foreign encoding.

Cheers,
Simon



>
>
> Output of sample code on my machine:
>
>> > print(sessionInfo())
>> R version 2.9.2 Patched (2009-09-24 r49861)
>> i386-apple-darwin9.8.0
>>
>> locale:
>> en_GB/en_GB/C/C/en_GB/en_GB
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> >
>> > words <- c("aa", "ab", "a\xfc", "a\xe4", "b\xe4", "b\xfc",  
>> "\xe4\xfc")
>> > str(words)
>> chr [1:7] "aa" "ab" "a\xfc" "a\xe4" "b\xe4" "b\xfc" ...
>> > print(table(Encoding(words)))
>>
>> unknown   UTF-8
>>    2       5
>> >
>> > Encoding(words) <- "latin1"  # this is the correct encoding!
>> > print(table(Encoding(words)))
>>
>> latin1 unknown
>>    5       2
>> >
>> > N <- 1000
>> > words <- rep(words, length.out=N)
>> >
>> > print(N)
>> [1] 1000
>> > for (i in 1:N) {
>> +   x <- words[1:i]
>> +   # the following line will crash for some i, depending on the  
>> particular
>> +   # strings in <words> and the subset selected for <x> above
>> +   order(x)
>> + }
>>
>> *** caught bus error ***
>> address 0x86, cause 'non-existent physical address'
>>
>> Traceback:
>> 1: order(x)
>> aborting ...
>> Bus error
>
> 64-bit version:
>
>> > print(sessionInfo())
>> R version 2.9.2 Patched (2009-09-24 r49861)
>> x86_64-apple-darwin9.8.0
>>
>> locale:
>> en_GB/en_GB/C/C/en_GB/en_GB
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> >
>> > words <- c("aa", "ab", "a\xfc", "a\xe4", "b\xe4", "b\xfc",  
>> "\xe4\xfc")
>> > str(words)
>> chr [1:7] "aa" "ab" "a\xfc" "a\xe4" "b\xe4" "b\xfc" ...
>> > print(table(Encoding(words)))
>>
>> unknown   UTF-8
>>    2       5
>> >
>> > Encoding(words) <- "latin1"  # this is the correct encoding!
>> > print(table(Encoding(words)))
>>
>> latin1 unknown
>>    5       2
>> >
>> > N <- 1000
>> > words <- rep(words, length.out=N)
>> >
>> > print(N)
>> [1] 1000
>> > for (i in 1:N) {
>> +   x <- words[1:i]
>> +   # the following line will crash for some i, depending on the  
>> particular
>> +   # strings in <words> and the subset selected for <x> above
>> +   order(x)
>> + }
>> Error in order(x) : 'translateCharUTF8' must be called on a CHARSXP
>> Execution halted
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From simon.urbanek at r-project.org  Wed Sep 30 16:58:32 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 30 Sep 2009 10:58:32 -0400
Subject: [Rd] How to compile R with command completion?
In-Reply-To: <366c6f340909300713v5354d451p26cd8e86ff678e@mail.gmail.com>
References: <366c6f340909291134w1b253caeje00a3054ef35e619@mail.gmail.com>
	<4AC27267.2060007@gmail.com>
	<366c6f340909291946u545c024fyf0ac54e002e3927@mail.gmail.com>
	<4AC2D2E8.8040208@fhcrc.org>
	<366c6f340909300526s3470a4eep63c92eb67f24270b@mail.gmail.com>
	<4AC361CA.3010206@fhcrc.org>
	<366c6f340909300713v5354d451p26cd8e86ff678e@mail.gmail.com>
Message-ID: <B4579565-640A-426B-BC09-9DB4F8FEC660@r-project.org>


On Sep 30, 2009, at 10:13 , Peng Yu wrote:

> I compiled R-2.9.2 from source on Cent OS. But the compile R program
> does not support command completion.
>
> I get the following configure output that is related to readline. Why
> 'rl_completion_matches' doesn't exist?

Maybe your readline is too old? Maybe you have a readline-replacement  
library (e.g. libedit) that poses as readline? Try installing some  
recent readline (incl. -dev part) - the current version is 6.0. If  
that doesn't help, look at config.log around the rl_completion_matches.

Cheers,
Simon


> How should I make R support
> command completion?
>
> ===================
> checking readline/history.h usability... yes
> checking readline/history.h presence... yes
> checking for readline/history.h... yes
> checking readline/readline.h usability... yes
> checking readline/readline.h presence... yes
> checking for readline/readline.h... yes
> checking for rl_callback_read_char in -lreadline... no
> checking for main in -lncurses... yes
> checking for rl_callback_read_char in -lreadline... yes
> checking for history_truncate_file... yes
> checking whether rl_completion_matches exists and is declared... no
>
>
> checking readline/history.h usability... yes
> checking readline/history.h presence... yes
> checking for readline/history.h... yes
> checking readline/readline.h usability... yes
> checking readline/readline.h presence... yes
> checking for readline/readline.h... yes
> checking for rl_callback_read_char in -lreadline... no
> checking for main in -lncurses... yes
> checking for rl_callback_read_char in -lreadline... yes
> checking for history_truncate_file... yes
> checking whether rl_completion_matches exists and is declared... no
> =====================
>
>
> Here is my sessionInfo() of the compiled R.
> =========================
> $ R
>
> R version 2.9.2 (2009-08-24)
> Copyright (C) 2009 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
>  Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
>
>> sessionInfo()
> R version 2.9.2 (2009-08-24)
> x86_64-unknown-linux-gnu
>
> locale:
> LC_CTYPE 
> = 
> en_US 
> .UTF 
> -8 
> ;LC_NUMERIC 
> = 
> C 
> ;LC_TIME 
> = 
> en_US 
> .UTF 
> -8 
> ;LC_COLLATE 
> = 
> en_US 
> .UTF 
> -8 
> ;LC_MONETARY 
> = 
> C 
> ;LC_MESSAGES 
> = 
> en_US 
> .UTF 
> -8 
> ;LC_PAPER 
> = 
> en_US 
> .UTF 
> -8 
> ;LC_NAME 
> = 
> C 
> ;LC_ADDRESS 
> =C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From zong-pei.han at imm.ox.ac.uk  Wed Sep 30 18:36:43 2009
From: zong-pei.han at imm.ox.ac.uk (zong-pei.han at imm.ox.ac.uk)
Date: Wed, 30 Sep 2009 17:36:43 +0100 (BST)
Subject: [Rd] Installation problem from R 2.8.x
Message-ID: <Pine.LNX.4.64.0909301726210.17114@raven.linux.ox.ac.uk>

Dear Developers,

Since 2.8, R installation has got a bug in it such
that if a package has a "configure" file then it
cannot be installed without modification.

For example:

* Installing *source* package 'foreign' ...
ERROR: 'configure' exists but is not executable --
see the 'R Installation and Adminstration Manual'
* Removing '/usr/local/source_code/Linux/R/R-2.9.2/library/foreign'
make[2]: *** [foreign.ts] Error 1

In fact, 'configure' is executable!!! So I have to manually
run 'configure', remove 'configure', and then repackage
foreign_0.8-37.tar.gz so it can be installed.

This bug makes it very time consuming to add any package
which has a 'configure' in it. And the bug seems to be
in  src/library/tools/R/install.R

Regards,

Dr Zong-Pei Han
UNIX Systems Administrator
Computational Biology Research Group
University of Oxford
http://www.cbrg.ox.ac.uk/


From ligges at statistik.tu-dortmund.de  Wed Sep 30 18:48:31 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 30 Sep 2009 18:48:31 +0200
Subject: [Rd] Installation problem from R 2.8.x
In-Reply-To: <Pine.LNX.4.64.0909301726210.17114@raven.linux.ox.ac.uk>
References: <Pine.LNX.4.64.0909301726210.17114@raven.linux.ox.ac.uk>
Message-ID: <4AC38BDF.6010308@statistik.tu-dortmund.de>

What you call a bug in R has never been reported since R-2.8.0 was 
recent. Hence I guess it is a permission issue on your system.
Or do you think nobody else tried to install a package during the last 
12 months?

Uwe Ligges


zong-pei.han at imm.ox.ac.uk wrote:
> Dear Developers,
> 
> Since 2.8, R installation has got a bug in it such
> that if a package has a "configure" file then it
> cannot be installed without modification.
> 
> For example:
> 
> * Installing *source* package 'foreign' ...
> ERROR: 'configure' exists but is not executable --
> see the 'R Installation and Adminstration Manual'
> * Removing '/usr/local/source_code/Linux/R/R-2.9.2/library/foreign'
> make[2]: *** [foreign.ts] Error 1
> 
> In fact, 'configure' is executable!!! So I have to manually
> run 'configure', remove 'configure', and then repackage
> foreign_0.8-37.tar.gz so it can be installed.
> 
> This bug makes it very time consuming to add any package
> which has a 'configure' in it. And the bug seems to be
> in  src/library/tools/R/install.R
> 
> Regards,
> 
> Dr Zong-Pei Han
> UNIX Systems Administrator
> Computational Biology Research Group
> University of Oxford
> http://www.cbrg.ox.ac.uk/
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From wdunlap at tibco.com  Wed Sep 30 19:30:32 2009
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 30 Sep 2009 10:30:32 -0700
Subject: [Rd] Installation problem from R 2.8.x
In-Reply-To: <4AC38BDF.6010308@statistik.tu-dortmund.de>
References: <Pine.LNX.4.64.0909301726210.17114@raven.linux.ox.ac.uk>
	<4AC38BDF.6010308@statistik.tu-dortmund.de>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D70001E5F4AF@NA-PA-VBE03.na.tibco.com>

In September 2009 Matias Silva reported a execution permission
problem during a package installation (look in the r-devel archives
for ' [Rd] Installing rJava RJDBC bad interpreter: Permission denied').
It was due to the fstab file marking /tmp as noexec, hence nothing
in /tmp was executable, regardless of its file mode.  Since the package
was copied to /tmp before compilation he ran into the problem.
I think he worked around it by setting TMPDIR=/var/tmp, where /var/tmp
did not have this restriction, before doing the install.  His error
message was different but you might be having a similar problem.

Bill Dunlap
TIBCO Software Inc - Spotfire Division
wdunlap tibco.com  

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Uwe Ligges
> Sent: Wednesday, September 30, 2009 9:49 AM
> To: zong-pei.han at imm.ox.ac.uk
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] Installation problem from R 2.8.x
> 
> What you call a bug in R has never been reported since R-2.8.0 was 
> recent. Hence I guess it is a permission issue on your system.
> Or do you think nobody else tried to install a package during 
> the last 
> 12 months?
> 
> Uwe Ligges
> 
> 
> zong-pei.han at imm.ox.ac.uk wrote:
> > Dear Developers,
> > 
> > Since 2.8, R installation has got a bug in it such
> > that if a package has a "configure" file then it
> > cannot be installed without modification.
> > 
> > For example:
> > 
> > * Installing *source* package 'foreign' ...
> > ERROR: 'configure' exists but is not executable --
> > see the 'R Installation and Adminstration Manual'
> > * Removing '/usr/local/source_code/Linux/R/R-2.9.2/library/foreign'
> > make[2]: *** [foreign.ts] Error 1
> > 
> > In fact, 'configure' is executable!!! So I have to manually
> > run 'configure', remove 'configure', and then repackage
> > foreign_0.8-37.tar.gz so it can be installed.
> > 
> > This bug makes it very time consuming to add any package
> > which has a 'configure' in it. And the bug seems to be
> > in  src/library/tools/R/install.R
> > 
> > Regards,
> > 
> > Dr Zong-Pei Han
> > UNIX Systems Administrator
> > Computational Biology Research Group
> > University of Oxford
> > http://www.cbrg.ox.ac.uk/
> > 
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From MSilva at specificmedia.com  Wed Sep 30 20:14:37 2009
From: MSilva at specificmedia.com (Matias Silva)
Date: Wed, 30 Sep 2009 11:14:37 -0700
Subject: [Rd] Installation problem from R 2.8.x
In-Reply-To: <77EB52C6DD32BA4D87471DCD70C8D70001E5F4AF@NA-PA-VBE03.na.tibco.com>
References: <Pine.LNX.4.64.0909301726210.17114@raven.linux.ox.ac.uk>
	<4AC38BDF.6010308@statistik.tu-dortmund.de>
	<77EB52C6DD32BA4D87471DCD70C8D70001E5F4AF@NA-PA-VBE03.na.tibco.com>
Message-ID: <1D39027E38D41B4C91702F159EF19160239F15AF46@west-corp-ex02.specificmedia.local>

Hi, this is correct.  I had to set the TMPDIR and also set the JAVA_HOME to the root of the 
JDK Java directory and not the JRE for the packages that depend on Java...

[root at localhost ~]# export TMPDIR=/var/tmp
[root at localhost ~]# export JAVA_HOME=/usr/java/latest

I'M running on a CentOS (RHEL) system and installed the rpm version of R and JDK.

I hope this helps.

Best,
Matias

-----Original Message-----
From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-project.org] On Behalf Of William Dunlap
Sent: Wednesday, September 30, 2009 10:31 AM
To: Uwe Ligges; zong-pei.han at imm.ox.ac.uk
Cc: r-devel at r-project.org
Subject: Re: [Rd] Installation problem from R 2.8.x

In September 2009 Matias Silva reported a execution permission
problem during a package installation (look in the r-devel archives
for ' [Rd] Installing rJava RJDBC bad interpreter: Permission denied').
It was due to the fstab file marking /tmp as noexec, hence nothing
in /tmp was executable, regardless of its file mode.  Since the package
was copied to /tmp before compilation he ran into the problem.
I think he worked around it by setting TMPDIR=/var/tmp, where /var/tmp
did not have this restriction, before doing the install.  His error
message was different but you might be having a similar problem.

Bill Dunlap
TIBCO Software Inc - Spotfire Division
wdunlap tibco.com  

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Uwe Ligges
> Sent: Wednesday, September 30, 2009 9:49 AM
> To: zong-pei.han at imm.ox.ac.uk
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] Installation problem from R 2.8.x
> 
> What you call a bug in R has never been reported since R-2.8.0 was 
> recent. Hence I guess it is a permission issue on your system.
> Or do you think nobody else tried to install a package during 
> the last 
> 12 months?
> 
> Uwe Ligges
> 
> 
> zong-pei.han at imm.ox.ac.uk wrote:
> > Dear Developers,
> > 
> > Since 2.8, R installation has got a bug in it such
> > that if a package has a "configure" file then it
> > cannot be installed without modification.
> > 
> > For example:
> > 
> > * Installing *source* package 'foreign' ...
> > ERROR: 'configure' exists but is not executable --
> > see the 'R Installation and Adminstration Manual'
> > * Removing '/usr/local/source_code/Linux/R/R-2.9.2/library/foreign'
> > make[2]: *** [foreign.ts] Error 1
> > 
> > In fact, 'configure' is executable!!! So I have to manually
> > run 'configure', remove 'configure', and then repackage
> > foreign_0.8-37.tar.gz so it can be installed.
> > 
> > This bug makes it very time consuming to add any package
> > which has a 'configure' in it. And the bug seems to be
> > in  src/library/tools/R/install.R
> > 
> > Regards,
> > 
> > Dr Zong-Pei Han
> > UNIX Systems Administrator
> > Computational Biology Research Group
> > University of Oxford
> > http://www.cbrg.ox.ac.uk/
> > 
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From nikko at hailmail.net  Wed Sep 30 20:29:06 2009
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Wed, 30 Sep 2009 11:29:06 -0700
Subject: [Rd] buglet in is.na?
Message-ID: <1254335346.8321.1337412857@webmail.messagingengine.com>

Hi
the following example I think demonstrates the inconsistency
> f<-function(x) x
> length(f)
[1] 1
> is.na(f)
[1] FALSE
Warning message:
In is.na(f) : is.na() applied to non-(list or vector) of type 'closure'

The documentation states:
Arguments
x       an R object to be tested.
value   a suitable index vector for use with x.

And nowhere in the details was it implied (to me anyway) that x could
not be a function
or anything else in R for that matter. Did I miss something?

Nicholas


From murdoch at stats.uwo.ca  Wed Sep 30 20:41:08 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 30 Sep 2009 14:41:08 -0400
Subject: [Rd] buglet in is.na?
In-Reply-To: <1254335346.8321.1337412857@webmail.messagingengine.com>
References: <1254335346.8321.1337412857@webmail.messagingengine.com>
Message-ID: <4AC3A644.4050507@stats.uwo.ca>

On 9/30/2009 2:29 PM, Nicholas Lewin-Koh wrote:
> Hi
> the following example I think demonstrates the inconsistency
>> f<-function(x) x
>> length(f)
> [1] 1
>> is.na(f)
> [1] FALSE
> Warning message:
> In is.na(f) : is.na() applied to non-(list or vector) of type 'closure'

As the error message says, closures aren't vectors.  However, they do 
have a length.

> The documentation states:
> Arguments
> x       an R object to be tested.
> value   a suitable index vector for use with x.
> 
> And nowhere in the details was it implied (to me anyway) that x could
> not be a function
> or anything else in R for that matter. Did I miss something?

This might be an omission from the docs, but it did say pretty clearly 
in the warning message that x needs to be a vector.  So it's not a bug.

The source for the docs is in

https://svn.r-project.org/R/trunk/src/library/base/man/NA.rd

If you can think of a way to make it clearer, and you think this is the 
sort of error someone would not understand given the warning message, 
please submit a patch.

Duncan Murdoch


From p.dalgaard at biostat.ku.dk  Wed Sep 30 20:56:19 2009
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed, 30 Sep 2009 20:56:19 +0200
Subject: [Rd] buglet in is.na?
In-Reply-To: <1254335346.8321.1337412857@webmail.messagingengine.com>
References: <1254335346.8321.1337412857@webmail.messagingengine.com>
Message-ID: <4AC3A9D3.2010607@biostat.ku.dk>

Nicholas Lewin-Koh wrote:
> Hi
> the following example I think demonstrates the inconsistency
>> f<-function(x) x
>> length(f)
> [1] 1
>> is.na(f)
> [1] FALSE
> Warning message:
> In is.na(f) : is.na() applied to non-(list or vector) of type 'closure'
> 
> The documentation states:
> Arguments
> x       an R object to be tested.
> value   a suitable index vector for use with x.
> 
> And nowhere in the details was it implied (to me anyway) that x could
> not be a function
> or anything else in R for that matter. Did I miss something?
> 

Well, it's just a warning which you get whenever you apply is.na to 
things that cannot logically be NA, e.g.

 > is.na(.GlobalEnv)
[1] FALSE FALSE
Warning message:
In is.na(.GlobalEnv) :
   is.na() applied to non-(list or vector) of type 'environment'
 > is.na(quote(a))
[1] FALSE
Warning message:
In is.na(quote(a)) :
   is.na() applied to non-(list or vector) of type 'symbol'
 > is.na(quote(`NA`))
[1] FALSE
Warning message:
In is.na(quote(`NA`)) :
   is.na() applied to non-(list or vector) of type 'symbol'
 > is.na(is.na)
[1] FALSE
Warning message:
In is.na(is.na) : is.na() applied to non-(list or vector) of type 'builtin'

I suppose the documentation could be more explicit about it, but where's 
the need?

-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From neilt at neiltiffin.com  Wed Sep 30 14:02:54 2009
From: neilt at neiltiffin.com (Neil Tiffin)
Date: Wed, 30 Sep 2009 07:02:54 -0500
Subject: [Rd] unable to load shared library (Symbol not found:
	_PQbackendPID)
In-Reply-To: <19138.45749.671652.380175@ron.nulle.part>
References: <44FD7002-2943-4449-B98C-130724DA6AB8@forestinformatics.com>
	<19138.45749.671652.380175@ron.nulle.part>
Message-ID: <F7DA7F85-8FCB-430F-8E86-83DEA90DB150@neiltiffin.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090930/71b43799/attachment.pl>

From nikko at hailmail.net  Wed Sep 30 22:29:53 2009
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Wed, 30 Sep 2009 13:29:53 -0700
Subject: [Rd] buglet in is.na?
In-Reply-To: <4AC3A644.4050507@stats.uwo.ca>
References: <1254335346.8321.1337412857@webmail.messagingengine.com>
	<4AC3A644.4050507@stats.uwo.ca>
Message-ID: <1254342593.29386.1337432385@webmail.messagingengine.com>

Hmm, Well the error message is clear, perhaps in the docs:
x  a array, matrix, list or data.frame

I realize that this is minor, but is the warning necessary?
f is a function not an NA, so FALSE, as would anything else
that is not an NA.

Though this may just be bad programming practice on my part,
I have a member of an object that can be an integer, a function
returning an integer
or NA, perhaps it would be better to specify it as an integer, a
function or NULL.

Nicholas


On Wed, 30 Sep 2009 14:41 -0400, "Duncan Murdoch" <murdoch at stats.uwo.ca>
wrote:
> On 9/30/2009 2:29 PM, Nicholas Lewin-Koh wrote:
> > Hi
> > the following example I think demonstrates the inconsistency
> >> f<-function(x) x
> >> length(f)
> > [1] 1
> >> is.na(f)
> > [1] FALSE
> > Warning message:
> > In is.na(f) : is.na() applied to non-(list or vector) of type 'closure'
> 
> As the error message says, closures aren't vectors.  However, they do 
> have a length.
> 
> > The documentation states:
> > Arguments
> > x       an R object to be tested.
> > value   a suitable index vector for use with x.
> > 
> > And nowhere in the details was it implied (to me anyway) that x could
> > not be a function
> > or anything else in R for that matter. Did I miss something?
> 
> This might be an omission from the docs, but it did say pretty clearly 
> in the warning message that x needs to be a vector.  So it's not a bug.
> 
> The source for the docs is in
> 
> https://svn.r-project.org/R/trunk/src/library/base/man/NA.rd
> 
> If you can think of a way to make it clearer, and you think this is the 
> sort of error someone would not understand given the warning message, 
> please submit a patch.
> 
> Duncan Murdoch


From pengyu.ut at gmail.com  Wed Sep 30 22:30:22 2009
From: pengyu.ut at gmail.com (Peng Yu)
Date: Wed, 30 Sep 2009 15:30:22 -0500
Subject: [Rd] How to compile R with command completion?
In-Reply-To: <B4579565-640A-426B-BC09-9DB4F8FEC660@r-project.org>
References: <366c6f340909291134w1b253caeje00a3054ef35e619@mail.gmail.com>
	<4AC27267.2060007@gmail.com>
	<366c6f340909291946u545c024fyf0ac54e002e3927@mail.gmail.com>
	<4AC2D2E8.8040208@fhcrc.org>
	<366c6f340909300526s3470a4eep63c92eb67f24270b@mail.gmail.com>
	<4AC361CA.3010206@fhcrc.org>
	<366c6f340909300713v5354d451p26cd8e86ff678e@mail.gmail.com>
	<B4579565-640A-426B-BC09-9DB4F8FEC660@r-project.org>
Message-ID: <366c6f340909301330u69db2352k4adf7dfd72204233@mail.gmail.com>

On Wed, Sep 30, 2009 at 9:58 AM, Simon Urbanek
<simon.urbanek at r-project.org> wrote:
>
> On Sep 30, 2009, at 10:13 , Peng Yu wrote:
>
>> I compiled R-2.9.2 from source on Cent OS. But the compile R program
>> does not support command completion.
>>
>> I get the following configure output that is related to readline. Why
>> 'rl_completion_matches' doesn't exist?
>
> Maybe your readline is too old? Maybe you have a readline-replacement
> library (e.g. libedit) that poses as readline? Try installing some recent
> readline (incl. -dev part) - the current version is 6.0. If that doesn't
> help, look at config.log around the rl_completion_matches.

I have installed readline 6.0.

$ ls /home/pengy/utility/linux/lib/libreadline.*
/home/pengy/utility/linux/lib/libreadline.a
/home/pengy/utility/linux/lib/libreadline.so
/home/pengy/utility/linux/lib/libreadline.so.6
/home/pengy/utility/linux/lib/libreadline.so.6.0
$ ls /home/pengy/utility/linux/lib/libhistory.*
/home/pengy/utility/linux/lib/libhistory.a
/home/pengy/utility/linux/lib/libhistory.so
/home/pengy/utility/linux/lib/libhistory.so.6
/home/pengy/utility/linux/lib/libhistory.so.6.0

But R still doesn't configure it correctly. Would you please what
might be the problem?

Regards,
Peng

configure:22192: checking whether rl_completion_matches exists and is declared
configure:22224: gcc -o conftest
-I/home/pengy/utility/linux/opt/gcc-4.3.4/include
-I/home/pengy/utility/linux/include
-I/home/pengy/utility/linux/usr/local/Trolltech/Qt-4.5.2/include
-I/home/pengy/utility/linux/opt/Python-2.6.2/include/python2.6
-I/home/pengy/utility/linux/opt/gcc-4.3.4/include
-I/home/pengy/utility/linux/include
-L/home/pengy/utility/linux/usr/local/Trolltech/Qt-4.5.2/lib
-L/home/pengy/utility/linux/opt/R-2.9.2/lib64/R/lib
-L/home/pengy/utility/linux/opt/Python-2.6.2/lib
-L/home/pengy/utility/linux/opt/gcc-4.3.4/lib64
-L/home/pengy/download/linux/qtsdk-2009.03/lib
-L/home/pengy/utility/linux/lib64 -L/home/pengy/utility/linux/lib64
-L/home/pengy/utility/linux/lib conftest.c -ldl -lm  >&5
/home/pengy/.tmp/ccpZyEGH.o: In function `main':
conftest.c:(.text+0x8): undefined reference to `rl_completion_matches'
collect2: ld returned 1 exit status
configure:22230: $? = 1
configure: failed program was:
| /* confdefs.h.  */
| #define PACKAGE_NAME "R"
| #define PACKAGE_TARNAME "R"
| #define PACKAGE_VERSION "2.9.2"
| #define PACKAGE_STRING "R 2.9.2"
| #define PACKAGE_BUGREPORT "r-bugs at R-project.org"
| #define PACKAGE "R"
| #define VERSION "2.9.2"
| #define R_PLATFORM "x86_64-unknown-linux-gnu"
| #define R_CPU "x86_64"
| #define R_VENDOR "unknown"
| #define R_OS "linux-gnu"
| #define Unix 1
| #define R_ARCH ""
| #define HAVE_VISIBILITY_ATTRIBUTE 1
| #define _GNU_SOURCE 1
| #define STDC_HEADERS 1
| #define HAVE_SYS_TYPES_H 1
| #define HAVE_SYS_STAT_H 1
| #define HAVE_STDLIB_H 1
| #define HAVE_STRING_H 1
| #define HAVE_MEMORY_H 1
| #define HAVE_STRINGS_H 1
| #define HAVE_INTTYPES_H 1
| #define HAVE_STDINT_H 1
| #define HAVE_UNISTD_H 1
| #define HAVE_DLFCN_H 1
| #define LT_OBJDIR ".libs/"
| #define HAVE_LIBM 1
| #define HAVE_LIBDL 1
| #define HAVE_READLINE_HISTORY_H 1
| #define HAVE_READLINE_READLINE_H 1
| #define HAVE_LIBNCURSES 1
| #define HAVE_LIBREADLINE 1
| #define HAVE_HISTORY_TRUNCATE_FILE 1
| /* end confdefs.h.  */
| #include <stdio.h>
| #include <readline/readline.h>
|
|
| int
| main ()
| {
| #ifndef rl_completion_matches
|   char *p = (char *) rl_completion_matches;
| #endif
|
|   ;
|   return 0;
| }
configure:22248: result: no


From murdoch at stats.uwo.ca  Wed Sep 30 22:44:14 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 30 Sep 2009 16:44:14 -0400
Subject: [Rd] buglet in is.na?
In-Reply-To: <1254342593.29386.1337432385@webmail.messagingengine.com>
References: <1254335346.8321.1337412857@webmail.messagingengine.com>
	<4AC3A644.4050507@stats.uwo.ca>
	<1254342593.29386.1337432385@webmail.messagingengine.com>
Message-ID: <4AC3C31E.8020706@stats.uwo.ca>

On 9/30/2009 4:29 PM, Nicholas Lewin-Koh wrote:
> Hmm, Well the error message is clear, perhaps in the docs:
> x  a array, matrix, list or data.frame

But that misses the usual case, where x is a vector.
> 
> I realize that this is minor, but is the warning necessary?
> f is a function not an NA, so FALSE, as would anything else
> that is not an NA.

I think the reason for the warning is that it usually indicates that the 
programmer is confused.  Why would you pass a function to something 
looking for missing values?

> Though this may just be bad programming practice on my part,
> I have a member of an object that can be an integer, a function
> returning an integer
> or NA, perhaps it would be better to specify it as an integer, a
> function or NULL.

Or you could use identical(x, NA) (but watch out for the different 
flavours of NA, which are not identical).  But aren't you going to be in 
trouble if someone passes in a vector of numbers, some of which are NA 
and some of which are not?

Duncan Murdoch

> 
> Nicholas
> 
> 
> On Wed, 30 Sep 2009 14:41 -0400, "Duncan Murdoch" <murdoch at stats.uwo.ca>
> wrote:
>> On 9/30/2009 2:29 PM, Nicholas Lewin-Koh wrote:
>> > Hi
>> > the following example I think demonstrates the inconsistency
>> >> f<-function(x) x
>> >> length(f)
>> > [1] 1
>> >> is.na(f)
>> > [1] FALSE
>> > Warning message:
>> > In is.na(f) : is.na() applied to non-(list or vector) of type 'closure'
>> 
>> As the error message says, closures aren't vectors.  However, they do 
>> have a length.
>> 
>> > The documentation states:
>> > Arguments
>> > x       an R object to be tested.
>> > value   a suitable index vector for use with x.
>> > 
>> > And nowhere in the details was it implied (to me anyway) that x could
>> > not be a function
>> > or anything else in R for that matter. Did I miss something?
>> 
>> This might be an omission from the docs, but it did say pretty clearly 
>> in the warning message that x needs to be a vector.  So it's not a bug.
>> 
>> The source for the docs is in
>> 
>> https://svn.r-project.org/R/trunk/src/library/base/man/NA.rd
>> 
>> If you can think of a way to make it clearer, and you think this is the 
>> sort of error someone would not understand given the warning message, 
>> please submit a patch.
>> 
>> Duncan Murdoch


From simon.urbanek at r-project.org  Wed Sep 30 22:47:21 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 30 Sep 2009 16:47:21 -0400
Subject: [Rd] How to compile R with command completion?
In-Reply-To: <366c6f340909301330u69db2352k4adf7dfd72204233@mail.gmail.com>
References: <366c6f340909291134w1b253caeje00a3054ef35e619@mail.gmail.com>
	<4AC27267.2060007@gmail.com>
	<366c6f340909291946u545c024fyf0ac54e002e3927@mail.gmail.com>
	<4AC2D2E8.8040208@fhcrc.org>
	<366c6f340909300526s3470a4eep63c92eb67f24270b@mail.gmail.com>
	<4AC361CA.3010206@fhcrc.org>
	<366c6f340909300713v5354d451p26cd8e86ff678e@mail.gmail.com>
	<B4579565-640A-426B-BC09-9DB4F8FEC660@r-project.org>
	<366c6f340909301330u69db2352k4adf7dfd72204233@mail.gmail.com>
Message-ID: <F99C1252-65CE-415A-A243-7C28F4716E3F@r-project.org>

Peng,

as you can see there is no -lreadline so I'd look further up in  
config.log to see why it's failing -- do you have LD_LIBRARY_PATH  
setup to match your custom location of libs? (Also I notice you are  
building x86_64 yet the readline you are showing is in /lib and not  
in /lib64 -- did you build it just in 32-bit?)

Cheers,
Simon


On Sep 30, 2009, at 16:30 , Peng Yu wrote:

> On Wed, Sep 30, 2009 at 9:58 AM, Simon Urbanek
> <simon.urbanek at r-project.org> wrote:
>>
>> On Sep 30, 2009, at 10:13 , Peng Yu wrote:
>>
>>> I compiled R-2.9.2 from source on Cent OS. But the compile R program
>>> does not support command completion.
>>>
>>> I get the following configure output that is related to readline.  
>>> Why
>>> 'rl_completion_matches' doesn't exist?
>>
>> Maybe your readline is too old? Maybe you have a readline-replacement
>> library (e.g. libedit) that poses as readline? Try installing some  
>> recent
>> readline (incl. -dev part) - the current version is 6.0. If that  
>> doesn't
>> help, look at config.log around the rl_completion_matches.
>
> I have installed readline 6.0.
>
> $ ls /home/pengy/utility/linux/lib/libreadline.*
> /home/pengy/utility/linux/lib/libreadline.a
> /home/pengy/utility/linux/lib/libreadline.so
> /home/pengy/utility/linux/lib/libreadline.so.6
> /home/pengy/utility/linux/lib/libreadline.so.6.0
> $ ls /home/pengy/utility/linux/lib/libhistory.*
> /home/pengy/utility/linux/lib/libhistory.a
> /home/pengy/utility/linux/lib/libhistory.so
> /home/pengy/utility/linux/lib/libhistory.so.6
> /home/pengy/utility/linux/lib/libhistory.so.6.0
>
> But R still doesn't configure it correctly. Would you please what
> might be the problem?
>
> Regards,
> Peng
>
> configure:22192: checking whether rl_completion_matches exists and  
> is declared
> configure:22224: gcc -o conftest
> -I/home/pengy/utility/linux/opt/gcc-4.3.4/include
> -I/home/pengy/utility/linux/include
> -I/home/pengy/utility/linux/usr/local/Trolltech/Qt-4.5.2/include
> -I/home/pengy/utility/linux/opt/Python-2.6.2/include/python2.6
> -I/home/pengy/utility/linux/opt/gcc-4.3.4/include
> -I/home/pengy/utility/linux/include
> -L/home/pengy/utility/linux/usr/local/Trolltech/Qt-4.5.2/lib
> -L/home/pengy/utility/linux/opt/R-2.9.2/lib64/R/lib
> -L/home/pengy/utility/linux/opt/Python-2.6.2/lib
> -L/home/pengy/utility/linux/opt/gcc-4.3.4/lib64
> -L/home/pengy/download/linux/qtsdk-2009.03/lib
> -L/home/pengy/utility/linux/lib64 -L/home/pengy/utility/linux/lib64
> -L/home/pengy/utility/linux/lib conftest.c -ldl -lm  >&5
> /home/pengy/.tmp/ccpZyEGH.o: In function `main':
> conftest.c:(.text+0x8): undefined reference to `rl_completion_matches'
> collect2: ld returned 1 exit status
> configure:22230: $? = 1
> configure: failed program was:
> | /* confdefs.h.  */
> | #define PACKAGE_NAME "R"
> | #define PACKAGE_TARNAME "R"
> | #define PACKAGE_VERSION "2.9.2"
> | #define PACKAGE_STRING "R 2.9.2"
> | #define PACKAGE_BUGREPORT "r-bugs at R-project.org"
> | #define PACKAGE "R"
> | #define VERSION "2.9.2"
> | #define R_PLATFORM "x86_64-unknown-linux-gnu"
> | #define R_CPU "x86_64"
> | #define R_VENDOR "unknown"
> | #define R_OS "linux-gnu"
> | #define Unix 1
> | #define R_ARCH ""
> | #define HAVE_VISIBILITY_ATTRIBUTE 1
> | #define _GNU_SOURCE 1
> | #define STDC_HEADERS 1
> | #define HAVE_SYS_TYPES_H 1
> | #define HAVE_SYS_STAT_H 1
> | #define HAVE_STDLIB_H 1
> | #define HAVE_STRING_H 1
> | #define HAVE_MEMORY_H 1
> | #define HAVE_STRINGS_H 1
> | #define HAVE_INTTYPES_H 1
> | #define HAVE_STDINT_H 1
> | #define HAVE_UNISTD_H 1
> | #define HAVE_DLFCN_H 1
> | #define LT_OBJDIR ".libs/"
> | #define HAVE_LIBM 1
> | #define HAVE_LIBDL 1
> | #define HAVE_READLINE_HISTORY_H 1
> | #define HAVE_READLINE_READLINE_H 1
> | #define HAVE_LIBNCURSES 1
> | #define HAVE_LIBREADLINE 1
> | #define HAVE_HISTORY_TRUNCATE_FILE 1
> | /* end confdefs.h.  */
> | #include <stdio.h>
> | #include <readline/readline.h>
> |
> |
> | int
> | main ()
> | {
> | #ifndef rl_completion_matches
> |   char *p = (char *) rl_completion_matches;
> | #endif
> |
> |   ;
> |   return 0;
> | }
> configure:22248: result: no
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From pengyu.ut at gmail.com  Wed Sep 30 23:35:36 2009
From: pengyu.ut at gmail.com (Peng Yu)
Date: Wed, 30 Sep 2009 16:35:36 -0500
Subject: [Rd] How to compile R with command completion?
In-Reply-To: <F99C1252-65CE-415A-A243-7C28F4716E3F@r-project.org>
References: <366c6f340909291134w1b253caeje00a3054ef35e619@mail.gmail.com>
	<4AC27267.2060007@gmail.com>
	<366c6f340909291946u545c024fyf0ac54e002e3927@mail.gmail.com>
	<4AC2D2E8.8040208@fhcrc.org>
	<366c6f340909300526s3470a4eep63c92eb67f24270b@mail.gmail.com>
	<4AC361CA.3010206@fhcrc.org>
	<366c6f340909300713v5354d451p26cd8e86ff678e@mail.gmail.com>
	<B4579565-640A-426B-BC09-9DB4F8FEC660@r-project.org>
	<366c6f340909301330u69db2352k4adf7dfd72204233@mail.gmail.com>
	<F99C1252-65CE-415A-A243-7C28F4716E3F@r-project.org>
Message-ID: <366c6f340909301435r42406619kdcd335d5bab58131@mail.gmail.com>

I didn't change anything except --prefix when I compile readline. Here
is my $LD_LIBRARY_PATH which has the directory where libreadline.so is
in. I also copied 'conftest.c' to a temp dir and compiled it with
-lreadline and -lcurses (this is manual testing, not using configure).
The problem of "conftest.c:(.text+0x8): undefined reference to
`rl_completion_matches'" is resolved.

Why '-lreadline' and '-lcurses' are not in the command called by
'configure'? Is this a bug in configure? How should I fix it?

$ echo $LD_LIBRARY_PATH
/home/pengy/utility/linux/usr/local/Trolltech/Qt-4.5.2/lib:/home/pengy/utility/linux/opt/R-2.9.2/lib64/R/lib:/home/pengy/utility/linux/opt/gcc-4.3.4/lib64:/home/pengy/utility/linux/opt/gcc-4.3.4/lib:/home/pengy/download/linux/qtsdk-2009.03/lib:/home/pengy/utility/linux/lib64:/home/pengy/utility/linux/lib


$ cat conftest.c
/* confdefs.h.  */
#define PACKAGE_NAME "R"
#define PACKAGE_TARNAME "R"
#define PACKAGE_VERSION "2.9.2"
#define PACKAGE_STRING "R 2.9.2"
#define PACKAGE_BUGREPORT "r-bugs at R-project.org"
#define PACKAGE "R"
#define VERSION "2.9.2"
#define R_PLATFORM "x86_64-unknown-linux-gnu"
#define R_CPU "x86_64"
#define R_VENDOR "unknown"
#define R_OS "linux-gnu"
#define Unix 1
#define R_ARCH ""
#define HAVE_VISIBILITY_ATTRIBUTE 1
#define _GNU_SOURCE 1
#define STDC_HEADERS 1
#define HAVE_SYS_TYPES_H 1
#define HAVE_SYS_STAT_H 1
#define HAVE_STDLIB_H 1
#define HAVE_STRING_H 1
#define HAVE_MEMORY_H 1
#define HAVE_STRINGS_H 1
#define HAVE_INTTYPES_H 1
#define HAVE_STDINT_H 1
#define HAVE_UNISTD_H 1
#define HAVE_DLFCN_H 1
#define LT_OBJDIR ".libs/"
#define HAVE_LIBM 1
#define HAVE_LIBDL 1
#define HAVE_READLINE_HISTORY_H 1
#define HAVE_READLINE_READLINE_H 1
#define HAVE_LIBNCURSES 1
#define HAVE_LIBREADLINE 1
#define HAVE_HISTORY_TRUNCATE_FILE 1
/* end confdefs.h.  */
#include <stdio.h>
#include <readline/readline.h>


int
main ()
{
#ifndef rl_completion_matches
  char *p = (char *) rl_completion_matches;
#endif

  ;
  return 0;
}

$ gcc -o conftest -I/home/pengy/utility/linux/opt/gcc-4.3.4/include
-I/home/pengy/utility/linux/include
-I/home/pengy/utility/linux/usr/local/Trolltech/Qt-4.5.2/include
-I/home/pengy/utility/linux/opt/Python-2.6.2/include/python2.6
-I/home/pengy/utility/linux/opt/gcc-4.3.4/include
-I/home/pengy/utility/linux/include
-L/home/pengy/utility/linux/usr/local/Trolltech/Qt-4.5.2/lib
-L/home/pengy/utility/linux/opt/R-2.9.2/lib64/R/lib
-L/home/pengy/utility/linux/opt/Python-2.6.2/lib
-L/home/pengy/utility/linux/opt/gcc-4.3.4/lib64
-L/home/pengy/download/linux/qtsdk-2009.03/lib
-L/home/pengy/utility/linux/lib64 -L/home/pengy/utility/linux/lib64
-L/home/pengy/utility/linux/lib conftest.c -lreadline -ldl -lm
-lcurses

On Wed, Sep 30, 2009 at 3:47 PM, Simon Urbanek
<simon.urbanek at r-project.org> wrote:
> Peng,
>
> as you can see there is no -lreadline so I'd look further up in config.log
> to see why it's failing -- do you have LD_LIBRARY_PATH setup to match your
> custom location of libs? (Also I notice you are building x86_64 yet the
> readline you are showing is in /lib and not in /lib64 -- did you build it
> just in 32-bit?)
>
> Cheers,
> Simon
>
>
> On Sep 30, 2009, at 16:30 , Peng Yu wrote:
>
>> On Wed, Sep 30, 2009 at 9:58 AM, Simon Urbanek
>> <simon.urbanek at r-project.org> wrote:
>>>
>>> On Sep 30, 2009, at 10:13 , Peng Yu wrote:
>>>
>>>> I compiled R-2.9.2 from source on Cent OS. But the compile R program
>>>> does not support command completion.
>>>>
>>>> I get the following configure output that is related to readline. Why
>>>> 'rl_completion_matches' doesn't exist?
>>>
>>> Maybe your readline is too old? Maybe you have a readline-replacement
>>> library (e.g. libedit) that poses as readline? Try installing some recent
>>> readline (incl. -dev part) - the current version is 6.0. If that doesn't
>>> help, look at config.log around the rl_completion_matches.
>>
>> I have installed readline 6.0.
>>
>> $ ls /home/pengy/utility/linux/lib/libreadline.*
>> /home/pengy/utility/linux/lib/libreadline.a
>> /home/pengy/utility/linux/lib/libreadline.so
>> /home/pengy/utility/linux/lib/libreadline.so.6
>> /home/pengy/utility/linux/lib/libreadline.so.6.0
>> $ ls /home/pengy/utility/linux/lib/libhistory.*
>> /home/pengy/utility/linux/lib/libhistory.a
>> /home/pengy/utility/linux/lib/libhistory.so
>> /home/pengy/utility/linux/lib/libhistory.so.6
>> /home/pengy/utility/linux/lib/libhistory.so.6.0
>>
>> But R still doesn't configure it correctly. Would you please what
>> might be the problem?
>>
>> Regards,
>> Peng
>>
>> configure:22192: checking whether rl_completion_matches exists and is
>> declared
>> configure:22224: gcc -o conftest
>> -I/home/pengy/utility/linux/opt/gcc-4.3.4/include
>> -I/home/pengy/utility/linux/include
>> -I/home/pengy/utility/linux/usr/local/Trolltech/Qt-4.5.2/include
>> -I/home/pengy/utility/linux/opt/Python-2.6.2/include/python2.6
>> -I/home/pengy/utility/linux/opt/gcc-4.3.4/include
>> -I/home/pengy/utility/linux/include
>> -L/home/pengy/utility/linux/usr/local/Trolltech/Qt-4.5.2/lib
>> -L/home/pengy/utility/linux/opt/R-2.9.2/lib64/R/lib
>> -L/home/pengy/utility/linux/opt/Python-2.6.2/lib
>> -L/home/pengy/utility/linux/opt/gcc-4.3.4/lib64
>> -L/home/pengy/download/linux/qtsdk-2009.03/lib
>> -L/home/pengy/utility/linux/lib64 -L/home/pengy/utility/linux/lib64
>> -L/home/pengy/utility/linux/lib conftest.c -ldl -lm ?>&5
>> /home/pengy/.tmp/ccpZyEGH.o: In function `main':
>> conftest.c:(.text+0x8): undefined reference to `rl_completion_matches'
>> collect2: ld returned 1 exit status
>> configure:22230: $? = 1
>> configure: failed program was:
>> | /* confdefs.h. ?*/
>> | #define PACKAGE_NAME "R"
>> | #define PACKAGE_TARNAME "R"
>> | #define PACKAGE_VERSION "2.9.2"
>> | #define PACKAGE_STRING "R 2.9.2"
>> | #define PACKAGE_BUGREPORT "r-bugs at R-project.org"
>> | #define PACKAGE "R"
>> | #define VERSION "2.9.2"
>> | #define R_PLATFORM "x86_64-unknown-linux-gnu"
>> | #define R_CPU "x86_64"
>> | #define R_VENDOR "unknown"
>> | #define R_OS "linux-gnu"
>> | #define Unix 1
>> | #define R_ARCH ""
>> | #define HAVE_VISIBILITY_ATTRIBUTE 1
>> | #define _GNU_SOURCE 1
>> | #define STDC_HEADERS 1
>> | #define HAVE_SYS_TYPES_H 1
>> | #define HAVE_SYS_STAT_H 1
>> | #define HAVE_STDLIB_H 1
>> | #define HAVE_STRING_H 1
>> | #define HAVE_MEMORY_H 1
>> | #define HAVE_STRINGS_H 1
>> | #define HAVE_INTTYPES_H 1
>> | #define HAVE_STDINT_H 1
>> | #define HAVE_UNISTD_H 1
>> | #define HAVE_DLFCN_H 1
>> | #define LT_OBJDIR ".libs/"
>> | #define HAVE_LIBM 1
>> | #define HAVE_LIBDL 1
>> | #define HAVE_READLINE_HISTORY_H 1
>> | #define HAVE_READLINE_READLINE_H 1
>> | #define HAVE_LIBNCURSES 1
>> | #define HAVE_LIBREADLINE 1
>> | #define HAVE_HISTORY_TRUNCATE_FILE 1
>> | /* end confdefs.h. ?*/
>> | #include <stdio.h>
>> | #include <readline/readline.h>
>> |
>> |
>> | int
>> | main ()
>> | {
>> | #ifndef rl_completion_matches
>> | ? char *p = (char *) rl_completion_matches;
>> | #endif
>> |
>> | ? ;
>> | ? return 0;
>> | }
>> configure:22248: result: no
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
>


