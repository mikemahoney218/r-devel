From ligges at statistik.tu-dortmund.de  Wed Jul  1 00:49:51 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 01 Jul 2009 00:49:51 +0200
Subject: [Rd] install.packages with R 2.9.1 under Vista?
In-Reply-To: <4A4A1CC2.7090001@prodsyse.com>
References: <4A4A1CC2.7090001@prodsyse.com>
Message-ID: <4A4A968F.5080502@statistik.tu-dortmund.de>



spencerg wrote:
> 
>      What do I need to do to get "install.packages" to work properly for 
> me in R 2.9.1 under Vista?
> 
>      Currently, install.packages in Rgui 2.9.1 by default goes to 
> "C:\\Users\\sgraves\\Documents/R/win-library/2.9".  This is a problem 
> for me, because R running under Emacs does not currently look there.
> 
>      I made the mistake last night of first installing R 2.9.1 in the 
> default "C:\Program Files".  When I found that packages I installed 
> using Rgui could not be found from within Emacs, I uninstalled R from 
> "C:\Program Files" and reinstalled it under "C:\Users\sgraves\R" 
> alongside R 2.9.0, which has allowed "install.packages" from Rgui to be 
> accessed from R under Emacs.
> 
>      I've traced the problem to the different behavior of ".libPaths()":
> 
> *** Rgui: .libPaths()
> [1] "C:\\Users\\sgraves\\Documents/R/win-library/2.9"
> [2] "C:/Users/sgraves/R/R-2.9.1/library" 
> 
> *** R under Emacs: > .libPaths()
> [1] "c:/Users/sgraves/R/R-2.9.1/library"
> 
> 
>      What do you suggest?      Thanks,



Either set for the second setup 
"C:\\Users\\sgraves\\Documents/R/win-library/2.9" as a default library 
path (e.g. via env var R_LIBS) or remove it from the  first setup (in a 
personal startup file).

Best wishes,
Uwe



>      Spencer
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From spencer.graves at prodsyse.com  Wed Jul  1 05:00:57 2009
From: spencer.graves at prodsyse.com (spencerg)
Date: Tue, 30 Jun 2009 20:00:57 -0700
Subject: [Rd] install.packages with R 2.9.1 under Vista?
In-Reply-To: <4A4A968F.5080502@statistik.tu-dortmund.de>
References: <4A4A1CC2.7090001@prodsyse.com>
	<4A4A968F.5080502@statistik.tu-dortmund.de>
Message-ID: <4A4AD169.6020406@prodsyse.com>

Dear Uwe: 


      Thanks very much.  Based on your suggestion, I deleted 
"C:\\Users\\sgraves\\Documents/R/win-library/2.9", which got created 
when I first installed R 2.9.1 into the default, write-protected area 
and then did "install.packages".  When I uninstalled that 
write-protected copy and installed it in a different location, the 
directory "C:\\Users\\sgraves\\Documents/R/win-library/2.9" remained, 
and Rgui directed "install.packages" to that directory, though Rterm did 
not.  I had not intentionally set "R_LIBS" nor any other special thing 
like that, so I was confused. 


      Thanks again.
      Best Wishes,
      Spencer


Uwe Ligges wrote:
>
>
> spencerg wrote:
>>
>>      What do I need to do to get "install.packages" to work properly 
>> for me in R 2.9.1 under Vista?
>>
>>      Currently, install.packages in Rgui 2.9.1 by default goes to 
>> "C:\\Users\\sgraves\\Documents/R/win-library/2.9".  This is a problem 
>> for me, because R running under Emacs does not currently look there.
>>
>>      I made the mistake last night of first installing R 2.9.1 in the 
>> default "C:\Program Files".  When I found that packages I installed 
>> using Rgui could not be found from within Emacs, I uninstalled R from 
>> "C:\Program Files" and reinstalled it under "C:\Users\sgraves\R" 
>> alongside R 2.9.0, which has allowed "install.packages" from Rgui to 
>> be accessed from R under Emacs.
>>
>>      I've traced the problem to the different behavior of ".libPaths()":
>>
>> *** Rgui: .libPaths()
>> [1] "C:\\Users\\sgraves\\Documents/R/win-library/2.9"
>> [2] "C:/Users/sgraves/R/R-2.9.1/library"
>> *** R under Emacs: > .libPaths()
>> [1] "c:/Users/sgraves/R/R-2.9.1/library"
>>
>>
>>      What do you suggest?      Thanks,
>
>
>
> Either set for the second setup 
> "C:\\Users\\sgraves\\Documents/R/win-library/2.9" as a default library 
> path (e.g. via env var R_LIBS) or remove it from the  first setup (in 
> a personal startup file).
>
> Best wishes,
> Uwe
>
>
>
>>      Spencer
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ligges at statistik.tu-dortmund.de  Wed Jul  1 10:25:20 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 01 Jul 2009 10:25:20 +0200
Subject: [Rd] install.packages with R 2.9.1 under Vista?
In-Reply-To: <4A4AD169.6020406@prodsyse.com>
References: <4A4A1CC2.7090001@prodsyse.com>	<4A4A968F.5080502@statistik.tu-dortmund.de>
	<4A4AD169.6020406@prodsyse.com>
Message-ID: <4A4B1D70.9020305@statistik.tu-dortmund.de>

Spencer,

see ?R_LIBS_USER

once R created "C:\\Users\\sgraves\\Documents/R/win-library/2.9"  for 
you it is used as a library (since it is the default for R_LIBS_USER if 
the latter is unset otherwise). Just delete the whole directory and it 
won't be used further on.

Best,
Uwe



spencerg wrote:
> Dear Uwe:
> 
>      Thanks very much.  Based on your suggestion, I deleted 
> "C:\\Users\\sgraves\\Documents/R/win-library/2.9", which got created 
> when I first installed R 2.9.1 into the default, write-protected area 
> and then did "install.packages".  When I uninstalled that 
> write-protected copy and installed it in a different location, the 
> directory "C:\\Users\\sgraves\\Documents/R/win-library/2.9" remained, 
> and Rgui directed "install.packages" to that directory, though Rterm did 
> not.  I had not intentionally set "R_LIBS" nor any other special thing 
> like that, so I was confused.
> 
>      Thanks again.
>      Best Wishes,
>      Spencer
> 
> 
> Uwe Ligges wrote:
>>
>>
>> spencerg wrote:
>>>
>>>      What do I need to do to get "install.packages" to work properly 
>>> for me in R 2.9.1 under Vista?
>>>
>>>      Currently, install.packages in Rgui 2.9.1 by default goes to 
>>> "C:\\Users\\sgraves\\Documents/R/win-library/2.9".  This is a problem 
>>> for me, because R running under Emacs does not currently look there.
>>>
>>>      I made the mistake last night of first installing R 2.9.1 in the 
>>> default "C:\Program Files".  When I found that packages I installed 
>>> using Rgui could not be found from within Emacs, I uninstalled R from 
>>> "C:\Program Files" and reinstalled it under "C:\Users\sgraves\R" 
>>> alongside R 2.9.0, which has allowed "install.packages" from Rgui to 
>>> be accessed from R under Emacs.
>>>
>>>      I've traced the problem to the different behavior of ".libPaths()":
>>>
>>> *** Rgui: .libPaths()
>>> [1] "C:\\Users\\sgraves\\Documents/R/win-library/2.9"
>>> [2] "C:/Users/sgraves/R/R-2.9.1/library"
>>> *** R under Emacs: > .libPaths()
>>> [1] "c:/Users/sgraves/R/R-2.9.1/library"
>>>
>>>
>>>      What do you suggest?      Thanks,
>>
>>
>>
>> Either set for the second setup 
>> "C:\\Users\\sgraves\\Documents/R/win-library/2.9" as a default library 
>> path (e.g. via env var R_LIBS) or remove it from the  first setup (in 
>> a personal startup file).
>>
>> Best wishes,
>> Uwe
>>
>>
>>
>>>      Spencer
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From kjell.konis at epfl.ch  Wed Jul  1 10:30:22 2009
From: kjell.konis at epfl.ch (Kjell Konis)
Date: Wed, 1 Jul 2009 10:30:22 +0200
Subject: [Rd] Matrix with random number
In-Reply-To: <30454.53644.qm@web59716.mail.ac4.yahoo.com>
References: <30454.53644.qm@web59716.mail.ac4.yahoo.com>
Message-ID: <0C5135DD-C2AB-4E6B-A8A6-5813B7FA17E6@epfl.ch>

Hi Fabio,

Your function myrbeta returns void so assigning the output isn't going  
to work.  Instead you need to call it like a FORTRAN subroutine.   
Also, I added arguments for the parameters of the beta and moved the  
fseedi and fseedo calls outside of the loop.

This is a pretty basic FORTRAN programming question and there are lots  
of books that can help you learn FORTRAN.


     subroutine mat(x,l,c,pa,pb)
     integer l,c
     double precision x(l,c), a
     integer i,j
     call fseedi()
     do j = 1, c
        do i = 1, l
          call myrbeta(x(i,j),pa,pb)
         enddo
       enddo
     call fseedo()
     end


In R call it like this:

storage.mode(x) <- "double"
.Fortran("mat", x = x, as.integer(l), as.integer(c), as.double(1),  
as.double(2))


Cheers,
Kjell



On 30 juin 09, at 20:02, Fabio Mathias wrote:

> Thanks Mr. Barry Rowlingson
>
> However, the matrix appears to zeros!
>
> Notice the code below! Please!
>
> Code in fortran
>
>     subroutine mat(x,l,c,a)
>     integer l,c
>     double precision x(l,c), a
>     integer i,j
>      do j = 1, c
>        do i = 1, l
>         call fseedi()
>          x(i,j) = myrbeta(a,1,2)
>         call fseedo()
>            enddo
>           enddo
>     end
>
> In R:
>
> dyn.load("func.so")
> x <- matrix(0,5,6)
> l <- nrow(x)
> c <-
> ncol(x)
> a <- 0
>
> ..Fortran("mat", x = x, l, c, as.double(a))
>
> Results:
>
> $x
>      [,1] [,2] [,3] [,4] [,5] [,6]
> [1,]    0    0    0    0    0    0
> [2,]    0    0    0    0    0    0
> [3,]    0    0    0    0    0    0
> [4,]    0    0    0    0    0    0
> [5,]    0    0    0    0    0    0
>
> [[2]]
> [1] 5
>
> [[3]]
> [1] 6
>
> [[4]]
> [1] 1
>
>
> Thanks!!!
>
>
>              F?bio Mathias Corr?a                       UFLA
>
>
>
>
>       
> ____________________________________________________________________________________
> [[elided Yahoo spam]]
>
> 	[[alternative HTML version deleted]]
>
> <ATT00001.txt>


From ggrothendieck at gmail.com  Wed Jul  1 14:10:23 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 1 Jul 2009 08:10:23 -0400
Subject: [Rd] install.packages with R 2.9.1 under Vista?
In-Reply-To: <4A4B1D70.9020305@statistik.tu-dortmund.de>
References: <4A4A1CC2.7090001@prodsyse.com>
	<4A4A968F.5080502@statistik.tu-dortmund.de> 
	<4A4AD169.6020406@prodsyse.com>
	<4A4B1D70.9020305@statistik.tu-dortmund.de>
Message-ID: <971536df0907010510h15bc6123u21e2b65c6d591319@mail.gmail.com>

I use a different editor so I only have general comments but
regardless of editor it
would be best to keep and use the library in your user space to avoid
any problems
with permissions on Vista.

Note that this is the same problem as on UNIX where you need root permissions
to modify the R library if its not in user space and is not a problem
specific to Vista.


2009/7/1 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
> Spencer,
>
> see ?R_LIBS_USER
>
> once R created "C:\\Users\\sgraves\\Documents/R/win-library/2.9" ?for you it
> is used as a library (since it is the default for R_LIBS_USER if the latter
> is unset otherwise). Just delete the whole directory and it won't be used
> further on.
>
> Best,
> Uwe
>
>
>
> spencerg wrote:
>>
>> Dear Uwe:
>>
>> ? ? Thanks very much. ?Based on your suggestion, I deleted
>> "C:\\Users\\sgraves\\Documents/R/win-library/2.9", which got created when I
>> first installed R 2.9.1 into the default, write-protected area and then did
>> "install.packages". ?When I uninstalled that write-protected copy and
>> installed it in a different location, the directory
>> "C:\\Users\\sgraves\\Documents/R/win-library/2.9" remained, and Rgui
>> directed "install.packages" to that directory, though Rterm did not. ?I had
>> not intentionally set "R_LIBS" nor any other special thing like that, so I
>> was confused.
>>
>> ? ? Thanks again.
>> ? ? Best Wishes,
>> ? ? Spencer
>>
>>
>> Uwe Ligges wrote:
>>>
>>>
>>> spencerg wrote:
>>>>
>>>> ? ? What do I need to do to get "install.packages" to work properly for
>>>> me in R 2.9.1 under Vista?
>>>>
>>>> ? ? Currently, install.packages in Rgui 2.9.1 by default goes to
>>>> "C:\\Users\\sgraves\\Documents/R/win-library/2.9". ?This is a problem for
>>>> me, because R running under Emacs does not currently look there.
>>>>
>>>> ? ? I made the mistake last night of first installing R 2.9.1 in the
>>>> default "C:\Program Files". ?When I found that packages I installed using
>>>> Rgui could not be found from within Emacs, I uninstalled R from "C:\Program
>>>> Files" and reinstalled it under "C:\Users\sgraves\R" alongside R 2.9.0,
>>>> which has allowed "install.packages" from Rgui to be accessed from R under
>>>> Emacs.
>>>>
>>>> ? ? I've traced the problem to the different behavior of ".libPaths()":
>>>>
>>>> *** Rgui: .libPaths()
>>>> [1] "C:\\Users\\sgraves\\Documents/R/win-library/2.9"
>>>> [2] "C:/Users/sgraves/R/R-2.9.1/library"
>>>> *** R under Emacs: > .libPaths()
>>>> [1] "c:/Users/sgraves/R/R-2.9.1/library"
>>>>
>>>>
>>>> ? ? What do you suggest? ? ? ?Thanks,
>>>
>>>
>>>
>>> Either set for the second setup
>>> "C:\\Users\\sgraves\\Documents/R/win-library/2.9" as a default library path
>>> (e.g. via env var R_LIBS) or remove it from the ?first setup (in a personal
>>> startup file).
>>>
>>> Best wishes,
>>> Uwe
>>>
>>>
>>>
>>>> ? ? Spencer
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From barbet.g at gmail.com  Wed Jul  1 14:40:10 2009
From: barbet.g at gmail.com (guillaume barbet)
Date: Wed, 1 Jul 2009 14:40:10 +0200
Subject: [Rd] rpart and usersplits
Message-ID: <dc2ef7480907010540t6290e590wcc3145dfd8667cb1@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090701/33d7c177/attachment.pl>

From seth at userprimary.net  Wed Jul  1 18:23:15 2009
From: seth at userprimary.net (Seth Falcon)
Date: Wed, 1 Jul 2009 09:23:15 -0700
Subject: [Rd] Conditional dependency between packages
In-Reply-To: <4A4A12BB.6020504@geo.uu.nl>
References: <4A4A12BB.6020504@geo.uu.nl>
Message-ID: <20090701162315.GV2739@ziti.local>

Hi Jon,

* On 2009-06-30 at 15:27 +0200 Jon Olav Skoien wrote:
> I work on two packages, pkg1 and pkg2 (in two different projects). pkg1 is 
> quite generic, pkg2 tries to solve a particular problem within same field 
> (geostatistics). Therefore, there might be users who want to use pkg2 as an 
> add-on package to increase the functionality of pkg1. In other words, 
> functions in pkg1 are based on the S3 class system, and I want pkg2 to 
> offer methods for pkg2-objects to functions defined in pkg1, for users 
> having both packages installed. Merging the packages or making pkg2 always 
> depend pkg1 would be the easiest solution, but it is not preferred as most 
> users will only be interested in one of the packages.

I'm not sure I understand the above, I think you may have a pkg2 where
you meant pkg1, but I'm not sure it matters.

I think the short version is, pkg2 can be used on its own but will do
more if pkg1 is available.  I don't think R's packaging system
currently supports conditional dependencies as you might like.
However, I think you can get the behavior you want by following a
recipe like:

* In pkg2 DESCRIPTION, list Suggests: pkg1.

* In pkg2 code, you might define a package-level environment and 
  in .onLoad check to see if pkg1 is available.

     PKG_INFO <- new.env(parent=emptyenv())
     .onLoad <- function(libname, pkgname) {
         if (check if pkg1 is available) {
            PKG_INFO[["pkg1"]] <- TRUE
         }
     }

* Then your methods can check PKG_INFO[["pkg1"]].


     
+ seth


From Troy.Robertson at aad.gov.au  Thu Jul  2 07:37:05 2009
From: Troy.Robertson at aad.gov.au (Troy Robertson)
Date: Thu, 2 Jul 2009 15:37:05 +1000
Subject: [Rd] V2.9.0 changes [Sec=Unclassified]
In-Reply-To: <4A40D7C2.7050307@fhcrc.org>
Message-ID: <42C7503E0B99F248B06BC65E7D2B4E020122C50FB2FD@EX2K7-CCR.AAD.GOV.AU>

Well...

My performance problems were in the pass-by-value semantics of R.

I have just changed my classes to inherit from .environment and then moved data members from S4 slots to the .xData objects as Martin suggested.

That meant I could remove all my returns and assignments on all method calls.

This has sped execution time for my model up by more than an order of magnitude. Eg one test simulation from 1931 secs down to 175 secs.

Not bad seeing as though the class structure, functionality and logic has not been touched.

I really do think S4 could benfit from having its slots stored in environment when the class enherits from .environment.  It would be a lot more sensible if my data members were still declared as S4 slots instead of having to hide them in .xData

Troy


Troy Robertson
Database and Computing Support Provider
Southern Ocean Ecosystems, ERM/Fish
Australian Antarctic Division
Channel Highway, Kingston 7050
PH: 03 62323571
Troy.Robertson at aad.gov.au


> -----Original Message-----
> From: Martin Morgan [mailto:mtmorgan at fhcrc.org]
> Sent: Tuesday, 23 June 2009 11:25 PM
> To: Troy Robertson
> Cc: 'r-devel at R-project.org'
> Subject: Re: [Rd] V2.9.0 changes [Sec=Unclassified]
>
> Troy Robertson wrote:
> > Hi all,
> >
> >
> >
> > Prefix: I am a frustrated Java coder in R.
>
> ah good, if you're frustrated with Java you'll find R very different ;)
>
> >
> >
> >
> > I am coding a medium sized ecosystem modelling program in R.  I have
> changed to using S4 objects and it has cost me an order of magnitude in
> execution speed over the functional model.  I cannot afford this penalty
> and have found that it is the result of all the passing-by-value of
> objects.
> >
> >
> >
> > I see that you can now safely inherit from environment in V2.9.0.
> >
> > That got me all excited that I would now be able to pass objects by
> reference.
> >
> >
> >
> > But...
> >
> > That doesn't seem to be the case.
> >
> > It only seem that passing an environment which holds the object allows
> for pass-by-reference and that passing an object which inherits from
> environment doesn't.
> >
> > Why is this the case, either an object inherits the properties of its
> parent or it doesn't.
>
> The object inherits slots from it's parent, and the methods defined on
> the parent class. Maybe this example helps?
>
> setClass("Ticker", contains=".environment")
>
> ## initialize essential, so each instance gets its own environment
> setMethod(initialize, "Ticker",
>           function(.Object, ..., .xData=new.env(parent=emptyenv()))
> {
>     .xData[["count"]] <- 0
>     callNextMethod(.Object, ..., .xData=.xData)
> })
>
> ## tick: increment (private) counter by n
> setGeneric("tick", function(reference, n=1L) standardGeneric("tick"),
>            signature="reference")
>
> setMethod(tick, "Ticker", function(reference, n=1L) {
>     reference[["count"]] <- reference[["count"]] + n
> })
>
> ## tock: report current value of counter
> setGeneric("tock", function(reference) standardGeneric("tock"))
>
> setMethod(tock, "Ticker", function(reference) {
>     reference[["count"]]
> })
>
> and then
>
> > e <- new("Ticker")
> > tock(e)
> [1] 0
> > tick(e); tick(e, 10); tock(e)
> [1] 11
> > f <- e
> > tock(f); tick(e); tock(f)
> [1] 11
> [1] 12
>
> The data inside .environment could be structured, too, using S4.
> Probably it would be more appropriate to have the environment as a slot,
> rather the class that is being extended. And in terms of inherited
> 'properties', e.g., the "[[" function as defined on environments is
> available
>
> > e[["count"]]
>
> Of course I haven't seen your code, but a different interpretation of
> your performance issues is that, within the rules of S4, you've chosen
> to implement functionality in an inefficient way. So it might be
> instructive to step back a bit and try to reformulate your data
> structures and methods. This is hard to do.
>
> Martin
>
> >
> > Has anyone else had a play with this?  Or have I got it all wrong.
> >
> >
> >
> > I tried the below:
> >
> > ------------------------------------------------------------------------
> -----------------
> >
> > setClass('foo', representation=representation(stuff='list',
> bar='numeric'),
> >
> >                      prototype=list(stuff=list(), bar=0),
> >
> >                      contains='.environment')
> >
> >
> >
> > setGeneric('doit', function(.Object, newfoo='environment')
> standardGeneric('doit'))
> >
> >
> >
> > setMethod('doit', 'foo', function(.Object, newfoo){newfoo at bar <- 10})
> >
> >
> >
> > z <- new('foo')
> >
> >
> >
> > z at stuff$x <- new('foo')
> >
> >
> >
> > doit(z,z at stuff$x)
> >
> >
> >
> > z at stuff$x at bar
> >
> >
> >
> > [1] 0
> >
> > ------------------------------------------------------------------------
> ------------------
> >
> >
> >
> > Can anyone help with a better way of doing this.
> >
> > I'm trying to avoid all the indirection of packing and unpacking
> environments for passing.
> >
> >
> >
> >
> >
> > Thanks heaps
> >
> >
> >
> > Troy
> >
> >
> >
> >
> >
> > Troy Robertson
> >
> > Database and Computing Support Provider
> >
> > Southern Ocean Ecosystems, ERM/Fish
> >
> > Australian Antarctic Division
> >
> > Channel Highway, Kingston 7050
> >
> > PH: 03 62323571
> >
> > Troy.Robertson at aad.gov.au
> >
> >
> >
> >
> >
> __________________________________________________________________________
> _
> >
> >     Australian Antarctic Division - Commonwealth of Australia
> > IMPORTANT: This transmission is intended for the addressee only. If you
> are not the
> > intended recipient, you are notified that use or dissemination of this
> communication is
> > strictly prohibited by Commonwealth law. If you have received this
> transmission in error,
> > please notify the sender immediately by e-mail or by telephoning +61 3
> 6232 3209 and
> > DELETE the message.
> >         Visit our web site at http://www.antarctica.gov.au/
> >
> __________________________________________________________________________
> _
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel

___________________________________________________________________________

    Australian Antarctic Division - Commonwealth of Australia
IMPORTANT: This transmission is intended for the addressee only. If you are not the
intended recipient, you are notified that use or dissemination of this communication is
strictly prohibited by Commonwealth law. If you have received this transmission in error,
please notify the sender immediately by e-mail or by telephoning +61 3 6232 3209 and
DELETE the message.
        Visit our web site at http://www.antarctica.gov.au/
___________________________________________________________________________


From romain.francois at dbmail.com  Thu Jul  2 09:38:32 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Thu, 02 Jul 2009 09:38:32 +0200
Subject: [Rd] package post install instructions
Message-ID: <4A4C63F8.4000900@dbmail.com>

Hello,

I've looked in tools:::.install_packages for some sort of hook that 
would let packages developers point to further instructions after a 
package is installed. For example, some packages need to setup 
environment variables, ...

Is there something I have missed ?

Romain

-- 
Romain Francois
Independent R Consultant
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/qzSl : using ImageJ from R: the RImageJ package
|- http://tr.im/qzSJ : with semantics for java objects in rJava
`- http://tr.im/qzTs : Better completion popups


From j.skoien at geo.uu.nl  Thu Jul  2 14:29:06 2009
From: j.skoien at geo.uu.nl (Jon Olav Skoien)
Date: Thu, 02 Jul 2009 14:29:06 +0200
Subject: [Rd] Conditional dependency between packages
In-Reply-To: <20090701162315.GV2739@ziti.local>
References: <4A4A12BB.6020504@geo.uu.nl> <20090701162315.GV2739@ziti.local>
Message-ID: <4A4CA812.5070301@geo.uu.nl>

Hi Seth,

And thanks for your suggestion! I was not able to do exactly what you 
described (I have no earlier experience with using environments), but 
you mentioning .onLoad was a good starting point. I have now removed all 
references to pkg1 from the NAMESPACE, and wrote the following .onLoad 
function:

.onLoad <- function(libname, pkgname) {
  if ("pkg1" %in% rownames(utils:::installed.packages()) ) {
    library(pkg1)
    info = matrix(c("fun1", "fun2", "fun3", rep("pkg2", 3), rep(NA,3)), 
ncol = 3)
    registerS3methods(info, package = "pkg1", env = environment(funInPkg2))
  }
}

New methods for functions fun1, fun2 and fun3 seem to be available if 
pkg1 is installed, while they are ignored if pkg1 is not installed. The 
function above loads pkg1 automatically if installed (I would prefer 
this to be optional), but at least it will not be necessary to download 
pkg1 (with all its dependencies) for users without interest in it.

I have not found any description of registerS3methods (except from an 
old .Rd file stating that it is not intended to be called directly), so 
there might be better ways of doing this... And I am sure there is a 
better way of assigning the right environment...

Thanks again,
Jon



Seth Falcon wrote:
> Hi Jon,
>
> * On 2009-06-30 at 15:27 +0200 Jon Olav Skoien wrote:
>   
>> I work on two packages, pkg1 and pkg2 (in two different projects). pkg1 is 
>> quite generic, pkg2 tries to solve a particular problem within same field 
>> (geostatistics). Therefore, there might be users who want to use pkg2 as an 
>> add-on package to increase the functionality of pkg1. In other words, 
>> functions in pkg1 are based on the S3 class system, and I want pkg2 to 
>> offer methods for pkg2-objects to functions defined in pkg1, for users 
>> having both packages installed. Merging the packages or making pkg2 always 
>> depend pkg1 would be the easiest solution, but it is not preferred as most 
>> users will only be interested in one of the packages.
>>     
>
> I'm not sure I understand the above, I think you may have a pkg2 where
> you meant pkg1, but I'm not sure it matters.
>
> I think the short version is, pkg2 can be used on its own but will do
> more if pkg1 is available.  I don't think R's packaging system
> currently supports conditional dependencies as you might like.
> However, I think you can get the behavior you want by following a
> recipe like:
>
> * In pkg2 DESCRIPTION, list Suggests: pkg1.
>
> * In pkg2 code, you might define a package-level environment and 
>   in .onLoad check to see if pkg1 is available.
>
>      PKG_INFO <- new.env(parent=emptyenv())
>      .onLoad <- function(libname, pkgname) {
>          if (check if pkg1 is available) {
>             PKG_INFO[["pkg1"]] <- TRUE
>          }
>      }
>
> * Then your methods can check PKG_INFO[["pkg1"]].
>
>
>      
> + seth
>


From mtmorgan at fhcrc.org  Thu Jul  2 14:58:28 2009
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Thu, 02 Jul 2009 05:58:28 -0700
Subject: [Rd] V2.9.0 changes [Sec=Unclassified]
In-Reply-To: <42C7503E0B99F248B06BC65E7D2B4E020122C50FB2FD@EX2K7-CCR.AAD.GOV.AU>
References: <42C7503E0B99F248B06BC65E7D2B4E020122C50FB2FD@EX2K7-CCR.AAD.GOV.AU>
Message-ID: <4A4CAEF4.3070008@fhcrc.org>

Troy Robertson wrote:
> Well...
> 
> My performance problems were in the pass-by-value semantics of R.
> 
> I have just changed my classes to inherit from .environment and then moved data members from S4 slots to the .xData objects as Martin suggested.

Actually, I had hoped the take-home message would be in the final paragraph:

>> Of course I haven't seen your code, but a different interpretation of
>> your performance issues is that, within the rules of S4, you've chosen
>> to implement functionality in an inefficient way. So it might be
>> instructive to step back a bit and try to reformulate your data
>> structures and methods. This is hard to do.

Martin

> That meant I could remove all my returns and assignments on all method calls.
> 
> This has sped execution time for my model up by more than an order of magnitude. Eg one test simulation from 1931 secs down to 175 secs.
> 
> Not bad seeing as though the class structure, functionality and logic has not been touched.
> 
> I really do think S4 could benfit from having its slots stored in environment when the class enherits from .environment.  It would be a lot more sensible if my data members were still declared as S4 slots instead of having to hide them in .xData
> 
> Troy
> 
> 
> Troy Robertson
> Database and Computing Support Provider
> Southern Ocean Ecosystems, ERM/Fish
> Australian Antarctic Division
> Channel Highway, Kingston 7050
> PH: 03 62323571
> Troy.Robertson at aad.gov.au
> 
> 
>> -----Original Message-----
>> From: Martin Morgan [mailto:mtmorgan at fhcrc.org]
>> Sent: Tuesday, 23 June 2009 11:25 PM
>> To: Troy Robertson
>> Cc: 'r-devel at R-project.org'
>> Subject: Re: [Rd] V2.9.0 changes [Sec=Unclassified]
>>
>> Troy Robertson wrote:
>>> Hi all,
>>>
>>>
>>>
>>> Prefix: I am a frustrated Java coder in R.
>> ah good, if you're frustrated with Java you'll find R very different ;)
>>
>>>
>>>
>>> I am coding a medium sized ecosystem modelling program in R.  I have
>> changed to using S4 objects and it has cost me an order of magnitude in
>> execution speed over the functional model.  I cannot afford this penalty
>> and have found that it is the result of all the passing-by-value of
>> objects.
>>>
>>>
>>> I see that you can now safely inherit from environment in V2.9.0.
>>>
>>> That got me all excited that I would now be able to pass objects by
>> reference.
>>>
>>>
>>> But...
>>>
>>> That doesn't seem to be the case.
>>>
>>> It only seem that passing an environment which holds the object allows
>> for pass-by-reference and that passing an object which inherits from
>> environment doesn't.
>>> Why is this the case, either an object inherits the properties of its
>> parent or it doesn't.
>>
>> The object inherits slots from it's parent, and the methods defined on
>> the parent class. Maybe this example helps?
>>
>> setClass("Ticker", contains=".environment")
>>
>> ## initialize essential, so each instance gets its own environment
>> setMethod(initialize, "Ticker",
>>           function(.Object, ..., .xData=new.env(parent=emptyenv()))
>> {
>>     .xData[["count"]] <- 0
>>     callNextMethod(.Object, ..., .xData=.xData)
>> })
>>
>> ## tick: increment (private) counter by n
>> setGeneric("tick", function(reference, n=1L) standardGeneric("tick"),
>>            signature="reference")
>>
>> setMethod(tick, "Ticker", function(reference, n=1L) {
>>     reference[["count"]] <- reference[["count"]] + n
>> })
>>
>> ## tock: report current value of counter
>> setGeneric("tock", function(reference) standardGeneric("tock"))
>>
>> setMethod(tock, "Ticker", function(reference) {
>>     reference[["count"]]
>> })
>>
>> and then
>>
>>> e <- new("Ticker")
>>> tock(e)
>> [1] 0
>>> tick(e); tick(e, 10); tock(e)
>> [1] 11
>>> f <- e
>>> tock(f); tick(e); tock(f)
>> [1] 11
>> [1] 12
>>
>> The data inside .environment could be structured, too, using S4.
>> Probably it would be more appropriate to have the environment as a slot,
>> rather the class that is being extended. And in terms of inherited
>> 'properties', e.g., the "[[" function as defined on environments is
>> available
>>
>>> e[["count"]]
>> Of course I haven't seen your code, but a different interpretation of
>> your performance issues is that, within the rules of S4, you've chosen
>> to implement functionality in an inefficient way. So it might be
>> instructive to step back a bit and try to reformulate your data
>> structures and methods. This is hard to do.
>>
>> Martin
>>
>>> Has anyone else had a play with this?  Or have I got it all wrong.
>>>
>>>
>>>
>>> I tried the below:
>>>
>>> ------------------------------------------------------------------------
>> -----------------
>>> setClass('foo', representation=representation(stuff='list',
>> bar='numeric'),
>>>                      prototype=list(stuff=list(), bar=0),
>>>
>>>                      contains='.environment')
>>>
>>>
>>>
>>> setGeneric('doit', function(.Object, newfoo='environment')
>> standardGeneric('doit'))
>>>
>>>
>>> setMethod('doit', 'foo', function(.Object, newfoo){newfoo at bar <- 10})
>>>
>>>
>>>
>>> z <- new('foo')
>>>
>>>
>>>
>>> z at stuff$x <- new('foo')
>>>
>>>
>>>
>>> doit(z,z at stuff$x)
>>>
>>>
>>>
>>> z at stuff$x at bar
>>>
>>>
>>>
>>> [1] 0
>>>
>>> ------------------------------------------------------------------------
>> ------------------
>>>
>>>
>>> Can anyone help with a better way of doing this.
>>>
>>> I'm trying to avoid all the indirection of packing and unpacking
>> environments for passing.
>>>
>>>
>>>
>>>
>>> Thanks heaps
>>>
>>>
>>>
>>> Troy
>>>
>>>
>>>
>>>
>>>
>>> Troy Robertson
>>>
>>> Database and Computing Support Provider
>>>
>>> Southern Ocean Ecosystems, ERM/Fish
>>>
>>> Australian Antarctic Division
>>>
>>> Channel Highway, Kingston 7050
>>>
>>> PH: 03 62323571
>>>
>>> Troy.Robertson at aad.gov.au
>>>
>>>
>>>
>>>
>>>
>> __________________________________________________________________________
>> _
>>>     Australian Antarctic Division - Commonwealth of Australia
>>> IMPORTANT: This transmission is intended for the addressee only. If you
>> are not the
>>> intended recipient, you are notified that use or dissemination of this
>> communication is
>>> strictly prohibited by Commonwealth law. If you have received this
>> transmission in error,
>>> please notify the sender immediately by e-mail or by telephoning +61 3
>> 6232 3209 and
>>> DELETE the message.
>>>         Visit our web site at http://www.antarctica.gov.au/
>>>
>> __________________________________________________________________________
>> _
>>>       [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ___________________________________________________________________________
> 
>     Australian Antarctic Division - Commonwealth of Australia
> IMPORTANT: This transmission is intended for the addressee only. If you are not the
> intended recipient, you are notified that use or dissemination of this communication is
> strictly prohibited by Commonwealth law. If you have received this transmission in error,
> please notify the sender immediately by e-mail or by telephoning +61 3 6232 3209 and
> DELETE the message.
>         Visit our web site at http://www.antarctica.gov.au/
> ___________________________________________________________________________


From ggrothendieck at gmail.com  Thu Jul  2 15:39:16 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 2 Jul 2009 09:39:16 -0400
Subject: [Rd] V2.9.0 changes [Sec=Unclassified]
In-Reply-To: <42C7503E0B99F248B06BC65E7D2B4E020122C50FB2FD@EX2K7-CCR.AAD.GOV.AU>
References: <4A40D7C2.7050307@fhcrc.org>
	<42C7503E0B99F248B06BC65E7D2B4E020122C50FB2FD@EX2K7-CCR.AAD.GOV.AU>
Message-ID: <971536df0907020639k2733406enaa1876af4988c170@mail.gmail.com>

On Thu, Jul 2, 2009 at 1:37 AM, Troy Robertson<Troy.Robertson at aad.gov.au> wrote:
> Well...
>
> My performance problems were in the pass-by-value semantics of R.
>
> I have just changed my classes to inherit from .environment and then moved data members from S4 slots to the .xData objects as Martin suggested.
>

Note that the R.oo and proto packages already use environments for
their storage. e.g.

library(proto)
p <- proto(a = 1, incr = function(.) .$a <- .$a + 1)
class(p) # c("proto", "environment")

p$a # 1
p$incr()
p$a # 2

p$ls() #  c("a", "incr")
ls(p) # same


From Thomas.Petzoldt at tu-dresden.de  Thu Jul  2 17:31:03 2009
From: Thomas.Petzoldt at tu-dresden.de (Thomas Petzoldt)
Date: Thu, 02 Jul 2009 17:31:03 +0200
Subject: [Rd] OOP performance, was:   V2.9.0 changes
In-Reply-To: <42C7503E0B99F248B06BC65E7D2B4E020122C50FB1FD@EX2K7-CCR.AAD.GOV.AU>
References: <42C7503E0B99F248B06BC65E7D2B4E020122C50FB1FD@EX2K7-CCR.AAD.GOV.AU>
Message-ID: <4A4CD2B7.8080009@tu-dresden.de>

Hi Troy,

first of all a question, what kind of ecosystem models are you
developing in R? Differential equations or individual-based?

Your write that you are a frustrated Java developer in R. I have a
similar experience, however I still like JAVA, and I'm now more happy
with R as it is much more efficient (i.e. sum(programming + runtime))
for the things I usually do: ecological data analysis and modelling.

After using functional R quite a time and Java in parallel
I had the same idea, to make R more JAVA like and to model ecosystems in
an object oriented manner. At that time I took a look into R.oo (thanks
Henrik Bengtssson) and was one of the Co-authors of proto. I still think
that R.oo is very good and that proto is a cool idea, but finally I
switched to the recommended S4 for my ecological simulation package.

Note also, that my solution was *not* to model the ecosystems as objects
(habitat - populations- individuals), but instead to model ecological
models (equations, inputs, parameters, time steps, outputs, ...).

This works quite well with S4. A speed test (see useR!2006 poster on
http://simecol.r-forge.r-project.org/) showed that all OOP flavours had
quite comparable performance.

The only thing I have to have in mind are a few rules:

- avoid unnecessary copying of large objects. Sometimes it helps to
prefer matrices over data frames.

- use vectorization. This means for an individual-based model that one
has to re-think how to model an individual: not "many [S4] objects"
like in JAVA, but R structures (arrays, lists, data frames) where
vectorized functions (e.g. arithmetics or subset) can work with.

- avoid interpolation (i.e. approx) and if unavoidable, minimize the tables.

If all these things do not help, I write core functions in C (others use
Fortran). This can be done in a mixed style and even a full C to C
communication is possible (see the deSolve documentation how to do this
with differential equation models).


Thomas P.



-- 
Thomas Petzoldt
Technische Universitaet Dresden
Institut fuer Hydrobiologie        thomas.petzoldt at tu-dresden.de
01062 Dresden                      http://tu-dresden.de/hydrobiologie/
GERMANY


From hb at stat.berkeley.edu  Fri Jul  3 00:41:50 2009
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Thu, 2 Jul 2009 15:41:50 -0700
Subject: [Rd] Conditional dependency between packages
In-Reply-To: <4A4CA812.5070301@geo.uu.nl>
References: <4A4A12BB.6020504@geo.uu.nl> <20090701162315.GV2739@ziti.local> 
	<4A4CA812.5070301@geo.uu.nl>
Message-ID: <59d7961d0907021541t4c1f229ew156cade7cb1d72fa@mail.gmail.com>

if ("pkg1" %in% rownames(utils:::installed.packages()) ) {
  library(pkg1)
  ...
}

can be replaced by:

if (require("pkg1")) {
  ...
}

/Henrik

On Thu, Jul 2, 2009 at 5:29 AM, Jon Olav Skoien<j.skoien at geo.uu.nl> wrote:
> Hi Seth,
>
> And thanks for your suggestion! I was not able to do exactly what you
> described (I have no earlier experience with using environments), but you
> mentioning .onLoad was a good starting point. I have now removed all
> references to pkg1 from the NAMESPACE, and wrote the following .onLoad
> function:
>
> .onLoad <- function(libname, pkgname) {
> ?if ("pkg1" %in% rownames(utils:::installed.packages()) ) {
> ? library(pkg1)
> ? info = matrix(c("fun1", "fun2", "fun3", rep("pkg2", 3), rep(NA,3)), ncol =
> 3)
> ? registerS3methods(info, package = "pkg1", env = environment(funInPkg2))
> ?}
> }
>
> New methods for functions fun1, fun2 and fun3 seem to be available if pkg1
> is installed, while they are ignored if pkg1 is not installed. The function
> above loads pkg1 automatically if installed (I would prefer this to be
> optional), but at least it will not be necessary to download pkg1 (with all
> its dependencies) for users without interest in it.
>
> I have not found any description of registerS3methods (except from an old
> .Rd file stating that it is not intended to be called directly), so there
> might be better ways of doing this... And I am sure there is a better way of
> assigning the right environment...
>
> Thanks again,
> Jon
>
>
>
> Seth Falcon wrote:
>>
>> Hi Jon,
>>
>> * On 2009-06-30 at 15:27 +0200 Jon Olav Skoien wrote:
>>
>>>
>>> I work on two packages, pkg1 and pkg2 (in two different projects). pkg1
>>> is quite generic, pkg2 tries to solve a particular problem within same field
>>> (geostatistics). Therefore, there might be users who want to use pkg2 as an
>>> add-on package to increase the functionality of pkg1. In other words,
>>> functions in pkg1 are based on the S3 class system, and I want pkg2 to offer
>>> methods for pkg2-objects to functions defined in pkg1, for users having both
>>> packages installed. Merging the packages or making pkg2 always depend pkg1
>>> would be the easiest solution, but it is not preferred as most users will
>>> only be interested in one of the packages.
>>>
>>
>> I'm not sure I understand the above, I think you may have a pkg2 where
>> you meant pkg1, but I'm not sure it matters.
>>
>> I think the short version is, pkg2 can be used on its own but will do
>> more if pkg1 is available. ?I don't think R's packaging system
>> currently supports conditional dependencies as you might like.
>> However, I think you can get the behavior you want by following a
>> recipe like:
>>
>> * In pkg2 DESCRIPTION, list Suggests: pkg1.
>>
>> * In pkg2 code, you might define a package-level environment and ?in
>> .onLoad check to see if pkg1 is available.
>>
>> ? ? PKG_INFO <- new.env(parent=emptyenv())
>> ? ? .onLoad <- function(libname, pkgname) {
>> ? ? ? ? if (check if pkg1 is available) {
>> ? ? ? ? ? ?PKG_INFO[["pkg1"]] <- TRUE
>> ? ? ? ? }
>> ? ? }
>>
>> * Then your methods can check PKG_INFO[["pkg1"]].
>>
>>
>> ? ? + seth
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From Troy.Robertson at aad.gov.au  Fri Jul  3 01:19:39 2009
From: Troy.Robertson at aad.gov.au (Troy Robertson)
Date: Fri, 3 Jul 2009 09:19:39 +1000
Subject: [Rd] V2.9.0 changes [Sec=Unclassified]
In-Reply-To: <4A4CAEF4.3070008@fhcrc.org>
Message-ID: <42C7503E0B99F248B06BC65E7D2B4E020122C50FB30A@EX2K7-CCR.AAD.GOV.AU>


> -----Original Message-----
> From: Martin Morgan [mailto:mtmorgan at fhcrc.org]
> Sent: Thursday, 2 July 2009 10:58 PM
> To: Troy Robertson
> Cc: 'r-devel at R-project.org'
> Subject: Re: [Rd] V2.9.0 changes [Sec=Unclassified]
>
> Troy Robertson wrote:
> > Well...
> >
> > My performance problems were in the pass-by-value semantics of R.
> >
> > I have just changed my classes to inherit from .environment and then
> moved data members from S4 slots to the .xData objects as Martin
> suggested.
>
> Actually, I had hoped the take-home message would be in the final
> paragraph:
>
> >> Of course I haven't seen your code, but a different interpretation of
> >> your performance issues is that, within the rules of S4, you've chosen
> >> to implement functionality in an inefficient way. So it might be
> >> instructive to step back a bit and try to reformulate your data
> >> structures and methods. This is hard to do.
>

Yes, it just takes a little time and playing around to work out the rules of R (and S4) though, and how to use them to your advantage rather than be limited by them.  I know I am still probably not using this functional language in the best way, but there you go.


>
> > That meant I could remove all my returns and assignments on all method
> calls.
> >
> > This has sped execution time for my model up by more than an order of
> magnitude. Eg one test simulation from 1931 secs down to 175 secs.
> >
> > Not bad seeing as though the class structure, functionality and logic
> has not been touched.
> >
> > I really do think S4 could benfit from having its slots stored in
> environment when the class enherits from .environment.  It would be a lot
> more sensible if my data members were still declared as S4 slots instead
> of having to hide them in .xData
> >
> > Troy
> >
> >
> > Troy Robertson
> > Database and Computing Support Provider
> > Southern Ocean Ecosystems, ERM/Fish
> > Australian Antarctic Division
> > Channel Highway, Kingston 7050
> > PH: 03 62323571
> > Troy.Robertson at aad.gov.au
> >
> >
> >> -----Original Message-----
> >> From: Martin Morgan [mailto:mtmorgan at fhcrc.org]
> >> Sent: Tuesday, 23 June 2009 11:25 PM
> >> To: Troy Robertson
> >> Cc: 'r-devel at R-project.org'
> >> Subject: Re: [Rd] V2.9.0 changes [Sec=Unclassified]
> >>
> >> Troy Robertson wrote:
> >>> Hi all,
> >>>
> >>>
> >>>
> >>> Prefix: I am a frustrated Java coder in R.
> >> ah good, if you're frustrated with Java you'll find R very different ;)
> >>
> >>>
> >>>
> >>> I am coding a medium sized ecosystem modelling program in R.  I have
> >> changed to using S4 objects and it has cost me an order of magnitude in
> >> execution speed over the functional model.  I cannot afford this
> penalty
> >> and have found that it is the result of all the passing-by-value of
> >> objects.
> >>>
> >>>
> >>> I see that you can now safely inherit from environment in V2.9.0.
> >>>
> >>> That got me all excited that I would now be able to pass objects by
> >> reference.
> >>>
> >>>
> >>> But...
> >>>
> >>> That doesn't seem to be the case.
> >>>
> >>> It only seem that passing an environment which holds the object allows
> >> for pass-by-reference and that passing an object which inherits from
> >> environment doesn't.
> >>> Why is this the case, either an object inherits the properties of its
> >> parent or it doesn't.
> >>
> >> The object inherits slots from it's parent, and the methods defined on
> >> the parent class. Maybe this example helps?
> >>
> >> setClass("Ticker", contains=".environment")
> >>
> >> ## initialize essential, so each instance gets its own environment
> >> setMethod(initialize, "Ticker",
> >>           function(.Object, ..., .xData=new.env(parent=emptyenv()))
> >> {
> >>     .xData[["count"]] <- 0
> >>     callNextMethod(.Object, ..., .xData=.xData)
> >> })
> >>
> >> ## tick: increment (private) counter by n
> >> setGeneric("tick", function(reference, n=1L) standardGeneric("tick"),
> >>            signature="reference")
> >>
> >> setMethod(tick, "Ticker", function(reference, n=1L) {
> >>     reference[["count"]] <- reference[["count"]] + n
> >> })
> >>
> >> ## tock: report current value of counter
> >> setGeneric("tock", function(reference) standardGeneric("tock"))
> >>
> >> setMethod(tock, "Ticker", function(reference) {
> >>     reference[["count"]]
> >> })
> >>
> >> and then
> >>
> >>> e <- new("Ticker")
> >>> tock(e)
> >> [1] 0
> >>> tick(e); tick(e, 10); tock(e)
> >> [1] 11
> >>> f <- e
> >>> tock(f); tick(e); tock(f)
> >> [1] 11
> >> [1] 12
> >>
> >> The data inside .environment could be structured, too, using S4.
> >> Probably it would be more appropriate to have the environment as a
> slot,
> >> rather the class that is being extended. And in terms of inherited
> >> 'properties', e.g., the "[[" function as defined on environments is
> >> available
> >>
> >>> e[["count"]]
> >> Of course I haven't seen your code, but a different interpretation of
> >> your performance issues is that, within the rules of S4, you've chosen
> >> to implement functionality in an inefficient way. So it might be
> >> instructive to step back a bit and try to reformulate your data
> >> structures and methods. This is hard to do.
> >>
> >> Martin
> >>
> >>> Has anyone else had a play with this?  Or have I got it all wrong.
> >>>
> >>>
> >>>
> >>> I tried the below:
> >>>
> >>> ----------------------------------------------------------------------
> --
> >> -----------------
> >>> setClass('foo', representation=representation(stuff='list',
> >> bar='numeric'),
> >>>                      prototype=list(stuff=list(), bar=0),
> >>>
> >>>                      contains='.environment')
> >>>
> >>>
> >>>
> >>> setGeneric('doit', function(.Object, newfoo='environment')
> >> standardGeneric('doit'))
> >>>
> >>>
> >>> setMethod('doit', 'foo', function(.Object, newfoo){newfoo at bar <- 10})
> >>>
> >>>
> >>>
> >>> z <- new('foo')
> >>>
> >>>
> >>>
> >>> z at stuff$x <- new('foo')
> >>>
> >>>
> >>>
> >>> doit(z,z at stuff$x)
> >>>
> >>>
> >>>
> >>> z at stuff$x at bar
> >>>
> >>>
> >>>
> >>> [1] 0
> >>>
> >>> ----------------------------------------------------------------------
> --
> >> ------------------
> >>>
> >>>
> >>> Can anyone help with a better way of doing this.
> >>>
> >>> I'm trying to avoid all the indirection of packing and unpacking
> >> environments for passing.
> >>>
> >>>
> >>>
> >>>
> >>> Thanks heaps
> >>>
> >>>
> >>>
> >>> Troy
> >>>
> >>>
> >>>
> >>>
> >>>
> >>> Troy Robertson
> >>>
> >>> Database and Computing Support Provider
> >>>
> >>> Southern Ocean Ecosystems, ERM/Fish
> >>>
> >>> Australian Antarctic Division
> >>>
> >>> Channel Highway, Kingston 7050
> >>>
> >>> PH: 03 62323571
> >>>
> >>> Troy.Robertson at aad.gov.au
> >>>
> >>>
> >>>
> >>>
> >>>
> >>
> __________________________________________________________________________
> >> _
> >>>     Australian Antarctic Division - Commonwealth of Australia
> >>> IMPORTANT: This transmission is intended for the addressee only. If
> you
> >> are not the
> >>> intended recipient, you are notified that use or dissemination of this
> >> communication is
> >>> strictly prohibited by Commonwealth law. If you have received this
> >> transmission in error,
> >>> please notify the sender immediately by e-mail or by telephoning +61 3
> >> 6232 3209 and
> >>> DELETE the message.
> >>>         Visit our web site at http://www.antarctica.gov.au/
> >>>
> >>
> __________________________________________________________________________
> >> _
> >>>       [[alternative HTML version deleted]]
> >>>
> >>> ______________________________________________
> >>> R-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
> __________________________________________________________________________
> _
> >
> >     Australian Antarctic Division - Commonwealth of Australia
> > IMPORTANT: This transmission is intended for the addressee only. If you
> are not the
> > intended recipient, you are notified that use or dissemination of this
> communication is
> > strictly prohibited by Commonwealth law. If you have received this
> transmission in error,
> > please notify the sender immediately by e-mail or by telephoning +61 3
> 6232 3209 and
> > DELETE the message.
> >         Visit our web site at http://www.antarctica.gov.au/
> >
> __________________________________________________________________________
> _

___________________________________________________________________________

    Australian Antarctic Division - Commonwealth of Australia
IMPORTANT: This transmission is intended for the addressee only. If you are not the
intended recipient, you are notified that use or dissemination of this communication is
strictly prohibited by Commonwealth law. If you have received this transmission in error,
please notify the sender immediately by e-mail or by telephoning +61 3 6232 3209 and
DELETE the message.
        Visit our web site at http://www.antarctica.gov.au/
___________________________________________________________________________


From Troy.Robertson at aad.gov.au  Fri Jul  3 01:39:51 2009
From: Troy.Robertson at aad.gov.au (Troy Robertson)
Date: Fri, 3 Jul 2009 09:39:51 +1000
Subject: [Rd] OOP performance, was:   V2.9.0 changes [SEC=Unclassified]
In-Reply-To: <4A4CD2B7.8080009@tu-dresden.de>
Message-ID: <42C7503E0B99F248B06BC65E7D2B4E020122C50FB30C@EX2K7-CCR.AAD.GOV.AU>

Hi Thomas,

It is a population-based model, but I didn't develop the work.  I am just the programmer who has been given the job of coding it.  The goal is to allow for a plug and play type approach by users to construction of the model (of both elements and functionality).  Hence my focus on OO.

You are right about avoiding the copying of large objects.  That is what was killing things.  I am now working on vectorizing more of the number crunching and removing some of the nested for loops.  That should step things up a little too.

I do also need to investigate how to move some of the more expensive code to C.

Had a quick look at simecol which looks interesting.  Will point it out to my boss to check out too.

Thanks

Troy

> -----Original Message-----
> From: Thomas Petzoldt [mailto:Thomas.Petzoldt at tu-dresden.de]
> Sent: Friday, 3 July 2009 1:31 AM
> To: Troy Robertson
> Cc: 'r-devel at R-project.org'
> Subject: OOP performance, was: [Rd] V2.9.0 changes [SEC=Unclassified]
>
> Hi Troy,
>
> first of all a question, what kind of ecosystem models are you
> developing in R? Differential equations or individual-based?
>
> Your write that you are a frustrated Java developer in R. I have a
> similar experience, however I still like JAVA, and I'm now more happy
> with R as it is much more efficient (i.e. sum(programming + runtime))
> for the things I usually do: ecological data analysis and modelling.
>
> After using functional R quite a time and Java in parallel
> I had the same idea, to make R more JAVA like and to model ecosystems in
> an object oriented manner. At that time I took a look into R.oo (thanks
> Henrik Bengtssson) and was one of the Co-authors of proto. I still think
> that R.oo is very good and that proto is a cool idea, but finally I
> switched to the recommended S4 for my ecological simulation package.
>
> Note also, that my solution was *not* to model the ecosystems as objects
> (habitat - populations- individuals), but instead to model ecological
> models (equations, inputs, parameters, time steps, outputs, ...).
>
> This works quite well with S4. A speed test (see useR!2006 poster on
> http://simecol.r-forge.r-project.org/) showed that all OOP flavours had
> quite comparable performance.
>
> The only thing I have to have in mind are a few rules:
>
> - avoid unnecessary copying of large objects. Sometimes it helps to
> prefer matrices over data frames.
>
> - use vectorization. This means for an individual-based model that one
> has to re-think how to model an individual: not "many [S4] objects"
> like in JAVA, but R structures (arrays, lists, data frames) where
> vectorized functions (e.g. arithmetics or subset) can work with.
>
> - avoid interpolation (i.e. approx) and if unavoidable, minimize the
> tables.
>
> If all these things do not help, I write core functions in C (others use
> Fortran). This can be done in a mixed style and even a full C to C
> communication is possible (see the deSolve documentation how to do this
> with differential equation models).
>
>
> Thomas P.
>
>
>
> --
> Thomas Petzoldt
> Technische Universitaet Dresden
> Institut fuer Hydrobiologie        thomas.petzoldt at tu-dresden.de
> 01062 Dresden                      http://tu-dresden.de/hydrobiologie/
> GERMANY
>
>
>
>

___________________________________________________________________________

    Australian Antarctic Division - Commonwealth of Australia
IMPORTANT: This transmission is intended for the addressee only. If you are not the
intended recipient, you are notified that use or dissemination of this communication is
strictly prohibited by Commonwealth law. If you have received this transmission in error,
please notify the sender immediately by e-mail or by telephoning +61 3 6232 3209 and
DELETE the message.
        Visit our web site at http://www.antarctica.gov.au/
___________________________________________________________________________


From deepayan.sarkar at gmail.com  Fri Jul  3 01:56:30 2009
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Thu, 2 Jul 2009 16:56:30 -0700
Subject: [Rd] [R] ggplot2 x axis question
In-Reply-To: <f8e6ff050906290905o39a567c8p7298aea90e01529@mail.gmail.com>
References: <4A4783FF.4020907@gmail.com>
	<f8e6ff050906281821x2caef422t11dbac30bb5fce1d@mail.gmail.com>
	<4A48E02D.2040101@gmail.com>
	<f8e6ff050906290905o39a567c8p7298aea90e01529@mail.gmail.com>
Message-ID: <eb555e660907021656l98ce52co8fc6edb84410b216@mail.gmail.com>

On Mon, Jun 29, 2009 at 9:05 AM, hadley wickham<h.wickham at gmail.com> wrote:
> In that case, try:
>
> qplot(reorder(factor(model),delta),delta,data=growthm.bic)
>
> Deepayan: do you think there should also be a numeric method for reorder?

r-devel now has a reorder.default (replacing reorder.factor and
reorder.character), so reorder() should also work for numeric data.

-Deepayan

> Hadley
>
> On Mon, Jun 29, 2009 at 10:39 AM, Christopher
> Desjardins<cddesjardins at gmail.com> wrote:
>> Hi Hadley,
>> Thanks for the reply and the great graphing package. That code is giving me
>> the following error:
>>
>>> qplot(reorder(model,delta),delta,data=growthm.bic)
>> Error in UseMethod("reorder") : no applicable method for "reorder"
>>
>> Cheers,
>> Chris

[...]


From ggrothendieck at gmail.com  Fri Jul  3 02:29:04 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 2 Jul 2009 20:29:04 -0400
Subject: [Rd] OOP performance, was: V2.9.0 changes
In-Reply-To: <4A4CD2B7.8080009@tu-dresden.de>
References: <42C7503E0B99F248B06BC65E7D2B4E020122C50FB1FD@EX2K7-CCR.AAD.GOV.AU>
	<4A4CD2B7.8080009@tu-dresden.de>
Message-ID: <971536df0907021729n344fbf76qeef158141c179b86@mail.gmail.com>

In terms of performance if you want the fastest
performance in R go with S3 and if you want
even faster performance rewrite your inner loops
in C.  All the other approaches will usually be slower.
Also S3 is simple, elegant and will result in less code
and take you much less time to design, program and
debug.

For 100% R code, particularly for simulations,
proto can sometimes be even faster than pure R code based
S3 as proto supports hand optimizations that cannot readily
be done in other systems.  (For unoptimized code it would
be slower.)  The key trick is based on its ability
to separate dispatching from calling so that if method f and
object p are unchanged in a loop
   for(...) p$f(...)
then the loop can be rewritten
  f <- p$f; for(...) f(...)
Note that this still retains dynamic dispatch but
just factors it out of the loop.  With S3 the best you could
get would be for(...) f.p(...) where f is a method of class p
but this is really tantamount to not using OO at all since
no dispatch is done at all.

On Thu, Jul 2, 2009 at 11:31 AM, Thomas
Petzoldt<Thomas.Petzoldt at tu-dresden.de> wrote:
> Hi Troy,
>
> first of all a question, what kind of ecosystem models are you
> developing in R? Differential equations or individual-based?
>
> Your write that you are a frustrated Java developer in R. I have a
> similar experience, however I still like JAVA, and I'm now more happy
> with R as it is much more efficient (i.e. sum(programming + runtime))
> for the things I usually do: ecological data analysis and modelling.
>
> After using functional R quite a time and Java in parallel
> I had the same idea, to make R more JAVA like and to model ecosystems in
> an object oriented manner. At that time I took a look into R.oo (thanks
> Henrik Bengtssson) and was one of the Co-authors of proto. I still think
> that R.oo is very good and that proto is a cool idea, but finally I
> switched to the recommended S4 for my ecological simulation package.
>
> Note also, that my solution was *not* to model the ecosystems as objects
> (habitat - populations- individuals), but instead to model ecological
> models (equations, inputs, parameters, time steps, outputs, ...).
>
> This works quite well with S4. A speed test (see useR!2006 poster on
> http://simecol.r-forge.r-project.org/) showed that all OOP flavours had
> quite comparable performance.
>
> The only thing I have to have in mind are a few rules:
>
> - avoid unnecessary copying of large objects. Sometimes it helps to
> prefer matrices over data frames.
>
> - use vectorization. This means for an individual-based model that one
> has to re-think how to model an individual: not "many [S4] objects"
> like in JAVA, but R structures (arrays, lists, data frames) where
> vectorized functions (e.g. arithmetics or subset) can work with.
>
> - avoid interpolation (i.e. approx) and if unavoidable, minimize the tables.
>
> If all these things do not help, I write core functions in C (others use
> Fortran). This can be done in a mixed style and even a full C to C
> communication is possible (see the deSolve documentation how to do this
> with differential equation models).
>
>
> Thomas P.
>
>
>
> --
> Thomas Petzoldt
> Technische Universitaet Dresden
> Institut fuer Hydrobiologie ? ? ? ?thomas.petzoldt at tu-dresden.de
> 01062 Dresden ? ? ? ? ? ? ? ? ? ? ?http://tu-dresden.de/hydrobiologie/
> GERMANY
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From Troy.Robertson at aad.gov.au  Fri Jul  3 02:56:20 2009
From: Troy.Robertson at aad.gov.au (Troy Robertson)
Date: Fri, 3 Jul 2009 10:56:20 +1000
Subject: [Rd] OOP performance, was: V2.9.0 changes [SEC=Unclassified]
In-Reply-To: <971536df0907021729n344fbf76qeef158141c179b86@mail.gmail.com>
Message-ID: <42C7503E0B99F248B06BC65E7D2B4E020122C50FB313@EX2K7-CCR.AAD.GOV.AU>

Hi Gabor,

Look, I agree with you about S3 and have at times wished I had chosen that path rather than S4.  It seems to do the things I struggle to find answers for with S4.  But..., knowing little about R before engaging with this project, I decided to go with the latest OO framework, S4.  I do now find that I am undoing some of it, such as the use of data member slots, in order to implement pass-by-ref via environments and improve performance.  But its all a learning experience.

Troy


> -----Original Message-----
> From: Gabor Grothendieck [mailto:ggrothendieck at gmail.com]
> Sent: Friday, 3 July 2009 10:29 AM
> To: Troy Robertson; r-devel at R-project.org
> Subject: Re: [Rd] OOP performance, was: V2.9.0 changes [SEC=Unclassified]
>
> In terms of performance if you want the fastest
> performance in R go with S3 and if you want
> even faster performance rewrite your inner loops
> in C.  All the other approaches will usually be slower.
> Also S3 is simple, elegant and will result in less code
> and take you much less time to design, program and
> debug.
>
> For 100% R code, particularly for simulations,
> proto can sometimes be even faster than pure R code based
> S3 as proto supports hand optimizations that cannot readily
> be done in other systems.  (For unoptimized code it would
> be slower.)  The key trick is based on its ability
> to separate dispatching from calling so that if method f and
> object p are unchanged in a loop
>    for(...) p$f(...)
> then the loop can be rewritten
>   f <- p$f; for(...) f(...)
> Note that this still retains dynamic dispatch but
> just factors it out of the loop.  With S3 the best you could
> get would be for(...) f.p(...) where f is a method of class p
> but this is really tantamount to not using OO at all since
> no dispatch is done at all.
>
> On Thu, Jul 2, 2009 at 11:31 AM, Thomas
> Petzoldt<Thomas.Petzoldt at tu-dresden.de> wrote:
> > Hi Troy,
> >
> > first of all a question, what kind of ecosystem models are you
> > developing in R? Differential equations or individual-based?
> >
> > Your write that you are a frustrated Java developer in R. I have a
> > similar experience, however I still like JAVA, and I'm now more happy
> > with R as it is much more efficient (i.e. sum(programming + runtime))
> > for the things I usually do: ecological data analysis and modelling.
> >
> > After using functional R quite a time and Java in parallel
> > I had the same idea, to make R more JAVA like and to model ecosystems in
> > an object oriented manner. At that time I took a look into R.oo (thanks
> > Henrik Bengtssson) and was one of the Co-authors of proto. I still think
> > that R.oo is very good and that proto is a cool idea, but finally I
> > switched to the recommended S4 for my ecological simulation package.
> >
> > Note also, that my solution was *not* to model the ecosystems as objects
> > (habitat - populations- individuals), but instead to model ecological
> > models (equations, inputs, parameters, time steps, outputs, ...).
> >
> > This works quite well with S4. A speed test (see useR!2006 poster on
> > http://simecol.r-forge.r-project.org/) showed that all OOP flavours had
> > quite comparable performance.
> >
> > The only thing I have to have in mind are a few rules:
> >
> > - avoid unnecessary copying of large objects. Sometimes it helps to
> > prefer matrices over data frames.
> >
> > - use vectorization. This means for an individual-based model that one
> > has to re-think how to model an individual: not "many [S4] objects"
> > like in JAVA, but R structures (arrays, lists, data frames) where
> > vectorized functions (e.g. arithmetics or subset) can work with.
> >
> > - avoid interpolation (i.e. approx) and if unavoidable, minimize the
> tables.
> >
> > If all these things do not help, I write core functions in C (others use
> > Fortran). This can be done in a mixed style and even a full C to C
> > communication is possible (see the deSolve documentation how to do this
> > with differential equation models).
> >
> >
> > Thomas P.
> >
> >
> >
> > --
> > Thomas Petzoldt
> > Technische Universitaet Dresden
> > Institut fuer Hydrobiologie        thomas.petzoldt at tu-dresden.de
> > 01062 Dresden                      http://tu-dresden.de/hydrobiologie/
> > GERMANY
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
___________________________________________________________________________

    Australian Antarctic Division - Commonwealth of Australia
IMPORTANT: This transmission is intended for the addressee only. If you are not the
intended recipient, you are notified that use or dissemination of this communication is
strictly prohibited by Commonwealth law. If you have received this transmission in error,
please notify the sender immediately by e-mail or by telephoning +61 3 6232 3209 and
DELETE the message.
        Visit our web site at http://www.antarctica.gov.au/
___________________________________________________________________________


From romain.francois at dbmail.com  Fri Jul  3 10:27:19 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Fri, 03 Jul 2009 10:27:19 +0200
Subject: [Rd] package post install instructions
In-Reply-To: <4A4C63F8.4000900@dbmail.com>
References: <4A4C63F8.4000900@dbmail.com>
Message-ID: <4A4DC0E7.7080000@dbmail.com>

A somewhat related question. Can one install a hook to be called when 
__any__ package is loaded. Something like this :

setHook(packageEvent(".*", "onLoad"),
              function(...) grDevices::ps.options(horizontal=FALSE))

Romain

On 07/02/2009 09:38 AM, Romain Francois wrote:
>
> Hello,
>
> I've looked in tools:::.install_packages for some sort of hook that
> would let packages developers point to further instructions after a
> package is installed. For example, some packages need to setup
> environment variables, ...
>
> Is there something I have missed ?
>
> Romain


-- 
Romain Francois
Independent R Consultant
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/qJ8V : RGG#153: stars network
|- http://tr.im/qzSl : using ImageJ from R: the RImageJ package
`- http://tr.im/qzSJ : with semantics for java objects in rJava


From j.skoien at geo.uu.nl  Fri Jul  3 10:32:05 2009
From: j.skoien at geo.uu.nl (Jon Olav Skoien)
Date: Fri, 03 Jul 2009 10:32:05 +0200
Subject: [Rd] Conditional dependency between packages
In-Reply-To: <59d7961d0907021541t4c1f229ew156cade7cb1d72fa@mail.gmail.com>
References: <4A4A12BB.6020504@geo.uu.nl> <20090701162315.GV2739@ziti.local>
	<4A4CA812.5070301@geo.uu.nl>
	<59d7961d0907021541t4c1f229ew156cade7cb1d72fa@mail.gmail.com>
Message-ID: <4A4DC205.8000002@geo.uu.nl>

I agree that require makes it clearer what happens, so I will probably 
change. The disadvantage is the (for some users confusing) 
messages/warnings if the package is not installed. Wrapping it in with 
suppressWarnings and suppressMessages before reprinting the load message 
solves that though:

if (suppressMessages(suppressWarnings(require(pkg1)))) {
  print("Loading required package: pkg1")
  ...
}

Thanks,
Jon

Henrik Bengtsson wrote:
> if ("pkg1" %in% rownames(utils:::installed.packages()) ) {
>   library(pkg1)
>   ...
> }
>
> can be replaced by:
>
> if (require("pkg1")) {
>   ...
> }
>
> /Henrik
>
> On Thu, Jul 2, 2009 at 5:29 AM, Jon Olav Skoien<j.skoien at geo.uu.nl> wrote:
>   
>> Hi Seth,
>>
>> And thanks for your suggestion! I was not able to do exactly what you
>> described (I have no earlier experience with using environments), but you
>> mentioning .onLoad was a good starting point. I have now removed all
>> references to pkg1 from the NAMESPACE, and wrote the following .onLoad
>> function:
>>
>> .onLoad <- function(libname, pkgname) {
>>  if ("pkg1" %in% rownames(utils:::installed.packages()) ) {
>>   library(pkg1)
>>   info = matrix(c("fun1", "fun2", "fun3", rep("pkg2", 3), rep(NA,3)), ncol =
>> 3)
>>   registerS3methods(info, package = "pkg1", env = environment(funInPkg2))
>>  }
>> }
>>
>> New methods for functions fun1, fun2 and fun3 seem to be available if pkg1
>> is installed, while they are ignored if pkg1 is not installed. The function
>> above loads pkg1 automatically if installed (I would prefer this to be
>> optional), but at least it will not be necessary to download pkg1 (with all
>> its dependencies) for users without interest in it.
>>
>> I have not found any description of registerS3methods (except from an old
>> .Rd file stating that it is not intended to be called directly), so there
>> might be better ways of doing this... And I am sure there is a better way of
>> assigning the right environment...
>>
>> Thanks again,
>> Jon
>>
>>
>>
>> Seth Falcon wrote:
>>     
>>> Hi Jon,
>>>
>>> * On 2009-06-30 at 15:27 +0200 Jon Olav Skoien wrote:
>>>
>>>       
>>>> I work on two packages, pkg1 and pkg2 (in two different projects). pkg1
>>>> is quite generic, pkg2 tries to solve a particular problem within same field
>>>> (geostatistics). Therefore, there might be users who want to use pkg2 as an
>>>> add-on package to increase the functionality of pkg1. In other words,
>>>> functions in pkg1 are based on the S3 class system, and I want pkg2 to offer
>>>> methods for pkg2-objects to functions defined in pkg1, for users having both
>>>> packages installed. Merging the packages or making pkg2 always depend pkg1
>>>> would be the easiest solution, but it is not preferred as most users will
>>>> only be interested in one of the packages.
>>>>
>>>>         
>>> I'm not sure I understand the above, I think you may have a pkg2 where
>>> you meant pkg1, but I'm not sure it matters.
>>>
>>> I think the short version is, pkg2 can be used on its own but will do
>>> more if pkg1 is available.  I don't think R's packaging system
>>> currently supports conditional dependencies as you might like.
>>> However, I think you can get the behavior you want by following a
>>> recipe like:
>>>
>>> * In pkg2 DESCRIPTION, list Suggests: pkg1.
>>>
>>> * In pkg2 code, you might define a package-level environment and  in
>>> .onLoad check to see if pkg1 is available.
>>>
>>>     PKG_INFO <- new.env(parent=emptyenv())
>>>     .onLoad <- function(libname, pkgname) {
>>>         if (check if pkg1 is available) {
>>>            PKG_INFO[["pkg1"]] <- TRUE
>>>         }
>>>     }
>>>
>>> * Then your methods can check PKG_INFO[["pkg1"]].
>>>
>>>
>>>     + seth
>>>
>>>       
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>


From mtmorgan at fhcrc.org  Fri Jul  3 16:57:49 2009
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Fri, 03 Jul 2009 07:57:49 -0700
Subject: [Rd] factor() calls sort.list unnecessarily?
Message-ID: <4A4E1C6D.2000807@fhcrc.org>

R-devel,

factor(x) can take a long time on large character vectors (more than a
minute in the example below). This is because of a call to sort.list.

> str(x)
 chr [1:3436831] "chr5" "chr10" "chr16" "chr3" "chr4" "chr15" ...
> Rprof("/tmp/factor.Rprof")
> invisible(factor(x))
> Rprof()
> summaryRprof("/tmp/factor.Rprof")
$by.self
                 self.time self.pct total.time total.pct
"sort.list"          66.14     98.9      66.14      98.9
"unique.default"      0.26      0.4       0.26       0.4
"unique"              0.24      0.4       0.50       0.7
"match"               0.24      0.4       0.24       0.4
"factor"              0.02      0.0      66.90     100.0

$by.total
                 total.time total.pct self.time self.pct
"factor"              66.90     100.0      0.02      0.0
"sort.list"           66.14      98.9     66.14     98.9
"unique"               0.50       0.7      0.24      0.4
"unique.default"       0.26       0.4      0.26      0.4
"match"                0.24       0.4      0.24      0.4

$sampling.time
[1] 66.9

sort.list is always called but used only to determine the order of
levels, so unnecessary when levels are provided. In addition, order of
levels is for unique values of x only. Perhaps these issues are
addressed in the patch below? It does require unique() on the original
argument x, rather than only on as.character(x) At the least, perhaps
sort.list can be called only when levels are not provided?

Martin

Index: src/library/base/R/factor.R
===================================================================
--- src/library/base/R/factor.R (revision 48892)
+++ src/library/base/R/factor.R (working copy)
@@ -18,12 +18,13 @@
                    exclude = NA, ordered = is.ordered(x))
 {
     exclude <- as.vector(exclude, typeof(x))
-    ind <- sort.list(x) # or ?  order(x) which more (too ?) tolerant
+    if (missing(levels))
+        ind <- sort.list(unique(x))
     nx <- names(x)
     force(ordered)
     x <- as.character(x)
     if(missing(levels)) # get unique levels ordered by the original values
-       levels <- unique(x[ind])
+       levels <- unique(x)[ind]
     levels <- levels[is.na(match(levels, exclude))]
     f <- match(x, levels)
     if(!is.null(nx))


From mimil5252 at hotmail.com  Fri Jul  3 11:30:12 2009
From: mimil5252 at hotmail.com (mimil5252 at hotmail.com)
Date: Fri,  3 Jul 2009 11:30:12 +0200 (CEST)
Subject: [Rd] Bug report (PR#13798)
Message-ID: <20090703093012.780882830317@mail.pubhealth.ku.dk>

Full_Name: Emilien Henry
Version: 2.9.1
OS: 
Submission from: (NULL) (80.13.174.5)


R often stops working after execution of some packages (R commander or ade4TkGUI
for example)


Signature du probl?me?:
  Nom d??v?nement de probl?me:	APPCRASH
  Nom de l?application:	Rgui.exe
  Version de l?application:	2.91.48839.0
  Horodatage de l'application:	4a44ca0a
  Nom du module par d?faut:	tk85.dll
  Version du module par d?faut:	8.5.2.6
  Horodateur du module par d?faut:	497e22aa
  Code de l?exception:	c0000005
  D?calage de l?exception:	0005d66d
  Version du syst?me:	6.0.6001.2.1.0.768.3
  Identificateur de param?tres r?gionaux:	1036
  Information suppl?mentaire n??1:	34a8
  Information suppl?mentaire n??2:	4fc241adc2ff96677a38ba647d58d35b
  Information suppl?mentaire n??3:	b1d4
  Information suppl?mentaire n??4:	93d43904703cf937a4f652a9b119d54


From fabio.ufla at yahoo.com.br  Fri Jul  3 18:49:55 2009
From: fabio.ufla at yahoo.com.br (Fabio Mathias)
Date: Fri, 3 Jul 2009 09:49:55 -0700 (PDT)
Subject: [Rd] Matrix with random number
Message-ID: <279040.8540.qm@web59716.mail.ac4.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090703/6fab2c27/attachment.pl>

From r.cowan at merit.unimaas.nl  Fri Jul  3 22:37:53 2009
From: r.cowan at merit.unimaas.nl (robin cowan)
Date: Fri, 3 Jul 2009 16:37:53 -0400
Subject: [Rd] Dynamic libraries
Message-ID: <7A8037A5-AB10-479D-B34A-5E3F0445EFF1@merit.unimaas.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090703/89e8cb50/attachment.pl>

From murdoch at stats.uwo.ca  Sat Jul  4 01:53:26 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 03 Jul 2009 19:53:26 -0400
Subject: [Rd] Dynamic libraries
In-Reply-To: <7A8037A5-AB10-479D-B34A-5E3F0445EFF1@merit.unimaas.nl>
References: <7A8037A5-AB10-479D-B34A-5E3F0445EFF1@merit.unimaas.nl>
Message-ID: <4A4E99F6.4060304@stats.uwo.ca>

On 03/07/2009 4:37 PM, robin cowan wrote:
> I am trying to write a dynamic linked library for R, in Pascal.

You need to tell us what Pascal compiler you're using.  You may need to 
ask your compiler provider how to compile something to interface with R, 
or tell us all sorts of details that you may not know.  Such as:

  - what is "integer"?
  - what is "cdecl"?

Those have obvious answers; but it really depends on your compiler 
writer to implement them in the obvious way or some other.  And then 
there's:

- what registers does your compiler preserve across calls?

That's usually much harder to discover, but really crucial for stable 
performance of the caller.

Duncan Murdoch


  (This
> is to speed up the execution of a simulation that I am running in R.)  
> I know Pascal might not be the perfect language for this (C or Fortran  
> being more natural), but from what I have read I think it should  
> work.  Though I should point out that I am a neophyte when it comes to  
> DLLs.
> 
>  From R I want to hand a function in the library a two-dimensional  
> matrix, operate on the matrix, and hand back a 2-d matrix.
> 
> I have no problem creating the library and loading it using dyn.load()
> 
> I have written an R wrapper for the function.
> 
> When I do something simple using scalars (integers) everything works  
> fine, or so it seems at least.
> However, when I try to use a vector as an argument to the function,  
> two things happen:
> R becomes very unstable;
> the function only operates on the first 3 elements of the vector (say  
> if the vector has 5 elements).
> 
> Anyone have experience with this sort of thing?
> 
> Thanks,
> Robin Cowan
> 
> Sample below:
> 
> This one works fine:
> 
> library Test1Lib;
> 
> type
> pA=^integer;
> 
> procedure simple(x:pA); cdecl;
> var i1,i2:integer;
> 
> begin
> 	x^:=x^*2;
> end;
> 
> exports  simple;
> begin
> end.
> 
> 
> This one does not:
> 
> library Test2Lib;
> 
> type
> array1=array[1..5] of integer;
> pA=^array1;
> procedure simpleArray(x:pA); cdecl;
> var i1:integer;
> 
> begin
> for i1:=1 to 5 do
> 	x^[i1]:=x^[i1]*2;
> end;
> 
> exports  simpleArray;
> begin
> end.
> 
> 
> Here is the wrapper I use:
> MySimple <- function(x)
> {
>    ans <- .C("simple",as.integer(x)) # or simpleArray in the second case
>    ans[[1]]
>    }
> 
> Here is what I get:
> 
>  > x<-c(1,2,3,4,5)
>  > MySimple(x)
> [1] 2 4 6 4 5
> 
> 
> 
> The University of Maastricht has changed its name and mail servers. My  
> email address is now r.cowan at maastrichtuniversity.nl.
> 
> 
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ross at biostat.ucsf.edu  Sat Jul  4 03:53:11 2009
From: ross at biostat.ucsf.edu (Ross Boylan)
Date: Fri, 03 Jul 2009 18:53:11 -0700
Subject: [Rd] beginner's guide to C++ programming with R packages?
In-Reply-To: <8ec76080906261317g77abf908wa1b9614efd19c489@mail.gmail.com>
References: <13e802630906261243s7b071010ldfe6416e8c0ae304@mail.gmail.com>
	<8ec76080906261317g77abf908wa1b9614efd19c489@mail.gmail.com>
Message-ID: <1246672391.559.12.camel@corn.betterworld.us>

On Fri, 2009-06-26 at 16:17 -0400, Whit Armstrong wrote:
> > But this draws me back to the basic question.  I don't want to run R
> > CMD INSTALL 20 times per hour.  How do developers "actually" test
> > their code?
> 
> check out RUnit for tests.
> http://cran.r-project.org/web/packages/RUnit/index.html
> 
> as for testing c++ code.  I have taken an approach which is probably
> different than most.  I try to build my package as a c++ library that
> can be used independent of R.  Then you can test your library with
> whatever c++ test suite that you prefer.  Once you are happy, then
I also have C++ tests that operate separately from R, though I have a
very small library of stub R functions to get the thing to build.  There
have been some tricky issues with R (if one links to the regular R
library) and the test framework fighting over who was "main."  I think
that's why I switched to the stub.

Working only with R level tests alone does not permit the kind of lower
level testing that you can get by running your own unit tests.  I use
the boost unit test framework.

Of course, you want R level tests too.  Some of my upper level C++ tests
are mirror images of R tests; this can help identify if a problem lies
at the interface.

For C++ tests I build my code in conjunction with a main program.

I think I also have or had a test building it as a library, but I don't
use that much.

For R, my modules get built into a library.

It's usually cleaner to build the R library from a fresh version of the
sources; otherwise scraps of my other builds tend to end up in the R
package.

Thanks, Whit, for the  pointers to Rcpp and RAbstraction.
Ross Boylan


From phgrosjean at sciviews.org  Sat Jul  4 06:07:46 2009
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Sat, 04 Jul 2009 06:07:46 +0200
Subject: [Rd] beginner's guide to C++ programming with R packages?
In-Reply-To: <1246672391.559.12.camel@corn.betterworld.us>
References: <13e802630906261243s7b071010ldfe6416e8c0ae304@mail.gmail.com>	<8ec76080906261317g77abf908wa1b9614efd19c489@mail.gmail.com>
	<1246672391.559.12.camel@corn.betterworld.us>
Message-ID: <4A4ED592.3010404@sciviews.org>

Ross Boylan wrote:
> On Fri, 2009-06-26 at 16:17 -0400, Whit Armstrong wrote:
>>> But this draws me back to the basic question.  I don't want to run R
>>> CMD INSTALL 20 times per hour.  How do developers "actually" test
>>> their code?
>> check out RUnit for tests.
>> http://cran.r-project.org/web/packages/RUnit/index.html

You could also look at the svUnit package 
http://cran.r-project.org/web/packages/svUnit/index.html
.

PhG

>> as for testing c++ code.  I have taken an approach which is probably
>> different than most.  I try to build my package as a c++ library that
>> can be used independent of R.  Then you can test your library with
>> whatever c++ test suite that you prefer.  Once you are happy, then
> I also have C++ tests that operate separately from R, though I have a
> very small library of stub R functions to get the thing to build.  There
> have been some tricky issues with R (if one links to the regular R
> library) and the test framework fighting over who was "main."  I think
> that's why I switched to the stub.
> 
> Working only with R level tests alone does not permit the kind of lower
> level testing that you can get by running your own unit tests.  I use
> the boost unit test framework.
> 
> Of course, you want R level tests too.  Some of my upper level C++ tests
> are mirror images of R tests; this can help identify if a problem lies
> at the interface.
> 
> For C++ tests I build my code in conjunction with a main program.
> 
> I think I also have or had a test building it as a library, but I don't
> use that much.
> 
> For R, my modules get built into a library.
> 
> It's usually cleaner to build the R library from a fresh version of the
> sources; otherwise scraps of my other builds tend to end up in the R
> package.
> 
> Thanks, Whit, for the  pointers to Rcpp and RAbstraction.
> Ross Boylan
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>


From savicky at cs.cas.cz  Sun Jul  5 11:07:43 2009
From: savicky at cs.cas.cz (Petr Savicky)
Date: Sun, 5 Jul 2009 11:07:43 +0200
Subject: [Rd] factor() calls sort.list unnecessarily?
In-Reply-To: <4A4E1C6D.2000807@fhcrc.org>
References: <4A4E1C6D.2000807@fhcrc.org>
Message-ID: <20090705090743.GA31686@cs.cas.cz>

On Fri, Jul 03, 2009 at 07:57:49AM -0700, Martin Morgan wrote:
[...]
> sort.list is always called but used only to determine the order of
> levels, so unnecessary when levels are provided.

I think, this is correct. Replacing 
  ind <- sort.list(x)
by
  if (missing(levels))
      ind <- sort.list(x)
makes factor() more efficient, when levels parameter is not missing
and since variable ind is not needed in this case, i think, the
modification in the above form (without unique()) is correct.
Parameter levels is not used between the two tests of missing(levels),
so we get the same result in both cases as needed.

> In addition, order of
> levels is for unique values of x only. Perhaps these issues are
> addressed in the patch below? It does require unique() on the original
> argument x, rather than only on as.character(x)

Computing the order of levels is sufficient for unique levels, however,
if x is numeric, then the operation
  x <- as.character(x)
performs rounding, due to which different, but very close numbers 
are mapped to the same value. So, the length of unique(x) may change.

A possible solution could be to keep unique(x) for the original values
and refer to it, when constructing the levels. For example, as follows.
  y <- unique(x)
  ind <- sort.list(y)
  y <- as.character(y)
  levels <- unique(y[ind])
  x <- as.character(x)
  f <- match(x, levels)
This is more efficient, if the length of unique(x) is significantly
smaller then the length of x. On the other hand, if their lengths are
similar, then computing as.character() on both x and y incures some
slow down.

> At the least, perhaps
> sort.list can be called only when levels are not provided?

I support this part of the patch without unique().

Petr.


From wavexx at users.sf.net  Sun Jul  5 16:54:45 2009
From: wavexx at users.sf.net (Yuri D'Elia)
Date: Sun, 5 Jul 2009 16:54:45 +0200
Subject: [Rd] Memory management issues
Message-ID: <20090705165445.68dae639@abz8111lx.eurac.edu>

Hi everybody,

I have been interfacing some C++ library code into an R package but
ran into optimization issues specific to memory management that require
some insight into the GC.

One of the C++ libraries returns simple vectors of integers, doubles and
complex which are allocated and managed from the library itself. I
cannot know the length of the array beforehand, so I cannot
pre-allocate that memory through the GC.

Right now I'm allocating via allocVector and copying all the data in it.
However, this requires twice the amount of space (and time), and we're
running out of memory when doing concurrent analysis.

What I'd would like to do is:

- "patch" the SEXP returned to R so that DATAPTR() points directly to
  the required address. 

- create a normal LISTSXP in the package, which holds a reference
  to all these objects, so that GC never takes place.

- turn these objects read-only, or, at least, ensure that they are
  never free()d or remalloc()ed. overwriting the contents is not a
  critical issue.

Would that approach work?
Are there any alternative approaches?
Any specific advice about turning these objects read-only?

Thanks in advance.


From murdoch at stats.uwo.ca  Sun Jul  5 21:46:07 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 05 Jul 2009 15:46:07 -0400
Subject: [Rd] Memory management issues
In-Reply-To: <20090705165445.68dae639@abz8111lx.eurac.edu>
References: <20090705165445.68dae639@abz8111lx.eurac.edu>
Message-ID: <4A5102FF.8040303@stats.uwo.ca>

On 05/07/2009 10:54 AM, Yuri D'Elia wrote:
> Hi everybody,
> 
> I have been interfacing some C++ library code into an R package but
> ran into optimization issues specific to memory management that require
> some insight into the GC.
> 
> One of the C++ libraries returns simple vectors of integers, doubles and
> complex which are allocated and managed from the library itself. I
> cannot know the length of the array beforehand, so I cannot
> pre-allocate that memory through the GC.
> 
> Right now I'm allocating via allocVector and copying all the data in it.
> However, this requires twice the amount of space (and time), and we're
> running out of memory when doing concurrent analysis.
> 
> What I'd would like to do is:
> 
> - "patch" the SEXP returned to R so that DATAPTR() points directly to
>   the required address. 

The normal way to do what you want is to use an "external pointer".  R 
assumes that memory management for those is handled completely 
externally.  External pointers can have finalizers, so when you no 
longer have a need for the object, you can ask the external library to 
release it.

> 
> - create a normal LISTSXP in the package, which holds a reference
>   to all these objects, so that GC never takes place.

The list would hold the external pointers, which act like references.
> 
> - turn these objects read-only, or, at least, ensure that they are
>   never free()d or remalloc()ed. overwriting the contents is not a
>   critical issue.

That won't happen.

I wouldn't try to trick the memory manager into thinking that it 
allocated these things; that will likely just lead to problems.

Duncan Murdoch

> 
> Would that approach work?
> Are there any alternative approaches?
> Any specific advice about turning these objects read-only?
> 
> Thanks in advance.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From armstrong.whit at gmail.com  Sun Jul  5 21:59:51 2009
From: armstrong.whit at gmail.com (Whit Armstrong)
Date: Sun, 5 Jul 2009 15:59:51 -0400
Subject: [Rd] Memory management issues
In-Reply-To: <20090705165445.68dae639@abz8111lx.eurac.edu>
References: <20090705165445.68dae639@abz8111lx.eurac.edu>
Message-ID: <8ec76080907051259q4744d40bp46b2434b086d5adc@mail.gmail.com>

If you are in control of the c++ library (i.e. it is not from a
vendor), then you can also override the new operator of your object so
that it allocates an SEXP.  if you implement PROTECT/UNPROTECT calls
correctly, then GC will not be a problem.

The approach that I've taken with my time series library is that you
specify a storage policy as a template parameter.  If you are using
regular c++, then vectors of double/int are just allocated normally in
c++, however, if you specify the R storage backend, then the
constructor allocates an SEXP of doubles and sets the object's pointer
to the first element in the vector.  The ojbect doesn't really know
that it's using R's backend storage.

Sources here:
R backend storage policy: http://github.com/armstrtw/r.tslib.backend/tree/master
tslib: http://github.com/armstrtw/tslib/tree/master

-Whit



On Sun, Jul 5, 2009 at 10:54 AM, Yuri D'Elia<wavexx at users.sf.net> wrote:
> Hi everybody,
>
> I have been interfacing some C++ library code into an R package but
> ran into optimization issues specific to memory management that require
> some insight into the GC.
>
> One of the C++ libraries returns simple vectors of integers, doubles and
> complex which are allocated and managed from the library itself. I
> cannot know the length of the array beforehand, so I cannot
> pre-allocate that memory through the GC.
>
> Right now I'm allocating via allocVector and copying all the data in it.
> However, this requires twice the amount of space (and time), and we're
> running out of memory when doing concurrent analysis.
>
> What I'd would like to do is:
>
> - "patch" the SEXP returned to R so that DATAPTR() points directly to
> ?the required address.
>
> - create a normal LISTSXP in the package, which holds a reference
> ?to all these objects, so that GC never takes place.
>
> - turn these objects read-only, or, at least, ensure that they are
> ?never free()d or remalloc()ed. overwriting the contents is not a
> ?critical issue.
>
> Would that approach work?
> Are there any alternative approaches?
> Any specific advice about turning these objects read-only?
>
> Thanks in advance.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From wavexx at users.sf.net  Mon Jul  6 00:05:18 2009
From: wavexx at users.sf.net (Yuri D'Elia)
Date: Mon, 06 Jul 2009 00:05:18 +0200
Subject: [Rd] Memory management issues
References: <20090705165445.68dae639@abz8111lx.eurac.edu>
	<4A5102FF.8040303@stats.uwo.ca>
Message-ID: <wavexx-25F071.00051806072009@ger.gmane.org>

In article <4A5102FF.8040303 at stats.uwo.ca>,
 Duncan Murdoch <murdoch at stats.uwo.ca> wrote:

> > What I'd would like to do is:
> > 
> > - "patch" the SEXP returned to R so that DATAPTR() points directly to
> >   the required address. 
> 
> The normal way to do what you want is to use an "external pointer".  R 
> assumes that memory management for those is handled completely 
> externally.  External pointers can have finalizers, so when you no 
> longer have a need for the object, you can ask the external library to 
> release it.

I don't think external pointers can be read from R sources like normal 
vectors, or am I wrong?

Using external pointers would imply either proxy calls for every action 
you need to perform or deep copies (like I'm doing now).

> I wouldn't try to trick the memory manager into thinking that it 
> allocated these things; that will likely just lead to problems.

I'm not afraid of patching R sources somehow, if that's the only 
solution, but it's one that I would like to avoid.


From wavexx at users.sf.net  Mon Jul  6 00:13:54 2009
From: wavexx at users.sf.net (Yuri D'Elia)
Date: Mon, 06 Jul 2009 00:13:54 +0200
Subject: [Rd] Memory management issues
References: <20090705165445.68dae639@abz8111lx.eurac.edu>
	<8ec76080907051259q4744d40bp46b2434b086d5adc@mail.gmail.com>
Message-ID: <wavexx-F25043.00135406072009@ger.gmane.org>

In article 
<8ec76080907051259q4744d40bp46b2434b086d5adc at mail.gmail.com>,
 Whit Armstrong <armstrong.whit at gmail.com> wrote:

> If you are in control of the c++ library (i.e. it is not from a
> vendor), then you can also override the new operator of your object so
> that it allocates an SEXP.  if you implement PROTECT/UNPROTECT calls
> correctly, then GC will not be a problem.

The library returns addresses which may not be from the top of the 
allocated object. For some pre-calculated values, I actually use a 
shared memory pool.

I really need to be able to 'wire' this address directly into the SEXP.

Like I wrote in another message, changing the GC code (if necessary) 
could be a viable option.

> Sources here:
> R backend storage policy: 
> http://github.com/armstrtw/r.tslib.backend/tree/master
> tslib: http://github.com/armstrtw/tslib/tree/master

I really like this approach, it would turn useful for many other 
projects :).

Thanks


From murdoch at stats.uwo.ca  Mon Jul  6 00:57:24 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sun, 05 Jul 2009 18:57:24 -0400
Subject: [Rd] Memory management issues
In-Reply-To: <wavexx-25F071.00051806072009@ger.gmane.org>
References: <20090705165445.68dae639@abz8111lx.eurac.edu>	<4A5102FF.8040303@stats.uwo.ca>
	<wavexx-25F071.00051806072009@ger.gmane.org>
Message-ID: <4A512FD4.7090107@stats.uwo.ca>

On 05/07/2009 6:05 PM, Yuri D'Elia wrote:
> In article <4A5102FF.8040303 at stats.uwo.ca>,
>  Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> 
>>> What I'd would like to do is:
>>>
>>> - "patch" the SEXP returned to R so that DATAPTR() points directly to
>>>   the required address. 
>> The normal way to do what you want is to use an "external pointer".  R 
>> assumes that memory management for those is handled completely 
>> externally.  External pointers can have finalizers, so when you no 
>> longer have a need for the object, you can ask the external library to 
>> release it.
> 
> I don't think external pointers can be read from R sources like normal 
> vectors, or am I wrong?

No, you're right.

> Using external pointers would imply either proxy calls for every action 
> you need to perform or deep copies (like I'm doing now).

Yes.

Duncan Murdoch

> 
>> I wouldn't try to trick the memory manager into thinking that it 
>> allocated these things; that will likely just lead to problems.
> 
> I'm not afraid of patching R sources somehow, if that's the only 
> solution, but it's one that I would like to avoid.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From simon.urbanek at r-project.org  Mon Jul  6 05:10:00 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sun, 5 Jul 2009 23:10:00 -0400
Subject: [Rd] Memory management issues
In-Reply-To: <20090705165445.68dae639@abz8111lx.eurac.edu>
References: <20090705165445.68dae639@abz8111lx.eurac.edu>
Message-ID: <24443639-D10D-4263-8D10-60D9FC1F4D36@r-project.org>


On Jul 5, 2009, at 10:54 AM, Yuri D'Elia wrote:

> Hi everybody,
>
> I have been interfacing some C++ library code into an R package but
> ran into optimization issues specific to memory management that  
> require
> some insight into the GC.
>
> One of the C++ libraries returns simple vectors of integers, doubles  
> and
> complex which are allocated and managed from the library itself. I
> cannot know the length of the array beforehand, so I cannot
> pre-allocate that memory through the GC.
>
> Right now I'm allocating via allocVector and copying all the data in  
> it.
> However, this requires twice the amount of space (and time), and we're
> running out of memory when doing concurrent analysis.
>
> What I'd would like to do is:
>
> - "patch" the SEXP returned to R so that DATAPTR() points directly to
>  the required address.
>

Why don't you just "patch" the library to use allocVector? That's most  
reliable and trivial to do. Messing around with internal SEXP  
representation is asking for trouble as that may change at any point  
without notice (note that all access is through functions to avoid  
that).

Cheers,
Simon


> - create a normal LISTSXP in the package, which holds a reference
>  to all these objects, so that GC never takes place.
>
> - turn these objects read-only, or, at least, ensure that they are
>  never free()d or remalloc()ed. overwriting the contents is not a
>  critical issue.
>
> Would that approach work?
> Are there any alternative approaches?
> Any specific advice about turning these objects read-only?
>
> Thanks in advance.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From thothal at sbox.tugraz.at  Mon Jul  6 10:26:14 2009
From: thothal at sbox.tugraz.at (Thorn Thaler)
Date: Mon, 06 Jul 2009 10:26:14 +0200
Subject: [Rd] Speed up code, profiling, optimization, lapply vs. loops
Message-ID: <4A51B526.7070705@sbox.tugraz.at>

High everybody,

currently I'm writinig a package that, for a given family of variance 
functions depending on a parameter theta, say, computes the extended 
quasi likelihood (eql) function for different values of theta.

The computation involves a couple of calls of the 'glm' routine. What 
I'm doing now is to call 'lapply' for a list of theta values and a 
function, that constructs a family object for the particular choice of 
theta, computes the glm and uses the results to get the eql. Not 
surprisingly the function is not very fast. Depending on the size of the 
parameter space under consideration it takes a couple of minutes until 
the function finishes. Testing ~1000 Parameters takes about 5 minutes on 
my machine.

I know that loops in R are slow more often than not. Thus, I thought 
using 'lapply' is a better way. But anyways, it is just another way of a 
loop. Besides, it involves some overhead for the function call and hence 
i'm not sure wheter using 'lapply' is really the better choice.

What I like to know is to figure out, where the bottleneck lies. 
Vectorization would help, but since I don't think that there is 
vectorized 'glm' function, which is able to handle a vector of family 
objects. I'm not aware if there is any choice aside from using a loop.

So my questions:
- how can I figure out where the bottleneck lies?
- is 'lapply' always superior to a loop in terms of execution time?
- are there any 'evil' commands that should be avoided in a loop, for 
they slow down the computation?
- are there any good books, tutorials about how to profile R code 
efficiently?

TIA 4 ur help,

Thorn


From murdoch at stats.uwo.ca  Mon Jul  6 13:13:14 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 06 Jul 2009 07:13:14 -0400
Subject: [Rd] [R] problem with internal functions in Windows
In-Reply-To: <4A51E4FA.5572.00B2.1@lshtm.ac.uk>
References: <4A51E4FA.5572.00B2.1@lshtm.ac.uk>
Message-ID: <4A51DC4A.3080000@stats.uwo.ca>

This is more of an r-devel topic, so I've sent my reply there.

On 06/07/2009 6:50 AM, Antonio.Gasparrini at lshtm.ac.uk wrote:
> Dear R users,
>  
> I included 2 internal functions in the package 'dlnm', called 'mkbasis' and 'mklagbasis'.
> Despite they are not meant to be called by the users, I included them in the namespace in order to make them available, keeping the process more transparent and giving the opportunity to change or improve them.

The usual reason to make something an internal function is so that you 
feel no obligation to maintain the interface.  If it is in the 
NAMESPACE, you should feel guilty whenever you make incompatible changes.

Another reason to keep them internal is that they don't really fit with 
the goals of your package:  they are just a distraction.  You don't want 
people to use your package just for those things.  (This is actually the 
same reason as the first: the reason you don't want your package to be 
used for some little utility function is that you would drop it if it 
showed up in a base package.)

So if you think those functions are useful and on target, and you don't 
foresee changing them, then exporting them is reasonable.

> I included an help page 'dlnm-internal.Rd' to document them, and some examples in a package vignette I want to add.
> The problem is that the link to this help page doesn't work in the version installed by the CRAN (eg. try ?mkbasis).
> I checked the help pages for internal functions in other packages: some of them work (e.g. ?geepack::anova.geeglm), others don't (e.g. ?gam::.First.lib).
>  
> Any suggestions?

Did you set aliases in the help pages?  Those are what help uses to find 
the page.

And what OS and R version are you using?  ?gam::.First.lib works for me 
(on Windows, with 2.9.0 or 2.9.1 patched).

Duncan Murdoch


From murdoch at stats.uwo.ca  Mon Jul  6 15:30:46 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 06 Jul 2009 09:30:46 -0400
Subject: [Rd] [R] problem with internal functions in Windows
In-Reply-To: <4A51FAE2.5572.00B2.1@lshtm.ac.uk>
References: <4A51E4FA.5572.00B2.1@lshtm.ac.uk> <4A51DC4A.3080000@stats.uwo.ca>
	<4A51FAE2.5572.00B2.1@lshtm.ac.uk>
Message-ID: <4A51FC86.9030701@stats.uwo.ca>

On 7/6/2009 8:23 AM, Antonio.Gasparrini at lshtm.ac.uk wrote:
> 
> I kept those functions as internal because users don't need to call them 
> directly to use all the functionalities of the package (they are called 
> by other functions).
> Nonetheless, I want to make them available and documented because they 
> can give an idea about the process to specify the other functions.
>  
> The package is called 'dlnm' (available in the CRAN), the two internal 
> functions are 'mkbasis' ans 'mklagbasis', included as aliases in 
> 'dlnm-internal.Rd'.
> But the link ?mkbasis typed in R returns "The page cannot be displayed".
> I tried in 3 different machines (with both Vista and XP, R version 
> 2.9.1), but I got the same result.
> The strange thing is that everything is working when, instead than the 
> CRAN version, I install the .zip file with he binaries I create with my 
> machine.

I have no problem with ?mkbasis in the text or HTML display, but it 
fails in the CHM help display.  When I look at the .chm file on CRAN, I 
don't see the dlnm-internals topic.  I'll see if I can spot what's going 
wrong...

Duncan Murdoch


>  
> I hope this helps.
> Antonio Gasparrini
> 
>  >>> Duncan Murdoch <murdoch at stats.uwo.ca> 06/07/2009 12:13 >>>
> This is more of an r-devel topic, so I've sent my reply there.
> 
> On 06/07/2009 6:50 AM, Antonio.Gasparrini at lshtm.ac.uk wrote:
>  > Dear R users,
>  > 
>  > I included 2 internal functions in the package 'dlnm', called 
> 'mkbasis' and 'mklagbasis'.
>  > Despite they are not meant to be called by the users, I included them 
> in the namespace in order to make them available, keeping the process 
> more transparent and giving the opportunity to change or improve them.
> 
> The usual reason to make something an internal function is so that you
> feel no obligation to maintain the interface.  If it is in the
> NAMESPACE, you should feel guilty whenever you make incompatible changes.
> 
> Another reason to keep them internal is that they don't really fit with
> the goals of your package:  they are just a distraction.  You don't want
> people to use your package just for those things.  (This is actually the
> same reason as the first: the reason you don't want your package to be
> used for some little utility function is that you would drop it if it
> showed up in a base package.)
> 
> So if you think those functions are useful and on target, and you don't
> foresee changing them, then exporting them is reasonable.
> 
>  > I included an help page 'dlnm-internal.Rd' to document them, and some 
> examples in a package vignette I want to add.
>  > The problem is that the link to this help page doesn't work in the 
> version installed by the CRAN (eg. try ?mkbasis).
>  > I checked the help pages for internal functions in other packages: 
> some of them work (e.g. ?geepack::anova.geeglm), others don't (e.g. 
> ?gam::.First.lib).
>  > 
>  > Any suggestions?
> 
> Did you set aliases in the help pages?  Those are what help uses to find
> the page.
> 
> And what OS and R version are you using?  ?gam::.First.lib works for me
> (on Windows, with 2.9.0 or 2.9.1 patched).
> 
> Duncan Murdoch


From murdoch at stats.uwo.ca  Mon Jul  6 16:29:54 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 06 Jul 2009 10:29:54 -0400
Subject: [Rd] [R] problem with internal functions in Windows
In-Reply-To: <4A51FC86.9030701@stats.uwo.ca>
References: <4A51E4FA.5572.00B2.1@lshtm.ac.uk>
	<4A51DC4A.3080000@stats.uwo.ca>	<4A51FAE2.5572.00B2.1@lshtm.ac.uk>
	<4A51FC86.9030701@stats.uwo.ca>
Message-ID: <4A520A62.5020202@stats.uwo.ca>

On 7/6/2009 9:30 AM, Duncan Murdoch wrote:
> On 7/6/2009 8:23 AM, Antonio.Gasparrini at lshtm.ac.uk wrote:
>> 
>> I kept those functions as internal because users don't need to call them 
>> directly to use all the functionalities of the package (they are called 
>> by other functions).
>> Nonetheless, I want to make them available and documented because they 
>> can give an idea about the process to specify the other functions.
>>  
>> The package is called 'dlnm' (available in the CRAN), the two internal 
>> functions are 'mkbasis' ans 'mklagbasis', included as aliases in 
>> 'dlnm-internal.Rd'.
>> But the link ?mkbasis typed in R returns "The page cannot be displayed".
>> I tried in 3 different machines (with both Vista and XP, R version 
>> 2.9.1), but I got the same result.
>> The strange thing is that everything is working when, instead than the 
>> CRAN version, I install the .zip file with he binaries I create with my 
>> machine.
> 
> I have no problem with ?mkbasis in the text or HTML display, but it 
> fails in the CHM help display.  When I look at the .chm file on CRAN, I 
> don't see the dlnm-internals topic.  I'll see if I can spot what's going 
> wrong...

I have found the problem.  R never lists topics that are marked as 
internal in the HTML index, but normally it includes their aliases in 
the internal index it uses for those.  However, CHM help doesn't make 
use of that file, it uses the HTML index as the root for finding what 
files to include in the .chm output.  Since internal pages aren't listed 
there, it won't include the corresponding help page, and you get the 
"cannot be displayed" message.

I'll see if there's another way to include the page.

Duncan Murdoch

> Duncan Murdoch
> 
> 
>>  
>> I hope this helps.
>> Antonio Gasparrini
>> 
>>  >>> Duncan Murdoch <murdoch at stats.uwo.ca> 06/07/2009 12:13 >>>
>> This is more of an r-devel topic, so I've sent my reply there.
>> 
>> On 06/07/2009 6:50 AM, Antonio.Gasparrini at lshtm.ac.uk wrote:
>>  > Dear R users,
>>  > 
>>  > I included 2 internal functions in the package 'dlnm', called 
>> 'mkbasis' and 'mklagbasis'.
>>  > Despite they are not meant to be called by the users, I included them 
>> in the namespace in order to make them available, keeping the process 
>> more transparent and giving the opportunity to change or improve them.
>> 
>> The usual reason to make something an internal function is so that you
>> feel no obligation to maintain the interface.  If it is in the
>> NAMESPACE, you should feel guilty whenever you make incompatible changes.
>> 
>> Another reason to keep them internal is that they don't really fit with
>> the goals of your package:  they are just a distraction.  You don't want
>> people to use your package just for those things.  (This is actually the
>> same reason as the first: the reason you don't want your package to be
>> used for some little utility function is that you would drop it if it
>> showed up in a base package.)
>> 
>> So if you think those functions are useful and on target, and you don't
>> foresee changing them, then exporting them is reasonable.
>> 
>>  > I included an help page 'dlnm-internal.Rd' to document them, and some 
>> examples in a package vignette I want to add.
>>  > The problem is that the link to this help page doesn't work in the 
>> version installed by the CRAN (eg. try ?mkbasis).
>>  > I checked the help pages for internal functions in other packages: 
>> some of them work (e.g. ?geepack::anova.geeglm), others don't (e.g. 
>> ?gam::.First.lib).
>>  > 
>>  > Any suggestions?
>> 
>> Did you set aliases in the help pages?  Those are what help uses to find
>> the page.
>> 
>> And what OS and R version are you using?  ?gam::.First.lib works for me
>> (on Windows, with 2.9.0 or 2.9.1 patched).
>> 
>> Duncan Murdoch
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From rdpeng at gmail.com  Mon Jul  6 22:42:21 2009
From: rdpeng at gmail.com (Roger Peng)
Date: Mon, 6 Jul 2009 16:42:21 -0400
Subject: [Rd] Speed up code, profiling, optimization, lapply vs. loops
In-Reply-To: <4A51B526.7070705@sbox.tugraz.at>
References: <4A51B526.7070705@sbox.tugraz.at>
Message-ID: <66f3bd910907061342m73088a78j700f48e0537db954@mail.gmail.com>

My advice would be to use the profiler 'Rprof()' --- you may find that
the loop is not really the problem. In my experience, there's
relatively little difference between 'lapply' and a 'for' loop,
although 'lapply' can be faster at times.

-roger

On Mon, Jul 6, 2009 at 4:26 AM, Thorn Thaler<thothal at sbox.tugraz.at> wrote:
> High everybody,
>
> currently I'm writinig a package that, for a given family of variance
> functions depending on a parameter theta, say, computes the extended quasi
> likelihood (eql) function for different values of theta.
>
> The computation involves a couple of calls of the 'glm' routine. What I'm
> doing now is to call 'lapply' for a list of theta values and a function,
> that constructs a family object for the particular choice of theta, computes
> the glm and uses the results to get the eql. Not surprisingly the function
> is not very fast. Depending on the size of the parameter space under
> consideration it takes a couple of minutes until the function finishes.
> Testing ~1000 Parameters takes about 5 minutes on my machine.
>
> I know that loops in R are slow more often than not. Thus, I thought using
> 'lapply' is a better way. But anyways, it is just another way of a loop.
> Besides, it involves some overhead for the function call and hence i'm not
> sure wheter using 'lapply' is really the better choice.
>
> What I like to know is to figure out, where the bottleneck lies.
> Vectorization would help, but since I don't think that there is vectorized
> 'glm' function, which is able to handle a vector of family objects. I'm not
> aware if there is any choice aside from using a loop.
>
> So my questions:
> - how can I figure out where the bottleneck lies?
> - is 'lapply' always superior to a loop in terms of execution time?
> - are there any 'evil' commands that should be avoided in a loop, for they
> slow down the computation?
> - are there any good books, tutorials about how to profile R code
> efficiently?
>
> TIA 4 ur help,
>
> Thorn
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Roger D. Peng  |  http://www.biostat.jhsph.edu/~rpeng/


From gmbecker at ucdavis.edu  Tue Jul  7 00:44:28 2009
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Mon, 6 Jul 2009 15:44:28 -0700
Subject: [Rd] Speed up code, profiling, optimization, lapply vs. loops
In-Reply-To: <66f3bd910907061342m73088a78j700f48e0537db954@mail.gmail.com>
References: <4A51B526.7070705@sbox.tugraz.at>
	<66f3bd910907061342m73088a78j700f48e0537db954@mail.gmail.com>
Message-ID: <c797fbfb0907061544g5e7f06e3vf9a1da83c52222d1@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090706/5fbe5f58/attachment.pl>

From mb990434 at uni-greifswald.de  Mon Jul  6 08:50:11 2009
From: mb990434 at uni-greifswald.de (mb990434 at uni-greifswald.de)
Date: Mon,  6 Jul 2009 08:50:11 +0200 (CEST)
Subject: [Rd] Installation of R_2.9.1 & readline (PR#13805)
Message-ID: <20090706065011.CFA98282EF29@mail.pubhealth.ku.dk>

Full_Name: Noyb
Version: 2.9.1
OS: Ubuntu 9.04
Submission from: (NULL) (141.53.34.152)


Hello,
when I try to install R by "./configure", I get the following message:

<quote>
.
.
.
configure: error: --with-readline=yes (default) and headers/libs are not
available
<end of quote>.

Installation by "./configure --with-readline=no" works, but then I do not have
the comfort do use the arrow-keys for moving the cursor within a command or
scrolling through command history. Any ideas?

Thanks!


From mb990434 at uni-greifswald.de  Mon Jul  6 10:25:12 2009
From: mb990434 at uni-greifswald.de (mb990434 at uni-greifswald.de)
Date: Mon,  6 Jul 2009 10:25:12 +0200 (CEST)
Subject: [Rd] Starting R Commander doesn't work (PR#13806)
Message-ID: <20090706082512.1E135282EFC7@mail.pubhealth.ku.dk>

Full_Name: Noyb
Version: 2.9.1
OS: Ubuntu 9.04
Submission from: (NULL) (141.53.34.152)


Hello,
I installed the GUI R Commander and tried to open it out of R by

> library("Rcmdr").

The following message occurred:
"Lade n?tiges Paket: tcltk
Error in firstlib(which.lib.loc, package) : 
  Tcl/Tk auf diesem System nicht verf?gbar
Fehler: Paket 'tcltk' konnte nicht geladen werden"

(in English: Load needed package: tcltk
             Error in firstlib(which.lib.loc, package) :
             Tcl/Tk not available on this system
             Error: package 'tcltk' could not be loaded).

I'd like to use the GUI instead of working from the shell, so how do I get it to
run?

Thanks in advance.


From Soren.Hojsgaard at agrsci.dk  Mon Jul  6 10:37:35 2009
From: Soren.Hojsgaard at agrsci.dk (=?iso-8859-1?Q?S=F8ren_H=F8jsgaard?=)
Date: Mon, 6 Jul 2009 10:37:35 +0200
Subject: [Rd] Speed up code, profiling, optimization, lapply vs. loops
In-Reply-To: <4A51B526.7070705@sbox.tugraz.at>
References: <4A51B526.7070705@sbox.tugraz.at>
Message-ID: <9F0721FDD4F12D4B95AD894274F388EC018773B80A91@DJFEXMBX01.djf.agrsci.dk>

If you do

Rprof()
<your code>
Rprof(NULL)
summaryRprof()

then you'll get a listing of how much time is spent in each function of <your code>.

Regards
S?ren


________________________________________
Fra: r-devel-bounces at r-project.org [r-devel-bounces at r-project.org] P&#229; vegne af Thorn Thaler [thothal at sbox.tugraz.at]
Sendt: 6. juli 2009 10:26
Til: r-devel at r-project.org
Emne: [Rd] Speed up code, profiling, optimization, lapply vs. loops

High everybody,

currently I'm writinig a package that, for a given family of variance
functions depending on a parameter theta, say, computes the extended
quasi likelihood (eql) function for different values of theta.

The computation involves a couple of calls of the 'glm' routine. What
I'm doing now is to call 'lapply' for a list of theta values and a
function, that constructs a family object for the particular choice of
theta, computes the glm and uses the results to get the eql. Not
surprisingly the function is not very fast. Depending on the size of the
parameter space under consideration it takes a couple of minutes until
the function finishes. Testing ~1000 Parameters takes about 5 minutes on
my machine.

I know that loops in R are slow more often than not. Thus, I thought
using 'lapply' is a better way. But anyways, it is just another way of a
loop. Besides, it involves some overhead for the function call and hence
i'm not sure wheter using 'lapply' is really the better choice.

What I like to know is to figure out, where the bottleneck lies.
Vectorization would help, but since I don't think that there is
vectorized 'glm' function, which is able to handle a vector of family
objects. I'm not aware if there is any choice aside from using a loop.

So my questions:
- how can I figure out where the bottleneck lies?
- is 'lapply' always superior to a loop in terms of execution time?
- are there any 'evil' commands that should be avoided in a loop, for
they slow down the computation?
- are there any good books, tutorials about how to profile R code
efficiently?

TIA 4 ur help,

Thorn

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel

From f.papenmeier at iwm-kmrc.de  Mon Jul  6 12:50:08 2009
From: f.papenmeier at iwm-kmrc.de (f.papenmeier at iwm-kmrc.de)
Date: Mon,  6 Jul 2009 12:50:08 +0200 (CEST)
Subject: [Rd] feature request Windows: open .R script with Rgui.exe from
	Explorer (PR#13808)
Message-ID: <20090706105008.B8141282EF29@mail.pubhealth.ku.dk>

Full_Name: Frank Papenmeier
Version: 2.9.1
OS: Windows Vista
Submission from: (NULL) (134.2.190.254)


Hi,

is it possible to modify Rgui.exe in order to allow the following behavior:

Double-click in Windows explorer on fooscript.R will open an instance of
Rgui.exe with the script being opened as well as the working directory being set
to the directory of fooscript.R

Currently, one has to open Rgui.exe, select "open script", select the script,
and change the working directory to the script location afterwards.

(BTW: In R 2.8.1 one could open the script by selecting the File->"open script"
menu and afterwards one had to select File->"change directory" and it would
instantly suggest the directory of the R script. Now (with R 2.9.1) it shows the
Documents directoy after selecting File->"change directory", again. This is very
annoying as I need to click through all my folders twice. That is why I would
very much appreciate a possibility of directly opening a R script and changing
the working directory from the Windows explorer.)

Thanks!


From general_mail at i.ua  Mon Jul  6 14:18:06 2009
From: general_mail at i.ua (true-searcher)
Date: Mon, 6 Jul 2009 05:18:06 -0700 (PDT)
Subject: [Rd] Re port generating
Message-ID: <24354390.post@talk.nabble.com>


Can somebody help me.
I'm trying to use R language in a process of automatiacal report generating.
I find a mechanizm of usind DOM models for writing xml files.
I'm trying to find some gui for creating a temletes for creating DOM models
or for generating R-code to construct and write with R language specific
reports.
-- 
View this message in context: http://www.nabble.com/Report-generating-tp24354390p24354390.html
Sent from the R devel mailing list archive at Nabble.com.


From htl10 at users.sourceforge.net  Mon Jul  6 22:25:01 2009
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Mon, 6 Jul 2009 13:25:01 -0700 (PDT)
Subject: [Rd] success(?) with cross-compiling R package with R 2.9.1
Message-ID: <903856.37067.qm@web23106.mail.ird.yahoo.com>


Hi, 
(I am not longer on R-devel - please CC:)

Just when Fedora 11 is shipping a gcc 4.4 based cross-compiler - the last major distro to ship a cross-compiler, but the first to ship a gcc 4.4- one.(both Suse & Debian has been so so for a while, and I expect Ubuntu as well), and the mingw people has finally released gcc 4.4 mingw builds, I am a little disappointed to find that cross-compling support has been withdrawn from R in mid-January. I can't find any discussions... anyway, so I set about trying to revert the changes.

The bulk of the cross-compiling support was removed in three svn commits - GIT is very good as a svn client! - 

'remove support for cross-building'      - r47689
'makefile reorganization part 3'         - r47698
'remove more vestiges of cross-building' - r48109

The last one can be reverted cleanly against trunk, the first with a little manual fiddle, but the 2nd one is a pain.

Then I worked that that copying just this list over from 2.8.1 is sufficient to restore R package cross-compiling ability: (half of these files are removed in 2.9.1, half are different)
------------------
share/perl/build-help-windows.pl
share/perl/R/Rdlists.pm
src/gnuwin32/
src/gnuwin32/makeDllRes.pl
src/gnuwin32/Makefile
src/gnuwin32/pwd.pl
src/gnuwin32/MkRules
src/gnuwin32/MakeDll
src/gnuwin32/help/
src/gnuwin32/help/Makefile
src/gnuwin32/MakePkg
------------------

Then I thought there must be a simplier way - most of R 2.9.1 isn't platform-sensitive any more (in fact that seems to be the direction of the changes), the important part is just building dll. So lastly, I found that just by building the DLL and drop it into the libs folder of the unix build, the result seems to work with windows (or at least, in wine).

The procedure for building the package DLL is this:

1) insert into the file "src/gnuwin32/MkRules", just before "end of user-customizable parts", these two lines:

BINPREF=i386-mingw32-
R_EXE=/usr/bin/R

2) copy src/gnuwin32/MakeDll and src/gnuwin32/MkRules from <R_src_top>
to <win32_R_top> (the win32 R distribution no longer carries those two files - it would be nice if it does.. very subtle hint!)

3) Run

make -C <package_src_top>/src/ \
     -f <win32_R_top>/src/gnuwin32/MakeDll \
     RHOME=<win32_R_top> \ 
     DLLNAME=<package_name>

I guess my question is, other than that this is neither a supported nor recommended way of building win32 R packages, is there any forseeable problem with it? R 2.9.1 seems to be sane enough that just dropping the <package>.dll into the unix build, next to the libs/<package>.so, results in an R package usable with win32 R.

I suppose there are more people than just me who would like cross-compiling R packages to work - using a separate windows box or the win-builder on-line service has a fair amount of round-trip time, compared to cross-compiling (and try it out in wine).

Cheers,
Hin-Tak





From htl10 at users.sourceforge.net  Tue Jul  7 00:23:07 2009
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Mon, 6 Jul 2009 15:23:07 -0700 (PDT)
Subject: [Rd] R 2.8->2.9 change that breaks some upgrade scenarios
Message-ID: <340397.17501.qm@web23105.mail.ird.yahoo.com>


I finally got round to look at a little problem I have - most of the time when I use R I would be using snpMatrix (now part of bioconductor, I wrote a substantial part of), so I had $HOME/.Rprofile to save some typing. Upgrading, switching versions used to work fine with R 2.8 then it broke with 2.9..

Apparently it is because most of SHLIB, INSTALL, etc used to be fairly extensive shell scripts in R 2.8 where options not specific to a particular script is passed to R itself. Those scripts also do more of --vanilla (--no-site-files, --no-init-files, etc), and it is also possible to pass --vanilla, etc explicitly. The R 2.9 implementations of these scripts are fairly thin wrappers of R routines, and they silently(?) ignore extra options.

The specific behaviors of the scripts are probably not gauranteed, and it is no problem temporarily moving .Rprofile away, etc for the occasional installations/upgrade of packages, but I think it is a valid scenario to want to have a site-/user-customized profile for day-to-day R usage, and a clean/vanilla R session for installation, etc. A few more of the 
  --no-site-files, --no-init-files, options should go into the R 2.9 versions of SHLIB, INSTALL, etc?





From hpages at fhcrc.org  Tue Jul  7 02:25:04 2009
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Mon, 06 Jul 2009 17:25:04 -0700
Subject: [Rd] Protection stack overflow when calling
 setGeneric()/setMethod() from within .onLoad()
Message-ID: <4A5295E0.30000@fhcrc.org>

Hi list,

Calling setGeneric()/setMethod() from within the .onLoad() hook
of MyPkg package produces the following error:

   > gctorture(TRUE)
   > library(MyPkg)
   .onLoad(): ok1
   .onLoad(): ok2
   Error : protect(): protection stack overflow
   Error : .onLoad failed in 'loadNamespace' for 'MyPkg'
   Error: package/namespace load failed for 'MyPkg'

This is with the following code in the .onLoad() hook:

   .onLoad <- function(libname, pkgname) {
     cat(".onLoad(): ok1\n")
     setGeneric("foo", function(x, y) standardGeneric("foo"))
     cat(".onLoad(): ok2\n")
     setMethod("foo", c("ANY", "ANY"),
         function(x, y) cat("calling foo,ANY,ANY method\n")
     )
     cat(".onLoad(): ok3\n")
   }

and with R-2.9.0/R-2.9.1 or recent R-devel.

Note that without the call to gctorture(TRUE), everything *seems* to work
fine:

   > library(MyPkg)
   .onLoad(): ok1
   .onLoad(): ok2
   .onLoad(): ok3

but it could be that my session is now corrupted because some users have
reported the nasty and now famous:

   Error in get(name, envir = table) :
     formal argument "envir" matched by multiple actual arguments
   Calls: assign ... .getGeneric -> .cacheGeneric -> .cacheGenericTable -> get

after they've loaded MyPkg and started to run some other code that is not
necessarily calling foo(). Those users are running R-2.9.1 or a very recent
R-devel (less than 1 week old) so they are not triggering the reg.finalizer()
problem reported here (and fixed) a few weeks ago:

   https://stat.ethz.ch/pipermail/r-devel/2009-June/053607.html

Also note that if I make foo() a function of one argument only, I don't
get the protection stack overflow anymore.

Cheers,
H.


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From murdoch at stats.uwo.ca  Tue Jul  7 03:34:29 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 06 Jul 2009 21:34:29 -0400
Subject: [Rd] feature request Windows: open .R script with Rgui.exe from
 Explorer (PR#13808)
In-Reply-To: <20090706105008.B8141282EF29@mail.pubhealth.ku.dk>
References: <20090706105008.B8141282EF29@mail.pubhealth.ku.dk>
Message-ID: <4A52A625.7020600@stats.uwo.ca>

On 06/07/2009 6:50 AM, f.papenmeier at iwm-kmrc.de wrote:
> Full_Name: Frank Papenmeier
> Version: 2.9.1
> OS: Windows Vista
> Submission from: (NULL) (134.2.190.254)
> 
> 
> Hi,
> 
> is it possible to modify Rgui.exe in order to allow the following behavior:
> 
> Double-click in Windows explorer on fooscript.R will open an instance of
> Rgui.exe with the script being opened as well as the working directory being set
> to the directory of fooscript.R

That sounds like a reasonable request.  I'll review a patch to implement 
it if you write one (or convince someone else to do so).  One way would 
be to change the R edit() command so it doesn't wait for you to finish 
editing; then it could all be done by R code run from your startup file.

Duncan Murdoch

> 
> Currently, one has to open Rgui.exe, select "open script", select the script,
> and change the working directory to the script location afterwards.
> 
> (BTW: In R 2.8.1 one could open the script by selecting the File->"open script"
> menu and afterwards one had to select File->"change directory" and it would
> instantly suggest the directory of the R script. Now (with R 2.9.1) it shows the
> Documents directoy after selecting File->"change directory", again. This is very
> annoying as I need to click through all my folders twice. That is why I would
> very much appreciate a possibility of directly opening a R script and changing
> the working directory from the Windows explorer.)
> 
> Thanks!
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch at stats.uwo.ca  Tue Jul  7 03:40:09 2009
From: murdoch at stats.uwo.ca (murdoch at stats.uwo.ca)
Date: Tue,  7 Jul 2009 03:40:09 +0200 (CEST)
Subject: [Rd] feature request Windows: open .R script with Rgui.exe from
	(PR#13811)
Message-ID: <20090707014009.C08FD282EF53@mail.pubhealth.ku.dk>

On 06/07/2009 6:50 AM, f.papenmeier at iwm-kmrc.de wrote:
> Full_Name: Frank Papenmeier
> Version: 2.9.1
> OS: Windows Vista
> Submission from: (NULL) (134.2.190.254)
> 
> 
> Hi,
> 
> is it possible to modify Rgui.exe in order to allow the following behavior:
> 
> Double-click in Windows explorer on fooscript.R will open an instance of
> Rgui.exe with the script being opened as well as the working directory being set
> to the directory of fooscript.R

That sounds like a reasonable request.  I'll review a patch to implement 
it if you write one (or convince someone else to do so).  One way would 
be to change the R edit() command so it doesn't wait for you to finish 
editing; then it could all be done by R code run from your startup file.

Duncan Murdoch

> 
> Currently, one has to open Rgui.exe, select "open script", select the script,
> and change the working directory to the script location afterwards.
> 
> (BTW: In R 2.8.1 one could open the script by selecting the File->"open script"
> menu and afterwards one had to select File->"change directory" and it would
> instantly suggest the directory of the R script. Now (with R 2.9.1) it shows the
> Documents directoy after selecting File->"change directory", again. This is very
> annoying as I need to click through all my folders twice. That is why I would
> very much appreciate a possibility of directly opening a R script and changing
> the working directory from the Windows explorer.)
> 
> Thanks!
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From khansen at stat.berkeley.edu  Tue Jul  7 06:53:36 2009
From: khansen at stat.berkeley.edu (Kasper Daniel Hansen)
Date: Mon, 6 Jul 2009 21:53:36 -0700
Subject: [Rd] Speed up code, profiling, optimization, lapply vs. loops
In-Reply-To: <4A51B526.7070705@sbox.tugraz.at>
References: <4A51B526.7070705@sbox.tugraz.at>
Message-ID: <7BDFF633-8E5D-4330-8583-35743292C8F4@stat.berkeley.edu>

Aside from the advice from other people, you seem to be doing many glm  
calls. A big part of a call to a model function involves setting up  
the design matrix, check for missing values etc. If I understand you  
description correctly you may only need to do this once. This will  
require some poking around in glm, but might save you a lot of time.

Kasper

On Jul 6, 2009, at 1:26 , Thorn Thaler wrote:

> High everybody,
>
> currently I'm writinig a package that, for a given family of  
> variance functions depending on a parameter theta, say, computes the  
> extended quasi likelihood (eql) function for different values of  
> theta.
>
> The computation involves a couple of calls of the 'glm' routine.  
> What I'm doing now is to call 'lapply' for a list of theta values  
> and a function, that constructs a family object for the particular  
> choice of theta, computes the glm and uses the results to get the  
> eql. Not surprisingly the function is not very fast. Depending on  
> the size of the parameter space under consideration it takes a  
> couple of minutes until the function finishes. Testing ~1000  
> Parameters takes about 5 minutes on my machine.
>
> I know that loops in R are slow more often than not. Thus, I thought  
> using 'lapply' is a better way. But anyways, it is just another way  
> of a loop. Besides, it involves some overhead for the function call  
> and hence i'm not sure wheter using 'lapply' is really the better  
> choice.
>
> What I like to know is to figure out, where the bottleneck lies.  
> Vectorization would help, but since I don't think that there is  
> vectorized 'glm' function, which is able to handle a vector of  
> family objects. I'm not aware if there is any choice aside from  
> using a loop.
>
> So my questions:
> - how can I figure out where the bottleneck lies?
> - is 'lapply' always superior to a loop in terms of execution time?
> - are there any 'evil' commands that should be avoided in a loop,  
> for they slow down the computation?
> - are there any good books, tutorials about how to profile R code  
> efficiently?
>
> TIA 4 ur help,
>
> Thorn
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From cowan.pd at gmail.com  Tue Jul  7 07:10:28 2009
From: cowan.pd at gmail.com (Peter Cowan)
Date: Mon, 6 Jul 2009 22:10:28 -0700
Subject: [Rd] Starting R Commander doesn't work (PR#13806)
In-Reply-To: <20090706082512.1E135282EFC7@mail.pubhealth.ku.dk>
References: <20090706082512.1E135282EFC7@mail.pubhealth.ku.dk>
Message-ID: <e1fc21b0907062210m54ec127cpb54c4672641dbd2c@mail.gmail.com>

On Mon, Jul 6, 2009 at 1:25 AM, <mb990434 at uni-greifswald.de> wrote:
> Full_Name: Noyb
> Version: 2.9.1
> OS: Ubuntu 9.04
> Submission from: (NULL) (141.53.34.152)
>
>
> Hello,
> I installed the GUI R Commander and tried to open it out of R by
>
Noyb,

It looks like your new to R, welcome to the community.  A couple quick
notes, first the bug reporting system for the R community is
specifically for bugs only, not support issues.  The developers of R
are quite strict about this.  It looks that you've filed a couple of
bug reports, whereas a better place to send such queries would be
R-help.  Second, R Commander, is an add on package, so questions
regarding it's use should be directed to the appropriate email list (I
don't know it, because I don't use R commander.)  The bug tracker, and
the developer list that bugs are sent to, are for core R issues.

As an R newbie I think you'll find the following sites helpful
<http://cran.r-project.org/manuals.html>,
<http://wiki.r-project.org/rwiki/doku.php>, and
<http://www.R-project.org/posting-guide.html>

>> library("Rcmdr").
>
> The following message occurred:
> "Lade n?tiges Paket: tcltk
> Error in firstlib(which.lib.loc, package) :
> ?Tcl/Tk auf diesem System nicht verf?gbar
> Fehler: Paket 'tcltk' konnte nicht geladen werden"
>
> (in English: Load needed package: tcltk
> ? ? ? ? ? ? Error in firstlib(which.lib.loc, package) :
> ? ? ? ? ? ? Tcl/Tk not available on this system
> ? ? ? ? ? ? Error: package 'tcltk' could not be loaded).
>
> I'd like to use the GUI instead of working from the shell, so how do I get it to
> run?

I'm guessing that the tcltk package isn't available because it hasn't
been installed yet.  Something similar to install.packages("tcltk")
ought to do the trick.  type ?install.packages at an R prompt for more
info.

HTH

Peter


>
> Thanks in advance.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ligges at statistik.tu-dortmund.de  Tue Jul  7 09:30:59 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 07 Jul 2009 09:30:59 +0200
Subject: [Rd] Installation of R_2.9.1 & readline (PR#13805)
In-Reply-To: <20090706065011.CFA98282EF29@mail.pubhealth.ku.dk>
References: <20090706065011.CFA98282EF29@mail.pubhealth.ku.dk>
Message-ID: <4A52F9B3.3050101@statistik.tu-dortmund.de>



mb990434 at uni-greifswald.de wrote:
> Full_Name: Noyb
> Version: 2.9.1
> OS: Ubuntu 9.04
> Submission from: (NULL) (141.53.34.152)
> 
> 
> Hello,
> when I try to install R by "./configure", I get the following message:
> 
> <quote>
> .
> .
> .
> configure: error: --with-readline=yes (default) and headers/libs are not
> available
> <end of quote>.
> 
> Installation by "./configure --with-readline=no" works, but then I do not have
> the comfort do use the arrow-keys for moving the cursor within a command or
> scrolling through command history. Any ideas?


Not a bug at all, almsot a frequently asked question,so please do NOT 
write a bug report and read what a bug report is intended to be.

Answer: Install readline-devel to your OS.


Uwe Ligges


> Thanks!
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Tue Jul  7 09:45:04 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 07 Jul 2009 09:45:04 +0200
Subject: [Rd] Starting R Commander doesn't work (PR#13806)
In-Reply-To: <e1fc21b0907062210m54ec127cpb54c4672641dbd2c@mail.gmail.com>
References: <20090706082512.1E135282EFC7@mail.pubhealth.ku.dk>
	<e1fc21b0907062210m54ec127cpb54c4672641dbd2c@mail.gmail.com>
Message-ID: <4A52FD00.1050601@statistik.tu-dortmund.de>



Peter Cowan wrote:
> On Mon, Jul 6, 2009 at 1:25 AM, <mb990434 at uni-greifswald.de> wrote:
>> Full_Name: Noyb
>> Version: 2.9.1
>> OS: Ubuntu 9.04
>> Submission from: (NULL) (141.53.34.152)
>>
>>
>> Hello,
>> I installed the GUI R Commander and tried to open it out of R by
>>
> Noyb,
> 
> It looks like your new to R, welcome to the community.  A couple quick
> notes, first the bug reporting system for the R community is
> specifically for bugs only, not support issues.  The developers of R
> are quite strict about this.  It looks that you've filed a couple of
> bug reports, whereas a better place to send such queries would be
> R-help.  Second, R Commander, is an add on package, so questions
> regarding it's use should be directed to the appropriate email list (I
> don't know it, because I don't use R commander.)  The bug tracker, and
> the developer list that bugs are sent to, are for core R issues.
> 
> As an R newbie I think you'll find the following sites helpful
> <http://cran.r-project.org/manuals.html>,
> <http://wiki.r-project.org/rwiki/doku.php>, and
> <http://www.R-project.org/posting-guide.html>
> 
>>> library("Rcmdr").
>> The following message occurred:
>> "Lade n?tiges Paket: tcltk
>> Error in firstlib(which.lib.loc, package) :
>>  Tcl/Tk auf diesem System nicht verf?gbar
>> Fehler: Paket 'tcltk' konnte nicht geladen werden"
>>
>> (in English: Load needed package: tcltk
>>             Error in firstlib(which.lib.loc, package) :
>>             Tcl/Tk not available on this system
>>             Error: package 'tcltk' could not be loaded).
>>
>> I'd like to use the GUI instead of working from the shell, so how do I get it to
>> run?
> 
> I'm guessing that the tcltk package isn't available because it hasn't
> been installed yet.  Something similar to install.packages("tcltk")
> ought to do the trick.  type ?install.packages at an R prompt for more
> info.


Actually, tcltk is installed with R given the required support libraries 
are installed on your system. If not, you got a warning when saying 
./configure, I guess.

Best wishes,
Uwe


> HTH
> 
> Peter
> 
> 
>> Thanks in advance.
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From rdpeng at gmail.com  Tue Jul  7 13:54:38 2009
From: rdpeng at gmail.com (Roger Peng)
Date: Tue, 7 Jul 2009 07:54:38 -0400
Subject: [Rd] Speed up code, profiling, optimization, lapply vs. loops
In-Reply-To: <7BDFF633-8E5D-4330-8583-35743292C8F4@stat.berkeley.edu>
References: <4A51B526.7070705@sbox.tugraz.at>
	<7BDFF633-8E5D-4330-8583-35743292C8F4@stat.berkeley.edu>
Message-ID: <66f3bd910907070454v52f96af9o1932fe37872d1e20@mail.gmail.com>

That's a good point---I've found that skipping a lot of the setup that
'glm' does and calling 'glm.fit' directly can save a lot of time.

-roger

On Tue, Jul 7, 2009 at 12:53 AM, Kasper Daniel
Hansen<khansen at stat.berkeley.edu> wrote:
> Aside from the advice from other people, you seem to be doing many glm
> calls. A big part of a call to a model function involves setting up the
> design matrix, check for missing values etc. If I understand you description
> correctly you may only need to do this once. This will require some poking
> around in glm, but might save you a lot of time.
>
> Kasper
>
> On Jul 6, 2009, at 1:26 , Thorn Thaler wrote:
>
>> High everybody,
>>
>> currently I'm writinig a package that, for a given family of variance
>> functions depending on a parameter theta, say, computes the extended quasi
>> likelihood (eql) function for different values of theta.
>>
>> The computation involves a couple of calls of the 'glm' routine. What I'm
>> doing now is to call 'lapply' for a list of theta values and a function,
>> that constructs a family object for the particular choice of theta, computes
>> the glm and uses the results to get the eql. Not surprisingly the function
>> is not very fast. Depending on the size of the parameter space under
>> consideration it takes a couple of minutes until the function finishes.
>> Testing ~1000 Parameters takes about 5 minutes on my machine.
>>
>> I know that loops in R are slow more often than not. Thus, I thought using
>> 'lapply' is a better way. But anyways, it is just another way of a loop.
>> Besides, it involves some overhead for the function call and hence i'm not
>> sure wheter using 'lapply' is really the better choice.
>>
>> What I like to know is to figure out, where the bottleneck lies.
>> Vectorization would help, but since I don't think that there is vectorized
>> 'glm' function, which is able to handle a vector of family objects. I'm not
>> aware if there is any choice aside from using a loop.
>>
>> So my questions:
>> - how can I figure out where the bottleneck lies?
>> - is 'lapply' always superior to a loop in terms of execution time?
>> - are there any 'evil' commands that should be avoided in a loop, for they
>> slow down the computation?
>> - are there any good books, tutorials about how to profile R code
>> efficiently?
>>
>> TIA 4 ur help,
>>
>> Thorn
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Roger D. Peng  |  http://www.biostat.jhsph.edu/~rpeng/


From thothal at sbox.tugraz.at  Tue Jul  7 14:28:46 2009
From: thothal at sbox.tugraz.at (Thorn Thaler)
Date: Tue, 07 Jul 2009 14:28:46 +0200
Subject: [Rd] Speed up code, profiling, optimization, lapply vs. loops
In-Reply-To: <66f3bd910907070454v52f96af9o1932fe37872d1e20@mail.gmail.com>
References: <4A51B526.7070705@sbox.tugraz.at>	
	<7BDFF633-8E5D-4330-8583-35743292C8F4@stat.berkeley.edu>
	<66f3bd910907070454v52f96af9o1932fe37872d1e20@mail.gmail.com>
Message-ID: <4A533F7E.8010609@sbox.tugraz.at>

Thanks for ur good advices. I've run Rprof and figured out that the 
bottleneck lies within the deviance function, which uses "integrate" to 
determine the deviance numerically. Since I'm not aware of a closed form 
solution for the integral

\int 1/(t^k*(1-t)^l) dt, \forall k,l \in R  ,

I've to rely on the numerical procedure. 'glm' itself is according to 
Rprof suprisingly not that time consuming and I could narrow the lack of 
performance down to multiple calls of the (numerically determined) 
deviance function, which is currently implemented by:

devf <- function(y, mu, ...) {
   mapply(function(y, mu, ...) {
     integrand <- function(u, y, ...)
       return((y - u) / varf(u, ...))
     int <- try(suppressWarnings(
       integrate(integrand, lower=y, upper=mu, y=y, ...)), silent=TRUE)
     if (class(int) == "try-error") {
       stop("Deviance could not be evaluated!\n", int)
     } else {
       return(-2 * int$value)
     }
   }, y, mu, ...)
}

where 'varf' denotes the particular variance function depending on some 
parameter vector.

I'd appreciate any comments on the code. Is it possible to speed up the 
computation?


From rkoenker at uiuc.edu  Tue Jul  7 15:01:06 2009
From: rkoenker at uiuc.edu (roger koenker)
Date: Tue, 7 Jul 2009 08:01:06 -0500
Subject: [Rd] Generic backsolve?
Message-ID: <771D9F2A-AB08-4A4C-9375-59BA04121958@uiuc.edu>

When loading the package SparseM, a "warning" is generated
indicating:

	The following object(s) are masked from package:base :

One, of three, examples is the function backsolve which is defined
in SparseM as:

setGeneric("backsolve",
         function(r, x, k = NULL, upper.tri = NULL, transpose = NULL,   
twice = TRUE, ...)
                 standardGeneric("backsolve"),
         useAsDefault= function(r, x,  k = NULL, upper.tri = NULL,
                 transpose = NULL, twice = TRUE, ...)
                 base::backsolve(r, x, k = ncol(r), upper.tri = TRUE,
                         transpose = FALSE, ...))

Methods are then defined for sparse matrix classes.

My question is:  Is there a better way to do this that will avoid the
load warning?  Should I revert to the suggestion in the "Writing
R Extensions" manual and avoid the setGeneric approach
entirely?  (My most recent experience is with R 2.9.1, but this
has been an issue for several versions.)


url:    www.econ.uiuc.edu/~roger            Roger Koenker
email    rkoenker at uiuc.edu            Department of Economics
vox:     217-333-4558                University of Illinois
fax:       217-244-6678                Urbana, IL 61801


From hb at stat.berkeley.edu  Wed Jul  8 02:36:48 2009
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Tue, 7 Jul 2009 17:36:48 -0700
Subject: [Rd] reg.finalizer(..., add=FALSE)?
Message-ID: <59d7961d0907071736j73f22031y291662df97968293@mail.gmail.com>

Is it possible to (i) clear or (ii) override already registered
finalizer functions, e.g. reg.finalizer(e, f, add=FALSE) cf.
on.exit(..., add=FALSE)?

Currently:

> env <- new.env()
> reg.finalizer(env, function(...) cat("Finalizer A!\n"))
NULL
> reg.finalizer(env, function(...) cat("Finalizer B!\n"))
NULL
> reg.finalizer(env, function(...) cat("Finalizer C!\n"))
NULL
> gc()
         used (Mb) gc trigger (Mb) max used (Mb)
Ncells 115827  3.1     350000  9.4   350000  9.4
Vcells  77109  0.6     786432  6.0   370917  2.9
> rm(env)
> gc()
Finalizer C!
Finalizer B!
Finalizer A!
         used (Mb) gc trigger (Mb) max used (Mb)
Ncells 115932  3.1     350000  9.4   350000  9.4
Vcells  77648  0.6     786432  6.0   370917  2.9

I wish to have only finalizer "C" to run.

/Henrik


From murdoch at stats.uwo.ca  Wed Jul  8 03:20:11 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 07 Jul 2009 21:20:11 -0400
Subject: [Rd] reg.finalizer(..., add=FALSE)?
In-Reply-To: <59d7961d0907071736j73f22031y291662df97968293@mail.gmail.com>
References: <59d7961d0907071736j73f22031y291662df97968293@mail.gmail.com>
Message-ID: <4A53F44B.3090707@stats.uwo.ca>

On 07/07/2009 8:36 PM, Henrik Bengtsson wrote:
> Is it possible to (i) clear or (ii) override already registered
> finalizer functions, e.g. reg.finalizer(e, f, add=FALSE) cf.
> on.exit(..., add=FALSE)?

No, but you can have the finalizer function call something else, and 
change the thing it calls.  E.g.

reg.finalizer(env, function (...) CleanUp(...))

will call CleanUp in the global environment (the environment of the 
anonymous finalizer); change that function and the cleanup behaviour 
will change.

Duncan Murdoch

> 
> Currently:
> 
>> env <- new.env()
>> reg.finalizer(env, function(...) cat("Finalizer A!\n"))
> NULL
>> reg.finalizer(env, function(...) cat("Finalizer B!\n"))
> NULL
>> reg.finalizer(env, function(...) cat("Finalizer C!\n"))
> NULL
>> gc()
>          used (Mb) gc trigger (Mb) max used (Mb)
> Ncells 115827  3.1     350000  9.4   350000  9.4
> Vcells  77109  0.6     786432  6.0   370917  2.9
>> rm(env)
>> gc()
> Finalizer C!
> Finalizer B!
> Finalizer A!
>          used (Mb) gc trigger (Mb) max used (Mb)
> Ncells 115932  3.1     350000  9.4   350000  9.4
> Vcells  77648  0.6     786432  6.0   370917  2.9
> 
> I wish to have only finalizer "C" to run.
> 
> /Henrik
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From enrique.bengoechea at credit-suisse.com  Wed Jul  8 10:15:04 2009
From: enrique.bengoechea at credit-suisse.com (=?iso-8859-1?Q?Bengoechea_Bartolom=E9_Enrique_=28SIES_73=29?=)
Date: Wed, 8 Jul 2009 10:15:04 +0200
Subject: [Rd] Suggestion: Dimension-sensitive attributes
Message-ID: <19811401A1D8174CB3EAD7F6072E9B50023F38A7@chsa1025.share.beluni.net>

Hi,

I agree with Henrik that his suggestion to have "dimension vector attributes" working like dimnames (see below) would be an extremely useful infrastructure adittion to R.

If this is not considered for R-core, I am happy to try to implement this in a package, as a new class. And possibly do the same thing for data frames. Should you have any comments, ideas or suggestions about it, please share!

Best,

Enrique

-----------------------------------------------------------------------------
Subject: 
From: Henrik Bengtsson <hb_at_stat.berkeley.edu 
Date: Sun, 07 Jun 2009 14:42:08 -0700

Hi, 

maybe this has been suggested before, but would it be possible, without not breaking too much existing code, to add other "dimension vector attributes" in addition to 'dimnames'? These attributes would then be subsetted just like dimnames. 

Something like this: 

> x <- array(1:30, dim=c(2,3,5)) 
> dimnames(x) <- list(c("a", "b"), c("a1", "a2", "a3"), NULL); 
> dimattr(x, "misc") <- list(1:2, list(x=1:5, y=letters[1:8], z=NA), letters[1:5]); 


> y <- x[,1:2,2:3] 
> str(dimnames(y)) 

List of 3 

 $ : chr [1:2] "a" "b"
 $ : chr [1:2] "a1" "a2"
 $ : NULL


> str(dimattr(x, "misc")) 

List of 3 
 $ : int [1:2] 1 2 
 $ :List of 2 
  ..$ x: int [1:5] 1 2 3 4 5 
  ..$ y: chr [1:8] "a" "b" "c" "d" ... 
 $ : chr [1:2] "b" "c" 

 I can imagine this needs to be added in several places and functions such as is.vector() needs to be updated etc. It is not a quick migration, but is it something worth considering for the future? 

/Henrik 


From b.rowlingson at lancaster.ac.uk  Wed Jul  8 13:07:02 2009
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 8 Jul 2009 12:07:02 +0100
Subject: [Rd] "Roxygenating" packages
Message-ID: <d8ad40b50907080407y5bcc3a64r5c8a70271bc1dc3a@mail.gmail.com>

Is there any interest in a method of taking a package with
documentation in Rd files and attaching it to package R files in
Roxygen format? I can see a few problems with a totally general
solution but it might be possible to make a script that provides a
kickstart to converting a package to Roxygen.

Or is it trickier than it seems?

Barry


From edd at debian.org  Wed Jul  8 14:44:20 2009
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 8 Jul 2009 07:44:20 -0500
Subject: [Rd] Installation of R_2.9.1 & readline (PR#13805)
In-Reply-To: <20090706065011.CFA98282EF29@mail.pubhealth.ku.dk>
References: <20090706065011.CFA98282EF29@mail.pubhealth.ku.dk>
Message-ID: <19028.38052.291176.258935@ron.nulle.part>


On 6 July 2009 at 08:50, mb990434 at uni-greifswald.de wrote:
| Submission from: (NULL) (141.53.34.152)
| 
| 
| Hello,
| when I try to install R by "./configure", I get the following message:
| 
| <quote>
| .
| .
| .
| configure: error: --with-readline=yes (default) and headers/libs are not
| available
| <end of quote>.
| 
| Installation by "./configure --with-readline=no" works, but then I do not have
| the comfort do use the arrow-keys for moving the cursor within a command or
| scrolling through command history. Any ideas?

See http://cran.r-project.org/bin/linux/ubuntu/ for detailed instruction on
getting pre-compiled current versions of R for Ubuntu.

As for your other non-bug bug report, you also get Rcmdr for Ubuntu via 'sudo
apt-get r-cran-rcmdr' --- and the same holds for a number of other CRAN
packages which are already in Ubuntu.

Dirk

-- 
Three out of two people have difficulties with fractions.


From cbeleites at units.it  Wed Jul  8 15:23:27 2009
From: cbeleites at units.it (Claudia Beleites)
Date: Wed, 08 Jul 2009 15:23:27 +0200
Subject: [Rd] "Roxygenating" packages
References: <d8ad40b50907080407y5bcc3a64r5c8a70271bc1dc3a@mail.gmail.com>
Message-ID: <h326kf$1ul$1@ger.gmane.org>

Dear Barry,

I'd definitely be interested. Though I don't have time to do it :-(
But I'd volunteer as test user :-)

--Claudia

> Is there any interest in a method of taking a package with
> documentation in Rd files and attaching it to package R files in
> Roxygen format? I can see a few problems with a totally general
> solution but it might be possible to make a script that provides a
> kickstart to converting a package to Roxygen.
> 
> Or is it trickier than it seems?


From h.wickham at gmail.com  Wed Jul  8 16:53:50 2009
From: h.wickham at gmail.com (hadley wickham)
Date: Wed, 8 Jul 2009 16:53:50 +0200
Subject: [Rd] "Roxygenating" packages
In-Reply-To: <d8ad40b50907080407y5bcc3a64r5c8a70271bc1dc3a@mail.gmail.com>
References: <d8ad40b50907080407y5bcc3a64r5c8a70271bc1dc3a@mail.gmail.com>
Message-ID: <f8e6ff050907080753i27b806e5r84a62a26fe51f148@mail.gmail.com>

Sounds like a neat idea!  Especially with Duncan Murdoch's recent work
making it easy to parse rdoc files in R.
Hadley

On Wed, Jul 8, 2009 at 1:07 PM, Barry
Rowlingson<b.rowlingson at lancaster.ac.uk> wrote:
> Is there any interest in a method of taking a package with
> documentation in Rd files and attaching it to package R files in
> Roxygen format? I can see a few problems with a totally general
> solution but it might be possible to make a script that provides a
> kickstart to converting a package to Roxygen.
>
> Or is it trickier than it seems?
>
> Barry
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
http://had.co.nz/


From tplate at acm.org  Wed Jul  8 18:00:50 2009
From: tplate at acm.org (Tony Plate)
Date: Wed, 08 Jul 2009 10:00:50 -0600
Subject: [Rd] Suggestion: Dimension-sensitive attributes
In-Reply-To: <19811401A1D8174CB3EAD7F6072E9B50023F38A7@chsa1025.share.beluni.net>
References: <19811401A1D8174CB3EAD7F6072E9B50023F38A7@chsa1025.share.beluni.net>
Message-ID: <4A54C2B2.1010308@acm.org>

There have been times when I've thought this could be useful too.

One way to go about it could be to introduce a special attribute that 
controls how attributes are dealt with in subsetting, e.g., 
"attr.dimname.like".  The contents of this would be character data; on 
subsetting, any attribute that had a name appearing in this vector would 
be treated as a dimension.  At the same time, it might be nice to also 
introduce "attr.keep.on.subset", which would specify which attributes 
should be kept on the result of a subsetting operation (could be useful 
for attributes that specify units).  This of course could be a way of 
implementing Henrik's suggestion: dimattr(x, "misc") <- value would add 
"misc" to the "attr.dimname.like" attribute and also set the attribute 
"misc".  The tricky part would be modifying the "[" methods.   However, 
the most useful would probably be the one for ordinary matrices and 
arrays, and others could be modified when and if their maintainers see 
the need.

-- Tony Plate

Bengoechea Bartolom? Enrique (SIES 73) wrote:
> Hi,
>
> I agree with Henrik that his suggestion to have "dimension vector attributes" working like dimnames (see below) would be an extremely useful infrastructure adittion to R.
>
> If this is not considered for R-core, I am happy to try to implement this in a package, as a new class. And possibly do the same thing for data frames. Should you have any comments, ideas or suggestions about it, please share!
>
> Best,
>
> Enrique
>
> -----------------------------------------------------------------------------
> Subject: 
> From: Henrik Bengtsson <hb_at_stat.berkeley.edu 
> Date: Sun, 07 Jun 2009 14:42:08 -0700
>
> Hi, 
>
> maybe this has been suggested before, but would it be possible, without not breaking too much existing code, to add other "dimension vector attributes" in addition to 'dimnames'? These attributes would then be subsetted just like dimnames. 
>
> Something like this: 
>
>   
>> x <- array(1:30, dim=c(2,3,5)) 
>> dimnames(x) <- list(c("a", "b"), c("a1", "a2", "a3"), NULL); 
>> dimattr(x, "misc") <- list(1:2, list(x=1:5, y=letters[1:8], z=NA), letters[1:5]); 
>>     
>
>
>   
>> y <- x[,1:2,2:3] 
>> str(dimnames(y)) 
>>     
>
> List of 3 
>
>  $ : chr [1:2] "a" "b"
>  $ : chr [1:2] "a1" "a2"
>  $ : NULL
>
>
>   
>> str(dimattr(x, "misc")) 
>>     
>
> List of 3 
>  $ : int [1:2] 1 2 
>  $ :List of 2 
>   ..$ x: int [1:5] 1 2 3 4 5 
>   ..$ y: chr [1:8] "a" "b" "c" "d" ... 
>  $ : chr [1:2] "b" "c" 
>
>  I can imagine this needs to be added in several places and functions such as is.vector() needs to be updated etc. It is not a quick migration, but is it something worth considering for the future? 
>
> /Henrik 
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From b.rowlingson at lancaster.ac.uk  Wed Jul  8 18:13:37 2009
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 8 Jul 2009 17:13:37 +0100
Subject: [Rd] "Roxygenating" packages
In-Reply-To: <f8e6ff050907080753i27b806e5r84a62a26fe51f148@mail.gmail.com>
References: <d8ad40b50907080407y5bcc3a64r5c8a70271bc1dc3a@mail.gmail.com>
	<f8e6ff050907080753i27b806e5r84a62a26fe51f148@mail.gmail.com>
Message-ID: <d8ad40b50907080913m75640879o8295cca370b1f128@mail.gmail.com>

On Wed, Jul 8, 2009 at 3:53 PM, hadley wickham<h.wickham at gmail.com> wrote:
> Sounds like a neat idea! ?Especially with Duncan Murdoch's recent work
> making it easy to parse rdoc files in R.

 I reckon the tricky bit is going to be working out how to map the
various possibilities of rdoc files into Roxygen syntax.

 We do have a huge potential test suite though, since once the .R
files are passed through Roxygen we should get back the .Rd files that
we started with....

 For example, just looking at the sp package, there's gridded.R which
has functions documented in gridded-methods.Rd. Are Rd file names
essentially arbitrary, meaning we need to look at the \alias section
to see what functions are documented? And then if those functions are
in more than one .R file what do we do?

 The various class descriptions and methods also seem to be scattered
amongst various files too. This is not an easy problem...

Barry


From khansen at stat.berkeley.edu  Thu Jul  9 07:15:30 2009
From: khansen at stat.berkeley.edu (Kasper Daniel Hansen)
Date: Wed, 8 Jul 2009 22:15:30 -0700
Subject: [Rd] bug in seq_along
Message-ID: <7E0D03FE-2742-4442-977F-538AE7DE920A@stat.berkeley.edu>

Using the IRanges package from Bioconductor and somewhat recent R-2.9.1.

ov = IRanges(1:3, 4:6)
length(ov) # 3
seq(along = ov) # 1 2 3 as wanted
seq_along(ov) # 1!

I had expected that the last line would yield 1:3. My guess is that  
somehow seq_along don't utilize that ov is an S4 class with a length  
method.

The last line of the *Details* section of ?seq has a typeo. Currently  
it is
      'seq.int', 'seq_along' and 'seq.int' are primitive: the latter two
      ignore any argument name.
I would guess it ought to be
      'seq.int', 'seq_along' and 'seq_len' are primitive: the latter two
      ignore any argument name.

Kasper


From h.wickham at gmail.com  Thu Jul  9 09:55:15 2009
From: h.wickham at gmail.com (hadley wickham)
Date: Thu, 9 Jul 2009 09:55:15 +0200
Subject: [Rd] "Roxygenating" packages
In-Reply-To: <d8ad40b50907080913m75640879o8295cca370b1f128@mail.gmail.com>
References: <d8ad40b50907080407y5bcc3a64r5c8a70271bc1dc3a@mail.gmail.com>
	<f8e6ff050907080753i27b806e5r84a62a26fe51f148@mail.gmail.com>
	<d8ad40b50907080913m75640879o8295cca370b1f128@mail.gmail.com>
Message-ID: <f8e6ff050907090055n52c2a95foedef31a9a45daa14@mail.gmail.com>

On Wed, Jul 8, 2009 at 6:13 PM, Barry
Rowlingson<b.rowlingson at lancaster.ac.uk> wrote:
> On Wed, Jul 8, 2009 at 3:53 PM, hadley wickham<h.wickham at gmail.com> wrote:
>> Sounds like a neat idea! ?Especially with Duncan Murdoch's recent work
>> making it easy to parse rdoc files in R.
>
> ?I reckon the tricky bit is going to be working out how to map the
> various possibilities of rdoc files into Roxygen syntax.
>
> ?We do have a huge potential test suite though, since once the .R
> files are passed through Roxygen we should get back the .Rd files that
> we started with....
>
> ?For example, just looking at the sp package, there's gridded.R which
> has functions documented in gridded-methods.Rd. Are Rd file names
> essentially arbitrary, meaning we need to look at the \alias section
> to see what functions are documented? And then if those functions are
> in more than one .R file what do we do?

Yes, the file names are arbitrary, so you need to inspect the alias
sections, and then output them to @alias rdoc tags.  I'd think the
best way to start would be to convert each .rd file to a .r files
containing the rdoc comment block with tags, and then leave it up to
the user to match those comment blocks to individual functions.
Roxygen encourages more documentation of individual functions (rather
than a single rd file which documents many files), but teasing apart a
single rdoc file into multiple roxygen blocks would be exceedingly
difficult.

Hadley

-- 
http://had.co.nz/


From enrique.bengoechea at credit-suisse.com  Thu Jul  9 10:01:12 2009
From: enrique.bengoechea at credit-suisse.com (=?iso-8859-1?Q?Bengoechea_Bartolom=E9_Enrique_=28SIES_73=29?=)
Date: Thu, 9 Jul 2009 10:01:12 +0200
Subject: [Rd] Suggestion: Dimension-sensitive attributes
In-Reply-To: <4A54C2B2.1010308@acm.org>
Message-ID: <19811401A1D8174CB3EAD7F6072E9B50023F3A71@chsa1025.share.beluni.net>

I've also had several use cases where I needed "cell-like" attributes, that is, attributes that have the same dimensions as the original array and are subsetted in the same way --along all its dimensions.

So we're talking about a way to add metadata to matrices/arrays at 3 possible levels:

	1) at the "whole object" level: attributes that are not dropped on subsetting 
	2) at the "dimension" level: attributes that behave like "dimnames", i.e. subsetted along each dimension
	3) at the "cell" level: attributes that are subsetted in the same way as the original array

My proposal would be simpler that Tony's suggestion: like "dimnames", just have reserved attribute names for each case, say "objdata", "dimdata", and "celldata" (or "objattr", "dimattr" and "cellattr").

On the other hand, Tony's pattern would allow as many attributes of each type as necessary (some multiplicity is already possible with the simpler design as dimdata or celldata could be lists of lists), at the cost of a more complex scheme of attributes that needs to be "parsed" each time.

On Tony's suggestion, "attr.keep.on.subset" and "attr.dimname.like" (and possible "attr.cell.like") could be kept on a single list with 3 elements, something like:

> attr(x, "attr.subset.with") <- list(object=..., dims=..., cells=...)

Would something like this make sense for R-core --either for standard arrays or as a new class-- or would it be better implemented in a package?

Enrique

-----Original Message-----
From: Tony Plate [mailto:tplate at acm.org] 
Sent: mi?rcoles, 08 de julio de 2009 18:01
To: r-devel at r-project.org
Cc: Bengoechea Bartolom? Enrique (SIES 73); Henrik Bengtsson
Subject: Re: [Rd] Suggestion: Dimension-sensitive attributes

There have been times when I've thought this could be useful too.

One way to go about it could be to introduce a special attribute that controls how attributes are dealt with in subsetting, e.g., "attr.dimname.like".  The contents of this would be character data; on subsetting, any attribute that had a name appearing in this vector would be treated as a dimension.  At the same time, it might be nice to also introduce "attr.keep.on.subset", which would specify which attributes should be kept on the result of a subsetting operation (could be useful for attributes that specify units).  This of course could be a way of implementing Henrik's suggestion: dimattr(x, "misc") <- value would add "misc" to the "attr.dimname.like" attribute and also set the attribute 
"misc".  The tricky part would be modifying the "[" methods.   However, 
the most useful would probably be the one for ordinary matrices and arrays, and others could be modified when and if their maintainers see the need.

-- Tony Plate

Bengoechea Bartolom? Enrique (SIES 73) wrote:
> Hi,
>
> I agree with Henrik that his suggestion to have "dimension vector attributes" working like dimnames (see below) would be an extremely useful infrastructure adittion to R.
>
> If this is not considered for R-core, I am happy to try to implement this in a package, as a new class. And possibly do the same thing for data frames. Should you have any comments, ideas or suggestions about it, please share!
>
> Best,
>
> Enrique
>
> ----------------------------------------------------------------------
> -------
> Subject: 
> From: Henrik Bengtsson <hb_at_stat.berkeley.edu
> Date: Sun, 07 Jun 2009 14:42:08 -0700
>
> Hi,
>
> maybe this has been suggested before, but would it be possible, without not breaking too much existing code, to add other "dimension vector attributes" in addition to 'dimnames'? These attributes would then be subsetted just like dimnames. 
>
> Something like this: 
>
>   
>> x <- array(1:30, dim=c(2,3,5))
>> dimnames(x) <- list(c("a", "b"), c("a1", "a2", "a3"), NULL); 
>> dimattr(x, "misc") <- list(1:2, list(x=1:5, y=letters[1:8], z=NA), 
>> letters[1:5]);
>>     
>
>
>   
>> y <- x[,1:2,2:3]
>> str(dimnames(y))
>>     
>
> List of 3 
>
>  $ : chr [1:2] "a" "b"
>  $ : chr [1:2] "a1" "a2"
>  $ : NULL
>
>
>   
>> str(dimattr(x, "misc")) 
>>     
>
> List of 3 
>  $ : int [1:2] 1 2 
>  $ :List of 2 
>   ..$ x: int [1:5] 1 2 3 4 5 
>   ..$ y: chr [1:8] "a" "b" "c" "d" ... 
>  $ : chr [1:2] "b" "c" 
>
>  I can imagine this needs to be added in several places and functions such as is.vector() needs to be updated etc. It is not a quick migration, but is it something worth considering for the future? 
>
> /Henrik 
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>   


From tuechler at gmx.at  Thu Jul  9 10:55:43 2009
From: tuechler at gmx.at (Heinz Tuechler)
Date: Thu, 09 Jul 2009 10:55:43 +0200
Subject: [Rd] Suggestion: Dimension-sensitive attributes
In-Reply-To: <19811401A1D8174CB3EAD7F6072E9B50023F3A71@chsa1025.share.be
	luni.net>
References: <4A54C2B2.1010308@acm.org>
	<19811401A1D8174CB3EAD7F6072E9B50023F3A71@chsa1025.share.beluni.net>
Message-ID: <200907090856.n698uHxh006457@hypatia.math.ethz.ch>

At 10:01 09.07.2009, SIES 73 wrote:
>I've also had several use cases where I needed 
>"cell-like" attributes, that is, attributes that 
>have the same dimensions as the original array 
>and are subsetted in the same way --along all its dimensions.
>
>So we're talking about a way to add metadata to 
>matrices/arrays at 3 possible levels:
>
>         1) at the "whole object" level: 
> attributes that are not dropped on subsetting
>         2) at the "dimension" level: attributes 
> that behave like "dimnames", i.e. subsetted along each dimension
>         3) at the "cell" level: attributes that 
> are subsetted in the same way as the original array
>
>My proposal would be simpler that Tony's 
>suggestion: like "dimnames", just have reserved 
>attribute names for each case, say "objdata", 
>"dimdata", and "celldata" (or "objattr", "dimattr" and "cellattr").

If "objattr", "dimattr" and "cellattr" are lists, 
they would offer save places for all attributes 
that should be kept on subsetting. In my view 
this would be very useful, because that way a 
general solution for data description, like 
variabel names, variable labels, units, ... could be reached.


>On the other hand, Tony's pattern would allow as 
>many attributes of each type as necessary (some 
>multiplicity is already possible with the 
>simpler design as dimdata or celldata could be 
>lists of lists), at the cost of a more complex 
>scheme of attributes that needs to be "parsed" each time.
>
>On Tony's suggestion, "attr.keep.on.subset" and 
>"attr.dimname.like" (and possible 
>"attr.cell.like") could be kept on a single list 
>with 3 elements, something like:
>
> > attr(x, "attr.subset.with") <- list(object=..., dims=..., cells=...)
>
>Would something like this make sense for R-core 
>--either for standard arrays or as a new class-- 
>or would it be better implemented in a package?
>
>Enrique
>
>-----Original Message-----
>From: Tony Plate [mailto:tplate at acm.org]
>Sent: mi?rcoles, 08 de julio de 2009 18:01
>To: r-devel at r-project.org
>Cc: Bengoechea Bartolom? Enrique (SIES 73); Henrik Bengtsson
>Subject: Re: [Rd] Suggestion: Dimension-sensitive attributes
>
>There have been times when I've thought this could be useful too.
>
>One way to go about it could be to introduce a 
>special attribute that controls how attributes 
>are dealt with in subsetting, e.g., 
>"attr.dimname.like".  The contents of this would 
>be character data; on subsetting, any attribute 
>that had a name appearing in this vector would 
>be treated as a dimension.  At the same time, it 
>might be nice to also introduce 
>"attr.keep.on.subset", which would specify which 
>attributes should be kept on the result of a 
>subsetting operation (could be useful for 
>attributes that specify units).  This of course 
>could be a way of implementing Henrik's 
>suggestion: dimattr(x, "misc") <- value would 
>add "misc" to the "attr.dimname.like" attribute and also set the attribute
>"misc".  The tricky part would be modifying the "[" methods.   However,
>the most useful would probably be the one for 
>ordinary matrices and arrays, and others could 
>be modified when and if their maintainers see the need.
>
>-- Tony Plate
>
>Bengoechea Bartolom? Enrique (SIES 73) wrote:
> > Hi,
> >
> > I agree with Henrik that his suggestion to 
> have "dimension vector attributes" working like 
> dimnames (see below) would be an extremely useful infrastructure adittion to R.
> >
> > If this is not considered for R-core, I am 
> happy to try to implement this in a package, as 
> a new class. And possibly do the same thing for 
> data frames. Should you have any comments, 
> ideas or suggestions about it, please share!
> >
> > Best,
> >
> > Enrique
> >
> > ----------------------------------------------------------------------
> > -------
> > Subject:
> > From: Henrik Bengtsson <hb_at_stat.berkeley.edu
> > Date: Sun, 07 Jun 2009 14:42:08 -0700
> >
> > Hi,
> >
> > maybe this has been suggested before, but 
> would it be possible, without not breaking too 
> much existing code, to add other "dimension 
> vector attributes" in addition to 'dimnames'? 
> These attributes would then be subsetted just like dimnames.
> >
> > Something like this:
> >
> >
> >> x <- array(1:30, dim=c(2,3,5))
> >> dimnames(x) <- list(c("a", "b"), c("a1", "a2", "a3"), NULL);
> >> dimattr(x, "misc") <- list(1:2, list(x=1:5, y=letters[1:8], z=NA),
> >> letters[1:5]);
> >>
> >
> >
> >
> >> y <- x[,1:2,2:3]
> >> str(dimnames(y))
> >>
> >
> > List of 3
> >
> >  $ : chr [1:2] "a" "b"
> >  $ : chr [1:2] "a1" "a2"
> >  $ : NULL
> >
> >
> >
> >> str(dimattr(x, "misc"))
> >>
> >
> > List of 3
> >  $ : int [1:2] 1 2
> >  $ :List of 2
> >   ..$ x: int [1:5] 1 2 3 4 5
> >   ..$ y: chr [1:8] "a" "b" "c" "d" ...
> >  $ : chr [1:2] "b" "c"
> >
> >  I can imagine this needs to be added in 
> several places and functions such as 
> is.vector() needs to be updated etc. It is not 
> a quick migration, but is it something worth considering for the future?
> >
> > /Henrik
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
>
>______________________________________________
>R-devel at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-devel


From enrique.bengoechea at credit-suisse.com  Thu Jul  9 11:14:12 2009
From: enrique.bengoechea at credit-suisse.com (=?iso-8859-1?Q?Bengoechea_Bartolom=E9_Enrique_=28SIES_73=29?=)
Date: Thu, 9 Jul 2009 11:14:12 +0200
Subject: [Rd] Suggestion: Dimension-sensitive attributes
In-Reply-To: <200907090855.n698ttjj019442@mail-gw24.credit-suisse.com>
Message-ID: <19811401A1D8174CB3EAD7F6072E9B50023F3AB1@chsa1025.share.beluni.net>

> If "objattr", "dimattr" and "cellattr" are lists, they would offer save places for all attributes that should be kept on subsetting. 

My proposed design would be that:

	* "objattr" would be a list of attributes (just preserved on subsetting)
	* "dimattr" would be a list with as many elements as array dimensions. Each element can be any object whose length matches the corresponding array dimension's length and that can be itself subsetted with "[": so it could be a vector, a list, a data frame...
	* "cellattr" would be any object whose dimensions match the array dimensions: another array, a data frame...

> In my view this would be very useful, because that way a general solution for data description, like variabel names, variable labels, units, ... could be reached.

Indeed, that's the objective: attaching user-defined metadata that is automatically synchronized with subsetting operations to the actual data.

I've had dozens of use cases on my own R programs that needed this type of pattern, and seen it implemented in different ways in several classes (xts, timeSeries, AnnotatedDataFrame, etc.) As you point, this could offer a unified design for a common need.

Enrique

-----Original Message-----
From: Heinz Tuechler [mailto:tuechler at gmx.at] 
Sent: jueves, 09 de julio de 2009 10:56
To: Bengoechea Bartolom? Enrique (SIES 73); Tony Plate; r-devel at r-project.org
Cc: Henrik Bengtsson
Subject: Re: [Rd] Suggestion: Dimension-sensitive attributes

At 10:01 09.07.2009, SIES 73 wrote:
>I've also had several use cases where I needed "cell-like" attributes, 
>that is, attributes that have the same dimensions as the original array 
>and are subsetted in the same way --along all its dimensions.
>
>So we're talking about a way to add metadata to matrices/arrays at 3 
>possible levels:
>
>         1) at the "whole object" level: 
> attributes that are not dropped on subsetting
>         2) at the "dimension" level: attributes that behave like 
> "dimnames", i.e. subsetted along each dimension
>         3) at the "cell" level: attributes that are subsetted in the 
> same way as the original array
>
>My proposal would be simpler that Tony's
>suggestion: like "dimnames", just have reserved attribute names for 
>each case, say "objdata", "dimdata", and "celldata" (or "objattr", 
>"dimattr" and "cellattr").

If "objattr", "dimattr" and "cellattr" are lists, they would offer save places for all attributes that should be kept on subsetting. In my view this would be very useful, because that way a general solution for data description, like variabel names, variable labels, units, ... could be reached.


>On the other hand, Tony's pattern would allow as many attributes of 
>each type as necessary (some multiplicity is already possible with the 
>simpler design as dimdata or celldata could be lists of lists), at the 
>cost of a more complex scheme of attributes that needs to be "parsed" 
>each time.
>
>On Tony's suggestion, "attr.keep.on.subset" and "attr.dimname.like" 
>(and possible
>"attr.cell.like") could be kept on a single list with 3 elements, 
>something like:
>
> > attr(x, "attr.subset.with") <- list(object=..., dims=..., cells=...)
>
>Would something like this make sense for R-core --either for standard 
>arrays or as a new class-- or would it be better implemented in a 
>package?
>
>Enrique
>


From tuechler at gmx.at  Thu Jul  9 11:48:20 2009
From: tuechler at gmx.at (Heinz Tuechler)
Date: Thu, 09 Jul 2009 11:48:20 +0200
Subject: [Rd] Suggestion: Dimension-sensitive attributes
In-Reply-To: <19811401A1D8174CB3EAD7F6072E9B50023F3AB1@chsa1025.share.be
	luni.net>
References: <200907090855.n698ttjj019442@mail-gw24.credit-suisse.com>
	<19811401A1D8174CB3EAD7F6072E9B50023F3AB1@chsa1025.share.beluni.net>
Message-ID: <200907090949.n699mwG4013622@hypatia.math.ethz.ch>

At 11:14 09.07.2009, SIES 73 wrote:
> > If "objattr", "dimattr" and "cellattr" are 
> lists, they would offer save places for all 
> attributes that should be kept on subsetting.
>
>My proposed design would be that:
>
>         * "objattr" would be a list of 
> attributes (just preserved on subsetting)
>         * "dimattr" would be a list with as 
> many elements as array dimensions. Each element 
> can be any object whose length matches the 
> corresponding array dimension's length and that 
> can be itself subsetted with "[": so it could 
> be a vector, a list, a data frame...
>         * "cellattr" would be any object whose 
> dimensions match the array dimensions: another array, a data frame...
>
> > In my view this would be very useful, because 
> that way a general solution for data 
> description, like variabel names, variable labels, units, ... could be reached.
>
>Indeed, that's the objective: attaching 
>user-defined metadata that is automatically 
>synchronized with subsetting operations to the actual data.
>
>I've had dozens of use cases on my own R 
>programs that needed this type of pattern, and 
>seen it implemented in different ways in several 
>classes (xts, timeSeries, AnnotatedDataFrame, 
>etc.) As you point, this could offer a unified design for a common need.
>
>Enrique


For my personal use it was sufficient to create a 
class called "documented" with a corresponding 
subsetting method and one attribute, also called 
"documented". This attribute may contain 
'varlabel', 'varname', 'value.labels', 
'missing.values', 'code.ordered', 'comment', ...
It is copied on subsetting.
I think attributes concerning e.g. dimensions, 
i.e. parts of an object should stay in this 
object-related attribute and be extracted on 
subsetting. Since subsetting an object leads to a 
new object, this could then have its own, new persisting attribute.
The more difficult part may to be the binding of objects.

Heinz




>-----Original Message-----
>From: Heinz Tuechler [mailto:tuechler at gmx.at]
>Sent: jueves, 09 de julio de 2009 10:56
>To: Bengoechea Bartolom? Enrique (SIES 73); Tony Plate; r-devel at r-project.org
>Cc: Henrik Bengtsson
>Subject: Re: [Rd] Suggestion: Dimension-sensitive attributes
>
>At 10:01 09.07.2009, SIES 73 wrote:
> >I've also had several use cases where I needed "cell-like" attributes,
> >that is, attributes that have the same dimensions as the original array
> >and are subsetted in the same way --along all its dimensions.
> >
> >So we're talking about a way to add metadata to matrices/arrays at 3
> >possible levels:
> >
> >         1) at the "whole object" level:
> > attributes that are not dropped on subsetting
> >         2) at the "dimension" level: attributes that behave like
> > "dimnames", i.e. subsetted along each dimension
> >         3) at the "cell" level: attributes that are subsetted in the
> > same way as the original array
> >
> >My proposal would be simpler that Tony's
> >suggestion: like "dimnames", just have reserved attribute names for
> >each case, say "objdata", "dimdata", and "celldata" (or "objattr",
> >"dimattr" and "cellattr").
>
>If "objattr", "dimattr" and "cellattr" are 
>lists, they would offer save places for all 
>attributes that should be kept on subsetting. In 
>my view this would be very useful, because that 
>way a general solution for data description, 
>like variabel names, variable labels, units, ... could be reached.
>
>
> >On the other hand, Tony's pattern would allow as many attributes of
> >each type as necessary (some multiplicity is already possible with the
> >simpler design as dimdata or celldata could be lists of lists), at the
> >cost of a more complex scheme of attributes that needs to be "parsed"
> >each time.
> >
> >On Tony's suggestion, "attr.keep.on.subset" and "attr.dimname.like"
> >(and possible
> >"attr.cell.like") could be kept on a single list with 3 elements,
> >something like:
> >
> > > attr(x, "attr.subset.with") <- list(object=..., dims=..., cells=...)
> >
> >Would something like this make sense for R-core --either for standard
> >arrays or as a new class-- or would it be better implemented in a
> >package?
> >
> >Enrique
> >


From lgautier at gmail.com  Thu Jul  9 14:15:12 2009
From: lgautier at gmail.com (Laurent Gautier)
Date: Thu, 09 Jul 2009 14:15:12 +0200
Subject: [Rd] Suggestion: Dimension-sensitive attributes
Message-ID: <4A55DF50.9080403@gmail.com>

Starting by working on an interface for such object(s) is probably the 
first step toward a unified solution, and this before about if and how R 
attributes are used.

It would also help to ensure a smooth transition from the existing 
classes implementing a similar solution (first the interface is added to 
those classes, then after a grace period the classes are eventually 
refactored).

Dimension-level is what seems to the be most needed... but I am not 
convinced of the practicality of the object-level, and cell-level scheme 
s proposed:

- Object-level, if not linked to any dimension-attribute is such saying 
that one want to attach anything to any object. That's what attr() is 
already doing.

- Cell-level, is may be out-of-scope for one first trial (but may be I 
missed the use-cases for it)



If starting with behaviour, it seems to boil to having "["/"[<-" and 
"dimmeta()"/"dimmeta<-()", :

- extract "[" / replace "[<-" :

   * keeps working the way it already does

   * extracts a subset of the object as well as a subset of the 
dimension-associated metadata.

   * departing too much from the way "[" is working and add 
behind-the-curtain name matching will only compromise the chances of 
adoption.

   * forget about the bit about which metadata is kept and which one 
isn't when using "[". Make a function "unmeta()" (similar behavior to 
"unname()") to drop them all, or work it out with something like
 > dimmeta(x, 1) <- NULL # drop the metadata associated with dimension 1

- access the dimension-associated metadata:

   * may be a function called "dimmeta()" (for consistency with 
"dimnames()") ? The signature could be dimmeta(x, i), with x the object, 
and i the dimension requested. A replace function "dimmeta<-"(x, i, 
value) would be provided.


In the abstract the "names" associated with a given dimension is just 
one of possible metadata, but I'd keep away from meddling with it for a 
start.


It would seem natural that metadata associated with one dimension:
would a table-like object (data.frame seems natural in R, and 
unfortunately there is no data.frame-like structure in R).



L.


From david.keegan at shenick.com  Thu Jul  9 14:35:10 2009
From: david.keegan at shenick.com (david.keegan at shenick.com)
Date: Thu,  9 Jul 2009 14:35:10 +0200 (CEST)
Subject: [Rd] Wishlist: Rscript to support --args option like R. (PR#13815)
Message-ID: <20090709123510.407542831FF3@mail.pubhealth.ku.dk>

Full_Name: David Keegan
Version: 2.9.0
OS: Fedora 11
Submission from: (NULL) (62.77.176.130)


R has a --args option to mark the end of command line arguments intended for R
itself (following arguments are passed to the user code).

It would be nice if Rscript could support a similar option to avoid arguments
intended for the user code being mis-interpreted by Rscript itself.


From enrique.bengoechea at credit-suisse.com  Thu Jul  9 16:14:32 2009
From: enrique.bengoechea at credit-suisse.com (=?iso-8859-1?Q?Bengoechea_Bartolom=E9_Enrique_=28SIES_73=29?=)
Date: Thu, 9 Jul 2009 16:14:32 +0200
Subject: [Rd] Suggestion: Dimension-sensitive attributes
In-Reply-To: <4A55DF50.9080403@gmail.com>
Message-ID: <19811401A1D8174CB3EAD7F6072E9B50023F3B7B@chsa1025.share.beluni.net>

Very good points. They closely match the current prototype I have written...

> Starting by working on an interface for such object(s) is probably the first step toward a unified solution

Agree. Getting a good API is always the most important step.

> Dimension-level is what seems to the be most needed...

True, and that was Henrik's original suggestion. But I find all three are closely related to the same topic (metadata) and as such deserve to be worked out together, but if most people agree otherwise, the direction is clear.

> - Object-level, if not linked to any dimension-attribute is such saying that one want to attach anything to any object. That's what attr() is already doing.

Except that plain attributes are dropped when subsetting. I've found myself dozens of times creating classes must to create a `[` method for them that preserves some attributes. This looks like such a common situation that having a mechanism to avoid the user programming the same stuff again and again would be handy.

> - Cell-level, is may be out-of-scope for one first trial (but may be I missed the use-cases for it)

Although I agree that cell-level is far less common, here are a couple of use cases I've hit recently:

1) the array represents time series in columns. The original data comes in a different frequency for each column, with some data missing. When you align to a common frequency and interpolate missing values, I needed a factor array of the same dimension as the data array identifying whether each observation corresponded to the actual original series, or had been interpolated, and whether interpolation was due to missing data or to frequency alignment. Of course, I needed the factor array to be subsetted together with the array.

2) the array is a table representing data to be formatted by a reporting system (Sweave, R2HTML, etc), similar to the 'xtable' class. So I needed to associate formatting information to each individual "cell" (font, color, borders...), as well to each dimension and to the whole table.

Anyway, it's far easier to add "cell-level" metadata on top of the other features with a new class: for `[` subscripting just call NextMethod() and then apply the same indexes to the object storing the cell-level metadata. But I still think it's useful to work out data object's metadata at all possible levels with a unified interface.


About the subscripting `[` methods, I don't see the need to modify `[<-` for arrays, as out-of-bound indexes generate errors with arrays (unlike vectors or data frames), so `[<-` would only replace data and leave metadata untouched. Am I missing something? 

> may be a function called "dimmeta()" (for consistency with "dimnames()") ? 

I'm using 'dimdata' in my current prototype, and Henrik suggested 'dimattr', but I really like your proposal more. 

Wrappers to the two first elements of 'dimmeta' for 2-dim arrays could be added in the same vein as 'rownames' and 'colnames': 'rowmeta' and 'colmeta'.

> The signature could be dimmeta(x, i), with x the object, 

For consistency with 'dimnames', the 'i' argument could be dropped and use dimmeta(x)[[i]] instead...


Other standard generics to be affected would be:

 * rbind & cbind for 2-dim arrays/matrices: they should combine the metadata, and for dimension-sensitive metadata can be modelled upon what is done with dimnames: use rowmeta (colmeta) of the first object with them in cbind (rbind), and combine colmeta (rowmeta) of all objects with them, filling with NAs/NULLs/.. for non metadata-sensitive objects being combined. An issue of coercing dimmeta of different classes may arise.

 * `dim<-`, but this may raise the same problem of coercing dimmeta of different classes.


...and I agree with the rest of your comments.

Best,

Enrique

-----Original Message-----
From: Laurent Gautier [mailto:lgautier at gmail.com] 
Sent: jueves, 09 de julio de 2009 14:15
Cc: Heinz Tuechler; Bengoechea Bartolom? Enrique (SIES 73); Tony Plate; Henrik Bengtsson; r-devel at r-project.org
Subject: Re: [Rd] Suggestion: Dimension-sensitive attributes

Starting by working on an interface for such object(s) is probably the first step toward a unified solution, and this before about if and how R attributes are used.

It would also help to ensure a smooth transition from the existing classes implementing a similar solution (first the interface is added to those classes, then after a grace period the classes are eventually refactored).

Dimension-level is what seems to the be most needed... but I am not convinced of the practicality of the object-level, and cell-level scheme s proposed:

- Object-level, if not linked to any dimension-attribute is such saying that one want to attach anything to any object. That's what attr() is already doing.

- Cell-level, is may be out-of-scope for one first trial (but may be I missed the use-cases for it)



If starting with behaviour, it seems to boil to having "["/"[<-" and 
"dimmeta()"/"dimmeta<-()", :

- extract "[" / replace "[<-" :

   * keeps working the way it already does

   * extracts a subset of the object as well as a subset of the 
dimension-associated metadata.

   * departing too much from the way "[" is working and add 
behind-the-curtain name matching will only compromise the chances of 
adoption.

   * forget about the bit about which metadata is kept and which one 
isn't when using "[". Make a function "unmeta()" (similar behavior to 
"unname()") to drop them all, or work it out with something like
 > dimmeta(x, 1) <- NULL # drop the metadata associated with dimension 1

- access the dimension-associated metadata:

   * may be a function called "dimmeta()" (for consistency with 
"dimnames()") ? The signature could be dimmeta(x, i), with x the object, 
and i the dimension requested. A replace function "dimmeta<-"(x, i, 
value) would be provided.


In the abstract the "names" associated with a given dimension is just 
one of possible metadata, but I'd keep away from meddling with it for a 
start.


It would seem natural that metadata associated with one dimension:
would a table-like object (data.frame seems natural in R, and 
unfortunately there is no data.frame-like structure in R).



L.


From spencer.graves at prodsyse.com  Thu Jul  9 16:33:32 2009
From: spencer.graves at prodsyse.com (spencerg)
Date: Thu, 09 Jul 2009 07:33:32 -0700
Subject: [Rd] Number of functions, data sets, ..., in a package?
Message-ID: <4A55FFBC.4010805@prodsyse.com>

Hello: 


      How can one get the number of functions and data sets in a package? 


      I've written a function "PackageSum2" to get an extended package 
summary for an installed package.  I get much of what I want from the 
object returned by "help(package=pkgName)".  For example, 
"help(pac=...)$info[[1]]" is a character vector giving author, 
maintainer, date built, etc.  "help(pac=...)$info[[2]]" is a character 
vector with at least one row for each help page;  I can get the number 
of help pages by subtracting the number starting with blank (" ") from 
the length.  And "help(pac=...)$info[[3]]" is a character matrix 
describing the vignettes. 


      Is there a reasonably easy way to get numbers of (a) functions and 
(b) data sets in the package? 


      I want this for a the next version of "PackageSum2" in the 
"RSiteSearch" package.  Based partly on previous input from this list, 
the package is being renamed to "sos" with the primary 
"RSiteSearch.function" function being renamed to "findFn".  You can 
install the current development version via 'install.packages("sos", 
repos="http://R-Forge.R-project.org")'. 


      Thanks,
      Spencer


From ggrothendieck at gmail.com  Thu Jul  9 16:45:52 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 9 Jul 2009 10:45:52 -0400
Subject: [Rd] Number of functions, data sets, ..., in a package?
In-Reply-To: <4A55FFBC.4010805@prodsyse.com>
References: <4A55FFBC.4010805@prodsyse.com>
Message-ID: <971536df0907090745p2d79e2adsdd668922dd5f393c@mail.gmail.com>

On Thu, Jul 9, 2009 at 10:33 AM, spencerg<spencer.graves at prodsyse.com> wrote:
> Hello:
>
> ? ? How can one get the number of functions and data sets in a package?
>
> ? ? I've written a function "PackageSum2" to get an extended package summary
> for an installed package. ?I get much of what I want from the object
> returned by "help(package=pkgName)". ?For example, "help(pac=...)$info[[1]]"
> is a character vector giving author, maintainer, date built, etc.
> ?"help(pac=...)$info[[2]]" is a character vector with at least one row for
> each help page; ?I can get the number of help pages by subtracting the
> number starting with blank (" ") from the length. ?And
> "help(pac=...)$info[[3]]" is a character matrix describing the vignettes.

Also look at ?packageDescription

>
> ? ? Is there a reasonably easy way to get numbers of (a) functions and (b)
> data sets in the package?
>
> ? ? I want this for a the next version of "PackageSum2" in the "RSiteSearch"
> package. ?Based partly on previous input from this list, the package is
> being renamed to "sos" with the primary "RSiteSearch.function" function
> being renamed to "findFn". ?You can install the current development version
> via 'install.packages("sos", repos="http://R-Forge.R-project.org")'.
>

Check out the source of codoc in the tools package.

> ? ? Thanks,
> ? ? Spencer
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From enrique.bengoechea at credit-suisse.com  Thu Jul  9 16:56:32 2009
From: enrique.bengoechea at credit-suisse.com (=?iso-8859-1?Q?Bengoechea_Bartolom=E9_Enrique_=28SIES_73=29?=)
Date: Thu, 9 Jul 2009 16:56:32 +0200
Subject: [Rd] Suggestion: Dimension-sensitive attributes
In-Reply-To: <4A55DF50.9080403@gmail.com>
Message-ID: <19811401A1D8174CB3EAD7F6072E9B50023F3B9D@chsa1025.share.beluni.net>

Forgot to answer this one:

> It would seem natural that metadata associated with one dimension:
> would a table-like object  

Right. A data frame has the problem that for most use cases one would want that each dimension length matches the *rows* of the data frame instead of the columns, but it is the columns what we would have "for free" when allowing "dimmeta" elements to be lists...

Enrique

-----Original Message-----
From: Laurent Gautier [mailto:lgautier at gmail.com] 
Sent: jueves, 09 de julio de 2009 14:15
Cc: Heinz Tuechler; Bengoechea Bartolom? Enrique (SIES 73); Tony Plate; Henrik Bengtsson; r-devel at r-project.org
Subject: Re: [Rd] Suggestion: Dimension-sensitive attributes

Starting by working on an interface for such object(s) is probably the first step toward a unified solution, and this before about if and how R attributes are used.

It would also help to ensure a smooth transition from the existing classes implementing a similar solution (first the interface is added to those classes, then after a grace period the classes are eventually refactored).

Dimension-level is what seems to the be most needed... but I am not convinced of the practicality of the object-level, and cell-level scheme s proposed:

- Object-level, if not linked to any dimension-attribute is such saying that one want to attach anything to any object. That's what attr() is already doing.

- Cell-level, is may be out-of-scope for one first trial (but may be I missed the use-cases for it)



If starting with behaviour, it seems to boil to having "["/"[<-" and 
"dimmeta()"/"dimmeta<-()", :

- extract "[" / replace "[<-" :

   * keeps working the way it already does

   * extracts a subset of the object as well as a subset of the 
dimension-associated metadata.

   * departing too much from the way "[" is working and add 
behind-the-curtain name matching will only compromise the chances of 
adoption.

   * forget about the bit about which metadata is kept and which one 
isn't when using "[". Make a function "unmeta()" (similar behavior to 
"unname()") to drop them all, or work it out with something like
 > dimmeta(x, 1) <- NULL # drop the metadata associated with dimension 1

- access the dimension-associated metadata:

   * may be a function called "dimmeta()" (for consistency with 
"dimnames()") ? The signature could be dimmeta(x, i), with x the object, 
and i the dimension requested. A replace function "dimmeta<-"(x, i, 
value) would be provided.


In the abstract the "names" associated with a given dimension is just 
one of possible metadata, but I'd keep away from meddling with it for a 
start.


It would seem natural that metadata associated with one dimension:
would a table-like object (data.frame seems natural in R, and 
unfortunately there is no data.frame-like structure in R).



L.


From ivo at iugrina.com  Thu Jul  9 17:05:27 2009
From: ivo at iugrina.com (Ivo Ugrina)
Date: Thu, 09 Jul 2009 17:05:27 +0200
Subject: [Rd] Improvement of [dpq]wilcox functions
Message-ID: <4A560737.9080005@iugrina.com>

Hi,

I believe I have significantly improved [dpq]wilcox
functions by implementing Harding's algorithm:
Harding, E.F. (1984): An Efficient, Minimal-storage Procedure
for Calculating the Mann-Whitney U, Generalized U and Similar
Distributions, App. Statist., 33, 1-6

Results on my computer show (against R-2.9.1):

> system.time( dwilcox( 800, 800, 80) )
   user  system elapsed
  0.240   0.180   0.443
> system.time( dwilcox( (1:2800), 80, 80) )
   user  system elapsed
  0.290   0.020   0.30
> system.time( dwilcox( (1:2800), 160, 160) )
   user  system elapsed
  0.810   0.060   0.868
> system.time( dwilcox( (1:28000), 210, 210) )
   user  system elapsed
 17.700   0.600  18.313
RAM: ~ 700MB
> system.time( pwilcox( 21000, 211, 211) )
   user  system elapsed
 18.110   0.640  18.762
> system.time( a <- qwilcox( 0.43, 200, 400) )
^C
Timing stopped at: 14.39 1.43 18.794
RAM: > 1.4GB at interrupt time

> system.time( dwilcox(800, 800, 80) )
   user  system elapsed
  0.140   0.000   0.144
> system.time( dwilcox( (1:2800), 80, 80) )
   user  system elapsed
  0.010   0.000   0.007
> system.time( dwilcox( (1:2800), 160, 160) )
   user  system elapsed
  0.020   0.000   0.016
> system.time( dwilcox( (1:28000), 210, 210) )
   user  system elapsed
  0.050   0.000   0.05
RAM: < 1MB
> system.time( pwilcox( 21000, 211, 211) )
   user  system elapsed
  0.020   0.000   0.025
> system.time( a <- qwilcox( 0.43, 200, 400) )
   user  system elapsed
  0.040   0.000   0.07
RAM: < 1MB

There is no more need for
wilcox_free at [dpq]wilcox in src/library/stats/distn.R
(every other call after the first one with the same m,n
will just read the results from the array so it will be
really fast) and for
#define WILCOX_MAX 50 in src/nmath/nmath.h

p.s. modified files are in the attachment

have fun,
-- 
Ivo Ugrina << http://web.math.hr/~iugrina >>
Teaching/Research Assistant at Department of Mathematics
University of Zagreb, Croatia
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: distn.R
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090709/330b9a86/attachment.pl>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: nmath.h
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090709/330b9a86/attachment.h>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: wilcox.c
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090709/330b9a86/attachment.c>

From lgautier at gmail.com  Thu Jul  9 17:33:09 2009
From: lgautier at gmail.com (Laurent Gautier)
Date: Thu, 09 Jul 2009 17:33:09 +0200
Subject: [Rd] Suggestion: Dimension-sensitive attributes
In-Reply-To: <19811401A1D8174CB3EAD7F6072E9B50023F3B9D@chsa1025.share.beluni.net>
References: <19811401A1D8174CB3EAD7F6072E9B50023F3B9D@chsa1025.share.beluni.net>
Message-ID: <4A560DB5.3040101@gmail.com>

Bengoechea Bartolom? Enrique (SIES 73) wrote:
> Forgot to answer this one:
> 
>> It would seem natural that metadata associated with one dimension: 
>> would a table-like object

[thanks for reading through what seems much like a telescoped sentences]

> Right. A data frame has the problem that for most use cases one would
> want that each dimension length matches the *rows* of the data frame
> instead of the columns, but it is the columns what we would have "for
> free" when allowing "dimmeta" elements to be lists...

Think of one data.frame per dimension and each data.frame having its 
rows aligned along that dimension.

In the case of a matrix, the dim-1 data.frame would have as many rows as 
rows in the matrix and the dim-2 data.frame would have as many rows as 
columns in the matrix.

When thinking in terms of generalization, one can also note that the 
one-dimension case can already be modelled by a data.frame.


L.

> Enrique
> 
> -----Original Message----- From: Laurent Gautier
> [mailto:lgautier at gmail.com] Sent: jueves, 09 de julio de 2009 14:15 
> Cc: Heinz Tuechler; Bengoechea Bartolom? Enrique (SIES 73); Tony
> Plate; Henrik Bengtsson; r-devel at r-project.org Subject: Re: [Rd]
> Suggestion: Dimension-sensitive attributes
> 
> Starting by working on an interface for such object(s) is probably
> the first step toward a unified solution, and this before about if
> and how R attributes are used.
> 
> It would also help to ensure a smooth transition from the existing
> classes implementing a similar solution (first the interface is added
> to those classes, then after a grace period the classes are
> eventually refactored).
> 
> Dimension-level is what seems to the be most needed... but I am not
> convinced of the practicality of the object-level, and cell-level
> scheme s proposed:
> 
> - Object-level, if not linked to any dimension-attribute is such
> saying that one want to attach anything to any object. That's what
> attr() is already doing.
> 
> - Cell-level, is may be out-of-scope for one first trial (but may be
> I missed the use-cases for it)
> 
> 
> 
> If starting with behaviour, it seems to boil to having "["/"[<-" and
>  "dimmeta()"/"dimmeta<-()", :
> 
> - extract "[" / replace "[<-" :
> 
> * keeps working the way it already does
> 
> * extracts a subset of the object as well as a subset of the 
> dimension-associated metadata.
> 
> * departing too much from the way "[" is working and add 
> behind-the-curtain name matching will only compromise the chances of
>  adoption.
> 
> * forget about the bit about which metadata is kept and which one 
> isn't when using "[". Make a function "unmeta()" (similar behavior to
>  "unname()") to drop them all, or work it out with something like
>> dimmeta(x, 1) <- NULL # drop the metadata associated with dimension
>> 1
> 
> - access the dimension-associated metadata:
> 
> * may be a function called "dimmeta()" (for consistency with 
> "dimnames()") ? The signature could be dimmeta(x, i), with x the
> object, and i the dimension requested. A replace function
> "dimmeta<-"(x, i, value) would be provided.
> 
> 
> In the abstract the "names" associated with a given dimension is just
>  one of possible metadata, but I'd keep away from meddling with it
> for a start.
> 
> 
> It would seem natural that metadata associated with one dimension: 
> would a table-like object (data.frame seems natural in R, and 
> unfortunately there is no data.frame-like structure in R).
> 
> 
> 
> L.
> 
>


From spencer.graves at prodsyse.com  Thu Jul  9 17:33:57 2009
From: spencer.graves at prodsyse.com (spencerg)
Date: Thu, 09 Jul 2009 08:33:57 -0700
Subject: [Rd] Number of functions, data sets, ..., in a package?
In-Reply-To: <971536df0907090745p2d79e2adsdd668922dd5f393c@mail.gmail.com>
References: <4A55FFBC.4010805@prodsyse.com>
	<971536df0907090745p2d79e2adsdd668922dd5f393c@mail.gmail.com>
Message-ID: <4A560DE5.2050001@prodsyse.com>

Dear Gabor: 


      Thanks very much.  I will study "codoc" with great interest.  (The 
code already uses "packageDescription".) 


      Thanks again,
      Spencer

Gabor Grothendieck wrote:
> On Thu, Jul 9, 2009 at 10:33 AM, spencerg<spencer.graves at prodsyse.com> wrote:
>   
>> Hello:
>>
>>     How can one get the number of functions and data sets in a package?
>>
>>     I've written a function "PackageSum2" to get an extended package summary
>> for an installed package.  I get much of what I want from the object
>> returned by "help(package=pkgName)".  For example, "help(pac=...)$info[[1]]"
>> is a character vector giving author, maintainer, date built, etc.
>>  "help(pac=...)$info[[2]]" is a character vector with at least one row for
>> each help page;  I can get the number of help pages by subtracting the
>> number starting with blank (" ") from the length.  And
>> "help(pac=...)$info[[3]]" is a character matrix describing the vignettes.
>>     
>
> Also look at ?packageDescription
>
>   
>>     Is there a reasonably easy way to get numbers of (a) functions and (b)
>> data sets in the package?
>>
>>     I want this for a the next version of "PackageSum2" in the "RSiteSearch"
>> package.  Based partly on previous input from this list, the package is
>> being renamed to "sos" with the primary "RSiteSearch.function" function
>> being renamed to "findFn".  You can install the current development version
>> via 'install.packages("sos", repos="http://R-Forge.R-project.org")'.
>>
>>     
>
> Check out the source of codoc in the tools package.
>
>   
>>     Thanks,
>>     Spencer
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>     
>
>


From adrian_d at eskimo.com  Thu Jul  9 19:05:43 2009
From: adrian_d at eskimo.com (Adrian Dragulescu)
Date: Thu, 9 Jul 2009 10:05:43 -0700 (PDT)
Subject: [Rd] merge performace degradation in 2.9.1
Message-ID: <Pine.LNX.4.64.0907090953580.1125@shell.eskimo.com>


I have noticed a significant performance degradation using merge in 2.9.1 
relative to 2.8.1.  Here is what I observed:

   N <- 100000
   X <- data.frame(group=rep(12:1, each=N), mon=rep(rev(month.abb), each=N))
   X$mon <- as.character(X$mon)
   Y <- data.frame(mon=month.abb, letter=letters[1:12])
   Y$mon <- as.character(Y$mon)

   Z <- cbind(Y, group=1:12)

   system.time(Out <- merge(X, Y, by="mon", all=TRUE))
   # R 2.8.1 is 17% faster than R 2.9.1 for N=100000

   system.time(Out <- merge(X, Z, by=c("mon", "group"), all=TRUE))
   # R 2.8.1 is 16% faster than R 2.9.1 for N=100000

Here is the head of summaryRprof() for 2.8.1
$by.self
                    self.time self.pct total.time total.pct
sort.list               4.60     56.5       4.60      56.5
make.unique             1.68     20.6       2.18      26.8
as.character            0.50      6.1       0.50       6.1
duplicated.default      0.50      6.1       0.50       6.1
merge.data.frame        0.20      2.5       8.02      98.5
[.data.frame            0.16      2.0       7.10      87.2

and for 2.9.1
$by.self
                    self.time self.pct total.time total.pct
sort.list               4.66     39.2       4.66      39.2
nchar                   3.28     27.6       3.28      27.6
make.unique             1.42     12.0       1.92      16.2
as.character            0.50      4.2       0.50       4.2
data.frame              0.46      3.9       4.12      34.7
[.data.frame            0.44      3.7       7.28      61.3

As you notice the 2.9.1 has an nchar entry that is quite time consuming.

Is there a way to avoid the degradation in performance in 2.9.1?

Thank you,
Adrian

As an aside, I got interested in testing merge in 2.9.1 by reading the 
r-devel message from 30-May-2009 "Degraded performance with rank()" by Tim 
Bergsma, as he mentions doing merges, but only today decided to test.


From Mike.Lawrence at dal.ca  Thu Jul  9 19:20:14 2009
From: Mike.Lawrence at dal.ca (Mike.Lawrence at dal.ca)
Date: Thu,  9 Jul 2009 19:20:14 +0200 (CEST)
Subject: [Rd] save() file size (PR#13816)
Message-ID: <20090709172014.5D4B0283031C@mail.pubhealth.ku.dk>

Full_Name: Mike Lawrence
Version: 2.9.0
OS: OS 10.5.7
Submission from: (NULL) (208.98.203.100)


When using save() I notice that sometimes saving smaller objects yield larger
file sizes.

x=data.frame(
	expand.grid(
		id=factor(1:1000)
		,trial=1:24
		,cue=factor(1:3)
		,flank=factor(1:4)
	)
)
save(x,file='temp1.Rdata') #about 20KB
y=x[x$id!='1',]
save(y,file='temp2.Rdata') #>500KB


From klaus.nordhausen at uta.fi  Thu Jul  9 20:26:02 2009
From: klaus.nordhausen at uta.fi (Klaus Nordhausen)
Date: Thu, 09 Jul 2009 21:26:02 +0300
Subject: [Rd] Programming using formulas
Message-ID: <4A56363A.6010402@uta.fi>

Dear R experts,

I'm planning to write some kind of multivariate regression function 
where I would like to use a formula method.

My question is if there is anywhere some detailed introduction how to 
program formulas in R?

A bit more about what I need:

I would like to start implementing a multivariate hierarchical 
regression model and to keep it simple in the beginning I would restrict 
to only one hierarchical level and one categorical explanatory variable 
or just the intercept (one sample case).

For example I collect three numeric scores y1 , y2 and y3 from students 
and would like to get the gender effect x while taking into account that 
the students belong to different classes z.

I have then a formula in mind like
y1 + y2 + y3 ~ x | z
or
Y ~ x | z

For my internal functions I would need to be able to get from the 
formula three matrices:
- Y the matrix of responses (should be checked to be numeric)
- X a model matrix (where factors should be dummy coded)
- Z matrix indicating to which cluster the subject belongs

And I would like to program that in such a flexible way that it would be 
later possible to increase the level of hierarchies, for instance that I 
consider also different schools within which I have different classes 
and that x could become numeric and also several variables and so on.

What would be then the best way to handle that the response should be 
multivariate and numeric? What is the best way to define the 
hierarchical structure, is it the "|" and how can I restrict the number 
of hierarchical levels?
And how to use in this context, the data, subset, weights and na.action 
arguments?

In case you are wondering what I plan to implement, one references for 
example is:

Haataja, R., Larocque, D., Nevalainen, J. and Oja, H. (2009). A weighted 
multivariate signed-rank test for cluster-correlated data. Journal of 
Multivariate Analysis, 100, 6, 1107-1119.

Thanks you very much for your help in advance!

Best wishes,

Klaus

-- 
Klaus Nordhausen
Researcher
Tampere School of Public Health
FIN-33014 University of Tampere

phone:	+358 3 3551 4153
fax:	+358 3 3551 4150
e-mail:	Klaus.Nordhausen at uta.fi


From ripley at stats.ox.ac.uk  Thu Jul  9 21:41:13 2009
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 9 Jul 2009 20:41:13 +0100 (BST)
Subject: [Rd] save() file size (PR#13816)
In-Reply-To: <20090709172014.5D4B0283031C@mail.pubhealth.ku.dk>
References: <20090709172014.5D4B0283031C@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0907092036450.3829@gannet.stats.ox.ac.uk>

The evidence contradicts this claim:

> object.size(x)
4666464 bytes
> object.size(y)
5812696 bytes

so 'y' is indeed larger than 'x' (and compresses less well).
Reason: 'x' has automatic row names and 'y' does not.

On Thu, 9 Jul 2009, Mike.Lawrence at dal.ca wrote:

> Full_Name: Mike Lawrence
> Version: 2.9.0
> OS: OS 10.5.7
> Submission from: (NULL) (208.98.203.100)
>
>
> When using save() I notice that sometimes saving smaller objects yield larger
> file sizes.
>
> x=data.frame(
> 	expand.grid(
> 		id=factor(1:1000)
> 		,trial=1:24
> 		,cue=factor(1:3)
> 		,flank=factor(1:4)
> 	)
> )
> save(x,file='temp1.Rdata') #about 20KB
> y=x[x$id!='1',]
> save(y,file='temp2.Rdata') #>500KB
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From r.d.morey at rug.nl  Thu Jul  9 23:57:24 2009
From: r.d.morey at rug.nl (Richard Morey)
Date: Thu, 09 Jul 2009 23:57:24 +0200
Subject: [Rd] Changing text in a tkentry widget
In-Reply-To: <mailman.11.1247133608.27074.r-devel@r-project.org>
References: <mailman.11.1247133608.27074.r-devel@r-project.org>
Message-ID: <4A5667C4.5030002@rug.nl>

I searched the web and the list archives for a solution to this, but 
didn't see anything, so here goes. I'm new to tcltk. I'm trying to 
change the contents of a tkentry widget when a button is pressed. Once I 
get that working, the widget will be read only to the user. Here is some 
toy code:

###############
require(tcltk)
thisEnv=environment()
tt<-tktoplevel()
Name <- tclVar("Anonymous")
entry.Name <-tkentry(tt,width="20",textvariable=Name)
tkgrid(entry.Name)
OnChange <- function()
{
    assign("Name",tclVar("changed name"),thisEnv)
}
Change.but <-tkbutton(tt,text="   Change   ",command=OnChange)
tkgrid(Change.but)
tkfocus(tt)
##################
(much of this is taken from 
http://bioinf.wehi.edu.au/~wettenhall/RTclTkExamples/editboxes.html)

Now, I thought the whole point of the textvariable argument was to 
change the content of the tkentry widget. But, as you can see by running 
this code, changing the Name variable using assign does not change the 
content of the widget.

Is there a function to update the content? tkinsert didn't seem to work 
when I tried it.

Thanks,
Richard Morey


From ggrothendieck at gmail.com  Fri Jul 10 02:03:53 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Thu, 9 Jul 2009 20:03:53 -0400
Subject: [Rd] Changing text in a tkentry widget
In-Reply-To: <4A5667C4.5030002@rug.nl>
References: <mailman.11.1247133608.27074.r-devel@r-project.org> 
	<4A5667C4.5030002@rug.nl>
Message-ID: <971536df0907091703j1401e7ddg4aa896ca17f6ecdb@mail.gmail.com>

I assume that what is wanted is that "Anonymous" should
change to "changed name" when the "Change" button is pressed.

In that case enter this and then press the Change button
at which point "Anonymous" should change to "changed name".

library(tcltk)
tt <- tktoplevel()
Name <- tclVar("Anonymous")
entry.Name <-tkentry(tt, width = "20", textvariable = Name)
tkgrid(entry.Name)
OnChange <- function() {
	tclvalue(Name) <- "changed name"
}
Change.but <-tkbutton(tt,text="   Change   ",command = OnChange)
tkgrid(Change.but)
tkfocus(tt)



On Thu, Jul 9, 2009 at 5:57 PM, Richard Morey<r.d.morey at rug.nl> wrote:
> I searched the web and the list archives for a solution to this, but didn't
> see anything, so here goes. I'm new to tcltk. I'm trying to change the
> contents of a tkentry widget when a button is pressed. Once I get that
> working, the widget will be read only to the user. Here is some toy code:
>
> ###############
> require(tcltk)
> thisEnv=environment()
> tt<-tktoplevel()
> Name <- tclVar("Anonymous")
> entry.Name <-tkentry(tt,width="20",textvariable=Name)
> tkgrid(entry.Name)
> OnChange <- function()
> {
> ? assign("Name",tclVar("changed name"),thisEnv)
> }
> Change.but <-tkbutton(tt,text=" ? Change ? ",command=OnChange)
> tkgrid(Change.but)
> tkfocus(tt)
> ##################
> (much of this is taken from
> http://bioinf.wehi.edu.au/~wettenhall/RTclTkExamples/editboxes.html)
>
> Now, I thought the whole point of the textvariable argument was to change
> the content of the tkentry widget. But, as you can see by running this code,
> changing the Name variable using assign does not change the content of the
> widget.
>
> Is there a function to update the content? tkinsert didn't seem to work when
> I tried it.
>
> Thanks,
> Richard Morey
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From lgautier at gmail.com  Fri Jul 10 08:41:34 2009
From: lgautier at gmail.com (Laurent Gautier)
Date: Fri, 10 Jul 2009 08:41:34 +0200
Subject: [Rd] Suggestion: Dimension-sensitive attributes
In-Reply-To: <19811401A1D8174CB3EAD7F6072E9B50023F3B7B@chsa1025.share.beluni.net>
References: <19811401A1D8174CB3EAD7F6072E9B50023F3B7B@chsa1025.share.beluni.net>
Message-ID: <4A56E29E.7000609@gmail.com>

Bengoechea Bartolom? Enrique (SIES 73) wrote:
> Very good points. They closely match the current prototype I have
> written...
> 
>> Starting by working on an interface for such object(s) is probably
>> the first step toward a unified solution
> 
> Agree. Getting a good API is always the most important step.
> 
>> Dimension-level is what seems to the be most needed...
> 
> True, and that was Henrik's original suggestion.



> But I find all three
> are closely related to the same topic (metadata) and as such deserve
> to be worked out together, but if most people agree otherwise, the
> direction is clear.
> 
>> - Object-level, if not linked to any dimension-attribute is such
>> saying that one want to attach anything to any object. That's what
>> attr() is already doing.
> 
> Except that plain attributes are dropped when subsetting. I've found
> myself dozens of times creating classes must to create a `[` method
> for them that preserves some attributes. This looks like such a
> common situation that having a mechanism to avoid the user
> programming the same stuff again and again would be handy.

I see. I never faced the issue, but I agree that this can be somehow 
counter-intuitive.
Thinking about it, it seems natural nowadays to consider 
attributes-associated objects as a kind of prototype-based programming 
(and "[" to keep the attributes - although it does somehow consider 
special attributes such as "dim", "names", "dimnames").


>> - Cell-level, is may be out-of-scope for one first trial (but may
>> be I missed the use-cases for it)
> 
> Although I agree that cell-level is far less common, here are a
> couple of use cases I've hit recently:
> 
> 1) the array represents time series in columns. The original data
> comes in a different frequency for each column, with some data
> missing. When you align to a common frequency and interpolate missing
> values, I needed a factor array of the same dimension as the data
> array identifying whether each observation corresponded to the actual
> original series, or had been interpolated, and whether interpolation
> was due to missing data or to frequency alignment. Of course, I
> needed the factor array to be subsetted together with the array.

In that respect, and as you outline it, this is then like 
"stacking"/"putting side-by-side" arrays of identical dimensions. Your 
time serie data is in one array, the origin of the observation in an 
other...

I would see that as a separate data structure (that could implement the 
metadata interface we are discussing).

> 2) the array is a table representing data to be formatted by a
> reporting system (Sweave, R2HTML, etc), similar to the 'xtable'
> class. So I needed to associate formatting information to each
> individual "cell" (font, color, borders...), as well to each
> dimension and to the whole table.
> 
> Anyway, it's far easier to add "cell-level" metadata on top of the
> other features with a new class: for `[` subscripting just call
> NextMethod() and then apply the same indexes to the object storing
> the cell-level metadata. But I still think it's useful to work out
> data object's metadata at all possible levels with a unified
> interface.
> 

I understand the use cases, but I can't stop stop thinking that this 
should be separated from the dimension-associated metadata.

In the examples above, the data structures are two-dimensional and 
therefore dimension-associated metadata will be for "rows" and for 
"columns"; all the cells in a table/array as a sequence are not mapped 
to any *dimension*.



> About the subscripting `[` methods, I don't see the need to modify
> `[<-` for arrays, as out-of-bound indexes generate errors with arrays
> (unlike vectors or data frames), so `[<-` would only replace data and
> leave metadata untouched. Am I missing something?

That's what I am thinking.
I bundle "[" with "[<-" to specify that the way indexing is done would 
remain the same (for a second I considered that someone though of 
somehow indexing on the names of the dimensions, or on the metadata).

>> may be a function called "dimmeta()" (for consistency with
>> "dimnames()") ?
> 
> I'm using 'dimdata' in my current prototype, and Henrik suggested
> 'dimattr', but I really like your proposal more.

  the colour of the bikeshed

> Wrappers to the two first elements of 'dimmeta' for 2-dim arrays
> could be added in the same vein as 'rownames' and 'colnames':
> 'rowmeta' and 'colmeta'.

Yes. That the spirit.

>> The signature could be dimmeta(x, i), with x the object,
> 
> For consistency with 'dimnames', the 'i' argument could be dropped
> and use dimmeta(x)[[i]] instead...
> 

I thought about that, but also thought that it could have implications 
on the actual storage of those metadata. In the case the metadata are 
stored in a list, that interface enforces the building of a list.
(I said to ignore implementation for now, but paradoxically this made me 
consider possible implementations).

Let's ignore that and go for consistency first (there will always be 
time to come back on that and make backward compatible changes, such as 
dimmeta(x, i=NULL) # return the list if i is NULL ).


> Other standard generics to be affected would be:
> 
> * rbind & cbind for 2-dim arrays/matrices: they should combine the
> metadata, and for dimension-sensitive metadata can be modelled upon
> what is done with dimnames: use rowmeta (colmeta) of the first object
> with them in cbind (rbind), and combine colmeta (rowmeta) of all
> objects with them, filling with NAs/NULLs/.. for non
> metadata-sensitive objects being combined. An issue of coercing
> dimmeta of different classes may arise.

May be good to be trigger-happy for a first pass ( stop("mismatching 
meta data - sorry") )... and mix-and-match use cases might be fewer.

> * `dim<-`, but this may raise the same problem of coercing dimmeta of
> different classes.
> 

Disabling "dim<-" is, I think, choosing sanity for now.


> ...and I agree with the rest of your comments.


Same for me (about your comments).
This thread seems to be leading to something great.


L.


> Best,
> 
> Enrique
> 
> -----Original Message----- From: Laurent Gautier
> [mailto:lgautier at gmail.com] Sent: jueves, 09 de julio de 2009 14:15 
> Cc: Heinz Tuechler; Bengoechea Bartolom? Enrique (SIES 73); Tony
> Plate; Henrik Bengtsson; r-devel at r-project.org Subject: Re: [Rd]
> Suggestion: Dimension-sensitive attributes
> 
> Starting by working on an interface for such object(s) is probably
> the first step toward a unified solution, and this before about if
> and how R attributes are used.
> 
> It would also help to ensure a smooth transition from the existing
> classes implementing a similar solution (first the interface is added
> to those classes, then after a grace period the classes are
> eventually refactored).
> 
> Dimension-level is what seems to the be most needed... but I am not
> convinced of the practicality of the object-level, and cell-level
> scheme s proposed:
> 
> - Object-level, if not linked to any dimension-attribute is such
> saying that one want to attach anything to any object. That's what
> attr() is already doing.
> 
> - Cell-level, is may be out-of-scope for one first trial (but may be
> I missed the use-cases for it)
> 
> 
> 
> If starting with behaviour, it seems to boil to having "["/"[<-" and
>  "dimmeta()"/"dimmeta<-()", :
> 
> - extract "[" / replace "[<-" :
> 
> * keeps working the way it already does
> 
> * extracts a subset of the object as well as a subset of the 
> dimension-associated metadata.
> 
> * departing too much from the way "[" is working and add 
> behind-the-curtain name matching will only compromise the chances of
>  adoption.
> 
> * forget about the bit about which metadata is kept and which one 
> isn't when using "[". Make a function "unmeta()" (similar behavior to
>  "unname()") to drop them all, or work it out with something like
>> dimmeta(x, 1) <- NULL # drop the metadata associated with dimension
>> 1
> 
> - access the dimension-associated metadata:
> 
> * may be a function called "dimmeta()" (for consistency with 
> "dimnames()") ? The signature could be dimmeta(x, i), with x the
> object, and i the dimension requested. A replace function
> "dimmeta<-"(x, i, value) would be provided.
> 
> 
> In the abstract the "names" associated with a given dimension is just
>  one of possible metadata, but I'd keep away from meddling with it
> for a start.
> 
> 
> It would seem natural that metadata associated with one dimension: 
> would a table-like object (data.frame seems natural in R, and 
> unfortunately there is no data.frame-like structure in R).
> 
> 
> 
> L.
> 
>


From enrique.bengoechea at credit-suisse.com  Fri Jul 10 10:58:25 2009
From: enrique.bengoechea at credit-suisse.com (=?iso-8859-1?Q?Bengoechea_Bartolom=E9_Enrique_=28SIES_73=29?=)
Date: Fri, 10 Jul 2009 10:58:25 +0200
Subject: [Rd] Suggestion: Dimension-sensitive attributes
In-Reply-To: <4A56E29E.7000609@gmail.com>
Message-ID: <19811401A1D8174CB3EAD7F6072E9B50023F3C4D@chsa1025.share.beluni.net>

> In the case the metadata are stored in a list, that interface enforces the building of a list.
> (I said to ignore implementation for now, but paradoxically this made me consider possible implementations).

Creating the list on the fly if it's not stored internally as a list should be cheap. For example, this is done with data frames, that store "dimnames" in two separate attributes, "names" and "row.names".


From rm.short at comcast.net  Fri Jul 10 19:20:15 2009
From: rm.short at comcast.net (rm.short at comcast.net)
Date: Fri, 10 Jul 2009 19:20:15 +0200 (CEST)
Subject: [Rd] Too many files open (PR#13818)
Message-ID: <20090710172015.D9009282EEFA@mail.pubhealth.ku.dk>

Full_Name: Richard Short
Version: 2.9.1
OS: Windows XP
Submission from: (NULL) (98.225.76.171)


I'm having a problem in R that may be an operating system problem. I'm getting
an error message that reads, "Too many files open". I'm opening files and
closing them (and unlinking them), but when I go through that process 509 times,
the program bombs and I get this error message. I've been working on this
problem for a week and have gleaned a bit of info from different threads, but no
solutions yet. There is some talk that some windows systems have a limit of 512
files that can be open at one time. Even though I'm closing my files each time,
something is keeping track of how many time I've opened and closed a file in a
session and halts execution after 512 occurances.

I've attached a script that will induce the problem. However, be warned that you
will have to get out of R after you run it. R will hang up. It won't be obvious
at first, but you will no longer be able to open files (or help). This can be
solved by getting out of the R GUI and back in. Also, I'm using my pathname,
"MyPathnameA", so you'll probably want to edit it with your own.
 
R E-mails from as far back as 2006 ask for help on the issue. There have been
several suggestions, but no confirmed solution that I can find. You will see my
attempt at these suggestions in the script [ rm(outMIA);rm(junk); and gc();
after close(outMIA); and unlink(FileNameMIA);]. 


#-------------------- Start of Script
----------------------------------------------
# This script induces an error: "cannot open the connection" with
# warnings: "Too many open files". 


       # ---------------- Create a junk file and "save" it for use further into
the program ---
       junk <- 1
       MyPathnameA <- "C:\\Documents and Settings\\All
Users\\Documents\\SIREPO\\DBFS-0150"
       connectionX <- paste(MyPathnameA,"junk",sep="\\")
       outJunk     <- file(connectionX, open="wb")
       save(junk, file=outJunk)
       close(outJunk)
      

       # The next two lines are a repeat from above. They will be useful if you
want to run
       # this script again after "junk" has been loaded.
       MyPathnameA <- "C:\\Documents and Settings\\All
Users\\Documents\\SIREPO\\DBFS-0150"
       connectionX <- paste(MyPathnameA,"junk",sep="\\")
       FileNameMIA <- connectionX 
       for(i in 1:4000){
            # ----------------- Load "junk" ---------------------------------
            outMIA <- file(FileNameMIA, open="rb")
            load(file=outMIA)
            # ----------------- close "junk"; unlink; remove; ----------------
            close(outMIA)
            unlink(FileNameMIA)
            rm(outMIA)
            rm(junk)
            cat(" i = ",i,sep=" ")
            gc()
            zzz <- showConnections(all=FALSE)
            cat(" zzz = ",zzz,"\n",sep=" ")
       } 
#------------------------------------ End of Script
--------------------------------

Any suggestion would be greatly appreciated.
 
Thanks,
Rich


From peter.muhlberger at gmail.com  Sat Jul 11 22:05:11 2009
From: peter.muhlberger at gmail.com (peter.muhlberger at gmail.com)
Date: Sat, 11 Jul 2009 22:05:11 +0200 (CEST)
Subject: [Rd] foreign generates bad Stata data files (PR#13820)
Message-ID: <20090711200511.81795282EF4C@mail.pubhealth.ku.dk>

Full_Name: peter muhlberger
Version: 2.7.1
OS: Ubuntu x86_64 dual core
Submission from: (NULL) (70.238.206.13)


I've spent half a day generating .dta files using write.dta only to have them
crash my copy of Stata.  I eventually discovered that removing a string variable
with a maximum observed length of 280 characters allows Stata to read the file
without problems.  A Stata limit is that the length of a string variable cannot
exceed 244.  R gives no warning about this problem.  I assume it does not
abbreviate either.  The following code creates a .dta file that causes my copy
of Stata to suddenly disappear when I try to open the file:

x=c("XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX")
x=as.data.frame(x, stringsAsFactors=F)
names(x)[1]="x"
write.dta(x,  version = 10, file="/home/peterm/Desktop/x.dta")

That's the main problem I wanted to report.  There are several others you might
want to look into.  Above, leave out names(x)[1]="x" and take a look at what the
name of the variable is in the dataframe--it's a line of code.  Also, write.dta
is supposed to turn factors into variable labels in Stata, but I get no variable
labels in Stata (starting w/ data that has factors).  Finally, when I try to
read an spss dataset created by Sawtooth into R using read.spss, I get a
multitude of variables that aren't in the original dataset and have nothing in
them.


Below, my sessionInfo:

> sessionInfo()
R version 2.7.1 (2008-06-23) 
x86_64-pc-linux-gnu 

locale:
LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=en_US.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=en_US.UTF-8;LC_ADDRESS=en_US.UTF-8;LC_TELEPHONE=en_US.UTF-8;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] foreign_0.8-36 JGR_1.6-7      iplots_1.1-3   JavaGD_0.5-2   rJava_0.6-3   
boot_1.2-37

Hope this helps!

Cheers,
Peter


From m.crawley at imperial.ac.uk  Sun Jul 12 10:30:09 2009
From: m.crawley at imperial.ac.uk (m.crawley at imperial.ac.uk)
Date: Sun, 12 Jul 2009 10:30:09 +0200 (CEST)
Subject: [Rd] box and whisker (PR#13821)
Message-ID: <20090712083009.34D6A282EF4F@mail.pubhealth.ku.dk>

In a Box and Whisker plot, I thought that when there are outliers both abov=
e and below the whiskers, then the whiskers should both be the same length =
(plus or minus 1.5 times the inter-quartile range).

If you look at the plot for SilwoodWeather on p.155 of The R Book you will =
see that for November (month =3D 11) the upper whisker is shorter than the =
lower, while for other months with outliers both above and below, the lines=
 are the same lengths.

When there are no outliers, then of course the maximum and minimum values r=
esult in whiskers of different lengths above and below.

Here is the code that creates the problem:

data<-read.table("c:\\temp\\SilwoodWeather.txt",header=3DT)
attach(data)
names(data)

[1] "upper" "lower" "rain"  "month" "yr"

month<-factor(month)
plot(month,upper)

and exactly the same with

boxplot(upper~month)



Best wishes,

Mick

Prof  M.J. Crawley  FRS

Imperial College London
Silwood Park
Ascot
Berks
SL5 7PY
UK

Phone (0) 207 5942 216
Fax     (0) 207 5942 339


	[[alternative HTML version deleted]]


From p.dalgaard at biostat.ku.dk  Sun Jul 12 11:11:37 2009
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sun, 12 Jul 2009 11:11:37 +0200
Subject: [Rd] box and whisker (PR#13821)
In-Reply-To: <20090712083009.34D6A282EF4F@mail.pubhealth.ku.dk>
References: <20090712083009.34D6A282EF4F@mail.pubhealth.ku.dk>
Message-ID: <4A59A8C9.7080405@biostat.ku.dk>

m.crawley at imperial.ac.uk wrote:
> In a Box and Whisker plot, I thought that when there are outliers both abov=
> e and below the whiskers, then the whiskers should both be the same length =
> (plus or minus 1.5 times the inter-quartile range).

Not according to the docs:

    range: this determines how far the plot whiskers extend out from the
           box.  If 'range' is positive, the whiskers extend to the most
           extreme data point which is no more than 'range' times the
           interquartile range from the box. A value of zero causes the
           whiskers to extend to the data extremes.

And the code itself has

             stats[c(1, 5)] <- range(x[!out], na.rm = TRUE)

So the whisker won't be equal to 1.5 IQR unless there happens to be an 
observation there.

Now, this might be wrong, but people have tried very hard to make the 
implementation follow the original definition due to Tukey. I.e., if you 
can point out that Tukey specified it otherwise, then we'd change it, 
otherwise it is just not a bug.

> If you look at the plot for SilwoodWeather on p.155 of The R Book you will =
> see that for November (month =3D 11) the upper whisker is shorter than the =
> lower, while for other months with outliers both above and below, the lines=
>  are the same lengths.

For easier reproduction (reproducible examples should not refer to files 
on your C: drive...):

 > diff(boxplot({set.seed(9);x<-rnorm(50)})$stats)
           [,1]
[1,] 1.2525857
[2,] 0.5412128
[3,] 0.6083348
[4,] 1.4625057



-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From bolker at ufl.edu  Mon Jul 13 01:42:30 2009
From: bolker at ufl.edu (Ben Bolker)
Date: Sun, 12 Jul 2009 16:42:30 -0700 (PDT)
Subject: [Rd] box and whisker (PR#13821)
In-Reply-To: <4A59A8C9.7080405@biostat.ku.dk>
References: <20090712083009.34D6A282EF4F@mail.pubhealth.ku.dk>
	<4A59A8C9.7080405@biostat.ku.dk>
Message-ID: <24453549.post@talk.nabble.com>




Peter Dalgaard wrote:
> 
> 
> For easier reproduction (reproducible examples should not refer to files 
> on your C: drive...):
> 
> 

For what it's worth, the data are available at
http://www.bio.ic.ac.uk/research/mjcraw/therbook/data/SilwoodWeather.txt

Not that that's really necessary since as you've shown the point is pretty
general.

  Ben Bolker

-- 
View this message in context: http://www.nabble.com/box-and-whisker-%28PR-13821%29-tp24446795p24453549.html
Sent from the R devel mailing list archive at Nabble.com.


From hpages at fhcrc.org  Tue Jul 14 00:43:20 2009
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Mon, 13 Jul 2009 15:43:20 -0700
Subject: [Rd] bug in seq_along
In-Reply-To: <7E0D03FE-2742-4442-977F-538AE7DE920A@stat.berkeley.edu>
References: <7E0D03FE-2742-4442-977F-538AE7DE920A@stat.berkeley.edu>
Message-ID: <4A5BB888.8020708@fhcrc.org>

Hi Kasper and R developers,

Kasper Daniel Hansen wrote:
> Using the IRanges package from Bioconductor and somewhat recent R-2.9.1.
> 
> ov = IRanges(1:3, 4:6)
> length(ov) # 3
> seq(along = ov) # 1 2 3 as wanted
> seq_along(ov) # 1!
> 
> I had expected that the last line would yield 1:3. My guess is that 
> somehow seq_along don't utilize that ov is an S4 class with a length 
> method.

I agree, this is not good. seq_along() has always been broken on S4
objects:

   https://stat.ethz.ch/pipermail/r-devel/2007-July/046337.html

so I prefer to not use it, ever. Even when I deal with S3 objects.
Because the day I need to extend my code to deal with S4 objects,
it's too easy to forget to replace 'seq_along(x)' with 'seq_len(length(x))'.
So I'd rather use the latter all the time and from the very beginning
(hopefully there is no serious performance penalty for doing this).

Surprisingly, seq_along() diserves its own C implementation (why
wouldn't seq_along <- function(x) seq_len(length(x)) be just good
enough?). It's calling length() at the C level which is an inline
function defined as:

INLINE_FUN R_len_t length(SEXP s)
{
     int i;
     switch (TYPEOF(s)) {
     case NILSXP:
         return 0;
     case LGLSXP:
     case INTSXP:
     case REALSXP:
     case CPLXSXP:
     case STRSXP:
     case CHARSXP:
     case VECSXP:
     case EXPRSXP:
     case RAWSXP:
         return LENGTH(s);
     case LISTSXP:
     case LANGSXP:
     case DOTSXP:
         i = 0;
         while (s != NULL && s != R_NilValue) {
             i++;
             s = CDR(s);
         }
         return i;
     case ENVSXP:
         return Rf_envlength(s);
     default:
         return 1;
     }
}

Hence it will return 1 when 's' is an S4SXP.

If for whatever reason, seq_along() is not able to figure out what
the *real* length of an S4 object is, then wouldn't it be better to
make it return an error? Or at least to put a big warning in its
man page saying: DON'T TRUST ME ON YOUR S4 OBJECTS, I'M BROKEN!

Cheers,
H.


> 
> The last line of the *Details* section of ?seq has a typeo. Currently it is
>      'seq.int', 'seq_along' and 'seq.int' are primitive: the latter two
>      ignore any argument name.
> I would guess it ought to be
>      'seq.int', 'seq_along' and 'seq_len' are primitive: the latter two
>      ignore any argument name.
> 
> Kasper
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From mdowle at mdowle.plus.com  Tue Jul 14 03:59:50 2009
From: mdowle at mdowle.plus.com (Matthew Dowle)
Date: Tue, 14 Jul 2009 02:59:50 +0100
Subject: [Rd] merge performace degradation in 2.9.1
References: <Pine.LNX.4.64.0907090953580.1125@shell.eskimo.com>
Message-ID: <h3gou1$43e$1@ger.gmane.org>

> Is there a way to avoid the degradation in performance in 2.9.1?
If the example is to demonstrate a difference between R versions that you 
really need to get to the bottom of then read no further.  However, if the 
example is actually what you want to do then you can speed it up by using a 
data.table as follows to reduce the 26 secs to 1 sec.

Time on my PC at home (quite old now!) :
> system.time(Out <- merge(X, Y, by="mon", all=TRUE))
   user  system elapsed
  25.63    0.58   26.98

Using a data.table instead :
X <- data.table(group=rep(12:1, each=N), mon=rep(rev(month.abb), each=N), 
key="mon")
Y <- data.table(mon=month.abb, letter=letters[1:12], key="mon")
tables()
     NAME      NROW COLS       KEY
[1,] X    1,200,000 group,mon  mon
[2,] Y           12 mon,letter mon
> system.time(X$letter <- Y[X,letter])   # Y[X] is the syntax for merge of 
> two data.tables
   user  system elapsed
   0.98    0.11    1.10
> identical(Out$letter, X$letter)
[1] TRUE
> identical(Out$mon, X$mon)
[1] TRUE
> identical(Out$group, X$group)
[1] TRUE

To do the multi-column equi-join of X and Z, set a key of 2 columns. 
'nomatch' is the equivalent of 'all' and can be set to 0 (inner join) or NA 
(outer join).


"Adrian Dragulescu" <adrian_d at eskimo.com> wrote in message 
news:Pine.LNX.4.64.0907090953580.1125 at shell.eskimo.com...
>
> I have noticed a significant performance degradation using merge in 2.9.1 
> relative to 2.8.1.  Here is what I observed:
>
>   N <- 100000
>   X <- data.frame(group=rep(12:1, each=N), mon=rep(rev(month.abb), 
> each=N))
>   X$mon <- as.character(X$mon)
>   Y <- data.frame(mon=month.abb, letter=letters[1:12])
>   Y$mon <- as.character(Y$mon)
>
>   Z <- cbind(Y, group=1:12)
>
>   system.time(Out <- merge(X, Y, by="mon", all=TRUE))
>   # R 2.8.1 is 17% faster than R 2.9.1 for N=100000
>
>   system.time(Out <- merge(X, Z, by=c("mon", "group"), all=TRUE))
>   # R 2.8.1 is 16% faster than R 2.9.1 for N=100000
>
> Here is the head of summaryRprof() for 2.8.1
> $by.self
>                    self.time self.pct total.time total.pct
> sort.list               4.60     56.5       4.60      56.5
> make.unique             1.68     20.6       2.18      26.8
> as.character            0.50      6.1       0.50       6.1
> duplicated.default      0.50      6.1       0.50       6.1
> merge.data.frame        0.20      2.5       8.02      98.5
> [.data.frame            0.16      2.0       7.10      87.2
>
> and for 2.9.1
> $by.self
>                    self.time self.pct total.time total.pct
> sort.list               4.66     39.2       4.66      39.2
> nchar                   3.28     27.6       3.28      27.6
> make.unique             1.42     12.0       1.92      16.2
> as.character            0.50      4.2       0.50       4.2
> data.frame              0.46      3.9       4.12      34.7
> [.data.frame            0.44      3.7       7.28      61.3
>
> As you notice the 2.9.1 has an nchar entry that is quite time consuming.
>
> Is there a way to avoid the degradation in performance in 2.9.1?
>
> Thank you,
> Adrian
>
> As an aside, I got interested in testing merge in 2.9.1 by reading the 
> r-devel message from 30-May-2009 "Degraded performance with rank()" by Tim 
> Bergsma, as he mentions doing merges, but only today decided to test.
>


From thothal at sbox.tugraz.at  Tue Jul 14 07:55:45 2009
From: thothal at sbox.tugraz.at (Thorn Thaler)
Date: Tue, 14 Jul 2009 07:55:45 +0200
Subject: [Rd] Extended Quasi Likelihood Library
Message-ID: <4A5C1DE1.60501@sbox.tugraz.at>

Hi everybody,

for my master thesis I'm currently working on a package providing a 
possibility to estimate the parameter(s) of a family of variance 
functions in a GLM. My approach is based on the EQL function (cf Nelder 
& Pregibon: An extended quasi-likelihood function. Biometrika 74 (1987), 
221--232).

I've uploaded version 1.0 of the package to www.thothal.com/EQL.html and 
I'd highly appreciate any comments.

The package depends on 'ttutils' which combines some auxiliary functions 
and can be found on the aforementioned page as well. Furthermore, it 
imports package 'lattice' to do some plotting.

I'm looking forward to any feedback.

Thorn


From rocket at google.com  Tue Jul 14 06:15:17 2009
From: rocket at google.com (rocket at google.com)
Date: Tue, 14 Jul 2009 06:15:17 +0200 (CEST)
Subject: [Rd] Incorrect comment about ISNA(x) in Arith.h (PR#13826)
Message-ID: <20090714041517.282B6282EF4D@mail.pubhealth.ku.dk>

R-2.9.0/include/R_ext/Arith.h has:

int R_IsNA(double);		/* True for R's NA only */
int R_IsNaN(double);		/* True for special NaN, *not* for NA */
int R_finite(double);		/* True if none of NA, NaN, +/-Inf */

#define ISNA(x)	       R_IsNA(x)
/* True for *both* NA and NaN.

The first and last lines are contradictory - if R_IsNA is true only
for NA, not NaN, then ISNA should be the same.

Venables & Ripley S Programming p 137 indicates that
"ISNA does not detect NaN s"

Here's a little .c file and R transcript that shows that V&R are correct,
   ISNA(x) is not True for NaN
So the last comment should read
/* True for NA, not NaN



#include "R.h"
void mysum(double *x)
{
  double sum = 0.0;
  sum = x[0] + x[1] + x[2];
  if (ISNA(sum))
    PROBLEM "sum is NA" WARNING(NULL_ENTRY);
  if (ISNAN(sum))
    PROBLEM "sum is NAN" WARNING(NULL_ENTRY);
  if (!(R_FINITE(sum)))
    PROBLEM "sum is not finite" WARNING(NULL_ENTRY);
  return;
}


> dyn.load("~/R/work/bug.so")
> .C("mysum", c(NaN, 0.0, 0.0), NAOK = TRUE, DUP = FALSE)
[[1]]
[1] NaN   0   0

Warning messages:
1: sum is NAN 
2: sum is not finite 



--please do not edit the information below--

Version:
 platform = x86_64-unknown-linux-gnu
 arch = x86_64
 os = linux-gnu
 system = x86_64, linux-gnu
 status = 
 major = 2
 minor = 9.0
 year = 2009
 month = 04
 day = 17
 svn rev = 48333
 language = R
 version.string = R version 2.9.0 (2009-04-17)

Locale:
LC_CTYPE=en_US;LC_NUMERIC=C;LC_TIME=C;LC_COLLATE=C;LC_MONETARY=C;LC_MESSAGES=en_US;LC_PAPER=en_US;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US;LC_IDENTIFICATION=C

Search Path:
 .GlobalEnv, package:Rfixes, package:Rcode, package:aggregate, package:splus2Rgoogle, package:stats, package:graphics, package:grDevices, package:utils, package:datasets, package:methods, Autoloads, package:base


From r.d.morey at rug.nl  Tue Jul 14 20:10:52 2009
From: r.d.morey at rug.nl (Richard D. Morey)
Date: Tue, 14 Jul 2009 20:10:52 +0200
Subject: [Rd] matrix algebra in c
In-Reply-To: <mailman.19.1247565606.18918.r-devel@r-project.org>
References: <mailman.19.1247565606.18918.r-devel@r-project.org>
Message-ID: <4A5CCA2C.8000109@rug.nl>

I'd like to use some matrix algebra in my c code that is called from R.
I need matrix multiplication, transposition, and Cholesky decomposition.
I haven't come across any easy way to do this, but from browsing the web
and R-devel a few options come to mind:

1. use F77_CALL() to call matrix multiplication functions from blas.
This should be ok as long as I remember that c and FORTRAN store
matrices differently.

2. include gsl code and link against the gsl binaries? This seems like
it would cause problems compiling it on different systems.

3. write my own code (bad idea)

4. Call R from my C code (slow?)

What's the best/easiest way? I don't really care how the matrices are
represented in c (could be gsl_matrix, SEXP, whatever) as long as it works.

Thanks,
Richard Morey


From eric.vanderwal at usask.ca  Tue Jul 14 21:10:14 2009
From: eric.vanderwal at usask.ca (eric.vanderwal at usask.ca)
Date: Tue, 14 Jul 2009 21:10:14 +0200 (CEST)
Subject: [Rd] ordering dataframe for strata() (PR#13830)
Message-ID: <20090714191015.973162830319@mail.pubhealth.ku.dk>

I've been using strata(sampling) and found that if the dataframe to be 
sampled ("data") consists of repeated measures that are not sorted in 
order the run will fail on a given stratum.  Ordering the dataframe 
prior to using strata() eliminates this problem.

Thanks,
Eric

-- 
Eric Vander Wal
Ph.D. Candidate
University of Saskatchewan, Department of Biology,
112 Science Place, Saskatoon, SK., S7N 5E2

"Pluralitas non est ponenda sine neccesitate"


From marc_schwartz at me.com  Tue Jul 14 21:30:28 2009
From: marc_schwartz at me.com (marc_schwartz at me.com)
Date: Tue, 14 Jul 2009 21:30:28 +0200 (CEST)
Subject: [Rd] ordering dataframe for strata() (PR#13830)
Message-ID: <20090714193028.6BE872830319@mail.pubhealth.ku.dk>

On Jul 14, 2009, at 2:10 PM, eric.vanderwal at usask.ca wrote:

> I've been using strata(sampling) and found that if the dataframe to be
> sampled ("data") consists of repeated measures that are not sorted in
> order the run will fail on a given stratum.  Ordering the dataframe
> prior to using strata() eliminates this problem.
>
> Thanks,
> Eric



If you are reporting a bug, then as per the R FAQ and the Posting  
Guide, you are asked to report bugs on contributed packages to the  
package maintainer, not to the R Bug Repository.

If you are simply reporting curious behavior for the benefit of  
others, then please post it to R-help and do not report it as a bug. I  
would still contact the package maintainer, who may wish to add  
clarifications to the package/function documentation.

Marc Schwartz


From timhesterberg at gmail.com  Wed Jul 15 00:51:18 2009
From: timhesterberg at gmail.com (Tim Hesterberg)
Date: Tue, 14 Jul 2009 15:51:18 -0700
Subject: [Rd] Faster as.data.frame & save copy by doing names(x) <- NULL
	only if needed
Message-ID: <e21d304c0907141551k4e07ca79xc0c060c5589d37f9@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090714/2e662856/attachment.pl>

From francois.greff at dbmail.com  Wed Jul 15 01:20:12 2009
From: francois.greff at dbmail.com (francois.greff at dbmail.com)
Date: Wed, 15 Jul 2009 01:20:12 +0200 (CEST)
Subject: [Rd] rcmdr gui not running (PR#13831)
Message-ID: <20090714232012.22BD92830319@mail.pubhealth.ku.dk>

Full_Name: greff francois
Version: 2.8.1 
OS: ubuntu 9.04
Submission from: (NULL) (89.227.27.2)


into r , the command library("Rcmdr") works well : the r commander GUI is opened
, with menu in french ( well !) . But it isn't possible to have a response to
any click on menu ??? It's neither possible to edit a command in the "script
window" . To resume, nothing at all is possible , neither with the mouse , nor
with the keyboard .

What mistake did I . I reinstalled everything .... same response .

here my r session :

library("Rcmdr")
Le chargement a n?cessit? le package : tcltk
Chargement de Tcl/Tk... termin?
Le chargement a n?cessit? le package : grDevices
Le chargement a n?cessit? le package : utils
Le chargement a n?cessit? le package : car
Le chargement a n?cessit? le package : stats
Le chargement a n?cessit? le package : graphics

Version de Rcmdr 1.4-10


Attachement du package : 'Rcmdr'


	The following object(s) are masked from package:tcltk :

	 tclvalue


From p.dalgaard at biostat.ku.dk  Wed Jul 15 07:59:31 2009
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Wed, 15 Jul 2009 07:59:31 +0200
Subject: [Rd] rcmdr gui not running (PR#13831)
In-Reply-To: <20090714232012.22BD92830319@mail.pubhealth.ku.dk>
References: <20090714232012.22BD92830319@mail.pubhealth.ku.dk>
Message-ID: <4A5D7043.9050003@biostat.ku.dk>

francois.greff at dbmail.com wrote:
> Full_Name: greff francois
> Version: 2.8.1 
> OS: ubuntu 9.04
> Submission from: (NULL) (89.227.27.2)
> 
> 
> into r , the command library("Rcmdr") works well : the r commander GUI is opened
> , with menu in french ( well !) . But it isn't possible to have a response to
> any click on menu ??? It's neither possible to edit a command in the "script
> window" . To resume, nothing at all is possible , neither with the mouse , nor
> with the keyboard .
> 
> What mistake did I . I reinstalled everything .... same response .
> 
> here my r session :
> 
> library("Rcmdr")
> Le chargement a n?cessit? le package : tcltk
> Chargement de Tcl/Tk... termin?
> Le chargement a n?cessit? le package : grDevices
> Le chargement a n?cessit? le package : utils
> Le chargement a n?cessit? le package : car
> Le chargement a n?cessit? le package : stats
> Le chargement a n?cessit? le package : graphics
> 
> Version de Rcmdr 1.4-10
> 
> 
> Attachement du package : 'Rcmdr'
> 
> 
> 	The following object(s) are masked from package:tcltk :
> 
> 	 tclvalue

Hmm, where did that come from? If a second tclvalue() function is 
getting picked up instead of the one in tcltk, then bad things would 
likely happen (but I thought namespaces would take care of that?)

Have you tried starting R with a clean workspace before loading Rcmdr?


-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From hpages at fhcrc.org  Wed Jul 15 10:34:40 2009
From: hpages at fhcrc.org (hpages at fhcrc.org)
Date: Wed, 15 Jul 2009 01:34:40 -0700
Subject: [Rd] Protection stack overflow
Message-ID: <20090715013440.v7a1c8r4g0cgksw8@webmail.fhcrc.org>

Hi,

   > gctorture(TRUE)
   > setGeneric("foo", function(x, y) standardGeneric("foo"))
   [1] "foo"
   > setMethod("foo", c("ANY", "ANY"),
   +   function(x, y) cat("calling foo,ANY,ANY method\n")
   + )
   Error: protect(): protection stack overflow

Sorry this is something I already reported one week ago here
   https://stat.ethz.ch/pipermail/r-devel/2009-July/053973.html
but I just had a 2nd look at it and realized that the problem
can in fact be reproduced out of the .onLoad() hook. So I'm
reporting it again with a different subject.

See my sessionInfo() below. Thanks!
H.


> sessionInfo()
R version 2.10.0 Under development (unstable) (2009-06-26 r48837)
x86_64-unknown-linux-gnu

locale:
  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
  [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
  [5] LC_MONETARY=C              LC_MESSAGES=en_CA.UTF-8
  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base


From saptarshi.guha at gmail.com  Wed Jul 15 12:48:46 2009
From: saptarshi.guha at gmail.com (Saptarshi Guha)
Date: Wed, 15 Jul 2009 03:48:46 -0700
Subject: [Rd] A question on the serialization of a list vector
Message-ID: <1e7471d50907150348v57eed13bx795d5607d370364e@mail.gmail.com>

Hello,
I've (by somewhat understanding serialize.c) understood how a vector
of type numeric/char/raw/logical are serialized, assuming they have no
attributes (e.g no attributes(x)=NULL).

I assumed for lists, the content of the list is written first and then
the names attribute. However nested lists this is not always true. The
names are written but the header is not the same (for the innermost
list, 'names' is written, but not so thereafter)

I didn't quite understand WriteItem in serialize.c, could someone
explain what happens in the case of a list whose only attribute is
names and whose elements are vectors which are either a)char b)raw
c)logical d)numeric or d)lists of these

Thank you
Regards
Saptarshi


From paola at idsia.ch  Wed Jul 15 12:00:09 2009
From: paola at idsia.ch (paola at idsia.ch)
Date: Wed, 15 Jul 2009 12:00:09 +0200 (CEST)
Subject: [Rd] bug in texi2dvi? (PR#13833)
Message-ID: <20090715100009.85C1F282EFC8@mail.pubhealth.ku.dk>

This is a multi-part message in MIME format.
--------------030806020308000905090302
Content-Type: text/plain; charset=ISO-8859-15; format=flowed
Content-Transfer-Encoding: 7bit

Hello,

I am trying to call texi2dvi on a very simple tex-file (see below) and 
it fails with a memory access error. I originally tried to call it on 
another, meaningful tex file with the same error occuring. I am 
attaching a screenshot.

Thank you very much for your help.

Kind regards,
Paola

-------------- tex file ciao.tex ------

\documentclass[11pt]{article}
\begin{document}

ciao

\end{document}


--------------030806020308000905090302
Content-Type: image/png;
 name="rgui_bug.png"
Content-Transfer-Encoding: base64
Content-Disposition: inline;
 filename="rgui_bug.png"

iVBORw0KGgoAAAANSUhEUgAAA84AAAI5CAIAAAD/l/QaAAAAAXNSR0IArs4c6QAAAARnQU1B
AACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAA
sfRJREFUeF7tvQm8JFV96N93ECTglhgStwSNW8R9QRRURlFzwV1Ao6OOY1wRULBVRHCGYV9k
Z67AZUAYVoWrgCLrRRwQcAnRiblK4iiJJhiS9/55L768Jbn/c+pUnTqn6pyqOtVV3V3d3/4c
8U531Vm+VV31rV//qs7M8vJyjxcEIAABCEAAAhCAAAQg0BCBo4466vbbb1+5cmVPqPaW++6m
QAACEIAABCAAAQhAAAKNEFi3bp3wbPFfVJvLDAhAAAIQgAAEIAABCDRJwKHaOzztgEbKjk8/
YMenfzwtz/j4I+Jy4COeEZVnHvjItBz0yD896FFmedbBj3rWwY82yy4HP3qXTzxGl2d/4jFR
+d1nfzIuz/nk7z7nk78nyyGyPDcuj33uIbI871Bdfv95h8ryfFE+pcpOorxAlb4of6DKC3X5
9B++8NN/+CKrPO7FnzHL41/8mce/5LNmecKun43KYXF56WFPTMvnnvjSzz1xt889KS2HP+ll
h/9Rprz8839slt0//8e7f37n3Y+Iyx5H7ByVJ+9xZFxeceSTX3HkU+Lyhae8Mi5/8sovxOVV
a/8kKk9VZU9R1qnyNFFW6nLU01dG5dVpecar1z/jNVZ55l5Hm+VP9zr6T18ryjG6POt1xyTl
2Ge9TpZdXq/Lcbu8/rhd/uy4Z5tl9vjnZMrexz937xPSss8Jz93nhOftc2Ja3nDi895w4vNl
OUmWN8ryAl3edPILovJCXd58yguj8iJV3qLKF1+sylvT8pK3nirL29Ky69tO2/XtVnnp2097
6b6n67Lbvqfvtp8qZ6jysv11OfNl+8vy8neY5ayXv/Os3e2yx5+fbZV3nf2Kd52Tlnef84p3
n/NKWTbEZdWGV67a8Kq4zL3qPbLsqct7v7RnVFbq8r4vrXzfuaK8WpXVcXnN6vPi8v7zXhOV
vd5/vixr0vLaNee/9gPzZnndB+Zf9xeiXKDK60X5oCobVfkzUT6ky4V/9qELZz9sl49ctLdd
9vnol63ysS+/QZaL43LAxW844OI3xuWSNx5wyRs/fsmb0rLpTQfK8mazHHTpmw+69C26HHzp
W2S57K2qfCIub/vE5XH55OVvi8rbZbni7YekZd9DrpDl0Ct12e/QK/f7lChXqbK/KH1dvrJ/
/yvvEOXTZvnqOz+TLX/+2avN8q7Drn7XYdek5XPXvDsuC+/+XFQOX1iVlq+t+vzX3mOWI77+
niO+/l6zHPn19x557ft0+cK174vK6i9cF5e1161ee937ZblelnVxWbPuelmO+oYuHzjqG7Ks
F+WbqvyFKEercoMoH1TlGF2+9aFjvvWhY63y4eNuNMtHjrvxI8ffZJaPnnBTVG6Oy4k3fywt
t3zsxFs+dtItB6Tl1gNOvvXjmXLKbQea5Yu3HfjF2w764mJcTl08KCoHn3p7XE67/eDTbv9E
XL79idPj8snTvx2XM+74ZFQOUeVMUb6jyqGinKXL5k+dFZWz09I/+87+OVb59Ia7zPKZDXd9
Zk6U7+ry2S99Nyl3f/ZLshx2ri73HHbuPYedd8/nzHL+vYdnyvy9n5//Xlou+N7nL/jeERd8
Py0bv3/Exu8fKcsPZLlQli/octEPvxCVtbp8+S/XRmWdKherct9RqlySlvWX/JUsm9Jy9KYf
HX2pVY659EfHXPZjXY697MfHXq7KFlWOu0KXvz7uClmOv9IsPzn+qp+cYJcTv/I3Vvnq35z0
1aW0XL100tVLJ8vy07hc89OTr/npKXH52SkLsnxRl6/d/8WonKrL1+8/9et/K8ppqlwbl9Ov
/bu4XPd3p0fljOt+Lsv1aTnz+p+f+Y2tZjnrG1vP+qYov1DlbFFuUOWXqpwjyrd0eeCcbz2w
4Ua73PT3c3b50s3/YJVb/uFcWX4Vl1t/de6tvzovLr8+79Zfn3fbr89Pyz+evyjLvFlu/6f5
2//pAl2+/U8XyPLgRlXuiMuFd/wmLt/5zYVRuUiWf75oc1q+vPmfZbnzIV0uvvOhi+8S5V9U
uUSU7+ryr5d89183iXK3Wf7bpfdY5bJ7//uYFxUUL1LtD3z80/t+6DBn2fu9h+y8y67FRo5q
o9qoNqqNaqPaqDaqjWqj2qi2lUCiBfqMGx484bwH9t9/i7McsHZLsW2j2qg2qo1qo9qoNqqN
aqPaqHZ7qi1uNaz+EjnT1RcWS4rlVeC83lrlUe0TNj2wT3/LDvtv2WWfn7/3mAcOPU2WI6Py
sSPuf8n+W/Y7YMtOO3lj26g2qo1qo9qoNqqNaqPaqDaq3apqV7x5USVyVH8KiFpeq3ZQK2qt
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
QAACEIAABCAAAQg0TgDVxrMhAAEIQAACEIAABCDQCoGqqj34zXzUAAEIQAACEIAABCAAgWkj
sHLlSjEpoYqXK/POTmEj3uIFAQhAAAIQgAAEIAABCNQgUKLaenpw/oAABCAAAQhAAAIQgAAE
Qgl4o9qNp4dTIQQgAAEIQAACoyUgwnLT9iM+44XAaAkUqXaotrM8BCAAAQhAAAJjS0Bli45W
O2gdAtNGoES1R3vxTesQgAAEIAABCDRFANWeNsljvONAANVu5QkvTR0WqQcCEIAABCDQFAFU
exzEiz5MG4FKqr3D0w4YsOz49AN2fPrHVXnEM0Q5UJZnHvjIuBz0yD896FGqPOvgR+uyy8GP
2eUTsjxblt999idleY4sv/ecQ2R5riyPFeV5h4ry+6o8/1Oi7CTKC1Tp/4EoL1Tl03/4orQ8
7sWfUeXxorzks6o8YVdRDlPliS9V5XNP3O1zT4rL4U962eF/pMrLD//jl38+Lrt/fufdj4jL
Hkc8eY8jZXmFLE+R5QtPeaUsfyLKq9aK8lRV9hRl3dNEWanKUU8X5dVxecZr1uvyzL2OVuVP
RXntMao863WqHCvKLq9X5bhd/uy4Z+sye/xzVNn7+OfufUJc9jnhefucGJc3nPh8WU56/htl
eYEsJ7/gTbK8UJQ3i3LKi1R5iyhffLEob43LS9566kveFpdd33barm+X5aWi7Hu6KruJsp8o
Z4jysv1VOVOUl78jKe88a/ek7PHnZ+vyinedE5d3n/NKWTbIsmrDq2SZe9V7ZNlTlfd+aaUq
7xPl3FerslqW16w+7zXvj8te7z9/rzVxee2a+dd+QJbXifIXolwgyutF+aAoG0X5sw/pcuHs
h5PykYv2Tso+H/2yLm/42Jff8LGLZTng4jfKcoksH7/kTaocuEmUN6ty0KVvUeVgWd568GWy
fEKWt33iclk+KcvbP3nF2w+Jy76HXLHvoVeKsp8onxLlKlH2F6Wvylfe8WldvvrOz6Tlzz97
tSrvOkyUa1R59+dEWZDl8IVVcfnaqs9/7T2qHPH19+py5Nffd+S1snxBltVfuE6WtbK8f+31
sqyTZY0oR31DlA+osv6bovyFKEercsMHRTlGlW996Ni0fPi4G1X5iCjH36TKR08Q5WZVPnai
Krd87KRbDojLrQecfOvHVTnl1gNPuS0uX7ztoC8uxuXUxYNPvV2W02T5hCzf/sTpsnxSlDPu
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
YII=
--------------030806020308000905090302--


From murdoch at stats.uwo.ca  Wed Jul 15 15:47:16 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 15 Jul 2009 09:47:16 -0400
Subject: [Rd] Dynamic help pages
Message-ID: <4A5DDDE4.5000207@stats.uwo.ca>

I've just committed code that allows R to be built with support for 
dynamic help pages using \Sexpr in Rd files.  Define USE_NEW_HELP and 
the R function tools:::.convertRdfiles will be used instead of the Perl 
RdConv script, supporting \Sexpr and using the new R converters.

Currently only text help has the macros evaluated when the user asks for 
help; the others are rendered at install time.  Hopefully HTML rendering 
will also be in place before the 2.10.x release.  I can't see how CHM 
and Latex help pages would ever be dynamic. Build time evaluation of 
\Sexpr macros is not yet supported.

The only man page currently containing \Sexpr is ?tools::Rd2HTML.

Duncan Murdoch


From r.cowan at merit.unimaas.nl  Wed Jul 15 20:19:08 2009
From: r.cowan at merit.unimaas.nl (robin cowan)
Date: Wed, 15 Jul 2009 14:19:08 -0400
Subject: [Rd] Fwd: DLLs
References: <E85406A5-2063-425A-B955-2FD87224E87B@merit.unimaas.nl>
Message-ID: <D4C2AF1D-B511-47F6-AE7A-D983A7DAF7A5@merit.unimaas.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090715/275012e6/attachment.pl>

From mwkimpel at gmail.com  Wed Jul 15 20:46:55 2009
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Wed, 15 Jul 2009 14:46:55 -0400
Subject: [Rd] rJava fails compilation on R-2.9.1 but not R-2.7.1 on Debian
	Lenny
Message-ID: <6b93d1830907151146q506e937fxd4d31cc7d01c2ea3@mail.gmail.com>

I have been futzing around for days tying to get rJava to install on
my freshly build Debian Lenny installation. I have R-2.9.1 installed
from source in my R_HOME directory and R-2.7.1 installed via apt-get
install r-recommended. I was tried many different things, but by
accident started up R-2.7.1 as root and viola, successful install. I
immediately exited out of R-2.7.1 and started R-2.9.1 as root and
compilation fails. The file

The output is voluminous, but is included below. I had originally
thought that my problem had to do with setting environmental
variables, but now it seems not.

Thanks,
Mark

mkimpel-debian-xps /usr/lib/jvm/java-6-sun/include: su root
Password:
mkimpel-debian-xps:/usr/lib/jvm/java-6-sun/include#
/home/mkimpel/R_HOME/R-2.9.1/R-build/bin/R
WARNING: ignoring environment value of R_HOME

R version 2.9.1 (2009-06-26)
Copyright (C) 2009 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> install.packages('rJava')
Warning in install.packages("rJava") :
  argument 'lib' is missing: using '/usr/local/lib/R/site-library'
--- Please select a CRAN mirror for use in this session ---
Loading Tcl/Tk interface ... done
trying URL 'http://cran.fhcrc.org/src/contrib/rJava_0.6-3.tar.gz'
Content type 'application/x-gzip' length 240527 bytes (234 Kb)
opened URL
==================================================
downloaded 234 Kb

* Installing *source* package ?rJava? ...
checking for gcc... gcc -std=gnu99
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc -std=gnu99 accepts -g... yes
checking for gcc -std=gnu99 option to accept ISO C89... none needed
checking how to run the C preprocessor... gcc -std=gnu99 -E
checking for grep that handles long lines and -e... /bin/grep
checking for egrep... /bin/grep -E
checking for ANSI C header files... yes
checking for sys/wait.h that is POSIX.1 compatible... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking for string.h... (cached) yes
checking sys/time.h usability... yes
checking sys/time.h presence... yes
checking for sys/time.h... yes
checking for unistd.h... (cached) yes
checking for an ANSI C-conforming const... yes
checking whether time.h and sys/time.h may both be included... yes
configure: checking whether gcc -std=gnu99 supports static inline...
yes
checking Java support in R... present:
interpreter : '/usr/bin/java'
archiver    : '/usr/bin/jar'
compiler    : '/usr/bin/javac'
header prep.: '/usr/bin/javah'
cpp flags   : '-I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux'
java libs   : '-L$(JAVA_HOME)/lib/amd64/server
-L$(JAVA_HOME)/lib/amd64 -L$(JAVA_HOME)/../lib/amd64 -L
-L/usr/java/packages/lib/amd64 -L/lib -L/usr/lib -ljvm'
checking whether JNI programs can be compiled... yes
checking JNI data types... ok
checking whether JRI should be compiled (autodetect)... no
checking whether debugging output should be enabled... no
checking whether memory profiling is desired... no
checking whether threads support is requested... no
checking whether callbacks support is requested... no
checking whether JNI cache support is requested... no
checking whether JRI is requested... no
configure: creating ./config.status
config.status: creating src/Makevars
config.status: creating R/zzz.R
config.status: creating src/config.h
** libs
gcc -std=gnu99 -I/home/mkimpel/R_HOME/R-2.9.1/R-build/lib64/R/include
-I. -I/usr/lib/jvm/java-1.5.0-gcj-4.3-1.5.0.0/jre/../include
-I/usr/lib/jvm/java-1.5.0-gcj-4.3-1.5.0.0/jre/../include/linux
-I/usr/local/include    -fpic  -g -O2 -c Rglue.c -o Rglue.o
In file included from Rglue.c:2:
rJava.h:17:17: error: jni.h: No such file or directory
In file included from Rglue.c:2:
rJava.h:115: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?*? token
rJava.h:117: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?*? token
rJava.h:120: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?*? token
rJava.h:122: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?javaStringClass?
rJava.h:123: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?javaObjectClass?
rJava.h:124: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?javaClassClass?
rJava.h:125: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?javaFieldClass?
rJava.h:127: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?mid_forName?
rJava.h:128: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?mid_getName?
rJava.h:129: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?mid_getType?
rJava.h:130: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?mid_getField?
rJava.h:133: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?clClassLoader?
rJava.h:134: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?oClassLoader?
rJava.h:137: error: expected ?)? before ?*? token
rJava.h:138: error: expected ?)? before ?*? token
rJava.h:139: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?R1par2jvalue?
rJava.h:144: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?callToString?
rJava.h:147: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?createObject?
rJava.h:148: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?findClass?
rJava.h:149: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?objectClass?
rJava.h:151: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?newDoubleArray?
rJava.h:152: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?newIntArray?
rJava.h:153: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?newBooleanArrayI?
rJava.h:154: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?newString?
rJava.h:155: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?newCharArrayI?
rJava.h:156: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?newShortArrayI?
rJava.h:157: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?newFloatArrayD?
rJava.h:158: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?newLongArrayD?
rJava.h:159: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?newByteArray?
rJava.h:160: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?newByteArrayI?
rJava.h:162: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?makeGlobal?
rJava.h:163: error: expected ?)? before ?*? token
rJava.h:164: error: expected ?)? before ?*? token
rJava.h:166: error: expected ?)? before ?*? token
rJava.h:168: error: expected ?)? before ?*? token
rJava.h:170: error: expected ?)? before ?*? token
Rglue.c: In function ?JRefObjectFinalizer?:
Rglue.c:79: error: ?JNIEnv? undeclared (first use in this function)
Rglue.c:79: error: (Each undeclared identifier is reported only once
Rglue.c:79: error: for each function it appears in.)
Rglue.c:79: error: ?env? undeclared (first use in this function)
Rglue.c:79: warning: implicit declaration of function ?getJNIEnv?
Rglue.c:80: error: ?jobject? undeclared (first use in this function)
Rglue.c:80: error: expected ?;? before ?o?
Rglue.c:95: error: ?o? undeclared (first use in this function)
Rglue.c:98: warning: implicit declaration of function ?releaseGlobal?
Rglue.c: At top level:
Rglue.c:104: error: expected ?)? before ?*? token
Rglue.c: In function ?deserializeSEXP?:
Rglue.c:151: error: ?JNIEnv? undeclared (first use in this function)
Rglue.c:151: error: ?env? undeclared (first use in this function)
Rglue.c:152: error: ?clClassLoader? undeclared (first use in this function)
Rglue.c:152: error: ?oClassLoader? undeclared (first use in this function)
Rglue.c:153: error: ?jbyteArray? undeclared (first use in this function)
Rglue.c:153: error: expected ?;? before ?ser?
Rglue.c:154: error: ?ser? undeclared (first use in this function)
Rglue.c:155: error: ?jmethodID? undeclared (first use in this function)
Rglue.c:155: error: expected ?;? before ?mid?
Rglue.c:156: error: ?mid? undeclared (first use in this function)
Rglue.c:157: error: ?jobject? undeclared (first use in this function)
Rglue.c:157: error: expected ?;? before ?res?
Rglue.c:158: error: ?res? undeclared (first use in this function)
Rglue.c:159: error: expected ?;? before ?go?
Rglue.c:161: error: ?go? undeclared (first use in this function)
Rglue.c:173: warning: implicit declaration of function ?releaseObject?
Rglue.c: At top level:
Rglue.c:214: error: expected ?)? before ?*? token
Rglue.c:380: error: expected ?)? before ?*? token
Rglue.c:390: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
before ?R1par2jvalue?
Rglue.c: In function ?RcallMethod?:
Rglue.c:410: error: ?jvalue? undeclared (first use in this function)
Rglue.c:410: error: expected ?;? before ?jpar?
Rglue.c:411: error: ?jobject? undeclared (first use in this function)
Rglue.c:411: error: expected ?;? before ?tmpo?
Rglue.c:412: error: expected ?;? before ?o?
Rglue.c:414: error: ?jmethodID? undeclared (first use in this function)
Rglue.c:414: error: expected ?;? before ?mid?
Rglue.c:415: error: ?jclass? undeclared (first use in this function)
Rglue.c:415: error: expected ?;? before ?cls?
Rglue.c:416: error: ?JNIEnv? undeclared (first use in this function)
Rglue.c:416: error: ?env? undeclared (first use in this function)
Rglue.c:424: error: ?o? undeclared (first use in this function)
Rglue.c:440: error: ?cls? undeclared (first use in this function)
Rglue.c:440: warning: implicit declaration of function ?findClass?
Rglue.c:442: warning: implicit declaration of function ?objectClass?
Rglue.c:467: warning: implicit declaration of function ?Rpar2jvalue?
Rglue.c:467: error: ?jpar? undeclared (first use in this function)
Rglue.c:467: error: ?tmpo? undeclared (first use in this function)
Rglue.c:471: error: ?mid? undeclared (first use in this function)
Rglue.c:475: warning: implicit declaration of function ?checkExceptionsX?
Rglue.c:481: warning: implicit declaration of function ?Rfreejpars?
Rglue.c:542: error: ?jlong? undeclared (first use in this function)
Rglue.c:542: error: expected ?;? before ?r?
Rglue.c:546: error: ?r? undeclared (first use in this function)
Rglue.c:555: error: ?jshort? undeclared (first use in this function)
Rglue.c:555: error: expected ?;? before ?r?
Rglue.c:568: error: ?jboolean? undeclared (first use in this function)
Rglue.c:568: error: expected ?;? before ?r?
Rglue.c:607: error: expected ?;? before ?r?
Rglue.c:620: warning: implicit declaration of function ?j2SEXP?
Rglue.c:620: warning: assignment makes pointer from integer without a cast
Rglue.c: In function ?RcallSyncMethod?:
Rglue.c:634: error: ?jobject? undeclared (first use in this function)
Rglue.c:634: error: expected ?;? before ?o?
Rglue.c:635: error: ?JNIEnv? undeclared (first use in this function)
Rglue.c:635: error: ?env? undeclared (first use in this function)
Rglue.c:642: error: ?o? undeclared (first use in this function)
Rglue.c:650: error: ?JNI_OK? undeclared (first use in this function)
Rglue.c: In function ?RcreateObject?:
Rglue.c:671: error: ?jvalue? undeclared (first use in this function)
Rglue.c:671: error: expected ?;? before ?jpar?
Rglue.c:672: error: ?jobject? undeclared (first use in this function)
Rglue.c:672: error: expected ?;? before ?tmpo?
Rglue.c:673: error: expected ?;? before ?o?
Rglue.c:674: error: ?JNIEnv? undeclared (first use in this function)
Rglue.c:674: error: ?env? undeclared (first use in this function)
Rglue.c:690: error: ?jpar? undeclared (first use in this function)
Rglue.c:690: error: ?tmpo? undeclared (first use in this function)
Rglue.c:704: error: ?o? undeclared (first use in this function)
Rglue.c:704: warning: implicit declaration of function ?createObject?
Rglue.c:723: warning: return makes pointer from integer without a cast
Rglue.c: At top level:
Rglue.c:727: error: expected ?)? before ?*? token
Rglue.c:758: error: expected ?)? before ?*? token
Rglue.c:770: error: expected ?)? before ?*? token
Rglue.c: In function ?RcreateArray?:
Rglue.c:786: error: ?JNIEnv? undeclared (first use in this function)
Rglue.c:786: error: ?env? undeclared (first use in this function)
Rglue.c:793: error: ?jbyteArray? undeclared (first use in this function)
Rglue.c:793: error: expected ?;? before ?a?
Rglue.c:794: error: ?a? undeclared (first use in this function)
Rglue.c:795: warning: implicit declaration of function ?new_jarrayRef?
Rglue.c:795: warning: return makes pointer from integer without a cast
Rglue.c:797: error: ?jcharArray? undeclared (first use in this function)
Rglue.c:797: error: expected ?;? before ?a?
Rglue.c:799: warning: return makes pointer from integer without a cast
Rglue.c:801: error: ?jintArray? undeclared (first use in this function)
Rglue.c:801: error: expected ?;? before ?a?
Rglue.c:803: warning: return makes pointer from integer without a cast
Rglue.c:809: error: ?jfloatArray? undeclared (first use in this function)
Rglue.c:809: error: expected ?;? before ?a?
Rglue.c:811: warning: return makes pointer from integer without a cast
Rglue.c:813: error: ?jlongArray? undeclared (first use in this function)
Rglue.c:813: error: expected ?;? before ?a?
Rglue.c:815: warning: return makes pointer from integer without a cast
Rglue.c:817: error: ?jdoubleArray? undeclared (first use in this function)
Rglue.c:817: error: expected ?;? before ?a?
Rglue.c:819: warning: return makes pointer from integer without a cast
Rglue.c:824: error: ?jobjectArray? undeclared (first use in this function)
Rglue.c:824: error: expected ?;? before ?a?
Rglue.c:828: error: ?jobject? undeclared (first use in this function)
Rglue.c:828: error: expected ?;? before ?so?
Rglue.c:829: error: ?so? undeclared (first use in this function)
Rglue.c:833: warning: return makes pointer from integer without a cast
Rglue.c:838: error: ?jbooleanArray? undeclared (first use in this function)
Rglue.c:838: error: expected ?;? before ?a?
Rglue.c:840: warning: return makes pointer from integer without a cast
Rglue.c:845: error: ?jclass? undeclared (first use in this function)
Rglue.c:845: error: expected ?;? before ?ac?
Rglue.c:861: error: ?ac? undeclared (first use in this function)
Rglue.c:881: error: expected ?;? before ?a?
Rglue.c:883: error: ?javaObjectClass? undeclared (first use in this function)
Rglue.c:888: error: expected ?;? before ?o?
Rglue.c:893: error: ?o? undeclared (first use in this function)
Rglue.c:899: warning: return makes pointer from integer without a cast
Rglue.c:904: error: expected ?;? before ?a?
Rglue.c:906: warning: return makes pointer from integer without a cast
Rglue.c: In function ?RpollException?:
Rglue.c:916: error: ?JNIEnv? undeclared (first use in this function)
Rglue.c:916: error: ?env? undeclared (first use in this function)
Rglue.c:917: error: ?jthrowable? undeclared (first use in this function)
Rglue.c:917: error: expected ?;? before ?t?
Rglue.c:919: error: ?t? undeclared (first use in this function)
Rglue.c: In function ?RclearException?:
Rglue.c:927: error: ?JNIEnv? undeclared (first use in this function)
Rglue.c:927: error: ?env? undeclared (first use in this function)
Rglue.c: In function ?RthrowException?:
Rglue.c:948: error: ?JNIEnv? undeclared (first use in this function)
Rglue.c:948: error: ?env? undeclared (first use in this function)
Rglue.c:949: error: ?jthrowable? undeclared (first use in this function)
Rglue.c:949: error: expected ?;? before ?t?
Rglue.c:960: error: ?t? undeclared (first use in this function)
make: *** [Rglue.o] Error 1
ERROR: compilation failed for package ?rJava?
* Removing ?/usr/local/lib/R/site-library/rJava?
* Restoring previous ?/usr/local/lib/R/site-library/rJava?

The downloaded packages are in
	?/tmp/Rtmp0D1hWd/downloaded_packages?
Warning message:
In install.packages("rJava") :
  installation of package 'rJava' had non-zero exit status
> q()
Save workspace image? [y/n/c]: n
mkimpel-debian-xps:/usr/lib/jvm/java-6-sun/include# R

R version 2.7.1 (2008-06-23)
Copyright (C) 2008 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> install.packages('rJava')
Warning in install.packages("rJava") :
  argument 'lib' is missing: using '/usr/local/lib/R/site-library'
--- Please select a CRAN mirror for use in this session ---
Loading Tcl/Tk interface ... done
trying URL 'http://cran.fhcrc.org/src/contrib/rJava_0.6-3.tar.gz'
Content type 'application/x-gzip' length 240527 bytes (234 Kb)
opened URL
==================================================
downloaded 234 Kb

* Installing *source* package 'rJava' ...
checking for gcc... gcc -std=gnu99
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc -std=gnu99 accepts -g... yes
checking for gcc -std=gnu99 option to accept ISO C89... none needed
checking how to run the C preprocessor... gcc -std=gnu99 -E
checking for grep that handles long lines and -e... /bin/grep
checking for egrep... /bin/grep -E
checking for ANSI C header files... yes
checking for sys/wait.h that is POSIX.1 compatible... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking for string.h... (cached) yes
checking sys/time.h usability... yes
checking sys/time.h presence... yes
checking for sys/time.h... yes
checking for unistd.h... (cached) yes
checking for an ANSI C-conforming const... yes
checking whether time.h and sys/time.h may both be included... yes
configure: checking whether gcc -std=gnu99 supports static inline...
yes
checking Java support in R... present:
interpreter : '/usr/bin/java'
archiver    : '/usr/bin/jar'
compiler    : '/usr/bin/javac'
header prep.: '/usr/bin/javah'
cpp flags   : '-I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux'
java libs   : '-L$(JAVA_HOME)/lib/amd64/server
-L$(JAVA_HOME)/lib/amd64 -L$(JAVA_HOME)/../lib/amd64 -L
-L/usr/java/packages/lib/amd64 -L/lib -L/usr/lib -ljvm'
checking whether JNI programs can be compiled... yes
checking JNI data types... ok
checking whether JRI should be compiled (autodetect)... yes
checking whether debugging output should be enabled... no
checking whether memory profiling is desired... no
checking whether threads support is requested... no
checking whether callbacks support is requested... no
checking whether JNI cache support is requested... no
checking whether JRI is requested... yes
configure: creating ./config.status
config.status: creating src/Makevars
config.status: creating R/zzz.R
config.status: creating src/config.h
=== configuring in jri (/tmp/R.INSTALL.bELNGf/rJava/jri)
configure: running /bin/sh ./configure '--prefix=/usr/local'
--cache-file=/dev/null --srcdir=.
checking build system type... x86_64-unknown-linux-gnu
checking host system type... x86_64-unknown-linux-gnu
checking for gcc... gcc -std=gnu99
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc -std=gnu99 accepts -g... yes
checking for gcc -std=gnu99 option to accept ISO C89... none needed
checking how to run the C preprocessor... gcc -std=gnu99 -E
checking for grep that handles long lines and -e... /bin/grep
checking for egrep... /bin/grep -E
checking for ANSI C header files... yes
checking whether Java interpreter works... checking whether JNI
programs can be compiled... yes
checking whether JNI programs can be run... yes
checking JNI data types... ok
checking whether Rinterface.h exports R_CStackXXX variables... yes
checking whether Rinterface.h exports R_SignalHandlers... yes
configure: creating ./config.status
config.status: creating src/Makefile
config.status: creating Makefile
config.status: creating run
config.status: creating src/config.h
** libs
gcc -std=gnu99 -I/usr/share/R/include -I.
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux     -fpic  -g
-O2 -c arrayc.c -o arrayc.o
gcc -std=gnu99 -I/usr/share/R/include -I.
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux     -fpic  -g
-O2 -c callback.c -o callback.o
gcc -std=gnu99 -I/usr/share/R/include -I.
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux     -fpic  -g
-O2 -c callJNI.c -o callJNI.o
gcc -std=gnu99 -I/usr/share/R/include -I.
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux     -fpic  -g
-O2 -c fields.c -o fields.o
gcc -std=gnu99 -I/usr/share/R/include -I.
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux     -fpic  -g
-O2 -c init.c -o init.o
gcc -std=gnu99 -I/usr/share/R/include -I.
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux     -fpic  -g
-O2 -c jri_glue.c -o jri_glue.o
gcc -std=gnu99 -I/usr/share/R/include -I.
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux     -fpic  -g
-O2 -c loader.c -o loader.o
gcc -std=gnu99 -I/usr/share/R/include -I.
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux     -fpic  -g
-O2 -c Rglue.c -o Rglue.o
gcc -std=gnu99 -I/usr/share/R/include -I.
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux     -fpic  -g
-O2 -c rJava.c -o rJava.o
gcc -std=gnu99 -I/usr/share/R/include -I.
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux     -fpic  -g
-O2 -c tools.c -o tools.o
gcc -std=gnu99 -shared  -o rJava.so arrayc.o callback.o callJNI.o
fields.o init.o jri_glue.o loader.o Rglue.o rJava.o tools.o
-L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/amd64/server
-L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/amd64
-L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../lib/amd64 -L
-L/usr/java/packages/lib/amd64 -L/lib -L/usr/lib -ljvm
-L/usr/lib64/R/lib -lR
make -C ../jri/
make[1]: Entering directory `/tmp/R.INSTALL.bELNGf/rJava/jri'
make -C src JRI.jar
make[2]: Entering directory `/tmp/R.INSTALL.bELNGf/rJava/jri/src'
/usr/bin/javac -target 1.4 -source 1.4 -d . ../Mutex.java
../RBool.java ../RConsoleOutputStream.java ../Rengine.java
../REXP.java ../RFactor.java ../RList.java ../RMainLoopCallbacks.java
../RVector.java
/usr/bin/javah -d . -classpath . org.rosuda.JRI.Rengine
gcc -std=gnu99 -c -o Rengine.o Rengine.c -g -Iinclude
-DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux  -fpic
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
-I/usr/share/R/include -I/usr/share/R/include -I/usr/share/R/include
gcc -std=gnu99 -c -o jri.o jri.c -g -Iinclude  -DRIF_HAS_CSTACK
-DRIF_HAS_RSIGHAND -g -O2
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux  -fpic
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
-I/usr/share/R/include -I/usr/share/R/include -I/usr/share/R/include
jri.c: In function ?jri_getObjectArray?:
jri.c:303: warning: cast from pointer to integer of different size
gcc -std=gnu99 -c -o Rcallbacks.o Rcallbacks.c -g -Iinclude
-DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux  -fpic
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
-I/usr/share/R/include -I/usr/share/R/include -I/usr/share/R/include
gcc -std=gnu99 -c -o Rinit.o Rinit.c -g -Iinclude  -DRIF_HAS_CSTACK
-DRIF_HAS_RSIGHAND -g -O2
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux  -fpic
-I/usr/share/R/include -I/usr/share/R/include -I/usr/share/R/include
gcc -std=gnu99 -c -o globals.o globals.c -g -Iinclude
-DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux  -fpic
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
gcc -std=gnu99 -c -o rjava.o rjava.c -g -Iinclude  -DRIF_HAS_CSTACK
-DRIF_HAS_RSIGHAND -g -O2
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux  -fpic
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
-I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
gcc -std=gnu99 -o libjri.so Rengine.o jri.o Rcallbacks.o Rinit.o
globals.o rjava.o  -shared
-L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/amd64/server
-L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/amd64
-L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../lib/amd64 -L
-L/usr/java/packages/lib/amd64 -L/lib -L/usr/lib -ljvm
-L/usr/lib64/R/lib -lR
/usr/bin/javac -target 1.4 -source 1.4 -d . ../Mutex.java
../RBool.java ../RConsoleOutputStream.java ../Rengine.java
../REXP.java ../RFactor.java ../RList.java ../RMainLoopCallbacks.java
../RVector.java
/usr/bin/jar fc JRI.jar org libjri.so
make[2]: Leaving directory `/tmp/R.INSTALL.bELNGf/rJava/jri/src'
rm -f libjri.so
cp src/libjri.so libjri.so
/usr/bin/javac -target 1.4 -source 1.4 -classpath src/JRI.jar -d
examples examples/rtest2.java
Note: examples/rtest2.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
/usr/bin/javac -target 1.4 -source 1.4 -classpath src/JRI.jar -d
examples examples/rtest.java
Note: examples/rtest.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
make[1]: Leaving directory `/tmp/R.INSTALL.bELNGf/rJava/jri'
** R
** inst
** preparing package for lazy loading
** help
 >>> Building/Updating help pages for package 'rJava'
     Formats: text html latex example
  accessOp                          text    html    latex   example
  jarray                            text    html    latex   example
  jarrayRef-class                   text    html    latex
  jcall                             text    html    latex   example
  jcast                             text    html    latex   example
  jcastToArray                      text    html    latex   example
  jcheck                            text    html    latex   example
  jengine                           text    html    latex   example
  jequals                           text    html    latex   example
  jfield                            text    html    latex   example
  jfloat-class                      text    html    latex
  jfloat                            text    html    latex
  jinit                             text    html    latex   example
  jmemprof                          text    html    latex   example
  jnew                              text    html    latex   example
  jnull                             text    html    latex   example
  jobjRef-class                     text    html    latex
  jpackage                          text    html    latex   example
  jreflection                       text    html    latex   example
  jserialize                        text    html    latex
  jsimplify                         text    html    latex   example
  loader                            text    html    latex   example
  show                              text    html    latex
** building package indices ...
* DONE (rJava)

The downloaded packages are in
	/tmp/RtmplOpZ4F/downloaded_packages
> q()
Save workspace image? [y/n/c]: n
mkimpel-debian-xps:/usr/lib/jvm/java-6-sun/include#
------------------------------------------------------------
Mark W. Kimpel MD  ** Neuroinformatics ** Dept. of Psychiatry
Indiana University School of Medicine

15032 Hunter Court, Westfield, IN  46074

(317) 490-5129 Work, & Mobile & VoiceMail

"The real problem is not whether machines think but whether men do."
-- B. F. Skinner


From mwkimpel at gmail.com  Wed Jul 15 20:52:16 2009
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Wed, 15 Jul 2009 14:52:16 -0400
Subject: [Rd] rJava fails compilation on R-2.9.1 but not R-2.7.1 on
	Debian Lenny
In-Reply-To: <6b93d1830907151146q506e937fxd4d31cc7d01c2ea3@mail.gmail.com>
References: <6b93d1830907151146q506e937fxd4d31cc7d01c2ea3@mail.gmail.com>
Message-ID: <6b93d1830907151152padfca12tf0cbe5b37274a001@mail.gmail.com>

Sorry, My sentence that starts "The file" was truncated and should say
"The file "jni.h" is present and on my PATH, see output below"

mkimpel-debian-xps /usr/lib/jvm/java-6-sun/include: ls
classfile_constants.h  jawt.h  jdwpTransport.h	jni.h  jvmti.h	linux
mkimpel-debian-xps /usr/lib/jvm/java-6-sun/include: printenv PATH
/home/mkimpel/bin:/usr/local/bin:/usr/bin:/bin:/usr/games:/usr/lib/jvm/
mkimpel-debian-xps /usr/lib/jvm/java-6-sun/include:
------------------------------------------------------------



On Wed, Jul 15, 2009 at 2:46 PM, Mark Kimpel<mwkimpel at gmail.com> wrote:
> I have been futzing around for days tying to get rJava to install on
> my freshly build Debian Lenny installation. I have R-2.9.1 installed
> from source in my R_HOME directory and R-2.7.1 installed via apt-get
> install r-recommended. I was tried many different things, but by
> accident started up R-2.7.1 as root and viola, successful install. I
> immediately exited out of R-2.7.1 and started R-2.9.1 as root and
> compilation fails. The file
>
> The output is voluminous, but is included below. I had originally
> thought that my problem had to do with setting environmental
> variables, but now it seems not.
>
> Thanks,
> Mark
>
> mkimpel-debian-xps /usr/lib/jvm/java-6-sun/include: su root
> Password:
> mkimpel-debian-xps:/usr/lib/jvm/java-6-sun/include#
> /home/mkimpel/R_HOME/R-2.9.1/R-build/bin/R
> WARNING: ignoring environment value of R_HOME
>
> R version 2.9.1 (2009-06-26)
> Copyright (C) 2009 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
> ?Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
>
>> install.packages('rJava')
> Warning in install.packages("rJava") :
> ?argument 'lib' is missing: using '/usr/local/lib/R/site-library'
> --- Please select a CRAN mirror for use in this session ---
> Loading Tcl/Tk interface ... done
> trying URL 'http://cran.fhcrc.org/src/contrib/rJava_0.6-3.tar.gz'
> Content type 'application/x-gzip' length 240527 bytes (234 Kb)
> opened URL
> ==================================================
> downloaded 234 Kb
>
> * Installing *source* package ?rJava? ...
> checking for gcc... gcc -std=gnu99
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc -std=gnu99 accepts -g... yes
> checking for gcc -std=gnu99 option to accept ISO C89... none needed
> checking how to run the C preprocessor... gcc -std=gnu99 -E
> checking for grep that handles long lines and -e... /bin/grep
> checking for egrep... /bin/grep -E
> checking for ANSI C header files... yes
> checking for sys/wait.h that is POSIX.1 compatible... yes
> checking for sys/types.h... yes
> checking for sys/stat.h... yes
> checking for stdlib.h... yes
> checking for string.h... yes
> checking for memory.h... yes
> checking for strings.h... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for unistd.h... yes
> checking for string.h... (cached) yes
> checking sys/time.h usability... yes
> checking sys/time.h presence... yes
> checking for sys/time.h... yes
> checking for unistd.h... (cached) yes
> checking for an ANSI C-conforming const... yes
> checking whether time.h and sys/time.h may both be included... yes
> configure: checking whether gcc -std=gnu99 supports static inline...
> yes
> checking Java support in R... present:
> interpreter : '/usr/bin/java'
> archiver ? ?: '/usr/bin/jar'
> compiler ? ?: '/usr/bin/javac'
> header prep.: '/usr/bin/javah'
> cpp flags ? : '-I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux'
> java libs ? : '-L$(JAVA_HOME)/lib/amd64/server
> -L$(JAVA_HOME)/lib/amd64 -L$(JAVA_HOME)/../lib/amd64 -L
> -L/usr/java/packages/lib/amd64 -L/lib -L/usr/lib -ljvm'
> checking whether JNI programs can be compiled... yes
> checking JNI data types... ok
> checking whether JRI should be compiled (autodetect)... no
> checking whether debugging output should be enabled... no
> checking whether memory profiling is desired... no
> checking whether threads support is requested... no
> checking whether callbacks support is requested... no
> checking whether JNI cache support is requested... no
> checking whether JRI is requested... no
> configure: creating ./config.status
> config.status: creating src/Makevars
> config.status: creating R/zzz.R
> config.status: creating src/config.h
> ** libs
> gcc -std=gnu99 -I/home/mkimpel/R_HOME/R-2.9.1/R-build/lib64/R/include
> -I. -I/usr/lib/jvm/java-1.5.0-gcj-4.3-1.5.0.0/jre/../include
> -I/usr/lib/jvm/java-1.5.0-gcj-4.3-1.5.0.0/jre/../include/linux
> -I/usr/local/include ? ?-fpic ?-g -O2 -c Rglue.c -o Rglue.o
> In file included from Rglue.c:2:
> rJava.h:17:17: error: jni.h: No such file or directory
> In file included from Rglue.c:2:
> rJava.h:115: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?*? token
> rJava.h:117: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?*? token
> rJava.h:120: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?*? token
> rJava.h:122: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?javaStringClass?
> rJava.h:123: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?javaObjectClass?
> rJava.h:124: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?javaClassClass?
> rJava.h:125: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?javaFieldClass?
> rJava.h:127: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?mid_forName?
> rJava.h:128: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?mid_getName?
> rJava.h:129: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?mid_getType?
> rJava.h:130: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?mid_getField?
> rJava.h:133: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?clClassLoader?
> rJava.h:134: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?oClassLoader?
> rJava.h:137: error: expected ?)? before ?*? token
> rJava.h:138: error: expected ?)? before ?*? token
> rJava.h:139: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?R1par2jvalue?
> rJava.h:144: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?callToString?
> rJava.h:147: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?createObject?
> rJava.h:148: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?findClass?
> rJava.h:149: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?objectClass?
> rJava.h:151: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newDoubleArray?
> rJava.h:152: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newIntArray?
> rJava.h:153: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newBooleanArrayI?
> rJava.h:154: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newString?
> rJava.h:155: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newCharArrayI?
> rJava.h:156: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newShortArrayI?
> rJava.h:157: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newFloatArrayD?
> rJava.h:158: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newLongArrayD?
> rJava.h:159: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newByteArray?
> rJava.h:160: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newByteArrayI?
> rJava.h:162: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?makeGlobal?
> rJava.h:163: error: expected ?)? before ?*? token
> rJava.h:164: error: expected ?)? before ?*? token
> rJava.h:166: error: expected ?)? before ?*? token
> rJava.h:168: error: expected ?)? before ?*? token
> rJava.h:170: error: expected ?)? before ?*? token
> Rglue.c: In function ?JRefObjectFinalizer?:
> Rglue.c:79: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:79: error: (Each undeclared identifier is reported only once
> Rglue.c:79: error: for each function it appears in.)
> Rglue.c:79: error: ?env? undeclared (first use in this function)
> Rglue.c:79: warning: implicit declaration of function ?getJNIEnv?
> Rglue.c:80: error: ?jobject? undeclared (first use in this function)
> Rglue.c:80: error: expected ?;? before ?o?
> Rglue.c:95: error: ?o? undeclared (first use in this function)
> Rglue.c:98: warning: implicit declaration of function ?releaseGlobal?
> Rglue.c: At top level:
> Rglue.c:104: error: expected ?)? before ?*? token
> Rglue.c: In function ?deserializeSEXP?:
> Rglue.c:151: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:151: error: ?env? undeclared (first use in this function)
> Rglue.c:152: error: ?clClassLoader? undeclared (first use in this function)
> Rglue.c:152: error: ?oClassLoader? undeclared (first use in this function)
> Rglue.c:153: error: ?jbyteArray? undeclared (first use in this function)
> Rglue.c:153: error: expected ?;? before ?ser?
> Rglue.c:154: error: ?ser? undeclared (first use in this function)
> Rglue.c:155: error: ?jmethodID? undeclared (first use in this function)
> Rglue.c:155: error: expected ?;? before ?mid?
> Rglue.c:156: error: ?mid? undeclared (first use in this function)
> Rglue.c:157: error: ?jobject? undeclared (first use in this function)
> Rglue.c:157: error: expected ?;? before ?res?
> Rglue.c:158: error: ?res? undeclared (first use in this function)
> Rglue.c:159: error: expected ?;? before ?go?
> Rglue.c:161: error: ?go? undeclared (first use in this function)
> Rglue.c:173: warning: implicit declaration of function ?releaseObject?
> Rglue.c: At top level:
> Rglue.c:214: error: expected ?)? before ?*? token
> Rglue.c:380: error: expected ?)? before ?*? token
> Rglue.c:390: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?R1par2jvalue?
> Rglue.c: In function ?RcallMethod?:
> Rglue.c:410: error: ?jvalue? undeclared (first use in this function)
> Rglue.c:410: error: expected ?;? before ?jpar?
> Rglue.c:411: error: ?jobject? undeclared (first use in this function)
> Rglue.c:411: error: expected ?;? before ?tmpo?
> Rglue.c:412: error: expected ?;? before ?o?
> Rglue.c:414: error: ?jmethodID? undeclared (first use in this function)
> Rglue.c:414: error: expected ?;? before ?mid?
> Rglue.c:415: error: ?jclass? undeclared (first use in this function)
> Rglue.c:415: error: expected ?;? before ?cls?
> Rglue.c:416: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:416: error: ?env? undeclared (first use in this function)
> Rglue.c:424: error: ?o? undeclared (first use in this function)
> Rglue.c:440: error: ?cls? undeclared (first use in this function)
> Rglue.c:440: warning: implicit declaration of function ?findClass?
> Rglue.c:442: warning: implicit declaration of function ?objectClass?
> Rglue.c:467: warning: implicit declaration of function ?Rpar2jvalue?
> Rglue.c:467: error: ?jpar? undeclared (first use in this function)
> Rglue.c:467: error: ?tmpo? undeclared (first use in this function)
> Rglue.c:471: error: ?mid? undeclared (first use in this function)
> Rglue.c:475: warning: implicit declaration of function ?checkExceptionsX?
> Rglue.c:481: warning: implicit declaration of function ?Rfreejpars?
> Rglue.c:542: error: ?jlong? undeclared (first use in this function)
> Rglue.c:542: error: expected ?;? before ?r?
> Rglue.c:546: error: ?r? undeclared (first use in this function)
> Rglue.c:555: error: ?jshort? undeclared (first use in this function)
> Rglue.c:555: error: expected ?;? before ?r?
> Rglue.c:568: error: ?jboolean? undeclared (first use in this function)
> Rglue.c:568: error: expected ?;? before ?r?
> Rglue.c:607: error: expected ?;? before ?r?
> Rglue.c:620: warning: implicit declaration of function ?j2SEXP?
> Rglue.c:620: warning: assignment makes pointer from integer without a cast
> Rglue.c: In function ?RcallSyncMethod?:
> Rglue.c:634: error: ?jobject? undeclared (first use in this function)
> Rglue.c:634: error: expected ?;? before ?o?
> Rglue.c:635: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:635: error: ?env? undeclared (first use in this function)
> Rglue.c:642: error: ?o? undeclared (first use in this function)
> Rglue.c:650: error: ?JNI_OK? undeclared (first use in this function)
> Rglue.c: In function ?RcreateObject?:
> Rglue.c:671: error: ?jvalue? undeclared (first use in this function)
> Rglue.c:671: error: expected ?;? before ?jpar?
> Rglue.c:672: error: ?jobject? undeclared (first use in this function)
> Rglue.c:672: error: expected ?;? before ?tmpo?
> Rglue.c:673: error: expected ?;? before ?o?
> Rglue.c:674: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:674: error: ?env? undeclared (first use in this function)
> Rglue.c:690: error: ?jpar? undeclared (first use in this function)
> Rglue.c:690: error: ?tmpo? undeclared (first use in this function)
> Rglue.c:704: error: ?o? undeclared (first use in this function)
> Rglue.c:704: warning: implicit declaration of function ?createObject?
> Rglue.c:723: warning: return makes pointer from integer without a cast
> Rglue.c: At top level:
> Rglue.c:727: error: expected ?)? before ?*? token
> Rglue.c:758: error: expected ?)? before ?*? token
> Rglue.c:770: error: expected ?)? before ?*? token
> Rglue.c: In function ?RcreateArray?:
> Rglue.c:786: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:786: error: ?env? undeclared (first use in this function)
> Rglue.c:793: error: ?jbyteArray? undeclared (first use in this function)
> Rglue.c:793: error: expected ?;? before ?a?
> Rglue.c:794: error: ?a? undeclared (first use in this function)
> Rglue.c:795: warning: implicit declaration of function ?new_jarrayRef?
> Rglue.c:795: warning: return makes pointer from integer without a cast
> Rglue.c:797: error: ?jcharArray? undeclared (first use in this function)
> Rglue.c:797: error: expected ?;? before ?a?
> Rglue.c:799: warning: return makes pointer from integer without a cast
> Rglue.c:801: error: ?jintArray? undeclared (first use in this function)
> Rglue.c:801: error: expected ?;? before ?a?
> Rglue.c:803: warning: return makes pointer from integer without a cast
> Rglue.c:809: error: ?jfloatArray? undeclared (first use in this function)
> Rglue.c:809: error: expected ?;? before ?a?
> Rglue.c:811: warning: return makes pointer from integer without a cast
> Rglue.c:813: error: ?jlongArray? undeclared (first use in this function)
> Rglue.c:813: error: expected ?;? before ?a?
> Rglue.c:815: warning: return makes pointer from integer without a cast
> Rglue.c:817: error: ?jdoubleArray? undeclared (first use in this function)
> Rglue.c:817: error: expected ?;? before ?a?
> Rglue.c:819: warning: return makes pointer from integer without a cast
> Rglue.c:824: error: ?jobjectArray? undeclared (first use in this function)
> Rglue.c:824: error: expected ?;? before ?a?
> Rglue.c:828: error: ?jobject? undeclared (first use in this function)
> Rglue.c:828: error: expected ?;? before ?so?
> Rglue.c:829: error: ?so? undeclared (first use in this function)
> Rglue.c:833: warning: return makes pointer from integer without a cast
> Rglue.c:838: error: ?jbooleanArray? undeclared (first use in this function)
> Rglue.c:838: error: expected ?;? before ?a?
> Rglue.c:840: warning: return makes pointer from integer without a cast
> Rglue.c:845: error: ?jclass? undeclared (first use in this function)
> Rglue.c:845: error: expected ?;? before ?ac?
> Rglue.c:861: error: ?ac? undeclared (first use in this function)
> Rglue.c:881: error: expected ?;? before ?a?
> Rglue.c:883: error: ?javaObjectClass? undeclared (first use in this function)
> Rglue.c:888: error: expected ?;? before ?o?
> Rglue.c:893: error: ?o? undeclared (first use in this function)
> Rglue.c:899: warning: return makes pointer from integer without a cast
> Rglue.c:904: error: expected ?;? before ?a?
> Rglue.c:906: warning: return makes pointer from integer without a cast
> Rglue.c: In function ?RpollException?:
> Rglue.c:916: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:916: error: ?env? undeclared (first use in this function)
> Rglue.c:917: error: ?jthrowable? undeclared (first use in this function)
> Rglue.c:917: error: expected ?;? before ?t?
> Rglue.c:919: error: ?t? undeclared (first use in this function)
> Rglue.c: In function ?RclearException?:
> Rglue.c:927: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:927: error: ?env? undeclared (first use in this function)
> Rglue.c: In function ?RthrowException?:
> Rglue.c:948: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:948: error: ?env? undeclared (first use in this function)
> Rglue.c:949: error: ?jthrowable? undeclared (first use in this function)
> Rglue.c:949: error: expected ?;? before ?t?
> Rglue.c:960: error: ?t? undeclared (first use in this function)
> make: *** [Rglue.o] Error 1
> ERROR: compilation failed for package ?rJava?
> * Removing ?/usr/local/lib/R/site-library/rJava?
> * Restoring previous ?/usr/local/lib/R/site-library/rJava?
>
> The downloaded packages are in
> ? ? ? ??/tmp/Rtmp0D1hWd/downloaded_packages?
> Warning message:
> In install.packages("rJava") :
> ?installation of package 'rJava' had non-zero exit status
>> q()
> Save workspace image? [y/n/c]: n
> mkimpel-debian-xps:/usr/lib/jvm/java-6-sun/include# R
>
> R version 2.7.1 (2008-06-23)
> Copyright (C) 2008 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
> ?Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
>
>> install.packages('rJava')
> Warning in install.packages("rJava") :
> ?argument 'lib' is missing: using '/usr/local/lib/R/site-library'
> --- Please select a CRAN mirror for use in this session ---
> Loading Tcl/Tk interface ... done
> trying URL 'http://cran.fhcrc.org/src/contrib/rJava_0.6-3.tar.gz'
> Content type 'application/x-gzip' length 240527 bytes (234 Kb)
> opened URL
> ==================================================
> downloaded 234 Kb
>
> * Installing *source* package 'rJava' ...
> checking for gcc... gcc -std=gnu99
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc -std=gnu99 accepts -g... yes
> checking for gcc -std=gnu99 option to accept ISO C89... none needed
> checking how to run the C preprocessor... gcc -std=gnu99 -E
> checking for grep that handles long lines and -e... /bin/grep
> checking for egrep... /bin/grep -E
> checking for ANSI C header files... yes
> checking for sys/wait.h that is POSIX.1 compatible... yes
> checking for sys/types.h... yes
> checking for sys/stat.h... yes
> checking for stdlib.h... yes
> checking for string.h... yes
> checking for memory.h... yes
> checking for strings.h... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for unistd.h... yes
> checking for string.h... (cached) yes
> checking sys/time.h usability... yes
> checking sys/time.h presence... yes
> checking for sys/time.h... yes
> checking for unistd.h... (cached) yes
> checking for an ANSI C-conforming const... yes
> checking whether time.h and sys/time.h may both be included... yes
> configure: checking whether gcc -std=gnu99 supports static inline...
> yes
> checking Java support in R... present:
> interpreter : '/usr/bin/java'
> archiver ? ?: '/usr/bin/jar'
> compiler ? ?: '/usr/bin/javac'
> header prep.: '/usr/bin/javah'
> cpp flags ? : '-I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux'
> java libs ? : '-L$(JAVA_HOME)/lib/amd64/server
> -L$(JAVA_HOME)/lib/amd64 -L$(JAVA_HOME)/../lib/amd64 -L
> -L/usr/java/packages/lib/amd64 -L/lib -L/usr/lib -ljvm'
> checking whether JNI programs can be compiled... yes
> checking JNI data types... ok
> checking whether JRI should be compiled (autodetect)... yes
> checking whether debugging output should be enabled... no
> checking whether memory profiling is desired... no
> checking whether threads support is requested... no
> checking whether callbacks support is requested... no
> checking whether JNI cache support is requested... no
> checking whether JRI is requested... yes
> configure: creating ./config.status
> config.status: creating src/Makevars
> config.status: creating R/zzz.R
> config.status: creating src/config.h
> === configuring in jri (/tmp/R.INSTALL.bELNGf/rJava/jri)
> configure: running /bin/sh ./configure '--prefix=/usr/local'
> --cache-file=/dev/null --srcdir=.
> checking build system type... x86_64-unknown-linux-gnu
> checking host system type... x86_64-unknown-linux-gnu
> checking for gcc... gcc -std=gnu99
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc -std=gnu99 accepts -g... yes
> checking for gcc -std=gnu99 option to accept ISO C89... none needed
> checking how to run the C preprocessor... gcc -std=gnu99 -E
> checking for grep that handles long lines and -e... /bin/grep
> checking for egrep... /bin/grep -E
> checking for ANSI C header files... yes
> checking whether Java interpreter works... checking whether JNI
> programs can be compiled... yes
> checking whether JNI programs can be run... yes
> checking JNI data types... ok
> checking whether Rinterface.h exports R_CStackXXX variables... yes
> checking whether Rinterface.h exports R_SignalHandlers... yes
> configure: creating ./config.status
> config.status: creating src/Makefile
> config.status: creating Makefile
> config.status: creating run
> config.status: creating src/config.h
> ** libs
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c arrayc.c -o arrayc.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c callback.c -o callback.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c callJNI.c -o callJNI.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c fields.c -o fields.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c init.c -o init.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c jri_glue.c -o jri_glue.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c loader.c -o loader.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c Rglue.c -o Rglue.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c rJava.c -o rJava.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c tools.c -o tools.o
> gcc -std=gnu99 -shared ?-o rJava.so arrayc.o callback.o callJNI.o
> fields.o init.o jri_glue.o loader.o Rglue.o rJava.o tools.o
> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/amd64/server
> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/amd64
> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../lib/amd64 -L
> -L/usr/java/packages/lib/amd64 -L/lib -L/usr/lib -ljvm
> -L/usr/lib64/R/lib -lR
> make -C ../jri/
> make[1]: Entering directory `/tmp/R.INSTALL.bELNGf/rJava/jri'
> make -C src JRI.jar
> make[2]: Entering directory `/tmp/R.INSTALL.bELNGf/rJava/jri/src'
> /usr/bin/javac -target 1.4 -source 1.4 -d . ../Mutex.java
> ../RBool.java ../RConsoleOutputStream.java ../Rengine.java
> ../REXP.java ../RFactor.java ../RList.java ../RMainLoopCallbacks.java
> ../RVector.java
> /usr/bin/javah -d . -classpath . org.rosuda.JRI.Rengine
> gcc -std=gnu99 -c -o Rengine.o Rengine.c -g -Iinclude
> -DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
> -I/usr/share/R/include -I/usr/share/R/include -I/usr/share/R/include
> gcc -std=gnu99 -c -o jri.o jri.c -g -Iinclude ?-DRIF_HAS_CSTACK
> -DRIF_HAS_RSIGHAND -g -O2
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
> -I/usr/share/R/include -I/usr/share/R/include -I/usr/share/R/include
> jri.c: In function ?jri_getObjectArray?:
> jri.c:303: warning: cast from pointer to integer of different size
> gcc -std=gnu99 -c -o Rcallbacks.o Rcallbacks.c -g -Iinclude
> -DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
> -I/usr/share/R/include -I/usr/share/R/include -I/usr/share/R/include
> gcc -std=gnu99 -c -o Rinit.o Rinit.c -g -Iinclude ?-DRIF_HAS_CSTACK
> -DRIF_HAS_RSIGHAND -g -O2
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
> -I/usr/share/R/include -I/usr/share/R/include -I/usr/share/R/include
> gcc -std=gnu99 -c -o globals.o globals.c -g -Iinclude
> -DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
> gcc -std=gnu99 -c -o rjava.o rjava.c -g -Iinclude ?-DRIF_HAS_CSTACK
> -DRIF_HAS_RSIGHAND -g -O2
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
> gcc -std=gnu99 -o libjri.so Rengine.o jri.o Rcallbacks.o Rinit.o
> globals.o rjava.o ?-shared
> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/amd64/server
> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/amd64
> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../lib/amd64 -L
> -L/usr/java/packages/lib/amd64 -L/lib -L/usr/lib -ljvm
> -L/usr/lib64/R/lib -lR
> /usr/bin/javac -target 1.4 -source 1.4 -d . ../Mutex.java
> ../RBool.java ../RConsoleOutputStream.java ../Rengine.java
> ../REXP.java ../RFactor.java ../RList.java ../RMainLoopCallbacks.java
> ../RVector.java
> /usr/bin/jar fc JRI.jar org libjri.so
> make[2]: Leaving directory `/tmp/R.INSTALL.bELNGf/rJava/jri/src'
> rm -f libjri.so
> cp src/libjri.so libjri.so
> /usr/bin/javac -target 1.4 -source 1.4 -classpath src/JRI.jar -d
> examples examples/rtest2.java
> Note: examples/rtest2.java uses or overrides a deprecated API.
> Note: Recompile with -Xlint:deprecation for details.
> /usr/bin/javac -target 1.4 -source 1.4 -classpath src/JRI.jar -d
> examples examples/rtest.java
> Note: examples/rtest.java uses or overrides a deprecated API.
> Note: Recompile with -Xlint:deprecation for details.
> make[1]: Leaving directory `/tmp/R.INSTALL.bELNGf/rJava/jri'
> ** R
> ** inst
> ** preparing package for lazy loading
> ** help
> ?>>> Building/Updating help pages for package 'rJava'
> ? ? Formats: text html latex example
> ?accessOp ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?jarray ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?jarrayRef-class ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex
> ?jcall ? ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
> ?jcast ? ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
> ?jcastToArray ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?jcheck ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?jengine ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
> ?jequals ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
> ?jfield ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?jfloat-class ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex
> ?jfloat ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex
> ?jinit ? ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
> ?jmemprof ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?jnew ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?jnull ? ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
> ?jobjRef-class ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex
> ?jpackage ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?jreflection ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
> ?jserialize ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex
> ?jsimplify ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
> ?loader ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?show ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex
> ** building package indices ...
> * DONE (rJava)
>
> The downloaded packages are in
> ? ? ? ?/tmp/RtmplOpZ4F/downloaded_packages
>> q()
> Save workspace image? [y/n/c]: n
> mkimpel-debian-xps:/usr/lib/jvm/java-6-sun/include#
> ------------------------------------------------------------
> Mark W. Kimpel MD ?** Neuroinformatics ** Dept. of Psychiatry
> Indiana University School of Medicine
>
> 15032 Hunter Court, Westfield, IN ?46074
>
> (317) 490-5129 Work, & Mobile & VoiceMail
>
> "The real problem is not whether machines think but whether men do."
> -- B. F. Skinner
> ******************************************************************
>


From aseila at gmail.com  Wed Jul 15 19:25:16 2009
From: aseila at gmail.com (aseila at gmail.com)
Date: Wed, 15 Jul 2009 19:25:16 +0200 (CEST)
Subject: [Rd] dir.create not working correctly under Solaris (PR#13834)
Message-ID: <20090715172516.6399C282BE84@mail.pubhealth.ku.dk>

Full_Name: Andy Seila
Version: 2.9.1-patched
OS: Solaris 10 x86
Submission from: (NULL) (66.156.94.118)


When compiling R under a user's home directory that is mounted by the
automounter, R cannot create directories using dir.create() with
"recursive=TRUE".  This causes the build to exit with an error when attempting
to install package VR.  If R is built and installed under a user's home
directory that is automounted, additional packages cannot be installed using "R
CMD INSTALL" because the R script calls dir.create() with "recursive=TRUE).

Here is some output with R-patched_2009-07-06: (The working directory is
/home/andy/temp)

> dir.create("/home/andy/temp/bob", recursive=TRUE)
Warning message:
In dir.create("/home/andy/temp/bob", recursive = TRUE) :
  cannot create dir '/home/andy', reason 'Operation not applicable'
> system("ls")
> dir.create("/home/andy/temp/bob/bill", recursive=TRUE)
Warning message:
In dir.create("/home/andy/temp/bob/bill", recursive = TRUE) :
  cannot create dir '/home/andy', reason 'Operation not applicable'
> system("ls")
> dir.create("/home/andy/temp/bob", recursive=FALSE)
> system("ls")
bob
> dir.create("/home/andy/temp/bob/bill", recursive=FALSE)
> system("ls bob")
bill
> system("rm -rf bob")
> system("ls")
> dir.create("bob", recursive=TRUE)
> system("ls")
bob
> system("rm -rf bob")
> dir.create("bob/bill", recursive=TRUE)
> system("ls")
bob
> system("ls bob")
bill

A workaround is to build and install R under directories that are not
automounted.  If the directory /export/home/<user> is mounted on /home/<user>,
another solution is to cd to /export/home/<user> before building R.  However,
many systems automount a directory accessed through nfs and this workaround is
not an option.  Regardless, if R is installed under /home/<user> and
/home/<user> is automounted, additional packages cannot be installed.


From josh.m.ulrich at gmail.com  Wed Jul 15 21:13:43 2009
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 15 Jul 2009 14:13:43 -0500
Subject: [Rd] rJava fails compilation on R-2.9.1 but not R-2.7.1 on
	Debian Lenny
In-Reply-To: <6b93d1830907151146q506e937fxd4d31cc7d01c2ea3@mail.gmail.com>
References: <6b93d1830907151146q506e937fxd4d31cc7d01c2ea3@mail.gmail.com>
Message-ID: <8cca69990907151213v440b7046r883d5aff5ea2aad1@mail.gmail.com>

Hi Mark,

The first thing that jumps out to me is that 2.7.1 compiles JRI, while
2.9.1 does not (for some reason, autodetect decides not to compile).

HTH,
Josh
--
http://www.fosstrading.com



On Wed, Jul 15, 2009 at 1:46 PM, Mark Kimpel<mwkimpel at gmail.com> wrote:
> I have been futzing around for days tying to get rJava to install on
> my freshly build Debian Lenny installation. I have R-2.9.1 installed
> from source in my R_HOME directory and R-2.7.1 installed via apt-get
> install r-recommended. I was tried many different things, but by
> accident started up R-2.7.1 as root and viola, successful install. I
> immediately exited out of R-2.7.1 and started R-2.9.1 as root and
> compilation fails. The file
>
> The output is voluminous, but is included below. I had originally
> thought that my problem had to do with setting environmental
> variables, but now it seems not.
>
> Thanks,
> Mark
>
> mkimpel-debian-xps /usr/lib/jvm/java-6-sun/include: su root
> Password:
> mkimpel-debian-xps:/usr/lib/jvm/java-6-sun/include#
> /home/mkimpel/R_HOME/R-2.9.1/R-build/bin/R
> WARNING: ignoring environment value of R_HOME
>
> R version 2.9.1 (2009-06-26)
> Copyright (C) 2009 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
> ?Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
>
>> install.packages('rJava')
> Warning in install.packages("rJava") :
> ?argument 'lib' is missing: using '/usr/local/lib/R/site-library'
> --- Please select a CRAN mirror for use in this session ---
> Loading Tcl/Tk interface ... done
> trying URL 'http://cran.fhcrc.org/src/contrib/rJava_0.6-3.tar.gz'
> Content type 'application/x-gzip' length 240527 bytes (234 Kb)
> opened URL
> ==================================================
> downloaded 234 Kb
>
> * Installing *source* package ?rJava? ...
> checking for gcc... gcc -std=gnu99
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc -std=gnu99 accepts -g... yes
> checking for gcc -std=gnu99 option to accept ISO C89... none needed
> checking how to run the C preprocessor... gcc -std=gnu99 -E
> checking for grep that handles long lines and -e... /bin/grep
> checking for egrep... /bin/grep -E
> checking for ANSI C header files... yes
> checking for sys/wait.h that is POSIX.1 compatible... yes
> checking for sys/types.h... yes
> checking for sys/stat.h... yes
> checking for stdlib.h... yes
> checking for string.h... yes
> checking for memory.h... yes
> checking for strings.h... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for unistd.h... yes
> checking for string.h... (cached) yes
> checking sys/time.h usability... yes
> checking sys/time.h presence... yes
> checking for sys/time.h... yes
> checking for unistd.h... (cached) yes
> checking for an ANSI C-conforming const... yes
> checking whether time.h and sys/time.h may both be included... yes
> configure: checking whether gcc -std=gnu99 supports static inline...
> yes
> checking Java support in R... present:
> interpreter : '/usr/bin/java'
> archiver ? ?: '/usr/bin/jar'
> compiler ? ?: '/usr/bin/javac'
> header prep.: '/usr/bin/javah'
> cpp flags ? : '-I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux'
> java libs ? : '-L$(JAVA_HOME)/lib/amd64/server
> -L$(JAVA_HOME)/lib/amd64 -L$(JAVA_HOME)/../lib/amd64 -L
> -L/usr/java/packages/lib/amd64 -L/lib -L/usr/lib -ljvm'
> checking whether JNI programs can be compiled... yes
> checking JNI data types... ok
> checking whether JRI should be compiled (autodetect)... no
> checking whether debugging output should be enabled... no
> checking whether memory profiling is desired... no
> checking whether threads support is requested... no
> checking whether callbacks support is requested... no
> checking whether JNI cache support is requested... no
> checking whether JRI is requested... no
> configure: creating ./config.status
> config.status: creating src/Makevars
> config.status: creating R/zzz.R
> config.status: creating src/config.h
> ** libs
> gcc -std=gnu99 -I/home/mkimpel/R_HOME/R-2.9.1/R-build/lib64/R/include
> -I. -I/usr/lib/jvm/java-1.5.0-gcj-4.3-1.5.0.0/jre/../include
> -I/usr/lib/jvm/java-1.5.0-gcj-4.3-1.5.0.0/jre/../include/linux
> -I/usr/local/include ? ?-fpic ?-g -O2 -c Rglue.c -o Rglue.o
> In file included from Rglue.c:2:
> rJava.h:17:17: error: jni.h: No such file or directory
> In file included from Rglue.c:2:
> rJava.h:115: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?*? token
> rJava.h:117: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?*? token
> rJava.h:120: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?*? token
> rJava.h:122: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?javaStringClass?
> rJava.h:123: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?javaObjectClass?
> rJava.h:124: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?javaClassClass?
> rJava.h:125: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?javaFieldClass?
> rJava.h:127: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?mid_forName?
> rJava.h:128: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?mid_getName?
> rJava.h:129: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?mid_getType?
> rJava.h:130: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?mid_getField?
> rJava.h:133: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?clClassLoader?
> rJava.h:134: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?oClassLoader?
> rJava.h:137: error: expected ?)? before ?*? token
> rJava.h:138: error: expected ?)? before ?*? token
> rJava.h:139: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?R1par2jvalue?
> rJava.h:144: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?callToString?
> rJava.h:147: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?createObject?
> rJava.h:148: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?findClass?
> rJava.h:149: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?objectClass?
> rJava.h:151: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newDoubleArray?
> rJava.h:152: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newIntArray?
> rJava.h:153: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newBooleanArrayI?
> rJava.h:154: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newString?
> rJava.h:155: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newCharArrayI?
> rJava.h:156: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newShortArrayI?
> rJava.h:157: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newFloatArrayD?
> rJava.h:158: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newLongArrayD?
> rJava.h:159: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newByteArray?
> rJava.h:160: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?newByteArrayI?
> rJava.h:162: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?makeGlobal?
> rJava.h:163: error: expected ?)? before ?*? token
> rJava.h:164: error: expected ?)? before ?*? token
> rJava.h:166: error: expected ?)? before ?*? token
> rJava.h:168: error: expected ?)? before ?*? token
> rJava.h:170: error: expected ?)? before ?*? token
> Rglue.c: In function ?JRefObjectFinalizer?:
> Rglue.c:79: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:79: error: (Each undeclared identifier is reported only once
> Rglue.c:79: error: for each function it appears in.)
> Rglue.c:79: error: ?env? undeclared (first use in this function)
> Rglue.c:79: warning: implicit declaration of function ?getJNIEnv?
> Rglue.c:80: error: ?jobject? undeclared (first use in this function)
> Rglue.c:80: error: expected ?;? before ?o?
> Rglue.c:95: error: ?o? undeclared (first use in this function)
> Rglue.c:98: warning: implicit declaration of function ?releaseGlobal?
> Rglue.c: At top level:
> Rglue.c:104: error: expected ?)? before ?*? token
> Rglue.c: In function ?deserializeSEXP?:
> Rglue.c:151: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:151: error: ?env? undeclared (first use in this function)
> Rglue.c:152: error: ?clClassLoader? undeclared (first use in this function)
> Rglue.c:152: error: ?oClassLoader? undeclared (first use in this function)
> Rglue.c:153: error: ?jbyteArray? undeclared (first use in this function)
> Rglue.c:153: error: expected ?;? before ?ser?
> Rglue.c:154: error: ?ser? undeclared (first use in this function)
> Rglue.c:155: error: ?jmethodID? undeclared (first use in this function)
> Rglue.c:155: error: expected ?;? before ?mid?
> Rglue.c:156: error: ?mid? undeclared (first use in this function)
> Rglue.c:157: error: ?jobject? undeclared (first use in this function)
> Rglue.c:157: error: expected ?;? before ?res?
> Rglue.c:158: error: ?res? undeclared (first use in this function)
> Rglue.c:159: error: expected ?;? before ?go?
> Rglue.c:161: error: ?go? undeclared (first use in this function)
> Rglue.c:173: warning: implicit declaration of function ?releaseObject?
> Rglue.c: At top level:
> Rglue.c:214: error: expected ?)? before ?*? token
> Rglue.c:380: error: expected ?)? before ?*? token
> Rglue.c:390: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
> before ?R1par2jvalue?
> Rglue.c: In function ?RcallMethod?:
> Rglue.c:410: error: ?jvalue? undeclared (first use in this function)
> Rglue.c:410: error: expected ?;? before ?jpar?
> Rglue.c:411: error: ?jobject? undeclared (first use in this function)
> Rglue.c:411: error: expected ?;? before ?tmpo?
> Rglue.c:412: error: expected ?;? before ?o?
> Rglue.c:414: error: ?jmethodID? undeclared (first use in this function)
> Rglue.c:414: error: expected ?;? before ?mid?
> Rglue.c:415: error: ?jclass? undeclared (first use in this function)
> Rglue.c:415: error: expected ?;? before ?cls?
> Rglue.c:416: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:416: error: ?env? undeclared (first use in this function)
> Rglue.c:424: error: ?o? undeclared (first use in this function)
> Rglue.c:440: error: ?cls? undeclared (first use in this function)
> Rglue.c:440: warning: implicit declaration of function ?findClass?
> Rglue.c:442: warning: implicit declaration of function ?objectClass?
> Rglue.c:467: warning: implicit declaration of function ?Rpar2jvalue?
> Rglue.c:467: error: ?jpar? undeclared (first use in this function)
> Rglue.c:467: error: ?tmpo? undeclared (first use in this function)
> Rglue.c:471: error: ?mid? undeclared (first use in this function)
> Rglue.c:475: warning: implicit declaration of function ?checkExceptionsX?
> Rglue.c:481: warning: implicit declaration of function ?Rfreejpars?
> Rglue.c:542: error: ?jlong? undeclared (first use in this function)
> Rglue.c:542: error: expected ?;? before ?r?
> Rglue.c:546: error: ?r? undeclared (first use in this function)
> Rglue.c:555: error: ?jshort? undeclared (first use in this function)
> Rglue.c:555: error: expected ?;? before ?r?
> Rglue.c:568: error: ?jboolean? undeclared (first use in this function)
> Rglue.c:568: error: expected ?;? before ?r?
> Rglue.c:607: error: expected ?;? before ?r?
> Rglue.c:620: warning: implicit declaration of function ?j2SEXP?
> Rglue.c:620: warning: assignment makes pointer from integer without a cast
> Rglue.c: In function ?RcallSyncMethod?:
> Rglue.c:634: error: ?jobject? undeclared (first use in this function)
> Rglue.c:634: error: expected ?;? before ?o?
> Rglue.c:635: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:635: error: ?env? undeclared (first use in this function)
> Rglue.c:642: error: ?o? undeclared (first use in this function)
> Rglue.c:650: error: ?JNI_OK? undeclared (first use in this function)
> Rglue.c: In function ?RcreateObject?:
> Rglue.c:671: error: ?jvalue? undeclared (first use in this function)
> Rglue.c:671: error: expected ?;? before ?jpar?
> Rglue.c:672: error: ?jobject? undeclared (first use in this function)
> Rglue.c:672: error: expected ?;? before ?tmpo?
> Rglue.c:673: error: expected ?;? before ?o?
> Rglue.c:674: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:674: error: ?env? undeclared (first use in this function)
> Rglue.c:690: error: ?jpar? undeclared (first use in this function)
> Rglue.c:690: error: ?tmpo? undeclared (first use in this function)
> Rglue.c:704: error: ?o? undeclared (first use in this function)
> Rglue.c:704: warning: implicit declaration of function ?createObject?
> Rglue.c:723: warning: return makes pointer from integer without a cast
> Rglue.c: At top level:
> Rglue.c:727: error: expected ?)? before ?*? token
> Rglue.c:758: error: expected ?)? before ?*? token
> Rglue.c:770: error: expected ?)? before ?*? token
> Rglue.c: In function ?RcreateArray?:
> Rglue.c:786: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:786: error: ?env? undeclared (first use in this function)
> Rglue.c:793: error: ?jbyteArray? undeclared (first use in this function)
> Rglue.c:793: error: expected ?;? before ?a?
> Rglue.c:794: error: ?a? undeclared (first use in this function)
> Rglue.c:795: warning: implicit declaration of function ?new_jarrayRef?
> Rglue.c:795: warning: return makes pointer from integer without a cast
> Rglue.c:797: error: ?jcharArray? undeclared (first use in this function)
> Rglue.c:797: error: expected ?;? before ?a?
> Rglue.c:799: warning: return makes pointer from integer without a cast
> Rglue.c:801: error: ?jintArray? undeclared (first use in this function)
> Rglue.c:801: error: expected ?;? before ?a?
> Rglue.c:803: warning: return makes pointer from integer without a cast
> Rglue.c:809: error: ?jfloatArray? undeclared (first use in this function)
> Rglue.c:809: error: expected ?;? before ?a?
> Rglue.c:811: warning: return makes pointer from integer without a cast
> Rglue.c:813: error: ?jlongArray? undeclared (first use in this function)
> Rglue.c:813: error: expected ?;? before ?a?
> Rglue.c:815: warning: return makes pointer from integer without a cast
> Rglue.c:817: error: ?jdoubleArray? undeclared (first use in this function)
> Rglue.c:817: error: expected ?;? before ?a?
> Rglue.c:819: warning: return makes pointer from integer without a cast
> Rglue.c:824: error: ?jobjectArray? undeclared (first use in this function)
> Rglue.c:824: error: expected ?;? before ?a?
> Rglue.c:828: error: ?jobject? undeclared (first use in this function)
> Rglue.c:828: error: expected ?;? before ?so?
> Rglue.c:829: error: ?so? undeclared (first use in this function)
> Rglue.c:833: warning: return makes pointer from integer without a cast
> Rglue.c:838: error: ?jbooleanArray? undeclared (first use in this function)
> Rglue.c:838: error: expected ?;? before ?a?
> Rglue.c:840: warning: return makes pointer from integer without a cast
> Rglue.c:845: error: ?jclass? undeclared (first use in this function)
> Rglue.c:845: error: expected ?;? before ?ac?
> Rglue.c:861: error: ?ac? undeclared (first use in this function)
> Rglue.c:881: error: expected ?;? before ?a?
> Rglue.c:883: error: ?javaObjectClass? undeclared (first use in this function)
> Rglue.c:888: error: expected ?;? before ?o?
> Rglue.c:893: error: ?o? undeclared (first use in this function)
> Rglue.c:899: warning: return makes pointer from integer without a cast
> Rglue.c:904: error: expected ?;? before ?a?
> Rglue.c:906: warning: return makes pointer from integer without a cast
> Rglue.c: In function ?RpollException?:
> Rglue.c:916: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:916: error: ?env? undeclared (first use in this function)
> Rglue.c:917: error: ?jthrowable? undeclared (first use in this function)
> Rglue.c:917: error: expected ?;? before ?t?
> Rglue.c:919: error: ?t? undeclared (first use in this function)
> Rglue.c: In function ?RclearException?:
> Rglue.c:927: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:927: error: ?env? undeclared (first use in this function)
> Rglue.c: In function ?RthrowException?:
> Rglue.c:948: error: ?JNIEnv? undeclared (first use in this function)
> Rglue.c:948: error: ?env? undeclared (first use in this function)
> Rglue.c:949: error: ?jthrowable? undeclared (first use in this function)
> Rglue.c:949: error: expected ?;? before ?t?
> Rglue.c:960: error: ?t? undeclared (first use in this function)
> make: *** [Rglue.o] Error 1
> ERROR: compilation failed for package ?rJava?
> * Removing ?/usr/local/lib/R/site-library/rJava?
> * Restoring previous ?/usr/local/lib/R/site-library/rJava?
>
> The downloaded packages are in
> ? ? ? ??/tmp/Rtmp0D1hWd/downloaded_packages?
> Warning message:
> In install.packages("rJava") :
> ?installation of package 'rJava' had non-zero exit status
>> q()
> Save workspace image? [y/n/c]: n
> mkimpel-debian-xps:/usr/lib/jvm/java-6-sun/include# R
>
> R version 2.7.1 (2008-06-23)
> Copyright (C) 2008 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
> ?Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
>
>> install.packages('rJava')
> Warning in install.packages("rJava") :
> ?argument 'lib' is missing: using '/usr/local/lib/R/site-library'
> --- Please select a CRAN mirror for use in this session ---
> Loading Tcl/Tk interface ... done
> trying URL 'http://cran.fhcrc.org/src/contrib/rJava_0.6-3.tar.gz'
> Content type 'application/x-gzip' length 240527 bytes (234 Kb)
> opened URL
> ==================================================
> downloaded 234 Kb
>
> * Installing *source* package 'rJava' ...
> checking for gcc... gcc -std=gnu99
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc -std=gnu99 accepts -g... yes
> checking for gcc -std=gnu99 option to accept ISO C89... none needed
> checking how to run the C preprocessor... gcc -std=gnu99 -E
> checking for grep that handles long lines and -e... /bin/grep
> checking for egrep... /bin/grep -E
> checking for ANSI C header files... yes
> checking for sys/wait.h that is POSIX.1 compatible... yes
> checking for sys/types.h... yes
> checking for sys/stat.h... yes
> checking for stdlib.h... yes
> checking for string.h... yes
> checking for memory.h... yes
> checking for strings.h... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for unistd.h... yes
> checking for string.h... (cached) yes
> checking sys/time.h usability... yes
> checking sys/time.h presence... yes
> checking for sys/time.h... yes
> checking for unistd.h... (cached) yes
> checking for an ANSI C-conforming const... yes
> checking whether time.h and sys/time.h may both be included... yes
> configure: checking whether gcc -std=gnu99 supports static inline...
> yes
> checking Java support in R... present:
> interpreter : '/usr/bin/java'
> archiver ? ?: '/usr/bin/jar'
> compiler ? ?: '/usr/bin/javac'
> header prep.: '/usr/bin/javah'
> cpp flags ? : '-I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux'
> java libs ? : '-L$(JAVA_HOME)/lib/amd64/server
> -L$(JAVA_HOME)/lib/amd64 -L$(JAVA_HOME)/../lib/amd64 -L
> -L/usr/java/packages/lib/amd64 -L/lib -L/usr/lib -ljvm'
> checking whether JNI programs can be compiled... yes
> checking JNI data types... ok
> checking whether JRI should be compiled (autodetect)... yes
> checking whether debugging output should be enabled... no
> checking whether memory profiling is desired... no
> checking whether threads support is requested... no
> checking whether callbacks support is requested... no
> checking whether JNI cache support is requested... no
> checking whether JRI is requested... yes
> configure: creating ./config.status
> config.status: creating src/Makevars
> config.status: creating R/zzz.R
> config.status: creating src/config.h
> === configuring in jri (/tmp/R.INSTALL.bELNGf/rJava/jri)
> configure: running /bin/sh ./configure '--prefix=/usr/local'
> --cache-file=/dev/null --srcdir=.
> checking build system type... x86_64-unknown-linux-gnu
> checking host system type... x86_64-unknown-linux-gnu
> checking for gcc... gcc -std=gnu99
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc -std=gnu99 accepts -g... yes
> checking for gcc -std=gnu99 option to accept ISO C89... none needed
> checking how to run the C preprocessor... gcc -std=gnu99 -E
> checking for grep that handles long lines and -e... /bin/grep
> checking for egrep... /bin/grep -E
> checking for ANSI C header files... yes
> checking whether Java interpreter works... checking whether JNI
> programs can be compiled... yes
> checking whether JNI programs can be run... yes
> checking JNI data types... ok
> checking whether Rinterface.h exports R_CStackXXX variables... yes
> checking whether Rinterface.h exports R_SignalHandlers... yes
> configure: creating ./config.status
> config.status: creating src/Makefile
> config.status: creating Makefile
> config.status: creating run
> config.status: creating src/config.h
> ** libs
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c arrayc.c -o arrayc.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c callback.c -o callback.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c callJNI.c -o callJNI.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c fields.c -o fields.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c init.c -o init.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c jri_glue.c -o jri_glue.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c loader.c -o loader.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c Rglue.c -o Rglue.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c rJava.c -o rJava.o
> gcc -std=gnu99 -I/usr/share/R/include -I.
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
> -O2 -c tools.c -o tools.o
> gcc -std=gnu99 -shared ?-o rJava.so arrayc.o callback.o callJNI.o
> fields.o init.o jri_glue.o loader.o Rglue.o rJava.o tools.o
> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/amd64/server
> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/amd64
> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../lib/amd64 -L
> -L/usr/java/packages/lib/amd64 -L/lib -L/usr/lib -ljvm
> -L/usr/lib64/R/lib -lR
> make -C ../jri/
> make[1]: Entering directory `/tmp/R.INSTALL.bELNGf/rJava/jri'
> make -C src JRI.jar
> make[2]: Entering directory `/tmp/R.INSTALL.bELNGf/rJava/jri/src'
> /usr/bin/javac -target 1.4 -source 1.4 -d . ../Mutex.java
> ../RBool.java ../RConsoleOutputStream.java ../Rengine.java
> ../REXP.java ../RFactor.java ../RList.java ../RMainLoopCallbacks.java
> ../RVector.java
> /usr/bin/javah -d . -classpath . org.rosuda.JRI.Rengine
> gcc -std=gnu99 -c -o Rengine.o Rengine.c -g -Iinclude
> -DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
> -I/usr/share/R/include -I/usr/share/R/include -I/usr/share/R/include
> gcc -std=gnu99 -c -o jri.o jri.c -g -Iinclude ?-DRIF_HAS_CSTACK
> -DRIF_HAS_RSIGHAND -g -O2
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
> -I/usr/share/R/include -I/usr/share/R/include -I/usr/share/R/include
> jri.c: In function ?jri_getObjectArray?:
> jri.c:303: warning: cast from pointer to integer of different size
> gcc -std=gnu99 -c -o Rcallbacks.o Rcallbacks.c -g -Iinclude
> -DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
> -I/usr/share/R/include -I/usr/share/R/include -I/usr/share/R/include
> gcc -std=gnu99 -c -o Rinit.o Rinit.c -g -Iinclude ?-DRIF_HAS_CSTACK
> -DRIF_HAS_RSIGHAND -g -O2
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
> -I/usr/share/R/include -I/usr/share/R/include -I/usr/share/R/include
> gcc -std=gnu99 -c -o globals.o globals.c -g -Iinclude
> -DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
> gcc -std=gnu99 -c -o rjava.o rjava.c -g -Iinclude ?-DRIF_HAS_CSTACK
> -DRIF_HAS_RSIGHAND -g -O2
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
> gcc -std=gnu99 -o libjri.so Rengine.o jri.o Rcallbacks.o Rinit.o
> globals.o rjava.o ?-shared
> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/amd64/server
> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/amd64
> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../lib/amd64 -L
> -L/usr/java/packages/lib/amd64 -L/lib -L/usr/lib -ljvm
> -L/usr/lib64/R/lib -lR
> /usr/bin/javac -target 1.4 -source 1.4 -d . ../Mutex.java
> ../RBool.java ../RConsoleOutputStream.java ../Rengine.java
> ../REXP.java ../RFactor.java ../RList.java ../RMainLoopCallbacks.java
> ../RVector.java
> /usr/bin/jar fc JRI.jar org libjri.so
> make[2]: Leaving directory `/tmp/R.INSTALL.bELNGf/rJava/jri/src'
> rm -f libjri.so
> cp src/libjri.so libjri.so
> /usr/bin/javac -target 1.4 -source 1.4 -classpath src/JRI.jar -d
> examples examples/rtest2.java
> Note: examples/rtest2.java uses or overrides a deprecated API.
> Note: Recompile with -Xlint:deprecation for details.
> /usr/bin/javac -target 1.4 -source 1.4 -classpath src/JRI.jar -d
> examples examples/rtest.java
> Note: examples/rtest.java uses or overrides a deprecated API.
> Note: Recompile with -Xlint:deprecation for details.
> make[1]: Leaving directory `/tmp/R.INSTALL.bELNGf/rJava/jri'
> ** R
> ** inst
> ** preparing package for lazy loading
> ** help
> ?>>> Building/Updating help pages for package 'rJava'
> ? ? Formats: text html latex example
> ?accessOp ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?jarray ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?jarrayRef-class ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex
> ?jcall ? ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
> ?jcast ? ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
> ?jcastToArray ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?jcheck ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?jengine ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
> ?jequals ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
> ?jfield ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?jfloat-class ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex
> ?jfloat ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex
> ?jinit ? ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
> ?jmemprof ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?jnew ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?jnull ? ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
> ?jobjRef-class ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex
> ?jpackage ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?jreflection ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
> ?jserialize ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex
> ?jsimplify ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
> ?loader ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
> ?show ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex
> ** building package indices ...
> * DONE (rJava)
>
> The downloaded packages are in
> ? ? ? ?/tmp/RtmplOpZ4F/downloaded_packages
>> q()
> Save workspace image? [y/n/c]: n
> mkimpel-debian-xps:/usr/lib/jvm/java-6-sun/include#
> ------------------------------------------------------------
> Mark W. Kimpel MD ?** Neuroinformatics ** Dept. of Psychiatry
> Indiana University School of Medicine
>
> 15032 Hunter Court, Westfield, IN ?46074
>
> (317) 490-5129 Work, & Mobile & VoiceMail
>
> "The real problem is not whether machines think but whether men do."
> -- B. F. Skinner
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From murdoch at stats.uwo.ca  Wed Jul 15 22:07:13 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 15 Jul 2009 16:07:13 -0400
Subject: [Rd] Dynamic help pages
In-Reply-To: <4A5DDDE4.5000207@stats.uwo.ca>
References: <4A5DDDE4.5000207@stats.uwo.ca>
Message-ID: <4A5E36F1.1020206@stats.uwo.ca>

On 7/15/2009 9:47 AM, Duncan Murdoch wrote:
> I've just committed code that allows R to be built with support for 
> dynamic help pages using \Sexpr in Rd files.  Define USE_NEW_HELP and 
> the R function tools:::.convertRdfiles will be used instead of the Perl 
> RdConv script, supporting \Sexpr and using the new R converters.
> 
> Currently only text help has the macros evaluated when the user asks for 
> help; the others are rendered at install time.  Hopefully HTML rendering 
> will also be in place before the 2.10.x release.  I can't see how CHM 
> and Latex help pages would ever be dynamic. Build time evaluation of 
> \Sexpr macros is not yet supported.
> 
> The only man page currently containing \Sexpr is ?tools::Rd2HTML.


This message may be a little premature:  the USE_NEW_HELP setting only 
affects base packages so far.  I'll see if I can get R CMD INSTALL 
working too, but it might take a while....

Duncan Murdoch


From edd at debian.org  Wed Jul 15 22:54:12 2009
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 15 Jul 2009 15:54:12 -0500
Subject: [Rd] rJava fails compilation on R-2.9.1 but not R-2.7.1
	on	Debian Lenny
In-Reply-To: <6b93d1830907151152padfca12tf0cbe5b37274a001@mail.gmail.com>
References: <6b93d1830907151146q506e937fxd4d31cc7d01c2ea3@mail.gmail.com>
	<6b93d1830907151152padfca12tf0cbe5b37274a001@mail.gmail.com>
Message-ID: <19038.16884.759700.438646@ron.nulle.part>


Mark,

Again, 

    sudo apt-get install r-cran-rjava

does what you want.  We do provide these binaries for a reason. Namely, that
it can be hard to tame the system requirements. So why don't you just install
the binaries we provide?  

Dirk

-- 
Three out of two people have difficulties with fractions.


From murdoch at stats.uwo.ca  Thu Jul 16 01:19:51 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 15 Jul 2009 19:19:51 -0400
Subject: [Rd] bug in texi2dvi? (PR#13833)
In-Reply-To: <20090715100009.85C1F282EFC8@mail.pubhealth.ku.dk>
References: <20090715100009.85C1F282EFC8@mail.pubhealth.ku.dk>
Message-ID: <4A5E6417.8030102@stats.uwo.ca>

On 15/07/2009 6:00 AM, paola at idsia.ch wrote:

> I am trying to call texi2dvi on a very simple tex-file (see below) and 
> it fails with a memory access error. I originally tried to call it on 
> another, meaningful tex file with the same error occuring. I am 
> attaching a screenshot.
> 
> Thank you very much for your help.

I couldn't view your screenshot, but I wonder why you think this is an R 
bug.  texi2dvi is a separate program, unrelated to R, except that R uses 
it for some of the documentation.

(texinfo is designed to process .texi files, not .tex:  your file looked 
like latex to me, so I'm not surprised texinfo failed, but I'm somehwat 
surprised it had a memory access error.)

Duncan Murdoch


From hpages at fhcrc.org  Thu Jul 16 02:08:20 2009
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Wed, 15 Jul 2009 17:08:20 -0700
Subject: [Rd] Resizing a named vector crashes R with gctorture(TRUE)
In-Reply-To: <20090715013440.v7a1c8r4g0cgksw8@webmail.fhcrc.org>
References: <20090715013440.v7a1c8r4g0cgksw8@webmail.fhcrc.org>
Message-ID: <4A5E6F74.30002@fhcrc.org>

Hi,

   > x <- c(a=10, b=20)
   > length(x) <- 1
   > x
    a
   10

But with gctorture turned on, I get:

   > gctorture(TRUE)
   > x <- c(a=10, b=20)
   > length(x) <- 1
   > x
     a
   "a"   <---- ???

   > x <- c(a=10, b=20)
   > length(x) <- 3

    *** caught segfault ***
   address (nil), cause 'unknown'

   Possible actions:
   1: abort (with core dump, if enabled)
   2: normal R exit
   3: exit R without saving workspace
   4: exit R saving workspace

This seems to have been around for a while (I get this with R 2.10,
2.9 and 2.8). Note that I don't get this with an unnamed vector.

This problem affects the methods package. I found it while
troubleshooting the "Protection stack overflow" I reported earlier
(see https://stat.ethz.ch/pipermail/r-devel/2009-July/054030.html)
but I can't tell yet whether the 2 issues are related or not.

It would be nice to see some reaction from the R developers
about these issues. Thanks in advance!

H.


hpages at fhcrc.org wrote:
> Hi,
> 
>   > gctorture(TRUE)
>   > setGeneric("foo", function(x, y) standardGeneric("foo"))
>   [1] "foo"
>   > setMethod("foo", c("ANY", "ANY"),
>   +   function(x, y) cat("calling foo,ANY,ANY method\n")
>   + )
>   Error: protect(): protection stack overflow
> 
> Sorry this is something I already reported one week ago here
>   https://stat.ethz.ch/pipermail/r-devel/2009-July/053973.html
> but I just had a 2nd look at it and realized that the problem
> can in fact be reproduced out of the .onLoad() hook. So I'm
> reporting it again with a different subject.
> 
> See my sessionInfo() below. Thanks!
> H.
> 
> 
>> sessionInfo()
> R version 2.10.0 Under development (unstable) (2009-06-26 r48837)
> x86_64-unknown-linux-gnu
> 
> locale:
>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
>  [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
>  [5] LC_MONETARY=C              LC_MESSAGES=en_CA.UTF-8
>  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From murdoch at stats.uwo.ca  Thu Jul 16 02:30:09 2009
From: murdoch at stats.uwo.ca (murdoch at stats.uwo.ca)
Date: Thu, 16 Jul 2009 02:30:09 +0200 (CEST)
Subject: [Rd] Resizing a named vector crashes R with gctorture(TRUE)
	(PR#13837)
Message-ID: <20090716003009.9255A282BE84@mail.pubhealth.ku.dk>

On 15/07/2009 8:08 PM, Herv? Pag?s wrote:
> Hi,
> 
>    > x <- c(a=10, b=20)
>    > length(x) <- 1
>    > x
>     a
>    10
> 
> But with gctorture turned on, I get:
> 
>    > gctorture(TRUE)
>    > x <- c(a=10, b=20)
>    > length(x) <- 1
>    > x
>      a
>    "a"   <---- ???
> 
>    > x <- c(a=10, b=20)
>    > length(x) <- 3
> 
>     *** caught segfault ***
>    address (nil), cause 'unknown'
> 
>    Possible actions:
>    1: abort (with core dump, if enabled)
>    2: normal R exit
>    3: exit R without saving workspace
>    4: exit R saving workspace
> 
> This seems to have been around for a while (I get this with R 2.10,
> 2.9 and 2.8). Note that I don't get this with an unnamed vector.
> 
> This problem affects the methods package. I found it while
> troubleshooting the "Protection stack overflow" I reported earlier
> (see https://stat.ethz.ch/pipermail/r-devel/2009-July/054030.html)
> but I can't tell yet whether the 2 issues are related or not.

That's clearly a bug (reproducible in today's R-devel build); I've cc'd 
this reply to r-bugs.  I'll take a look and see if I can track it down.

> It would be nice to see some reaction from the R developers
> about these issues. Thanks in advance!

You should post them as bug reports if they are as clearly bugs as this 
one; otherwise they can easily get lost in the noise.  I'm not going to 
offer to look into the other one; I don't know the insides of the 
methods package.

Duncan Murdoch

> 
> H.
> 
> 
> hpages at fhcrc.org wrote:
>> Hi,
>>
>>   > gctorture(TRUE)
>>   > setGeneric("foo", function(x, y) standardGeneric("foo"))
>>   [1] "foo"
>>   > setMethod("foo", c("ANY", "ANY"),
>>   +   function(x, y) cat("calling foo,ANY,ANY method\n")
>>   + )
>>   Error: protect(): protection stack overflow
>>
>> Sorry this is something I already reported one week ago here
>>   https://stat.ethz.ch/pipermail/r-devel/2009-July/053973.html
>> but I just had a 2nd look at it and realized that the problem
>> can in fact be reproduced out of the .onLoad() hook. So I'm
>> reporting it again with a different subject.
>>
>> See my sessionInfo() below. Thanks!
>> H.
>>
>>
>>> sessionInfo()
>> R version 2.10.0 Under development (unstable) (2009-06-26 r48837)
>> x86_64-unknown-linux-gnu
>>
>> locale:
>>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
>>  [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
>>  [5] LC_MONETARY=C              LC_MESSAGES=en_CA.UTF-8
>>  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
>>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>> [11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From murdoch at stats.uwo.ca  Thu Jul 16 02:45:15 2009
From: murdoch at stats.uwo.ca (murdoch at stats.uwo.ca)
Date: Thu, 16 Jul 2009 02:45:15 +0200 (CEST)
Subject: [Rd] Resizing a named vector crashes R with
	gctorture(TRUE)	(PR#13837)
Message-ID: <20090716004516.0A505282BE84@mail.pubhealth.ku.dk>

On 15/07/2009 8:30 PM, murdoch at stats.uwo.ca wrote:
> On 15/07/2009 8:08 PM, Herv? Pag?s wrote:
>> Hi,
>>
>>    > x <- c(a=10, b=20)
>>    > length(x) <- 1
>>    > x
>>     a
>>    10
>>
>> But with gctorture turned on, I get:
>>
>>    > gctorture(TRUE)
>>    > x <- c(a=10, b=20)
>>    > length(x) <- 1
>>    > x
>>      a
>>    "a"   <---- ???
>>
>>    > x <- c(a=10, b=20)
>>    > length(x) <- 3
>>
>>     *** caught segfault ***
>>    address (nil), cause 'unknown'
>>
>>    Possible actions:
>>    1: abort (with core dump, if enabled)
>>    2: normal R exit
>>    3: exit R without saving workspace
>>    4: exit R saving workspace
>>
>> This seems to have been around for a while (I get this with R 2.10,
>> 2.9 and 2.8). Note that I don't get this with an unnamed vector.
>>
>> This problem affects the methods package. I found it while
>> troubleshooting the "Protection stack overflow" I reported earlier
>> (see https://stat.ethz.ch/pipermail/r-devel/2009-July/054030.html)
>> but I can't tell yet whether the 2 issues are related or not.
> 
> That's clearly a bug (reproducible in today's R-devel build); I've cc'd 
> this reply to r-bugs.  I'll take a look and see if I can track it down.

That's got to be the easiest low-level bug I've worked on in a while. 
Just a missing PROTECT.  Now fixed, about to be committed to R-devel.

Duncan Murdoch

> 
>> It would be nice to see some reaction from the R developers
>> about these issues. Thanks in advance!
> 
> You should post them as bug reports if they are as clearly bugs as this 
> one; otherwise they can easily get lost in the noise.  I'm not going to 
> offer to look into the other one; I don't know the insides of the 
> methods package.
> 
> Duncan Murdoch
> 
>> H.
>>
>>
>> hpages at fhcrc.org wrote:
>>> Hi,
>>>
>>>   > gctorture(TRUE)
>>>   > setGeneric("foo", function(x, y) standardGeneric("foo"))
>>>   [1] "foo"
>>>   > setMethod("foo", c("ANY", "ANY"),
>>>   +   function(x, y) cat("calling foo,ANY,ANY method\n")
>>>   + )
>>>   Error: protect(): protection stack overflow
>>>
>>> Sorry this is something I already reported one week ago here
>>>   https://stat.ethz.ch/pipermail/r-devel/2009-July/053973.html
>>> but I just had a 2nd look at it and realized that the problem
>>> can in fact be reproduced out of the .onLoad() hook. So I'm
>>> reporting it again with a different subject.
>>>
>>> See my sessionInfo() below. Thanks!
>>> H.
>>>
>>>
>>>> sessionInfo()
>>> R version 2.10.0 Under development (unstable) (2009-06-26 r48837)
>>> x86_64-unknown-linux-gnu
>>>
>>> locale:
>>>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
>>>  [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
>>>  [5] LC_MONETARY=C              LC_MESSAGES=en_CA.UTF-8
>>>  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
>>>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>> [11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hpages at fhcrc.org  Thu Jul 16 03:10:31 2009
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Wed, 15 Jul 2009 18:10:31 -0700
Subject: [Rd] Resizing a named vector crashes R
	with	gctorture(TRUE)	(PR#13837)
In-Reply-To: <20090716004516.0A505282BE84@mail.pubhealth.ku.dk>
References: <20090716004516.0A505282BE84@mail.pubhealth.ku.dk>
Message-ID: <4A5E7E07.8040203@fhcrc.org>

murdoch at stats.uwo.ca wrote:
> On 15/07/2009 8:30 PM, murdoch at stats.uwo.ca wrote:
>> On 15/07/2009 8:08 PM, Herv? Pag?s wrote:
>>> Hi,
>>>
>>>    > x <- c(a=10, b=20)
>>>    > length(x) <- 1
>>>    > x
>>>     a
>>>    10
>>>
>>> But with gctorture turned on, I get:
>>>
>>>    > gctorture(TRUE)
>>>    > x <- c(a=10, b=20)
>>>    > length(x) <- 1
>>>    > x
>>>      a
>>>    "a"   <---- ???
>>>
>>>    > x <- c(a=10, b=20)
>>>    > length(x) <- 3
>>>
>>>     *** caught segfault ***
>>>    address (nil), cause 'unknown'
>>>
>>>    Possible actions:
>>>    1: abort (with core dump, if enabled)
>>>    2: normal R exit
>>>    3: exit R without saving workspace
>>>    4: exit R saving workspace
>>>
>>> This seems to have been around for a while (I get this with R 2.10,
>>> 2.9 and 2.8). Note that I don't get this with an unnamed vector.
>>>
>>> This problem affects the methods package. I found it while
>>> troubleshooting the "Protection stack overflow" I reported earlier
>>> (see https://stat.ethz.ch/pipermail/r-devel/2009-July/054030.html)
>>> but I can't tell yet whether the 2 issues are related or not.
>> That's clearly a bug (reproducible in today's R-devel build); I've cc'd 
>> this reply to r-bugs.  I'll take a look and see if I can track it down.
> 
> That's got to be the easiest low-level bug I've worked on in a while. 
> Just a missing PROTECT.  Now fixed, about to be committed to R-devel.

Thanks Duncan! And the "Protection stack overflow" issue that was affecting
the methods package is gone now :)

Cheers,
H.

> 
> Duncan Murdoch
> 
>>> It would be nice to see some reaction from the R developers
>>> about these issues. Thanks in advance!
>> You should post them as bug reports if they are as clearly bugs as this 
>> one; otherwise they can easily get lost in the noise.  I'm not going to 
>> offer to look into the other one; I don't know the insides of the 
>> methods package.
>>
>> Duncan Murdoch
>>
>>> H.
>>>
>>>
>>> hpages at fhcrc.org wrote:
>>>> Hi,
>>>>
>>>>   > gctorture(TRUE)
>>>>   > setGeneric("foo", function(x, y) standardGeneric("foo"))
>>>>   [1] "foo"
>>>>   > setMethod("foo", c("ANY", "ANY"),
>>>>   +   function(x, y) cat("calling foo,ANY,ANY method\n")
>>>>   + )
>>>>   Error: protect(): protection stack overflow
>>>>
>>>> Sorry this is something I already reported one week ago here
>>>>   https://stat.ethz.ch/pipermail/r-devel/2009-July/053973.html
>>>> but I just had a 2nd look at it and realized that the problem
>>>> can in fact be reproduced out of the .onLoad() hook. So I'm
>>>> reporting it again with a different subject.
>>>>
>>>> See my sessionInfo() below. Thanks!
>>>> H.
>>>>
>>>>
>>>>> sessionInfo()
>>>> R version 2.10.0 Under development (unstable) (2009-06-26 r48837)
>>>> x86_64-unknown-linux-gnu
>>>>
>>>> locale:
>>>>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
>>>>  [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
>>>>  [5] LC_MONETARY=C              LC_MESSAGES=en_CA.UTF-8
>>>>  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
>>>>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>> [11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C
>>>>
>>>> attached base packages:
>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From mwkimpel at gmail.com  Thu Jul 16 04:00:01 2009
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Wed, 15 Jul 2009 22:00:01 -0400
Subject: [Rd] rJava fails compilation on R-2.9.1 but not R-2.7.1 on
	Debian Lenny
In-Reply-To: <8cca69990907151213v440b7046r883d5aff5ea2aad1@mail.gmail.com>
References: <6b93d1830907151146q506e937fxd4d31cc7d01c2ea3@mail.gmail.com>
	<8cca69990907151213v440b7046r883d5aff5ea2aad1@mail.gmail.com>
Message-ID: <6b93d1830907151900y5f8403e8nc54dff3bd6309114@mail.gmail.com>

Well, guess what, rJava also compiles on R-devel (soon to be
R-2.10.0). I'll stick with that for my purposes. Thanks for your
suggestion. Mark
------------------------------------------------------------
Mark W. Kimpel MD  ** Neuroinformatics ** Dept. of Psychiatry
Indiana University School of Medicine

15032 Hunter Court, Westfield, IN  46074

(317) 490-5129 Work, & Mobile & VoiceMail

"The real problem is not whether machines think but whether men do."
-- B. F. Skinner
******************************************************************



On Wed, Jul 15, 2009 at 3:13 PM, Joshua Ulrich<josh.m.ulrich at gmail.com> wrote:
> Hi Mark,
>
> The first thing that jumps out to me is that 2.7.1 compiles JRI, while
> 2.9.1 does not (for some reason, autodetect decides not to compile).
>
> HTH,
> Josh
> --
> http://www.fosstrading.com
>
>
>
> On Wed, Jul 15, 2009 at 1:46 PM, Mark Kimpel<mwkimpel at gmail.com> wrote:
>> I have been futzing around for days tying to get rJava to install on
>> my freshly build Debian Lenny installation. I have R-2.9.1 installed
>> from source in my R_HOME directory and R-2.7.1 installed via apt-get
>> install r-recommended. I was tried many different things, but by
>> accident started up R-2.7.1 as root and viola, successful install. I
>> immediately exited out of R-2.7.1 and started R-2.9.1 as root and
>> compilation fails. The file
>>
>> The output is voluminous, but is included below. I had originally
>> thought that my problem had to do with setting environmental
>> variables, but now it seems not.
>>
>> Thanks,
>> Mark
>>
>> mkimpel-debian-xps /usr/lib/jvm/java-6-sun/include: su root
>> Password:
>> mkimpel-debian-xps:/usr/lib/jvm/java-6-sun/include#
>> /home/mkimpel/R_HOME/R-2.9.1/R-build/bin/R
>> WARNING: ignoring environment value of R_HOME
>>
>> R version 2.9.1 (2009-06-26)
>> Copyright (C) 2009 The R Foundation for Statistical Computing
>> ISBN 3-900051-07-0
>>
>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>> You are welcome to redistribute it under certain conditions.
>> Type 'license()' or 'licence()' for distribution details.
>>
>> ?Natural language support but running in an English locale
>>
>> R is a collaborative project with many contributors.
>> Type 'contributors()' for more information and
>> 'citation()' on how to cite R or R packages in publications.
>>
>> Type 'demo()' for some demos, 'help()' for on-line help, or
>> 'help.start()' for an HTML browser interface to help.
>> Type 'q()' to quit R.
>>
>>> install.packages('rJava')
>> Warning in install.packages("rJava") :
>> ?argument 'lib' is missing: using '/usr/local/lib/R/site-library'
>> --- Please select a CRAN mirror for use in this session ---
>> Loading Tcl/Tk interface ... done
>> trying URL 'http://cran.fhcrc.org/src/contrib/rJava_0.6-3.tar.gz'
>> Content type 'application/x-gzip' length 240527 bytes (234 Kb)
>> opened URL
>> ==================================================
>> downloaded 234 Kb
>>
>> * Installing *source* package ?rJava? ...
>> checking for gcc... gcc -std=gnu99
>> checking for C compiler default output file name... a.out
>> checking whether the C compiler works... yes
>> checking whether we are cross compiling... no
>> checking for suffix of executables...
>> checking for suffix of object files... o
>> checking whether we are using the GNU C compiler... yes
>> checking whether gcc -std=gnu99 accepts -g... yes
>> checking for gcc -std=gnu99 option to accept ISO C89... none needed
>> checking how to run the C preprocessor... gcc -std=gnu99 -E
>> checking for grep that handles long lines and -e... /bin/grep
>> checking for egrep... /bin/grep -E
>> checking for ANSI C header files... yes
>> checking for sys/wait.h that is POSIX.1 compatible... yes
>> checking for sys/types.h... yes
>> checking for sys/stat.h... yes
>> checking for stdlib.h... yes
>> checking for string.h... yes
>> checking for memory.h... yes
>> checking for strings.h... yes
>> checking for inttypes.h... yes
>> checking for stdint.h... yes
>> checking for unistd.h... yes
>> checking for string.h... (cached) yes
>> checking sys/time.h usability... yes
>> checking sys/time.h presence... yes
>> checking for sys/time.h... yes
>> checking for unistd.h... (cached) yes
>> checking for an ANSI C-conforming const... yes
>> checking whether time.h and sys/time.h may both be included... yes
>> configure: checking whether gcc -std=gnu99 supports static inline...
>> yes
>> checking Java support in R... present:
>> interpreter : '/usr/bin/java'
>> archiver ? ?: '/usr/bin/jar'
>> compiler ? ?: '/usr/bin/javac'
>> header prep.: '/usr/bin/javah'
>> cpp flags ? : '-I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux'
>> java libs ? : '-L$(JAVA_HOME)/lib/amd64/server
>> -L$(JAVA_HOME)/lib/amd64 -L$(JAVA_HOME)/../lib/amd64 -L
>> -L/usr/java/packages/lib/amd64 -L/lib -L/usr/lib -ljvm'
>> checking whether JNI programs can be compiled... yes
>> checking JNI data types... ok
>> checking whether JRI should be compiled (autodetect)... no
>> checking whether debugging output should be enabled... no
>> checking whether memory profiling is desired... no
>> checking whether threads support is requested... no
>> checking whether callbacks support is requested... no
>> checking whether JNI cache support is requested... no
>> checking whether JRI is requested... no
>> configure: creating ./config.status
>> config.status: creating src/Makevars
>> config.status: creating R/zzz.R
>> config.status: creating src/config.h
>> ** libs
>> gcc -std=gnu99 -I/home/mkimpel/R_HOME/R-2.9.1/R-build/lib64/R/include
>> -I. -I/usr/lib/jvm/java-1.5.0-gcj-4.3-1.5.0.0/jre/../include
>> -I/usr/lib/jvm/java-1.5.0-gcj-4.3-1.5.0.0/jre/../include/linux
>> -I/usr/local/include ? ?-fpic ?-g -O2 -c Rglue.c -o Rglue.o
>> In file included from Rglue.c:2:
>> rJava.h:17:17: error: jni.h: No such file or directory
>> In file included from Rglue.c:2:
>> rJava.h:115: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?*? token
>> rJava.h:117: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?*? token
>> rJava.h:120: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?*? token
>> rJava.h:122: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?javaStringClass?
>> rJava.h:123: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?javaObjectClass?
>> rJava.h:124: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?javaClassClass?
>> rJava.h:125: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?javaFieldClass?
>> rJava.h:127: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?mid_forName?
>> rJava.h:128: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?mid_getName?
>> rJava.h:129: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?mid_getType?
>> rJava.h:130: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?mid_getField?
>> rJava.h:133: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?clClassLoader?
>> rJava.h:134: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?oClassLoader?
>> rJava.h:137: error: expected ?)? before ?*? token
>> rJava.h:138: error: expected ?)? before ?*? token
>> rJava.h:139: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?R1par2jvalue?
>> rJava.h:144: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?callToString?
>> rJava.h:147: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?createObject?
>> rJava.h:148: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?findClass?
>> rJava.h:149: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?objectClass?
>> rJava.h:151: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?newDoubleArray?
>> rJava.h:152: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?newIntArray?
>> rJava.h:153: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?newBooleanArrayI?
>> rJava.h:154: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?newString?
>> rJava.h:155: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?newCharArrayI?
>> rJava.h:156: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?newShortArrayI?
>> rJava.h:157: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?newFloatArrayD?
>> rJava.h:158: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?newLongArrayD?
>> rJava.h:159: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?newByteArray?
>> rJava.h:160: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?newByteArrayI?
>> rJava.h:162: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?makeGlobal?
>> rJava.h:163: error: expected ?)? before ?*? token
>> rJava.h:164: error: expected ?)? before ?*? token
>> rJava.h:166: error: expected ?)? before ?*? token
>> rJava.h:168: error: expected ?)? before ?*? token
>> rJava.h:170: error: expected ?)? before ?*? token
>> Rglue.c: In function ?JRefObjectFinalizer?:
>> Rglue.c:79: error: ?JNIEnv? undeclared (first use in this function)
>> Rglue.c:79: error: (Each undeclared identifier is reported only once
>> Rglue.c:79: error: for each function it appears in.)
>> Rglue.c:79: error: ?env? undeclared (first use in this function)
>> Rglue.c:79: warning: implicit declaration of function ?getJNIEnv?
>> Rglue.c:80: error: ?jobject? undeclared (first use in this function)
>> Rglue.c:80: error: expected ?;? before ?o?
>> Rglue.c:95: error: ?o? undeclared (first use in this function)
>> Rglue.c:98: warning: implicit declaration of function ?releaseGlobal?
>> Rglue.c: At top level:
>> Rglue.c:104: error: expected ?)? before ?*? token
>> Rglue.c: In function ?deserializeSEXP?:
>> Rglue.c:151: error: ?JNIEnv? undeclared (first use in this function)
>> Rglue.c:151: error: ?env? undeclared (first use in this function)
>> Rglue.c:152: error: ?clClassLoader? undeclared (first use in this function)
>> Rglue.c:152: error: ?oClassLoader? undeclared (first use in this function)
>> Rglue.c:153: error: ?jbyteArray? undeclared (first use in this function)
>> Rglue.c:153: error: expected ?;? before ?ser?
>> Rglue.c:154: error: ?ser? undeclared (first use in this function)
>> Rglue.c:155: error: ?jmethodID? undeclared (first use in this function)
>> Rglue.c:155: error: expected ?;? before ?mid?
>> Rglue.c:156: error: ?mid? undeclared (first use in this function)
>> Rglue.c:157: error: ?jobject? undeclared (first use in this function)
>> Rglue.c:157: error: expected ?;? before ?res?
>> Rglue.c:158: error: ?res? undeclared (first use in this function)
>> Rglue.c:159: error: expected ?;? before ?go?
>> Rglue.c:161: error: ?go? undeclared (first use in this function)
>> Rglue.c:173: warning: implicit declaration of function ?releaseObject?
>> Rglue.c: At top level:
>> Rglue.c:214: error: expected ?)? before ?*? token
>> Rglue.c:380: error: expected ?)? before ?*? token
>> Rglue.c:390: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?R1par2jvalue?
>> Rglue.c: In function ?RcallMethod?:
>> Rglue.c:410: error: ?jvalue? undeclared (first use in this function)
>> Rglue.c:410: error: expected ?;? before ?jpar?
>> Rglue.c:411: error: ?jobject? undeclared (first use in this function)
>> Rglue.c:411: error: expected ?;? before ?tmpo?
>> Rglue.c:412: error: expected ?;? before ?o?
>> Rglue.c:414: error: ?jmethodID? undeclared (first use in this function)
>> Rglue.c:414: error: expected ?;? before ?mid?
>> Rglue.c:415: error: ?jclass? undeclared (first use in this function)
>> Rglue.c:415: error: expected ?;? before ?cls?
>> Rglue.c:416: error: ?JNIEnv? undeclared (first use in this function)
>> Rglue.c:416: error: ?env? undeclared (first use in this function)
>> Rglue.c:424: error: ?o? undeclared (first use in this function)
>> Rglue.c:440: error: ?cls? undeclared (first use in this function)
>> Rglue.c:440: warning: implicit declaration of function ?findClass?
>> Rglue.c:442: warning: implicit declaration of function ?objectClass?
>> Rglue.c:467: warning: implicit declaration of function ?Rpar2jvalue?
>> Rglue.c:467: error: ?jpar? undeclared (first use in this function)
>> Rglue.c:467: error: ?tmpo? undeclared (first use in this function)
>> Rglue.c:471: error: ?mid? undeclared (first use in this function)
>> Rglue.c:475: warning: implicit declaration of function ?checkExceptionsX?
>> Rglue.c:481: warning: implicit declaration of function ?Rfreejpars?
>> Rglue.c:542: error: ?jlong? undeclared (first use in this function)
>> Rglue.c:542: error: expected ?;? before ?r?
>> Rglue.c:546: error: ?r? undeclared (first use in this function)
>> Rglue.c:555: error: ?jshort? undeclared (first use in this function)
>> Rglue.c:555: error: expected ?;? before ?r?
>> Rglue.c:568: error: ?jboolean? undeclared (first use in this function)
>> Rglue.c:568: error: expected ?;? before ?r?
>> Rglue.c:607: error: expected ?;? before ?r?
>> Rglue.c:620: warning: implicit declaration of function ?j2SEXP?
>> Rglue.c:620: warning: assignment makes pointer from integer without a cast
>> Rglue.c: In function ?RcallSyncMethod?:
>> Rglue.c:634: error: ?jobject? undeclared (first use in this function)
>> Rglue.c:634: error: expected ?;? before ?o?
>> Rglue.c:635: error: ?JNIEnv? undeclared (first use in this function)
>> Rglue.c:635: error: ?env? undeclared (first use in this function)
>> Rglue.c:642: error: ?o? undeclared (first use in this function)
>> Rglue.c:650: error: ?JNI_OK? undeclared (first use in this function)
>> Rglue.c: In function ?RcreateObject?:
>> Rglue.c:671: error: ?jvalue? undeclared (first use in this function)
>> Rglue.c:671: error: expected ?;? before ?jpar?
>> Rglue.c:672: error: ?jobject? undeclared (first use in this function)
>> Rglue.c:672: error: expected ?;? before ?tmpo?
>> Rglue.c:673: error: expected ?;? before ?o?
>> Rglue.c:674: error: ?JNIEnv? undeclared (first use in this function)
>> Rglue.c:674: error: ?env? undeclared (first use in this function)
>> Rglue.c:690: error: ?jpar? undeclared (first use in this function)
>> Rglue.c:690: error: ?tmpo? undeclared (first use in this function)
>> Rglue.c:704: error: ?o? undeclared (first use in this function)
>> Rglue.c:704: warning: implicit declaration of function ?createObject?
>> Rglue.c:723: warning: return makes pointer from integer without a cast
>> Rglue.c: At top level:
>> Rglue.c:727: error: expected ?)? before ?*? token
>> Rglue.c:758: error: expected ?)? before ?*? token
>> Rglue.c:770: error: expected ?)? before ?*? token
>> Rglue.c: In function ?RcreateArray?:
>> Rglue.c:786: error: ?JNIEnv? undeclared (first use in this function)
>> Rglue.c:786: error: ?env? undeclared (first use in this function)
>> Rglue.c:793: error: ?jbyteArray? undeclared (first use in this function)
>> Rglue.c:793: error: expected ?;? before ?a?
>> Rglue.c:794: error: ?a? undeclared (first use in this function)
>> Rglue.c:795: warning: implicit declaration of function ?new_jarrayRef?
>> Rglue.c:795: warning: return makes pointer from integer without a cast
>> Rglue.c:797: error: ?jcharArray? undeclared (first use in this function)
>> Rglue.c:797: error: expected ?;? before ?a?
>> Rglue.c:799: warning: return makes pointer from integer without a cast
>> Rglue.c:801: error: ?jintArray? undeclared (first use in this function)
>> Rglue.c:801: error: expected ?;? before ?a?
>> Rglue.c:803: warning: return makes pointer from integer without a cast
>> Rglue.c:809: error: ?jfloatArray? undeclared (first use in this function)
>> Rglue.c:809: error: expected ?;? before ?a?
>> Rglue.c:811: warning: return makes pointer from integer without a cast
>> Rglue.c:813: error: ?jlongArray? undeclared (first use in this function)
>> Rglue.c:813: error: expected ?;? before ?a?
>> Rglue.c:815: warning: return makes pointer from integer without a cast
>> Rglue.c:817: error: ?jdoubleArray? undeclared (first use in this function)
>> Rglue.c:817: error: expected ?;? before ?a?
>> Rglue.c:819: warning: return makes pointer from integer without a cast
>> Rglue.c:824: error: ?jobjectArray? undeclared (first use in this function)
>> Rglue.c:824: error: expected ?;? before ?a?
>> Rglue.c:828: error: ?jobject? undeclared (first use in this function)
>> Rglue.c:828: error: expected ?;? before ?so?
>> Rglue.c:829: error: ?so? undeclared (first use in this function)
>> Rglue.c:833: warning: return makes pointer from integer without a cast
>> Rglue.c:838: error: ?jbooleanArray? undeclared (first use in this function)
>> Rglue.c:838: error: expected ?;? before ?a?
>> Rglue.c:840: warning: return makes pointer from integer without a cast
>> Rglue.c:845: error: ?jclass? undeclared (first use in this function)
>> Rglue.c:845: error: expected ?;? before ?ac?
>> Rglue.c:861: error: ?ac? undeclared (first use in this function)
>> Rglue.c:881: error: expected ?;? before ?a?
>> Rglue.c:883: error: ?javaObjectClass? undeclared (first use in this function)
>> Rglue.c:888: error: expected ?;? before ?o?
>> Rglue.c:893: error: ?o? undeclared (first use in this function)
>> Rglue.c:899: warning: return makes pointer from integer without a cast
>> Rglue.c:904: error: expected ?;? before ?a?
>> Rglue.c:906: warning: return makes pointer from integer without a cast
>> Rglue.c: In function ?RpollException?:
>> Rglue.c:916: error: ?JNIEnv? undeclared (first use in this function)
>> Rglue.c:916: error: ?env? undeclared (first use in this function)
>> Rglue.c:917: error: ?jthrowable? undeclared (first use in this function)
>> Rglue.c:917: error: expected ?;? before ?t?
>> Rglue.c:919: error: ?t? undeclared (first use in this function)
>> Rglue.c: In function ?RclearException?:
>> Rglue.c:927: error: ?JNIEnv? undeclared (first use in this function)
>> Rglue.c:927: error: ?env? undeclared (first use in this function)
>> Rglue.c: In function ?RthrowException?:
>> Rglue.c:948: error: ?JNIEnv? undeclared (first use in this function)
>> Rglue.c:948: error: ?env? undeclared (first use in this function)
>> Rglue.c:949: error: ?jthrowable? undeclared (first use in this function)
>> Rglue.c:949: error: expected ?;? before ?t?
>> Rglue.c:960: error: ?t? undeclared (first use in this function)
>> make: *** [Rglue.o] Error 1
>> ERROR: compilation failed for package ?rJava?
>> * Removing ?/usr/local/lib/R/site-library/rJava?
>> * Restoring previous ?/usr/local/lib/R/site-library/rJava?
>>
>> The downloaded packages are in
>> ? ? ? ??/tmp/Rtmp0D1hWd/downloaded_packages?
>> Warning message:
>> In install.packages("rJava") :
>> ?installation of package 'rJava' had non-zero exit status
>>> q()
>> Save workspace image? [y/n/c]: n
>> mkimpel-debian-xps:/usr/lib/jvm/java-6-sun/include# R
>>
>> R version 2.7.1 (2008-06-23)
>> Copyright (C) 2008 The R Foundation for Statistical Computing
>> ISBN 3-900051-07-0
>>
>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>> You are welcome to redistribute it under certain conditions.
>> Type 'license()' or 'licence()' for distribution details.
>>
>> ?Natural language support but running in an English locale
>>
>> R is a collaborative project with many contributors.
>> Type 'contributors()' for more information and
>> 'citation()' on how to cite R or R packages in publications.
>>
>> Type 'demo()' for some demos, 'help()' for on-line help, or
>> 'help.start()' for an HTML browser interface to help.
>> Type 'q()' to quit R.
>>
>>> install.packages('rJava')
>> Warning in install.packages("rJava") :
>> ?argument 'lib' is missing: using '/usr/local/lib/R/site-library'
>> --- Please select a CRAN mirror for use in this session ---
>> Loading Tcl/Tk interface ... done
>> trying URL 'http://cran.fhcrc.org/src/contrib/rJava_0.6-3.tar.gz'
>> Content type 'application/x-gzip' length 240527 bytes (234 Kb)
>> opened URL
>> ==================================================
>> downloaded 234 Kb
>>
>> * Installing *source* package 'rJava' ...
>> checking for gcc... gcc -std=gnu99
>> checking for C compiler default output file name... a.out
>> checking whether the C compiler works... yes
>> checking whether we are cross compiling... no
>> checking for suffix of executables...
>> checking for suffix of object files... o
>> checking whether we are using the GNU C compiler... yes
>> checking whether gcc -std=gnu99 accepts -g... yes
>> checking for gcc -std=gnu99 option to accept ISO C89... none needed
>> checking how to run the C preprocessor... gcc -std=gnu99 -E
>> checking for grep that handles long lines and -e... /bin/grep
>> checking for egrep... /bin/grep -E
>> checking for ANSI C header files... yes
>> checking for sys/wait.h that is POSIX.1 compatible... yes
>> checking for sys/types.h... yes
>> checking for sys/stat.h... yes
>> checking for stdlib.h... yes
>> checking for string.h... yes
>> checking for memory.h... yes
>> checking for strings.h... yes
>> checking for inttypes.h... yes
>> checking for stdint.h... yes
>> checking for unistd.h... yes
>> checking for string.h... (cached) yes
>> checking sys/time.h usability... yes
>> checking sys/time.h presence... yes
>> checking for sys/time.h... yes
>> checking for unistd.h... (cached) yes
>> checking for an ANSI C-conforming const... yes
>> checking whether time.h and sys/time.h may both be included... yes
>> configure: checking whether gcc -std=gnu99 supports static inline...
>> yes
>> checking Java support in R... present:
>> interpreter : '/usr/bin/java'
>> archiver ? ?: '/usr/bin/jar'
>> compiler ? ?: '/usr/bin/javac'
>> header prep.: '/usr/bin/javah'
>> cpp flags ? : '-I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux'
>> java libs ? : '-L$(JAVA_HOME)/lib/amd64/server
>> -L$(JAVA_HOME)/lib/amd64 -L$(JAVA_HOME)/../lib/amd64 -L
>> -L/usr/java/packages/lib/amd64 -L/lib -L/usr/lib -ljvm'
>> checking whether JNI programs can be compiled... yes
>> checking JNI data types... ok
>> checking whether JRI should be compiled (autodetect)... yes
>> checking whether debugging output should be enabled... no
>> checking whether memory profiling is desired... no
>> checking whether threads support is requested... no
>> checking whether callbacks support is requested... no
>> checking whether JNI cache support is requested... no
>> checking whether JRI is requested... yes
>> configure: creating ./config.status
>> config.status: creating src/Makevars
>> config.status: creating R/zzz.R
>> config.status: creating src/config.h
>> === configuring in jri (/tmp/R.INSTALL.bELNGf/rJava/jri)
>> configure: running /bin/sh ./configure '--prefix=/usr/local'
>> --cache-file=/dev/null --srcdir=.
>> checking build system type... x86_64-unknown-linux-gnu
>> checking host system type... x86_64-unknown-linux-gnu
>> checking for gcc... gcc -std=gnu99
>> checking for C compiler default output file name... a.out
>> checking whether the C compiler works... yes
>> checking whether we are cross compiling... no
>> checking for suffix of executables...
>> checking for suffix of object files... o
>> checking whether we are using the GNU C compiler... yes
>> checking whether gcc -std=gnu99 accepts -g... yes
>> checking for gcc -std=gnu99 option to accept ISO C89... none needed
>> checking how to run the C preprocessor... gcc -std=gnu99 -E
>> checking for grep that handles long lines and -e... /bin/grep
>> checking for egrep... /bin/grep -E
>> checking for ANSI C header files... yes
>> checking whether Java interpreter works... checking whether JNI
>> programs can be compiled... yes
>> checking whether JNI programs can be run... yes
>> checking JNI data types... ok
>> checking whether Rinterface.h exports R_CStackXXX variables... yes
>> checking whether Rinterface.h exports R_SignalHandlers... yes
>> configure: creating ./config.status
>> config.status: creating src/Makefile
>> config.status: creating Makefile
>> config.status: creating run
>> config.status: creating src/config.h
>> ** libs
>> gcc -std=gnu99 -I/usr/share/R/include -I.
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
>> -O2 -c arrayc.c -o arrayc.o
>> gcc -std=gnu99 -I/usr/share/R/include -I.
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
>> -O2 -c callback.c -o callback.o
>> gcc -std=gnu99 -I/usr/share/R/include -I.
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
>> -O2 -c callJNI.c -o callJNI.o
>> gcc -std=gnu99 -I/usr/share/R/include -I.
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
>> -O2 -c fields.c -o fields.o
>> gcc -std=gnu99 -I/usr/share/R/include -I.
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
>> -O2 -c init.c -o init.o
>> gcc -std=gnu99 -I/usr/share/R/include -I.
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
>> -O2 -c jri_glue.c -o jri_glue.o
>> gcc -std=gnu99 -I/usr/share/R/include -I.
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
>> -O2 -c loader.c -o loader.o
>> gcc -std=gnu99 -I/usr/share/R/include -I.
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
>> -O2 -c Rglue.c -o Rglue.o
>> gcc -std=gnu99 -I/usr/share/R/include -I.
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
>> -O2 -c rJava.c -o rJava.o
>> gcc -std=gnu99 -I/usr/share/R/include -I.
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ? ? -fpic ?-g
>> -O2 -c tools.c -o tools.o
>> gcc -std=gnu99 -shared ?-o rJava.so arrayc.o callback.o callJNI.o
>> fields.o init.o jri_glue.o loader.o Rglue.o rJava.o tools.o
>> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/amd64/server
>> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/amd64
>> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../lib/amd64 -L
>> -L/usr/java/packages/lib/amd64 -L/lib -L/usr/lib -ljvm
>> -L/usr/lib64/R/lib -lR
>> make -C ../jri/
>> make[1]: Entering directory `/tmp/R.INSTALL.bELNGf/rJava/jri'
>> make -C src JRI.jar
>> make[2]: Entering directory `/tmp/R.INSTALL.bELNGf/rJava/jri/src'
>> /usr/bin/javac -target 1.4 -source 1.4 -d . ../Mutex.java
>> ../RBool.java ../RConsoleOutputStream.java ../Rengine.java
>> ../REXP.java ../RFactor.java ../RList.java ../RMainLoopCallbacks.java
>> ../RVector.java
>> /usr/bin/javah -d . -classpath . org.rosuda.JRI.Rengine
>> gcc -std=gnu99 -c -o Rengine.o Rengine.c -g -Iinclude
>> -DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
>> -I/usr/share/R/include -I/usr/share/R/include -I/usr/share/R/include
>> gcc -std=gnu99 -c -o jri.o jri.c -g -Iinclude ?-DRIF_HAS_CSTACK
>> -DRIF_HAS_RSIGHAND -g -O2
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
>> -I/usr/share/R/include -I/usr/share/R/include -I/usr/share/R/include
>> jri.c: In function ?jri_getObjectArray?:
>> jri.c:303: warning: cast from pointer to integer of different size
>> gcc -std=gnu99 -c -o Rcallbacks.o Rcallbacks.c -g -Iinclude
>> -DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
>> -I/usr/share/R/include -I/usr/share/R/include -I/usr/share/R/include
>> gcc -std=gnu99 -c -o Rinit.o Rinit.c -g -Iinclude ?-DRIF_HAS_CSTACK
>> -DRIF_HAS_RSIGHAND -g -O2
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
>> -I/usr/share/R/include -I/usr/share/R/include -I/usr/share/R/include
>> gcc -std=gnu99 -c -o globals.o globals.c -g -Iinclude
>> -DRIF_HAS_CSTACK -DRIF_HAS_RSIGHAND -g -O2
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
>> gcc -std=gnu99 -c -o rjava.o rjava.c -g -Iinclude ?-DRIF_HAS_CSTACK
>> -DRIF_HAS_RSIGHAND -g -O2
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux ?-fpic
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include
>> -I/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../include/linux
>> gcc -std=gnu99 -o libjri.so Rengine.o jri.o Rcallbacks.o Rinit.o
>> globals.o rjava.o ?-shared
>> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/amd64/server
>> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/lib/amd64
>> -L/usr/lib/jvm/java-6-sun-1.6.0.12/jre/../lib/amd64 -L
>> -L/usr/java/packages/lib/amd64 -L/lib -L/usr/lib -ljvm
>> -L/usr/lib64/R/lib -lR
>> /usr/bin/javac -target 1.4 -source 1.4 -d . ../Mutex.java
>> ../RBool.java ../RConsoleOutputStream.java ../Rengine.java
>> ../REXP.java ../RFactor.java ../RList.java ../RMainLoopCallbacks.java
>> ../RVector.java
>> /usr/bin/jar fc JRI.jar org libjri.so
>> make[2]: Leaving directory `/tmp/R.INSTALL.bELNGf/rJava/jri/src'
>> rm -f libjri.so
>> cp src/libjri.so libjri.so
>> /usr/bin/javac -target 1.4 -source 1.4 -classpath src/JRI.jar -d
>> examples examples/rtest2.java
>> Note: examples/rtest2.java uses or overrides a deprecated API.
>> Note: Recompile with -Xlint:deprecation for details.
>> /usr/bin/javac -target 1.4 -source 1.4 -classpath src/JRI.jar -d
>> examples examples/rtest.java
>> Note: examples/rtest.java uses or overrides a deprecated API.
>> Note: Recompile with -Xlint:deprecation for details.
>> make[1]: Leaving directory `/tmp/R.INSTALL.bELNGf/rJava/jri'
>> ** R
>> ** inst
>> ** preparing package for lazy loading
>> ** help
>> ?>>> Building/Updating help pages for package 'rJava'
>> ? ? Formats: text html latex example
>> ?accessOp ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
>> ?jarray ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
>> ?jarrayRef-class ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex
>> ?jcall ? ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
>> ?jcast ? ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
>> ?jcastToArray ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
>> ?jcheck ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
>> ?jengine ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
>> ?jequals ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
>> ?jfield ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
>> ?jfloat-class ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex
>> ?jfloat ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex
>> ?jinit ? ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
>> ?jmemprof ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
>> ?jnew ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
>> ?jnull ? ? ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
>> ?jobjRef-class ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex
>> ?jpackage ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
>> ?jreflection ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
>> ?jserialize ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex
>> ?jsimplify ? ? ? ? ? ? ? ? ? ? ? ? text ? ?html ? ?latex ? example
>> ?loader ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex ? example
>> ?show ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?text ? ?html ? ?latex
>> ** building package indices ...
>> * DONE (rJava)
>>
>> The downloaded packages are in
>> ? ? ? ?/tmp/RtmplOpZ4F/downloaded_packages
>>> q()
>> Save workspace image? [y/n/c]: n
>> mkimpel-debian-xps:/usr/lib/jvm/java-6-sun/include#
>> ------------------------------------------------------------
>> Mark W. Kimpel MD ?** Neuroinformatics ** Dept. of Psychiatry
>> Indiana University School of Medicine
>>
>> 15032 Hunter Court, Westfield, IN ?46074
>>
>> (317) 490-5129 Work, & Mobile & VoiceMail
>>
>> "The real problem is not whether machines think but whether men do."
>> -- B. F. Skinner
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From gabraham at csse.unimelb.edu.au  Thu Jul 16 04:07:17 2009
From: gabraham at csse.unimelb.edu.au (Gad Abraham)
Date: Thu, 16 Jul 2009 12:07:17 +1000
Subject: [Rd] Handling masked methods
Message-ID: <4A5E8B55.2020602@csse.unimelb.edu.au>

Hi,

Say I have two packages, test1 and test2, that both define the generic 
method train (identical definition), and each has a specific train 
method for a different S4 object (foo and bar, resp.)

I want to be able to call train(foo, x, y) and train(bar, x, y), which 
doesn't work since test2 masks test1, as seen below.

The two solutions I can think of are to a) prefix train, 
test1::train(foo) and test2::train(bar), which gets cumbersome for 
non-trivial code, or b) make test2 depend on test1 so it doesn't have to 
define the generic, but I'd rather keep the packages compatible but not 
dependent. Any suggestions?

You can get the code at
http://www.cs.mu.oz.au/~gabraham/test1_0.1.tar.gz
and
http://www.cs.mu.oz.au/~gabraham/test2_0.1.tar.gz

Thanks,
Gad

 > library(test1)
 > f <- new('foo')
 > f
An object of class ?foo?
Slot "x":
      [,1]
[1,]   NA

Slot "y":
logical(0)

 > x <- matrix(rnorm(9), 3, 3)
 > y <- rnorm(3)
 > train(f, x, y)
An object of class ?foo?
Slot "x":
            [,1]       [,2]      [,3]
[1,] -1.1274528  1.5079401 1.5252550
[2,] -1.8574282  0.1638099 0.4446156
[3,] -0.7004087 -0.6221687 2.2455707

Slot "y":
[1] -0.2074759  0.2224259  1.1194120

 > library(test2)

Attaching package: 'test2'


	The following object(s) are masked from package:test1 :

	 train

 > train(f, x, y)
Error in function (classes, fdef, mtable)  :
   unable to find an inherited method for function "train", for 
signature "foo", "matrix", "numeric"
 > test2::train
standardGeneric for "train" defined from package "test2"

function (object, x, y, ...)
standardGeneric("train")
<environment: 0x160a22d0>
Methods may be defined for arguments: object, x, y
Use  showMethods("train")  for currently available ones.
 > test1::train
standardGeneric for "train" defined from package "test1"

function (object, x, y, ...)
standardGeneric("train")
<environment: 0x16075070>
Methods may be defined for arguments: object, x, y
Use  showMethods("train")  for currently available ones.

-- 
Gad Abraham
MEng Student, Dept. CSSE and NICTA
The University of Melbourne
Parkville 3010, Victoria, Australia
email: gabraham at csse.unimelb.edu.au
web: http://www.csse.unimelb.edu.au/~gabraham


From hpages at fhcrc.org  Thu Jul 16 04:15:22 2009
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Wed, 15 Jul 2009 19:15:22 -0700
Subject: [Rd] Resizing a named vector crashes
	R	with	gctorture(TRUE)	(PR#13837)
In-Reply-To: <4A5E7E07.8040203@fhcrc.org>
References: <20090716004516.0A505282BE84@mail.pubhealth.ku.dk>
	<4A5E7E07.8040203@fhcrc.org>
Message-ID: <4A5E8D3A.30206@fhcrc.org>

I have to confess that I'm a little bit puzzled by how the
PROTECT/UNPROTECT mechanism is used in the C code of R.
Duncan, you say the problem you just fixed was an easy one.
I looked at the C code too and was able to recognize a pattern
that is indeed easy to identify as problematic:

   an unprotected call to allocVector() followed by a call
   that can trigger garbage collection (in that case another
   call to allocVector())

It only took me 1 minute to find another occurrence of this pattern.
It's in the do_grep() function (src/main/character.c, line 1168):

   > gctorture(TRUE)
   > grep("b", c(A="aa", B="aba"), value=TRUE)
     B
   "B"

Given that the overhead of PROTECTing the SEXP returned by
allocVector() can really be considered 0 (or almost), I'm
wondering why this is not done in a more systematic way.
Even when nothing between PROTECT(allocVector()) and the
corresponding UNPROTECT could trigger garbage collection
(e.g. PROTECT(allocVector()) is close to the return statement).
Because making exceptions like this can make your code
really hard to maintain in the long term.

Cheers,
H.


Herv? Pag?s wrote:
> murdoch at stats.uwo.ca wrote:
>> On 15/07/2009 8:30 PM, murdoch at stats.uwo.ca wrote:
>>> On 15/07/2009 8:08 PM, Herv? Pag?s wrote:
>>>> Hi,
>>>>
>>>>    > x <- c(a=10, b=20)
>>>>    > length(x) <- 1
>>>>    > x
>>>>     a
>>>>    10
>>>>
>>>> But with gctorture turned on, I get:
>>>>
>>>>    > gctorture(TRUE)
>>>>    > x <- c(a=10, b=20)
>>>>    > length(x) <- 1
>>>>    > x
>>>>      a
>>>>    "a"   <---- ???
>>>>
>>>>    > x <- c(a=10, b=20)
>>>>    > length(x) <- 3
>>>>
>>>>     *** caught segfault ***
>>>>    address (nil), cause 'unknown'
>>>>
>>>>    Possible actions:
>>>>    1: abort (with core dump, if enabled)
>>>>    2: normal R exit
>>>>    3: exit R without saving workspace
>>>>    4: exit R saving workspace
>>>>
>>>> This seems to have been around for a while (I get this with R 2.10,
>>>> 2.9 and 2.8). Note that I don't get this with an unnamed vector.
>>>>
>>>> This problem affects the methods package. I found it while
>>>> troubleshooting the "Protection stack overflow" I reported earlier
>>>> (see https://stat.ethz.ch/pipermail/r-devel/2009-July/054030.html)
>>>> but I can't tell yet whether the 2 issues are related or not.
>>> That's clearly a bug (reproducible in today's R-devel build); I've 
>>> cc'd this reply to r-bugs.  I'll take a look and see if I can track 
>>> it down.
>>
>> That's got to be the easiest low-level bug I've worked on in a while. 
>> Just a missing PROTECT.  Now fixed, about to be committed to R-devel.
> 
> Thanks Duncan! And the "Protection stack overflow" issue that was affecting
> the methods package is gone now :)
> 
> Cheers,
> H.
> 
>>
>> Duncan Murdoch
>>
>>>> It would be nice to see some reaction from the R developers
>>>> about these issues. Thanks in advance!
>>> You should post them as bug reports if they are as clearly bugs as 
>>> this one; otherwise they can easily get lost in the noise.  I'm not 
>>> going to offer to look into the other one; I don't know the insides 
>>> of the methods package.
>>>
>>> Duncan Murdoch
>>>
>>>> H.
>>>>
>>>>
>>>> hpages at fhcrc.org wrote:
>>>>> Hi,
>>>>>
>>>>>   > gctorture(TRUE)
>>>>>   > setGeneric("foo", function(x, y) standardGeneric("foo"))
>>>>>   [1] "foo"
>>>>>   > setMethod("foo", c("ANY", "ANY"),
>>>>>   +   function(x, y) cat("calling foo,ANY,ANY method\n")
>>>>>   + )
>>>>>   Error: protect(): protection stack overflow
>>>>>
>>>>> Sorry this is something I already reported one week ago here
>>>>>   https://stat.ethz.ch/pipermail/r-devel/2009-July/053973.html
>>>>> but I just had a 2nd look at it and realized that the problem
>>>>> can in fact be reproduced out of the .onLoad() hook. So I'm
>>>>> reporting it again with a different subject.
>>>>>
>>>>> See my sessionInfo() below. Thanks!
>>>>> H.
>>>>>
>>>>>
>>>>>> sessionInfo()
>>>>> R version 2.10.0 Under development (unstable) (2009-06-26 r48837)
>>>>> x86_64-unknown-linux-gnu
>>>>>
>>>>> locale:
>>>>>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
>>>>>  [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
>>>>>  [5] LC_MONETARY=C              LC_MESSAGES=en_CA.UTF-8
>>>>>  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
>>>>>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>> [11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C
>>>>>
>>>>> attached base packages:
>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From murdoch at stats.uwo.ca  Thu Jul 16 04:18:53 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 15 Jul 2009 22:18:53 -0400
Subject: [Rd] Handling masked methods
In-Reply-To: <4A5E8B55.2020602@csse.unimelb.edu.au>
References: <4A5E8B55.2020602@csse.unimelb.edu.au>
Message-ID: <4A5E8E0D.3020803@stats.uwo.ca>

Gad Abraham wrote:
> Hi,
>
> Say I have two packages, test1 and test2, that both define the generic 
> method train (identical definition), and each has a specific train 
> method for a different S4 object (foo and bar, resp.)
>
> I want to be able to call train(foo, x, y) and train(bar, x, y), which 
> doesn't work since test2 masks test1, as seen below.
>
> The two solutions I can think of are to a) prefix train, 
> test1::train(foo) and test2::train(bar), which gets cumbersome for 
> non-trivial code, or b) make test2 depend on test1 so it doesn't have to 
> define the generic, but I'd rather keep the packages compatible but not 
> dependent. Any suggestions?
>
>   
Two other possibilities:

Make just one package, with just one definition, and put all the other 
stuff from test1 and test2 into it.

Make a third package to hold the generic, and have both packages depend 
on that.

Duncan Murdoch
> You can get the code at
> http://www.cs.mu.oz.au/~gabraham/test1_0.1.tar.gz
> and
> http://www.cs.mu.oz.au/~gabraham/test2_0.1.tar.gz
>
> Thanks,
> Gad
>
>  > library(test1)
>  > f <- new('foo')
>  > f
> An object of class ?foo?
> Slot "x":
>       [,1]
> [1,]   NA
>
> Slot "y":
> logical(0)
>
>  > x <- matrix(rnorm(9), 3, 3)
>  > y <- rnorm(3)
>  > train(f, x, y)
> An object of class ?foo?
> Slot "x":
>             [,1]       [,2]      [,3]
> [1,] -1.1274528  1.5079401 1.5252550
> [2,] -1.8574282  0.1638099 0.4446156
> [3,] -0.7004087 -0.6221687 2.2455707
>
> Slot "y":
> [1] -0.2074759  0.2224259  1.1194120
>
>  > library(test2)
>
> Attaching package: 'test2'
>
>
> 	The following object(s) are masked from package:test1 :
>
> 	 train
>
>  > train(f, x, y)
> Error in function (classes, fdef, mtable)  :
>    unable to find an inherited method for function "train", for 
> signature "foo", "matrix", "numeric"
>  > test2::train
> standardGeneric for "train" defined from package "test2"
>
> function (object, x, y, ...)
> standardGeneric("train")
> <environment: 0x160a22d0>
> Methods may be defined for arguments: object, x, y
> Use  showMethods("train")  for currently available ones.
>  > test1::train
> standardGeneric for "train" defined from package "test1"
>
> function (object, x, y, ...)
> standardGeneric("train")
> <environment: 0x16075070>
> Methods may be defined for arguments: object, x, y
> Use  showMethods("train")  for currently available ones.
>
>


From khansen at stat.berkeley.edu  Thu Jul 16 07:02:19 2009
From: khansen at stat.berkeley.edu (Kasper Daniel Hansen)
Date: Wed, 15 Jul 2009 22:02:19 -0700
Subject: [Rd] question about try and errors
Message-ID: <22F9A100-AB6E-42D8-AE0C-FC583F837FA3@stat.berkeley.edu>

I am using try. I have found that sometimes errors are not caught by  
try. For example, I got the following error message from code that was  
wrapped in try. After the error, my R CMD BATCH aborted.

Error in assign(".target", method at target, envir = envir) :
   no function to return from, jumping to top level
Calls: reverseComplement -> loadMethod -> loadMethod -> assign
Execution halted

This specific error is in relation to the emails posted by Herve about  
problems with the methods package (I think), and it also happens  
inside a large piece of code that takes several hours to execute. So  
it is not easy to give a reproducible example.

I am however surprised by the fact that try does not catch all errors  
- are there different error levels in R?

Kasper


From ripley at stats.ox.ac.uk  Thu Jul 16 07:19:44 2009
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 16 Jul 2009 06:19:44 +0100 (BST)
Subject: [Rd] bug in texi2dvi? (PR#13833)
In-Reply-To: <4A5E6417.8030102@stats.uwo.ca>
References: <20090715100009.85C1F282EFC8@mail.pubhealth.ku.dk>
	<4A5E6417.8030102@stats.uwo.ca>
Message-ID: <alpine.LFD.2.00.0907160610500.28605@gannet.stats.ox.ac.uk>

On Wed, 15 Jul 2009, Duncan Murdoch wrote:

> On 15/07/2009 6:00 AM, paola at idsia.ch wrote:
>
>> I am trying to call texi2dvi on a very simple tex-file (see below) and it 
>> fails with a memory access error. I originally tried to call it on another, 
>> meaningful tex file with the same error occuring. I am attaching a 
>> screenshot.
>> 
>> Thank you very much for your help.
>
> I couldn't view your screenshot, but I wonder why you think this is an R bug. 
> texi2dvi is a separate program, unrelated to R, except that R uses it for 
> some of the documentation.
>
> (texinfo is designed to process .texi files, not .tex:  your file looked like 
> latex to me, so I'm not surprised texinfo failed, but I'm somehwat surprised 
> it had a memory access error.)

Maybe, but both implementations of texi2dviI am aware of do handle 
most tex dialects.  The shell script that is part of the texinfo 
distribution says

DESCRIPTION
     Run each Texinfo or LaTeX FILE through TeX in turn until all cross-ref-
     erences are resolved, building all indices.  The  directory  containing
     each  FILE  is searched for included files.  The suffix of FILE is used
     to determine its language (LaTeX or Texinfo).

and in MiKTeX texi2dvi is an alias for 'texify'.  We exploit this to 
build vignettes.

I too did not bother to try to unencode the screenshot, and all the 
basic information in a R-bugs report (including the version of R, the 
OS and the exact commands used) were missing.  Here the OS and hence 
implementation of texi2div were crucial data, as was which program had 
the 'memory access error' (most likely it was not R itelf)

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch at stats.uwo.ca  Thu Jul 16 12:12:33 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 16 Jul 2009 06:12:33 -0400
Subject: [Rd] Resizing a named vector crashes
	R	with	gctorture(TRUE)	(PR#13837)
In-Reply-To: <4A5E8D3A.30206@fhcrc.org>
References: <20090716004516.0A505282BE84@mail.pubhealth.ku.dk>
	<4A5E7E07.8040203@fhcrc.org> <4A5E8D3A.30206@fhcrc.org>
Message-ID: <4A5EFD11.4000702@stats.uwo.ca>

On 15/07/2009 10:15 PM, Herv? Pag?s wrote:
> I have to confess that I'm a little bit puzzled by how the
> PROTECT/UNPROTECT mechanism is used in the C code of R.
> Duncan, you say the problem you just fixed was an easy one.
> I looked at the C code too and was able to recognize a pattern
> that is indeed easy to identify as problematic:
> 
>    an unprotected call to allocVector() followed by a call
>    that can trigger garbage collection (in that case another
>    call to allocVector())
> 
> It only took me 1 minute to find another occurrence of this pattern.
> It's in the do_grep() function (src/main/character.c, line 1168):
> 
>    > gctorture(TRUE)
>    > grep("b", c(A="aa", B="aba"), value=TRUE)
>      B
>    "B"
> 
> Given that the overhead of PROTECTing the SEXP returned by
> allocVector() can really be considered 0 (or almost), I'm
> wondering why this is not done in a more systematic way.

This is an explanation, not a justification:

If you look at the history of that file, you'll see a hint:  line 1168 
was written in 1998, the other lines were written later, by other 
people.  It is simply a matter of someone thinking something was safe 
when it wasn't, and it's not clear who was wrong:  it may have been safe 
when written, but susceptible to later changes.

> Even when nothing between PROTECT(allocVector()) and the
> corresponding UNPROTECT could trigger garbage collection
> (e.g. PROTECT(allocVector()) is close to the return statement).
> Because making exceptions like this can make your code
> really hard to maintain in the long term.

There are a lot of people who object to anything that slows R at all. 
That puts pressure on anyone writing code to do it in a way that wastes 
as few cycles as possible.  That in turn makes it harder for someone 
else to analyze the code.  And overuse of PROTECT also makes the code 
harder to read.

As an example: just below line 1168 there's another unprotected 
allocVector of nm, but I think that one is safe, because it is attached 
as an attribute to ans (which is now PROTECT'd) before anything is done 
that could trigger gc.  And a few lines below that, on another branch of 
the if, another unprotected but safe-looking allocation.  Should I 
protect those?  Then I'd also need to call UNPROTECT again, or keep a 
counter of PROTECT calls, and the code would be a little harder to read.

Thanks for tracking down these two bugs; I'll fix the grep bug too.  If 
you feel like looking for more, it would be appreciated.  (Writing an 
automatic tool to analyze code and determine where new ones are needed 
and where existing ones could be eliminated might be a fun project, but 
there are too many fun projects.)

Duncan Murdoch

> 
> Cheers,
> H.
> 
> 
> Herv? Pag?s wrote:
>> murdoch at stats.uwo.ca wrote:
>>> On 15/07/2009 8:30 PM, murdoch at stats.uwo.ca wrote:
>>>> On 15/07/2009 8:08 PM, Herv? Pag?s wrote:
>>>>> Hi,
>>>>>
>>>>>    > x <- c(a=10, b=20)
>>>>>    > length(x) <- 1
>>>>>    > x
>>>>>     a
>>>>>    10
>>>>>
>>>>> But with gctorture turned on, I get:
>>>>>
>>>>>    > gctorture(TRUE)
>>>>>    > x <- c(a=10, b=20)
>>>>>    > length(x) <- 1
>>>>>    > x
>>>>>      a
>>>>>    "a"   <---- ???
>>>>>
>>>>>    > x <- c(a=10, b=20)
>>>>>    > length(x) <- 3
>>>>>
>>>>>     *** caught segfault ***
>>>>>    address (nil), cause 'unknown'
>>>>>
>>>>>    Possible actions:
>>>>>    1: abort (with core dump, if enabled)
>>>>>    2: normal R exit
>>>>>    3: exit R without saving workspace
>>>>>    4: exit R saving workspace
>>>>>
>>>>> This seems to have been around for a while (I get this with R 2.10,
>>>>> 2.9 and 2.8). Note that I don't get this with an unnamed vector.
>>>>>
>>>>> This problem affects the methods package. I found it while
>>>>> troubleshooting the "Protection stack overflow" I reported earlier
>>>>> (see https://stat.ethz.ch/pipermail/r-devel/2009-July/054030.html)
>>>>> but I can't tell yet whether the 2 issues are related or not.
>>>> That's clearly a bug (reproducible in today's R-devel build); I've 
>>>> cc'd this reply to r-bugs.  I'll take a look and see if I can track 
>>>> it down.
>>> That's got to be the easiest low-level bug I've worked on in a while. 
>>> Just a missing PROTECT.  Now fixed, about to be committed to R-devel.
>> Thanks Duncan! And the "Protection stack overflow" issue that was affecting
>> the methods package is gone now :)
>>
>> Cheers,
>> H.
>>
>>> Duncan Murdoch
>>>
>>>>> It would be nice to see some reaction from the R developers
>>>>> about these issues. Thanks in advance!
>>>> You should post them as bug reports if they are as clearly bugs as 
>>>> this one; otherwise they can easily get lost in the noise.  I'm not 
>>>> going to offer to look into the other one; I don't know the insides 
>>>> of the methods package.
>>>>
>>>> Duncan Murdoch
>>>>
>>>>> H.
>>>>>
>>>>>
>>>>> hpages at fhcrc.org wrote:
>>>>>> Hi,
>>>>>>
>>>>>>   > gctorture(TRUE)
>>>>>>   > setGeneric("foo", function(x, y) standardGeneric("foo"))
>>>>>>   [1] "foo"
>>>>>>   > setMethod("foo", c("ANY", "ANY"),
>>>>>>   +   function(x, y) cat("calling foo,ANY,ANY method\n")
>>>>>>   + )
>>>>>>   Error: protect(): protection stack overflow
>>>>>>
>>>>>> Sorry this is something I already reported one week ago here
>>>>>>   https://stat.ethz.ch/pipermail/r-devel/2009-July/053973.html
>>>>>> but I just had a 2nd look at it and realized that the problem
>>>>>> can in fact be reproduced out of the .onLoad() hook. So I'm
>>>>>> reporting it again with a different subject.
>>>>>>
>>>>>> See my sessionInfo() below. Thanks!
>>>>>> H.
>>>>>>
>>>>>>
>>>>>>> sessionInfo()
>>>>>> R version 2.10.0 Under development (unstable) (2009-06-26 r48837)
>>>>>> x86_64-unknown-linux-gnu
>>>>>>
>>>>>> locale:
>>>>>>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
>>>>>>  [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
>>>>>>  [5] LC_MONETARY=C              LC_MESSAGES=en_CA.UTF-8
>>>>>>  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
>>>>>>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>>> [11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C
>>>>>>
>>>>>> attached base packages:
>>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From groemp at tfh-berlin.de  Thu Jul 16 15:01:16 2009
From: groemp at tfh-berlin.de (=?UTF-8?Q?Ulrike_Gr=C3=B6mping?=)
Date: Thu, 16 Jul 2009 06:01:16 -0700 (PDT)
Subject: [Rd]  Semi-automated testing of function with GUI-inputs?
Message-ID: <24515875.post@talk.nabble.com>


Dear DevelopeRs,

I have written a version of function fix for my class design (data frame
with attributes) that is supposed to allow users to type in some additional
variables, while preserving the attributes, as long as no forbidden edits
(like changes to the experimental factors) are done. 

It is quite nasty that currently any checking of this function requires that
I sit down and - for each relevant scenario - type in something that I think
a user might type and then see what happens. Doing that once is fine, but
for any substantial change do it again etc. ... It would be fine to manually
run a test battery that has been automatically created (by stored key
inputs? what else?). Is there any way to at least partly automate such a
test process ? Or is that asking for a miracle ?

Regards, Ulrike
-- 
View this message in context: http://www.nabble.com/Semi-automated-testing-of-function-with-GUI-inputs--tp24515875p24515875.html
Sent from the R devel mailing list archive at Nabble.com.


From Torsten.Hothorn at stat.uni-muenchen.de  Thu Jul 16 17:20:10 2009
From: Torsten.Hothorn at stat.uni-muenchen.de (Torsten.Hothorn at stat.uni-muenchen.de)
Date: Thu, 16 Jul 2009 17:20:10 +0200 (CEST)
Subject: [Rd] model.matrix memory problem (PR#13838)
Message-ID: <20090716152011.1002A2831FE4@mail.pubhealth.ku.dk>


Hi,

`model.matrix' might kill R with a segfault (on a illposed problem, but anyway):

mydf <- as.data.frame(sapply(1:40, function(i) gl(2, 100)))
f <- as.formula(paste("~ - 1 + ", paste(names(mydf), collapse = ":"), sep = ""))
X <- model.matrix(f, data = mydf)

  *** caught segfault ***
address 0x18, cause 'memory not mapped'
Segmentation fault

Best wishes,
Torsten

--please do not edit the information below--

Version:
  platform = i686-pc-linux-gnu
  arch = i686
  os = linux-gnu
  system = i686, linux-gnu
  status =
  major = 2
  minor = 9.0
  year = 2009
  month = 04
  day = 17
  svn rev = 48333
  language = R
  version.string = R version 2.9.0 (2009-04-17)

Locale:
LC_CTYPE=en_GB.UTF-8;LC_NUMERIC=C;LC_TIME=en_GB.UTF-8;LC_COLLATE=en_GB.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_GB.UTF-8;LC_PAPER=en_GB.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_GB.UTF-8;LC_IDENTIFICATION=C

Search Path:
  .GlobalEnv, package:stats, package:graphics, package:grDevices, package:utils, package:datasets, package:methods, Autoloads, package:base


From maechler at stat.math.ethz.ch  Thu Jul 16 17:44:45 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 16 Jul 2009 17:44:45 +0200
Subject: [Rd] Dynamic help pages
In-Reply-To: <4A5E36F1.1020206@stats.uwo.ca>
References: <4A5DDDE4.5000207@stats.uwo.ca>
	<4A5E36F1.1020206@stats.uwo.ca>
Message-ID: <19039.19181.30776.5977@lynne.math.ethz.ch>

>>>>> "DM" == Duncan Murdoch <murdoch at stats.uwo.ca>
>>>>>     on Wed, 15 Jul 2009 16:07:13 -0400 writes:

    DM> On 7/15/2009 9:47 AM, Duncan Murdoch wrote:
    >> I've just committed code that allows R to be built with support for 
    >> dynamic help pages using \Sexpr in Rd files.  Define USE_NEW_HELP and 
    >> the R function tools:::.convertRdfiles will be used instead of the Perl 
    >> RdConv script, supporting \Sexpr and using the new R converters.
    >> 
    >> Currently only text help has the macros evaluated when the user asks for 
    >> help; the others are rendered at install time.  Hopefully HTML rendering 
    >> will also be in place before the 2.10.x release.  I can't see how CHM 
    >> and Latex help pages would ever be dynamic. Build time evaluation of 
    >> \Sexpr macros is not yet supported.
    >> 
    >> The only man page currently containing \Sexpr is ?tools::Rd2HTML.


    DM> This message may be a little premature:  the USE_NEW_HELP setting only 
    DM> affects base packages so far.  I'll see if I can get R CMD INSTALL 
    DM> working too, but it might take a while....

    DM> Duncan Murdoch

In any case, it's great to see your work progressing in these
directions. I expect this will have great potential indeed. 
Thank you very much!

Martin Maechler, ETH Zurich


From maechler at stat.math.ethz.ch  Thu Jul 16 17:56:07 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 16 Jul 2009 17:56:07 +0200
Subject: [Rd] ... gctorture(TRUE) segfault etc
In-Reply-To: <4A5E6F74.30002@fhcrc.org>
References: <20090715013440.v7a1c8r4g0cgksw8@webmail.fhcrc.org>
	<4A5E6F74.30002@fhcrc.org>
Message-ID: <19039.19863.794390.756066@lynne.math.ethz.ch>

>>>>> "HP" == Herv? Pag?s <hpages at fhcrc.org>
>>>>>     on Wed, 15 Jul 2009 17:08:20 -0700 writes:

    HP> Hi,
    >> x <- c(a=10, b=20)
    >> length(x) <- 1
    >> x
    HP> a
    HP> 10

    HP> But with gctorture turned on, I get:

    >> gctorture(TRUE)
    >> x <- c(a=10, b=20)
    >> length(x) <- 1
    >> x
    HP> a
    HP> "a"   <---- ???

    >> x <- c(a=10, b=20)
    >> length(x) <- 3

    HP> *** caught segfault ***
    HP> address (nil), cause 'unknown'

    HP> Possible actions:
    HP> 1: abort (with core dump, if enabled)
    HP> 2: normal R exit
    HP> 3: exit R without saving workspace
    HP> 4: exit R saving workspace

    HP> This seems to have been around for a while (I get this with R 2.10,
    HP> 2.9 and 2.8). Note that I don't get this with an unnamed vector.

    HP> This problem affects the methods package. I found it while
    HP> troubleshooting the "Protection stack overflow" I reported earlier
    HP> (see https://stat.ethz.ch/pipermail/r-devel/2009-July/054030.html)
    HP> but I can't tell yet whether the 2 issues are related or not.

    HP> It would be nice to see some reaction from the R developers
    HP> about these issues. Thanks in advance!

Salut Herv?,
so here comes "some reaction" ..

 {You know we had  "useR! 2009" in Rennes, a big success I think,
  and then a very nice "DSC 2009" in Copenhagen, so many R
  developers were either attending or then were vacationing / too
  busy to attend ==> all reasons for not getting quick replies}

Indeed, you have uncovered quite a nasty bug, and R core will
definitely address it sooner or later.
However, I'm not the one doing that for the time being,
as garbage collection and the protection stack is not my home
ground.

BTW: My subjective probability is pretty high that indeed this
     bug is related to the one you encountered with
     setGeneric() & setMethod() calls, as I also get a	
     "Protection stack overflow" using a variation of the
     example above.

BTW, running under gdb :

> gctorture(TRUE)
> x <- c(a=10, b=20) ; length(x) <- 1
> dput(x)

Program received signal SIGSEGV, Segmentation fault.
0x000000366f823184 in __gconv_transform_utf8_internal () from /lib64/libc.so.6
(gdb) bt
#0  0x000000366f823184 in __gconv_transform_utf8_internal ()
   from /lib64/libc.so.6
#1  0x000000366f88988b in mbrtowc () from /lib64/libc.so.6
#2  0x000000000046e4b1 in Rstrwid (str=0xad76e0 "a", slen=1, 
    ienc=<value optimized out>, quote=34)
    at ../../../R/src/main/printutils.c:304
#3  0x000000000057ed93 in Rf_formatString (x=<value optimized out>, n=1, 
    fieldwidth=0x7fffff3ff1ac, quote=11368166)
    at ../../../R/src/main/format.c:60
#4  0x000000000046f87f in Rf_EncodeElement (x=<value optimized out>, 
    indx=<value optimized out>, quote=34, dec=46 '.')
    at ../../../R/src/main/printutils.c:643
#5  0x0000000000534359 in vector2buff (d=<value optimized out>, 
    vector=<value optimized out>) at ../../../R/src/main/deparse.c:1326
#6  deparse2buff (d=<value optimized out>, vector=<value optimized out>)
    at ../../../R/src/main/deparse.c:1129
#7  0x0000000000537249 in attr2 (s=0x1913148, d=0x7fffffffb8b0)
    at ../../../R/src/main/deparse.c:571
#8  0x000000000053417d in deparse2buff (s=0x1913148, d=0x7fffffffb8b0)
    at ../../../R/src/main/deparse.c:746
#9  0x0000000000537249 in attr2 (s=0x1913148, d=0x7fffffffb8b0)
    at ../../../R/src/main/deparse.c:571
#10 0x000000000053417d in deparse2buff (s=0x1913148, d=0x7fffffffb8b0)
    at ../../../R/src/main/deparse.c:746
#11 0x0000000000537249 in attr2 (s=0x1913148, d=0x7fffffffb8b0)
    at ../../../R/src/main/deparse.c:571
#12 0x000000000053417d in deparse2buff (s=0x1913148, d=0x7fffffffb8b0)
    at ../../../R/src/main/deparse.c:746

..............

#23613 0x0000000000537249 in attr2 (s=0x1913148, d=0x7fffffffb8b0)
    at ../../../R/src/main/deparse.c:571
#23614 0x000000000053417d in deparse2buff (s=0x1913148, d=0x7fffffffb8b0)
    at ../../../R/src/main/deparse.c:746

...............


which very very strongly looks like an infinite loop
( that is not properly caught in the usual way ).

---
Martin


From maechler at stat.math.ethz.ch  Thu Jul 16 18:25:30 2009
From: maechler at stat.math.ethz.ch (maechler at stat.math.ethz.ch)
Date: Thu, 16 Jul 2009 18:25:30 +0200 (CEST)
Subject: [Rd] Incorrect comment about ISNA(x) in Arith.h (PR#13826)
Message-ID: <20090716162530.3A38F2831FE8@mail.pubhealth.ku.dk>

>>>>> Tim Hesterberg <rocket at google.com>
>>>>>     on Tue, 14 Jul 2009 06:15:17 +0200 (CEST) writes:

    > R-2.9.0/include/R_ext/Arith.h has:
    > int R_IsNA(double);		/* True for R's NA only */
    > int R_IsNaN(double);		/* True for special NaN, *not* for NA */
    > int R_finite(double);		/* True if none of NA, NaN, +/-Inf */

    > #define ISNA(x)	       R_IsNA(x)
    > /* True for *both* NA and NaN.

Hi Tim, thanks for that, but you have cited things out of
context. The last line in the above is the beginning of a longer
comment which introduces  '#define ISNAN(x)'
and is all about ISNAN(.) and hence is correct.

So really, there's no bug, not even in comments of the sources
{{which are *not* part of the API, so very pedantically cannot
  have a bug... but of course, we'd still be glad for reports
  like yours particularly if they are about an error ..}}

In order to ensure that such a confusion is less likely to
happen again, I've very slightly changed that part now
[svn rev 48943].

Regards,
Martin Maechler, ETH Zurich




    > The first and last lines are contradictory - if R_IsNA is true only
    > for NA, not NaN, then ISNA should be the same.

    > Venables & Ripley S Programming p 137 indicates that
    > "ISNA does not detect NaN s"

    > Here's a little .c file and R transcript that shows that V&R are correct,
    > ISNA(x) is not True for NaN
    > So the last comment should read
    > /* True for NA, not NaN



    > #include "R.h"
    > void mysum(double *x)
    > {
    > double sum = 0.0;
    > sum = x[0] + x[1] + x[2];
    > if (ISNA(sum))
    > PROBLEM "sum is NA" WARNING(NULL_ENTRY);
    > if (ISNAN(sum))
    > PROBLEM "sum is NAN" WARNING(NULL_ENTRY);
    > if (!(R_FINITE(sum)))
    > PROBLEM "sum is not finite" WARNING(NULL_ENTRY);
    > return;
    > }


    >> dyn.load("~/R/work/bug.so")
    >> .C("mysum", c(NaN, 0.0, 0.0), NAOK = TRUE, DUP = FALSE)
    > [[1]]
    > [1] NaN   0   0

    > Warning messages:
    > 1: sum is NAN 
    > 2: sum is not finite 



    > --please do not edit the information below--

    > Version:
    > platform = x86_64-unknown-linux-gnu
    > arch = x86_64
    > os = linux-gnu
    > system = x86_64, linux-gnu
    > status = 
    > major = 2
    > minor = 9.0
    > year = 2009
    > month = 04
    > day = 17
    > svn rev = 48333
    > language = R
    > version.string = R version 2.9.0 (2009-04-17)

    > Locale:
    > LC_CTYPE=en_US;LC_NUMERIC=C;LC_TIME=C;LC_COLLATE=C;LC_MONETARY=C;LC_MESSAGES=en_US;LC_PAPER=en_US;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US;LC_IDENTIFICATION=C

    > Search Path:
    > .GlobalEnv, package:Rfixes, package:Rcode, package:aggregate, package:splus2Rgoogle, package:stats, package:graphics, package:grDevices, package:utils, package:datasets, package:methods, Autoloads, package:base

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From maechler at stat.math.ethz.ch  Thu Jul 16 18:52:00 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 16 Jul 2009 18:52:00 +0200
Subject: [Rd] ... gctorture(TRUE) segfault etc
In-Reply-To: <19039.19863.794390.756066@lynne.math.ethz.ch>
References: <20090715013440.v7a1c8r4g0cgksw8@webmail.fhcrc.org>
	<4A5E6F74.30002@fhcrc.org>
	<19039.19863.794390.756066@lynne.math.ethz.ch>
Message-ID: <19039.23216.914387.329760@lynne.math.ethz.ch>

>>>>> "MM" == Martin Maechler <maechler at stat.math.ethz.ch>
>>>>>     on Thu, 16 Jul 2009 17:56:07 +0200 writes:


...............

    HP> This seems to have been around for a while (I get this with R 2.10,
    HP> 2.9 and 2.8). Note that I don't get this with an unnamed vector.

    HP> This problem affects the methods package. I found it while
    HP> troubleshooting the "Protection stack overflow" I reported earlier
    HP> (see https://stat.ethz.ch/pipermail/r-devel/2009-July/054030.html)
    HP> but I can't tell yet whether the 2 issues are related or not.

    HP> It would be nice to see some reaction from the R developers
    HP> about these issues. Thanks in advance!

    MM> Salut Herv?,
    MM> so here comes "some reaction" ..

    MM> {You know we had  "useR! 2009" in Rennes, a big success I think,
    MM> and then a very nice "DSC 2009" in Copenhagen, so many R
    MM> developers were either attending or then were vacationing / too
    MM> busy to attend ==> all reasons for not getting quick replies}

    MM> Indeed, you have uncovered quite a nasty bug, and R core will
    MM> definitely address it sooner or later.
    MM> However, I'm not the one doing that for the time being,
    MM> as garbage collection and the protection stack is not my home
    MM> ground.

hmm, ... actually I was able to fix this bug in spite of all I
said...

but when I tried to commit my fix, I saw that Duncan Murdoch 
has been faster ...

Regards,
Martin


From hpages at fhcrc.org  Thu Jul 16 20:34:49 2009
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Thu, 16 Jul 2009 11:34:49 -0700
Subject: [Rd] Resizing a named vector crashes
	R	with	gctorture(TRUE)	(PR#13837)
In-Reply-To: <4A5EFD11.4000702@stats.uwo.ca>
References: <20090716004516.0A505282BE84@mail.pubhealth.ku.dk>
	<4A5E7E07.8040203@fhcrc.org> <4A5E8D3A.30206@fhcrc.org>
	<4A5EFD11.4000702@stats.uwo.ca>
Message-ID: <4A5F72C9.5090402@fhcrc.org>

Duncan Murdoch wrote:
> On 15/07/2009 10:15 PM, Herv? Pag?s wrote:
>> I have to confess that I'm a little bit puzzled by how the
>> PROTECT/UNPROTECT mechanism is used in the C code of R.
>> Duncan, you say the problem you just fixed was an easy one.
>> I looked at the C code too and was able to recognize a pattern
>> that is indeed easy to identify as problematic:
>>
>>    an unprotected call to allocVector() followed by a call
>>    that can trigger garbage collection (in that case another
>>    call to allocVector())
>>
>> It only took me 1 minute to find another occurrence of this pattern.
>> It's in the do_grep() function (src/main/character.c, line 1168):
>>
>>    > gctorture(TRUE)
>>    > grep("b", c(A="aa", B="aba"), value=TRUE)
>>      B
>>    "B"
>>
>> Given that the overhead of PROTECTing the SEXP returned by
>> allocVector() can really be considered 0 (or almost), I'm
>> wondering why this is not done in a more systematic way.
> 
> This is an explanation, not a justification:
> 
> If you look at the history of that file, you'll see a hint:  line 1168 
> was written in 1998, the other lines were written later, by other 
> people.  It is simply a matter of someone thinking something was safe 
> when it wasn't, and it's not clear who was wrong:  it may have been safe 
> when written, but susceptible to later changes.
> 
>> Even when nothing between PROTECT(allocVector()) and the
>> corresponding UNPROTECT could trigger garbage collection
>> (e.g. PROTECT(allocVector()) is close to the return statement).
>> Because making exceptions like this can make your code
>> really hard to maintain in the long term.
> 
> There are a lot of people who object to anything that slows R at all. 
> That puts pressure on anyone writing code to do it in a way that wastes 
> as few cycles as possible.  That in turn makes it harder for someone 
> else to analyze the code.  And overuse of PROTECT also makes the code 
> harder to read.

Most of the calls to allocVector() are currently protected. There is a
very small percentage of calls to allocVector() that are not. Most of
the times because people apparently decided that, at the time they wrote
the code, it didn't seem necessary. It doesn't matter if they were wrong
or write. My point is that this game is not worth it.

I bet if you protected all the calls to allocVector() you wouldn't notice
any slow down in R. What is guaranteed though is that you end up with code
that sooner or later will break because of some changes that are made to
the function itself or to another function called by your function (because
this other function is now calling gc and you were assuming that it wouldn't
do that).

And this kind of breakage is one of the worst kinds: if you are lucky,
you get a segfault, but if you are not, you don't notice anything and
get the wrong answer, like in the length<-() and grep() examples (and
you can safely assume that there are many other places like this in R).

I guess 99.999% of R users would happily trade a 0.001% slow down for
a correct result.

First make it right, then make it fast. And sorry, but you're not going
to make it fast by saving a few calls to PROTECT() here and here.

Cheers,
H.


> 
> As an example: just below line 1168 there's another unprotected 
> allocVector of nm, but I think that one is safe, because it is attached 
> as an attribute to ans (which is now PROTECT'd) before anything is done 
> that could trigger gc.  And a few lines below that, on another branch of 
> the if, another unprotected but safe-looking allocation.  Should I 
> protect those?  Then I'd also need to call UNPROTECT again, or keep a 
> counter of PROTECT calls, and the code would be a little harder to read.
> 
> Thanks for tracking down these two bugs; I'll fix the grep bug too.  If 
> you feel like looking for more, it would be appreciated.  (Writing an 
> automatic tool to analyze code and determine where new ones are needed 
> and where existing ones could be eliminated might be a fun project, but 
> there are too many fun projects.)
> 
> Duncan Murdoch
> 
>>
>> Cheers,
>> H.
>>
>>
>> Herv? Pag?s wrote:
>>> murdoch at stats.uwo.ca wrote:
>>>> On 15/07/2009 8:30 PM, murdoch at stats.uwo.ca wrote:
>>>>> On 15/07/2009 8:08 PM, Herv? Pag?s wrote:
>>>>>> Hi,
>>>>>>
>>>>>>    > x <- c(a=10, b=20)
>>>>>>    > length(x) <- 1
>>>>>>    > x
>>>>>>     a
>>>>>>    10
>>>>>>
>>>>>> But with gctorture turned on, I get:
>>>>>>
>>>>>>    > gctorture(TRUE)
>>>>>>    > x <- c(a=10, b=20)
>>>>>>    > length(x) <- 1
>>>>>>    > x
>>>>>>      a
>>>>>>    "a"   <---- ???
>>>>>>
>>>>>>    > x <- c(a=10, b=20)
>>>>>>    > length(x) <- 3
>>>>>>
>>>>>>     *** caught segfault ***
>>>>>>    address (nil), cause 'unknown'
>>>>>>
>>>>>>    Possible actions:
>>>>>>    1: abort (with core dump, if enabled)
>>>>>>    2: normal R exit
>>>>>>    3: exit R without saving workspace
>>>>>>    4: exit R saving workspace
>>>>>>
>>>>>> This seems to have been around for a while (I get this with R 2.10,
>>>>>> 2.9 and 2.8). Note that I don't get this with an unnamed vector.
>>>>>>
>>>>>> This problem affects the methods package. I found it while
>>>>>> troubleshooting the "Protection stack overflow" I reported earlier
>>>>>> (see https://stat.ethz.ch/pipermail/r-devel/2009-July/054030.html)
>>>>>> but I can't tell yet whether the 2 issues are related or not.
>>>>> That's clearly a bug (reproducible in today's R-devel build); I've 
>>>>> cc'd this reply to r-bugs.  I'll take a look and see if I can track 
>>>>> it down.
>>>> That's got to be the easiest low-level bug I've worked on in a 
>>>> while. Just a missing PROTECT.  Now fixed, about to be committed to 
>>>> R-devel.
>>> Thanks Duncan! And the "Protection stack overflow" issue that was 
>>> affecting
>>> the methods package is gone now :)
>>>
>>> Cheers,
>>> H.
>>>
>>>> Duncan Murdoch
>>>>
>>>>>> It would be nice to see some reaction from the R developers
>>>>>> about these issues. Thanks in advance!
>>>>> You should post them as bug reports if they are as clearly bugs as 
>>>>> this one; otherwise they can easily get lost in the noise.  I'm not 
>>>>> going to offer to look into the other one; I don't know the insides 
>>>>> of the methods package.
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>> H.
>>>>>>
>>>>>>
>>>>>> hpages at fhcrc.org wrote:
>>>>>>> Hi,
>>>>>>>
>>>>>>>   > gctorture(TRUE)
>>>>>>>   > setGeneric("foo", function(x, y) standardGeneric("foo"))
>>>>>>>   [1] "foo"
>>>>>>>   > setMethod("foo", c("ANY", "ANY"),
>>>>>>>   +   function(x, y) cat("calling foo,ANY,ANY method\n")
>>>>>>>   + )
>>>>>>>   Error: protect(): protection stack overflow
>>>>>>>
>>>>>>> Sorry this is something I already reported one week ago here
>>>>>>>   https://stat.ethz.ch/pipermail/r-devel/2009-July/053973.html
>>>>>>> but I just had a 2nd look at it and realized that the problem
>>>>>>> can in fact be reproduced out of the .onLoad() hook. So I'm
>>>>>>> reporting it again with a different subject.
>>>>>>>
>>>>>>> See my sessionInfo() below. Thanks!
>>>>>>> H.
>>>>>>>
>>>>>>>
>>>>>>>> sessionInfo()
>>>>>>> R version 2.10.0 Under development (unstable) (2009-06-26 r48837)
>>>>>>> x86_64-unknown-linux-gnu
>>>>>>>
>>>>>>> locale:
>>>>>>>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
>>>>>>>  [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
>>>>>>>  [5] LC_MONETARY=C              LC_MESSAGES=en_CA.UTF-8
>>>>>>>  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
>>>>>>>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>>>> [11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C
>>>>>>>
>>>>>>> attached base packages:
>>>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From murdoch at stats.uwo.ca  Thu Jul 16 20:54:41 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 16 Jul 2009 14:54:41 -0400
Subject: [Rd] Resizing a named vector crashes
	R	with	gctorture(TRUE)	(PR#13837)
In-Reply-To: <4A5F72C9.5090402@fhcrc.org>
References: <20090716004516.0A505282BE84@mail.pubhealth.ku.dk>
	<4A5E7E07.8040203@fhcrc.org> <4A5E8D3A.30206@fhcrc.org>
	<4A5EFD11.4000702@stats.uwo.ca> <4A5F72C9.5090402@fhcrc.org>
Message-ID: <4A5F7771.70706@stats.uwo.ca>

On 7/16/2009 2:34 PM, Herv? Pag?s wrote:
> Duncan Murdoch wrote:
>> On 15/07/2009 10:15 PM, Herv? Pag?s wrote:
>>> I have to confess that I'm a little bit puzzled by how the
>>> PROTECT/UNPROTECT mechanism is used in the C code of R.
>>> Duncan, you say the problem you just fixed was an easy one.
>>> I looked at the C code too and was able to recognize a pattern
>>> that is indeed easy to identify as problematic:
>>>
>>>    an unprotected call to allocVector() followed by a call
>>>    that can trigger garbage collection (in that case another
>>>    call to allocVector())
>>>
>>> It only took me 1 minute to find another occurrence of this pattern.
>>> It's in the do_grep() function (src/main/character.c, line 1168):
>>>
>>>    > gctorture(TRUE)
>>>    > grep("b", c(A="aa", B="aba"), value=TRUE)
>>>      B
>>>    "B"
>>>
>>> Given that the overhead of PROTECTing the SEXP returned by
>>> allocVector() can really be considered 0 (or almost), I'm
>>> wondering why this is not done in a more systematic way.
>> 
>> This is an explanation, not a justification:
>> 
>> If you look at the history of that file, you'll see a hint:  line 1168 
>> was written in 1998, the other lines were written later, by other 
>> people.  It is simply a matter of someone thinking something was safe 
>> when it wasn't, and it's not clear who was wrong:  it may have been safe 
>> when written, but susceptible to later changes.
>> 
>>> Even when nothing between PROTECT(allocVector()) and the
>>> corresponding UNPROTECT could trigger garbage collection
>>> (e.g. PROTECT(allocVector()) is close to the return statement).
>>> Because making exceptions like this can make your code
>>> really hard to maintain in the long term.
>> 
>> There are a lot of people who object to anything that slows R at all. 
>> That puts pressure on anyone writing code to do it in a way that wastes 
>> as few cycles as possible.  That in turn makes it harder for someone 
>> else to analyze the code.  And overuse of PROTECT also makes the code 
>> harder to read.
> 
> Most of the calls to allocVector() are currently protected. There is a
> very small percentage of calls to allocVector() that are not. Most of
> the times because people apparently decided that, at the time they wrote
> the code, it didn't seem necessary. It doesn't matter if they were wrong
> or write. My point is that this game is not worth it.
> 
> I bet if you protected all the calls to allocVector() you wouldn't notice
> any slow down in R. What is guaranteed though is that you end up with code
> that sooner or later will break because of some changes that are made to
> the function itself or to another function called by your function (because
> this other function is now calling gc and you were assuming that it wouldn't
> do that).
> 
> And this kind of breakage is one of the worst kinds: if you are lucky,
> you get a segfault, but if you are not, you don't notice anything and
> get the wrong answer, like in the length<-() and grep() examples (and
> you can safely assume that there are many other places like this in R).
> 
> I guess 99.999% of R users would happily trade a 0.001% slow down for
> a correct result.
> 
> First make it right, then make it fast. And sorry, but you're not going
> to make it fast by saving a few calls to PROTECT() here and here.

As I said, I gave you an explanation, not a justification.  I generally 
agree with you, but not everyone does.  For example, after posting the 
first patch I received a private email suggesting that the following 
PROTECT on xnames could be removed.  I didn't remove it, because I think 
it is mostly harmless, and it's not worth my time to analyze whether any 
particular PROTECT is unneeded.

I generally agree with you, but I don't totally agree with you.  The 
protection stack is not infinite, so any time you add a PROTECT you have 
to be sure it will be removed in a relatively short time.  You can't 
have something like

for (i=0; i < n; i++) { PROTECT( ans <- allocVector(...) ) ; ... }
UNPROTECT(n);

because you are likely to blow the stack when n is large.  You need the 
UNPROTECTs within the loop, but still after ans stops being vulnerable 
to garbage collection.  It's hard to place them automatically.  And 
every extra function/macro call adds to the obscurity of the code, so 
it's harder to read it and know whether it really does what you wanted 
it to.  My inclination is to over-PROTECT things, but not to PROTECT 
everything.

Duncan Murdoch


> 
> Cheers,
> H.
> 
> 
>> 
>> As an example: just below line 1168 there's another unprotected 
>> allocVector of nm, but I think that one is safe, because it is attached 
>> as an attribute to ans (which is now PROTECT'd) before anything is done 
>> that could trigger gc.  And a few lines below that, on another branch of 
>> the if, another unprotected but safe-looking allocation.  Should I 
>> protect those?  Then I'd also need to call UNPROTECT again, or keep a 
>> counter of PROTECT calls, and the code would be a little harder to read.
>> 
>> Thanks for tracking down these two bugs; I'll fix the grep bug too.  If 
>> you feel like looking for more, it would be appreciated.  (Writing an 
>> automatic tool to analyze code and determine where new ones are needed 
>> and where existing ones could be eliminated might be a fun project, but 
>> there are too many fun projects.)
>> 
>> Duncan Murdoch
>> 
>>>
>>> Cheers,
>>> H.
>>>
>>>
>>> Herv? Pag?s wrote:
>>>> murdoch at stats.uwo.ca wrote:
>>>>> On 15/07/2009 8:30 PM, murdoch at stats.uwo.ca wrote:
>>>>>> On 15/07/2009 8:08 PM, Herv? Pag?s wrote:
>>>>>>> Hi,
>>>>>>>
>>>>>>>    > x <- c(a=10, b=20)
>>>>>>>    > length(x) <- 1
>>>>>>>    > x
>>>>>>>     a
>>>>>>>    10
>>>>>>>
>>>>>>> But with gctorture turned on, I get:
>>>>>>>
>>>>>>>    > gctorture(TRUE)
>>>>>>>    > x <- c(a=10, b=20)
>>>>>>>    > length(x) <- 1
>>>>>>>    > x
>>>>>>>      a
>>>>>>>    "a"   <---- ???
>>>>>>>
>>>>>>>    > x <- c(a=10, b=20)
>>>>>>>    > length(x) <- 3
>>>>>>>
>>>>>>>     *** caught segfault ***
>>>>>>>    address (nil), cause 'unknown'
>>>>>>>
>>>>>>>    Possible actions:
>>>>>>>    1: abort (with core dump, if enabled)
>>>>>>>    2: normal R exit
>>>>>>>    3: exit R without saving workspace
>>>>>>>    4: exit R saving workspace
>>>>>>>
>>>>>>> This seems to have been around for a while (I get this with R 2.10,
>>>>>>> 2.9 and 2.8). Note that I don't get this with an unnamed vector.
>>>>>>>
>>>>>>> This problem affects the methods package. I found it while
>>>>>>> troubleshooting the "Protection stack overflow" I reported earlier
>>>>>>> (see https://stat.ethz.ch/pipermail/r-devel/2009-July/054030.html)
>>>>>>> but I can't tell yet whether the 2 issues are related or not.
>>>>>> That's clearly a bug (reproducible in today's R-devel build); I've 
>>>>>> cc'd this reply to r-bugs.  I'll take a look and see if I can track 
>>>>>> it down.
>>>>> That's got to be the easiest low-level bug I've worked on in a 
>>>>> while. Just a missing PROTECT.  Now fixed, about to be committed to 
>>>>> R-devel.
>>>> Thanks Duncan! And the "Protection stack overflow" issue that was 
>>>> affecting
>>>> the methods package is gone now :)
>>>>
>>>> Cheers,
>>>> H.
>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>>> It would be nice to see some reaction from the R developers
>>>>>>> about these issues. Thanks in advance!
>>>>>> You should post them as bug reports if they are as clearly bugs as 
>>>>>> this one; otherwise they can easily get lost in the noise.  I'm not 
>>>>>> going to offer to look into the other one; I don't know the insides 
>>>>>> of the methods package.
>>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>> H.
>>>>>>>
>>>>>>>
>>>>>>> hpages at fhcrc.org wrote:
>>>>>>>> Hi,
>>>>>>>>
>>>>>>>>   > gctorture(TRUE)
>>>>>>>>   > setGeneric("foo", function(x, y) standardGeneric("foo"))
>>>>>>>>   [1] "foo"
>>>>>>>>   > setMethod("foo", c("ANY", "ANY"),
>>>>>>>>   +   function(x, y) cat("calling foo,ANY,ANY method\n")
>>>>>>>>   + )
>>>>>>>>   Error: protect(): protection stack overflow
>>>>>>>>
>>>>>>>> Sorry this is something I already reported one week ago here
>>>>>>>>   https://stat.ethz.ch/pipermail/r-devel/2009-July/053973.html
>>>>>>>> but I just had a 2nd look at it and realized that the problem
>>>>>>>> can in fact be reproduced out of the .onLoad() hook. So I'm
>>>>>>>> reporting it again with a different subject.
>>>>>>>>
>>>>>>>> See my sessionInfo() below. Thanks!
>>>>>>>> H.
>>>>>>>>
>>>>>>>>
>>>>>>>>> sessionInfo()
>>>>>>>> R version 2.10.0 Under development (unstable) (2009-06-26 r48837)
>>>>>>>> x86_64-unknown-linux-gnu
>>>>>>>>
>>>>>>>> locale:
>>>>>>>>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
>>>>>>>>  [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
>>>>>>>>  [5] LC_MONETARY=C              LC_MESSAGES=en_CA.UTF-8
>>>>>>>>  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
>>>>>>>>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>>>>> [11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C
>>>>>>>>
>>>>>>>> attached base packages:
>>>>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>>>>>
>>>>>>>> ______________________________________________
>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>> 
>


From hpages at fhcrc.org  Thu Jul 16 23:06:26 2009
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Thu, 16 Jul 2009 14:06:26 -0700
Subject: [Rd] Resizing a named vector crashes
	R	with	gctorture(TRUE)	(PR#13837)
In-Reply-To: <4A5F7771.70706@stats.uwo.ca>
References: <20090716004516.0A505282BE84@mail.pubhealth.ku.dk>
	<4A5E7E07.8040203@fhcrc.org> <4A5E8D3A.30206@fhcrc.org>
	<4A5EFD11.4000702@stats.uwo.ca> <4A5F72C9.5090402@fhcrc.org>
	<4A5F7771.70706@stats.uwo.ca>
Message-ID: <4A5F9652.1090300@fhcrc.org>

Duncan Murdoch wrote:
> On 7/16/2009 2:34 PM, Herv? Pag?s wrote:
>> Duncan Murdoch wrote:
>>> On 15/07/2009 10:15 PM, Herv? Pag?s wrote:
>>>> I have to confess that I'm a little bit puzzled by how the
>>>> PROTECT/UNPROTECT mechanism is used in the C code of R.
>>>> Duncan, you say the problem you just fixed was an easy one.
>>>> I looked at the C code too and was able to recognize a pattern
>>>> that is indeed easy to identify as problematic:
>>>>
>>>>    an unprotected call to allocVector() followed by a call
>>>>    that can trigger garbage collection (in that case another
>>>>    call to allocVector())
>>>>
>>>> It only took me 1 minute to find another occurrence of this pattern.
>>>> It's in the do_grep() function (src/main/character.c, line 1168):
>>>>
>>>>    > gctorture(TRUE)
>>>>    > grep("b", c(A="aa", B="aba"), value=TRUE)
>>>>      B
>>>>    "B"
>>>>
>>>> Given that the overhead of PROTECTing the SEXP returned by
>>>> allocVector() can really be considered 0 (or almost), I'm
>>>> wondering why this is not done in a more systematic way.
>>>
>>> This is an explanation, not a justification:
>>>
>>> If you look at the history of that file, you'll see a hint:  line 
>>> 1168 was written in 1998, the other lines were written later, by 
>>> other people.  It is simply a matter of someone thinking something 
>>> was safe when it wasn't, and it's not clear who was wrong:  it may 
>>> have been safe when written, but susceptible to later changes.
>>>
>>>> Even when nothing between PROTECT(allocVector()) and the
>>>> corresponding UNPROTECT could trigger garbage collection
>>>> (e.g. PROTECT(allocVector()) is close to the return statement).
>>>> Because making exceptions like this can make your code
>>>> really hard to maintain in the long term.
>>>
>>> There are a lot of people who object to anything that slows R at all. 
>>> That puts pressure on anyone writing code to do it in a way that 
>>> wastes as few cycles as possible.  That in turn makes it harder for 
>>> someone else to analyze the code.  And overuse of PROTECT also makes 
>>> the code harder to read.
>>
>> Most of the calls to allocVector() are currently protected. There is a
>> very small percentage of calls to allocVector() that are not. Most of
>> the times because people apparently decided that, at the time they wrote
>> the code, it didn't seem necessary. It doesn't matter if they were wrong
>> or write. My point is that this game is not worth it.
>>
>> I bet if you protected all the calls to allocVector() you wouldn't notice
>> any slow down in R. What is guaranteed though is that you end up with 
>> code
>> that sooner or later will break because of some changes that are made to
>> the function itself or to another function called by your function 
>> (because
>> this other function is now calling gc and you were assuming that it 
>> wouldn't
>> do that).
>>
>> And this kind of breakage is one of the worst kinds: if you are lucky,
>> you get a segfault, but if you are not, you don't notice anything and
>> get the wrong answer, like in the length<-() and grep() examples (and
>> you can safely assume that there are many other places like this in R).
>>
>> I guess 99.999% of R users would happily trade a 0.001% slow down for
>> a correct result.
>>
>> First make it right, then make it fast. And sorry, but you're not going
>> to make it fast by saving a few calls to PROTECT() here and here.
> 
> As I said, I gave you an explanation, not a justification.  I generally 
> agree with you, but not everyone does.  For example, after posting the 
> first patch I received a private email suggesting that the following 
> PROTECT on xnames could be removed.  I didn't remove it, because I think 
> it is mostly harmless, and it's not worth my time to analyze whether any 
> particular PROTECT is unneeded.
> 
> I generally agree with you, but I don't totally agree with you.  The 
> protection stack is not infinite, so any time you add a PROTECT you have 
> to be sure it will be removed in a relatively short time.  You can't 
> have something like
> 
> for (i=0; i < n; i++) { PROTECT( ans <- allocVector(...) ) ; ... }
> UNPROTECT(n);
> 
> because you are likely to blow the stack when n is large.  You need the 
> UNPROTECTs within the loop, but still after ans stops being vulnerable 
> to garbage collection.

Indeed, putting the UNPROTECT out of the loop would be a bad idea.
The only reason I see people would do this is because they have
some continue, break or return statements inside the loop and they
don't want to put the UNPROTECT before each of them.
But most of the times, it should be clear where to put the UNPROTECT,
and, if this is not the case, then that means that it was not clear
either that ans didn't need to be protected in the first place!

> It's hard to place them automatically.  And 
> every extra function/macro call adds to the obscurity of the code, so 
> it's harder to read it and know whether it really does what you wanted 
> it to.  My inclination is to over-PROTECT things, but not to PROTECT 
> everything.

I didn't say everything should be protected. Just that
PROTECT(allocVector()) could be used in a more systematic way.

Thanks,
H.

> 
> Duncan Murdoch
> 
> 
>>
>> Cheers,
>> H.
>>
>>
>>>
>>> As an example: just below line 1168 there's another unprotected 
>>> allocVector of nm, but I think that one is safe, because it is 
>>> attached as an attribute to ans (which is now PROTECT'd) before 
>>> anything is done that could trigger gc.  And a few lines below that, 
>>> on another branch of the if, another unprotected but safe-looking 
>>> allocation.  Should I protect those?  Then I'd also need to call 
>>> UNPROTECT again, or keep a counter of PROTECT calls, and the code 
>>> would be a little harder to read.
>>>
>>> Thanks for tracking down these two bugs; I'll fix the grep bug too.  
>>> If you feel like looking for more, it would be appreciated.  (Writing 
>>> an automatic tool to analyze code and determine where new ones are 
>>> needed and where existing ones could be eliminated might be a fun 
>>> project, but there are too many fun projects.)
>>>
>>> Duncan Murdoch
>>>
>>>>
>>>> Cheers,
>>>> H.
>>>>
>>>>
>>>> Herv? Pag?s wrote:
>>>>> murdoch at stats.uwo.ca wrote:
>>>>>> On 15/07/2009 8:30 PM, murdoch at stats.uwo.ca wrote:
>>>>>>> On 15/07/2009 8:08 PM, Herv? Pag?s wrote:
>>>>>>>> Hi,
>>>>>>>>
>>>>>>>>    > x <- c(a=10, b=20)
>>>>>>>>    > length(x) <- 1
>>>>>>>>    > x
>>>>>>>>     a
>>>>>>>>    10
>>>>>>>>
>>>>>>>> But with gctorture turned on, I get:
>>>>>>>>
>>>>>>>>    > gctorture(TRUE)
>>>>>>>>    > x <- c(a=10, b=20)
>>>>>>>>    > length(x) <- 1
>>>>>>>>    > x
>>>>>>>>      a
>>>>>>>>    "a"   <---- ???
>>>>>>>>
>>>>>>>>    > x <- c(a=10, b=20)
>>>>>>>>    > length(x) <- 3
>>>>>>>>
>>>>>>>>     *** caught segfault ***
>>>>>>>>    address (nil), cause 'unknown'
>>>>>>>>
>>>>>>>>    Possible actions:
>>>>>>>>    1: abort (with core dump, if enabled)
>>>>>>>>    2: normal R exit
>>>>>>>>    3: exit R without saving workspace
>>>>>>>>    4: exit R saving workspace
>>>>>>>>
>>>>>>>> This seems to have been around for a while (I get this with R 2.10,
>>>>>>>> 2.9 and 2.8). Note that I don't get this with an unnamed vector.
>>>>>>>>
>>>>>>>> This problem affects the methods package. I found it while
>>>>>>>> troubleshooting the "Protection stack overflow" I reported earlier
>>>>>>>> (see https://stat.ethz.ch/pipermail/r-devel/2009-July/054030.html)
>>>>>>>> but I can't tell yet whether the 2 issues are related or not.
>>>>>>> That's clearly a bug (reproducible in today's R-devel build); 
>>>>>>> I've cc'd this reply to r-bugs.  I'll take a look and see if I 
>>>>>>> can track it down.
>>>>>> That's got to be the easiest low-level bug I've worked on in a 
>>>>>> while. Just a missing PROTECT.  Now fixed, about to be committed 
>>>>>> to R-devel.
>>>>> Thanks Duncan! And the "Protection stack overflow" issue that was 
>>>>> affecting
>>>>> the methods package is gone now :)
>>>>>
>>>>> Cheers,
>>>>> H.
>>>>>
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>>> It would be nice to see some reaction from the R developers
>>>>>>>> about these issues. Thanks in advance!
>>>>>>> You should post them as bug reports if they are as clearly bugs 
>>>>>>> as this one; otherwise they can easily get lost in the noise.  
>>>>>>> I'm not going to offer to look into the other one; I don't know 
>>>>>>> the insides of the methods package.
>>>>>>>
>>>>>>> Duncan Murdoch
>>>>>>>
>>>>>>>> H.
>>>>>>>>
>>>>>>>>
>>>>>>>> hpages at fhcrc.org wrote:
>>>>>>>>> Hi,
>>>>>>>>>
>>>>>>>>>   > gctorture(TRUE)
>>>>>>>>>   > setGeneric("foo", function(x, y) standardGeneric("foo"))
>>>>>>>>>   [1] "foo"
>>>>>>>>>   > setMethod("foo", c("ANY", "ANY"),
>>>>>>>>>   +   function(x, y) cat("calling foo,ANY,ANY method\n")
>>>>>>>>>   + )
>>>>>>>>>   Error: protect(): protection stack overflow
>>>>>>>>>
>>>>>>>>> Sorry this is something I already reported one week ago here
>>>>>>>>>   https://stat.ethz.ch/pipermail/r-devel/2009-July/053973.html
>>>>>>>>> but I just had a 2nd look at it and realized that the problem
>>>>>>>>> can in fact be reproduced out of the .onLoad() hook. So I'm
>>>>>>>>> reporting it again with a different subject.
>>>>>>>>>
>>>>>>>>> See my sessionInfo() below. Thanks!
>>>>>>>>> H.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>> sessionInfo()
>>>>>>>>> R version 2.10.0 Under development (unstable) (2009-06-26 r48837)
>>>>>>>>> x86_64-unknown-linux-gnu
>>>>>>>>>
>>>>>>>>> locale:
>>>>>>>>>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
>>>>>>>>>  [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
>>>>>>>>>  [5] LC_MONETARY=C              LC_MESSAGES=en_CA.UTF-8
>>>>>>>>>  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
>>>>>>>>>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>>>>>> [11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C
>>>>>>>>>
>>>>>>>>> attached base packages:
>>>>>>>>> [1] stats     graphics  grDevices utils     datasets  methods   
>>>>>>>>> base
>>>>>>>>>
>>>>>>>>> ______________________________________________
>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>
> 

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From murdoch at stats.uwo.ca  Thu Jul 16 23:51:18 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 16 Jul 2009 17:51:18 -0400
Subject: [Rd] Resizing a named vector
	crashes	R	with	gctorture(TRUE)	(PR#13837)
In-Reply-To: <4A5F9652.1090300@fhcrc.org>
References: <20090716004516.0A505282BE84@mail.pubhealth.ku.dk>	<4A5E7E07.8040203@fhcrc.org>
	<4A5E8D3A.30206@fhcrc.org>	<4A5EFD11.4000702@stats.uwo.ca>
	<4A5F72C9.5090402@fhcrc.org>	<4A5F7771.70706@stats.uwo.ca>
	<4A5F9652.1090300@fhcrc.org>
Message-ID: <4A5FA0D6.6080801@stats.uwo.ca>

On 16/07/2009 5:06 PM, Herv? Pag?s wrote:
> Duncan Murdoch wrote:
>> On 7/16/2009 2:34 PM, Herv? Pag?s wrote:
>>> Duncan Murdoch wrote:
>>>> On 15/07/2009 10:15 PM, Herv? Pag?s wrote:
>>>>> I have to confess that I'm a little bit puzzled by how the
>>>>> PROTECT/UNPROTECT mechanism is used in the C code of R.
>>>>> Duncan, you say the problem you just fixed was an easy one.
>>>>> I looked at the C code too and was able to recognize a pattern
>>>>> that is indeed easy to identify as problematic:
>>>>>
>>>>>    an unprotected call to allocVector() followed by a call
>>>>>    that can trigger garbage collection (in that case another
>>>>>    call to allocVector())
>>>>>
>>>>> It only took me 1 minute to find another occurrence of this pattern.
>>>>> It's in the do_grep() function (src/main/character.c, line 1168):
>>>>>
>>>>>    > gctorture(TRUE)
>>>>>    > grep("b", c(A="aa", B="aba"), value=TRUE)
>>>>>      B
>>>>>    "B"
>>>>>
>>>>> Given that the overhead of PROTECTing the SEXP returned by
>>>>> allocVector() can really be considered 0 (or almost), I'm
>>>>> wondering why this is not done in a more systematic way.
>>>> This is an explanation, not a justification:
>>>>
>>>> If you look at the history of that file, you'll see a hint:  line 
>>>> 1168 was written in 1998, the other lines were written later, by 
>>>> other people.  It is simply a matter of someone thinking something 
>>>> was safe when it wasn't, and it's not clear who was wrong:  it may 
>>>> have been safe when written, but susceptible to later changes.
>>>>
>>>>> Even when nothing between PROTECT(allocVector()) and the
>>>>> corresponding UNPROTECT could trigger garbage collection
>>>>> (e.g. PROTECT(allocVector()) is close to the return statement).
>>>>> Because making exceptions like this can make your code
>>>>> really hard to maintain in the long term.
>>>> There are a lot of people who object to anything that slows R at all. 
>>>> That puts pressure on anyone writing code to do it in a way that 
>>>> wastes as few cycles as possible.  That in turn makes it harder for 
>>>> someone else to analyze the code.  And overuse of PROTECT also makes 
>>>> the code harder to read.
>>> Most of the calls to allocVector() are currently protected. There is a
>>> very small percentage of calls to allocVector() that are not. Most of
>>> the times because people apparently decided that, at the time they wrote
>>> the code, it didn't seem necessary. It doesn't matter if they were wrong
>>> or write. My point is that this game is not worth it.
>>>
>>> I bet if you protected all the calls to allocVector() you wouldn't notice
>>> any slow down in R. What is guaranteed though is that you end up with 
>>> code
>>> that sooner or later will break because of some changes that are made to
>>> the function itself or to another function called by your function 
>>> (because
>>> this other function is now calling gc and you were assuming that it 
>>> wouldn't
>>> do that).
>>>
>>> And this kind of breakage is one of the worst kinds: if you are lucky,
>>> you get a segfault, but if you are not, you don't notice anything and
>>> get the wrong answer, like in the length<-() and grep() examples (and
>>> you can safely assume that there are many other places like this in R).
>>>
>>> I guess 99.999% of R users would happily trade a 0.001% slow down for
>>> a correct result.
>>>
>>> First make it right, then make it fast. And sorry, but you're not going
>>> to make it fast by saving a few calls to PROTECT() here and here.
>> As I said, I gave you an explanation, not a justification.  I generally 
>> agree with you, but not everyone does.  For example, after posting the 
>> first patch I received a private email suggesting that the following 
>> PROTECT on xnames could be removed.  I didn't remove it, because I think 
>> it is mostly harmless, and it's not worth my time to analyze whether any 
>> particular PROTECT is unneeded.
>>
>> I generally agree with you, but I don't totally agree with you.  The 
>> protection stack is not infinite, so any time you add a PROTECT you have 
>> to be sure it will be removed in a relatively short time.  You can't 
>> have something like
>>
>> for (i=0; i < n; i++) { PROTECT( ans <- allocVector(...) ) ; ... }
>> UNPROTECT(n);
>>
>> because you are likely to blow the stack when n is large.  You need the 
>> UNPROTECTs within the loop, but still after ans stops being vulnerable 
>> to garbage collection.
> 
> Indeed, putting the UNPROTECT out of the loop would be a bad idea.
> The only reason I see people would do this is because they have
> some continue, break or return statements inside the loop and they
> don't want to put the UNPROTECT before each of them.
> But most of the times, it should be clear where to put the UNPROTECT,
> and, if this is not the case, then that means that it was not clear
> either that ans didn't need to be protected in the first place!
> 
>> It's hard to place them automatically.  And 
>> every extra function/macro call adds to the obscurity of the code, so 
>> it's harder to read it and know whether it really does what you wanted 
>> it to.  My inclination is to over-PROTECT things, but not to PROTECT 
>> everything.
> 
> I didn't say everything should be protected. Just that
> PROTECT(allocVector()) could be used in a more systematic way.

Tell me the system.

Duncan Murdoch

> 
> Thanks,
> H.
> 
>> Duncan Murdoch
>>
>>
>>> Cheers,
>>> H.
>>>
>>>
>>>> As an example: just below line 1168 there's another unprotected 
>>>> allocVector of nm, but I think that one is safe, because it is 
>>>> attached as an attribute to ans (which is now PROTECT'd) before 
>>>> anything is done that could trigger gc.  And a few lines below that, 
>>>> on another branch of the if, another unprotected but safe-looking 
>>>> allocation.  Should I protect those?  Then I'd also need to call 
>>>> UNPROTECT again, or keep a counter of PROTECT calls, and the code 
>>>> would be a little harder to read.
>>>>
>>>> Thanks for tracking down these two bugs; I'll fix the grep bug too.  
>>>> If you feel like looking for more, it would be appreciated.  (Writing 
>>>> an automatic tool to analyze code and determine where new ones are 
>>>> needed and where existing ones could be eliminated might be a fun 
>>>> project, but there are too many fun projects.)
>>>>
>>>> Duncan Murdoch
>>>>
>>>>> Cheers,
>>>>> H.
>>>>>
>>>>>
>>>>> Herv? Pag?s wrote:
>>>>>> murdoch at stats.uwo.ca wrote:
>>>>>>> On 15/07/2009 8:30 PM, murdoch at stats.uwo.ca wrote:
>>>>>>>> On 15/07/2009 8:08 PM, Herv? Pag?s wrote:
>>>>>>>>> Hi,
>>>>>>>>>
>>>>>>>>>    > x <- c(a=10, b=20)
>>>>>>>>>    > length(x) <- 1
>>>>>>>>>    > x
>>>>>>>>>     a
>>>>>>>>>    10
>>>>>>>>>
>>>>>>>>> But with gctorture turned on, I get:
>>>>>>>>>
>>>>>>>>>    > gctorture(TRUE)
>>>>>>>>>    > x <- c(a=10, b=20)
>>>>>>>>>    > length(x) <- 1
>>>>>>>>>    > x
>>>>>>>>>      a
>>>>>>>>>    "a"   <---- ???
>>>>>>>>>
>>>>>>>>>    > x <- c(a=10, b=20)
>>>>>>>>>    > length(x) <- 3
>>>>>>>>>
>>>>>>>>>     *** caught segfault ***
>>>>>>>>>    address (nil), cause 'unknown'
>>>>>>>>>
>>>>>>>>>    Possible actions:
>>>>>>>>>    1: abort (with core dump, if enabled)
>>>>>>>>>    2: normal R exit
>>>>>>>>>    3: exit R without saving workspace
>>>>>>>>>    4: exit R saving workspace
>>>>>>>>>
>>>>>>>>> This seems to have been around for a while (I get this with R 2.10,
>>>>>>>>> 2.9 and 2.8). Note that I don't get this with an unnamed vector.
>>>>>>>>>
>>>>>>>>> This problem affects the methods package. I found it while
>>>>>>>>> troubleshooting the "Protection stack overflow" I reported earlier
>>>>>>>>> (see https://stat.ethz.ch/pipermail/r-devel/2009-July/054030.html)
>>>>>>>>> but I can't tell yet whether the 2 issues are related or not.
>>>>>>>> That's clearly a bug (reproducible in today's R-devel build); 
>>>>>>>> I've cc'd this reply to r-bugs.  I'll take a look and see if I 
>>>>>>>> can track it down.
>>>>>>> That's got to be the easiest low-level bug I've worked on in a 
>>>>>>> while. Just a missing PROTECT.  Now fixed, about to be committed 
>>>>>>> to R-devel.
>>>>>> Thanks Duncan! And the "Protection stack overflow" issue that was 
>>>>>> affecting
>>>>>> the methods package is gone now :)
>>>>>>
>>>>>> Cheers,
>>>>>> H.
>>>>>>
>>>>>>> Duncan Murdoch
>>>>>>>
>>>>>>>>> It would be nice to see some reaction from the R developers
>>>>>>>>> about these issues. Thanks in advance!
>>>>>>>> You should post them as bug reports if they are as clearly bugs 
>>>>>>>> as this one; otherwise they can easily get lost in the noise.  
>>>>>>>> I'm not going to offer to look into the other one; I don't know 
>>>>>>>> the insides of the methods package.
>>>>>>>>
>>>>>>>> Duncan Murdoch
>>>>>>>>
>>>>>>>>> H.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> hpages at fhcrc.org wrote:
>>>>>>>>>> Hi,
>>>>>>>>>>
>>>>>>>>>>   > gctorture(TRUE)
>>>>>>>>>>   > setGeneric("foo", function(x, y) standardGeneric("foo"))
>>>>>>>>>>   [1] "foo"
>>>>>>>>>>   > setMethod("foo", c("ANY", "ANY"),
>>>>>>>>>>   +   function(x, y) cat("calling foo,ANY,ANY method\n")
>>>>>>>>>>   + )
>>>>>>>>>>   Error: protect(): protection stack overflow
>>>>>>>>>>
>>>>>>>>>> Sorry this is something I already reported one week ago here
>>>>>>>>>>   https://stat.ethz.ch/pipermail/r-devel/2009-July/053973.html
>>>>>>>>>> but I just had a 2nd look at it and realized that the problem
>>>>>>>>>> can in fact be reproduced out of the .onLoad() hook. So I'm
>>>>>>>>>> reporting it again with a different subject.
>>>>>>>>>>
>>>>>>>>>> See my sessionInfo() below. Thanks!
>>>>>>>>>> H.
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>> sessionInfo()
>>>>>>>>>> R version 2.10.0 Under development (unstable) (2009-06-26 r48837)
>>>>>>>>>> x86_64-unknown-linux-gnu
>>>>>>>>>>
>>>>>>>>>> locale:
>>>>>>>>>>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
>>>>>>>>>>  [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
>>>>>>>>>>  [5] LC_MONETARY=C              LC_MESSAGES=en_CA.UTF-8
>>>>>>>>>>  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
>>>>>>>>>>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>>>>>>> [11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C
>>>>>>>>>>
>>>>>>>>>> attached base packages:
>>>>>>>>>> [1] stats     graphics  grDevices utils     datasets  methods   
>>>>>>>>>> base
>>>>>>>>>>
>>>>>>>>>> ______________________________________________
>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>> ______________________________________________
>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From gabraham at csse.unimelb.edu.au  Fri Jul 17 02:29:29 2009
From: gabraham at csse.unimelb.edu.au (Gad Abraham)
Date: Fri, 17 Jul 2009 10:29:29 +1000
Subject: [Rd] Handling masked methods
In-Reply-To: <4A5E8E0D.3020803@stats.uwo.ca>
References: <4A5E8B55.2020602@csse.unimelb.edu.au>
	<4A5E8E0D.3020803@stats.uwo.ca>
Message-ID: <4A5FC5E9.30901@csse.unimelb.edu.au>

On 16/7/09 12:18 PM, Duncan Murdoch wrote:
> Gad Abraham wrote:
>> Hi,
>>
>> Say I have two packages, test1 and test2, that both define the generic
>> method train (identical definition), and each has a specific train
>> method for a different S4 object (foo and bar, resp.)
>>
>> I want to be able to call train(foo, x, y) and train(bar, x, y), which
>> doesn't work since test2 masks test1, as seen below.
>>
>> The two solutions I can think of are to a) prefix train,
>> test1::train(foo) and test2::train(bar), which gets cumbersome for
>> non-trivial code, or b) make test2 depend on test1 so it doesn't have
>> to define the generic, but I'd rather keep the packages compatible but
>> not dependent. Any suggestions?
>>
> Two other possibilities:
>
> Make just one package, with just one definition, and put all the other
> stuff from test1 and test2 into it.
>
> Make a third package to hold the generic, and have both packages depend
> on that.

Thanks, but these approaches only really work if you're the author of 
both packages. I'm more interested in having compatible packages which 
just work together, just like predict works on any object.

Is there a way to tell R that the two generics are really the same so 
not to complain about it, or alternatively, to search for the method in 
each object's own package first?

I ended up assigning the respective train method as an attribute to each 
object, and then extracting that when needed; it works but it's a bit ugly.

-- 
Gad Abraham
MEng Student, Dept. CSSE and NICTA
The University of Melbourne
Parkville 3010, Victoria, Australia
email: gabraham at csse.unimelb.edu.au
web: http://www.csse.unimelb.edu.au/~gabraham


From hpages at fhcrc.org  Fri Jul 17 02:30:50 2009
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Thu, 16 Jul 2009 17:30:50 -0700
Subject: [Rd] Resizing a named vector
	crashes	R	with	gctorture(TRUE)	(PR#13837)
In-Reply-To: <4A5FA0D6.6080801@stats.uwo.ca>
References: <20090716004516.0A505282BE84@mail.pubhealth.ku.dk>	<4A5E7E07.8040203@fhcrc.org>
	<4A5E8D3A.30206@fhcrc.org>	<4A5EFD11.4000702@stats.uwo.ca>
	<4A5F72C9.5090402@fhcrc.org>	<4A5F7771.70706@stats.uwo.ca>
	<4A5F9652.1090300@fhcrc.org> <4A5FA0D6.6080801@stats.uwo.ca>
Message-ID: <4A5FC63A.7010907@fhcrc.org>



Duncan Murdoch wrote:
> On 16/07/2009 5:06 PM, Herv? Pag?s wrote:
>> Duncan Murdoch wrote:
>>> On 7/16/2009 2:34 PM, Herv? Pag?s wrote:
>>>> Duncan Murdoch wrote:
>>>>> On 15/07/2009 10:15 PM, Herv? Pag?s wrote:
>>>>>> I have to confess that I'm a little bit puzzled by how the
>>>>>> PROTECT/UNPROTECT mechanism is used in the C code of R.
>>>>>> Duncan, you say the problem you just fixed was an easy one.
>>>>>> I looked at the C code too and was able to recognize a pattern
>>>>>> that is indeed easy to identify as problematic:
>>>>>>
>>>>>>    an unprotected call to allocVector() followed by a call
>>>>>>    that can trigger garbage collection (in that case another
>>>>>>    call to allocVector())
>>>>>>
>>>>>> It only took me 1 minute to find another occurrence of this pattern.
>>>>>> It's in the do_grep() function (src/main/character.c, line 1168):
>>>>>>
>>>>>>    > gctorture(TRUE)
>>>>>>    > grep("b", c(A="aa", B="aba"), value=TRUE)
>>>>>>      B
>>>>>>    "B"
>>>>>>
>>>>>> Given that the overhead of PROTECTing the SEXP returned by
>>>>>> allocVector() can really be considered 0 (or almost), I'm
>>>>>> wondering why this is not done in a more systematic way.
>>>>> This is an explanation, not a justification:
>>>>>
>>>>> If you look at the history of that file, you'll see a hint:  line 
>>>>> 1168 was written in 1998, the other lines were written later, by 
>>>>> other people.  It is simply a matter of someone thinking something 
>>>>> was safe when it wasn't, and it's not clear who was wrong:  it may 
>>>>> have been safe when written, but susceptible to later changes.
>>>>>
>>>>>> Even when nothing between PROTECT(allocVector()) and the
>>>>>> corresponding UNPROTECT could trigger garbage collection
>>>>>> (e.g. PROTECT(allocVector()) is close to the return statement).
>>>>>> Because making exceptions like this can make your code
>>>>>> really hard to maintain in the long term.
>>>>> There are a lot of people who object to anything that slows R at 
>>>>> all. That puts pressure on anyone writing code to do it in a way 
>>>>> that wastes as few cycles as possible.  That in turn makes it 
>>>>> harder for someone else to analyze the code.  And overuse of 
>>>>> PROTECT also makes the code harder to read.
>>>> Most of the calls to allocVector() are currently protected. There is a
>>>> very small percentage of calls to allocVector() that are not. Most of
>>>> the times because people apparently decided that, at the time they 
>>>> wrote
>>>> the code, it didn't seem necessary. It doesn't matter if they were 
>>>> wrong
>>>> or write. My point is that this game is not worth it.
>>>>
>>>> I bet if you protected all the calls to allocVector() you wouldn't 
>>>> notice
>>>> any slow down in R. What is guaranteed though is that you end up 
>>>> with code
>>>> that sooner or later will break because of some changes that are 
>>>> made to
>>>> the function itself or to another function called by your function 
>>>> (because
>>>> this other function is now calling gc and you were assuming that it 
>>>> wouldn't
>>>> do that).
>>>>
>>>> And this kind of breakage is one of the worst kinds: if you are lucky,
>>>> you get a segfault, but if you are not, you don't notice anything and
>>>> get the wrong answer, like in the length<-() and grep() examples (and
>>>> you can safely assume that there are many other places like this in R).
>>>>
>>>> I guess 99.999% of R users would happily trade a 0.001% slow down for
>>>> a correct result.
>>>>
>>>> First make it right, then make it fast. And sorry, but you're not going
>>>> to make it fast by saving a few calls to PROTECT() here and here.
>>> As I said, I gave you an explanation, not a justification.  I 
>>> generally agree with you, but not everyone does.  For example, after 
>>> posting the first patch I received a private email suggesting that 
>>> the following PROTECT on xnames could be removed.  I didn't remove 
>>> it, because I think it is mostly harmless, and it's not worth my time 
>>> to analyze whether any particular PROTECT is unneeded.
>>>
>>> I generally agree with you, but I don't totally agree with you.  The 
>>> protection stack is not infinite, so any time you add a PROTECT you 
>>> have to be sure it will be removed in a relatively short time.  You 
>>> can't have something like
>>>
>>> for (i=0; i < n; i++) { PROTECT( ans <- allocVector(...) ) ; ... }
>>> UNPROTECT(n);
>>>
>>> because you are likely to blow the stack when n is large.  You need 
>>> the UNPROTECTs within the loop, but still after ans stops being 
>>> vulnerable to garbage collection.
>>
>> Indeed, putting the UNPROTECT out of the loop would be a bad idea.
>> The only reason I see people would do this is because they have
>> some continue, break or return statements inside the loop and they
>> don't want to put the UNPROTECT before each of them.
>> But most of the times, it should be clear where to put the UNPROTECT,
>> and, if this is not the case, then that means that it was not clear
>> either that ans didn't need to be protected in the first place!
>>
>>> It's hard to place them automatically.  And every extra 
>>> function/macro call adds to the obscurity of the code, so it's harder 
>>> to read it and know whether it really does what you wanted it to.  My 
>>> inclination is to over-PROTECT things, but not to PROTECT everything.
>>
>> I didn't say everything should be protected. Just that
>> PROTECT(allocVector()) could be used in a more systematic way.
> 
> Tell me the system.

OK, the system is the following. Here "you" is not you Duncan, but
the developer that is facing a protect-or-not-protect dilemma.

Every time you are tempted to write

   x = allocVector();

think about what will happen the day someone will come and
add the following line right after your line:

   y = allocVector();

Then cross your finger that s/he will remember to fix your code.
Alternatively you have the option to anticipate and make your
code safer in the long run. It's easy and at the same time you
show that you care more about long term maintainability than
saving an insignificant number of CPU cycles.

It's easy to imagine that people will be reluctant to change
things like:

   ans_elt = allocVector();
   SET_VECTOR_ELT(ans, i, ans_elt);

but I still think that the following is as good and not a lot
harder to read:

   PROTECT(ans_elt = allocVector());
   SET_VECTOR_ELT(ans, i, ans_elt);
   UNPROTECT(1);

But maybe you can have a short list of authorized exceptions
to the rule for these very simple cases.

Otherwise, when you see code like

   /* No protection needed as ExtractSubset does not allocate */
   result = allocVector(mode, n);
   PROTECT(result = ExtractSubset(x, result, indx, call));

it's nice to have a comment, but since 'result' gets finally
protected (ExtractSubset returns the same 'result' that was
passed to it), then why not just do:

   PROTECT(result = allocVector(mode, n));
   result = ExtractSubset(x, result, indx, call);

so you don't need to comment anything and the day someone
decides to allocate in ExtractSubset you are still good.

More generally, when a function is changed from being
non-allocating to be allocating, is the person in charge of
this change also supposed to come to every place where the
function is called and add the missing PROTECT/UNPROTECT?
Even worse, if it's a low-level routine that becomes an
allocating function, it could be that dozens or hundreds
of higher level functions now become allocating (being an
allocating function is a property that propagates to the
parents of the function), so the person can end up having to
check hundreds of places! The task might just become impossible.

H.


> 
> Duncan Murdoch
> 
>>
>> Thanks,
>> H.
>>
>>> Duncan Murdoch
>>>
>>>
>>>> Cheers,
>>>> H.
>>>>
>>>>
>>>>> As an example: just below line 1168 there's another unprotected 
>>>>> allocVector of nm, but I think that one is safe, because it is 
>>>>> attached as an attribute to ans (which is now PROTECT'd) before 
>>>>> anything is done that could trigger gc.  And a few lines below 
>>>>> that, on another branch of the if, another unprotected but 
>>>>> safe-looking allocation.  Should I protect those?  Then I'd also 
>>>>> need to call UNPROTECT again, or keep a counter of PROTECT calls, 
>>>>> and the code would be a little harder to read.
>>>>>
>>>>> Thanks for tracking down these two bugs; I'll fix the grep bug 
>>>>> too.  If you feel like looking for more, it would be appreciated.  
>>>>> (Writing an automatic tool to analyze code and determine where new 
>>>>> ones are needed and where existing ones could be eliminated might 
>>>>> be a fun project, but there are too many fun projects.)
>>>>>
>>>>> Duncan Murdoch
>>>>>
>>>>>> Cheers,
>>>>>> H.
>>>>>>
>>>>>>
>>>>>> Herv? Pag?s wrote:
>>>>>>> murdoch at stats.uwo.ca wrote:
>>>>>>>> On 15/07/2009 8:30 PM, murdoch at stats.uwo.ca wrote:
>>>>>>>>> On 15/07/2009 8:08 PM, Herv? Pag?s wrote:
>>>>>>>>>> Hi,
>>>>>>>>>>
>>>>>>>>>>    > x <- c(a=10, b=20)
>>>>>>>>>>    > length(x) <- 1
>>>>>>>>>>    > x
>>>>>>>>>>     a
>>>>>>>>>>    10
>>>>>>>>>>
>>>>>>>>>> But with gctorture turned on, I get:
>>>>>>>>>>
>>>>>>>>>>    > gctorture(TRUE)
>>>>>>>>>>    > x <- c(a=10, b=20)
>>>>>>>>>>    > length(x) <- 1
>>>>>>>>>>    > x
>>>>>>>>>>      a
>>>>>>>>>>    "a"   <---- ???
>>>>>>>>>>
>>>>>>>>>>    > x <- c(a=10, b=20)
>>>>>>>>>>    > length(x) <- 3
>>>>>>>>>>
>>>>>>>>>>     *** caught segfault ***
>>>>>>>>>>    address (nil), cause 'unknown'
>>>>>>>>>>
>>>>>>>>>>    Possible actions:
>>>>>>>>>>    1: abort (with core dump, if enabled)
>>>>>>>>>>    2: normal R exit
>>>>>>>>>>    3: exit R without saving workspace
>>>>>>>>>>    4: exit R saving workspace
>>>>>>>>>>
>>>>>>>>>> This seems to have been around for a while (I get this with R 
>>>>>>>>>> 2.10,
>>>>>>>>>> 2.9 and 2.8). Note that I don't get this with an unnamed vector.
>>>>>>>>>>
>>>>>>>>>> This problem affects the methods package. I found it while
>>>>>>>>>> troubleshooting the "Protection stack overflow" I reported 
>>>>>>>>>> earlier
>>>>>>>>>> (see 
>>>>>>>>>> https://stat.ethz.ch/pipermail/r-devel/2009-July/054030.html)
>>>>>>>>>> but I can't tell yet whether the 2 issues are related or not.
>>>>>>>>> That's clearly a bug (reproducible in today's R-devel build); 
>>>>>>>>> I've cc'd this reply to r-bugs.  I'll take a look and see if I 
>>>>>>>>> can track it down.
>>>>>>>> That's got to be the easiest low-level bug I've worked on in a 
>>>>>>>> while. Just a missing PROTECT.  Now fixed, about to be committed 
>>>>>>>> to R-devel.
>>>>>>> Thanks Duncan! And the "Protection stack overflow" issue that was 
>>>>>>> affecting
>>>>>>> the methods package is gone now :)
>>>>>>>
>>>>>>> Cheers,
>>>>>>> H.
>>>>>>>
>>>>>>>> Duncan Murdoch
>>>>>>>>
>>>>>>>>>> It would be nice to see some reaction from the R developers
>>>>>>>>>> about these issues. Thanks in advance!
>>>>>>>>> You should post them as bug reports if they are as clearly bugs 
>>>>>>>>> as this one; otherwise they can easily get lost in the noise.  
>>>>>>>>> I'm not going to offer to look into the other one; I don't know 
>>>>>>>>> the insides of the methods package.
>>>>>>>>>
>>>>>>>>> Duncan Murdoch
>>>>>>>>>
>>>>>>>>>> H.
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>> hpages at fhcrc.org wrote:
>>>>>>>>>>> Hi,
>>>>>>>>>>>
>>>>>>>>>>>   > gctorture(TRUE)
>>>>>>>>>>>   > setGeneric("foo", function(x, y) standardGeneric("foo"))
>>>>>>>>>>>   [1] "foo"
>>>>>>>>>>>   > setMethod("foo", c("ANY", "ANY"),
>>>>>>>>>>>   +   function(x, y) cat("calling foo,ANY,ANY method\n")
>>>>>>>>>>>   + )
>>>>>>>>>>>   Error: protect(): protection stack overflow
>>>>>>>>>>>
>>>>>>>>>>> Sorry this is something I already reported one week ago here
>>>>>>>>>>>   https://stat.ethz.ch/pipermail/r-devel/2009-July/053973.html
>>>>>>>>>>> but I just had a 2nd look at it and realized that the problem
>>>>>>>>>>> can in fact be reproduced out of the .onLoad() hook. So I'm
>>>>>>>>>>> reporting it again with a different subject.
>>>>>>>>>>>
>>>>>>>>>>> See my sessionInfo() below. Thanks!
>>>>>>>>>>> H.
>>>>>>>>>>>
>>>>>>>>>>>
>>>>>>>>>>>> sessionInfo()
>>>>>>>>>>> R version 2.10.0 Under development (unstable) (2009-06-26 
>>>>>>>>>>> r48837)
>>>>>>>>>>> x86_64-unknown-linux-gnu
>>>>>>>>>>>
>>>>>>>>>>> locale:
>>>>>>>>>>>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
>>>>>>>>>>>  [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8
>>>>>>>>>>>  [5] LC_MONETARY=C              LC_MESSAGES=en_CA.UTF-8
>>>>>>>>>>>  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
>>>>>>>>>>>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>>>>>>>> [11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C
>>>>>>>>>>>
>>>>>>>>>>> attached base packages:
>>>>>>>>>>> [1] stats     graphics  grDevices utils     datasets  
>>>>>>>>>>> methods   base
>>>>>>>>>>>
>>>>>>>>>>> ______________________________________________
>>>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>>> ______________________________________________
>>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>> ______________________________________________
>>>>>>>> R-devel at r-project.org mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From maechler at stat.math.ethz.ch  Fri Jul 17 11:01:44 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 17 Jul 2009 11:01:44 +0200
Subject: [Rd] Handling masked methods
In-Reply-To: <4A5FC5E9.30901@csse.unimelb.edu.au>
References: <4A5E8B55.2020602@csse.unimelb.edu.au>
	<4A5E8E0D.3020803@stats.uwo.ca>
	<4A5FC5E9.30901@csse.unimelb.edu.au>
Message-ID: <19040.15864.860292.525248@lynne.math.ethz.ch>

>>>>> "GA" == Gad Abraham <gabraham at csse.unimelb.edu.au>
>>>>>     on Fri, 17 Jul 2009 10:29:29 +1000 writes:

    GA> On 16/7/09 12:18 PM, Duncan Murdoch wrote:
    >> Gad Abraham wrote:
    >>> Hi,
    >>> 
    >>> Say I have two packages, test1 and test2, that both define the generic
    >>> method train (identical definition), and each has a specific train
    >>> method for a different S4 object (foo and bar, resp.)
    >>> 
    >>> I want to be able to call train(foo, x, y) and train(bar, x, y), which
    >>> doesn't work since test2 masks test1, as seen below.
    >>> 
    >>> The two solutions I can think of are to a) prefix train,
    >>> test1::train(foo) and test2::train(bar), which gets cumbersome for
    >>> non-trivial code, or b) make test2 depend on test1 so it doesn't have
    >>> to define the generic, but I'd rather keep the packages compatible but
    >>> not dependent. Any suggestions?
    >>> 
    >> Two other possibilities:
    >> 
    >> Make just one package, with just one definition, and put all the other
    >> stuff from test1 and test2 into it.

    >> Make a third package to hold the generic, and have both packages depend
    >> on that.

Yes.
A while ago, there was a proposal to provide a small standard
(i.e. in R-base) package, say "generics", depending on 'methods'
which would contain  setGenerics(..) for a set of
generic functions that the R developer community would more or
less agree on.
Then, all packages that define methods for these generics would
just import from "generics" and attach their methods to that one
generic from the "generics" package.


    GA> Thanks, but these approaches only really work if you're the author of 
    GA> both packages. I'm more interested in having compatible packages which 
    GA> just work together, just like predict works on any object.

(in theory!)

    GA> Is there a way to tell R that the two generics are really the same 
    GA> so not to complain about it,

As mentioned, there's the -- albeit asymmetric -- approach
of test2 importing the generic from test1. 
Making R not to complain would be quite wrong IMO, since
you'll have two generics with different methods attached (more
detailled: you have two different method dispatch hash tables in
different namespaces) and that maybe
very problematic, hence should be warned about.
I may not be aware of the latest developments here, and we
should away John Chambers say on this
BTW: Do read

     Chambers, John M.(2009) _Developments in Class Inheritance and
     Method Selection_ <URL:
     http://stat.stanford.edu/~jmc4/classInheritance.pdf>.

{ which is from the "References:" section in  help(Methods) }

    GA>  or alternatively, to search for the method in each
    GA>  object's own package first?

That's a somewhat interesting proposal
which would mean a change (in those relatively rare cases) in 
S4 method dispatch.




    GA> I ended up assigning the respective train method as an attribute to each 
    GA> object, and then extracting that when needed; it works but it's a bit ugly.

    GA> -- 
    GA> Gad Abraham
    GA> MEng Student, Dept. CSSE and NICTA
    GA> The University of Melbourne
    GA> Parkville 3010, Victoria, Australia
    GA> email: gabraham at csse.unimelb.edu.au
    GA> web: http://www.csse.unimelb.edu.au/~gabraham

    GA> ______________________________________________
    GA> R-devel at r-project.org mailing list
    GA> https://stat.ethz.ch/mailman/listinfo/r-devel


From maechler at stat.math.ethz.ch  Fri Jul 17 14:12:20 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 17 Jul 2009 14:12:20 +0200
Subject: [Rd] R 2.8->2.9 change that breaks some upgrade scenarios
In-Reply-To: <340397.17501.qm@web23105.mail.ird.yahoo.com>
References: <340397.17501.qm@web23105.mail.ird.yahoo.com>
Message-ID: <19040.27300.43795.372323@lynne.math.ethz.ch>

>>>>> "HL" == Hin-Tak Leung <htl10 at users.sourceforge.net>
>>>>>     on Mon, 6 Jul 2009 15:23:07 -0700 (PDT) writes:

    HL> I finally got round to look at a little problem I have - most of the time when I use R I would be using snpMatrix (now part of bioconductor, I wrote a substantial part of), so I had $HOME/.Rprofile to save some typing. Upgrading, switching versions used to work fine with R 2.8 then it broke with 2.9..

    HL> Apparently it is because most of SHLIB, INSTALL, etc used to be fairly extensive shell scripts in R 2.8 where options not specific to a particular script is passed to R itself. Those scripts also do more of --vanilla (--no-site-files, --no-init-files, etc), and it is also possible to pass --vanilla, etc explicitly. The R 2.9 implementations of these scripts are fairly thin wrappers of R routines, and they silently(?) ignore extra options.

    HL> The specific behaviors of the scripts are probably not gauranteed, and it is no problem temporarily moving .Rprofile away, etc for the occasional installations/upgrade of packages, but I think it is a valid scenario to want to have a site-/user-customized profile for day-to-day R usage, and a clean/vanilla R session for installation, etc. A few more of the 
    HL> --no-site-files, --no-init-files, options should go into the R 2.9 versions of SHLIB, INSTALL, etc?

R 2.9.x  uses  R code instead of the previous perl code for 
INSTALL. That's the explanation for the difference.

I agree that it would be quite useful if they supported features
as you mention, and we (R-core) will be very willing to accept
(well-tested) patches enabling that.

Regards,
Martin Maechler, ETH Zurich


From olafm at kimberly.tako.de  Fri Jul 17 19:15:08 2009
From: olafm at kimberly.tako.de (Olaf Mersmann)
Date: Fri, 17 Jul 2009 19:15:08 +0200
Subject: [Rd] model.matrix memory problem (PR#13838)
In-Reply-To: <20090716152011.1002A2831FE4@mail.pubhealth.ku.dk>
References: <20090716152011.1002A2831FE4@mail.pubhealth.ku.dk>
Message-ID: <1247850626-sup-3168@bloxx.rothe>

Hi,

Excerpts from Torsten.Hothorn's message of Thu Jul 16 17:20:10 +0200 2009:
> `model.matrix' might kill R with a segfault (on a illposed problem, but anyway):
> 
> mydf <- as.data.frame(sapply(1:40, function(i) gl(2, 100)))
> f <- as.formula(paste("~ - 1 + ", paste(names(mydf), collapse = ":"), sep = ""))
> X <- model.matrix(f, data = mydf)
> 
>   *** caught segfault ***
> address 0x18, cause 'memory not mapped'
> Segmentation fault

I've taken a look at this. The problem lies in lines 1784 - 1798 of
src/main/model.c. What happens is that 'k' overflows (signed
int). That means k is 0 after the loop an nc is set to 0. That means
the allocated model matrix 'x' is too small which results in the
observed segfault. 

I can provide a patch which checks for overflow and throws an error if
that is the desired behaviour.

Greetings,
Olaf Mersmann


From murdoch at stats.uwo.ca  Fri Jul 17 19:39:36 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 17 Jul 2009 13:39:36 -0400
Subject: [Rd] model.matrix memory problem (PR#13838)
In-Reply-To: <1247850626-sup-3168@bloxx.rothe>
References: <20090716152011.1002A2831FE4@mail.pubhealth.ku.dk>
	<1247850626-sup-3168@bloxx.rothe>
Message-ID: <4A60B758.4050707@stats.uwo.ca>

On 7/17/2009 1:15 PM, Olaf Mersmann wrote:
> Hi,
> 
> Excerpts from Torsten.Hothorn's message of Thu Jul 16 17:20:10 +0200 2009:
>> `model.matrix' might kill R with a segfault (on a illposed problem, but anyway):
>> 
>> mydf <- as.data.frame(sapply(1:40, function(i) gl(2, 100)))
>> f <- as.formula(paste("~ - 1 + ", paste(names(mydf), collapse = ":"), sep = ""))
>> X <- model.matrix(f, data = mydf)
>> 
>>   *** caught segfault ***
>> address 0x18, cause 'memory not mapped'
>> Segmentation fault
> 
> I've taken a look at this. The problem lies in lines 1784 - 1798 of
> src/main/model.c. What happens is that 'k' overflows (signed
> int). That means k is 0 after the loop an nc is set to 0. That means
> the allocated model matrix 'x' is too small which results in the
> observed segfault. 
> 
> I can provide a patch which checks for overflow and throws an error if
> that is the desired behaviour.

Thanks for tracking this down.  I'll fix it; your patch would likely be 
helpful, but your description is clear enough.

Duncan Murdoch


From steve.kembel at gmail.com  Sat Jul 18 01:30:49 2009
From: steve.kembel at gmail.com (Steven Kembel)
Date: Fri, 17 Jul 2009 16:30:49 -0700
Subject: [Rd] Any workaround for CRAN Mac OS X compiler switch to R 2.10.0?
Message-ID: <7C4541BB-4CFB-4D30-BF4B-B61274F9A9A5@gmail.com>

Hello,

Has the CRAN compiler for Mac OS X switched to using R 2.10? I  
recently uploaded an update for the package I maintain to CRAN, and  
it's no longer possible to run the package after installing CRAN  
binaries for this package under Mac OS X 10.5 and R 2.9.1.

The package is picante 0.7-1. It passes all checks on CRAN cleanly.  
Under R 2.9.1 on Mac OS X 10.5, the package can be installed from CRAN  
binaries, but fails to load (see example output at end of this  
message). This can be worked around by installing from source.

The error seems to be related to looking for and not finding the file  
"/Library/Frameworks/R.framework/Versions/2.10/Resources/lib/ 
libR.dylib" when installed from binaries.

Is anyone else experiencing this, and is there some workaround?

Thanks,
Steve

Code to replicate this problem (R 2.9.1, Mac OS X 10.5):

 > install.packages('picante')
trying URL 'http://ftp5.gwdg.de/pub/misc/cran/bin/macosx/universal/contrib/2.9/picante_0.7-1.tgz'
Content type 'application/x-gzip' length 117452 bytes (114 Kb)
opened URL
==================================================
downloaded 114 Kb

The downloaded packages are in
	/var/folders/Ei/EiJQkAf0G-WsCO80yfEpKU+++TI/-Tmp-//RtmpZUZOIo/ 
downloaded_packages
 > library(picante)
Loading required package: ape
Loading required package: vegan
This is vegan 1.15-3
Loading required package: nlme
Error in dyn.load(file, DLLpath = DLLpath, ...) :
unable to load shared library '/Library/Frameworks/R.framework/ 
Resources/library/picante/libs/i386/picante.so':
dlopen(/Library/Frameworks/R.framework/Resources/library/picante/libs/ 
i386/picante.so, 6): Library not loaded: /Library/Frameworks/ 
R.framework/Versions/2.10/Resources/lib/libR.dylib
Referenced from: /Library/Frameworks/R.framework/Resources/library/ 
picante/libs/i386/picante.so
Reason: image not found
In addition: Warning message:
package 'picante' was built under R version 2.10.0
Error in library(picante) : .First.lib failed for 'picante'
 >


From khansen at stat.berkeley.edu  Sat Jul 18 02:55:21 2009
From: khansen at stat.berkeley.edu (Kasper Daniel Hansen)
Date: Fri, 17 Jul 2009 17:55:21 -0700
Subject: [Rd] Any workaround for CRAN Mac OS X compiler switch to R
	2.10.0?
In-Reply-To: <7C4541BB-4CFB-4D30-BF4B-B61274F9A9A5@gmail.com>
References: <7C4541BB-4CFB-4D30-BF4B-B61274F9A9A5@gmail.com>
Message-ID: <44E94360-4938-4644-A4AF-890043BE00C8@stat.berkeley.edu>

This has been discussed on the R-sig-mac email list. The short answer  
is that something bad happened (bad = R-devel was used to compile CRAN  
packages) and Simon (who is maintaining this) was traveling. He is  
working on the problem now. A fix should happen "soon".

Kasper

On Jul 17, 2009, at 16:30 , Steven Kembel wrote:

> Hello,
>
> Has the CRAN compiler for Mac OS X switched to using R 2.10? I  
> recently uploaded an update for the package I maintain to CRAN, and  
> it's no longer possible to run the package after installing CRAN  
> binaries for this package under Mac OS X 10.5 and R 2.9.1.
>
> The package is picante 0.7-1. It passes all checks on CRAN cleanly.  
> Under R 2.9.1 on Mac OS X 10.5, the package can be installed from  
> CRAN binaries, but fails to load (see example output at end of this  
> message). This can be worked around by installing from source.
>
> The error seems to be related to looking for and not finding the  
> file "/Library/Frameworks/R.framework/Versions/2.10/Resources/lib/ 
> libR.dylib" when installed from binaries.
>
> Is anyone else experiencing this, and is there some workaround?
>
> Thanks,
> Steve
>
> Code to replicate this problem (R 2.9.1, Mac OS X 10.5):
>
> > install.packages('picante')
> trying URL 'http://ftp5.gwdg.de/pub/misc/cran/bin/macosx/universal/contrib/2.9/picante_0.7-1.tgz'
> Content type 'application/x-gzip' length 117452 bytes (114 Kb)
> opened URL
> ==================================================
> downloaded 114 Kb
>
> The downloaded packages are in
> 	/var/folders/Ei/EiJQkAf0G-WsCO80yfEpKU+++TI/-Tmp-//RtmpZUZOIo/ 
> downloaded_packages
> > library(picante)
> Loading required package: ape
> Loading required package: vegan
> This is vegan 1.15-3
> Loading required package: nlme
> Error in dyn.load(file, DLLpath = DLLpath, ...) :
> unable to load shared library '/Library/Frameworks/R.framework/ 
> Resources/library/picante/libs/i386/picante.so':
> dlopen(/Library/Frameworks/R.framework/Resources/library/picante/ 
> libs/i386/picante.so, 6): Library not loaded: /Library/Frameworks/ 
> R.framework/Versions/2.10/Resources/lib/libR.dylib
> Referenced from: /Library/Frameworks/R.framework/Resources/library/ 
> picante/libs/i386/picante.so
> Reason: image not found
> In addition: Warning message:
> package 'picante' was built under R version 2.10.0
> Error in library(picante) : .First.lib failed for 'picante'
> >
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From htl10 at users.sourceforge.net  Sat Jul 18 00:31:53 2009
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Fri, 17 Jul 2009 22:31:53 +0000 (GMT)
Subject: [Rd] R 2.8->2.9 change that breaks some upgrade scenarios
In-Reply-To: <19040.27300.43795.372323@lynne.math.ethz.ch>
Message-ID: <492097.10150.qm@web23103.mail.ird.yahoo.com>

--- On Fri, 17/7/09, Martin Maechler <maechler at stat.math.ethz.ch> wrote:

> >>>>> "HL" == Hin-Tak Leung <htl10 at users.sourceforge.net>
> >>>>>     on Mon, 6 Jul 2009 15:23:07 -0700 (PDT) writes:
> 
>     HL> I finally got round to look at a
> little problem I have - most of the time when I use R I
> would be using snpMatrix (now part of bioconductor, I wrote
> a substantial part of), so I had $HOME/.Rprofile to save
> some typing. Upgrading, switching versions used to work fine
> with R 2.8 then it broke with 2.9..
> 
>     HL> Apparently it is because most of
> SHLIB, INSTALL, etc used to be fairly extensive shell
> scripts in R 2.8 where options not specific to a particular
> script is passed to R itself. Those scripts also do more of
> --vanilla (--no-site-files, --no-init-files, etc), and it is
> also possible to pass --vanilla, etc explicitly. The R 2.9
> implementations of these scripts are fairly thin wrappers of
> R routines, and they silently(?) ignore extra options.
> 
>     HL> The specific behaviors of the scripts
> are probably not gauranteed, and it is no problem
> temporarily moving .Rprofile away, etc for the occasional
> installations/upgrade of packages, but I think it is a valid
> scenario to want to have a site-/user-customized profile for
> day-to-day R usage, and a clean/vanilla R session for
> installation, etc. A few more of the 
>     HL> --no-site-files, --no-init-files,
> options should go into the R 2.9 versions of SHLIB, INSTALL,
> etc?
> 
> R 2.9.x  uses  R code instead of the previous perl code for 
> INSTALL. That's the explanation for the difference.
> 
> I agree that it would be quite useful if they supported
> features as you mention, and we (R-core) will be very willing to
> accept (well-tested) patches enabling that.

I had a bit more thoughts on this issue since - the R 2.8 behavior (disabling user/site customization) during package installation is probably more sensible; I don't know of any user/site customization that are useful/necessary during installation. Adding --vanilla to SHLIB, INSTALL is fairly trivial? (unfortunately, with R 2.9 one can no longer do 'R --vanilla CMD INSTALL ...' for reasons I already explained, as the --vanilla option in R 2.9 needs to go inside of the INSTALL script to have any effect). I can submit a patch fairly easily, but I guess the question is, is there any scenario where one *wants* site/user customization active during package installation?

Unfortunately with the R 2.9 implementation of those scripts, it is all or nothing. (all command line arguments are passed to R routines inside R for processing; there is no mechanism to modify how R is started in the new R 2..9 scripts. Well, with some extensive/painful change it is possible, but then it is basically and conceptually reverting back to the R 2.8 way with an extensive shell script wrapper).





From htl10 at users.sourceforge.net  Sat Jul 18 00:48:29 2009
From: htl10 at users.sourceforge.net (Hin-Tak Leung)
Date: Fri, 17 Jul 2009 22:48:29 +0000 (GMT)
Subject: [Rd] R 2.8->2.9 change that breaks some upgrade scenarios
In-Reply-To: <19040.27300.43795.372323@lynne.math.ethz.ch>
Message-ID: <240855.17655.qm@web23103.mail.ird.yahoo.com>

--- On Fri, 17/7/09, Martin Maechler <maechler at stat.math.ethz.ch> wrote:

> R 2.9.x? uses? R code instead of the previous perl code for 
> INSTALL. That's the explanation for the difference.
> 
> I agree that it would be quite useful if they supported features
> as you mention, and we (R-core) will be very willing to accept
> (well-tested) patches enabling that.

I just checked R trunk - only "SHLIB", "INSTALL", "REMOVE" has undergone the shell/perl script->R routine transformation. I would suggest just adding --vanilla to those three. (personally I have never used the last one - just dumping the package directory from within the library directory normally remove almost all trace of a package anyway).

Hin-Tak





From maechler at stat.math.ethz.ch  Sat Jul 18 10:51:17 2009
From: maechler at stat.math.ethz.ch (maechler at stat.math.ethz.ch)
Date: Sat, 18 Jul 2009 10:51:17 +0200 (CEST)
Subject: [Rd] box and whisker (PR#13821)
Message-ID: <20090718085117.DEA4C282EF50@mail.pubhealth.ku.dk>

>>>>> "PD" == Peter Dalgaard <p.dalgaard at biostat.ku.dk>
>>>>>     on Sun, 12 Jul 2009 11:11:37 +0200 writes:

    PD> m.crawley at imperial.ac.uk wrote:
    >> In a Box and Whisker plot, I thought that when there are outliers both abov=
    >> e and below the whiskers, then the whiskers should both be the same length =
    >> (plus or minus 1.5 times the inter-quartile range).

    PD> Not according to the docs:

    PD> range: this determines how far the plot whiskers extend out from the
    PD> box.  If 'range' is positive, the whiskers extend to the most
    PD> extreme data point which is no more than 'range' times the
    PD> interquartile range from the box. A value of zero causes the
    PD> whiskers to extend to the data extremes.

    PD> And the code itself has

    PD> stats[c(1, 5)] <- range(x[!out], na.rm = TRUE)

    PD> So the whisker won't be equal to 1.5 IQR unless there happens to be an 
    PD> observation there.

    PD> Now, this might be wrong, but people have tried very hard to make the 
    PD> implementation follow the original definition due to Tukey. I.e., if you 
    PD> can point out that Tukey specified it otherwise, then we'd change it, 
    PD> otherwise it is just not a bug.

I'd bet pretty large amounts that we (and S and S-plus probably
quite few otherpackages) have implemented the whiskers the way
JWT defined them, very purposefully.

One of JWT's point *was* exactly that most of the values "drawn"
represent *observations* (and those that do not use
exact mid points of obs.):
It's not by coincidence or even queerness that the box is *not*
delineated by the usual quartiles, but rather the *hinges*

[ Digression about hinges vs quartiles : 

   ?boxplot.stats

  has a section 'Details'  to which I had added such information about
  decade ago.
  Whereas our R help pages ( ?boxplot.stats,  ?fivenum ) 
  do use the correct definitions,
  unfortunately many other places do *not*, e.g., even the
  Wikipedia page  http://en.wikipedia.org/wiki/Five-number_summary
  wrongly talks about 1st and 3rd quartile,
  but then at least uses a numerical example using the hinges
]

Martin Maechler, ETH Zurich

    >> If you look at the plot for SilwoodWeather on p.155 of The R Book you will =
    >> see that for November (month =3D 11) the upper whisker is shorter than the =
    >> lower, while for other months with outliers both above and below, the lines=
    >> are the same lengths.

    PD> For easier reproduction (reproducible examples should not refer to files 
    PD> on your C: drive...):

    >> diff(boxplot({set.seed(9);x<-rnorm(50)})$stats)
    PD> [,1]
    PD> [1,] 1.2525857
    PD> [2,] 0.5412128
    PD> [3,] 0.6083348
    PD> [4,] 1.4625057



    PD> -- 
    PD> O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
    PD> c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
    PD> (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
    PD> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907

    PD> ______________________________________________
    PD> R-devel at r-project.org mailing list
    PD> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch at stats.uwo.ca  Sat Jul 18 14:15:12 2009
From: murdoch at stats.uwo.ca (murdoch at stats.uwo.ca)
Date: Sat, 18 Jul 2009 14:15:12 +0200 (CEST)
Subject: [Rd] [R] Problem With Repeated Use Of Load/Save/Close Commands
	(PR#13841)
Message-ID: <20090718121512.5F3AC282EF2D@mail.pubhealth.ku.dk>

On 17/07/2009 7:57 PM, Marilyn & Rich Short wrote:
> Hello,
> 
> I'm having a problem in R with repeated use of the "load", "save", and 
> "close" commands. I'm getting an error message that reads, "Too many 
> open files". I'm opening files and closing them (and unlinking them), 
> but when I go through that process 509 times, the program halts and I 
> get this error message: "cannot open the connection" with warning 
> messages: "Too many open files".  I've been working on this problem for 
> a couple of weeks and have gleaned a bit of info from different internet 
> threads, but no solutions yet.
> 
> I'm using Windows XP, SP3 and R 2.9.1.
> Here is my session info:
> 
> R version 2.9.1 (2009-06-26)
> i286-pc-mingw32
> 
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> States. 1252;LC_MONETARY=English_United
> States. 1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> I'm using the vanilla load of R, with nothing added after booting up.
> The problem also occurs on my Vista machine as well.
> 
> The program below will induce the problem.
> ------------------------------------------------------------
>    junk       = 1
>    PathA    = tempdir()
>    conX     = paste(PathA,"junk",sep="\\")
>    outJunk  = file(conX, open="wb")
>    save(junk, file=outJunk)
>    close(outJunk)
>    for(i in 1:4000){
>        outMIA = file(conX, open="rb")
>        load(file=outMIA)
>        close(outMIA)
>        closeAllConnections()
>        unlink(conX)
>        rm(outMIA)
>        rm(junk)
>        cat(" i = ",i,sep=" ")
>        gc()
>        zzz = showConnections(all=FALSE)
>        cat(" zzz = ",zzz,"\n",sep=" ")
>    }
> --------------------------------------------------------------------
> There is some talk on the internet that some windows systems have a 
> limit of 512 files that can be open at one time. Even though I'm closing 
> my files each time, something is keeping track of how many times I've 
> opened and closed a file in a session. I've talked to Microsoft and run 
> a test program in Visual Studio C#, and, at the moment, it looks like 
> the problem does not lie in the Microsoft arena. The C# program 
> performed a similar task 10,000 times without a problem. I'm not totally 
> convinced, but the current evidence says to look elsewhere.
> 
> I've attached a script that will induce the problem. However, be warned 
> that, if you use it, you will have to get out of R after you run it. R 
> will no longer be able to access files such as help or sessionInfo(). 
> This can be solved by getting out of the R GUI and back in.
> 
> R E-mails from as far back as 2006 ask for help on the issue. There have 
> been several suggestions, but no confirmed solution that I can find. You 
> will see my attempt at these suggestions in the script [ rm(outMIA); 
> rm(junk); closeAllConnections(); and gc(); after close(outMIA);  and 
> unlink(conX);]. For me, this becomes important because it limits the 
> total number if iterations in nested do-loops. This is where I ran into 
> the problem. The program above will allow you to reproduce the problem.
> 
> Any suggestion would be greatly appreciated.

This looks like a bug to me, and so I've posted it to the bugs list, but 
your script doesn't make sense for normal use.  Before the loop you 
create a file named according to conX containing the junk variable, and 
then within the loop you load that file, *then delete it*, using 
unlink().  However, if you examine the value of unlink(), you'll see 
that it fails every time.

Moreover, the use of connections is unnecessary:  load() can work with a 
filename.  So you can skip the file() and close() calls.

If I simplify your script by removing the unnecessary stuff, then it 
works.  That is, this works:

     junk       = 1
     PathA    = tempdir()
     conX     = paste(PathA,"junk",sep="\\")
     save(junk, file=conX)
     for(i in 1:4000){
         load(file=conX)
         rm(junk)
         cat(" i = ",i,sep=" ")
         gc()
         zzz = showConnections(all=FALSE)
         cat(" zzz = ",zzz,"\n",sep=" ")
     }

So a suggestion for a workaround is simply to follow the pattern above, 
rather than that of your demonstration code.

I'll spend a bit more time and see if I can find what is causing the 
open file leak.

Duncan Murdoch


From murdoch at stats.uwo.ca  Sat Jul 18 18:19:50 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 18 Jul 2009 12:19:50 -0400
Subject: [Rd] [R] Problem With Repeated Use Of Load/Save/Close Commands
 (PR#13841)
In-Reply-To: <20090718121512.5F3AC282EF2D@mail.pubhealth.ku.dk>
References: <20090718121512.5F3AC282EF2D@mail.pubhealth.ku.dk>
Message-ID: <4A61F626.2040004@stats.uwo.ca>

On 18/07/2009 8:15 AM, murdoch at stats.uwo.ca wrote:
> On 17/07/2009 7:57 PM, Marilyn & Rich Short wrote:
>> Hello,
>>
>> I'm having a problem in R with repeated use of the "load", "save", and 
>> "close" commands. I'm getting an error message that reads, "Too many 
>> open files". I'm opening files and closing them (and unlinking them), 
>> but when I go through that process 509 times, the program halts and I 
>> get this error message: "cannot open the connection" with warning 
>> messages: "Too many open files".  I've been working on this problem for 
>> a couple of weeks and have gleaned a bit of info from different internet 
>> threads, but no solutions yet.
>>
>> I'm using Windows XP, SP3 and R 2.9.1.
>> Here is my session info:
>>
>> R version 2.9.1 (2009-06-26)
>> i286-pc-mingw32
>>
>> locale:
>> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
>> States. 1252;LC_MONETARY=English_United
>> States. 1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> I'm using the vanilla load of R, with nothing added after booting up.
>> The problem also occurs on my Vista machine as well.
>>
>> The program below will induce the problem.
>> ------------------------------------------------------------
>>    junk       = 1
>>    PathA    = tempdir()
>>    conX     = paste(PathA,"junk",sep="\\")
>>    outJunk  = file(conX, open="wb")
>>    save(junk, file=outJunk)
>>    close(outJunk)
>>    for(i in 1:4000){
>>        outMIA = file(conX, open="rb")
>>        load(file=outMIA)
>>        close(outMIA)
>>        closeAllConnections()
>>        unlink(conX)
>>        rm(outMIA)
>>        rm(junk)
>>        cat(" i = ",i,sep=" ")
>>        gc()
>>        zzz = showConnections(all=FALSE)
>>        cat(" zzz = ",zzz,"\n",sep=" ")
>>    }
>> --------------------------------------------------------------------
>> There is some talk on the internet that some windows systems have a 
>> limit of 512 files that can be open at one time. Even though I'm closing 
>> my files each time, something is keeping track of how many times I've 
>> opened and closed a file in a session. I've talked to Microsoft and run 
>> a test program in Visual Studio C#, and, at the moment, it looks like 
>> the problem does not lie in the Microsoft arena. The C# program 
>> performed a similar task 10,000 times without a problem. I'm not totally 
>> convinced, but the current evidence says to look elsewhere.
>>
>> I've attached a script that will induce the problem. However, be warned 
>> that, if you use it, you will have to get out of R after you run it. R 
>> will no longer be able to access files such as help or sessionInfo(). 
>> This can be solved by getting out of the R GUI and back in.
>>
>> R E-mails from as far back as 2006 ask for help on the issue. There have 
>> been several suggestions, but no confirmed solution that I can find. You 
>> will see my attempt at these suggestions in the script [ rm(outMIA); 
>> rm(junk); closeAllConnections(); and gc(); after close(outMIA);  and 
>> unlink(conX);]. For me, this becomes important because it limits the 
>> total number if iterations in nested do-loops. This is where I ran into 
>> the problem. The program above will allow you to reproduce the problem.
>>
>> Any suggestion would be greatly appreciated.
> 
> This looks like a bug to me, and so I've posted it to the bugs list, but 
> your script doesn't make sense for normal use.  Before the loop you 
> create a file named according to conX containing the junk variable, and 
> then within the loop you load that file, *then delete it*, using 
> unlink().  However, if you examine the value of unlink(), you'll see 
> that it fails every time.
> 
> Moreover, the use of connections is unnecessary:  load() can work with a 
> filename.  So you can skip the file() and close() calls.
> 
> If I simplify your script by removing the unnecessary stuff, then it 
> works.  That is, this works:
> 
>      junk       = 1
>      PathA    = tempdir()
>      conX     = paste(PathA,"junk",sep="\\")
>      save(junk, file=conX)
>      for(i in 1:4000){
>          load(file=conX)
>          rm(junk)
>          cat(" i = ",i,sep=" ")
>          gc()
>          zzz = showConnections(all=FALSE)
>          cat(" zzz = ",zzz,"\n",sep=" ")
>      }
> 
> So a suggestion for a workaround is simply to follow the pattern above, 
> rather than that of your demonstration code.
> 
> I'll spend a bit more time and see if I can find what is causing the 
> open file leak.

Now fixed in R-devel, R-patched coming soon.

Duncan Murdoch


From murdoch at stats.uwo.ca  Sat Jul 18 18:25:16 2009
From: murdoch at stats.uwo.ca (murdoch at stats.uwo.ca)
Date: Sat, 18 Jul 2009 18:25:16 +0200 (CEST)
Subject: [Rd] [R] Problem With Repeated Use Of Load/Save/Close Commands
	(PR#13842)
Message-ID: <20090718162516.87AFA282EF2D@mail.pubhealth.ku.dk>

On 18/07/2009 8:15 AM, murdoch at stats.uwo.ca wrote:
> On 17/07/2009 7:57 PM, Marilyn & Rich Short wrote:
>> Hello,
>>
>> I'm having a problem in R with repeated use of the "load", "save", and 
>> "close" commands. I'm getting an error message that reads, "Too many 
>> open files". I'm opening files and closing them (and unlinking them), 
>> but when I go through that process 509 times, the program halts and I 
>> get this error message: "cannot open the connection" with warning 
>> messages: "Too many open files".  I've been working on this problem for 
>> a couple of weeks and have gleaned a bit of info from different internet 
>> threads, but no solutions yet.
>>
>> I'm using Windows XP, SP3 and R 2.9.1.
>> Here is my session info:
>>
>> R version 2.9.1 (2009-06-26)
>> i286-pc-mingw32
>>
>> locale:
>> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
>> States. 1252;LC_MONETARY=English_United
>> States. 1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> I'm using the vanilla load of R, with nothing added after booting up.
>> The problem also occurs on my Vista machine as well.
>>
>> The program below will induce the problem.
>> ------------------------------------------------------------
>>    junk       = 1
>>    PathA    = tempdir()
>>    conX     = paste(PathA,"junk",sep="\\")
>>    outJunk  = file(conX, open="wb")
>>    save(junk, file=outJunk)
>>    close(outJunk)
>>    for(i in 1:4000){
>>        outMIA = file(conX, open="rb")
>>        load(file=outMIA)
>>        close(outMIA)
>>        closeAllConnections()
>>        unlink(conX)
>>        rm(outMIA)
>>        rm(junk)
>>        cat(" i = ",i,sep=" ")
>>        gc()
>>        zzz = showConnections(all=FALSE)
>>        cat(" zzz = ",zzz,"\n",sep=" ")
>>    }
>> --------------------------------------------------------------------
>> There is some talk on the internet that some windows systems have a 
>> limit of 512 files that can be open at one time. Even though I'm closing 
>> my files each time, something is keeping track of how many times I've 
>> opened and closed a file in a session. I've talked to Microsoft and run 
>> a test program in Visual Studio C#, and, at the moment, it looks like 
>> the problem does not lie in the Microsoft arena. The C# program 
>> performed a similar task 10,000 times without a problem. I'm not totally 
>> convinced, but the current evidence says to look elsewhere.
>>
>> I've attached a script that will induce the problem. However, be warned 
>> that, if you use it, you will have to get out of R after you run it. R 
>> will no longer be able to access files such as help or sessionInfo(). 
>> This can be solved by getting out of the R GUI and back in.
>>
>> R E-mails from as far back as 2006 ask for help on the issue. There have 
>> been several suggestions, but no confirmed solution that I can find. You 
>> will see my attempt at these suggestions in the script [ rm(outMIA); 
>> rm(junk); closeAllConnections(); and gc(); after close(outMIA);  and 
>> unlink(conX);]. For me, this becomes important because it limits the 
>> total number if iterations in nested do-loops. This is where I ran into 
>> the problem. The program above will allow you to reproduce the problem.
>>
>> Any suggestion would be greatly appreciated.
> 
> This looks like a bug to me, and so I've posted it to the bugs list, but 
> your script doesn't make sense for normal use.  Before the loop you 
> create a file named according to conX containing the junk variable, and 
> then within the loop you load that file, *then delete it*, using 
> unlink().  However, if you examine the value of unlink(), you'll see 
> that it fails every time.
> 
> Moreover, the use of connections is unnecessary:  load() can work with a 
> filename.  So you can skip the file() and close() calls.
> 
> If I simplify your script by removing the unnecessary stuff, then it 
> works.  That is, this works:
> 
>      junk       = 1
>      PathA    = tempdir()
>      conX     = paste(PathA,"junk",sep="\\")
>      save(junk, file=conX)
>      for(i in 1:4000){
>          load(file=conX)
>          rm(junk)
>          cat(" i = ",i,sep=" ")
>          gc()
>          zzz = showConnections(all=FALSE)
>          cat(" zzz = ",zzz,"\n",sep=" ")
>      }
> 
> So a suggestion for a workaround is simply to follow the pattern above, 
> rather than that of your demonstration code.
> 
> I'll spend a bit more time and see if I can find what is causing the 
> open file leak.

Now fixed in R-devel, R-patched coming soon.

Duncan Murdoch


From simon.urbanek at r-project.org  Sat Jul 18 19:06:10 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Sat, 18 Jul 2009 13:06:10 -0400
Subject: [Rd] Any workaround for CRAN Mac OS X compiler switch to R
	2.10.0?
In-Reply-To: <44E94360-4938-4644-A4AF-890043BE00C8@stat.berkeley.edu>
References: <7C4541BB-4CFB-4D30-BF4B-B61274F9A9A5@gmail.com>
	<44E94360-4938-4644-A4AF-890043BE00C8@stat.berkeley.edu>
Message-ID: <027CABAE-E917-4560-B924-B4BDF25FA9BF@r-project.org>


On Jul 17, 2009, at 8:55 PM, Kasper Daniel Hansen wrote:

> This has been discussed on the R-sig-mac email list. The short  
> answer is that something bad happened (bad = R-devel was used to  
> compile CRAN packages) and Simon (who is maintaining this) was  
> traveling. He is working on the problem now. A fix should happen  
> "soon".
>

This is now fixed, but may take a while until all mirrors have caught  
up. You can use the http://r.urbanek.info/ master mirror in the  
meantime.

In fact it affected only a handful packages that didn't build due to  
dependency issues.

Cheers,
Simon



>
> On Jul 17, 2009, at 16:30 , Steven Kembel wrote:
>
>> Hello,
>>
>> Has the CRAN compiler for Mac OS X switched to using R 2.10? I  
>> recently uploaded an update for the package I maintain to CRAN, and  
>> it's no longer possible to run the package after installing CRAN  
>> binaries for this package under Mac OS X 10.5 and R 2.9.1.
>>
>> The package is picante 0.7-1. It passes all checks on CRAN cleanly.  
>> Under R 2.9.1 on Mac OS X 10.5, the package can be installed from  
>> CRAN binaries, but fails to load (see example output at end of this  
>> message). This can be worked around by installing from source.
>>
>> The error seems to be related to looking for and not finding the  
>> file "/Library/Frameworks/R.framework/Versions/2.10/Resources/lib/ 
>> libR.dylib" when installed from binaries.
>>
>> Is anyone else experiencing this, and is there some workaround?
>>
>> Thanks,
>> Steve
>>
>> Code to replicate this problem (R 2.9.1, Mac OS X 10.5):
>>
>> > install.packages('picante')
>> trying URL 'http://ftp5.gwdg.de/pub/misc/cran/bin/macosx/universal/contrib/2.9/picante_0.7-1.tgz'
>> Content type 'application/x-gzip' length 117452 bytes (114 Kb)
>> opened URL
>> ==================================================
>> downloaded 114 Kb
>>
>> The downloaded packages are in
>> 	/var/folders/Ei/EiJQkAf0G-WsCO80yfEpKU+++TI/-Tmp-//RtmpZUZOIo/ 
>> downloaded_packages
>> > library(picante)
>> Loading required package: ape
>> Loading required package: vegan
>> This is vegan 1.15-3
>> Loading required package: nlme
>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>> unable to load shared library '/Library/Frameworks/R.framework/ 
>> Resources/library/picante/libs/i386/picante.so':
>> dlopen(/Library/Frameworks/R.framework/Resources/library/picante/ 
>> libs/i386/picante.so, 6): Library not loaded: /Library/Frameworks/ 
>> R.framework/Versions/2.10/Resources/lib/libR.dylib
>> Referenced from: /Library/Frameworks/R.framework/Resources/library/ 
>> picante/libs/i386/picante.so
>> Reason: image not found
>> In addition: Warning message:
>> package 'picante' was built under R version 2.10.0
>> Error in library(picante) : .First.lib failed for 'picante'
>> >
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From maechler at stat.math.ethz.ch  Mon Jul 20 10:32:14 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 20 Jul 2009 10:32:14 +0200
Subject: [Rd] slight inconsistency in <Factorize>( <logical matrix> )
Message-ID: <19044.11150.920656.512693@lynne.math.ethz.ch>

We have a very slight inconsistency in the treatment of logical
matrices with our three major factorizations:

qr() coerces to numeric , whereas
svd() and eigen() give an error.

I'm proposing to change  svd() and eigen() such that they also
treat a logical matrix as if it was 0-1 ,  analogously to all
other arithmetic operations.

Martin Maechler, R Core Team & ETH Zurich


From mtmorgan at fhcrc.org  Mon Jul 20 15:01:03 2009
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Mon, 20 Jul 2009 06:01:03 -0700
Subject: [Rd] tabulate can accept NA values?
Message-ID: <6phocrfld9s.fsf@gopher4.fhcrc.org>

tabulate has

    .C("R_tabulate", as.integer(bin), as.integer(length(bin)),
       as.integer(nbins), ans = integer(nbins), PACKAGE="base")$ans

The implementation of R_tabulate has

  	if(x[i] != R_NaInt && x[i] > 0 && x[i] <= *nbin)

and so copes with (silently drops) NA. Perhaps the .C could have
NAOK=TRUE? This is useful in apply'ing tabulate to the rows or columns
of a (large) matrix, where the work-around involves introducing some
artificial NA value (and consequently copying the matrix) outside the
range of tabulate's nbin argument.

Martin  
-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From krcoombes at mdacc.tmc.edu  Mon Jul 20 20:11:58 2009
From: krcoombes at mdacc.tmc.edu (Kevin R. Coombes)
Date: Mon, 20 Jul 2009 13:11:58 -0500
Subject: [Rd] Rcmd check fails on Windows Samba network path in R 2.9.1
Message-ID: <4A64B36E.8040405@mdacc.tmc.edu>

Hi,

I have just updated R from version 2.8.1 to version 2.9.1.  I am running 
Windows XP Professional, Service Pack 3.

With the update, I decided to update a set of packages that I maintain 
by compiling them for the new version.  Everything worked fine except 
for one package.  This package is unique (among the six I was working 
on) in that is stored on a UNIX-based file server that is exported to 
the Windows network via Samba.  The root of that network path is mapped 
to drive "N:" on the local machine.

'Rcmd check' fails for this package under 2.9.1.  The error message in 
'00install.out'  is:
"Error: ERROR: no permission to install to directory 
'N:/krc/Umpire/R-Package/Umpire.Rcheck'"

'Rcmd check' works for this package under 2.8.1.

'Rcmd check' works for this package if the directory is copied onto a 
local hard drive instead of the network drive.

'Rcmd build' and 'Rcmd build --binary' work under both versions.

It would be nice if someone could figure out what has changed and fix it....

Best,
    Kevin Coombes


From khansen at stat.berkeley.edu  Mon Jul 20 23:02:21 2009
From: khansen at stat.berkeley.edu (Kasper Daniel Hansen)
Date: Mon, 20 Jul 2009 14:02:21 -0700
Subject: [Rd] bug in seq_along
In-Reply-To: <4A5BB888.8020708@fhcrc.org>
References: <7E0D03FE-2742-4442-977F-538AE7DE920A@stat.berkeley.edu>
	<4A5BB888.8020708@fhcrc.org>
Message-ID: <427BCBED-A2DE-464E-B8A7-4FA089CA4BBC@stat.berkeley.edu>

This has now been fixed in R-2.9 and R-devel by Martin Maechler.

Thanks
Kasper

On Jul 13, 2009, at 15:43 , Herv? Pag?s wrote:

> Hi Kasper and R developers,
>
> Kasper Daniel Hansen wrote:
>> Using the IRanges package from Bioconductor and somewhat recent  
>> R-2.9.1.
>> ov = IRanges(1:3, 4:6)
>> length(ov) # 3
>> seq(along = ov) # 1 2 3 as wanted
>> seq_along(ov) # 1!
>> I had expected that the last line would yield 1:3. My guess is that  
>> somehow seq_along don't utilize that ov is an S4 class with a  
>> length method.
>
> I agree, this is not good. seq_along() has always been broken on S4
> objects:
>
>  https://stat.ethz.ch/pipermail/r-devel/2007-July/046337.html
>
> so I prefer to not use it, ever. Even when I deal with S3 objects.
> Because the day I need to extend my code to deal with S4 objects,
> it's too easy to forget to replace 'seq_along(x)' with  
> 'seq_len(length(x))'.
> So I'd rather use the latter all the time and from the very beginning
> (hopefully there is no serious performance penalty for doing this).
>
> Surprisingly, seq_along() diserves its own C implementation (why
> wouldn't seq_along <- function(x) seq_len(length(x)) be just good
> enough?). It's calling length() at the C level which is an inline
> function defined as:
>
> INLINE_FUN R_len_t length(SEXP s)
> {
>    int i;
>    switch (TYPEOF(s)) {
>    case NILSXP:
>        return 0;
>    case LGLSXP:
>    case INTSXP:
>    case REALSXP:
>    case CPLXSXP:
>    case STRSXP:
>    case CHARSXP:
>    case VECSXP:
>    case EXPRSXP:
>    case RAWSXP:
>        return LENGTH(s);
>    case LISTSXP:
>    case LANGSXP:
>    case DOTSXP:
>        i = 0;
>        while (s != NULL && s != R_NilValue) {
>            i++;
>            s = CDR(s);
>        }
>        return i;
>    case ENVSXP:
>        return Rf_envlength(s);
>    default:
>        return 1;
>    }
> }
>
> Hence it will return 1 when 's' is an S4SXP.
>
> If for whatever reason, seq_along() is not able to figure out what
> the *real* length of an S4 object is, then wouldn't it be better to
> make it return an error? Or at least to put a big warning in its
> man page saying: DON'T TRUST ME ON YOUR S4 OBJECTS, I'M BROKEN!
>
> Cheers,
> H.
>
>
>> The last line of the *Details* section of ?seq has a typeo.  
>> Currently it is
>>     'seq.int', 'seq_along' and 'seq.int' are primitive: the latter  
>> two
>>     ignore any argument name.
>> I would guess it ought to be
>>     'seq.int', 'seq_along' and 'seq_len' are primitive: the latter  
>> two
>>     ignore any argument name.
>> Kasper
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> -- 
> Herv? Pag?s
>
> Program in Computational Biology
> Division of Public Health Sciences
> Fred Hutchinson Cancer Research Center
> 1100 Fairview Ave. N, M2-B876
> P.O. Box 19024
> Seattle, WA 98109-1024
>
> E-mail: hpages at fhcrc.org
> Phone:  (206) 667-5791
> Fax:    (206) 667-1319


From tplate at acm.org  Mon Jul 20 23:07:22 2009
From: tplate at acm.org (Tony Plate)
Date: Mon, 20 Jul 2009 15:07:22 -0600
Subject: [Rd] Rcmd check fails on Windows Samba network path in R 2.9.1
In-Reply-To: <4A64B36E.8040405@mdacc.tmc.edu>
References: <4A64B36E.8040405@mdacc.tmc.edu>
Message-ID: <4A64DC8A.6040805@acm.org>

This error message looks like it comes from 
src/library/tools/R/install.R, which contains the following test:

    if (!.file_test("-d", lib) || file.access(lib, 2L))
        stop("ERROR: no permission to install to directory ",
             sQuote(lib), call. = FALSE)

The function .file_test() is defined earlier in the same file (it looks 
at file.info(lib)$isdir) and appears to be intended to be the same as 
utils:::file_test().

You could start trying to figure out what the problem is by trying these 
calls on the directory in question from an interactive R session.
(They seem to work as intended on my Windows system with a NetApp file 
system mounted on a letter drive.)

-- Tony Plate

Kevin R. Coombes wrote:
> Hi,
>
> I have just updated R from version 2.8.1 to version 2.9.1.  I am 
> running Windows XP Professional, Service Pack 3.
>
> With the update, I decided to update a set of packages that I maintain 
> by compiling them for the new version.  Everything worked fine except 
> for one package.  This package is unique (among the six I was working 
> on) in that is stored on a UNIX-based file server that is exported to 
> the Windows network via Samba.  The root of that network path is 
> mapped to drive "N:" on the local machine.
>
> 'Rcmd check' fails for this package under 2.9.1.  The error message in 
> '00install.out'  is:
> "Error: ERROR: no permission to install to directory 
> 'N:/krc/Umpire/R-Package/Umpire.Rcheck'"
>
> 'Rcmd check' works for this package under 2.8.1.
>
> 'Rcmd check' works for this package if the directory is copied onto a 
> local hard drive instead of the network drive.
>
> 'Rcmd build' and 'Rcmd build --binary' work under both versions.
>
> It would be nice if someone could figure out what has changed and fix 
> it....
>
> Best,
>    Kevin Coombes
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From rgentlem at fhcrc.org  Tue Jul 21 03:36:21 2009
From: rgentlem at fhcrc.org (Robert Gentleman)
Date: Mon, 20 Jul 2009 18:36:21 -0700
Subject: [Rd] tabulate can accept NA values?
In-Reply-To: <6phocrfld9s.fsf@gopher4.fhcrc.org>
References: <6phocrfld9s.fsf@gopher4.fhcrc.org>
Message-ID: <4A651B95.9020903@fhcrc.org>

should be in devel now, NAs are ignored (as are non-integers and things 
outside the nbin argument)

Martin Morgan wrote:
> tabulate has
> 
>     .C("R_tabulate", as.integer(bin), as.integer(length(bin)),
>        as.integer(nbins), ans = integer(nbins), PACKAGE="base")$ans
> 
> The implementation of R_tabulate has
> 
>   	if(x[i] != R_NaInt && x[i] > 0 && x[i] <= *nbin)
> 
> and so copes with (silently drops) NA. Perhaps the .C could have
> NAOK=TRUE? This is useful in apply'ing tabulate to the rows or columns
> of a (large) matrix, where the work-around involves introducing some
> artificial NA value (and consequently copying the matrix) outside the
> range of tabulate's nbin argument.
> 
> Martin  

-- 
Robert Gentleman, PhD
Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
PO Box 19024
Seattle, Washington 98109-1024
206-667-7700
rgentlem at fhcrc.org


From krcoombes at mdacc.tmc.edu  Tue Jul 21 13:55:06 2009
From: krcoombes at mdacc.tmc.edu (Kevin R. Coombes)
Date: Tue, 21 Jul 2009 06:55:06 -0500
Subject: [Rd] Rcmd check fails on Windows Samba network path in R 2.9.1
In-Reply-To: <4A64DC8A.6040805@acm.org>
References: <4A64B36E.8040405@mdacc.tmc.edu> <4A64DC8A.6040805@acm.org>
Message-ID: <4A65AC9A.9060808@mdacc.tmc.edu>

Hi,

The problem almost certainly has something to do with Samba.  We also 
have a NetApp file system, and copying the package source to that drive 
and running Rcmd check from Windows works just fine.

When running the commands from an interactive R session, file_test 
returns TRUE and file.access to test write permission indicates a 
failure, even though that information is incorrect.Here is a session 
transcript:

-----------------------------------------
 > getwd()
[1] "n:/krc/Umpire/R-Package"
 > lib <- "Umpire.Rcheck"
 > file_test("-d", lib)
[1] TRUE
 > file.access(lib, 2)
Umpire.Rcheck
           -1
 > dir.create(paste(lib, "testdir", sep='/'))
 > dir(lib)
[1] "00check.log"   "00install.out" "testdir"     
 > sessionInfo()
R version 2.9.1 (2009-06-26)
i386-pc-mingw32

locale:
LC_COLLATE=English_United States.1252;LC_CTYPE=English_United 
States.1252;LC_MONETARY=English_United 
States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base
----------------------------------------
Again, this all worked (and still works) correctly in 2.8.1.

    Kevin

Tony Plate wrote:
> This error message looks like it comes from 
> src/library/tools/R/install.R, which contains the following test:
>
>    if (!.file_test("-d", lib) || file.access(lib, 2L))
>        stop("ERROR: no permission to install to directory ",
>             sQuote(lib), call. = FALSE)
>
> The function .file_test() is defined earlier in the same file (it 
> looks at file.info(lib)$isdir) and appears to be intended to be the 
> same as utils:::file_test().
>
> You could start trying to figure out what the problem is by trying 
> these calls on the directory in question from an interactive R session.
> (They seem to work as intended on my Windows system with a NetApp file 
> system mounted on a letter drive.)
>
> -- Tony Plate
>
> Kevin R. Coombes wrote:
>> Hi,
>>
>> I have just updated R from version 2.8.1 to version 2.9.1.  I am 
>> running Windows XP Professional, Service Pack 3.
>>
>> With the update, I decided to update a set of packages that I 
>> maintain by compiling them for the new version.  Everything worked 
>> fine except for one package.  This package is unique (among the six I 
>> was working on) in that is stored on a UNIX-based file server that is 
>> exported to the Windows network via Samba.  The root of that network 
>> path is mapped to drive "N:" on the local machine.
>>
>> 'Rcmd check' fails for this package under 2.9.1.  The error message 
>> in '00install.out'  is:
>> "Error: ERROR: no permission to install to directory 
>> 'N:/krc/Umpire/R-Package/Umpire.Rcheck'"
>>
>> 'Rcmd check' works for this package under 2.8.1.
>>
>> 'Rcmd check' works for this package if the directory is copied onto a 
>> local hard drive instead of the network drive.
>>
>> 'Rcmd build' and 'Rcmd build --binary' work under both versions.
>>
>> It would be nice if someone could figure out what has changed and fix 
>> it....
>>
>> Best,
>>    Kevin Coombes
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From kjell.konis at epfl.ch  Tue Jul 21 15:32:53 2009
From: kjell.konis at epfl.ch (Kjell Konis)
Date: Tue, 21 Jul 2009 15:32:53 +0200
Subject: [Rd] strange bug? with R CMD check
Message-ID: <09DFE5E3-9AA4-47F1-8935-C4763DB008F2@epfl.ch>

Hello,

I am trying to get a package to pass R CMD check on an iMac running  
Mac OS X.  When the package is named safeBinaryRegression I get the  
following warning from R CMD check:

* checking whether the name space can be loaded with stated  
dependencies ... WARNING
Error in dyn.load(file, DLLpath = DLLpath, ...) :
   function 'make_lp' not provided by package 'lpSolveAPI'
Calls: loadNamespace -> library.dynam -> dyn.load
Execution halted

A namespace must be able to be loaded with just the base namespace  
loaded:
otherwise if the namespace gets loaded by a saved object, the session  
will
be unable to start.

Probably some imports need to be declared in the NAMESPACE file.


Here is the contents of the DESCRIPTION:

Package: safeBinaryRegression
Version: 0.1-2
Date: 2009-07-01
Title: Safe Binary Regression
Author: Kjell Konis <kjell.konis at epfl.ch>
Maintainer: Kjell Konis <kjell.konis at epfl.ch>
Depends: R (>= 2.9.1), lpSolveAPI (>= 5.5.0.14)
LinkingTo: lpSolveAPI
Description: Overloads the stats::glm function so that a test for the  
existence of
   the maximum likelihood estimate is computed as part of the fitting  
procedure for
   binary regression models.
License: GPL-2


Here is the contents of the NAMESPACE:

export(glm)
useDynLib(safeBinaryRegression, linprog, reducedLP)


The strange thing is that if I change the length of the package name  
(for example safeBinaryRegression to safeBinaryRegress) the warning  
goes away and R CMD check completes successfully.  Also, regardless of  
the package name, the package installs and runs as expected.  I'm at a  
loss trying to figure out what's going on.

To reproduce:

(1) check out the sbr package (which passes R CMD check)

   svn checkout svn://svn.r-forge.r-project.org/svnroot/sbr/pkg  
safeBinaryRegression

(2) replace sbr with safeBinaryRegression in DESCRIPTION and NAMESPACE

(3) run R CMD check


Session Info:

 > sessionInfo()
R version 2.9.1 (2009-06-26)
i386-apple-darwin8.11.1

locale:
fr_CH.UTF-8/en_US.UTF-8/C/C/fr_CH.UTF-8/fr_CH.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

Thanks,
Kjell


From tplate at acm.org  Tue Jul 21 16:19:51 2009
From: tplate at acm.org (Tony Plate)
Date: Tue, 21 Jul 2009 08:19:51 -0600
Subject: [Rd] Rcmd check fails on Windows Samba network path in R 2.9.1
In-Reply-To: <4A65AC9A.9060808@mdacc.tmc.edu>
References: <4A64B36E.8040405@mdacc.tmc.edu> <4A64DC8A.6040805@acm.org>
	<4A65AC9A.9060808@mdacc.tmc.edu>
Message-ID: <4A65CE87.2070503@acm.org>

Did you try starting up R-2.8.1 and checking the result of 
file.access(lib, 2) on that very same directory where R-2.9.1 gives an 
incorrect indication?  If that gives the correct answer, then, look for 
changes in the file.access code.

-- Tony Plate

Kevin R. Coombes wrote:
> Hi,
>
> The problem almost certainly has something to do with Samba.  We also 
> have a NetApp file system, and copying the package source to that 
> drive and running Rcmd check from Windows works just fine.
>
> When running the commands from an interactive R session, file_test 
> returns TRUE and file.access to test write permission indicates a 
> failure, even though that information is incorrect.Here is a session 
> transcript:
>
> -----------------------------------------
> > getwd()
> [1] "n:/krc/Umpire/R-Package"
> > lib <- "Umpire.Rcheck"
> > file_test("-d", lib)
> [1] TRUE
> > file.access(lib, 2)
> Umpire.Rcheck
>           -1
> > dir.create(paste(lib, "testdir", sep='/'))
> > dir(lib)
> [1] "00check.log"   "00install.out" "testdir"     > sessionInfo()
> R version 2.9.1 (2009-06-26)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United 
> States.1252;LC_MONETARY=English_United 
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> ----------------------------------------
> Again, this all worked (and still works) correctly in 2.8.1.
>
>    Kevin
>
> Tony Plate wrote:
>> This error message looks like it comes from 
>> src/library/tools/R/install.R, which contains the following test:
>>
>>    if (!.file_test("-d", lib) || file.access(lib, 2L))
>>        stop("ERROR: no permission to install to directory ",
>>             sQuote(lib), call. = FALSE)
>>
>> The function .file_test() is defined earlier in the same file (it 
>> looks at file.info(lib)$isdir) and appears to be intended to be the 
>> same as utils:::file_test().
>>
>> You could start trying to figure out what the problem is by trying 
>> these calls on the directory in question from an interactive R session.
>> (They seem to work as intended on my Windows system with a NetApp 
>> file system mounted on a letter drive.)
>>
>> -- Tony Plate
>>
>> Kevin R. Coombes wrote:
>>> Hi,
>>>
>>> I have just updated R from version 2.8.1 to version 2.9.1.  I am 
>>> running Windows XP Professional, Service Pack 3.
>>>
>>> With the update, I decided to update a set of packages that I 
>>> maintain by compiling them for the new version.  Everything worked 
>>> fine except for one package.  This package is unique (among the six 
>>> I was working on) in that is stored on a UNIX-based file server that 
>>> is exported to the Windows network via Samba.  The root of that 
>>> network path is mapped to drive "N:" on the local machine.
>>>
>>> 'Rcmd check' fails for this package under 2.9.1.  The error message 
>>> in '00install.out'  is:
>>> "Error: ERROR: no permission to install to directory 
>>> 'N:/krc/Umpire/R-Package/Umpire.Rcheck'"
>>>
>>> 'Rcmd check' works for this package under 2.8.1.
>>>
>>> 'Rcmd check' works for this package if the directory is copied onto 
>>> a local hard drive instead of the network drive.
>>>
>>> 'Rcmd build' and 'Rcmd build --binary' work under both versions.
>>>
>>> It would be nice if someone could figure out what has changed and 
>>> fix it....
>>>
>>> Best,
>>>    Kevin Coombes
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>


From vogranovich at jumptrading.com  Tue Jul 21 17:13:26 2009
From: vogranovich at jumptrading.com (Vadim Ogranovich)
Date: Tue, 21 Jul 2009 10:13:26 -0500
Subject: [Rd] building source package in R run within Emacs under Windows.
Message-ID: <22D850BC39A25742977325ADDE208E770271F720AB@chiexchange02.w2k.jumptrading.com>

Dear R-devel,

I installed R-2.9.1 on the 'y:' drive which happens to be mounted to an IBRIX file system.
I also downloaded and installed the Rtools bundle recommended for 2.9x.

When I build a source package launching R via RGui.exe it seems to work fine:

## setting path according to "Appendix E The Windows toolset"
> Sys.setenv(PATH="c:/Rtools/bin;c:/Rtools/perl/bin;c:/Rtools/MinGW/bin;c:/cygwin/bin;c:/progra~1/htmhe~1;y:/R/R-2.9.1/bin;c:/windows;c:/windows/system32")
> install.packages("c:/R/vmisc", repos=NULL, type="source", lib="y:/R/vogranovich/library")

*** 'hhc.exe' not found: not building CHM help

* Installing *source* package 'vmisc' ...
** libs
  making DLL ...
  ... done
** R
** data
** preparing package for lazy loading
** help
*** installing help indices
 >>> Building/Updating help pages for package 'vmisc'
     Formats: text html latex example
Note: removing empty section \usage in file 'vmisc.Rd'
  vmisc                             text    html    latex   example
** building package indices ...
** MD5 sums
* DONE (vmisc)

However when I run the same commands in R launched via Rterm under Emacs (ESS mode) I get this error:
> Sys.setenv(PATH="c:/Rtools/bin;c:/Rtools/perl/bin;c:/Rtools/MinGW/bin;c:/cygwin/bin;c:/progra~1/htmhe~1;y:/R/R-2.9.1/bin;c:/windows;c:/windows/system32")
> install.packages("c:/R/vmisc", repos=NULL, type="source", lib="y:/R/vogranovich/library")
[1] "y:/R/vogranovich/library" "y:/R/R-2.9.1/library"

*** 'hhc.exe' not found: not building CHM help

* Installing *source* package 'vmisc' ...
** libs
  making DLL ...
  ... done
** R
** data
** preparing package for lazy loading
** help
*** installing help indices
Can't locate R/Rdconv.pm in @INC (@INC contains: y /R/R-2.9.1/share/perl;y /R/R-2.9.1/share/perl;y /R/R-2.9.1/share/perl; /usr/lib/perl5/5.8/cygwin /usr/lib/perl5/5.8 /usr/lib/perl5/site_perl/5.8/cygwin /usr/lib/perl5/site_perl/5.8 /usr/lib/perl5/site_perl/5.8 /usr/lib/perl5/vendor_perl/5.8/cygwin /usr/lib/perl5/vendor_perl/5.8 /usr/lib/perl5/vendor_perl/5.8 .) at y:/R/R-2.9.1/share/perl/build-help.pl line 21.
BEGIN failed--compilation aborted at y:/R/R-2.9.1/share/perl/build-help.pl line 21.
ERROR: building help failed for package 'vmisc'
* Removing 'y:/R/vogranovich/library/vmisc'
* Restoring previous 'y:/R/vogranovich/library/vmisc'
Warning message:
In install.packages("c:/traders/titan/R/vmisc", repos = NULL, type = "source",  :
  installation of package 'c:/traders/titan/R/vmisc' had non-zero exit status


It seems that perl's @INC is corrupted, but I don't know how to fix it.


Here is the Emacs version info:
This is GNU Emacs 22.0.96.1 (i386-mingw-nt5.1.2600)
 of 2007-03-21 on LENNART-69DE564 (patched)

Did anyone have this problem? I understand that the process of building source packages in Windows is rather fragile so I'll be happy to live with using Rgui, but I am asking just in case someone may know.

Thanks,
Vadim

Note: This email is for the confidential use of the named addressee(s) only and may contain proprietary, confidential or privileged information. If you are not the intended recipient, you are hereby notified that any review, dissemination or copying of this email is strictly prohibited, and to please notify the sender immediately and destroy this email and any attachments.  Email transmission cannot be guaranteed to be secure or error-free.  Jump Trading, therefore, does not make any guarantees as to the completeness or accuracy of this email or any attachments.  This email is for informational purposes only and does not constitute a recommendation, offer, request or solicitation of any kind to buy, sell, subscribe, redeem or perform any type of transaction of a financial product.


From markus.jochmann at strath.ac.uk  Tue Jul 21 18:11:07 2009
From: markus.jochmann at strath.ac.uk (Markus Jochmann)
Date: Tue, 21 Jul 2009 09:11:07 -0700 (PDT)
Subject: [Rd]  Building a package with BLAS under Windows
Message-ID: <24590763.post@talk.nabble.com>


Hi everybody:

I am writing a package that includes C code that uses the BLAS library. My
Makevars looks like

PKG_LIBS = $(LAPACK_LIBS) $(BLAS_LIBS) $(FLIBS).

If I check and build the package under Linux on my own computer everything
works fine. However, if I submit the package to win-builder I get the
following error messages:

g++ -shared -s -o bzipl.dll tmp.def ars.o bzipl.o cvm_arrays.o cvm_axpym.o
cvm_cmatrix.o cvm_cmexp.o cvm_cmplx.o cvm_copym.o cvm_cpoly.o cvm_cvector.o
cvm_dmexp.o cvm_dpoly.o cvm_globals.o cvm_icamax.o cvm_icamin.o cvm_idamax.o
cvm_idamin.o cvm_infnm.o cvm_isamax.o cvm_isamin.o cvm_izamax.o cvm_izamin.o
cvm_npoly.o cvm_rmatrix.o cvm_rvector.o cvm_scalm.o cvm_scmatrix.o
cvm_smexp.o cvm_spoly.o cvm_srmatrix.o cvm_utils.o cvm_zmexp.o cvm_zpoly.o
-Ld:/Rcompile/recent/R-29~1.1/bin -lRlapack
-Ld:/Rcompile/recent/R-29~1.1/bin -lRblas -lgfortran -lgfortran
-Ld:/Rcompile/recent/R-29~1.1/bin -lR

cvm_arrays.o:cvm_arrays.cpp:(.text+0xf2): undefined reference to `sscal_'
cvm_arrays.o:cvm_arrays.cpp:(.text+0x1e2): undefined reference to `cscal_'
cvm_arrays.o:cvm_arrays.cpp:(.text+0x252): undefined reference to `csscal_'
cvm_arrays.o:cvm_arrays.cpp:(.text+0x32a): undefined reference to `caxpy_'
cvm_arrays.o:cvm_arrays.cpp:(.text+0x421): undefined reference to `saxpy_'
...

To me it looks like somehow the BLAS routines are not called correctly under
Windows.

I would be very grateful if anybody could help me.

Thanks a lot,
Markus.

-- 
View this message in context: http://www.nabble.com/Building-a-package-with-BLAS-under-Windows-tp24590763p24590763.html
Sent from the R devel mailing list archive at Nabble.com.


From dasmailinglists at gmail.com  Tue Jul 21 19:00:37 2009
From: dasmailinglists at gmail.com (David Scherrer)
Date: Tue, 21 Jul 2009 19:00:37 +0200
Subject: [Rd] destructor for S4 class objects in analogy to C++
Message-ID: <1a3e78310907211000g50935bb7l867e4a0c97fe12a@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090721/889b14b4/attachment.pl>

From armstrong.whit at gmail.com  Tue Jul 21 19:22:45 2009
From: armstrong.whit at gmail.com (Whit Armstrong)
Date: Tue, 21 Jul 2009 13:22:45 -0400
Subject: [Rd] destructor for S4 class objects in analogy to C++
In-Reply-To: <1a3e78310907211000g50935bb7l867e4a0c97fe12a@mail.gmail.com>
References: <1a3e78310907211000g50935bb7l867e4a0c97fe12a@mail.gmail.com>
Message-ID: <8ec76080907211022jbc14217h8e9654618e202654@mail.gmail.com>

if you are using external pointers, then R allows you to set a
finalizer function to be called on the pointer.

http://cran.r-project.org/doc/manuals/R-exts.html#External-pointers-and-weak-references

see examples in RODBC package.

and here too:
see the "connFinalizer" function
http://github.com/armstrtw/unifieddbi/blob/3b21da83f96de231fb14a1adaf9150fa1bc6a277/src/interface.cpp

-Whit



On Tue, Jul 21, 2009 at 1:00 PM, David
Scherrer<dasmailinglists at gmail.com> wrote:
> Hi all,
>
> I'm wondering if there is a way to define a destructor function (to free
> memory) for S4 class objects in analogy to C++?
> rm() combined with gc() does not seem to be a good idea (Chambers, 2008).
> So could it be done on the C/C++ level or is it even already available in
> the "internals"?
>
> Many thanks,
> David
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From simon.urbanek at r-project.org  Tue Jul 21 19:26:36 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 21 Jul 2009 13:26:36 -0400
Subject: [Rd] destructor for S4 class objects in analogy to C++
In-Reply-To: <1a3e78310907211000g50935bb7l867e4a0c97fe12a@mail.gmail.com>
References: <1a3e78310907211000g50935bb7l867e4a0c97fe12a@mail.gmail.com>
Message-ID: <811E2752-C23C-465B-A3E9-711FC1C6E482@r-project.org>

David,

On Jul 21, 2009, at 13:00 , David Scherrer wrote:

> I'm wondering if there is a way to define a destructor function (to  
> free memory) for S4 class objects in analogy to C++?

The analogy doesn't work, because in C++ you have pass-by-reference  
semantics, but in R you have pass-by-value. Hence in R there is no  
"one" object that you could finalize - there may be dozens of copies  
of your S4 object, so which one would you finalize? However, you can  
register a finalizer for reference-semantics objects (if that's what  
you really have), see ?reg.finalizer (and on C level  
R_Register*Finalizer* functions).

Cheers,
Simon


> rm() combined with gc() does not seem to be a good idea (Chambers,  
> 2008).
> So could it be done on the C/C++ level or is it even already  
> available in
> the "internals"?
>
> Many thanks,
> David
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From krcoombes at mdacc.tmc.edu  Tue Jul 21 20:14:07 2009
From: krcoombes at mdacc.tmc.edu (Kevin R. Coombes)
Date: Tue, 21 Jul 2009 13:14:07 -0500
Subject: [Rd] Rcmd check fails on Windows Samba network path in R 2.9.1
In-Reply-To: <4A65CE87.2070503@acm.org>
References: <4A64B36E.8040405@mdacc.tmc.edu> <4A64DC8A.6040805@acm.org>
	<4A65AC9A.9060808@mdacc.tmc.edu> <4A65CE87.2070503@acm.org>
Message-ID: <4A66056F.5010901@mdacc.tmc.edu>

The results of the session below are the same in 2.8.1 as in 2.9.1 
(including in particular the response to the call to file.access).
    Kevin

Tony Plate wrote:
> Did you try starting up R-2.8.1 and checking the result of 
> file.access(lib, 2) on that very same directory where R-2.9.1 gives an 
> incorrect indication?  If that gives the correct answer, then, look 
> for changes in the file.access code.
>
> -- Tony Plate
>
> Kevin R. Coombes wrote:
>> Hi,
>>
>> The problem almost certainly has something to do with Samba.  We also 
>> have a NetApp file system, and copying the package source to that 
>> drive and running Rcmd check from Windows works just fine.
>>
>> When running the commands from an interactive R session, file_test 
>> returns TRUE and file.access to test write permission indicates a 
>> failure, even though that information is incorrect.Here is a session 
>> transcript:
>>
>> -----------------------------------------
>> > getwd()
>> [1] "n:/krc/Umpire/R-Package"
>> > lib <- "Umpire.Rcheck"
>> > file_test("-d", lib)
>> [1] TRUE
>> > file.access(lib, 2)
>> Umpire.Rcheck
>>           -1
>> > dir.create(paste(lib, "testdir", sep='/'))
>> > dir(lib)
>> [1] "00check.log"   "00install.out" "testdir"     > sessionInfo()
>> R version 2.9.1 (2009-06-26)
>> i386-pc-mingw32
>>
>> locale:
>> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United 
>> States.1252;LC_MONETARY=English_United 
>> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> ----------------------------------------
>> Again, this all worked (and still works) correctly in 2.8.1.
>>
>>    Kevin
>>
>> Tony Plate wrote:
>>> This error message looks like it comes from 
>>> src/library/tools/R/install.R, which contains the following test:
>>>
>>>    if (!.file_test("-d", lib) || file.access(lib, 2L))
>>>        stop("ERROR: no permission to install to directory ",
>>>             sQuote(lib), call. = FALSE)
>>>
>>> The function .file_test() is defined earlier in the same file (it 
>>> looks at file.info(lib)$isdir) and appears to be intended to be the 
>>> same as utils:::file_test().
>>>
>>> You could start trying to figure out what the problem is by trying 
>>> these calls on the directory in question from an interactive R session.
>>> (They seem to work as intended on my Windows system with a NetApp 
>>> file system mounted on a letter drive.)
>>>
>>> -- Tony Plate
>>>
>>> Kevin R. Coombes wrote:
>>>> Hi,
>>>>
>>>> I have just updated R from version 2.8.1 to version 2.9.1.  I am 
>>>> running Windows XP Professional, Service Pack 3.
>>>>
>>>> With the update, I decided to update a set of packages that I 
>>>> maintain by compiling them for the new version.  Everything worked 
>>>> fine except for one package.  This package is unique (among the six 
>>>> I was working on) in that is stored on a UNIX-based file server 
>>>> that is exported to the Windows network via Samba.  The root of 
>>>> that network path is mapped to drive "N:" on the local machine.
>>>>
>>>> 'Rcmd check' fails for this package under 2.9.1.  The error message 
>>>> in '00install.out'  is:
>>>> "Error: ERROR: no permission to install to directory 
>>>> 'N:/krc/Umpire/R-Package/Umpire.Rcheck'"
>>>>
>>>> 'Rcmd check' works for this package under 2.8.1.
>>>>
>>>> 'Rcmd check' works for this package if the directory is copied onto 
>>>> a local hard drive instead of the network drive.
>>>>
>>>> 'Rcmd build' and 'Rcmd build --binary' work under both versions.
>>>>
>>>> It would be nice if someone could figure out what has changed and 
>>>> fix it....
>>>>
>>>> Best,
>>>>    Kevin Coombes
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>
>


From vogranovich at jumptrading.com  Tue Jul 21 21:24:01 2009
From: vogranovich at jumptrading.com (Vadim Ogranovich)
Date: Tue, 21 Jul 2009 14:24:01 -0500
Subject: [Rd] bug in approx crashes R
Message-ID: <22D850BC39A25742977325ADDE208E770271F720AD@chiexchange02.w2k.jumptrading.com>

Dear R-devel,

The following line crashes R
> approx(1, 1, 0, method='const', rule=2, f=0, yleft=NULL, ties='ordered')$y

Process R:2 exited abnormally with code 5 at Tue Jul 21 14:18:09 2009


> version
               _
platform       i386-pc-mingw32
arch           i386
os             mingw32
system         i386, mingw32
status
major          2
minor          9.1
year           2009
month          06
day            26
svn rev        48839
language       R
version.string R version 2.9.1 (2009-06-26)

Thanks,
Vadim

Note: This email is for the confidential use of the named addressee(s) only and may contain proprietary, confidential or privileged information. If you are not the intended recipient, you are hereby notified that any review, dissemination or copying of this email is strictly prohibited, and to please notify the sender immediately and destroy this email and any attachments.  Email transmission cannot be guaranteed to be secure or error-free.  Jump Trading, therefore, does not make any guarantees as to the completeness or accuracy of this email or any attachments.  This email is for informational purposes only and does not constitute a recommendation, offer, request or solicitation of any kind to buy, sell, subscribe, redeem or perform any type of transaction of a financial product.


From kjell.konis at epfl.ch  Wed Jul 22 09:55:56 2009
From: kjell.konis at epfl.ch (Kjell Konis)
Date: Wed, 22 Jul 2009 09:55:56 +0200
Subject: [Rd] strange bug? with R CMD check
In-Reply-To: <13e802630907212231u5778043dibee68b6b676dba27@mail.gmail.com>
References: <09DFE5E3-9AA4-47F1-8935-C4763DB008F2@epfl.ch>
	<13e802630907212231u5778043dibee68b6b676dba27@mail.gmail.com>
Message-ID: <9F46385C-C95E-46A4-B049-E4E96C3F068D@epfl.ch>

Yes, I managed to work around the problem. You can still reproduce the  
strange behavior with revision 5 of the package though.

svn checkout svn://svn.r-forge.r-project.org/svnroot/sbr/pkg at 5  
safeBinaryRegression

Kjell


On 22 juil. 09, at 07:31, Paul Johnson wrote:

> I am guessing you solved this, because I just downloaded your svn
> files and there's no more "sbr" and the check passes on my system.
>
> Right?
>
> pj
>
> On Tue, Jul 21, 2009 at 8:32 AM, Kjell Konis<kjell.konis at epfl.ch>  
> wrote:
>> Hello,
>>
>> I am trying to get a package to pass R CMD check on an iMac running  
>> Mac OS
>> X.  When the package is named safeBinaryRegression I get the  
>> following
>> warning from R CMD check:
>>
>> * checking whether the name space can be loaded with stated  
>> dependencies ...
>> WARNING
>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>  function 'make_lp' not provided by package 'lpSolveAPI'
>> Calls: loadNamespace -> library.dynam -> dyn.load
>> Execution halted
>>
>> A namespace must be able to be loaded with just the base namespace  
>> loaded:
>> otherwise if the namespace gets loaded by a saved object, the  
>> session will
>> be unable to start.
>>
>> Probably some imports need to be declared in the NAMESPACE file.
>>
>>
>> Here is the contents of the DESCRIPTION:
>>
>> Package: safeBinaryRegression
>> Version: 0.1-2
>> Date: 2009-07-01
>> Title: Safe Binary Regression
>> Author: Kjell Konis <kjell.konis at epfl.ch>
>> Maintainer: Kjell Konis <kjell.konis at epfl.ch>
>> Depends: R (>= 2.9.1), lpSolveAPI (>= 5.5.0.14)
>> LinkingTo: lpSolveAPI
>> Description: Overloads the stats::glm function so that a test for the
>> existence of
>>  the maximum likelihood estimate is computed as part of the fitting
>> procedure for
>>  binary regression models.
>> License: GPL-2
>>
>>
>> Here is the contents of the NAMESPACE:
>>
>> export(glm)
>> useDynLib(safeBinaryRegression, linprog, reducedLP)
>>
>>
>> The strange thing is that if I change the length of the package  
>> name (for
>> example safeBinaryRegression to safeBinaryRegress) the warning goes  
>> away and
>> R CMD check completes successfully.  Also, regardless of the  
>> package name,
>> the package installs and runs as expected.  I'm at a loss trying to  
>> figure
>> out what's going on.
>>
>> To reproduce:
>>
>> (1) check out the sbr package (which passes R CMD check)
>>
>>  svn checkout svn://svn.r-forge.r-project.org/svnroot/sbr/pkg
>> safeBinaryRegression
>>
>> (2) replace sbr with safeBinaryRegression in DESCRIPTION and  
>> NAMESPACE
>>
>> (3) run R CMD check
>>
>>
>> Session Info:
>>
>>> sessionInfo()
>> R version 2.9.1 (2009-06-26)
>> i386-apple-darwin8.11.1
>>
>> locale:
>> fr_CH.UTF-8/en_US.UTF-8/C/C/fr_CH.UTF-8/fr_CH.UTF-8
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> Thanks,
>> Kjell
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
>
> -- 
> Paul E. Johnson
> Professor, Political Science
> 1541 Lilac Lane, Room 504
> University of Kansas


From hb at stat.berkeley.edu  Wed Jul 22 10:46:18 2009
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Wed, 22 Jul 2009 10:46:18 +0200
Subject: [Rd] Rcmd check fails on Windows Samba network path in R 2.9.1
In-Reply-To: <4A65AC9A.9060808@mdacc.tmc.edu>
References: <4A64B36E.8040405@mdacc.tmc.edu> <4A64DC8A.6040805@acm.org> 
	<4A65AC9A.9060808@mdacc.tmc.edu>
Message-ID: <59d7961d0907220146k72738bd4m3c1cd56a77401aa3@mail.gmail.com>

See r-devel thread '[Rd] file.access() on network (mounted) drive on
Windows Vista' on Nov 26, 2008:

  http://tolstoy.newcastle.edu.au/R/e5/devel/08/11/0806.html

where it was concluded that file.access() is "not 100%", e.g.
file.access() and file.info() can give different answers.

I added fileAccess(..., safe=TRUE) to R.utils, which imitates
file.access() but relies also on file.info() and file.exists() to
infer the rights.  It is still not 100% but (hopefully) closer than
file.access().

/H

On Tue, Jul 21, 2009 at 1:55 PM, Kevin R.
Coombes<krcoombes at mdacc.tmc.edu> wrote:
> Hi,
>
> The problem almost certainly has something to do with Samba. ?We also have a
> NetApp file system, and copying the package source to that drive and running
> Rcmd check from Windows works just fine.
>
> When running the commands from an interactive R session, file_test returns
> TRUE and file.access to test write permission indicates a failure, even
> though that information is incorrect.Here is a session transcript:
>
> -----------------------------------------
>> getwd()
> [1] "n:/krc/Umpire/R-Package"
>> lib <- "Umpire.Rcheck"
>> file_test("-d", lib)
> [1] TRUE
>> file.access(lib, 2)
> Umpire.Rcheck
> ? ? ? ? ?-1
>> dir.create(paste(lib, "testdir", sep='/'))
>> dir(lib)
> [1] "00check.log" ? "00install.out" "testdir" ? ? > sessionInfo()
> R version 2.9.1 (2009-06-26)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> States.1252;LC_MONETARY=English_United
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
> ----------------------------------------
> Again, this all worked (and still works) correctly in 2.8.1.
>
> ? Kevin
>
> Tony Plate wrote:
>>
>> This error message looks like it comes from src/library/tools/R/install.R,
>> which contains the following test:
>>
>> ? if (!.file_test("-d", lib) || file.access(lib, 2L))
>> ? ? ? stop("ERROR: no permission to install to directory ",
>> ? ? ? ? ? ?sQuote(lib), call. = FALSE)
>>
>> The function .file_test() is defined earlier in the same file (it looks at
>> file.info(lib)$isdir) and appears to be intended to be the same as
>> utils:::file_test().
>>
>> You could start trying to figure out what the problem is by trying these
>> calls on the directory in question from an interactive R session.
>> (They seem to work as intended on my Windows system with a NetApp file
>> system mounted on a letter drive.)
>>
>> -- Tony Plate
>>
>> Kevin R. Coombes wrote:
>>>
>>> Hi,
>>>
>>> I have just updated R from version 2.8.1 to version 2.9.1. ?I am running
>>> Windows XP Professional, Service Pack 3.
>>>
>>> With the update, I decided to update a set of packages that I maintain by
>>> compiling them for the new version. ?Everything worked fine except for one
>>> package. ?This package is unique (among the six I was working on) in that is
>>> stored on a UNIX-based file server that is exported to the Windows network
>>> via Samba. ?The root of that network path is mapped to drive "N:" on the
>>> local machine.
>>>
>>> 'Rcmd check' fails for this package under 2.9.1. ?The error message in
>>> '00install.out' ?is:
>>> "Error: ERROR: no permission to install to directory
>>> 'N:/krc/Umpire/R-Package/Umpire.Rcheck'"
>>>
>>> 'Rcmd check' works for this package under 2.8.1.
>>>
>>> 'Rcmd check' works for this package if the directory is copied onto a
>>> local hard drive instead of the network drive.
>>>
>>> 'Rcmd build' and 'Rcmd build --binary' work under both versions.
>>>
>>> It would be nice if someone could figure out what has changed and fix
>>> it....
>>>
>>> Best,
>>> ? Kevin Coombes
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ivo at iugrina.com  Wed Jul 22 11:20:00 2009
From: ivo at iugrina.com (Ivo Ugrina)
Date: Wed, 22 Jul 2009 11:20:00 +0200
Subject: [Rd] Improvement of [dpq]wilcox functions
In-Reply-To: <4A560737.9080005@iugrina.com>
References: <4A560737.9080005@iugrina.com>
Message-ID: <4A66D9C0.8020608@iugrina.com>

Ivo Ugrina wrote:
> Hi,
> 
> I believe I have significantly improved [dpq]wilcox
> functions by implementing Harding's algorithm:
> Harding, E.F. (1984): An Efficient, Minimal-storage Procedure
> for Calculating the Mann-Whitney U, Generalized U and Similar
> Distributions, App. Statist., 33, 1-6
> 
> Results on my computer show (against R-2.9.1):
> 
>> system.time( dwilcox( 800, 800, 80) )
>    user  system elapsed
>   0.240   0.180   0.443
>> system.time( dwilcox( (1:2800), 80, 80) )
>    user  system elapsed
>   0.290   0.020   0.30
>> system.time( dwilcox( (1:2800), 160, 160) )
>    user  system elapsed
>   0.810   0.060   0.868
>> system.time( dwilcox( (1:28000), 210, 210) )
>    user  system elapsed
>  17.700   0.600  18.313
> RAM: ~ 700MB
>> system.time( pwilcox( 21000, 211, 211) )
>    user  system elapsed
>  18.110   0.640  18.762
>> system.time( a <- qwilcox( 0.43, 200, 400) )
> ^C
> Timing stopped at: 14.39 1.43 18.794
> RAM: > 1.4GB at interrupt time
> 
>> system.time( dwilcox(800, 800, 80) )
>    user  system elapsed
>   0.140   0.000   0.144
>> system.time( dwilcox( (1:2800), 80, 80) )
>    user  system elapsed
>   0.010   0.000   0.007
>> system.time( dwilcox( (1:2800), 160, 160) )
>    user  system elapsed
>   0.020   0.000   0.016
>> system.time( dwilcox( (1:28000), 210, 210) )
>    user  system elapsed
>   0.050   0.000   0.05
> RAM: < 1MB
>> system.time( pwilcox( 21000, 211, 211) )
>    user  system elapsed
>   0.020   0.000   0.025
>> system.time( a <- qwilcox( 0.43, 200, 400) )
>    user  system elapsed
>   0.040   0.000   0.07
> RAM: < 1MB
> 
> There is no more need for
> wilcox_free at [dpq]wilcox in src/library/stats/distn.R
> (every other call after the first one with the same m,n
> will just read the results from the array so it will be
> really fast) and for
> #define WILCOX_MAX 50 in src/nmath/nmath.h
> 
> p.s. modified files are in the attachment
> 
> have fun,
> 

So is this an improvement or not?

-- 
Ivo Ugrina << http://web.math.hr/~iugrina >>
Teaching/Research Assistant at Department of Mathematics
University of Zagreb, Croatia


From markus.jochmann at strath.ac.uk  Wed Jul 22 13:07:14 2009
From: markus.jochmann at strath.ac.uk (Markus Jochmann)
Date: Wed, 22 Jul 2009 04:07:14 -0700 (PDT)
Subject: [Rd] matrix algebra in c
In-Reply-To: <4A5CCA2C.8000109@rug.nl>
References: <4A5CCA2C.8000109@rug.nl>
Message-ID: <24604315.post@talk.nabble.com>


> 1. use F77_CALL() to call matrix multiplication functions from blas.
> This should be ok as long as I remember that c and FORTRAN store
> matrices differently.

Concerning 1. you might want to look at some C++ wrapper for BLAS and Lapack
like http://flens.sourceforge.net, this makes things easier.

-- 
View this message in context: http://www.nabble.com/matrix-algebra-in-c-tp24484891p24604315.html
Sent from the R devel mailing list archive at Nabble.com.


From krcoombes at mdacc.tmc.edu  Wed Jul 22 15:10:11 2009
From: krcoombes at mdacc.tmc.edu (Kevin R. Coombes)
Date: Wed, 22 Jul 2009 08:10:11 -0500
Subject: [Rd] Rcmd check fails on Windows Samba network path in R 2.9.1
In-Reply-To: <59d7961d0907220146k72738bd4m3c1cd56a77401aa3@mail.gmail.com>
References: <4A64B36E.8040405@mdacc.tmc.edu> <4A64DC8A.6040805@acm.org>
	<4A65AC9A.9060808@mdacc.tmc.edu>
	<59d7961d0907220146k72738bd4m3c1cd56a77401aa3@mail.gmail.com>
Message-ID: <4A670FB3.4030802@mdacc.tmc.edu>

Hi,

Thanks; that confirms that the problem originates where I thought it 
did, and provides a fix from within R.

However, the original problem was that running "Rcmd check" from a 
Windows/DOS command prompt on a package on a mounted Samba network drive 
fails.  The failure occurs because of the file.access call in 
"install.R", which appears to get incorrect information from the 
operating system.  Is it possible to get install.R changed so it works 
in this situation?

(Under the philosophy that "it is easier to beg forgiveness than to ask 
permission", perhaps install R should just try to create/write what it 
wants and only fail iby checking the result rather than 'asking 
permission"....)

Best,
    Kevin

Henrik Bengtsson wrote:
> See r-devel thread '[Rd] file.access() on network (mounted) drive on
> Windows Vista' on Nov 26, 2008:
>
>   http://tolstoy.newcastle.edu.au/R/e5/devel/08/11/0806.html
>
> where it was concluded that file.access() is "not 100%", e.g.
> file.access() and file.info() can give different answers.
>
> I added fileAccess(..., safe=TRUE) to R.utils, which imitates
> file.access() but relies also on file.info() and file.exists() to
> infer the rights.  It is still not 100% but (hopefully) closer than
> file.access().
>
> /H
>
> On Tue, Jul 21, 2009 at 1:55 PM, Kevin R.
> Coombes<krcoombes at mdacc.tmc.edu> wrote:
>   
>> Hi,
>>
>> The problem almost certainly has something to do with Samba.  We also have a
>> NetApp file system, and copying the package source to that drive and running
>> Rcmd check from Windows works just fine.
>>
>> When running the commands from an interactive R session, file_test returns
>> TRUE and file.access to test write permission indicates a failure, even
>> though that information is incorrect.Here is a session transcript:
>>
>> -----------------------------------------
>>     
>>> getwd()
>>>       
>> [1] "n:/krc/Umpire/R-Package"
>>     
>>> lib <- "Umpire.Rcheck"
>>> file_test("-d", lib)
>>>       
>> [1] TRUE
>>     
>>> file.access(lib, 2)
>>>       
>> Umpire.Rcheck
>>          -1
>>     
>>> dir.create(paste(lib, "testdir", sep='/'))
>>> dir(lib)
>>>       
>> [1] "00check.log"   "00install.out" "testdir"     > sessionInfo()
>> R version 2.9.1 (2009-06-26)
>> i386-pc-mingw32
>>
>> locale:
>> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
>> States.1252;LC_MONETARY=English_United
>> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> ----------------------------------------
>> Again, this all worked (and still works) correctly in 2.8.1.
>>
>>   Kevin
>>
>> Tony Plate wrote:
>>     
>>> This error message looks like it comes from src/library/tools/R/install.R,
>>> which contains the following test:
>>>
>>>   if (!.file_test("-d", lib) || file.access(lib, 2L))
>>>       stop("ERROR: no permission to install to directory ",
>>>            sQuote(lib), call. = FALSE)
>>>
>>> The function .file_test() is defined earlier in the same file (it looks at
>>> file.info(lib)$isdir) and appears to be intended to be the same as
>>> utils:::file_test().
>>>
>>> You could start trying to figure out what the problem is by trying these
>>> calls on the directory in question from an interactive R session.
>>> (They seem to work as intended on my Windows system with a NetApp file
>>> system mounted on a letter drive.)
>>>
>>> -- Tony Plate
>>>
>>> Kevin R. Coombes wrote:
>>>       
>>>> Hi,
>>>>
>>>> I have just updated R from version 2.8.1 to version 2.9.1.  I am running
>>>> Windows XP Professional, Service Pack 3.
>>>>
>>>> With the update, I decided to update a set of packages that I maintain by
>>>> compiling them for the new version.  Everything worked fine except for one
>>>> package.  This package is unique (among the six I was working on) in that is
>>>> stored on a UNIX-based file server that is exported to the Windows network
>>>> via Samba.  The root of that network path is mapped to drive "N:" on the
>>>> local machine.
>>>>
>>>> 'Rcmd check' fails for this package under 2.9.1.  The error message in
>>>> '00install.out'  is:
>>>> "Error: ERROR: no permission to install to directory
>>>> 'N:/krc/Umpire/R-Package/Umpire.Rcheck'"
>>>>
>>>> 'Rcmd check' works for this package under 2.8.1.
>>>>
>>>> 'Rcmd check' works for this package if the directory is copied onto a
>>>> local hard drive instead of the network drive.
>>>>
>>>> 'Rcmd build' and 'Rcmd build --binary' work under both versions.
>>>>
>>>> It would be nice if someone could figure out what has changed and fix
>>>> it....
>>>>
>>>> Best,
>>>>   Kevin Coombes
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>         
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>


From Thierry.ONKELINX at inbo.be  Wed Jul 22 15:53:35 2009
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Wed, 22 Jul 2009 15:53:35 +0200
Subject: [Rd] Link to documentation in another package
Message-ID: <2E9C414912813E4EB981326983E0A104069D9B06@inboexch.inbo.be>

Dear all,

One of the functions that I wrote (ggsave.latex) extents the
functionality of a function (ggsave) in another package (ggplot2).
Instead of copying all the information I would like to create a link in
the helpfile of ggsave.latex to the helpfile of ggsave. I tried
\code{\link{ggsave}} and \code{\link{ggplot2::ggsave}}, but neither
worked. Both cases gave a 'missing link' warning.

Any suggestions?

Thierry

------------------------------------------------------------------------
----
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature
and Forest
Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
methodology and quality assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium
tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to
say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of
data.
~ John Tukey


Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer 
en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is
door een geldig ondertekend document. The views expressed in  this message 
and any annex are purely those of the writer and may not be regarded as stating 
an official position of INBO, as long as the message is not confirmed by a duly 
signed document.


From ncrookston at fs.fed.us  Wed Jul 22 16:10:05 2009
From: ncrookston at fs.fed.us (Nicholas L Crookston)
Date: Wed, 22 Jul 2009 07:10:05 -0700
Subject: [Rd] Link to documentation in another package
In-Reply-To: <2E9C414912813E4EB981326983E0A104069D9B06@inboexch.inbo.be>
Message-ID: <OFF4C8F1B5.CD6DE08F-ON882575FB.004DB25A-882575FB.004DD407@fs.fed.us>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090722/2bd289b9/attachment.pl>

From matteo at naufraghi.net  Wed Jul 22 16:26:51 2009
From: matteo at naufraghi.net (Matteo Bertini)
Date: Wed, 22 Jul 2009 16:26:51 +0200
Subject: [Rd] maximum supported lag is 350
Message-ID: <4A6721AB.3010103@naufraghi.net>

I have found a strange error:

 > fit = Arima(flow, c(1,0,1), list(order=c(0,1,1), period=96*7))
Error in makeARIMA(trarma[[1L]], trarma[[2L]], Delta, kappa) :
   maximum supported lag is 350

Is in fact quite common to have a lag > 350 using a weekly period in 
15min steps = 672 (standard in traffic flow prediction litterature for 
example).

Is there any reasons against doing what is suggested in the comment and 
avoid the hardcoded limit?

Thanks,
Matteo Bertini



# https://svn.r-project.org/R/trunk/src/library/stats/src/arima.c
SEXP getQ0(SEXP sPhi, SEXP sTheta)
{

[----8<----]

     /* This is the limit using an int index.  We could use
        size_t and get more on a 64-bit system,
        but there seems no practical need. */
     if(r > 350) error(_("maximum supported lag is 350"));


From murdoch at stats.uwo.ca  Wed Jul 22 16:28:28 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 22 Jul 2009 10:28:28 -0400
Subject: [Rd] Rcmd check fails on Windows Samba network path in R 2.9.1
In-Reply-To: <4A670FB3.4030802@mdacc.tmc.edu>
References: <4A64B36E.8040405@mdacc.tmc.edu>
	<4A64DC8A.6040805@acm.org>	<4A65AC9A.9060808@mdacc.tmc.edu>	<59d7961d0907220146k72738bd4m3c1cd56a77401aa3@mail.gmail.com>
	<4A670FB3.4030802@mdacc.tmc.edu>
Message-ID: <4A67220C.2040908@stats.uwo.ca>

On 7/22/2009 9:10 AM, Kevin R. Coombes wrote:
> Hi,
> 
> Thanks; that confirms that the problem originates where I thought it 
> did, and provides a fix from within R.
> 
> However, the original problem was that running "Rcmd check" from a 
> Windows/DOS command prompt on a package on a mounted Samba network drive 
> fails.  The failure occurs because of the file.access call in 
> "install.R", which appears to get incorrect information from the 
> operating system.  Is it possible to get install.R changed so it works 
> in this situation?


Of course that's possible, but I'd put it at a low priority.  The right 
solution here is to fix Samba.  A simple workaround is to copy the 
package to a non-Samba drive.  Since this is not our bug, and it has a 
simple workaround, I don't want to put an effort into fixing it.

Duncan Murdoch

> 
> (Under the philosophy that "it is easier to beg forgiveness than to ask 
> permission", perhaps install R should just try to create/write what it 
> wants and only fail iby checking the result rather than 'asking 
> permission"....)
> 
> Best,
>     Kevin
> 
> Henrik Bengtsson wrote:
>> See r-devel thread '[Rd] file.access() on network (mounted) drive on
>> Windows Vista' on Nov 26, 2008:
>>
>>   http://tolstoy.newcastle.edu.au/R/e5/devel/08/11/0806.html
>>
>> where it was concluded that file.access() is "not 100%", e.g.
>> file.access() and file.info() can give different answers.
>>
>> I added fileAccess(..., safe=TRUE) to R.utils, which imitates
>> file.access() but relies also on file.info() and file.exists() to
>> infer the rights.  It is still not 100% but (hopefully) closer than
>> file.access().
>>
>> /H
>>
>> On Tue, Jul 21, 2009 at 1:55 PM, Kevin R.
>> Coombes<krcoombes at mdacc.tmc.edu> wrote:
>>   
>>> Hi,
>>>
>>> The problem almost certainly has something to do with Samba.  We also have a
>>> NetApp file system, and copying the package source to that drive and running
>>> Rcmd check from Windows works just fine.
>>>
>>> When running the commands from an interactive R session, file_test returns
>>> TRUE and file.access to test write permission indicates a failure, even
>>> though that information is incorrect.Here is a session transcript:
>>>
>>> -----------------------------------------
>>>     
>>>> getwd()
>>>>       
>>> [1] "n:/krc/Umpire/R-Package"
>>>     
>>>> lib <- "Umpire.Rcheck"
>>>> file_test("-d", lib)
>>>>       
>>> [1] TRUE
>>>     
>>>> file.access(lib, 2)
>>>>       
>>> Umpire.Rcheck
>>>          -1
>>>     
>>>> dir.create(paste(lib, "testdir", sep='/'))
>>>> dir(lib)
>>>>       
>>> [1] "00check.log"   "00install.out" "testdir"     > sessionInfo()
>>> R version 2.9.1 (2009-06-26)
>>> i386-pc-mingw32
>>>
>>> locale:
>>> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
>>> States.1252;LC_MONETARY=English_United
>>> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>> ----------------------------------------
>>> Again, this all worked (and still works) correctly in 2.8.1.
>>>
>>>   Kevin
>>>
>>> Tony Plate wrote:
>>>     
>>>> This error message looks like it comes from src/library/tools/R/install.R,
>>>> which contains the following test:
>>>>
>>>>   if (!.file_test("-d", lib) || file.access(lib, 2L))
>>>>       stop("ERROR: no permission to install to directory ",
>>>>            sQuote(lib), call. = FALSE)
>>>>
>>>> The function .file_test() is defined earlier in the same file (it looks at
>>>> file.info(lib)$isdir) and appears to be intended to be the same as
>>>> utils:::file_test().
>>>>
>>>> You could start trying to figure out what the problem is by trying these
>>>> calls on the directory in question from an interactive R session.
>>>> (They seem to work as intended on my Windows system with a NetApp file
>>>> system mounted on a letter drive.)
>>>>
>>>> -- Tony Plate
>>>>
>>>> Kevin R. Coombes wrote:
>>>>       
>>>>> Hi,
>>>>>
>>>>> I have just updated R from version 2.8.1 to version 2.9.1.  I am running
>>>>> Windows XP Professional, Service Pack 3.
>>>>>
>>>>> With the update, I decided to update a set of packages that I maintain by
>>>>> compiling them for the new version.  Everything worked fine except for one
>>>>> package.  This package is unique (among the six I was working on) in that is
>>>>> stored on a UNIX-based file server that is exported to the Windows network
>>>>> via Samba.  The root of that network path is mapped to drive "N:" on the
>>>>> local machine.
>>>>>
>>>>> 'Rcmd check' fails for this package under 2.9.1.  The error message in
>>>>> '00install.out'  is:
>>>>> "Error: ERROR: no permission to install to directory
>>>>> 'N:/krc/Umpire/R-Package/Umpire.Rcheck'"
>>>>>
>>>>> 'Rcmd check' works for this package under 2.8.1.
>>>>>
>>>>> 'Rcmd check' works for this package if the directory is copied onto a
>>>>> local hard drive instead of the network drive.
>>>>>
>>>>> 'Rcmd build' and 'Rcmd build --binary' work under both versions.
>>>>>
>>>>> It would be nice if someone could figure out what has changed and fix
>>>>> it....
>>>>>
>>>>> Best,
>>>>>   Kevin Coombes
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>>         
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From Thierry.ONKELINX at inbo.be  Wed Jul 22 17:18:44 2009
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Wed, 22 Jul 2009 17:18:44 +0200
Subject: [Rd] Link to documentation in another package
In-Reply-To: <OFF4C8F1B5.CD6DE08F-ON882575FB.004DB25A-882575FB.004DD407@fs.fed.us>
References: <2E9C414912813E4EB981326983E0A104069D9B06@inboexch.inbo.be>
	<OFF4C8F1B5.CD6DE08F-ON882575FB.004DB25A-882575FB.004DD407@fs.fed.us>
Message-ID: <2E9C414912813E4EB981326983E0A104069D9B2A@inboexch.inbo.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090722/92b17dd5/attachment.pl>

From simon.urbanek at r-project.org  Wed Jul 22 18:02:37 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Wed, 22 Jul 2009 12:02:37 -0400
Subject: [Rd] Rcmd check fails on Windows Samba network path in R 2.9.1
In-Reply-To: <4A67220C.2040908@stats.uwo.ca>
References: <4A64B36E.8040405@mdacc.tmc.edu>
	<4A64DC8A.6040805@acm.org>	<4A65AC9A.9060808@mdacc.tmc.edu>	<59d7961d0907220146k72738bd4m3c1cd56a77401aa3@mail.gmail.com>
	<4A670FB3.4030802@mdacc.tmc.edu> <4A67220C.2040908@stats.uwo.ca>
Message-ID: <A3946251-8DC4-4780-BD07-4BDE3EC26C41@r-project.org>


On Jul 22, 2009, at 10:28 , Duncan Murdoch wrote:

> On 7/22/2009 9:10 AM, Kevin R. Coombes wrote:
>> Hi,
>> Thanks; that confirms that the problem originates where I thought  
>> it did, and provides a fix from within R.
>> However, the original problem was that running "Rcmd check" from a  
>> Windows/DOS command prompt on a package on a mounted Samba network  
>> drive fails.  The failure occurs because of the file.access call in  
>> "install.R", which appears to get incorrect information from the  
>> operating system.  Is it possible to get install.R changed so it  
>> works in this situation?
>
>
> Of course that's possible, but I'd put it at a low priority.  The  
> right solution here is to fix Samba.  A simple workaround is to copy  
> the package to a non-Samba drive.  Since this is not our bug, and it  
> has a simple workaround, I don't want to put an effort into fixing it.
>

It *is* our bug - this happens on other drives, too, not just samba  
(see my "R CMD check failing due to unreliable file.access() on  
Windows" post from 7/2 on R-core about this) - hence your advice is  
quite far off. Also note that other tools have no issue finding the  
correct flags. I thought this is being worked on (according to that  
thread)... I'm not saying that file.access() can be fixed easily  
(essentially you have to deal with GetFileSecurityW returning  
ERROR_NOT_SUPPORTED and use the GetFileAttributesW result or something  
similar instead), but check surely can use the same old reality-based  
check that it used before 2.9.0.

Cheers,
Simon



> Duncan Murdoch
>
>> (Under the philosophy that "it is easier to beg forgiveness than to  
>> ask permission", perhaps install R should just try to create/write  
>> what it wants and only fail iby checking the result rather than  
>> 'asking permission"....)
>> Best,
>>    Kevin
>> Henrik Bengtsson wrote:
>>> See r-devel thread '[Rd] file.access() on network (mounted) drive on
>>> Windows Vista' on Nov 26, 2008:
>>>
>>>  http://tolstoy.newcastle.edu.au/R/e5/devel/08/11/0806.html
>>>
>>> where it was concluded that file.access() is "not 100%", e.g.
>>> file.access() and file.info() can give different answers.
>>>
>>> I added fileAccess(..., safe=TRUE) to R.utils, which imitates
>>> file.access() but relies also on file.info() and file.exists() to
>>> infer the rights.  It is still not 100% but (hopefully) closer than
>>> file.access().
>>>
>>> /H
>>>
>>> On Tue, Jul 21, 2009 at 1:55 PM, Kevin R.
>>> Coombes<krcoombes at mdacc.tmc.edu> wrote:
>>>
>>>> Hi,
>>>>
>>>> The problem almost certainly has something to do with Samba.  We  
>>>> also have a
>>>> NetApp file system, and copying the package source to that drive  
>>>> and running
>>>> Rcmd check from Windows works just fine.
>>>>
>>>> When running the commands from an interactive R session,  
>>>> file_test returns
>>>> TRUE and file.access to test write permission indicates a  
>>>> failure, even
>>>> though that information is incorrect.Here is a session transcript:
>>>>
>>>> -----------------------------------------
>>>>
>>>>> getwd()
>>>>>
>>>> [1] "n:/krc/Umpire/R-Package"
>>>>
>>>>> lib <- "Umpire.Rcheck"
>>>>> file_test("-d", lib)
>>>>>
>>>> [1] TRUE
>>>>
>>>>> file.access(lib, 2)
>>>>>
>>>> Umpire.Rcheck
>>>>         -1
>>>>
>>>>> dir.create(paste(lib, "testdir", sep='/'))
>>>>> dir(lib)
>>>>>
>>>> [1] "00check.log"   "00install.out" "testdir"     > sessionInfo()
>>>> R version 2.9.1 (2009-06-26)
>>>> i386-pc-mingw32
>>>>
>>>> locale:
>>>> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
>>>> States.1252;LC_MONETARY=English_United
>>>> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>>>>
>>>> attached base packages:
>>>> [1] stats     graphics  grDevices utils     datasets  methods    
>>>> base
>>>> ----------------------------------------
>>>> Again, this all worked (and still works) correctly in 2.8.1.
>>>>
>>>>  Kevin
>>>>
>>>> Tony Plate wrote:
>>>>
>>>>> This error message looks like it comes from src/library/tools/R/ 
>>>>> install.R,
>>>>> which contains the following test:
>>>>>
>>>>>  if (!.file_test("-d", lib) || file.access(lib, 2L))
>>>>>      stop("ERROR: no permission to install to directory ",
>>>>>           sQuote(lib), call. = FALSE)
>>>>>
>>>>> The function .file_test() is defined earlier in the same file  
>>>>> (it looks at
>>>>> file.info(lib)$isdir) and appears to be intended to be the same as
>>>>> utils:::file_test().
>>>>>
>>>>> You could start trying to figure out what the problem is by  
>>>>> trying these
>>>>> calls on the directory in question from an interactive R session.
>>>>> (They seem to work as intended on my Windows system with a  
>>>>> NetApp file
>>>>> system mounted on a letter drive.)
>>>>>
>>>>> -- Tony Plate
>>>>>
>>>>> Kevin R. Coombes wrote:
>>>>>
>>>>>> Hi,
>>>>>>
>>>>>> I have just updated R from version 2.8.1 to version 2.9.1.  I  
>>>>>> am running
>>>>>> Windows XP Professional, Service Pack 3.
>>>>>>
>>>>>> With the update, I decided to update a set of packages that I  
>>>>>> maintain by
>>>>>> compiling them for the new version.  Everything worked fine  
>>>>>> except for one
>>>>>> package.  This package is unique (among the six I was working  
>>>>>> on) in that is
>>>>>> stored on a UNIX-based file server that is exported to the  
>>>>>> Windows network
>>>>>> via Samba.  The root of that network path is mapped to drive  
>>>>>> "N:" on the
>>>>>> local machine.
>>>>>>
>>>>>> 'Rcmd check' fails for this package under 2.9.1.  The error  
>>>>>> message in
>>>>>> '00install.out'  is:
>>>>>> "Error: ERROR: no permission to install to directory
>>>>>> 'N:/krc/Umpire/R-Package/Umpire.Rcheck'"
>>>>>>
>>>>>> 'Rcmd check' works for this package under 2.8.1.
>>>>>>
>>>>>> 'Rcmd check' works for this package if the directory is copied  
>>>>>> onto a
>>>>>> local hard drive instead of the network drive.
>>>>>>
>>>>>> 'Rcmd build' and 'Rcmd build --binary' work under both versions.
>>>>>>
>>>>>> It would be nice if someone could figure out what has changed  
>>>>>> and fix
>>>>>> it....
>>>>>>
>>>>>> Best,
>>>>>>  Kevin Coombes
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>
>>>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From olafm at kimberly.tako.de  Thu Jul 23 00:45:32 2009
From: olafm at kimberly.tako.de (Olaf Mersmann)
Date: Thu, 23 Jul 2009 00:45:32 +0200
Subject: [Rd] Improvement of [dpq]wilcox functions
In-Reply-To: <4A560737.9080005@iugrina.com>
References: <4A560737.9080005@iugrina.com>
Message-ID: <1248302320-sup-9142@bloxx.local>

Hi Ivo,

Excerpts from Ivo Ugrina's message of Thu Jul 09 17:05:27 +0200 2009:
> I believe I have significantly improved [dpq]wilcox
> functions by implementing Harding's algorithm:
> Harding, E.F. (1984): An Efficient, Minimal-storage Procedure
> for Calculating the Mann-Whitney U, Generalized U and Similar
> Distributions, App. Statist., 33, 1-6

I've looked at your code and it is indeed quite a bit faster. Sadly in
some cases it produces inaccurate results. See for example:

R 2.9.1:
  > sum(dwilcox(1:(500*100), 500, 100))
  [1] 1

R 2.9.1 + your patch:
  > sum(dwilcox(1:(500*100), 500, 100))
  [1] 1.001377
  > sum(dwilcox(1:(500*200), 500, 200))
  [1] -132443.2
  > sum(dwilcox(1:(1000*200), 1000, 200))
  [1] 3.412391e+13

The last two examples run out of memory on my machine in an unpatched
R. I think if you can sort out the numerical issuses your patch would
be interesting since it is indeed quite a bit faster than the current
implementation.

Cheers,
Olaf Mersmann


From tpw at google.com  Wed Jul 22 22:45:12 2009
From: tpw at google.com (tpw at google.com)
Date: Wed, 22 Jul 2009 22:45:12 +0200 (CEST)
Subject: [Rd] ks.test - The two-sample two-sided Kolmogorov-Smirnov test
	with ties (PR#13848)
Message-ID: <20090722204513.093E8282EF29@mail.pubhealth.ku.dk>

Full_Name: Thomas Waterhouse
Version: 2.9.1
OS: OS X 10.5.7
Submission from: (NULL) (216.239.45.4)


ks.test uses a biased approximation to the p-value in the case of the two-sample
test with ties in the pooled data.  This has been justified in R in the past by
the argument that the KS test assumes a continuous distribution.  But the
two-sample test can be extended to arbitrary distributions by a combinatorial
argument (below), which I would like to see implemented in R.

The p-value of the test is simply the probability that a random assignment of
the pooled data to two sets of the sizes of the input data sets has a KS test
statistic at least as great as that of the input data.  The function psmirnov2x
in ks.c calculates this probability by enumerating all such assignments as
lattice walks, except that it doesn't know how to handle tied data points.

The correct procedure can be deduced by considering that steps in such lattice
walks represent steps along the x-axis in computing the empirical CDFs of the
two data sets.  The trick is to consider all occurrences of a repeated data
point together, when determining whether a path exceeds the input statistic or
not.  A FORTRAN implementation of this algorithm was published by Nikiforov
(http://www.ams.sunysb.edu/~nkfr/5PUBL.HTM), but it's not for the faint of
heart.

It would be straightforward to change psmirnov2x to include this logic, but I
found it easier simply to rewrite it (with comments this time!) as follows:

void
psmirnov2x(double *x, Sint *m, Sint *n, double *pool)
{
/* Inputs:  *x is the value of the KS test statistic (from 0.0 to 1.0)
            *m and *n are the lengths of each data set
            *pool is an array of length *m + *n formed by combining the two
            data sets and sorting in increasing order
   Output:  *x is unity minus the p-value of the test
   Notes:     The p-value of the two-sample KS test is the proportion of all
            assignments of the pooled data to sets of sizes *m and *n which
            have test statistic exceeding the test statistic of the actual
data.
              To calculate this, we interpret each assignment as a lattice walk
            from the origin to (*m, *n), where the i-th step represents the
i-th
            data point in the pooled data set.  A step to the right represents
            assigning a data point to the *m set, and a step up represents
            assigning a data point to the *n set.  The difference between the
            empirical CDFs of each set can be computed at each step, and the
            KS test statistic is simply the maximum of this value along a given
            walk.
              The p-value is obtained by counting the number of walks that do
            not exceed the input value (since this is easier than counting the
            number that do) and dividing by the total number of walks; this is
            what we return to the caller.
              If the same value occurs multiple times in the pooled data, we
            need to count all multiplicites at the same time when computing the
            empirical CDFs.  In terms of the lattice walk, this means we look
            only the final occurence of each value when determining whether or
            not a walk exceeds the input statistic.
 */
    double md, nd, q, *u, w;
    Sint i, j;
    
    if (*x == 0.0) {
        return 1.0;
    }
    
    md = (double) (*m);
    nd = (double) (*n);
    q = floor(*x * md * nd - 1e-7) / (md * nd);  /* just *x minus an epsilon */
    u = (double *) R_alloc(*n + 1, sizeof(double));

    for (i = 0; i <= *m; i++) {
        for (j = 0; j <= *n; j++) {
            /* At each step, rescale by w := j/(j+*m); this is equivalent to
               dividing by C(*m+*n, *m) at the end, but without the risk of
               overflow */
            w = (double)(j) / (double)(j + *m);
            if (i + j == 0) {
                /* Start with 1 walk from the origin to the origin */
                u[j] = 1.0;
            } else if (i + j < *m + *n &&
                       pool[i + j - 1] != pool[i + j] &&
                       fabs(i / md - j / nd) > q) {
                /* This walk meets or exceeds *x, so don't count it */
                u[j] = 0.0;
            } else if (i == 0) {
                /* The *n-edge:  The number of walks to (0, j) is the same as
                   the number of walks to (0, j-1) */
                u[j] = u[j - 1] * w;
            } else if (j == 0) {
                /* The *m-edge:  The number of walks to (i, 0) is the same as
                   the number of walks to (i-1, 0) */
                /* no-op */
            } else {
                /* The general case:  The number of walks to (i, j) is the
                   number of walks to (i-1, j) plus the number of walks to
                   (i, j-1) */
                u[j] = u[j] + u[j - 1] * w;
            }
        }
    }
    /* Return the proportion of walks that do not exceed the input statistic:
*/
    *x = u[*n];
}

ks.test.R must also be changed as per the following diff, which includes a
corrected calculation of the test statistic:
51d50
<         TIES <- FALSE
54,59c53,57
<         z <- cumsum(ifelse(order(w) <= n.x, 1 / n.x, - 1 / n.y))
<         if(length(unique(w)) < (n.x + n.y)) {
<             warning("cannot compute correct p-values with ties")
<             z <- z[c(which(diff(sort(w)) != 0), n.x + n.y)]
<             TIES <- TRUE
<         }
---
> 		steps = which(diff(sort(w)) != 0)
> 		if(length(steps) > 0)
> 			z <- cumsum(ifelse(order(w) <= n.x, 1 / n.x, - 1 / n.y))[steps]
> 		else
> 			z <- c(0)
68c66
<         if(exact && (alternative == "two.sided") && !TIES)
---
>         if(exact && (alternative == "two.sided"))
72a71
> 						   sort(w),

Finally, the changed signature of psmirnov2x needs to be reflected in ctest.h
and init.c.

I have built and tested the above implementation against 20 pairs of data sets
for which I calculated the test statistics and p-values by brute force or
Nikiforov's algorithm.  I can provide these test sets if desired.


From JLIAO at hes.hmc.psu.edu  Wed Jul 22 14:33:29 2009
From: JLIAO at hes.hmc.psu.edu (Jason Liao)
Date: Wed, 22 Jul 2009 08:33:29 -0400
Subject: [Rd] inclusion of a new bandwidth selector for kernel density
	estimation in R stats
Message-ID: <5A203B7CD12C334494BF14580641456E011D1902@GEMINI.hes.hmc.psu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090722/c63d9ab8/attachment.pl>

From web at umich.edu  Thu Jul 23 17:34:00 2009
From: web at umich.edu (William Bulley)
Date: Thu, 23 Jul 2009 11:34:00 -0400
Subject: [Rd] problem building R 2.9.1 from source on RHEL 4 (x86_64)
Message-ID: <20090723153400.GG77184@dell1>


I am building from source on RHEL 4 and have run into a
problem while running "make check":

   running code in 'lapack.R' ...make[3]: *** [lapack.Rout] Error 1
   make[3]: Leaving directory `/opt/R/R-2.9.1/tests'
   make[2]: *** [test-Specific] Error 2
   make[2]: Leaving directory `/opt/R/R-2.9.1/tests'
   make[1]: *** [test-all-basics] Error 1
   make[1]: Leaving directory `/opt/R/R-2.9.1/tests'
   make: *** [check] Error 2

I don't know the first thing about R as an application.  The
"./configure" and "make" steps succeeded without error.  I got
a warning about not being able to build "info" and "HTML"
documents.  This is due to an older version (4.5) of makeinfo.
I asked, and our developers think they don't need "info" or
"HTML" documentation.  They are okay with man pages.  However,
there may be other problems from any older libraries or other
missing software.

I asked Kurt Hornik about this.  Here are his comments:

According to Kurt Hornik <Kurt.Hornik at wu.ac.at> on Sun, 07/19/09 at 12:02:
> 
> You have:
> 
> BLAS_LIBS = -L$(R_HOME)/lib$(R_ARCH) -lRblas
> LAPACK_LIBS = -L$(R_HOME)/lib$(R_ARCH) -lRlapack
> 
> so you really use the BLAS and LAPACK code that comes with R ...
> so I am somewhat clueless on this.
> 
> Perhaps you can ask on the r-devel mailing list whether others
> have had similar problems?

Can anyone shed any light on this problem?  Thanks in advance.

Regards,

web...

--
William Bulley                     Email: web at umich.edu

The information contained in this message may be CONFIDE...{{dropped:6}}


From matteo at naufraghi.net  Thu Jul 23 19:01:54 2009
From: matteo at naufraghi.net (Matteo Bertini)
Date: Thu, 23 Jul 2009 19:01:54 +0200
Subject: [Rd] maximum supported lag is 350
In-Reply-To: <4A6721AB.3010103@naufraghi.net>
References: <4A6721AB.3010103@naufraghi.net>
Message-ID: <4A689782.4010806@naufraghi.net>

Il 22-07-2009 16:26, Matteo Bertini ha scritto:
> I have found a strange error:
>
>  > fit = Arima(flow, c(1,0,1), list(order=c(0,1,1), period=96*7))
> Error in makeARIMA(trarma[[1L]], trarma[[2L]], Delta, kappa) :
> maximum supported lag is 350
>
> Is in fact quite common to have a lag > 350 using a weekly period in
> 15min steps = 672 (standard in traffic flow prediction litterature for
> example).
>
> Is there any reasons against doing what is suggested in the comment and
> avoid the hardcoded limit?
>
> Thanks,
> Matteo Bertini
>
>
>
> # https://svn.r-project.org/R/trunk/src/library/stats/src/arima.c
> SEXP getQ0(SEXP sPhi, SEXP sTheta)
> {
>
> [----8<----]
>
> /* This is the limit using an int index. We could use
> size_t and get more on a 64-bit system,
> but there seems no practical need. */
> if(r > 350) error(_("maximum supported lag is 350"));
>

Can someone review this analysis?
I can propose a patch to fix the problem if it is ok.

As I can see from the code:

     /* NB: nrbar could overflow */
     int r = max(p, q + 1);
     size_t np = r * (r + 1) / 2, nrbar = np * (np - 1) / 2;

where we want

     nrbar <= SIZE_MAX/2

considering that:

     np = r * (r + 1) / 2 < (r + 1)^2 / 2 = r2

and

     nrbar = np * (np - 1) / 2 < np^2 / 2 < r2^2 / 2

we have a protective:

     nrbar < (r + 1)^4 / 8

and we can check for:

     (r + 1)^4 / 8 <= SIZE_MAX/2

matteo at zarathustra:~/Documents/src$ cat size_max.c
#include <stdio.h>
#include <stdint.h>
#include <math.h>

#define MAX_LAG (int)(sqrt(sqrt(8)) * sqrt(sqrt(SIZE_MAX/2)) - 1)

int main(void) {
	int r;
	size_t np, nrbar;
	printf("MAX_LAG = %d\n", MAX_LAG);
	for (r=MAX_LAG-5; r<MAX_LAG+5; ++r) {
		np = (size_t)r * (r + 1) / 2; // <-- size_t cast
		nrbar = np * (np - 1) / 2;
		printf("r=%d, np=%zd, nrbar=%zd\n", r, np, nrbar);
	}
}
matteo at zarathustra:~/Documents/src$ gcc size_max.c && ./a.out
MAX_LAG = 361
r=356, np=63546, nrbar=2019015285
r=357, np=63903, nrbar=2041764753
r=358, np=64261, nrbar=2064705930
r=359, np=64620, nrbar=2087839890
r=360, np=64980, nrbar=2111167710
r=361, np=65341, nrbar=2134690470
r=362, np=65703, nrbar=10925605
r=363, np=66066, nrbar=34841497
r=364, np=66430, nrbar=58955587
r=365, np=66795, nrbar=83268967
matteo at zarathustra:~/Documents/src$ gcc -arch x86_64 size_max.c && ./a.out
MAX_LAG = 92680
r=92675, np=4294374150, nrbar=9220824667946924175
r=92676, np=4294466826, nrbar=9221222657660023725
r=92677, np=4294559503, nrbar=9221620660256523753
r=92678, np=4294652181, nrbar=9222018675736702290
r=92679, np=4294744860, nrbar=9222416704100837370
r=92680, np=4294837540, nrbar=9222814745349207030
r=92681, np=4294930221, nrbar=9223212799482089310
r=92682, np=4295022903, nrbar=238829644986445
r=92683, np=4295115586, nrbar=636909547728097
r=92684, np=4295208270, nrbar=1035002335816507


Thanks,
Matteo Bertini


PS
I was thinking the right limit was something like
nrbar <= SIZE_MAX
but perhaps I was missing some detail given the overflow occurs at 
SIZE_MAX/2


From web at umich.edu  Thu Jul 23 20:54:11 2009
From: web at umich.edu (William Bulley)
Date: Thu, 23 Jul 2009 14:54:11 -0400
Subject: [Rd] problem building R 2.9.1 from source on RHEL 4 (x86_64)
Message-ID: <20090723185411.GA80388@dell1>

According to William Bulley <web at umich.edu> on Thu, 07/23/09 at 11:34:
> 
> I am building from source on RHEL 4 and have run into a
> problem while running "make check":
> 
>    running code in 'lapack.R' ...make[3]: *** [lapack.Rout] Error 1
>    make[3]: Leaving directory `/opt/R/R-2.9.1/tests'
>    make[2]: *** [test-Specific] Error 2
>    make[2]: Leaving directory `/opt/R/R-2.9.1/tests'
>    make[1]: *** [test-all-basics] Error 1
>    make[1]: Leaving directory `/opt/R/R-2.9.1/tests'
>    make: *** [check] Error 2

Maybe some additional detail would be useful...   Ah-hem...   :-)

linux% uname -a                                                                                               
Linux host 2.4.21-57.ELsmp #1 SMP Wed Apr 23 01:31:01 EDT 2008 x86_64 x86_64 x86_64 GNU/Linux

I ran ./configure (see attached files) followed by make and make test.

I have attached the output of a couple of files to help debug this one.

I hope these will be useful.  If not, I can send more details, just ask.

Regards,

web...

--
William Bulley                     Email: web at umich.edu

The information contained in this message may be CONFIDENTIAL
and is for the intended addressee only.  Any unauthorized use,
dissemination of the information, or copying of this message
is prohibited.  If you are not the intended addressee, please
notify the sender immediately, and delete this message.

-------------- next part --------------
PACKAGE = R
VERSION = 2.9.1

abs_top_srcdir = /opt/R/R-2.9.1
abs_top_builddir = /opt/R/R-2.9.1

include $(top_srcdir)/share/make/vars.mk

AR = ar
ACLOCAL = aclocal
AUTOCONF = autoconf
AUTOMAKE = automake
AUTOHEADER = autoheader
AWK = gawk
BITMAP_LIBS = -ljpeg -lpng -lz -ltiff
BLAS_LIBS = -L$(R_HOME)/lib$(R_ARCH) -lRblas
BUILDDIR_IS_SRCDIR = yes
BUILD_CC = 
BUILD_R = 
CC = gcc -std=gnu99
CFLAGS = -g -O2
CPICFLAGS = -fpic
CPPFLAGS = -I/usr/local/include
DEFS = -DHAVE_CONFIG_H 
DISTDIR_TAR_EXCLUDE = --exclude=.svn --exclude=Makefile --exclude="*.o" --exclude="*$(SHLIB_EXT)"
DVIPS = /usr/bin/dvips
DYLIB_EXT = .so
DYLIB_LD = gcc -std=gnu99
DYLIB_LDFLAGS = -shared
DYLIB_LINK = $(DYLIB_LD) $(DYLIB_LDFLAGS) $(LDFLAGS)
ECHO = echo
ECHO_C = 
ECHO_N = -n
ECHO_T = 
FFLAGS = -g -O2
FLIBS =  -lg2c -lm
FPICFLAGS = -fpic
F77 = g77
GETWD = /bin/pwd
GZIP = --best
INSTALL = /usr/bin/install -c
INSTALL_DATA = ${INSTALL} -m 644
INSTALL_PROGRAM = ${INSTALL}
INSTALL_SCRIPT = ${INSTALL}
INSTALL_DIR = ${INSTALL} -d
JAVA = 
JAVA_HOME = 
JAVA_LD_LIBRARY_PATH = 
JAVA_LIBS = 
JAVAC = /usr/bin/javac
LATEX = /usr/bin/latex
LDFLAGS = -L/usr/local/lib64
LIBINTL= 
LIBM = -lm
LIBR = 
LIBS =  -ldl -lm
LIBnn = lib64
LIBTOOL = $(SHELL) $(top_builddir)/libtool
LN_S = ln -s
MAIN_CFLAGS = 
MAIN_FFLAGS = 
MAIN_LD = gcc -std=gnu99
MAIN_LDFLAGS = -Wl,--export-dynamic  # -Wl,-bE:$(top_builddir)/etc/R.exp
MAIN_LINK = $(MAIN_LD) $(MAIN_LDFLAGS) $(LDFLAGS)
MAKEINDEX = /usr/bin/makeindex
## need this for bootstrapping
MKINSTALLDIRS = /bin/sh $(top_srcdir)/src/scripts/mkinstalldirs.in
PERL = /usr/local/bin/perl
OBJC = 
OBJCFLAGS = -g -O2
R_ARCH = 
R_FRAMEWORK_DIR = $(prefix)/R.framework
R_GZIPCMD = /bin/gzip
## needed for AIX only
# R_HOME = $(top_builddir)
R_MODULES = X11
R_OSTYPE = unix
R_PKGS = $(R_PKGS_BASE)  $(R_PKGS_RECOMMENDED)
R_PLATFORM = x86_64-unknown-linux-gnu
R_XTRA_CFLAGS = 
R_XTRA_CPPFLAGS =  -I. -I$(top_builddir)/src/include -I$(top_srcdir)/src/include
R_XTRA_FFLAGS = 
R_XTRA_LIBS = 
RANLIB = ranlib
READLINE_LIBS = -lreadline -lncurses 
SED = /bin/sed
SHELL = /bin/sh
SHLIB_EXT = .so
SHLIB_CFLAGS = 
SHLIB_FFLAGS = 
SHLIB_LD = gcc -std=gnu99
SHLIB_LDFLAGS = -shared
SHLIB_LINK = $(SHLIB_LD) $(SHLIB_LDFLAGS) $(LDFLAGS)
STRIP_LIBS = strip --strip-unneeded
STRIP_STATIC_LIBS = strip --strip-debug
TAR = tar
USE_NLS = yes
X_CFLAGS =  -I/usr/X11R6/include
X_LIBS =  -L/usr/X11R6/lib64 -lX11 -lXt -lXmu
X_PRE_LIBS =  -lSM -lICE
X_EXTRA_LIBS = 
YACC = bison -y

ALL_CFLAGS = $(R_XTRA_CFLAGS) $(MAIN_CFLAGS) $(CFLAGS)
ALL_CPPFLAGS = $(R_XTRA_CPPFLAGS) $(CPPFLAGS) $(DEFS)
ALL_FFLAGS = $(R_XTRA_FFLAGS) $(MAIN_FFLAGS) $(FFLAGS)
ALL_OBJCFLAGS = $(R_XTRA_OBJCFLAGS) $(MAIN_OBJCFLAGS) $(OBJCFLAGS)
ALL_CFLAGS_LO = $(R_XTRA_CFLAGS) $(CPICFLAGS) $(SHLIB_CFLAGS) $(CFLAGS)
ALL_FFLAGS_LO = $(R_XTRA_FFLAGS) $(FPICFLAGS) $(SHLIB_FFLAGS) $(FFLAGS)

.SUFFIXES:
.SUFFIXES: .c .f .m .d .o

.c.o:
	$(CC) $(ALL_CPPFLAGS) $(ALL_CFLAGS) -c $< -o $@
.c.d:
	@echo "making $@ from $<"
	@gcc -std=gnu99 -MM $(ALL_CPPFLAGS) $< > $@
.f.o:
	$(F77) $(ALL_FFLAGS) -c $< -o $@
.m.o:
	$(OBJC) $(ALL_CPPFLAGS) $(ALL_OBJCFLAGS) -c $< -o $@
.m.d:
	@echo "making $@ from $<"
	@gcc -E -M $(ALL_CPPFLAGS) $< > $@

prefix = /usr/local
exec_prefix = ${prefix}
datarootdir = ${prefix}/share
## only used for installing 'R'.
bindir = ${exec_prefix}/bin
## not used
datadir = ${datarootdir}
## used for 'rhome' and installation of standalone Rmath
libdir = ${exec_prefix}/${LIBnn}
## used for man page
mandir = ${datarootdir}/man
## used for installation of standalone Rmath headers
includedir = ${prefix}/include

rhome = ${libdir}/R
rsharedir = ${rhome}/share
rincludedir = ${rhome}/include
rdocdir = ${rhome}/doc

## Overrides for installing R as a framework (MacOS X).
#FW_VERSION = 
#rhome = $(R_FRAMEWORK_DIR)/Versions/$(FW_VERSION)/Resources
#bindir = $(rhome)
#mandir = $(rhome)

Rexecbindir = $(rhome)/bin
Rexecbindir2 = $(rhome)/bin/exec$(R_ARCH)
Rexeclibdir = $(rhome)/lib$(R_ARCH)
## FIXME:
## Alternatively, we could try to set pkglibdir = $(rhome)/lib when
## switching to automake.
## </FIXME>
Rexecmodulesdir = $(rhome)/modules$(R_ARCH)
-------------- next part --------------
# etc/Makeconf.  Generated from Makeconf.in by configure.
#
# ${R_HOME}/etc/Makeconf

include $(R_SHARE_DIR)/make/vars.mk

AR = ar
BLAS_LIBS = -L$(R_HOME)/lib$(R_ARCH) -lRblas
C_VISIBILITY = 
CC = gcc -std=gnu99
CFLAGS = -g -O2
CPICFLAGS = -fpic
CPPFLAGS = -I/usr/local/include
CXX = g++
CXXCPP = g++ -E
CXXFLAGS = -g -O2
CXXPICFLAGS = -fpic
DYLIB_EXT = .so
DYLIB_LD = gcc -std=gnu99
DYLIB_LDFLAGS = -shared
DYLIB_LINK = $(DYLIB_LD) $(DYLIB_LDFLAGS) $(LDFLAGS)
ECHO = echo
ECHO_C = 
ECHO_N = -n
ECHO_T = 
F77 = g77
F77_VISIBILITY = 
FC = g77
FCFLAGS = -g -O2
FFLAGS = -g -O2
FLIBS =  -lg2c -lm
FCPICFLAGS = -fpic
FPICFLAGS = -fpic
FOUNDATION_CPPFLAGS = 
FOUNDATION_LIBS = 
JAR = /usr/bin/jar
JAVA = 
JAVAC = /usr/bin/javac
JAVAH = 
JAVA_HOME = 
JAVA_LD_LIBRARY_PATH = 
JAVA_LIBS = 
JAVA_CPPFLAGS = 
LAPACK_LIBS = -L$(R_HOME)/lib$(R_ARCH) -lRlapack
## we only need this is if it is external, as otherwise link to R
LIBINTL= 
LIBM = -lm
LIBR = 
LIBS =  -ldl -lm
## needed by R CMD config
LIBnn = lib64
LIBTOOL = $(SHELL) $(R_HOME)/bin/libtool
LDFLAGS = -L/usr/local/lib64
## needed to build applications linking to static libR
MAIN_LD = gcc -std=gnu99
MAIN_LDFLAGS = -Wl,--export-dynamic
MAIN_LINK = $(MAIN_LD) $(MAIN_LDFLAGS) $(LDFLAGS)
MKINSTALLDIRS = $(R_HOME)/bin/mkinstalldirs
OBJC = 
OBJCFLAGS = -g -O2
OBJC_LIBS = 
OBJCXX = g++
R_ARCH = 
RANLIB = ranlib
SAFE_FFLAGS = -g -O2 -ffloat-store
SED = /bin/sed
SHELL = /bin/sh
SHLIB_CFLAGS = 
SHLIB_CXXFLAGS = 
SHLIB_CXXLD = g++
SHLIB_CXXLDFLAGS = -shared
SHLIB_EXT = .so
SHLIB_FCLD = g77
SHLIB_FCLDFLAGS = -shared
SHLIB_FFLAGS = 
SHLIB_LD = gcc -std=gnu99
SHLIB_LDFLAGS = -shared
SHLIB_LIBADD = 
SHLIB_LINK = $(SHLIB_LD) $(SHLIB_LDFLAGS) $(LDFLAGS)
STRIP_LIBS = strip --strip-unneeded
STRIP_STATIC_LIBS = strip --strip-debug
TCLTK_CPPFLAGS = 
TCLTK_LIBS = 

## for linking to libR.a
STATIC_LIBR = # $(R_HOME)/lib$(R_ARCH)/libR.a $(BLAS_LIBS) $(FLIBS)  $(LIBINTL) -lreadline -lncurses  $(LIBS)


R_XTRA_CFLAGS = 
R_XTRA_CPPFLAGS =  -I$(R_INCLUDE_DIR)
R_XTRA_CXXFLAGS = 
R_XTRA_FFLAGS = 

ALL_CFLAGS = $(R_XTRA_CFLAGS) $(PKG_CFLAGS) $(CPICFLAGS) $(SHLIB_CFLAGS) $(CFLAGS)
ALL_CPPFLAGS = $(R_XTRA_CPPFLAGS) $(PKG_CPPFLAGS) $(CPPFLAGS) $(CLINK_CPPFLAGS)
ALL_CXXFLAGS = $(R_XTRA_CXXFLAGS) $(PKG_CXXFLAGS) $(CXXPICFLAGS) $(SHLIB_CXXFLAGS) $(CXXFLAGS)
ALL_OBJCFLAGS = $(PKG_OBJCFLAGS) $(CPICFLAGS) $(SHLIB_CFLAGS) $(OBJCFLAGS)
ALL_OBJCXXFLAGS = $(PKG_OBJCXXFLAGS) $(CXXPICFLAGS) $(SHLIB_CXXFLAGS) $(OBJCXXFLAGS)
ALL_FFLAGS = $(R_XTRA_FFLAGS) $(PKG_FFLAGS) $(FPICFLAGS) $(SHLIB_FFLAGS) $(FFLAGS)
ALL_LIBS = $(PKG_LIBS) $(SHLIB_LIBADD) $(LIBR)# $(LIBINTL)

.SUFFIXES:
.SUFFIXES: .c .cc .cpp .C .d .f .f90 .f95 .m .mm .M .o

.c.o:
	$(CC) $(ALL_CPPFLAGS) $(ALL_CFLAGS) -c $< -o $@
.c.d:
	@echo "making $@ from $<"
	@gcc -std=gnu99 -MM $(ALL_CPPFLAGS) $< > $@
.cc.o:
	$(CXX) $(ALL_CPPFLAGS) $(ALL_CXXFLAGS) -c $< -o $@
.cpp.o:
	$(CXX) $(ALL_CPPFLAGS) $(ALL_CXXFLAGS) -c $< -o $@
.C.o:
	$(CXX) $(ALL_CPPFLAGS) $(ALL_CXXFLAGS) -c $< -o $@
.cc.d:
	@echo "making $@ from $<"
	@$(CXX) -M $(ALL_CPPFLAGS) $< > $@
.cpp.d:
	@echo "making $@ from $<"
	@$(CXX) -M $(ALL_CPPFLAGS) $< > $@
.C.d:
	@echo "making $@ from $<"
	@$(CXX) -M $(ALL_CPPFLAGS) $< > $@
.m.o:
	$(OBJC) $(ALL_CPPFLAGS) $(ALL_OBJCFLAGS) -c $< -o $@
.m.d:
	@echo "making $@ from $<"
	@gcc -E -M $(ALL_CPPFLAGS) $< > $@
.mm.o:
	$(OBJCXX) $(ALL_CPPFLAGS) $(ALL_OBJCXXFLAGS) -c $< -o $@
.M.o:
	$(OBJCXX) $(ALL_CPPFLAGS) $(ALL_OBJCXXFLAGS) -c $< -o $@
.f.o:
	$(F77) $(ALL_FFLAGS) -c $< -o $@
.f95.o:
	$(FC) $(PKG_FCFLAGS) $(FCPICFLAGS) $(FCFLAGS) -c  $< -o $@
.f90.o:
	$(FC) $(PKG_FCFLAGS) $(FCPICFLAGS) $(FCFLAGS) -c  $< -o $@

From markus.jochmann at strath.ac.uk  Thu Jul 23 22:25:04 2009
From: markus.jochmann at strath.ac.uk (Markus Jochmann)
Date: Thu, 23 Jul 2009 13:25:04 -0700 (PDT)
Subject: [Rd] Building a package with BLAS under Windows
In-Reply-To: <24590763.post@talk.nabble.com>
References: <24590763.post@talk.nabble.com>
Message-ID: <24633850.post@talk.nabble.com>


Solved it myself: The single precision and complex BLAS routines were not
installed.
-- 
View this message in context: http://www.nabble.com/Building-a-package-with-BLAS-under-Windows-tp24590763p24633850.html
Sent from the R devel mailing list archive at Nabble.com.


From Thierry.ONKELINX at inbo.be  Fri Jul 24 10:20:27 2009
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Fri, 24 Jul 2009 10:20:27 +0200
Subject: [Rd] Extend FAQ 7.22
Message-ID: <2E9C414912813E4EB981326983E0A104069D9CDA@inboexch.inbo.be>

Dear all,

I suggest to extend FAQ 7.22 by mentioning ggplot2 graphics as well.


7.22 Why do lattice/trellis/ggplot2 graphics not work?

The most likely reason is that you forgot to tell R to display the
graph. Lattice functions such as xyplot() create a graph object, but do
not display it (the same is true of ggplot2 graphics and Trellis
graphics in S-Plus). The print() method for the graph object produces
the actual display. When you use these functions interactively at the
command line, the result is automatically printed, but in source() or
inside your own functions you will need an explicit print() statement. 


Best regards,

Thierry

------------------------------------------------------------------------
----
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature
and Forest
Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
methodology and quality assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium
tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be
www.inbo.be

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to
say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of
data.
~ John Tukey


Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer 
en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is
door een geldig ondertekend document. The views expressed in  this message 
and any annex are purely those of the writer and may not be regarded as stating 
an official position of INBO, as long as the message is not confirmed by a duly 
signed document.


From sateeshvarmap at gmail.com  Fri Jul 24 08:11:57 2009
From: sateeshvarmap at gmail.com (Albert EINstEIN)
Date: Thu, 23 Jul 2009 23:11:57 -0700 (PDT)
Subject: [Rd]  How to create a permanent dataset in R.
Message-ID: <24639146.post@talk.nabble.com>



Hi everybody,

Actually, we know that If we create a dataset in R ,after closing the
session the dataset automatically is closed. I tried for creating dataset
permanently in R.I am facing the problem of creating permanent dataset.
can we create dataset permanently If possible? 
Could somebody help me out in this aspect,plz? Any help would be
appreciated.

Thanks in advance.
-- 
View this message in context: http://www.nabble.com/How-to-create-a-permanent-dataset-in-R.-tp24639146p24639146.html
Sent from the R devel mailing list archive at Nabble.com.


From jeremiah.cohen at gmail.com  Thu Jul 23 21:30:12 2009
From: jeremiah.cohen at gmail.com (jeremiah.cohen at gmail.com)
Date: Thu, 23 Jul 2009 21:30:12 +0200 (CEST)
Subject: [Rd] Bug in seq() (PR#13849)
Message-ID: <20090723193012.D69F3282EFFB@mail.pubhealth.ku.dk>

Full_Name: Jeremiah Cohen
Version: 2.9.0
OS: Windows XP
Submission from: (NULL) (129.59.230.235)


I believe there is a bug in the seq() function for certain values of the "from"
argument. Here are examples:

> seq(-.2, .1, .1)
[1] -0.2 -0.1  0.0  0.1
> seq(-.3, .1, .1)
[1] -3.000000e-01 -2.000000e-01 -1.000000e-01  5.551115e-17  1.000000e-01
> seq(-.4, .1, .1)
[1] -0.4 -0.3 -0.2 -0.1  0.0  0.1
> seq(-.5, .1, .1)
[1] -0.5 -0.4 -0.3 -0.2 -0.1  0.0  0.1
> seq(-.6, .1, .1)
[1] -6.000000e-01 -5.000000e-01 -4.000000e-01 -3.000000e-01 -2.000000e-01
-1.000000e-01  1.110223e-16  1.000000e-01
> seq(-.7, .1, .1)
[1] -7.000000e-01 -6.000000e-01 -5.000000e-01 -4.000000e-01 -3.000000e-01
-2.000000e-01 -1.000000e-01  1.110223e-16
[9]  1.000000e-01
> seq(-.8, .1, .1)
[1] -0.8 -0.7 -0.6 -0.5 -0.4 -0.3 -0.2 -0.1  0.0  0.1

So, for example,

> which(seq(-.2, .1, .1) == 0)
[1] 3
> which(seq(-.3, .1, .1) == 0)
integer(0)

Here are the results of the "version" command on my machine:

platform       i386-pc-mingw32             
arch           i386                        
os             mingw32                     
system         i386, mingw32               
status                                     
major          2                           
minor          9.0                         
year           2009                        
month          04                          
day            17                          
svn rev        48333                       
language       R                           
version.string R version 2.9.0 (2009-04-17)


From groemping at bht-berlin.de  Fri Jul 24 16:55:11 2009
From: groemping at bht-berlin.de (groemping at bht-berlin.de)
Date: Fri, 24 Jul 2009 16:55:11 +0200 (CEST)
Subject: [Rd] Misleading sentence in documentation of data.frame (PR#13850)
Message-ID: <20090724145511.28CDA282EF4F@mail.pubhealth.ku.dk>

Full_Name: Ulrike Groemping
Version: 2.9.0
OS: Windows
Submission from: (NULL) (84.190.173.190)


The documentation for data.frame contains the sentence "A data frame is a list
of variables of the same length with unique row names, given class
"data.frame"." This of course does describe the standard use of data frames, but
other versions are possible (e.g. df <- swiss; df$proof <- as.matrix(swiss);
ncol(df); df; length(df$proof)), which is important to know at least for package
developers and should be documented (it is documented with the extractor methods
for data.frame, but I don't think that this is sufficient).

Regards, Ulrike


From groemping at bht-berlin.de  Fri Jul 24 17:00:09 2009
From: groemping at bht-berlin.de (groemping at bht-berlin.de)
Date: Fri, 24 Jul 2009 17:00:09 +0200 (CEST)
Subject: [Rd] Wishlist: install.packages to look for the newest version of a
	package (PR#13851)
Message-ID: <20090724150009.3463F282EF4F@mail.pubhealth.ku.dk>

Full_Name: Ulrike Groemping
Version: 2.9.0 (and older)
OS: Windows
Submission from: (NULL) (84.190.173.190)


When using an older version of R, packages are not found although they are
available for newer versions of R and do work when installed with the old
version. For example, installing DoE.base on R 2.8.1 installs version 0.2, while
CRAN is at version 0.4-1 currently. It would be nice if the install process
would per default look for the newest version of the package and install this
one if its R-version request allows this. (I recently found a help list entry by
Uwe Ligges that explains how to manually install from a repository for a newer
CRAN version, but I did not bookmark it and cannot find it any more. The
documentation does not enlighten me there.)

Regards, Ulrike


From jeff.a.ryan at gmail.com  Fri Jul 24 19:53:12 2009
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Fri, 24 Jul 2009 12:53:12 -0500
Subject: [Rd] How to create a permanent dataset in R.
In-Reply-To: <24639146.post@talk.nabble.com>
References: <24639146.post@talk.nabble.com>
Message-ID: <e8e755250907241053r363a2941ob2463d40bb696280@mail.gmail.com>

The biggest help would come by not pretending to be Albert Einstein.

hTh,
Jeff

On Fri, Jul 24, 2009 at 1:11 AM, Albert EINstEIN<sateeshvarmap at gmail.com> wrote:
>
>
> Hi everybody,
>
> Actually, we know that If we create a dataset in R ,after closing the
> session the dataset automatically is closed. I tried for creating dataset
> permanently in R.I am facing the problem of creating permanent dataset.
> can we create dataset permanently If possible?
> Could somebody help me out in this aspect,plz? Any help would be
> appreciated.
>
> Thanks in advance.
> --
> View this message in context: http://www.nabble.com/How-to-create-a-permanent-dataset-in-R.-tp24639146p24639146.html
> Sent from the R devel mailing list archive at Nabble.com.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From murdoch at stats.uwo.ca  Fri Jul 24 19:54:00 2009
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 24 Jul 2009 13:54:00 -0400
Subject: [Rd] Bug in seq() (PR#13849)
In-Reply-To: <20090723193012.D69F3282EFFB@mail.pubhealth.ku.dk>
References: <20090723193012.D69F3282EFFB@mail.pubhealth.ku.dk>
Message-ID: <4A69F538.9050904@stats.uwo.ca>

On 7/23/2009 3:30 PM, jeremiah.cohen at gmail.com wrote:
> Full_Name: Jeremiah Cohen
> Version: 2.9.0
> OS: Windows XP
> Submission from: (NULL) (129.59.230.235)

This is not a bug, it is yet another variation of FAQ 7.31.

Duncan Murdoch

> 
> 
> I believe there is a bug in the seq() function for certain values of the "from"
> argument. Here are examples:
> 
>> seq(-.2, .1, .1)
> [1] -0.2 -0.1  0.0  0.1
>> seq(-.3, .1, .1)
> [1] -3.000000e-01 -2.000000e-01 -1.000000e-01  5.551115e-17  1.000000e-01
>> seq(-.4, .1, .1)
> [1] -0.4 -0.3 -0.2 -0.1  0.0  0.1
>> seq(-.5, .1, .1)
> [1] -0.5 -0.4 -0.3 -0.2 -0.1  0.0  0.1
>> seq(-.6, .1, .1)
> [1] -6.000000e-01 -5.000000e-01 -4.000000e-01 -3.000000e-01 -2.000000e-01
> -1.000000e-01  1.110223e-16  1.000000e-01
>> seq(-.7, .1, .1)
> [1] -7.000000e-01 -6.000000e-01 -5.000000e-01 -4.000000e-01 -3.000000e-01
> -2.000000e-01 -1.000000e-01  1.110223e-16
> [9]  1.000000e-01
>> seq(-.8, .1, .1)
> [1] -0.8 -0.7 -0.6 -0.5 -0.4 -0.3 -0.2 -0.1  0.0  0.1
> 
> So, for example,
> 
>> which(seq(-.2, .1, .1) == 0)
> [1] 3
>> which(seq(-.3, .1, .1) == 0)
> integer(0)
> 
> Here are the results of the "version" command on my machine:
> 
> platform       i386-pc-mingw32             
> arch           i386                        
> os             mingw32                     
> system         i386, mingw32               
> status                                     
> major          2                           
> minor          9.0                         
> year           2009                        
> month          04                          
> day            17                          
> svn rev        48333                       
> language       R                           
> version.string R version 2.9.0 (2009-04-17)
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Fri Jul 24 19:56:26 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 24 Jul 2009 19:56:26 +0200
Subject: [Rd] Bug in seq() (PR#13849)
In-Reply-To: <20090723193012.D69F3282EFFB@mail.pubhealth.ku.dk>
References: <20090723193012.D69F3282EFFB@mail.pubhealth.ku.dk>
Message-ID: <4A69F5CA.60303@statistik.tu-dortmund.de>

Please read how to report bugs (with recent version of R!) and read the 
FAQs (in thsi case FAQ "Why doesn't R think these numbers are equal?") 
and the mailing list archives before.

Uwe Ligges



jeremiah.cohen at gmail.com wrote:
> Full_Name: Jeremiah Cohen
> Version: 2.9.0
> OS: Windows XP
> Submission from: (NULL) (129.59.230.235)
> 
> 
> I believe there is a bug in the seq() function for certain values of the "from"
> argument. Here are examples:
> 
>> seq(-.2, .1, .1)
> [1] -0.2 -0.1  0.0  0.1
>> seq(-.3, .1, .1)
> [1] -3.000000e-01 -2.000000e-01 -1.000000e-01  5.551115e-17  1.000000e-01
>> seq(-.4, .1, .1)
> [1] -0.4 -0.3 -0.2 -0.1  0.0  0.1
>> seq(-.5, .1, .1)
> [1] -0.5 -0.4 -0.3 -0.2 -0.1  0.0  0.1
>> seq(-.6, .1, .1)
> [1] -6.000000e-01 -5.000000e-01 -4.000000e-01 -3.000000e-01 -2.000000e-01
> -1.000000e-01  1.110223e-16  1.000000e-01
>> seq(-.7, .1, .1)
> [1] -7.000000e-01 -6.000000e-01 -5.000000e-01 -4.000000e-01 -3.000000e-01
> -2.000000e-01 -1.000000e-01  1.110223e-16
> [9]  1.000000e-01
>> seq(-.8, .1, .1)
> [1] -0.8 -0.7 -0.6 -0.5 -0.4 -0.3 -0.2 -0.1  0.0  0.1
> 
> So, for example,
> 
>> which(seq(-.2, .1, .1) == 0)
> [1] 3
>> which(seq(-.3, .1, .1) == 0)
> integer(0)
> 
> Here are the results of the "version" command on my machine:
> 
> platform       i386-pc-mingw32             
> arch           i386                        
> os             mingw32                     
> system         i386, mingw32               
> status                                     
> major          2                           
> minor          9.0                         
> year           2009                        
> month          04                          
> day            17                          
> svn rev        48333                       
> language       R                           
> version.string R version 2.9.0 (2009-04-17)
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ligges at statistik.tu-dortmund.de  Fri Jul 24 20:00:38 2009
From: ligges at statistik.tu-dortmund.de (ligges at statistik.tu-dortmund.de)
Date: Fri, 24 Jul 2009 20:00:38 +0200 (CEST)
Subject: [Rd] Wishlist: install.packages to look for the newest version
	(PR#13852)
Message-ID: <20090724180038.E7B98282EF4F@mail.pubhealth.ku.dk>

Ulrike,

if you install from source, you always get the most recent version of 
the package given it does not depend on a newer version of R.

If you want a binary package, you also get the newest version - that was 
newest at the time we stopped building binaries for that version of R.
We (or better I if we only talk about Windows, but similar for all other 
platforms) cannot build for each R version any more. In that case we'd 
have to build even 11 binary versions for Windows just for the R-2.x.y 
series now. Binary repositories are fixed at some time (for Windows once 
the first patchlevel release of the next R version is out, e.g. at the 
time of the R-2.9.1 release the binary builds for R-2.8.x had been stopped).

So please upgrade your version of R or compile yourself from sources for 
the R version you need the particular package for.

Best wishes,
Uwe Ligges





groemping at bht-berlin.de wrote:
> Full_Name: Ulrike Groemping
> Version: 2.9.0 (and older)
> OS: Windows
> Submission from: (NULL) (84.190.173.190)
> 
> 
> When using an older version of R, packages are not found although they are
> available for newer versions of R and do work when installed with the old
> version. For example, installing DoE.base on R 2.8.1 installs version 0.2, while
> CRAN is at version 0.4-1 currently. It would be nice if the install process
> would per default look for the newest version of the package and install this
> one if its R-version request allows this. (I recently found a help list entry by
> Uwe Ligges that explains how to manually install from a repository for a newer
> CRAN version, but I did not bookmark it and cannot find it any more. The
> documentation does not enlighten me there.)
> 
> Regards, Ulrike
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From tlumley at u.washington.edu  Fri Jul 24 23:43:38 2009
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Fri, 24 Jul 2009 14:43:38 -0700 (PDT)
Subject: [Rd] Wishlist: install.packages to look for the newest version
 (PR#13852)
In-Reply-To: <20090724180038.E7B98282EF4F@mail.pubhealth.ku.dk>
Message-ID: <Pine.LNX.4.43.0907241443380.14406@hymn13.u.washington.edu>


Uwe,

I think Ulrike is making a different suggestion, that install.packages() should fetch the binary that has been built for the current version of R.

This would be a bad idea for a different reason -- in general it is not possible to be sure that the package works with an older version of R. The R version dependency isn't enough for two reasons. The first is that the author may well not know that the package fails with an older version of R and so would not have listed a dependency. The second is that the binary versions may be incompatible even if the source versions are compatible.

You can always download a binary package from CRAN in a browser and use the option to install from a local zip file. Or, as Uwe suggests, get a new version of R.

What I think might be useful if it's not too difficult is a warning from install.packages() that a newer version of the package you were installing is available for the current version of R.

      -thomas


On Fri, 24 Jul 2009 ligges at statistik.tu-dortmund.de wrote:

> Ulrike,
>
> if you install from source, you always get the most recent version of
> the package given it does not depend on a newer version of R.
>
> If you want a binary package, you also get the newest version - that was
> newest at the time we stopped building binaries for that version of R.
> We (or better I if we only talk about Windows, but similar for all other
> platforms) cannot build for each R version any more. In that case we'd
> have to build even 11 binary versions for Windows just for the R-2.x.y
> series now. Binary repositories are fixed at some time (for Windows once
> the first patchlevel release of the next R version is out, e.g. at the
> time of the R-2.9.1 release the binary builds for R-2.8.x had been stopped).
>
> So please upgrade your version of R or compile yourself from sources for
> the R version you need the particular package for.
>
> Best wishes,
> Uwe Ligges
>
>
>
>
>
> groemping at bht-berlin.de wrote:
>> Full_Name: Ulrike Groemping
>> Version: 2.9.0 (and older)
>> OS: Windows
>> Submission from: (NULL) (84.190.173.190)
>>
>>
>> When using an older version of R, packages are not found although they are
>> available for newer versions of R and do work when installed with the old
>> version. For example, installing DoE.base on R 2.8.1 installs version 0.2, while
>> CRAN is at version 0.4-1 currently. It would be nice if the install process
>> would per default look for the newest version of the package and install this
>> one if its R-version request allows this. (I recently found a help list entry by
>> Uwe Ligges that explains how to manually install from a repository for a newer
>> CRAN version, but I did not bookmark it and cannot find it any more. The
>> documentation does not enlighten me there.)
>>
>> Regards, Ulrike
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley at u.washington.edu	University of Washington, Seattle


From mdowle at mdowle.plus.com  Sat Jul 25 09:07:44 2009
From: mdowle at mdowle.plus.com (Matthew Dowle)
Date: Sat, 25 Jul 2009 08:07:44 +0100
Subject: [Rd] Using svSocket with data.table
Message-ID: <h4eb3j$eji$1@ger.gmane.org>

Hi r-devel,

svSocket is working well.  Short demo here of using it with data.table : 
http://www.youtube.com/watch?v=rvT8XThGA8o
If you maximise and press the HD button it should be readable.  There isn't 
any audio.

However, svSocket is currently text based IPC using dump.  Is there a 
solution which will do binary and work in the same way ?  Its nice that I 
can make R become a server any time after it starts up i.e. I'm not 
restricted to just R sessions that have been started by some cluster 
wrapper.  Its also great that the command line interface is not blocked.   I 
can even type options(debug.Socket=TRUE) into the server to see the traffic, 
then type in to set debug back to FALSE again,  all while its running 
(although that isn't in this demo).  And of course this is cross platform, 
the R client can be 32 bit windows, the R server can be 64 bit lunix.  Or 
remote graphics for example.

So I'm looking to do the same as the demo,  but with a binary socket.  Does 
anyone have any ideas?  I've looked a bit at  Rserve, bigmemory, biocep, nws 
but although all those packages are great,  I didn't find anything that 
worked in exactly this way i.e.  i) R to R ii) CLI non-blocking and iii) no 
need to startup R in a special way

Regards, Matthew


From groemp at tfh-berlin.de  Sat Jul 25 09:21:02 2009
From: groemp at tfh-berlin.de (=?UTF-8?Q?Ulrike_Gr=C3=B6mping?=)
Date: Sat, 25 Jul 2009 00:21:02 -0700 (PDT)
Subject: [Rd] Wishlist: install.packages to look for the newest version
 (PR#13852)
In-Reply-To: <Pine.LNX.4.43.0907241443380.14406@hymn13.u.washington.edu>
References: <20090724180038.E7B98282EF4F@mail.pubhealth.ku.dk>
	<Pine.LNX.4.43.0907241443380.14406@hymn13.u.washington.edu>
Message-ID: <24655521.post@talk.nabble.com>


Thomas,

yes, I think, if installation of the new version is not safe, a warning
would be a very good idea, perhaps also with a hint on how to manually
install from the repository for the new version of R ? 

Regards, Ulrike


Thomas Lumley wrote:
> 
> 
> Uwe,
> 
> I think Ulrike is making a different suggestion, that install.packages()
> should fetch the binary that has been built for the current version of R.
> 
> This would be a bad idea for a different reason -- in general it is not
> possible to be sure that the package works with an older version of R. The
> R version dependency isn't enough for two reasons. The first is that the
> author may well not know that the package fails with an older version of R
> and so would not have listed a dependency. The second is that the binary
> versions may be incompatible even if the source versions are compatible.
> 
> You can always download a binary package from CRAN in a browser and use
> the option to install from a local zip file. Or, as Uwe suggests, get a
> new version of R.
> 
> What I think might be useful if it's not too difficult is a warning from
> install.packages() that a newer version of the package you were installing
> is available for the current version of R.
> 
>       -thomas
> 
> 
> On Fri, 24 Jul 2009 ligges at statistik.tu-dortmund.de wrote:
> 
>> Ulrike,
>>
>> if you install from source, you always get the most recent version of
>> the package given it does not depend on a newer version of R.
>>
>> If you want a binary package, you also get the newest version - that was
>> newest at the time we stopped building binaries for that version of R.
>> We (or better I if we only talk about Windows, but similar for all other
>> platforms) cannot build for each R version any more. In that case we'd
>> have to build even 11 binary versions for Windows just for the R-2.x.y
>> series now. Binary repositories are fixed at some time (for Windows once
>> the first patchlevel release of the next R version is out, e.g. at the
>> time of the R-2.9.1 release the binary builds for R-2.8.x had been
>> stopped).
>>
>> So please upgrade your version of R or compile yourself from sources for
>> the R version you need the particular package for.
>>
>> Best wishes,
>> Uwe Ligges
>>
>>
>>
>>
>>
>> groemping at bht-berlin.de wrote:
>>> Full_Name: Ulrike Groemping
>>> Version: 2.9.0 (and older)
>>> OS: Windows
>>> Submission from: (NULL) (84.190.173.190)
>>>
>>>
>>> When using an older version of R, packages are not found although they
>>> are
>>> available for newer versions of R and do work when installed with the
>>> old
>>> version. For example, installing DoE.base on R 2.8.1 installs version
>>> 0.2, while
>>> CRAN is at version 0.4-1 currently. It would be nice if the install
>>> process
>>> would per default look for the newest version of the package and install
>>> this
>>> one if its R-version request allows this. (I recently found a help list
>>> entry by
>>> Uwe Ligges that explains how to manually install from a repository for a
>>> newer
>>> CRAN version, but I did not bookmark it and cannot find it any more. The
>>> documentation does not enlighten me there.)
>>>
>>> Regards, Ulrike
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
> Thomas Lumley			Assoc. Professor, Biostatistics
> tlumley at u.washington.edu	University of Washington, Seattle
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 

-- 
View this message in context: http://www.nabble.com/Re%3A-Wishlist%3A-install.packages-to-look-for-the-newest-version-%28PR-13852%29-tp24649240p24655521.html
Sent from the R devel mailing list archive at Nabble.com.


From alexdamour at gmail.com  Fri Jul 24 19:39:05 2009
From: alexdamour at gmail.com (Alex D'Amour)
Date: Fri, 24 Jul 2009 13:39:05 -0400
Subject: [Rd] How to create a permanent dataset in R.
In-Reply-To: <24639146.post@talk.nabble.com>
References: <24639146.post@talk.nabble.com>
Message-ID: <2ffd32cb0907241039h748b27e8h43d13243fda52105@mail.gmail.com>

Say your dataset is stored in variable "dat".

Type:

> save(dat, file="mydatfile.RData")

Next time you start the session, call:

load("mydatfile.RData")

And you can reload your dataset.

Is this what you meant?

HTH,
Alex

On Fri, Jul 24, 2009 at 2:11 AM, Albert EINstEIN<sateeshvarmap at gmail.com> wrote:
>
>
> Hi everybody,
>
> Actually, we know that If we create a dataset in R ,after closing the
> session the dataset automatically is closed. I tried for creating dataset
> permanently in R.I am facing the problem of creating permanent dataset.
> can we create dataset permanently If possible?
> Could somebody help me out in this aspect,plz? Any help would be
> appreciated.
>
> Thanks in advance.
> --
> View this message in context: http://www.nabble.com/How-to-create-a-permanent-dataset-in-R.-tp24639146p24639146.html
> Sent from the R devel mailing list archive at Nabble.com.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From groemping at bht-berlin.de  Fri Jul 24 20:35:17 2009
From: groemping at bht-berlin.de (groemping at bht-berlin.de)
Date: Fri, 24 Jul 2009 20:35:17 +0200 (CEST)
Subject: [Rd] Wishlist: install.packages to look for the newest version
	(PR#13853)
Message-ID: <20090724183517.2831F282EF4F@mail.pubhealth.ku.dk>

Uwe,

I am talking binaries and Windows. I was not thinking of building 
binaries for old versions, but of looking in the new version 
repositories first, whether there is a binary that is said to be valid 
for the older version. Wouldn't it be possible to have the process look 
up a table of a newer R version for compatible binaries ?
I got stuck with R 2-8.1 (which is not that old and should not have 
stopped building binaries yet, has it?), where the binary install 
installs version 0.2 from the Austrian repository although version 0.3 
has been around for almost a month and version 0.4-1 is current.

As a workaround, I could at least refer people who are willing to test 
my current (quickly changing) design packages to the install command 
that allows them to install the packages from the newer repository 
without upgrading their R version. Could you help me out with that 
command ? I searched quite a bit and remember a help entry by you, but 
did not find anything any more about the syntax of install.packages for 
this purpose.

Regards, Ulrike

Uwe Ligges schrieb:
> Ulrike,
>
> if you install from source, you always get the most recent version of 
> the package given it does not depend on a newer version of R.
>
> If you want a binary package, you also get the newest version - that 
> was newest at the time we stopped building binaries for that version 
> of R.
> We (or better I if we only talk about Windows, but similar for all 
> other platforms) cannot build for each R version any more. In that 
> case we'd have to build even 11 binary versions for Windows just for 
> the R-2.x.y series now. Binary repositories are fixed at some time 
> (for Windows once the first patchlevel release of the next R version 
> is out, e.g. at the time of the R-2.9.1 release the binary builds for 
> R-2.8.x had been stopped).
>
> So please upgrade your version of R or compile yourself from sources 
> for the R version you need the particular package for.
>
> Best wishes,
> Uwe Ligges
>
>
>
>
>
> groemping at bht-berlin.de wrote:
>> Full_Name: Ulrike Groemping
>> Version: 2.9.0 (and older)
>> OS: Windows
>> Submission from: (NULL) (84.190.173.190)
>>
>>
>> When using an older version of R, packages are not found although 
>> they are
>> available for newer versions of R and do work when installed with the 
>> old
>> version. For example, installing DoE.base on R 2.8.1 installs version 
>> 0.2, while
>> CRAN is at version 0.4-1 currently. It would be nice if the install 
>> process
>> would per default look for the newest version of the package and 
>> install this
>> one if its R-version request allows this. (I recently found a help 
>> list entry by
>> Uwe Ligges that explains how to manually install from a repository 
>> for a newer
>> CRAN version, but I did not bookmark it and cannot find it any more. The
>> documentation does not enlighten me there.)
>>
>> Regards, Ulrike
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel


-- 
***********************************************
* Ulrike Groemping                            *
* BHT Berlin - University of Applied Sciences *
***********************************************
* +49 (30) 39404863 (Home Office)             *
* +49 (30) 4504 5127 (BHT)                    *
***********************************************
* http://prof.tfh-berlin.de/groemping         *
* groemping at bht-berlin.de                     *


From ligges at statistik.tu-dortmund.de  Sat Jul 25 11:45:09 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sat, 25 Jul 2009 11:45:09 +0200
Subject: [Rd] Wishlist: install.packages to look for the newest version
 of a	package (PR#13851)
In-Reply-To: <4A69FE71.8050407@bht-berlin.de>
References: <20090724150009.3463F282EF4F@mail.pubhealth.ku.dk>
	<4A69F552.9070501@statistik.tu-dortmund.de>
	<4A69FE71.8050407@bht-berlin.de>
Message-ID: <4A6AD425.6060903@statistik.tu-dortmund.de>



Ulrike Gr?mping wrote:
> Uwe,
> 
> I am talking binaries and Windows. I was not thinking of building 
> binaries for old versions, but of looking in the new version 
> repositories first, whether there is a binary that is said to be valid 
> for the older version. Wouldn't it be possible to have the process look 
> up a table of a newer R version for compatible binaries ?


[I stopped bugging R-bugs and "just" send to R-devel now]


Well, we cannot know if a package needs to be recompiled for another R 
version - you cannot assume binary compatibility: a package compiled 
under R-x1.y1.z may not work under R-x2.y2.z, for x1.y1 != x2.y2


> I got stuck with R 2-8.1 (which is not that old and should not have 
> stopped building binaries yet, has it?), 

Well we are building binaries for R-2.9.x and R-devel (to be R-2.10.0) 
and stopped building for R-2.8.x. S


where the binary install
> installs version 0.2 from the Austrian repository although version 0.3 
> has been around for almost a month and version 0.4-1 is current.
> 
> As a workaround, I could at least refer people who are willing to test 
> my current (quickly changing) design packages to the install command 
> that allows them to install the packages from the newer repository 
> without upgrading their R version. 

No, since we cannot be sure that the new binary works with old R. Source 
package compatibility does not imply binary compatibility.

 > Could you help me out with that
> command ? I searched quite a bit and remember a help entry by you, but 
> did not find anything any more about the syntax of install.packages for 
> this purpose.

Well, you could try by downloading the most recent version form CRAN and 
install via zip file from the Windows GUI. Or much better, install from 
sources which is not that difficult.

Best wishes,
Uwe


> 
> Regards, Ulrike
> 
> Uwe Ligges schrieb:
>> Ulrike,
>>
>> if you install from source, you always get the most recent version of 
>> the package given it does not depend on a newer version of R.
>>
>> If you want a binary package, you also get the newest version - that 
>> was newest at the time we stopped building binaries for that version 
>> of R.
>> We (or better I if we only talk about Windows, but similar for all 
>> other platforms) cannot build for each R version any more. In that 
>> case we'd have to build even 11 binary versions for Windows just for 
>> the R-2.x.y series now. Binary repositories are fixed at some time 
>> (for Windows once the first patchlevel release of the next R version 
>> is out, e.g. at the time of the R-2.9.1 release the binary builds for 
>> R-2.8.x had been stopped).
>>
>> So please upgrade your version of R or compile yourself from sources 
>> for the R version you need the particular package for.
>>
>> Best wishes,
>> Uwe Ligges
>>
>>
>>
>>
>>
>> groemping at bht-berlin.de wrote:
>>> Full_Name: Ulrike Groemping
>>> Version: 2.9.0 (and older)
>>> OS: Windows
>>> Submission from: (NULL) (84.190.173.190)
>>>
>>>
>>> When using an older version of R, packages are not found although 
>>> they are
>>> available for newer versions of R and do work when installed with the 
>>> old
>>> version. For example, installing DoE.base on R 2.8.1 installs version 
>>> 0.2, while
>>> CRAN is at version 0.4-1 currently. It would be nice if the install 
>>> process
>>> would per default look for the newest version of the package and 
>>> install this
>>> one if its R-version request allows this. (I recently found a help 
>>> list entry by
>>> Uwe Ligges that explains how to manually install from a repository 
>>> for a newer
>>> CRAN version, but I did not bookmark it and cannot find it any more. The
>>> documentation does not enlighten me there.)
>>>
>>> Regards, Ulrike
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
>


From ligges at statistik.tu-dortmund.de  Sat Jul 25 11:48:27 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sat, 25 Jul 2009 11:48:27 +0200
Subject: [Rd] Wishlist: install.packages to look for the newest version
 (PR#13852)
In-Reply-To: <Pine.LNX.4.43.0907241443380.14406@hymn13.u.washington.edu>
References: <Pine.LNX.4.43.0907241443380.14406@hymn13.u.washington.edu>
Message-ID: <4A6AD4EB.6080201@statistik.tu-dortmund.de>



Thomas Lumley wrote:
> 
> Uwe,
> 
> I think Ulrike is making a different suggestion, that install.packages() 
> should fetch the binary that has been built for the current version of R.
> 
> This would be a bad idea for a different reason -- in general it is not 
> possible to be sure that the package works with an older version of R. 
> The R version dependency isn't enough for two reasons. The first is that 
> the author may well not know that the package fails with an older 
> version of R and so would not have listed a dependency. The second is 
> that the binary versions may be incompatible even if the source versions 
> are compatible.
> 
> You can always download a binary package from CRAN in a browser and use 
> the option to install from a local zip file. Or, as Uwe suggests, get a 
> new version of R.
> 
> What I think might be useful if it's not too difficult is a warning from 
> install.packages() that a newer version of the package you were 
> installing is available for the current version of R.

That could be done, of course, but not that easy (see below * ). But 
then, should we also warn in general (say if 
[install,update,available].packages() is called) that a newer R version 
is available?

I thought that has been discussed some years ago and the decision was 
not to warn, but now it is 2009 and we may want something different.

(*) Not easy for former releases. For future releases, it is possible to 
always look additionally into the "R-release" respository, but it means 
that an additional packages file must be downloaded (which is not funny 
for modem connections) in order to be able to compare versions and just 
to generate a warning.

Best wishes,
Uwe



>      -thomas
> 
> 
> On Fri, 24 Jul 2009 ligges at statistik.tu-dortmund.de wrote:
> 
>> Ulrike,
>>
>> if you install from source, you always get the most recent version of
>> the package given it does not depend on a newer version of R.
>>
>> If you want a binary package, you also get the newest version - that was
>> newest at the time we stopped building binaries for that version of R.
>> We (or better I if we only talk about Windows, but similar for all other
>> platforms) cannot build for each R version any more. In that case we'd
>> have to build even 11 binary versions for Windows just for the R-2.x.y
>> series now. Binary repositories are fixed at some time (for Windows once
>> the first patchlevel release of the next R version is out, e.g. at the
>> time of the R-2.9.1 release the binary builds for R-2.8.x had been 
>> stopped).
>>
>> So please upgrade your version of R or compile yourself from sources for
>> the R version you need the particular package for.
>>
>> Best wishes,
>> Uwe Ligges
>>
>>
>>
>>
>>
>> groemping at bht-berlin.de wrote:
>>> Full_Name: Ulrike Groemping
>>> Version: 2.9.0 (and older)
>>> OS: Windows
>>> Submission from: (NULL) (84.190.173.190)
>>>
>>>
>>> When using an older version of R, packages are not found although 
>>> they are
>>> available for newer versions of R and do work when installed with the 
>>> old
>>> version. For example, installing DoE.base on R 2.8.1 installs version 
>>> 0.2, while
>>> CRAN is at version 0.4-1 currently. It would be nice if the install 
>>> process
>>> would per default look for the newest version of the package and 
>>> install this
>>> one if its R-version request allows this. (I recently found a help 
>>> list entry by
>>> Uwe Ligges that explains how to manually install from a repository 
>>> for a newer
>>> CRAN version, but I did not bookmark it and cannot find it any more. The
>>> documentation does not enlighten me there.)
>>>
>>> Regards, Ulrike
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
> Thomas Lumley            Assoc. Professor, Biostatistics
> tlumley at u.washington.edu    University of Washington, Seattle
> 
> 
>


From romain.francois at dbmail.com  Sat Jul 25 14:52:50 2009
From: romain.francois at dbmail.com (Romain Francois)
Date: Sat, 25 Jul 2009 14:52:50 +0200
Subject: [Rd] Using svSocket with data.table
In-Reply-To: <h4eb3j$eji$1@ger.gmane.org>
References: <h4eb3j$eji$1@ger.gmane.org>
Message-ID: <4A6B0022.5060106@dbmail.com>

Hi,

Just look at the way Rserve wraps data and the way the Rserve client 
unwraps it, and pipe the data through the svSocket instead of Rserve 
communication protocols.

The command line is not blocked because svSocket uses tcl/tk event loop 
for the communication.

So there are these questions:
- can the socket implemented in svSocket handle binary transfer of data.
- can you wrap the data suitable for transfer through a socket
- can you then unwrap the data on the other side of the socket

I am pretty sure the two last questions can be answered by Rserve. The 
first question, you can answer by looking at the way the socket server 
is created, and then change it so it transfers binary data, I would be 
surprised if the tcl socket would not be able to transfer binary data.

The "danger" of svSocket is that it somehow gives the illusion that R 
deals with concurrent requests (from the command line and the socket)

Romain


On 07/25/2009 09:07 AM, Matthew Dowle wrote:
> Hi r-devel,
>
> svSocket is working well.  Short demo here of using it with data.table :
> http://www.youtube.com/watch?v=rvT8XThGA8o
> If you maximise and press the HD button it should be readable.  There isn't
> any audio.
>
> However, svSocket is currently text based IPC using dump.  Is there a
> solution which will do binary and work in the same way ?  Its nice that I
> can make R become a server any time after it starts up i.e. I'm not
> restricted to just R sessions that have been started by some cluster
> wrapper.  Its also great that the command line interface is not blocked.   I
> can even type options(debug.Socket=TRUE) into the server to see the traffic,
> then type in to set debug back to FALSE again,  all while its running
> (although that isn't in this demo).  And of course this is cross platform,
> the R client can be 32 bit windows, the R server can be 64 bit lunix.  Or
> remote graphics for example.
>
> So I'm looking to do the same as the demo,  but with a binary socket.  Does
> anyone have any ideas?  I've looked a bit at  Rserve, bigmemory, biocep, nws
> but although all those packages are great,  I didn't find anything that
> worked in exactly this way i.e.  i) R to R ii) CLI non-blocking and iii) no
> need to startup R in a special way
>
> Regards, Matthew


-- 
Romain Francois
Independent R Consultant
+33(0) 6 28 91 30 30
http://romainfrancois.blog.free.fr
|- http://tr.im/tlNb : RGG#155, 156 and 157
|- http://tr.im/rw0p : useR! slides
`- http://tr.im/rw0b : RGG#154: demo of atomic functions


From olafm at kimberly.tako.de  Sat Jul 25 22:56:51 2009
From: olafm at kimberly.tako.de (Olaf Mersmann)
Date: Sat, 25 Jul 2009 22:56:51 +0200
Subject: [Rd] Using svSocket with data.table
In-Reply-To: <h4eb3j$eji$1@ger.gmane.org>
References: <h4eb3j$eji$1@ger.gmane.org>
Message-ID: <1248555172-sup-4306@bloxx.local>

Hi Matthew,

Excerpts from Matthew Dowle's message of Sat Jul 25 09:07:44 +0200 2009:
> So I'm looking to do the same as the demo,  but with a binary socket.  Does 
> anyone have any ideas?  I've looked a bit at  Rserve, bigmemory, biocep, nws 
> but although all those packages are great,  I didn't find anything that 
> worked in exactly this way i.e.  i) R to R ii) CLI non-blocking and iii) no 
> need to startup R in a special way

Don't be fooled. R does not handle multiple requests in parallel
internally. Also I suspect that, depending on what you do on the CLI,
this will interact badly with svSocket. 

As far as binary transfer of R objects goes, you are probably looking
for serialize() and unserialize(). Not sure if these are guaranteed to
work across differen versions of R and different word sizes. See the
Warnings section in the serialize manual page.

Cheers
Olaf


From sateeshvarmap at gmail.com  Mon Jul 27 07:50:14 2009
From: sateeshvarmap at gmail.com (Albert EINstEIN)
Date: Sun, 26 Jul 2009 22:50:14 -0700 (PDT)
Subject: [Rd] How to create a permanent dataset in R.
In-Reply-To: <2ffd32cb0907241039h748b27e8h43d13243fda52105@mail.gmail.com>
References: <24639146.post@talk.nabble.com>
	<2ffd32cb0907241039h748b27e8h43d13243fda52105@mail.gmail.com>
Message-ID: <24673895.post@talk.nabble.com>


Hi,
         Thanks for your valuable reply.
can you provide me some more information regarding . Here we are reloading
the data when we start the R, In R there are some default packages with
datasets can we create a dataset permanently in any packages so that we can
get the dataset without reloading,like creating dataset in a permanent
library in SAS .

   can we create our own packages in R. It would be very helpful for us, if
you provide any information regarding this. 

Thanks for your reply in advance
-- 
View this message in context: http://www.nabble.com/How-to-create-a-permanent-dataset-in-R.-tp24639146p24673895.html
Sent from the R devel mailing list archive at Nabble.com.


From maechler at stat.math.ethz.ch  Mon Jul 27 10:47:19 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 27 Jul 2009 10:47:19 +0200
Subject: [Rd] WRONG mailing list --  How to create ...
In-Reply-To: <24673895.post@talk.nabble.com>
References: <24639146.post@talk.nabble.com>
	<2ffd32cb0907241039h748b27e8h43d13243fda52105@mail.gmail.com>
	<24673895.post@talk.nabble.com>
Message-ID: <19053.27031.308180.190897@lynne.math.ethz.ch>

>>>>> "AE" == Albert EINstEIN <sateeshvarmap at gmail.com>
>>>>>     on Sun, 26 Jul 2009 22:50:14 -0700 (PDT) writes:

PLEASE!  These are typical quesions of R beginners.

They do  *NOT*  belong to the R-devel mailing list,
but rather to R-help  (and even then: 

    PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
  

)

Again: do *NOT* misuse R-devel with such questions. They do not
belong here at all.

Martin <Maechler at stat.math.ethz.ch> 


    AE> Hi, Thanks for your valuable reply.  can you provide me
    AE> some more information regarding . Here we are reloading
    AE> the data when we start the R, In R there are some
    AE> default packages with datasets can we create a dataset
    AE> permanently in any packages so that we can get the
    AE> dataset without reloading,like creating dataset in a
    AE> permanent library in SAS .

    AE>    can we create our own packages in R. It would be very
    AE> helpful for us, if you provide any information regarding
    AE> this.

    AE> Thanks for your reply in advance -- View this message in
    AE> context:
    AE> http://www.nabble.com/How-to-create-a-permanent-dataset-in-R.-tp24639146p24673895.html
    AE> Sent from the R devel mailing list archive at
    AE> Nabble.com.

    AE> ______________________________________________
    AE> R-devel at r-project.org mailing list
    AE> https://stat.ethz.ch/mailman/listinfo/r-devel


From martin.becker at mx.uni-saarland.de  Mon Jul 27 12:41:42 2009
From: martin.becker at mx.uni-saarland.de (Martin Becker)
Date: Mon, 27 Jul 2009 12:41:42 +0200
Subject: [Rd] how to change FPU control word?
Message-ID: <4A6D8466.6000603@mx.uni-saarland.de>

Dear developers,

is there (already) a platform-independent way for (temporarily!) 
changing the fpu control word?
More precisely: I am looking for functions (accessible from C code in R 
packages) which read and write the fpu control word on x86 cpus (and 
cause no harm otherwise), because I need to (temporarily) turn off 
internal 80-bit precision for some algorithms relying on 64-bit IEEE 
arithmetics. Currently, I am using inline assembler (which works for x86 
cpus on Linux and Windows (MinGW)), but I am not sure what happens for 
other cpus/OSs (and I am not able to check this). I hope, there is 
already a better solution.
Any hints appreciated!

Thanks,
  Martin

-- 
Dr. Martin Becker
Statistics and Econometrics
Saarland University
Campus C3 1, Room 206
66123 Saarbruecken
Germany


From therneau at mayo.edu  Mon Jul 27 15:14:29 2009
From: therneau at mayo.edu (Terry Therneau)
Date: Mon, 27 Jul 2009 08:14:29 -0500 (CDT)
Subject: [Rd] noweb and R
Message-ID: <200907271314.n6RDETg01854@hsrnfs-101.mayo.edu>

 I'm working on the next release of coxme (ready to start some testing), and 
have written major chunks of it using noweb -- very similar to Sweave except I'm 
generating code and documentation for the code rather than vingetes.
 
 The question: I have directory with .Rnw objects and a Makefile therein that 
generates most of the .R files.  I don't see any guidance in the documentation 
on where this should preferably be placed in the package tree.  
 
 	Thanks for any pointers (or opinions)
 	
 	Terry T


From adamour at iq.harvard.edu  Mon Jul 27 15:31:35 2009
From: adamour at iq.harvard.edu (Alex D'Amour)
Date: Mon, 27 Jul 2009 09:31:35 -0400
Subject: [Rd] How to create a permanent dataset in R.
In-Reply-To: <24673895.post@talk.nabble.com>
References: <24639146.post@talk.nabble.com>
	<2ffd32cb0907241039h748b27e8h43d13243fda52105@mail.gmail.com>
	<24673895.post@talk.nabble.com>
Message-ID: <2ffd32cb0907270631vac02a02j39a697cab3a85cb6@mail.gmail.com>

Please see http://cran.r-project.org/doc/manuals/R-exts.html.

On Mon, Jul 27, 2009 at 1:50 AM, Albert EINstEIN<sateeshvarmap at gmail.com> wrote:
>
> Hi,
> ? ? ? ? Thanks for your valuable reply.
> can you provide me some more information regarding . Here we are reloading
> the data when we start the R, In R there are some default packages with
> datasets can we create a dataset permanently in any packages so that we can
> get the dataset without reloading,like creating dataset in a permanent
> library in SAS .
>
> ? can we create our own packages in R. It would be very helpful for us, if
> you provide any information regarding this.
>
> Thanks for your reply in advance
> --
> View this message in context: http://www.nabble.com/How-to-create-a-permanent-dataset-in-R.-tp24639146p24673895.html
> Sent from the R devel mailing list archive at Nabble.com.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From gregor.gorjanc at bfro.uni-lj.si  Mon Jul 27 19:00:23 2009
From: gregor.gorjanc at bfro.uni-lj.si (Gregor Gorjanc)
Date: Mon, 27 Jul 2009 17:00:23 +0000 (UTC)
Subject: [Rd] noweb and R
References: <200907271314.n6RDETg01854@hsrnfs-101.mayo.edu>
Message-ID: <loom.20090727T165933-906@post.gmane.org>

Terry

Take a look in R News - there was a paper published on that topic.

gg


From wdunlap at tibco.com  Mon Jul 27 19:13:59 2009
From: wdunlap at tibco.com (William Dunlap)
Date: Mon, 27 Jul 2009 10:13:59 -0700
Subject: [Rd] bug in approx crashes R
In-Reply-To: <22D850BC39A25742977325ADDE208E770271F720AD@chiexchange02.w2k.jumptrading.com>
References: <22D850BC39A25742977325ADDE208E770271F720AD@chiexchange02.w2k.jumptrading.com>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D700018AEA43@NA-PA-VBE03.na.tibco.com>

The C code called by approx (via .C, not .Call), following the help
file,
assumes that yleft and yright are scalars but NULL is not scalar.
The following change would let your example work (returning NA)

--- R/approx.R  (revision 48911)
+++ R/approx.R  (working copy)
@@ -61,8 +61,8 @@
     }
     y <- .C("R_approx", as.double(x), as.double(y), as.integer(nx),
            xout = as.double(xout), as.integer(length(xout)),
-           as.integer(method), as.double(yleft), as.double(yright),
-           as.double(f), NAOK = TRUE, PACKAGE = "stats")$xout
+           as.integer(method), as.double(yleft)[1],
as.double(yright)[1],
+           as.double(f)[1], NAOK = TRUE, PACKAGE = "stats")$xout
     list(x = xout, y = y)
 }

but I think it would be better to get an error message that yleft,
yright, and f are expected to be scalar:

--- R/approx.R  (revision 48911)
+++ R/approx.R  (working copy)
@@ -59,6 +59,7 @@
            stop("'approx' requires n >= 1")
        xout <- seq.int(x[1L], x[nx], length.out = n)
     }
+    stopifnot(length(yleft)==1, length(yright)==1, length(f)==1)
     y <- .C("R_approx", as.double(x), as.double(y), as.integer(nx),
            xout = as.double(xout), as.integer(length(xout)),
            as.integer(method), as.double(yleft), as.double(yright),


Bill Dunlap
TIBCO Software Inc - Spotfire Division
wdunlap tibco.com  

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Vadim Ogranovich
> Sent: Tuesday, July 21, 2009 12:24 PM
> To: 'r-devel at r-project.org'
> Subject: [Rd] bug in approx crashes R
> 
> Dear R-devel,
> 
> The following line crashes R
> > approx(1, 1, 0, method='const', rule=2, f=0, yleft=NULL, 
> ties='ordered')$y
> 
> Process R:2 exited abnormally with code 5 at Tue Jul 21 14:18:09 2009
> 
> 
> > version
>                _
> platform       i386-pc-mingw32
> arch           i386
> os             mingw32
> system         i386, mingw32
> status
> major          2
> minor          9.1
> year           2009
> month          06
> day            26
> svn rev        48839
> language       R
> version.string R version 2.9.1 (2009-06-26)
> 
> Thanks,
> Vadim
> 
> Note: This email is for the confidential use of the named 
> addressee(s) only and may contain proprietary, confidential 
> or privileged information. If you are not the intended 
> recipient, you are hereby notified that any review, 
> dissemination or copying of this email is strictly 
> prohibited, and to please notify the sender immediately and 
> destroy this email and any attachments.  Email transmission 
> cannot be guaranteed to be secure or error-free.  Jump 
> Trading, therefore, does not make any guarantees as to the 
> completeness or accuracy of this email or any attachments.  
> This email is for informational purposes only and does not 
> constitute a recommendation, offer, request or solicitation 
> of any kind to buy, sell, subscribe, redeem or perform any 
> type of transaction of a financial product.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From vogranovich at jumptrading.com  Mon Jul 27 19:47:47 2009
From: vogranovich at jumptrading.com (Vadim Ogranovich)
Date: Mon, 27 Jul 2009 12:47:47 -0500
Subject: [Rd] bug in approx crashes R
In-Reply-To: <77EB52C6DD32BA4D87471DCD70C8D700018AEA43@NA-PA-VBE03.na.tibco.com>
References: <22D850BC39A25742977325ADDE208E770271F720AD@chiexchange02.w2k.jumptrading.com>
	<77EB52C6DD32BA4D87471DCD70C8D700018AEA43@NA-PA-VBE03.na.tibco.com>
Message-ID: <22D850BC39A25742977325ADDE208E770271F720B4@chiexchange02.w2k.jumptrading.com>

Thank you Bill.

The original motivation for my experiments with setting yleft to NULL was to see if I could get more flexibility that that allowed by the 'rule' argument. To recall:

    rule: an integer describing how interpolation is to take place
          outside the interval ['min(x)', 'max(x)']. If 'rule' is '1'
          then 'NA's are returned for such points and if it is '2', the
          value at the closest data extreme is used.

What I wanted is to interpolate at the left end, but not at the right end. Still don't know how to do that.

I agree that having a clear error message when yleft, yright, and f are set to non-scalars is better than silently returning NA.

Thanks,
Vadim


-----Original Message-----
From: William Dunlap [mailto:wdunlap at tibco.com]
Sent: Monday, July 27, 2009 12:14 PM
To: Vadim Ogranovich; r-devel at r-project.org
Subject: RE: [Rd] bug in approx crashes R

The C code called by approx (via .C, not .Call), following the help
file,
assumes that yleft and yright are scalars but NULL is not scalar.
The following change would let your example work (returning NA)

--- R/approx.R  (revision 48911)
+++ R/approx.R  (working copy)
@@ -61,8 +61,8 @@
     }
     y <- .C("R_approx", as.double(x), as.double(y), as.integer(nx),
            xout = as.double(xout), as.integer(length(xout)),
-           as.integer(method), as.double(yleft), as.double(yright),
-           as.double(f), NAOK = TRUE, PACKAGE = "stats")$xout
+           as.integer(method), as.double(yleft)[1],
as.double(yright)[1],
+           as.double(f)[1], NAOK = TRUE, PACKAGE = "stats")$xout
     list(x = xout, y = y)
 }

but I think it would be better to get an error message that yleft,
yright, and f are expected to be scalar:

--- R/approx.R  (revision 48911)
+++ R/approx.R  (working copy)
@@ -59,6 +59,7 @@
            stop("'approx' requires n >= 1")
        xout <- seq.int(x[1L], x[nx], length.out = n)
     }
+    stopifnot(length(yleft)==1, length(yright)==1, length(f)==1)
     y <- .C("R_approx", as.double(x), as.double(y), as.integer(nx),
            xout = as.double(xout), as.integer(length(xout)),
            as.integer(method), as.double(yleft), as.double(yright),


Bill Dunlap
TIBCO Software Inc - Spotfire Division
wdunlap tibco.com

> -----Original Message-----
> From: r-devel-bounces at r-project.org
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Vadim Ogranovich
> Sent: Tuesday, July 21, 2009 12:24 PM
> To: 'r-devel at r-project.org'
> Subject: [Rd] bug in approx crashes R
>
> Dear R-devel,
>
> The following line crashes R
> > approx(1, 1, 0, method='const', rule=2, f=0, yleft=NULL,
> ties='ordered')$y
>
> Process R:2 exited abnormally with code 5 at Tue Jul 21 14:18:09 2009
>
>
> > version
>                _
> platform       i386-pc-mingw32
> arch           i386
> os             mingw32
> system         i386, mingw32
> status
> major          2
> minor          9.1
> year           2009
> month          06
> day            26
> svn rev        48839
> language       R
> version.string R version 2.9.1 (2009-06-26)
>
> Thanks,
> Vadim
>
> Note: This email is for the confidential use of the named
> addressee(s) only and may contain proprietary, confidential
> or privileged information. If you are not the intended
> recipient, you are hereby notified that any review,
> dissemination or copying of this email is strictly
> prohibited, and to please notify the sender immediately and
> destroy this email and any attachments.  Email transmission
> cannot be guaranteed to be secure or error-free.  Jump
> Trading, therefore, does not make any guarantees as to the
> completeness or accuracy of this email or any attachments.
> This email is for informational purposes only and does not
> constitute a recommendation, offer, request or solicitation
> of any kind to buy, sell, subscribe, redeem or perform any
> type of transaction of a financial product.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

Note: This email is for the confidential use of the named addressee(s) only and may contain proprietary, confidential or privileged information. If you are not the intended recipient, you are hereby notified that any review, dissemination or copying of this email is strictly prohibited, and to please notify the sender immediately and destroy this email and any attachments.  Email transmission cannot be guaranteed to be secure or error-free.  Jump Trading, therefore, does not make any guarantees as to the completeness or accuracy of this email or any attachments.  This email is for informational purposes only and does not constitute a recommendation, offer, request or solicitation of any kind to buy, sell, subscribe, redeem or perform any type of transaction of a financial product.


From rgentlem at fhcrc.org  Tue Jul 28 01:55:50 2009
From: rgentlem at fhcrc.org (Robert Gentleman)
Date: Mon, 27 Jul 2009 16:55:50 -0700
Subject: [Rd] debug
Message-ID: <4A6E3E86.4000005@fhcrc.org>

Hi,
   I just committed a change to R-devel so that if debug is called on an 
S3 generic function, all methods will also automatically have debug 
turned on for them (if they are dispatched to from the generic).

   I hope to be able to extend this to S4 and a few other cases that are 
currently not being handled over the the next few weeks.

   Please let me know if you have problems, or suggested improvements.

  Robert
-- 
Robert Gentleman, PhD
Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
PO Box 19024
Seattle, Washington 98109-1024
206-667-7700
rgentlem at fhcrc.org


From tal.galili at gmail.com  Mon Jul 27 15:15:11 2009
From: tal.galili at gmail.com (tal.galili at gmail.com)
Date: Mon, 27 Jul 2009 15:15:11 +0200 (CEST)
Subject: [Rd] save.image fails when the directory structure has Hebrew in
	it. (PR#13855)
Message-ID: <20090727131511.BDD56282EFC6@mail.pubhealth.ku.dk>

Hello to who ever reads this.

I use R 2.8.0 on win XP

I noticed for some time now that every time I use the menu commands:
file -> save work space
If I am saving to a directory that has Hebrew in one of the folder names on
the tree, the save.image will give the following error massage:

> save.image("C:\\Documents and Settings\\Tal G\\My
Documents\\=F2=E1=E5=E3=E4\\statistics\\=E6=E4=F8\\=EE=E9=F8=E9 =E5=E6=E4=
=F8\\code\\=F0=E9=F1=E5=E9
=E4=EB=E3=E5=F8\\27.7.09.RData")
*Error in save.image*("C:\\Documents and Settings\\Tal G\\My
Documents\\=F2=E1=E5=E3=E4\\statistics\\=E6=E4=F8\\=EE=E9=F8=E9 =E5=E6=E4=
=F8\\code\\=F0=E9=F1=E5=E9
=E4=EB=E3=E5=F8\\27.7.09.RData") :
 * image could not be renamed and is left in* C:\Documents and Settings\Tal
G\My Documents\=F2=E1=E5=E3=E4\statistics\=E6=E4=F8\=EE=E9=F8=E9 =E5=E6=E4=
=F8\code\=F0=E9=F1=E5=E9
=E4=EB=E3=E5=F8\27.7.09.RDataTmp

Hope to see it resolved.


Thanks,
Tal





--=20
----------------------------------------------


My contact information:
Tal Galili
Phone number: 972-50-3373767
FaceBook: Tal Galili
My Blogs:
http://www.r-statistics.com/
http://www.talgalili.com
http://www.biostatistics.co.il

	[[alternative HTML version deleted]]


From maechler at stat.math.ethz.ch  Tue Jul 28 11:59:36 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 28 Jul 2009 11:59:36 +0200
Subject: [Rd] bug in approx crashes R
In-Reply-To: <22D850BC39A25742977325ADDE208E770271F720B4@chiexchange02.w2k.jumptrading.com>
References: <22D850BC39A25742977325ADDE208E770271F720AD@chiexchange02.w2k.jumptrading.com>
	<77EB52C6DD32BA4D87471DCD70C8D700018AEA43@NA-PA-VBE03.na.tibco.com>
	<22D850BC39A25742977325ADDE208E770271F720B4@chiexchange02.w2k.jumptrading.com>
Message-ID: <19054.52232.465181.458748@lynne.math.ethz.ch>

>>>>> Vadim Ogranovich <vogranovich at jumptrading.com>
>>>>>     on Mon, 27 Jul 2009 12:47:47 -0500 writes:

    > Thank you Bill.

Indeed, thank you, Bill Dunlap!

    > The original motivation for my
    > experiments with setting yleft to NULL was to see if I
    > could get more flexibility that that allowed by the
    > 'rule' argument. To recall:

    >     rule: an integer describing how interpolation is to
    > take place outside the interval ['min(x)', 'max(x)']. If
    > 'rule' is '1' then 'NA's are returned for such points
    > and if it is '2', the value at the closest data extreme
    > is used.

    > What I wanted is to interpolate at the left end, but not
    > at the right end. Still don't know how to do that.

Really?
If you quickly browse the code, you see that's it's simply a
matter of correctly setting  yleft  and  yright.

But in order to help future users, and since it's so trivial,
I will change approxfun() {my favorite} and approx() to also
accept
	rule = c(1,2)
or	rule = c(2,1)


    > I agree that having a clear error message when yleft,
    > yright, and f are set to non-scalars is better than
    > silently returning NA.

yes, I agree too.

---
Martin Maechler, ETH Zurich


    > Thanks,
    > Vadim


    > -----Original Message-----
    > From: William Dunlap [mailto:wdunlap at tibco.com]
    > Sent: Monday, July 27, 2009 12:14 PM
    > To: Vadim Ogranovich; r-devel at r-project.org
    > Subject: RE: [Rd] bug in approx crashes R

    > The C code called by approx (via .C, not .Call), following the help
    > file,
    > assumes that yleft and yright are scalars but NULL is not scalar.
    > The following change would let your example work (returning NA)

    > --- R/approx.R  (revision 48911)
    > +++ R/approx.R  (working copy)
    > @@ -61,8 +61,8 @@
    > }
    > y <- .C("R_approx", as.double(x), as.double(y), as.integer(nx),
    > xout = as.double(xout), as.integer(length(xout)),
    > -           as.integer(method), as.double(yleft), as.double(yright),
    > -           as.double(f), NAOK = TRUE, PACKAGE = "stats")$xout
    > +           as.integer(method), as.double(yleft)[1],
    > as.double(yright)[1],
    > +           as.double(f)[1], NAOK = TRUE, PACKAGE = "stats")$xout
    > list(x = xout, y = y)
    > }

    > but I think it would be better to get an error message that yleft,
    > yright, and f are expected to be scalar:

    > --- R/approx.R  (revision 48911)
    > +++ R/approx.R  (working copy)
    > @@ -59,6 +59,7 @@
    > stop("'approx' requires n >= 1")
    > xout <- seq.int(x[1L], x[nx], length.out = n)
    > }
    > +    stopifnot(length(yleft)==1, length(yright)==1, length(f)==1)
    > y <- .C("R_approx", as.double(x), as.double(y), as.integer(nx),
    > xout = as.double(xout), as.integer(length(xout)),
    > as.integer(method), as.double(yleft), as.double(yright),


    > Bill Dunlap
    > TIBCO Software Inc - Spotfire Division
    > wdunlap tibco.com

    >> -----Original Message-----
    >> From: r-devel-bounces at r-project.org
    >> [mailto:r-devel-bounces at r-project.org] On Behalf Of Vadim Ogranovich
    >> Sent: Tuesday, July 21, 2009 12:24 PM
    >> To: 'r-devel at r-project.org'
    >> Subject: [Rd] bug in approx crashes R
    >> 
    >> Dear R-devel,
    >> 
    >> The following line crashes R
    >> > approx(1, 1, 0, method='const', rule=2, f=0, yleft=NULL,
    >> ties='ordered')$y
    >> 
    >> Process R:2 exited abnormally with code 5 at Tue Jul 21 14:18:09 2009
    >> 
    >> 
    >> > version
    >> _
    >> platform       i386-pc-mingw32
    >> arch           i386
    >> os             mingw32
    >> system         i386, mingw32
    >> status
    >> major          2
    >> minor          9.1
    >> year           2009
    >> month          06
    >> day            26
    >> svn rev        48839
    >> language       R
    >> version.string R version 2.9.1 (2009-06-26)
    >> 
    >> Thanks,
    >> Vadim
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >>


From atp at piskorski.com  Tue Jul 28 12:22:53 2009
From: atp at piskorski.com (Andrew Piskorski)
Date: Tue, 28 Jul 2009 06:22:53 -0400
Subject: [Rd] how to change FPU control word?
In-Reply-To: <4A6D8466.6000603@mx.uni-saarland.de>
References: <4A6D8466.6000603@mx.uni-saarland.de>
Message-ID: <20090728102253.GA22435@piskorski.com>

On Mon, Jul 27, 2009 at 12:41:42PM +0200, Martin Becker wrote:

> is there (already) a platform-independent way for (temporarily!) 
> changing the fpu control word?

> Currently, I am using inline assembler (which works for x86 cpus on
> Linux and Windows (MinGW))

Platform-indepdendent?  I don't know about that.  But on Linux, mostly
x86-64, we use these from C:

  _FPU_GETCW()
  _FPU_SETCW()

-- 
Andrew Piskorski <atp at piskorski.com>
http://www.piskorski.com/


From gb at stat.umu.se  Tue Jul 28 13:03:39 2009
From: gb at stat.umu.se (=?ISO-8859-1?Q?G=F6ran_Brostr=F6m?=)
Date: Tue, 28 Jul 2009 13:03:39 +0200
Subject: [Rd] Sys.setlocale
Message-ID: <4A6EDB0B.4070907@stat.umu.se>

When checking an R package of mine, I get

* checking R files for syntax errors ... WARNING
Warning in Sys.setlocale("LC_CTYPE", "en_US") :
   OS reports request to set locale to "en_US" cannot be honored

'Sys.setlocale' is not used in any of my R functions. What should I do 
to fix the Warning? I have never seen this before.

My locale is "sv_SE", on ubuntu 9.04

 > sessionInfo()
R version 2.9.1 Patched (2009-07-27 r49006)
x86_64-unknown-linux-gnu

locale:
LC_CTYPE=sv_SE;LC_NUMERIC=C;LC_TIME=sv_SE;LC_COLLATE=sv_SE;LC_MONETARY=C;LC_MESSAGES=sv_SE;LC_PAPER=sv_SE;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=sv_SE;LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

G?ran
-- 
G?ran Brostr?m               phone: 46 90 786 5223; 46 705 197 507
Department of Statistics     fax: 46 90 786 6614
Ume? University              email: gb at stat.umu.se
SE-90187 Ume?, Sweden        http://tal.stat.umu.se/~gb


From p.dalgaard at biostat.ku.dk  Tue Jul 28 15:02:00 2009
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Tue, 28 Jul 2009 15:02:00 +0200
Subject: [Rd] Sys.setlocale
In-Reply-To: <4A6EDB0B.4070907@stat.umu.se>
References: <4A6EDB0B.4070907@stat.umu.se>
Message-ID: <4A6EF6C8.30307@biostat.ku.dk>

G?ran Brostr?m wrote:
> When checking an R package of mine, I get
> 
> * checking R files for syntax errors ... WARNING
> Warning in Sys.setlocale("LC_CTYPE", "en_US") :
>   OS reports request to set locale to "en_US" cannot be honored
> 
> 'Sys.setlocale' is not used in any of my R functions. What should I do 
> to fix the Warning? I have never seen this before.
> 
> My locale is "sv_SE", on ubuntu 9.04
> 
>  > sessionInfo()
> R version 2.9.1 Patched (2009-07-27 r49006)
> x86_64-unknown-linux-gnu
> 
> locale:
> LC_CTYPE=sv_SE;LC_NUMERIC=C;LC_TIME=sv_SE;LC_COLLATE=sv_SE;LC_MONETARY=C;LC_MESSAGES=sv_SE;LC_PAPER=sv_SE;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=sv_SE;LC_IDENTIFICATION=C 
> 
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> G?ran

The logic is in src/library/tools/R/QC.R (.check_package_code_syntax). 
If I read correctly, the underlying reason could be that you have 
"Encoding: latin1" in DESCRIPTION.

For a workaround, you could play with the R_ENCODING_LOCALES environment 
variable (documented in R-exts), but I suspect it is easier just to 
install en_US.


-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From gb at stat.umu.se  Tue Jul 28 16:59:59 2009
From: gb at stat.umu.se (=?ISO-8859-1?Q?G=F6ran_Brostr=F6m?=)
Date: Tue, 28 Jul 2009 16:59:59 +0200
Subject: [Rd] Sys.setlocale
In-Reply-To: <4A6EF6C8.30307@biostat.ku.dk>
References: <4A6EDB0B.4070907@stat.umu.se> <4A6EF6C8.30307@biostat.ku.dk>
Message-ID: <4A6F126F.8070206@stat.umu.se>

Peter Dalgaard wrote:
> G?ran Brostr?m wrote:
>> When checking an R package of mine, I get
>>
>> * checking R files for syntax errors ... WARNING
>> Warning in Sys.setlocale("LC_CTYPE", "en_US") :
>>   OS reports request to set locale to "en_US" cannot be honored
>>
>> 'Sys.setlocale' is not used in any of my R functions. What should I do 
>> to fix the Warning? I have never seen this before.
>>
>> My locale is "sv_SE", on ubuntu 9.04
>>
>>  > sessionInfo()
>> R version 2.9.1 Patched (2009-07-27 r49006)
>> x86_64-unknown-linux-gnu
>>
>> locale:
>> LC_CTYPE=sv_SE;LC_NUMERIC=C;LC_TIME=sv_SE;LC_COLLATE=sv_SE;LC_MONETARY=C;LC_MESSAGES=sv_SE;LC_PAPER=sv_SE;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=sv_SE;LC_IDENTIFICATION=C 
>>
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> G?ran
> 
> The logic is in src/library/tools/R/QC.R (.check_package_code_syntax). 
> If I read correctly, the underlying reason could be that you have 
> "Encoding: latin1" in DESCRIPTION.
> 
> For a workaround, you could play with the R_ENCODING_LOCALES environment 
> variable (documented in R-exts), but I suspect it is easier just to 
> install en_US.

Thanks, I installed en_US and the Warning went away.

G?ran


From vogranovich at jumptrading.com  Tue Jul 28 17:02:15 2009
From: vogranovich at jumptrading.com (Vadim Ogranovich)
Date: Tue, 28 Jul 2009 10:02:15 -0500
Subject: [Rd] bug in approx crashes R
In-Reply-To: <19054.52232.465181.458748@lynne.math.ethz.ch>
References: <22D850BC39A25742977325ADDE208E770271F720AD@chiexchange02.w2k.jumptrading.com>
	<77EB52C6DD32BA4D87471DCD70C8D700018AEA43@NA-PA-VBE03.na.tibco.com>
	<22D850BC39A25742977325ADDE208E770271F720B4@chiexchange02.w2k.jumptrading.com>
	<19054.52232.465181.458748@lynne.math.ethz.ch>
Message-ID: <22D850BC39A25742977325ADDE208E770271F720B7@chiexchange02.w2k.jumptrading.com>

Thank you Martin! The new 'rule'-s is exactly what I wanted. It's intuitive and consistent with the scalar use.

Thanks,
Vadim

-----Original Message-----
From: Martin Maechler [mailto:maechler at stat.math.ethz.ch]
Sent: Tuesday, July 28, 2009 5:00 AM
To: Vadim Ogranovich
Cc: 'William Dunlap'; r-devel at r-project.org
Subject: Re: [Rd] bug in approx crashes R

>>>>> Vadim Ogranovich <vogranovich at jumptrading.com>
>>>>>     on Mon, 27 Jul 2009 12:47:47 -0500 writes:

    > Thank you Bill.

Indeed, thank you, Bill Dunlap!

    > The original motivation for my
    > experiments with setting yleft to NULL was to see if I
    > could get more flexibility that that allowed by the
    > 'rule' argument. To recall:

    >     rule: an integer describing how interpolation is to
    > take place outside the interval ['min(x)', 'max(x)']. If
    > 'rule' is '1' then 'NA's are returned for such points
    > and if it is '2', the value at the closest data extreme
    > is used.

    > What I wanted is to interpolate at the left end, but not
    > at the right end. Still don't know how to do that.

Really?
If you quickly browse the code, you see that's it's simply a
matter of correctly setting  yleft  and  yright.

But in order to help future users, and since it's so trivial,
I will change approxfun() {my favorite} and approx() to also
accept
        rule = c(1,2)
or      rule = c(2,1)


    > I agree that having a clear error message when yleft,
    > yright, and f are set to non-scalars is better than
    > silently returning NA.

yes, I agree too.

---
Martin Maechler, ETH Zurich


    > Thanks,
    > Vadim


    > -----Original Message-----
    > From: William Dunlap [mailto:wdunlap at tibco.com]
    > Sent: Monday, July 27, 2009 12:14 PM
    > To: Vadim Ogranovich; r-devel at r-project.org
    > Subject: RE: [Rd] bug in approx crashes R

    > The C code called by approx (via .C, not .Call), following the help
    > file,
    > assumes that yleft and yright are scalars but NULL is not scalar.
    > The following change would let your example work (returning NA)

    > --- R/approx.R  (revision 48911)
    > +++ R/approx.R  (working copy)
    > @@ -61,8 +61,8 @@
    > }
    > y <- .C("R_approx", as.double(x), as.double(y), as.integer(nx),
    > xout = as.double(xout), as.integer(length(xout)),
    > -           as.integer(method), as.double(yleft), as.double(yright),
    > -           as.double(f), NAOK = TRUE, PACKAGE = "stats")$xout
    > +           as.integer(method), as.double(yleft)[1],
    > as.double(yright)[1],
    > +           as.double(f)[1], NAOK = TRUE, PACKAGE = "stats")$xout
    > list(x = xout, y = y)
    > }

    > but I think it would be better to get an error message that yleft,
    > yright, and f are expected to be scalar:

    > --- R/approx.R  (revision 48911)
    > +++ R/approx.R  (working copy)
    > @@ -59,6 +59,7 @@
    > stop("'approx' requires n >= 1")
    > xout <- seq.int(x[1L], x[nx], length.out = n)
    > }
    > +    stopifnot(length(yleft)==1, length(yright)==1, length(f)==1)
    > y <- .C("R_approx", as.double(x), as.double(y), as.integer(nx),
    > xout = as.double(xout), as.integer(length(xout)),
    > as.integer(method), as.double(yleft), as.double(yright),


    > Bill Dunlap
    > TIBCO Software Inc - Spotfire Division
    > wdunlap tibco.com

    >> -----Original Message-----
    >> From: r-devel-bounces at r-project.org
    >> [mailto:r-devel-bounces at r-project.org] On Behalf Of Vadim Ogranovich
    >> Sent: Tuesday, July 21, 2009 12:24 PM
    >> To: 'r-devel at r-project.org'
    >> Subject: [Rd] bug in approx crashes R
    >>
    >> Dear R-devel,
    >>
    >> The following line crashes R
    >> > approx(1, 1, 0, method='const', rule=2, f=0, yleft=NULL,
    >> ties='ordered')$y
    >>
    >> Process R:2 exited abnormally with code 5 at Tue Jul 21 14:18:09 2009
    >>
    >>
    >> > version
    >> _
    >> platform       i386-pc-mingw32
    >> arch           i386
    >> os             mingw32
    >> system         i386, mingw32
    >> status
    >> major          2
    >> minor          9.1
    >> year           2009
    >> month          06
    >> day            26
    >> svn rev        48839
    >> language       R
    >> version.string R version 2.9.1 (2009-06-26)
    >>
    >> Thanks,
    >> Vadim
    >>
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >>

Note: This email is for the confidential use of the named addressee(s) only and may contain proprietary, confidential or privileged information. If you are not the intended recipient, you are hereby notified that any review, dissemination or copying of this email is strictly prohibited, and to please notify the sender immediately and destroy this email and any attachments.  Email transmission cannot be guaranteed to be secure or error-free.  Jump Trading, therefore, does not make any guarantees as to the completeness or accuracy of this email or any attachments.  This email is for informational purposes only and does not constitute a recommendation, offer, request or solicitation of any kind to buy, sell, subscribe, redeem or perform any type of transaction of a financial product.


From Klaus.Nordhausen at uta.fi  Tue Jul 28 18:58:44 2009
From: Klaus.Nordhausen at uta.fi (Klaus Nordhausen)
Date: Tue, 28 Jul 2009 19:58:44 +0300
Subject: [Rd] How to use formulas for multivariate clustered data?
Message-ID: <20090728195844.60574ascdn9hdb28@imp2.uta.fi>

Dear R experts,

I wrote already a couple of weeks ago but did not get any reply.  
Therefore I'll rephrase my question and hope some of you can give me  
some answers or some advice where better to look for an answer.

In general I'm looking for information on how to program functions  
using formulas in order to write a nonparametric multivariate  
regression function with possible clustering of the data.

I would assume that the formulas for my function would have the form
y1 + y2 + y3 ~ x | z
or
Y ~ x | z,

where y1, y2 and y3 are continuous response variables, or Y the matrix  
of responses and x an explaining variable and z a factor indicating  
the cluster membership.

I'm looking for general information about writing functions using  
formulas. But more concrete I would need to know what would be the  
best way to make sure that the response should be multivariate and  
numeric? What is the best way to define the hierarchical structure, is  
it the "|" or is there another, better way? How can I restrict the  
number of hierarchical levels?
And how to use in this context, the data, subset, weights and na.action
arguments?

Thanks in advance,

Klaus

-- 
Klaus Nordhausen
Researcher
Tampere School of Public Health
FIN-33014 University of Tampere

phone:	+358 3 3551 4153
fax:	+358 3 3551 4150
e-mail:	Klaus.Nordhausen at uta.fi


From ggrothendieck at gmail.com  Tue Jul 28 19:16:14 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 28 Jul 2009 13:16:14 -0400
Subject: [Rd] How to use formulas for multivariate clustered data?
In-Reply-To: <20090728195844.60574ascdn9hdb28@imp2.uta.fi>
References: <20090728195844.60574ascdn9hdb28@imp2.uta.fi>
Message-ID: <971536df0907281016x3ad25f29v9a8606de161da14f@mail.gmail.com>

Have a look at the source code for the Formula package.

On Tue, Jul 28, 2009 at 12:58 PM, Klaus
Nordhausen<Klaus.Nordhausen at uta.fi> wrote:
> Dear R experts,
>
> I wrote already a couple of weeks ago but did not get any reply. Therefore
> I'll rephrase my question and hope some of you can give me some answers or
> some advice where better to look for an answer.
>
> In general I'm looking for information on how to program functions using
> formulas in order to write a nonparametric multivariate regression function
> with possible clustering of the data.
>
> I would assume that the formulas for my function would have the form
> y1 + y2 + y3 ~ x | z
> or
> Y ~ x | z,
>
> where y1, y2 and y3 are continuous response variables, or Y the matrix of
> responses and x an explaining variable and z a factor indicating the cluster
> membership.
>
> I'm looking for general information about writing functions using formulas.
> But more concrete I would need to know what would be the best way to make
> sure that the response should be multivariate and numeric? What is the best
> way to define the hierarchical structure, is it the "|" or is there another,
> better way? How can I restrict the number of hierarchical levels?
> And how to use in this context, the data, subset, weights and na.action
> arguments?
>
> Thanks in advance,
>
> Klaus
>
> --
> Klaus Nordhausen
> Researcher
> Tampere School of Public Health
> FIN-33014 University of Tampere
>
> phone: ?+358 3 3551 4153
> fax: ? ?+358 3 3551 4150
> e-mail: Klaus.Nordhausen at uta.fi
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From info at aghmed.fsnet.co.uk  Tue Jul 28 19:21:01 2009
From: info at aghmed.fsnet.co.uk (Michael Dewey)
Date: Tue, 28 Jul 2009 18:21:01 +0100
Subject: [Rd] Advice sought about Rd versions
Message-ID: <Zen-1MVqMR-0000Yo-9s@smarthost01.mail.zen.net.uk>

 From R 2.9.0 we have the concept of versions for Rd files. The 
manual is clear about the differences but I am unsure as to what I 
should do about my existing packages. Is it recommended that I set 
the version to 1.1 and then fix the errors R CMD check helpfully 
points out and then subsequently do the same for later versions (the 
manual mentions version 2 is coming)? What benefit will I gain?


Michael Dewey
http://www.aghmed.fsnet.co.uk


From Achim.Zeileis at wu-wien.ac.at  Tue Jul 28 19:23:44 2009
From: Achim.Zeileis at wu-wien.ac.at (Achim Zeileis)
Date: Tue, 28 Jul 2009 19:23:44 +0200 (CEST)
Subject: [Rd] How to use formulas for multivariate clustered data?
In-Reply-To: <20090728195844.60574ascdn9hdb28@imp2.uta.fi>
References: <20090728195844.60574ascdn9hdb28@imp2.uta.fi>
Message-ID: <Pine.LNX.4.64.0907281918110.25026@paninaro.stat-math.wu-wien.ac.at>

Klaus:

> I wrote already a couple of weeks ago but did not get any reply. Therefore 
> I'll rephrase my question and hope some of you can give me some answers or 
> some advice where better to look for an answer.
>
> In general I'm looking for information on how to program functions using 
> formulas in order to write a nonparametric multivariate regression function 
> with possible clustering of the data.
>
> I would assume that the formulas for my function would have the form
> y1 + y2 + y3 ~ x | z
> or
> Y ~ x | z,
>
> where y1, y2 and y3 are continuous response variables, or Y the matrix of 
> responses and x an explaining variable and z a factor indicating the cluster 
> membership.
>
> I'm looking for general information about writing functions using formulas. 
> But more concrete I would need to know what would be the best way to make 
> sure that the response should be multivariate and numeric? What is the best 
> way to define the hierarchical structure, is it the "|" or is there another, 
> better way? How can I restrict the number of hierarchical levels?
> And how to use in this context, the data, subset, weights and na.action
> arguments?

The CRAN package "Formula" has some functionality which might assist you 
in what you want to do. It provides several tools for extracting 
information from formulas like
   Y ~ x1 + x2 | z

The version on R-Forge also has some tools for
   y1 + y2 + y3 ~ x1 + x2 | z1 | z2 + z3
etc. But the version on R-Forge is not yet quite stable, however, we hope 
to get something new to CRAN over the summer.

The package just assists you with accessing the different parts of the 
formula. All the checking of types, dimensions, etc. you have to do 
yourself. I hope it solves some of your problems, though...

hth,
Z

> Thanks in advance,
>
> Klaus
>
> -- 
> Klaus Nordhausen
> Researcher
> Tampere School of Public Health
> FIN-33014 University of Tampere
>
> phone:	+358 3 3551 4153
> fax:	+358 3 3551 4150
> e-mail:	Klaus.Nordhausen at uta.fi
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From pgilbert at bank-banque-canada.ca  Tue Jul 28 21:21:35 2009
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Tue, 28 Jul 2009 15:21:35 -0400
Subject: [Rd] noweb and R
In-Reply-To: <200907271314.n6RDETg01854@hsrnfs-101.mayo.edu>
References: <200907271314.n6RDETg01854@hsrnfs-101.mayo.edu>
Message-ID: <4A6F4FBF.4010105@bank-banque-canada.ca>

Terry

I didn't see any response to this and I am a bit curious about the 
answer.  If I understand correctly, you are suggesting you would like 
some directory, say Rman/, that gets pre-processed to produce the R/ and 
man/ directories.  Are you thinking that it should be part of the 
package tree? When you have Rman/, would you also include the R/ and 
man/ directories or expect those to get generated by build or install?

I'm doing something simplistic but superficially similar by having all 
my Rd files for a package in one file and pre-processing that to 
generate man/, but I do this prior to rolling up the package, and then 
do not include the original.

Paul

Terry Therneau wrote:
>  I'm working on the next release of coxme (ready to start some testing), and 
> have written major chunks of it using noweb -- very similar to Sweave except I'm 
> generating code and documentation for the code rather than vingetes.
>  
>  The question: I have directory with .Rnw objects and a Makefile therein that 
> generates most of the .R files.  I don't see any guidance in the documentation 
> on where this should preferably be placed in the package tree.  
>  
>  	Thanks for any pointers (or opinions)
>  	
>  	Terry T
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential information, and the Bank of
Canada does not waive any related rights. Any distribution, use, or copying of this
email or the information it contains by other than the intended recipient is
unauthorized. If you received this email in error please delete it immediately from
your system and notify the sender promptly by email that you have done so. 

------------------------------------------------------------------------------------

Le pr?sent courriel peut contenir de l'information privil?gi?e ou confidentielle.
La Banque du Canada ne renonce pas aux droits qui s'y rapportent. Toute diffusion,
utilisation ou copie de ce courriel ou des renseignements qu'il contient par une
personne autre que le ou les destinataires d?sign?s est interdite. Si vous recevez
ce courriel par erreur, veuillez le supprimer imm?diatement et envoyer sans d?lai ?
l'exp?diteur un message ?lectronique pour l'aviser que vous avez ?limin? de votre
ordinateur toute copie du courriel re?u.

From cgb at datanalytics.com  Tue Jul 28 22:31:11 2009
From: cgb at datanalytics.com (Carlos J. Gil Bellosta)
Date: Tue, 28 Jul 2009 22:31:11 +0200
Subject: [Rd] Checking package on Windows (and seemingly irreproducible
 errors in CRAN checks)
Message-ID: <1248813071.4657.18.camel@kropotkin>

Hello,

I submitted a small package, colbycol, to CRAN. I developed it on Linux
and tested it on my Linux box and another Windows machine. Besides,
other people kindly tested it in their systems. 

The package seems to "compile" correctly in r-forge for Windows. In
fact, you can find the binary package at

http://r-forge.r-project.org/R/?group_id=426.

However, in CRAN, the Windows package cannot be built according to

http://cran.r-project.org/web/checks/check_results_colbycol.html

I cannot reproduce the error. I can guess very little more about what
could have gone wrong. The error seems to happen at a time when R tries
to read a temporary file (in a temporary folder) that has just been
created in a call to a non-R piece of code that does not catch its IO
exceptions, if any. 

Any ideas? Suggestions?

Best regards,

Carlos J. Gil Bellosta
http://www.datanalytics.com


From ggrothendieck at gmail.com  Tue Jul 28 22:53:58 2009
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 28 Jul 2009 16:53:58 -0400
Subject: [Rd] Checking package on Windows (and seemingly irreproducible
	errors in CRAN checks)
In-Reply-To: <1248813071.4657.18.camel@kropotkin>
References: <1248813071.4657.18.camel@kropotkin>
Message-ID: <971536df0907281353v66425bf5y43447ba1796d72da@mail.gmail.com>

That's a check error.  Did you try running R CMD CHECK on it?

Since it appears to happen in an example you could put
\dontrun{
...
}

around the example although it would be better to get it to the
state that it passes R CMD CHECK without having to do that.

On Tue, Jul 28, 2009 at 4:31 PM, Carlos J. Gil
Bellosta<cgb at datanalytics.com> wrote:
> Hello,
>
> I submitted a small package, colbycol, to CRAN. I developed it on Linux
> and tested it on my Linux box and another Windows machine. Besides,
> other people kindly tested it in their systems.
>
> The package seems to "compile" correctly in r-forge for Windows. In
> fact, you can find the binary package at
>
> http://r-forge.r-project.org/R/?group_id=426.
>
> However, in CRAN, the Windows package cannot be built according to
>
> http://cran.r-project.org/web/checks/check_results_colbycol.html
>
> I cannot reproduce the error. I can guess very little more about what
> could have gone wrong. The error seems to happen at a time when R tries
> to read a temporary file (in a temporary folder) that has just been
> created in a call to a non-R piece of code that does not catch its IO
> exceptions, if any.
>
> Any ideas? Suggestions?
>
> Best regards,
>
> Carlos J. Gil Bellosta
> http://www.datanalytics.com
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From mathieu.ribatet at epfl.ch  Tue Jul 28 23:14:29 2009
From: mathieu.ribatet at epfl.ch (Mathieu Ribatet)
Date: Tue, 28 Jul 2009 23:14:29 +0200
Subject: [Rd] Checking package on Windows (and seemingly irreproducible
 errors in CRAN checks)
In-Reply-To: <1248813071.4657.18.camel@kropotkin>
References: <1248813071.4657.18.camel@kropotkin>
Message-ID: <1248815669.30084.15.camel@ubuntu>

Dear Carlos,

>From your check results:

        cbc.data <- cbc.read.table( system.file("data",
        "cbc.test.data.txt", package = "colbycol"), sep = "\t" )
                Warning in file(file, "r") :
                cannot open file '0001': No such file or directory
        
I think you're trying to read the file "cbc.test.data.txt" located in
the folder "data" of your package skeleton. Is that right? If so, maybe
using

        paste(system.file(package = "colbycol"),
        "data/cbc.test.data.txt", sep="/")
        
will solve your issue - although I didn't try.

Best,
Mathieu

Le mardi 28 juillet 2009 ? 22:31 +0200, Carlos J. Gil Bellosta a ?crit :
> Hello,
> 
> I submitted a small package, colbycol, to CRAN. I developed it on Linux
> and tested it on my Linux box and another Windows machine. Besides,
> other people kindly tested it in their systems. 
> 
> The package seems to "compile" correctly in r-forge for Windows. In
> fact, you can find the binary package at
> 
> http://r-forge.r-project.org/R/?group_id=426.
> 
> However, in CRAN, the Windows package cannot be built according to
> 
> http://cran.r-project.org/web/checks/check_results_colbycol.html
> 
> I cannot reproduce the error. I can guess very little more about what
> could have gone wrong. The error seems to happen at a time when R tries
> to read a temporary file (in a temporary folder) that has just been
> created in a call to a non-R piece of code that does not catch its IO
> exceptions, if any. 
> 
> Any ideas? Suggestions?
> 
> Best regards,
> 
> Carlos J. Gil Bellosta
> http://www.datanalytics.com
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
-- 
Institute of Mathematics
Ecole Polytechnique F?d?rale de Lausanne
STAT-IMA-FSB-EPFL, Station 8
CH-1015 Lausanne   Switzerland
http://stat.epfl.ch/
Tel: + 41 (0)21 693 7907


From cgb at datanalytics.com  Tue Jul 28 23:22:22 2009
From: cgb at datanalytics.com (Carlos J. Gil Bellosta)
Date: Tue, 28 Jul 2009 23:22:22 +0200
Subject: [Rd] Checking package on Windows (and seemingly irreproducible
 errors in CRAN checks)
In-Reply-To: <971536df0907281353v66425bf5y43447ba1796d72da@mail.gmail.com>
References: <1248813071.4657.18.camel@kropotkin>
	<971536df0907281353v66425bf5y43447ba1796d72da@mail.gmail.com>
Message-ID: <1248816142.4657.39.camel@kropotkin>

Dear Gabor,

Yes, I did run the R CMD CHECK on Linux. It only gave me the same two
warnings as in the checks for non-Windows architectures.

The examples run fine on Linux and also on Windows when I installed my
package from the binaries provided in r-forge. I never run a R CMD check
on Windows, though... should it be the way to proceed?

Although I think I have a clue as I am under the impression (that I
should check) after some issues with an application today that
"malformed" paths such as /home/me//myfile.txt are valid in UNIX (I know
for sure) but not on Windows. Maybe I am using such a path somewhere...

Best regards,

Carlos J. Gil Bellosta
http://www.datanalytics.com



On Tue, 2009-07-28 at 16:53 -0400, Gabor Grothendieck wrote:
> That's a check error.  Did you try running R CMD CHECK on it?
> 
> Since it appears to happen in an example you could put
> \dontrun{
> ...
> }
> 
> around the example although it would be better to get it to the
> state that it passes R CMD CHECK without having to do that.
> 
> On Tue, Jul 28, 2009 at 4:31 PM, Carlos J. Gil
> Bellosta<cgb at datanalytics.com> wrote:
> > Hello,
> >
> > I submitted a small package, colbycol, to CRAN. I developed it on Linux
> > and tested it on my Linux box and another Windows machine. Besides,
> > other people kindly tested it in their systems.
> >
> > The package seems to "compile" correctly in r-forge for Windows. In
> > fact, you can find the binary package at
> >
> > http://r-forge.r-project.org/R/?group_id=426.
> >
> > However, in CRAN, the Windows package cannot be built according to
> >
> > http://cran.r-project.org/web/checks/check_results_colbycol.html
> >
> > I cannot reproduce the error. I can guess very little more about what
> > could have gone wrong. The error seems to happen at a time when R tries
> > to read a temporary file (in a temporary folder) that has just been
> > created in a call to a non-R piece of code that does not catch its IO
> > exceptions, if any.
> >
> > Any ideas? Suggestions?
> >
> > Best regards,
> >
> > Carlos J. Gil Bellosta
> > http://www.datanalytics.com
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >


From h.wickham at gmail.com  Wed Jul 29 00:03:14 2009
From: h.wickham at gmail.com (hadley wickham)
Date: Tue, 28 Jul 2009 15:03:14 -0700
Subject: [Rd] Checking package on Windows (and seemingly irreproducible
	errors in CRAN checks)
In-Reply-To: <1248815669.30084.15.camel@ubuntu>
References: <1248813071.4657.18.camel@kropotkin>
	<1248815669.30084.15.camel@ubuntu>
Message-ID: <f8e6ff050907281503m6e41c947s67548b2351d778b1@mail.gmail.com>

On Tue, Jul 28, 2009 at 2:14 PM, Mathieu Ribatet<mathieu.ribatet at epfl.ch> wrote:
> Dear Carlos,
>
> >From your check results:
>
> ? ? ? ?cbc.data <- cbc.read.table( system.file("data",
> ? ? ? ?"cbc.test.data.txt", package = "colbycol"), sep = "\t" )
> ? ? ? ? ? ? ? ?Warning in file(file, "r") :
> ? ? ? ? ? ? ? ?cannot open file '0001': No such file or directory
>
> I think you're trying to read the file "cbc.test.data.txt" located in
> the folder "data" of your package skeleton. Is that right? If so, maybe
> using
>
> ? ? ? ?paste(system.file(package = "colbycol"),
> ? ? ? ?"data/cbc.test.data.txt", sep="/")
>
> will solve your issue - although I didn't try.

That's a step in the wrong direction - you're using a whole lot of
platform specific constructs.

Hadley


-- 
http://had.co.nz/


From smckinney at bccrc.ca  Wed Jul 29 00:30:12 2009
From: smckinney at bccrc.ca (smckinney at bccrc.ca)
Date: Wed, 29 Jul 2009 00:30:12 +0200 (CEST)
Subject: [Rd] Wishlist: Navigate to "Index" page of help when no topic
	specified (PR#13860)
Message-ID: <20090728223012.75E272830316@mail.pubhealth.ku.dk>

Hi all,

When I install a new package, and don't yet know any function names,
I have to play the "poor man's game" to get to the standard
help system "Index" page for the package:
Poor Man's Game -=20
  Load new package;=20
  issue search() command;
  find position (say N) of loaded package;=20
  issue objects(pos =3D N) command;
  get name of a random function (san newFunction);=20
  issue ?newFunction command;
  scroll to bottom of page;=20
  click on the "Index" hyperlink

There are other variations, but they all involve this=20
long march to the Index page.


What I'd like to be able to do is enter the command

> help(package =3D "survival")

or

> ?survival::

and get the usual hyperlinked help page displayed (the "00Index" page)
instead of the static "text only" display or an error message

(for example, on Windows, this equates to invoking
"C:/PROGRA~1/R/R-29~1.1/library/survival/chm/00Index"
on Apple Mac,
"/Library/Frameworks/R.framework/Resources/library/survival/html/00Index.ht=
ml"
etc.)


Details:
---------------

The help() function returns an object of
class "help_files_with_topic".
The object consists of a character vector
with several attributes.

PC:  Windows XP

> library("survival")
> foo <- help("aareg", package =3D "survival")
> class(foo)
[1] "help_files_with_topic"
> foo[1]
[1] "C:/PROGRA~1/R/R-29~1.1/library/survival/chm/aareg"
> attributes(foo)
$call
help(topic =3D "aareg", package =3D "survival")

$pager
[1] "internal"

$topic
[1] "aareg"

$tried_all_packages
[1] FALSE

$type
[1] "chm"

$class
[1] "help_files_with_topic"

> bar <- help("", package =3D "survival")
> class(bar)
[1] "help_files_with_topic"
> bar[1]
[1] NA
> attributes(bar)
$call
help(topic =3D "", package =3D "survival")

$pager
[1] "internal"

$topic
[1] ""

$tried_all_packages
[1] FALSE

$type
[1] "chm"

$class
[1] "help_files_with_topic"

If I alter the character vector to
point to "00Index"

> bar[1] <- "C:/PROGRA~1/R/R-29~1.1/library/survival/chm/00Index"
> bar

I see exactly what I've been attempting to achieve.


Mac OS X:

> foo <- help("aareg", package =3D "survival")
> foo[1]
[1] "/Library/Frameworks/R.framework/Resources/library/survival/html/aareg.=
html"
> attributes(foo)
$call
help(topic =3D "aareg", package =3D "survival")

$pager
[1] "/Library/Frameworks/R.framework/Resources/bin/pager"

$topic
[1] "aareg"

$tried_all_packages
[1] FALSE

$type
[1] "html"

$class
[1] "help_files_with_topic"

> bar <- help("", package =3D "survival")
> bar[1]
[1] NA
> bar[1] <- "/Library/Frameworks/R.framework/Resources/library/survival/htm=
l/00Index.html"
> bar

Again I see exactly what I've been after.

Running R in Emacs on Mac OS X:

> foo <- help(topic =3D "aareg", package =3D "survival")
> foo[1]
[1] "/Library/Frameworks/R.framework/Resources/library/survival/html/aareg.=
html"
> attributes(foo)
$call
help(topic =3D "aareg", package =3D "survival")

$pager
[1] "/Library/Frameworks/R.framework/Resources/bin/pager"

$topic
[1] "aareg"

$tried_all_packages
[1] FALSE

$type
[1] "html"

$class
[1] "help_files_with_topic"

> bar <- help(topic =3D "", package =3D "survival")
> bar[1]
[1] NA
> bar[1] <- "/Library/Frameworks/R.framework/Resources/library/survival/htm=
l/00Index.html"
> bar
Help for '' is shown in browser /usr/bin/open ...
Use
        help("", htmlhelp =3D FALSE)
or
        options(htmlhelp =3D FALSE)
to revert.
>

Again, what I've been trying to achieve.

When a user loads a new library and doesn't yet know any function names,
I think
> help(package =3D "newLibrary")
or
> ?newLibrary::

should perform the above action whenever possible instead of
producing static help or an error message.

The "00Index" 'object' should be available for such use
whenever it exists. =20

I have not yet worked out all the coding details to make this happen,
but before I do, am I missing some key point?  Any reasons why this
would be a Bad Idea?



Steven McKinney, Ph.D.

Statistician
Molecular Oncology and Breast Cancer Program
British Columbia Cancer Research Centre

email: smckinney +at+ bccrc +dot+ ca

tel: 604-675-8000 x7561

BCCRC
Molecular Oncology
675 West 10th Ave, Floor 4
Vancouver B.C.
V5Z 1L3
Canada


From foylong at gmail.com  Wed Jul 29 10:24:56 2009
From: foylong at gmail.com (=?ISO-8859-1?B?RuFuIEzzbmc=?=)
Date: Wed, 29 Jul 2009 16:24:56 +0800
Subject: [Rd] Is this a bug of quantreg package
Message-ID: <e936a3d0907290124p8a3a21cl6421d7c638b58eb1@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090729/7e47840d/attachment.pl>

From maechler at stat.math.ethz.ch  Wed Jul 29 11:37:48 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 29 Jul 2009 11:37:48 +0200
Subject: [Rd] RFC: methods() and showMethods() {was "debug"}
Message-ID: <19056.6252.321949.632481@lynne.math.ethz.ch>

       (a new thread, on purpose)

>>>>> "RobG" == Robert Gentleman <rgentlem at fhcrc.org>
>>>>>     on Mon, 27 Jul 2009 16:55:50 -0700 writes:

    RobG> Hi, I just committed a change to R-devel so that if
    RobG> debug is called on an S3 generic function, all methods
    RobG> will also automatically have debug turned on for them
    RobG> (if they are dispatched to from the generic).

very nice.

    RobG>    I hope to be able to extend this to S4 and a few
    RobG> other cases that are currently not being handled over
    RobG> the next few weeks.

that (S4) will be very useful for me, thank you in advance,
Robert!

A somewhat related issue:
As many of the R-devel readers will know, there has been quite
a nice ongoing effort to make S3 and S4 methods and classes more
compatible.
One issue here, notably for inexperienced programmeRs,
is also the fact that
methods(f) only tells about S3-methods for 'f',
and showMethods(f) only mentions S4 ones.
This is not at all design error, as indeed S3 and S4 dispatch is quite
different (notably as the latter allows multiple dispatch and
hence uses the nice concept of "signature"),
used to be more incompatible and, indeed,  methods(f) *still*
warns, often wrongly, if it finds that f is a (S4) generic function.

As this is an RFC, let me just make a few more propositional
points, and we (R core) will be happy to receive constructive
feedback from outside the core team as well.

Propositions / Ideas :
[ Using the example of having Matrix: 
  library(Matrix)
]

1) methods(f) should become a bit smarter when it sees that f is
   an S4 generic,  and not say,  e.g., for  

  >  methods(qr)
  ...
   'qr' is a formal generic function; S3 methods will not likely be found
  ...

  but rather at least "look" to see if there's an "ANY" method containing
  UseMethod() (*1), 

2) and if there is, or maybe in any case, methods() should then
   also call showMethods() to show the S4 methods;
   or it would suggest the to user to call  'showMethods(..)'

3) showMethods(.) : It could/should  
  a) look for S3 dispatch symptoms such as
     UseMethod(.) in its "ANY" methods
  b) call methods() in any case

  and then possibly mention the result of methods() in any case,
  *plus* ... that's probably the most difficult part ... 
  warn if there are S3 methods {as per 'b)'} that seem not be
  called at all {as per a)}, but that would also have to
  consider .Primitive s with C internal (S3 and S4) dispatch.


As you see, these are partly concrete proposals, partly just
ideas, asking for feedback, from you, experienced 
programmeRs, ...

Martin Maechler, ETH Zurich


---
*1) as there will always be if the  S4 methods
    have been setup properly and *after* the S3 ones.
  This will typically be the case for situations when there are
  old traditional S3 methods in "base R", and a package adds new
  modern S4 methods.


From hintak_leung at yahoo.co.uk  Tue Jul 28 23:38:46 2009
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Tue, 28 Jul 2009 21:38:46 +0000 (GMT)
Subject: [Rd] R --vannilla for install/remove/shlib(Re: R 2.8->2.9 change
	that breaks some upgrade scenarios)
Message-ID: <820730.16144.qm@web23106.mail.ird.yahoo.com>

This is the change I suggested earlier - it should just disable more of user/site customization during package installation/removal, and getting more of R 2.8-like behavior back. Attached and inlined below. 
Against svn r48897 (svn HEAD AFAIK).

--------------------------------------------------
diff --git a/src/scripts/INSTALL b/src/scripts/INSTALL
index 42470c2...4c7bae9 100755
--- a/src/scripts/INSTALL
+++ b/src/scripts/INSTALL
@@ -9,4 +9,4 @@ while test -n "${1}"; do
 done
 
 ## NB: Apple's ICU needs LC_COLLATE set when R is started.
-echo 'tools:::.install_packages()' | R_DEFAULT_PACKAGES= LC_COLLATE=C "${R_HOME}/bin/R" --no-restore --slave --args ${args}
+echo 'tools:::.install_packages()' | R_DEFAULT_PACKAGES= LC_COLLATE=C "${R_HOME}/bin/R" --vanilla --slave --args ${args}
diff --git a/src/scripts/REMOVE b/src/scripts/REMOVE
index dcbe5bf..0be7462 100644
--- a/src/scripts/REMOVE
+++ b/src/scripts/REMOVE
@@ -1,4 +1,4 @@
 # ${R_HOME}/bin/REMOVE for removing add-on packages
 
-R_DEFAULT_PACKAGES=NULL "${R_HOME}/bin/R" -f "${R_SHARE_DIR}/R/REMOVE.R" --no-restore --slave --args $@
+R_DEFAULT_PACKAGES=NULL "${R_HOME}/bin/R" -f "${R_SHARE_DIR}/R/REMOVE.R" --vanilla --slave --args $@
 
diff --git a/src/scripts/SHLIB b/src/scripts/SHLIB
index d0ab9a0..ab62369 100644
--- a/src/scripts/SHLIB
+++ b/src/scripts/SHLIB
@@ -1,5 +1,5 @@
 #
 # ${R_HOME}/bin/SHLIB
 
-echo 'tools:::.SHLIB()' | R_DEFAULT_PACKAGES=NULL "${R_HOME}/bin/R" --no-restore --slave --no-site-file --no-init-file --args $@
+echo 'tools:::.SHLIB()' | R_DEFAULT_PACKAGES=NULL "${R_HOME}/bin/R" --vanilla --slave --args $@
 
--------------------
[Hin-Tak at localhost R]$ 



      
-------------- next part --------------
A non-text attachment was scrubbed...
Name: R-more-vanilla.diff
Type: text/x-patch
Size: 1308 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090728/3fbd9c08/attachment.bin>

From kfmfe04 at gmail.com  Wed Jul 29 06:22:37 2009
From: kfmfe04 at gmail.com (Ken-JP)
Date: Tue, 28 Jul 2009 21:22:37 -0700 (PDT)
Subject: [Rd]  xtable formatting: RED for negative numbers?
Message-ID: <24712197.post@talk.nabble.com>



I've been experimenting recently with the fantastic Sweave/xtable
combination for generating latex.  In the xtable vignette, I found this
great example of printing a ts object by months.

Is there a way to modify this code to generate RED numbers inside xtable for
negative results in x.ts?
Thanks in advance.

- Ken

# Sweave/xtable snippet below
--------------------------------------------------------------

\begin{table}[ht]
<<sample,echo=F,results=tex>>=
x.ts <- ts(rnorm(100), start = c(1954, 7), frequency = 12)
x.table <- xtable( x.ts, digits = 1 )
print( x.table, floating = FALSE )
@
\end{table}


-- 
View this message in context: http://www.nabble.com/xtable-formatting%3A-RED-for-negative-numbers--tp24712197p24712197.html
Sent from the R devel mailing list archive at Nabble.com.


From ligges at statistik.tu-dortmund.de  Wed Jul 29 17:38:22 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 29 Jul 2009 17:38:22 +0200
Subject: [Rd] Checking package on Windows (and seemingly irreproducible
 errors in CRAN checks)
In-Reply-To: <1248815669.30084.15.camel@ubuntu>
References: <1248813071.4657.18.camel@kropotkin>
	<1248815669.30084.15.camel@ubuntu>
Message-ID: <4A706CEE.6060603@statistik.tu-dortmund.de>



Mathieu Ribatet wrote:
> Dear Carlos,
> 
>>From your check results:
> 
>         cbc.data <- cbc.read.table( system.file("data",
>         "cbc.test.data.txt", package = "colbycol"), sep = "\t" )
>                 Warning in file(file, "r") :
>                 cannot open file '0001': No such file or directory
>         
> I think you're trying to read the file "cbc.test.data.txt" located in
> the folder "data" of your package skeleton. Is that right? If so, maybe
> using
> 
>         paste(system.file(package = "colbycol"),
>         "data/cbc.test.data.txt", sep="/")
>         
> will solve your issue - although I didn't try.


It won't slve it, because reading that file works, but reading file 
"0001" does ot which is handled within cbc.read.table() in the lines

....
   for( column in names(columns) ){
         tmp <- read.table( columns[[column]]$filename, sep = sep, 
na.strings = "", comment.char = "", quote = "", header = FALSE, ... )[,1]
....


I guess the problem happens before during the Java stuff where the 0001 
file is never created (at least not in the location you expect).


On the console I see error messages like


Exception in thread "main" Traceback (most recent call last):
   File "d:/temp/colbycol/python/colbycol.py", line 6, in <module>
     os.chdir( work_dir )
   File "D:\RCompile\CRANpkg\lib\2.9\rSymPy\jython\Lib\os.py", line 261, 
in chdir
     raise OSError(errno.ENOENT, strerror(errno.ENOENT), path)
OSError: [Errno 2] No such file or directory: 
'd:/temp/Rtmp1mB6qg/dir72ae2cd6'


Best,
Uwe Ligges




> Best,
> Mathieu
> 
> Le mardi 28 juillet 2009 ? 22:31 +0200, Carlos J. Gil Bellosta a ?crit :
>> Hello,
>>
>> I submitted a small package, colbycol, to CRAN. I developed it on Linux
>> and tested it on my Linux box and another Windows machine. Besides,
>> other people kindly tested it in their systems. 
>>
>> The package seems to "compile" correctly in r-forge for Windows. In
>> fact, you can find the binary package at
>>
>> http://r-forge.r-project.org/R/?group_id=426.
>>
>> However, in CRAN, the Windows package cannot be built according to
>>
>> http://cran.r-project.org/web/checks/check_results_colbycol.html
>>
>> I cannot reproduce the error. I can guess very little more about what
>> could have gone wrong. The error seems to happen at a time when R tries
>> to read a temporary file (in a temporary folder) that has just been
>> created in a call to a non-R piece of code that does not catch its IO
>> exceptions, if any. 
>>
>> Any ideas? Suggestions?
>>
>> Best regards,
>>
>> Carlos J. Gil Bellosta
>> http://www.datanalytics.com
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel


From macrakis at alum.mit.edu  Wed Jul 29 21:28:36 2009
From: macrakis at alum.mit.edu (Stavros Macrakis)
Date: Wed, 29 Jul 2009 15:28:36 -0400
Subject: [Rd] BUG/FIX: View gives internal error with long argument
	(multiline deparse)
Message-ID: <8b356f880907291228v7e4d8a5bv85caa49a700571d5@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090729/57360885/attachment.pl>

From cameron.bracken at gmail.com  Wed Jul 29 22:31:29 2009
From: cameron.bracken at gmail.com (cameron.bracken)
Date: Wed, 29 Jul 2009 13:31:29 -0700 (PDT)
Subject: [Rd] xtable formatting: RED for negative numbers?
In-Reply-To: <24712197.post@talk.nabble.com>
References: <24712197.post@talk.nabble.com>
Message-ID: <24726982.post@talk.nabble.com>



Ken-JP wrote:
> 
> Is there a way to modify this code to generate RED numbers inside xtable
> for
> negative results in x.ts?
> 


This post would probably have been better for R-help.  Anyway, you can do it
easily by modifying print.xtable.R in the xtable package.  If it is easier,
make a copy of that file, modify it, load the xtable package, then source
your modified version.   

Basically change line 227 from 

result[i] <- gsub("-","$-$",result[i],fixed=TRUE)

to

result[i] <- gsub("-","\\color{red}$-$",result[i],fixed=TRUE)

and then your code chunk becomes:

<<sample,echo=F,results=tex>>= 
library(xtable)
x.ts <- ts(rnorm(100), start = c(1954, 7), frequency = 12)
x.table <- xtable( x.ts, digits = 1 ) 
print( x.table, floating = FALSE, math.style.negative = TRUE) 
@ 


Here is the patch:  http://www.nabble.com/file/p24726982/print.xtable.R.diff
print.xtable.R.diff 
Here is the output I got: 
http://www.nabble.com/file/p24726982/xtable-red.pdf xtable-red.pdf 

- Cameron

P.S. You must use the color package in latex.
-- 
View this message in context: http://www.nabble.com/xtable-formatting%3A-RED-for-negative-numbers--tp24715905p24726982.html
Sent from the R devel mailing list archive at Nabble.com.


From cameron.bracken at gmail.com  Wed Jul 29 22:33:55 2009
From: cameron.bracken at gmail.com (cameron.bracken)
Date: Wed, 29 Jul 2009 13:33:55 -0700 (PDT)
Subject: [Rd] xtable formatting: RED for negative numbers?
In-Reply-To: <24726982.post@talk.nabble.com>
References: <24712197.post@talk.nabble.com> <24726982.post@talk.nabble.com>
Message-ID: <24727010.post@talk.nabble.com>


The links to those previous files were broken, here they are:

Here is the patch:  http://www.nabble.com/file/p24727010/print.xtable.R.diff
print.xtable.R.diff 
Here is the output I got: 
http://www.nabble.com/file/p24727010/xtable-red.pdf xtable-red.pdf 
-- 
View this message in context: http://www.nabble.com/xtable-formatting%3A-RED-for-negative-numbers--tp24715905p24727010.html
Sent from the R devel mailing list archive at Nabble.com.


From richcalaway at revolution-computing.com  Wed Jul 29 23:20:41 2009
From: richcalaway at revolution-computing.com (Richard Calaway)
Date: Wed, 29 Jul 2009 14:20:41 -0700
Subject: [Rd] Problem in setRepositories() logic
Message-ID: <E6242E43-C389-43CB-9B9B-76EC327B55D5@revolution-computing.com>

Hi, all--

I was playing around with the Packages menu in the Windows RGui, and  
noticed that when I chose Select  repositories and clicked Cancel,  
instead of being returned to the R prompt I was faced with a text  
version of the menu. I think the text menu should only appear
if graphics=FALSE, and should explicitly say how to cancel, as well.  
The following changes make that happen:

Index: packages.R
===================================================================
--- packages.R  (revision 49021)
+++ packages.R  (working copy)
@@ -654,7 +654,7 @@
                                                     multiple = TRUE,  
"Repositories"),
                               a[, 1L])
          }
-        if(!length(res)) {
+        else {
              ## text-mode fallback
              cat(gettext("--- Please select repositories for use in  
this session ---\n"))
              nc <- length(default)
@@ -662,12 +662,12 @@
                            ifelse(default, "+", " "), " ", a[, 1L],
                            sep=""),
                  "", sep="\n")
-            cat(gettext("Enter one or more numbers separated by spaces 
\n"))
+            cat(gettext("Enter one or more numbers separated by  
spaces, or 0 to cancel\n"))
              res <- scan("", what=0, quiet=TRUE, nlines=1L)
-            if(!length(res) || (length(res) == 1L && !res[1L]))
-                return(invisible())
-            res <- res[1 <= res && res <= nc]
          }
+        if(!length(res) || (length(res) == 1L && !res[1L]))
+            return(invisible())
+        res <- res[1 <= res && res <= nc]
      }
      if(length(res)) {
          repos <- a[["URL"]]


Rich Calaway
Documentation Manager
REvolution Computing, Inc.
richcalaway at revolution-computing.com
206-577-4778 x3204


From richcalaway at revolution-computing.com  Thu Jul 30 00:45:08 2009
From: richcalaway at revolution-computing.com (Richard Calaway)
Date: Wed, 29 Jul 2009 15:45:08 -0700
Subject: [Rd] Oops...a better (working, this time) patch for setRepositories
Message-ID: <31DE65C3-241C-4BE2-A69A-17284C4EDCA3@revolution-computing.com>

My previous suggested patch worked fine for the text-menu case, but  
broke the graphics case; the following one, that moves the definition  
of nc outside of the if...else clauses, works for both:

Index: packages.R
===================================================================
--- packages.R  (revision 49021)
+++ packages.R  (working copy)
@@ -639,7 +639,7 @@
      }

      default <- a[["default"]]
-
+    nc <- length(default)
      if(length(ind)) res <- as.integer(ind)
      else {
          res <- integer(0L)
@@ -654,20 +654,19 @@
                                                     multiple = TRUE,  
"Repositories"),
                               a[, 1L])
          }
-        if(!length(res)) {
+        else {
              ## text-mode fallback
              cat(gettext("--- Please select repositories for use in  
this session ---\n"))
-            nc <- length(default)
              cat("", paste(seq_len(nc), ": ",
                            ifelse(default, "+", " "), " ", a[, 1L],
                            sep=""),
                  "", sep="\n")
-            cat(gettext("Enter one or more numbers separated by spaces 
\n"))
+            cat(gettext("Enter one or more numbers separated by  
spaces, or 0 to cancel\n"))
              res <- scan("", what=0, quiet=TRUE, nlines=1L)
-            if(!length(res) || (length(res) == 1L && !res[1L]))
-                return(invisible())
-            res <- res[1 <= res && res <= nc]
          }
+        if(!length(res) || (length(res) == 1L && !res[1L]))
+            return(invisible())
+        res <- res[1 <= res && res <= nc]
      }
      if(length(res)) {
          repos <- a[["URL"]]

Rich Calaway
Documentation Manager
REvolution Computing, Inc.
richcalaway at revolution-computing.com
206-577-4778 x3204


From ross at biostat.ucsf.edu  Thu Jul 30 08:21:13 2009
From: ross at biostat.ucsf.edu (Ross Boylan)
Date: Wed, 29 Jul 2009 23:21:13 -0700
Subject: [Rd] user supplied random number generators
Message-ID: <1248934873.18270.83.camel@corn.betterworld.us>

?Random.user says (in svn trunk)
  Optionally,
  functions \code{user_unif_nseed} and \code{user_unif_seedloc} can be
  supplied which are called with no arguments and should return pointers
  to the number of seeds and to an integer array of seeds.  Calls to
  \code{GetRNGstate} and \code{PutRNGstate} will then copy this array to
  and from \code{.Random.seed}.
And it offers as an example
  void  user_unif_init(Int32 seed_in) { seed = seed_in; }
  int * user_unif_nseed() { return &nseed; }
  int * user_unif_seedloc() { return (int *) &seed; }

First question: what is the lifetime of the buffers pointed to by the
user_unif-* functions, and who is responsible for cleaning them up?  In
the help file they are static variables, but in general they might be
allocated on the heap or might be in structures that only persist as
long as the generator does.

Since the example uses static variables, it seems reasonable to conclude
the core R code is not going to try to free them.

Second, are the types really correct?  The documentation seems quite
explicit, all the more so because it uses Int32 in places.  However, the
code in RNG.c (RNG_Init) says

	    ns = *((int *) User_unif_nseed());
	    if (ns < 0 || ns > 625) {
		warning(_("seed length must be in 0...625; ignored"));
		break;
	    }
	    RNG_Table[kind].n_seed = ns;
	    RNG_Table[kind].i_seed = (Int32 *) User_unif_seedloc();
consistent with the earlier definition of RNG_Table entries as
typedef struct {
    RNGtype kind;
    N01type Nkind;
    char *name; /* print name */
    int n_seed; /* length of seed vector */
    Int32 *i_seed;
} RNGTAB;

This suggests that the type of user_unif_seedloc is Int32*, not int *.
It also suggests that user_unif_nseed should return the number of 32 bit
integers.  The code for PutRNGstate(), for example, uses them in just
that way.

While the dominant model, even on 64 bit hardware, is probably to leave
int as 32 bit, it doesn't seem wise to assume that is always the case.

I got into this because I'm trying to extend the rsprng code; sprng
returns its state as a vector of bytes.  Converting these to a vector of
integers depends on the integer length, hence my interest in the exact
definiton of integer.  I'm interested in lifetime because I believe
those bytes are associated with the stream and become invalid when the
stream is freed; furthermore, I probably need to copy them into a buffer
that is padded to full wordlength.  This means I allocate the buffer
whose address is returned to the core R RNG machinery.  Eventually
somebody needs to free the memory.

Far more of my rsprng adventures are on
http://wiki.r-project.org/rwiki/doku.php?id=packages:cran:rsprng.  Feel
free to read, correct, or extend it.

Thanks.

Ross Boylan


From kbare at andrew.cmu.edu  Wed Jul 29 19:50:16 2009
From: kbare at andrew.cmu.edu (kbare at andrew.cmu.edu)
Date: Wed, 29 Jul 2009 19:50:16 +0200 (CEST)
Subject: [Rd] Strange Interaction Between Promises and Closures (PR#13861)
Message-ID: <20090729175016.731F8282C76A@mail.pubhealth.ku.dk>

Full_Name: Keith Bare
Version: 2.7.1
OS: Linux
Submission from: (NULL) (128.2.134.48)


I observed unexpected behavior attempting to use lapply to vary parameters in
generated closures.  All the generated closures ran with the last parameter
value in the list.

Here's a simple example:

> funcs <- lapply(c("alpha", "beta", "gamma", "delta"), function(x) function()
print(x))
> funcs[[1]]()
[1] "delta"
> funcs[[2]]()
[1] "delta"
> funcs[[3]]()
[1] "delta"
> funcs[[4]]()
[1] "delta"


What appears to be happening, is that the unevaluated promise for x is getting
stored in the generated closure.  This promise references a variable in the
local environment for the lapply call.  However, that variable gets clobbered by
subsequent processing by lapply.


This may be a language "feature" rather than a bug.  But IMO, the observed
behavior is very non-intuitive.  If so, maybe it deserves mention in the
documentation for lapply, "function", or the language reference section on
functions.


For now, I've found that adding a force in the function that generates the
returned closure is a workaround.  E.g.:

> funcs <- lapply(c("alpha", "beta", "gamma", "delta"), function(x) { force(x);
function() print(x) })
> funcs[[1]]()
[1] "alpha"
> funcs[[2]]()
[1] "beta"
> funcs[[3]]()
[1] "gamma"
> funcs[[4]]()
[1] "delta"


And here's my version output (I'm running the version in Debian lenny):

> version
               _                           
platform       x86_64-pc-linux-gnu         
arch           x86_64                      
os             linux-gnu                   
system         x86_64, linux-gnu           
status                                     
major          2                           
minor          7.1                         
year           2008                        
month          06                          
day            23                          
svn rev        45970                       
language       R                           
version.string R version 2.7.1 (2008-06-23)


--Keith


From maechler at stat.math.ethz.ch  Thu Jul 30 10:32:22 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 30 Jul 2009 10:32:22 +0200
Subject: [Rd] R --vanilla for install/remove/shlib(Re: R 2.8->2.9 change
	that breaks some upgrade scenarios)
In-Reply-To: <820730.16144.qm@web23106.mail.ird.yahoo.com>
References: <820730.16144.qm@web23106.mail.ird.yahoo.com>
Message-ID: <19057.23190.432051.352920@lynne.math.ethz.ch>

>>>>> "HL" == Hin-Tak Leung <hintak_leung at yahoo.co.uk>
>>>>>     on Tue, 28 Jul 2009 21:38:46 +0000 (GMT) writes:

    HL> This is the change I suggested earlier - it should just disable more of user/site customization during package installation/removal, and getting more of R 2.8-like behavior back. Attached and inlined below. 
    HL> Against svn r48897 (svn HEAD AFAIK).

hmm, too bad: that's too old.

A couple of days ago I had already changed  INSTALL  to at least
*optionally* allow to use --vanilla (just one "n": note I've changed
the subject).

But as I understand different R core members have different
views on this issue, and so for now (with a newish R-devel),
I use
-----------------------
export R_INSTALL_VANILLA=true
-----------------------

somewhere in my (sh/bash) login setup, and am happy that my old
'<pkg>-check-me' shell scripts which set R_LIBS explictly again
work (whereas the current R-devel by default uses R_LIBS from our site-wide
Rprofile equivalent which is not what I think is optimal ..).

The current experimental R_INSTALL_VANILLA behavior is still
careful to find the   user-/site- specific  .libPaths()[1]
library location for installing a package in the case that no 
library location has been specified.


I'm not sure this addresses all the problems that your patch
tried to fix,
but in any case, your patch re-installing the --vanilla behavior
unconditionally (without the .libPaths()[1] detection) was not 
suffificient.


Best regards,
Martin Maechler, ETH Zurich


From p.dalgaard at biostat.ku.dk  Thu Jul 30 11:12:58 2009
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 30 Jul 2009 11:12:58 +0200
Subject: [Rd] Strange Interaction Between Promises and Closures
	(PR#13861)
In-Reply-To: <20090729175016.731F8282C76A@mail.pubhealth.ku.dk>
References: <20090729175016.731F8282C76A@mail.pubhealth.ku.dk>
Message-ID: <4A71641A.8080901@biostat.ku.dk>

kbare at andrew.cmu.edu wrote:
> Full_Name: Keith Bare
> Version: 2.7.1
> OS: Linux
> Submission from: (NULL) (128.2.134.48)
> 
> 
> I observed unexpected behavior attempting to use lapply to vary parameters in
> generated closures.  All the generated closures ran with the last parameter
> value in the list.
> 
> Here's a simple example:
> 
>> funcs <- lapply(c("alpha", "beta", "gamma", "delta"), function(x) function()
> print(x))
>> funcs[[1]]()
> [1] "delta"
>> funcs[[2]]()
> [1] "delta"
>> funcs[[3]]()
> [1] "delta"
>> funcs[[4]]()
> [1] "delta"
> 
> 
> What appears to be happening, is that the unevaluated promise for x is getting
> stored in the generated closure.  This promise references a variable in the
> local environment for the lapply call.  However, that variable gets clobbered by
> subsequent processing by lapply.
> 
> 
> This may be a language "feature" rather than a bug.  But IMO, the observed
> behavior is very non-intuitive.  If so, maybe it deserves mention in the
> documentation for lapply, "function", or the language reference section on
> functions.
> 
> 
> For now, I've found that adding a force in the function that generates the
> returned closure is a workaround.  E.g.:
> 
>> funcs <- lapply(c("alpha", "beta", "gamma", "delta"), function(x) { force(x);
> function() print(x) })
>> funcs[[1]]()
> [1] "alpha"
>> funcs[[2]]()
> [1] "beta"
>> funcs[[3]]()
> [1] "gamma"
>> funcs[[4]]()
> [1] "delta"

Not a bug, consequence of lazy evaluation, and force() IS the 
workaround. It is not specific to lapply; a prototypical example goes

 > f <- function(x) function() x
 > x <- 2
 > g <- f(x)
 > x <- 4
 > g()
[1] 4
 > x <- 6
 > g()
[1] 4

In the lapply context, the promise refers to an internal loop variable, 
and if the promise is not evaluated until the loop is done, you get the 
value of the loop variable at the end.

Documenting this sort of thing in a place that actually gets seen is an 
interesting problem... Probably, Section 4.3.3 in the R-lang manual is 
the only viable option.


-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From hintak_leung at yahoo.co.uk  Thu Jul 30 10:59:01 2009
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Thu, 30 Jul 2009 08:59:01 +0000 (GMT)
Subject: [Rd] R --vanilla for install/remove/shlib(Re: R 2.8->2.9 change
	that breaks some upgrade scenarios)
In-Reply-To: <19057.23190.432051.352920@lynne.math.ethz.ch>
Message-ID: <136624.77590.qm@web23106.mail.ird.yahoo.com>

--- On Thu, 30/7/09, Martin Maechler <maechler at stat.math.ethz.ch> wrote:

> I'm not sure this addresses all the problems that your
> patch
> tried to fix,
> but in any case, your patch re-installing the --vanilla
> behavior
> unconditionally (without the .libPaths()[1] detection) was
> not 
> suffificient.

But I think .libPaths should not be _implicitly_ user-/site- overridded - afterall, non-standard locations are already catered for with the -l option (which presumbably does the same thing as declaring R_LIBS, just explicitly).

This is analogous to installing system libraries and run-time relocation - while people do install binaries and libraries in non-standard locations and customize their $PATH and $LD_LIBRARY_PATH to reflect that either at the user- or site- level, it would be quite strange to allow ./configure or other equivalent software building tools to peek at the first part of PATH or LD_LIBRARY_PATH and put executables in the former and libraries in the latter... That's almost anarchy :-).





From dutangc at gmail.com  Thu Jul 30 12:32:55 2009
From: dutangc at gmail.com (Christophe Dutang)
Date: Thu, 30 Jul 2009 12:32:55 +0200
Subject: [Rd] user supplied random number generators
In-Reply-To: <1248934873.18270.83.camel@corn.betterworld.us>
References: <1248934873.18270.83.camel@corn.betterworld.us>
Message-ID: <85EC2769-AFC0-4C15-ADCB-02F4EB87FD73@gmail.com>

Hello,

Le 30 juil. 09 ? 08:21, Ross Boylan a ?crit :

> ?Random.user says (in svn trunk)
>  Optionally,
>  functions \code{user_unif_nseed} and \code{user_unif_seedloc} can be
>  supplied which are called with no arguments and should return  
> pointers
>  to the number of seeds and to an integer array of seeds.  Calls to
>  \code{GetRNGstate} and \code{PutRNGstate} will then copy this array  
> to
>  and from \code{.Random.seed}.
> And it offers as an example
>  void  user_unif_init(Int32 seed_in) { seed = seed_in; }
>  int * user_unif_nseed() { return &nseed; }
>  int * user_unif_seedloc() { return (int *) &seed; }
>
> First question: what is the lifetime of the buffers pointed to by the
> user_unif-* functions, and who is responsible for cleaning them up?   
> In
> the help file they are static variables, but in general they might be
> allocated on the heap or might be in structures that only persist as
> long as the generator does.
>
> Since the example uses static variables, it seems reasonable to  
> conclude
> the core R code is not going to try to free them.
>
> Second, are the types really correct?  The documentation seems quite
> explicit, all the more so because it uses Int32 in places.  However,  
> the
> code in RNG.c (RNG_Init) says
>
> 	    ns = *((int *) User_unif_nseed());
> 	    if (ns < 0 || ns > 625) {
> 		warning(_("seed length must be in 0...625; ignored"));
> 		break;
> 	    }
> 	    RNG_Table[kind].n_seed = ns;
> 	    RNG_Table[kind].i_seed = (Int32 *) User_unif_seedloc();
> consistent with the earlier definition of RNG_Table entries as
> typedef struct {
>    RNGtype kind;
>    N01type Nkind;
>    char *name; /* print name */
>    int n_seed; /* length of seed vector */
>    Int32 *i_seed;
> } RNGTAB;
>
> This suggests that the type of user_unif_seedloc is Int32*, not int *.
> It also suggests that user_unif_nseed should return the number of 32  
> bit
> integers.  The code for PutRNGstate(), for example, uses them in just
> that way.
>
> While the dominant model, even on 64 bit hardware, is probably to  
> leave
> int as 32 bit, it doesn't seem wise to assume that is always the case.

You can test the size of an int with a configure script. see for  
example the package foreign, the package randtoolbox (can be found in  
Rmetrics R forge project) I maintain with Petr Savicky.

By the way, I'm sure he has an answer about RNGkind because he made  
the runif interface in the randtoolbox package and in rngWELL19937  
package.

Christophe

>
>
> I got into this because I'm trying to extend the rsprng code; sprng
> returns its state as a vector of bytes.  Converting these to a  
> vector of
> integers depends on the integer length, hence my interest in the exact
> definiton of integer.  I'm interested in lifetime because I believe
> those bytes are associated with the stream and become invalid when the
> stream is freed; furthermore, I probably need to copy them into a  
> buffer
> that is padded to full wordlength.  This means I allocate the buffer
> whose address is returned to the core R RNG machinery.  Eventually
> somebody needs to free the memory.
>
> Far more of my rsprng adventures are on
> http://wiki.r-project.org/rwiki/doku.php?id=packages:cran:rsprng.   
> Feel
> free to read, correct, or extend it.
>
> Thanks.
>
> Ross Boylan
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

--
Christophe Dutang
Ph.D. student at ISFA, Lyon, France
website: http://dutangc.free.fr


From maechler at stat.math.ethz.ch  Thu Jul 30 12:35:24 2009
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 30 Jul 2009 12:35:24 +0200
Subject: [Rd] R --vanilla for install/remove/shlib(Re: R 2.8->2.9 change
	that breaks some upgrade scenarios)
In-Reply-To: <136624.77590.qm@web23106.mail.ird.yahoo.com>
References: <19057.23190.432051.352920@lynne.math.ethz.ch>
	<136624.77590.qm@web23106.mail.ird.yahoo.com>
Message-ID: <19057.30572.837860.529964@lynne.math.ethz.ch>

>>>>> "HL" == Hin-Tak Leung <hintak_leung at yahoo.co.uk>
>>>>>     on Thu, 30 Jul 2009 08:59:01 +0000 (GMT) writes:

    HL> --- On Thu, 30/7/09, Martin Maechler <maechler at stat.math.ethz.ch> wrote:
    >> I'm not sure this addresses all the problems that your
    >> patch
    >> tried to fix,
    >> but in any case, your patch re-installing the --vanilla
    >> behavior
    >> unconditionally (without the .libPaths()[1] detection) was
    >> not 
    >> suffificient.

    HL> But I think .libPaths should not be _implicitly_ user-/site- overridded - afterall, non-standard locations are already catered for with the -l option (which presumbably does the same thing as declaring R_LIBS, just explicitly).

We are talking *only* about the case where no '-l' (or
'lib.loc') was specified, and the default has always been to
take the first entry in  .libPaths() .... [ with all its
problems when that is not writable, but that's a different story]


    HL> This is analogous to installing system libraries and run-time relocation - while people do install binaries and libraries in non-standard locations and customize their $PATH and $LD_LIBRARY_PATH to reflect that either at the user- or site- level, it would be quite strange to allow ./configure or other equivalent software building tools to peek at the first part of PATH or LD_LIBRARY_PATH and put executables in the former and libraries in the latter... That's almost anarchy :-).

The comparison is interesting, and slightly off I think:
Again, we are only talking about the case when there's *no*
default library location specified for package *installation*.

HOWEVER,
the case I mentioned, where I have scenarios where I was able to
use
	'R_LIBS=...:...:....  R CMD check <mypkg>'

using non-default library locations, not for installation
(because that would be  <mypkg>.Rcheck  anyway), but for
searching of package *dependencies* of <mypkg>
is also something that has stopped working in the current
R-devel, because it uses our site-wide Rprofile and that sets
R_LIBS differently itself.

--

Anyway, I think it would not be a bad course to still *allow* 
"vanilla-INSTALL"  but keep the current R-devel default
behavior.
But maybe we can find something better.
(and hopefully other R core members will explain more clearly
 why they think it was "the correct" default behavior to obey
 site-wide and user-specific  Rprofile  settings)

Martin


From hintak_leung at yahoo.co.uk  Thu Jul 30 13:06:50 2009
From: hintak_leung at yahoo.co.uk (Hin-Tak Leung)
Date: Thu, 30 Jul 2009 11:06:50 +0000 (GMT)
Subject: [Rd] R --vanilla for install/remove/shlib(Re: R 2.8->2.9 change
	that breaks some upgrade scenarios)
In-Reply-To: <19057.30572.837860.529964@lynne.math.ethz.ch>
Message-ID: <283713.36119.qm@web23101.mail.ird.yahoo.com>

--- On Thu, 30/7/09, Martin Maechler <maechler at stat.math.ethz.ch> wrote:

> >>>>> "HL" == Hin-Tak
> Leung <hintak_leung at yahoo.co.uk>
> >>>>>     on Thu, 30 Jul
> 2009 08:59:01 +0000 (GMT) writes:
> 
>     HL> --- On Thu, 30/7/09, Martin Maechler
> <maechler at stat.math.ethz.ch>
> wrote:
>     >> I'm not sure this addresses all the
> problems that your
>     >> patch
>     >> tried to fix,
>     >> but in any case, your patch
> re-installing the --vanilla
>     >> behavior
>     >> unconditionally (without the
> .libPaths()[1] detection) was
>     >> not 
>     >> suffificient.
> 
>     HL> But I think .libPaths should not be
> _implicitly_ user-/site- overridded - afterall, non-standard
> locations are already catered for with the -l option (which
> presumbably does the same thing as declaring R_LIBS, just
> explicitly).
> 
> We are talking *only* about the case where no '-l' (or
> 'lib.loc') was specified, and the default has always been
> to
> take the first entry in  .libPaths() .... [ with all
> its
> problems when that is not writable, but that's a different
> story]
> 
> 
>     HL> This is analogous to installing system
> libraries and run-time relocation - while people do install
> binaries and libraries in non-standard locations and
> customize their $PATH and $LD_LIBRARY_PATH to reflect that
> either at the user- or site- level, it would be quite
> strange to allow ./configure or other equivalent software
> building tools to peek at the first part of PATH or
> LD_LIBRARY_PATH and put executables in the former and
> libraries in the latter... That's almost anarchy :-).
> 
> The comparison is interesting, and slightly off I think:
> Again, we are only talking about the case when there's
> *no*
> default library location specified for package
> *installation*.
> 
> HOWEVER,
> the case I mentioned, where I have scenarios where I was
> able to
> use
>     'R_LIBS=...:...:....  R CMD check
> <mypkg>'
> 
> using non-default library locations, not for installation
> (because that would be  <mypkg>.Rcheck 
> anyway), but for
> searching of package *dependencies* of <mypkg>
> is also something that has stopped working in the current
> R-devel, because it uses our site-wide Rprofile and that
> sets
> R_LIBS differently itself.
> 
> --
> 
> Anyway, I think it would not be a bad course to still
> *allow* 
> "vanilla-INSTALL"  but keep the current R-devel
> default
> behavior.
> But maybe we can find something better.
> (and hopefully other R core members will explain more
> clearly
>  why they think it was "the correct" default behavior to
> obey
>  site-wide and user-specific  Rprofile 
> settings)

But there is always a shipped default? $R_HOME/library , and I seem to recall for non-admin users, $HOME/R/<arch> . .libPath() is $R_HOME/library on R --vanilla .

If the user or site admin choose a configuration to prepend .libPath() with a customization via Rprofile/R_LIBS, it stands to reason that he/she should also do -l for installation? (or rather, it should happen the other way round - if one choose to install, *consciously*, elsewhere than the default, than Rprofile/R_LIBS is required)

Nonetheless, I think we are drifting a little. the original problem was that it is not possible to upgrade/overwrite a package and its associated resources like its namespace when that package is loaded. Maybe the correct solution is to unload the said package, unregister the dlls/shared-libraries, and unload a namespace  on installation. I seem to recall that there are some issues about dll unloading on windows, but that's a technicality... 






From ligges at statistik.tu-dortmund.de  Thu Jul 30 13:14:59 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 30 Jul 2009 13:14:59 +0200
Subject: [Rd] R --vanilla for install/remove/shlib(Re: R 2.8->2.9 change
 that breaks some upgrade scenarios)
In-Reply-To: <283713.36119.qm@web23101.mail.ird.yahoo.com>
References: <283713.36119.qm@web23101.mail.ird.yahoo.com>
Message-ID: <4A7180B3.1000305@statistik.tu-dortmund.de>



Hin-Tak Leung wrote:
> --- On Thu, 30/7/09, Martin Maechler <maechler at stat.math.ethz.ch> wrote:
> 
>>>>>>> "HL" == Hin-Tak
>> Leung <hintak_leung at yahoo.co.uk>
>>>>>>>     on Thu, 30 Jul
>> 2009 08:59:01 +0000 (GMT) writes:
>>
>>     HL> --- On Thu, 30/7/09, Martin Maechler
>> <maechler at stat.math.ethz.ch>
>> wrote:
>>     >> I'm not sure this addresses all the
>> problems that your
>>     >> patch
>>     >> tried to fix,
>>     >> but in any case, your patch
>> re-installing the --vanilla
>>     >> behavior
>>     >> unconditionally (without the
>> .libPaths()[1] detection) was
>>     >> not 
>>     >> suffificient.
>>
>>     HL> But I think .libPaths should not be
>> _implicitly_ user-/site- overridded - afterall, non-standard
>> locations are already catered for with the -l option (which
>> presumbably does the same thing as declaring R_LIBS, just
>> explicitly).
>>
>> We are talking *only* about the case where no '-l' (or
>> 'lib.loc') was specified, and the default has always been
>> to
>> take the first entry in  .libPaths() .... [ with all
>> its
>> problems when that is not writable, but that's a different
>> story]
>>
>>
>>     HL> This is analogous to installing system
>> libraries and run-time relocation - while people do install
>> binaries and libraries in non-standard locations and
>> customize their $PATH and $LD_LIBRARY_PATH to reflect that
>> either at the user- or site- level, it would be quite
>> strange to allow ./configure or other equivalent software
>> building tools to peek at the first part of PATH or
>> LD_LIBRARY_PATH and put executables in the former and
>> libraries in the latter... That's almost anarchy :-).
>>
>> The comparison is interesting, and slightly off I think:
>> Again, we are only talking about the case when there's
>> *no*
>> default library location specified for package
>> *installation*.
>>
>> HOWEVER,
>> the case I mentioned, where I have scenarios where I was
>> able to
>> use
>>     'R_LIBS=...:...:....  R CMD check
>> <mypkg>'
>>
>> using non-default library locations, not for installation
>> (because that would be  <mypkg>.Rcheck 
>> anyway), but for
>> searching of package *dependencies* of <mypkg>
>> is also something that has stopped working in the current
>> R-devel, because it uses our site-wide Rprofile and that
>> sets
>> R_LIBS differently itself.
>>
>> --
>>
>> Anyway, I think it would not be a bad course to still
>> *allow* 
>> "vanilla-INSTALL"  but keep the current R-devel
>> default
>> behavior.
>> But maybe we can find something better.
>> (and hopefully other R core members will explain more
>> clearly
>>  why they think it was "the correct" default behavior to
>> obey
>>  site-wide and user-specific  Rprofile 
>> settings)
> 
> But there is always a shipped default? $R_HOME/library , and I seem to recall for non-admin users, $HOME/R/<arch> . .libPath() is $R_HOME/library on R --vanilla .
> 
> If the user or site admin choose a configuration to prepend .libPath() with a customization via Rprofile/R_LIBS, it stands to reason that he/she should also do -l for installation? (or rather, it should happen the other way round - if one choose to install, *consciously*, elsewhere than the default, than Rprofile/R_LIBS is required)
> 
> Nonetheless, I think we are drifting a little. the original problem was that it is not possible to upgrade/overwrite a package and its associated resources like its namespace when that package is loaded. Maybe the correct solution is to unload the said package, unregister the dlls/shared-libraries, and unload a namespace  on installation. I seem to recall that there are some issues about dll unloading on windows, but that's a technicality... 

... that cannot be solved easily while we try to make R behave as 
similar as possible on all platforms in order to simplify 
maintainability of the code.

Uwe Ligges



> 
> 
> 
> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From cgb at datanalytics.com  Thu Jul 30 13:33:38 2009
From: cgb at datanalytics.com (Carlos J. Gil Bellosta )
Date: Thu, 30 Jul 2009 13:33:38 +0200
Subject: [Rd] Checking package on Windows (and seemingly irreproducible
	errors in CRAN checks)
In-Reply-To: <4A706CEE.6060603@statistik.tu-dortmund.de>
References: <1248813071.4657.18.camel@kropotkin>
	<1248815669.30084.15.camel@ubuntu>
	<4A706CEE.6060603@statistik.tu-dortmund.de>
Message-ID: <b028350f0907300433i52f672a8scb0561f55082ec6b@mail.gmail.com>

Dear Uwe,

The thing that I find funny is that the check of the package on
Windows for R 2.10.x works on r-forge as you can see here:

http://r-forge.r-project.org/R/?group_id=426&log=check_x86_32_windows&pkg=colbycol&flavor=devel

May I be facing some kind of Windows configuration specific issue
here? I am sorry that I am very Windows-illiterate...

This is not something that worries me much "per se", as I am
implementing some changes in the package and the new version does not
resemble the current one too much, but intrigues me quite a lot.

Best regards,

Carlos J. Gil Bellosta
http://www.datanalytics.com


2009/7/29 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>
>
> Mathieu Ribatet wrote:
>>
>> Dear Carlos,
>>
>>> From your check results:
>>
>> ? ? ? ?cbc.data <- cbc.read.table( system.file("data",
>> ? ? ? ?"cbc.test.data.txt", package = "colbycol"), sep = "\t" )
>> ? ? ? ? ? ? ? ?Warning in file(file, "r") :
>> ? ? ? ? ? ? ? ?cannot open file '0001': No such file or directory
>> ? ? ? ?I think you're trying to read the file "cbc.test.data.txt" located
>> in
>> the folder "data" of your package skeleton. Is that right? If so, maybe
>> using
>>
>> ? ? ? ?paste(system.file(package = "colbycol"),
>> ? ? ? ?"data/cbc.test.data.txt", sep="/")
>> ? ? ? ?will solve your issue - although I didn't try.
>
>
> It won't slve it, because reading that file works, but reading file "0001"
> does ot which is handled within cbc.read.table() in the lines
>
> ....
> ?for( column in names(columns) ){
> ? ? ? ?tmp <- read.table( columns[[column]]$filename, sep = sep, na.strings
> = "", comment.char = "", quote = "", header = FALSE, ... )[,1]
> ....
>
>
> I guess the problem happens before during the Java stuff where the 0001 file
> is never created (at least not in the location you expect).
>
>
> On the console I see error messages like
>
>
> Exception in thread "main" Traceback (most recent call last):
> ?File "d:/temp/colbycol/python/colbycol.py", line 6, in <module>
> ? ?os.chdir( work_dir )
> ?File "D:\RCompile\CRANpkg\lib\2.9\rSymPy\jython\Lib\os.py", line 261, in
> chdir
> ? ?raise OSError(errno.ENOENT, strerror(errno.ENOENT), path)
> OSError: [Errno 2] No such file or directory:
> 'd:/temp/Rtmp1mB6qg/dir72ae2cd6'
>
>
> Best,
> Uwe Ligges
>
>


From ligges at statistik.tu-dortmund.de  Thu Jul 30 13:38:46 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 30 Jul 2009 13:38:46 +0200
Subject: [Rd] Checking package on Windows (and seemingly irreproducible
In-Reply-To: <b028350f0907300433i52f672a8scb0561f55082ec6b@mail.gmail.com>
References: <1248813071.4657.18.camel@kropotkin>	
	<1248815669.30084.15.camel@ubuntu>	
	<4A706CEE.6060603@statistik.tu-dortmund.de>
	<b028350f0907300433i52f672a8scb0561f55082ec6b@mail.gmail.com>
Message-ID: <4A718646.8070106@statistik.tu-dortmund.de>



Carlos J. Gil Bellosta wrote:
> Dear Uwe,
> 
> The thing that I find funny is that the check of the package on
> Windows for R 2.10.x works on r-forge as you can see here:
> 
> http://r-forge.r-project.org/R/?group_id=426&log=check_x86_32_windows&pkg=colbycol&flavor=devel
> 
> May I be facing some kind of Windows configuration specific issue
> here? I am sorry that I am very Windows-illiterate...
> 
> This is not something that worries me much "per se", as I am
> implementing some changes in the package and the new version does not
> resemble the current one too much, but intrigues me quite a lot.



Well, you said that it works on R-forge, but it does not on my build 
system.
What would help more is if you could specify what the requirements for 
your package are that made it work on R-forge. Specific version of Java, 
Phython, ...???

Best,
Uwe Ligges


> Best regards,
> 
> Carlos J. Gil Bellosta
> http://www.datanalytics.com
> 
> 
> 2009/7/29 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>>
>> Mathieu Ribatet wrote:
>>> Dear Carlos,
>>>
>>>> From your check results:
>>>        cbc.data <- cbc.read.table( system.file("data",
>>>        "cbc.test.data.txt", package = "colbycol"), sep = "\t" )
>>>                Warning in file(file, "r") :
>>>                cannot open file '0001': No such file or directory
>>>        I think you're trying to read the file "cbc.test.data.txt" located
>>> in
>>> the folder "data" of your package skeleton. Is that right? If so, maybe
>>> using
>>>
>>>        paste(system.file(package = "colbycol"),
>>>        "data/cbc.test.data.txt", sep="/")
>>>        will solve your issue - although I didn't try.
>>
>> It won't slve it, because reading that file works, but reading file "0001"
>> does ot which is handled within cbc.read.table() in the lines
>>
>> ....
>>  for( column in names(columns) ){
>>        tmp <- read.table( columns[[column]]$filename, sep = sep, na.strings
>> = "", comment.char = "", quote = "", header = FALSE, ... )[,1]
>> ....
>>
>>
>> I guess the problem happens before during the Java stuff where the 0001 file
>> is never created (at least not in the location you expect).
>>
>>
>> On the console I see error messages like
>>
>>
>> Exception in thread "main" Traceback (most recent call last):
>>  File "d:/temp/colbycol/python/colbycol.py", line 6, in <module>
>>    os.chdir( work_dir )
>>  File "D:\RCompile\CRANpkg\lib\2.9\rSymPy\jython\Lib\os.py", line 261, in
>> chdir
>>    raise OSError(errno.ENOENT, strerror(errno.ENOENT), path)
>> OSError: [Errno 2] No such file or directory:
>> 'd:/temp/Rtmp1mB6qg/dir72ae2cd6'
>>
>>
>> Best,
>> Uwe Ligges
>>
>>


From simon.urbanek at r-project.org  Thu Jul 30 15:19:08 2009
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 30 Jul 2009 09:19:08 -0400
Subject: [Rd] Checking package on Windows (and seemingly irreproducible
	errors in CRAN checks)
In-Reply-To: <b028350f0907300433i52f672a8scb0561f55082ec6b@mail.gmail.com>
References: <1248813071.4657.18.camel@kropotkin>
	<1248815669.30084.15.camel@ubuntu>
	<4A706CEE.6060603@statistik.tu-dortmund.de>
	<b028350f0907300433i52f672a8scb0561f55082ec6b@mail.gmail.com>
Message-ID: <0D974D52-1C6C-4CF4-8E8B-94CB48F8C2E3@r-project.org>


On Jul 30, 2009, at 7:33 , Carlos J. Gil Bellosta wrote:

> Dear Uwe,
>
> The thing that I find funny is that the check of the package on
> Windows for R 2.10.x works on r-forge as you can see here:
>
> http://r-forge.r-project.org/R/?group_id=426&log=check_x86_32_windows&pkg=colbycol&flavor=devel
>
> May I be facing some kind of Windows configuration specific issue
> here? I am sorry that I am very Windows-illiterate...
>

Just from the plain output I suspect that the problem is handling of  
paths in the 3rd party system used (Python) is different from R's on  
Windows and the package author is not converting them properly. It  
seems as if Python is trying to use the path 'd:/temp/Rtmp1mB6qg/ 
dir72ae2cd6' literally instead of using 'd:\temp\Rtmp1mB6qg 
\dir72ae2cd6'. I'm a bit surprised, because Java does the right thing:  
System.out.println("'"+(new File("z:/foo/bar"))+"'"); will print  
correctly 'z:\foo\bar'.

I would suspect that the difference between R-Forge and CRAN may  
probably be just the setting of TMP/TEMP... [just a guess ;)]

Cheers,
Simon


> This is not something that worries me much "per se", as I am  
> implementing some changes in the package and the new version does  
> not resemble the current one too much, but intrigues me quite a lot.
>
> Best regards,
>
> Carlos J. Gil Bellosta
> http://www.datanalytics.com
>
>
> 2009/7/29 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>>
>>
>> Mathieu Ribatet wrote:
>>>
>>> Dear Carlos,
>>>
>>>> From your check results:
>>>
>>>        cbc.data <- cbc.read.table( system.file("data",
>>>        "cbc.test.data.txt", package = "colbycol"), sep = "\t" )
>>>                Warning in file(file, "r") :
>>>                cannot open file '0001': No such file or directory
>>>        I think you're trying to read the file "cbc.test.data.txt"  
>>> located
>>> in
>>> the folder "data" of your package skeleton. Is that right? If so,  
>>> maybe
>>> using
>>>
>>>        paste(system.file(package = "colbycol"),
>>>        "data/cbc.test.data.txt", sep="/")
>>>        will solve your issue - although I didn't try.
>>
>>
>> It won't slve it, because reading that file works, but reading file  
>> "0001"
>> does ot which is handled within cbc.read.table() in the lines
>>
>> ....
>>  for( column in names(columns) ){
>>        tmp <- read.table( columns[[column]]$filename, sep = sep,  
>> na.strings
>> = "", comment.char = "", quote = "", header = FALSE, ... )[,1]
>> ....
>>
>>
>> I guess the problem happens before during the Java stuff where the  
>> 0001 file
>> is never created (at least not in the location you expect).
>>
>>
>> On the console I see error messages like
>>
>>
>> Exception in thread "main" Traceback (most recent call last):
>>  File "d:/temp/colbycol/python/colbycol.py", line 6, in <module>
>>    os.chdir( work_dir )
>>  File "D:\RCompile\CRANpkg\lib\2.9\rSymPy\jython\Lib\os.py", line  
>> 261, in
>> chdir
>>    raise OSError(errno.ENOENT, strerror(errno.ENOENT), path)
>> OSError: [Errno 2] No such file or directory:
>> 'd:/temp/Rtmp1mB6qg/dir72ae2cd6'
>>
>>
>> Best,
>> Uwe Ligges
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From ross at biostat.ucsf.edu  Thu Jul 30 18:51:45 2009
From: ross at biostat.ucsf.edu (Ross Boylan)
Date: Thu, 30 Jul 2009 09:51:45 -0700
Subject: [Rd] user supplied random number generators
In-Reply-To: <85EC2769-AFC0-4C15-ADCB-02F4EB87FD73@gmail.com>
References: <1248934873.18270.83.camel@corn.betterworld.us>
	<85EC2769-AFC0-4C15-ADCB-02F4EB87FD73@gmail.com>
Message-ID: <1248972705.18270.88.camel@corn.betterworld.us>

On Thu, 2009-07-30 at 12:32 +0200, Christophe Dutang wrote:
> > This suggests that the type of user_unif_seedloc is Int32*, not int
> *.
> > It also suggests that user_unif_nseed should return the number of
> 32  
> > bit
> > integers.  The code for PutRNGstate(), for example, uses them in
> just
> > that way.
> >
> > While the dominant model, even on 64 bit hardware, is probably to  
> > leave
> > int as 32 bit, it doesn't seem wise to assume that is always the
> case.
> 
> You can test the size of an int with a configure script. see for  
> example the package foreign, the package randtoolbox (can be found
> in  
> Rmetrics R forge project) I maintain with Petr Savicky.
http://cran.r-project.org/doc/manuals/R-admin.html#Choosing-between-32_002d-and-64_002dbit-builds says "All current versions of R use 32-bit integers".

Also, sizeof(int) works at runtime.  But my question was really about
whether code for user defined RNGs should be written using Int32 or int
as the target type for the state vector.  The R core code suggests to me
one should use Int32, but the documentation says int.

Ross


From mtmorgan at fhcrc.org  Thu Jul 30 18:52:17 2009
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Thu, 30 Jul 2009 09:52:17 -0700
Subject: [Rd] RFC: methods() and showMethods() {was "debug"}
In-Reply-To: <19056.6252.321949.632481@lynne.math.ethz.ch> (Martin
	Maechler's message of "Wed, 29 Jul 2009 11:37:48 +0200")
References: <19056.6252.321949.632481@lynne.math.ethz.ch>
Message-ID: <6phvdlanmf2.fsf@gopher4.fhcrc.org>

Martin Maechler <maechler at stat.math.ethz.ch> writes:

>        (a new thread, on purpose)
>
>>>>>> "RobG" == Robert Gentleman <rgentlem at fhcrc.org>
>>>>>>     on Mon, 27 Jul 2009 16:55:50 -0700 writes:
>
>     RobG> Hi, I just committed a change to R-devel so that if
>     RobG> debug is called on an S3 generic function, all methods
>     RobG> will also automatically have debug turned on for them
>     RobG> (if they are dispatched to from the generic).
>
> very nice.
>
>     RobG>    I hope to be able to extend this to S4 and a few
>     RobG> other cases that are currently not being handled over
>     RobG> the next few weeks.
>
> that (S4) will be very useful for me, thank you in advance,
> Robert!
>
> A somewhat related issue:
> As many of the R-devel readers will know, there has been quite
> a nice ongoing effort to make S3 and S4 methods and classes more
> compatible.
> One issue here, notably for inexperienced programmeRs,
> is also the fact that
> methods(f) only tells about S3-methods for 'f',
> and showMethods(f) only mentions S4 ones.
> This is not at all design error, as indeed S3 and S4 dispatch is quite
> different (notably as the latter allows multiple dispatch and
> hence uses the nice concept of "signature"),
> used to be more incompatible and, indeed,  methods(f) *still*
> warns, often wrongly, if it finds that f is a (S4) generic function.
>
> As this is an RFC, let me just make a few more propositional
> points, and we (R core) will be happy to receive constructive
> feedback from outside the core team as well.
>
> Propositions / Ideas :
> [ Using the example of having Matrix: 
>   library(Matrix)
> ]
>
> 1) methods(f) should become a bit smarter when it sees that f is
>    an S4 generic,  and not say,  e.g., for  
>
>   >  methods(qr)
>   ...
>    'qr' is a formal generic function; S3 methods will not likely be found
>   ...
>
>   but rather at least "look" to see if there's an "ANY" method containing
>   UseMethod() (*1), 
>
> 2) and if there is, or maybe in any case, methods() should then
>    also call showMethods() to show the S4 methods;
>    or it would suggest the to user to call  'showMethods(..)'
>
> 3) showMethods(.) : It could/should  
>   a) look for S3 dispatch symptoms such as
>      UseMethod(.) in its "ANY" methods
>   b) call methods() in any case
>
>   and then possibly mention the result of methods() in any case,
>   *plus* ... that's probably the most difficult part ... 
>   warn if there are S3 methods {as per 'b)'} that seem not be
>   called at all {as per a)}, but that would also have to
>   consider .Primitive s with C internal (S3 and S4) dispatch.
>

Hi Martin --

A couple of thoughts on showMethods and methods, as a preamble.

1. It would be great if showMethods() returned an S4 object so that its
output could be used in a programmatic way.

2. If I

  library(Biobase); library(Matrix)
  showMethods(class="sparseMatrix")

I end up with entries like

  Function "selectSomeIndex":
    <not a generic function>
 
where selectSomeIndex is an unexported generic from Biobase. So it
would be helpful to clarify the output here, probably restricting
methods to those visible to the caller of showMethods.

3. showMethods allows the user to restrict the search to generics
defined in a particular name space, which can be useful.

4. showMethods has an includeDefs argument, which can also be useful
as a shortcut to constructing a second call (to getMethod or
selectMethod) with a potentially complicated argument list to specify
exactly the method to get.

5. methods() reports that 'Non-visible functions are asterisked' but
might provide additional information on how to access these
non-visible functions (e.g., getAnywhere, though here name spaces
might become important).

6. methods(print, "tukeyline") returning all print methods, but not
residuals.tukeyline. I think the behavior one wants is like
showMethods, the intersection of print methods relevant to class
tukeyline.

In terms of the original prompt about methods() functionality, it
would seem that looking for S4 methods, regardless of an ANY-method
would be 'good' since one use case is to understand object
dispatch. Point 1 makes us want to have an object to manipulate, and
then we must decide between S3 and S4 representation, and S4 probably
wins because of the greater flexibility. This might not be palatable to
all, perhaps leading to a smarter methods returning an S3 object and a
smarter showMethods returning an S4 object.

I wonder whether the functionality typically desired by users of
methods() is more analogous to selectMethod, i.e., find and display
the method that my object will be dispatched to, which is related to
4 and 6, above.

Martin

> As you see, these are partly concrete proposals, partly just
> ideas, asking for feedback, from you, experienced 
> programmeRs, ...
>
> Martin Maechler, ETH Zurich
>
>
> ---
> *1) as there will always be if the  S4 methods
>     have been setup properly and *after* the S3 ones.
>   This will typically be the case for situations when there are
>   old traditional S3 methods in "base R", and a package adds new
>   modern S4 methods.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M1 B861
Phone: (206) 667-2793


From cgb at datanalytics.com  Thu Jul 30 19:07:07 2009
From: cgb at datanalytics.com (Carlos J. Gil Bellosta )
Date: Thu, 30 Jul 2009 19:07:07 +0200
Subject: [Rd] Checking package on Windows (and seemingly irreproducible
	errors in CRAN checks)
In-Reply-To: <0D974D52-1C6C-4CF4-8E8B-94CB48F8C2E3@r-project.org>
References: <1248813071.4657.18.camel@kropotkin>
	<1248815669.30084.15.camel@ubuntu>
	<4A706CEE.6060603@statistik.tu-dortmund.de>
	<b028350f0907300433i52f672a8scb0561f55082ec6b@mail.gmail.com>
	<0D974D52-1C6C-4CF4-8E8B-94CB48F8C2E3@r-project.org>
Message-ID: <b028350f0907301007g74f8a036y3fea213614ddbf65@mail.gmail.com>

Hello,

The issue is no longer an issue concerning my package as I have
changed the part that drives the error (for unrelated reasons).

It is true that I might have done a greater effort to make the package
fully cross-platform. I did R-CMD-checks on Unbuntu and CentOS but
never on Windows. But I did install the package on Windows and
successfully run, among other, the examples that fail on CRAN servers.

What makes me curious about Windows is how can it be that the checks
pass on some machines (r-forge?s) but fail on CRAN?s. If there were
any blunt violation of cross-platform implementation practices, all
Windows checks would fail. However, some succeed.

Perhaps this is an idle intellectual exercise. But one can probably
ask himself the following two questions:

1) If I R-CMD-check my package on _my_ Windows box, how can I be sure
that the check will also succeed in other Windows box?

2) Is there any lesson to learn concerning cross-platform
implementation to learn from this case (there seems to be and I am
learning it, by the way).

Best regards and thank you for your comments on this issue.

Carlos J. Gil Bellosta
http://www.datanalytics.com


2009/7/30 Simon Urbanek <simon.urbanek at r-project.org>:
>
> On Jul 30, 2009, at 7:33 , Carlos J. Gil Bellosta wrote:
>
>> Dear Uwe,
>>
>> The thing that I find funny is that the check of the package on
>> Windows for R 2.10.x works on r-forge as you can see here:
>>
>>
>> http://r-forge.r-project.org/R/?group_id=426&log=check_x86_32_windows&pkg=colbycol&flavor=devel
>>
>> May I be facing some kind of Windows configuration specific issue
>> here? I am sorry that I am very Windows-illiterate...
>>
>
> Just from the plain output I suspect that the problem is handling of paths
> in the 3rd party system used (Python) is different from R's on Windows and
> the package author is not converting them properly. It seems as if Python is
> trying to use the path 'd:/temp/Rtmp1mB6qg/dir72ae2cd6' literally instead of
> using 'd:\temp\Rtmp1mB6qg\dir72ae2cd6'. I'm a bit surprised, because Java
> does the right thing: System.out.println("'"+(new File("z:/foo/bar"))+"'");
> will print correctly 'z:\foo\bar'.
>
> I would suspect that the difference between R-Forge and CRAN may probably be
> just the setting of TMP/TEMP... [just a guess ;)]
>
> Cheers,
> Simon
>
>
>> This is not something that worries me much "per se", as I am implementing
>> some changes in the package and the new version does not resemble the
>> current one too much, but intrigues me quite a lot.
>>
>> Best regards,
>>
>> Carlos J. Gil Bellosta
>> http://www.datanalytics.com
>>
>>
>> 2009/7/29 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>>>
>>>
>>> Mathieu Ribatet wrote:
>>>>
>>>> Dear Carlos,
>>>>
>>>>> From your check results:
>>>>
>>>> ? ? ? cbc.data <- cbc.read.table( system.file("data",
>>>> ? ? ? "cbc.test.data.txt", package = "colbycol"), sep = "\t" )
>>>> ? ? ? ? ? ? ? Warning in file(file, "r") :
>>>> ? ? ? ? ? ? ? cannot open file '0001': No such file or directory
>>>> ? ? ? I think you're trying to read the file "cbc.test.data.txt" located
>>>> in
>>>> the folder "data" of your package skeleton. Is that right? If so, maybe
>>>> using
>>>>
>>>> ? ? ? paste(system.file(package = "colbycol"),
>>>> ? ? ? "data/cbc.test.data.txt", sep="/")
>>>> ? ? ? will solve your issue - although I didn't try.
>>>
>>>
>>> It won't slve it, because reading that file works, but reading file
>>> "0001"
>>> does ot which is handled within cbc.read.table() in the lines
>>>
>>> ....
>>> ?for( column in names(columns) ){
>>> ? ? ? tmp <- read.table( columns[[column]]$filename, sep = sep,
>>> na.strings
>>> = "", comment.char = "", quote = "", header = FALSE, ... )[,1]
>>> ....
>>>
>>>
>>> I guess the problem happens before during the Java stuff where the 0001
>>> file
>>> is never created (at least not in the location you expect).
>>>
>>>
>>> On the console I see error messages like
>>>
>>>
>>> Exception in thread "main" Traceback (most recent call last):
>>> ?File "d:/temp/colbycol/python/colbycol.py", line 6, in <module>
>>> ? os.chdir( work_dir )
>>> ?File "D:\RCompile\CRANpkg\lib\2.9\rSymPy\jython\Lib\os.py", line 261, in
>>> chdir
>>> ? raise OSError(errno.ENOENT, strerror(errno.ENOENT), path)
>>> OSError: [Errno 2] No such file or directory:
>>> 'd:/temp/Rtmp1mB6qg/dir72ae2cd6'
>>>
>>>
>>> Best,
>>> Uwe Ligges
>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
>


From wdunlap at tibco.com  Thu Jul 30 20:23:41 2009
From: wdunlap at tibco.com (William Dunlap)
Date: Thu, 30 Jul 2009 11:23:41 -0700
Subject: [Rd] user supplied random number generators
In-Reply-To: <1248972705.18270.88.camel@corn.betterworld.us>
References: <1248934873.18270.83.camel@corn.betterworld.us><85EC2769-AFC0-4C15-ADCB-02F4EB87FD73@gmail.com>
	<1248972705.18270.88.camel@corn.betterworld.us>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D700018AF22C@NA-PA-VBE03.na.tibco.com>

src/arithmetic.c will not compile if ints are not 32 bits and I suspect
that there is other code that will not work correctly if ints are not
32 bits
   src/arithmetic.c:
    574 #ifndef INT_32_BITS
    575 /* configure checks whether int is 32 bits.  If not this code
will
    576    need to be rewritten.  Since 32 bit ints are pretty much
universal,
    577    we can worry about writing alternate code when the need
arises.
    578    To be safe, we signal a compiler error if int is not 32 bits.
*/
    579 # error code requires that int have 32 bits
    580 #else
http://www.unix.org/version2/whatsnew/lp64_wp.html is rather old
but says that keeping int at 32 bits is the way to go for the forseeable
future.

I would recommend using Int32, as it makes the intent clearer.  The
seed does not need to be stored as nseed Sint's (the C type used to
store R/S/S+ integers: int in R, long in S and S+) but as nseed Int32's.

When I implemented this interface in S+ I used unsigned 32-bit ints
internally, so they would not suffer sign extension when naively
converted to the (signed) longs S+ uses for integer datsets like
.Random.seed.

Bill Dunlap
TIBCO Software Inc - Spotfire Division
wdunlap tibco.com  

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Ross Boylan
> Sent: Thursday, July 30, 2009 9:52 AM
> To: Christophe Dutang
> Cc: R-devel
> Subject: Re: [Rd] user supplied random number generators
> 
> On Thu, 2009-07-30 at 12:32 +0200, Christophe Dutang wrote:
> > > This suggests that the type of user_unif_seedloc is 
> Int32*, not int
> > *.
> > > It also suggests that user_unif_nseed should return the number of
> > 32  
> > > bit
> > > integers.  The code for PutRNGstate(), for example, uses them in
> > just
> > > that way.
> > >
> > > While the dominant model, even on 64 bit hardware, is 
> probably to  
> > > leave
> > > int as 32 bit, it doesn't seem wise to assume that is always the
> > case.
> > 
> > You can test the size of an int with a configure script. see for  
> > example the package foreign, the package randtoolbox (can be found
> > in  
> > Rmetrics R forge project) I maintain with Petr Savicky.
> http://cran.r-project.org/doc/manuals/R-admin.html#Choosing-be
> tween-32_002d-and-64_002dbit-builds says "All current 
> versions of R use 32-bit integers".
> 
> Also, sizeof(int) works at runtime.  But my question was really about
> whether code for user defined RNGs should be written using 
> Int32 or int
> as the target type for the state vector.  The R core code 
> suggests to me
> one should use Int32, but the documentation says int.
> 
> Ross
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From dutangc at gmail.com  Thu Jul 30 21:43:09 2009
From: dutangc at gmail.com (Christophe Dutang)
Date: Thu, 30 Jul 2009 21:43:09 +0200
Subject: [Rd] rowSums, rowMean and rowCumSums?
Message-ID: <F6AF81E1-11C1-4343-B20D-1979B6945F38@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090730/51dd75ea/attachment.pl>

From sdorairaj at gmail.com  Thu Jul 30 23:28:19 2009
From: sdorairaj at gmail.com (Sundar Dorai-Raj)
Date: Thu, 30 Jul 2009 14:28:19 -0700
Subject: [Rd] update.formula and backticked colons
Message-ID: <c9ce82b00907301428y698e401by2c3334b41ff7fc4c@mail.gmail.com>

I just noticed the following in update.formula and I'm wondering if
this behavior is the intention of the developers. Here's an example:

update(`a: b` ~ x, ~ . + y)

Note now that the response has no backticks and is interpreted as a:b
(i.e. ":" is now an operator). This is because in update.formula the
call to terms.formula uses simplify = TRUE. I'm working with data that
has a lot of colons in their names and for reporting purposes I don't
want to use make.names to avoid this situation. I do have a solution
which simply avoids using update.formula, but I wonder if the
developers would consider removing the "simplify" argument and allow
it to be passed through "...", which is currently ignored by
update.formula. Alternatively, add a simplify=TRUE to the
update.formula call, which can manually be set to FALSE by the user.

I would love to hear any comments or criticisms of my findings.

Thanks,

--sundar


From sdorairaj at gmail.com  Thu Jul 30 23:30:27 2009
From: sdorairaj at gmail.com (Sundar Dorai-Raj)
Date: Thu, 30 Jul 2009 14:30:27 -0700
Subject: [Rd] update.formula and backticked colons
In-Reply-To: <c9ce82b00907301428y698e401by2c3334b41ff7fc4c@mail.gmail.com>
References: <c9ce82b00907301428y698e401by2c3334b41ff7fc4c@mail.gmail.com>
Message-ID: <c9ce82b00907301430p1186243eq7f79cb503d8919ae@mail.gmail.com>

On Thu, Jul 30, 2009 at 2:28 PM, Sundar Dorai-Raj<sdorairaj at gmail.com> wrote:
> I just noticed the following in update.formula and I'm wondering if
> this behavior is the intention of the developers. Here's an example:
>
> update(`a: b` ~ x, ~ . + y)
>
> Note now that the response has no backticks and is interpreted as a:b
> (i.e. ":" is now an operator). This is because in update.formula the
> call to terms.formula uses simplify = TRUE. I'm working with data that
> has a lot of colons in their names and for reporting purposes I don't
> want to use make.names to avoid this situation. I do have a solution
> which simply avoids using update.formula, but I wonder if the
> developers would consider removing the "simplify" argument and allow
> it to be passed through "...", which is currently ignored by
> update.formula. Alternatively, add a simplify=TRUE to the
> update.formula call, which can manually be set to FALSE by the user.
>
> I would love to hear any comments or criticisms of my findings.
>
> Thanks,
>
> --sundar
>

Forgot my version info

> version
               _
platform       x86_64-unknown-linux-gnu
arch           x86_64
os             linux-gnu
system         x86_64, linux-gnu
status
major          2
minor          9.1
year           2009
month          06
day            26
svn rev        48839
language       R
version.string R version 2.9.1 (2009-06-26)


From mark.thyer at newcastle.edu.au  Fri Jul 31 01:25:06 2009
From: mark.thyer at newcastle.edu.au (Mark Thyer)
Date: Fri, 31 Jul 2009 09:25:06 +1000
Subject: [Rd] What changed in the R Windows interface from v2.6.2 to v2.7.0?
Message-ID: <FB2B3A529AB544F5A3A396BBD21D4809@civsurvenv.engbe.uncle.newcastle.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20090731/1121b541/attachment.pl>

From felix at nfrac.org  Fri Jul 31 09:27:06 2009
From: felix at nfrac.org (Felix Andrews)
Date: Fri, 31 Jul 2009 17:27:06 +1000
Subject: [Rd] rowSums, rowMean and rowCumSums?
In-Reply-To: <F6AF81E1-11C1-4343-B20D-1979B6945F38@gmail.com>
References: <F6AF81E1-11C1-4343-B20D-1979B6945F38@gmail.com>
Message-ID: <94730b8a0907310027q57fe1d08u30147156a0e00bec@mail.gmail.com>

Hi,
you can compute cumsums for each row with
t(apply(x, 1, cumsum))
As this is a simple, direct implementation, I see no reason to make it
a named function.

Cheers
-Felix


2009/7/31 Christophe Dutang <dutangc at gmail.com>:
> Dear list,
>
> Don't you think it could be useful to have in R base a function
> rowCumSums, that compute cumulative sums for each row of a matrix?
>
> My implementation of rowCumSums is
>
> rowCumSums <- function(x) t(mapply(function(row)cumsum(x[row,]),
> 1:NROW(x)))
>
> I'm sure it can be improved to have other arguments like na.rm or dims.
>
> Is there any hope to have this function in R?
>
> Christophe
>
> --
> Christophe Dutang
> Ph.D. student at ISFA, Lyon, France
> website: http://dutangc.free.fr
>
>
>
>
>
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Felix Andrews / ???
Postdoctoral Fellow
Integrated Catchment Assessment and Management (iCAM) Centre
Fenner School of Environment and Society [Bldg 48a]
The Australian National University
Canberra ACT 0200 Australia
M: +61 410 400 963
T: + 61 2 6125 1670
E: felix.andrews at anu.edu.au
CRICOS Provider No. 00120C
-- 
http://www.neurofractal.org/felix/


From ligges at statistik.tu-dortmund.de  Fri Jul 31 13:36:18 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 31 Jul 2009 13:36:18 +0200
Subject: [Rd] Checking package on Windows (and seemingly irreproducible
 errors in CRAN checks)
In-Reply-To: <0D974D52-1C6C-4CF4-8E8B-94CB48F8C2E3@r-project.org>
References: <1248813071.4657.18.camel@kropotkin>
	<1248815669.30084.15.camel@ubuntu>
	<4A706CEE.6060603@statistik.tu-dortmund.de>
	<b028350f0907300433i52f672a8scb0561f55082ec6b@mail.gmail.com>
	<0D974D52-1C6C-4CF4-8E8B-94CB48F8C2E3@r-project.org>
Message-ID: <4A72D732.2060701@statistik.tu-dortmund.de>



Simon Urbanek wrote:
> 
> On Jul 30, 2009, at 7:33 , Carlos J. Gil Bellosta wrote:
> 
>> Dear Uwe,
>>
>> The thing that I find funny is that the check of the package on
>> Windows for R 2.10.x works on r-forge as you can see here:
>>
>> http://r-forge.r-project.org/R/?group_id=426&log=check_x86_32_windows&pkg=colbycol&flavor=devel 
>>
>>
>> May I be facing some kind of Windows configuration specific issue
>> here? I am sorry that I am very Windows-illiterate...
>>
> 
> Just from the plain output I suspect that the problem is handling of 
> paths in the 3rd party system used (Python) is different from R's on 
> Windows and the package author is not converting them properly. It seems 
> as if Python is trying to use the path 'd:/temp/Rtmp1mB6qg/dir72ae2cd6' 
> literally instead of using 'd:\temp\Rtmp1mB6qg\dir72ae2cd6'. I'm a bit 
> surprised, because Java does the right thing: 
> System.out.println("'"+(new File("z:/foo/bar"))+"'"); will print 
> correctly 'z:\foo\bar'.
> 
> I would suspect that the difference between R-Forge and CRAN may 
> probably be just the setting of TMP/TEMP... [just a guess ;)]


Good idea. Unfortunately, changing d:\temp to d:/temp in my setting does 
not help...

Uwe




> Cheers,
> Simon
> 
> 
>> This is not something that worries me much "per se", as I am 
>> implementing some changes in the package and the new version does not 
>> resemble the current one too much, but intrigues me quite a lot.
>>
>> Best regards,
>>
>> Carlos J. Gil Bellosta
>> http://www.datanalytics.com
>>
>>
>> 2009/7/29 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>>>
>>>
>>> Mathieu Ribatet wrote:
>>>>
>>>> Dear Carlos,
>>>>
>>>>> From your check results:
>>>>
>>>>        cbc.data <- cbc.read.table( system.file("data",
>>>>        "cbc.test.data.txt", package = "colbycol"), sep = "\t" )
>>>>                Warning in file(file, "r") :
>>>>                cannot open file '0001': No such file or directory
>>>>        I think you're trying to read the file "cbc.test.data.txt" 
>>>> located
>>>> in
>>>> the folder "data" of your package skeleton. Is that right? If so, maybe
>>>> using
>>>>
>>>>        paste(system.file(package = "colbycol"),
>>>>        "data/cbc.test.data.txt", sep="/")
>>>>        will solve your issue - although I didn't try.
>>>
>>>
>>> It won't slve it, because reading that file works, but reading file 
>>> "0001"
>>> does ot which is handled within cbc.read.table() in the lines
>>>
>>> ....
>>>  for( column in names(columns) ){
>>>        tmp <- read.table( columns[[column]]$filename, sep = sep, 
>>> na.strings
>>> = "", comment.char = "", quote = "", header = FALSE, ... )[,1]
>>> ....
>>>
>>>
>>> I guess the problem happens before during the Java stuff where the 
>>> 0001 file
>>> is never created (at least not in the location you expect).
>>>
>>>
>>> On the console I see error messages like
>>>
>>>
>>> Exception in thread "main" Traceback (most recent call last):
>>>  File "d:/temp/colbycol/python/colbycol.py", line 6, in <module>
>>>    os.chdir( work_dir )
>>>  File "D:\RCompile\CRANpkg\lib\2.9\rSymPy\jython\Lib\os.py", line 
>>> 261, in
>>> chdir
>>>    raise OSError(errno.ENOENT, strerror(errno.ENOENT), path)
>>> OSError: [Errno 2] No such file or directory:
>>> 'd:/temp/Rtmp1mB6qg/dir72ae2cd6'
>>>
>>>
>>> Best,
>>> Uwe Ligges
>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>


From ligges at statistik.tu-dortmund.de  Fri Jul 31 13:39:46 2009
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 31 Jul 2009 13:39:46 +0200
Subject: [Rd] Checking package on Windows (and seemingly irreproducible
 errors in CRAN checks)
In-Reply-To: <b028350f0907301007g74f8a036y3fea213614ddbf65@mail.gmail.com>
References: <1248813071.4657.18.camel@kropotkin>	<1248815669.30084.15.camel@ubuntu>	<4A706CEE.6060603@statistik.tu-dortmund.de>	<b028350f0907300433i52f672a8scb0561f55082ec6b@mail.gmail.com>	<0D974D52-1C6C-4CF4-8E8B-94CB48F8C2E3@r-project.org>
	<b028350f0907301007g74f8a036y3fea213614ddbf65@mail.gmail.com>
Message-ID: <4A72D802.6030304@statistik.tu-dortmund.de>



Carlos J. Gil Bellosta wrote:
> Hello,
> 
> The issue is no longer an issue concerning my package as I have
> changed the part that drives the error (for unrelated reasons).
> 
> It is true that I might have done a greater effort to make the package
> fully cross-platform. I did R-CMD-checks on Unbuntu and CentOS but
> never on Windows. But I did install the package on Windows and
> successfully run, among other, the examples that fail on CRAN servers.
> 
> What makes me curious about Windows is how can it be that the checks
> pass on some machines (r-forge?s) but fail on CRAN?s. If there were
> any blunt violation of cross-platform implementation practices, all
> Windows checks would fail. However, some succeed.
> 
> Perhaps this is an idle intellectual exercise. But one can probably
> ask himself the following two questions:
> 
> 1) If I R-CMD-check my package on _my_ Windows box, how can I be sure
> that the check will also succeed in other Windows box?


You cannot (same as for any other OS where some settings are different 
between machines). It might also be related to the fact that my Server 
runs Windows Server 2008 64bit, due to permission problems, or due to 
third party requirements (Java / Phyton that are not correctly 
satisfied) - which is why I asked you to specify the requirements that 
makes it work under your machine.

Best,
Uwe Ligges



> 2) Is there any lesson to learn concerning cross-platform
> implementation to learn from this case (there seems to be and I am
> learning it, by the way).
> 
> Best regards and thank you for your comments on this issue.
> 
> Carlos J. Gil Bellosta
> http://www.datanalytics.com
> 
> 
> 2009/7/30 Simon Urbanek <simon.urbanek at r-project.org>:
>> On Jul 30, 2009, at 7:33 , Carlos J. Gil Bellosta wrote:
>>
>>> Dear Uwe,
>>>
>>> The thing that I find funny is that the check of the package on
>>> Windows for R 2.10.x works on r-forge as you can see here:
>>>
>>>
>>> http://r-forge.r-project.org/R/?group_id=426&log=check_x86_32_windows&pkg=colbycol&flavor=devel
>>>
>>> May I be facing some kind of Windows configuration specific issue
>>> here? I am sorry that I am very Windows-illiterate...
>>>
>> Just from the plain output I suspect that the problem is handling of paths
>> in the 3rd party system used (Python) is different from R's on Windows and
>> the package author is not converting them properly. It seems as if Python is
>> trying to use the path 'd:/temp/Rtmp1mB6qg/dir72ae2cd6' literally instead of
>> using 'd:\temp\Rtmp1mB6qg\dir72ae2cd6'. I'm a bit surprised, because Java
>> does the right thing: System.out.println("'"+(new File("z:/foo/bar"))+"'");
>> will print correctly 'z:\foo\bar'.
>>
>> I would suspect that the difference between R-Forge and CRAN may probably be
>> just the setting of TMP/TEMP... [just a guess ;)]
>>
>> Cheers,
>> Simon
>>
>>
>>> This is not something that worries me much "per se", as I am implementing
>>> some changes in the package and the new version does not resemble the
>>> current one too much, but intrigues me quite a lot.
>>>
>>> Best regards,
>>>
>>> Carlos J. Gil Bellosta
>>> http://www.datanalytics.com
>>>
>>>
>>> 2009/7/29 Uwe Ligges <ligges at statistik.tu-dortmund.de>:
>>>>
>>>> Mathieu Ribatet wrote:
>>>>> Dear Carlos,
>>>>>
>>>>>> From your check results:
>>>>>       cbc.data <- cbc.read.table( system.file("data",
>>>>>       "cbc.test.data.txt", package = "colbycol"), sep = "\t" )
>>>>>               Warning in file(file, "r") :
>>>>>               cannot open file '0001': No such file or directory
>>>>>       I think you're trying to read the file "cbc.test.data.txt" located
>>>>> in
>>>>> the folder "data" of your package skeleton. Is that right? If so, maybe
>>>>> using
>>>>>
>>>>>       paste(system.file(package = "colbycol"),
>>>>>       "data/cbc.test.data.txt", sep="/")
>>>>>       will solve your issue - although I didn't try.
>>>>
>>>> It won't slve it, because reading that file works, but reading file
>>>> "0001"
>>>> does ot which is handled within cbc.read.table() in the lines
>>>>
>>>> ....
>>>>  for( column in names(columns) ){
>>>>       tmp <- read.table( columns[[column]]$filename, sep = sep,
>>>> na.strings
>>>> = "", comment.char = "", quote = "", header = FALSE, ... )[,1]
>>>> ....
>>>>
>>>>
>>>> I guess the problem happens before during the Java stuff where the 0001
>>>> file
>>>> is never created (at least not in the location you expect).
>>>>
>>>>
>>>> On the console I see error messages like
>>>>
>>>>
>>>> Exception in thread "main" Traceback (most recent call last):
>>>>  File "d:/temp/colbycol/python/colbycol.py", line 6, in <module>
>>>>   os.chdir( work_dir )
>>>>  File "D:\RCompile\CRANpkg\lib\2.9\rSymPy\jython\Lib\os.py", line 261, in
>>>> chdir
>>>>   raise OSError(errno.ENOENT, strerror(errno.ENOENT), path)
>>>> OSError: [Errno 2] No such file or directory:
>>>> 'd:/temp/Rtmp1mB6qg/dir72ae2cd6'
>>>>
>>>>
>>>> Best,
>>>> Uwe Ligges
>>>>
>>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From sdorairaj at gmail.com  Fri Jul 31 18:14:23 2009
From: sdorairaj at gmail.com (Sundar Dorai-Raj)
Date: Fri, 31 Jul 2009 09:14:23 -0700
Subject: [Rd] update.formula and backticked colons
In-Reply-To: <c9ce82b00907301430p1186243eq7f79cb503d8919ae@mail.gmail.com>
References: <c9ce82b00907301428y698e401by2c3334b41ff7fc4c@mail.gmail.com> 
	<c9ce82b00907301430p1186243eq7f79cb503d8919ae@mail.gmail.com>
Message-ID: <c9ce82b00907310914ibc9abecr34bb03f89c0f8116@mail.gmail.com>

On Thu, Jul 30, 2009 at 2:30 PM, Sundar Dorai-Raj<sdorairaj at gmail.com> wrote:
> On Thu, Jul 30, 2009 at 2:28 PM, Sundar Dorai-Raj<sdorairaj at gmail.com> wrote:
>> I just noticed the following in update.formula and I'm wondering if
>> this behavior is the intention of the developers. Here's an example:
>>
>> update(`a: b` ~ x, ~ . + y)
>>
>> Note now that the response has no backticks and is interpreted as a:b
>> (i.e. ":" is now an operator). This is because in update.formula the
>> call to terms.formula uses simplify = TRUE. I'm working with data that
>> has a lot of colons in their names and for reporting purposes I don't
>> want to use make.names to avoid this situation. I do have a solution
>> which simply avoids using update.formula, but I wonder if the
>> developers would consider removing the "simplify" argument and allow
>> it to be passed through "...", which is currently ignored by
>> update.formula. Alternatively, add a simplify=TRUE to the
>> update.formula call, which can manually be set to FALSE by the user.
>>
>> I would love to hear any comments or criticisms of my findings.
>>
>> Thanks,
>>
>> --sundar
>>
>
> Forgot my version info
>
>> version
> ? ? ? ? ? ? ? _
> platform ? ? ? x86_64-unknown-linux-gnu
> arch ? ? ? ? ? x86_64
> os ? ? ? ? ? ? linux-gnu
> system ? ? ? ? x86_64, linux-gnu
> status
> major ? ? ? ? ?2
> minor ? ? ? ? ?9.1
> year ? ? ? ? ? 2009
> month ? ? ? ? ?06
> day ? ? ? ? ? ?26
> svn rev ? ? ? ?48839
> language ? ? ? R
> version.string R version 2.9.1 (2009-06-26)
>

This bounced on me so I don't know if it actually made it through.
Sorry if this is a repost.

--sundar


From ripley at stats.ox.ac.uk  Fri Jul 31 19:05:35 2009
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 31 Jul 2009 18:05:35 +0100 (BST)
Subject: [Rd] update.formula and backticked colons
In-Reply-To: <c9ce82b00907310914ibc9abecr34bb03f89c0f8116@mail.gmail.com>
References: <c9ce82b00907301428y698e401by2c3334b41ff7fc4c@mail.gmail.com>
	<c9ce82b00907301430p1186243eq7f79cb503d8919ae@mail.gmail.com>
	<c9ce82b00907310914ibc9abecr34bb03f89c0f8116@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.0907311801380.11104@gannet.stats.ox.ac.uk>

You can always check the list archives (the ETHZ ones): it did make 
it.  See the thread starting at

https://stat.ethz.ch/pipermail/r-devel/2009-July/054184.html

I need to look more carefully, but this is not what ... is documented 
to do and it would need to be an extra argument for this method. 
Since terms.formula predates backticks, perhaps the change is better 
made there?

On Fri, 31 Jul 2009, Sundar Dorai-Raj wrote:

> On Thu, Jul 30, 2009 at 2:30 PM, Sundar Dorai-Raj<sdorairaj at gmail.com> wrote:
>> On Thu, Jul 30, 2009 at 2:28 PM, Sundar Dorai-Raj<sdorairaj at gmail.com> wrote:
>>> I just noticed the following in update.formula and I'm wondering if
>>> this behavior is the intention of the developers. Here's an example:
>>>
>>> update(`a: b` ~ x, ~ . + y)
>>>
>>> Note now that the response has no backticks and is interpreted as a:b
>>> (i.e. ":" is now an operator). This is because in update.formula the
>>> call to terms.formula uses simplify = TRUE. I'm working with data that
>>> has a lot of colons in their names and for reporting purposes I don't
>>> want to use make.names to avoid this situation. I do have a solution
>>> which simply avoids using update.formula, but I wonder if the
>>> developers would consider removing the "simplify" argument and allow
>>> it to be passed through "...", which is currently ignored by
>>> update.formula. Alternatively, add a simplify=TRUE to the
>>> update.formula call, which can manually be set to FALSE by the user.
>>>
>>> I would love to hear any comments or criticisms of my findings.
>>>
>>> Thanks,
>>>
>>> --sundar
>>>
>>
>> Forgot my version info
>>
>>> version
>> ? ? ? ? ? ? ? _
>> platform ? ? ? x86_64-unknown-linux-gnu
>> arch ? ? ? ? ? x86_64
>> os ? ? ? ? ? ? linux-gnu
>> system ? ? ? ? x86_64, linux-gnu
>> status
>> major ? ? ? ? ?2
>> minor ? ? ? ? ?9.1
>> year ? ? ? ? ? 2009
>> month ? ? ? ? ?06
>> day ? ? ? ? ? ?26
>> svn rev ? ? ? ?48839
>> language ? ? ? R
>> version.string R version 2.9.1 (2009-06-26)
>>
>
> This bounced on me so I don't know if it actually made it through.
> Sorry if this is a repost.
>
> --sundar
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From wdunlap at tibco.com  Fri Jul 31 19:15:27 2009
From: wdunlap at tibco.com (William Dunlap)
Date: Fri, 31 Jul 2009 10:15:27 -0700
Subject: [Rd] update.formula and backticked colons
In-Reply-To: <c9ce82b00907301428y698e401by2c3334b41ff7fc4c@mail.gmail.com>
References: <c9ce82b00907301428y698e401by2c3334b41ff7fc4c@mail.gmail.com>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D7000195D912@NA-PA-VBE03.na.tibco.com>

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Sundar Dorai-Raj
> Sent: Thursday, July 30, 2009 2:28 PM
> To: r-devel at stat.math.ethz.ch
> Subject: [Rd] update.formula and backticked colons
> 
> I just noticed the following in update.formula and I'm wondering if
> this behavior is the intention of the developers. Here's an example:
> 
> update(`a: b` ~ x, ~ . + y)
> 
> Note now that the response has no backticks and is interpreted as a:b
> (i.e. ":" is now an operator). This is because in update.formula the
> call to terms.formula uses simplify = TRUE. I'm working with data that
> has a lot of colons in their names and for reporting purposes I don't
> want to use make.names to avoid this situation. I do have a solution
> which simply avoids using update.formula, but I wonder if the
> developers would consider removing the "simplify" argument and allow
> it to be passed through "...", which is currently ignored by
> update.formula. Alternatively, add a simplify=TRUE to the
> update.formula call, which can manually be set to FALSE by the user.
> 
> I would love to hear any comments or criticisms of my findings.
> 
> Thanks,
> 
> --sundar

It would be nice to get right of the deparse/parse cycle in
terms.formula,
since that often causes problems.  However, I think that adding
backticks=TRUE
to terms.formula:fixFormulaObject's call to deparse(form[[2L]])  would
fix the 
immediate problem.  (I haven't spent much time looking for bad side
effects
of this change to terms.formula, which gets called in a lot of other
situations.)

Bill Dunlap
TIBCO Software Inc - Spotfire Division
wdunlap tibco.com 


From wdunlap at tibco.com  Fri Jul 31 19:16:45 2009
From: wdunlap at tibco.com (William Dunlap)
Date: Fri, 31 Jul 2009 10:16:45 -0700
Subject: [Rd] update.formula and backticked colons
References: <c9ce82b00907301428y698e401by2c3334b41ff7fc4c@mail.gmail.com> 
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D7000195D913@NA-PA-VBE03.na.tibco.com>


> -----Original Message-----
> From: William Dunlap 
> Sent: Friday, July 31, 2009 10:15 AM
> To: 'Sundar Dorai-Raj'; r-devel at stat.math.ethz.ch
> Subject: RE: [Rd] update.formula and backticked colons
> 
> > -----Original Message-----
> > From: r-devel-bounces at r-project.org 
> > [mailto:r-devel-bounces at r-project.org] On Behalf Of Sundar Dorai-Raj
> > Sent: Thursday, July 30, 2009 2:28 PM
> > To: r-devel at stat.math.ethz.ch
> > Subject: [Rd] update.formula and backticked colons
> > 
> > I just noticed the following in update.formula and I'm wondering if
> > this behavior is the intention of the developers. Here's an example:
> > 
> > update(`a: b` ~ x, ~ . + y)
> > 
> > Note now that the response has no backticks and is 
> interpreted as a:b
> > (i.e. ":" is now an operator). This is because in update.formula the
> > call to terms.formula uses simplify = TRUE. I'm working 
> with data that
> > has a lot of colons in their names and for reporting 
> purposes I don't
> > want to use make.names to avoid this situation. I do have a solution
> > which simply avoids using update.formula, but I wonder if the
> > developers would consider removing the "simplify" argument and allow
> > it to be passed through "...", which is currently ignored by
> > update.formula. Alternatively, add a simplify=TRUE to the
> > update.formula call, which can manually be set to FALSE by the user.
> > 
> > I would love to hear any comments or criticisms of my findings.
> > 
> > Thanks,
> > 
> > --sundar
> 
> It would be nice to get right of the deparse/parse cycle in 
> terms.formula,
> since that often causes problems.  However, I think that 
> adding backticks=TRUE

Typo above: backtick should be singular.

> to terms.formula:fixFormulaObject's call to 
> deparse(form[[2L]])  would fix the 
> immediate problem.  (I haven't spent much time looking for 
> bad side effects
> of this change to terms.formula, which gets called in a lot 
> of other situations.)
> 
> Bill Dunlap
> TIBCO Software Inc - Spotfire Division
> wdunlap tibco.com 


