From MEC at stowers.org  Thu Oct  1 21:59:15 2015
From: MEC at stowers.org (Cook, Malcolm)
Date: Thu, 1 Oct 2015 19:59:15 +0000
Subject: [Rd] BUG: emacs orgmode ob-R.el function
 org-babel-R-evaluate-session over aggressively performs "; ;
 cleanup extra prompts left in output" and a possible workaround
Message-ID: <e23d5e509a6740f19e355d07757c30d7@exchsrv2.sgc.loc>

Hello ,

I am not sure what the best solution is, but, in my hands using Org-mode version 8.3.2-elpa org-20150929 the reg-expt  used to "cleanup extra prompts left in output" is over-aggressive and will trim session :output at lines consisting exclusively of blanks and periods such as produced when printing a BioConductor 'Views' object which wants to appear as

#+RESULTS:
#+begin_example
  Views on a 23011544-letter DNAString subject
subject: CGACAATGCACGACAGAGGAAGCAGAACAGATATTTAGATTGCCTCTCATTTTCTCTCCCATATTATAGGGAGAAATATGATCGCGTATGCGAGAGTAGTGCCAACATATTGTGCTCTTTGATTTTTTGGCAACCCAAAATGGTGGCGGATGAACGAGATGATAATATATTCAAGTTGCCGCTAATCAGAAATAAATTCATTGCAACGTTAAATACAGCACAATATATGATCGCGTATGCGAGAGTAGTGCCAACATATTGTGCTAATGAGTGCCTCTCGTTCTCTGTCTTATA...TATCTTTCAAATTTTGATGACCCCCACTAGCAAAAAATGCGAAAATTAACCCAAATAATGATTTCCCTAAATCCTTCCAAAAGTAAATATTAACTTTTTGGCAAAATCCATTTTCCCAAATTTCGGTCATTAAATAATCAGTTTTTTGCCACAACTTTTAAAATAATTGTCTGAAAATGGAATGTCATATCTCGATGAGCTCATAATTAAATTTACAATCAAACTGTGTTCGAAAAAGAGAAAACTAACATTTTTTTGGCATATTTGCAAATTTTGATGAACCCCCCTTTCAAA
views:
         start      end width
  [1]   344766   344773     8 [CATGAGGC]
  [2]   563564   563571     8 [CATGAGGC]
  [3]   641027   641034     8 [CATGAGGC]
  [4]   656168   656175     8 [CATGAGGC]
  [5]   709112   709119     8 [CATGAGGC]
  ...      ...      ...   ... ...
[141] 22209984 22209991     8 [CATGAGGC]
[142] 22371543 22371550     8 [CATGAGGC]
[143] 22554991 22554998     8 [CATGAGGC]
[144] 22618578 22618585     8 [CATGAGGC]
[145] 22897728 22897735     8 [CATGAGGC]
#+end_example

But alas rather appears as:

#+RESULTS:
#+begin_example
  ...      ...      ...   ... ...
[141] 22209984 22209991     8 [CATGAGGC]
[142] 22371543 22371550     8 [CATGAGGC]
[143] 22554991 22554998     8 [CATGAGGC]
[144] 22618578 22618585     8 [CATGAGGC]
[145] 22897728 22897735     8 [CATGAGGC]
#+end_example


I offer as a possible workaround the following:

So far, I have had good success having removed provision for allowing leading whitespace by changing the regexp  org-babel-R-evaluate-session  from
      "^\\([ ]*[>+\\.][ ]?\\)+\\([[0-9]+\\|[ ]\\)"
 to
      "^\\([>+\\.][ ]?\\)+\\([[0-9]+\\|[ ]\\)"

But I don't know all the test cases so, YMMV....

HTH,

~Malcolm (who, FWIW, has never really liked the way ob-R communicated with the inferior R session in the first place....)


From mikko.korpela at aalto.fi  Fri Oct  2 16:33:57 2015
From: mikko.korpela at aalto.fi (Mikko Korpela)
Date: Fri, 2 Oct 2015 17:33:57 +0300
Subject: [Rd] Typo in ?Memory
Message-ID: <560E95D5.3070504@aalto.fi>

I noticed a small typo in ?Memory. See the diff at the bottom of the
message.

- Mikko

Index: src/library/base/man/Memory.Rd
===================================================================
--- src/library/base/man/Memory.Rd	(revision 69448)
+++ src/library/base/man/Memory.Rd	(working copy)
@@ -31,7 +31,7 @@
   bytes on a 64-bit build.

   The default values are (currently) an initial setting of 350k cons
-  cell sand 6Mb of vector heap.  Note that the areas are not actually
+  cells and 6Mb of vector heap.  Note that the areas are not actually
   allocated initially: rather these values are the sizes for triggering
   garbage collection.  These values can be set by the command line
   options \option{--min-nsize} and \option{--min-vsize} (or if they are


From murdoch.duncan at gmail.com  Fri Oct  2 17:15:59 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 2 Oct 2015 11:15:59 -0400
Subject: [Rd] Typo in ?Memory
In-Reply-To: <560E95D5.3070504@aalto.fi>
References: <560E95D5.3070504@aalto.fi>
Message-ID: <560E9FAF.10605@gmail.com>

On 02/10/2015 10:33 AM, Mikko Korpela wrote:
> I noticed a small typo in ?Memory. See the diff at the bottom of the
> message.
>
> - Mikko
>
> Index: src/library/base/man/Memory.Rd
> ===================================================================
> --- src/library/base/man/Memory.Rd	(revision 69448)
> +++ src/library/base/man/Memory.Rd	(working copy)
> @@ -31,7 +31,7 @@
>     bytes on a 64-bit build.
>
>     The default values are (currently) an initial setting of 350k cons
> -  cell sand 6Mb of vector heap.  Note that the areas are not actually
> +  cells and 6Mb of vector heap.  Note that the areas are not actually
>     allocated initially: rather these values are the sizes for triggering
>     garbage collection.  These values can be set by the command line
>     options \option{--min-nsize} and \option{--min-vsize} (or if they are
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

Thanks, I'll fix it.

Duncan Murdoch


From stefanML at collocations.de  Sat Oct  3 16:28:19 2015
From: stefanML at collocations.de (Stefan Evert)
Date: Sat, 3 Oct 2015 16:28:19 +0200
Subject: [Rd] issues with dev.new avoiding RStudio plot device on unix?
In-Reply-To: <560AFB6D.5020301@gmail.com>
References: <5605982E.5000104@skyeome.net>
	<CAMMJQ0Y2dHA2wjdzNQznEA=cfh7PLdQH4XBBzJcdzoVUx19EMA@mail.gmail.com>
	<56062226.8010005@skyeome.net> <56067201.4070707@gmail.com>
	<560AD1D9.9050900@skyeome.net> <560AFB6D.5020301@gmail.com>
Message-ID: <1DE4416E-4764-4142-BFF5-5BA20014661C@collocations.de>


> The problem is that the device chosen by dev.new() depends on the GUI.
> You can see the code that does this in grDevices:::.onLoad.  So in fact
> with noRstudioGD=TRUE, the decision is identical to what it is in R:
> you only get X11 if your GUI is X11 or Tk, you get pdf otherwise.
> It's pretty common to use R on a machine where X11 won't work, so this
> makes sense.

But not if running from RStudio always causes the X11 check to fail.  If the function is used outside RStudio, there's little point in specifying noRStudioGD=TRUE in the first place.

If you consider the code used to determine whether quartz() or X11() is available

	dsp <- Sys.getenv("DISPLAY")
	if (.Platform$OS.type == "windows")
		windows
	else if (.Platform$GUI == "AQUA" || ((!nzchar(dsp) || grepl("^/tmp/launch-", dsp)) && .Call(C_makeQuartzDefault)))
		quartz
	else if (nzchar(dsp) && .Platform$GUI %in% c("X11", "Tk"))
		X11
	else defdev 

you can see that it checks for a DISPLAY variable and assumes that X11 can be used if it is set.  Wouldn't it be just as safe to add RStudio to the list of accepted .Platform$GUIs?

In my case (Mac OS X 10.10.5), I'd like to get a quartz device.  The problem here is that I have XQuartz installed, so DISPLAY is always set and looks like this

	/private/tmp/com.apple.launchd.2wKas4wzPe/org.macosforge.xquartz:0 

while dev.new() checks for ^/tmp/launch-; I suppose the DISPLAY variable has changed between different versions of Mac OS X or XQuartz.  Perhaps the additional patterns could just be added to the grepl() call?

Best,
Stefan


From murdoch.duncan at gmail.com  Sat Oct  3 19:47:12 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sat, 3 Oct 2015 13:47:12 -0400
Subject: [Rd] issues with dev.new avoiding RStudio plot device on unix?
In-Reply-To: <1DE4416E-4764-4142-BFF5-5BA20014661C@collocations.de>
References: <5605982E.5000104@skyeome.net>
	<CAMMJQ0Y2dHA2wjdzNQznEA=cfh7PLdQH4XBBzJcdzoVUx19EMA@mail.gmail.com>
	<56062226.8010005@skyeome.net> <56067201.4070707@gmail.com>
	<560AD1D9.9050900@skyeome.net> <560AFB6D.5020301@gmail.com>
	<1DE4416E-4764-4142-BFF5-5BA20014661C@collocations.de>
Message-ID: <561014A0.1010404@gmail.com>

On 03/10/2015 10:28 AM, Stefan Evert wrote:
> 
>> The problem is that the device chosen by dev.new() depends on the GUI.
>> You can see the code that does this in grDevices:::.onLoad.  So in fact
>> with noRstudioGD=TRUE, the decision is identical to what it is in R:
>> you only get X11 if your GUI is X11 or Tk, you get pdf otherwise.
>> It's pretty common to use R on a machine where X11 won't work, so this
>> makes sense.
> 
> But not if running from RStudio always causes the X11 check to fail.  If the function is used outside RStudio, there's little point in specifying noRStudioGD=TRUE in the first place.
> 
> If you consider the code used to determine whether quartz() or X11() is available
> 
> 	dsp <- Sys.getenv("DISPLAY")
> 	if (.Platform$OS.type == "windows")
> 		windows
> 	else if (.Platform$GUI == "AQUA" || ((!nzchar(dsp) || grepl("^/tmp/launch-", dsp)) && .Call(C_makeQuartzDefault)))
> 		quartz
> 	else if (nzchar(dsp) && .Platform$GUI %in% c("X11", "Tk"))
> 		X11
> 	else defdev 
> 
> you can see that it checks for a DISPLAY variable and assumes that X11 can be used if it is set.  Wouldn't it be just as safe to add RStudio to the list of accepted .Platform$GUIs?
> 
> In my case (Mac OS X 10.10.5), I'd like to get a quartz device.  The problem here is that I have XQuartz installed, so DISPLAY is always set and looks like this
> 
> 	/private/tmp/com.apple.launchd.2wKas4wzPe/org.macosforge.xquartz:0 
> 
> while dev.new() checks for ^/tmp/launch-; I suppose the DISPLAY variable has changed between different versions of Mac OS X or XQuartz.  Perhaps the additional patterns could just be added to the grepl() call?

In my opinion dev.new() and grDevices:::.onLoad are already too
complicated, and that's the cause of the problem.  I'm not going to mess
with them.

For your case, it seems pretty easy for you to set
options(device="quartz") during startup, or R_DEFAULT_DEVICE=quartz
before startup.

Duncan Murdoch


From jgrn at illinois.edu  Sun Oct  4 16:10:41 2015
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Sun, 04 Oct 2015 14:10:41 +0000
Subject: [Rd] Conditional importFrom (roxygen?)
Message-ID: <CABG0rfu+kdrgWsyQPyJf-Twm2ostSCsMi7vbzR5br9LoPtmbLw@mail.gmail.com>

Folks:

I am getting a build failure when I:
#' @importFrom utils shortPathName

which roxygenizes it to the NAMESPACE.

I suspect this is because this particular function is Windows-only, but I'm
a bit confused how I should "properly" importFrom a function like this so
it doesn't cause a build failure, but I don't get a note in my R CMD CHECK
if I DON'T have it:

gdal_setInstallation : correctPath: no visible global function
  definition for 'shortPathName'
gdalinfo: no visible global function definition for 'glob2rx'
gdallocationinfo: no visible global function definition for
  'write.table'
gdaltransform: no visible global function definition for 'write.table'
get_subdatasets: no visible global function definition for 'glob2rx'
mosaic_rasters: no visible global function definition for 'write.table'
Undefined global functions or variables:
  glob2rx shortPathName write.table
Consider adding
  importFrom("utils", "glob2rx", "shortPathName", "write.table")
to your NAMESPACE.

I'll note my function actually first checks to see what OS is running, and
doesn't use this function on non-Windows machines, so having this function
does not cause any actual errors:

...

if (.Platform$OS.type=="windows")

{

x <- shortPathName(x)

} else

{

x <- path.expand(x)

}


...

Is there a way to do a conditional importFrom based on the OS?  Or can I
safely ignore this (I'm trying to submit to CRAN).

--j

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Sun Oct  4 18:23:09 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 4 Oct 2015 12:23:09 -0400
Subject: [Rd] Conditional importFrom (roxygen?)
In-Reply-To: <CABG0rfu+kdrgWsyQPyJf-Twm2ostSCsMi7vbzR5br9LoPtmbLw@mail.gmail.com>
References: <CABG0rfu+kdrgWsyQPyJf-Twm2ostSCsMi7vbzR5br9LoPtmbLw@mail.gmail.com>
Message-ID: <5611526D.7080508@gmail.com>

On 04/10/2015 10:10 AM, Jonathan Greenberg wrote:
> Folks:
> 
> I am getting a build failure when I:
> #' @importFrom utils shortPathName
> 
> which roxygenizes it to the NAMESPACE.
> 
> I suspect this is because this particular function is Windows-only, but I'm
> a bit confused how I should "properly" importFrom a function like this so
> it doesn't cause a build failure, but I don't get a note in my R CMD CHECK
> if I DON'T have it:
> 
> gdal_setInstallation : correctPath: no visible global function
>   definition for 'shortPathName'
> gdalinfo: no visible global function definition for 'glob2rx'
> gdallocationinfo: no visible global function definition for
>   'write.table'
> gdaltransform: no visible global function definition for 'write.table'
> get_subdatasets: no visible global function definition for 'glob2rx'
> mosaic_rasters: no visible global function definition for 'write.table'
> Undefined global functions or variables:
>   glob2rx shortPathName write.table
> Consider adding
>   importFrom("utils", "glob2rx", "shortPathName", "write.table")
> to your NAMESPACE.
> 
> I'll note my function actually first checks to see what OS is running, and
> doesn't use this function on non-Windows machines, so having this function
> does not cause any actual errors:
> 
> ...
> 
> if (.Platform$OS.type=="windows")
> 
> {
> 
> x <- shortPathName(x)
> 
> } else
> 
> {
> 
> x <- path.expand(x)
> 
> }
> 
> 
> ...
> 
> Is there a way to do a conditional importFrom based on the OS?  Or can I
> safely ignore this (I'm trying to submit to CRAN).
> 

Yes, you can put conditionals into the NAMESPACE file.  Apparently
roxygen2 doesn't support this feature, so you'll have to do it by hand.

Duncan Murdoch


From bbolker at gmail.com  Mon Oct  5 01:34:50 2015
From: bbolker at gmail.com (Ben Bolker)
Date: Sun, 4 Oct 2015 23:34:50 +0000
Subject: [Rd] Conditional importFrom (roxygen?)
References: <CABG0rfu+kdrgWsyQPyJf-Twm2ostSCsMi7vbzR5br9LoPtmbLw@mail.gmail.com>
	<5611526D.7080508@gmail.com>
Message-ID: <loom.20151005T013053-407@post.gmane.org>

Duncan Murdoch <murdoch.duncan <at> gmail.com> writes:

> 
> On 04/10/2015 10:10 AM, Jonathan Greenberg wrote:
> > Folks:
> > 

[snip snip snip]

> > 
> > Is there a way to do a conditional importFrom based on the OS?  Or can I
> > safely ignore this (I'm trying to submit to CRAN).
> > 
> 
> Yes, you can put conditionals into the NAMESPACE file.  Apparently
> roxygen2 doesn't support this feature, so you'll have to do it by hand.
> 
> Duncan Murdoch
> 
> 

This has been submitted as an issue at

https://github.com/klutometis/roxygen/issues/378

closely related:

https://github.com/klutometis/roxygen/issues/371

my current hacky solution to this is to use a Makefile that
post-processes the NAMESPACE after it's roxygenized, e.g. search
for "getRversion" in

https://github.com/glmmTMB/glmmTMB/blob/master/Makefile


From murdoch.duncan at gmail.com  Mon Oct  5 01:52:36 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 4 Oct 2015 19:52:36 -0400
Subject: [Rd] Conditional importFrom (roxygen?)
In-Reply-To: <loom.20151005T013053-407@post.gmane.org>
References: <CABG0rfu+kdrgWsyQPyJf-Twm2ostSCsMi7vbzR5br9LoPtmbLw@mail.gmail.com>
	<5611526D.7080508@gmail.com> <loom.20151005T013053-407@post.gmane.org>
Message-ID: <5611BBC4.2030307@gmail.com>

On 04/10/2015 7:34 PM, Ben Bolker wrote:
> Duncan Murdoch <murdoch.duncan <at> gmail.com> writes:
> 
>>
>> On 04/10/2015 10:10 AM, Jonathan Greenberg wrote:
>>> Folks:
>>>
> 
> [snip snip snip]
> 
>>>
>>> Is there a way to do a conditional importFrom based on the OS?  Or can I
>>> safely ignore this (I'm trying to submit to CRAN).
>>>
>>
>> Yes, you can put conditionals into the NAMESPACE file.  Apparently
>> roxygen2 doesn't support this feature, so you'll have to do it by hand.
>>
>> Duncan Murdoch
>>
>>
> 
> This has been submitted as an issue at
> 
> https://github.com/klutometis/roxygen/issues/378
> 
> closely related:
> 
> https://github.com/klutometis/roxygen/issues/371
> 
> my current hacky solution to this is to use a Makefile that
> post-processes the NAMESPACE after it's roxygenized, e.g. search
> for "getRversion" in
> 
> https://github.com/glmmTMB/glmmTMB/blob/master/Makefile

Hadley has the right idea (allow roxygen to specify some uninterpreted
text to drop into the NAMESPACE file), but it doesn't go far enough.
Really this is a design flaw in roxygen:  being able to enter NAMESPACE
and help page info in source files is a great feature, but being forced
to go all or nothing is a flaw.

If base R adds something new to the NAMESPACE or .Rd files (or has some
obscure feature that roxygen authors didn't notice), it's really hard
for roxygen users to make use of it.

A better design would be to allow content from both sources:  some
manually entered NAMESPACE stuff, and some automatically generated stuff.

A really nice design would be to read the manually entered stuff and
show (some of?) it in the .R files, but that would be really tricky to
get right.  I think it would need to be supported by a GUI, it wouldn't
be reasonable to expect people to type it all properly in a dumb editor.
 Maybe Hadley knows someone who has written a GUI?

Duncan Murdoch


From jorismeys at gmail.com  Mon Oct  5 16:22:08 2015
From: jorismeys at gmail.com (Joris Meys)
Date: Mon, 5 Oct 2015 16:22:08 +0200
Subject: [Rd] Error generated by .Internal(nchar) disappears when debugging
Message-ID: <CAO1zAVYsOWG0QSVdU_wex-Y2U3KD3YEtGJu5nH5zNc8dCzm5ig@mail.gmail.com>

Hi all,

I have a puzzling problem related to nchar. In R 3.2.1, the internal nchar
gained an extra argument (see
https://stat.ethz.ch/pipermail/r-announce/2015/000586.html)

I've been testing code using the package copula, and at home I'm still
running R 3.2.0 (I know, I know...). When trying the following code, I got
an error:

> library(copula)
> fgmCopula(0.8)
Error in substr(sc[i], 2, nchar(sc[i]) - 1) :
  4 arguments passed to .Internal(nchar) which requires 3

So I do the obvious and try to debug using debug():

> debugonce(fgmCopula)
> fgmCopula(0.8)

And when I try that, I can step through the complete function without any
error. I know that the obvious solution is to update to R 3.2.2, but :

- I have absolutely no clue how a function can give an error when used
normally, but not return any error when stepping through it using debug.
- The copula package built for R 3.2.2 isn't compatible any longer with R
versions older than R 3.2.1, like the one used in our PC classes. Other
packages might share the same problem.

Can somebody shed some light on what exactly is going on here? I don't want
to bug the authors of the copula package if I'm not sure of the origin of
this problem.

Cheers
Joris
-- 
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Mathematical Modelling, Statistics and Bio-Informatics

tel :  +32 (0)9 264 61 79
Joris.Meys at Ugent.be
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php

	[[alternative HTML version deleted]]


From dusa.adrian at unibuc.ro  Mon Oct  5 23:02:04 2015
From: dusa.adrian at unibuc.ro (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Tue, 6 Oct 2015 00:02:04 +0300
Subject: [Rd] authorship and citation
Message-ID: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>

Dear R developers,

This is a rather peculiar question, but nevertheless I would still need an
answer for.
It is about an R package which I created (namely QCA), and from versions
1.0-0 to 1.1-4 I had a co-author.
The co-author recently withdrawn from the package development, but still
requires to be left in the authors list and be cited for the package in the
CITATION file.

Obviously, one could not require citations for further developments, but
don't know how exactly to proceed (I would like to be fair and comply to
rules).

I have three options:

1. Since the co-author withdrawn from the package development, erase his
name from the list of authors (but duly recognising his past contribution
in the package description file)

2. Preserve his name in the list of authors (with the comment "up to
version 1.1-4"), but erasing his name from the citation file

3. Keep his name both in the authors list and in the citation file
indefinitely, even though he doesn't do any development work anymore (I
have been threatened with a legal process for plagiarism if I did
otherwise).

My gut feeling is, since his name is related to the previous versions,
anyone using those versions would cite him as well, but otherwise I don't
feel comfortable citing my former co-author for the current work he hasn't
contributed to.

At this point, I would really use an advice, as on the other hand I
wouldn't want to break any regulation I might not be aware of.

Best wishes,
Adrian


-- 
Adrian Dusa
University of Bucharest
Romanian Social Data Archive
Soseaua Panduri nr.90
050663 Bucharest sector 5
Romania

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Mon Oct  5 23:22:25 2015
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 5 Oct 2015 23:22:25 +0200
Subject: [Rd] authorship and citation
In-Reply-To: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
Message-ID: <5612EA11.7080805@statistik.tu-dortmund.de>

Simply advice:

The former co-author contributed, so he is still author and probably 
copyright holder and has to be listed among the authors, otherwise it 
would be a CRAN policy violation since even if he does not develop 
further on, he developed parts of the so far existing package (if you 
talk about a CRAN package).

I am not a lawyer, hence I cannot speak for copyright/license stuff in 
general, hence my comments only about CRAN policies.


Best,
Uwe Ligges


On 05.10.2015 23:02, Adrian Du?a wrote:
> Dear R developers,
>
> This is a rather peculiar question, but nevertheless I would still need an
> answer for.
> It is about an R package which I created (namely QCA), and from versions
> 1.0-0 to 1.1-4 I had a co-author.
> The co-author recently withdrawn from the package development, but still
> requires to be left in the authors list and be cited for the package in the
> CITATION file.
>
> Obviously, one could not require citations for further developments, but
> don't know how exactly to proceed (I would like to be fair and comply to
> rules).
>
> I have three options:
>
> 1. Since the co-author withdrawn from the package development, erase his
> name from the list of authors (but duly recognising his past contribution
> in the package description file)
>
> 2. Preserve his name in the list of authors (with the comment "up to
> version 1.1-4"), but erasing his name from the citation file
>
> 3. Keep his name both in the authors list and in the citation file
> indefinitely, even though he doesn't do any development work anymore (I
> have been threatened with a legal process for plagiarism if I did
> otherwise).
>
> My gut feeling is, since his name is related to the previous versions,
> anyone using those versions would cite him as well, but otherwise I don't
> feel comfortable citing my former co-author for the current work he hasn't
> contributed to.
>
> At this point, I would really use an advice, as on the other hand I
> wouldn't want to break any regulation I might not be aware of.
>
> Best wishes,
> Adrian
>
>


From A.Robinson at ms.unimelb.edu.au  Mon Oct  5 23:47:55 2015
From: A.Robinson at ms.unimelb.edu.au (Andrew Robinson)
Date: Tue, 6 Oct 2015 08:47:55 +1100
Subject: [Rd] authorship and citation
In-Reply-To: <5612EA11.7080805@statistik.tu-dortmund.de>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
Message-ID: <CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>

As a fourth option, I wonder if the first author could fork the package?

Presumably, appropriately cited, a fork is permitted by the license under
which it was released. Then the original package, by both authors, still
exists (and a final version could point to the new one) and the new
package, citing the previous version appropriately, is by a single author.

The page of CRAN's policies doesn't seem to touch on forking, presumably
because it's out of scope.

Best wishes,

Andrew



On Tue, Oct 6, 2015 at 8:22 AM, Uwe Ligges <ligges at statistik.tu-dortmund.de>
wrote:

> Simply advice:
>
> The former co-author contributed, so he is still author and probably
> copyright holder and has to be listed among the authors, otherwise it would
> be a CRAN policy violation since even if he does not develop further on, he
> developed parts of the so far existing package (if you talk about a CRAN
> package).
>
> I am not a lawyer, hence I cannot speak for copyright/license stuff in
> general, hence my comments only about CRAN policies.
>
>
> Best,
> Uwe Ligges
>
>
>
> On 05.10.2015 23:02, Adrian Du?a wrote:
>
>> Dear R developers,
>>
>> This is a rather peculiar question, but nevertheless I would still need an
>> answer for.
>> It is about an R package which I created (namely QCA), and from versions
>> 1.0-0 to 1.1-4 I had a co-author.
>> The co-author recently withdrawn from the package development, but still
>> requires to be left in the authors list and be cited for the package in
>> the
>> CITATION file.
>>
>> Obviously, one could not require citations for further developments, but
>> don't know how exactly to proceed (I would like to be fair and comply to
>> rules).
>>
>> I have three options:
>>
>> 1. Since the co-author withdrawn from the package development, erase his
>> name from the list of authors (but duly recognising his past contribution
>> in the package description file)
>>
>> 2. Preserve his name in the list of authors (with the comment "up to
>> version 1.1-4"), but erasing his name from the citation file
>>
>> 3. Keep his name both in the authors list and in the citation file
>> indefinitely, even though he doesn't do any development work anymore (I
>> have been threatened with a legal process for plagiarism if I did
>> otherwise).
>>
>> My gut feeling is, since his name is related to the previous versions,
>> anyone using those versions would cite him as well, but otherwise I don't
>> feel comfortable citing my former co-author for the current work he hasn't
>> contributed to.
>>
>> At this point, I would really use an advice, as on the other hand I
>> wouldn't want to break any regulation I might not be aware of.
>>
>> Best wishes,
>> Adrian
>>
>>
>>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Andrew Robinson
Deputy Director, CEBRA, School of Biosciences
Reader & Associate Professor in Applied Statistics  Tel: (+61) 0403 138 955
School of Mathematics and Statistics                        Fax: +61-3-8344
4599
University of Melbourne, VIC 3010 Australia
Email: a.robinson at ms.unimelb.edu.au
Website: http://www.ms.unimelb.edu.au/~andrewpr

MSME: http://www.crcpress.com/product/isbn/9781439858028
FAwR: http://www.ms.unimelb.edu.au/~andrewpr/FAwR/
SPuR: http://www.ms.unimelb.edu.au/spuRs/

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Tue Oct  6 00:31:04 2015
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 6 Oct 2015 00:31:04 +0200
Subject: [Rd] authorship and citation
In-Reply-To: <CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
Message-ID: <5612FA28.2090607@statistik.tu-dortmund.de>



On 05.10.2015 23:47, Andrew Robinson wrote:
> As a fourth option, I wonder if the first author could fork the package?
>
> Presumably, appropriately cited, a fork is permitted by the license under
> which it was released. Then the original package, by both authors, still
> exists (and a final version could point to the new one) and the new
> package, citing the previous version appropriately, is by a single author.

No, copyright remains. You can fork given the license permits it, but 
there are still the same copyright holders ...

Best,
Uwe Ligges



>
> The page of CRAN's policies doesn't seem to touch on forking, presumably
> because it's out of scope.
>
> Best wishes,
>
> Andrew
>
>
>
> On Tue, Oct 6, 2015 at 8:22 AM, Uwe Ligges <ligges at statistik.tu-dortmund.de>
> wrote:
>
>> Simply advice:
>>
>> The former co-author contributed, so he is still author and probably
>> copyright holder and has to be listed among the authors, otherwise it would
>> be a CRAN policy violation since even if he does not develop further on, he
>> developed parts of the so far existing package (if you talk about a CRAN
>> package).
>>
>> I am not a lawyer, hence I cannot speak for copyright/license stuff in
>> general, hence my comments only about CRAN policies.
>>
>>
>> Best,
>> Uwe Ligges
>>
>>
>>
>> On 05.10.2015 23:02, Adrian Du?a wrote:
>>
>>> Dear R developers,
>>>
>>> This is a rather peculiar question, but nevertheless I would still need an
>>> answer for.
>>> It is about an R package which I created (namely QCA), and from versions
>>> 1.0-0 to 1.1-4 I had a co-author.
>>> The co-author recently withdrawn from the package development, but still
>>> requires to be left in the authors list and be cited for the package in
>>> the
>>> CITATION file.
>>>
>>> Obviously, one could not require citations for further developments, but
>>> don't know how exactly to proceed (I would like to be fair and comply to
>>> rules).
>>>
>>> I have three options:
>>>
>>> 1. Since the co-author withdrawn from the package development, erase his
>>> name from the list of authors (but duly recognising his past contribution
>>> in the package description file)
>>>
>>> 2. Preserve his name in the list of authors (with the comment "up to
>>> version 1.1-4"), but erasing his name from the citation file
>>>
>>> 3. Keep his name both in the authors list and in the citation file
>>> indefinitely, even though he doesn't do any development work anymore (I
>>> have been threatened with a legal process for plagiarism if I did
>>> otherwise).
>>>
>>> My gut feeling is, since his name is related to the previous versions,
>>> anyone using those versions would cite him as well, but otherwise I don't
>>> feel comfortable citing my former co-author for the current work he hasn't
>>> contributed to.
>>>
>>> At this point, I would really use an advice, as on the other hand I
>>> wouldn't want to break any regulation I might not be aware of.
>>>
>>> Best wishes,
>>> Adrian
>>>
>>>
>>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
>


From mattjdowle at gmail.com  Tue Oct  6 01:24:15 2015
From: mattjdowle at gmail.com (Matt Dowle)
Date: Mon, 5 Oct 2015 23:24:15 +0000
Subject: [Rd] Error generated by .Internal(nchar) disappears when
	debugging
References: <CAO1zAVYsOWG0QSVdU_wex-Y2U3KD3YEtGJu5nH5zNc8dCzm5ig@mail.gmail.com>
Message-ID: <loom.20151006T011642-505@post.gmane.org>

Joris Meys <jorismeys <at> gmail.com> writes:

> 
> Hi all,
> 
> I have a puzzling problem related to nchar. In R 3.2.1, the internal 
nchar
> gained an extra argument (see
> https://stat.ethz.ch/pipermail/r-announce/2015/000586.html)
> 
> I've been testing code using the package copula, and at home I'm still
> running R 3.2.0 (I know, I know...). When trying the following code, I 
got
> an error:
> 
> > library(copula)
> > fgmCopula(0.8)
> Error in substr(sc[i], 2, nchar(sc[i]) - 1) :
>   4 arguments passed to .Internal(nchar) which requires 3
> 
> Cheers
> Joris


I'm seeing a similar problem. IIUC, the Windows binary .zip from CRAN of 
any package using base::nchar is affected. Could someone check my answer 
here is correct please : http://stackoverflow.com/a/32959306/403310

Matt


From murdoch.duncan at gmail.com  Tue Oct  6 01:57:21 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 5 Oct 2015 19:57:21 -0400
Subject: [Rd] Error generated by .Internal(nchar) disappears when
 debugging
In-Reply-To: <loom.20151006T011642-505@post.gmane.org>
References: <CAO1zAVYsOWG0QSVdU_wex-Y2U3KD3YEtGJu5nH5zNc8dCzm5ig@mail.gmail.com>
	<loom.20151006T011642-505@post.gmane.org>
Message-ID: <56130E61.8060007@gmail.com>

On 05/10/2015 7:24 PM, Matt Dowle wrote:
> Joris Meys <jorismeys <at> gmail.com> writes:
> 
>>
>> Hi all,
>>
>> I have a puzzling problem related to nchar. In R 3.2.1, the internal 
> nchar
>> gained an extra argument (see
>> https://stat.ethz.ch/pipermail/r-announce/2015/000586.html)
>>
>> I've been testing code using the package copula, and at home I'm still
>> running R 3.2.0 (I know, I know...). When trying the following code, I 
> got
>> an error:
>>
>>> library(copula)
>>> fgmCopula(0.8)
>> Error in substr(sc[i], 2, nchar(sc[i]) - 1) :
>>   4 arguments passed to .Internal(nchar) which requires 3
>>
>> Cheers
>> Joris
> 
> 
> I'm seeing a similar problem. IIUC, the Windows binary .zip from CRAN of 
> any package using base::nchar is affected. Could someone check my answer 
> here is correct please : http://stackoverflow.com/a/32959306/403310

Nobody has posted a simple reproducible example here, so it's kind of
hard to say.

I would have guessed that a change to the internal signature of the C
code underlying nchar() wouldn't have any effect on a package that
called the R nchar() function.

When I put together my own example (a tiny package containing a function
calling nchar(), built to .zip using R 3.2.2, installed into R 3.2.0),
it confirmed my guess.

On the other hand, if some package is calling the .Internal function
directly, I'd expect that to break.  Packages shouldn't do that.

So I'd say there's been no evidence posted of a problem in R here,
though there may be problems in some of the packages involved.  I'd
welcome an example that provided some usable evidence.

Duncan Murdoch


From michael.weylandt at gmail.com  Tue Oct  6 02:04:30 2015
From: michael.weylandt at gmail.com (Michael Weylandt)
Date: Mon, 5 Oct 2015 19:04:30 -0500
Subject: [Rd] Error generated by .Internal(nchar) disappears when
	debugging
In-Reply-To: <56130E61.8060007@gmail.com>
References: <CAO1zAVYsOWG0QSVdU_wex-Y2U3KD3YEtGJu5nH5zNc8dCzm5ig@mail.gmail.com>
	<loom.20151006T011642-505@post.gmane.org>
	<56130E61.8060007@gmail.com>
Message-ID: <06B5CE33-FF54-4619-BB77-2625E944777C@gmail.com>

Doesn't the byte-compiler inline calls like nchar() to call the .Internal directly for certain optimization levels?  If the 'internal' signature changed in a point release, I'd expect an issue like the below.  (I'm pretty sure CRAN packages are byte-compiled at build-time, but don't use Windows so can't confirm)

To Joris' initial question. I think the debug machinery calls the unoptimized (no-inline) function. 

Michael

> On Oct 5, 2015, at 6:57 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> 
>> On 05/10/2015 7:24 PM, Matt Dowle wrote:
>> Joris Meys <jorismeys <at> gmail.com> writes:
>> 
>>> 
>>> Hi all,
>>> 
>>> I have a puzzling problem related to nchar. In R 3.2.1, the internal
>> nchar
>>> gained an extra argument (see
>>> https://stat.ethz.ch/pipermail/r-announce/2015/000586.html)
>>> 
>>> I've been testing code using the package copula, and at home I'm still
>>> running R 3.2.0 (I know, I know...). When trying the following code, I
>> got
>>> an error:
>>> 
>>>> library(copula)
>>>> fgmCopula(0.8)
>>> Error in substr(sc[i], 2, nchar(sc[i]) - 1) :
>>>  4 arguments passed to .Internal(nchar) which requires 3
>>> 
>>> Cheers
>>> Joris
>> 
>> 
>> I'm seeing a similar problem. IIUC, the Windows binary .zip from CRAN of 
>> any package using base::nchar is affected. Could someone check my answer 
>> here is correct please : http://stackoverflow.com/a/32959306/403310
> 
> Nobody has posted a simple reproducible example here, so it's kind of
> hard to say.
> 
> I would have guessed that a change to the internal signature of the C
> code underlying nchar() wouldn't have any effect on a package that
> called the R nchar() function.
> 
> When I put together my own example (a tiny package containing a function
> calling nchar(), built to .zip using R 3.2.2, installed into R 3.2.0),
> it confirmed my guess.
> 
> On the other hand, if some package is calling the .Internal function
> directly, I'd expect that to break.  Packages shouldn't do that.
> 
> So I'd say there's been no evidence posted of a problem in R here,
> though there may be problems in some of the packages involved.  I'd
> welcome an example that provided some usable evidence.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From simon.urbanek at r-project.org  Tue Oct  6 02:06:58 2015
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 5 Oct 2015 20:06:58 -0400
Subject: [Rd] authorship and citation
In-Reply-To: <5612FA28.2090607@statistik.tu-dortmund.de>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
Message-ID: <8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>


On Oct 5, 2015, at 6:31 PM, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:

> 
> 
> On 05.10.2015 23:47, Andrew Robinson wrote:
>> As a fourth option, I wonder if the first author could fork the package?
>> 
>> Presumably, appropriately cited, a fork is permitted by the license under
>> which it was released. Then the original package, by both authors, still
>> exists (and a final version could point to the new one) and the new
>> package, citing the previous version appropriately, is by a single author.
> 
> No, copyright remains. You can fork given the license permits it, but there are still the same copyright holders ...
> 

To clarify, legally, you can fork a standard GPL package and make any changes you want, including changing authors fields etc. If you don't own copyright for the entire work then you cannot change the license without consent from the other copyright holders, otherwise you have all the rights as anyone else granted by the license.

However, CRAN policies go beyond that and say

"Where code is copied (or derived) from the work of others (including from R itself), care must be taken that any copyright/license statements are preserved and authorship is not misrepresented.
Preferably, an ?Authors at R? would be used with ?ctb? roles for the authors of such code. Alternatively, the ?Author? field should list these authors as contributors.
Where copyrights are held by an entity other than the package authors, this should preferably be indicated via ?cph? roles in the ?Authors at R? field, or using a ?Copyright? field (if necessary referring to an inst/COPYRIGHTS file)."

This means that CRAN will not accept a package where you did not list all copyright holders in one of the Author roles, although it is legal for you to do so outside of CRAN.

Cheers,
Simon


> Best,
> Uwe Ligges
> 
> 
> 
>> 
>> The page of CRAN's policies doesn't seem to touch on forking, presumably
>> because it's out of scope.
>> 
>> Best wishes,
>> 
>> Andrew
>> 
>> 
>> 
>> On Tue, Oct 6, 2015 at 8:22 AM, Uwe Ligges <ligges at statistik.tu-dortmund.de>
>> wrote:
>> 
>>> Simply advice:
>>> 
>>> The former co-author contributed, so he is still author and probably
>>> copyright holder and has to be listed among the authors, otherwise it would
>>> be a CRAN policy violation since even if he does not develop further on, he
>>> developed parts of the so far existing package (if you talk about a CRAN
>>> package).
>>> 
>>> I am not a lawyer, hence I cannot speak for copyright/license stuff in
>>> general, hence my comments only about CRAN policies.
>>> 
>>> 
>>> Best,
>>> Uwe Ligges
>>> 
>>> 
>>> 
>>> On 05.10.2015 23:02, Adrian Du?a wrote:
>>> 
>>>> Dear R developers,
>>>> 
>>>> This is a rather peculiar question, but nevertheless I would still need an
>>>> answer for.
>>>> It is about an R package which I created (namely QCA), and from versions
>>>> 1.0-0 to 1.1-4 I had a co-author.
>>>> The co-author recently withdrawn from the package development, but still
>>>> requires to be left in the authors list and be cited for the package in
>>>> the
>>>> CITATION file.
>>>> 
>>>> Obviously, one could not require citations for further developments, but
>>>> don't know how exactly to proceed (I would like to be fair and comply to
>>>> rules).
>>>> 
>>>> I have three options:
>>>> 
>>>> 1. Since the co-author withdrawn from the package development, erase his
>>>> name from the list of authors (but duly recognising his past contribution
>>>> in the package description file)
>>>> 
>>>> 2. Preserve his name in the list of authors (with the comment "up to
>>>> version 1.1-4"), but erasing his name from the citation file
>>>> 
>>>> 3. Keep his name both in the authors list and in the citation file
>>>> indefinitely, even though he doesn't do any development work anymore (I
>>>> have been threatened with a legal process for plagiarism if I did
>>>> otherwise).
>>>> 
>>>> My gut feeling is, since his name is related to the previous versions,
>>>> anyone using those versions would cite him as well, but otherwise I don't
>>>> feel comfortable citing my former co-author for the current work he hasn't
>>>> contributed to.
>>>> 
>>>> At this point, I would really use an advice, as on the other hand I
>>>> wouldn't want to break any regulation I might not be aware of.
>>>> 
>>>> Best wishes,
>>>> Adrian
>>>> 
>>>> 
>>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>> 
>> 
>> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From mattjdowle at gmail.com  Tue Oct  6 02:25:01 2015
From: mattjdowle at gmail.com (Matt Dowle)
Date: Mon, 5 Oct 2015 17:25:01 -0700
Subject: [Rd] Error generated by .Internal(nchar) disappears when
	debugging
In-Reply-To: <56130E61.8060007@gmail.com>
References: <CAO1zAVYsOWG0QSVdU_wex-Y2U3KD3YEtGJu5nH5zNc8dCzm5ig@mail.gmail.com>
	<loom.20151006T011642-505@post.gmane.org> <56130E61.8060007@gmail.com>
Message-ID: <CAOuOy3fA4hx3_ZHDEVyhy=3droVg2FK80s+dnaTN9MrJaQhMbw@mail.gmail.com>

On Mon, Oct 5, 2015 at 4:57 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 05/10/2015 7:24 PM, Matt Dowle wrote:
> > Joris Meys <jorismeys <at> gmail.com> writes:
> >
> >>
> >> Hi all,
> >>
> >> I have a puzzling problem related to nchar. In R 3.2.1, the internal
> > nchar
> >> gained an extra argument (see
> >> https://stat.ethz.ch/pipermail/r-announce/2015/000586.html)
> >>
> >> I've been testing code using the package copula, and at home I'm still
> >> running R 3.2.0 (I know, I know...). When trying the following code, I
> > got
> >> an error:
> >>
> >>> library(copula)
> >>> fgmCopula(0.8)
> >> Error in substr(sc[i], 2, nchar(sc[i]) - 1) :
> >>   4 arguments passed to .Internal(nchar) which requires 3
> >>
> >> Cheers
> >> Joris
> >
> >
> > I'm seeing a similar problem. IIUC, the Windows binary .zip from CRAN of
> > any package using base::nchar is affected. Could someone check my answer
> > here is correct please : http://stackoverflow.com/a/32959306/403310
>
> Nobody has posted a simple reproducible example here, so it's kind of
> hard to say.
>
> I would have guessed that a change to the internal signature of the C
> code underlying nchar() wouldn't have any effect on a package that
> called the R nchar() function.
>
> When I put together my own example (a tiny package containing a function
> calling nchar(), built to .zip using R 3.2.2, installed into R 3.2.0),
> it confirmed my guess.
>
> On the other hand, if some package is calling the .Internal function
> directly, I'd expect that to break.  Packages shouldn't do that.
>
> So I'd say there's been no evidence posted of a problem in R here,
> though there may be problems in some of the packages involved.  I'd
> welcome an example that provided some usable evidence.
>
> Duncan Murdoch
>
>
I don't have Windows so am not able to test unfortunately.
data.table makes no calls to .Internal(). Such calls are caught and
prevented by R CMD check.
Both data.table and copula contain "ByteCompile: yes" in their DESCRIPTION
files.  Does the toy package break with that setting?
Matt

	[[alternative HTML version deleted]]


From wdunlap at tibco.com  Tue Oct  6 02:40:53 2015
From: wdunlap at tibco.com (William Dunlap)
Date: Mon, 5 Oct 2015 17:40:53 -0700
Subject: [Rd] Error generated by .Internal(nchar) disappears when
	debugging
In-Reply-To: <56130E61.8060007@gmail.com>
References: <CAO1zAVYsOWG0QSVdU_wex-Y2U3KD3YEtGJu5nH5zNc8dCzm5ig@mail.gmail.com>
	<loom.20151006T011642-505@post.gmane.org> <56130E61.8060007@gmail.com>
Message-ID: <CAF8bMcZVihhK1No4mNG9a1Azp-EdAFbA7uD=JO4CQXch75aY9Q@mail.gmail.com>

I can reproduce the problem by running R-3.2.0 (on Windows),
installing copula from CRAN,
and then using it:

> install.packages("copula")
Installing package into 'C:/Program Files/R/R-3.2.0/site-library'
(as 'lib' is unspecified)
also installing the dependencies 'gsl', 'ADGofTest', 'pspline'

Warning: unable to access index for repository
http://bioconductor.org/packages/2.12/data/annotation/bin/windows/contrib/3.2
Warning: unable to access index for repository
http://bioconductor.org/packages/2.12/data/experiment/bin/windows/contrib/3.2
trying URL 'http://cran.rstudio.com/bin/windows/contrib/3.2/gsl_1.9-10.zip'
Content type 'application/zip' length 1121688 bytes (1.1 MB)
downloaded 1.1 MB

trying URL 'http://cran.rstudio.com/bin/windows/contrib/3.2/ADGofTest_0.3.zip'
Content type 'application/zip' length 13378 bytes (13 KB)
downloaded 13 KB

trying URL 'http://cran.rstudio.com/bin/windows/contrib/3.2/pspline_1.0-17.zip'
Content type 'application/zip' length 58343 bytes (56 KB)
downloaded 56 KB

trying URL 'http://cran.rstudio.com/bin/windows/contrib/3.2/copula_0.999-13.zip'
Content type 'application/zip' length 3792158 bytes (3.6 MB)
downloaded 3.6 MB

package 'gsl' successfully unpacked and MD5 sums checked
package 'ADGofTest' successfully unpacked and MD5 sums checked
package 'pspline' successfully unpacked and MD5 sums checked
package 'copula' successfully unpacked and MD5 sums checked

The downloaded binary packages are in
        C:\Users\wdunlap\AppData\Local\Temp\RtmpeurJX7\downloaded_packages
> library(copula)
Warning message:
package 'copula' was built under R version 3.2.2
> fgmCopula(0.8)
Error in substr(sc[i], 2, nchar(sc[i]) - 1) :
  4 arguments passed to .Internal(nchar) which requires 3
Bill Dunlap
TIBCO Software
wdunlap tibco.com


On Mon, Oct 5, 2015 at 4:57 PM, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> On 05/10/2015 7:24 PM, Matt Dowle wrote:
>> Joris Meys <jorismeys <at> gmail.com> writes:
>>
>>>
>>> Hi all,
>>>
>>> I have a puzzling problem related to nchar. In R 3.2.1, the internal
>> nchar
>>> gained an extra argument (see
>>> https://stat.ethz.ch/pipermail/r-announce/2015/000586.html)
>>>
>>> I've been testing code using the package copula, and at home I'm still
>>> running R 3.2.0 (I know, I know...). When trying the following code, I
>> got
>>> an error:
>>>
>>>> library(copula)
>>>> fgmCopula(0.8)
>>> Error in substr(sc[i], 2, nchar(sc[i]) - 1) :
>>>   4 arguments passed to .Internal(nchar) which requires 3
>>>
>>> Cheers
>>> Joris
>>
>>
>> I'm seeing a similar problem. IIUC, the Windows binary .zip from CRAN of
>> any package using base::nchar is affected. Could someone check my answer
>> here is correct please : http://stackoverflow.com/a/32959306/403310
>
> Nobody has posted a simple reproducible example here, so it's kind of
> hard to say.
>
> I would have guessed that a change to the internal signature of the C
> code underlying nchar() wouldn't have any effect on a package that
> called the R nchar() function.
>
> When I put together my own example (a tiny package containing a function
> calling nchar(), built to .zip using R 3.2.2, installed into R 3.2.0),
> it confirmed my guess.
>
> On the other hand, if some package is calling the .Internal function
> directly, I'd expect that to break.  Packages shouldn't do that.
>
> So I'd say there's been no evidence posted of a problem in R here,
> though there may be problems in some of the packages involved.  I'd
> welcome an example that provided some usable evidence.
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch.duncan at gmail.com  Tue Oct  6 02:41:19 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 5 Oct 2015 20:41:19 -0400
Subject: [Rd] Error generated by .Internal(nchar) disappears when
 debugging
In-Reply-To: <CAOuOy3fA4hx3_ZHDEVyhy=3droVg2FK80s+dnaTN9MrJaQhMbw@mail.gmail.com>
References: <CAO1zAVYsOWG0QSVdU_wex-Y2U3KD3YEtGJu5nH5zNc8dCzm5ig@mail.gmail.com>
	<loom.20151006T011642-505@post.gmane.org> <56130E61.8060007@gmail.com>
	<CAOuOy3fA4hx3_ZHDEVyhy=3droVg2FK80s+dnaTN9MrJaQhMbw@mail.gmail.com>
Message-ID: <561318AF.4010402@gmail.com>

On 05/10/2015 8:25 PM, Matt Dowle wrote:
> 
> On Mon, Oct 5, 2015 at 4:57 PM, Duncan Murdoch <murdoch.duncan at gmail.com
> <mailto:murdoch.duncan at gmail.com>> wrote:
> 
>     On 05/10/2015 7:24 PM, Matt Dowle wrote:
>     > Joris Meys <jorismeys <at> gmail.com <http://gmail.com>> writes:
>     >
>     >>
>     >> Hi all,
>     >>
>     >> I have a puzzling problem related to nchar. In R 3.2.1, the internal
>     > nchar
>     >> gained an extra argument (see
>     >> https://stat.ethz.ch/pipermail/r-announce/2015/000586.html)
>     >>
>     >> I've been testing code using the package copula, and at home I'm
>     still
>     >> running R 3.2.0 (I know, I know...). When trying the following
>     code, I
>     > got
>     >> an error:
>     >>
>     >>> library(copula)
>     >>> fgmCopula(0.8)
>     >> Error in substr(sc[i], 2, nchar(sc[i]) - 1) :
>     >>   4 arguments passed to .Internal(nchar) which requires 3
>     >>
>     >> Cheers
>     >> Joris
>     >
>     >
>     > I'm seeing a similar problem. IIUC, the Windows binary .zip from
>     CRAN of
>     > any package using base::nchar is affected. Could someone check my
>     answer
>     > here is correct please : http://stackoverflow.com/a/32959306/403310
> 
>     Nobody has posted a simple reproducible example here, so it's kind of
>     hard to say.
> 
>     I would have guessed that a change to the internal signature of the C
>     code underlying nchar() wouldn't have any effect on a package that
>     called the R nchar() function.
> 
>     When I put together my own example (a tiny package containing a function
>     calling nchar(), built to .zip using R 3.2.2, installed into R 3.2.0),
>     it confirmed my guess.
> 
>     On the other hand, if some package is calling the .Internal function
>     directly, I'd expect that to break.  Packages shouldn't do that.
> 
>     So I'd say there's been no evidence posted of a problem in R here,
>     though there may be problems in some of the packages involved.  I'd
>     welcome an example that provided some usable evidence.
> 
>     Duncan Murdoch
> 
> 
> I don't have Windows so am not able to test unfortunately.
> data.table makes no calls to .Internal(). Such calls are caught and
> prevented by R CMD check.
> Both data.table and copula contain "ByteCompile: yes" in their
> DESCRIPTION files.  Does the toy package break with that setting?
> Matt
> 

That's it.  With "ByteCompile: yes" I get the same error.

I don't know if there's anything we can do about this now, but we should
be able to avoid it in the future.

Duncan Murdoch


From S.Ellison at LGCGroup.com  Tue Oct  6 13:58:38 2015
From: S.Ellison at LGCGroup.com (S Ellison)
Date: Tue, 6 Oct 2015 12:58:38 +0100
Subject: [Rd] authorship and citation
In-Reply-To: <5612EA11.7080805@statistik.tu-dortmund.de>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
Message-ID: <1A8C1289955EF649A09086A153E2672403B485C5DD@GBTEDVPEXCMB04.corp.lgc-group.com>

> The former co-author contributed, so he is still author and probably copyright
> holder and has to be listed among the authors, otherwise it would be a CRAN
> policy violation ...

It's a bit of a philosophical question right now, but at some point in a developing package's life - particularly one that starts small but is subsequently refactored in growth - there may be no code left that was contributed by the original developer.

Is there a point at which the original developer should not stay on the author list?

S Ellison



*******************************************************************
This email and any attachments are confidential. Any use, copying or
disclosure other than by the intended recipient is unauthorised. If 
you have received this message in error, please notify the sender 
immediately via +44(0)20 8943 7000 or notify postmaster at lgcgroup.com 
and delete this message and any copies from your computer and network. 
LGC Limited. Registered in England 2991879. 
Registered office: Queens Road, Teddington, Middlesex, TW11 0LY, UK

From plummerm at iarc.fr  Tue Oct  6 14:18:24 2015
From: plummerm at iarc.fr (Martyn Plummer)
Date: Tue, 6 Oct 2015 12:18:24 +0000
Subject: [Rd] authorship and citation
In-Reply-To: <1A8C1289955EF649A09086A153E2672403B485C5DD@GBTEDVPEXCMB04.corp.lgc-group.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>,
	<1A8C1289955EF649A09086A153E2672403B485C5DD@GBTEDVPEXCMB04.corp.lgc-group.com>
Message-ID: <017F00C3-C54D-488C-8156-288CC01E457C@iarc.fr>




On 06 Oct 2015, at 14:09, S Ellison <S.Ellison at lgcgroup.com> wrote:

>> The former co-author contributed, so he is still author and probably copyright
>> holder and has to be listed among the authors, otherwise it would be a CRAN
>> policy violation ...
> 
> It's a bit of a philosophical question right now, but at some point in a developing package's life - particularly one that starts small but is subsequently refactored in growth - there may be no code left that was contributed by the original developer.

That is indeed the philosophical question of the ship of Theseus.

Martyn

> Is there a point at which the original developer should not stay on the author list?
> 
> S Ellison
> 
> 
> 
> *******************************************************************
> This email and any attachments are confidential. Any u...{{dropped:19}}


From simon.urbanek at r-project.org  Tue Oct  6 14:32:52 2015
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 6 Oct 2015 08:32:52 -0400
Subject: [Rd] authorship and citation
In-Reply-To: <1A8C1289955EF649A09086A153E2672403B485C5DD@GBTEDVPEXCMB04.corp.lgc-group.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<1A8C1289955EF649A09086A153E2672403B485C5DD@GBTEDVPEXCMB04.corp.lgc-group.com>
Message-ID: <49285CA2-77F9-473F-9196-3D1D2F2F0937@r-project.org>


On Oct 6, 2015, at 7:58 AM, S Ellison <S.Ellison at LGCGroup.com> wrote:

>> The former co-author contributed, so he is still author and probably copyright
>> holder and has to be listed among the authors, otherwise it would be a CRAN
>> policy violation ...
> 
> It's a bit of a philosophical question right now, but at some point in a developing package's life - particularly one that starts small but is subsequently refactored in growth - there may be no code left that was contributed by the original developer.
> 
> Is there a point at which the original developer should not stay on the author list?
> 

CRAN policies only require the presence of copyright holders, so if there is no content left to which the original author has copyright, then s/he doesn't need to be listed. Note that this extends to all the content, not just code.

Cheers,
S


> S Ellison
> 
> 
> 
> *******************************************************************
> This email and any attachments are confidential. Any u...{{dropped:14}}


From ripley at stats.ox.ac.uk  Tue Oct  6 14:38:05 2015
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 6 Oct 2015 13:38:05 +0100
Subject: [Rd] authorship and citation
In-Reply-To: <1A8C1289955EF649A09086A153E2672403B485C5DD@GBTEDVPEXCMB04.corp.lgc-group.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<1A8C1289955EF649A09086A153E2672403B485C5DD@GBTEDVPEXCMB04.corp.lgc-group.com>
Message-ID: <5613C0AD.80505@stats.ox.ac.uk>

On 06/10/2015 12:58, S Ellison wrote:

(quoting without attribution to the author, who would appear to be Uwe 
Liggges).

>> The former co-author contributed, so he is still author and probably copyright
>> holder and has to be listed among the authors, otherwise it would be a CRAN
>> policy violation ...
>
> It's a bit of a philosophical question right now, but at some point in a developing package's life - particularly one that starts small but is subsequently refactored in growth - there may be no code left that was contributed by the original developer.
>
> Is there a point at which the original developer should not stay on the author list?

Authorship is not just about code.  For example, there are functions in 
R which have been completely recoded, but the design and documentation 
remain.  Copyright can apply to designs and there is shading between 
inspiration and infringement.   And many of us believe that inspiration 
should be credited as a moral even if not a legal obligation.

As in "George Washington's axe" and similar myths, if all the parts are 
replaced it remains of the original design.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford
1 South Parks Road, Oxford OX1 3TG, UK


From jorismeys at gmail.com  Tue Oct  6 14:48:53 2015
From: jorismeys at gmail.com (Joris Meys)
Date: Tue, 6 Oct 2015 14:48:53 +0200
Subject: [Rd] Error generated by .Internal(nchar) disappears when
	debugging
In-Reply-To: <56130E61.8060007@gmail.com>
References: <CAO1zAVYsOWG0QSVdU_wex-Y2U3KD3YEtGJu5nH5zNc8dCzm5ig@mail.gmail.com>
	<loom.20151006T011642-505@post.gmane.org>
	<56130E61.8060007@gmail.com>
Message-ID: <CAO1zAVZZtGsgJWzLfZAb5gn0YMdZaq1PB3cfPuATzRdjOrLsLA@mail.gmail.com>

On Tue, Oct 6, 2015 at 1:57 AM, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 05/10/2015 7:24 PM, Matt Dowle wrote:
> > Joris Meys <jorismeys <at> gmail.com> writes:
> >
> >>
> >> Hi all,
> >>
> >> I have a puzzling problem related to nchar. In R 3.2.1, the internal
> > nchar
> >> gained an extra argument (see
> >> https://stat.ethz.ch/pipermail/r-announce/2015/000586.html)
> >>
> >> I've been testing code using the package copula, and at home I'm still
> >> running R 3.2.0 (I know, I know...). When trying the following code, I
> > got
> >> an error:
> >>
> >>> library(copula)
> >>> fgmCopula(0.8)
> >> Error in substr(sc[i], 2, nchar(sc[i]) - 1) :
> >>   4 arguments passed to .Internal(nchar) which requires 3
> >>
> >> Cheers
> >> Joris
> >
> >
> > I'm seeing a similar problem. IIUC, the Windows binary .zip from CRAN of
> > any package using base::nchar is affected. Could someone check my answer
> > here is correct please : http://stackoverflow.com/a/32959306/403310
>
> Nobody has posted a simple reproducible example here, so it's kind of
> hard to say.
>

You're free to try the simple reproducible example I've provided in my
original question. Tried that out on 3 different computers, and I got the
same behaviour 3 times.


>
> I would have guessed that a change to the internal signature of the C
> code underlying nchar() wouldn't have any effect on a package that
> called the R nchar() function.
>
> When I put together my own example (a tiny package containing a function
> calling nchar(), built to .zip using R 3.2.2, installed into R 3.2.0),
> it confirmed my guess.
>
> On the other hand, if some package is calling the .Internal function
> directly, I'd expect that to break.  Packages shouldn't do that.
>

I never said the package called the internal function, because it doesn't.
The error message reports there's an error in substr(sc[i], 2, nchar(sc[i])
- 1). Then it continues to indicate the problem occurs at the moment
nchar() calles the internal function. That's how the core team wrote the
nchar() function.


> So I'd say there's been no evidence posted of a problem in R here,
> though there may be problems in some of the packages involved.  I'd
> welcome an example that provided some usable evidence.
>

With all due respect for your involvement in and knowledge about R, I have
the impression you read too quickly through the mail. There is a problem
and it is reproducible. I'm just not smart enough to figure out how the
problem came about.

Kind regards
Joris


>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Mathematical Modelling, Statistics and Bio-Informatics

tel :  +32 (0)9 264 61 79
Joris.Meys at Ugent.be
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php

	[[alternative HTML version deleted]]


From edd at debian.org  Tue Oct  6 14:55:20 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 6 Oct 2015 07:55:20 -0500
Subject: [Rd] authorship and citation
In-Reply-To: <5613C0AD.80505@stats.ox.ac.uk>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<1A8C1289955EF649A09086A153E2672403B485C5DD@GBTEDVPEXCMB04.corp.lgc-group.com>
	<5613C0AD.80505@stats.ox.ac.uk>
Message-ID: <22035.50360.739715.68802@max.nulle.part>


On 6 October 2015 at 13:38, Prof Brian Ripley wrote:
| Authorship is not just about code.

An fair credit about is the only currency we have in Open Source projects.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From jorismeys at gmail.com  Tue Oct  6 15:00:27 2015
From: jorismeys at gmail.com (Joris Meys)
Date: Tue, 6 Oct 2015 15:00:27 +0200
Subject: [Rd] Error generated by .Internal(nchar) disappears when
	debugging
In-Reply-To: <561318AF.4010402@gmail.com>
References: <CAO1zAVYsOWG0QSVdU_wex-Y2U3KD3YEtGJu5nH5zNc8dCzm5ig@mail.gmail.com>
	<loom.20151006T011642-505@post.gmane.org>
	<56130E61.8060007@gmail.com>
	<CAOuOy3fA4hx3_ZHDEVyhy=3droVg2FK80s+dnaTN9MrJaQhMbw@mail.gmail.com>
	<561318AF.4010402@gmail.com>
Message-ID: <CAO1zAVbYv-L1G-T1nLOfebdESi33TB6qE-s7KoQqrX3CRJ5SVA@mail.gmail.com>

Thank you for looking at the issue. I've tried it with a tiny package
myself and I get the same results. So the problem should solve itself in
time.
Also thank you Michael for explaining the difference in behaviour when
debugging.

Cheers
Joris

On Tue, Oct 6, 2015 at 2:41 AM, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 05/10/2015 8:25 PM, Matt Dowle wrote:
> >
> > On Mon, Oct 5, 2015 at 4:57 PM, Duncan Murdoch <murdoch.duncan at gmail.com
> > <mailto:murdoch.duncan at gmail.com>> wrote:
> >
> >     On 05/10/2015 7:24 PM, Matt Dowle wrote:
> >     > Joris Meys <jorismeys <at> gmail.com <http://gmail.com>> writes:
> >     >
> >     >>
> >     >> Hi all,
> >     >>
> >     >> I have a puzzling problem related to nchar. In R 3.2.1, the
> internal
> >     > nchar
> >     >> gained an extra argument (see
> >     >> https://stat.ethz.ch/pipermail/r-announce/2015/000586.html)
> >     >>
> >     >> I've been testing code using the package copula, and at home I'm
> >     still
> >     >> running R 3.2.0 (I know, I know...). When trying the following
> >     code, I
> >     > got
> >     >> an error:
> >     >>
> >     >>> library(copula)
> >     >>> fgmCopula(0.8)
> >     >> Error in substr(sc[i], 2, nchar(sc[i]) - 1) :
> >     >>   4 arguments passed to .Internal(nchar) which requires 3
> >     >>
> >     >> Cheers
> >     >> Joris
> >     >
> >     >
> >     > I'm seeing a similar problem. IIUC, the Windows binary .zip from
> >     CRAN of
> >     > any package using base::nchar is affected. Could someone check my
> >     answer
> >     > here is correct please :
> http://stackoverflow.com/a/32959306/403310
> >
> >     Nobody has posted a simple reproducible example here, so it's kind of
> >     hard to say.
> >
> >     I would have guessed that a change to the internal signature of the C
> >     code underlying nchar() wouldn't have any effect on a package that
> >     called the R nchar() function.
> >
> >     When I put together my own example (a tiny package containing a
> function
> >     calling nchar(), built to .zip using R 3.2.2, installed into R
> 3.2.0),
> >     it confirmed my guess.
> >
> >     On the other hand, if some package is calling the .Internal function
> >     directly, I'd expect that to break.  Packages shouldn't do that.
> >
> >     So I'd say there's been no evidence posted of a problem in R here,
> >     though there may be problems in some of the packages involved.  I'd
> >     welcome an example that provided some usable evidence.
> >
> >     Duncan Murdoch
> >
> >
> > I don't have Windows so am not able to test unfortunately.
> > data.table makes no calls to .Internal(). Such calls are caught and
> > prevented by R CMD check.
> > Both data.table and copula contain "ByteCompile: yes" in their
> > DESCRIPTION files.  Does the toy package break with that setting?
> > Matt
> >
>
> That's it.  With "ByteCompile: yes" I get the same error.
>
> I don't know if there's anything we can do about this now, but we should
> be able to avoid it in the future.
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Mathematical Modelling, Statistics and Bio-Informatics

tel :  +32 (0)9 264 61 79
Joris.Meys at Ugent.be
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Tue Oct  6 15:02:57 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 6 Oct 2015 09:02:57 -0400
Subject: [Rd] Error generated by .Internal(nchar) disappears when
 debugging
In-Reply-To: <CAO1zAVZZtGsgJWzLfZAb5gn0YMdZaq1PB3cfPuATzRdjOrLsLA@mail.gmail.com>
References: <CAO1zAVYsOWG0QSVdU_wex-Y2U3KD3YEtGJu5nH5zNc8dCzm5ig@mail.gmail.com>
	<loom.20151006T011642-505@post.gmane.org> <56130E61.8060007@gmail.com>
	<CAO1zAVZZtGsgJWzLfZAb5gn0YMdZaq1PB3cfPuATzRdjOrLsLA@mail.gmail.com>
Message-ID: <5613C681.8070506@gmail.com>

On 06/10/2015 8:48 AM, Joris Meys wrote:
> 
> 
> On Tue, Oct 6, 2015 at 1:57 AM, Duncan Murdoch <murdoch.duncan at gmail.com
> <mailto:murdoch.duncan at gmail.com>> wrote:
> 
>     On 05/10/2015 7:24 PM, Matt Dowle wrote:
>     > Joris Meys <jorismeys <at> gmail.com <http://gmail.com>> writes:
>     >
>     >>
>     >> Hi all,
>     >>
>     >> I have a puzzling problem related to nchar. In R 3.2.1, the internal
>     > nchar
>     >> gained an extra argument (see
>     >> https://stat.ethz.ch/pipermail/r-announce/2015/000586.html)
>     >>
>     >> I've been testing code using the package copula, and at home I'm still
>     >> running R 3.2.0 (I know, I know...). When trying the following code, I
>     > got
>     >> an error:
>     >>
>     >>> library(copula)
>     >>> fgmCopula(0.8)
>     >> Error in substr(sc[i], 2, nchar(sc[i]) - 1) :
>     >>   4 arguments passed to .Internal(nchar) which requires 3
>     >>
>     >> Cheers
>     >> Joris
>     >
>     >
>     > I'm seeing a similar problem. IIUC, the Windows binary .zip from CRAN of
>     > any package using base::nchar is affected. Could someone check my answer
>     > here is correct please : http://stackoverflow.com/a/32959306/403310
> 
>     Nobody has posted a simple reproducible example here, so it's kind of
>     hard to say.
> 
> 
> You're free to try the simple reproducible example I've provided in my
> original question. Tried that out on 3 different computers, and I got
> the same behaviour 3 times.

As I posted yesterday, with Matt's help I was able to find a simple
reproduction of the bug.

The reason I wouldn't count your original post as a simple reproducible
example (and the same applies to what I saw on Stack Overflow), was that
it required a fairly large package (copula) in the demonstration.  I'm
not familiar with the internals of that package (or Matt's package
discussed on Stack Overflow), so it would be a lot of work for me to
identify what it was in them that triggered the bug.  If the bug had
required those packages and couldn't be demonstrated without them, then
it would likely be a bug in those packages, not in R.


>  
> 
> 
>     I would have guessed that a change to the internal signature of the C
>     code underlying nchar() wouldn't have any effect on a package that
>     called the R nchar() function.
> 
>     When I put together my own example (a tiny package containing a function
>     calling nchar(), built to .zip using R 3.2.2, installed into R 3.2.0),
>     it confirmed my guess.
> 
>     On the other hand, if some package is calling the .Internal function
>     directly, I'd expect that to break.  Packages shouldn't do that.
> 
> 
> I never said the package called the internal function, because it
> doesn't. The error message reports there's an error insubstr(sc[i], 2,
> nchar(sc[i]) - 1). Then it continues to indicate the problem occurs at
> the moment nchar() calles the internal function. That's how the core
> team wrote the nchar() function.
> 
> 
>     So I'd say there's been no evidence posted of a problem in R here,
>     though there may be problems in some of the packages involved.  I'd
>     welcome an example that provided some usable evidence.
> 
> 
> With all due respect for your involvement in and knowledge about R, I
> have the impression you read too quickly through the mail. There is a
> problem and it is reproducible. I'm just not smart enough to figure out
> how the problem came about.
> 

I sometimes do read too quickly and miss important details, but I don't
think I did in this case.

Duncan Murdoch


From jorismeys at gmail.com  Tue Oct  6 15:13:39 2015
From: jorismeys at gmail.com (Joris Meys)
Date: Tue, 6 Oct 2015 15:13:39 +0200
Subject: [Rd] Error generated by .Internal(nchar) disappears when
	debugging
In-Reply-To: <5613C681.8070506@gmail.com>
References: <CAO1zAVYsOWG0QSVdU_wex-Y2U3KD3YEtGJu5nH5zNc8dCzm5ig@mail.gmail.com>
	<loom.20151006T011642-505@post.gmane.org>
	<56130E61.8060007@gmail.com>
	<CAO1zAVZZtGsgJWzLfZAb5gn0YMdZaq1PB3cfPuATzRdjOrLsLA@mail.gmail.com>
	<5613C681.8070506@gmail.com>
Message-ID: <CAO1zAVYCD8hJhJ5j0T0tKQftjvZEQsEaFZonijgwZGB2m+2JwA@mail.gmail.com>

On Tue, Oct 6, 2015 at 3:02 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 06/10/2015 8:48 AM, Joris Meys wrote:
>
>
> The reason I wouldn't count your original post as a simple reproducible
> example (and the same applies to what I saw on Stack Overflow), was that
> it required a fairly large package (copula) in the demonstration.  I'm
> not familiar with the internals of that package (or Matt's package
> discussed on Stack Overflow), so it would be a lot of work for me to
> identify what it was in them that triggered the bug.  If the bug had
> required those packages and couldn't be demonstrated without them, then
> it would likely be a bug in those packages, not in R.
>

Dear Duncan,

thank you for the help and the extra clarification. I'll keep it in mind
for the future.
Cheers
Joris

-- 
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Mathematical Modelling, Statistics and Bio-Informatics

tel :  +32 (0)9 264 61 79
Joris.Meys at Ugent.be
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php

	[[alternative HTML version deleted]]


From dusa.adrian at unibuc.ro  Tue Oct  6 18:55:43 2015
From: dusa.adrian at unibuc.ro (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Tue, 6 Oct 2015 19:55:43 +0300
Subject: [Rd] authorship and citation
In-Reply-To: <8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
Message-ID: <CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>

On Tue, Oct 6, 2015 at 3:06 AM, Simon Urbanek <simon.urbanek at r-project.org>
wrote:

>
> [...]
>
> To clarify, legally, you can fork a standard GPL package and make any
> changes you want, including changing authors fields etc. If you don't own
> copyright for the entire work then you cannot change the license without
> consent from the other copyright holders, otherwise you have all the rights
> as anyone else granted by the license.
>
> However, CRAN policies go beyond that and say
>
> "Where code is copied (or derived) from the work of others (including from
> R itself), care must be taken that any copyright/license statements are
> preserved and authorship is not misrepresented.
> Preferably, an ?Authors at R? would be used with ?ctb? roles for the authors
> of such code. Alternatively, the ?Author? field should list these authors
> as contributors.
> Where copyrights are held by an entity other than the package authors,
> this should preferably be indicated via ?cph? roles in the ?Authors at R?
> field, or using a ?Copyright? field (if necessary referring to an
> inst/COPYRIGHTS file)."
>
> This means that CRAN will not accept a package where you did not list all
> copyright holders in one of the Author roles, although it is legal for you
> to do so outside of CRAN.
>


Please pardon my delay, I am writing from California and it's still morning
here.
I understand very well that I need to keep the previous co-author in the
list of authors, and duly acknowledge his contribution.
I would still be interested in the formal rules of compiling the citation
file (example package Rcmdr), but for the moment it can be automatically
generated via citation("QCA").

Both of these are perfectly compliant with the CRAN policies.

As another attempt to solve the matter, I wonder if any rules would be
broken if I used the .onAttach(...) function to print a message in the line
of:

> library(QCA)

Users are encouraged to cite this package as:

  Dusa, Adrian (2015). QCA: Qualitative Comparative Analysis. R Package
Version 1.2-0,
  URL: http://cran.r-project.org/package=QCA

This is just an encouragement, not a requirement, and the official citation
file meets the CRAN policies. Would that be acceptable?

Best wishes,
Adrian


-- 
Adrian Dusa
University of Bucharest
Romanian Social Data Archive
Soseaua Panduri nr.90
050663 Bucharest sector 5
Romania

	[[alternative HTML version deleted]]


From gmbecker at ucdavis.edu  Tue Oct  6 21:59:06 2015
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Tue, 6 Oct 2015 12:59:06 -0700
Subject: [Rd] authorship and citation
In-Reply-To: <CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
Message-ID: <CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>

Adrian,

I am not on the CRAN  or R-core teams, so the following is my own view,
but...

> library(QCA)
>
> Users are encouraged to cite this package as:
>
>   Dusa, Adrian (2015). QCA: Qualitative Comparative Analysis. R Package
> Version 1.2-0,
>   URL: http://cran.r-project.org/package=QCA
>
> This is just an encouragement, not a requirement, and the official citation
> file meets the CRAN policies. Would that be acceptable?
>


At the very least, this is seems to be a flagrant violation of the *spirit*
of the CRAN policy, which AFAIK is intended to enforce acknowledgement of
the contributions of all copyright holders in the package. The fact that
you are trying to bypass the policy by suggesting users use an unofficial
citation which would not comply with the policy while maintaining an
official one which complies, but which you don't want users to see  is
probably a suggestion that you shouldn't do that.

Best,
~G


>
> Best wishes,
> Adrian
>
>
> --
> Adrian Dusa
> University of Bucharest
> Romanian Social Data Archive
> Soseaua Panduri nr.90
> 050663 Bucharest sector 5
> Romania
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Gabriel Becker, PhD
Computational Biologist
Bioinformatics and Computational Biology
Genentech, Inc.

	[[alternative HTML version deleted]]


From thierry.onkelinx at inbo.be  Tue Oct  6 22:46:34 2015
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Tue, 6 Oct 2015 22:46:34 +0200
Subject: [Rd] authorship and citation
In-Reply-To: <CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
Message-ID: <CAJuCY5z0Q-wgFFeV7wNXwBiJa3wbn9QSPfh1smMcKes9R9OfgQ@mail.gmail.com>

Dear Adrian,

Have a look at the DESCRIPTION of the RODBC package. One of the authors was
contributing from 1999 to 2002. I have the feeling that your situation is
similar.

Best regards,

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

2015-10-06 18:55 GMT+02:00 Adrian Du?a <dusa.adrian at unibuc.ro>:

> On Tue, Oct 6, 2015 at 3:06 AM, Simon Urbanek <simon.urbanek at r-project.org
> >
> wrote:
>
> >
> > [...]
> >
> > To clarify, legally, you can fork a standard GPL package and make any
> > changes you want, including changing authors fields etc. If you don't own
> > copyright for the entire work then you cannot change the license without
> > consent from the other copyright holders, otherwise you have all the
> rights
> > as anyone else granted by the license.
> >
> > However, CRAN policies go beyond that and say
> >
> > "Where code is copied (or derived) from the work of others (including
> from
> > R itself), care must be taken that any copyright/license statements are
> > preserved and authorship is not misrepresented.
> > Preferably, an ?Authors at R? would be used with ?ctb? roles for the
> authors
> > of such code. Alternatively, the ?Author? field should list these authors
> > as contributors.
> > Where copyrights are held by an entity other than the package authors,
> > this should preferably be indicated via ?cph? roles in the ?Authors at R?
> > field, or using a ?Copyright? field (if necessary referring to an
> > inst/COPYRIGHTS file)."
> >
> > This means that CRAN will not accept a package where you did not list all
> > copyright holders in one of the Author roles, although it is legal for
> you
> > to do so outside of CRAN.
> >
>
>
> Please pardon my delay, I am writing from California and it's still morning
> here.
> I understand very well that I need to keep the previous co-author in the
> list of authors, and duly acknowledge his contribution.
> I would still be interested in the formal rules of compiling the citation
> file (example package Rcmdr), but for the moment it can be automatically
> generated via citation("QCA").
>
> Both of these are perfectly compliant with the CRAN policies.
>
> As another attempt to solve the matter, I wonder if any rules would be
> broken if I used the .onAttach(...) function to print a message in the line
> of:
>
> > library(QCA)
>
> Users are encouraged to cite this package as:
>
>   Dusa, Adrian (2015). QCA: Qualitative Comparative Analysis. R Package
> Version 1.2-0,
>   URL: http://cran.r-project.org/package=QCA
>
> This is just an encouragement, not a requirement, and the official citation
> file meets the CRAN policies. Would that be acceptable?
>
> Best wishes,
> Adrian
>
>
> --
> Adrian Dusa
> University of Bucharest
> Romanian Social Data Archive
> Soseaua Panduri nr.90
> 050663 Bucharest sector 5
> Romania
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From dusa.adrian at unibuc.ro  Tue Oct  6 22:58:54 2015
From: dusa.adrian at unibuc.ro (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Tue, 6 Oct 2015 23:58:54 +0300
Subject: [Rd] authorship and citation
In-Reply-To: <CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
	<CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>
Message-ID: <CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>

Hi Gabriel,

On Tue, Oct 6, 2015 at 10:59 PM, Gabriel Becker <gmbecker at ucdavis.edu>
wrote:

> [...]
>
> At the very least, this is seems to be a flagrant violation of the
> *spirit* of the CRAN policy, which AFAIK is intended to enforce
> acknowledgement of the contributions of all copyright holders in the
> package. The fact that you are trying to bypass the policy by suggesting
> users use an unofficial citation which would not comply with the policy
> while maintaining an official one which complies, but which you don't want
> users to see  is probably a suggestion that you shouldn't do that.
>


But that is the very point: I read the CRAN policies twice, and there is no
official guideline on how to compile the citation.
Regarding the Source packages, the policies mention:

######
The ownership of copyright and intellectual property rights of all
components of the package must be clear and unambiguous (including from the
authors specification in the DESCRIPTION file). Where code is copied (or
derived) from the work of others (including from R itself), care must be
taken that any copyright/license statements are preserved and authorship is
not misrepresented.
Preferably, an ?Authors at R? would be used with ?ctb? roles for the authors
of such code. Alternatively, the ?Author? field should list these authors
as contributors.

Where copyrights are held by an entity other than the package authors, this
should preferably be indicated via ?cph? roles in the ?Authors at R? field, or
using a ?Copyright? field (if necessary referring to an inst/COPYRIGHTS
file).

Trademarks must be respected.
######

Now, that requirement is already met: the former author is still in the
authors' list. So the contribution of the former author is duly
acknowledged, but the fundamental issue of my question related to the
citation file, for which the CRAN policies doesn't offer any other
information.

If the spirit of the CRAN policies is to enforce citing each and every one
of the authors, then I don't understand why the citation from package Rcmdr
meets this spirit, while my suggestion doesn't.

I apologize for pushing this topic to the limit, but I haven't got an
answer to this question yet...

Best wishes,
Adrian

PS: @Thierry: I did take a look at RODBC, but the citation information is
generated automatically upon package installation (no other special file on
CRAN)

-- 
Adrian Dusa
University of Bucharest
Romanian Social Data Archive
Soseaua Panduri nr.90
050663 Bucharest sector 5
Romania

	[[alternative HTML version deleted]]


From dusa.adrian at unibuc.ro  Tue Oct  6 23:37:03 2015
From: dusa.adrian at unibuc.ro (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Wed, 7 Oct 2015 00:37:03 +0300
Subject: [Rd] authorship and citation
In-Reply-To: <CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
	<CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>
	<CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
Message-ID: <CAJ=0CtDmiUzzxm6HYPEZ6nWZ3JyG9dUry+06gfODtx5d4709AA@mail.gmail.com>

On Tue, Oct 6, 2015 at 11:58 PM, Adrian Du?a <dusa.adrian at unibuc.ro> wrote:
>
> [...]
> If the spirit of the CRAN policies is to enforce citing each and every
one of the authors, then I don't understand why the citation from package
Rcmdr meets this spirit, while my suggestion doesn't.
>
> I apologize for pushing this topic to the limit, but I haven't got an
answer to this question yet...


Out of curiosity, upon random checks there seem to be many other packages
in similar situations (which have multiple authors, but cite only a subset):
SamplingStrata
sandwich
SAVE
seawave

What all of these cases seem to have in common is an older published
journal article, and the citation adhered to that article irrespective of
how many authors subsequently contributed to that package.

Would it suffice to provide such an article, then?
Adrian

--
Adrian Dusa
University of Bucharest
Romanian Social Data Archive
Soseaua Panduri nr.90
050663 Bucharest sector 5
Romania

	[[alternative HTML version deleted]]


From gmbecker at ucdavis.edu  Tue Oct  6 23:39:30 2015
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Tue, 6 Oct 2015 14:39:30 -0700
Subject: [Rd] authorship and citation
In-Reply-To: <CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
	<CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>
	<CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
Message-ID: <CADwqtCO+72hW3xJp_tLq6Gb1EcbB+yP=ogEx_g8eBOU88XfLYw@mail.gmail.com>

Adrian,

Responses inline

On Tue, Oct 6, 2015 at 1:58 PM, Adrian Du?a <dusa.adrian at unibuc.ro> wrote:

> Hi Gabriel,
>
> On Tue, Oct 6, 2015 at 10:59 PM, Gabriel Becker <gmbecker at ucdavis.edu>
> wrote:
>
>> [...]
>>
>> At the very least, this is seems to be a flagrant violation of the
>> *spirit* of the CRAN policy, which AFAIK is intended to enforce
>> acknowledgement of the contributions of all copyright holders in the
>> package. The fact that you are trying to bypass the policy by suggesting
>> users use an unofficial citation which would not comply with the policy
>> while maintaining an official one which complies, but which you don't want
>> users to see  is probably a suggestion that you shouldn't do that.
>>
>
>
> But that is the very point: I read the CRAN policies twice, and there is
> no official guideline on how to compile the citation.
> Regarding the Source packages, the policies mention:
>

> ######
> The ownership of copyright and intellectual property rights of all
> components of the package must be clear and unambiguous (including from the
> authors specification in the DESCRIPTION file). Where code is copied (or
> derived) from the work of others (including from R itself), care must be
> taken that any copyright/license statements are preserved and authorship is
> not misrepresented.
> Preferably, an ?Authors at R? would be used with ?ctb? roles for the authors
> of such code. Alternatively, the ?Author? field should list these authors
> as contributors.
>
> Where copyrights are held by an entity other than the package authors,
> this should preferably be indicated via ?cph? roles in the ?Authors at R?
> field, or using a ?Copyright? field (if necessary referring to an
> inst/COPYRIGHTS file).
>
> Trademarks must be respected.
> ######
>
> Now, that requirement is already met: the former author is still in the
> authors' list. So the contribution of the former author is duly
> acknowledged, but the fundamental issue of my question related to the
> citation file, for which the CRAN policies doesn't offer any other
> information.
>

The citation mechanism, AFAIK, has two purposes. One is to associate a
published article/book/etc with an r package, where appropriate (and there
authorship and inclusion would need to meet the requirements of the
publishing journal). The other is to give a way for other works to cite the
work done in developing the package.

If you don't acknowledge that it is "heavily implied" that in the second
case all authors of the package should appear in the citation (this is
almost definitionally true of citations, I would think) I'm not really sure
what to tell you.

Approached from a different angle, what reason do you have for wanting the
other other to not appear in the citation for the package other than
minimizing/not acknowledging the copyright-holding work that he or she did
on the project?


>
> If the spirit of the CRAN policies is to enforce citing each and every one
> of the authors, then I don't understand why the citation from package Rcmdr
> meets this spirit, while my suggestion doesn't.
>

I don't have any knowledge of what Rcmdr does with regards to the citations
or the historical context that would make it relevant to the discussion
here.

>
> I apologize for pushing this topic to the limit, but I haven't got an
> answer to this question yet...
>

With respect, not receiving the answer you wanted isn't the same as not
receiving an answer.

Best,
~G


>
> Best wishes,
> Adrian
>
> PS: @Thierry: I did take a look at RODBC, but the citation information is
> generated automatically upon package installation (no other special file on
> CRAN)
>
> --
> Adrian Dusa
> University of Bucharest
> Romanian Social Data Archive
> Soseaua Panduri nr.90
> 050663 Bucharest sector 5
> Romania
>



-- 
Gabriel Becker, PhD
Computational Biologist
Bioinformatics and Computational Biology
Genentech, Inc.

	[[alternative HTML version deleted]]


From dusa.adrian at unibuc.ro  Tue Oct  6 23:52:33 2015
From: dusa.adrian at unibuc.ro (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Wed, 7 Oct 2015 00:52:33 +0300
Subject: [Rd] authorship and citation
In-Reply-To: <CADwqtCO+72hW3xJp_tLq6Gb1EcbB+yP=ogEx_g8eBOU88XfLYw@mail.gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
	<CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>
	<CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
	<CADwqtCO+72hW3xJp_tLq6Gb1EcbB+yP=ogEx_g8eBOU88XfLYw@mail.gmail.com>
Message-ID: <CAJ=0CtAt5-G_XYR2_PFnrJ9EGykqqhqtF5oJ0WEiJ8JVtsgHwA@mail.gmail.com>

Dear Gabriel,

On Wed, Oct 7, 2015 at 12:39 AM, Gabriel Becker <gmbecker at ucdavis.edu>
wrote:

> [...]
>
>>
>> I apologize for pushing this topic to the limit, but I haven't got an
>> answer to this question yet...
>>
>
> With respect, not receiving the answer you wanted isn't the same as not
> receiving an answer.
>

I very much appreciate your patience with me, and I am grateful for it.
The question is I believe very important, for I would like to avoid
submitting a new version of the package only to be told that I did
something wrong.

As so many other packages seem to have a lot of flexibility in compiling
the citation file, what I am inquiring is: will I be prosecuted for
submitting a new version which doesn't include all the authors in the
citation file, especially since the other author is no longer contributing?
(let's say I will provide a single author, published journal article,
referring specifically to this package).

The work of the other author is duly acknowledged in his position in the
authors' list.
As I previously wrote, citing Dusa and Other (2015) implies equal citation
rights for unequal work, a thing that I am uncomfortable with. There is a
huge amount of work being involved in this subsequent version, to which the
former author didn't contribute anything at all...

Best wishes,
Adrian

-- 
Adrian Dusa
University of Bucharest
Romanian Social Data Archive
Soseaua Panduri nr.90
050663 Bucharest sector 5
Romania

	[[alternative HTML version deleted]]


From gmbecker at ucdavis.edu  Wed Oct  7 00:07:27 2015
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Tue, 6 Oct 2015 15:07:27 -0700
Subject: [Rd] authorship and citation
In-Reply-To: <CAJ=0CtAt5-G_XYR2_PFnrJ9EGykqqhqtF5oJ0WEiJ8JVtsgHwA@mail.gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
	<CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>
	<CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
	<CADwqtCO+72hW3xJp_tLq6Gb1EcbB+yP=ogEx_g8eBOU88XfLYw@mail.gmail.com>
	<CAJ=0CtAt5-G_XYR2_PFnrJ9EGykqqhqtF5oJ0WEiJ8JVtsgHwA@mail.gmail.com>
Message-ID: <CADwqtCNAfymoSNWpaA8KJcae6K91_2TCz7pTkGzeuhK_igmAAg@mail.gmail.com>

On Tue, Oct 6, 2015 at 2:52 PM, Adrian Du?a <dusa.adrian at unibuc.ro> wrote:

> Dear Gabriel,
>
> On Wed, Oct 7, 2015 at 12:39 AM, Gabriel Becker <gmbecker at ucdavis.edu>
> wrote:
>
>> [...]
>>
>>>
>>> I apologize for pushing this topic to the limit, but I haven't got an
>>> answer to this question yet...
>>>
>>
>> With respect, not receiving the answer you wanted isn't the same as not
>> receiving an answer.
>>
>
> I very much appreciate your patience with me, and I am grateful for it.
> The question is I believe very important, for I would like to avoid
> submitting a new version of the package only to be told that I did
> something wrong.
>
> As so many other packages seem to have a lot of flexibility in compiling
> the citation file, what I am inquiring is: will I be prosecuted for
> submitting a new version which doesn't include all the authors in the
> citation file, especially since the other author is no longer contributing?
> (let's say I will provide a single author, published journal article,
> referring specifically to this package).
>

I am not part of CRAN, as I prefaced my initial response with, so I can't
speak to "prosecution". You will have to wait for them to respond (again)
for a definitive answer to that. I do think, however, that if you did this
specifically to disenfranchise your previous collaborator you would be
morally in the wrong, and substantially so.



>
> The work of the other author is duly acknowledged in his position in the
> authors' list.
> As I previously wrote, citing Dusa and Other (2015) implies equal citation
> rights for unequal work, a thing that I am uncomfortable with. There is a
> huge amount of work being involved in this subsequent version, to which the
> former author didn't contribute anything at all...
>

It really doesn't imply this at all, at least to me (and I don't think I'm
alone here).  In most authorship-listing schemes first author is the one
who did the most direct work (wrote the draft, in the case of an article).
On the other hand, citing Dusa (2015) implies NO work by Other in the
entity being cited. That is clearly and concretely not the case.

I will leave you with this, which may sound like a personal attack but I
assure you it is not: I myself would not consider collaborating with you on
a project given your apparent attitude towards the contributions of people
no longer actively working on projects you own.

Best,
~G


>
> Best wishes,
> Adrian
>
> --
> Adrian Dusa
> University of Bucharest
> Romanian Social Data Archive
> Soseaua Panduri nr.90
> 050663 Bucharest sector 5
> Romania
>



-- 
Gabriel Becker, PhD
Computational Biologist
Bioinformatics and Computational Biology
Genentech, Inc.

	[[alternative HTML version deleted]]


From dusa.adrian at unibuc.ro  Wed Oct  7 01:04:12 2015
From: dusa.adrian at unibuc.ro (=?UTF-8?B?QWRyaWFuIER1yJlh?=)
Date: Wed, 7 Oct 2015 02:04:12 +0300
Subject: [Rd] authorship and citation
In-Reply-To: <CADwqtCNAfymoSNWpaA8KJcae6K91_2TCz7pTkGzeuhK_igmAAg@mail.gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
	<CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>
	<CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
	<CADwqtCO+72hW3xJp_tLq6Gb1EcbB+yP=ogEx_g8eBOU88XfLYw@mail.gmail.com>
	<CAJ=0CtAt5-G_XYR2_PFnrJ9EGykqqhqtF5oJ0WEiJ8JVtsgHwA@mail.gmail.com>
	<CADwqtCNAfymoSNWpaA8KJcae6K91_2TCz7pTkGzeuhK_igmAAg@mail.gmail.com>
Message-ID: <CAJ=0CtDA_UEqur5YZA-ZCqbfibaP8nh_KESv+mKVBGkSQN5gSQ@mail.gmail.com>

On Wed, Oct 7, 2015 at 1:07 AM, Gabriel Becker <gmbecker at ucdavis.edu> wrote:

>
> [...]
>
>>
>> The work of the other author is duly acknowledged in his position in the
>> authors' list.
>> As I previously wrote, citing Dusa and Other (2015) implies equal
>> citation rights for unequal work, a thing that I am uncomfortable with.
>> There is a huge amount of work being involved in this subsequent version,
>> to which the former author didn't contribute anything at all...
>>
>
> It really doesn't imply this at all, at least to me (and I don't think I'm
> alone here).  In most authorship-listing schemes first author is the one
> who did the most direct work (wrote the draft, in the case of an article).
> On the other hand, citing Dusa (2015) implies NO work by Other in the
> entity being cited. That is clearly and concretely not the case.
>

That is another way of looking at things, but I don't necessarily agree
with you. It doesn't imply NO work, since that is duly recognised by the
presence of the Other in the authors' list.
And I have nevertheless changed my suggestion from Dusa (2015) with a
citation of a previous (older, 2007) article, one that laid the very
foundations for the package, and an article that the Other had also no
contribution at all.

Given that many other packages seem to have the liberty to do so, the
question is under what conditions do I have this liberty as well.

Best wishes,
Adrian


-- 
Adrian Dusa
University of Bucharest
Romanian Social Data Archive
Soseaua Panduri nr.90
050663 Bucharest sector 5
Romania

	[[alternative HTML version deleted]]


From S.Ellison at LGCGroup.com  Wed Oct  7 12:10:14 2015
From: S.Ellison at LGCGroup.com (S Ellison)
Date: Wed, 7 Oct 2015 11:10:14 +0100
Subject: [Rd] authorship and citation
In-Reply-To: <5613C0AD.80505@stats.ox.ac.uk>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<1A8C1289955EF649A09086A153E2672403B485C5DD@GBTEDVPEXCMB04.corp.lgc-group.com>
	<5613C0AD.80505@stats.ox.ac.uk>
Message-ID: <1A8C1289955EF649A09086A153E2672403B485C85F@GBTEDVPEXCMB04.corp.lgc-group.com>

> > Is there a point at which the original developer should not stay on the author
> list?
> 
> Authorship is not just about code.  For example, there are functions in R which
> have been completely recoded, but the design and documentation remain.
> Copyright can apply to designs and there is shading between
> inspiration and infringement.   And many of us believe that inspiration
> should be credited as a moral even if not a legal obligation.

"Once an author on CRAN, always an author on CRAN"* doesn't sound a bad maxim to work to.


*This statement should be cited** as
S L R Ellison, C L Dodgson, 'RE: [Rd] authorship and citation'. r-devel mailing list, 2015 with 
Acknowledgements: B Ripley, R-Core, S Urbanek for helpful remarks 

**following its own precepts :)


*******************************************************************
This email and any attachments are confidential. Any use, copying or
disclosure other than by the intended recipient is unauthorised. If 
you have received this message in error, please notify the sender 
immediately via +44(0)20 8943 7000 or notify postmaster at lgcgroup.com 
and delete this message and any copies from your computer and network. 
LGC Limited. Registered in England 2991879. 
Registered office: Queens Road, Teddington, Middlesex, TW11 0LY, UK

From h.wickham at gmail.com  Wed Oct  7 13:59:52 2015
From: h.wickham at gmail.com (Hadley Wickham)
Date: Wed, 7 Oct 2015 07:59:52 -0400
Subject: [Rd] authorship and citation
In-Reply-To: <CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
	<CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>
	<CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
Message-ID: <CABdHhvEgKF85d0vk2XDNVYDtPr-r10OCxxn+Rdm=FSijQLFa4g@mail.gmail.com>

On Tue, Oct 6, 2015 at 4:58 PM, Adrian Du?a <dusa.adrian at unibuc.ro> wrote:
> Hi Gabriel,
>
> On Tue, Oct 6, 2015 at 10:59 PM, Gabriel Becker <gmbecker at ucdavis.edu>
> wrote:
>
>> [...]
>>
>> At the very least, this is seems to be a flagrant violation of the
>> *spirit* of the CRAN policy, which AFAIK is intended to enforce
>> acknowledgement of the contributions of all copyright holders in the
>> package. The fact that you are trying to bypass the policy by suggesting
>> users use an unofficial citation which would not comply with the policy
>> while maintaining an official one which complies, but which you don't want
>> users to see  is probably a suggestion that you shouldn't do that.
>>
>
>
> But that is the very point: I read the CRAN policies twice, and there is no
> official guideline on how to compile the citation.
> Regarding the Source packages, the policies mention:
>
> ######
> The ownership of copyright and intellectual property rights of all
> components of the package must be clear and unambiguous (including from the
> authors specification in the DESCRIPTION file). Where code is copied (or
> derived) from the work of others (including from R itself), care must be
> taken that any copyright/license statements are preserved and authorship is
> not misrepresented.
> Preferably, an ?Authors at R? would be used with ?ctb? roles for the authors
> of such code. Alternatively, the ?Author? field should list these authors
> as contributors.
>
> Where copyrights are held by an entity other than the package authors, this
> should preferably be indicated via ?cph? roles in the ?Authors at R? field, or
> using a ?Copyright? field (if necessary referring to an inst/COPYRIGHTS
> file).
>
> Trademarks must be respected.
> ######
>
> Now, that requirement is already met: the former author is still in the
> authors' list. So the contribution of the former author is duly
> acknowledged, but the fundamental issue of my question related to the
> citation file, for which the CRAN policies doesn't offer any other
> information.
>
> If the spirit of the CRAN policies is to enforce citing each and every one
> of the authors, then I don't understand why the citation from package Rcmdr
> meets this spirit, while my suggestion doesn't.

I'd recommend that you read
https://cran.r-project.org/web/packages/shiny/DESCRIPTION and compare
it to citation("shiny"). Authors, but not contributors, all listed in
the citation.

Hadley

-- 
http://had.co.nz/


From gmbecker at ucdavis.edu  Wed Oct  7 16:23:51 2015
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Wed, 7 Oct 2015 07:23:51 -0700
Subject: [Rd] authorship and citation
In-Reply-To: <CABdHhvEgKF85d0vk2XDNVYDtPr-r10OCxxn+Rdm=FSijQLFa4g@mail.gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
	<CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>
	<CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
	<CABdHhvEgKF85d0vk2XDNVYDtPr-r10OCxxn+Rdm=FSijQLFa4g@mail.gmail.com>
Message-ID: <CADwqtCPN4GS-KWRDpxy0tk+LvPFB2hhty7mMJZHk-Za_6W9yPA@mail.gmail.com>

Hadley,

With all due respect, I'm not sure what exactly your deliniation between
author and contributor is, but from what I can tell I don't agree with it.

>From the blogpost regarding your new purrr package:

"Purrr wouldn?t be possible without Lionel Henry
<https://github.com/lionel->. He wrote a lot of the package and his
insightful comments ..."

And yet he is listed as a contributor in the DESCRIPTION file, and thus in
your view not worthy of being in the citation even as a non-first author?
That does not jive with what I understand to be "standard practice" with
regard to software-related publications, and it certainly isn't what I
would choose to do in that situation.

Best,
~G

On Wed, Oct 7, 2015 at 4:59 AM, Hadley Wickham <h.wickham at gmail.com> wrote:

> On Tue, Oct 6, 2015 at 4:58 PM, Adrian Du?a <dusa.adrian at unibuc.ro> wrote:
> > Hi Gabriel,
> >
> > On Tue, Oct 6, 2015 at 10:59 PM, Gabriel Becker <gmbecker at ucdavis.edu>
> > wrote:
> >
> >> [...]
> >>
> >> At the very least, this is seems to be a flagrant violation of the
> >> *spirit* of the CRAN policy, which AFAIK is intended to enforce
> >> acknowledgement of the contributions of all copyright holders in the
> >> package. The fact that you are trying to bypass the policy by suggesting
> >> users use an unofficial citation which would not comply with the policy
> >> while maintaining an official one which complies, but which you don't
> want
> >> users to see  is probably a suggestion that you shouldn't do that.
> >>
> >
> >
> > But that is the very point: I read the CRAN policies twice, and there is
> no
> > official guideline on how to compile the citation.
> > Regarding the Source packages, the policies mention:
> >
> > ######
> > The ownership of copyright and intellectual property rights of all
> > components of the package must be clear and unambiguous (including from
> the
> > authors specification in the DESCRIPTION file). Where code is copied (or
> > derived) from the work of others (including from R itself), care must be
> > taken that any copyright/license statements are preserved and authorship
> is
> > not misrepresented.
> > Preferably, an ?Authors at R? would be used with ?ctb? roles for the
> authors
> > of such code. Alternatively, the ?Author? field should list these authors
> > as contributors.
> >
> > Where copyrights are held by an entity other than the package authors,
> this
> > should preferably be indicated via ?cph? roles in the ?Authors at R?
> field, or
> > using a ?Copyright? field (if necessary referring to an inst/COPYRIGHTS
> > file).
> >
> > Trademarks must be respected.
> > ######
> >
> > Now, that requirement is already met: the former author is still in the
> > authors' list. So the contribution of the former author is duly
> > acknowledged, but the fundamental issue of my question related to the
> > citation file, for which the CRAN policies doesn't offer any other
> > information.
> >
> > If the spirit of the CRAN policies is to enforce citing each and every
> one
> > of the authors, then I don't understand why the citation from package
> Rcmdr
> > meets this spirit, while my suggestion doesn't.
>
> I'd recommend that you read
> https://cran.r-project.org/web/packages/shiny/DESCRIPTION and compare
> it to citation("shiny"). Authors, but not contributors, all listed in
> the citation.
>
> Hadley
>
> --
> http://had.co.nz/
>



-- 
Gabriel Becker, PhD
Computational Biologist
Bioinformatics and Computational Biology
Genentech, Inc.

	[[alternative HTML version deleted]]


From nico at nicolasdrouin.com  Wed Oct  7 16:59:00 2015
From: nico at nicolasdrouin.com (Nicolas Drouin)
Date: Wed, 7 Oct 2015 14:59:00 +0000
Subject: [Rd] A new CSS file for the offline documentation
Message-ID: <loom.20151007T165053-386@post.gmane.org>

I have made a new CSS file for the R offline documentation.

It's far easier to read, it's lightweight, looks good, cross-browsers,
responsive, and without any bug.

Now my problem is where should I post it so it can be used in the next
version ? And it's not an easy problem...

Any ideas?

The file is here : www.nicolasdrouin.com/R.css

There is no need to change the HTML part just to switch the old CSS files
with this new one.


From spencer.graves at prodsyse.com  Wed Oct  7 18:29:40 2015
From: spencer.graves at prodsyse.com (Spencer Graves)
Date: Wed, 7 Oct 2015 11:29:40 -0500
Subject: [Rd] authorship and citation
In-Reply-To: <CADwqtCPN4GS-KWRDpxy0tk+LvPFB2hhty7mMJZHk-Za_6W9yPA@mail.gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
	<CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>
	<CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
	<CABdHhvEgKF85d0vk2XDNVYDtPr-r10OCxxn+Rdm=FSijQLFa4g@mail.gmail.com>
	<CADwqtCPN4GS-KWRDpxy0tk+LvPFB2hhty7mMJZHk-Za_6W9yPA@mail.gmail.com>
Message-ID: <56154874.8020408@prodsyse.com>

An example from the sos package:  Its DESCRIPTION file says Author: 
Spencer Graves, Sundar Dorai-Raj, and Romain Francois.  However, the 
package includes a findFn function, whose help file includes an 
Author(s) section, which reads, "Spencer Graves, Sundar Dorai-Raj, 
Romain Francois.  Duncan Murdoch suggested the "???" alias for "findFn" 
and contributed the code for it.  Special thanks to Jonathan Baron and 
Andy Liaw. Baron maintains the RSiteSearch data base. Liaw and Baron 
created the RSiteSearch function in the utils package."


Another example:  The "Author" of the Ecdat package is Yves Croissant 
<yves.croissant at let.ish-lyon.cnrs.fr>.  I'm the Maintainer.  At some 
point, I may add my name to the list of Authors but I certainly would 
never remove Yves' name.  That package is, I think, exclusively data 
sets.  I added functions, which I later spun off into a separate Edfun 
package;  I'm listed as the Author and Maintainer of that.


Another example that may help you:  The "distr" package has several 
companion packages:  distrDoc, distrEx, distrSim, distrTEst, distrTeach, 
distrMod, and distrEllipse.  I haven't checked, but each package could 
have a separate and different list of authors.


Hope this helps.
Spencer


On 10/7/2015 9:23 AM, Gabriel Becker wrote:
> Hadley,
>
> With all due respect, I'm not sure what exactly your deliniation between
> author and contributor is, but from what I can tell I don't agree with it.
>
> >From the blogpost regarding your new purrr package:
>
> "Purrr wouldn?t be possible without Lionel Henry
> <https://github.com/lionel->. He wrote a lot of the package and his
> insightful comments ..."
>
> And yet he is listed as a contributor in the DESCRIPTION file, and thus in
> your view not worthy of being in the citation even as a non-first author?
> That does not jive with what I understand to be "standard practice" with
> regard to software-related publications, and it certainly isn't what I
> would choose to do in that situation.
>
> Best,
> ~G
>
> On Wed, Oct 7, 2015 at 4:59 AM, Hadley Wickham <h.wickham at gmail.com> wrote:
>
>> On Tue, Oct 6, 2015 at 4:58 PM, Adrian Du?a <dusa.adrian at unibuc.ro> wrote:
>>> Hi Gabriel,
>>>
>>> On Tue, Oct 6, 2015 at 10:59 PM, Gabriel Becker <gmbecker at ucdavis.edu>
>>> wrote:
>>>
>>>> [...]
>>>>
>>>> At the very least, this is seems to be a flagrant violation of the
>>>> *spirit* of the CRAN policy, which AFAIK is intended to enforce
>>>> acknowledgement of the contributions of all copyright holders in the
>>>> package. The fact that you are trying to bypass the policy by suggesting
>>>> users use an unofficial citation which would not comply with the policy
>>>> while maintaining an official one which complies, but which you don't
>> want
>>>> users to see  is probably a suggestion that you shouldn't do that.
>>>>
>>>
>>> But that is the very point: I read the CRAN policies twice, and there is
>> no
>>> official guideline on how to compile the citation.
>>> Regarding the Source packages, the policies mention:
>>>
>>> ######
>>> The ownership of copyright and intellectual property rights of all
>>> components of the package must be clear and unambiguous (including from
>> the
>>> authors specification in the DESCRIPTION file). Where code is copied (or
>>> derived) from the work of others (including from R itself), care must be
>>> taken that any copyright/license statements are preserved and authorship
>> is
>>> not misrepresented.
>>> Preferably, an ?Authors at R? would be used with ?ctb? roles for the
>> authors
>>> of such code. Alternatively, the ?Author? field should list these authors
>>> as contributors.
>>>
>>> Where copyrights are held by an entity other than the package authors,
>> this
>>> should preferably be indicated via ?cph? roles in the ?Authors at R?
>> field, or
>>> using a ?Copyright? field (if necessary referring to an inst/COPYRIGHTS
>>> file).
>>>
>>> Trademarks must be respected.
>>> ######
>>>
>>> Now, that requirement is already met: the former author is still in the
>>> authors' list. So the contribution of the former author is duly
>>> acknowledged, but the fundamental issue of my question related to the
>>> citation file, for which the CRAN policies doesn't offer any other
>>> information.
>>>
>>> If the spirit of the CRAN policies is to enforce citing each and every
>> one
>>> of the authors, then I don't understand why the citation from package
>> Rcmdr
>>> meets this spirit, while my suggestion doesn't.
>> I'd recommend that you read
>> https://cran.r-project.org/web/packages/shiny/DESCRIPTION and compare
>> it to citation("shiny"). Authors, but not contributors, all listed in
>> the citation.
>>
>> Hadley
>>
>> --
>> http://had.co.nz/
>>
>
>


From tkeitt at utexas.edu  Wed Oct  7 19:39:19 2015
From: tkeitt at utexas.edu (Tim Keitt)
Date: Wed, 7 Oct 2015 12:39:19 -0500
Subject: [Rd] authorship and citation
In-Reply-To: <56154874.8020408@prodsyse.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
	<CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>
	<CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
	<CABdHhvEgKF85d0vk2XDNVYDtPr-r10OCxxn+Rdm=FSijQLFa4g@mail.gmail.com>
	<CADwqtCPN4GS-KWRDpxy0tk+LvPFB2hhty7mMJZHk-Za_6W9yPA@mail.gmail.com>
	<56154874.8020408@prodsyse.com>
Message-ID: <CANnL8gpHCxwRxeL5D=RN-2Coeb=WDzBbK3tDfmQGBSJt30R_Hw@mail.gmail.com>

On Wed, Oct 7, 2015 at 11:29 AM, Spencer Graves <spencer.graves at prodsyse.com
> wrote:

> Another example:  The "Author" of the Ecdat package is Yves Croissant <
> yves.croissant at let.ish-lyon.cnrs.fr>.  I'm the Maintainer.  At some
> point, I may add my name to the list of Authors but I certainly would never
> remove Yves' name.  That package is, I think, exclusively data sets.  I
> added functions, which I later spun off into a separate Edfun package;  I'm
> listed as the Author and Maintainer of that.
>

This reminded me of something I have always found curious about roles
listed in the DESCRIPTION file. Since there is no "maintainer" role in this
list: http://www.loc.gov/marc/relators/relaterm.html, which was used to get
the role names, you will be listed as the "creator" of the package when you
list yourself as maintainer even if you did not initiate the package or
even contribute code.

THK

http://www.keittlab.org/

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Wed Oct  7 21:39:51 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 7 Oct 2015 15:39:51 -0400
Subject: [Rd] authorship and citation
In-Reply-To: <CANnL8gpHCxwRxeL5D=RN-2Coeb=WDzBbK3tDfmQGBSJt30R_Hw@mail.gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
	<CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>
	<CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
	<CABdHhvEgKF85d0vk2XDNVYDtPr-r10OCxxn+Rdm=FSijQLFa4g@mail.gmail.com>
	<CADwqtCPN4GS-KWRDpxy0tk+LvPFB2hhty7mMJZHk-Za_6W9yPA@mail.gmail.com>
	<56154874.8020408@prodsyse.com>
	<CANnL8gpHCxwRxeL5D=RN-2Coeb=WDzBbK3tDfmQGBSJt30R_Hw@mail.gmail.com>
Message-ID: <56157507.5090007@gmail.com>

On 07/10/2015 1:39 PM, Tim Keitt wrote:
> On Wed, Oct 7, 2015 at 11:29 AM, Spencer Graves <spencer.graves at prodsyse.com
>> wrote:
> 
>> Another example:  The "Author" of the Ecdat package is Yves Croissant <
>> yves.croissant at let.ish-lyon.cnrs.fr>.  I'm the Maintainer.  At some
>> point, I may add my name to the list of Authors but I certainly would never
>> remove Yves' name.  That package is, I think, exclusively data sets.  I
>> added functions, which I later spun off into a separate Edfun package;  I'm
>> listed as the Author and Maintainer of that.
>>
> 
> This reminded me of something I have always found curious about roles
> listed in the DESCRIPTION file. Since there is no "maintainer" role in this
> list: http://www.loc.gov/marc/relators/relaterm.html, which was used to get
> the role names, you will be listed as the "creator" of the package when you
> list yourself as maintainer even if you did not initiate the package or
> even contribute code.
> 

I think it was easier to (ab)use that role than to get a "Maintainer"
role added to the standard ones.  The description of "creator" is

"A person or organization responsible for the intellectual or artistic
content of a resource"

The usual English meaning of "creator" would be close to

"A person or organization originally responsible for the intellectual or
artistic content of a resource"

R's use of it is close to

"A person or organization currently responsible for the intellectual or
artistic content of a resource"

Duncan Murdoch


From MEC at stowers.org  Wed Oct  7 21:52:29 2015
From: MEC at stowers.org (Cook, Malcolm)
Date: Wed, 7 Oct 2015 19:52:29 +0000
Subject: [Rd] Error generated by .Internal(nchar) disappears when
 debugging
In-Reply-To: <56130E61.8060007@gmail.com>
References: <CAO1zAVYsOWG0QSVdU_wex-Y2U3KD3YEtGJu5nH5zNc8dCzm5ig@mail.gmail.com>
	<loom.20151006T011642-505@post.gmane.org> <56130E61.8060007@gmail.com>
Message-ID: <aaeba58c8b8a4bbb816f39fadcdc674d@exchsrv2.sgc.loc>

What other packages do you have loaded?  Perhaps a BioConductor one that loads S4Vectors that announces upon load:

	Creating a generic function for 'nchar' from package 'base' in package 'S4Vectors'

Maybe a red herring...

~Malcolm

 > -----Original Message-----
 > From: R-devel [mailto:r-devel-bounces at r-project.org] On Behalf Of Duncan
 > Murdoch
 > Sent: Monday, October 05, 2015 6:57 PM
 > To: Matt Dowle <mattjdowle at gmail.com>; r-devel at stat.math.ethz.ch
 > Subject: Re: [Rd] Error generated by .Internal(nchar) disappears when
 > debugging
 > 
 > On 05/10/2015 7:24 PM, Matt Dowle wrote:
 > > Joris Meys <jorismeys <at> gmail.com> writes:
 > >
 > >>
 > >> Hi all,
 > >>
 > >> I have a puzzling problem related to nchar. In R 3.2.1, the internal
 > > nchar
 > >> gained an extra argument (see
 > >> https://stat.ethz.ch/pipermail/r-announce/2015/000586.html)
 > >>
 > >> I've been testing code using the package copula, and at home I'm
 > >> still running R 3.2.0 (I know, I know...). When trying the following
 > >> code, I
 > > got
 > >> an error:
 > >>
 > >>> library(copula)
 > >>> fgmCopula(0.8)
 > >> Error in substr(sc[i], 2, nchar(sc[i]) - 1) :
 > >>   4 arguments passed to .Internal(nchar) which requires 3
 > >>
 > >> Cheers
 > >> Joris
 > >
 > >
 > > I'm seeing a similar problem. IIUC, the Windows binary .zip from CRAN
 > > of any package using base::nchar is affected. Could someone check my
 > > answer here is correct please :
 > > http://stackoverflow.com/a/32959306/403310
 > 
 > Nobody has posted a simple reproducible example here, so it's kind of hard to
 > say.
 > 
 > I would have guessed that a change to the internal signature of the C code
 > underlying nchar() wouldn't have any effect on a package that called the R
 > nchar() function.
 > 
 > When I put together my own example (a tiny package containing a function
 > calling nchar(), built to .zip using R 3.2.2, installed into R 3.2.0), it confirmed
 > my guess.
 > 
 > On the other hand, if some package is calling the .Internal function directly, I'd
 > expect that to break.  Packages shouldn't do that.
 > 
 > So I'd say there's been no evidence posted of a problem in R here, though
 > there may be problems in some of the packages involved.  I'd welcome an
 > example that provided some usable evidence.
 > 
 > Duncan Murdoch
 > 
 > ______________________________________________
 > R-devel at r-project.org mailing list
 > https://stat.ethz.ch/mailman/listinfo/r-devel


From wdunlap at tibco.com  Wed Oct  7 22:22:42 2015
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 7 Oct 2015 13:22:42 -0700
Subject: [Rd] read.table reads "i" as NA_complex_
Message-ID: <CAF8bMcbD=RST5NA1S5FhRj+3hV6UAAayn8pQs-pfmJkzjyvF-Q@mail.gmail.com>

I just noticed that read.table() and type.convert() interpret the string "i"
as a missing value of type complex.
   > str(read.table(text=c("i\ni\ni\ni\n")))
   'data.frame':   4 obs. of  1 variable:
    $ V1: cplx  NA NA NA ...
   > str(type.convert("i"))
    cplx NA

If there are other strings in the column it makes the column character so
most people will not notice
   > str(read.table(text=c("i\nii\niii\niv\n")))
   'data.frame':   4 obs. of  1 variable:
    $ V1: Factor w/ 4 levels "i","ii","iii",..: 1 2 3 4

Is this intended?  It surprised me.

Bill Dunlap
TIBCO Software
wdunlap tibco.com

	[[alternative HTML version deleted]]


From ripley at stats.ox.ac.uk  Wed Oct  7 22:41:13 2015
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 7 Oct 2015 21:41:13 +0100
Subject: [Rd] read.table reads "i" as NA_complex_
In-Reply-To: <CAF8bMcbD=RST5NA1S5FhRj+3hV6UAAayn8pQs-pfmJkzjyvF-Q@mail.gmail.com>
References: <CAF8bMcbD=RST5NA1S5FhRj+3hV6UAAayn8pQs-pfmJkzjyvF-Q@mail.gmail.com>
Message-ID: <56158369.4070104@stats.ox.ac.uk>

On 07/10/2015 21:22, William Dunlap wrote:
> I just noticed that read.table() and type.convert() interpret the string "i"
> as a missing value of type complex.
>     > str(read.table(text=c("i\ni\ni\ni\n")))
>     'data.frame':   4 obs. of  1 variable:
>      $ V1: cplx  NA NA NA ...
>     > str(type.convert("i"))
>      cplx NA
>
> If there are other strings in the column it makes the column character so
> most people will not notice
>     > str(read.table(text=c("i\nii\niii\niv\n")))
>     'data.frame':   4 obs. of  1 variable:
>      $ V1: Factor w/ 4 levels "i","ii","iii",..: 1 2 3 4
>
> Is this intended?  It surprised me.

It was intended (that input is ambiguous), but it is being changed .... 
from the NEWS file for R-devel:

     ? type.convert("i") now returns a factor instead of a complex value
       with zero real part and missing imaginary part.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford
1 South Parks Road, Oxford OX1 3TG, UK


From pdalgd at gmail.com  Wed Oct  7 22:44:27 2015
From: pdalgd at gmail.com (peter dalgaard)
Date: Wed, 7 Oct 2015 22:44:27 +0200
Subject: [Rd] read.table reads "i" as NA_complex_
In-Reply-To: <CAF8bMcbD=RST5NA1S5FhRj+3hV6UAAayn8pQs-pfmJkzjyvF-Q@mail.gmail.com>
References: <CAF8bMcbD=RST5NA1S5FhRj+3hV6UAAayn8pQs-pfmJkzjyvF-Q@mail.gmail.com>
Message-ID: <6D210035-8EE0-4C6F-856F-89A2D8E1C578@gmail.com>

This is fixed/changed in r-devel:

> str(type.convert("i"))
 Factor w/ 1 level "i": 1

It was reported on July 18 as PR#16473, if you care.

(Funny how an obscure issue goes unnoticed for a decade, then pops up twice independently within a few months. A property of the Poisson process, I suppose.)


> On 07 Oct 2015, at 22:22 , William Dunlap <wdunlap at tibco.com> wrote:
> 
> I just noticed that read.table() and type.convert() interpret the string "i"
> as a missing value of type complex.
>> str(read.table(text=c("i\ni\ni\ni\n")))
>   'data.frame':   4 obs. of  1 variable:
>    $ V1: cplx  NA NA NA ...
>> str(type.convert("i"))
>    cplx NA
> 
> If there are other strings in the column it makes the column character so
> most people will not notice
>> str(read.table(text=c("i\nii\niii\niv\n")))
>   'data.frame':   4 obs. of  1 variable:
>    $ V1: Factor w/ 4 levels "i","ii","iii",..: 1 2 3 4
> 
> Is this intended?  It surprised me.
> 
> Bill Dunlap
> TIBCO Software
> wdunlap tibco.com
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From jorismeys at gmail.com  Wed Oct  7 23:08:58 2015
From: jorismeys at gmail.com (Joris Meys)
Date: Wed, 7 Oct 2015 23:08:58 +0200
Subject: [Rd] Error generated by .Internal(nchar) disappears when
	debugging
In-Reply-To: <aaeba58c8b8a4bbb816f39fadcdc674d@exchsrv2.sgc.loc>
References: <CAO1zAVYsOWG0QSVdU_wex-Y2U3KD3YEtGJu5nH5zNc8dCzm5ig@mail.gmail.com>
	<loom.20151006T011642-505@post.gmane.org>
	<56130E61.8060007@gmail.com>
	<aaeba58c8b8a4bbb816f39fadcdc674d@exchsrv2.sgc.loc>
Message-ID: <CAO1zAVb2UbB01otKM1shsM2_NRrJAUQuk6tJsmARfSC+gqwOCA@mail.gmail.com>

Malcolm,

I tested the code on a clean R 3.2.0 session. Not even in RStudio, just to
rule that out.

> sessionInfo()
R version 3.2.0 (2015-04-16)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 8 x64 (build 9200)

locale:
[1] LC_COLLATE=English_United Kingdom.1252
[2] LC_CTYPE=English_United Kingdom.1252
[3] LC_MONETARY=English_United Kingdom.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United Kingdom.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] copula_0.999-13

loaded via a namespace (and not attached):
 [1] Matrix_1.2-0     ADGofTest_0.3    tools_3.2.0      pspline_1.0-17
 [5] gsl_1.9-10       mvtnorm_1.0-3    grid_3.2.0       stats4_3.2.0
 [9] lattice_0.20-31  stabledist_0.7-0 fortunes_1.5-2


On Wed, Oct 7, 2015 at 9:52 PM, Cook, Malcolm <MEC at stowers.org> wrote:

> What other packages do you have loaded?  Perhaps a BioConductor one that
> loads S4Vectors that announces upon load:
>
>         Creating a generic function for 'nchar' from package 'base' in
> package 'S4Vectors'
>
> Maybe a red herring...
>
> ~Malcolm
>
>  > -----Original Message-----
>  > From: R-devel [mailto:r-devel-bounces at r-project.org] On Behalf Of
> Duncan
>  > Murdoch
>  > Sent: Monday, October 05, 2015 6:57 PM
>  > To: Matt Dowle <mattjdowle at gmail.com>; r-devel at stat.math.ethz.ch
>  > Subject: Re: [Rd] Error generated by .Internal(nchar) disappears when
>  > debugging
>  >
>  > On 05/10/2015 7:24 PM, Matt Dowle wrote:
>  > > Joris Meys <jorismeys <at> gmail.com> writes:
>  > >
>  > >>
>  > >> Hi all,
>  > >>
>  > >> I have a puzzling problem related to nchar. In R 3.2.1, the internal
>  > > nchar
>  > >> gained an extra argument (see
>  > >> https://stat.ethz.ch/pipermail/r-announce/2015/000586.html)
>  > >>
>  > >> I've been testing code using the package copula, and at home I'm
>  > >> still running R 3.2.0 (I know, I know...). When trying the following
>  > >> code, I
>  > > got
>  > >> an error:
>  > >>
>  > >>> library(copula)
>  > >>> fgmCopula(0.8)
>  > >> Error in substr(sc[i], 2, nchar(sc[i]) - 1) :
>  > >>   4 arguments passed to .Internal(nchar) which requires 3
>  > >>
>  > >> Cheers
>  > >> Joris
>  > >
>  > >
>  > > I'm seeing a similar problem. IIUC, the Windows binary .zip from CRAN
>  > > of any package using base::nchar is affected. Could someone check my
>  > > answer here is correct please :
>  > > http://stackoverflow.com/a/32959306/403310
>  >
>  > Nobody has posted a simple reproducible example here, so it's kind of
> hard to
>  > say.
>  >
>  > I would have guessed that a change to the internal signature of the C
> code
>  > underlying nchar() wouldn't have any effect on a package that called
> the R
>  > nchar() function.
>  >
>  > When I put together my own example (a tiny package containing a function
>  > calling nchar(), built to .zip using R 3.2.2, installed into R 3.2.0),
> it confirmed
>  > my guess.
>  >
>  > On the other hand, if some package is calling the .Internal function
> directly, I'd
>  > expect that to break.  Packages shouldn't do that.
>  >
>  > So I'd say there's been no evidence posted of a problem in R here,
> though
>  > there may be problems in some of the packages involved.  I'd welcome an
>  > example that provided some usable evidence.
>  >
>  > Duncan Murdoch
>  >
>  > ______________________________________________
>  > R-devel at r-project.org mailing list
>  > https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Mathematical Modelling, Statistics and Bio-Informatics

tel :  +32 (0)9 264 61 79
Joris.Meys at Ugent.be
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php

	[[alternative HTML version deleted]]


From MEC at stowers.org  Wed Oct  7 23:21:05 2015
From: MEC at stowers.org (Cook, Malcolm)
Date: Wed, 7 Oct 2015 21:21:05 +0000
Subject: [Rd] Error generated by .Internal(nchar) disappears when
 debugging
In-Reply-To: <CAO1zAVb2UbB01otKM1shsM2_NRrJAUQuk6tJsmARfSC+gqwOCA@mail.gmail.com>
References: <CAO1zAVYsOWG0QSVdU_wex-Y2U3KD3YEtGJu5nH5zNc8dCzm5ig@mail.gmail.com>
	<loom.20151006T011642-505@post.gmane.org>	<56130E61.8060007@gmail.com>
	<aaeba58c8b8a4bbb816f39fadcdc674d@exchsrv2.sgc.loc>
	<CAO1zAVb2UbB01otKM1shsM2_NRrJAUQuk6tJsmARfSC+gqwOCA@mail.gmail.com>
Message-ID: <7d1197c12116421398e37bf5e35a8579@exchsrv2.sgc.loc>

OK ? definitely a red herring ? thanks for following up?

From: Joris Meys [mailto:jorismeys at gmail.com]
Sent: Wednesday, October 07, 2015 4:09 PM
To: Cook, Malcolm <MEC at stowers.org>
Cc: Duncan Murdoch <murdoch.duncan at gmail.com>; Matt Dowle <mattjdowle at gmail.com>; r-devel at stat.math.ethz.ch
Subject: Re: [Rd] Error generated by .Internal(nchar) disappears when debugging

Malcolm,

I tested the code on a clean R 3.2.0 session. Not even in RStudio, just to rule that out.

> sessionInfo()
R version 3.2.0 (2015-04-16)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 8 x64 (build 9200)

locale:
[1] LC_COLLATE=English_United Kingdom.1252
[2] LC_CTYPE=English_United Kingdom.1252
[3] LC_MONETARY=English_United Kingdom.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United Kingdom.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] copula_0.999-13

loaded via a namespace (and not attached):
 [1] Matrix_1.2-0     ADGofTest_0.3    tools_3.2.0      pspline_1.0-17
 [5] gsl_1.9-10       mvtnorm_1.0-3    grid_3.2.0       stats4_3.2.0
 [9] lattice_0.20-31  stabledist_0.7-0 fortunes_1.5-2


On Wed, Oct 7, 2015 at 9:52 PM, Cook, Malcolm <MEC at stowers.org<mailto:MEC at stowers.org>> wrote:
What other packages do you have loaded?  Perhaps a BioConductor one that loads S4Vectors that announces upon load:

        Creating a generic function for 'nchar' from package 'base' in package 'S4Vectors'

Maybe a red herring...

~Malcolm

 > -----Original Message-----
 > From: R-devel [mailto:r-devel-bounces at r-project.org<mailto:r-devel-bounces at r-project.org>] On Behalf Of Duncan
 > Murdoch
 > Sent: Monday, October 05, 2015 6:57 PM
 > To: Matt Dowle <mattjdowle at gmail.com<mailto:mattjdowle at gmail.com>>; r-devel at stat.math.ethz.ch<mailto:r-devel at stat.math.ethz.ch>
 > Subject: Re: [Rd] Error generated by .Internal(nchar) disappears when
 > debugging
 >
 > On 05/10/2015 7:24 PM, Matt Dowle wrote:
 > > Joris Meys <jorismeys <at> gmail.com<http://gmail.com>> writes:
 > >
 > >>
 > >> Hi all,
 > >>
 > >> I have a puzzling problem related to nchar. In R 3.2.1, the internal
 > > nchar
 > >> gained an extra argument (see
 > >> https://stat.ethz.ch/pipermail/r-announce/2015/000586.html)
 > >>
 > >> I've been testing code using the package copula, and at home I'm
 > >> still running R 3.2.0 (I know, I know...). When trying the following
 > >> code, I
 > > got
 > >> an error:
 > >>
 > >>> library(copula)
 > >>> fgmCopula(0.8)
 > >> Error in substr(sc[i], 2, nchar(sc[i]) - 1) :
 > >>   4 arguments passed to .Internal(nchar) which requires 3
 > >>
 > >> Cheers
 > >> Joris
 > >
 > >
 > > I'm seeing a similar problem. IIUC, the Windows binary .zip from CRAN
 > > of any package using base::nchar is affected. Could someone check my
 > > answer here is correct please :
 > > http://stackoverflow.com/a/32959306/403310
 >
 > Nobody has posted a simple reproducible example here, so it's kind of hard to
 > say.
 >
 > I would have guessed that a change to the internal signature of the C code
 > underlying nchar() wouldn't have any effect on a package that called the R
 > nchar() function.
 >
 > When I put together my own example (a tiny package containing a function
 > calling nchar(), built to .zip using R 3.2.2, installed into R 3.2.0), it confirmed
 > my guess.
 >
 > On the other hand, if some package is calling the .Internal function directly, I'd
 > expect that to break.  Packages shouldn't do that.
 >
 > So I'd say there's been no evidence posted of a problem in R here, though
 > there may be problems in some of the packages involved.  I'd welcome an
 > example that provided some usable evidence.
 >
 > Duncan Murdoch
 >
 > ______________________________________________
 > R-devel at r-project.org<mailto:R-devel at r-project.org> mailing list
 > https://stat.ethz.ch/mailman/listinfo/r-devel

______________________________________________
R-devel at r-project.org<mailto:R-devel at r-project.org> mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel



--
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Mathematical Modelling, Statistics and Bio-Informatics

tel :  +32 (0)9 264 61 79
Joris.Meys at Ugent.be<mailto:Joris.Meys at Ugent.be>
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php

	[[alternative HTML version deleted]]


From wdunlap at tibco.com  Wed Oct  7 23:25:00 2015
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 7 Oct 2015 14:25:00 -0700
Subject: [Rd] read.table reads "i" as NA_complex_
In-Reply-To: <6D210035-8EE0-4C6F-856F-89A2D8E1C578@gmail.com>
References: <CAF8bMcbD=RST5NA1S5FhRj+3hV6UAAayn8pQs-pfmJkzjyvF-Q@mail.gmail.com>
	<6D210035-8EE0-4C6F-856F-89A2D8E1C578@gmail.com>
Message-ID: <CAF8bMcaL9qN0cgUv=p1SxD7NHWdO=TCz_Q0meCpJC7OR+3_6Lg@mail.gmail.com>

Thank you both!

Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Wed, Oct 7, 2015 at 1:44 PM, peter dalgaard <pdalgd at gmail.com> wrote:

> This is fixed/changed in r-devel:
>
> > str(type.convert("i"))
>  Factor w/ 1 level "i": 1
>
> It was reported on July 18 as PR#16473, if you care.
>
> (Funny how an obscure issue goes unnoticed for a decade, then pops up
> twice independently within a few months. A property of the Poisson process,
> I suppose.)
>
>
> > On 07 Oct 2015, at 22:22 , William Dunlap <wdunlap at tibco.com> wrote:
> >
> > I just noticed that read.table() and type.convert() interpret the string
> "i"
> > as a missing value of type complex.
> >> str(read.table(text=c("i\ni\ni\ni\n")))
> >   'data.frame':   4 obs. of  1 variable:
> >    $ V1: cplx  NA NA NA ...
> >> str(type.convert("i"))
> >    cplx NA
> >
> > If there are other strings in the column it makes the column character so
> > most people will not notice
> >> str(read.table(text=c("i\nii\niii\niv\n")))
> >   'data.frame':   4 obs. of  1 variable:
> >    $ V1: Factor w/ 4 levels "i","ii","iii",..: 1 2 3 4
> >
> > Is this intended?  It surprised me.
> >
> > Bill Dunlap
> > TIBCO Software
> > wdunlap tibco.com
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>
> --
> Peter Dalgaard, Professor,
> Center for Statistics, Copenhagen Business School
> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
> Phone: (+45)38153501
> Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
>
>
>
>
>
>
>
>
>

	[[alternative HTML version deleted]]


From tkeitt at utexas.edu  Wed Oct  7 23:42:33 2015
From: tkeitt at utexas.edu (Tim Keitt)
Date: Wed, 7 Oct 2015 16:42:33 -0500
Subject: [Rd] authorship and citation
In-Reply-To: <56157507.5090007@gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
	<CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>
	<CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
	<CABdHhvEgKF85d0vk2XDNVYDtPr-r10OCxxn+Rdm=FSijQLFa4g@mail.gmail.com>
	<CADwqtCPN4GS-KWRDpxy0tk+LvPFB2hhty7mMJZHk-Za_6W9yPA@mail.gmail.com>
	<56154874.8020408@prodsyse.com>
	<CANnL8gpHCxwRxeL5D=RN-2Coeb=WDzBbK3tDfmQGBSJt30R_Hw@mail.gmail.com>
	<56157507.5090007@gmail.com>
Message-ID: <CANnL8goY+BzUW4O8pVad+4qw_Y62ZTymLK5PfjuZG6ZOr-bDVw@mail.gmail.com>

On Wed, Oct 7, 2015 at 2:39 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> I think it was easier to (ab)use that role than to get a "Maintainer"
> role added to the standard ones.
>

Why bother with the relators list at all?

THK

http://www.keittlab.org/

	[[alternative HTML version deleted]]


From Achim.Zeileis at uibk.ac.at  Thu Oct  8 00:44:05 2015
From: Achim.Zeileis at uibk.ac.at (Achim Zeileis)
Date: Thu, 8 Oct 2015 00:44:05 +0200 (CEST)
Subject: [Rd] MARC creator role (was: authorship and citation)
In-Reply-To: <CANnL8goY+BzUW4O8pVad+4qw_Y62ZTymLK5PfjuZG6ZOr-bDVw@mail.gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
	<CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>
	<CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
	<CABdHhvEgKF85d0vk2XDNVYDtPr-r10OCxxn+Rdm=FSijQLFa4g@mail.gmail.com>
	<CADwqtCPN4GS-KWRDpxy0tk+LvPFB2hhty7mMJZHk-Za_6W9yPA@mail.gmail.com>
	<56154874.8020408@prodsyse.com>
	<CANnL8gpHCxwRxeL5D=RN-2Coeb=WDzBbK3tDfmQGBSJt30R_Hw@mail.gmail.com>
	<56157507.5090007@gmail.com>
	<CANnL8goY+BzUW4O8pVad+4qw_Y62ZTymLK5PfjuZG6ZOr-bDVw@mail.gmail.com>
Message-ID: <alpine.DEB.2.11.1510080029050.1946@paninaro.uibk.ac.at>

On Wed, 7 Oct 2015, Tim Keitt wrote:

> On Wed, Oct 7, 2015 at 2:39 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
> wrote:
>
>> I think it was easier to (ab)use that role than to get a "Maintainer"
>> role added to the standard ones.

Also note that the "creator" in the MARC vocabulary is with respect to a 
_resource_ - which is different from the creation of a _work_ by an 
"author".

In the case of the CRAN repository, the individual resources are the 
packages. And the maintainer is the person who is responsible for a 
package (aka resource) being made available (aka created) on CRAN. Also, 
the maintainer is the contact responsible for the resource.

Therefore, using the "author" role for those who have created the code 
(aka work) and the "creator" role for those who have created the (CRAN) 
package (aka resource) seemed appropriate.

> Why bother with the relators list at all?

Certainly, it is better to use a standard vocabulary than creating a new 
domain-specific vocabulary to facilitate communication of the information 
outside the domain. Therefore, both the "person" and the "bibentry" 
objects try to follow models that were well established rather than 
starting out from scratch.

> THK
>
> http://www.keittlab.org/
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From Martin.Morgan at roswellpark.org  Thu Oct  8 00:53:00 2015
From: Martin.Morgan at roswellpark.org (Morgan, Martin)
Date: Wed, 7 Oct 2015 22:53:00 +0000
Subject: [Rd] Error generated by .Internal(nchar) disappears when
 debugging
In-Reply-To: <aaeba58c8b8a4bbb816f39fadcdc674d@exchsrv2.sgc.loc>
References: <CAO1zAVYsOWG0QSVdU_wex-Y2U3KD3YEtGJu5nH5zNc8dCzm5ig@mail.gmail.com>
	<loom.20151006T011642-505@post.gmane.org> <56130E61.8060007@gmail.com>
	<aaeba58c8b8a4bbb816f39fadcdc674d@exchsrv2.sgc.loc>
Message-ID: <DF23DAC5A53912408040FF04D8B780AADF0FFC@EXMB3RSC.roswellpark.org>



> -----Original Message-----
> From: R-devel [mailto:r-devel-bounces at r-project.org] On Behalf Of Cook,
> Malcolm
> Sent: Wednesday, October 07, 2015 3:52 PM
> To: 'Duncan Murdoch'; Matt Dowle; r-devel at stat.math.ethz.ch
> Subject: Re: [Rd] Error generated by .Internal(nchar) disappears when
> debugging
> 
> What other packages do you have loaded?  Perhaps a BioConductor one that
> loads S4Vectors that announces upon load:
> 
> 	Creating a generic function for 'nchar' from package 'base' in package
> 'S4Vectors'

This was introduced as a way around the problem, where the declaration of a method was moved to the .onLoad hook

.onLoad <- function(libname, pkgname)
     setMethod("nchar", "Rle", .nchar_Rle)

instead of in the body of the package. The rationale was that the method is then created at run-time, when the generic is defined on the user's R, rather than at compile time, when the generic is defined on the build system's R. There was a subsequent independent report that this did not solve the problem, but we were not able to follow up on that.

This is only defined in the current release version of S4Vectors, which is the only version expected to straddle R versions with different signatures.

Martin Morgan

> 
> Maybe a red herring...
> 
> ~Malcolm
> 
>  > -----Original Message-----
>  > From: R-devel [mailto:r-devel-bounces at r-project.org] On Behalf Of
> Duncan  > Murdoch  > Sent: Monday, October 05, 2015 6:57 PM  > To: Matt
> Dowle <mattjdowle at gmail.com>; r-devel at stat.math.ethz.ch  > Subject: Re:
> [Rd] Error generated by .Internal(nchar) disappears when  > debugging  >  >
> On 05/10/2015 7:24 PM, Matt Dowle wrote:
>  > > Joris Meys <jorismeys <at> gmail.com> writes:
>  > >
>  > >>
>  > >> Hi all,
>  > >>
>  > >> I have a puzzling problem related to nchar. In R 3.2.1, the internal  > >
> nchar  > >> gained an extra argument (see  > >>
> https://stat.ethz.ch/pipermail/r-announce/2015/000586.html)
>  > >>
>  > >> I've been testing code using the package copula, and at home I'm  > >>
> still running R 3.2.0 (I know, I know...). When trying the following  > >> code, I
> > > got  > >> an error:
>  > >>
>  > >>> library(copula)
>  > >>> fgmCopula(0.8)
>  > >> Error in substr(sc[i], 2, nchar(sc[i]) - 1) :
>  > >>   4 arguments passed to .Internal(nchar) which requires 3
>  > >>
>  > >> Cheers
>  > >> Joris
>  > >
>  > >
>  > > I'm seeing a similar problem. IIUC, the Windows binary .zip from CRAN  >
> > of any package using base::nchar is affected. Could someone check my  > >
> answer here is correct please :
>  > > http://stackoverflow.com/a/32959306/403310
>  >
>  > Nobody has posted a simple reproducible example here, so it's kind of
> hard to  > say.
>  >
>  > I would have guessed that a change to the internal signature of the C code
> > underlying nchar() wouldn't have any effect on a package that called the R
> > nchar() function.
>  >
>  > When I put together my own example (a tiny package containing a
> function  > calling nchar(), built to .zip using R 3.2.2, installed into R 3.2.0), it
> confirmed  > my guess.
>  >
>  > On the other hand, if some package is calling the .Internal function directly,
> I'd  > expect that to break.  Packages shouldn't do that.
>  >
>  > So I'd say there's been no evidence posted of a problem in R here, though
> > there may be problems in some of the packages involved.  I'd welcome an
> > example that provided some usable evidence.
>  >
>  > Duncan Murdoch
>  >
>  > ______________________________________________
>  > R-devel at r-project.org mailing list
>  > https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


This email message may contain legally privileged and/or confidential information.  If you are not the intended recipient(s), or the employee or agent responsible for the delivery of this message to the intended recipient(s), you are hereby notified that any disclosure, copying, distribution, or use of this email message is prohibited.  If you have received this message in error, please notify the sender immediately by e-mail and delete this email message from your computer. Thank you.

From jwiley.psych at gmail.com  Thu Oct  8 03:19:16 2015
From: jwiley.psych at gmail.com (Joshua Wiley)
Date: Thu, 8 Oct 2015 12:19:16 +1100
Subject: [Rd] Unexpected failure when calling new() with unnamed arg and
In-Reply-To: <5553CC87.7080402@fredhutch.org>
References: <55527C42.7090707@fredhutch.org>
	<21843.11818.477419.434062@stat.math.ethz.ch>
	<5553CC87.7080402@fredhutch.org>
Message-ID: <CANz9Z_L4qY60RXOQuu_4DVc10Yxb0Hy8MzoDHkt4+-jQ7xPPcw@mail.gmail.com>

Hi,

I realize this is an old thread, but just wondering whether a conclusion
was ever reached on this issue?  I'm using formula(NULL) but it would be
nice if default initialization worked for formula classes as well.

Cheers,

Josh


On Thu, May 14, 2015 at 8:13 AM, Herv? Pag?s <hpages at fredhutch.org> wrote:

> Thanks Martin for looking into this.  H.
>
>
> On 05/13/2015 03:57 AM, Martin Maechler wrote:
>
>> Herv? Pag?s <hpages at fredhutch.org>
>>>>>>>      on Tue, 12 May 2015 15:18:42 -0700 writes:
>>>>>>>
>>>>>>
>> Hi,
>>>
>>
>> The man page for new() suggests that if 'a' is an object with slots
>>> "slot1" and "slot2" and C is a class that extends the class of 'a',
>>> then the 2 following calls should be equivalent:
>>>
>>
>>     new("C", a, ...)
>>>     new("C", slot1=a at slot1, slot2=a at slot2, ...)
>>>
>>
>> This is generally the case but I just ran into a situation where it's
>>> not. In the following example the former fails while the latter works:
>>>
>>
>>     setClass("A", representation(slot1="numeric", slot2="logical"))
>>>     setClass("B", contains="A", representation(design="formula"))
>>>     setClass("C", contains="B")
>>>     a <- new("A", slot1=77, slot2=TRUE)
>>>
>>
>>     new("C", a, design=x ~ y)  # fails
>>>     new("C", slot1=a at slot1, slot2=a at slot2, design=x ~ y)  # works
>>>
>>
>> Note that new("B", a, design=x ~ y) works so the 3-level class
>>> hierarchy is really needed in order to reproduce.
>>>
>>
>> Probably related to this, I also noted that new("B") and/or new("C")
>>> return invalid objects:
>>>
>>
>>     c <- new("C")
>>>
>>
>>     validObject(c)
>>>     # Error in validObject(c) :
>>>     #  invalid class ?C? object: invalid object for slot "design"
>>>     #  in class "C": got class "S4", should be or extend class "formula"
>>>
>>
>>     is(c at design, "formula")
>>>     # [1] FALSE
>>>
>>
>>     class(c at design)
>>>     # [1] "S4"
>>>
>>
>> Note that 'c' can be fixed:
>>>
>>
>>     c at design <- formula(NULL)
>>>
>>
>>     validObject(c)
>>>     # [1] TRUE
>>>
>>
>> Maybe something that the default "initialize" method should take care
>>> of?
>>>
>>
>> Another singularity that is maybe at the root of all of this is that
>>> the "formula" S4 class is virtual:
>>>
>>
>>     showClass("formula")
>>>     # Virtual Class "formula" [package "methods"]
>>>     #
>>>     # Slots:
>>>     #
>>>     # Name:   .S3Class
>>>     # Class: character
>>>     #
>>>     # Extends: "oldClass"
>>>
>>
>> so a bare call to new("formula") fails:
>>>
>>
>>     new("formula")
>>>     # Error in new("formula") :
>>>     #   trying to generate an object from a virtual class ("formula")
>>>
>>
>> Shouldn't new("formula") just return an "empty" S3 formula (like
>>> formula(NULL) does), in the same way that new("integer") returns
>>> an empty ordinary integer vector?
>>>
>>
>> Interesting .. and at least worth following.
>>
>> One problem and historical reason for the current setup seems
>> that the "formula" S3 class is not from 'base' but 'stats' :
>>
>> R's source, src/library/methods/R/BasicClasses.R,
>> lines 524 ff has the following comment block
>>
>> |  .OldClassesPrototypes is a list of S3 classes for which prototype
>> |  objects are known & reasonable.  The classes will reappear in
>> |  .OldClassesList, but will have been initialized first in
>> |  .InitBasicClasses.  NB:  the methods package will NOT set up
>> |  prototypes for S3 classes except those in package base and for "ts"
>> |  (and would rather not do those either).  The package that owns the
>> |  S3 class should have code to call setOldClass in its
>> |  initialization.
>>
>> So, when John Chambers wrote this, he envisioned that the
>> 'stats' package would do "the correct thing" for its own classes.
>> OTOH, as history went, the stats package was never allowed to
>> depend on methods.
>> There are many other S3 classes from 'stats' which also end up
>> similarly, being defined via  setOldClass() and that itself
>> produces a VIRTUAL class.
>> Also, another part of the (R source) comment above is no longer
>> quite accurate, e.g., "data.frame" is in .OldClassesPrototypes
>> but not in .OldClassesList ...
>>
>> As I do agree that "formula" is much more basic than these other classes,
>> I'm currently looking at tweaks to the methods (and stats) code,
>> to get this to work.... as indeed - you mentioned above -  we
>> already allow "empty S3 formula" objects anyway.
>>
>> ... half an hour later : Indeed, I've been able to use the above
>> information
>> such that  new("formula") and new("formula", y ~ x)
>> work.
>>
>> However, your code above now --- with my changes --- would  fail :
>>
>>   > setClass("A", representation(slot1="numeric", slot2="logical"))
>>   > setClass("B", contains="A", representation(design="formula"))
>>   > setClass("C", contains="B")
>>   Error in reconcilePropertiesAndPrototype(name, slots, prototype,
>> superClasses,  :
>>     "B" is not eligible to be the data part of another class (must be a
>> basic class or a virtual class with no slots)
>>   >
>>
>> So, I am not yet committing my changes to R-devel.
>> Hopefully more on this, later today.
>>
>> Martin Maechler,
>> ETH Zurich
>>
>>
>> Thanks,
>>> H.
>>>
>>
>>   > sessionInfo()
>>> R version 3.2.0 Patched (2015-04-17 r68202)
>>> Platform: x86_64-unknown-linux-gnu (64-bit)
>>> Running under: Ubuntu 14.04.2 LTS
>>>
>>
>> --
>>> Herv? Pag?s
>>> Fred Hutchinson Cancer Research Center
>>>
>>
>>   [..................]
>>
>>
>>
> --
> Herv? Pag?s
>
> Program in Computational Biology
> Division of Public Health Sciences
> Fred Hutchinson Cancer Research Center
> 1100 Fairview Ave. N, M1-B514
> P.O. Box 19024
> Seattle, WA 98109-1024
>
> E-mail: hpages at fredhutch.org
> Phone:  (206) 667-5791
> Fax:    (206) 667-1319
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Joshua F. Wiley, Ph.D.
http://joshuawiley.com/
---
Postdoctoral Research Fellow
Mary MacKillop Institute for Health Research
Australian Catholic University
---
Senior Partner, Elkhart Group Ltd.
http://elkhartgroup.com
Office: 260.673.5518

	[[alternative HTML version deleted]]


From maechler at stat.math.ethz.ch  Thu Oct  8 13:03:54 2015
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 8 Oct 2015 13:03:54 +0200
Subject: [Rd] Unexpected failure when calling new() with unnamed arg and
In-Reply-To: <CANz9Z_L4qY60RXOQuu_4DVc10Yxb0Hy8MzoDHkt4+-jQ7xPPcw@mail.gmail.com>
References: <55527C42.7090707@fredhutch.org>
	<21843.11818.477419.434062@stat.math.ethz.ch>
	<5553CC87.7080402@fredhutch.org>
	<CANz9Z_L4qY60RXOQuu_4DVc10Yxb0Hy8MzoDHkt4+-jQ7xPPcw@mail.gmail.com>
Message-ID: <22038.19866.92251.745312@stat.math.ethz.ch>

>>>>> Joshua Wiley <jwiley.psych at gmail.com>
>>>>>     on Thu, 8 Oct 2015 12:19:16 +1100 writes:

    > Hi, I realize this is an old thread, but just wondering
    > whether a conclusion was ever reached on this issue?  I'm
    > using formula(NULL) but it would be nice if default
    > initialization worked for formula classes as well.

Well,
yes "of course", it was fixed quite a while ago ..
as I had ("almost") promissed (below).

Fixed only for R-devel though, e.g., because it potentially
requires package re-installation, etc.

Martin

    > Cheers,
    > Josh


    > On Thu, May 14, 2015 at 8:13 AM, Herv? Pag?s
    > <hpages at fredhutch.org> wrote:

    >> Thanks Martin for looking into this.  H.
    >> 
    >> 
    >> On 05/13/2015 03:57 AM, Martin Maechler wrote:
    >> 
    >>> Herv? Pag?s <hpages at fredhutch.org>
    >>>>>>>> on Tue, 12 May 2015 15:18:42 -0700 writes:
    >>>>>>>> 
    >>>>>>> 
    >>> Hi,
    >>>> 
    >>> 
    >>> The man page for new() suggests that if 'a' is an object
    >>> with slots
    >>>> "slot1" and "slot2" and C is a class that extends the
    >>>> class of 'a', then the 2 following calls should be
    >>>> equivalent:
    >>>> 
    >>> 
    >>> new("C", a, ...)
    >>>> new("C", slot1=a at slot1, slot2=a at slot2, ...)
    >>>> 
    >>> 
    >>> This is generally the case but I just ran into a
    >>> situation where it's
    >>>> not. In the following example the former fails while
    >>>> the latter works:
    >>>> 
    >>> 
    >>> setClass("A", representation(slot1="numeric",
    >>> slot2="logical"))
    >>>> setClass("B", contains="A",
    >>>> representation(design="formula")) setClass("C",
    >>>> contains="B") a <- new("A", slot1=77, slot2=TRUE)
    >>>> 
    >>> 
    >>> new("C", a, design=x ~ y) # fails
    >>>> new("C", slot1=a at slot1, slot2=a at slot2, design=x ~ y) #
    >>>> works
    >>>> 
    >>> 
    >>> Note that new("B", a, design=x ~ y) works so the 3-level
    >>> class
    >>>> hierarchy is really needed in order to reproduce.
    >>>> 
    >>> 
    >>> Probably related to this, I also noted that new("B")
    >>> and/or new("C")
    >>>> return invalid objects:
    >>>> 
    >>> 
    >>> c <- new("C")
    >>>> 
    >>> 
    >>> validObject(c)
    >>>> # Error in validObject(c) : # invalid class ?C? object:
    >>>> invalid object for slot "design" # in class "C": got
    >>>> class "S4", should be or extend class "formula"
    >>>> 
    >>> 
    >>> is(c at design, "formula")
    >>>> # [1] FALSE
    >>>> 
    >>> 
    >>> class(c at design)
    >>>> # [1] "S4"
    >>>> 
    >>> 
    >>> Note that 'c' can be fixed:
    >>>> 
    >>> 
    >>> c at design <- formula(NULL)
    >>>> 
    >>> 
    >>> validObject(c)
    >>>> # [1] TRUE
    >>>> 
    >>> 
    >>> Maybe something that the default "initialize" method
    >>> should take care
    >>>> of?
    >>>> 
    >>> 
    >>> Another singularity that is maybe at the root of all of
    >>> this is that
    >>>> the "formula" S4 class is virtual:
    >>>> 
    >>> 
    >>> showClass("formula")
    >>>> # Virtual Class "formula" [package "methods"]
    >>>> #
    >>>> # Slots:
    >>>> #
    >>>> # Name: .S3Class # Class: character
    >>>> #
    >>>> # Extends: "oldClass"
    >>>> 
    >>> 
    >>> so a bare call to new("formula") fails:
    >>>> 
    >>> 
    >>> new("formula")
    >>>> # Error in new("formula") : # trying to generate an
    >>>> object from a virtual class ("formula")
    >>>> 
    >>> 
    >>> Shouldn't new("formula") just return an "empty" S3
    >>> formula (like
    >>>> formula(NULL) does), in the same way that
    >>>> new("integer") returns an empty ordinary integer
    >>>> vector?
    >>>> 
    >>> 
    >>> Interesting .. and at least worth following.
    >>> 
    >>> One problem and historical reason for the current setup
    >>> seems that the "formula" S3 class is not from 'base' but
    >>> 'stats' :
    >>> 
    >>> R's source, src/library/methods/R/BasicClasses.R, lines
    >>> 524 ff has the following comment block
    >>> 
    >>> | .OldClassesPrototypes is a list of S3 classes for
    >>> which prototype | objects are known & reasonable.  The
    >>> classes will reappear in | .OldClassesList, but will
    >>> have been initialized first in | .InitBasicClasses.  NB:
    >>> the methods package will NOT set up | prototypes for S3
    >>> classes except those in package base and for "ts" | (and
    >>> would rather not do those either).  The package that
    >>> owns the | S3 class should have code to call setOldClass
    >>> in its | initialization.
    >>> 
    >>> So, when John Chambers wrote this, he envisioned that
    >>> the 'stats' package would do "the correct thing" for its
    >>> own classes.  OTOH, as history went, the stats package
    >>> was never allowed to depend on methods.  There are many
    >>> other S3 classes from 'stats' which also end up
    >>> similarly, being defined via setOldClass() and that
    >>> itself produces a VIRTUAL class.  Also, another part of
    >>> the (R source) comment above is no longer quite
    >>> accurate, e.g., "data.frame" is in .OldClassesPrototypes
    >>> but not in .OldClassesList ...
    >>> 
    >>> As I do agree that "formula" is much more basic than
    >>> these other classes, I'm currently looking at tweaks to
    >>> the methods (and stats) code, to get this to work.... as
    >>> indeed - you mentioned above - we already allow "empty
    >>> S3 formula" objects anyway.
    >>> 
    >>> ... half an hour later : Indeed, I've been able to use
    >>> the above information such that new("formula") and
    >>> new("formula", y ~ x) work.
    >>> 
    >>> However, your code above now --- with my changes ---
    >>> would fail :
    >>> 
    >>> > setClass("A", representation(slot1="numeric",
    >>> slot2="logical")) > setClass("B", contains="A",
    >>> representation(design="formula")) > setClass("C",
    >>> contains="B") Error in
    >>> reconcilePropertiesAndPrototype(name, slots, prototype,
    >>> superClasses, : "B" is not eligible to be the data part
    >>> of another class (must be a basic class or a virtual
    >>> class with no slots)
    >>> >
    >>> 
    >>> So, I am not yet committing my changes to R-devel.
    >>> Hopefully more on this, later today.
    >>> 
    >>> Martin Maechler, ETH Zurich
    >>> 
    >>> 
    >>> Thanks,
    >>>> H.
    >>>> 
    >>> 
    >>> > sessionInfo()
    >>>> R version 3.2.0 Patched (2015-04-17 r68202) Platform:
    >>>> x86_64-unknown-linux-gnu (64-bit) Running under: Ubuntu
    >>>> 14.04.2 LTS
    >>>> 
    >>> 
    >>> --
    >>>> Herv? Pag?s Fred Hutchinson Cancer Research Center
    >>>> 
    >>> 
    >>> [..................]
    >>> 
    >>> 
    >>> 
    >> --
    >> Herv? Pag?s
    >> 
    >> Program in Computational Biology Division of Public
    >> Health Sciences Fred Hutchinson Cancer Research Center
    >> 1100 Fairview Ave. N, M1-B514 P.O. Box 19024 Seattle, WA
    >> 98109-1024
    >> 
    >> E-mail: hpages at fredhutch.org Phone: (206) 667-5791 Fax:
    >> (206) 667-1319
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >> 



    > -- 
    > Joshua F. Wiley, Ph.D.  http://joshuawiley.com/
    > ---
    > Postdoctoral Research Fellow Mary MacKillop Institute for
    > Health Research Australian Catholic University
    > ---
    > Senior Partner, Elkhart Group Ltd.
    > http://elkhartgroup.com Office: 260.673.5518


From jwiley.psych at gmail.com  Thu Oct  8 13:43:09 2015
From: jwiley.psych at gmail.com (Joshua Wiley)
Date: Thu, 8 Oct 2015 22:43:09 +1100
Subject: [Rd] Unexpected failure when calling new() with unnamed arg and
In-Reply-To: <22038.19866.92251.745312@stat.math.ethz.ch>
References: <55527C42.7090707@fredhutch.org>
	<21843.11818.477419.434062@stat.math.ethz.ch>
	<5553CC87.7080402@fredhutch.org>
	<CANz9Z_L4qY60RXOQuu_4DVc10Yxb0Hy8MzoDHkt4+-jQ7xPPcw@mail.gmail.com>
	<22038.19866.92251.745312@stat.math.ethz.ch>
Message-ID: <CANz9Z_Lp4=f_ttD5RTQoFcGu-Tck2nP9Na9xdDFfGLkFHp=Wbg@mail.gmail.com>

Hi Martin,

Thanks and apologies for not seeing that.  I had checked NEWS but not tried
it in R devel.

Thanks again.

Josh


On Thu, Oct 8, 2015 at 10:03 PM, Martin Maechler <maechler at stat.math.ethz.ch
> wrote:

> >>>>> Joshua Wiley <jwiley.psych at gmail.com>
> >>>>>     on Thu, 8 Oct 2015 12:19:16 +1100 writes:
>
>     > Hi, I realize this is an old thread, but just wondering
>     > whether a conclusion was ever reached on this issue?  I'm
>     > using formula(NULL) but it would be nice if default
>     > initialization worked for formula classes as well.
>
> Well,
> yes "of course", it was fixed quite a while ago ..
> as I had ("almost") promissed (below).
>
> Fixed only for R-devel though, e.g., because it potentially
> requires package re-installation, etc.
>
> Martin
>
>     > Cheers,
>     > Josh
>
>
>     > On Thu, May 14, 2015 at 8:13 AM, Herv? Pag?s
>     > <hpages at fredhutch.org> wrote:
>
>     >> Thanks Martin for looking into this.  H.
>     >>
>     >>
>     >> On 05/13/2015 03:57 AM, Martin Maechler wrote:
>     >>
>     >>> Herv? Pag?s <hpages at fredhutch.org>
>     >>>>>>>> on Tue, 12 May 2015 15:18:42 -0700 writes:
>     >>>>>>>>
>     >>>>>>>
>     >>> Hi,
>     >>>>
>     >>>
>     >>> The man page for new() suggests that if 'a' is an object
>     >>> with slots
>     >>>> "slot1" and "slot2" and C is a class that extends the
>     >>>> class of 'a', then the 2 following calls should be
>     >>>> equivalent:
>     >>>>
>     >>>
>     >>> new("C", a, ...)
>     >>>> new("C", slot1=a at slot1, slot2=a at slot2, ...)
>     >>>>
>     >>>
>     >>> This is generally the case but I just ran into a
>     >>> situation where it's
>     >>>> not. In the following example the former fails while
>     >>>> the latter works:
>     >>>>
>     >>>
>     >>> setClass("A", representation(slot1="numeric",
>     >>> slot2="logical"))
>     >>>> setClass("B", contains="A",
>     >>>> representation(design="formula")) setClass("C",
>     >>>> contains="B") a <- new("A", slot1=77, slot2=TRUE)
>     >>>>
>     >>>
>     >>> new("C", a, design=x ~ y) # fails
>     >>>> new("C", slot1=a at slot1, slot2=a at slot2, design=x ~ y) #
>     >>>> works
>     >>>>
>     >>>
>     >>> Note that new("B", a, design=x ~ y) works so the 3-level
>     >>> class
>     >>>> hierarchy is really needed in order to reproduce.
>     >>>>
>     >>>
>     >>> Probably related to this, I also noted that new("B")
>     >>> and/or new("C")
>     >>>> return invalid objects:
>     >>>>
>     >>>
>     >>> c <- new("C")
>     >>>>
>     >>>
>     >>> validObject(c)
>     >>>> # Error in validObject(c) : # invalid class ?C? object:
>     >>>> invalid object for slot "design" # in class "C": got
>     >>>> class "S4", should be or extend class "formula"
>     >>>>
>     >>>
>     >>> is(c at design, "formula")
>     >>>> # [1] FALSE
>     >>>>
>     >>>
>     >>> class(c at design)
>     >>>> # [1] "S4"
>     >>>>
>     >>>
>     >>> Note that 'c' can be fixed:
>     >>>>
>     >>>
>     >>> c at design <- formula(NULL)
>     >>>>
>     >>>
>     >>> validObject(c)
>     >>>> # [1] TRUE
>     >>>>
>     >>>
>     >>> Maybe something that the default "initialize" method
>     >>> should take care
>     >>>> of?
>     >>>>
>     >>>
>     >>> Another singularity that is maybe at the root of all of
>     >>> this is that
>     >>>> the "formula" S4 class is virtual:
>     >>>>
>     >>>
>     >>> showClass("formula")
>     >>>> # Virtual Class "formula" [package "methods"]
>     >>>> #
>     >>>> # Slots:
>     >>>> #
>     >>>> # Name: .S3Class # Class: character
>     >>>> #
>     >>>> # Extends: "oldClass"
>     >>>>
>     >>>
>     >>> so a bare call to new("formula") fails:
>     >>>>
>     >>>
>     >>> new("formula")
>     >>>> # Error in new("formula") : # trying to generate an
>     >>>> object from a virtual class ("formula")
>     >>>>
>     >>>
>     >>> Shouldn't new("formula") just return an "empty" S3
>     >>> formula (like
>     >>>> formula(NULL) does), in the same way that
>     >>>> new("integer") returns an empty ordinary integer
>     >>>> vector?
>     >>>>
>     >>>
>     >>> Interesting .. and at least worth following.
>     >>>
>     >>> One problem and historical reason for the current setup
>     >>> seems that the "formula" S3 class is not from 'base' but
>     >>> 'stats' :
>     >>>
>     >>> R's source, src/library/methods/R/BasicClasses.R, lines
>     >>> 524 ff has the following comment block
>     >>>
>     >>> | .OldClassesPrototypes is a list of S3 classes for
>     >>> which prototype | objects are known & reasonable.  The
>     >>> classes will reappear in | .OldClassesList, but will
>     >>> have been initialized first in | .InitBasicClasses.  NB:
>     >>> the methods package will NOT set up | prototypes for S3
>     >>> classes except those in package base and for "ts" | (and
>     >>> would rather not do those either).  The package that
>     >>> owns the | S3 class should have code to call setOldClass
>     >>> in its | initialization.
>     >>>
>     >>> So, when John Chambers wrote this, he envisioned that
>     >>> the 'stats' package would do "the correct thing" for its
>     >>> own classes.  OTOH, as history went, the stats package
>     >>> was never allowed to depend on methods.  There are many
>     >>> other S3 classes from 'stats' which also end up
>     >>> similarly, being defined via setOldClass() and that
>     >>> itself produces a VIRTUAL class.  Also, another part of
>     >>> the (R source) comment above is no longer quite
>     >>> accurate, e.g., "data.frame" is in .OldClassesPrototypes
>     >>> but not in .OldClassesList ...
>     >>>
>     >>> As I do agree that "formula" is much more basic than
>     >>> these other classes, I'm currently looking at tweaks to
>     >>> the methods (and stats) code, to get this to work.... as
>     >>> indeed - you mentioned above - we already allow "empty
>     >>> S3 formula" objects anyway.
>     >>>
>     >>> ... half an hour later : Indeed, I've been able to use
>     >>> the above information such that new("formula") and
>     >>> new("formula", y ~ x) work.
>     >>>
>     >>> However, your code above now --- with my changes ---
>     >>> would fail :
>     >>>
>     >>> > setClass("A", representation(slot1="numeric",
>     >>> slot2="logical")) > setClass("B", contains="A",
>     >>> representation(design="formula")) > setClass("C",
>     >>> contains="B") Error in
>     >>> reconcilePropertiesAndPrototype(name, slots, prototype,
>     >>> superClasses, : "B" is not eligible to be the data part
>     >>> of another class (must be a basic class or a virtual
>     >>> class with no slots)
>     >>> >
>     >>>
>     >>> So, I am not yet committing my changes to R-devel.
>     >>> Hopefully more on this, later today.
>     >>>
>     >>> Martin Maechler, ETH Zurich
>     >>>
>     >>>
>     >>> Thanks,
>     >>>> H.
>     >>>>
>     >>>
>     >>> > sessionInfo()
>     >>>> R version 3.2.0 Patched (2015-04-17 r68202) Platform:
>     >>>> x86_64-unknown-linux-gnu (64-bit) Running under: Ubuntu
>     >>>> 14.04.2 LTS
>     >>>>
>     >>>
>     >>> --
>     >>>> Herv? Pag?s Fred Hutchinson Cancer Research Center
>     >>>>
>     >>>
>     >>> [..................]
>     >>>
>     >>>
>     >>>
>     >> --
>     >> Herv? Pag?s
>     >>
>     >> Program in Computational Biology Division of Public
>     >> Health Sciences Fred Hutchinson Cancer Research Center
>     >> 1100 Fairview Ave. N, M1-B514 P.O. Box 19024 Seattle, WA
>     >> 98109-1024
>     >>
>     >> E-mail: hpages at fredhutch.org Phone: (206) 667-5791 Fax:
>     >> (206) 667-1319
>     >>
>     >> ______________________________________________
>     >> R-devel at r-project.org mailing list
>     >> https://stat.ethz.ch/mailman/listinfo/r-devel
>     >>
>
>
>
>     > --
>     > Joshua F. Wiley, Ph.D.  http://joshuawiley.com/
>     > ---
>     > Postdoctoral Research Fellow Mary MacKillop Institute for
>     > Health Research Australian Catholic University
>     > ---
>     > Senior Partner, Elkhart Group Ltd.
>     > http://elkhartgroup.com Office: 260.673.5518
>



-- 
Joshua F. Wiley, Ph.D.
http://joshuawiley.com/
---
Postdoctoral Research Fellow
Mary MacKillop Institute for Health Research
Australian Catholic University
---
Senior Partner, Elkhart Group Ltd.
http://elkhartgroup.com
Office: 260.673.5518

	[[alternative HTML version deleted]]


From S.Ellison at LGCGroup.com  Thu Oct  8 14:56:37 2015
From: S.Ellison at LGCGroup.com (S Ellison)
Date: Thu, 8 Oct 2015 13:56:37 +0100
Subject: [Rd] authorship and citation
In-Reply-To: <CABdHhvEgKF85d0vk2XDNVYDtPr-r10OCxxn+Rdm=FSijQLFa4g@mail.gmail.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
	<CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>
	<CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
	<CABdHhvEgKF85d0vk2XDNVYDtPr-r10OCxxn+Rdm=FSijQLFa4g@mail.gmail.com>
Message-ID: <1A8C1289955EF649A09086A153E2672403B485CBD8@GBTEDVPEXCMB04.corp.lgc-group.com>


> > I read the CRAN policies twice, and there
> > is no official guideline on how to compile the citation.

The policies are about copyright and IP, not credited authorship. There's overlap but they are not the same thing. 

You can see whether someone is a copyright holder by referring to the license you had and whether there is any of their content remaining. But that might not mean they are package 'authors'. If you reuse code verbatim from another package's function, you _must_ note the copyright - but that does not necessarily make the original author of the code a co-author of your package (though I would expect to see at least an acknowledgement in the particular function's help page). And not all 'authors' need necessarily provide code - they could, for example, have developed the core maths the code implements. Of itself, that does not confer copyright in any part of the package code or help text, but it's very likely they'd deserve credit as co-authors. 

Common sense would suggest to me that if you are in doubt about whether someone should be on your author list (as opposed to copyright owner list) in a package's citation, you should probably ask them. And if you are considering removing an author, you should very definitely be in doubt because there was a reason they were there.

The answers you get from different contributors might be different so it would not be surprising if packages differed in the extent to which they cited contributions or added acknowledgements. In essence, though, if everybody feels fairly treated by the citations within a package, there's no reason for anyone else to complain about it, and if someone feels they have not been properly credited they can - and should - contact the maintainer and say so.

So ask before removing someone from your citation. If they say 'no', don?t remove them.

S Ellison


*******************************************************************
This email and any attachments are confidential. Any use, copying or
disclosure other than by the intended recipient is unauthorised. If 
you have received this message in error, please notify the sender 
immediately via +44(0)20 8943 7000 or notify postmaster at lgcgroup.com 
and delete this message and any copies from your computer and network. 
LGC Limited. Registered in England 2991879. 
Registered office: Queens Road, Teddington, Middlesex, TW11 0LY, UK

From ripley at stats.ox.ac.uk  Thu Oct  8 17:15:45 2015
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 8 Oct 2015 16:15:45 +0100
Subject: [Rd] authorship and citation
In-Reply-To: <1A8C1289955EF649A09086A153E2672403B485CBD8@GBTEDVPEXCMB04.corp.lgc-group.com>
References: <CAJ=0CtAKRSjo9yeVtN6ye4kHWZs3Yrf2DJMBscUbWTZRDCDvtg@mail.gmail.com>
	<5612EA11.7080805@statistik.tu-dortmund.de>
	<CAHyGmd7M_OZ3vtJzHBV_1AsHrB34tXD6-a8+wB87S8QpUhPRvw@mail.gmail.com>
	<5612FA28.2090607@statistik.tu-dortmund.de>
	<8B5956DE-4D87-4444-BC9D-AF96C04C4F7A@r-project.org>
	<CAJ=0CtAkV0uyeRjgRbOAdFzp4dfM9b_Q1+PqS2MfLBS492W94Q@mail.gmail.com>
	<CADwqtCPV3cFqSzXH5Wr-uWaSN0PZg_7cFddk-xyqrn5_SNpvSw@mail.gmail.com>
	<CAJ=0CtAF--akTCjUocARtURD5GGxuUX55R+WXxyq=D2Tfn3HNg@mail.gmail.com>
	<CABdHhvEgKF85d0vk2XDNVYDtPr-r10OCxxn+Rdm=FSijQLFa4g@mail.gmail.com>
	<1A8C1289955EF649A09086A153E2672403B485CBD8@GBTEDVPEXCMB04.corp.lgc-group.com>
Message-ID: <561688A1.9010208@stats.ox.ac.uk>

S Ellison posted:

(quoting someone else, it appears)

>>> I read the CRAN policies twice, and there
>>> is no official guideline on how to compile the citation.

And once again Dr Ellison is not attributing quotes: that is clearly 
covered by the posting guide.  Including:

Take care when you quote other people?s comments ...
     The original authorship and meaning should always be clear.

> The policies are about copyright and IP, not credited authorship.

Hmm, people keep saying things like that, but it is not correct.  The 
right to be identified as an author is an IP right: in some 
jurisdictions it is called a 'moral right' (and there are others).


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford
1 South Parks Road, Oxford OX1 3TG, UK


From jgrn at illinois.edu  Thu Oct  8 19:51:25 2015
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Thu, 08 Oct 2015 17:51:25 +0000
Subject: [Rd] library() in .Rd Examples (Depends vs. Imports)?
Message-ID: <CABG0rfvubYw7HVFA_AQW4wGr4NvXY_1dZv7JDUP7TmULuE94eg@mail.gmail.com>

I'm a little confused when documenting my code using Imports vs. Depends.
If I have an example in my .Rd that uses a library that is listed under
Imports, it doesn't work, but if it is listed under Depends, it does.  What
is the proper way to go about using examples that rely on an Imports?
Should I just if(require(somepackage)) in the example?  Or is there a more
elegant way of doing this?

--j

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Thu Oct  8 20:12:34 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 8 Oct 2015 14:12:34 -0400
Subject: [Rd] library() in .Rd Examples (Depends vs. Imports)?
In-Reply-To: <CABG0rfvubYw7HVFA_AQW4wGr4NvXY_1dZv7JDUP7TmULuE94eg@mail.gmail.com>
References: <CABG0rfvubYw7HVFA_AQW4wGr4NvXY_1dZv7JDUP7TmULuE94eg@mail.gmail.com>
Message-ID: <5616B212.3060301@gmail.com>

On 08/10/2015 1:51 PM, Jonathan Greenberg wrote:
> I'm a little confused when documenting my code using Imports vs. Depends.
> If I have an example in my .Rd that uses a library that is listed under
> Imports, it doesn't work, but if it is listed under Depends, it does.  What
> is the proper way to go about using examples that rely on an Imports?
> Should I just if(require(somepackage)) in the example?  Or is there a more
> elegant way of doing this?

The more elegant way is to use somepackage::somefunction(...).   You 
should avoid using require(somepackage), because that modifies the 
user's search list; they may not want you to do that.

Within your own package code you won't need the somepackage:: prefix if 
you import the function in your NAMESPACE file, but help page examples 
are executed in the user's context, so they can't see imports.

Duncan Murdoch


From dutangc at gmail.com  Thu Oct  8 19:58:20 2015
From: dutangc at gmail.com (Christophe Dutang)
Date: Thu, 8 Oct 2015 19:58:20 +0200
Subject: [Rd] names treatment in optim()
In-Reply-To: <5BD131B0-C1B7-43FE-A309-3082EBE80807@gmail.com>
References: <5BD131B0-C1B7-43FE-A309-3082EBE80807@gmail.com>
Message-ID: <C216D74B-6503-45B8-8F43-32FFE52DE488@gmail.com>

Dear list,

A possible patch to correct the treatment of names consists in adding the following lines

    if(!is.null(names(par))) names(res$par) <- names(par)  
    if(!is.null(names(fn1(par)))) names(res$value) <- names(fn1(par)) 

 just before returning the variable res in optim. That is 

optim <-
    function(par, fn, gr = NULL, ...,
             method = c("Nelder-Mead", "BFGS", "CG", "L-BFGS-B", "SANN", "Brent"),
             lower = -Inf, upper = Inf,
             control = list(), hessian = FALSE)
{
?

    if (hessian)
        res$hessian <- .External2(C_optimhess, res$par, fn1, gr1, con)
    if(!is.null(names(par))) names(res$par) <- names(par)  
    if(!is.null(names(fn1(par)))) names(res$value) <- names(fn1(par)) 
    res
}

Regards, Christophe

---------------------------------------
Christophe Dutang
LMM, UdM, Le Mans, France
web: http://dutangc.free.fr

> Le 17 sept. 2015 ? 13:04, Christophe Dutang <dutangc at gmail.com> a ?crit :
> 
> Dear both,
> 
> I have found that names are not treated in the same way in optim() depending on the optimization method (argument method). 
> 
> The example below shows the difference between the Brent method and the L-BFGS-B method.
> 
> f <- function(x){ y <- x^2;names(y) <-"f(x)";y}
> optim(10, f, method="Brent", lower=-1, upper=10)$value
> optim(10, f, method="L-BFGS-B", lower=-1, upper=10)$value
> 
> z <- 10
> names(z) <- "x"
> z
> optim(z, f, method="Brent", lower=-1, upper=10)$par
> optim(z, f, method="L-BFGS-B", lower=-1, upper=10)$par
> 
> 
> Do you obtain the same behavior? would you consider interesting to have the names passed to the components value and par?
> 
> I?m using R version 3.2.2 (2015-08-14)
> Platform: x86_64-apple-darwin13.4.0 (64-bit)
> Running under: OS X 10.10.5 (Yosemite)
> 
> locale:
> [1] fr_FR.UTF-8/fr_FR.UTF-8/fr_FR.UTF-8/C/fr_FR.UTF-8/fr_FR.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base   
> 
> 
> 
> Kind regards, Christophe
> 
> ---------------------------------------
> Christophe Dutang
> LMM, UdM, Le Mans, France
> web: http://dutangc.free.fr
> 


From marius.hofert at uwaterloo.ca  Thu Oct  8 22:18:10 2015
From: marius.hofert at uwaterloo.ca (Marius Hofert)
Date: Thu, 8 Oct 2015 22:18:10 +0200
Subject: [Rd] rank(, ties.method="last")
Message-ID: <CAM3-KjZ=d1a4sUFckw83RZu-phZffY7KvZeQ1WtAjNB6ysoeJw@mail.gmail.com>

Hi,

I ran into a problem where I actually need rank(, ties.method="last"). It would
be great to have this feature in base and it's also simple to get (see below).

Thanks & cheers,
Marius


rank2 <- function (x, na.last = TRUE, ties.method = c("average",
"first", "last", # new "last"
    "random", "max", "min"))
{
    nas <- is.na(x)
    nm <- names(x)
    ties.method <- match.arg(ties.method)
    if (is.factor(x))
        x <- as.integer(x)
    x <- x[!nas]
    y <- switch(ties.method, average = , min = , max = .Internal(rank(x,
        length(x), ties.method)), first = sort.list(sort.list(x)),
        last = sort.list(sort.list(x, decreasing=TRUE),
decreasing=TRUE), # change
        random = sort.list(order(x, stats::runif(sum(!nas)))))
    if (!is.na(na.last) && any(nas)) {
        yy <- NA
        NAkeep <- (na.last == "keep")
        if (NAkeep || na.last) {
            yy[!nas] <- y
            if (!NAkeep)
                yy[nas] <- (length(y) + 1L):length(yy)
        }
        else {
            len <- sum(nas)
            yy[!nas] <- y + len
            yy[nas] <- seq_len(len)
        }
        y <- yy
        names(y) <- nm
    }
    else names(y) <- nm[!nas]
    y
}

## MWE
x <- c(10, 11, 11, 12, 12, 13)
rank(x, ties.method="first")
rank2(x, ties.method="last")


From ckmsasi at gmail.com  Thu Oct  8 22:58:16 2015
From: ckmsasi at gmail.com (Sasikumar Kandhasamy)
Date: Thu, 8 Oct 2015 13:58:16 -0700
Subject: [Rd] R-core package cross compilation help
Message-ID: <CABbvK+Go0__5z=6VBsAnKPasWYSoC1wm2cg7cwuhN6FbxVQKdg@mail.gmail.com>

Hi,

I am a beginner to R language and currently exploring R to use it for
machine learning use case. My requirement is to include R-core package in
my embedded linux box which runs on customized Monta Vista Linux with
kernel 2.6.32 and it has multi-core MIPS processor.

I hope, there is NO pre-compiled R package for Monta vista linux and mips
processor. So, i am trying to do cross compilation with monta vista mips
compiler toolchain.

Can you please help me with reference manuals(if any) on setting up the R
package for cross compilation? and also, given that we need only
statistical analytic model algorithms and we may not use graphical
interface, what is the recommendation on packages to be compiled?



Thanks & Regards
Sasi

	[[alternative HTML version deleted]]


From brian at braverock.com  Thu Oct  8 23:47:58 2015
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 08 Oct 2015 16:47:58 -0500
Subject: [Rd] R-core package cross compilation help
In-Reply-To: <CABbvK+Go0__5z=6VBsAnKPasWYSoC1wm2cg7cwuhN6FbxVQKdg@mail.gmail.com>
References: <CABbvK+Go0__5z=6VBsAnKPasWYSoC1wm2cg7cwuhN6FbxVQKdg@mail.gmail.com>
Message-ID: <1444340878.30969.11.camel@brian-rcg>

On Thu, 2015-10-08 at 13:58 -0700, Sasikumar Kandhasamy wrote:
> I am a beginner to R language and currently exploring R to use it for
> machine learning use case. My requirement is to include R-core package in
> my embedded linux box which runs on customized Monta Vista Linux with
> kernel 2.6.32 and it has multi-core MIPS processor.
> 
> I hope, there is NO pre-compiled R package for Monta vista linux and mips
> processor. So, i am trying to do cross compilation with monta vista mips
> compiler toolchain.
> 
> Can you please help me with reference manuals(if any) on setting up the R
> package for cross compilation? and also, given that we need only
> statistical analytic model algorithms and we may not use graphical
> interface, what is the recommendation on packages to be compiled?

See the R Installation and Administration manual here:

https://cran.r-project.org/doc/manuals/r-devel/R-admin.html

Especially 

https://cran.r-project.org/doc/manuals/r-devel/R-admin.html#Simple-compilation

and then, to consider machine learning applications in addition to R
core, you probably want to look at the task view to consider packages:

https://cran.r-project.org/web/views/MachineLearning.html

questions on the packages in the task view should probably be directed
to the package maintainers or e.g. r-help or one of the r-sig-* lists,
as appropriate.

Regards,

Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From vinhdizzo at gmail.com  Fri Oct  9 03:50:07 2015
From: vinhdizzo at gmail.com (Vinh Nguyen)
Date: Thu, 8 Oct 2015 18:50:07 -0700
Subject: [Rd] R 3.2.2 64 bit compilation error on AIX
Message-ID: <CA+2Dmwg42NrchprLEOoSuVSyqtU8H6H2XLLUZYftGHG6-bfXyw@mail.gmail.com>

Dear list,

I'm following the instructions provided here to compile R 64 bit on
AIX 6.1.  I did

export OBJECT_MODE=64
export CC="gcc -maix64 -pthread"
export CXX="g++ -maix64 -pthread"
export FC="gfortran -maix64 -pthread"
export F77="gfortran -maix64 -pthread"
export CFLAGS="-O2 -g -mcpu=power6"
export FFLAGS="-O2 -g -mcpu=power6"
export FCFLAGS="-O2 -g -mcpu=power6"
./configure
make -j 16

and it errors out at

gcc -maix64 -pthread -std=gnu99 -I../../../../include -DNDEBUG
-I../../../include -I../../../../src/include -DHAVE_CONFIG_H
-I../../../../src/main -I/usr/local/include  -mminimal-toc    -O2 -g
-mcpu=power6  -c gramRd.c -o gramRd.o

gcc -maix64 -pthread -std=gnu99 -shared -Wl,-brtl -Wl,-G -Wl,-bexpall
-Wl,-bnoentry -lc -L/usr/local/lib -o tools.so text.o init.o Rmd5.o
md5.o signals.o install.o getfmts.o http.o gramLatex.o gramRd.o -lm
-lintl

make[6]: Entering directory '/sas/data04/vinh/R-3.2.2/src/library/tools/src'

mkdir -p -- ../../../../library/tools/libs

make[6]: Leaving directory '/sas/data04/vinh/R-3.2.2/src/library/tools/src'

make[5]: Leaving directory '/sas/data04/vinh/R-3.2.2/src/library/tools/src'

make[4]: Leaving directory '/sas/data04/vinh/R-3.2.2/src/library/tools'

make[4]: Entering directory '/sas/data04/vinh/R-3.2.2/src/library/tools'

installing 'sysdata.rda'

Error: Line starting 'Package: tools ...' is malformed!

Execution halted

../../../share/make/basepkg.mk:150: recipe for target 'sysdata' failed

make[4]: *** [sysdata] Error 1

make[4]: Leaving directory '/sas/data04/vinh/R-3.2.2/src/library/tools'

Makefile:30: recipe for target 'all' failed

make[3]: *** [all] Error 2

make[3]: Leaving directory '/sas/data04/vinh/R-3.2.2/src/library/tools'

Makefile:36: recipe for target 'R' failed

make[2]: *** [R] Error 1

make[2]: Leaving directory '/sas/data04/vinh/R-3.2.2/src/library'

Makefile:28: recipe for target 'R' failed

make[1]: *** [R] Error 1

make[1]: Leaving directory '/sas/data04/vinh/R-3.2.2/src'

Makefile:59: recipe for target 'R' failed

make: *** [R] Error 1



I tried going all the way back to R 2.15.3 and I still get this error.
Any suggestions for fixing this?  Thanks.

-- Vinh


From vinhdizzo at gmail.com  Fri Oct  9 03:51:31 2015
From: vinhdizzo at gmail.com (Vinh Nguyen)
Date: Thu, 8 Oct 2015 18:51:31 -0700
Subject: [Rd] R 3.2.2 64 bit compilation error on AIX
In-Reply-To: <CA+2Dmwg42NrchprLEOoSuVSyqtU8H6H2XLLUZYftGHG6-bfXyw@mail.gmail.com>
References: <CA+2Dmwg42NrchprLEOoSuVSyqtU8H6H2XLLUZYftGHG6-bfXyw@mail.gmail.com>
Message-ID: <CA+2DmwiWo0RwSfS7eMQgXr_MxMN3UE76wCqspWysP-UghY0nSg@mail.gmail.com>

Please note that if I don't specify those variables, then R 32 bit
compiles fine.  Thanks.
-- Vinh


On Thu, Oct 8, 2015 at 6:50 PM, Vinh Nguyen <vinhdizzo at gmail.com> wrote:
> Dear list,
>
> I'm following the instructions provided here to compile R 64 bit on
> AIX 6.1.  I did
>
> export OBJECT_MODE=64
> export CC="gcc -maix64 -pthread"
> export CXX="g++ -maix64 -pthread"
> export FC="gfortran -maix64 -pthread"
> export F77="gfortran -maix64 -pthread"
> export CFLAGS="-O2 -g -mcpu=power6"
> export FFLAGS="-O2 -g -mcpu=power6"
> export FCFLAGS="-O2 -g -mcpu=power6"
> ./configure
> make -j 16
>
> and it errors out at
>
> gcc -maix64 -pthread -std=gnu99 -I../../../../include -DNDEBUG
> -I../../../include -I../../../../src/include -DHAVE_CONFIG_H
> -I../../../../src/main -I/usr/local/include  -mminimal-toc    -O2 -g
> -mcpu=power6  -c gramRd.c -o gramRd.o
>
> gcc -maix64 -pthread -std=gnu99 -shared -Wl,-brtl -Wl,-G -Wl,-bexpall
> -Wl,-bnoentry -lc -L/usr/local/lib -o tools.so text.o init.o Rmd5.o
> md5.o signals.o install.o getfmts.o http.o gramLatex.o gramRd.o -lm
> -lintl
>
> make[6]: Entering directory '/sas/data04/vinh/R-3.2.2/src/library/tools/src'
>
> mkdir -p -- ../../../../library/tools/libs
>
> make[6]: Leaving directory '/sas/data04/vinh/R-3.2.2/src/library/tools/src'
>
> make[5]: Leaving directory '/sas/data04/vinh/R-3.2.2/src/library/tools/src'
>
> make[4]: Leaving directory '/sas/data04/vinh/R-3.2.2/src/library/tools'
>
> make[4]: Entering directory '/sas/data04/vinh/R-3.2.2/src/library/tools'
>
> installing 'sysdata.rda'
>
> Error: Line starting 'Package: tools ...' is malformed!
>
> Execution halted
>
> ../../../share/make/basepkg.mk:150: recipe for target 'sysdata' failed
>
> make[4]: *** [sysdata] Error 1
>
> make[4]: Leaving directory '/sas/data04/vinh/R-3.2.2/src/library/tools'
>
> Makefile:30: recipe for target 'all' failed
>
> make[3]: *** [all] Error 2
>
> make[3]: Leaving directory '/sas/data04/vinh/R-3.2.2/src/library/tools'
>
> Makefile:36: recipe for target 'R' failed
>
> make[2]: *** [R] Error 1
>
> make[2]: Leaving directory '/sas/data04/vinh/R-3.2.2/src/library'
>
> Makefile:28: recipe for target 'R' failed
>
> make[1]: *** [R] Error 1
>
> make[1]: Leaving directory '/sas/data04/vinh/R-3.2.2/src'
>
> Makefile:59: recipe for target 'R' failed
>
> make: *** [R] Error 1
>
>
>
> I tried going all the way back to R 2.15.3 and I still get this error.
> Any suggestions for fixing this?  Thanks.
>
> -- Vinh


From vinhdizzo at gmail.com  Fri Oct  9 04:22:35 2015
From: vinhdizzo at gmail.com (Vinh Nguyen)
Date: Thu, 8 Oct 2015 19:22:35 -0700
Subject: [Rd] R 3.2.2 64 bit compilation error on AIX
In-Reply-To: <CA+2DmwiWo0RwSfS7eMQgXr_MxMN3UE76wCqspWysP-UghY0nSg@mail.gmail.com>
References: <CA+2Dmwg42NrchprLEOoSuVSyqtU8H6H2XLLUZYftGHG6-bfXyw@mail.gmail.com>
	<CA+2DmwiWo0RwSfS7eMQgXr_MxMN3UE76wCqspWysP-UghY0nSg@mail.gmail.com>
Message-ID: <CA+2DmwgQEkZuCZCvyhudhY55rFznN6ddgeo=qVfx5bJO1AnGSg@mail.gmail.com>

One other note: I'm also using the latest src/main/dcf.c that was
giving an issue on AIX previously; see
[this](https://stat.ethz.ch/pipermail/r-devel/2015-September/071781.html)
thread.

Thanks.

On Thu, Oct 8, 2015 at 6:51 PM, Vinh Nguyen <vinhdizzo at gmail.com> wrote:
> Please note that if I don't specify those variables, then R 32 bit
> compiles fine.  Thanks.
>
> -- Vinh


From vinhdizzo at gmail.com  Fri Oct  9 05:21:32 2015
From: vinhdizzo at gmail.com (Vinh Nguyen)
Date: Thu, 8 Oct 2015 20:21:32 -0700
Subject: [Rd] R 3.2.2 64 bit compilation error on AIX
In-Reply-To: <CA+2DmwgQEkZuCZCvyhudhY55rFznN6ddgeo=qVfx5bJO1AnGSg@mail.gmail.com>
References: <CA+2Dmwg42NrchprLEOoSuVSyqtU8H6H2XLLUZYftGHG6-bfXyw@mail.gmail.com>
	<CA+2DmwiWo0RwSfS7eMQgXr_MxMN3UE76wCqspWysP-UghY0nSg@mail.gmail.com>
	<CA+2DmwgQEkZuCZCvyhudhY55rFznN6ddgeo=qVfx5bJO1AnGSg@mail.gmail.com>
Message-ID: <CA+2DmwhY7Qo19JY-TMpR-oObDvkEEqzemVsoqhf9YV2B9W-mRw@mail.gmail.com>

Ahh, sorry for not googling the error message.  Found
[this](http://r.789695.n4.nabble.com/Error-compiling-R-2-10-1-on-AIX-td1017862.html)
post that suggests modifying /src/extra/tre/tre-internal.h
(https://r-forge.r-project.org/scm/viewvc.php/patches/aix_R210_tre.patch?view=markup&root=aix)
for AIX 64 bit.

Is it possible to add this information to the AIX section of the
R-admin manual?  Thanks.

-- Vinh


On Thu, Oct 8, 2015 at 7:22 PM, Vinh Nguyen <vinhdizzo at gmail.com> wrote:
> One other note: I'm also using the latest src/main/dcf.c that was
> giving an issue on AIX previously; see
> [this](https://stat.ethz.ch/pipermail/r-devel/2015-September/071781.html)
> thread.
>
> Thanks.
>
> On Thu, Oct 8, 2015 at 6:51 PM, Vinh Nguyen <vinhdizzo at gmail.com> wrote:
>> Please note that if I don't specify those variables, then R 32 bit
>> compiles fine.  Thanks.
>>
>> -- Vinh


From avraham.adler at gmail.com  Fri Oct  9 07:24:44 2015
From: avraham.adler at gmail.com (Avraham Adler)
Date: Fri, 9 Oct 2015 01:24:44 -0400
Subject: [Rd] Building manuals are failing now that MikTex 2.9 has removed
	texi2dvi.exe
Message-ID: <CAL6gwn+WG9oJH6qzCnnzAGc+5jY-4qBJjmzJLMv_VgDmF54qsg@mail.gmail.com>

According to the MikTex bug reports [1], MikTex 2.9 has removed
texi2dvi.exe last week (on 2015-09-29) as "it was not compatible
(anymore) with the original shell script texi2dvi (GNU Texinfo)." I
found this out the hard way as I just (unknowingly) updated MikTex
this evening, and then, while building R-devel_2015-10-08 on Windows7
64bit using the Rtools 3.3 toolchain (4.9.3 branch), had it crash
during `make manuals` with:

Output written on fullrefman.pdf (3468 pages, 9511515 bytes).
Transcript written on fullrefman.log.
creating doc/manual/version.texi
texi2dvi --pdf --texinfo="@set UseExternalXrefs " R-FAQ.texi
texi2dvi: not found
make[1]: *** [R-FAQ.pdf] Error 127
make: *** [manuals] Error 2

Outside of trying to dig up an old (and now obsolete) version of the
executable, what can be, or should be, done to build the manuals, or
have we lost that ability?

Thank you,

Avi

[1] http://sourceforge.net/p/miktex/bugs/2400/


From ripley at stats.ox.ac.uk  Fri Oct  9 07:44:17 2015
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 9 Oct 2015 06:44:17 +0100
Subject: [Rd] Building manuals are failing now that MikTex 2.9 has
 removed texi2dvi.exe
In-Reply-To: <CAL6gwn+WG9oJH6qzCnnzAGc+5jY-4qBJjmzJLMv_VgDmF54qsg@mail.gmail.com>
References: <CAL6gwn+WG9oJH6qzCnnzAGc+5jY-4qBJjmzJLMv_VgDmF54qsg@mail.gmail.com>
Message-ID: <56175431.40801@stats.ox.ac.uk>

Hmm, look in MkRules.dist for the setting you failed to make .... 
Obviously available in R-patched and R-devel only as we cannot foretell 
such changes.

On 09/10/2015 06:24, Avraham Adler wrote:
> According to the MikTex bug reports [1], MikTex 2.9 has removed
> texi2dvi.exe last week (on 2015-09-29) as "it was not compatible
> (anymore) with the original shell script texi2dvi (GNU Texinfo)." I
> found this out the hard way as I just (unknowingly) updated MikTex
> this evening, and then, while building R-devel_2015-10-08 on Windows7
> 64bit using the Rtools 3.3 toolchain (4.9.3 branch), had it crash

Note what the posting guide says about not abusing the word 'crash'.

> during `make manuals` with:
>
> Output written on fullrefman.pdf (3468 pages, 9511515 bytes).
> Transcript written on fullrefman.log.
> creating doc/manual/version.texi
> texi2dvi --pdf --texinfo="@set UseExternalXrefs " R-FAQ.texi
> texi2dvi: not found
> make[1]: *** [R-FAQ.pdf] Error 127
> make: *** [manuals] Error 2
>
> Outside of trying to dig up an old (and now obsolete) version of the
> executable, what can be, or should be, done to build the manuals, or
> have we lost that ability?
>
> Thank you,
>
> Avi
>
> [1] http://sourceforge.net/p/miktex/bugs/2400/


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford
1 South Parks Road, Oxford OX1 3TG, UK


From avraham.adler at gmail.com  Fri Oct  9 07:54:32 2015
From: avraham.adler at gmail.com (Avraham Adler)
Date: Fri, 9 Oct 2015 01:54:32 -0400
Subject: [Rd] Building manuals are failing now that MikTex 2.9 has
	removed texi2dvi.exe
In-Reply-To: <56175431.40801@stats.ox.ac.uk>
References: <CAL6gwn+WG9oJH6qzCnnzAGc+5jY-4qBJjmzJLMv_VgDmF54qsg@mail.gmail.com>
	<56175431.40801@stats.ox.ac.uk>
Message-ID: <CAL6gwn+-_Fr5G6gFxUyZmf5AZfMUWu3dRc8OVHkbHrDAdVR4jA@mail.gmail.com>

On Fri, Oct 9, 2015 at 1:44 AM, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> Hmm, look in MkRules.dist for the setting you failed to make .... Obviously
> available in R-patched and R-devel only as we cannot foretell such changes.
>
>[snip]

Yes, I see my error. For efficiency, I had copied in an old pre-filled
Mkrules.local; penny wise and pound foolish.

> Note what the posting guide says about not abusing the word 'crash'.

My apologies for the word "crash." More accurate would have been
"properly halted."

Thank you very much,

Avi


From maechler at stat.math.ethz.ch  Fri Oct  9 08:36:39 2015
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 9 Oct 2015 08:36:39 +0200
Subject: [Rd] R 3.2.2 64 bit compilation error on AIX
In-Reply-To: <CA+2DmwhY7Qo19JY-TMpR-oObDvkEEqzemVsoqhf9YV2B9W-mRw@mail.gmail.com>
References: <CA+2Dmwg42NrchprLEOoSuVSyqtU8H6H2XLLUZYftGHG6-bfXyw@mail.gmail.com>
	<CA+2DmwiWo0RwSfS7eMQgXr_MxMN3UE76wCqspWysP-UghY0nSg@mail.gmail.com>
	<CA+2DmwgQEkZuCZCvyhudhY55rFznN6ddgeo=qVfx5bJO1AnGSg@mail.gmail.com>
	<CA+2DmwhY7Qo19JY-TMpR-oObDvkEEqzemVsoqhf9YV2B9W-mRw@mail.gmail.com>
Message-ID: <22039.24695.462269.116657@stat.math.ethz.ch>

>>>>> Vinh Nguyen <vinhdizzo at gmail.com>
>>>>>     on Thu, 8 Oct 2015 20:21:32 -0700 writes:

    > Ahh, sorry for not googling the error message.  Found
    > [this](http://r.789695.n4.nabble.com/Error-compiling-R-2-10-1-on-AIX-td1017862.html)
    > post that suggests modifying /src/extra/tre/tre-internal.h
    > (https://r-forge.r-project.org/scm/viewvc.php/patches/aix_R210_tre.patch?view=markup&root=aix)
    > for AIX 64 bit.

    > Is it possible to add this information to the AIX section
    > of the R-admin manual?  Thanks.

Actually, I think we (R Core) should just apply that patch to the
 R/src/extras/tre/ sources.

But this does not seem to be related to your original problem
where compilation stopped during tools package building,
or does it ?

Martin Maechler,
ETH Zurich

    > -- Vinh


    > On Thu, Oct 8, 2015 at 7:22 PM, Vinh Nguyen
    > <vinhdizzo at gmail.com> wrote:
    >> One other note: I'm also using the latest src/main/dcf.c
    >> that was giving an issue on AIX previously; see
    >> [this](https://stat.ethz.ch/pipermail/r-devel/2015-September/071781.html)
    >> thread.
    >> 
    >> Thanks.
    >> 
    >> On Thu, Oct 8, 2015 at 6:51 PM, Vinh Nguyen
    >> <vinhdizzo at gmail.com> wrote:
    >>> Please note that if I don't specify those variables,
    >>> then R 32 bit compiles fine.  Thanks.
    >>> 
    >>> -- Vinh

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From maechler at stat.math.ethz.ch  Fri Oct  9 12:14:55 2015
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 9 Oct 2015 12:14:55 +0200
Subject: [Rd] rank(, ties.method="last")
In-Reply-To: <CAM3-KjZ=d1a4sUFckw83RZu-phZffY7KvZeQ1WtAjNB6ysoeJw@mail.gmail.com>
References: <CAM3-KjZ=d1a4sUFckw83RZu-phZffY7KvZeQ1WtAjNB6ysoeJw@mail.gmail.com>
Message-ID: <22039.37791.6045.955899@stat.math.ethz.ch>


> I ran into a problem where I actually need rank(, ties.method="last"). It would
> be great to have this feature in base and it's also simple to get (see below).

> Thanks & cheers,
> Marius


> rank2 <- function (x, na.last = TRUE, ties.method = c("average",
> "first", "last", # new "last"
>     "random", "max", "min"))
> {
>     nas <- is.na(x)
>     nm <- names(x)
>     ties.method <- match.arg(ties.method)
>     if (is.factor(x))
>         x <- as.integer(x)
>     x <- x[!nas]
>     y <- switch(ties.method, average = , min = , max = .Internal(rank(x,
>         length(x), ties.method)), first = sort.list(sort.list(x)),
>         last = sort.list(sort.list(x, decreasing=TRUE), decreasing=TRUE), # change
>         random = sort.list(order(x, stats::runif(sum(!nas)))))
>     if (!is.na(na.last) && any(nas)) {
>         yy <- NA
>         NAkeep <- (na.last == "keep")
>         if (NAkeep || na.last) {
>             yy[!nas] <- y
>             if (!NAkeep)
>                 yy[nas] <- (length(y) + 1L):length(yy)
>         }
>         else {
>             len <- sum(nas)
>             yy[!nas] <- y + len
>             yy[nas] <- seq_len(len)
>         }
>         y <- yy
>         names(y) <- nm
>     }
>     else names(y) <- nm[!nas]
>     y
> }

> ## MWE
> x <- c(10, 11, 11, 12, 12, 13)
> rank(x, ties.method="first")
> rank2(x, ties.method="last")

Indeed, this makes sense to me, and is easy enough to document
and maintain, and preferable to asking useRs to use  rev(.) and
similar "easy" (but somewhat costly for large data!)
transformations to get the same....

Or have (Marius Hofert and I) overlooked something obvious ?

Martin Maechler,
ETH Zurich


From bo.werth at gmail.com  Fri Oct  9 11:55:08 2015
From: bo.werth at gmail.com (Bo Werth)
Date: Fri, 9 Oct 2015 11:55:08 +0200
Subject: [Rd] reverse object creation
Message-ID: <CAHaz_Kk6WkTCADXdh5A+o57iMKtVAKjv8_ROX61=TwAsW9fAHA@mail.gmail.com>

Dear all,

this is my first message to this mailing list - please advise if it is not
the right place for the subject

I've been using R very intensively the last 3-4 years and one of the most
tedious tasks is modification of lookup or conversion tables

So far, I have not found functions that create the commands for creating
objects (vectors, data frames) based on the objects themselves - i.e. to
reverse-engineer them.

Here are my suggestions:

c_rev <- function(x) cat(paste0('c("', gsub(', ', '", "', toString(x)),
'")\n'))

df_rev <- function(x) {
    X <- apply(x, 1,
               function(x) {
                   paste0('c(',
                          paste0(shQuote(x), collapse = ", "),
                          ')'
                          )
               }
               )
    command <- paste0(
        'rbind.data.frame(',
        paste0(
            X,
            collapse = ",\n"),
        ')')
    return(cat(command, "\n"))
}

Bo

---
bowerth.github.io

	[[alternative HTML version deleted]]


From thierry.onkelinx at inbo.be  Fri Oct  9 12:22:26 2015
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Fri, 9 Oct 2015 12:22:26 +0200
Subject: [Rd] reverse object creation
In-Reply-To: <CAHaz_Kk6WkTCADXdh5A+o57iMKtVAKjv8_ROX61=TwAsW9fAHA@mail.gmail.com>
References: <CAHaz_Kk6WkTCADXdh5A+o57iMKtVAKjv8_ROX61=TwAsW9fAHA@mail.gmail.com>
Message-ID: <CAJuCY5yzoWS5UR0r2pveSDvh-sHWYr2KmomYmT9_btdo0i_Y0w@mail.gmail.com>

Dear Bo,

I think that you are looking for dput()

Best regards,

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

2015-10-09 11:55 GMT+02:00 Bo Werth <bo.werth at gmail.com>:

> Dear all,
>
> this is my first message to this mailing list - please advise if it is not
> the right place for the subject
>
> I've been using R very intensively the last 3-4 years and one of the most
> tedious tasks is modification of lookup or conversion tables
>
> So far, I have not found functions that create the commands for creating
> objects (vectors, data frames) based on the objects themselves - i.e. to
> reverse-engineer them.
>
> Here are my suggestions:
>
> c_rev <- function(x) cat(paste0('c("', gsub(', ', '", "', toString(x)),
> '")\n'))
>
> df_rev <- function(x) {
>     X <- apply(x, 1,
>                function(x) {
>                    paste0('c(',
>                           paste0(shQuote(x), collapse = ", "),
>                           ')'
>                           )
>                }
>                )
>     command <- paste0(
>         'rbind.data.frame(',
>         paste0(
>             X,
>             collapse = ",\n"),
>         ')')
>     return(cat(command, "\n"))
> }
>
> Bo
>
> ---
> bowerth.github.io
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From thierry.onkelinx at inbo.be  Fri Oct  9 12:54:52 2015
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Fri, 9 Oct 2015 12:54:52 +0200
Subject: [Rd] reverse object creation
In-Reply-To: <CAHaz_K=O+0S=z_vuxr0hHHFKLSrZP2_y51RsEHVmY699wAmuHQ@mail.gmail.com>
References: <CAHaz_Kk6WkTCADXdh5A+o57iMKtVAKjv8_ROX61=TwAsW9fAHA@mail.gmail.com>
	<CAJuCY5yzoWS5UR0r2pveSDvh-sHWYr2KmomYmT9_btdo0i_Y0w@mail.gmail.com>
	<CAHaz_K=O+0S=z_vuxr0hHHFKLSrZP2_y51RsEHVmY699wAmuHQ@mail.gmail.com>
Message-ID: <CAJuCY5w9uyFUkVzMCzpUgNi18B+8S0FPqg3wT2GCtXFBNoudkg@mail.gmail.com>

Dear Bo,

Please keep the mailing list in cc.

Your function only works properly with a data.frame in which all variables
are characters. dput() will preserve the structure of the object and works
with all R objects.

Best regards,

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

2015-10-09 12:32 GMT+02:00 Bo Werth <bo.werth at gmail.com>:

> Dear Thierry,
>
> many thanks for the hint - indeed, I wasn't aware of dput() - it is doing
> something close to what I was looking for -
> the only issue with the result for data frames is that it becomes
> difficult to see the row association:
>
> dput returns
>
> structure(list(sheet = c("output cup", "output coppy", "gross value added
> cup",
> "gross value added coppy", "GFCF cup", "GFCF vol", "empl jobs",
> "empl FTE", "employees jobs", "employees FTE", "D1", "D11", "D29-D39",
> "D29 nom", "D39 nom", "P51c nom", "B2n+B3n", "total hours worked",
> "hours worked employees"), var = c("PROD", "PKPY", "VALU", "VKPY",
> "GFCF", "GKPY", "EMPN", "FTEN", "EMPE", "FTEE", "LABR", "WAGE",
> "OTXS", "D29 nom", "D39 nom", "CFCC", "NOPS", "HRNS", "HRSE")), .Names =
> c("sheet",
> "var"), row.names = c(NA, -19L), class = "data.frame")
> >
>
> df_rev returns
>
> rbind.data.frame(c("output cup", "PROD"),
> c("output coppy", "PKPY"),
> c("gross value added cup", "VALU"),
> c("gross value added coppy", "VKPY"),
> c("GFCF cup", "GFCF"),
> c("GFCF vol", "GKPY"),
> c("empl jobs", "EMPN"),
> c("empl FTE", "FTEN"),
> c("employees jobs", "EMPE"),
> c("employees FTE", "FTEE"),
> c("D1", "LABR"),
> c("D11", "WAGE"),
> c("D29-D39", "OTXS"),
> c("D29 nom", "D29 nom"),
> c("D39 nom", "D39 nom"),
> c("P51c nom", "CFCC"),
> c("B2n+B3n", "NOPS"),
> c("total hours worked", "HRNS"),
> c("hours worked employees", "HRSE"))
>
> Thanks again,
> best,
> Bo
>
> On Fri, Oct 9, 2015 at 12:22 PM, Thierry Onkelinx <
> thierry.onkelinx at inbo.be> wrote:
>
>> Dear Bo,
>>
>> I think that you are looking for dput()
>>
>> Best regards,
>>
>> ir. Thierry Onkelinx
>> Instituut voor natuur- en bosonderzoek / Research Institute for Nature
>> and Forest
>> team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
>> Kliniekstraat 25
>> 1070 Anderlecht
>> Belgium
>>
>> To call in the statistician after the experiment is done may be no more
>> than asking him to perform a post-mortem examination: he may be able to say
>> what the experiment died of. ~ Sir Ronald Aylmer Fisher
>> The plural of anecdote is not data. ~ Roger Brinner
>> The combination of some data and an aching desire for an answer does not
>> ensure that a reasonable answer can be extracted from a given body of data.
>> ~ John Tukey
>>
>> 2015-10-09 11:55 GMT+02:00 Bo Werth <bo.werth at gmail.com>:
>>
>>> Dear all,
>>>
>>> this is my first message to this mailing list - please advise if it is
>>> not
>>> the right place for the subject
>>>
>>> I've been using R very intensively the last 3-4 years and one of the most
>>> tedious tasks is modification of lookup or conversion tables
>>>
>>> So far, I have not found functions that create the commands for creating
>>> objects (vectors, data frames) based on the objects themselves - i.e. to
>>> reverse-engineer them.
>>>
>>> Here are my suggestions:
>>>
>>> c_rev <- function(x) cat(paste0('c("', gsub(', ', '", "', toString(x)),
>>> '")\n'))
>>>
>>> df_rev <- function(x) {
>>>     X <- apply(x, 1,
>>>                function(x) {
>>>                    paste0('c(',
>>>                           paste0(shQuote(x), collapse = ", "),
>>>                           ')'
>>>                           )
>>>                }
>>>                )
>>>     command <- paste0(
>>>         'rbind.data.frame(',
>>>         paste0(
>>>             X,
>>>             collapse = ",\n"),
>>>         ')')
>>>     return(cat(command, "\n"))
>>> }
>>>
>>> Bo
>>>
>>> ---
>>> bowerth.github.io
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>>
>

	[[alternative HTML version deleted]]


From marius.hofert at uwaterloo.ca  Fri Oct  9 13:53:41 2015
From: marius.hofert at uwaterloo.ca (Marius Hofert)
Date: Fri, 9 Oct 2015 13:53:41 +0200
Subject: [Rd] Improvement of R_orderVector() via orderVector1()
Message-ID: <CAM3-KjZo6fDqMm2GRYfZT_eU=Aiuo0tPuZEH6aJ=g_Btux552Q@mail.gmail.com>

Hi,

I think R_orderVector() can be improved by calling orderVector1() if
possible. In a problem we had, this gave us a run time improvement
factor of 4.... so my hope is that this can be included. Below is the
suggested change, I'm just not 100% sure if the test "CDR(arglist) ==
R_NilValue" is good...

Cheers,
Marius

void R_orderVector(int *indx, // must be pre-allocated to length >= n
                   int n,
                   SEXP arglist, // <- e.g.  Rf_lang2(x,y)
                   Rboolean nalast, Rboolean decreasing)
{
    // idx[] <- 0:(n-1) :
    for(int i = 0; i < n; i++) indx[i] = i;
    if(CDR(arglist) == R_NilValue) {
        orderVector1(indx, n, CAR(arglist), nalast, decreasing, R_NilValue);
    } else {
        orderVector(indx, n, arglist, nalast, decreasing, listgreater);
    }
    return;
}


From vinhdizzo at gmail.com  Fri Oct  9 15:35:01 2015
From: vinhdizzo at gmail.com (Vinh Nguyen)
Date: Fri, 9 Oct 2015 06:35:01 -0700
Subject: [Rd] R 3.2.2 64 bit compilation error on AIX
In-Reply-To: <22039.24695.462269.116657@stat.math.ethz.ch>
References: <CA+2Dmwg42NrchprLEOoSuVSyqtU8H6H2XLLUZYftGHG6-bfXyw@mail.gmail.com>
	<CA+2DmwiWo0RwSfS7eMQgXr_MxMN3UE76wCqspWysP-UghY0nSg@mail.gmail.com>
	<CA+2DmwgQEkZuCZCvyhudhY55rFznN6ddgeo=qVfx5bJO1AnGSg@mail.gmail.com>
	<CA+2DmwhY7Qo19JY-TMpR-oObDvkEEqzemVsoqhf9YV2B9W-mRw@mail.gmail.com>
	<22039.24695.462269.116657@stat.math.ethz.ch>
Message-ID: <CA+2DmwikBvv-cNeAuNzxv90Rj7wOjJwPP4n=Q5tf_btwtM9F5w@mail.gmail.com>

On Oct 8, 2015 11:36 PM, "Martin Maechler" <maechler at stat.math.ethz.ch>
wrote:
>
> >>>>> Vinh Nguyen <vinhdizzo at gmail.com>
> >>>>>     on Thu, 8 Oct 2015 20:21:32 -0700 writes:
>
>     > Ahh, sorry for not googling the error message.  Found
>     > [this](
http://r.789695.n4.nabble.com/Error-compiling-R-2-10-1-on-AIX-td1017862.html
)
>     > post that suggests modifying /src/extra/tre/tre-internal.h
>     > (
https://r-forge.r-project.org/scm/viewvc.php/patches/aix_R210_tre.patch?view=markup&root=aix
)
>     > for AIX 64 bit.
>
>     > Is it possible to add this information to the AIX section
>     > of the R-admin manual?  Thanks.
>
> Actually, I think we (R Core) should just apply that patch to the
>  R/src/extras/tre/ sources.

That sould be even better!

>
> But this does not seem to be related to your original problem
> where compilation stopped during tools package building,
> or does it ?

Yes, the patch did fix the error where the tools package was building. It
also fixed it for [others](
http://r.789695.n4.nabble.com/Error-compiling-R-2-10-1-on-AIX-td1017862.html
).

Thanks.

	[[alternative HTML version deleted]]


From gmbecker at ucdavis.edu  Fri Oct  9 17:06:27 2015
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Fri, 9 Oct 2015 08:06:27 -0700
Subject: [Rd] reverse object creation
In-Reply-To: <CAJuCY5w9uyFUkVzMCzpUgNi18B+8S0FPqg3wT2GCtXFBNoudkg@mail.gmail.com>
References: <CAHaz_Kk6WkTCADXdh5A+o57iMKtVAKjv8_ROX61=TwAsW9fAHA@mail.gmail.com>
	<CAJuCY5yzoWS5UR0r2pveSDvh-sHWYr2KmomYmT9_btdo0i_Y0w@mail.gmail.com>
	<CAHaz_K=O+0S=z_vuxr0hHHFKLSrZP2_y51RsEHVmY699wAmuHQ@mail.gmail.com>
	<CAJuCY5w9uyFUkVzMCzpUgNi18B+8S0FPqg3wT2GCtXFBNoudkg@mail.gmail.com>
Message-ID: <CADwqtCPV+q_44g8nnSm+nc7BXQYqYTMqarHhy_ej8D+upNVAJA@mail.gmail.com>

Bo,

More philosophically, the dput output is more idiomatically appropriate for
R.

Data.frames are emphatically column-major data structures in R, by (very
good) design.

Best,
~G
On Oct 9, 2015 3:55 AM, "Thierry Onkelinx" <thierry.onkelinx at inbo.be> wrote:

> Dear Bo,
>
> Please keep the mailing list in cc.
>
> Your function only works properly with a data.frame in which all variables
> are characters. dput() will preserve the structure of the object and works
> with all R objects.
>
> Best regards,
>
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
> Forest
> team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
> Kliniekstraat 25
> 1070 Anderlecht
> Belgium
>
> To call in the statistician after the experiment is done may be no more
> than asking him to perform a post-mortem examination: he may be able to say
> what the experiment died of. ~ Sir Ronald Aylmer Fisher
> The plural of anecdote is not data. ~ Roger Brinner
> The combination of some data and an aching desire for an answer does not
> ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
>
> 2015-10-09 12:32 GMT+02:00 Bo Werth <bo.werth at gmail.com>:
>
> > Dear Thierry,
> >
> > many thanks for the hint - indeed, I wasn't aware of dput() - it is doing
> > something close to what I was looking for -
> > the only issue with the result for data frames is that it becomes
> > difficult to see the row association:
> >
> > dput returns
> >
> > structure(list(sheet = c("output cup", "output coppy", "gross value added
> > cup",
> > "gross value added coppy", "GFCF cup", "GFCF vol", "empl jobs",
> > "empl FTE", "employees jobs", "employees FTE", "D1", "D11", "D29-D39",
> > "D29 nom", "D39 nom", "P51c nom", "B2n+B3n", "total hours worked",
> > "hours worked employees"), var = c("PROD", "PKPY", "VALU", "VKPY",
> > "GFCF", "GKPY", "EMPN", "FTEN", "EMPE", "FTEE", "LABR", "WAGE",
> > "OTXS", "D29 nom", "D39 nom", "CFCC", "NOPS", "HRNS", "HRSE")), .Names =
> > c("sheet",
> > "var"), row.names = c(NA, -19L), class = "data.frame")
> > >
> >
> > df_rev returns
> >
> > rbind.data.frame(c("output cup", "PROD"),
> > c("output coppy", "PKPY"),
> > c("gross value added cup", "VALU"),
> > c("gross value added coppy", "VKPY"),
> > c("GFCF cup", "GFCF"),
> > c("GFCF vol", "GKPY"),
> > c("empl jobs", "EMPN"),
> > c("empl FTE", "FTEN"),
> > c("employees jobs", "EMPE"),
> > c("employees FTE", "FTEE"),
> > c("D1", "LABR"),
> > c("D11", "WAGE"),
> > c("D29-D39", "OTXS"),
> > c("D29 nom", "D29 nom"),
> > c("D39 nom", "D39 nom"),
> > c("P51c nom", "CFCC"),
> > c("B2n+B3n", "NOPS"),
> > c("total hours worked", "HRNS"),
> > c("hours worked employees", "HRSE"))
> >
> > Thanks again,
> > best,
> > Bo
> >
> > On Fri, Oct 9, 2015 at 12:22 PM, Thierry Onkelinx <
> > thierry.onkelinx at inbo.be> wrote:
> >
> >> Dear Bo,
> >>
> >> I think that you are looking for dput()
> >>
> >> Best regards,
> >>
> >> ir. Thierry Onkelinx
> >> Instituut voor natuur- en bosonderzoek / Research Institute for Nature
> >> and Forest
> >> team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
> >> Kliniekstraat 25
> >> 1070 Anderlecht
> >> Belgium
> >>
> >> To call in the statistician after the experiment is done may be no more
> >> than asking him to perform a post-mortem examination: he may be able to
> say
> >> what the experiment died of. ~ Sir Ronald Aylmer Fisher
> >> The plural of anecdote is not data. ~ Roger Brinner
> >> The combination of some data and an aching desire for an answer does not
> >> ensure that a reasonable answer can be extracted from a given body of
> data.
> >> ~ John Tukey
> >>
> >> 2015-10-09 11:55 GMT+02:00 Bo Werth <bo.werth at gmail.com>:
> >>
> >>> Dear all,
> >>>
> >>> this is my first message to this mailing list - please advise if it is
> >>> not
> >>> the right place for the subject
> >>>
> >>> I've been using R very intensively the last 3-4 years and one of the
> most
> >>> tedious tasks is modification of lookup or conversion tables
> >>>
> >>> So far, I have not found functions that create the commands for
> creating
> >>> objects (vectors, data frames) based on the objects themselves - i.e.
> to
> >>> reverse-engineer them.
> >>>
> >>> Here are my suggestions:
> >>>
> >>> c_rev <- function(x) cat(paste0('c("', gsub(', ', '", "', toString(x)),
> >>> '")\n'))
> >>>
> >>> df_rev <- function(x) {
> >>>     X <- apply(x, 1,
> >>>                function(x) {
> >>>                    paste0('c(',
> >>>                           paste0(shQuote(x), collapse = ", "),
> >>>                           ')'
> >>>                           )
> >>>                }
> >>>                )
> >>>     command <- paste0(
> >>>         'rbind.data.frame(',
> >>>         paste0(
> >>>             X,
> >>>             collapse = ",\n"),
> >>>         ')')
> >>>     return(cat(command, "\n"))
> >>> }
> >>>
> >>> Bo
> >>>
> >>> ---
> >>> bowerth.github.io
> >>>
> >>>         [[alternative HTML version deleted]]
> >>>
> >>> ______________________________________________
> >>> R-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>>
> >>
> >>
> >
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From henrik.bengtsson at ucsf.edu  Sat Oct 10 01:18:22 2015
From: henrik.bengtsson at ucsf.edu (Henrik Bengtsson)
Date: Fri, 9 Oct 2015 16:18:22 -0700
Subject: [Rd] A where() functions that does what exists() does but return
 the environment when object lives?
Message-ID: <CAFDcVCRR1YwaC=yQXgvgKpoW1HKLPauKYGrU8g9S3q9rAbctLQ@mail.gmail.com>

Hi,

exists("foo", inherits=TRUE) check whether an object named "foo"
exists, and get("foo", inherits=TRUE) retrieves it.  I'm looking for a
similar function to exists() that returns the environment where the
object "foo" exists, iff at all.  If not found, NULL is returned.
Does that exist?

EXAMPLE #1:

> sample2 <- base::sample
> env <- where("sample2", inherits=TRUE)
> env
<environment: R_GlobalEnv>

Note the difference to:

> obj <- get("sample2", inherits=TRUE)
> environment(obj)
<environment: namespace:base>


EXAMPLE #2:

> a <- 1
> foo <- function() { b <- 2; list(a=where("a", inherits=TRUE), b=where("b", inherits=TRUE)) }
> foo()
$a
<environment: R_GlobalEnv>
$b
<environment: 0x000000000b7d2798>

> foo()
$a
<environment: R_GlobalEnv>
$b
<environment: 0x000000000b7d23e0>


I do understand that I can implement such a function myself, but I
prefer not to.

Thanks,

Henrik


From ripley at stats.ox.ac.uk  Sat Oct 10 08:02:22 2015
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 10 Oct 2015 07:02:22 +0100
Subject: [Rd] MiKTeX's withdrawal of texi2dvi.exe
Message-ID: <5618A9EE.7000208@stats.ox.ac.uk>

MiKTeX has abruptly removed texi2dvi.exe from its distribution.  (MiKTeX 
broke its updating process earlier and an attempted update trashed the 
updater on my installation so I was forced to make a fresh install of 
the current distribution.  I do not know if updates remove a currently 
installed texi2dvi.exe.)

This has two consequences:

1) It is used by tools::texi2dvi() if found.  As far as I can tell 
texify.exe is a sufficient replacement there, so you can set 
options(texi2dvi = "texify") (and R-patched/R-devel have been changed to 
try that).  Otherwise emulation will be used and does work, less robustly.

2) It was used to make manuals when building R from sources.  This has 
been worked around in R-patched/R-devel.  If you need to build an 
earlier version of R, edit doc/manuals/Makefile.win from

ifeq "$(MIKTEX)" "TRUE"
R_TEXOPTS = --include-directory=../../share/texmf/tex/latex
TEXI2DVI = texi2dvi
else
R_TEXOPTS =
TEXI2DVI =
endif

setting the first TEXI2DVI line to

TEXI2DVI = TEXINDEX=/Rtools/bin/texindex.exe texify

altering the full path to texindex.exe as required (being on the PATH is 
not sufficient).  (For current versions, set this in MkRules.local.)


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford
1 South Parks Road, Oxford OX1 3TG, UK


From ligges at statistik.tu-dortmund.de  Sat Oct 10 10:24:24 2015
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Sat, 10 Oct 2015 10:24:24 +0200
Subject: [Rd] A where() functions that does what exists() does but
 return the environment when object lives?
In-Reply-To: <CAFDcVCRR1YwaC=yQXgvgKpoW1HKLPauKYGrU8g9S3q9rAbctLQ@mail.gmail.com>
References: <CAFDcVCRR1YwaC=yQXgvgKpoW1HKLPauKYGrU8g9S3q9rAbctLQ@mail.gmail.com>
Message-ID: <5618CB38.7010606@statistik.tu-dortmund.de>

I'd start looking at getAnywhere().

Best,
Uwe

On 10.10.2015 01:18, Henrik Bengtsson wrote:
> Hi,
>
> exists("foo", inherits=TRUE) check whether an object named "foo"
> exists, and get("foo", inherits=TRUE) retrieves it.  I'm looking for a
> similar function to exists() that returns the environment where the
> object "foo" exists, iff at all.  If not found, NULL is returned.
> Does that exist?
>
> EXAMPLE #1:
>
>> sample2 <- base::sample
>> env <- where("sample2", inherits=TRUE)
>> env
> <environment: R_GlobalEnv>
>
> Note the difference to:
>
>> obj <- get("sample2", inherits=TRUE)
>> environment(obj)
> <environment: namespace:base>
>
>
> EXAMPLE #2:
>
>> a <- 1
>> foo <- function() { b <- 2; list(a=where("a", inherits=TRUE), b=where("b", inherits=TRUE)) }
>> foo()
> $a
> <environment: R_GlobalEnv>
> $b
> <environment: 0x000000000b7d2798>
>
>> foo()
> $a
> <environment: R_GlobalEnv>
> $b
> <environment: 0x000000000b7d23e0>
>
>
> I do understand that I can implement such a function myself, but I
> prefer not to.
>
> Thanks,
>
> Henrik
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From kirill.mueller at ivt.baug.ethz.ch  Sat Oct 10 12:30:32 2015
From: kirill.mueller at ivt.baug.ethz.ch (=?UTF-8?Q?Kirill_M=c3=bcller?=)
Date: Sat, 10 Oct 2015 12:30:32 +0200
Subject: [Rd] R CMD check --as-cran without qpdf
Message-ID: <5618E8C8.1050802@ivt.baug.ethz.ch>

Today, a package that has an HTML vignette (but no PDF vignette) failed 
R CMD check --as-cran on a system without qpdf. I think the warning 
originates here [1], due to a premature check for the existence of qpdf 
[2]. Setting R_QPDF=true (as in /bin/true) helped, but perhaps it's 
possible to check qpdf existence only when it matters.

I have attached a patch (untested) that could serve as a starting point. 
The code links correspond to SVN revision 69500. Thanks.


Best regards

Kirill


[1] 
https://github.com/wch/r-source/blob/f42ee5e7ecf89a245afd6619b46483f1e3594ab7/src/library/tools/R/check.R#L322-L326, 

[2] 
https://github.com/wch/r-source/blob/f42ee5e7ecf89a245afd6619b46483f1e3594ab7/src/library/tools/R/check.R#L4426-L4428
-------------- next part --------------
A non-text attachment was scrubbed...
Name: qpdf-missing.patch
Type: text/x-patch
Size: 2145 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20151010/2682c0ca/attachment.bin>

From jeroen.ooms at stat.ucla.edu  Sat Oct 10 13:52:04 2015
From: jeroen.ooms at stat.ucla.edu (Jeroen Ooms)
Date: Sat, 10 Oct 2015 13:52:04 +0200
Subject: [Rd] MiKTeX's withdrawal of texi2dvi.exe
In-Reply-To: <5618A9EE.7000208@stats.ox.ac.uk>
References: <5618A9EE.7000208@stats.ox.ac.uk>
Message-ID: <CABFfbXsGUQVFmQZZcKjkVeCL=YTfv3Hs9aXZZWOnjiJ0iZnEPg@mail.gmail.com>

On Sat, Oct 10, 2015 at 8:02 AM, Prof Brian Ripley
<ripley at stats.ox.ac.uk> wrote:
>
> It was used to make manuals when building R from sources.  This has been worked around in R-patched/R-devel.  If you need to build an earlier version of R, edit doc/manuals/Makefile.win ...

Thank you for the fix.

FWIW, texi2dvi.exe was actually removed quite a while ago (1 year?). A
copy of an older miktex build of the current miktex branch that still
includes texi2dvi is available
here:http://www.stat.ucla.edu/~jeroen/mingw-w64 . Perhaps it is worth
archiving this somewhere to be able to re-build older versions of R on
Windows in the future.


From arnaud.gaboury at gmail.com  Sun Oct 11 18:55:57 2015
From: arnaud.gaboury at gmail.com (arnaud gaboury)
Date: Sun, 11 Oct 2015 18:55:57 +0200
Subject: [Rd] Build R with MKL and ICC
In-Reply-To: <CAK1hC9uEvrvsAob9hPUaFM1RVY8dYWun3udfqZT21fw2Gy1SpQ@mail.gmail.com>
References: <CAK1hC9uLYSyA-7W92TwD4J9adcxDRE1a2ig1iDDPSyN43kikyg@mail.gmail.com>
	<CAK1hC9u0btbbXGR3+OAcAd5n3SbFwUHoH+YsT5FzVpaeyZWdEQ@mail.gmail.com>
	<1441382281.4083.26.camel@iarc.fr>
	<CAK1hC9vg0SePBhEbp-Xpt8W1BDH-kY3XTLr39ZHCp2k2MHxUhA@mail.gmail.com>
	<1441621388.4083.54.camel@iarc.fr>
	<CAFAN8vw53p+dCnr_LroKZbQMw66kwMiXypNBJAZVHhW998Di2g@mail.gmail.com>
	<CAK1hC9sZKdaWTGxCDQhhPa-nJARfd-WG=ivi8gWpLiL-4BA8VQ@mail.gmail.com>
	<CAFAN8vz0H9TZ4Q3+dkoaMWvrJvK9O9g3=ioXWDS6zCM+YFqfbA@mail.gmail.com>
	<CAK1hC9uEvrvsAob9hPUaFM1RVY8dYWun3udfqZT21fw2Gy1SpQ@mail.gmail.com>
Message-ID: <CAK1hC9txrScpYCsg1E-2eyT=UG3Rg_LH2rcmaTqA--r4v1oK6A@mail.gmail.com>

On Wed, Sep 30, 2015 at 12:18 PM, arnaud gaboury
<arnaud.gaboury at gmail.com> wrote:
> On Tue, Sep 29, 2015 at 8:11 PM, Nathan Kurz <nate at verse.com> wrote:
>> Hi Arnaud --
>>
>> I'm glad it's working for you.  I'm not sure I understand your final
>> answer.  Are you saying that the version I posted worked for you as
>> given, or that you had to remove some of the other options?
>
> I say it works perfectly when using the single dynamic library
> (lmkl_rt):  MKL=" -L${_mkllibpath} -lmkl_rt -lpthread -lm"
> N.B: not sure the -lm is needed, and It builds without it. It seems it
> may trigger some issues on. See[0]. Thus I removed it
>
>> Perhaps you could post the full final recipe in a way that others can
>> copy and paste if they find this thread in the future?
>
> Here it is. The script is writen for Parallel studio 2016. Change path
> accordingly if composerxe 2015.
> libRlib and libRblas are build as shared librairies. It build with
> static libraries too.
> More options can be added to configure.
> Best is to source mklvars and compilervars in a script so it won't
> polluated your shell environment once the build is done.
>
> ---------------------------------------------------------------
> #! /bin/sh
>
> source /opt/intel/compilers_and_libraries_2016.0.109/linux/mkl/bin/mklvars.sh
> intel64
> source /opt/intel/bin/compilervars.sh intel64
>
> _icclibpath=/opt/intel/compilers_and_lbraries_2016.0.109/linux/compiler/lib/intel64/
> _mkllibpath=${MKLROOT}/lib/intel64/
> _omp_lib=/opt/intel/lib/intel64/
>
> MKL=" -L${_mkllibpath} -lmkl_rt -lpthread"
>
> export CC="icc"
> export CXX="icpc"
> export AR="xiar"
> export LD="xild"
> export F77="ifort"
>
> export CFLAGS="-g -O3 -xHost -I${MKLROOT}/include"
> export CXXFLAGS="-g -O3 -xHost -I${MKLROOT}/include"
> export FFLAGS="-I${MKLROOT}/include"
> export FCFLAGS="-I${MKLROOT}/include"
>
> # shared libs
> ./configure --with-blas="${MKL}" --enable-R-shlib --enable-BLAS-shlib
> # static libs
> ./configure --with-blas="${MKL}" --with-lapack
>
> make -j4
> ----------------------------------------------------------------------------------------------
>
> from inside the build folder:
> -------------------------
> $ldd bin/exec/R
> linux-vdso.so.1 (0x00007ffc1e853000)
> libR.so => /usr/lib64/R/lib/libR.so (0x00007f747091f000)
> libRblas.so => not found         !! is not yet installed in the machine !!
> libm.so.6 => /lib64/libm.so.6 (0x00007f7470616000)
> libiomp5.so => /opt/intel/lib/intel64_lin/libiomp5.so (0x00007f74702d5000)
> libgcc_s.so.1 => /lib64/libgcc_s.so.1 (0x00007f74700be000)
> libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f746fea1000)
> libc.so.6 => /lib64/libc.so.6 (0x00007f746fae1000)
> libdl.so.2 => /lib64/libdl.so.2 (0x00007f746f8dd000)
> libblas.so.3 => not found         !! we don't need it !!
> libgfortran.so.3 => /lib64/libgfortran.so.3 (0x00007f746f5b1000)
> libquadmath.so.0 => /lib64/libquadmath.so.0 (0x00007f746f372000)
> libreadline.so.6 => /lib64/libreadline.so.6 (0x00007f746f127000)
> libtre.so.5 => /lib64/libtre.so.5 (0x00007f746ef17000)
> libpcre.so.1 => /lib64/libpcre.so.1 (0x00007f746eca7000)
> liblzma.so.5 => /lib64/liblzma.so.5 (0x00007f746ea80000)
> libbz2.so.1 => /lib64/libbz2.so.1 (0x00007f746e870000)
> libz.so.1 => /lib64/libz.so.1 (0x00007f746e65a000)
> librt.so.1 => /lib64/librt.so.1 (0x00007f746e451000)
> libicuuc.so.54 => /lib64/libicuuc.so.54 (0x00007f746e0c0000)
> libicui18n.so.54 => /lib64/libicui18n.so.54 (0x00007f746dc69000)
> libgomp.so.1 => /lib64/libgomp.so.1 (0x00007f746da46000)
> /lib64/ld-linux-x86-64.so.2 (0x000055fcb8058000)
> libtinfo.so.5 => /lib64/libtinfo.so.5 (0x00007f746d81c000)
> libicudata.so.54 => /lib64/libicudata.so.54 (0x00007f746bdf0000)
> libstdc++.so.6 => /lib64/libstdc++.so.6 (0x00007f746ba6e000)
>
> $ ldd lib/libRblas.so
> linux-vdso.so.1 (0x00007ffc5f3da000)
> libmkl_rt.so => /opt/intel/mkl/lib/intel64_lin/libmkl_rt.so (0x00007f232203e000)
> libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f2321e21000)
> libm.so.6 => /lib64/libm.so.6 (0x00007f2321b19000)
> libimf.so => /opt/intel/lib/intel64_lin/libimf.so (0x00007f2321621000)
> libsvml.so => /opt/intel/lib/intel64_lin/libsvml.so (0x00007f2320762000)
> libirng.so => /opt/intel/lib/intel64_lin/libirng.so (0x00007f2320559000)
> libiomp5.so => /opt/intel/lib/intel64_lin/libiomp5.so (0x00007f2320218000)
> libgcc_s.so.1 => /lib64/libgcc_s.so.1 (0x00007f2320001000)
> libintlc.so.5 => /opt/intel/lib/intel64_lin/libintlc.so.5 (0x00007f231fda1000)
> libc.so.6 => /lib64/libc.so.6 (0x00007f231f9e1000)
> libdl.so.2 => /lib64/libdl.so.2 (0x00007f231f7dd000)
> /lib64/ld-linux-x86-64.so.2 (0x000055ce12e09000)
> --------------------------------------------------------------------------
>
>
>>
>> Also, did you determine if the the same approach worked for linking to
>> MKL worked when using a non-Intel compiler?   That is, can you
>> substitute the gcc or clang tool names and get the same result?
>
> No. I was not enable to do it with gcc. More tries are needed with
> some variations.
>>
>> --nate
>>
>> On Tue, Sep 29, 2015 at 9:07 AM, arnaud gaboury
>> <arnaud.gaboury at gmail.com> wrote:
>>> On Wed, Sep 9, 2015 at 11:26 PM, Nathan Kurz <nate at verse.com> wrote:
>>>>
>>>> As a short and simple approach, I just compiled the current R release
>>>> on Ubuntu with ICC and MKL using just this:
>>>>
>>>> $ tar -xzf R-3.2.2.tar.gz
>>>> $ cd R-3.2.2
>>>> $ CC=icc CXX=icpc AR=xiar LD=xild CFLAGS="-g -O3 -xHost" CXXFLAGS="-g
>>>> -O3 -xHost" ./configure --with-blas="-lmkl_rt -lpthread" --with-lapack
>>>> --enable-memory-profiling --enable-R-shlib
>>>> $ make
>>>> $ sudo make install
>>>> $ R --version
>>>> R version 3.2.2 (2015-08-14) -- "Fire Safety"
>>>
>>>
>>> That is exactly the right combo: with-blas="-lmkl_rt -lpthread"
>>> Nothing more for $MKL
>>>
>>> now
>>> $ ldd bin/exec/R
>>> linux-vdso.so.1 (0x00007ffe305f9000)
>>> libmkl_rt.so => /opt/intel/mkl/lib/intel64_lin/libmkl_rt.so (0x00007f216c9e3000)
>>>         .................................
>
>
> [0]https://software.intel.com/en-us/search/site/language/en?query=-lm
> --
>
At least, after so many failed build attempts, R with Intel ICC and
MKL builds, installs and runs fine on Fedora 22.
If anyone is interested in building the rpm packages, please visit my
github[0] for the spec file.

Comments are welcome

[0]https://github.com/gabx/r-project/tree/master/R-mkl


-- 

google.com/+arnaudgabourygabx


From bbolker at gmail.com  Mon Oct 12 02:05:01 2015
From: bbolker at gmail.com (Ben Bolker)
Date: Sun, 11 Oct 2015 20:05:01 -0400
Subject: [Rd] identical(..., ignore.environment=TRUE)
Message-ID: <561AF92D.90801@gmail.com>


  It seems odd/inconvenient to me that the "ignore.environment" argument
of identical() only applies to closures (which I read as 'functions' --
someone can enlighten me about the technical differences between
functions and closures if they like -- see below for consequences of my
confusion).  This is certainly not a bug, it's clearly documented, but
it seems like a design flaw.  It would certainly be convenient to be
able to ignore differences in environments when comparing complex
objects with lots of deeply nested formula and terms objects with
environments ...

   Can anyone suggest a reason for this design?

Example:

> f1 <- formula()
> f2 <- formula()
> environment(f2) <- new.env()
> identical(f1,f2)
[1] FALSE
> identical(f1,f2,ignore.environment=TRUE)
[1] FALSE

Actually, maybe I don't understand how this is supposed to work since I
thought this would be TRUE:

> f1 <- function() {}
> f2 <- function() {}
> environment(f1) <- new.env()
> environment(f2) <- new.env()
> identical(f1,f2,ignore.environment=TRUE)   ## FALSE

  Maybe the problem *is* that I don't know the difference between a
function and a closure ... ?

  Ben Bolker


From murdoch.duncan at gmail.com  Mon Oct 12 04:36:03 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 11 Oct 2015 22:36:03 -0400
Subject: [Rd] identical(..., ignore.environment=TRUE)
In-Reply-To: <561AF92D.90801@gmail.com>
References: <561AF92D.90801@gmail.com>
Message-ID: <561B1C93.3060803@gmail.com>

On 11/10/2015 8:05 PM, Ben Bolker wrote:
> 
>   It seems odd/inconvenient to me that the "ignore.environment" argument
> of identical() only applies to closures (which I read as 'functions' --
> someone can enlighten me about the technical differences between
> functions and closures if they like -- see below for consequences of my
> confusion).  This is certainly not a bug, it's clearly documented, but
> it seems like a design flaw.  It would certainly be convenient to be
> able to ignore differences in environments when comparing complex
> objects with lots of deeply nested formula and terms objects with
> environments ...
> 
>    Can anyone suggest a reason for this design?
> 
> Example:
> 
>> f1 <- formula()
>> f2 <- formula()
>> environment(f2) <- new.env()
>> identical(f1,f2)
> [1] FALSE
>> identical(f1,f2,ignore.environment=TRUE)
> [1] FALSE
> 
> Actually, maybe I don't understand how this is supposed to work since I
> thought this would be TRUE:
> 
>> f1 <- function() {}
>> f2 <- function() {}
>> environment(f1) <- new.env()
>> environment(f2) <- new.env()
>> identical(f1,f2,ignore.environment=TRUE)   ## FALSE

Those two functions likely have different srcref attributes.  If you
created f2 using f2 <- f1, you'd get your expected result.

> 
>   Maybe the problem *is* that I don't know the difference between a
> function and a closure ... ?

In R, there is no difference.  All functions are closures.

Some people only use "closure" for functions returned as the value of
other functions.  That may be correct usage in other languages, but not
in R.

Duncan Murdoch


From murdoch.duncan at gmail.com  Mon Oct 12 04:42:25 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 11 Oct 2015 22:42:25 -0400
Subject: [Rd] identical(..., ignore.environment=TRUE)
In-Reply-To: <561B1C93.3060803@gmail.com>
References: <561AF92D.90801@gmail.com> <561B1C93.3060803@gmail.com>
Message-ID: <561B1E11.7050103@gmail.com>

On 11/10/2015 10:36 PM, Duncan Murdoch wrote:
> On 11/10/2015 8:05 PM, Ben Bolker wrote:
>>
>>   It seems odd/inconvenient to me that the "ignore.environment" argument
>> of identical() only applies to closures (which I read as 'functions' --
>> someone can enlighten me about the technical differences between
>> functions and closures if they like -- see below for consequences of my
>> confusion).  This is certainly not a bug, it's clearly documented, but
>> it seems like a design flaw.  It would certainly be convenient to be
>> able to ignore differences in environments when comparing complex
>> objects with lots of deeply nested formula and terms objects with
>> environments ...
>>
>>    Can anyone suggest a reason for this design?
>>
>> Example:
>>
>>> f1 <- formula()
>>> f2 <- formula()
>>> environment(f2) <- new.env()
>>> identical(f1,f2)
>> [1] FALSE
>>> identical(f1,f2,ignore.environment=TRUE)
>> [1] FALSE
>>
>> Actually, maybe I don't understand how this is supposed to work since I
>> thought this would be TRUE:
>>
>>> f1 <- function() {}
>>> f2 <- function() {}
>>> environment(f1) <- new.env()
>>> environment(f2) <- new.env()
>>> identical(f1,f2,ignore.environment=TRUE)   ## FALSE
> 
> Those two functions likely have different srcref attributes.  If you
> created f2 using f2 <- f1, you'd get your expected result.
> 
>>
>>   Maybe the problem *is* that I don't know the difference between a
>> function and a closure ... ?
> 
> In R, there is no difference.  All functions are closures.
> 
> Some people only use "closure" for functions returned as the value of
> other functions.  That may be correct usage in other languages, but not
> in R.

Sorry, I meant all user functions are closures.  There are other kinds
of function in R called "primitives" (e.g. c(), many low level math
functions, the functions that implement flow control, etc.).

Duncan Murdoch


From bbolker at gmail.com  Mon Oct 12 15:51:01 2015
From: bbolker at gmail.com (Ben Bolker)
Date: Mon, 12 Oct 2015 13:51:01 +0000
Subject: [Rd] identical(..., ignore.environment=TRUE)
References: <561AF92D.90801@gmail.com> <561B1C93.3060803@gmail.com>
	<561B1E11.7050103@gmail.com>
Message-ID: <loom.20151012T154046-990@post.gmane.org>

Duncan Murdoch <murdoch.duncan <at> gmail.com> writes:

BB>
> >> It seems odd/inconvenient to me that the "ignore.environment" argument
> >> of identical() only applies to closures (which I read as 'functions' --
> >> someone can enlighten me about the technical differences between
> >> functions and closures if they like -- see below for consequences of my
> >> confusion).  This is certainly not a bug, it's clearly documented, but
> >> it seems like a design flaw.  It would certainly be convenient to be
> >> able to ignore differences in environments when comparing complex
> >> objects with lots of deeply nested formula and terms objects with
> >> environments ...
> >>
> >>    Can anyone suggest a reason for this design?
> >>

  [snip]

> >> Actually, maybe I don't understand how this is supposed to work since I
> >> thought this would be TRUE:
> >>
> >>> f1 <- function() {}
> >>> f2 <- function() {}
> >>> environment(f1) <- new.env()
> >>> environment(f2) <- new.env()
> >>> identical(f1,f2,ignore.environment=TRUE)   ## FALSE
> > 
> > Those two functions likely have different srcref attributes.  If you
> > created f2 using f2 <- f1, you'd get your expected result.
> > 

[snip]

 Thanks for the clarification about closures vs. functions.

[snip]

You're right that the srcref attributes are different; although their
bodies are the same, they have their own environments that differ.
For me, this makes the intended use of ignore.environment= even more
puzzling; given that environments are not ignored recursively (that's
not exactly what I mean -- I mean ignoring all environments of components
of an object), I have trouble understanding the use case for
ignore.environnment ...  maybe it was developed before srcrefs 
existed?  

In the R code base it's used in checkConflicts (to see if a function
is re-exported) and in getAnywhere ...


From murdoch.duncan at gmail.com  Tue Oct 13 01:31:11 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 12 Oct 2015 19:31:11 -0400
Subject: [Rd] identical(..., ignore.environment=TRUE)
In-Reply-To: <loom.20151012T154046-990@post.gmane.org>
References: <561AF92D.90801@gmail.com> <561B1C93.3060803@gmail.com>
	<561B1E11.7050103@gmail.com> <loom.20151012T154046-990@post.gmane.org>
Message-ID: <561C42BF.6010005@gmail.com>

On 12/10/2015 9:51 AM, Ben Bolker wrote:
> Duncan Murdoch <murdoch.duncan <at> gmail.com> writes:
> 
> BB>
>>>> It seems odd/inconvenient to me that the "ignore.environment" argument
>>>> of identical() only applies to closures (which I read as 'functions' --
>>>> someone can enlighten me about the technical differences between
>>>> functions and closures if they like -- see below for consequences of my
>>>> confusion).  This is certainly not a bug, it's clearly documented, but
>>>> it seems like a design flaw.  It would certainly be convenient to be
>>>> able to ignore differences in environments when comparing complex
>>>> objects with lots of deeply nested formula and terms objects with
>>>> environments ...
>>>>
>>>>    Can anyone suggest a reason for this design?
>>>>
> 
>   [snip]
> 
>>>> Actually, maybe I don't understand how this is supposed to work since I
>>>> thought this would be TRUE:
>>>>
>>>>> f1 <- function() {}
>>>>> f2 <- function() {}
>>>>> environment(f1) <- new.env()
>>>>> environment(f2) <- new.env()
>>>>> identical(f1,f2,ignore.environment=TRUE)   ## FALSE
>>>
>>> Those two functions likely have different srcref attributes.  If you
>>> created f2 using f2 <- f1, you'd get your expected result.
>>>
> 
> [snip]
> 
>  Thanks for the clarification about closures vs. functions.
> 
> [snip]
> 
> You're right that the srcref attributes are different; although their
> bodies are the same, they have their own environments that differ.
> For me, this makes the intended use of ignore.environment= even more
> puzzling; given that environments are not ignored recursively (that's
> not exactly what I mean -- I mean ignoring all environments of components
> of an object), I have trouble understanding the use case for
> ignore.environnment ...  maybe it was developed before srcrefs 
> existed?  

I think it simply means "ignore.environment.of.closures", as the
description says, but that's too long to be a convenient arg name.

Closures have three parts:  the formals, the body and the environment.
(Actually, 4 parts:  like almost all R objects, they may also have
attributes.)

That arg just says to ignore the environment part when comparing
closures.  It doesn't say to ignore environments in general.

> 
> In the R code base it's used in checkConflicts (to see if a function
> is re-exported) and in getAnywhere ...
> 

I'd say those uses are slightly bogus.  You should generally remember
that closures have 3 (or 4) parts, and not go around comparing only two
(or 3) of them.

Duncan Murdoch


From maechler at stat.math.ethz.ch  Tue Oct 13 17:39:35 2015
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 13 Oct 2015 17:39:35 +0200
Subject: [Rd] identical(..., ignore.environment=TRUE)
In-Reply-To: <561C42BF.6010005@gmail.com>
References: <561AF92D.90801@gmail.com> <561B1C93.3060803@gmail.com>
	<561B1E11.7050103@gmail.com>
	<loom.20151012T154046-990@post.gmane.org>
	<561C42BF.6010005@gmail.com>
Message-ID: <22045.9655.425358.202845@stat.math.ethz.ch>

>>>>> Duncan Murdoch <murdoch.duncan at gmail.com>
>>>>>     on Mon, 12 Oct 2015 19:31:11 -0400 writes:

    > On 12/10/2015 9:51 AM, Ben Bolker wrote:
    >> Duncan Murdoch <murdoch.duncan <at> gmail.com> writes:
    >> 
    BB> 
    >>>>> It seems odd/inconvenient to me that the
    >>>>> "ignore.environment" argument of identical() only
    >>>>> applies to closures (which I read as 'functions' --
    >>>>> someone can enlighten me about the technical
    >>>>> differences between functions and closures if they
    >>>>> like -- see below for consequences of my confusion).
    >>>>> This is certainly not a bug, it's clearly documented,
    >>>>> but it seems like a design flaw.  It would certainly
    >>>>> be convenient to be able to ignore differences in
    >>>>> environments when comparing complex objects with lots
    >>>>> of deeply nested formula and terms objects with
    >>>>> environments ...
    >>>>> 
    >>>>> Can anyone suggest a reason for this design?
    >>>>> 
    >> 
    >> [snip]
    >> 
    >>>>> Actually, maybe I don't understand how this is
    >>>>> supposed to work since I thought this would be TRUE:
    >>>>> 
>>>>> f1 <- function() {}
>>>>> f2 <- function() {}
>>>>> environment(f1) <- new.env()
>>>>> environment(f2) <- new.env()
>>>>> identical(f1,f2,ignore.environment=TRUE) ## FALSE
    >>>> 
    >>>> Those two functions likely have different srcref
    >>>> attributes.  If you created f2 using f2 <- f1, you'd
    >>>> get your expected result.
    >>>> 
    >> 
    >> [snip]
    >> 
    >> Thanks for the clarification about closures
    >> vs. functions.
    >> 
    >> [snip]
    >> 
    >> You're right that the srcref attributes are different;
    >> although their bodies are the same, they have their own
    >> environments that differ.  For me, this makes the
    >> intended use of ignore.environment= even more puzzling;
    >> given that environments are not ignored recursively
    >> (that's not exactly what I mean -- I mean ignoring all
    >> environments of components of an object), I have trouble
    >> understanding the use case for ignore.environnment ...
    >> maybe it was developed before srcrefs existed?

    > I think it simply means "ignore.environment.of.closures",
    > as the description says, but that's too long to be a
    > convenient arg name.

    > Closures have three parts: the formals, the body and the
    > environment.  (Actually, 4 parts: like almost all R
    > objects, they may also have attributes.)

    > That arg just says to ignore the environment part when
    > comparing closures.  It doesn't say to ignore environments
    > in general.

For another beat on a dead horse, @ Ben:

You could either use  options(keep.source = FALSE) in your
enviroment such that your functions should not have any 'srcref'
attributes anymore,

or probably more sensible, use

all.equal(f1, f2) rather than identical(f1, f2, ..)

which I think should really do what you want
[even though it ends up using string comparison after deparse(.)
 .. about which one can debate... but I don't think we'd want to
 change  all.equal.language()  at this point in time].

Martin


    >> 
    >> In the R code base it's used in checkConflicts (to see if
    >> a function is re-exported) and in getAnywhere ...
    >> 

    > I'd say those uses are slightly bogus.  You should
    > generally remember that closures have 3 (or 4) parts, and
    > not go around comparing only two (or 3) of them.

    > Duncan Murdoch

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From wdunlap at tibco.com  Tue Oct 13 18:12:34 2015
From: wdunlap at tibco.com (William Dunlap)
Date: Tue, 13 Oct 2015 09:12:34 -0700
Subject: [Rd] identical(..., ignore.environment=TRUE)
In-Reply-To: <22045.9655.425358.202845@stat.math.ethz.ch>
References: <561AF92D.90801@gmail.com> <561B1C93.3060803@gmail.com>
	<561B1E11.7050103@gmail.com> <loom.20151012T154046-990@post.gmane.org>
	<561C42BF.6010005@gmail.com>
	<22045.9655.425358.202845@stat.math.ethz.ch>
Message-ID: <CAF8bMcZwFNOe6yOxyM3YSzBnWuyj1ubWdhEhEDuDGUKaQvWpLQ@mail.gmail.com>

MM> but I don't think we'd want to
MM> change  all.equal.language()  at this point in time

Although it would be nice if all.equal looked at least at attributes of
formulas
so we did not get results like
  > form <- y ~ x1 %in% x2
  > all.equal(form, terms(form))
  [1] TRUE
  > all.equal(terms(y~x1+x2+Error(x3/x2), specials="Error"),
terms(y~x1+x2+Error(x3/x2)))
  [1] TRUE



Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Tue, Oct 13, 2015 at 8:39 AM, Martin Maechler <maechler at stat.math.ethz.ch
> wrote:

> >>>>> Duncan Murdoch <murdoch.duncan at gmail.com>
> >>>>>     on Mon, 12 Oct 2015 19:31:11 -0400 writes:
>
>     > On 12/10/2015 9:51 AM, Ben Bolker wrote:
>     >> Duncan Murdoch <murdoch.duncan <at> gmail.com> writes:
>     >>
>     BB>
>     >>>>> It seems odd/inconvenient to me that the
>     >>>>> "ignore.environment" argument of identical() only
>     >>>>> applies to closures (which I read as 'functions' --
>     >>>>> someone can enlighten me about the technical
>     >>>>> differences between functions and closures if they
>     >>>>> like -- see below for consequences of my confusion).
>     >>>>> This is certainly not a bug, it's clearly documented,
>     >>>>> but it seems like a design flaw.  It would certainly
>     >>>>> be convenient to be able to ignore differences in
>     >>>>> environments when comparing complex objects with lots
>     >>>>> of deeply nested formula and terms objects with
>     >>>>> environments ...
>     >>>>>
>     >>>>> Can anyone suggest a reason for this design?
>     >>>>>
>     >>
>     >> [snip]
>     >>
>     >>>>> Actually, maybe I don't understand how this is
>     >>>>> supposed to work since I thought this would be TRUE:
>     >>>>>
> >>>>> f1 <- function() {}
> >>>>> f2 <- function() {}
> >>>>> environment(f1) <- new.env()
> >>>>> environment(f2) <- new.env()
> >>>>> identical(f1,f2,ignore.environment=TRUE) ## FALSE
>     >>>>
>     >>>> Those two functions likely have different srcref
>     >>>> attributes.  If you created f2 using f2 <- f1, you'd
>     >>>> get your expected result.
>     >>>>
>     >>
>     >> [snip]
>     >>
>     >> Thanks for the clarification about closures
>     >> vs. functions.
>     >>
>     >> [snip]
>     >>
>     >> You're right that the srcref attributes are different;
>     >> although their bodies are the same, they have their own
>     >> environments that differ.  For me, this makes the
>     >> intended use of ignore.environment= even more puzzling;
>     >> given that environments are not ignored recursively
>     >> (that's not exactly what I mean -- I mean ignoring all
>     >> environments of components of an object), I have trouble
>     >> understanding the use case for ignore.environnment ...
>     >> maybe it was developed before srcrefs existed?
>
>     > I think it simply means "ignore.environment.of.closures",
>     > as the description says, but that's too long to be a
>     > convenient arg name.
>
>     > Closures have three parts: the formals, the body and the
>     > environment.  (Actually, 4 parts: like almost all R
>     > objects, they may also have attributes.)
>
>     > That arg just says to ignore the environment part when
>     > comparing closures.  It doesn't say to ignore environments
>     > in general.
>
> For another beat on a dead horse, @ Ben:
>
> You could either use  options(keep.source = FALSE) in your
> enviroment such that your functions should not have any 'srcref'
> attributes anymore,
>
> or probably more sensible, use
>
> all.equal(f1, f2) rather than identical(f1, f2, ..)
>
> which I think should really do what you want
> [even though it ends up using string comparison after deparse(.)
>  .. about which one can debate... but I don't think we'd want to
>  change  all.equal.language()  at this point in time].
>
> Martin
>
>
>     >>
>     >> In the R code base it's used in checkConflicts (to see if
>     >> a function is re-exported) and in getAnywhere ...
>     >>
>
>     > I'd say those uses are slightly bogus.  You should
>     > generally remember that closures have 3 (or 4) parts, and
>     > not go around comparing only two (or 3) of them.
>
>     > Duncan Murdoch
>
>     > ______________________________________________
>     > R-devel at r-project.org mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From maechler at stat.math.ethz.ch  Tue Oct 13 18:38:17 2015
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 13 Oct 2015 18:38:17 +0200
Subject: [Rd] identical(..., ignore.environment=TRUE)
In-Reply-To: <CAF8bMcZwFNOe6yOxyM3YSzBnWuyj1ubWdhEhEDuDGUKaQvWpLQ@mail.gmail.com>
References: <561AF92D.90801@gmail.com> <561B1C93.3060803@gmail.com>
	<561B1E11.7050103@gmail.com>
	<loom.20151012T154046-990@post.gmane.org>
	<561C42BF.6010005@gmail.com>
	<22045.9655.425358.202845@stat.math.ethz.ch>
	<CAF8bMcZwFNOe6yOxyM3YSzBnWuyj1ubWdhEhEDuDGUKaQvWpLQ@mail.gmail.com>
Message-ID: <22045.13177.425106.991247@stat.math.ethz.ch>


>>>>> William Dunlap <wdunlap at tibco.com>
>>>>>     on Tue, 13 Oct 2015 09:12:34 -0700 writes:

> MM> but I don't think we'd want to
> MM> change  all.equal.language()  at this point in time

> Although it would be nice if all.equal looked at least at attributes of
> formulas
> so we did not get results like

>   > form <- y ~ x1 %in% x2
>   > all.equal(form, terms(form))
>   [1] TRUE

>   > all.equal(terms(y~x1+x2+Error(x3/x2), specials="Error"),
>               terms(y~x1+x2+Error(x3/x2)))
>   [1] TRUE

Hmm...  of course, you have a very good point....

So,  let me say
"Patches are welcome!"
 (If
   - they include changes to the *.Rd files  [e.g., with an option
					      to remain back-bug-compatible]
   - are well tested, e.g., run   'make check-all' )


[Yes, I think I know why they probably won't come from you,
 Bill, unfortunately ..]

Martin


> Bill Dunlap
> TIBCO Software
> wdunlap tibco.com

> On Tue, Oct 13, 2015 at 8:39 AM, Martin Maechler <maechler at stat.math.ethz.ch
> > wrote:

> > >>>>> Duncan Murdoch <murdoch.duncan at gmail.com>
> > >>>>>     on Mon, 12 Oct 2015 19:31:11 -0400 writes:
> >
> >     > On 12/10/2015 9:51 AM, Ben Bolker wrote:
> >     >> Duncan Murdoch <murdoch.duncan <at> gmail.com> writes:
> >     >>
> >     BB>
> >     >>>>> It seems odd/inconvenient to me that the
> >     >>>>> "ignore.environment" argument of identical() only
> >     >>>>> applies to closures (which I read as 'functions' --
> >     >>>>> someone can enlighten me about the technical
> >     >>>>> differences between functions and closures if they
> >     >>>>> like -- see below for consequences of my confusion).
> >     >>>>> This is certainly not a bug, it's clearly documented,
> >     >>>>> but it seems like a design flaw.  It would certainly
> >     >>>>> be convenient to be able to ignore differences in
> >     >>>>> environments when comparing complex objects with lots
> >     >>>>> of deeply nested formula and terms objects with
> >     >>>>> environments ...
> >     >>>>>
> >     >>>>> Can anyone suggest a reason for this design?
> >     >>>>>
> >     >>
> >     >> [snip]
> >     >>
> >     >>>>> Actually, maybe I don't understand how this is
> >     >>>>> supposed to work since I thought this would be TRUE:
> >     >>>>>
> > >>>>> f1 <- function() {}
> > >>>>> f2 <- function() {}
> > >>>>> environment(f1) <- new.env()
> > >>>>> environment(f2) <- new.env()
> > >>>>> identical(f1,f2,ignore.environment=TRUE) ## FALSE
> >     >>>>
> >     >>>> Those two functions likely have different srcref
> >     >>>> attributes.  If you created f2 using f2 <- f1, you'd
> >     >>>> get your expected result.
> >     >>>>
> >     >>
> >     >> [snip]
> >     >>
> >     >> Thanks for the clarification about closures
> >     >> vs. functions.
> >     >>
> >     >> [snip]
> >     >>
> >     >> You're right that the srcref attributes are different;
> >     >> although their bodies are the same, they have their own
> >     >> environments that differ.  For me, this makes the
> >     >> intended use of ignore.environment= even more puzzling;
> >     >> given that environments are not ignored recursively
> >     >> (that's not exactly what I mean -- I mean ignoring all
> >     >> environments of components of an object), I have trouble
> >     >> understanding the use case for ignore.environnment ...
> >     >> maybe it was developed before srcrefs existed?
> >
> >     > I think it simply means "ignore.environment.of.closures",
> >     > as the description says, but that's too long to be a
> >     > convenient arg name.
> >
> >     > Closures have three parts: the formals, the body and the
> >     > environment.  (Actually, 4 parts: like almost all R
> >     > objects, they may also have attributes.)
> >
> >     > That arg just says to ignore the environment part when
> >     > comparing closures.  It doesn't say to ignore environments
> >     > in general.
> >
> > For another beat on a dead horse, @ Ben:
> >
> > You could either use  options(keep.source = FALSE) in your
> > enviroment such that your functions should not have any 'srcref'
> > attributes anymore,
> >
> > or probably more sensible, use
> >
> > all.equal(f1, f2) rather than identical(f1, f2, ..)
> >
> > which I think should really do what you want
> > [even though it ends up using string comparison after deparse(.)
> >  .. about which one can debate... but I don't think we'd want to
> >  change  all.equal.language()  at this point in time].
> >
> > Martin
> >
> >
> >     >>
> >     >> In the R code base it's used in checkConflicts (to see if
> >     >> a function is re-exported) and in getAnywhere ...
> >     >>
> >
> >     > I'd say those uses are slightly bogus.  You should
> >     > generally remember that closures have 3 (or 4) parts, and
> >     > not go around comparing only two (or 3) of them.
> >
> >     > Duncan Murdoch
> >
> >     > ______________________________________________
> >     > R-devel at r-project.org mailing list
> >     > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >


From henrik.bengtsson at ucsf.edu  Tue Oct 13 22:39:46 2015
From: henrik.bengtsson at ucsf.edu (Henrik Bengtsson)
Date: Tue, 13 Oct 2015 13:39:46 -0700
Subject: [Rd] A where() functions that does what exists() does but
 return the environment when object lives?
In-Reply-To: <5618CB38.7010606@statistik.tu-dortmund.de>
References: <CAFDcVCRR1YwaC=yQXgvgKpoW1HKLPauKYGrU8g9S3q9rAbctLQ@mail.gmail.com>
	<5618CB38.7010606@statistik.tu-dortmund.de>
Message-ID: <CAFDcVCRdy-M-2UMn6Q8UB=CpqhonzMAUavvj_aAND9vvqROkuw@mail.gmail.com>

On Sat, Oct 10, 2015 at 1:24 AM, Uwe Ligges
<ligges at statistik.tu-dortmund.de> wrote:
> I'd start looking at getAnywhere().

Thanks Uwe, that does indeed provides "where" information.
Unfortunately, I don't see how it will allow me to search environments
similarly/in the same order as exists/get(..., envir, inherits=TRUE)
does it.  getAnywhere() will search everything in any order.  It's a
start though.

Cheers,

Henrik

>
> Best,
> Uwe
>
>
> On 10.10.2015 01:18, Henrik Bengtsson wrote:
>>
>> Hi,
>>
>> exists("foo", inherits=TRUE) check whether an object named "foo"
>> exists, and get("foo", inherits=TRUE) retrieves it.  I'm looking for a
>> similar function to exists() that returns the environment where the
>> object "foo" exists, iff at all.  If not found, NULL is returned.
>> Does that exist?
>>
>> EXAMPLE #1:
>>
>>> sample2 <- base::sample
>>> env <- where("sample2", inherits=TRUE)
>>> env
>>
>> <environment: R_GlobalEnv>
>>
>> Note the difference to:
>>
>>> obj <- get("sample2", inherits=TRUE)
>>> environment(obj)
>>
>> <environment: namespace:base>
>>
>>
>> EXAMPLE #2:
>>
>>> a <- 1
>>> foo <- function() { b <- 2; list(a=where("a", inherits=TRUE),
>>> b=where("b", inherits=TRUE)) }
>>> foo()
>>
>> $a
>> <environment: R_GlobalEnv>
>> $b
>> <environment: 0x000000000b7d2798>
>>
>>> foo()
>>
>> $a
>> <environment: R_GlobalEnv>
>> $b
>> <environment: 0x000000000b7d23e0>
>>
>>
>> I do understand that I can implement such a function myself, but I
>> prefer not to.
>>
>> Thanks,
>>
>> Henrik
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From h.wickham at gmail.com  Tue Oct 13 23:43:10 2015
From: h.wickham at gmail.com (Hadley Wickham)
Date: Tue, 13 Oct 2015 16:43:10 -0500
Subject: [Rd] A where() functions that does what exists() does but
 return the environment when object lives?
In-Reply-To: <CAFDcVCRR1YwaC=yQXgvgKpoW1HKLPauKYGrU8g9S3q9rAbctLQ@mail.gmail.com>
References: <CAFDcVCRR1YwaC=yQXgvgKpoW1HKLPauKYGrU8g9S3q9rAbctLQ@mail.gmail.com>
Message-ID: <CABdHhvEsKjDQ8qBS_ni8gZNg7JoKtCVhhs7R5h3WaxpVyRdrJA@mail.gmail.com>

Seems easy enough to write yourself:

where <- function(x, env = parent.frame()) {
    if (identical(env, emptyenv()))
        return(NULL)
    if (exists(x, envir = env, inherits = FALSE))
        return(env)
    where(x, parent.env(env))
}

sample2 <- base::sample
where("sample2")
#> <environment: 0x1154d3c28>
where("sample")
#> <environment: base>
where("blah")
#> NULL

Hadley

On Fri, Oct 9, 2015 at 6:18 PM, Henrik Bengtsson
<henrik.bengtsson at ucsf.edu> wrote:
> Hi,
>
> exists("foo", inherits=TRUE) check whether an object named "foo"
> exists, and get("foo", inherits=TRUE) retrieves it.  I'm looking for a
> similar function to exists() that returns the environment where the
> object "foo" exists, iff at all.  If not found, NULL is returned.
> Does that exist?
>
> EXAMPLE #1:
>
>> sample2 <- base::sample
>> env <- where("sample2", inherits=TRUE)
>> env
> <environment: R_GlobalEnv>
>
> Note the difference to:
>
>> obj <- get("sample2", inherits=TRUE)
>> environment(obj)
> <environment: namespace:base>
>
>
> EXAMPLE #2:
>
>> a <- 1
>> foo <- function() { b <- 2; list(a=where("a", inherits=TRUE), b=where("b", inherits=TRUE)) }
>> foo()
> $a
> <environment: R_GlobalEnv>
> $b
> <environment: 0x000000000b7d2798>
>
>> foo()
> $a
> <environment: R_GlobalEnv>
> $b
> <environment: 0x000000000b7d23e0>
>
>
> I do understand that I can implement such a function myself, but I
> prefer not to.
>
> Thanks,
>
> Henrik
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
http://had.co.nz/


From h.wickham at gmail.com  Tue Oct 13 23:44:08 2015
From: h.wickham at gmail.com (Hadley Wickham)
Date: Tue, 13 Oct 2015 16:44:08 -0500
Subject: [Rd] A where() functions that does what exists() does but
 return the environment when object lives?
In-Reply-To: <CABdHhvEsKjDQ8qBS_ni8gZNg7JoKtCVhhs7R5h3WaxpVyRdrJA@mail.gmail.com>
References: <CAFDcVCRR1YwaC=yQXgvgKpoW1HKLPauKYGrU8g9S3q9rAbctLQ@mail.gmail.com>
	<CABdHhvEsKjDQ8qBS_ni8gZNg7JoKtCVhhs7R5h3WaxpVyRdrJA@mail.gmail.com>
Message-ID: <CABdHhvFmj0xu1s3Ku48phkr91T_JzRQ++BGVEGw2BG1yOjxGqA@mail.gmail.com>

On Tue, Oct 13, 2015 at 4:43 PM, Hadley Wickham <h.wickham at gmail.com> wrote:
> Seems easy enough to write yourself:
>
> where <- function(x, env = parent.frame()) {
>     if (identical(env, emptyenv()))
>         return(NULL)
>     if (exists(x, envir = env, inherits = FALSE))
>         return(env)
>     where(x, parent.env(env))
> }
>
> sample2 <- base::sample
> where("sample2")
> #> <environment: 0x1154d3c28>

And that returns a random environment because I ran it with
reprex::reprex().  In interactive use it will return <environment:
R_GlobalEnv>

Hadley

-- 
http://had.co.nz/


From ligges at statistik.tu-dortmund.de  Wed Oct 14 00:19:26 2015
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 14 Oct 2015 00:19:26 +0200
Subject: [Rd] A where() functions that does what exists() does but
 return the environment when object lives?
In-Reply-To: <CAFDcVCRdy-M-2UMn6Q8UB=CpqhonzMAUavvj_aAND9vvqROkuw@mail.gmail.com>
References: <CAFDcVCRR1YwaC=yQXgvgKpoW1HKLPauKYGrU8g9S3q9rAbctLQ@mail.gmail.com>
	<5618CB38.7010606@statistik.tu-dortmund.de>
	<CAFDcVCRdy-M-2UMn6Q8UB=CpqhonzMAUavvj_aAND9vvqROkuw@mail.gmail.com>
Message-ID: <561D836E.7090807@statistik.tu-dortmund.de>



On 13.10.2015 22:39, Henrik Bengtsson wrote:
> On Sat, Oct 10, 2015 at 1:24 AM, Uwe Ligges
> <ligges at statistik.tu-dortmund.de> wrote:
>> I'd start looking at getAnywhere().
>
> Thanks Uwe, that does indeed provides "where" information.
> Unfortunately, I don't see how it will allow me to search environments
> similarly/in the same order as exists/get(..., envir, inherits=TRUE)
> does it.  getAnywhere() will search everything in any order.  It's a
> start though.

Ah, in the same order.... Then you probably need to write some code, but 
sources of the existing functions should allow for a good start, I believe.

Good luck,
Uwe

>
> Cheers,
>
> Henrik
>
>>
>> Best,
>> Uwe
>>
>>
>> On 10.10.2015 01:18, Henrik Bengtsson wrote:
>>>
>>> Hi,
>>>
>>> exists("foo", inherits=TRUE) check whether an object named "foo"
>>> exists, and get("foo", inherits=TRUE) retrieves it.  I'm looking for a
>>> similar function to exists() that returns the environment where the
>>> object "foo" exists, iff at all.  If not found, NULL is returned.
>>> Does that exist?
>>>
>>> EXAMPLE #1:
>>>
>>>> sample2 <- base::sample
>>>> env <- where("sample2", inherits=TRUE)
>>>> env
>>>
>>> <environment: R_GlobalEnv>
>>>
>>> Note the difference to:
>>>
>>>> obj <- get("sample2", inherits=TRUE)
>>>> environment(obj)
>>>
>>> <environment: namespace:base>
>>>
>>>
>>> EXAMPLE #2:
>>>
>>>> a <- 1
>>>> foo <- function() { b <- 2; list(a=where("a", inherits=TRUE),
>>>> b=where("b", inherits=TRUE)) }
>>>> foo()
>>>
>>> $a
>>> <environment: R_GlobalEnv>
>>> $b
>>> <environment: 0x000000000b7d2798>
>>>
>>>> foo()
>>>
>>> $a
>>> <environment: R_GlobalEnv>
>>> $b
>>> <environment: 0x000000000b7d23e0>
>>>
>>>
>>> I do understand that I can implement such a function myself, but I
>>> prefer not to.
>>>
>>> Thanks,
>>>
>>> Henrik
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel


From henrik.bengtsson at ucsf.edu  Wed Oct 14 05:09:34 2015
From: henrik.bengtsson at ucsf.edu (Henrik Bengtsson)
Date: Tue, 13 Oct 2015 20:09:34 -0700
Subject: [Rd] A where() functions that does what exists() does but
 return the environment when object lives?
In-Reply-To: <CABdHhvFmj0xu1s3Ku48phkr91T_JzRQ++BGVEGw2BG1yOjxGqA@mail.gmail.com>
References: <CAFDcVCRR1YwaC=yQXgvgKpoW1HKLPauKYGrU8g9S3q9rAbctLQ@mail.gmail.com>
	<CABdHhvEsKjDQ8qBS_ni8gZNg7JoKtCVhhs7R5h3WaxpVyRdrJA@mail.gmail.com>
	<CABdHhvFmj0xu1s3Ku48phkr91T_JzRQ++BGVEGw2BG1yOjxGqA@mail.gmail.com>
Message-ID: <CAFDcVCT7FKGt65XL_NR-OJpJHEcW19M2uYqHBF1pccXOGW=mYA@mail.gmail.com>

Thanks Uwe and thanks Hadley.  I ended up implementing:

## Emulates R internal findVar1mode() function
## https://svn.r-project.org/R/trunk/src/main/envir.c
where <- function(x, where=-1, envir=if (missing(frame)) { if (where <
0) parent.frame(-where) else as.environment(where) } else
sys.frame(frame), frame, mode="any", inherits=TRUE) {
  tt <- 1
  ## Validate arguments
  stopifnot(is.environment(envir))
  stopifnot(is.character(mode), length(mode) == 1L)
  inherits <- as.logical(inherits)
  stopifnot(inherits %in% c(FALSE, TRUE))

  ## Search
  while (!identical(envir, emptyenv())) {
    if (exists(x, envir=envir, mode=mode, inherits=FALSE)) return(envir)
    if (!inherits) return(NULL)
    envir <- parent.env(envir)
  }

  NULL
}

Here where() provides the same arguments as exists() and get().  It
turns out one needs to tweak the default value for 'envir' argument in
order work the same.

One could argue that where() should always return an environment, i.e.
it should return emptyenv() instead of NULL if the object was not
found.  On the other hand, it's easier to test for is.null(env) than
identical(env, emptyenv()).

/Henrik


On Tue, Oct 13, 2015 at 2:44 PM, Hadley Wickham <h.wickham at gmail.com> wrote:
> On Tue, Oct 13, 2015 at 4:43 PM, Hadley Wickham <h.wickham at gmail.com> wrote:
>> Seems easy enough to write yourself:
>>
>> where <- function(x, env = parent.frame()) {
>>     if (identical(env, emptyenv()))
>>         return(NULL)
>>     if (exists(x, envir = env, inherits = FALSE))
>>         return(env)
>>     where(x, parent.env(env))
>> }
>>
>> sample2 <- base::sample
>> where("sample2")
>> #> <environment: 0x1154d3c28>
>
> And that returns a random environment because I ran it with
> reprex::reprex().  In interactive use it will return <environment:
> R_GlobalEnv>
>
> Hadley
>
> --
> http://had.co.nz/


From vakili.kaveh.email at gmail.com  Tue Oct 13 15:46:10 2015
From: vakili.kaveh.email at gmail.com (kaveh)
Date: Tue, 13 Oct 2015 15:46:10 +0200
Subject: [Rd] gcc ubsan alignement test --minimal gcc version?
In-Reply-To: <561CA6B2.4080000@gmail.com>
References: <CAMNYAqWCK3Hc+h+jV2PK_CGeP-o+cMhue6FU9H36onze-u9rDg@mail.gmail.com>
	<561BF4F3.2030200@gmail.com> <561CA6B2.4080000@gmail.com>
Message-ID: <561D0B22.7060208@gmail.com>

   Dear All,

   I'm trying to implement the section of the manual pertaining to the 
gcc-ubsan test
   carried by CRAN on my local computer (ubuntu 14.04):

   http://www.stats.ox.ac.uk/pub/bdr/memtests/gcc-UBSAN/README.txt

   I was wondering whether someone could tell what the minimal version
    of the gcc tool chain needed to run the gcc-ASAN and gcc-UBSAN alignment
   tests on ones local computer is. CRAN seems to use gcc 5.2.0 to do 
these tests,
    but the current version of gcc shipped with ubuntu is 4.9.2 (to be 
updated to
    5.1.0 with the 15.10 release latter this month).

  I hope this is the correct list to post this.

   Thanks in advance,


From vakili.kaveh.email at gmail.com  Wed Oct 14 10:36:16 2015
From: vakili.kaveh.email at gmail.com (kaveh)
Date: Wed, 14 Oct 2015 10:36:16 +0200
Subject: [Rd] gcc ubsan alignement test --minimal gcc version?
In-Reply-To: <561E0E03.6050706@stats.ox.ac.uk>
References: <CAMNYAqWCK3Hc+h+jV2PK_CGeP-o+cMhue6FU9H36onze-u9rDg@mail.gmail.com>
	<561BF4F3.2030200@gmail.com> <561CA6B2.4080000@gmail.com>
	<561D0B22.7060208@gmail.com> <561E0E03.6050706@stats.ox.ac.uk>
Message-ID: <561E1400.4020202@gmail.com>

Dear Prof. Ripley,

Thank you for your answer. I think I am way over my head here.

(Using Doker adds a level of complexity that I'm afraid I can't
manage for now so I am happy with building Rdevel and using it
in to run these tests).

After building Rdevel with what I think are the correct options**
  (just to avoid mistakes I have also fully removed R from my system
  just before and insured that the following packages are all updated)

apt-get install bash-completion bison debhelper default-jdk g++ gcc 
gfortran groff-base libblas-dev libbz2-dev libcairo2-dev 
libcurl4-openssl-dev libjpeg-dev liblapack-dev liblzma-dev 
libncurses5-dev libpango1.0-dev libpcre3-dev libpng-dev libreadline-dev 
libtiff5-dev libx11-dev libxt-dev mpack subversion tcl8.5-dev texinfo 
texlive-base texlive-extra-utils texlive-fonts-extra 
texlive-fonts-recommended texlive-generic-recommended texlive-latex-base 
texlive-latex-extra texlive-latex-recommended tk8.5-dev valgrind 
x11proto-core-dev xauth xdg-utils xfonts-base xvfb zlib1g-dev

cd /tmp
svn co http://svn.r-project.org/R/trunk R-devel
cd /tmp/R-devel
R_PAPERSIZE=letter R_BATCHSAVE="--no-save --no-restore" 
PAGER=/usr/bin/pager  PERL=/usr/bin/perl  R_UNZIPCMD=/usr/bin/unzip 
R_ZIPCMD=/usr/bin/zip  R_PRINTCMD=/usr/bin/lpr  LIBnn=lib 
AWK=/usr/bin/awk  CFLAGS="-pipe -std=gnu99 -Wall -pedantic -O2" 
CXXFLAGS="-pipe -Wall -pedantic -O2"  CC="gcc 
-fsanitize=address,undefined"  CXX="g++ -fsanitize=address,undefined"  
CXX1X="g++ -fsanitize=address,undefined"  FC="gfortran 
-fsanitize=address,undefined"  F77="gfortran 
-fsanitize=address,undefined" ./configure --enable-R-shlib 
--without-blas --without-lapack --with-readline 
--without-recommended-packages --program-suffix=dev --disable-openmp
make
make install
make clean

But I'm not sure how to proceed from there.
I tried the obvious thing:

Rdevel CMD build my_offending_package
Rdevel CMD check --as-cran my_offending_package

But I have not been able to replicate the bug I see on cran:

/usr/local/gcc5/lib/gcc/x86_64-unknown-linux-gnu/5.2.0/include/emmintrin.h:140:21: runtime error: load of misaligned address 0x61800007fc84 for type 'const double', which requires 8 byte alignment
0x61800007fc84: note: pointer points here
   00 00 80 3f 00 00 80 3f  00 00 80 3f 00 00 80 3f  00 00 80 3f 00 00 80 3f  00 00 80 3f 00 00 80 3f


**Though the original authors bear no responsibility for these scripts,
  I have found many of these commands on this file:
https://github.com/rocker-org/r-devel-san/blob/master/Dockerfile





On 2015-10-14 10:10, Prof Brian Ripley wrote:
> On 13/10/2015 14:46, kaveh wrote:
>>    Dear All,
>>
>>    I'm trying to implement the section of the manual pertaining to the
>> gcc-ubsan test
>>    carried by CRAN on my local computer (ubuntu 14.04):
>>
>> http://www.stats.ox.ac.uk/pub/bdr/memtests/gcc-UBSAN/README.txt
>>
>>    I was wondering whether someone could tell what the minimal version
>>     of the gcc tool chain needed to run the gcc-ASAN and gcc-UBSAN
>> alignment
>>    tests on ones local computer is. CRAN seems to use gcc 5.2.0 to do
>> these tests,
>>     but the current version of gcc shipped with ubuntu is 4.9.2 (to be
>> updated to
>>     5.1.0 with the 15.10 release latter this month).
>>
>>   I hope this is the correct list to post this.
>
> The correct thing to do is to read the manual (either the R manual or 
> your gcc manual).  The R manual says
>
> 'AddressSanitizer (?ASan?) is a tool with similar aims to the memory 
> checker in valgrind. It is available with suitable builds of gcc 4.8.0 
> or clang 3.1 and later on common Linux and OS X platforms.'
>
> '?UBSanitizer? is a tool for C/C++ source code selected by 
> -fsanitize=undefined in suitable builds of clang, and GCC as from 4.9.0.'
>
> Note that including these capabilities and their runtimes is optional 
> at least for clang (until recently Apple omitted them), so you need to 
> check your own system's documentation.
>


From ripley at stats.ox.ac.uk  Wed Oct 14 10:10:43 2015
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 14 Oct 2015 09:10:43 +0100
Subject: [Rd] gcc ubsan alignement test --minimal gcc version?
In-Reply-To: <561D0B22.7060208@gmail.com>
References: <CAMNYAqWCK3Hc+h+jV2PK_CGeP-o+cMhue6FU9H36onze-u9rDg@mail.gmail.com>
	<561BF4F3.2030200@gmail.com> <561CA6B2.4080000@gmail.com>
	<561D0B22.7060208@gmail.com>
Message-ID: <561E0E03.6050706@stats.ox.ac.uk>

On 13/10/2015 14:46, kaveh wrote:
>    Dear All,
>
>    I'm trying to implement the section of the manual pertaining to the
> gcc-ubsan test
>    carried by CRAN on my local computer (ubuntu 14.04):
>
>    http://www.stats.ox.ac.uk/pub/bdr/memtests/gcc-UBSAN/README.txt
>
>    I was wondering whether someone could tell what the minimal version
>     of the gcc tool chain needed to run the gcc-ASAN and gcc-UBSAN
> alignment
>    tests on ones local computer is. CRAN seems to use gcc 5.2.0 to do
> these tests,
>     but the current version of gcc shipped with ubuntu is 4.9.2 (to be
> updated to
>     5.1.0 with the 15.10 release latter this month).
>
>   I hope this is the correct list to post this.

The correct thing to do is to read the manual (either the R manual or 
your gcc manual).  The R manual says

'AddressSanitizer (?ASan?) is a tool with similar aims to the memory 
checker in valgrind. It is available with suitable builds of gcc 4.8.0 
or clang 3.1 and later on common Linux and OS X platforms.'

'?UBSanitizer? is a tool for C/C++ source code selected by 
-fsanitize=undefined in suitable builds of clang, and GCC as from 4.9.0.'

Note that including these capabilities and their runtimes is optional at 
least for clang (until recently Apple omitted them), so you need to 
check your own system's documentation.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford
1 South Parks Road, Oxford OX1 3TG, UK


From guerda at freenet.de  Thu Oct 15 09:11:07 2015
From: guerda at freenet.de (=?UTF-8?B?UGhpbGlwIEdpbGxpw59lbg==?=)
Date: Thu, 15 Oct 2015 09:11:07 +0200
Subject: [Rd] Package integrity check via SHA256 or OpenPGP possible?
Message-ID: <44205912eaf5b26a3fee5eed9616f8e7@email.freenet.de>

Dear list,

I'm using R in a corporate environment and was interested how R checks integrity of packages during an installation.
I saw (and verified my suspicion in the code[1]) that the verification purely relies on MD5.
>From an IT security perspective, this can be improved.

My question is: Is is possible to force R to verify integrity via SHA256 or even OpenPGP signatures?
If not are there any plans to support better hashes than MD5?
As the source code looks, an extension to support other (optional) hash values would be quite easy.

Thanks in advance!

Kind regards,
Philip

[1] see from line 594 on in src/library/tools/R/install.R in R-latest.tar.gz






---
Alle Postf?cher an einem Ort. Jetzt wechseln und E-Mail-Adresse mitnehmen! http://email.freenet.de/basic/Informationen




From aixtools at gmail.com  Thu Oct 15 14:32:16 2015
From: aixtools at gmail.com (Michael Felt)
Date: Thu, 15 Oct 2015 14:32:16 +0200
Subject: [Rd] Building R for AIX in 64-bit mode
Message-ID: <CANvxniVBrCaT1C3HosULfg4OfBNkL-vQqnFuTt+j=pfMbovX_Q@mail.gmail.com>

Hi.

Just wanted to let you know I am getting close to packaging R for AIX in
64.bit mode.

One comment - the libtool.m4 I see used is quite old. The one I have on my
system is 2.4.6, and what I see in R says:

I am hoping a new libtool will clean up most of the manual work now needed.

# Which release of libtool.m4 was used?
macro_version=2.2.6
macro_revision=1.3012

This may be all that is needed to cleanup what I am doing manually.

working with gcc I have done the following for 64-bit building

export OBJECT_MODE=64
export CFLAGS="-maix64 -O2"
export FFLAGS="-maix64 -O2"
export LDFLAGS="-lpthread"

Note - it does not look as if LDFLAGS is actually being picked up, but
maybe I had a typo.

The first error I get is:

Target "libunix.a" is up to date.
        gcc -std=gnu99 -I. -I../../src/include -I../../src/include
-I/opt/buildaix/include -I/opt/include -DHAVE_CONFIG_H  -mminimal-toc
-I/opt/include -I/opt/buildaix/include -maix64 -O2  -L/usr/local/lib
-DR_HOME='"/data/prj/cran/64/R-3.2.2"'  -o Rscript ./Rscript.c
        gcc -std=gnu99 -Wl,-brtl -Wl,-bexpall -Wl,-bpT:0x100000000
-Wl,-bpD:0x110000000 -lc   -Wl,-bE:../../etc/R.exp  -L/usr/local/lib -o
R.bin Rmain.o CommandLineArgs.o Rdynload.o Renviron.o RNG.o agrep.o apply.o
arithmetic.o array.o attrib.o bind.o builtin.o character.o coerce.o
colors.o complex.o connections.o context.o cum.o dcf.o datetime.o debug.o
deparse.o devices.o dotcode.o dounzip.o dstruct.o duplicate.o edit.o
engine.o envir.o errors.o eval.o format.o gevents.o gram.o gram-ex.o
graphics.o grep.o identical.o inlined.o inspect.o internet.o iosupport.o
lapack.o list.o localecharset.o logic.o main.o mapply.o match.o memory.o
names.o objects.o options.o paste.o platform.o plot.o plot3d.o plotmath.o
print.o printarray.o printvector.o printutils.o qsort.o random.o raw.o
registration.o relop.o rlocale.o saveload.o scan.o seq.o serialize.o sort.o
source.o split.o sprintf.o startup.o subassign.o subscript.o subset.o
summary.o sysutils.o times.o unique.o util.o version.o g_alab_her.o
g_cntrlify.o g_fontdb.o g_her_glyph.o xxxpr.o   `ls ../unix/*.o ../appl/*.o
../nmath/*.o`  ../extra/bzip2/libbz2.a ../extra/pcre/libpcre.a
../extra/tre/libtre.a  ../extra/xz/liblzma.a ../extra/intl/libintl.a
-lgfortran -lm /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/ppc64/libgcc.a
-lz -lrt -ldl -lm -liconv
ld: 0711-738 ERROR: Input file /lib/crt0.o:
        XCOFF32 object files are not allowed in 64-bit mode.

This is repaired by adding the -maix64 flag again to the gcc comand used to
link.

The following steps - first cut/paste the original command, then add -maix64

root at x072:[/data/prj/cran/64/R-3.2.2]cd src/main
root at x072:[/data/prj/cran/64/R-3.2.2/src/main]ran -lm
/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/ppc64/libgcc.a     -lz -lrt -ldl
-lm -liconv               <
ld: 0711-738 ERROR: Input file /lib/crt0.o:
        XCOFF32 object files are not allowed in 64-bit mode.
collect2: error: ld returned 8 exit status
root at x072:[/data/prj/cran/64/R-3.2.2/src/main] gcc -maix64 -std=gnu99
-Wl,-brtl -Wl,-bexpall -Wl,-bpT:0x100000000 -Wl,-bpD:0x110000000 -lc
-Wl,-bE:../../>
ld: 0711-415 WARNING: Symbol BM_norm_keep is already exported.
ld: 0711-415 WARNING: Symbol LoadInitFile is already exported.
ld: 0711-415 WARNING: Symbol N01_kind is already exported.
ld: 0711-415 WARNING: Symbol R_ReadItemDepth is already exported.
ld: 0711-224 WARNING: Duplicate symbol: BM_norm_keep
ld: 0711-224 WARNING: Duplicate symbol: N01_kind
ld: 0711-224 WARNING: Duplicate symbol: LoadInitFile
ld: 0711-224 WARNING: Duplicate symbol: R_ReadItemDepth
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
information.
ld: 0711-317 ERROR: Undefined symbol: .pthread_mutex_lock
ld: 0711-317 ERROR: Undefined symbol: .pthread_mutex_unlock
collect2: error: ld returned 8 exit status
root at x072:[/data/prj/cran/64/R-3.2.2/src/main]

Now add the -lpthread

gcc -maix64 -std=gnu99 -Wl,-brtl -Wl,-bexpall -Wl,-bpT:0x100000000
-Wl,-bpD:0x110000000 -lc   -Wl,-bE:../../etc/R.exp  -L/usr/local/lib -o
R.bin Rmain.o Comma
ndLineArgs.o Rdynload.o Renviron.o RNG.o agrep.o apply.o arithmetic.o
array.o attrib.o bind.o builtin.o character.o coerce.o colors.o complex.o
connections.o
context.o cum.o dcf.o datetime.o debug.o deparse.o devices.o dotcode.o
dounzip.o dstruct.o duplicate.o edit.o engine.o envir.o errors.o eval.o
format.o gevent
s.o gram.o gram-ex.o graphics.o grep.o identical.o inlined.o inspect.o
internet.o iosupport.o lapack.o list.o localecharset.o logic.o main.o
mapply.o match.o
memory.o names.o objects.o options.o paste.o platform.o plot.o plot3d.o
plotmath.o print.o printarray.o printvector.o printutils.o qsort.o random.o
raw.o regi
stration.o relop.o rlocale.o saveload.o scan.o seq.o serialize.o sort.o
source.o split.o sprintf.o startup.o subassign.o subscript.o subset.o
summary.o sysuti
ls.o times.o unique.o util.o version.o g_alab_her.o g_cntrlify.o g_fontdb.o
g_her_glyph.o xxxpr.o   `ls ../unix/*.o ../appl/*.o ../nmath/*.o`
../extra/bzip2/
libbz2.a ../extra/pcre/libpcre.a ../extra/tre/libtre.a
../extra/xz/liblzma.a ../extra/intl/libintl.a   -lgfortran -lm
/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7
.4/ppc64/libgcc.a     -lz -lrt -ldl -lm -liconv -lpthread

gcc -maix64 -std=gnu99 -Wl,-brtl -Wl,-bexpall -Wl,-bpT:0x100000000
-Wl,-bpD:0x110000000 -lc   -Wl,-bE:../../etc/R.exp  -L/usr/local/lib -o
R.bin Rmain.o CommandLineArgs.o Rdynload.o Renviron.o RNG.o agrep.o apply.o
arithmetic.o array.o attrib.o bind.o builtin.o character.o coerce.o
colors.o complex.o connections.o context.o cum.o dcf.o datetime.o debug.o
deparse.o devices.o dotcode.o dounzip.o dstruct.o duplicate.o edit.o
engine.o envir.o errors.o eval.o format.o gevents.o gram.o gram-ex.o
graphics.o grep.o identical.o inlined.o inspect.o internet.o iosupport.o
lapack.o list.o localecharset.o logic.o main.o mapply.o match.o memory.o
names.o objects.o options.o paste.o platform.o plot.o plot3d.o plotmath.o
print.o printarray.o printvector.o printutils.o qsort.o random.o raw.o
registration.o relop.o rlocale.o saveload.o scan.o seq.o serialize.o sort.o
source.o split.o sprintf.o startup.o subassign.o subscript.o subset.o
summary.o sysutils.o times.o unique.o util.o version.o g_alab_her.o
g_cntrlify.o g_fontdb.o g_her_glyph.o xxxpr.o   `ls ../unix/*.o ../appl/*.o
../nmath/*.o`  ../extra/bzip2/libbz2.a ../extra/pcre/libpcre.a
../extra/tre/libtre.a  ../extra/xz/liblzma.a ../extra/intl/libintl.a
-lgfortran -lm /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/ppc64/libgcc.a
-lz -lrt -ldl -lm -liconv -lpthread
ld: 0711-415 WARNING: Symbol BM_norm_keep is already exported.
ld: 0711-415 WARNING: Symbol LoadInitFile is already exported.
ld: 0711-415 WARNING: Symbol N01_kind is already exported.
ld: 0711-415 WARNING: Symbol R_ReadItemDepth is already exported.
ld: 0711-224 WARNING: Duplicate symbol: BM_norm_keep
ld: 0711-224 WARNING: Duplicate symbol: N01_kind
ld: 0711-224 WARNING: Duplicate symbol: LoadInitFile
ld: 0711-224 WARNING: Duplicate symbol: R_ReadItemDepth
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
information.

Note: this is with 3.2.2 - with 3.1.3 I did not get the Duplicate symbols.


(Using the same command in the 3.1.3 directory shows there are some other
differences)

root at x072:[/data/prj/cran/64/R-3.1.3/src/main]gcc -maix64 -std=gnu99
-Wl,-brtl -Wl,-bexpall -Wl,-bpT:0x100000000 -Wl,-bpD:0>
gcc: error: g_alab_her.o: A file or directory in the path name does not
exist.
gcc: error: g_cntrlify.o: A file or directory in the path name does not
exist.
gcc: error: g_fontdb.o: A file or directory in the path name does not exist.
gcc: error: g_her_glyph.o: A file or directory in the path name does not
exist.

so, since I am getting farther with 3.1.3 - I shall continue this
INFORMATIONAL post.

root at x072:[/data/prj/cran/64/R-3.1.3/src/main]rm R.bin

root at x072:[/data/prj/cran/64/R-3.1.3/src/main]gcc -std=gnu99 -Wl,-brtl
-Wl,-bexpall -Wl,-bpT:0x100000000 -Wl,-bpD:0x110000000 -lc
-Wl,-bE:../../etc/R.exp  -L/usr/l>
ld: 0706-020 The number 0x100000000 is too large for the -b pT option.
        Use a value that is 4294967295 (hex FFFFFFFF) or less.
ld: 0706-020 The number 0x110000000 is too large for the -b pD option.
        Use a value that is 4294967295 (hex FFFFFFFF) or less.
collect2: error: ld returned 255 exit status
root at x072:[/data/prj/cran/64/R-3.1.3/src/main]gcc -maix64 -std=gnu99
-Wl,-brtl -Wl,-bexpall -Wl,-bpT:0x100000000 -Wl,-bpD:0x110000000 -lc
-Wl,-bE:../../etc/R.exp  >
ld: 0711-317 ERROR: Undefined symbol: .pthread_mutex_lock
ld: 0711-317 ERROR: Undefined symbol: .pthread_mutex_unlock
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
information.
collect2: error: ld returned 8 exit status
root at x072:[/data/prj/cran/64/R-3.1.3/src/main]bm-aix5.3.0.0/4.7.4/ppc64/libgcc.a
-lrt -ldl -lm -liconv -lpthread

This is a kind of error that occurs frequently - the argument -shared
causes "issues"

Target "libRlapack.so" is up to date.
/data/prj/cran/64/R-3.1.3/lib/libRlapack.so is unchanged
        gcc -std=gnu99 -shared -Wl,-brtl -Wl,-G -Wl,-bexpall -Wl,-bnoentry
-lc  -L/usr/local/lib -o lapack.so  Lapack.o     -L../../../lib -lRlapack
-lgfortran -lm /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/ppc64/libgcc.a
ld: 0711-736 ERROR: Input file Lapack.o:
        XCOFF64 object files are not allowed in 32-bit mode.
collect2: error: ld returned 8 exit status
make: 1254-004 The error code from the last command is 1.

changing -shared for -maix64 has "fixed" it up to now - Now however, back
to duplicate symbols:

gcc: error: Lapack.o: A file or directory in the path name does not exist.
root at x072:[/data/prj/cran/64/R-3.1.3/src/modules]cd lapack
root at x072:[/data/prj/cran/64/R-3.1.3/src/modules/lapack] gcc -std=gnu99
-shared -Wl,-brtl -Wl,-G -Wl,-bexpall -Wl,-bnoentry -lc  -L/usr/local/lib
-o lapack.so  Lapac>
ld: 0711-736 ERROR: Input file Lapack.o:
        XCOFF64 object files are not allowed in 32-bit mode.
collect2: error: ld returned 8 exit status
root at x072:[/data/prj/cran/64/R-3.1.3/src/modules/lapack]gcc -std=gnu99
-maix64  -Wl,-brtl -Wl,-G -Wl,-bexpall -Wl,-bnoentry -lc  -L/usr/local/lib
-o lapack.so  Lapac>
ld: 0711-224 WARNING: Duplicate symbol: p_xargc
ld: 0711-224 WARNING: Duplicate symbol: p_xargv
ld: 0711-224 WARNING: Duplicate symbol: p_xrcfg
ld: 0711-224 WARNING: Duplicate symbol: p_xrc
ld: 0711-224 WARNING: Duplicate symbol: end
ld: 0711-224 WARNING: Duplicate symbol: .memcpy
ld: 0711-224 WARNING: Duplicate symbol: memcpy
ld: 0711-224 WARNING: Duplicate symbol: .bcopy
ld: 0711-224 WARNING: Duplicate symbol: bcopy
ld: 0711-224 WARNING: Duplicate symbol: .strcmp
ld: 0711-224 WARNING: Duplicate symbol: strcmp
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
information.
root at x072:[/data/prj/cran/64/R-3.1.3/src/modules/lapack]

So, for today, my story ends with
gcc -Wl,-bloadmap:aixtools -std=gnu99 -maix64  -Wl,-brtl -Wl,-G
-Wl,-bexpall -Wl,-bnoentry -lc  -L/usr/local/lib -o lapack.so  Lapack.o
-L../../../lib -lRlapack  -lgfortran -lm
/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/ppc64/libgcc.a

ld: 0711-228 WARNING: Duplicate symbols were found while resolving symbols.
        The following duplicates were found:
 Symbol                    Source-File(Object) OR Import-File{Shared-object}
 ------------------------- -------------------------------------------------
 p_xargc                   crt0_64.s(/lib/crt0_64.o)
    ** Duplicate **        {../../../lib/libRlapack.so}
 p_xargv                   crt0_64.s(/lib/crt0_64.o)
    ** Duplicate **        {../../../lib/libRlapack.so}
 p_xrcfg                   crt0_64.s(/lib/crt0_64.o)
    ** Duplicate **        {../../../lib/libRlapack.so}
 p_xrc                     crt0_64.s(/lib/crt0_64.o)
    ** Duplicate **        {../../../lib/libRlapack.so}
 end                       crt0_64.s(/lib/crt0_64.o)
    ** Duplicate **        {../../../lib/libRlapack.so}
 .memcpy                   moveeq.s(/usr/lib/libc.a[moveeq_64.o])
    ** Duplicate **        {../../../lib/libRlapack.so}
 memcpy                    moveeq.s(/usr/lib/libc.a[moveeq_64.o])
    ** Duplicate **        {../../../lib/libRlapack.so}
 .bcopy                    moveeq.s(/usr/lib/libc.a[moveeq_64.o])
    ** Duplicate **        {../../../lib/libRlapack.so}
 bcopy                     moveeq.s(/usr/lib/libc.a[moveeq_64.o])
    ** Duplicate **        {../../../lib/libRlapack.so}
 .strcmp                   strcmp.s(/usr/lib/libc.a[strcmp_64.o])
    ** Duplicate **        {../../../lib/libRlapack.so}
 strcmp                    strcmp.s(/usr/lib/libc.a[strcmp_64.o])
    ** Duplicate **        {../../../lib/libRlapack.so}

	[[alternative HTML version deleted]]


From ripley at stats.ox.ac.uk  Thu Oct 15 15:02:57 2015
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 15 Oct 2015 14:02:57 +0100
Subject: [Rd] Building R for AIX in 64-bit mode
In-Reply-To: <CANvxniVBrCaT1C3HosULfg4OfBNkL-vQqnFuTt+j=pfMbovX_Q@mail.gmail.com>
References: <CANvxniVBrCaT1C3HosULfg4OfBNkL-vQqnFuTt+j=pfMbovX_Q@mail.gmail.com>
Message-ID: <561FA401.7010207@stats.ox.ac.uk>

On 15/10/2015 13:32, Michael Felt wrote:
> Hi.
>
> Just wanted to let you know I am getting close to packaging R for AIX in
> 64.bit mode.

Which version? (You mentioned 3.1.3 and 3.2.2 far below.)  There is 
little value in reporting on frozen branches, and most value in 
reporting on R-devel where all the current changes have been incorporated.

> One comment - the libtool.m4 I see used is quite old. The one I have on my
> system is 2.4.6, and what I see in R says:

R-devel has 2.4.6 .

> I am hoping a new libtool will clean up most of the manual work now needed.

But libtool is hardly used in building R.

> # Which release of libtool.m4 was used?
> macro_version=2.2.6
> macro_revision=1.3012
>
> This may be all that is needed to cleanup what I am doing manually.
>
> working with gcc I have done the following for 64-bit building
>
> export OBJECT_MODE=64
> export CFLAGS="-maix64 -O2"
> export FFLAGS="-maix64 -O2"

See the manual: flags such as -maix64 should be part of CC, not CFLAGS. 
  That explains a lot of what was reported.
Specifically, 
https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Essential-programs-and-libraries 
and https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#AIX .

It is safer to put such things on the configure command line or in a 
config.site file (they will be found when updating if you do).

[Lots of test output removed.]

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Emeritus Professor of Applied Statistics, University of Oxford
1 South Parks Road, Oxford OX1 3TG, UK


From jeroen.ooms at stat.ucla.edu  Thu Oct 15 15:51:39 2015
From: jeroen.ooms at stat.ucla.edu (Jeroen Ooms)
Date: Thu, 15 Oct 2015 15:51:39 +0200
Subject: [Rd] Package integrity check via SHA256 or OpenPGP possible?
In-Reply-To: <44205912eaf5b26a3fee5eed9616f8e7@email.freenet.de>
References: <44205912eaf5b26a3fee5eed9616f8e7@email.freenet.de>
Message-ID: <CABFfbXsfSYQDf_mt_+afqZ-Ap0uTUpShD8MX9DNmdLL4qs3NQg@mail.gmail.com>

On Thu, Oct 15, 2015 at 9:11 AM, Philip Gilli?en <guerda at freenet.de> wrote:
> I'm using R in a corporate environment...

That's irrelevant.

> is possible to force R to verify integrity via SHA256 or even OpenPGP signatures? If not are there any plans to support better hashes than MD5? As the source code looks, an extension to support other (optional) hash values would be quite easy.

A hash is not the same thing as a signature. If you need an
introduction to these topics I recommend www.crypto101.io.

Adding sha256 support would indeed be easy but we wouldn't gain much.
Coincidental md5 collisions are very unlikely. If you are considering
deliberate attacks on the network, a hash function is not going to
help as the attacker can just recompute the hash along with the
tampered package.

Also note that if you are using an https mirror, the connection
between you and the mirror should be secure. But of course it is still
possible that a mirror server itself gets hacked.

Now, signing packages with a private key would be useful against such
attacks, but require quite a bit of work. If we would follow the
Debian model, it would require that:

 - Each of the PACKAGES files in the repository gains a secure hash
(e.g. sha256) for each file in the directory.
 - A "Release" file [1] is added to the repository that includes a
secure hash of each of the PACKAGES files.
 - A "Release.gpg" file [2] or equivalent is added which contains a
signature of the "Release" file.
 - Each time "PACKAGES" and hence "Release" files are updated, the
repository maintainers need to update "Release.gpg" by signing
"Release" with their private key.
 - R installations would have to ship with the corresponding public
key in order to verify the signature in Release.gpg before installing
packages.
 - All of this would have to be implemented using a crypto library
capable of public key signatures.
 - A policy is designed for rotating keys when they expire, or between
R releases, or when one gets compromised, etc.

I have actually been looking into this over the past few months. On
Linux it would be doable with gpg, but unfortunately gpg does not work
very well on OSX and Windows, which make it impractical for R.

There are a few alternatives that are more portable. The PKI package
uses openssl to do RSA signatures, which could work. The new 'sodium'
package is probably the most advanced thing currently available. It
uses the ed25519 public-key signature system with a very simple API.
See the manual page for the 'sig_sign' and 'sig_verify' functions.

Either way, all this would require a substantial amount of work and
additional ongoing maintenance in both R and CRAN, which is unlikely
to happen given the limited resources.


[1] http://http.us.debian.org/debian/dists/jessie/Release
[2] http://http.us.debian.org/debian/dists/jessie/Release.gpg


From ripley at stats.ox.ac.uk  Thu Oct 15 16:13:06 2015
From: ripley at stats.ox.ac.uk (Brian Ripley)
Date: Thu, 15 Oct 2015 15:13:06 +0100
Subject: [Rd] Package integrity check via SHA256 or OpenPGP possible?
In-Reply-To: <44205912eaf5b26a3fee5eed9616f8e7@email.freenet.de>
References: <44205912eaf5b26a3fee5eed9616f8e7@email.freenet.de>
Message-ID: <26EF9147-ACE6-4503-9999-F10E415B4DB8@stats.ox.ac.uk>



> On 15 Oct 2015, at 08:11, Philip Gilli?en <guerda at freenet.de> wrote:
> 
> Dear list,
> 
> I'm using R in a corporate environment and was interested how R checks integrity of packages during an installation.
> I saw (and verified my suspicion in the code[1]) that the verification purely relies on MD5.
>> From an IT security perspective, this can be improved.

Maybe, but 'IT security' was not the point.  MD5 sums were added first as a way to check for corrupted downloads/unpacking (which used to be common on Windows), and second to reinforce the version number of a package as sometimes the source package is altered without changing the version, and less rarely binary packages are re-built.


> 
> My question is: Is is possible to force R to verify integrity via SHA256 or even OpenPGP signatures?
> If not are there any plans to support better hashes than MD5?
> As the source code looks, an extension to support other (optional) hash values would be quite easy.
> 
> Thanks in advance!
> 
> Kind regards,
> Philip
> 
> [1] see from line 594 on in src/library/tools/R/install.R in R-latest.tar.gz
> 
> 
> 
> 
> 
> 
> ---
> Alle Postf?cher an einem Ort. Jetzt wechseln und E-Mail-Adresse mitnehmen! http://email.freenet.de/basic/Informationen
> 
> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From simon.urbanek at r-project.org  Thu Oct 15 16:52:41 2015
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 15 Oct 2015 10:52:41 -0400
Subject: [Rd] Package integrity check via SHA256 or OpenPGP possible?
In-Reply-To: <CABFfbXsfSYQDf_mt_+afqZ-Ap0uTUpShD8MX9DNmdLL4qs3NQg@mail.gmail.com>
References: <44205912eaf5b26a3fee5eed9616f8e7@email.freenet.de>
	<CABFfbXsfSYQDf_mt_+afqZ-Ap0uTUpShD8MX9DNmdLL4qs3NQg@mail.gmail.com>
Message-ID: <35B9AAC1-2B32-4CE6-9B8B-8260D1FA605B@r-project.org>

FWIW PKI supports signing and verification of tar balls based on X.509 (PKI.sign.tar/PKI.verify.tar) - the aim was to specifically support signing of packages so we could have infrastructure akin to the Apple developer code signing where the repository would be the CA (e.g., CRAN, RForge.net, etc.). Obviously, it's just one approach, but at least it is already implemented.

This is getting OT as others have pointed out since the purpose of the hashes is an integrity check, not security, but I absolutely agree that it would be nice to have some kind of signing to validate the source of packages (=verifiable authorship).

Cheers,
Simon


> On Oct 15, 2015, at 9:51 AM, Jeroen Ooms <jeroen.ooms at stat.ucla.edu> wrote:
> 
> On Thu, Oct 15, 2015 at 9:11 AM, Philip Gilli?en <guerda at freenet.de> wrote:
>> I'm using R in a corporate environment...
> 
> That's irrelevant.
> 
>> is possible to force R to verify integrity via SHA256 or even OpenPGP signatures? If not are there any plans to support better hashes than MD5? As the source code looks, an extension to support other (optional) hash values would be quite easy.
> 
> A hash is not the same thing as a signature. If you need an
> introduction to these topics I recommend www.crypto101.io.
> 
> Adding sha256 support would indeed be easy but we wouldn't gain much.
> Coincidental md5 collisions are very unlikely. If you are considering
> deliberate attacks on the network, a hash function is not going to
> help as the attacker can just recompute the hash along with the
> tampered package.
> 
> Also note that if you are using an https mirror, the connection
> between you and the mirror should be secure. But of course it is still
> possible that a mirror server itself gets hacked.
> 
> Now, signing packages with a private key would be useful against such
> attacks, but require quite a bit of work. If we would follow the
> Debian model, it would require that:
> 
> - Each of the PACKAGES files in the repository gains a secure hash
> (e.g. sha256) for each file in the directory.
> - A "Release" file [1] is added to the repository that includes a
> secure hash of each of the PACKAGES files.
> - A "Release.gpg" file [2] or equivalent is added which contains a
> signature of the "Release" file.
> - Each time "PACKAGES" and hence "Release" files are updated, the
> repository maintainers need to update "Release.gpg" by signing
> "Release" with their private key.
> - R installations would have to ship with the corresponding public
> key in order to verify the signature in Release.gpg before installing
> packages.
> - All of this would have to be implemented using a crypto library
> capable of public key signatures.
> - A policy is designed for rotating keys when they expire, or between
> R releases, or when one gets compromised, etc.
> 
> I have actually been looking into this over the past few months. On
> Linux it would be doable with gpg, but unfortunately gpg does not work
> very well on OSX and Windows, which make it impractical for R.
> 
> There are a few alternatives that are more portable. The PKI package
> uses openssl to do RSA signatures, which could work. The new 'sodium'
> package is probably the most advanced thing currently available. It
> uses the ed25519 public-key signature system with a very simple API.
> See the manual page for the 'sig_sign' and 'sig_verify' functions.
> 
> Either way, all this would require a substantial amount of work and
> additional ongoing maintenance in both R and CRAN, which is unlikely
> to happen given the limited resources.
> 
> 
> [1] http://http.us.debian.org/debian/dists/jessie/Release
> [2] http://http.us.debian.org/debian/dists/jessie/Release.gpg
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From dmccully at mail.nih.gov  Sat Oct 17 21:04:43 2015
From: dmccully at mail.nih.gov (McCully, Dwayne (NIH/NIAMS) [C])
Date: Sat, 17 Oct 2015 19:04:43 +0000
Subject: [Rd] R 3.2.2 - make check and install package hang
In-Reply-To: <432A8E6B26DC62439F0201C069BE2B673F0E70F9@msgb06.nih.gov>
References: <432A8E6B26DC62439F0201C069BE2B673F0E70F9@msgb06.nih.gov>
Message-ID: <432A8E6B26DC62439F0201C069BE2B673F0E72F4@msgb06.nih.gov>

Hello Everyone,

After trying several ways to compile R 3.2.2 without luck, I?m reaching out for help.
The ?make check? does not hanges for some reason and when
trying to install a package it cannot list the download sites (see below).

What could be the problem?


./configure --enable-R-shlib --enable-BLAS-shlib

hostname = test
uname -m = x86_64
uname -r = 2.6.32-573.7.1.el6.x86_64
uname -s = Linux
uname -v = #1 SMP Thu Sep 10 13:42:16 EDT 2015
OS: Red Hat 6.7

configuring Java ...
Java interpreter : /usr/bin/java
Java version     : 1.7.0_85
Java home path   : /usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre
Java compiler    : /usr/bin/javac
Java headers gen.: /usr/bin/javah
Java archive tool: /usr/bin/jar

trying to compile and link a JNI program
detected JNI cpp flags    : -I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux
detected JNI linker flags : -L$(JAVA_HOME)/lib/amd64/server -ljvm
make[2]: Entering directory `/tmp/Rjavareconf.lcq59l'
gcc -std=gnu99 -I/home/dmccully/R-3.2.2/include -DNDEBUG -I/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre/../include -I/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre/../include/linux -I/usr/local/include    -fpic  -g -O2  -c conftest.c -o conftest.o
gcc -std=gnu99 -shared -L/home/dmccully/R-3.2.2/lib -L/usr/local/lib64 -o conftest.so conftest.o -L/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre/lib/amd64/server -ljvm -L/home/dmccully/R-3.2.2/lib -lR
make[2]: Leaving directory `/tmp/Rjavareconf.lcq59l'


JAVA_HOME        : /usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre
Java library path: $(JAVA_HOME)/lib/amd64/server
JNI cpp flags    : -I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux
JNI linker flags : -L$(JAVA_HOME)/lib/amd64/server -ljvm
Updating Java configuration in /home/dmccully/R-3.2.2
Done.

make[1]: Leaving directory `/home/dmccully/R-3.2.2'
[root at test R-3.2.2]# pwd
/home/dmccully/R-3.2.2
[root at test R-3.2.2]# make check
make[1]: Entering directory `/home/dmccully/R-3.2.2/tests'
make[2]: Entering directory `/home/dmccully/R-3.2.2/tests'
make[3]: Entering directory `/home/dmccully/R-3.2.2/tests/Examples'
Testing examples for package ?base?


> install.packages("ggplot2")
--- Please select a CRAN mirror for use in this session ---

	[[alternative HTML version deleted]]


From arnaud.gaboury at gmail.com  Sat Oct 17 23:43:37 2015
From: arnaud.gaboury at gmail.com (arnaud gaboury)
Date: Sat, 17 Oct 2015 23:43:37 +0200
Subject: [Rd] R 3.2.2 - make check and install package hang
In-Reply-To: <432A8E6B26DC62439F0201C069BE2B673F0E72F4@msgb06.nih.gov>
References: <432A8E6B26DC62439F0201C069BE2B673F0E70F9@msgb06.nih.gov>
	<432A8E6B26DC62439F0201C069BE2B673F0E72F4@msgb06.nih.gov>
Message-ID: <CAK1hC9s6--YC0mOsp50aeCDk2yxtf3GSaYksGjVpQfhOXK69BQ@mail.gmail.com>

On Sat, Oct 17, 2015 at 9:04 PM, McCully, Dwayne (NIH/NIAMS) [C]
<dmccully at mail.nih.gov> wrote:
> Hello Everyone,
>
> After trying several ways to compile R 3.2.2 without luck, I?m reaching out for help.
> The ?make check? does not hanges for some reason and when
> trying to install a package it cannot list the download sites (see below).
>
> What could be the problem?

Maybe your exisiting environment variable. Is R already installed? If
yes, please post output of the followning command in a R session:

> Sys.getenv()




>
>
> ./configure --enable-R-shlib --enable-BLAS-shlib
>
> hostname = test
> uname -m = x86_64
> uname -r = 2.6.32-573.7.1.el6.x86_64
> uname -s = Linux
> uname -v = #1 SMP Thu Sep 10 13:42:16 EDT 2015
> OS: Red Hat 6.7
>
> configuring Java ...
> Java interpreter : /usr/bin/java
> Java version     : 1.7.0_85
> Java home path   : /usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre
> Java compiler    : /usr/bin/javac
> Java headers gen.: /usr/bin/javah
> Java archive tool: /usr/bin/jar
>
> trying to compile and link a JNI program
> detected JNI cpp flags    : -I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux
> detected JNI linker flags : -L$(JAVA_HOME)/lib/amd64/server -ljvm
> make[2]: Entering directory `/tmp/Rjavareconf.lcq59l'
> gcc -std=gnu99 -I/home/dmccully/R-3.2.2/include -DNDEBUG -I/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre/../include -I/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre/../include/linux -I/usr/local/include    -fpic  -g -O2  -c conftest.c -o conftest.o
> gcc -std=gnu99 -shared -L/home/dmccully/R-3.2.2/lib -L/usr/local/lib64 -o conftest.so conftest.o -L/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre/lib/amd64/server -ljvm -L/home/dmccully/R-3.2.2/lib -lR
> make[2]: Leaving directory `/tmp/Rjavareconf.lcq59l'
>
>
> JAVA_HOME        : /usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre
> Java library path: $(JAVA_HOME)/lib/amd64/server
> JNI cpp flags    : -I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux
> JNI linker flags : -L$(JAVA_HOME)/lib/amd64/server -ljvm
> Updating Java configuration in /home/dmccully/R-3.2.2
> Done.
>
> make[1]: Leaving directory `/home/dmccully/R-3.2.2'
> [root at test R-3.2.2]# pwd
> /home/dmccully/R-3.2.2
> [root at test R-3.2.2]# make check
> make[1]: Entering directory `/home/dmccully/R-3.2.2/tests'
> make[2]: Entering directory `/home/dmccully/R-3.2.2/tests'
> make[3]: Entering directory `/home/dmccully/R-3.2.2/tests/Examples'
> Testing examples for package ?base?
>
>
>> install.packages("ggplot2")
> --- Please select a CRAN mirror for use in this session ---
>
>         [[alternative HTML version deleted]]
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 

google.com/+arnaudgabourygabx


From jeroenooms at gmail.com  Sun Oct 18 14:14:24 2015
From: jeroenooms at gmail.com (Jeroen Ooms)
Date: Sun, 18 Oct 2015 14:14:24 +0200
Subject: [Rd] R 3.2.2 - make check and install package hang
In-Reply-To: <432A8E6B26DC62439F0201C069BE2B673F0E72F4@msgb06.nih.gov>
References: <432A8E6B26DC62439F0201C069BE2B673F0E70F9@msgb06.nih.gov>
	<432A8E6B26DC62439F0201C069BE2B673F0E72F4@msgb06.nih.gov>
Message-ID: <CABFfbXu8m8OMVn9FXwZJ7b8bjAmdV7dO6v9GEw7LVNa7o3R1ug@mail.gmail.com>

On Sat, Oct 17, 2015 at 9:04 PM, McCully, Dwayne (NIH/NIAMS) [C]
<dmccully at mail.nih.gov> wrote:
> After trying several ways to compile R 3.2.2 without luck, I?m reaching out for help.

If you are new to R you probably want to use the precompiled binaries.
On CentOS/RHEL these are available through the EPEL repositories (see
http://bit.ly/1xVxGlD for installation instructions)

Once EPEL is installed you can simply do 'yum install R-devel' as you
would do on Fedora.


From aixtools at gmail.com  Sun Oct 18 21:06:50 2015
From: aixtools at gmail.com (aixtools)
Date: Sun, 18 Oct 2015 21:06:50 +0200
Subject: [Rd] Building R for AIX in 32-bit mode - as preparation for
 building in 64-bit mode (changed subject!) - INFO/FEEDBACK - do not read as
 a bug report!
In-Reply-To: <561FA401.7010207@stats.ox.ac.uk>
References: <CANvxniVBrCaT1C3HosULfg4OfBNkL-vQqnFuTt+j=pfMbovX_Q@mail.gmail.com>
	<561FA401.7010207@stats.ox.ac.uk>
Message-ID: <5623EDCA.5030309@gmail.com>

On 2015-10-15 15:02, Prof Brian Ripley wrote:
> On 15/10/2015 13:32, Michael Felt wrote:
>> Hi.
>>
>> Just wanted to let you know I am getting close to packaging R for AIX in
rephrase - would like to be active in keeping R binaries current for 
AIX. My interest in not in R per se (rather a colleague who has a 
project that uses R, so I hope to assist him, and others like him).
>
> Which version? (You mentioned 3.1.3 and 3.2.2 far below.)  There is 
> little value in reporting on frozen branches, and most value in 
> reporting on R-devel where all the current changes have been 
> incorporated.
The reason for reporting old and current releases is to understand what 
is new between releases, and what has been around for "awhile".

Note: in the future I shall edit all the "you cannot build, could not 
determine ... messages" - and as much as possible, shall focus on 
R-devel "packaging".

I (attempt to) 'package' a lot of Opensource tools for AIX. Generally, 
the problems are not application code related (sometimes a function 
available on one platform, e.g. Linux, but not on AIX) - but most are, 
or can be resolved, with modifications via configure.ac, Makefile.in, etc..

Sincerely,
Michael

"Details"...

When configure does complete - config.log starts with:
It was created by R configure 3.1.3, which was
generated by GNU Autoconf 2.69.  Invocation command line was

   $ ./configure --prefix=/opt --sysconfdir=/var/R/etc 
--sharedstatedir=/var/R/com --localstatedir=/var/R 
--mandir=/usr/share/man --infodir=/opt/share/info/R --with-readline=no 
--with-x=no

As I see you are using a recent autoconf (and I shall guess a recent 
automake) I would like to try a more version of libtool and see if that 
corrects anything. However, even in R-devel I do not see, directly, how 
you are using these tools (some projects include either a setup.sh or a 
buildconf script to standardize how the project does this.) I am quite 
capable of just calling the tools in sequence, but would prefer to 
follow your procedure.
I
Starting again - fresh 3.1.3, 3.2.2 and R-devel - all in 32-bit mode, 
for the start. The goal is a 64-bit build so that memory management will 
be easier.

This is my "standard command for building a package"

CPPFLAGS="-I/opt/buildaix/include -I/opt/include" CFLAGS="-I/opt/include 
-I/opt/buildaix/include -O2" ./configure \
                 --prefix=/opt  \
                 --sysconfdir=/var/R/etc \
                 --sharedstatedir=/var/R/com \
                 --localstatedir=/var/R \
                 --mandir=/usr/share/man \
                 --infodir=/opt/share/info/R --with-readline=no --with-x=no
Results for 3.1.3
configure: WARNING: you cannot build PDF versions of the R manuals
configure: WARNING: you cannot build PDF versions of vignettes and help 
pages
configure: WARNING: you cannot build info or HTML versions of the R manuals
configure: WARNING: I could not determine a browser
configure: WARNING: I could not determine a PDF viewer
configure: WARNING: you cannot build info or HTML versions of the R manuals
configure: WARNING: you cannot build PDF versions of the R manuals
configure: WARNING: you cannot build PDF versions of vignettes and help 
pages
configure: WARNING: I could not determine a browser
configure: WARNING: I could not determine a PDF viewer
+ make > .buildaix/make.out
sys-std.c: In function 'Rstd_ChooseFile':
sys-std.c:1186:5: warning: implicit declaration of function 'isspace' 
[-Wimplicit-function-declaration]
connections.c: In function 'fifo_open':
connections.c:885:5: warning: implicit declaration of function 'open' 
[-Wimplicit-function-declaration]
main.c: In function 'dummy_ii':
main.c:1594:5: warning: function returns address of local variable 
[enabled by default]
ld: 0711-224 WARNING: Duplicate symbol: .memcpy
ld: 0711-224 WARNING: Duplicate symbol: memcpy
ld: 0711-224 WARNING: Duplicate symbol: .bcopy
ld: 0711-224 WARNING: Duplicate symbol: bcopy
ld: 0711-224 WARNING: Duplicate symbol: .strcmp
ld: 0711-224 WARNING: Duplicate symbol: strcmp
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more 
information.
Warning in solve.default(rgb) :
   unable to load shared object 
'/data/prj/cran/32/R-3.1.3/modules//lapack.so':
   rtld: 0712-001 Symbol logf was referenced
       from module /data/prj/cran/32/R-3.1.3/lib/libRlapack.so(), but a 
runtime definition
             of the symbol was not found.
Error in solve.default(rgb) : LAPACK routines cannot be loaded
Error: unable to load R code in package 'grDevices'
Execution halted
make: 1254-004 The error code from the last command is 1.

...

Stop.
make returned an error
root at x072:[/data/prj/cran/32/R-3.1.3]
++++++
Notes: Last April I was successful with building R - I do not recall 
specifically how I changed the release. I shall determine what I did to 
get it to build normally.
++++++
Results for 3.2.2
configure: WARNING: you cannot build PDF versions of the R manuals
configure: WARNING: you cannot build PDF versions of vignettes and help 
pages
configure: WARNING: you cannot build info or HTML versions of the R manuals
configure: WARNING: I could not determine a browser
configure: WARNING: I could not determine a PDF viewer
configure: WARNING: you cannot build info or HTML versions of the R manuals
configure: WARNING: you cannot build PDF versions of the R manuals
configure: WARNING: you cannot build PDF versions of vignettes and help 
pages
configure: WARNING: I could not determine a browser
configure: WARNING: I could not determine a PDF viewer
+ make > .buildaix/make.out
sys-std.c: In function 'Rstd_ChooseFile':
sys-std.c:1189:5: warning: implicit declaration of function 'isspace' 
[-Wimplicit-function-declaration]
connections.c: In function 'fifo_open':
connections.c:876:5: warning: implicit declaration of function 'open' 
[-Wimplicit-function-declaration]
main.c: In function 'dummy_ii':
main.c:1598:5: warning: function returns address of local variable 
[enabled by default]
ld: 0711-415 WARNING: Symbol BM_norm_keep is already exported.
ld: 0711-415 WARNING: Symbol LoadInitFile is already exported.
ld: 0711-415 WARNING: Symbol N01_kind is already exported.
ld: 0711-415 WARNING: Symbol R_ReadItemDepth is already exported.
ld: 0711-224 WARNING: Duplicate symbol: LoadInitFile
ld: 0711-224 WARNING: Duplicate symbol: BM_norm_keep
ld: 0711-224 WARNING: Duplicate symbol: N01_kind
ld: 0711-224 WARNING: Duplicate symbol: R_ReadItemDepth
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more 
information.
ld: 0711-415 WARNING: Symbol BM_norm_keep is already exported.
ld: 0711-415 WARNING: Symbol LoadInitFile is already exported.
ld: 0711-415 WARNING: Symbol N01_kind is already exported.
ld: 0711-415 WARNING: Symbol R_ReadItemDepth is already exported.
ld: 0711-224 WARNING: Duplicate symbol: LoadInitFile
ld: 0711-224 WARNING: Duplicate symbol: BM_norm_keep
ld: 0711-224 WARNING: Duplicate symbol: N01_kind
ld: 0711-224 WARNING: Duplicate symbol: R_ReadItemDepth
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more 
information.
ld: 0711-224 WARNING: Duplicate symbol: .memcpy
ld: 0711-224 WARNING: Duplicate symbol: memcpy
ld: 0711-224 WARNING: Duplicate symbol: .bcopy
ld: 0711-224 WARNING: Duplicate symbol: bcopy
ld: 0711-224 WARNING: Duplicate symbol: .strcmp
ld: 0711-224 WARNING: Duplicate symbol: strcmp
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more 
information.
/bin/sh: There is no process to read data written to a pipe.
Warning in solve.default(rgb) :
   unable to load shared object 
'/data/prj/cran/32/R-3.2.2/modules//lapack.so':
   rtld: 0712-001 Symbol logf was referenced
       from module /data/prj/cran/32/R-3.2.2/lib/libRlapack.so(), but a 
runtime definition
             of the symbol was not found.
Error in solve.default(rgb) : LAPACK routines cannot be loaded
Error: unable to load R code in package 'grDevices'
Execution halted
make: 1254-004 The error code from the last command is 1.

...
make returned an error
+++++
Here there are similiar - and new problems. The error re: rtld is 
usually a compiler (actually ld) flag error - a routine is expected to 
be exported in a shared object, but the object is still "static".
I have seen this same problem with at least one R module.

I still am unsure why some functions are being defined double - that 
info will come later
root at x072:[/data/prj/cran/32/R-3.2.2]

+++++
>From  R-devel_2015-10-17.tar.bz2
configure: WARNING: you cannot build PDF versions of the R manuals
configure: WARNING: you cannot build PDF versions of vignettes and help 
pages
configure: WARNING: you cannot build info or HTML versions of the R manuals
configure: WARNING: I could not determine a browser
configure: WARNING: I could not determine a PDF viewer
configure: error: bzip2 library and headers are required
buildaix: ./configure ... returned an error

try doing "grep configure: config.log | tail" for possible explanation

try "./configure --help" for additional arguments to buildaix
++++ config.log configure: comments are ++++
configure:35647: checking bzlib.h presence
configure:35647: gcc -E -I/opt/buildaix/include -I/opt/include  conftest.c
configure:35647: $? = 1
configure: failed program was:
configure:35647: result: no
configure:35647: checking for bzlib.h
configure:35647: result: no
configure:35712: checking whether bzip2 support suffices
configure:35719: error: bzip2 library and headers are required
configure: exit 1
++++ ++++
Here is a completely new kind of "problem" - a demand for an include 
file. bzip2 is available, but configure is looking for it in a different 
way and now configure fails.

>
>> One comment - the libtool.m4 I see used is quite old. The one I have 
>> on my
>> system is 2.4.6, and what I see in R says:
>
> R-devel has 2.4.6 .
>
>> I am hoping a new libtool will clean up most of the manual work now 
>> needed.
>
> But libtool is hardly used in building R.
>
>> # Which release of libtool.m4 was used?
>> macro_version=2.2.6
>> macro_revision=1.3012
>>
>> This may be all that is needed to cleanup what I am doing manually.
>>
>> working with gcc I have done the following for 64-bit building
>>
>> export OBJECT_MODE=64
>> export CFLAGS="-maix64 -O2"
>> export FFLAGS="-maix64 -O2"
>
> See the manual: flags such as -maix64 should be part of CC, not 
> CFLAGS.  That explains a lot of what was reported.
> Specifically, 
> https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Essential-programs-and-libraries 
> and https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#AIX .
>
> It is safer to put such things on the configure command line or in a 
> config.site file (they will be found when updating if you do).
>
> [Lots of test output removed.]
>


From spencer.graves at prodsyse.com  Sun Oct 18 23:51:48 2015
From: spencer.graves at prodsyse.com (Spencer Graves)
Date: Sun, 18 Oct 2015 16:51:48 -0500
Subject: [Rd] Linking to documentation from a vignette using markdown?
Message-ID: <56241474.7020203@prodsyse.com>

Hello:


       What's the preferred way to link to package documentation from a 
vignette using markdown?


       My current draft includes 
"[cumsum](https://stat.ethz.ch/R-manual/R-devel/library/base/html/cumsum.html)" 
to link to the help page for cusum{base} and 
"[KFAS](https://rweb.crmda.ku.edu/cran/web/packages/KFAS/KFAS.pdf)" to 
link to the pdf documentation for the KFAS package.  This works, but it 
feels like an ugly hack, and I wonder if there might be some more 
elegant way of doing this (documented in a fine manual I have yet to find)?


       Thanks,
       Spencer


From murdoch.duncan at gmail.com  Mon Oct 19 03:18:38 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Sun, 18 Oct 2015 21:18:38 -0400
Subject: [Rd] Linking to documentation from a vignette using markdown?
In-Reply-To: <56241474.7020203@prodsyse.com>
References: <56241474.7020203@prodsyse.com>
Message-ID: <562444EE.7010900@gmail.com>

On 18/10/2015 5:51 PM, Spencer Graves wrote:
> Hello:
> 
> 
>        What's the preferred way to link to package documentation from a 
> vignette using markdown?
> 
> 
>        My current draft includes 
> "[cumsum](https://stat.ethz.ch/R-manual/R-devel/library/base/html/cumsum.html)" 
> to link to the help page for cusum{base} and 
> "[KFAS](https://rweb.crmda.ku.edu/cran/web/packages/KFAS/KFAS.pdf)" to 
> link to the pdf documentation for the KFAS package.  This works, but it 
> feels like an ugly hack, and I wonder if there might be some more 
> elegant way of doing this (documented in a fine manual I have yet to find)?

You can include links that work only when R is displaying the help using
relative URLs like

../../base/help/cumsum

or

../../base/html/cumsum.html

(The former is like doing ?cumsum, i.e. it uses the alias; the latter
goes directly to a page by its name.)

The advantage of this kind of link is it doesn't need an Internet
connection, it works with the R help system; the disadvantage is that it
only works when the help system is running, so those links won't work in
the copy of your vignette on CRAN, for example.

Duncan Murdoch


From spencer.graves at prodsyse.com  Mon Oct 19 04:12:11 2015
From: spencer.graves at prodsyse.com (Spencer Graves)
Date: Sun, 18 Oct 2015 21:12:11 -0500
Subject: [Rd] Linking to documentation from a vignette using markdown?
In-Reply-To: <562444EE.7010900@gmail.com>
References: <56241474.7020203@prodsyse.com> <562444EE.7010900@gmail.com>
Message-ID: <5624517B.6060503@prodsyse.com>

Hi, Duncan:


On 10/18/2015 8:18 PM, Duncan Murdoch wrote:
> On 18/10/2015 5:51 PM, Spencer Graves wrote:
>> Hello:
>>
>>
>>         What's the preferred way to link to package documentation from a
>> vignette using markdown?
>>
>>
>>         My current draft includes
>> "[cumsum](https://stat.ethz.ch/R-manual/R-devel/library/base/html/cumsum.html)"
>> to link to the help page for cusum{base} and
>> "[KFAS](https://rweb.crmda.ku.edu/cran/web/packages/KFAS/KFAS.pdf)" to
>> link to the pdf documentation for the KFAS package.  This works, but it
>> feels like an ugly hack, and I wonder if there might be some more
>> elegant way of doing this (documented in a fine manual I have yet to find)?
> You can include links that work only when R is displaying the help using
> relative URLs like
>
> ../../base/help/cumsum
>
> or
>
> ../../base/html/cumsum.html
>
> (The former is like doing ?cumsum, i.e. it uses the alias; the latter
> goes directly to a page by its name.)
>
> The advantage of this kind of link is it doesn't need an Internet
> connection, it works with the R help system; the disadvantage is that it
> only works when the help system is running, so those links won't work in
> the copy of your vignette on CRAN, for example.


       Thanks.  I think I saw links like these reading html trying to 
find what I needed for [KFAS];  this helps me understand what I read.  I 
think I'd prefer having links that work in a pdf that I could pass to 
someone who may not have R installed.


       What's the easiest way to find links like the absolute web 
address I gave for [KFAS]?  It took me a couple of hours, because I 
couldn't find how to get more than "https://rweb.crmda.ku.edu/cran/" 
from any of my current web browsers (Safari, Chrome, and SeaMonkey on OS 
X 10.11, Internet Explorer, Chrome, FireFox and SeaMonkey under Windows 7).


       Thanks again,
       Spencer
>
> Duncan Murdoch


From maechler at stat.math.ethz.ch  Mon Oct 19 11:51:38 2015
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 19 Oct 2015 11:51:38 +0200
Subject: [Rd] R 3.2.2 64 bit compilation error on AIX
In-Reply-To: <CA+2DmwikBvv-cNeAuNzxv90Rj7wOjJwPP4n=Q5tf_btwtM9F5w@mail.gmail.com>
References: <CA+2Dmwg42NrchprLEOoSuVSyqtU8H6H2XLLUZYftGHG6-bfXyw@mail.gmail.com>
	<CA+2DmwiWo0RwSfS7eMQgXr_MxMN3UE76wCqspWysP-UghY0nSg@mail.gmail.com>
	<CA+2DmwgQEkZuCZCvyhudhY55rFznN6ddgeo=qVfx5bJO1AnGSg@mail.gmail.com>
	<CA+2DmwhY7Qo19JY-TMpR-oObDvkEEqzemVsoqhf9YV2B9W-mRw@mail.gmail.com>
	<22039.24695.462269.116657@stat.math.ethz.ch>
	<CA+2DmwikBvv-cNeAuNzxv90Rj7wOjJwPP4n=Q5tf_btwtM9F5w@mail.gmail.com>
Message-ID: <22052.48426.400517.915637@stat.math.ethz.ch>

>>>>> Vinh Nguyen <vinhdizzo at gmail.com>
>>>>>     on Fri, 9 Oct 2015 06:35:01 -0700 writes:

    > On Oct 8, 2015 11:36 PM, "Martin Maechler"
    > <maechler at stat.math.ethz.ch> wrote:
    >> 
    >> >>>>> Vinh Nguyen <vinhdizzo at gmail.com> >>>>> on Thu, 8
    >> Oct 2015 20:21:32 -0700 writes:
    >> 
    >> > Ahh, sorry for not googling the error message.  Found >
    >> [this](
    > http://r.789695.n4.nabble.com/Error-compiling-R-2-10-1-on-AIX-td1017862.html
    > )
    >> > post that suggests modifying
    >> /src/extra/tre/tre-internal.h > (
    > https://r-forge.r-project.org/scm/viewvc.php/patches/aix_R210_tre.patch?view=markup&root=aix
    > )
    >> > for AIX 64 bit.
    >> 
    >> > Is it possible to add this information to the AIX
    >> section > of the R-admin manual?  Thanks.
    >> 
    >> Actually, I think we (R Core) should just apply that
    >> patch to the R/src/extras/tre/ sources.

    > That should be even better!

I've heard no other comments,
tried a version of your patch and checked that it does *not*
break either 32-bit or 64-bit Linux.

At the same time, that (very old) patch looks sensible and
solves your problem and you are one of very few who actively
work on building R on AIX

==> I have committed a corresponding change to src/extra/tre/tre-internal.h
    now.  (for R-devel aka "trunk" only).

Martin Maechler, ETH Zurich
	
    >> 
    >> But this does not seem to be related to your original
    >> problem where compilation stopped during tools package
    >> building, or does it ?

    > Yes, the patch did fix the error where the tools package
    > was building. It also fixed it for [others](
    > http://r.789695.n4.nabble.com/Error-compiling-R-2-10-1-on-AIX-td1017862.html
    > ).

    > Thanks.


From murdoch.duncan at gmail.com  Mon Oct 19 12:08:14 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Mon, 19 Oct 2015 06:08:14 -0400
Subject: [Rd] Linking to documentation from a vignette using markdown?
In-Reply-To: <5624517B.6060503@prodsyse.com>
References: <56241474.7020203@prodsyse.com> <562444EE.7010900@gmail.com>
	<5624517B.6060503@prodsyse.com>
Message-ID: <5624C10E.60705@gmail.com>

On 18/10/2015 10:12 PM, Spencer Graves wrote:
> Hi, Duncan:
> 
> 
> On 10/18/2015 8:18 PM, Duncan Murdoch wrote:
>> On 18/10/2015 5:51 PM, Spencer Graves wrote:
>>> Hello:
>>>
>>>
>>>         What's the preferred way to link to package documentation from a
>>> vignette using markdown?
>>>
>>>
>>>         My current draft includes
>>> "[cumsum](https://stat.ethz.ch/R-manual/R-devel/library/base/html/cumsum.html)"
>>> to link to the help page for cusum{base} and
>>> "[KFAS](https://rweb.crmda.ku.edu/cran/web/packages/KFAS/KFAS.pdf)" to
>>> link to the pdf documentation for the KFAS package.  This works, but it
>>> feels like an ugly hack, and I wonder if there might be some more
>>> elegant way of doing this (documented in a fine manual I have yet to find)?
>> You can include links that work only when R is displaying the help using
>> relative URLs like
>>
>> ../../base/help/cumsum
>>
>> or
>>
>> ../../base/html/cumsum.html
>>
>> (The former is like doing ?cumsum, i.e. it uses the alias; the latter
>> goes directly to a page by its name.)
>>
>> The advantage of this kind of link is it doesn't need an Internet
>> connection, it works with the R help system; the disadvantage is that it
>> only works when the help system is running, so those links won't work in
>> the copy of your vignette on CRAN, for example.
> 
> 
>        Thanks.  I think I saw links like these reading html trying to 
> find what I needed for [KFAS];  this helps me understand what I read.  I 
> think I'd prefer having links that work in a pdf that I could pass to 
> someone who may not have R installed.
> 
> 
>        What's the easiest way to find links like the absolute web 
> address I gave for [KFAS]?  It took me a couple of hours, because I 
> couldn't find how to get more than "https://rweb.crmda.ku.edu/cran/" 
> from any of my current web browsers (Safari, Chrome, and SeaMonkey on OS 
> X 10.11, Internet Explorer, Chrome, FireFox and SeaMonkey under Windows 7).
> 

CRAN uses frames, so the displayed address is the outer frame, but
different parts of the display come from different pages, which is why
the address bar doesn't change.  But you can still find the real link.
In Firefox you right click on the link and choose "Copy Link Location".
 I assume other browsers have similar methods.

BTW, I'd recommend using the "Cloud" mirror; it will be fastest for the
majority of users, not just those near ku.edu.

Duncan Murdoch


From dmccully at mail.nih.gov  Mon Oct 19 14:07:29 2015
From: dmccully at mail.nih.gov (McCully, Dwayne (NIH/NIAMS) [C])
Date: Mon, 19 Oct 2015 12:07:29 +0000
Subject: [Rd] R 3.2.2 - make check and install package hang
In-Reply-To: <CAK1hC9s6--YC0mOsp50aeCDk2yxtf3GSaYksGjVpQfhOXK69BQ@mail.gmail.com>
References: <432A8E6B26DC62439F0201C069BE2B673F0E70F9@msgb06.nih.gov>
	<432A8E6B26DC62439F0201C069BE2B673F0E72F4@msgb06.nih.gov>
	<CAK1hC9s6--YC0mOsp50aeCDk2yxtf3GSaYksGjVpQfhOXK69BQ@mail.gmail.com>
Message-ID: <432A8E6B26DC62439F0201C069BE2B673F0EEA10@msgb06.nih.gov>

Below is the output.   Thanks for the help. 

> Sys.getenv()
BASH_FUNC_module()      () { eval
                        `/cm/local/apps/environment-modules/3.2.10/Modules/$MODULE_VERSION/bin/modulecmd
                        bash $*` }
COLUMNS                 152
CPATH                   /cm/shared/apps/uge/8.2.1/include
CVS_RSH                 ssh
DISPLAY                 localhost:10.0
EDITOR                  vi
G_BROKEN_FILENAMES      1
HISTCONTROL             ignoredups
HISTSIZE                1000
HOME                    /root
HOSTNAME                test
LANG                    en_US.UTF-8
LD_LIBRARY_PATH         /cm/shared/apps/R/3.2.1/lib64/R/lib:/usr/local/lib64:/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre/lib/amd64/server:/cm/shared/apps/uge/8.2.1/lib/lx-amd64
LESSOPEN                ||/usr/bin/lesspipe.sh %s
LINES                   48
_LMFILES_               /cm/local/modulefiles/shared:/cm/shared/modulefiles/uge/8.2.1:/cm/local/modulefiles/cmsh:/cm/local/modulefiles/cmd:/cm/local/modulefiles/cluster-tools/7.1:/cm/shared/modulefiles/cmgui/7.1:/cm/shared/modulefiles/R/3.2.1
LN_S                    ln -s
LOADEDMODULES           shared:uge/8.2.1:cmsh:cmd:cluster-tools/7.1:cmgui/7.1:R/3.2.1
LOGNAME                 root
LS_COLORS               rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;05;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arj=01;31:*.taz=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lz=01;31:*.xz=01;31:*.bz2=01;31:*.tbz=01;31:*.tbz2=01;31:*.bz=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.rar=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.jpg=01;35:*.jpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.axv=01;35:*.anx=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.axa=01;36:*.oga=01;36:*.spx=01;36:*.xspf=01;36:
MAIL                    /var/spool/mail/root
MAKE                    make
MANPATH                 /cm/local/apps/cluster-tools/man:/cm/local/apps/cmd/man:/cm/shared/apps/uge/8.2.1/man:/usr/share/centrifydc/man:/usr/local/share/man:/usr/share/man/overrides:/usr/share/man/en:/usr/share/man:/cm/local/apps/environment-modules/current/share/man
MINICOM                 -t ansi-generic
MODULEPATH              /cm/local/modulefiles:/cm/shared/modulefiles
MODULESHOME             /cm/local/apps/environment-modules/3.2.10/Modules/3.2.10
MODULE_VERSION          3.2.10
MODULE_VERSION_STACK    3.2.10
NXDIR                   /usr/NX
PAGER                   /usr/bin/less
PATH                    /cm/shared/apps/R/3.2.1/bin:/cm/shared/apps/cmgui:/cm/local/apps/cluster-tools/bin:/cm/local/apps/cmd/sbin:/cm/local/apps/cmd/bin:/cm/shared/apps/uge/8.2.1/bin/lx-amd64:/usr/lib64/qt-3.3/bin:/usr/share/centrifydc/sbin:/usr/share/centrifydc/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/cm/local/apps/environment-modules/3.2.10/bin:/usr/NX/bin:/opt/dell/srvadmin/bin:/opt/dell/srvadmin/sbin:/root/bin
PWD                     /root
QTDIR                   /usr/lib64/qt-3.3
QTINC                   /usr/lib64/qt-3.3/include
QTLIB                   /usr/lib64/qt-3.3/lib
R_ARCH
R_BROWSER               /usr/bin/firefox
R_BZIPCMD               /usr/bin/bzip2
R_DOC_DIR               /cm/shared/apps/R/3.2.1/lib64/R/doc
R_GZIPCMD               /bin/gzip
R_HOME                  /cm/shared/apps/R/3.2.1/lib64/R
R_INCLUDE_DIR           /cm/shared/apps/R/3.2.1/lib64/R/include
R_LIBS_SITE
R_LIBS_USER             ~/R/x86_64-unknown-linux-gnu-library/3.2
R_PAPERSIZE             a4
R_PDFVIEWER             /usr/bin/xdg-open
R_PLATFORM              x86_64-unknown-linux-gnu
R_PRINTCMD              lpr
R_RD4PDF                times,hyper
R_SESSION_TMPDIR        /tmp/Rtmphn5m15
R_SHARE_DIR             /cm/shared/apps/R/3.2.1/lib64/R/share
R_SYSTEM_ABI            linux,gcc,gxx,gfortran,?
R_TEXI2DVICMD           /usr/bin/texi2dvi
R_UNZIPCMD              /usr/bin/unzip
R_ZIPCMD                /usr/bin/zip
SED                     /bin/sed
SGE_ROOT                /cm/shared/apps/uge/8.2.1
SHELL                   /bin/bash
SHLVL                   1
SSH_ASKPASS             /usr/libexec/openssh/gnome-ssh-askpass
TAR                     /bin/gtar
TERM                    xterm
USER                    root
XAUTHORITY              /root/.xauthtGhzUe

-----Original Message-----
From: arnaud gaboury [mailto:arnaud.gaboury at gmail.com] 
Sent: Saturday, October 17, 2015 5:44 PM
To: McCully, Dwayne (NIH/NIAMS) [C] <dmccully at mail.nih.gov>
Cc: r-devel at r-project.org
Subject: Re: [Rd] R 3.2.2 - make check and install package hang

On Sat, Oct 17, 2015 at 9:04 PM, McCully, Dwayne (NIH/NIAMS) [C] <dmccully at mail.nih.gov> wrote:
> Hello Everyone,
>
> After trying several ways to compile R 3.2.2 without luck, I?m reaching out for help.
> The ?make check? does not hanges for some reason and when trying to 
> install a package it cannot list the download sites (see below).
>
> What could be the problem?

Maybe your exisiting environment variable. Is R already installed? If yes, please post output of the followning command in a R session:

> Sys.getenv()




>
>
> ./configure --enable-R-shlib --enable-BLAS-shlib
>
> hostname = test
> uname -m = x86_64
> uname -r = 2.6.32-573.7.1.el6.x86_64
> uname -s = Linux
> uname -v = #1 SMP Thu Sep 10 13:42:16 EDT 2015
> OS: Red Hat 6.7
>
> configuring Java ...
> Java interpreter : /usr/bin/java
> Java version     : 1.7.0_85
> Java home path   : /usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre
> Java compiler    : /usr/bin/javac
> Java headers gen.: /usr/bin/javah
> Java archive tool: /usr/bin/jar
>
> trying to compile and link a JNI program
> detected JNI cpp flags    : -I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux
> detected JNI linker flags : -L$(JAVA_HOME)/lib/amd64/server -ljvm
> make[2]: Entering directory `/tmp/Rjavareconf.lcq59l'
> gcc -std=gnu99 -I/home/dmccully/R-3.2.2/include -DNDEBUG -I/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre/../include -I/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre/../include/linux -I/usr/local/include    -fpic  -g -O2  -c conftest.c -o conftest.o
> gcc -std=gnu99 -shared -L/home/dmccully/R-3.2.2/lib -L/usr/local/lib64 
> -o conftest.so conftest.o 
> -L/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre/lib/amd64/server 
> -ljvm -L/home/dmccully/R-3.2.2/lib -lR
> make[2]: Leaving directory `/tmp/Rjavareconf.lcq59l'
>
>
> JAVA_HOME        : /usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre
> Java library path: $(JAVA_HOME)/lib/amd64/server
> JNI cpp flags    : -I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux
> JNI linker flags : -L$(JAVA_HOME)/lib/amd64/server -ljvm Updating Java 
> configuration in /home/dmccully/R-3.2.2 Done.
>
> make[1]: Leaving directory `/home/dmccully/R-3.2.2'
> [root at test R-3.2.2]# pwd
> /home/dmccully/R-3.2.2
> [root at test R-3.2.2]# make check
> make[1]: Entering directory `/home/dmccully/R-3.2.2/tests'
> make[2]: Entering directory `/home/dmccully/R-3.2.2/tests'
> make[3]: Entering directory `/home/dmccully/R-3.2.2/tests/Examples'
> Testing examples for package ?base?
>
>
>> install.packages("ggplot2")
> --- Please select a CRAN mirror for use in this session ---
>
>         [[alternative HTML version deleted]]
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 

google.com/+arnaudgabourygabx

From dmccully at mail.nih.gov  Mon Oct 19 15:15:30 2015
From: dmccully at mail.nih.gov (McCully, Dwayne (NIH/NIAMS) [C])
Date: Mon, 19 Oct 2015 13:15:30 +0000
Subject: [Rd] R 3.2.2 - make check and install package hang
In-Reply-To: <432A8E6B26DC62439F0201C069BE2B673F0EEA10@msgb06.nih.gov>
References: <432A8E6B26DC62439F0201C069BE2B673F0E70F9@msgb06.nih.gov>
	<432A8E6B26DC62439F0201C069BE2B673F0E72F4@msgb06.nih.gov>
	<CAK1hC9s6--YC0mOsp50aeCDk2yxtf3GSaYksGjVpQfhOXK69BQ@mail.gmail.com>
	<432A8E6B26DC62439F0201C069BE2B673F0EEA10@msgb06.nih.gov>
Message-ID: <432A8E6B26DC62439F0201C069BE2B673F0EFAAB@msgb06.nih.gov>

When running the "make check"

14736 14735  0 09:03 pts/1    00:00:00 /bin/sh -c echo "tools::testInstalledPackages(scope='base', types='examples', srcdir=\".\", commentDonttest=!FALSE)" | LANGUAGE=
14738 14736  0 09:03 pts/1    00:00:03 /home/test/R-3.2.2/bin/exec/R --slave --vanilla
14740 14738  0 09:03 pts/1    00:00:00 sh /home/test/R-3.2.2/bin/Rcmd BATCH --vanilla --no-timing base-Ex.R base-Ex.Rout.fail
14743 14740  0 09:03 pts/1    00:00:03 /home/test/R-3.2.2/bin/exec/R -f base-Ex.R --restore --save --no-readline --vanilla

It just sits at "capabilities()" by viewing the file base-Ex.Rout.fail

[test at test ~]$ tail -f ./R-3.2.2/tests/Examples/base-Ex.Rout.fail
> flush(stderr()); flush(stdout())
>
> ### Name: capabilities
> ### Title: Report Capabilities of this Build of R
> ### Aliases: capabilities
> ### Keywords: utilities
>
> ### ** Examples
>
> capabilities()

-----Original Message-----
From: McCully, Dwayne (NIH/NIAMS) [C] 
Sent: Monday, October 19, 2015 8:07 AM
To: 'arnaud gaboury' <arnaud.gaboury at gmail.com>
Cc: r-devel at r-project.org
Subject: RE: [Rd] R 3.2.2 - make check and install package hang

Below is the output.   Thanks for the help. 

> Sys.getenv()
BASH_FUNC_module()      () { eval
                        `/cm/local/apps/environment-modules/3.2.10/Modules/$MODULE_VERSION/bin/modulecmd
                        bash $*` }
COLUMNS                 152
CPATH                   /cm/shared/apps/uge/8.2.1/include
CVS_RSH                 ssh
DISPLAY                 localhost:10.0
EDITOR                  vi
G_BROKEN_FILENAMES      1
HISTCONTROL             ignoredups
HISTSIZE                1000
HOME                    /root
HOSTNAME                test
LANG                    en_US.UTF-8
LD_LIBRARY_PATH         /cm/shared/apps/R/3.2.1/lib64/R/lib:/usr/local/lib64:/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre/lib/amd64/server:/cm/shared/apps/uge/8.2.1/lib/lx-amd64
LESSOPEN                ||/usr/bin/lesspipe.sh %s
LINES                   48
_LMFILES_               /cm/local/modulefiles/shared:/cm/shared/modulefiles/uge/8.2.1:/cm/local/modulefiles/cmsh:/cm/local/modulefiles/cmd:/cm/local/modulefiles/cluster-tools/7.1:/cm/shared/modulefiles/cmgui/7.1:/cm/shared/modulefiles/R/3.2.1
LN_S                    ln -s
LOADEDMODULES           shared:uge/8.2.1:cmsh:cmd:cluster-tools/7.1:cmgui/7.1:R/3.2.1
LOGNAME                 root
LS_COLORS               rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;05;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arj=01;31:*.taz=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lz=01;31:*.xz=01;31:*.bz2=01;31:*.tbz=01;31:*.tbz2=01;31:*.bz=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.rar=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.jpg=01;35:*.jpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.axv=01;35:*.anx=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.axa=01;36:*.oga=01;36:*.spx=01;36:*.xspf=01;36:
MAIL                    /var/spool/mail/root
MAKE                    make
MANPATH                 /cm/local/apps/cluster-tools/man:/cm/local/apps/cmd/man:/cm/shared/apps/uge/8.2.1/man:/usr/share/centrifydc/man:/usr/local/share/man:/usr/share/man/overrides:/usr/share/man/en:/usr/share/man:/cm/local/apps/environment-modules/current/share/man
MINICOM                 -t ansi-generic
MODULEPATH              /cm/local/modulefiles:/cm/shared/modulefiles
MODULESHOME             /cm/local/apps/environment-modules/3.2.10/Modules/3.2.10
MODULE_VERSION          3.2.10
MODULE_VERSION_STACK    3.2.10
NXDIR                   /usr/NX
PAGER                   /usr/bin/less
PATH                    /cm/shared/apps/R/3.2.1/bin:/cm/shared/apps/cmgui:/cm/local/apps/cluster-tools/bin:/cm/local/apps/cmd/sbin:/cm/local/apps/cmd/bin:/cm/shared/apps/uge/8.2.1/bin/lx-amd64:/usr/lib64/qt-3.3/bin:/usr/share/centrifydc/sbin:/usr/share/centrifydc/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/cm/local/apps/environment-modules/3.2.10/bin:/usr/NX/bin:/opt/dell/srvadmin/bin:/opt/dell/srvadmin/sbin:/root/bin
PWD                     /root
QTDIR                   /usr/lib64/qt-3.3
QTINC                   /usr/lib64/qt-3.3/include
QTLIB                   /usr/lib64/qt-3.3/lib
R_ARCH
R_BROWSER               /usr/bin/firefox
R_BZIPCMD               /usr/bin/bzip2
R_DOC_DIR               /cm/shared/apps/R/3.2.1/lib64/R/doc
R_GZIPCMD               /bin/gzip
R_HOME                  /cm/shared/apps/R/3.2.1/lib64/R
R_INCLUDE_DIR           /cm/shared/apps/R/3.2.1/lib64/R/include
R_LIBS_SITE
R_LIBS_USER             ~/R/x86_64-unknown-linux-gnu-library/3.2
R_PAPERSIZE             a4
R_PDFVIEWER             /usr/bin/xdg-open
R_PLATFORM              x86_64-unknown-linux-gnu
R_PRINTCMD              lpr
R_RD4PDF                times,hyper
R_SESSION_TMPDIR        /tmp/Rtmphn5m15
R_SHARE_DIR             /cm/shared/apps/R/3.2.1/lib64/R/share
R_SYSTEM_ABI            linux,gcc,gxx,gfortran,?
R_TEXI2DVICMD           /usr/bin/texi2dvi
R_UNZIPCMD              /usr/bin/unzip
R_ZIPCMD                /usr/bin/zip
SED                     /bin/sed
SGE_ROOT                /cm/shared/apps/uge/8.2.1
SHELL                   /bin/bash
SHLVL                   1
SSH_ASKPASS             /usr/libexec/openssh/gnome-ssh-askpass
TAR                     /bin/gtar
TERM                    xterm
USER                    root
XAUTHORITY              /root/.xauthtGhzUe

-----Original Message-----
From: arnaud gaboury [mailto:arnaud.gaboury at gmail.com]
Sent: Saturday, October 17, 2015 5:44 PM
To: McCully, Dwayne (NIH/NIAMS) [C] <dmccully at mail.nih.gov>
Cc: r-devel at r-project.org
Subject: Re: [Rd] R 3.2.2 - make check and install package hang

On Sat, Oct 17, 2015 at 9:04 PM, McCully, Dwayne (NIH/NIAMS) [C] <dmccully at mail.nih.gov> wrote:
> Hello Everyone,
>
> After trying several ways to compile R 3.2.2 without luck, I?m reaching out for help.
> The ?make check? does not hanges for some reason and when trying to 
> install a package it cannot list the download sites (see below).
>
> What could be the problem?

Maybe your exisiting environment variable. Is R already installed? If yes, please post output of the followning command in a R session:

> Sys.getenv()




>
>
> ./configure --enable-R-shlib --enable-BLAS-shlib
>
> hostname = test
> uname -m = x86_64
> uname -r = 2.6.32-573.7.1.el6.x86_64
> uname -s = Linux
> uname -v = #1 SMP Thu Sep 10 13:42:16 EDT 2015
> OS: Red Hat 6.7
>
> configuring Java ...
> Java interpreter : /usr/bin/java
> Java version     : 1.7.0_85
> Java home path   : /usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre
> Java compiler    : /usr/bin/javac
> Java headers gen.: /usr/bin/javah
> Java archive tool: /usr/bin/jar
>
> trying to compile and link a JNI program
> detected JNI cpp flags    : -I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux
> detected JNI linker flags : -L$(JAVA_HOME)/lib/amd64/server -ljvm
> make[2]: Entering directory `/tmp/Rjavareconf.lcq59l'
> gcc -std=gnu99 -I/home/dmccully/R-3.2.2/include -DNDEBUG -I/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre/../include -I/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre/../include/linux -I/usr/local/include    -fpic  -g -O2  -c conftest.c -o conftest.o
> gcc -std=gnu99 -shared -L/home/dmccully/R-3.2.2/lib -L/usr/local/lib64 
> -o conftest.so conftest.o 
> -L/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre/lib/amd64/server
> -ljvm -L/home/dmccully/R-3.2.2/lib -lR
> make[2]: Leaving directory `/tmp/Rjavareconf.lcq59l'
>
>
> JAVA_HOME        : /usr/lib/jvm/java-1.7.0-openjdk-1.7.0.85.x86_64/jre
> Java library path: $(JAVA_HOME)/lib/amd64/server
> JNI cpp flags    : -I$(JAVA_HOME)/../include -I$(JAVA_HOME)/../include/linux
> JNI linker flags : -L$(JAVA_HOME)/lib/amd64/server -ljvm Updating Java 
> configuration in /home/dmccully/R-3.2.2 Done.
>
> make[1]: Leaving directory `/home/dmccully/R-3.2.2'
> [root at test R-3.2.2]# pwd
> /home/dmccully/R-3.2.2
> [root at test R-3.2.2]# make check
> make[1]: Entering directory `/home/dmccully/R-3.2.2/tests'
> make[2]: Entering directory `/home/dmccully/R-3.2.2/tests'
> make[3]: Entering directory `/home/dmccully/R-3.2.2/tests/Examples'
> Testing examples for package ?base?
>
>
>> install.packages("ggplot2")
> --- Please select a CRAN mirror for use in this session ---
>
>         [[alternative HTML version deleted]]
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 

google.com/+arnaudgabourygabx

From nilsson.henric at gmail.com  Tue Oct 20 16:26:02 2015
From: nilsson.henric at gmail.com (Henric Winell)
Date: Tue, 20 Oct 2015 16:26:02 +0200
Subject: [Rd] rank(, ties.method="last")
In-Reply-To: <22039.37791.6045.955899@stat.math.ethz.ch>
References: <CAM3-KjZ=d1a4sUFckw83RZu-phZffY7KvZeQ1WtAjNB6ysoeJw@mail.gmail.com>
	<22039.37791.6045.955899@stat.math.ethz.ch>
Message-ID: <56264EFA.80402@gmail.com>

Den 2015-10-09 kl. 12:14, skrev Martin Maechler:
>
>> I ran into a problem where I actually need rank(, ties.method="last"). It would
>> be great to have this feature in base and it's also simple to get (see below).
>
>> Thanks & cheers,
>> Marius
>
>
>> rank2 <- function (x, na.last = TRUE, ties.method = c("average",
>> "first", "last", # new "last"
>>      "random", "max", "min"))
>> {
>>      nas <- is.na(x)
>>      nm <- names(x)
>>      ties.method <- match.arg(ties.method)
>>      if (is.factor(x))
>>          x <- as.integer(x)
>>      x <- x[!nas]
>>      y <- switch(ties.method, average = , min = , max = .Internal(rank(x,
>>          length(x), ties.method)), first = sort.list(sort.list(x)),
>>          last = sort.list(sort.list(x, decreasing=TRUE), decreasing=TRUE), # change
>>          random = sort.list(order(x, stats::runif(sum(!nas)))))
>>      if (!is.na(na.last) && any(nas)) {
>>          yy <- NA
>>          NAkeep <- (na.last == "keep")
>>          if (NAkeep || na.last) {
>>              yy[!nas] <- y
>>              if (!NAkeep)
>>                  yy[nas] <- (length(y) + 1L):length(yy)
>>          }
>>          else {
>>              len <- sum(nas)
>>              yy[!nas] <- y + len
>>              yy[nas] <- seq_len(len)
>>          }
>>          y <- yy
>>          names(y) <- nm
>>      }
>>      else names(y) <- nm[!nas]
>>      y
>> }
>
>> ## MWE
>> x <- c(10, 11, 11, 12, 12, 13)
>> rank(x, ties.method="first")
>> rank2(x, ties.method="last")
>
> Indeed, this makes sense to me, and is easy enough to document
> and maintain, and preferable to asking useRs to use  rev(.) and
> similar "easy" (but somewhat costly for large data!)
> transformations to get the same....
>
> Or have (Marius Hofert and I) overlooked something obvious ?

I think so: the code above doesn't seem to do the right thing.  Consider 
the following example:

 > x <- c(1, 1, 2, 3)
 > rank2(x, ties.method = "last")
[1] 1 2 4 3

That doesn't look right to me -- I had expected

 > rev(sort.list(x, decreasing = TRUE))
[1] 2 1 3 4


Henric Winell



>
> Martin Maechler,
> ETH Zurich
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From marius.hofert at uwaterloo.ca  Tue Oct 20 16:46:13 2015
From: marius.hofert at uwaterloo.ca (Marius Hofert)
Date: Tue, 20 Oct 2015 10:46:13 -0400
Subject: [Rd] rank(, ties.method="last")
In-Reply-To: <9fb44acc43d54762ae2f0795872d4881@CONNHUB1.connect.uwaterloo.ca>
References: <CAM3-KjZ=d1a4sUFckw83RZu-phZffY7KvZeQ1WtAjNB6ysoeJw@mail.gmail.com>
	<22039.37791.6045.955899@stat.math.ethz.ch>
	<9fb44acc43d54762ae2f0795872d4881@CONNHUB1.connect.uwaterloo.ca>
Message-ID: <CAM3-KjY5+Luf5Jp_9Os_UXuJgdCZ+CqE1Wh+4BYPtyp+JKDzxQ@mail.gmail.com>

On Tue, Oct 20, 2015 at 10:26 AM, Henric Winell
<nilsson.henric at gmail.com> wrote:
> Den 2015-10-09 kl. 12:14, skrev Martin Maechler:
> I think so: the code above doesn't seem to do the right thing.  Consider
> the following example:
>
>  > x <- c(1, 1, 2, 3)
>  > rank2(x, ties.method = "last")
> [1] 1 2 4 3
>
> That doesn't look right to me -- I had expected
>
>  > rev(sort.list(x, decreasing = TRUE))
> [1] 2 1 3 4
>

Indeed, well spotted, that seems to be correct.

>
> Henric Winell
>


From h.wickham at gmail.com  Tue Oct 20 17:39:11 2015
From: h.wickham at gmail.com (Hadley Wickham)
Date: Tue, 20 Oct 2015 10:39:11 -0500
Subject: [Rd] Conditional importFrom (roxygen?)
In-Reply-To: <5611BBC4.2030307@gmail.com>
References: <CABG0rfu+kdrgWsyQPyJf-Twm2ostSCsMi7vbzR5br9LoPtmbLw@mail.gmail.com>
	<5611526D.7080508@gmail.com> <loom.20151005T013053-407@post.gmane.org>
	<5611BBC4.2030307@gmail.com>
Message-ID: <CABdHhvFU4EmK7snFZ4ty0GYkqL-XCovXUc3Y8nzYkA8RyA4Giw@mail.gmail.com>

>> This has been submitted as an issue at
>>
>> https://github.com/klutometis/roxygen/issues/378
>>
>> closely related:
>>
>> https://github.com/klutometis/roxygen/issues/371
>>
>> my current hacky solution to this is to use a Makefile that
>> post-processes the NAMESPACE after it's roxygenized, e.g. search
>> for "getRversion" in
>>
>> https://github.com/glmmTMB/glmmTMB/blob/master/Makefile
>
> Hadley has the right idea (allow roxygen to specify some uninterpreted
> text to drop into the NAMESPACE file), but it doesn't go far enough.
> Really this is a design flaw in roxygen:  being able to enter NAMESPACE
> and help page info in source files is a great feature, but being forced
> to go all or nothing is a flaw.
>
> If base R adds something new to the NAMESPACE or .Rd files (or has some
> obscure feature that roxygen authors didn't notice), it's really hard
> for roxygen users to make use of it.

It should much easier in the dev version - you can use @rawRd and
@rawNamespace to insert literal Rd code and NAMESPACE directives
without any interpretation by roxygen.

> A better design would be to allow content from both sources:  some
> manually entered NAMESPACE stuff, and some automatically generated stuff.

I think you can now mostly do this - it might be possible to do more
intermingling, but it starts to get really hard to figure out which is
the authoritative version and to respond usefully to conflicts. I'm
not opposed to the idea, but it's a hard problem and unfortunately not
very high on my priority list.

> A really nice design would be to read the manually entered stuff and
> show (some of?) it in the .R files, but that would be really tricky to
> get right.  I think it would need to be supported by a GUI, it wouldn't
> be reasonable to expect people to type it all properly in a dumb editor.
>  Maybe Hadley knows someone who has written a GUI?

Nope, sorry :P

More seriously, again I think it would be possible, and it's not that
I'm opposed to it, but realistically, it's unlikely to ever get high
enough up our priority list to get implemented.

Hadley

-- 
http://had.co.nz/


From suharto_anggono at yahoo.com  Wed Oct 21 07:24:05 2015
From: suharto_anggono at yahoo.com (Suharto Anggono Suharto Anggono)
Date: Tue, 20 Oct 2015 22:24:05 -0700
Subject: [Rd] rank(, ties.method="last")
Message-ID: <1445405045.40045.YahooMailBasic@web125103.mail.ne1.yahoo.com>

Marius Hofert-4------------------------------
> Den 2015-10-09 kl. 12:14, skrev Martin Maechler:
> I think so: the code above doesn't seem to do the right thing.  Consider
> the following example:
>
>  > x <- c(1, 1, 2, 3)
>  > rank2(x, ties.method = "last")
> [1] 1 2 4 3
>
> That doesn't look right to me -- I had expected
>
>  > rev(sort.list(x, decreasing = TRUE))
> [1] 2 1 3 4
>

Indeed, well spotted, that seems to be correct.

>
> Henric Winell
> 
------------------------------

In the particular example (of length 4), what is really wanted is the following.
ind <- integer(4)
ind[sort.list(x, decreasing=TRUE)] <- 4:1
ind

The following gives the desired result:
sort.list(rev(sort.list(x, decreasing=TRUE)))


From nilsson.henric at gmail.com  Wed Oct 21 13:43:02 2015
From: nilsson.henric at gmail.com (Henric Winell)
Date: Wed, 21 Oct 2015 13:43:02 +0200
Subject: [Rd] rank(, ties.method="last")
In-Reply-To: <1445405045.40045.YahooMailBasic@web125103.mail.ne1.yahoo.com>
References: <1445405045.40045.YahooMailBasic@web125103.mail.ne1.yahoo.com>
Message-ID: <56277A46.60405@gmail.com>

Den 2015-10-21 kl. 07:24, skrev Suharto Anggono Suharto Anggono via R-devel:

> Marius Hofert-4------------------------------
>> Den 2015-10-09 kl. 12:14, skrev Martin Maechler:
>> I think so: the code above doesn't seem to do the right thing.  Consider
>> the following example:
>>
>>   > x <- c(1, 1, 2, 3)
>>   > rank2(x, ties.method = "last")
>> [1] 1 2 4 3
>>
>> That doesn't look right to me -- I had expected
>>
>>   > rev(sort.list(x, decreasing = TRUE))
>> [1] 2 1 3 4
>>
>
> Indeed, well spotted, that seems to be correct.
>
>>
>> Henric Winell
>>
> ------------------------------
>
> In the particular example (of length 4), what is really wanted is the following.
> ind <- integer(4)
> ind[sort.list(x, decreasing=TRUE)] <- 4:1
> ind

You don't provide the output here, but 'ind' is, of course,

 > ind
[1] 2 1 3 4

> The following gives the desired result:
> sort.list(rev(sort.list(x, decreasing=TRUE)))

And, again, no output, but

 > sort.list(rev(sort.list(x, decreasing=TRUE)))
[1] 2 1 3 4

Why is it necessary to use 'sort.list' on the result from 
'rev(sort.list(...'?


Henric Winell



>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From maechler at stat.math.ethz.ch  Wed Oct 21 18:06:50 2015
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 21 Oct 2015 18:06:50 +0200
Subject: [Rd] rank(, ties.method="last")
In-Reply-To: <56277A46.60405@gmail.com>
References: <1445405045.40045.YahooMailBasic@web125103.mail.ne1.yahoo.com>
	<56277A46.60405@gmail.com>
Message-ID: <22055.47130.499000.330314@stat.math.ethz.ch>

>>>>> Henric Winell <nilsson.henric at gmail.com>
>>>>>     on Wed, 21 Oct 2015 13:43:02 +0200 writes:

    > Den 2015-10-21 kl. 07:24, skrev Suharto Anggono Suharto Anggono via R-devel:
    >> Marius Hofert-4------------------------------
    >>> Den 2015-10-09 kl. 12:14, skrev Martin Maechler:
    >>> I think so: the code above doesn't seem to do the right thing.  Consider
    >>> the following example:
    >>> 
    >>> > x <- c(1, 1, 2, 3)
    >>> > rank2(x, ties.method = "last")
    >>> [1] 1 2 4 3
    >>> 
    >>> That doesn't look right to me -- I had expected
    >>> 
    >>> > rev(sort.list(x, decreasing = TRUE))
    >>> [1] 2 1 3 4
    >>> 
    >> 
    >> Indeed, well spotted, that seems to be correct.
    >> 
    >>> 
    >>> Henric Winell
    >>> 
    >> ------------------------------
    >> 
    >> In the particular example (of length 4), what is really wanted is the following.
    >> ind <- integer(4)
    >> ind[sort.list(x, decreasing=TRUE)] <- 4:1
    >> ind

    > You don't provide the output here, but 'ind' is, of course,

    >> ind
    > [1] 2 1 3 4

    >> The following gives the desired result:
    >> sort.list(rev(sort.list(x, decreasing=TRUE)))

    > And, again, no output, but

    >> sort.list(rev(sort.list(x, decreasing=TRUE)))
    > [1] 2 1 3 4

    > Why is it necessary to use 'sort.list' on the result from 
    > 'rev(sort.list(...'?

You can try all kind of code on this *too* simple example and do
experiments.  But let's approach this a bit more scientifically
and hence systematically:

Look at  rank  {the R function definition} to see that
for the case of no NA's,

 rank(x, ties.method = "first')   ===    sort.list(sort.list(x))

If you assume that to be correct and want to define "last" to be
correct as well (in the sense of being  "first"-consistent), 
it is clear that

  rank(x, ties.method = "last)   ===  rev(sort.list(sort.list(rev(x))))

must also be correct.  I don't think that *any* of the proposals
so far had a correct version [but the too simplistic examples
did not show the problems].

In  R-devel (the R development) version of today, i.e., svn
revision >= 69549, the implementation of  ties.method = "last'
uses
        ## == rev(sort.list(sort.list(rev(x)))) :
        if(length(x) == 0) integer(0)
        else { i <- length(x):1L
               sort.list(sort.list(x[i]))[i] },

which is equivalent to using rev() but a bit more efficient.

Martin Maechler, ETH Zurich


From h.wickham at gmail.com  Wed Oct 21 23:57:45 2015
From: h.wickham at gmail.com (Hadley Wickham)
Date: Wed, 21 Oct 2015 16:57:45 -0500
Subject: [Rd] Confusing print method for Inf dates
Message-ID: <CABdHhvGAUA_D6t2MB6xWr-B5EWeTxB+kELNDTTzuTyC3-AdzhA@mail.gmail.com>

x <- as.Date(Inf, origin = "1970-01-01")
x
#> [1] NA
str(x)
#>  Date[1:1], format: NA
unclass(x)
#> [1] Inf

It's not clear what the correct behaviour is. The documentation for
?Date has: "It is intended that the date should be an integer,", which
suggests that -Inf and Inf are not valid dates. But if that's true the
behaviour for max.Date() needs some thought:

max(as.Date(NA), na.rm = TRUE)
#> Warning in max.default(structure(NA_real_, class = "Date"), na.rm = TRUE):
#> no non-missing arguments to max; returning -Inf
#> [1] NA

If dates are integers, then there is no date that is smaller than all
other dates, so it's not clear what max() should return - NA?

Hadley

-- 
http://had.co.nz/


From josh.m.ulrich at gmail.com  Thu Oct 22 00:18:03 2015
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 21 Oct 2015 17:18:03 -0500
Subject: [Rd] Confusing print method for Inf dates
In-Reply-To: <CABdHhvGAUA_D6t2MB6xWr-B5EWeTxB+kELNDTTzuTyC3-AdzhA@mail.gmail.com>
References: <CABdHhvGAUA_D6t2MB6xWr-B5EWeTxB+kELNDTTzuTyC3-AdzhA@mail.gmail.com>
Message-ID: <CAPPM_gQg9ZCDdYDY_Xy-arrgqLTsgZ5UW=q-47Sm5afHLoTLjg@mail.gmail.com>

On Wed, Oct 21, 2015 at 4:57 PM, Hadley Wickham <h.wickham at gmail.com> wrote:
> x <- as.Date(Inf, origin = "1970-01-01")
> x
> #> [1] NA
> str(x)
> #>  Date[1:1], format: NA
> unclass(x)
> #> [1] Inf
>
> It's not clear what the correct behaviour is. The documentation for
> ?Date has: "It is intended that the date should be an integer,", which
> suggests that -Inf and Inf are not valid dates. But if that's true the

You omitted the second half of the sentence, which contains important
information.  The entire sentence is, "It is intended that the date
should be an integer, but this is not enforced in the internal
representation."  Since it's not enforced internally, it doesn't
necessarily follow that non-integer values are invalid dates.  The
rest of the paragraph describes how fractional (internal) dates can be
created.

Both ?format.Date and ?strptime say that 'NA' dates/times are printed
as NA_character_.  It might be clearer to say that "invalid"
dates/times are printed as NA_character_.

> behaviour for max.Date() needs some thought:
>
> max(as.Date(NA), na.rm = TRUE)
> #> Warning in max.default(structure(NA_real_, class = "Date"), na.rm = TRUE):
> #> no non-missing arguments to max; returning -Inf
> #> [1] NA
>
> If dates are integers, then there is no date that is smaller than all
> other dates, so it's not clear what max() should return - NA?
>
But they're not integers in the strict sense.

> Hadley
>
> --
> http://had.co.nz/
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com


From suharto_anggono at yahoo.com  Thu Oct 22 07:44:57 2015
From: suharto_anggono at yahoo.com (Suharto Anggono Suharto Anggono)
Date: Wed, 21 Oct 2015 22:44:57 -0700
Subject: [Rd] (no subject)
Message-ID: <1445492697.62360.YahooMailBasic@web125103.mail.ne1.yahoo.com>

------------------
>>>>> Henric Winell <[hidden email]>
>>>>>     on Wed, 21 Oct 2015 13:43:02 +0200 writes:

    > Den 2015-10-21 kl. 07:24, skrev Suharto Anggono Suharto Anggono via R-devel:
    >> Marius Hofert-4------------------------------
    >>> Den 2015-10-09 kl. 12:14, skrev Martin Maechler:
    >>> I think so: the code above doesn't seem to do the right thing.  Consider
    >>> the following example:
    >>>
    >>> > x <- c(1, 1, 2, 3)
    >>> > rank2(x, ties.method = "last")
    >>> [1] 1 2 4 3
    >>>
    >>> That doesn't look right to me -- I had expected
    >>>
    >>> > rev(sort.list(x, decreasing = TRUE))
    >>> [1] 2 1 3 4
    >>>
    >>
    >> Indeed, well spotted, that seems to be correct.
    >>
    >>>
    >>> Henric Winell
    >>>
    >> ------------------------------
    >>
    >> In the particular example (of length 4), what is really wanted is the following.
    >> ind <- integer(4)
    >> ind[sort.list(x, decreasing=TRUE)] <- 4:1
    >> ind

    > You don't provide the output here, but 'ind' is, of course,

    >> ind
    > [1] 2 1 3 4

    >> The following gives the desired result:
    >> sort.list(rev(sort.list(x, decreasing=TRUE)))

    > And, again, no output, but

    >> sort.list(rev(sort.list(x, decreasing=TRUE)))
    > [1] 2 1 3 4

    > Why is it necessary to use 'sort.list' on the result from
    > 'rev(sort.list(...'?

You can try all kind of code on this *too* simple example and do
experiments.  But let's approach this a bit more scientifically
and hence systematically:

Look at  rank  {the R function definition} to see that
for the case of no NA's,

 rank(x, ties.method = "first')   ===    sort.list(sort.list(x))

If you assume that to be correct and want to define "last" to be
correct as well (in the sense of being  "first"-consistent),
it is clear that

  rank(x, ties.method = "last)   ===  rev(sort.list(sort.list(rev(x))))

must also be correct.  I don't think that *any* of the proposals
so far had a correct version [but the too simplistic examples
did not show the problems].

In  R-devel (the R development) version of today, i.e., svn
revision >= 69549, the implementation of  ties.method = "last'
uses
        ## == rev(sort.list(sort.list(rev(x)))) :
        if(length(x) == 0) integer(0)
        else { i <- length(x):1L
               sort.list(sort.list(x[i]))[i] },

which is equivalent to using rev() but a bit more efficient.

Martin Maechler, ETH Zurich 
------------------

I'll defend that my code is correct in general.

All comes from the fact that, if p is a permutation of 1:n,
{ ind <- integer(n); ind[p] <- 1:n; ind }
gives the same result to
sort.list(p)
You can make sense of it like this. In ind[p] <- 1:n, ind[1] is the position where p == 1. So, ind[1] is the position of the smallest element of p. So, it is the first element of sort.list(p). Next elements follow.

That's why 'sort.list' is used for ties.method="first" and ties.method="random" in function 'rank' in R. When p gives the desired order,
{ ind <- integer(n); ind[p] <- 1:n; ind }
gives ranks of the original elements based on the order. The original element in position p[1] has rank 1, the original element in position p[2] has rank 2, and so on.

Now, I say that rev(sort.list(x, decreasing=TRUE)) gives the desired order for ties.method="last". With the order, the elements are from smallest to largest; for equal elements, elements are ordered by their positions backwards.


From maechler at stat.math.ethz.ch  Thu Oct 22 09:06:51 2015
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 22 Oct 2015 09:06:51 +0200
Subject: [Rd] rank(, ties.method="last")
In-Reply-To: <1445492697.62360.YahooMailBasic@web125103.mail.ne1.yahoo.com>
References: <1445405045.40045.YahooMailBasic@web125103.mail.ne1.yahoo.com>
	<56277A46.60405@gmail.com>
	<22055.47130.499000.330314@stat.math.ethz.ch>
	<1445492697.62360.YahooMailBasic@web125103.mail.ne1.yahoo.com>
Message-ID: <22056.35595.218955.235562@stat.math.ethz.ch>

>>>>> Suharto Anggono Suharto Anggono via R-devel <r-devel at r-project.org>
>>>>>     on Wed, 21 Oct 2015 22:44:57 -0700 writes:

    > ------------------
>>>>> Henric Winell <[hidden email]>
>>>>>     on Wed, 21 Oct 2015 13:43:02 +0200 writes:

    >> Den 2015-10-21 kl. 07:24, skrev Suharto Anggono Suharto Anggono via R-devel:
    >>> Marius Hofert-4------------------------------
    >>>> Den 2015-10-09 kl. 12:14, skrev Martin Maechler:
    >>>> I think so: the code above doesn't seem to do the right thing.  Consider
    >>>> the following example:
    >>>> 
    >>>> > x <- c(1, 1, 2, 3)
    >>>> > rank2(x, ties.method = "last")
    >>>> [1] 1 2 4 3
    >>>> 
    >>>> That doesn't look right to me -- I had expected
    >>>> 
    >>>> > rev(sort.list(x, decreasing = TRUE))
    >>>> [1] 2 1 3 4
    >>>> 
    >>> 
    >>> Indeed, well spotted, that seems to be correct.
    >>> 
    >>>> 
    >>>> Henric Winell
    >>>> 
    >>> ------------------------------
    >>> 
    >>> In the particular example (of length 4), what is really wanted is the following.
    >>> ind <- integer(4)
    >>> ind[sort.list(x, decreasing=TRUE)] <- 4:1
    >>> ind

    >> You don't provide the output here, but 'ind' is, of course,

    >>> ind
    >> [1] 2 1 3 4

    >>> The following gives the desired result:
    >>> sort.list(rev(sort.list(x, decreasing=TRUE)))

    >> And, again, no output, but

    >>> sort.list(rev(sort.list(x, decreasing=TRUE)))
    >> [1] 2 1 3 4

    >> Why is it necessary to use 'sort.list' on the result from
    >> 'rev(sort.list(...'?

    > You can try all kind of code on this *too* simple example and do
    > experiments.  But let's approach this a bit more scientifically
    > and hence systematically:

    > Look at  rank  {the R function definition} to see that
    > for the case of no NA's,

    > rank(x, ties.method = "first')   ===    sort.list(sort.list(x))

    > If you assume that to be correct and want to define "last" to be
    > correct as well (in the sense of being  "first"-consistent),
    > it is clear that

    > rank(x, ties.method = "last)   ===  rev(sort.list(sort.list(rev(x))))

    > must also be correct.  I don't think that *any* of the proposals
    > so far had a correct version [but the too simplistic examples
    > did not show the problems].

    > In  R-devel (the R development) version of today, i.e., svn
    > revision >= 69549, the implementation of  ties.method = "last'
    > uses
    > ## == rev(sort.list(sort.list(rev(x)))) :
    > if(length(x) == 0) integer(0)
    > else { i <- length(x):1L
    > sort.list(sort.list(x[i]))[i] },

    > which is equivalent to using rev() but a bit more efficient.

    > Martin Maechler, ETH Zurich 
    > ------------------

    > I'll defend that my code is correct in general.

    > All comes from the fact that, if p is a permutation of 1:n,
    > { ind <- integer(n); ind[p] <- 1:n; ind }
    > gives the same result to
    > sort.list(p)

Definitely; a known fact
(and that's how sort.list() -> order() is basically
 implemented in R's C source code.)

    > You can make sense of it like this. In ind[p] <- 1:n, ind[1] is the position where p == 1. So, ind[1] is the position of the smallest element of p. So, it is the first element of sort.list(p). Next elements follow.

    > That's why 'sort.list' is used for ties.method="first" and ties.method="random" in function 'rank' in R. When p gives the desired order,
    > { ind <- integer(n); ind[p] <- 1:n; ind }
    > gives ranks of the original elements based on the order. The original element in position p[1] has rank 1, the original element in position p[2] has rank 2, and so on.

    > Now, I say that rev(sort.list(x, decreasing=TRUE)) gives the desired order for ties.method="last". With the order, the elements are from smallest to largest; for equal elements, elements are ordered by their positions backwards.

You are right, Suharto :
Your proposed 

     sort.list(rev(sort.list(x, decreasing=TRUE)))

is also correct and the same as my

     rev(sort.list(sort.list(rev(x))))

from above
nd your variant will even be slightly more efficient if implemented optimally !
     	   
Indeed,  I was thinking wrongly when I wrote
  "I don't think that *any* of the proposals so far had a correct version"

because your proposal *was* correct.
I apologize for my wrong claim.

Best regards,
Martin


From jumanbar at gmail.com  Thu Oct 22 02:45:23 2015
From: jumanbar at gmail.com (Juan Manuel Barreneche)
Date: Wed, 21 Oct 2015 21:45:23 -0300
Subject: [Rd] alternative read.arff function for the package foreign
Message-ID: <CALSUKiN4dpqpL4-67w9DOJ-RFzW4qZUGQxaK_oMv_gZxmxCFCg@mail.gmail.com>

?Hello everyone, I guess this is really directed to the R Core Team, but I
understand that this is the best channel to submit this (please correct me
if I'm wrong!).

I would like to submit a function to consideration, as an upgrade for the
current read.arff in package foreign. Code in github:

https://raw.githubusercontent.com/jumanbar/misc/master/R/read.arff.R

This function is a modified version of the one found in the foreign
package. This changes aim to correct a problem I found with the standard
read.arff: levels in factors do not match what's explicitly written in the
original arff file.

For example, if a nominal attribute in some arff datafile has this line in
the header:

@attribute X {'A', 'B', 'C'}

But the data only have instances of 'A' and 'B', but not 'C', then what R
imports is:

dat <- read.arff("data.arff")
levels(dat$X)
[1] "a"  "b"

Not only the levels are in lowercase, but also there is one level which has
disappeared. This is troublesome, specially if I wish to export my data
frame to an arff file using write.arff.

With this version of read.arff, when dealing with the aforementioned case,
I get:

levels(dat$X)
[1] "A"  "B"  "C"

And also I can set a couple of parameters which can help me tune up my work
flow to better fit my needs (for example, reading only a limited number of
lines, since I just want to make a couple of fast tests and therefore, I
don't need the whole dataset).

Thanks for your time,
Juan Manuel

--

MSc. Juan M. Barreneche Sarasola

	[[alternative HTML version deleted]]


From kai.nitschke at uniklinik-freiburg.de  Thu Oct 22 18:59:28 2015
From: kai.nitschke at uniklinik-freiburg.de (Kai Nitschke)
Date: Thu, 22 Oct 2015 18:59:28 +0200
Subject: [Rd] C_LogLin (stats/loglin)
Message-ID: <20151022185928.npvro4f88co08kkk@webmail1.uniklinik-freiburg.de>

Hi everyone,

I have a question regarding a C function of the "stats" package in R.

I tried to understand the ?loglin? basic function of the ?stats?  
package implemented in
R. The implemented function itself runs without any problem (perhaps  
see sample). When I
ran it line by line it stopped at the lines 23-24 of the  
loglin-function; (the following line):
z <- .Call(C_LogLin, dtab, conf, table, start, nmar, eps, iter)

?.Call? calls the C/C++ function ?C_LogLin?. But when I am running it  
line by line I get
the following error on line 23/24:
Error: object 'C_LogLin' not found

Hence, my questions:
1. Where does the original ?loglin? function get the ?C_LogLin?  
function from (some libraries? where are they stored)?
2. Why does it not work in the normal R command (line by) line but in  
the implemented ?loglin? function?
3. Is it possible to isolate the ?C_LogLin? function so I can use it  
in other scripts or programming languages e.g. Matlab?

Thank you in advance for your help,
  Kai

--------------------------------------------
#Sample

# Example data
mytable = array(0,dim=c(3,4,5))
mytable[1,,1] = c(35,26,36,29); mytable[2,,1] = c(21,12,26,27);  
mytable[3,,1] = c(9,26,23,38);
mytable[1,,2] = c(43,26,89,26); mytable[2,,2] = c(78,42,32,9);  
mytable[3,,2] = c(34,39,42,51);
mytable[1,,3] = c(51,72,62,21); mytable[2,,3] = c(6,52,71,32);  
mytable[3,,3] = c(35,36,48,21);
mytable[1,,4] = c(12,26,53,42); mytable[2,,4] = c(96,75,81,56);  
mytable[3,,4] = c(32,65,75,63);
mytable[1,,5] = c(21,18,24,33); mytable[2,,5] = c(22,56,36,91);  
mytable[3,,5] = c(32,65,63,14);

# Call of the original function works fine
loglin(mytable,list(c(1,2),c(1,3)))

# line by line does not work
table = mytable; margin = list(c(1,2),c(1,3)); start = rep(1,  
length(table)); fit = FALSE; eps = 0.1;
iter = 20L; param = FALSE; print = TRUE;
rfit <- fit
dtab <- dim(table)
nvar <- length(dtab)
ncon <- length(margin)
conf <- matrix(0L, nrow = nvar, ncol = ncon)
nmar <- 0
varnames <- names(dimnames(table))
for (k in seq_along(margin)) {
         tmp <- margin[[k]]
         if (is.character(tmp)) {
             ## Rewrite margin names to numbers
             tmp <- match(tmp, varnames)
             margin[[k]] <- tmp
         }
         conf[seq_along(tmp), k] <- tmp
         nmar <- nmar + prod(dtab[tmp])
}
ntab <- length(table)
if (length(start) != ntab ) stop("'start' and 'table' must be same length")
z <- .Call(C_LogLin, dtab, conf, table, start, nmar, eps, iter)
...


-- 
Kai Nitschke, Dipl.-Psych.

Division of Functional Brain Imaging (FBI)
Dept. of Neurology, University of Freiburg

Breisacher Str. 64, 79095 Freiburg, Germany
Phone: +49 (0) 761 270 - 50410
Email: kai.nitschke at uniklinik-freiburg.de
URL: http://www.uniklinik-freiburg.de/fbi/people/kai-nitschke.html


From gmbecker at ucdavis.edu  Thu Oct 22 19:53:44 2015
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Thu, 22 Oct 2015 10:53:44 -0700
Subject: [Rd] C_LogLin (stats/loglin)
In-Reply-To: <20151022185928.npvro4f88co08kkk@webmail1.uniklinik-freiburg.de>
References: <20151022185928.npvro4f88co08kkk@webmail1.uniklinik-freiburg.de>
Message-ID: <CADwqtCPBwwUitThLStq6WoVJcmjEpHSqByrqgmT7WuFbPsBAJg@mail.gmail.com>

Kai,

Apologies for the double message, it didn't go to the list last time.

On Thu, Oct 22, 2015 at 9:59 AM, Kai Nitschke <
kai.nitschke at uniklinik-freiburg.de> wrote:

>
> ?.Call? calls the C/C++ function ?C_LogLin?. But when I am running it line
> by line I get
> the following error on line 23/24:
> Error: object 'C_LogLin' not found
>
> Hence, my questions:
> 1. Where does the original ?loglin? function get the ?C_LogLin? function
> from (some libraries? where are they stored)?
>

The libraries are in the stats package, built from the c code found in the
/src  directory of the package's source code.


> 2. Why does it not work in the normal R command (line by) line but in the
> implemented ?loglin? function?
>

Notice that C_LogLin is not in quotes. That is actually an R object, not a
string, and it is one that is not exported by the stats package.
stats:::C_LogLin would probably work.


> 3. Is it possible to isolate the ?C_LogLin? function so I can use it in
> other scripts or programming languages e.g. Matlab?
>


A function called by the .Call interface is going to operate on R's
internal representation of R objects, called SEXPs, It won't work in other
languages without major reworking (I can't say how major without looking
for at the code to see if, e.g., it's just a wrapper that calls another c
function that might be amenable to that). Even then, you'd have to look at
if/how it deals with NAs, etc.

~G

On Thu, Oct 22, 2015 at 9:59 AM, Kai Nitschke <
kai.nitschke at uniklinik-freiburg.de> wrote:

> Hi everyone,
>
> I have a question regarding a C function of the "stats" package in R.
>
> I tried to understand the ?loglin? basic function of the ?stats? package
> implemented in
> R. The implemented function itself runs without any problem (perhaps see
> sample). When I
> ran it line by line it stopped at the lines 23-24 of the loglin-function;
> (the following line):
> z <- .Call(C_LogLin, dtab, conf, table, start, nmar, eps, iter)
>
> ?.Call? calls the C/C++ function ?C_LogLin?. But when I am running it line
> by line I get
> the following error on line 23/24:
> Error: object 'C_LogLin' not found
>
> Hence, my questions:
> 1. Where does the original ?loglin? function get the ?C_LogLin? function
> from (some libraries? where are they stored)?
> 2. Why does it not work in the normal R command (line by) line but in the
> implemented ?loglin? function?
> 3. Is it possible to isolate the ?C_LogLin? function so I can use it in
> other scripts or programming languages e.g. Matlab?
>
> Thank you in advance for your help,
>  Kai
>
> --------------------------------------------
> #Sample
>
> # Example data
> mytable = array(0,dim=c(3,4,5))
> mytable[1,,1] = c(35,26,36,29); mytable[2,,1] = c(21,12,26,27);
> mytable[3,,1] = c(9,26,23,38);
> mytable[1,,2] = c(43,26,89,26); mytable[2,,2] = c(78,42,32,9);
> mytable[3,,2] = c(34,39,42,51);
> mytable[1,,3] = c(51,72,62,21); mytable[2,,3] = c(6,52,71,32);
> mytable[3,,3] = c(35,36,48,21);
> mytable[1,,4] = c(12,26,53,42); mytable[2,,4] = c(96,75,81,56);
> mytable[3,,4] = c(32,65,75,63);
> mytable[1,,5] = c(21,18,24,33); mytable[2,,5] = c(22,56,36,91);
> mytable[3,,5] = c(32,65,63,14);
>
> # Call of the original function works fine
> loglin(mytable,list(c(1,2),c(1,3)))
>
> # line by line does not work
> table = mytable; margin = list(c(1,2),c(1,3)); start = rep(1,
> length(table)); fit = FALSE; eps = 0.1;
> iter = 20L; param = FALSE; print = TRUE;
> rfit <- fit
> dtab <- dim(table)
> nvar <- length(dtab)
> ncon <- length(margin)
> conf <- matrix(0L, nrow = nvar, ncol = ncon)
> nmar <- 0
> varnames <- names(dimnames(table))
> for (k in seq_along(margin)) {
>         tmp <- margin[[k]]
>         if (is.character(tmp)) {
>             ## Rewrite margin names to numbers
>             tmp <- match(tmp, varnames)
>             margin[[k]] <- tmp
>         }
>         conf[seq_along(tmp), k] <- tmp
>         nmar <- nmar + prod(dtab[tmp])
> }
> ntab <- length(table)
> if (length(start) != ntab ) stop("'start' and 'table' must be same length")
> z <- .Call(C_LogLin, dtab, conf, table, start, nmar, eps, iter)
> ...
>
>
> --
> Kai Nitschke, Dipl.-Psych.
>
> Division of Functional Brain Imaging (FBI)
> Dept. of Neurology, University of Freiburg
>
> Breisacher Str. 64, 79095 Freiburg, Germany
> Phone: +49 (0) 761 270 - 50410
> Email: kai.nitschke at uniklinik-freiburg.de
> URL: http://www.uniklinik-freiburg.de/fbi/people/kai-nitschke.html
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Gabriel Becker, PhD
Associate Scientist (Bioinformatics)
Genentech Research

	[[alternative HTML version deleted]]


From jorismeys at gmail.com  Thu Oct 22 19:59:12 2015
From: jorismeys at gmail.com (Joris Meys)
Date: Thu, 22 Oct 2015 19:59:12 +0200
Subject: [Rd] Changed behaviour when passing a function?
Message-ID: <CAO1zAVb9azyYRR-fu5EKwzv0h9Rhu_tuL6oVtbyA1rW_5hAnFw@mail.gmail.com>

Hi all,

When teaching this year's class, I was quite amazed that one of my examples
didn't work any longer. I wanted to illustrate the importance of
match.fun() with following code:

myfun <- function(x, FUN, ...){
    FUN(x, ...)
}
round <- 2
myfun(0.85, FUN = round, digits=1)

I expected to see an error, but this code doesn't generate one. It seems as
if in the current R version match.fun() is added automatically.

I've scrolled through the complete R News section specifying all the
changes and bug fixes, starting from 3.0.0.  I couldn't find anything on
that change in behaviour though. Where can I find more information on what
changed exactly?

Thanks
Cheers
Joris

-- 
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Mathematical Modelling, Statistics and Bio-Informatics

tel :  +32 (0)9 264 61 79
Joris.Meys at Ugent.be
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Thu Oct 22 20:13:57 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 22 Oct 2015 14:13:57 -0400
Subject: [Rd] R CMD check --as-cran without qpdf
In-Reply-To: <5618E8C8.1050802@ivt.baug.ethz.ch>
References: <5618E8C8.1050802@ivt.baug.ethz.ch>
Message-ID: <56292765.1070201@gmail.com>

On 10/10/2015 6:30 AM, Kirill M?ller wrote:
> Today, a package that has an HTML vignette (but no PDF vignette) failed
> R CMD check --as-cran on a system without qpdf. I think the warning
> originates here [1], due to a premature check for the existence of qpdf
> [2]. Setting R_QPDF=true (as in /bin/true) helped, but perhaps it's
> possible to check qpdf existence only when it matters.
>
> I have attached a patch (untested) that could serve as a starting point.
> The code links correspond to SVN revision 69500. Thanks.

The patch looks fine, and is now in R-devel and (in a few minutes) in 
R-patched.  Thanks!

Duncan Murdoch


From edd at debian.org  Thu Oct 22 20:38:27 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 22 Oct 2015 13:38:27 -0500
Subject: [Rd] Missing parenthesis in R-exts.texi
Message-ID: <22057.11555.549790.694667@max.nulle.part>


Line 1204 (right now) of svn/r-devel/doc/manual/R-exts.texi has

  dest <- file.path(R_PACKAGE_DIR,  paste0('bin', R_ARCH)

which lacks a closing ) -- two open, only one close right now.

Dirk

[1] I would have reported a bug, but I am aware of a recent and
not-so-friendly response when bugzilla was used to report a typo.

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From murdoch.duncan at gmail.com  Thu Oct 22 20:45:49 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 22 Oct 2015 14:45:49 -0400
Subject: [Rd] Missing parenthesis in R-exts.texi
In-Reply-To: <22057.11555.549790.694667@max.nulle.part>
References: <22057.11555.549790.694667@max.nulle.part>
Message-ID: <56292EDD.6010605@gmail.com>

On 22/10/2015 2:38 PM, Dirk Eddelbuettel wrote:
> Line 1204 (right now) of svn/r-devel/doc/manual/R-exts.texi has
>
>    dest <- file.path(R_PACKAGE_DIR,  paste0('bin', R_ARCH)
>
> which lacks a closing ) -- two open, only one close right now.
>
> Dirk
>
> [1] I would have reported a bug, but I am aware of a recent and
> not-so-friendly response when bugzilla was used to report a typo.
>

Thanks, now fixed.  Generally reporting here creates a lot less work 
than filing a bug report, so we prefer it.  The only negative is that 
some reports here get lost.

Duncan Murdoch


From murdoch.duncan at gmail.com  Thu Oct 22 21:55:01 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 22 Oct 2015 15:55:01 -0400
Subject: [Rd] Best way to implement optional functions?
Message-ID: <56293F15.80509@gmail.com>

I'm planning on adding some new WebGL functionality to the rgl package, 
but it will pull in a very large number of dependencies. Since many 
people won't need it, I'd like to make the new parts optional.

The general idea I'm thinking of is to put the new stuff into a separate 
package, and have rgl "Suggest" it.  But I'm not sure whether these 
functions  should only be available in the new package (so users would 
have to attach it to use them), or whether they should be in rgl, but 
fail if the new package is not available for loading.

Can people suggest other packages that solve this kind of problem in a 
good way?

Duncan Murdoch


From brian at braverock.com  Thu Oct 22 22:08:52 2015
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 22 Oct 2015 15:08:52 -0500
Subject: [Rd] Best way to implement optional functions?
In-Reply-To: <56293F15.80509@gmail.com>
References: <56293F15.80509@gmail.com>
Message-ID: <1445544532.4147.22.camel@brian-rcg>

On Thu, 2015-10-22 at 15:55 -0400, Duncan Murdoch wrote:
> I'm planning on adding some new WebGL functionality to the rgl package, 
> but it will pull in a very large number of dependencies. Since many 
> people won't need it, I'd like to make the new parts optional.
> 
> The general idea I'm thinking of is to put the new stuff into a separate 
> package, and have rgl "Suggest" it.  But I'm not sure whether these 
> functions  should only be available in the new package (so users would 
> have to attach it to use them), or whether they should be in rgl, but 
> fail if the new package is not available for loading.
> 
> Can people suggest other packages that solve this kind of problem in a 
> good way?

We have a number of functions in PerformanceAnalytics or
PortfolioAnalytics that rely on packages in 'Suggests'.

The model we have chiefly used is 

stopifnot("package:MASS" %in% search() || require("MASS",quietly=TRUE))

of course, it is now no longer recommended to do it this way, so we'll
probably need to test and load namespaces instead.

It makes sense to me to have such functions in the main package, and
provide pointers in the documentation and the error message which
describe that the other package is required to be available for the
function to work.

Regards,

Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From edd at debian.org  Thu Oct 22 22:53:11 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 22 Oct 2015 15:53:11 -0500
Subject: [Rd] Best way to implement optional functions?
In-Reply-To: <1445544532.4147.22.camel@brian-rcg>
References: <56293F15.80509@gmail.com>
	<1445544532.4147.22.camel@brian-rcg>
Message-ID: <22057.19639.555092.663750@max.nulle.part>


On 22 October 2015 at 15:08, Brian G. Peterson wrote:
| On Thu, 2015-10-22 at 15:55 -0400, Duncan Murdoch wrote:
| > I'm planning on adding some new WebGL functionality to the rgl package, 
| > but it will pull in a very large number of dependencies. Since many 
| > people won't need it, I'd like to make the new parts optional.
| > 
| > The general idea I'm thinking of is to put the new stuff into a separate 
| > package, and have rgl "Suggest" it.  But I'm not sure whether these 
| > functions  should only be available in the new package (so users would 
| > have to attach it to use them), or whether they should be in rgl, but 
| > fail if the new package is not available for loading.
| > 
| > Can people suggest other packages that solve this kind of problem in a 
| > good way?
| 
| We have a number of functions in PerformanceAnalytics or
| PortfolioAnalytics that rely on packages in 'Suggests'.
| 
| The model we have chiefly used is 
| 
| stopifnot("package:MASS" %in% search() || require("MASS",quietly=TRUE))
| 
| of course, it is now no longer recommended to do it this way, so we'll
| probably need to test and load namespaces instead.
| 
| It makes sense to me to have such functions in the main package, and
| provide pointers in the documentation and the error message which
| describe that the other package is required to be available for the
| function to work.

Rcmdr by John Fox has also done this for many years -- and has also moved
back from "everything in Depends (or Imports)" to "most things in Suggests".
As I maintain the package in Debian I had to add a fair number of packages
because the requirement was "hard" (via Depends/Imports) so that the extra
package was needed to actually start Rcmdr.  

Generally, a soft requirement is much better, especially when coupled with
appropriate tests -- eg via requireNamespace("packageName", quietly=TRUE) --
and this can be coupled with notifying the user about the optional package.

Also note that CRAN got itself a new Repo Policy revision where this was added:

    A package listed in `Suggests' or `Enhances' should be used
    conditionally in examples or tests if it cannot straightforwardly be
    installed on the major R platforms.

This is step forward as it recognises that Suggests: need to be tested for.

Sadly it still waters it down via the "not straightforwardly".  But then Rome
wasn't built with a single Policy Revision either ...

Dirk


-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From gmbecker at ucdavis.edu  Thu Oct 22 23:08:37 2015
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Thu, 22 Oct 2015 14:08:37 -0700
Subject: [Rd] Changed behaviour when passing a function?
In-Reply-To: <CAO1zAVb9azyYRR-fu5EKwzv0h9Rhu_tuL6oVtbyA1rW_5hAnFw@mail.gmail.com>
References: <CAO1zAVb9azyYRR-fu5EKwzv0h9Rhu_tuL6oVtbyA1rW_5hAnFw@mail.gmail.com>
Message-ID: <CADwqtCNPb0wxhkZG+dR9r6nvhd2W70R+0VbJ7iucfcCNN3N7MA@mail.gmail.com>

Joris,


When a function call (detected via the parenthesis) R does the equivalent
of get(..., mode="function") to resolve the symbol.

> round = 2
> round(5.3)
[1] 5
> get("round")
[1] 2
> get("round", mode = "function")
function (x, digits = 0)  .Primitive("round")


It's done this for a while, but didn't always do it, I think. I don't know
when the change happened.

Best,
~G


On Thu, Oct 22, 2015 at 10:59 AM, Joris Meys <jorismeys at gmail.com> wrote:

> Hi all,
>
> When teaching this year's class, I was quite amazed that one of my examples
> didn't work any longer. I wanted to illustrate the importance of
> match.fun() with following code:
>
> myfun <- function(x, FUN, ...){
>     FUN(x, ...)
> }
> round <- 2
> myfun(0.85, FUN = round, digits=1)
>
> I expected to see an error, but this code doesn't generate one. It seems as
> if in the current R version match.fun() is added automatically.
>
> I've scrolled through the complete R News section specifying all the
> changes and bug fixes, starting from 3.0.0.  I couldn't find anything on
> that change in behaviour though. Where can I find more information on what
> changed exactly?
>
> Thanks
> Cheers
> Joris
>
> --
> Joris Meys
> Statistical consultant
>
> Ghent University
> Faculty of Bioscience Engineering
> Department of Mathematical Modelling, Statistics and Bio-Informatics
>
> tel :  +32 (0)9 264 61 79
> Joris.Meys at Ugent.be
> -------------------------------
> Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Gabriel Becker, PhD
Associate Scientist (Bioinformatics)
Genentech Research

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Thu Oct 22 23:25:20 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 22 Oct 2015 17:25:20 -0400
Subject: [Rd] Changed behaviour when passing a function?
In-Reply-To: <CAO1zAVb9azyYRR-fu5EKwzv0h9Rhu_tuL6oVtbyA1rW_5hAnFw@mail.gmail.com>
References: <CAO1zAVb9azyYRR-fu5EKwzv0h9Rhu_tuL6oVtbyA1rW_5hAnFw@mail.gmail.com>
Message-ID: <56295440.2080002@gmail.com>

On 22/10/2015 1:59 PM, Joris Meys wrote:
> Hi all,
>
> When teaching this year's class, I was quite amazed that one of my examples
> didn't work any longer. I wanted to illustrate the importance of
> match.fun() with following code:
>
> myfun <- function(x, FUN, ...){
>      FUN(x, ...)
> }
> round <- 2
> myfun(0.85, FUN = round, digits=1)
>
> I expected to see an error, but this code doesn't generate one. It seems as
> if in the current R version match.fun() is added automatically.
>
> I've scrolled through the complete R News section specifying all the
> changes and bug fixes, starting from 3.0.0.  I couldn't find anything on
> that change in behaviour though. Where can I find more information on what
> changed exactly?
>

When you say "current R version", what do you mean?  I see an error:

 > myfun <- function(x, FUN, ...){
+     FUN(x, ...)
+ }
 > round <- 2
 > myfun(0.85, FUN = round, digits=1)
Error in myfun(0.85, FUN = round, digits = 1) (from #2) :
   could not find function "FUN"

I see this in 3.2.2, R-patched and R-devel.

Duncan Murdoch


From gmbecker at ucdavis.edu  Thu Oct 22 23:44:24 2015
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Thu, 22 Oct 2015 14:44:24 -0700
Subject: [Rd] Changed behaviour when passing a function?
In-Reply-To: <56295440.2080002@gmail.com>
References: <CAO1zAVb9azyYRR-fu5EKwzv0h9Rhu_tuL6oVtbyA1rW_5hAnFw@mail.gmail.com>
	<56295440.2080002@gmail.com>
Message-ID: <CADwqtCOhnSCxfdydoNAr6RO55sWumV-f-eQa7TCcTPunMUCosw@mail.gmail.com>

Of course (and unsurprisingly) Duncan is correct.  I see that behavior in R
3.1.0, as well as the modern ones Duncan mentioned.

What I said is true, as far as it goes, but the symbol being resolved is
FUN, so when looking for a function it doesn't find the function version of
round.

Did you perhaps have a function named FUN in your global environment? If so
you are being bitten by what I mentioned before.

> FUN = function(...) 1
> myfun <- function(x, FUN, ...){
+      FUN(x, ...)
+ }
> round <- 2
> myfun(0.85, FUN = round, digits=1)
[1] 1

~G

On Thu, Oct 22, 2015 at 2:25 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 22/10/2015 1:59 PM, Joris Meys wrote:
>
>> Hi all,
>>
>> When teaching this year's class, I was quite amazed that one of my
>> examples
>> didn't work any longer. I wanted to illustrate the importance of
>> match.fun() with following code:
>>
>> myfun <- function(x, FUN, ...){
>>      FUN(x, ...)
>> }
>> round <- 2
>> myfun(0.85, FUN = round, digits=1)
>>
>> I expected to see an error, but this code doesn't generate one. It seems
>> as
>> if in the current R version match.fun() is added automatically.
>>
>> I've scrolled through the complete R News section specifying all the
>> changes and bug fixes, starting from 3.0.0.  I couldn't find anything on
>> that change in behaviour though. Where can I find more information on what
>> changed exactly?
>>
>>
> When you say "current R version", what do you mean?  I see an error:
>
> > myfun <- function(x, FUN, ...){
> +     FUN(x, ...)
> + }
> > round <- 2
> > myfun(0.85, FUN = round, digits=1)
> Error in myfun(0.85, FUN = round, digits = 1) (from #2) :
>   could not find function "FUN"
>
> I see this in 3.2.2, R-patched and R-devel.
>
> Duncan Murdoch
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Gabriel Becker, PhD
Associate Scientist (Bioinformatics)
Genentech Research

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Thu Oct 22 23:56:57 2015
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 22 Oct 2015 17:56:57 -0400
Subject: [Rd] Changed behaviour when passing a function?
In-Reply-To: <CADwqtCOhnSCxfdydoNAr6RO55sWumV-f-eQa7TCcTPunMUCosw@mail.gmail.com>
References: <CAO1zAVb9azyYRR-fu5EKwzv0h9Rhu_tuL6oVtbyA1rW_5hAnFw@mail.gmail.com>
	<56295440.2080002@gmail.com>
	<CADwqtCOhnSCxfdydoNAr6RO55sWumV-f-eQa7TCcTPunMUCosw@mail.gmail.com>
Message-ID: <56295BA9.6020000@gmail.com>

On 22/10/2015 5:44 PM, Gabriel Becker wrote:
> Of course (and unsurprisingly) Duncan is correct.  I see that behavior 
> in R 3.1.0, as well as the modern ones Duncan mentioned.
>
> What I said is true, as far as it goes, but the symbol being resolved 
> is FUN, so when looking for a function it doesn't find the function 
> version of round.

It comes down to the order of operations:  we need to bind something to 
FUN, and we need to look up a function named FUN.  Since the binding 
comes first, it fails.  If it happened in the other order: look for a 
function named FUN,
find an unresolved binding to "round", look in the caller frame for a 
function named round, we wouldn't get the error.  But that's not how we 
do it.

Duncan Murdoch
>
> Did you perhaps have a function named FUN in your global environment? 
> If so you are being bitten by what I mentioned before.
>
> > FUN = function(...) 1
> > myfun <- function(x, FUN, ...){
> +      FUN(x, ...)
> + }
> > round <- 2
> > myfun(0.85, FUN = round, digits=1)
> [1] 1
>
> ~G
>
> On Thu, Oct 22, 2015 at 2:25 PM, Duncan Murdoch 
> <murdoch.duncan at gmail.com <mailto:murdoch.duncan at gmail.com>> wrote:
>
>     On 22/10/2015 1:59 PM, Joris Meys wrote:
>
>         Hi all,
>
>         When teaching this year's class, I was quite amazed that one
>         of my examples
>         didn't work any longer. I wanted to illustrate the importance of
>         match.fun() with following code:
>
>         myfun <- function(x, FUN, ...){
>              FUN(x, ...)
>         }
>         round <- 2
>         myfun(0.85, FUN = round, digits=1)
>
>         I expected to see an error, but this code doesn't generate
>         one. It seems as
>         if in the current R version match.fun() is added automatically.
>
>         I've scrolled through the complete R News section specifying
>         all the
>         changes and bug fixes, starting from 3.0.0.  I couldn't find
>         anything on
>         that change in behaviour though. Where can I find more
>         information on what
>         changed exactly?
>
>
>     When you say "current R version", what do you mean?  I see an error:
>
>     > myfun <- function(x, FUN, ...){
>     +     FUN(x, ...)
>     + }
>     > round <- 2
>     > myfun(0.85, FUN = round, digits=1)
>     Error in myfun(0.85, FUN = round, digits = 1) (from #2) :
>       could not find function "FUN"
>
>     I see this in 3.2.2, R-patched and R-devel.
>
>     Duncan Murdoch
>
>
>     ______________________________________________
>     R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>
>
> -- 
> Gabriel Becker, PhD
> Associate Scientist (Bioinformatics)
> Genentech Research


From pgilbert902 at gmail.com  Fri Oct 23 00:48:17 2015
From: pgilbert902 at gmail.com (Paul Gilbert)
Date: Thu, 22 Oct 2015 18:48:17 -0400
Subject: [Rd] Best way to implement optional functions?
In-Reply-To: <56293F15.80509@gmail.com>
References: <56293F15.80509@gmail.com>
Message-ID: <562967B1.1010801@gmail.com>



On 10/22/2015 03:55 PM, Duncan Murdoch wrote:
> I'm planning on adding some new WebGL functionality to the rgl package,
> but it will pull in a very large number of dependencies. Since many
> people won't need it, I'd like to make the new parts optional.
>
> The general idea I'm thinking of is to put the new stuff into a separate
> package, and have rgl "Suggest" it.  But I'm not sure whether these
> functions  should only be available in the new package (so users would
> have to attach it to use them), or whether they should be in rgl, but
> fail if the new package is not available for loading.
>
> Can people suggest other packages that solve this kind of problem in a
> good way?

I do something similar in several packages. I would distinguish between 
the situation where the new functions have some functionality without 
all the extra dependencies, and the case where they really do not. In 
the former case it makes sense to put the functions in rgl and then fail 
when the extra functionality is demanded and not available. In the 
latter case, it "feels like" you are trying to defeat Depends: or 
Imports:. That route has usually gotten me in trouble.

Another thing you might want to consider is that, at least for awhile, 
the new functions in rglPlus will probably be less stable then those in 
rgl. Being able to change those and update rglPlus without needing to 
update rgl can be a real advantage (i.e. if the API for the new 
functions is in rgl, and you need to change it, then you are required to 
notify all the package maintainers that depend on rgl, do reverse 
testing, and you have to explain that your update of rgl is going to 
break rglPlus and you have a new version of that but you cannot submit 
that yet because it will not work until the new rgl is in place.)

Paul
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From kai.nitschke at uniklinik-freiburg.de  Fri Oct 23 08:02:08 2015
From: kai.nitschke at uniklinik-freiburg.de (Kai Nitschke)
Date: Fri, 23 Oct 2015 08:02:08 +0200
Subject: [Rd] C_LogLin (stats/loglin)
In-Reply-To: <CADwqtCPBwwUitThLStq6WoVJcmjEpHSqByrqgmT7WuFbPsBAJg@mail.gmail.com>
References: <20151022185928.npvro4f88co08kkk@webmail1.uniklinik-freiburg.de>
	<CADwqtCPBwwUitThLStq6WoVJcmjEpHSqByrqgmT7WuFbPsBAJg@mail.gmail.com>
Message-ID: <20151023080208.xuxt4vpuxw4csog0@webmail1.uniklinik-freiburg.de>

Hi Gabriel,

it actually works with: z <- .Call(stats:::C_LogLin, dtab, conf,  
table, start, nmar, eps, iter).

This helps me a great deal. I will inform myself further about SEXPs.

Thank you very much,
  Kai

Zitat von Gabriel Becker <gmbecker at ucdavis.edu>:

> Kai,
>
> Apologies for the double message, it didn't go to the list last time.
>
> On Thu, Oct 22, 2015 at 9:59 AM, Kai Nitschke <
> kai.nitschke at uniklinik-freiburg.de> wrote:
>
>>
>> ?.Call? calls the C/C++ function ?C_LogLin?. But when I am running it line
>> by line I get
>> the following error on line 23/24:
>> Error: object 'C_LogLin' not found
>>
>> Hence, my questions:
>> 1. Where does the original ?loglin? function get the ?C_LogLin? function
>> from (some libraries? where are they stored)?
>>
>
> The libraries are in the stats package, built from the c code found in the
> /src  directory of the package's source code.
>
>
>> 2. Why does it not work in the normal R command (line by) line but in the
>> implemented ?loglin? function?
>>
>
> Notice that C_LogLin is not in quotes. That is actually an R object, not a
> string, and it is one that is not exported by the stats package.
> stats:::C_LogLin would probably work.
>
>
>> 3. Is it possible to isolate the ?C_LogLin? function so I can use it in
>> other scripts or programming languages e.g. Matlab?
>>
>
>
> A function called by the .Call interface is going to operate on R's
> internal representation of R objects, called SEXPs, It won't work in other
> languages without major reworking (I can't say how major without looking
> for at the code to see if, e.g., it's just a wrapper that calls another c
> function that might be amenable to that). Even then, you'd have to look at
> if/how it deals with NAs, etc.
>
> ~G
>
> On Thu, Oct 22, 2015 at 9:59 AM, Kai Nitschke <
> kai.nitschke at uniklinik-freiburg.de> wrote:
>
>> Hi everyone,
>>
>> I have a question regarding a C function of the "stats" package in R.
>>
>> I tried to understand the ?loglin? basic function of the ?stats? package
>> implemented in
>> R. The implemented function itself runs without any problem (perhaps see
>> sample). When I
>> ran it line by line it stopped at the lines 23-24 of the loglin-function;
>> (the following line):
>> z <- .Call(C_LogLin, dtab, conf, table, start, nmar, eps, iter)
>>
>> ?.Call? calls the C/C++ function ?C_LogLin?. But when I am running it line
>> by line I get
>> the following error on line 23/24:
>> Error: object 'C_LogLin' not found
>>
>> Hence, my questions:
>> 1. Where does the original ?loglin? function get the ?C_LogLin? function
>> from (some libraries? where are they stored)?
>> 2. Why does it not work in the normal R command (line by) line but in the
>> implemented ?loglin? function?
>> 3. Is it possible to isolate the ?C_LogLin? function so I can use it in
>> other scripts or programming languages e.g. Matlab?
>>
>> Thank you in advance for your help,
>>  Kai
>>
>> --------------------------------------------
>> #Sample
>>
>> # Example data
>> mytable = array(0,dim=c(3,4,5))
>> mytable[1,,1] = c(35,26,36,29); mytable[2,,1] = c(21,12,26,27);
>> mytable[3,,1] = c(9,26,23,38);
>> mytable[1,,2] = c(43,26,89,26); mytable[2,,2] = c(78,42,32,9);
>> mytable[3,,2] = c(34,39,42,51);
>> mytable[1,,3] = c(51,72,62,21); mytable[2,,3] = c(6,52,71,32);
>> mytable[3,,3] = c(35,36,48,21);
>> mytable[1,,4] = c(12,26,53,42); mytable[2,,4] = c(96,75,81,56);
>> mytable[3,,4] = c(32,65,75,63);
>> mytable[1,,5] = c(21,18,24,33); mytable[2,,5] = c(22,56,36,91);
>> mytable[3,,5] = c(32,65,63,14);
>>
>> # Call of the original function works fine
>> loglin(mytable,list(c(1,2),c(1,3)))
>>
>> # line by line does not work
>> table = mytable; margin = list(c(1,2),c(1,3)); start = rep(1,
>> length(table)); fit = FALSE; eps = 0.1;
>> iter = 20L; param = FALSE; print = TRUE;
>> rfit <- fit
>> dtab <- dim(table)
>> nvar <- length(dtab)
>> ncon <- length(margin)
>> conf <- matrix(0L, nrow = nvar, ncol = ncon)
>> nmar <- 0
>> varnames <- names(dimnames(table))
>> for (k in seq_along(margin)) {
>>         tmp <- margin[[k]]
>>         if (is.character(tmp)) {
>>             ## Rewrite margin names to numbers
>>             tmp <- match(tmp, varnames)
>>             margin[[k]] <- tmp
>>         }
>>         conf[seq_along(tmp), k] <- tmp
>>         nmar <- nmar + prod(dtab[tmp])
>> }
>> ntab <- length(table)
>> if (length(start) != ntab ) stop("'start' and 'table' must be same length")
>> z <- .Call(C_LogLin, dtab, conf, table, start, nmar, eps, iter)
>> ...
>>
>>
>> --
>> Kai Nitschke, Dipl.-Psych.
>>
>> Division of Functional Brain Imaging (FBI)
>> Dept. of Neurology, University of Freiburg
>>
>> Breisacher Str. 64, 79095 Freiburg, Germany
>> Phone: +49 (0) 761 270 - 50410
>> Email: kai.nitschke at uniklinik-freiburg.de
>> URL: http://www.uniklinik-freiburg.de/fbi/people/kai-nitschke.html
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
>
> --
> Gabriel Becker, PhD
> Associate Scientist (Bioinformatics)
> Genentech Research
>


From jorismeys at gmail.com  Fri Oct 23 11:33:00 2015
From: jorismeys at gmail.com (Joris Meys)
Date: Fri, 23 Oct 2015 11:33:00 +0200
Subject: [Rd] Changed behaviour when passing a function?
In-Reply-To: <CADwqtCOhnSCxfdydoNAr6RO55sWumV-f-eQa7TCcTPunMUCosw@mail.gmail.com>
References: <CAO1zAVb9azyYRR-fu5EKwzv0h9Rhu_tuL6oVtbyA1rW_5hAnFw@mail.gmail.com>
	<56295440.2080002@gmail.com>
	<CADwqtCOhnSCxfdydoNAr6RO55sWumV-f-eQa7TCcTPunMUCosw@mail.gmail.com>
Message-ID: <CAO1zAVaXDBK0TBMQb9c1YMFMW3Pzze+K5iaXOoAHUxHeR9CcAA@mail.gmail.com>

Sorry guys, I've been my stupid self again.  Indeed, I had been playing
around and had a FUN in my global environment. I've checked my history and
what I actually did, was this:

FUN <- round
myfun <- function(x, FUN, ...){
  FUN(x, ...)
}
round <- 2
myfun(0.85, FUN = round, digits=1)

And then everything works as I would expect. Moral of the story: don't post
on r-devel on a caffein detox.

Cheers and thanks for being so patient

On Thu, Oct 22, 2015 at 11:44 PM, Gabriel Becker <gmbecker at ucdavis.edu>
wrote:

> Of course (and unsurprisingly) Duncan is correct.  I see that behavior in
> R 3.1.0, as well as the modern ones Duncan mentioned.
>
> What I said is true, as far as it goes, but the symbol being resolved is
> FUN, so when looking for a function it doesn't find the function version of
> round.
>
> Did you perhaps have a function named FUN in your global environment? If
> so you are being bitten by what I mentioned before.
>
> > FUN = function(...) 1
> > myfun <- function(x, FUN, ...){
> +      FUN(x, ...)
> + }
> > round <- 2
> > myfun(0.85, FUN = round, digits=1)
> [1] 1
>
> ~G
>
> On Thu, Oct 22, 2015 at 2:25 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
> wrote:
>
>> On 22/10/2015 1:59 PM, Joris Meys wrote:
>>
>>> Hi all,
>>>
>>> When teaching this year's class, I was quite amazed that one of my
>>> examples
>>> didn't work any longer. I wanted to illustrate the importance of
>>> match.fun() with following code:
>>>
>>> myfun <- function(x, FUN, ...){
>>>      FUN(x, ...)
>>> }
>>> round <- 2
>>> myfun(0.85, FUN = round, digits=1)
>>>
>>> I expected to see an error, but this code doesn't generate one. It seems
>>> as
>>> if in the current R version match.fun() is added automatically.
>>>
>>> I've scrolled through the complete R News section specifying all the
>>> changes and bug fixes, starting from 3.0.0.  I couldn't find anything on
>>> that change in behaviour though. Where can I find more information on
>>> what
>>> changed exactly?
>>>
>>>
>> When you say "current R version", what do you mean?  I see an error:
>>
>> > myfun <- function(x, FUN, ...){
>> +     FUN(x, ...)
>> + }
>> > round <- 2
>> > myfun(0.85, FUN = round, digits=1)
>> Error in myfun(0.85, FUN = round, digits = 1) (from #2) :
>>   could not find function "FUN"
>>
>> I see this in 3.2.2, R-patched and R-devel.
>>
>> Duncan Murdoch
>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
>
> --
> Gabriel Becker, PhD
> Associate Scientist (Bioinformatics)
> Genentech Research
>



-- 
Joris Meys
Statistical consultant

Ghent University
Faculty of Bioscience Engineering
Department of Mathematical Modelling, Statistics and Bio-Informatics

tel :  +32 (0)9 264 61 79
Joris.Meys at Ugent.be
-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php

	[[alternative HTML version deleted]]


From profjcnash at gmail.com  Fri Oct 23 14:40:52 2015
From: profjcnash at gmail.com (ProfJCNash)
Date: Fri, 23 Oct 2015 08:40:52 -0400
Subject: [Rd]  Best way to implement optional functions?
In-Reply-To: <mailman.21.1445594404.16728.r-devel@r-project.org>
References: <mailman.21.1445594404.16728.r-devel@r-project.org>
Message-ID: <562A2AD4.7080000@gmail.com>

I'm relieved to read that this issue is becoming more visible. In my own
work on optimizers, I've been finding it awkward to provide a clean
solution to allowing users to run e.g., optimx, when some optimizers are
not installed. Unfortunately, I've not found what I consider to be a
solution with any elegance.

JN

On 15-10-23 06:00 AM, r-devel-request at r-project.org wrote:
> Message: 8
> Date: Thu, 22 Oct 2015 15:55:01 -0400
> From: Duncan Murdoch <murdoch.duncan at gmail.com>
> To: "R-devel at r-project.org" <r-devel at r-project.org>
> Subject: [Rd] Best way to implement optional functions?
> Message-ID: <56293F15.80509 at gmail.com>
> Content-Type: text/plain; charset=utf-8; format=flowed
> 
> I'm planning on adding some new WebGL functionality to the rgl package, 
> but it will pull in a very large number of dependencies. Since many 
> people won't need it, I'd like to make the new parts optional.
> 
> The general idea I'm thinking of is to put the new stuff into a separate 
> package, and have rgl "Suggest" it.  But I'm not sure whether these 
> functions  should only be available in the new package (so users would 
> have to attach it to use them), or whether they should be in rgl, but 
> fail if the new package is not available for loading.
> 
> Can people suggest other packages that solve this kind of problem in a 
> good way?
> 
> Duncan Murdoch


From aixtools at gmail.com  Sat Oct 24 19:46:24 2015
From: aixtools at gmail.com (Michael Felt)
Date: Sat, 24 Oct 2015 19:46:24 +0200
Subject: [Rd] Building R for AIX in 32-bit mode - as preparation for
 building in 64-bit mode (changed subject!) - INFO/FEEDBACK - do not read as
 a bug report!
In-Reply-To: <5623EDCA.5030309@gmail.com>
References: <CANvxniVBrCaT1C3HosULfg4OfBNkL-vQqnFuTt+j=pfMbovX_Q@mail.gmail.com>
	<561FA401.7010207@stats.ox.ac.uk> <5623EDCA.5030309@gmail.com>
Message-ID: <CANvxniVXGruV+up17C4gy48V23aoPjQk=CM0M_QyxUa7vaJQHw@mail.gmail.com>

I have determined why there are many "WARNING: Duplicate symbol:" messages.

*** My apologies for the length *** There is a lot of detail - but I
hope the detail will help R - and others - setup correct options for
shared libraries.
*** As I press send, I have not stopped testing (my final trial here
might not even work) - but!
*** the message is that shared libraries do not need to have all
external libraries on the command line to make a shareable library
(that is the whole point of multiple shared libraries I think)

Anyway, I hope you are"in" for a long read.

a) the duplicate symbol messages occur during the creation (read
linking) of a shared object.
b) the shared object does not need to have all symbols resolved -
actually, you do not want "external" symbols from elsewhere pulled
into to the archive.
c) one example - stats.so

currently the command to make stats.so is:

gcc -Wl,-bnoquiet -std=gnu99 -shared -Wl,-brtl -Wl,-G -Wl,-bexpall
-Wl,-bnoentry  -o stats.so init.o kmeans.o ansari.o bandwidth
s.o chisqsim.o d2x2xk.o fexact.o kendall.o ks.o line.o smooth.o prho.o
swilk.o ksmooth.o loessc.o monoSpl.o isoreg.o Srunmed.o d
blcen.o distance.o hclust-utils.o nls.o rWishart.o HoltWinters.o
PPsum.o arima.o burg.o filter.o mAR.o pacf.o starma.o port.o fa
mily.o sbart.o approx.o loglin.o lowess.o massdist.o splines.o lm.o
complete_cases.o cov.o deriv.o fft.o fourier.o model.o optim
.o optimize.o integrate.o random.o distn.o zeroin.o rcont.o
influence.o bsplvd.o bvalue.o bvalus.o loessf.o ppr.o qsbart.o sgram
.o sinerp.o sslvrg.o stxwx.o hclust.o kmns.o eureka.o stl.o portsrc.o
lminfl.o -fopenmp -L../../../../lib -lRlapack -lgfortran -
lm /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/libgcc.a -lg -lm
/opt/lib/libintl.a /opt/lib/libiconv.a -lpthread

The result has duplicate symbols:

With comments:

gcc -Wl,-bnoquiet -std=gnu99 -shared -Wl,-brtl -Wl,-G -Wl,-bexpall
-Wl,-bnoentry  -o stats.so init.o kmeans.o ansari.o bandwidths.o
chisqsim.o d2x2xk.o fexact.o kendall.o ks.o line.o smooth.o prho.o
swilk.o ksmooth.o loessc.o monoSpl.o isoreg.o Srunmed.o dblcen.o
distance.o hclust-utils.o nls.o rWishart.o HoltWinters.o PPsum.o
arima.o burg.o filter.o mAR.o pacf.o starma.o port.o family.o sbart.o
approx.o loglin.o lowess.o massdist.o splines.o lm.o complete_cases.o
cov.o deriv.o fft.o fourier.o model.o optim.o optimize.o integrate.o
random.o distn.o zeroin.o rcont.o influence.o bsplvd.o bvalue.o
bvalus.o loessf.o ppr.o qsbart.o sgram.o sinerp.o sslvrg.o stxwx.o
hclust.o kmns.o eureka.o stl.o portsrc.o lminfl.o -fopenmp
-L../../../../lib -lRlapack -lgfortran -lm
/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/libgcc.a -lg -lm
/opt/lib/libintl.a /opt/lib/libiconv.a -lpthread -lc
(ld): halt 4
** Display the options passed to ld
(ld): setopt r/o->w
(ld): setopt nodelcsect
(ld): setopt noautoexp
(ld): setopt expall
(ld): setopt rtl
(ld): setopt nortllib
(ld): setopt symbolic:0
(ld): setfflag 4
(ld): savename stats.so
(ld): filelist 82 2
** not a program, not all symbols need to resolve
(ld): setopt noprogram
** not a program, not a defined entry point
(ld): noentry
NOENTRY: There is no entry point.
** link/load these objects
(ld): i init.o
(ld): i /tmp//ccc85WAT.o
(ld): i kmeans.o
(ld): i ansari.o
(ld): i bandwidths.o
(ld): i chisqsim.o
(ld): i d2x2xk.o
(ld): i fexact.o
(ld): i kendall.o
(ld): i ks.o
(ld): i line.o
(ld): i smooth.o
(ld): i prho.o
(ld): i swilk.o
(ld): i ksmooth.o
(ld): i loessc.o
(ld): i monoSpl.o
(ld): i isoreg.o
(ld): i Srunmed.o
(ld): i dblcen.o
(ld): i distance.o
(ld): i hclust-utils.o
(ld): i nls.o
(ld): i rWishart.o
(ld): i HoltWinters.o
(ld): i PPsum.o
(ld): i arima.o
(ld): i burg.o
(ld): i filter.o
(ld): i mAR.o
(ld): i pacf.o
(ld): i starma.o
(ld): i port.o
(ld): i family.o
(ld): i sbart.o
(ld): i approx.o
(ld): i loglin.o
(ld): i lowess.o
(ld): i massdist.o
(ld): i splines.o
(ld): i lm.o
(ld): i complete_cases.o
(ld): i cov.o
(ld): i deriv.o
(ld): i fft.o
(ld): i fourier.o
(ld): i model.o
(ld): i optim.o
(ld): i optimize.o
(ld): i integrate.o
(ld): i random.o
(ld): i distn.o
(ld): i zeroin.o
(ld): i rcont.o
(ld): i influence.o
(ld): i bsplvd.o
(ld): i bvalue.o
(ld): i bvalus.o
(ld): i loessf.o
(ld): i ppr.o
(ld): i qsbart.o
(ld): i sgram.o
(ld): i sinerp.o
(ld): i sslvrg.o
(ld): i stxwx.o
(ld): i hclust.o
(ld): i kmns.o
(ld): i eureka.o
(ld): i stl.o
(ld): i portsrc.o
(ld): i lminfl.o
** continue loading objects - these are archives!
(ld): lib ../../../../lib/libRlapack.so
(ld): lib /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../../pthread/libgfortran.a
(ld): lib /usr/lib/libm.a
(ld): i /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/libgcc.a
(ld): lib /usr/lib/libg.a
(ld): i /opt/lib/libintl.a
(ld): i /opt/lib/libiconv.a
(ld): lib /usr/lib/libpthread.a
(ld): lib /usr/lib/libc.a
(ld): lib /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../../pthread/libgomp.a
(ld): lib /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../../pthread/libgcc_s.a
** Import Symbols from the shared objects
LIBRARY: Shared object libRlapack.so: 574 symbols imported.
LIBRARY: Shared object libgfortran.a[libgfortran.so.3]: 1014 symbols imported.
LIBRARY: Shared object /opt/lib/libintl.a[libintl.so.8]: 58 symbols imported.
LIBRARY: Shared object /opt/lib/libiconv.a[libiconv.so.2]: 13 symbols imported.
LIBRARY: Shared object /opt/lib/libiconv.a[shr4.o]: 10 symbols imported.
LIBRARY: Shared object /opt/lib/libiconv.a[shr.o]: 11 symbols imported.
LIBRARY: Shared object libpthread.a[shr_comm.o]: 179 symbols imported.
LIBRARY: Shared object libpthread.a[shr_xpg5.o]: 173 symbols imported.
LIBRARY: Shared object libc.a[shr.o]: 3287 symbols imported.
LIBRARY: Shared object libc.a[meth.o]: 2 symbols imported.
LIBRARY: Shared object libc.a[posix_aio.o]: 20 symbols imported.
LIBRARY: Shared object libc.a[aio.o]: 18 symbols imported.
LIBRARY: Shared object libc.a[pse.o]: 8 symbols imported.
LIBRARY: Shared object libc.a[dl.o]: 4 symbols imported.
LIBRARY: Shared object libc.a[pty.o]: 1 symbols imported.
LIBRARY: Shared object libc.a[cthread.o]: 25 symbols imported.
LIBRARY: Shared object libc.a[uchar.o]: 4 symbols imported.
LIBRARY: Shared object libgomp.a[libgomp.so.1]: 228 symbols imported.
LIBRARY: Shared object libgcc_s.a[shr.o]: 127 symbols imported.
FILELIST: Number of previously inserted files processed: 82
** load the symbols we are exporting
(ld): exports /tmp//ccNjuEdL.x
EXPORTS: Symbols exported: 312
(ld): initfini _GLOBAL__FI_stats_so _GLOBAL__FD_stats_so
(ld): resolve
** during symbol resolution we see duplicates!!!
ld: 0711-228 WARNING: Duplicate symbols were found while resolving symbols.
        The following duplicates were found:
 Symbol                    Source-File(Object) OR Import-File{Shared-object}
 ------------------------- -------------------------------------------------
 .fsav                     {../../../../lib/libRlapack.so}
    ** Duplicate **        noname(/usr/lib/libc.a[fsavres.o])
 .fres                     {../../../../lib/libRlapack.so}
    ** Duplicate **        noname(/usr/lib/libc.a[fsavres.o])
 .memcpy                   {../../../../lib/libRlapack.so}
    ** Duplicate **        moveeq.s(/usr/lib/libc.a[moveeq.o])
 .isnan                    {../../../../lib/libRlapack.so}
    ** Duplicate **        isnan.s(/usr/lib/libm.a[isnan.o])
 .finite                   {../../../../lib/libRlapack.so}
    ** Duplicate **        finite.s(/usr/lib/libm.a[finite.o])
    ** Duplicate **        finite.s(/usr/lib/libc.a[finite.o])
 .bcopy                    {../../../../lib/libRlapack.so}
    ** Duplicate **        moveeq.s(/usr/lib/libc.a[moveeq.o])
RESOLVE: 1395 of 10573 symbols were kept.
RESOLVE: The return code is 4.
** sigh - do not know what glink.o is...
(ld): addgl /usr/lib/glink.o
ADDGL: Glink code added for 507 symbols.
(ld): mismatch
MISMATCH: No type mismatches exist.
(ld): comprld
COMPRLD: Kept 10436 of 10436 relocation entries.
(ld): origin page 0x10000000 0x20000000
(ld): libpath ../../../../lib:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/pthread:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../../pthread:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
LIBPATH: Library path set to
../../../../lib:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/pthread:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../../pthread:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
(ld): save SRE .
SAVE: Section sizes = 582204+13364+884 (0x8E23C+0x3434+0x374 hex)
SAVE: Size of TOC: 4048 (0xFD0 hex)
SAVE: No .loader section relocation entries exist for the .text section.
(ld): rc
RC: Highest return code was 4.
ld: 0711-224 WARNING: Duplicate symbol: .fsav
ld: 0711-224 WARNING: Duplicate symbol: .fres
ld: 0711-224 WARNING: Duplicate symbol: .memcpy
ld: 0711-224 WARNING: Duplicate symbol: .isnan
ld: 0711-224 WARNING: Duplicate symbol: .finite
ld: 0711-224 WARNING: Duplicate symbol: .bcopy

OKAY - lets first just get rid of the Duplicates - by removing some
references to external (shared) libraries.

Now after removing the arguments -lRlapack and -lc the command looks like:

gcc -Wl,-bnoquiet -std=gnu99 -shared -Wl,-brtl -Wl,-G -Wl,-bexpall
-Wl,-bnoentry  -o stats.so init.o kmeans.o ansari.o bandwidth
s.o chisqsim.o d2x2xk.o fexact.o kendall.o ks.o line.o smooth.o prho.o
swilk.o ksmooth.o loessc.o monoSpl.o isoreg.o Srunmed.o d
blcen.o distance.o hclust-utils.o nls.o rWishart.o HoltWinters.o
PPsum.o arima.o burg.o filter.o mAR.o pacf.o starma.o port.o fa
mily.o sbart.o approx.o loglin.o lowess.o massdist.o splines.o lm.o
complete_cases.o cov.o deriv.o fft.o fourier.o model.o optim
.o optimize.o integrate.o random.o distn.o zeroin.o rcont.o
influence.o bsplvd.o bvalue.o bvalus.o loessf.o ppr.o qsbart.o sgram
.o sinerp.o sslvrg.o stxwx.o hclust.o kmns.o eureka.o stl.o portsrc.o
lminfl.o -fopenmp -L../../../../lib -lgfortran -lm /opt/li
b/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/libgcc.a -lg -lm /opt/lib/libintl.a
/opt/lib/libiconv.a -lpthread

And the result is (truncated)

FILELIST: Number of previously inserted files processed: 81
(ld): exports /tmp//ccSxDrfr.x
EXPORTS: Symbols exported: 312
(ld): initfini _GLOBAL__FI_stats_so _GLOBAL__FD_stats_so
(ld): resolve
RESOLVE: 1638 of 10364 symbols were kept.
(ld): addgl /usr/lib/glink.o
ADDGL: Glink code added for 538 symbols.
(ld): mismatch
MISMATCH: No type mismatches exist.
(ld): comprld
COMPRLD: Kept 11305 of 11305 relocation entries.
(ld): origin page 0x10000000 0x20000000
(ld): libpath ../../../../lib:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/pthread:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../../pthread:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
LIBPATH: Library path set to
../../../../lib:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/pthread:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../../pthread:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
(ld): save SRE .
SAVE: Section sizes = 624252+44524+1128 (0x9867C+0xADEC+0x468 hex)
SAVE: Size of TOC: 4452 (0x1164 hex)
SAVE: No .loader section relocation entries exist for the .text section.
(ld): rc
RC: Highest return code was 0.

Note: RC is 0, rather than 4 (warnings)

Now, lets try removing ALL the external libraries (better, all
arguments from -fopenmp to the end of command)

gcc -Wl,-bnoquiet -std=gnu99 -shared -Wl,-brtl -Wl,-G -Wl,-bexpall
-Wl,-bnoentry  -o stats.so init.o kmeans.o ansari.o bandwidth
s.o chisqsim.o d2x2xk.o fexact.o kendall.o ks.o line.o smooth.o prho.o
swilk.o ksmooth.o loessc.o monoSpl.o isoreg.o Srunmed.o d
blcen.o distance.o hclust-utils.o nls.o rWishart.o HoltWinters.o
PPsum.o arima.o burg.o filter.o mAR.o pacf.o starma.o port.o fa
mily.o sbart.o approx.o loglin.o lowess.o massdist.o splines.o lm.o
complete_cases.o cov.o deriv.o fft.o fourier.o model.o optim
.o optimize.o integrate.o random.o distn.o zeroin.o rcont.o
influence.o bsplvd.o bvalue.o bvalus.o loessf.o ppr.o qsbart.o sgram
.o sinerp.o sslvrg.o stxwx.o hclust.o kmns.o eureka.o stl.o portsrc.o lminfl.o

(ld): lib /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../../libgcc_s.a
(ld): lib /usr/lib/libc.a
LIBRARY: Shared object libgcc_s.a[shr.o]: 127 symbols imported.
LIBRARY: Shared object libc.a[shr.o]: 3287 symbols imported.
LIBRARY: Shared object libc.a[meth.o]: 2 symbols imported.
LIBRARY: Shared object libc.a[posix_aio.o]: 20 symbols imported.
LIBRARY: Shared object libc.a[aio.o]: 18 symbols imported.
LIBRARY: Shared object libc.a[pse.o]: 8 symbols imported.
LIBRARY: Shared object libc.a[dl.o]: 4 symbols imported.
LIBRARY: Shared object libc.a[pty.o]: 1 symbols imported.
LIBRARY: Shared object libc.a[cthread.o]: 25 symbols imported.
LIBRARY: Shared object libc.a[uchar.o]: 4 symbols imported.
FILELIST: Number of previously inserted files processed: 73
(ld): exports /tmp//ccsv1Vg9.x
EXPORTS: Symbols exported: 312
(ld): initfini _GLOBAL__FI_stats_so _GLOBAL__FD_stats_so
(ld): resolve
RESOLVE: 1325 of 6197 symbols were kept.
(ld): addgl /usr/lib/glink.o
ADDGL: Glink code added for 505 symbols.
(ld): mismatch
MISMATCH: No type mismatches exist.
(ld): comprld
COMPRLD: Kept 10401 of 10401 relocation entries.
(ld): origin page 0x10000000 0x20000000
(ld): libpath /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
LIBPATH: Library path set to
/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
(ld): save SRE .
SAVE: Section sizes = 575900+12696+860 (0x8C99C+0x3198+0x35C hex)
SAVE: Size of TOC: 4016 (0xFB0 hex)
SAVE: No .loader section relocation entries exist for the .text section.
(ld): rc
RC: Highest return code was 0.

This is the same in all cases:
EXPORTS: Symbols exported: 312

but we have different SIZES:
1) SAVE: Section sizes = 582204+13364+884 (0x8E23C+0x3434+0x374 hex)
2) SAVE: Section sizes = 624252+44524+1128 (0x9867C+0xADEC+0x468 hex)
3) SAVE: Section sizes = 575900+12696+860 (0x8C99C+0x3198+0x35C hex)

The size of the TOC varies accordingly.

Now, for a final test - remove all the -Wl,... options except for the
argument -G (-Wl,-G) and see what we get:

gcc -Wl,-bnoquiet -std=gnu99 -Wl,-G -o stats.so init.o kmeans.o
ansari.o bandwidths.o chisqsim.o d2x2xk.o fexact.o kendall.o ks.o
line.o smooth.o prho.o swilk.o ksmooth.o loessc.o monoSpl.o isoreg.o
Srunmed.o dblcen.o distance.o hclust-utils.o nls.o rWishart.o
HoltWinters.o PPsum.o arima.o burg.o filter.o mAR.o pacf.o starma.o
port.o family.o sbart.o approx.o loglin.o lowess.o massdist.o
splines.o lm.o complete_cases.o cov.o deriv.o fft.o fourier.o model.o
optim.o optimize.o integrate.o random.o distn.o zeroin.o rcont.o
influence.o bsplvd.o bvalue.o bvalus.o loessf.o ppr.o qsbart.o sgram.o
sinerp.o sslvrg.o stxwx.o hclust.o kmns.o eureka.o stl.o portsrc.o
lminfl.o

(ld): i stl.o
(ld): i portsrc.o
(ld): i lminfl.o
(ld): i /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/libgcc.a
(ld): i /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/libgcc_eh.a
(ld): lib /usr/lib/libc.a
LIBRARY: Shared object libc.a[shr.o]: 3287 symbols imported.
LIBRARY: Shared object libc.a[meth.o]: 2 symbols imported.
LIBRARY: Shared object libc.a[posix_aio.o]: 20 symbols imported.
LIBRARY: Shared object libc.a[aio.o]: 18 symbols imported.
LIBRARY: Shared object libc.a[pse.o]: 8 symbols imported.
LIBRARY: Shared object libc.a[dl.o]: 4 symbols imported.
LIBRARY: Shared object libc.a[pty.o]: 1 symbols imported.
LIBRARY: Shared object libc.a[cthread.o]: 25 symbols imported.
LIBRARY: Shared object libc.a[uchar.o]: 4 symbols imported.
FILELIST: Number of previously inserted files processed: 74
(ld): resolve
RESOLVE: 29 of 6161 symbols were kept.
(ld): addgl /usr/lib/glink.o
ADDGL: Glink code added for 2 symbols.
(ld): mismatch
MISMATCH: No type mismatches exist.
(ld): comprld
COMPRLD: Kept 36 of 36 relocation entries.
(ld): origin page 0x10000000 0x20000000
(ld): libpath /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
LIBPATH: Library path set to
/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
(ld): save SRE .
SAVE: Section sizes = 680+240+4 (0x2A8+0xF0+0x4 hex)
SAVE: Size of TOC: 68 (0x44 hex)
SAVE: No .loader section relocation entries exist for the .text section.
(ld): rc
RC: Highest return code was 0.

Note the SIZES:
SAVE: Section sizes = 680+240+4 (0x2A8+0xF0+0x4 hex)
SAVE: Size of TOC: 68 (0x44 hex)

** If stats.so is shareable - we will see a header
root at x072:[/data/prj/cran/32/R-3.1.3.1/src/library/stats/src]dump -H stats.so

stats.so:

                        ***Loader Section***
                      Loader Header Information
VERSION#         #SYMtableENT     #RELOCent        LENidSTR
0x00000001       0x00000007       0x0000000e       0x00000080

#IMPfilID        OFFidSTR         LENstrTBL        OFFstrTBL
0x00000003       0x00000170       0x0000002a       0x000001f0


                        ***Import File Strings***
INDEX  PATH                          BASE                MEMBER
0      /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib

Looking at the symbols in stats.so - this is now too far "the other way"

-G means

(ld): halt 4
(ld): setopt r/o->w
(ld): setopt nodelcsect
(ld): setopt noautoexp
(ld): setopt rtl
(ld): setopt nortllib
(ld): setopt symbolic:0
(ld): setfflag 4
(ld): savename stats.so
(ld): filelist 74 1
(ld): setopt noprogram
** OOPS - we do not want to load crt0.o and/or init.o I think!
(ld): i /lib/crt0.o
(ld): i init.o

Just adding -Wl,-bnoentry does not suffice, so... adding -Wl-bexpall
gives us some body:

(ld): lib /usr/lib/libc.a
LIBRARY: Shared object libc.a[shr.o]: 3287 symbols imported.
LIBRARY: Shared object libc.a[meth.o]: 2 symbols imported.
LIBRARY: Shared object libc.a[posix_aio.o]: 20 symbols imported.
LIBRARY: Shared object libc.a[aio.o]: 18 symbols imported.
LIBRARY: Shared object libc.a[pse.o]: 8 symbols imported.
LIBRARY: Shared object libc.a[dl.o]: 4 symbols imported.
LIBRARY: Shared object libc.a[pty.o]: 1 symbols imported.
LIBRARY: Shared object libc.a[cthread.o]: 25 symbols imported.
LIBRARY: Shared object libc.a[uchar.o]: 4 symbols imported.
FILELIST: Number of previously inserted files processed: 74
(ld): resolve
RESOLVE: 1324 of 6388 symbols were kept.
(ld): addgl /usr/lib/glink.o
ADDGL: Glink code added for 505 symbols.
(ld): mismatch
MISMATCH: No type mismatches exist.
(ld): comprld
COMPRLD: Kept 10394 of 10394 relocation entries.
(ld): origin page 0x10000000 0x20000000
(ld): libpath /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
LIBPATH: Library path set to
/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
(ld): save SRE .
SAVE: Section sizes = 575596+12560+872 (0x8C86C+0x3110+0x368 hex)
SAVE: Size of TOC: 4012 (0xFAC hex)
SAVE: No .loader section relocation entries exist for the .text section.
(ld): rc
RC: Highest return code was 0.
root at x072:[/data/prj/cran/32/R-3.1.3.1/src/library/stats/src]ls -l stats.so
-rwxr-xr-x    1 root     system      1456186 Oct 24 17:36 stats.so


On Sun, Oct 18, 2015 at 9:06 PM, aixtools <aixtools at gmail.com> wrote:
> On 2015-10-15 15:02, Prof Brian Ripley wrote:
>>
>> On 15/10/2015 13:32, Michael Felt wrote:
>>>
>>> Hi.
>>>
>>> Just wanted to let you know I am getting close to packaging R for AIX in
>
> rephrase - would like to be active in keeping R binaries current for AIX. My
> interest in not in R per se (rather a colleague who has a project that uses
> R, so I hope to assist him, and others like him).
>>
>>
>> Which version? (You mentioned 3.1.3 and 3.2.2 far below.)  There is little
>> value in reporting on frozen branches, and most value in reporting on
>> R-devel where all the current changes have been incorporated.
>
> The reason for reporting old and current releases is to understand what is
> new between releases, and what has been around for "awhile".
>
> Note: in the future I shall edit all the "you cannot build, could not
> determine ... messages" - and as much as possible, shall focus on R-devel
> "packaging".
>
> I (attempt to) 'package' a lot of Opensource tools for AIX. Generally, the
> problems are not application code related (sometimes a function available on
> one platform, e.g. Linux, but not on AIX) - but most are, or can be
> resolved, with modifications via configure.ac, Makefile.in, etc..
>
> Sincerely,
> Michael
>
> "Details"...
>
> When configure does complete - config.log starts with:
> It was created by R configure 3.1.3, which was
> generated by GNU Autoconf 2.69.  Invocation command line was
>
>   $ ./configure --prefix=/opt --sysconfdir=/var/R/etc
> --sharedstatedir=/var/R/com --localstatedir=/var/R --mandir=/usr/share/man
> --infodir=/opt/share/info/R --with-readline=no --with-x=no
>
> As I see you are using a recent autoconf (and I shall guess a recent
> automake) I would like to try a more version of libtool and see if that
> corrects anything. However, even in R-devel I do not see, directly, how you
> are using these tools (some projects include either a setup.sh or a
> buildconf script to standardize how the project does this.) I am quite
> capable of just calling the tools in sequence, but would prefer to follow
> your procedure.
> I
> Starting again - fresh 3.1.3, 3.2.2 and R-devel - all in 32-bit mode, for
> the start. The goal is a 64-bit build so that memory management will be
> easier.
>
> This is my "standard command for building a package"
>
> CPPFLAGS="-I/opt/buildaix/include -I/opt/include" CFLAGS="-I/opt/include
> -I/opt/buildaix/include -O2" ./configure \
>                 --prefix=/opt  \
>                 --sysconfdir=/var/R/etc \
>                 --sharedstatedir=/var/R/com \
>                 --localstatedir=/var/R \
>                 --mandir=/usr/share/man \
>                 --infodir=/opt/share/info/R --with-readline=no --with-x=no
> Results for 3.1.3
> configure: WARNING: you cannot build PDF versions of the R manuals
> configure: WARNING: you cannot build PDF versions of vignettes and help
> pages
> configure: WARNING: you cannot build info or HTML versions of the R manuals
> configure: WARNING: I could not determine a browser
> configure: WARNING: I could not determine a PDF viewer
> configure: WARNING: you cannot build info or HTML versions of the R manuals
> configure: WARNING: you cannot build PDF versions of the R manuals
> configure: WARNING: you cannot build PDF versions of vignettes and help
> pages
> configure: WARNING: I could not determine a browser
> configure: WARNING: I could not determine a PDF viewer
> + make > .buildaix/make.out
> sys-std.c: In function 'Rstd_ChooseFile':
> sys-std.c:1186:5: warning: implicit declaration of function 'isspace'
> [-Wimplicit-function-declaration]
> connections.c: In function 'fifo_open':
> connections.c:885:5: warning: implicit declaration of function 'open'
> [-Wimplicit-function-declaration]
> main.c: In function 'dummy_ii':
> main.c:1594:5: warning: function returns address of local variable [enabled
> by default]
> ld: 0711-224 WARNING: Duplicate symbol: .memcpy
> ld: 0711-224 WARNING: Duplicate symbol: memcpy
> ld: 0711-224 WARNING: Duplicate symbol: .bcopy
> ld: 0711-224 WARNING: Duplicate symbol: bcopy
> ld: 0711-224 WARNING: Duplicate symbol: .strcmp
> ld: 0711-224 WARNING: Duplicate symbol: strcmp
> ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
> information.
> Warning in solve.default(rgb) :
>   unable to load shared object
> '/data/prj/cran/32/R-3.1.3/modules//lapack.so':
>   rtld: 0712-001 Symbol logf was referenced
>       from module /data/prj/cran/32/R-3.1.3/lib/libRlapack.so(), but a
> runtime definition
>             of the symbol was not found.
> Error in solve.default(rgb) : LAPACK routines cannot be loaded
> Error: unable to load R code in package 'grDevices'
> Execution halted
> make: 1254-004 The error code from the last command is 1.
>
> ...
>
> Stop.
> make returned an error
> root at x072:[/data/prj/cran/32/R-3.1.3]
> ++++++
> Notes: Last April I was successful with building R - I do not recall
> specifically how I changed the release. I shall determine what I did to get
> it to build normally.
> ++++++
> Results for 3.2.2
> configure: WARNING: you cannot build PDF versions of the R manuals
> configure: WARNING: you cannot build PDF versions of vignettes and help
> pages
> configure: WARNING: you cannot build info or HTML versions of the R manuals
> configure: WARNING: I could not determine a browser
> configure: WARNING: I could not determine a PDF viewer
> configure: WARNING: you cannot build info or HTML versions of the R manuals
> configure: WARNING: you cannot build PDF versions of the R manuals
> configure: WARNING: you cannot build PDF versions of vignettes and help
> pages
> configure: WARNING: I could not determine a browser
> configure: WARNING: I could not determine a PDF viewer
> + make > .buildaix/make.out
> sys-std.c: In function 'Rstd_ChooseFile':
> sys-std.c:1189:5: warning: implicit declaration of function 'isspace'
> [-Wimplicit-function-declaration]
> connections.c: In function 'fifo_open':
> connections.c:876:5: warning: implicit declaration of function 'open'
> [-Wimplicit-function-declaration]
> main.c: In function 'dummy_ii':
> main.c:1598:5: warning: function returns address of local variable [enabled
> by default]
> ld: 0711-415 WARNING: Symbol BM_norm_keep is already exported.
> ld: 0711-415 WARNING: Symbol LoadInitFile is already exported.
> ld: 0711-415 WARNING: Symbol N01_kind is already exported.
> ld: 0711-415 WARNING: Symbol R_ReadItemDepth is already exported.
> ld: 0711-224 WARNING: Duplicate symbol: LoadInitFile
> ld: 0711-224 WARNING: Duplicate symbol: BM_norm_keep
> ld: 0711-224 WARNING: Duplicate symbol: N01_kind
> ld: 0711-224 WARNING: Duplicate symbol: R_ReadItemDepth
> ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
> information.
> ld: 0711-415 WARNING: Symbol BM_norm_keep is already exported.
> ld: 0711-415 WARNING: Symbol LoadInitFile is already exported.
> ld: 0711-415 WARNING: Symbol N01_kind is already exported.
> ld: 0711-415 WARNING: Symbol R_ReadItemDepth is already exported.
> ld: 0711-224 WARNING: Duplicate symbol: LoadInitFile
> ld: 0711-224 WARNING: Duplicate symbol: BM_norm_keep
> ld: 0711-224 WARNING: Duplicate symbol: N01_kind
> ld: 0711-224 WARNING: Duplicate symbol: R_ReadItemDepth
> ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
> information.
> ld: 0711-224 WARNING: Duplicate symbol: .memcpy
> ld: 0711-224 WARNING: Duplicate symbol: memcpy
> ld: 0711-224 WARNING: Duplicate symbol: .bcopy
> ld: 0711-224 WARNING: Duplicate symbol: bcopy
> ld: 0711-224 WARNING: Duplicate symbol: .strcmp
> ld: 0711-224 WARNING: Duplicate symbol: strcmp
> ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
> information.
> /bin/sh: There is no process to read data written to a pipe.
> Warning in solve.default(rgb) :
>   unable to load shared object
> '/data/prj/cran/32/R-3.2.2/modules//lapack.so':
>   rtld: 0712-001 Symbol logf was referenced
>       from module /data/prj/cran/32/R-3.2.2/lib/libRlapack.so(), but a
> runtime definition
>             of the symbol was not found.
> Error in solve.default(rgb) : LAPACK routines cannot be loaded
> Error: unable to load R code in package 'grDevices'
> Execution halted
> make: 1254-004 The error code from the last command is 1.
>
> ...
> make returned an error
> +++++
> Here there are similiar - and new problems. The error re: rtld is usually a
> compiler (actually ld) flag error - a routine is expected to be exported in
> a shared object, but the object is still "static".
> I have seen this same problem with at least one R module.
>
> I still am unsure why some functions are being defined double - that info
> will come later
> root at x072:[/data/prj/cran/32/R-3.2.2]
>
> +++++
> From  R-devel_2015-10-17.tar.bz2
> configure: WARNING: you cannot build PDF versions of the R manuals
> configure: WARNING: you cannot build PDF versions of vignettes and help
> pages
> configure: WARNING: you cannot build info or HTML versions of the R manuals
> configure: WARNING: I could not determine a browser
> configure: WARNING: I could not determine a PDF viewer
> configure: error: bzip2 library and headers are required
> buildaix: ./configure ... returned an error
>
> try doing "grep configure: config.log | tail" for possible explanation
>
> try "./configure --help" for additional arguments to buildaix
> ++++ config.log configure: comments are ++++
> configure:35647: checking bzlib.h presence
> configure:35647: gcc -E -I/opt/buildaix/include -I/opt/include  conftest.c
> configure:35647: $? = 1
> configure: failed program was:
> configure:35647: result: no
> configure:35647: checking for bzlib.h
> configure:35647: result: no
> configure:35712: checking whether bzip2 support suffices
> configure:35719: error: bzip2 library and headers are required
> configure: exit 1
> ++++ ++++
> Here is a completely new kind of "problem" - a demand for an include file.
> bzip2 is available, but configure is looking for it in a different way and
> now configure fails.
>
>>
>>> One comment - the libtool.m4 I see used is quite old. The one I have on
>>> my
>>> system is 2.4.6, and what I see in R says:
>>
>>
>> R-devel has 2.4.6 .
>>
>>> I am hoping a new libtool will clean up most of the manual work now
>>> needed.
>>
>>
>> But libtool is hardly used in building R.
>>
>>> # Which release of libtool.m4 was used?
>>> macro_version=2.2.6
>>> macro_revision=1.3012
>>>
>>> This may be all that is needed to cleanup what I am doing manually.
>>>
>>> working with gcc I have done the following for 64-bit building
>>>
>>> export OBJECT_MODE=64
>>> export CFLAGS="-maix64 -O2"
>>> export FFLAGS="-maix64 -O2"
>>
>>
>> See the manual: flags such as -maix64 should be part of CC, not CFLAGS.
>> That explains a lot of what was reported.
>> Specifically,
>> https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Essential-programs-and-libraries
>> and https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#AIX .
>>
>> It is safer to put such things on the configure command line or in a
>> config.site file (they will be found when updating if you do).
>>
>> [Lots of test output removed.]
>>
>


From aixtools at gmail.com  Sun Oct 25 00:05:46 2015
From: aixtools at gmail.com (Michael Felt)
Date: Sun, 25 Oct 2015 00:05:46 +0200
Subject: [Rd] Building R for AIX in 32-bit mode - as preparation for
 building in 64-bit mode (changed subject!) - INFO/FEEDBACK - do not read as
 a bug report!
In-Reply-To: <CANvxniVXGruV+up17C4gy48V23aoPjQk=CM0M_QyxUa7vaJQHw@mail.gmail.com>
References: <CANvxniVBrCaT1C3HosULfg4OfBNkL-vQqnFuTt+j=pfMbovX_Q@mail.gmail.com>
	<561FA401.7010207@stats.ox.ac.uk> <5623EDCA.5030309@gmail.com>
	<CANvxniVXGruV+up17C4gy48V23aoPjQk=CM0M_QyxUa7vaJQHw@mail.gmail.com>
Message-ID: <CANvxniWYm0BSsNW8iJAsau4YnYbr54uQiwHrxcy7X7s1-Tq0yA@mail.gmail.com>

And now a shorter post.

Besides everything else, I suspect there are some dependencies on GNU
conventions and/or specifics of the run-time environment.

The good news is that I can - again - generate a 32-bit build for AIX
- when I package on AIX 5.3.

All for now.

On Sat, Oct 24, 2015 at 7:46 PM, Michael Felt <aixtools at gmail.com> wrote:
> I have determined why there are many "WARNING: Duplicate symbol:" messages.
>
> *** My apologies for the length *** There is a lot of detail - but I
> hope the detail will help R - and others - setup correct options for
> shared libraries.
> *** As I press send, I have not stopped testing (my final trial here
> might not even work) - but!
> *** the message is that shared libraries do not need to have all
> external libraries on the command line to make a shareable library
> (that is the whole point of multiple shared libraries I think)
>
> Anyway, I hope you are"in" for a long read.
>
> a) the duplicate symbol messages occur during the creation (read
> linking) of a shared object.
> b) the shared object does not need to have all symbols resolved -
> actually, you do not want "external" symbols from elsewhere pulled
> into to the archive.
> c) one example - stats.so
>
> currently the command to make stats.so is:
>
> gcc -Wl,-bnoquiet -std=gnu99 -shared -Wl,-brtl -Wl,-G -Wl,-bexpall
> -Wl,-bnoentry  -o stats.so init.o kmeans.o ansari.o bandwidth
> s.o chisqsim.o d2x2xk.o fexact.o kendall.o ks.o line.o smooth.o prho.o
> swilk.o ksmooth.o loessc.o monoSpl.o isoreg.o Srunmed.o d
> blcen.o distance.o hclust-utils.o nls.o rWishart.o HoltWinters.o
> PPsum.o arima.o burg.o filter.o mAR.o pacf.o starma.o port.o fa
> mily.o sbart.o approx.o loglin.o lowess.o massdist.o splines.o lm.o
> complete_cases.o cov.o deriv.o fft.o fourier.o model.o optim
> .o optimize.o integrate.o random.o distn.o zeroin.o rcont.o
> influence.o bsplvd.o bvalue.o bvalus.o loessf.o ppr.o qsbart.o sgram
> .o sinerp.o sslvrg.o stxwx.o hclust.o kmns.o eureka.o stl.o portsrc.o
> lminfl.o -fopenmp -L../../../../lib -lRlapack -lgfortran -
> lm /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/libgcc.a -lg -lm
> /opt/lib/libintl.a /opt/lib/libiconv.a -lpthread
>
> The result has duplicate symbols:
>
> With comments:
>
> gcc -Wl,-bnoquiet -std=gnu99 -shared -Wl,-brtl -Wl,-G -Wl,-bexpall
> -Wl,-bnoentry  -o stats.so init.o kmeans.o ansari.o bandwidths.o
> chisqsim.o d2x2xk.o fexact.o kendall.o ks.o line.o smooth.o prho.o
> swilk.o ksmooth.o loessc.o monoSpl.o isoreg.o Srunmed.o dblcen.o
> distance.o hclust-utils.o nls.o rWishart.o HoltWinters.o PPsum.o
> arima.o burg.o filter.o mAR.o pacf.o starma.o port.o family.o sbart.o
> approx.o loglin.o lowess.o massdist.o splines.o lm.o complete_cases.o
> cov.o deriv.o fft.o fourier.o model.o optim.o optimize.o integrate.o
> random.o distn.o zeroin.o rcont.o influence.o bsplvd.o bvalue.o
> bvalus.o loessf.o ppr.o qsbart.o sgram.o sinerp.o sslvrg.o stxwx.o
> hclust.o kmns.o eureka.o stl.o portsrc.o lminfl.o -fopenmp
> -L../../../../lib -lRlapack -lgfortran -lm
> /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/libgcc.a -lg -lm
> /opt/lib/libintl.a /opt/lib/libiconv.a -lpthread -lc
> (ld): halt 4
> ** Display the options passed to ld
> (ld): setopt r/o->w
> (ld): setopt nodelcsect
> (ld): setopt noautoexp
> (ld): setopt expall
> (ld): setopt rtl
> (ld): setopt nortllib
> (ld): setopt symbolic:0
> (ld): setfflag 4
> (ld): savename stats.so
> (ld): filelist 82 2
> ** not a program, not all symbols need to resolve
> (ld): setopt noprogram
> ** not a program, not a defined entry point
> (ld): noentry
> NOENTRY: There is no entry point.
> ** link/load these objects
> (ld): i init.o
> (ld): i /tmp//ccc85WAT.o
> (ld): i kmeans.o
> (ld): i ansari.o
> (ld): i bandwidths.o
> (ld): i chisqsim.o
> (ld): i d2x2xk.o
> (ld): i fexact.o
> (ld): i kendall.o
> (ld): i ks.o
> (ld): i line.o
> (ld): i smooth.o
> (ld): i prho.o
> (ld): i swilk.o
> (ld): i ksmooth.o
> (ld): i loessc.o
> (ld): i monoSpl.o
> (ld): i isoreg.o
> (ld): i Srunmed.o
> (ld): i dblcen.o
> (ld): i distance.o
> (ld): i hclust-utils.o
> (ld): i nls.o
> (ld): i rWishart.o
> (ld): i HoltWinters.o
> (ld): i PPsum.o
> (ld): i arima.o
> (ld): i burg.o
> (ld): i filter.o
> (ld): i mAR.o
> (ld): i pacf.o
> (ld): i starma.o
> (ld): i port.o
> (ld): i family.o
> (ld): i sbart.o
> (ld): i approx.o
> (ld): i loglin.o
> (ld): i lowess.o
> (ld): i massdist.o
> (ld): i splines.o
> (ld): i lm.o
> (ld): i complete_cases.o
> (ld): i cov.o
> (ld): i deriv.o
> (ld): i fft.o
> (ld): i fourier.o
> (ld): i model.o
> (ld): i optim.o
> (ld): i optimize.o
> (ld): i integrate.o
> (ld): i random.o
> (ld): i distn.o
> (ld): i zeroin.o
> (ld): i rcont.o
> (ld): i influence.o
> (ld): i bsplvd.o
> (ld): i bvalue.o
> (ld): i bvalus.o
> (ld): i loessf.o
> (ld): i ppr.o
> (ld): i qsbart.o
> (ld): i sgram.o
> (ld): i sinerp.o
> (ld): i sslvrg.o
> (ld): i stxwx.o
> (ld): i hclust.o
> (ld): i kmns.o
> (ld): i eureka.o
> (ld): i stl.o
> (ld): i portsrc.o
> (ld): i lminfl.o
> ** continue loading objects - these are archives!
> (ld): lib ../../../../lib/libRlapack.so
> (ld): lib /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../../pthread/libgfortran.a
> (ld): lib /usr/lib/libm.a
> (ld): i /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/libgcc.a
> (ld): lib /usr/lib/libg.a
> (ld): i /opt/lib/libintl.a
> (ld): i /opt/lib/libiconv.a
> (ld): lib /usr/lib/libpthread.a
> (ld): lib /usr/lib/libc.a
> (ld): lib /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../../pthread/libgomp.a
> (ld): lib /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../../pthread/libgcc_s.a
> ** Import Symbols from the shared objects
> LIBRARY: Shared object libRlapack.so: 574 symbols imported.
> LIBRARY: Shared object libgfortran.a[libgfortran.so.3]: 1014 symbols imported.
> LIBRARY: Shared object /opt/lib/libintl.a[libintl.so.8]: 58 symbols imported.
> LIBRARY: Shared object /opt/lib/libiconv.a[libiconv.so.2]: 13 symbols imported.
> LIBRARY: Shared object /opt/lib/libiconv.a[shr4.o]: 10 symbols imported.
> LIBRARY: Shared object /opt/lib/libiconv.a[shr.o]: 11 symbols imported.
> LIBRARY: Shared object libpthread.a[shr_comm.o]: 179 symbols imported.
> LIBRARY: Shared object libpthread.a[shr_xpg5.o]: 173 symbols imported.
> LIBRARY: Shared object libc.a[shr.o]: 3287 symbols imported.
> LIBRARY: Shared object libc.a[meth.o]: 2 symbols imported.
> LIBRARY: Shared object libc.a[posix_aio.o]: 20 symbols imported.
> LIBRARY: Shared object libc.a[aio.o]: 18 symbols imported.
> LIBRARY: Shared object libc.a[pse.o]: 8 symbols imported.
> LIBRARY: Shared object libc.a[dl.o]: 4 symbols imported.
> LIBRARY: Shared object libc.a[pty.o]: 1 symbols imported.
> LIBRARY: Shared object libc.a[cthread.o]: 25 symbols imported.
> LIBRARY: Shared object libc.a[uchar.o]: 4 symbols imported.
> LIBRARY: Shared object libgomp.a[libgomp.so.1]: 228 symbols imported.
> LIBRARY: Shared object libgcc_s.a[shr.o]: 127 symbols imported.
> FILELIST: Number of previously inserted files processed: 82
> ** load the symbols we are exporting
> (ld): exports /tmp//ccNjuEdL.x
> EXPORTS: Symbols exported: 312
> (ld): initfini _GLOBAL__FI_stats_so _GLOBAL__FD_stats_so
> (ld): resolve
> ** during symbol resolution we see duplicates!!!
> ld: 0711-228 WARNING: Duplicate symbols were found while resolving symbols.
>         The following duplicates were found:
>  Symbol                    Source-File(Object) OR Import-File{Shared-object}
>  ------------------------- -------------------------------------------------
>  .fsav                     {../../../../lib/libRlapack.so}
>     ** Duplicate **        noname(/usr/lib/libc.a[fsavres.o])
>  .fres                     {../../../../lib/libRlapack.so}
>     ** Duplicate **        noname(/usr/lib/libc.a[fsavres.o])
>  .memcpy                   {../../../../lib/libRlapack.so}
>     ** Duplicate **        moveeq.s(/usr/lib/libc.a[moveeq.o])
>  .isnan                    {../../../../lib/libRlapack.so}
>     ** Duplicate **        isnan.s(/usr/lib/libm.a[isnan.o])
>  .finite                   {../../../../lib/libRlapack.so}
>     ** Duplicate **        finite.s(/usr/lib/libm.a[finite.o])
>     ** Duplicate **        finite.s(/usr/lib/libc.a[finite.o])
>  .bcopy                    {../../../../lib/libRlapack.so}
>     ** Duplicate **        moveeq.s(/usr/lib/libc.a[moveeq.o])
> RESOLVE: 1395 of 10573 symbols were kept.
> RESOLVE: The return code is 4.
> ** sigh - do not know what glink.o is...
> (ld): addgl /usr/lib/glink.o
> ADDGL: Glink code added for 507 symbols.
> (ld): mismatch
> MISMATCH: No type mismatches exist.
> (ld): comprld
> COMPRLD: Kept 10436 of 10436 relocation entries.
> (ld): origin page 0x10000000 0x20000000
> (ld): libpath ../../../../lib:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/pthread:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../../pthread:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
> LIBPATH: Library path set to
> ../../../../lib:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/pthread:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../../pthread:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
> (ld): save SRE .
> SAVE: Section sizes = 582204+13364+884 (0x8E23C+0x3434+0x374 hex)
> SAVE: Size of TOC: 4048 (0xFD0 hex)
> SAVE: No .loader section relocation entries exist for the .text section.
> (ld): rc
> RC: Highest return code was 4.
> ld: 0711-224 WARNING: Duplicate symbol: .fsav
> ld: 0711-224 WARNING: Duplicate symbol: .fres
> ld: 0711-224 WARNING: Duplicate symbol: .memcpy
> ld: 0711-224 WARNING: Duplicate symbol: .isnan
> ld: 0711-224 WARNING: Duplicate symbol: .finite
> ld: 0711-224 WARNING: Duplicate symbol: .bcopy
>
> OKAY - lets first just get rid of the Duplicates - by removing some
> references to external (shared) libraries.
>
> Now after removing the arguments -lRlapack and -lc the command looks like:
>
> gcc -Wl,-bnoquiet -std=gnu99 -shared -Wl,-brtl -Wl,-G -Wl,-bexpall
> -Wl,-bnoentry  -o stats.so init.o kmeans.o ansari.o bandwidth
> s.o chisqsim.o d2x2xk.o fexact.o kendall.o ks.o line.o smooth.o prho.o
> swilk.o ksmooth.o loessc.o monoSpl.o isoreg.o Srunmed.o d
> blcen.o distance.o hclust-utils.o nls.o rWishart.o HoltWinters.o
> PPsum.o arima.o burg.o filter.o mAR.o pacf.o starma.o port.o fa
> mily.o sbart.o approx.o loglin.o lowess.o massdist.o splines.o lm.o
> complete_cases.o cov.o deriv.o fft.o fourier.o model.o optim
> .o optimize.o integrate.o random.o distn.o zeroin.o rcont.o
> influence.o bsplvd.o bvalue.o bvalus.o loessf.o ppr.o qsbart.o sgram
> .o sinerp.o sslvrg.o stxwx.o hclust.o kmns.o eureka.o stl.o portsrc.o
> lminfl.o -fopenmp -L../../../../lib -lgfortran -lm /opt/li
> b/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/libgcc.a -lg -lm /opt/lib/libintl.a
> /opt/lib/libiconv.a -lpthread
>
> And the result is (truncated)
>
> FILELIST: Number of previously inserted files processed: 81
> (ld): exports /tmp//ccSxDrfr.x
> EXPORTS: Symbols exported: 312
> (ld): initfini _GLOBAL__FI_stats_so _GLOBAL__FD_stats_so
> (ld): resolve
> RESOLVE: 1638 of 10364 symbols were kept.
> (ld): addgl /usr/lib/glink.o
> ADDGL: Glink code added for 538 symbols.
> (ld): mismatch
> MISMATCH: No type mismatches exist.
> (ld): comprld
> COMPRLD: Kept 11305 of 11305 relocation entries.
> (ld): origin page 0x10000000 0x20000000
> (ld): libpath ../../../../lib:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/pthread:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../../pthread:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
> LIBPATH: Library path set to
> ../../../../lib:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/pthread:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../../pthread:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
> (ld): save SRE .
> SAVE: Section sizes = 624252+44524+1128 (0x9867C+0xADEC+0x468 hex)
> SAVE: Size of TOC: 4452 (0x1164 hex)
> SAVE: No .loader section relocation entries exist for the .text section.
> (ld): rc
> RC: Highest return code was 0.
>
> Note: RC is 0, rather than 4 (warnings)
>
> Now, lets try removing ALL the external libraries (better, all
> arguments from -fopenmp to the end of command)
>
> gcc -Wl,-bnoquiet -std=gnu99 -shared -Wl,-brtl -Wl,-G -Wl,-bexpall
> -Wl,-bnoentry  -o stats.so init.o kmeans.o ansari.o bandwidth
> s.o chisqsim.o d2x2xk.o fexact.o kendall.o ks.o line.o smooth.o prho.o
> swilk.o ksmooth.o loessc.o monoSpl.o isoreg.o Srunmed.o d
> blcen.o distance.o hclust-utils.o nls.o rWishart.o HoltWinters.o
> PPsum.o arima.o burg.o filter.o mAR.o pacf.o starma.o port.o fa
> mily.o sbart.o approx.o loglin.o lowess.o massdist.o splines.o lm.o
> complete_cases.o cov.o deriv.o fft.o fourier.o model.o optim
> .o optimize.o integrate.o random.o distn.o zeroin.o rcont.o
> influence.o bsplvd.o bvalue.o bvalus.o loessf.o ppr.o qsbart.o sgram
> .o sinerp.o sslvrg.o stxwx.o hclust.o kmns.o eureka.o stl.o portsrc.o lminfl.o
>
> (ld): lib /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../../libgcc_s.a
> (ld): lib /usr/lib/libc.a
> LIBRARY: Shared object libgcc_s.a[shr.o]: 127 symbols imported.
> LIBRARY: Shared object libc.a[shr.o]: 3287 symbols imported.
> LIBRARY: Shared object libc.a[meth.o]: 2 symbols imported.
> LIBRARY: Shared object libc.a[posix_aio.o]: 20 symbols imported.
> LIBRARY: Shared object libc.a[aio.o]: 18 symbols imported.
> LIBRARY: Shared object libc.a[pse.o]: 8 symbols imported.
> LIBRARY: Shared object libc.a[dl.o]: 4 symbols imported.
> LIBRARY: Shared object libc.a[pty.o]: 1 symbols imported.
> LIBRARY: Shared object libc.a[cthread.o]: 25 symbols imported.
> LIBRARY: Shared object libc.a[uchar.o]: 4 symbols imported.
> FILELIST: Number of previously inserted files processed: 73
> (ld): exports /tmp//ccsv1Vg9.x
> EXPORTS: Symbols exported: 312
> (ld): initfini _GLOBAL__FI_stats_so _GLOBAL__FD_stats_so
> (ld): resolve
> RESOLVE: 1325 of 6197 symbols were kept.
> (ld): addgl /usr/lib/glink.o
> ADDGL: Glink code added for 505 symbols.
> (ld): mismatch
> MISMATCH: No type mismatches exist.
> (ld): comprld
> COMPRLD: Kept 10401 of 10401 relocation entries.
> (ld): origin page 0x10000000 0x20000000
> (ld): libpath /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
> LIBPATH: Library path set to
> /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
> (ld): save SRE .
> SAVE: Section sizes = 575900+12696+860 (0x8C99C+0x3198+0x35C hex)
> SAVE: Size of TOC: 4016 (0xFB0 hex)
> SAVE: No .loader section relocation entries exist for the .text section.
> (ld): rc
> RC: Highest return code was 0.
>
> This is the same in all cases:
> EXPORTS: Symbols exported: 312
>
> but we have different SIZES:
> 1) SAVE: Section sizes = 582204+13364+884 (0x8E23C+0x3434+0x374 hex)
> 2) SAVE: Section sizes = 624252+44524+1128 (0x9867C+0xADEC+0x468 hex)
> 3) SAVE: Section sizes = 575900+12696+860 (0x8C99C+0x3198+0x35C hex)
>
> The size of the TOC varies accordingly.
>
> Now, for a final test - remove all the -Wl,... options except for the
> argument -G (-Wl,-G) and see what we get:
>
> gcc -Wl,-bnoquiet -std=gnu99 -Wl,-G -o stats.so init.o kmeans.o
> ansari.o bandwidths.o chisqsim.o d2x2xk.o fexact.o kendall.o ks.o
> line.o smooth.o prho.o swilk.o ksmooth.o loessc.o monoSpl.o isoreg.o
> Srunmed.o dblcen.o distance.o hclust-utils.o nls.o rWishart.o
> HoltWinters.o PPsum.o arima.o burg.o filter.o mAR.o pacf.o starma.o
> port.o family.o sbart.o approx.o loglin.o lowess.o massdist.o
> splines.o lm.o complete_cases.o cov.o deriv.o fft.o fourier.o model.o
> optim.o optimize.o integrate.o random.o distn.o zeroin.o rcont.o
> influence.o bsplvd.o bvalue.o bvalus.o loessf.o ppr.o qsbart.o sgram.o
> sinerp.o sslvrg.o stxwx.o hclust.o kmns.o eureka.o stl.o portsrc.o
> lminfl.o
>
> (ld): i stl.o
> (ld): i portsrc.o
> (ld): i lminfl.o
> (ld): i /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/libgcc.a
> (ld): i /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/libgcc_eh.a
> (ld): lib /usr/lib/libc.a
> LIBRARY: Shared object libc.a[shr.o]: 3287 symbols imported.
> LIBRARY: Shared object libc.a[meth.o]: 2 symbols imported.
> LIBRARY: Shared object libc.a[posix_aio.o]: 20 symbols imported.
> LIBRARY: Shared object libc.a[aio.o]: 18 symbols imported.
> LIBRARY: Shared object libc.a[pse.o]: 8 symbols imported.
> LIBRARY: Shared object libc.a[dl.o]: 4 symbols imported.
> LIBRARY: Shared object libc.a[pty.o]: 1 symbols imported.
> LIBRARY: Shared object libc.a[cthread.o]: 25 symbols imported.
> LIBRARY: Shared object libc.a[uchar.o]: 4 symbols imported.
> FILELIST: Number of previously inserted files processed: 74
> (ld): resolve
> RESOLVE: 29 of 6161 symbols were kept.
> (ld): addgl /usr/lib/glink.o
> ADDGL: Glink code added for 2 symbols.
> (ld): mismatch
> MISMATCH: No type mismatches exist.
> (ld): comprld
> COMPRLD: Kept 36 of 36 relocation entries.
> (ld): origin page 0x10000000 0x20000000
> (ld): libpath /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
> LIBPATH: Library path set to
> /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
> (ld): save SRE .
> SAVE: Section sizes = 680+240+4 (0x2A8+0xF0+0x4 hex)
> SAVE: Size of TOC: 68 (0x44 hex)
> SAVE: No .loader section relocation entries exist for the .text section.
> (ld): rc
> RC: Highest return code was 0.
>
> Note the SIZES:
> SAVE: Section sizes = 680+240+4 (0x2A8+0xF0+0x4 hex)
> SAVE: Size of TOC: 68 (0x44 hex)
>
> ** If stats.so is shareable - we will see a header
> root at x072:[/data/prj/cran/32/R-3.1.3.1/src/library/stats/src]dump -H stats.so
>
> stats.so:
>
>                         ***Loader Section***
>                       Loader Header Information
> VERSION#         #SYMtableENT     #RELOCent        LENidSTR
> 0x00000001       0x00000007       0x0000000e       0x00000080
>
> #IMPfilID        OFFidSTR         LENstrTBL        OFFstrTBL
> 0x00000003       0x00000170       0x0000002a       0x000001f0
>
>
>                         ***Import File Strings***
> INDEX  PATH                          BASE                MEMBER
> 0      /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
>
> Looking at the symbols in stats.so - this is now too far "the other way"
>
> -G means
>
> (ld): halt 4
> (ld): setopt r/o->w
> (ld): setopt nodelcsect
> (ld): setopt noautoexp
> (ld): setopt rtl
> (ld): setopt nortllib
> (ld): setopt symbolic:0
> (ld): setfflag 4
> (ld): savename stats.so
> (ld): filelist 74 1
> (ld): setopt noprogram
> ** OOPS - we do not want to load crt0.o and/or init.o I think!
> (ld): i /lib/crt0.o
> (ld): i init.o
>
> Just adding -Wl,-bnoentry does not suffice, so... adding -Wl-bexpall
> gives us some body:
>
> (ld): lib /usr/lib/libc.a
> LIBRARY: Shared object libc.a[shr.o]: 3287 symbols imported.
> LIBRARY: Shared object libc.a[meth.o]: 2 symbols imported.
> LIBRARY: Shared object libc.a[posix_aio.o]: 20 symbols imported.
> LIBRARY: Shared object libc.a[aio.o]: 18 symbols imported.
> LIBRARY: Shared object libc.a[pse.o]: 8 symbols imported.
> LIBRARY: Shared object libc.a[dl.o]: 4 symbols imported.
> LIBRARY: Shared object libc.a[pty.o]: 1 symbols imported.
> LIBRARY: Shared object libc.a[cthread.o]: 25 symbols imported.
> LIBRARY: Shared object libc.a[uchar.o]: 4 symbols imported.
> FILELIST: Number of previously inserted files processed: 74
> (ld): resolve
> RESOLVE: 1324 of 6388 symbols were kept.
> (ld): addgl /usr/lib/glink.o
> ADDGL: Glink code added for 505 symbols.
> (ld): mismatch
> MISMATCH: No type mismatches exist.
> (ld): comprld
> COMPRLD: Kept 10394 of 10394 relocation entries.
> (ld): origin page 0x10000000 0x20000000
> (ld): libpath /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
> LIBPATH: Library path set to
> /opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4:/opt/lib/gcc/powerpc-ibm-aix5.3.0.0/4.7.4/../../..:/usr/lib:/lib
> (ld): save SRE .
> SAVE: Section sizes = 575596+12560+872 (0x8C86C+0x3110+0x368 hex)
> SAVE: Size of TOC: 4012 (0xFAC hex)
> SAVE: No .loader section relocation entries exist for the .text section.
> (ld): rc
> RC: Highest return code was 0.
> root at x072:[/data/prj/cran/32/R-3.1.3.1/src/library/stats/src]ls -l stats.so
> -rwxr-xr-x    1 root     system      1456186 Oct 24 17:36 stats.so
>
>
> On Sun, Oct 18, 2015 at 9:06 PM, aixtools <aixtools at gmail.com> wrote:
>> On 2015-10-15 15:02, Prof Brian Ripley wrote:
>>>
>>> On 15/10/2015 13:32, Michael Felt wrote:
>>>>
>>>> Hi.
>>>>
>>>> Just wanted to let you know I am getting close to packaging R for AIX in
>>
>> rephrase - would like to be active in keeping R binaries current for AIX. My
>> interest in not in R per se (rather a colleague who has a project that uses
>> R, so I hope to assist him, and others like him).
>>>
>>>
>>> Which version? (You mentioned 3.1.3 and 3.2.2 far below.)  There is little
>>> value in reporting on frozen branches, and most value in reporting on
>>> R-devel where all the current changes have been incorporated.
>>
>> The reason for reporting old and current releases is to understand what is
>> new between releases, and what has been around for "awhile".
>>
>> Note: in the future I shall edit all the "you cannot build, could not
>> determine ... messages" - and as much as possible, shall focus on R-devel
>> "packaging".
>>
>> I (attempt to) 'package' a lot of Opensource tools for AIX. Generally, the
>> problems are not application code related (sometimes a function available on
>> one platform, e.g. Linux, but not on AIX) - but most are, or can be
>> resolved, with modifications via configure.ac, Makefile.in, etc..
>>
>> Sincerely,
>> Michael
>>
>> "Details"...
>>
>> When configure does complete - config.log starts with:
>> It was created by R configure 3.1.3, which was
>> generated by GNU Autoconf 2.69.  Invocation command line was
>>
>>   $ ./configure --prefix=/opt --sysconfdir=/var/R/etc
>> --sharedstatedir=/var/R/com --localstatedir=/var/R --mandir=/usr/share/man
>> --infodir=/opt/share/info/R --with-readline=no --with-x=no
>>
>> As I see you are using a recent autoconf (and I shall guess a recent
>> automake) I would like to try a more version of libtool and see if that
>> corrects anything. However, even in R-devel I do not see, directly, how you
>> are using these tools (some projects include either a setup.sh or a
>> buildconf script to standardize how the project does this.) I am quite
>> capable of just calling the tools in sequence, but would prefer to follow
>> your procedure.
>> I
>> Starting again - fresh 3.1.3, 3.2.2 and R-devel - all in 32-bit mode, for
>> the start. The goal is a 64-bit build so that memory management will be
>> easier.
>>
>> This is my "standard command for building a package"
>>
>> CPPFLAGS="-I/opt/buildaix/include -I/opt/include" CFLAGS="-I/opt/include
>> -I/opt/buildaix/include -O2" ./configure \
>>                 --prefix=/opt  \
>>                 --sysconfdir=/var/R/etc \
>>                 --sharedstatedir=/var/R/com \
>>                 --localstatedir=/var/R \
>>                 --mandir=/usr/share/man \
>>                 --infodir=/opt/share/info/R --with-readline=no --with-x=no
>> Results for 3.1.3
>> configure: WARNING: you cannot build PDF versions of the R manuals
>> configure: WARNING: you cannot build PDF versions of vignettes and help
>> pages
>> configure: WARNING: you cannot build info or HTML versions of the R manuals
>> configure: WARNING: I could not determine a browser
>> configure: WARNING: I could not determine a PDF viewer
>> configure: WARNING: you cannot build info or HTML versions of the R manuals
>> configure: WARNING: you cannot build PDF versions of the R manuals
>> configure: WARNING: you cannot build PDF versions of vignettes and help
>> pages
>> configure: WARNING: I could not determine a browser
>> configure: WARNING: I could not determine a PDF viewer
>> + make > .buildaix/make.out
>> sys-std.c: In function 'Rstd_ChooseFile':
>> sys-std.c:1186:5: warning: implicit declaration of function 'isspace'
>> [-Wimplicit-function-declaration]
>> connections.c: In function 'fifo_open':
>> connections.c:885:5: warning: implicit declaration of function 'open'
>> [-Wimplicit-function-declaration]
>> main.c: In function 'dummy_ii':
>> main.c:1594:5: warning: function returns address of local variable [enabled
>> by default]
>> ld: 0711-224 WARNING: Duplicate symbol: .memcpy
>> ld: 0711-224 WARNING: Duplicate symbol: memcpy
>> ld: 0711-224 WARNING: Duplicate symbol: .bcopy
>> ld: 0711-224 WARNING: Duplicate symbol: bcopy
>> ld: 0711-224 WARNING: Duplicate symbol: .strcmp
>> ld: 0711-224 WARNING: Duplicate symbol: strcmp
>> ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
>> information.
>> Warning in solve.default(rgb) :
>>   unable to load shared object
>> '/data/prj/cran/32/R-3.1.3/modules//lapack.so':
>>   rtld: 0712-001 Symbol logf was referenced
>>       from module /data/prj/cran/32/R-3.1.3/lib/libRlapack.so(), but a
>> runtime definition
>>             of the symbol was not found.
>> Error in solve.default(rgb) : LAPACK routines cannot be loaded
>> Error: unable to load R code in package 'grDevices'
>> Execution halted
>> make: 1254-004 The error code from the last command is 1.
>>
>> ...
>>
>> Stop.
>> make returned an error
>> root at x072:[/data/prj/cran/32/R-3.1.3]
>> ++++++
>> Notes: Last April I was successful with building R - I do not recall
>> specifically how I changed the release. I shall determine what I did to get
>> it to build normally.
>> ++++++
>> Results for 3.2.2
>> configure: WARNING: you cannot build PDF versions of the R manuals
>> configure: WARNING: you cannot build PDF versions of vignettes and help
>> pages
>> configure: WARNING: you cannot build info or HTML versions of the R manuals
>> configure: WARNING: I could not determine a browser
>> configure: WARNING: I could not determine a PDF viewer
>> configure: WARNING: you cannot build info or HTML versions of the R manuals
>> configure: WARNING: you cannot build PDF versions of the R manuals
>> configure: WARNING: you cannot build PDF versions of vignettes and help
>> pages
>> configure: WARNING: I could not determine a browser
>> configure: WARNING: I could not determine a PDF viewer
>> + make > .buildaix/make.out
>> sys-std.c: In function 'Rstd_ChooseFile':
>> sys-std.c:1189:5: warning: implicit declaration of function 'isspace'
>> [-Wimplicit-function-declaration]
>> connections.c: In function 'fifo_open':
>> connections.c:876:5: warning: implicit declaration of function 'open'
>> [-Wimplicit-function-declaration]
>> main.c: In function 'dummy_ii':
>> main.c:1598:5: warning: function returns address of local variable [enabled
>> by default]
>> ld: 0711-415 WARNING: Symbol BM_norm_keep is already exported.
>> ld: 0711-415 WARNING: Symbol LoadInitFile is already exported.
>> ld: 0711-415 WARNING: Symbol N01_kind is already exported.
>> ld: 0711-415 WARNING: Symbol R_ReadItemDepth is already exported.
>> ld: 0711-224 WARNING: Duplicate symbol: LoadInitFile
>> ld: 0711-224 WARNING: Duplicate symbol: BM_norm_keep
>> ld: 0711-224 WARNING: Duplicate symbol: N01_kind
>> ld: 0711-224 WARNING: Duplicate symbol: R_ReadItemDepth
>> ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
>> information.
>> ld: 0711-415 WARNING: Symbol BM_norm_keep is already exported.
>> ld: 0711-415 WARNING: Symbol LoadInitFile is already exported.
>> ld: 0711-415 WARNING: Symbol N01_kind is already exported.
>> ld: 0711-415 WARNING: Symbol R_ReadItemDepth is already exported.
>> ld: 0711-224 WARNING: Duplicate symbol: LoadInitFile
>> ld: 0711-224 WARNING: Duplicate symbol: BM_norm_keep
>> ld: 0711-224 WARNING: Duplicate symbol: N01_kind
>> ld: 0711-224 WARNING: Duplicate symbol: R_ReadItemDepth
>> ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
>> information.
>> ld: 0711-224 WARNING: Duplicate symbol: .memcpy
>> ld: 0711-224 WARNING: Duplicate symbol: memcpy
>> ld: 0711-224 WARNING: Duplicate symbol: .bcopy
>> ld: 0711-224 WARNING: Duplicate symbol: bcopy
>> ld: 0711-224 WARNING: Duplicate symbol: .strcmp
>> ld: 0711-224 WARNING: Duplicate symbol: strcmp
>> ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
>> information.
>> /bin/sh: There is no process to read data written to a pipe.
>> Warning in solve.default(rgb) :
>>   unable to load shared object
>> '/data/prj/cran/32/R-3.2.2/modules//lapack.so':
>>   rtld: 0712-001 Symbol logf was referenced
>>       from module /data/prj/cran/32/R-3.2.2/lib/libRlapack.so(), but a
>> runtime definition
>>             of the symbol was not found.
>> Error in solve.default(rgb) : LAPACK routines cannot be loaded
>> Error: unable to load R code in package 'grDevices'
>> Execution halted
>> make: 1254-004 The error code from the last command is 1.
>>
>> ...
>> make returned an error
>> +++++
>> Here there are similiar - and new problems. The error re: rtld is usually a
>> compiler (actually ld) flag error - a routine is expected to be exported in
>> a shared object, but the object is still "static".
>> I have seen this same problem with at least one R module.
>>
>> I still am unsure why some functions are being defined double - that info
>> will come later
>> root at x072:[/data/prj/cran/32/R-3.2.2]
>>
>> +++++
>> From  R-devel_2015-10-17.tar.bz2
>> configure: WARNING: you cannot build PDF versions of the R manuals
>> configure: WARNING: you cannot build PDF versions of vignettes and help
>> pages
>> configure: WARNING: you cannot build info or HTML versions of the R manuals
>> configure: WARNING: I could not determine a browser
>> configure: WARNING: I could not determine a PDF viewer
>> configure: error: bzip2 library and headers are required
>> buildaix: ./configure ... returned an error
>>
>> try doing "grep configure: config.log | tail" for possible explanation
>>
>> try "./configure --help" for additional arguments to buildaix
>> ++++ config.log configure: comments are ++++
>> configure:35647: checking bzlib.h presence
>> configure:35647: gcc -E -I/opt/buildaix/include -I/opt/include  conftest.c
>> configure:35647: $? = 1
>> configure: failed program was:
>> configure:35647: result: no
>> configure:35647: checking for bzlib.h
>> configure:35647: result: no
>> configure:35712: checking whether bzip2 support suffices
>> configure:35719: error: bzip2 library and headers are required
>> configure: exit 1
>> ++++ ++++
>> Here is a completely new kind of "problem" - a demand for an include file.
>> bzip2 is available, but configure is looking for it in a different way and
>> now configure fails.
>>
>>>
>>>> One comment - the libtool.m4 I see used is quite old. The one I have on
>>>> my
>>>> system is 2.4.6, and what I see in R says:
>>>
>>>
>>> R-devel has 2.4.6 .
>>>
>>>> I am hoping a new libtool will clean up most of the manual work now
>>>> needed.
>>>
>>>
>>> But libtool is hardly used in building R.
>>>
>>>> # Which release of libtool.m4 was used?
>>>> macro_version=2.2.6
>>>> macro_revision=1.3012
>>>>
>>>> This may be all that is needed to cleanup what I am doing manually.
>>>>
>>>> working with gcc I have done the following for 64-bit building
>>>>
>>>> export OBJECT_MODE=64
>>>> export CFLAGS="-maix64 -O2"
>>>> export FFLAGS="-maix64 -O2"
>>>
>>>
>>> See the manual: flags such as -maix64 should be part of CC, not CFLAGS.
>>> That explains a lot of what was reported.
>>> Specifically,
>>> https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Essential-programs-and-libraries
>>> and https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#AIX .
>>>
>>> It is safer to put such things on the configure command line or in a
>>> config.site file (they will be found when updating if you do).
>>>
>>> [Lots of test output removed.]
>>>
>>


From henrik.bengtsson at gmail.com  Mon Oct 26 02:32:11 2015
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Sun, 25 Oct 2015 18:32:11 -0700
Subject: [Rd] Best way to implement optional functions?
In-Reply-To: <562967B1.1010801@gmail.com>
References: <56293F15.80509@gmail.com> <562967B1.1010801@gmail.com>
Message-ID: <CAFDcVCQjVu2k9nhPEJGiDEy4A=rgkHvepcW-YbGivbL6rYrZjg@mail.gmail.com>

On Thu, Oct 22, 2015 at 3:48 PM, Paul Gilbert <pgilbert902 at gmail.com> wrote:
>
>
> On 10/22/2015 03:55 PM, Duncan Murdoch wrote:
>>
>> I'm planning on adding some new WebGL functionality to the rgl package,
>> but it will pull in a very large number of dependencies. Since many
>> people won't need it, I'd like to make the new parts optional.
>>
>> The general idea I'm thinking of is to put the new stuff into a separate
>> package, and have rgl "Suggest" it.  But I'm not sure whether these
>> functions  should only be available in the new package (so users would
>> have to attach it to use them), or whether they should be in rgl, but
>> fail if the new package is not available for loading.
>>
>> Can people suggest other packages that solve this kind of problem in a
>> good way?
>
>
> I do something similar in several packages. I would distinguish between the
> situation where the new functions have some functionality without all the
> extra dependencies, and the case where they really do not. In the former
> case it makes sense to put the functions in rgl and then fail when the extra
> functionality is demanded and not available. In the latter case, it "feels
> like" you are trying to defeat Depends: or Imports:. That route has usually
> gotten me in trouble.
>
> Another thing you might want to consider is that, at least for awhile, the
> new functions in rglPlus will probably be less stable then those in rgl.
> Being able to change those and update rglPlus without needing to update rgl
> can be a real advantage (i.e. if the API for the new functions is in rgl,
> and you need to change it, then you are required to notify all the package
> maintainers that depend on rgl, do reverse testing, and you have to explain
> that your update of rgl is going to break rglPlus and you have a new version
> of that but you cannot submit that yet because it will not work until the
> new rgl is in place.)

I favor the latter solution; keep rgl as a core package and add bells
and whistles to rglPlus and have rglPlus attach rgl so that people
using the extra functions can just do library(rglPlus).  This way rgl
does not have to "know about" rglPlus.  Not sure if this design is
possible, or rgl do need to have to know about rglPlus.

/Henrik

>
> Paul
>
>>
>> Duncan Murdoch
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From marius.hofert at uwaterloo.ca  Thu Oct 29 02:39:07 2015
From: marius.hofert at uwaterloo.ca (Marius Hofert)
Date: Wed, 28 Oct 2015 21:39:07 -0400
Subject: [Rd] R CMD BATCH vs R CMD batch
Message-ID: <CAM3-Kjagdzcya2ecCm=1Q7roFnNsKH+RR0Ryg3JEWPGU1b=4VA@mail.gmail.com>

Hi,

Out of laziness I just used "R CMD batch" instead of "R CMD BATCH". I
didn't get an error so didn't think about the consequences... One
consequence is (at least on Mac OS X 10.11 but probably in more
generality) that R_BATCH_OPTIONS are ignored, which was kind of fatal
in my case... I am thus wondering whether it makes sense to either a)
have R_BATCH_OPTIONS also be respected for "R CMD batch" or b) simply
not allow "R CMD batch" as a valid command (so requiring to use "R CMD
BATCH"). Both approaches might be delicate... just wanted to point
this issue out...

Cheers,
M


From edd at debian.org  Thu Oct 29 03:05:20 2015
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 28 Oct 2015 21:05:20 -0500
Subject: [Rd] R CMD BATCH vs R CMD batch
In-Reply-To: <CAM3-Kjagdzcya2ecCm=1Q7roFnNsKH+RR0Ryg3JEWPGU1b=4VA@mail.gmail.com>
References: <CAM3-Kjagdzcya2ecCm=1Q7roFnNsKH+RR0Ryg3JEWPGU1b=4VA@mail.gmail.com>
Message-ID: <22065.32480.203040.942634@max.nulle.part>


On 28 October 2015 at 21:39, Marius Hofert wrote:
| Out of laziness I just used "R CMD batch" instead of "R CMD BATCH". I
| didn't get an error so didn't think about the consequences... One
| consequence is (at least on Mac OS X 10.11 but probably in more
| generality) that R_BATCH_OPTIONS are ignored, which was kind of fatal
| in my case... I am thus wondering whether it makes sense to either a)
| have R_BATCH_OPTIONS also be respected for "R CMD batch" or b) simply
| not allow "R CMD batch" as a valid command (so requiring to use "R CMD
| BATCH"). Both approaches might be delicate... just wanted to point
| this issue out...

Same reason we have 'R CMD INSTALL' as there often is /usr/bin/install with
different options ...

In general 'R CMD foo' will run for any 'foo' in the path:

   edd at max:~$ R CMD date
   Wed Oct 28 21:05:01 CDT 2015
   edd at max:~$ 

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From marius.hofert at uwaterloo.ca  Thu Oct 29 03:07:44 2015
From: marius.hofert at uwaterloo.ca (Marius Hofert)
Date: Wed, 28 Oct 2015 22:07:44 -0400
Subject: [Rd] R CMD BATCH vs R CMD batch
In-Reply-To: <d7af79d8f6bf45c69ce4f1eba03582d5@CONNHUB3.connect.uwaterloo.ca>
References: <CAM3-Kjagdzcya2ecCm=1Q7roFnNsKH+RR0Ryg3JEWPGU1b=4VA@mail.gmail.com>
	<d7af79d8f6bf45c69ce4f1eba03582d5@CONNHUB3.connect.uwaterloo.ca>
Message-ID: <CAM3-KjbK1Mxj1q9a9zh1+QX9pJYa-o1XHb9AiRqDTi_4KXXFRw@mail.gmail.com>

Great, thanks, Dirk. Nice example :-)


On Wed, Oct 28, 2015 at 10:05 PM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> On 28 October 2015 at 21:39, Marius Hofert wrote:
> | Out of laziness I just used "R CMD batch" instead of "R CMD BATCH". I
> | didn't get an error so didn't think about the consequences... One
> | consequence is (at least on Mac OS X 10.11 but probably in more
> | generality) that R_BATCH_OPTIONS are ignored, which was kind of fatal
> | in my case... I am thus wondering whether it makes sense to either a)
> | have R_BATCH_OPTIONS also be respected for "R CMD batch" or b) simply
> | not allow "R CMD batch" as a valid command (so requiring to use "R CMD
> | BATCH"). Both approaches might be delicate... just wanted to point
> | this issue out...
>
> Same reason we have 'R CMD INSTALL' as there often is /usr/bin/install with
> different options ...
>
> In general 'R CMD foo' will run for any 'foo' in the path:
>
>    edd at max:~$ R CMD date
>    Wed Oct 28 21:05:01 CDT 2015
>    edd at max:~$
>
> Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From Rainer at krugs.de  Thu Oct 29 09:39:34 2015
From: Rainer at krugs.de (Rainer M Krug)
Date: Thu, 29 Oct 2015 09:39:34 +0100
Subject: [Rd] R CMD BATCH vs R CMD batch
In-Reply-To: <22065.32480.203040.942634@max.nulle.part> (Dirk Eddelbuettel's
	message of "Wed, 28 Oct 2015 21:05:20 -0500")
References: <CAM3-Kjagdzcya2ecCm=1Q7roFnNsKH+RR0Ryg3JEWPGU1b=4VA@mail.gmail.com>
	<22065.32480.203040.942634@max.nulle.part>
Message-ID: <m2y4emax15.fsf@krugs.de>

Dirk Eddelbuettel <edd at debian.org> writes:

> On 28 October 2015 at 21:39, Marius Hofert wrote:
> | Out of laziness I just used "R CMD batch" instead of "R CMD BATCH". I
> | didn't get an error so didn't think about the consequences... One
> | consequence is (at least on Mac OS X 10.11 but probably in more
> | generality) that R_BATCH_OPTIONS are ignored, which was kind of fatal
> | in my case... I am thus wondering whether it makes sense to either a)
> | have R_BATCH_OPTIONS also be respected for "R CMD batch" or b) simply
> | not allow "R CMD batch" as a valid command (so requiring to use "R CMD
> | BATCH"). Both approaches might be delicate... just wanted to point
> | this issue out...
>
> Same reason we have 'R CMD INSTALL' as there often is /usr/bin/install with
> different options ...
>
> In general 'R CMD foo' will run for any 'foo' in the path:
>
>    edd at max:~$ R CMD date
>    Wed Oct 28 21:05:01 CDT 2015
>    edd at max:~$ 

So what is R CMD exactly doing in this example? The output is the same if
I say only the command (using pwd as otherwise the time has changed...): 

,----
| 09:35:03 ~$ R CMD pwd
| /Users/rainerkrug
| 09:35:37 ~$ R CMD pwd
| /Users/rainerkrug
| 09:37:44 ~$ pwd
| /Users/rainerkrug
| 09:37:49 ~$
`----

And this happens, except in cases where the foo is defined as a CMD in R (build, ...):

,----
| Commands:
|   BATCH			Run R in batch mode
|   COMPILE		Compile files for use with R
|   SHLIB			Build shared library for dynamic loading
|   INSTALL		Install add-on packages
|   REMOVE		Remove add-on packages
|   build			Build add-on packages
|   check			Check add-on packages
|   LINK			Front-end for creating executable programs
|   Rprof			Post-process R profiling files
|   Rdconv		Convert Rd format to various other formats
|   Rd2pdf		Convert Rd format to PDF
|   Rd2txt		Convert Rd format to pretty text
|   Stangle		Extract S/R code from Sweave documentation
|   Sweave		Process Sweave documentation
|   Rdiff			Diff R output ignoring headers etc
|   config		Obtain configuration information about R
|   javareconf		Update the Java configuration variables
|   rtags                 Create Emacs-style tag files from C, R, and Rd files
`----

Unless I miss something, is this is an inconsistency in R?

Rainer


>
> Dirk

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug

PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 454 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20151029/84e78acb/attachment.bin>

From deepayan.sarkar at gmail.com  Thu Oct 29 09:51:57 2015
From: deepayan.sarkar at gmail.com (Deepayan Sarkar)
Date: Thu, 29 Oct 2015 14:21:57 +0530
Subject: [Rd] R CMD BATCH vs R CMD batch
In-Reply-To: <m2y4emax15.fsf@krugs.de>
References: <CAM3-Kjagdzcya2ecCm=1Q7roFnNsKH+RR0Ryg3JEWPGU1b=4VA@mail.gmail.com>
	<22065.32480.203040.942634@max.nulle.part> <m2y4emax15.fsf@krugs.de>
Message-ID: <CADfFDC4wMVsEeZHQd0QoHvQDWT1JOizL0p+DQM=7JgBy40ZS_Q@mail.gmail.com>

On Thu, Oct 29, 2015 at 2:09 PM, Rainer M Krug <Rainer at krugs.de> wrote:
> Dirk Eddelbuettel <edd at debian.org> writes:
>
>> On 28 October 2015 at 21:39, Marius Hofert wrote:
>> | Out of laziness I just used "R CMD batch" instead of "R CMD BATCH". I
>> | didn't get an error so didn't think about the consequences... One
>> | consequence is (at least on Mac OS X 10.11 but probably in more
>> | generality) that R_BATCH_OPTIONS are ignored, which was kind of fatal
>> | in my case... I am thus wondering whether it makes sense to either a)
>> | have R_BATCH_OPTIONS also be respected for "R CMD batch" or b) simply
>> | not allow "R CMD batch" as a valid command (so requiring to use "R CMD
>> | BATCH"). Both approaches might be delicate... just wanted to point
>> | this issue out...
>>
>> Same reason we have 'R CMD INSTALL' as there often is /usr/bin/install with
>> different options ...
>>
>> In general 'R CMD foo' will run for any 'foo' in the path:
>>
>>    edd at max:~$ R CMD date
>>    Wed Oct 28 21:05:01 CDT 2015
>>    edd at max:~$
>
> So what is R CMD exactly doing in this example? The output is the same if
> I say only the command (using pwd as otherwise the time has changed...):
>
> ,----
> | 09:35:03 ~$ R CMD pwd
> | /Users/rainerkrug
> | 09:35:37 ~$ R CMD pwd
> | /Users/rainerkrug
> | 09:37:44 ~$ pwd
> | /Users/rainerkrug
> | 09:37:49 ~$
> `----
>
> And this happens, except in cases where the foo is defined as a CMD in R (build, ...):
>
> ,----
> | Commands:
> |   BATCH                       Run R in batch mode
> |   COMPILE             Compile files for use with R
> |   SHLIB                       Build shared library for dynamic loading
> |   INSTALL             Install add-on packages
> |   REMOVE              Remove add-on packages
> |   build                       Build add-on packages
> |   check                       Check add-on packages
> |   LINK                        Front-end for creating executable programs
> |   Rprof                       Post-process R profiling files
> |   Rdconv              Convert Rd format to various other formats
> |   Rd2pdf              Convert Rd format to PDF
> |   Rd2txt              Convert Rd format to pretty text
> |   Stangle             Extract S/R code from Sweave documentation
> |   Sweave              Process Sweave documentation
> |   Rdiff                       Diff R output ignoring headers etc
> |   config              Obtain configuration information about R
> |   javareconf          Update the Java configuration variables
> |   rtags                 Create Emacs-style tag files from C, R, and Rd files
> `----
>
> Unless I miss something, is this is an inconsistency in R?

One important difference (not sure if the only one) is that R CMD
defines more environment variables. Compare

env | grep -i tex
R CMD env | grep -i tex

So for example

R CMD pdflatex

will behave differently from plain pdflatex.

-Deepayan


From Rainer at krugs.de  Thu Oct 29 10:44:55 2015
From: Rainer at krugs.de (Rainer M Krug)
Date: Thu, 29 Oct 2015 10:44:55 +0100
Subject: [Rd] R CMD BATCH vs R CMD batch
In-Reply-To: <CADfFDC4wMVsEeZHQd0QoHvQDWT1JOizL0p+DQM=7JgBy40ZS_Q@mail.gmail.com>
	(Deepayan Sarkar's message of "Thu, 29 Oct 2015 14:21:57 +0530")
References: <CAM3-Kjagdzcya2ecCm=1Q7roFnNsKH+RR0Ryg3JEWPGU1b=4VA@mail.gmail.com>
	<22065.32480.203040.942634@max.nulle.part> <m2y4emax15.fsf@krugs.de>
	<CADfFDC4wMVsEeZHQd0QoHvQDWT1JOizL0p+DQM=7JgBy40ZS_Q@mail.gmail.com>
Message-ID: <m2oafiau08.fsf@krugs.de>

Deepayan Sarkar <deepayan.sarkar at gmail.com> writes:

> On Thu, Oct 29, 2015 at 2:09 PM, Rainer M Krug <Rainer at krugs.de> wrote:
>> Dirk Eddelbuettel <edd at debian.org> writes:
>>
>>> On 28 October 2015 at 21:39, Marius Hofert wrote:
>>> | Out of laziness I just used "R CMD batch" instead of "R CMD BATCH". I
>>> | didn't get an error so didn't think about the consequences... One
>>> | consequence is (at least on Mac OS X 10.11 but probably in more
>>> | generality) that R_BATCH_OPTIONS are ignored, which was kind of fatal
>>> | in my case... I am thus wondering whether it makes sense to either a)
>>> | have R_BATCH_OPTIONS also be respected for "R CMD batch" or b) simply
>>> | not allow "R CMD batch" as a valid command (so requiring to use "R CMD
>>> | BATCH"). Both approaches might be delicate... just wanted to point
>>> | this issue out...
>>>
>>> Same reason we have 'R CMD INSTALL' as there often is /usr/bin/install with
>>> different options ...
>>>
>>> In general 'R CMD foo' will run for any 'foo' in the path:
>>>
>>>    edd at max:~$ R CMD date
>>>    Wed Oct 28 21:05:01 CDT 2015
>>>    edd at max:~$
>>
>> So what is R CMD exactly doing in this example? The output is the same if
>> I say only the command (using pwd as otherwise the time has changed...):
>>
>> ,----
>> | 09:35:03 ~$ R CMD pwd
>> | /Users/rainerkrug
>> | 09:35:37 ~$ R CMD pwd
>> | /Users/rainerkrug
>> | 09:37:44 ~$ pwd
>> | /Users/rainerkrug
>> | 09:37:49 ~$
>> `----
>>
>> And this happens, except in cases where the foo is defined as a CMD in R (build, ...):
>>
>> ,----
>> | Commands:
>> |   BATCH                       Run R in batch mode
>> |   COMPILE             Compile files for use with R
>> |   SHLIB                       Build shared library for dynamic loading
>> |   INSTALL             Install add-on packages
>> |   REMOVE              Remove add-on packages
>> |   build                       Build add-on packages
>> |   check                       Check add-on packages
>> |   LINK                        Front-end for creating executable programs
>> |   Rprof                       Post-process R profiling files
>> |   Rdconv              Convert Rd format to various other formats
>> |   Rd2pdf              Convert Rd format to PDF
>> |   Rd2txt              Convert Rd format to pretty text
>> |   Stangle             Extract S/R code from Sweave documentation
>> |   Sweave              Process Sweave documentation
>> |   Rdiff                       Diff R output ignoring headers etc
>> |   config              Obtain configuration information about R
>> |   javareconf          Update the Java configuration variables
>> |   rtags                 Create Emacs-style tag files from C, R, and Rd files
>> `----
>>
>> Unless I miss something, is this is an inconsistency in R?
>
> One important difference (not sure if the only one) is that R CMD
> defines more environment variables. Compare
>
> env | grep -i tex
> R CMD env | grep -i tex
>
> So for example
>
> R CMD pdflatex
>
> will behave differently from plain pdflatex.

Reading Dirk's email again, I think I get the picture of what ~R CMD foo~ is
doing: running ~foo~ after doing some initial magic.

Out of interest: What is the magic ~R CMD~ is doing? Is it documented
anywhere?

Rainer

>
> -Deepayan

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug

PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 454 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20151029/9590fa6c/attachment.bin>

From pdalgd at gmail.com  Thu Oct 29 11:44:24 2015
From: pdalgd at gmail.com (peter dalgaard)
Date: Thu, 29 Oct 2015 11:44:24 +0100
Subject: [Rd] R CMD BATCH vs R CMD batch
In-Reply-To: <m2oafiau08.fsf@krugs.de>
References: <CAM3-Kjagdzcya2ecCm=1Q7roFnNsKH+RR0Ryg3JEWPGU1b=4VA@mail.gmail.com>
	<22065.32480.203040.942634@max.nulle.part>
	<m2y4emax15.fsf@krugs.de>
	<CADfFDC4wMVsEeZHQd0QoHvQDWT1JOizL0p+DQM=7JgBy40ZS_Q@mail.gmail.com>
	<m2oafiau08.fsf@krugs.de>
Message-ID: <7AF88AA2-B815-4CB3-825A-5D7AF9D8CFC6@gmail.com>


On 29 Oct 2015, at 10:44 , Rainer M Krug <Rainer at krugs.de> wrote:

> Out of interest: What is the magic ~R CMD~ is doing? Is it documented
> anywhere?


R is open source.... (and shell scripts are considered self-documenting by some)

On Unix-alikes, R is a shell script which, if called with 1st argument CMD, calls ${R_HOME}/bin/Rcmd, which is another shell script that ends with 

case "${1}" in
## this was a separate command prior to 2.10.0
  Rd2txt)
    cmd="${R_HOME}/bin/Rdconv"
    extra="-t txt"
    ;;
## removed in 2.15.0
  Rd2dvi)
    echo "R CMD Rd2dvi is defunct: use Rd2pdf instead"
    exit 1
    ;;
  *)
    if test -x "${R_HOME}/bin/${1}"; then
      cmd="${R_HOME}/bin/${1}"
    else
      cmd="${1}"
    fi
    ;;
esac
shift

exec "${cmd}" ${extra} "${@}"

I.e., except for setting up variables and such, R CMD ${foo} essentially looks for ${R_HOME}/bin/${foo} and executes it if it exists and is executable, otherwise it just executes ${foo}.

Notice that, somewhat contrary to what Dirk said, this logic works at the mercy of the file system when it comes to case sensitivity. On OSX with the default case-insensitive setup we get

Peters-iMac:IBP pd$ R CMD install
Error: ERROR: no packages specified

which comes from R's package installer, whereas a case-sensitive FS would pick up /usr/bin/install instead. That is just how the "test" shell built-in works: 

Peters-iMac:~ pd$ test -x `R RHOME`/bin/INSTALL ; echo $?
0
Peters-iMac:~ pd$ test -x `R RHOME`/bin/UNSTALL ; echo $?
1
Peters-iMac:~ pd$ test -x `R RHOME`/bin/install ; echo $?
0


-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From Rainer at krugs.de  Thu Oct 29 12:17:03 2015
From: Rainer at krugs.de (Rainer M Krug)
Date: Thu, 29 Oct 2015 12:17:03 +0100
Subject: [Rd] R CMD BATCH vs R CMD batch
In-Reply-To: <7AF88AA2-B815-4CB3-825A-5D7AF9D8CFC6@gmail.com> (peter
	dalgaard's message of "Thu, 29 Oct 2015 11:44:24 +0100")
References: <CAM3-Kjagdzcya2ecCm=1Q7roFnNsKH+RR0Ryg3JEWPGU1b=4VA@mail.gmail.com>
	<22065.32480.203040.942634@max.nulle.part> <m2y4emax15.fsf@krugs.de>
	<CADfFDC4wMVsEeZHQd0QoHvQDWT1JOizL0p+DQM=7JgBy40ZS_Q@mail.gmail.com>
	<m2oafiau08.fsf@krugs.de>
	<7AF88AA2-B815-4CB3-825A-5D7AF9D8CFC6@gmail.com>
Message-ID: <m2fv0tc4b4.fsf@krugs.de>

peter dalgaard <pdalgd at gmail.com> writes:

> On 29 Oct 2015, at 10:44 , Rainer M Krug <Rainer at krugs.de> wrote:
>
>> Out of interest: What is the magic ~R CMD~ is doing? Is it documented
>> anywhere?
>
>
> R is open source.... (and shell scripts are considered self-documenting by some)

True - should have looked in the sources...

>
> On Unix-alikes, R is a shell script which, if called with 1st argument
> CMD, calls ${R_HOME}/bin/Rcmd, which is another shell script that ends
> with
>
> case "${1}" in
> ## this was a separate command prior to 2.10.0
>   Rd2txt)
>     cmd="${R_HOME}/bin/Rdconv"
>     extra="-t txt"
>     ;;
> ## removed in 2.15.0
>   Rd2dvi)
>     echo "R CMD Rd2dvi is defunct: use Rd2pdf instead"
>     exit 1
>     ;;
>   *)
>     if test -x "${R_HOME}/bin/${1}"; then
>       cmd="${R_HOME}/bin/${1}"
>     else
>       cmd="${1}"
>     fi
>     ;;
> esac
> shift
>
> exec "${cmd}" ${extra} "${@}"
>
> I.e., except for setting up variables and such, R CMD ${foo}
> essentially looks for ${R_HOME}/bin/${foo} and executes it if it
> exists and is executable, otherwise it just executes ${foo}.

Thanks for that detailed explanation of the mechanism - it is much
clearer now. And as usual, if one knows how something is happening, it's
not "magical" anymore. 

>
> Notice that, somewhat contrary to what Dirk said, this logic works at
> the mercy of the file system when it comes to case sensitivity. On OSX
> with the default case-insensitive setup we get
>
> Peters-iMac:IBP pd$ R CMD install
> Error: ERROR: no packages specified
>
> which comes from R's package installer, whereas a case-sensitive FS
> would pick up /usr/bin/install instead. That is just how the "test"
> shell built-in works:
>
> Peters-iMac:~ pd$ test -x `R RHOME`/bin/INSTALL ; echo $?
> 0
> Peters-iMac:~ pd$ test -x `R RHOME`/bin/UNSTALL ; echo $?
> 1
> Peters-iMac:~ pd$ test -x `R RHOME`/bin/install ; echo $?
> 0

Yeah - true. I was already starting to wonder as I always was using ~R
CMD install~ and it always worked on my Mac.

Thanks again,

Rainer

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug

PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 454 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20151029/a723b94f/attachment.bin>

From brodie.gaslam at yahoo.com  Fri Oct 30 19:34:25 2015
From: brodie.gaslam at yahoo.com (brodie gaslam)
Date: Fri, 30 Oct 2015 18:34:25 +0000 (UTC)
Subject: [Rd] match.call enhancements in 3.2.2
References: <1204411940.5974386.1446230065057.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <1204411940.5974386.1446230065057.JavaMail.yahoo@mail.yahoo.com>

I was thrilled to see this in the change log:
> match.call() gains an envir argument for specifying the environment from which to retrieve the ... in the call, if any; this environment was wrong (or at least undesirable) when the definition argument was a function.
This was an issue I ran into a few years ago.? I ended up writing my own version that allows specification of the environment, but being able to rely on the built in R version seems much better.? That said, one issue remains as far as I can tell: if the `...` values are expressions they are substituted by `..1`, `..2`, etc.? For example:
> fun0 <- function(...) {
>?? fun_gpar <- function(b, ...) {
>???? fun_par <- function(a)
>?????? match.call(fun_gpar, sys.call(sys.parent()), envir=parent.frame(2L))
>???? fun_par()
>?? }
>?? fun_gpar(...)
> }
> fun0(999, 2 + 2, 3 * pi(), 4)

Returns:
> fun_gpar(b = 999, ..2, ..3, 4)
Instead of:

> fun_gpar(b = 999, 2 + 2, 3 * pi(), 4)
This is better than what used to happen before we had access to the `envir` parameter:

> fun_gpar(b = ..1, ..2, 4)
The dot substitution happens in `subDots` in `main/src/unique.c at 1228` (in 3.2.2 sources available as of today in CRAN).? Here is a snippet from that function:
>??? for(a = dots, b = rval, i = 1; i <= len; a = CDR(a), b = CDR(b), i++) {
>??? ??? SET_TAG(b, TAG(a));
>??? ??? t = CAR(a);
>??? ??? while (TYPEOF(t) == PROMSXP)
>??? ??? ??? t = PREXPR(t);
>??? ??? if( isSymbol(t) || isLanguage(t) )
>??? ??? ??? SETCAR(b, installDDVAL(i));?? // <-- HERE
>??? ??? else
>??? ??? ??? SETCAR(b, t);
>??? }

The `installDDVAL(i)` generates the `..X` symbols.? I'm sure there is a very good reason why this is done, but then it does lead to the issues above.
Am I just doing something wrong?
My workaround (https://github.com/brodieG/matchcall) addresses both the `..X` issue as well as the environment issue, but I'd prefer to deprecate it in favor of a base R solution if possible.
B.

	[[alternative HTML version deleted]]


From chiefmurphy at gmail.com  Fri Oct 30 21:15:05 2015
From: chiefmurphy at gmail.com (Dan Murphy)
Date: Fri, 30 Oct 2015 13:15:05 -0700
Subject: [Rd] cut.default labels when short range
Message-ID: <CAHgH9_FVdqd6Zs+1DTAwU36F8rt-6nHeJQneD2S+jAEW7cVfFQ@mail.gmail.com>

Hello:

I stumbled across an anomaly when running cut(4,4) in that the
rightmost level's right endpoint did not display the expansion of the
range as per ?cut.default. Modifying the last example there
cut(0:6, 3)
produces the documented behavior, as does
cut(0:6, 6)
but not
cut(0:5, 5)
However,
cut(0:5, 5, dig.lab = 4)
works.

Perhaps there is another documented point I am overlooking?

Thanks for all your great work.
Dan


From luckbuttered at gmail.com  Sat Oct 31 21:14:06 2015
From: luckbuttered at gmail.com (Luck Buttered)
Date: Sat, 31 Oct 2015 15:14:06 -0500
Subject: [Rd] Example input data with example output using relative pathway
 in vignette of R package?
Message-ID: <CAGRPoRSBs2-dc=KhqDrOA4fK8U0oHF89LY2=gF9rPE9shqOYag@mail.gmail.com>

I'm putting together an R package. I would like to show example code in the
vignette, where example data files (included in the package) are used to
generate an (example) output file.

I read about using example data in Hadley Wickham's post (
http://r-pkgs.had.co.nz/data.html), and believe I should keep my example
data as raw data, as it must be parsed to generate the output.

So, I created a directory in my package structure

/Users/userName/myPackage/inst/extdata/

with subdirectories InputFiles and OutputFiles.

And I put the example file (exampleData.csv) inside of the InputFiles
subdirectory (/Users/userName/myPackage/inst/extdata/InputFiles).

My vignette is located in:

/Users/userName/myPackage/vignettes/myPackage.Rnw

It contains the following syntax:

<<eval=FALSE>>=
fileString = "/Users/userName/myPackage/inst/extdata/InputFiles/exampleData.csv"
doFunction1(fileString)
doFunction2(fileString)
doFunction3(fileString, output
="Users/userName/myPackage/inst/extdata/OutputFiles")@

I am having two problems with developing this vignette and its example
datasets:

1) I am unsure if my use of the extdata file is appropriate. This seemed to
be the best directory name and location to place my example files,
according to the aforementioned Hadley Wickham reference.

2) I am unsure how to make the pathways relative, instead of absolute, as I
have them currently. This example code does not run automatically, as you
can see. Instead, I have it under an R chunk of eval=FALSE so that it is
simply listed there for the users to test themselves. After running the
example code, the users can also check that the output file was indeed
created in (/Users/userName/myPackage/inst/extdata/OutputFiles). What is
the best way for me to allow the user to not have to use an absolute path
when following the example? Is it possible to just follow a relative path
from within the package directory myPackage? I cannot create a help manual
(AFAIK) because this example code is not just an example of running one
function; instead, it is an example of running several functions and then
viewing the output.

If it would make more sense for me to just run the R chunk with eval=TRUE,
I would have the same question: How could I get it to automatically run
with just relative pathways?

Thank you for any advice!

	[[alternative HTML version deleted]]


From tobias.verbeke at openanalytics.eu  Sat Oct 31 21:59:48 2015
From: tobias.verbeke at openanalytics.eu (Tobias Verbeke)
Date: Sat, 31 Oct 2015 21:59:48 +0100 (CET)
Subject: [Rd] Example input data with example output using relative
 pathway in vignette of R package?
In-Reply-To: <CAGRPoRSBs2-dc=KhqDrOA4fK8U0oHF89LY2=gF9rPE9shqOYag@mail.gmail.com>
References: <CAGRPoRSBs2-dc=KhqDrOA4fK8U0oHF89LY2=gF9rPE9shqOYag@mail.gmail.com>
Message-ID: <1128761089.6735862.1446325188228.JavaMail.zimbra@openanalytics.eu>

Hi Luck,

If your package is installed, 

system.file("extdata", "InputFiles", package = "myPackage")

will give you the full path of the InputFiles directory.

See ?system.file for more details.

HTH,
Tobias

----- Original Message -----
> From: "Luck Buttered" <luckbuttered at gmail.com>
> To: "r-devel at r-project.org" <r-devel at r-project.org>
> Sent: Saturday, October 31, 2015 9:14:06 PM
> Subject: [Rd] Example input data with example output using relative pathway in vignette of R package?

> I'm putting together an R package. I would like to show example code in the
> vignette, where example data files (included in the package) are used to
> generate an (example) output file.
> 
> I read about using example data in Hadley Wickham's post (
> http://r-pkgs.had.co.nz/data.html), and believe I should keep my example
> data as raw data, as it must be parsed to generate the output.
> 
> So, I created a directory in my package structure
> 
> /Users/userName/myPackage/inst/extdata/
> 
> with subdirectories InputFiles and OutputFiles.
> 
> And I put the example file (exampleData.csv) inside of the InputFiles
> subdirectory (/Users/userName/myPackage/inst/extdata/InputFiles).
> 
> My vignette is located in:
> 
> /Users/userName/myPackage/vignettes/myPackage.Rnw
> 
> It contains the following syntax:
> 
> <<eval=FALSE>>=
> fileString = "/Users/userName/myPackage/inst/extdata/InputFiles/exampleData.csv"
> doFunction1(fileString)
> doFunction2(fileString)
> doFunction3(fileString, output
> ="Users/userName/myPackage/inst/extdata/OutputFiles")@
> 
> I am having two problems with developing this vignette and its example
> datasets:
> 
> 1) I am unsure if my use of the extdata file is appropriate. This seemed to
> be the best directory name and location to place my example files,
> according to the aforementioned Hadley Wickham reference.
> 
> 2) I am unsure how to make the pathways relative, instead of absolute, as I
> have them currently. This example code does not run automatically, as you
> can see. Instead, I have it under an R chunk of eval=FALSE so that it is
> simply listed there for the users to test themselves. After running the
> example code, the users can also check that the output file was indeed
> created in (/Users/userName/myPackage/inst/extdata/OutputFiles). What is
> the best way for me to allow the user to not have to use an absolute path
> when following the example? Is it possible to just follow a relative path
> from within the package directory myPackage? I cannot create a help manual
> (AFAIK) because this example code is not just an example of running one
> function; instead, it is an example of running several functions and then
> viewing the output.
> 
> If it would make more sense for me to just run the R chunk with eval=TRUE,
> I would have the same question: How could I get it to automatically run
> with just relative pathways?
> 
> Thank you for any advice!
> 
>	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


