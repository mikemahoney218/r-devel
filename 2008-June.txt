From jmc at r-project.org  Sun Jun  1 17:30:13 2008
From: jmc at r-project.org (John Chambers)
Date: Sun, 01 Jun 2008 11:30:13 -0400
Subject: [Rd] NAMESPACE & methods guidance, please
In-Reply-To: <6phd4n3lfwi.fsf@lamprey.fhcrc.org>
References: <6phd4n3lfwi.fsf@lamprey.fhcrc.org>
Message-ID: <4842C085.9010500@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080601/30e555ff/attachment.pl>

From hkawakat at gmail.com  Sun Jun  1 17:41:31 2008
From: hkawakat at gmail.com (Hiroyuki Kawakatsu)
Date: Sun, 1 Jun 2008 16:41:31 +0100
Subject: [Rd] suggested addition to fft man page
Message-ID: <307b90470806010841h5a60e252w6c0292f9984d1f1@mail.gmail.com>

Hi,

May I request that the formula for fft() be included in the man page?
This is the second time I had to check what fft() does... In fact,
fft.Rd has
  %%
  %% Here, we should really have a nice  \deqn{}{} giving the definition
  %% of the DFT !
  %%
Below is a suggested snippet (not necessarily "nice") to be added to
fft.Rd; please feel free to improve it.

  %%---begin{hiroyuki}
  \code{y <- fft(z)} returns
  \deqn{y[h] = \sum_{k=1}^n z[k] \exp(-2\pi i (k-1)(h-1)/n)}{%
    y[h] = sum_{k=1}^{n} z[k]*exp(-2*pi*1i*(k-1)*(h-1)/n)}
  for \eqn{h = 1,\ldots,n}{h = 1, ..., n} where n = \code{length(y)}. If
  \code{inverse} is \code{TRUE}, \eqn{\exp(-2\pi\ldots)}{exp(-2*pi...)}
  is replaced with \eqn{\exp(2\pi\ldots)}{exp(2*pi...)}.
  %%---end{hiroyuki}

Thanks for your consideration,
h.
p.s. fft.c was not "readable" so i used the following code to check the formula:

# to check fft formula
fft_slow <- function(z, inverse=FALSE) {
  n <- length(z)
  kdx <- seq(0, n-1)
  sgn <- ifelse(inverse, 1, -1)
  y <- rep(NA, n)
  for (h in 1:n) y[h] <- sum(z*exp(sgn*2*pi*1i*kdx*(h-1)/n))
  y
}

set.seed(1)
n <- 2^3
for (i in 1:10) {
  z <- complex(n, rnorm(n), rnorm(n))
#print(z)
  cat(sprintf("diff(inv=F) = %5.3e, diff(inv=T) = %5.3e\n",
              max(abs(fft(z) - fft_slow(z))),
              max(abs(fft(z, inverse=TRUE) - fft_slow(z, inverse=TRUE)))))
}

-- 
----------------------------------
Hiroyuki Kawakatsu
Business School
Dublin City University
Dublin 9, Ireland
Tel +353 (0)1 700 7496


From seth at userprimary.net  Sun Jun  1 20:15:56 2008
From: seth at userprimary.net (Seth Falcon)
Date: Sun, 1 Jun 2008 11:15:56 -0700
Subject: [Rd] NAMESPACE & methods guidance, please
In-Reply-To: <4842C085.9010500@r-project.org>
References: <6phd4n3lfwi.fsf@lamprey.fhcrc.org>
	<4842C085.9010500@r-project.org>
Message-ID: <20080601181555.GA647@ziti.local>

* On 2008-06-01 at 11:30 -0400 John Chambers wrote:
> My impression (but just as a user, not an implementer) is that the 
> NAMESPACE mechanism is intended to search for anything, not just for 
> methods, as follows:
> 
>  - look in the namespace itself;
>  - look in the imports, which are in the parent.env of the namespace;
>  - look in the base package's namespace.

As described in the R News article [1], the above describes the static
component of the search mechanism, but there is a dynamic component
which adds:

    - look in .GlobalEnv
    - look in each package on the search path
    - look (again) in base

[1] http://cran.r-project.org/doc/Rnews/Rnews_2003-1.pdf

> Period.  This provides a definition of the behavior of functions in the 
> package that is independent of the dynamically changing contents of the 
> search list.

I think the dynamic lookup is important.  Consider class Foo and some
methods, like show, for working with Foo instances defined in pkgA.
Further, suppose pkgB imports pkgA and contains a function that
returns a Foo instance.

If a user class library("pkgB") at the prompt, both the developer and
the user would like for methods for dealing with Foo instances to be
available.

This has been achieved by adding pkgA to the Depends field of pkgB.
In this case, library("pkgB") has the side-effect of attaching pkgA to
the search path and Foo instances behave as desired.  This, I believe,
describes the first part of Martin's example:

Martin Morgan:
> >> library(KEGG.db) # Imports, Depends AnnotationDbi; KEGG.db is data-only
> >> head(ls(KEGGPATHID2EXTID))
> >>     
> > [1] "hsa00232" "hsa00230" "hsa04514" "hsa04010" "hsa04012" "hsa04150"
> >

John Chambers:
> "Depends" may cause the relevant packages to be put on the search list. 
> But a subsequent attach or detach could change what objects were found.  
> So unless this is not the intended interpretation of namespaces, looking 
> in the search list seems a bad idea in principle.

I agree that using the dynamic lookup when the static lookup is
available is bad programming practice.  However, given the flexibility
of the current tools, it seems not unreasonable to expect that
picking up a method via the search path would work in a package just
as it does (should?) interactively.


+ seth

-- 
Seth Falcon | http://userprimary.net/user/


From maechler at stat.math.ethz.ch  Mon Jun  2 11:36:02 2008
From: maechler at stat.math.ethz.ch (maechler at stat.math.ethz.ch)
Date: Mon,  2 Jun 2008 11:36:02 +0200 (CEST)
Subject: [Rd] (PR#11537) help (using ?) does not handle trailing
	whitespace
Message-ID: <20080602093602.8566B283416D@mail.pubhealth.ku.dk>

>>>>> "BDR" == Prof Brian Ripley <ripley at stats.ox.ac.uk>
>>>>>     on Fri, 30 May 2008 22:34:28 +0100 (BST) writes:

    BDR> I think it is ESS that is parsing this as a help
    BDR> request (so it can divert it to an ESS buffer).

    BDR> Looks like this is an ESS issue, not an R one.

yes, indeed,  hence much more belonging the ESS-help mailing
list (or the 'ESS-bugs' e-mail alias).
I'm diverting to that list; please keep follow-ups to this
topic off R-devel.

As most ESS users are aware, ESS is "picking up"
?<...> calls, and indeed then calls help() for these.
In R,  '?' has become different from help() more and more,
and it is currently the most urgent open issue in ESS,
that ESS should become much smarter in dealing with '?', the 
various 'type ? topic' version and new '??', etc.


Martin Maechler, ETH Zurich

    BDR> Using ?"agrep " will fail in R, but that seems correct as there is no 
    BDR> topic "agrep ".


    BDR> On Fri, 30 May 2008, Tim Hesterberg wrote:

    >> By whitespace, I mean either a space or tab (preceding the newline).
    >> 
    >> I'm using ESS:
    >> ess-version's value is "5.3.6"
    >> GNU Emacs 21.4.1 (i486-pc-linux-gnu, X toolkit, Xaw3d scroll bars) of
    >> 2007-08-28 on terranova, modified by Debian
    >> 
    >> I have the following in my .emacs:
    >> (load "ess-5.3.6/lisp/ess-site")
    >> (setq ess-tab-always-indent nil)
    >> (setq ess-fancy-comments nil)
    >> 
    >> I have not edited ess-site.el
    >> 
    >> 
    >> On Fri, May 30, 2008 at 12:26 PM, Prof Brian Ripley
    >> <ripley at stats.ox.ac.uk> wrote:
    >>> We don't know how to reproduce this: 'whitespace' is not specific enough.
    >>> 
    >>> R's tokenizer breaks input at spaces, so a space would never be part of that
    >>> expression.  And tabs don't even get to the parser in interactive use, and
    >>> you cannot mean a newline.  So exactly what do you mean by 'whitespace'?
    >>> 
    >>> The character in your email as received here is an ASCII space, and that is
    >>> used to end the token on all my systems.  That's not to say that you didn't
    >>> type something else that looks like a space (e.g. a nbspace) since email
    >>> systems are fickle.
    >>> 
    >>> None of my guesses worked, so we need precise reproduction instructions.
    >>> 
    >>> On Thu, 29 May 2008, rocket at google.com wrote:
    >>> 
    >>>>> ?agrep
    >>>>> 
    >>>> 
    >>>> Results in:
    >>>> 
    >>>> No documentation for 'agrep ' in specified packages and libraries:
    >>>> you could try 'help.search("agrep ")'
    >>>> 
    >>>> There is white space after agrep, that ? doesn't ignore.
    >>>> 
    >>>> 
    >>>> --please do not edit the information below--
    >>>> 
    >>>> Version:
    >>>> platform = i486-pc-linux-gnu
    >>>> arch = i486
    >>>> os = linux-gnu
    >>>> system = i486, linux-gnu
    >>>> status =
    >>>> major = 2
    >>>> minor = 7.0
    >>>> year = 2008
    >>>> month = 04
    >>>> day = 22
    >>>> svn rev = 45424
    >>>> language = R
    >>>> version.string = R version 2.7.0 (2008-04-22)
    >>>> 
    >>>> Locale:
    >>>> 
    >>>> LC_CTYPE=en_US;LC_NUMERIC=C;LC_TIME=C;LC_COLLATE=C;LC_MONETARY=C;LC_MESSAGES=en_US;LC_PAPER=en_US;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US;LC_IDENTIFICATION=C
    >>>> 
    >>>> Search Path:
    >>>> .GlobalEnv, package:stats, package:graphics, package:grDevices,
    >>>> package:utils, package:datasets, package:showStructure, package:Rcode,
    >>>> package:splus2R, package:methods, Autoloads, package:base
    >>>> 
    >>>> ______________________________________________
    >>>> R-devel at r-project.org mailing list
    >>>> https://stat.ethz.ch/mailman/listinfo/r-devel
    >>>> 
    >>> 
    >>> --
    >>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
    >>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
    >>> University of Oxford,             Tel:  +44 1865 272861 (self)
    >>> 1 South Parks Road,                     +44 1865 272866 (PA)
    >>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
    >>> 
    >> 

    BDR> -- 
    BDR> Brian D. Ripley,                  ripley at stats.ox.ac.uk
    BDR> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
    BDR> University of Oxford,             Tel:  +44 1865 272861 (self)
    BDR> 1 South Parks Road,                     +44 1865 272866 (PA)
    BDR> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

    BDR> ______________________________________________
    BDR> R-devel at r-project.org mailing list
    BDR> https://stat.ethz.ch/mailman/listinfo/r-devel


From jmc at r-project.org  Mon Jun  2 15:22:39 2008
From: jmc at r-project.org (John Chambers)
Date: Mon, 02 Jun 2008 09:22:39 -0400
Subject: [Rd] NAMESPACE & methods guidance, please
In-Reply-To: <20080601181555.GA647@ziti.local>
References: <6phd4n3lfwi.fsf@lamprey.fhcrc.org>
	<4842C085.9010500@r-project.org> <20080601181555.GA647@ziti.local>
Message-ID: <4843F41F.30803@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080602/771e9b4d/attachment.pl>

From jmc at r-project.org  Mon Jun  2 16:39:32 2008
From: jmc at r-project.org (John Chambers)
Date: Mon, 02 Jun 2008 10:39:32 -0400
Subject: [Rd] Revised help pages for methods package
Message-ID: <48440624.4080702@r-project.org>

A number of the help pages have been revised, so far only on the r-devel 
version, although the great majority of the revisions apply to 2.7.0 as 
well.

Much of the existing documentation is out of date, some of it badly.  
Also, a goal of the revision is that readers could start with 
package?methods and navigate down through some general pages to 
details.  (Not by any means as an introduction to the topic, but for 
clarifications and for details.)

I hope eventually to revise most of the pages, but only a dozen or so 
have been done at this point (including, however, many of the key 
topics).   Another reason for delay was that the new pages reference the 
"Software for Data Analysis" book, which was supposed to be out by now, 
but is not "quite" (questions on that topic have to go to the publisher).

However, it seems useful to distribute these revisions now, as the 
topics come up, for example, in this mailing list fairly often.

John


From mike.prager at noaa.gov  Mon Jun  2 22:29:16 2008
From: mike.prager at noaa.gov (Mike Prager)
Date: Mon, 02 Jun 2008 16:29:16 -0400
Subject: [Rd] Request: Documentation of formulae
References: <o5n044t0444q8a0ne9ci4a8gv6kqknhrqg@4ax.com>
Message-ID: <jql844p3q5tr6fsnrs5upiuapnt8gqguf7@4ax.com>

Mike Prager <mike.prager at noaa.gov> wrote:

> I was at a loss to understand the use of "/" until I looked in
> "An Introduction [!] to R," where I found the explanation. 
> 
> My request is that more complete material on model formulae be
> lifted from "Introduction to R" (or elsewhere) and put into the
> main online help files. 

I also request the R Core consider remaining "An Introduction to
R" to something like "R User's Guide." It spans 100 pages and
treats many topics far beyond the introductory level. I was
surprised at the wealth of information it contains, and I expect
that I would have checked it first, not last, among available
resources had it been more accurately named.

-- 
Mike Prager, NOAA, Beaufort, NC
* Opinions expressed are personal and not represented otherwise.
* Any use of tradenames does not constitute a NOAA endorsement.


From mwkimpel at gmail.com  Tue Jun  3 05:42:17 2008
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Mon, 2 Jun 2008 23:42:17 -0400
Subject: [Rd] configure.args from install.packages passed on to subsequent
	update.packages?
Message-ID: <6b93d1830806022042x2c310eddifb00eb1a7791364a@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080602/4ac5a184/attachment.pl>

From mwkimpel at gmail.com  Tue Jun  3 05:56:16 2008
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Mon, 2 Jun 2008 23:56:16 -0400
Subject: [Rd] benchmarking R installations
Message-ID: <6b93d1830806022056o274e97c3i8d954748e17f6a81@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080602/41f6ca4c/attachment.pl>

From iverson at biostat.wisc.edu  Tue Jun  3 07:20:59 2008
From: iverson at biostat.wisc.edu (Erik Iverson)
Date: Tue, 03 Jun 2008 00:20:59 -0500
Subject: [Rd] More information on R segfaults, tcltk package,
	and graphics devices
Message-ID: <4844D4BB.7090806@biostat.wisc.edu>

Dear R-devel -

I have investigated the report I made at 
https://stat.ethz.ch/pipermail/r-devel/2008-May/049683.html some more, 
and believe I have enough information to warrant an update.  My 
sessionInfo() immediately after starting R is at the bottom of this message.

I decided to first concentrate on finding out why I sometimes receive a 
segfault while closing a graphics window while the window is redrawing 
after resizing it, but seemingly only after loading the tcltk package.

I do the following code in a --vanilla R session.

library(grid)
library(tcltk)
for(i in seq(0, 1, by = .1)) {
    for(j in seq(0, 1, by = .01)) {
      angle <- runif(1, 1, 180)
      col <- sample(colors(), 1)
      pushViewport(viewport(x = i, y= j, width = .1, height = .1,
                            angle = angle, gp = gpar(col = col)))
      grid.rect()
      popViewport()
    }
}

I then simply resize the X11 window a bit to force a redraw of the 
graphic, and then rapidly hit the 'X' close button on the X11 window 
while the rectangles are redrawing.  I will often get the behavior that 
the window closes and R segfaults.

The gdb backtraces from the core dumps I produced mostly were failing in 
GEcheckState from engine.c, but it was not clear to me what was going on 
from the backtrace.

After much trial and error, I decided to put a breakpoint in the 
removeDevice function from device.c.

I then do what I describe above, and get the following backtrace from 
gdb, edited to show what I think is going on.

(gdb) bt
#0  removeDevice (devNum=1, findNext=TRUE) at devices.c:307
#1  0xb7962855 in handleEvent (event=
         {type = 33, xany = {type = 33, serial = 15621, send_event = 1,
...(snip)...
, 268686226}})
     at devX11.c:627
#2  0xb796296c in R_ProcessX11Events (data=0x0) at devX11.c:665
#3  0x080fd99c in R_runHandlers (handlers=0x8263d28, readMask=0x82cf6a0) 
at sys-std.c:363
#4  0xb74e159e in RTcl_eventProc (evPtr=0x97dfbf0, flags=-1) at 
tcltk_unix.c:136
#5  0xb749d6a3 in Tcl_ServiceEvent () from /usr/lib/libtcl8.4.so.0
#6  0xb749da32 in Tcl_DoOneEvent () from /usr/lib/libtcl8.4.so.0
#7  0xb74e14ee in TclSpinLoop (data=0x0) at tcltk_unix.c:60
#8  0x0814d4a6 in R_ToplevelExec (fun=0xb74e14d0 <TclSpinLoop>, 
data=0x0) at context.c:604
#9  0xb74e14b2 in TclHandler () at tcltk_unix.c:67
#10 0x08184f11 in R_CheckUserInterrupt () at errors.c:125
#11 0x0818d5cc in Rf_eval (e=0x8ab3010, rho=0x858f6f8) at eval.c:370

... (snip)... Many Rf_eval, Rf_applyClosure, etc.

#73 0x08173480 in do_recordGraphics (call=0x8308040, op=0x83223e0, 
args=0x91f4c58,
     env=0x8308040) at engine.c:2757
#74 0x081730a7 in GEplayDisplayList (dd=0x974f8e0) at engine.c:2547
#75 0xb7962659 in handleEvent (event=
         {type = 12, xany = {type = 12, serial = 14493, send_event = 0, 
...snip...
#79 0x0805b0ca in Rf_ReplIteration (rho=0x832ac68, savestack=0, 
browselevel=0, state=0xbffbbc34)
     at main.c:206
#80 0x0805b1ea in R_ReplConsole (rho=0x832ac68, savestack=0, 
browselevel=0) at main.c:306
#81 0x0805b4d8 in run_Rmainloop () at main.c:967
#82 0x08058d91 in main (ac=0, av=0x0) at Rmain.c:35
#83 0xb7d61450 in __libc_start_main () from /lib/tls/i686/cmov/libc.so.6
#84 0x08058cc1 in _start ()

What seems to be happening is during the 	
while (theList != R_NilValue && plotok)
loop in GEplayDisplayList, at some point R_CheckUserInterrupt can be 
called, and if the tcltk package has been loaded, its TclHandler is 
called, which eventually ends up getting removeDevice called, as the 
backtrace above shows.  From there, and please excuse my possibly loose 
terminology here, the device no longer exists to R, and accessing the 
'dd' variable as in GEcheckState can cause a segfault, if something did 
not already go wrong while replaying the display list, such as the 
strange grid errors such as "Cannot pop top-level viewport" and 
"VECTOR_ELT() can only be applied to a 'list', not a 'NULL'" messages I 
had been receiving.

Now, I have no idea if there is a fix, or how to go about it at this 
point, but I believe that is what is happening, so if anyone wants to 
investigate it further, this should be a good starting point. Perhaps 
the relevant advice here is "Don't do that".

Please ask if I have not been clear enough or additional information 
from gdb is needed.

Best,
Erik Iverson
iverson at biostat.wisc.edu

sessionInfo()
R version 2.7.0 (2008-04-22)
i686-pc-linux-gnu

locale:
LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base


From maechler at stat.math.ethz.ch  Tue Jun  3 08:48:46 2008
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 3 Jun 2008 08:48:46 +0200
Subject: [Rd] Request: Documentation of formulae
In-Reply-To: <jql844p3q5tr6fsnrs5upiuapnt8gqguf7@4ax.com>
References: <o5n044t0444q8a0ne9ci4a8gv6kqknhrqg@4ax.com>
	<jql844p3q5tr6fsnrs5upiuapnt8gqguf7@4ax.com>
Message-ID: <18500.59726.138353.724757@stat.math.ethz.ch>

>>>>> "MP" == Mike Prager <mike.prager at noaa.gov>
>>>>>     on Mon, 02 Jun 2008 16:29:16 -0400 writes:

    MP> Mike Prager <mike.prager at noaa.gov> wrote:
    >> I was at a loss to understand the use of "/" until I looked in
    >> "An Introduction [!] to R," where I found the explanation. 
    >> 
    >> My request is that more complete material on model formulae be
    >> lifted from "Introduction to R" (or elsewhere) and put into the
    >> main online help files. 

    MP> I also request the R Core consider remaining "An Introduction to
    MP> R" to something like "R User's Guide." It spans 100 pages and
    MP> treats many topics far beyond the introductory level. I was
    MP> surprised at the wealth of information it contains, and I expect
    MP> that I would have checked it first, not last, among available
    MP> resources had it been more accurately named.

Hi Mike, you make very worthy suggestions; but I assume the word
"request" is really putting off almost all of us "R corers".
You *have* heard that R is a volunteer project, that much of its
development has happened in unpaid time of core team mates.
Why are you not using "Suggestion" instead?

Also, since it's a volunteer project, and you are a capable R
user, you could even consider sending patches, e.g. to the 
formula.Rd  help page.

At last, to the renaming suggestion: I see your point, but

1) in "an Intro" one is allowed to be non-comprehensive
   where as a "user's guide" is supposedly touching almost
   everything relevant.  This is not the case, since R has much
   evolved since the "An Intro .." had been compiled, and most
   new features are not mentioned in the intro.

2) I don't know your background, but in the math sciences, there
   exist quite a few comprehensive textbooks called "An
   Introduction to ...".
   One example from my bookshelf is
   @BOOK{AndT84,
     author = 	{T. W. Anderson},
     title = 	{An Introduction to Multivariate Statistical Analysis},
     publisher = Wiley,
     address =	NY,
     year = 	1984
   }


3) "An Introduction to R" is mentioned in many many pieces of
   documentation about R; from instructions to students, to
   online guides, to books, etc.

   For this reason, a new title should reall still contain the
   term.

   Maybe simply
	"An Introduction to R --- User's guide"
?
   
Best regards,
Martin Maechler, ETH Zurich


From pmc1 at cornell.edu  Tue Jun  3 01:40:17 2008
From: pmc1 at cornell.edu (pmc1 at cornell.edu)
Date: Tue,  3 Jun 2008 01:40:17 +0200 (CEST)
Subject: [Rd] significant digits (PR#9682)
Message-ID: <20080602234017.CB1FD282C786@mail.pubhealth.ku.dk>

I came to report this same bug and found it already in the trash, but
I slightly disagree with that assessment. If it's not a bug, then
perhaps it's a feature request. Comments at the end.

On Mon, May 14, 2007, Duncan Murdoch wrote:
>>On 13/05/2007 8:46 PM, scott.wilkinson at csiro.au wrote:
>>
>> In the example below round() does not report to the specified number of
>> digits when the last digit to be reported is zero: Compare behaviour for
>> 0.897575 and 0.946251. Ditto for signif(). The number of sigfigs is
>> ambiguous unless the reader knows this behaviour. Is this a bug or
>> intended behaviour? Is there a work-around?
>
> It's not a bug.  It has nothing to do with round(), it is the way R
> prints numbers by default.  If you ask to print 0.90, you'll get
>
> [1] 0.9
>
> because 0.9 and 0.90 are the same number.  If you want trailing zeros to
> print, you need to specify a format to do that, e.g.
>
> > noquote(format(0.9, nsmall=2))
> [1] 0.90
>
> The noquote stops the "" from printing.  You could also use sprintf() or
> formatC() for more C-like format specifications.

All of those options require you to specify the number of digits after
the decimal, don't they? Unless sprintf would default to the number of
decimal places passed to it, but it doesn't:

    > sprintf("%f",signif(0.90, digits=2))
    [1] "0.900000";

it defaults to 6. Although %g behaves differently,

    > sprintf("%g",signif(0.90, digits=2))
    [1] "0.9",

this clearly still isn't the desired behavior.

To continue that vein, the same issue with rounding versus printing
occurs with vectors:

      > sapply(c(1:6),function(a){signif(c(18.423,0.90),digits=a)})
          [,1] [,2] [,3]  [,4]   [,5]   [,6]
     [1,] 20.0 18.0 18.4 18.42 18.423 18.423
     [2,]  0.9  0.9  0.9  0.90  0.900  0.900

Trying to get that and more complicated tables to print the correct
number of significant digits gets pretty hairy with sprintf(). I could
be wrong, but I would view the primary purpose of rounding to
significant digits the printed output of the number. That there
doesn't seem to be a way to do this without later having to specify
the number of decimal places would seem to render signif() as it's
written not particularly useful.

There are two solutions I can think of off the top of my head. The
first is to create a new data type of a fixed length real number but
the easier way would be to have a function that returns a string
something like this:

signif.string <- function(signum,sigdigs){
  left <- nchar(trunc(signum))
  right <- nchar(signum-trunc(signum))-2
  if (abs(signum)<1 | signum<0) {left<-left-1}
  if (right<0) {right<-0}
  if (sigdigs<left) {return(as.character(signif(signum,digits=sigdigs)))}
  else if (sigdigs==left) {return(paste(round(signum),".",sep=""))}
  else if (sigdigs<=left+right) {return(format(signum,digits=sigdigs))}
  else {return(sprintf(paste("%.",sigdigs-left,"f",sep=""),signum))}
}

This is just a skeleton that I think suits my needs for the moment and
might also cover the original poster's. One for production would need
to handle scientific notation and would probably want to fix the 5
round behavior on windows.

Pat Carr

version.string R version 2.7.0 (2008-04-22)


From pmc1 at cornell.edu  Tue Jun  3 03:30:19 2008
From: pmc1 at cornell.edu (pmc1 at cornell.edu)
Date: Tue,  3 Jun 2008 03:30:19 +0200 (CEST)
Subject: [Rd] significant digits (PR#9682)
Message-ID: <20080603013019.7445F282C786@mail.pubhealth.ku.dk>

To reply to my own message, that function wasn't quite right. I think
this one works better:

signif.string <- function(signum,sigdigs){
  test <- abs(signum)
  left <- nchar(trunc(test))
  right <- nchar(test)-left-1
  if (test<1) {left<-left-1}
  if (right<0) {right<-0}
  if (sigdigs<left) {out<-as.character(signif(signum,digits=sigdigs))}
  else if (sigdigs==left & trunc(signum) %% 10 == 0)
{out<-paste(round(signum),".",sep="")}
  else if (sigdigs<=left+right) {out<-format(signum,digits=sigdigs)}
  else {out<-sprintf(paste("%.",sigdigs-left,"f",sep=""),signum)}
  return(noquote(out))
}

But it should still have error checking and vector capability, yadda
yadda. Also, I forgot what year it was, so sorry, Scott, for spamming
you with something you're hopefully not still stuck on.

Pat Carr


From lpone at xs4all.nl  Tue Jun  3 09:58:07 2008
From: lpone at xs4all.nl (Ludo Pagie)
Date: Tue, 3 Jun 2008 09:58:07 +0200 (CEST)
Subject: [Rd] benchmarking R installations
In-Reply-To: <6b93d1830806022056o274e97c3i8d954748e17f6a81@mail.gmail.com>
References: <6b93d1830806022056o274e97c3i8d954748e17f6a81@mail.gmail.com>
Message-ID: <20080603095219.G53049@xs7.xs4all.nl>

recently there was a post on R-help/Rd ?? with this link on benchmarking 
different 'number crunching packages'. They used a series of tests, 
although I didn't check they used all the types you mentioned. I couldn't 
find test code at first glance but myyebe it is available on request???

http://www.sciviews.org/benchmark/

Ludo





On Mon, 2 Jun 2008, Mark Kimpel wrote:

> Recently I posted to this list with a question about using the Intel 10.1
> compilers in building R and one response was basically, "why in the heck
> would you want to do that?" The answer is that my sysadmin believes that
> there will be a performance boost with the Intel vs. Gnu compilers on our
> Linux cluster, of which I am one of many users. Wanting to be a good citizen
> and use my machine time wisely, I'd of course like to use right tool to
> build the most efficient installation of R and associated packages. BTW, we
> got R to compile nicely using the settings at the end of this post.
>
> Looking back on previous posts, however, it seems that there is no consensus
> as to how to benchmark R. I realize such a task is not trivial, nor
> controversial, but does anyone have a set of time-consuming tasks that can
> be used to compare R installations? It would seem logical that such a
> benchmark would include sub-benchmarks on file access, interpreted intensive
> tasks, C intensive tasks, BLAS intensive tasks, etc. You developers know
> more about this than I do, but I know enough to realize that there won't be
> one simple answer. Nevertheless, I'd like to make my usage decisions on
> something rather than anedotal claims.
>
> So, does anyone know of a good benchmarking script or would be willing to
> contribute one?
>
> And here are the settings we used to compile R with Intel 10.1 compilers:
>
> ../configure --prefix=/N/u/mkimpel/R_HOME/R-patched/R-build \
> --with-system-zlib=/usr/lib64 --with-system-bzlib=/usr/lib64 \
> --with-mpi=/N/soft/linux-rhel4-x86_64/openmpi/1.2.5/intel-64 --with-tcltk \
> --with-tcl-config=/N/soft/linux-rhel4-x86_64/tcl8.4.16/lib64/tclConfig.sh \
> --with-tk-config=/N/soft/linux-rhel4-x86_64/tk8.4.16/lib64/tkConfig.sh \
> --without-x --without-readline --without-iconv \
> CC="/N/soft/linux-rhel4-x86_64/intel/cce/10.1.013/bin/icc" \
> CFLAGS="-O3 -no-prec-div -unroll" \
> F77="/N/soft/linux-rhel4-x86_64/intel/fce/10.1.013/bin/ifort" \
> FFLAGS="-O3 -no-prec-div -unroll" \
> CXX="/N/soft/linux-rhel4-x86_64/intel/cce/10.1.013/bin/icpc" \
> CXXFLAGS="-O3 -no-prec-div -unroll" \
> FC="/N/soft/linux-rhel4-x86_64/intel/fce/10.1.013/bin/ifort" \
> FCFLAGS="-O3 -no-prec-div -unroll" \
> OBJC="/N/soft/linux-rhel4-x86_64/intel/cce/10.1.013/bin/icc" \
> OBJCFLAGS="-O3 -no-prec-div -unroll" \
> --disable-R-profiling --disable-memory-profiling
> ##
> make all
> make install
>
> Mark
>
> -- 
> Mark W. Kimpel MD ** Neuroinformatics ** Dept. of Psychiatry
> Indiana University School of Medicine
>
> 15032 Hunter Court, Westfield, IN 46074
>
> (317) 490-5129 Work, & Mobile & VoiceMail
> (317) 663-0513 Home (no voice mail please)
>
> ******************************************************************
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From Matthias.Kohl at stamats.de  Tue Jun  3 12:34:02 2008
From: Matthias.Kohl at stamats.de (Matthias Kohl)
Date: Tue, 03 Jun 2008 12:34:02 +0200
Subject: [Rd] R CMD check in R 2.8.0 checks also .svn folder
Message-ID: <48451E1A.2080908@stamats.de>

Dear developers,

we develop our packages via r-forge and svn. Under R version 2.8.0 Under 
development (unstable) (2008-06-02 r45826) I now observe the following 
warning for our package "distrEx"

* checking for executable files ... WARNING
Found the following executable file(s):
  src/.svn/text-base/distrEx.dll.svn-base
Source packages should not contain undeclared executable files.
See section 'Package structure' in manual 'Writing R Extensions'.

Hence, R CMD check also checks the .svn-folder. I don't mind to get this 
warning. I just would like to know if this is intended and if this might 
have an influence on package building. (This warning doesn't occur under 
R version 2.7.0 Patched (2008-06-03 r45828))

My session info is:
R version 2.8.0 Under development (unstable) (2008-06-02 r45826)
i686-pc-linux-gnu

locale:
LC_CTYPE=de_DE.UTF-8;LC_NUMERIC=C;LC_TIME=de_DE.UTF-8;LC_COLLATE=de_DE.UTF-8;LC_MONETARY=C;LC_MESSAGES=de_DE.UTF-8;LC_PAPER=de_DE.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=de_DE.UTF-8;LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

Best regards,
Matthias

-- 
Dr. Matthias Kohl
www.stamats.de


From S.Ellison at lgc.co.uk  Tue Jun  3 12:39:55 2008
From: S.Ellison at lgc.co.uk (S Ellison)
Date: Tue, 03 Jun 2008 11:39:55 +0100
Subject: [Rd] Request: Documentation of formulae
Message-ID: <s8452d92.086@tedmail.lgc.co.uk>

Rather than transport quantities of the Introduction to R (a perfectly
sensible title for a very good starting point, IMHO) would it not be
simpler and involve less maintenance to include a link or
cross-reference in the 'formula' help page to the relevant part of the
Introduction? If nothing else, that might get folk to look at the
Introduction if they've bypassed it ....

Steve E

>>> Martin Maechler <maechler at stat.math.ethz.ch> 03/06/2008 07:48:46
>>>
>>>>> "MP" == Mike Prager <mike.prager at noaa.gov>
    MP> Mike Prager <mike.prager at noaa.gov> wrote:
    >> I was at a loss to understand the use of "/" until I looked in
    >> "An Introduction [!] to R," where I found the explanation. 
    >> 
    >> My request is that more complete material on model formulae be
    >> lifted from "Introduction to R" (or elsewhere) and put into the
    >> main online help files. 


*******************************************************************
This email and any attachments are confidential. Any use...{{dropped:8}}


From murdoch at stats.uwo.ca  Tue Jun  3 12:36:44 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 03 Jun 2008 06:36:44 -0400
Subject: [Rd] significant digits (PR#9682)
In-Reply-To: <20080602234017.CB1FD282C786@mail.pubhealth.ku.dk>
References: <20080602234017.CB1FD282C786@mail.pubhealth.ku.dk>
Message-ID: <48451EBC.1000207@stats.uwo.ca>

pmc1 at cornell.edu wrote:
> I came to report this same bug and found it already in the trash, but
> I slightly disagree with that assessment. If it's not a bug, then
> perhaps it's a feature request. Comments at the end.
>
> On Mon, May 14, 2007, Duncan Murdoch wrote:
>   
>>> On 13/05/2007 8:46 PM, scott.wilkinson at csiro.au wrote:
>>>
>>> In the example below round() does not report to the specified number of
>>> digits when the last digit to be reported is zero: Compare behaviour for
>>> 0.897575 and 0.946251. Ditto for signif(). The number of sigfigs is
>>> ambiguous unless the reader knows this behaviour. Is this a bug or
>>> intended behaviour? Is there a work-around?
>>>       
>> It's not a bug.  It has nothing to do with round(), it is the way R
>> prints numbers by default.  If you ask to print 0.90, you'll get
>>
>> [1] 0.9
>>
>> because 0.9 and 0.90 are the same number.  If you want trailing zeros to
>> print, you need to specify a format to do that, e.g.
>>
>>     
>>> noquote(format(0.9, nsmall=2))
>>>       
>> [1] 0.90
>>
>> The noquote stops the "" from printing.  You could also use sprintf() or
>> formatC() for more C-like format specifications.
>>     
>
> All of those options require you to specify the number of digits after
> the decimal, don't they? Unless sprintf would default to the number of
> decimal places passed to it, but it doesn't:
>   

That specification doesn't make sense.  There is no "number of decimal 
places passed to it".  What sprintf() sees below is identical to what it 
would see if you called

sprintf("%f", 0.9)

because signif(0.90, digits=2) == 0.9.  Those two objects are identical.
>     > sprintf("%f",signif(0.90, digits=2))
>     [1] "0.900000";
>
> it defaults to 6. Although %g behaves differently,
>
>     > sprintf("%g",signif(0.90, digits=2))
>     [1] "0.9",
>
> this clearly still isn't the desired behavior.
>   

Maybe not what you desired, but certainly reasonable behaviour.  
> To continue that vein, the same issue with rounding versus printing
> occurs with vectors:
>
>       > sapply(c(1:6),function(a){signif(c(18.423,0.90),digits=a)})
>           [,1] [,2] [,3]  [,4]   [,5]   [,6]
>      [1,] 20.0 18.0 18.4 18.42 18.423 18.423
>      [2,]  0.9  0.9  0.9  0.90  0.900  0.900
>
> Trying to get that and more complicated tables to print the correct
> number of significant digits gets pretty hairy with sprintf(). I could
> be wrong, but I would view the primary purpose of rounding to
> significant digits the printed output of the number. That there
> doesn't seem to be a way to do this without later having to specify
> the number of decimal places would seem to render signif() as it's
> written not particularly useful.
>
> There are two solutions I can think of off the top of my head. The
> first is to create a new data type of a fixed length real number but
> the easier way would be to have a function that returns a string
> something like this:
>
> signif.string <- function(signum,sigdigs){
>   left <- nchar(trunc(signum))
>   right <- nchar(signum-trunc(signum))-2
>   if (abs(signum)<1 | signum<0) {left<-left-1}
>   if (right<0) {right<-0}
>   if (sigdigs<left) {return(as.character(signif(signum,digits=sigdigs)))}
>   else if (sigdigs==left) {return(paste(round(signum),".",sep=""))}
>   else if (sigdigs<=left+right) {return(format(signum,digits=sigdigs))}
>   else {return(sprintf(paste("%.",sigdigs-left,"f",sep=""),signum))}
> }
>
>   
> This is just a skeleton that I think suits my needs for the moment and
> might also cover the original poster's. One for production would need
> to handle scientific notation and would probably want to fix the 5
> round behavior on windows.
>   

As far as I know, rounding is fine in Windows:

 > round(1:10 + 0.5)
 [1]  2  2  4  4  6  6  8  8 10 10

looks okay to me.  If you want biased rounding instead (getting 2:11 as 
output), simply use trunc(x + 0.5) instead of round(x).

Duncan Murdoch
> Pat Carr
>
> version.string R version 2.7.0 (2008-04-22)
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From murdoch at stats.uwo.ca  Tue Jun  3 12:44:23 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 03 Jun 2008 06:44:23 -0400
Subject: [Rd] Request: Documentation of formulae
In-Reply-To: <s8452d92.086@tedmail.lgc.co.uk>
References: <s8452d92.086@tedmail.lgc.co.uk>
Message-ID: <48452087.4050507@stats.uwo.ca>

S Ellison wrote:
> Rather than transport quantities of the Introduction to R (a perfectly
> sensible title for a very good starting point, IMHO) would it not be
> simpler and involve less maintenance to include a link or
> cross-reference in the 'formula' help page to the relevant part of the
> Introduction? If nothing else, that might get folk to look at the
> Introduction if they've bypassed it ....
>   

Yes, that would be much simpler.  I am hoping that help.search() will 
soon be able to look through the indices and tables of contents of the 
manuals, so that will be another way to discover the documentation.

Changing the title of the manual would be an unreasonable solution: it 
affects authors of dozens of books, not just R Core, who all have to 
track down every reference to the old title and write some ugly 
disjunction instead.

Duncan Murdoch
> Steve E
>
>   
>>>> Martin Maechler <maechler at stat.math.ethz.ch> 03/06/2008 07:48:46
>>>>
>>>>         
>>>>>> "MP" == Mike Prager <mike.prager at noaa.gov>
>>>>>>             
>     MP> Mike Prager <mike.prager at noaa.gov> wrote:
>     >> I was at a loss to understand the use of "/" until I looked in
>     >> "An Introduction [!] to R," where I found the explanation. 
>     >> 
>     >> My request is that more complete material on model formulae be
>     >> lifted from "Introduction to R" (or elsewhere) and put into the
>     >> main online help files. 
>
>
> *******************************************************************
> This email and any attachments are confidential. Any use...{{dropped:8}}
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From mike.prager at noaa.gov  Tue Jun  3 16:41:38 2008
From: mike.prager at noaa.gov (Mike Prager)
Date: Tue, 03 Jun 2008 10:41:38 -0400
Subject: [Rd] Request: Documentation of formulae
References: <o5n044t0444q8a0ne9ci4a8gv6kqknhrqg@4ax.com>
	<jql844p3q5tr6fsnrs5upiuapnt8gqguf7@4ax.com>
	<18500.59726.138353.724757@stat.math.ethz.ch>
Message-ID: <k9la44lc0d61ml4j0d5ca2uf1sdjbhrirn@4ax.com>

Martin Maechler <maechler at stat.math.ethz.ch> wrote:

> Hi Mike, you make very worthy suggestions; but I assume the word
> "request" is really putting off almost all of us "R corers".
> You *have* heard that R is a volunteer project, that much of its
> development has happened in unpaid time of core team mates.
> Why are you not using "Suggestion" instead?

Dear Martin,

Thank you for alerting me that my comments could so easily be
taken differently from my intent.  The comments were indeed put
forth as suggestions. 

Thanks also for the characterization as a competent R user.  I
may be that, or nearly so, but time and other resources don't
allow me to contribute changes now. Perhaps in future I will be
in a better position to do so.

With appreciation for R and R-Core,

Mike

-- 
Mike Prager, NOAA, Beaufort, NC
* Opinions expressed are personal and not represented otherwise.
* Any use of tradenames does not constitute a NOAA endorsement.


From mwkimpel at gmail.com  Tue Jun  3 17:09:28 2008
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Tue, 3 Jun 2008 11:09:28 -0400
Subject: [Rd] benchmarking R installations
In-Reply-To: <20080603041851.GA14088@eddelbuettel.com>
References: <6b93d1830806022056o274e97c3i8d954748e17f6a81@mail.gmail.com>
	<20080603041851.GA14088@eddelbuettel.com>
Message-ID: <6b93d1830806030809w7139ee32g7b85a6210922784d@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080603/675f6907/attachment.pl>

From edd at debian.org  Tue Jun  3 17:16:35 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 3 Jun 2008 15:16:35 +0000
Subject: [Rd] benchmarking R installations
In-Reply-To: <6b93d1830806030809w7139ee32g7b85a6210922784d@mail.gmail.com>
References: <6b93d1830806022056o274e97c3i8d954748e17f6a81@mail.gmail.com>
	<20080603041851.GA14088@eddelbuettel.com>
	<6b93d1830806030809w7139ee32g7b85a6210922784d@mail.gmail.com>
Message-ID: <20080603151634.GA5771@master.debian.org>

On Tue, Jun 03, 2008 at 11:09:28AM -0400, Mark Kimpel wrote:
> Dirk,
> 
> At the moment, our emphasis is getting an installation that will run Rmpi in
> batch mode. I imagine my sysadmin put that line in to minimize potential
> problems. To be honest, I didn't catch it, I was just glad to get a compile
> :)
> 
> As to the line that doesn't apply to the R install, I think you are
> referring to the "with mpi", which I think he also slipped in not realizing
> it should more properly go with the Rmpi install.

Right. I wasn't implying it would do harm.

As for the x11 choice: I prefer to keep the change vectors
minimal. Otherwise you go nuts trying to debug things.

But it's good to see that you now understand that you have to start
'at the top' with Intel icc, and once you have a working R with you
can start working towards packages.  It's like a port to a different
platform as you completely switch the toolchain.

Good luck and keep us posted. I have looking at icc on the TODO list
too (for my C++ code, though, given R's interactive nature I think
there are lower hanging fruits elsewhere...)

Lastly, as to the benchmarking: It's difficult. Ripley once snarled
that it is probably the application you want to run the most so
there you go ...

Dirk

> 
> Mark
> 
> On Tue, Jun 3, 2008 at 12:18 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
> 
> > On Mon, Jun 02, 2008 at 11:56:16PM -0400, Mark Kimpel wrote:
> > > ../configure --prefix=/N/u/mkimpel/R_HOME/R-patched/R-build \
> > > --with-system-zlib=/usr/lib64 --with-system-bzlib=/usr/lib64 \
> > > --with-mpi=/N/soft/linux-rhel4-x86_64/openmpi/1.2.5/intel-64 --with-tcltk
> > \
> >
> > There is no such option for R's configure.
> >
> > > --with-tcl-config=/N/soft/linux-rhel4-x86_64/tcl8.4.16/lib64/tclConfig.sh
> > \
> > > --with-tk-config=/N/soft/linux-rhel4-x86_64/tk8.4.16/lib64/tkConfig.sh \
> > > --without-x --without-readline --without-iconv \
> >
> > So you never want your compute cluster to be able to do an interactive
> > plot under x11 ?
> >
> > Dirk
> >
> > --
> > Three out of two people have difficulties with fractions.
> >
> 
> 
> 
> -- 
> Mark W. Kimpel MD  ** Neuroinformatics ** Dept. of Psychiatry
> Indiana University School of Medicine
> 
> 15032 Hunter Court, Westfield, IN  46074
> 
> (317) 490-5129 Work, & Mobile & VoiceMail
> (317) 663-0513 Home (no voice mail please)
> 
> ******************************************************************

-- 
Three out of two people have difficulties with fractions.


From S.Ellison at lgc.co.uk  Tue Jun  3 17:22:45 2008
From: S.Ellison at lgc.co.uk (S Ellison)
Date: Tue, 03 Jun 2008 16:22:45 +0100
Subject: [Rd] savePlot() no longer automatically adds an extension to
	the	filename.
Message-ID: <s8456fea.037@tedmail.lgc.co.uk>

Plaintive squeak: Why the change? 

Some OS's and desktops use the extension, so forgetting it causes
trouble. The new default filename keeps a filetype (as before) but the
user now has to type a filetype twice (once as the type, once as
extension) to get the same effect fo rtheir own filenames. And the
extension isn't then checked for consistency with valid file types, so
it can be mistyped and saved with no warning. Hard to see the advantage
of doing away with it...

Suggestion: Revert to the previous default (extension as type) and
include an 'extension' in the parameter list so that folk who don't want
it can change it and folk who did want it get it automatically.

 
The code would then look something like 

savePlot<-function (filename = "Rplot", 
	type = c("wmf", "emf", "png", "jpg", "jpeg", "bmp", "tif",
"tiff", "ps", "eps", "pdf"),
	device = dev.cur(), 
	restoreConsole = TRUE,
	extension)   #Added extension
{
    type <- match.arg(type)
    if(missing(extension)) 
           extension <- type	         ##added
    devlist <- dev.list()
    devcur <- match(device, devlist, NA)
    if (is.na(devcur)) 
        stop("no such device")
    devname <- names(devlist)[devcur]
    if (devname != "windows") 
        stop("can only copy from 'windows' devices")
    if (filename == "clipboard" && type == "wmf") 
        filename <- ""
      else
        fullname <- paste(filename, extension,
sep=ifelse(extension=="","",".") )  ##added
    invisible(.External(CsavePlot, device, fullname, type,
restoreConsole))            ##Modded
}

Steve E

PS Yes, I took a while to upgrade from 2.6.x. Otherwise I'd have
squeaked the day I upgraded - like I just did - 'cos I use savePlot a
LOT.



*******************************************************************
This email and any attachments are confidential. Any use...{{dropped:8}}


From simon.urbanek at r-project.org  Tue Jun  3 17:52:14 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 3 Jun 2008 11:52:14 -0400
Subject: [Rd] benchmarking R installations
In-Reply-To: <20080603095219.G53049@xs7.xs4all.nl>
References: <6b93d1830806022056o274e97c3i8d954748e17f6a81@mail.gmail.com>
	<20080603095219.G53049@xs7.xs4all.nl>
Message-ID: <339D6E60-D926-4351-93DB-1E7C7D366800@r-project.org>


On Jun 3, 2008, at 3:58 AM, Ludo Pagie wrote:

> recently there was a post on R-help/Rd ?? with this link on  
> benchmarking different 'number crunching packages'. They used a  
> series of tests, although I didn't check they used all the types you  
> mentioned. I couldn't find test code at first glance but myyebe it  
> is available on request???
>
> http://www.sciviews.org/benchmark/
>

It's quite outdated and doesn't work with the current R versions, but  
I have an updated version that works. I have put some benchmarks I'm  
aware of at
http://r.research.att.com/benchmarks/

Cheers,
Simon


>
>
> On Mon, 2 Jun 2008, Mark Kimpel wrote:
>
>> Recently I posted to this list with a question about using the  
>> Intel 10.1
>> compilers in building R and one response was basically, "why in the  
>> heck
>> would you want to do that?" The answer is that my sysadmin believes  
>> that
>> there will be a performance boost with the Intel vs. Gnu compilers  
>> on our
>> Linux cluster, of which I am one of many users. Wanting to be a  
>> good citizen
>> and use my machine time wisely, I'd of course like to use right  
>> tool to
>> build the most efficient installation of R and associated packages.  
>> BTW, we
>> got R to compile nicely using the settings at the end of this post.
>>
>> Looking back on previous posts, however, it seems that there is no  
>> consensus
>> as to how to benchmark R. I realize such a task is not trivial, nor
>> controversial, but does anyone have a set of time-consuming tasks  
>> that can
>> be used to compare R installations? It would seem logical that such a
>> benchmark would include sub-benchmarks on file access, interpreted  
>> intensive
>> tasks, C intensive tasks, BLAS intensive tasks, etc. You developers  
>> know
>> more about this than I do, but I know enough to realize that there  
>> won't be
>> one simple answer. Nevertheless, I'd like to make my usage  
>> decisions on
>> something rather than anedotal claims.
>>
>> So, does anyone know of a good benchmarking script or would be  
>> willing to
>> contribute one?
>>
>> And here are the settings we used to compile R with Intel 10.1  
>> compilers:
>>
>> ../configure --prefix=/N/u/mkimpel/R_HOME/R-patched/R-build \
>> --with-system-zlib=/usr/lib64 --with-system-bzlib=/usr/lib64 \
>> --with-mpi=/N/soft/linux-rhel4-x86_64/openmpi/1.2.5/intel-64 --with- 
>> tcltk \
>> --with-tcl-config=/N/soft/linux-rhel4-x86_64/tcl8.4.16/lib64/ 
>> tclConfig.sh \
>> --with-tk-config=/N/soft/linux-rhel4-x86_64/tk8.4.16/lib64/ 
>> tkConfig.sh \
>> --without-x --without-readline --without-iconv \
>> CC="/N/soft/linux-rhel4-x86_64/intel/cce/10.1.013/bin/icc" \
>> CFLAGS="-O3 -no-prec-div -unroll" \
>> F77="/N/soft/linux-rhel4-x86_64/intel/fce/10.1.013/bin/ifort" \
>> FFLAGS="-O3 -no-prec-div -unroll" \
>> CXX="/N/soft/linux-rhel4-x86_64/intel/cce/10.1.013/bin/icpc" \
>> CXXFLAGS="-O3 -no-prec-div -unroll" \
>> FC="/N/soft/linux-rhel4-x86_64/intel/fce/10.1.013/bin/ifort" \
>> FCFLAGS="-O3 -no-prec-div -unroll" \
>> OBJC="/N/soft/linux-rhel4-x86_64/intel/cce/10.1.013/bin/icc" \
>> OBJCFLAGS="-O3 -no-prec-div -unroll" \
>> --disable-R-profiling --disable-memory-profiling
>> ##
>> make all
>> make install
>>
>> Mark
>>
>> -- 
>> Mark W. Kimpel MD ** Neuroinformatics ** Dept. of Psychiatry
>> Indiana University School of Medicine
>>
>> 15032 Hunter Court, Westfield, IN 46074
>>
>> (317) 490-5129 Work, & Mobile & VoiceMail
>> (317) 663-0513 Home (no voice mail please)
>>
>> ******************************************************************
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From ggrothendieck at gmail.com  Tue Jun  3 18:02:42 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 3 Jun 2008 12:02:42 -0400
Subject: [Rd] savePlot() no longer automatically adds an extension to
	the filename.
In-Reply-To: <s8456fea.037@tedmail.lgc.co.uk>
References: <s8456fea.037@tedmail.lgc.co.uk>
Message-ID: <971536df0806030902i18e7b31cmb85733c92cf2ddd2@mail.gmail.com>

Not sure if this is sufficient but note that if you leave the filename
off entirely then the extension does default to the type.

savePlot() # wmf
savePlot(type = "jpg")

> args(savePlot)
function (filename = paste("Rplot", type, sep = "."), type = c("wmf",
    "emf", "png", "jpg", "jpeg", "bmp", "tif", "tiff", "ps",
    "eps", "pdf"), device = dev.cur(), restoreConsole = TRUE)

https://svn.r-project.org/R/trunk/src/library/grDevices/R/windows/windows.R

On Tue, Jun 3, 2008 at 11:22 AM, S Ellison <S.Ellison at lgc.co.uk> wrote:
> Plaintive squeak: Why the change?
>
> Some OS's and desktops use the extension, so forgetting it causes
> trouble. The new default filename keeps a filetype (as before) but the
> user now has to type a filetype twice (once as the type, once as
> extension) to get the same effect fo rtheir own filenames. And the
> extension isn't then checked for consistency with valid file types, so
> it can be mistyped and saved with no warning. Hard to see the advantage
> of doing away with it...
>
> Suggestion: Revert to the previous default (extension as type) and
> include an 'extension' in the parameter list so that folk who don't want
> it can change it and folk who did want it get it automatically.
>
>
> The code would then look something like
>
> savePlot<-function (filename = "Rplot",
>        type = c("wmf", "emf", "png", "jpg", "jpeg", "bmp", "tif",
> "tiff", "ps", "eps", "pdf"),
>        device = dev.cur(),
>        restoreConsole = TRUE,
>        extension)   #Added extension
> {
>    type <- match.arg(type)
>    if(missing(extension))
>           extension <- type             ##added
>    devlist <- dev.list()
>    devcur <- match(device, devlist, NA)
>    if (is.na(devcur))
>        stop("no such device")
>    devname <- names(devlist)[devcur]
>    if (devname != "windows")
>        stop("can only copy from 'windows' devices")
>    if (filename == "clipboard" && type == "wmf")
>        filename <- ""
>      else
>        fullname <- paste(filename, extension,
> sep=ifelse(extension=="","",".") )  ##added
>    invisible(.External(CsavePlot, device, fullname, type,
> restoreConsole))            ##Modded
> }
>
> Steve E
>
> PS Yes, I took a while to upgrade from 2.6.x. Otherwise I'd have
> squeaked the day I upgraded - like I just did - 'cos I use savePlot a
> LOT.
>
>
>
> *******************************************************************
> This email and any attachments are confidential. Any use...{{dropped:8}}
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From mike.prager at noaa.gov  Tue Jun  3 20:35:06 2008
From: mike.prager at noaa.gov (Mike Prager)
Date: Tue, 03 Jun 2008 14:35:06 -0400
Subject: [Rd] savePlot() no longer automatically adds an extension to
	the	filename.
References: <s8456fea.037@tedmail.lgc.co.uk>
Message-ID: <ou2b449rirr8tkv0con6u598vhocp2kmfk@4ax.com>

"S Ellison" <S.Ellison at lgc.co.uk> wrote:

> Plaintive squeak: Why the change? 
> 
> Some OS's and desktops use the extension, so forgetting it causes
> trouble. The new default filename keeps a filetype (as before) but the
> user now has to type a filetype twice (once as the type, once as
> extension) to get the same effect fo rtheir own filenames. And the
> extension isn't then checked for consistency with valid file types, so
> it can be mistyped and saved with no warning. Hard to see the advantage
> of doing away with it...

Just for the record. . .

This change broke a *lot* of my code, including code used by
others.  Windows depends on file extensions.  Fortunately, fixes
using getRversion are not too difficult.

-- 
Mike Prager, NOAA, Beaufort, NC
* Opinions expressed are personal and not represented otherwise.
* Any use of tradenames does not constitute a NOAA endorsement.


From murdoch at stats.uwo.ca  Tue Jun  3 20:48:32 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 03 Jun 2008 14:48:32 -0400
Subject: [Rd] significant digits (PR#9682)
In-Reply-To: <a696b2f20806030843i5c290c87u1125b280b8a7672e@mail.gmail.com>
References: <20080602234017.CB1FD282C786@mail.pubhealth.ku.dk>	
	<48451EBC.1000207@stats.uwo.ca>
	<a696b2f20806030843i5c290c87u1125b280b8a7672e@mail.gmail.com>
Message-ID: <48459200.20401@stats.uwo.ca>

On 6/3/2008 11:43 AM, Patrick Carr wrote:
> On 6/3/08, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>>
>>  because signif(0.90, digits=2) == 0.9.  Those two objects are identical.
> 
> My text above that is poorly worded. They're identical internally,
> yes. But in terms of the number of significant digits, 0.9 and 0.90
> are different. And that matters when the number is printed, say as an
> annotation on a graph. Passing it through sprintf() or format() later
> requires you to specify the number of digits after the decimal, which
> is different than the number of significant digits, and requires case
> testing for numbers of different orders of magnitude.
> 
> The original complainant (and I) expected this behavior from signif(),
> not merely rounding. As I said before, I wrote my own workaround so
> this is somewhat academic, but I don't think we're alone.
> 
>>  As far as I know, rounding is fine in Windows:
>>
>>  > round(1:10 + 0.5)
>>  [1]  2  2  4  4  6  6  8  8 10 10
>>
> 
> It might not be the rounding, then. (windows xp sp3)
> 
>    > signif(12345,digits=4)
>    [1] 12340
>    > signif(0.12345,digits=4)
>    [1] 0.1235

It's easy to make mistakes in this, but a little outside-of-R 
experimentation suggests those are the right answers.  The number 12345 
is exactly representable, so it is exactly half-way between 12340 and 
12350, so 12340 is the right answer by the unbiased round-to-even rule. 
  The number 0.12345 is not exactly representable, but (I think) it is 
represented by something slightly closer to 0.1235 than to 0.1234.  So 
it looks as though Windows gets it right.


> OS X (10.5.2/intel) does not have that problem.

Which would seem to imply OS X gets it wrong.  Both are supposed to be 
using the 64 bit floating point standard, so they should both give the 
same answer:  but the actual arithmetic is being done by run-time 
libraries that are outside our control to a large extent, and it looks 
as though the one on the Mac is less accurate than the one on Windows.


  But (on both windows and OS X):
> 
>    > signif(12345.12345,digits=10)
>    [1] 12345.12

This is a different problem.  The number is correctly computed as 
12345.12345 (or at least a representable number quite close to that), 
and then the default display rounds it some more.  Set 
options(digits=19) to see it in its full glory.

Duncan Murdoch


From murdoch at stats.uwo.ca  Tue Jun  3 21:08:08 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 03 Jun 2008 15:08:08 -0400
Subject: [Rd] savePlot() no longer automatically adds an extension to
 the	filename.
In-Reply-To: <s8456fea.037@tedmail.lgc.co.uk>
References: <s8456fea.037@tedmail.lgc.co.uk>
Message-ID: <48459698.5060207@stats.uwo.ca>

On 6/3/2008 11:22 AM, S Ellison wrote:
> Plaintive squeak: Why the change? 
> 
> Some OS's and desktops use the extension, so forgetting it causes
> trouble. The new default filename keeps a filetype (as before) but the
> user now has to type a filetype twice (once as the type, once as
> extension) to get the same effect fo rtheir own filenames. And the
> extension isn't then checked for consistency with valid file types, so
> it can be mistyped and saved with no warning. Hard to see the advantage
> of doing away with it...
> 
> Suggestion: Revert to the previous default (extension as type) and
> include an 'extension' in the parameter list so that folk who don't want
> it can change it and folk who did want it get it automatically.
> 
>  
> The code would then look something like 
> 
> savePlot<-function (filename = "Rplot", 
> 	type = c("wmf", "emf", "png", "jpg", "jpeg", "bmp", "tif",
> "tiff", "ps", "eps", "pdf"),
> 	device = dev.cur(), 
> 	restoreConsole = TRUE,
> 	extension)   #Added extension
> {
>     type <- match.arg(type)
>     if(missing(extension)) 
>            extension <- type	         ##added
>     devlist <- dev.list()
>     devcur <- match(device, devlist, NA)
>     if (is.na(devcur)) 
>         stop("no such device")
>     devname <- names(devlist)[devcur]
>     if (devname != "windows") 
>         stop("can only copy from 'windows' devices")
>     if (filename == "clipboard" && type == "wmf") 
>         filename <- ""
>       else
>         fullname <- paste(filename, extension,
> sep=ifelse(extension=="","",".") )  ##added
>     invisible(.External(CsavePlot, device, fullname, type,
> restoreConsole))            ##Modded
> }
> 
> Steve E
> 
> PS Yes, I took a while to upgrade from 2.6.x. Otherwise I'd have
> squeaked the day I upgraded - like I just did - 'cos I use savePlot a
> LOT.

Another way to avoid surprises like this is to pay attention to the 
daily announcements of changes.  This one was announced back in February:

http://developer.r-project.org/blosxom.cgi/R-devel/CHANGES/2008/02/26#c2008-02-26

Personally, I would have chosen to add an extension if the name 
contained no dot, but I didn't make this change, and don't really see a 
problem with it.  However, if you want to submit a patch that does this 
(including changes to src/library/grDevices/R/windows/windows.R, 
src/library/grDevices/man/windows/savePlot.Rd, and to 
src/gnuwin32/CHANGES) before Friday, I'll commit it.

Duncan Murdoch


From simon.urbanek at r-project.org  Tue Jun  3 22:36:00 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 3 Jun 2008 16:36:00 -0400
Subject: [Rd] significant digits (PR#9682)
In-Reply-To: <48459200.20401@stats.uwo.ca>
References: <20080602234017.CB1FD282C786@mail.pubhealth.ku.dk>	
	<48451EBC.1000207@stats.uwo.ca>
	<a696b2f20806030843i5c290c87u1125b280b8a7672e@mail.gmail.com>
	<48459200.20401@stats.uwo.ca>
Message-ID: <A900A60E-2026-416C-B7B3-E5D5A77479D7@r-project.org>


On Jun 3, 2008, at 2:48 PM, Duncan Murdoch wrote:

> On 6/3/2008 11:43 AM, Patrick Carr wrote:
>> On 6/3/08, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>>>
>>> because signif(0.90, digits=2) == 0.9.  Those two objects are  
>>> identical.
>> My text above that is poorly worded. They're identical internally,
>> yes. But in terms of the number of significant digits, 0.9 and 0.90
>> are different. And that matters when the number is printed, say as an
>> annotation on a graph. Passing it through sprintf() or format() later
>> requires you to specify the number of digits after the decimal, which
>> is different than the number of significant digits, and requires case
>> testing for numbers of different orders of magnitude.
>> The original complainant (and I) expected this behavior from  
>> signif(),
>> not merely rounding. As I said before, I wrote my own workaround so
>> this is somewhat academic, but I don't think we're alone.
>>> As far as I know, rounding is fine in Windows:
>>>
>>> > round(1:10 + 0.5)
>>> [1]  2  2  4  4  6  6  8  8 10 10
>>>
>> It might not be the rounding, then. (windows xp sp3)
>>   > signif(12345,digits=4)
>>   [1] 12340
>>   > signif(0.12345,digits=4)
>>   [1] 0.1235
>
> It's easy to make mistakes in this, but a little outside-of-R  
> experimentation suggests those are the right answers.  The number  
> 12345 is exactly representable, so it is exactly half-way between  
> 12340 and 12350, so 12340 is the right answer by the unbiased round- 
> to-even rule.  The number 0.12345 is not exactly representable, but  
> (I think) it is represented by something slightly closer to 0.1235  
> than to 0.1234.  So it looks as though Windows gets it right.
>
>
>> OS X (10.5.2/intel) does not have that problem.
>
> Which would seem to imply OS X gets it wrong.

This has nothing to do with OS X, you get that same answer on pretty  
much all other platforms (Intel/Linux, MIPS/IRIX, Sparc/Sun, ...).  
Windows is the only one delivering the incorrect result here.


>  Both are supposed to be using the 64 bit floating point standard,  
> so they should both give the same answer:

Should, yes, but Windows doesn't. In fact 10000.0 is exactly  
representable and so is 1234.5 which is the correct result that all  
except Windows get. I don't have a Windows box handy, so I can't tell  
why - but if you go through fprec this is what you get on the  
platforms I tested (log10 may vary slightly but that's irrelevant here):

x = 0.123450000000000004174439
l10 = -0.908508905732048899217546, e10 = 4
pow10 = 10000.000000000000000000000000
x*pow10 = 1234.500000000000000000000000

Cheers,
Simon


>  but the actual arithmetic is being done by run-time libraries that  
> are outside our control to a large extent, and it looks as though  
> the one on the Mac is less accurate than the one on Windows.
>
>
> But (on both windows and OS X):
>>   > signif(12345.12345,digits=10)
>>   [1] 12345.12
>
> This is a different problem.  The number is correctly computed as  
> 12345.12345 (or at least a representable number quite close to  
> that), and then the default display rounds it some more.  Set  
> options(digits=19) to see it in its full glory.
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From simon.urbanek at r-project.org  Tue Jun  3 22:40:16 2008
From: simon.urbanek at r-project.org (simon.urbanek at r-project.org)
Date: Tue,  3 Jun 2008 22:40:16 +0200 (CEST)
Subject: [Rd] significant digits (PR#9682)
Message-ID: <20080603204016.1FE222834154@mail.pubhealth.ku.dk>


On Jun 3, 2008, at 2:48 PM, Duncan Murdoch wrote:

> On 6/3/2008 11:43 AM, Patrick Carr wrote:
>> On 6/3/08, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>>>
>>> because signif(0.90, digits=2) == 0.9.  Those two objects are  
>>> identical.
>> My text above that is poorly worded. They're identical internally,
>> yes. But in terms of the number of significant digits, 0.9 and 0.90
>> are different. And that matters when the number is printed, say as an
>> annotation on a graph. Passing it through sprintf() or format() later
>> requires you to specify the number of digits after the decimal, which
>> is different than the number of significant digits, and requires case
>> testing for numbers of different orders of magnitude.
>> The original complainant (and I) expected this behavior from  
>> signif(),
>> not merely rounding. As I said before, I wrote my own workaround so
>> this is somewhat academic, but I don't think we're alone.
>>> As far as I know, rounding is fine in Windows:
>>>
>>> > round(1:10 + 0.5)
>>> [1]  2  2  4  4  6  6  8  8 10 10
>>>
>> It might not be the rounding, then. (windows xp sp3)
>>   > signif(12345,digits=4)
>>   [1] 12340
>>   > signif(0.12345,digits=4)
>>   [1] 0.1235
>
> It's easy to make mistakes in this, but a little outside-of-R  
> experimentation suggests those are the right answers.  The number  
> 12345 is exactly representable, so it is exactly half-way between  
> 12340 and 12350, so 12340 is the right answer by the unbiased round- 
> to-even rule.  The number 0.12345 is not exactly representable, but  
> (I think) it is represented by something slightly closer to 0.1235  
> than to 0.1234.  So it looks as though Windows gets it right.
>
>
>> OS X (10.5.2/intel) does not have that problem.
>
> Which would seem to imply OS X gets it wrong.

This has nothing to do with OS X, you get that same answer on pretty  
much all other platforms (Intel/Linux, MIPS/IRIX, Sparc/Sun, ...).  
Windows is the only one delivering the incorrect result here.


>  Both are supposed to be using the 64 bit floating point standard,  
> so they should both give the same answer:

Should, yes, but Windows doesn't. In fact 10000.0 is exactly  
representable and so is 1234.5 which is the correct result that all  
except Windows get. I don't have a Windows box handy, so I can't tell  
why - but if you go through fprec this is what you get on the  
platforms I tested (log10 may vary slightly but that's irrelevant here):

x = 0.123450000000000004174439
l10 = -0.908508905732048899217546, e10 = 4
pow10 = 10000.000000000000000000000000
x*pow10 = 1234.500000000000000000000000

Cheers,
Simon


>  but the actual arithmetic is being done by run-time libraries that  
> are outside our control to a large extent, and it looks as though  
> the one on the Mac is less accurate than the one on Windows.
>
>
> But (on both windows and OS X):
>>   > signif(12345.12345,digits=10)
>>   [1] 12345.12
>
> This is a different problem.  The number is correctly computed as  
> 12345.12345 (or at least a representable number quite close to  
> that), and then the default display rounds it some more.  Set  
> options(digits=19) to see it in its full glory.
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From murdoch at stats.uwo.ca  Tue Jun  3 23:12:52 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 03 Jun 2008 17:12:52 -0400
Subject: [Rd] significant digits (PR#9682)
In-Reply-To: <A900A60E-2026-416C-B7B3-E5D5A77479D7@r-project.org>
References: <20080602234017.CB1FD282C786@mail.pubhealth.ku.dk>	
	<48451EBC.1000207@stats.uwo.ca>
	<a696b2f20806030843i5c290c87u1125b280b8a7672e@mail.gmail.com>
	<48459200.20401@stats.uwo.ca>
	<A900A60E-2026-416C-B7B3-E5D5A77479D7@r-project.org>
Message-ID: <4845B3D4.1090504@stats.uwo.ca>

On 6/3/2008 4:36 PM, Simon Urbanek wrote:
> On Jun 3, 2008, at 2:48 PM, Duncan Murdoch wrote:
> 
>> On 6/3/2008 11:43 AM, Patrick Carr wrote:
>>> On 6/3/08, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>>>>
>>>> because signif(0.90, digits=2) == 0.9.  Those two objects are  
>>>> identical.
>>> My text above that is poorly worded. They're identical internally,
>>> yes. But in terms of the number of significant digits, 0.9 and 0.90
>>> are different. And that matters when the number is printed, say as an
>>> annotation on a graph. Passing it through sprintf() or format() later
>>> requires you to specify the number of digits after the decimal, which
>>> is different than the number of significant digits, and requires case
>>> testing for numbers of different orders of magnitude.
>>> The original complainant (and I) expected this behavior from  
>>> signif(),
>>> not merely rounding. As I said before, I wrote my own workaround so
>>> this is somewhat academic, but I don't think we're alone.
>>>> As far as I know, rounding is fine in Windows:
>>>>
>>>> > round(1:10 + 0.5)
>>>> [1]  2  2  4  4  6  6  8  8 10 10
>>>>
>>> It might not be the rounding, then. (windows xp sp3)
>>>   > signif(12345,digits=4)
>>>   [1] 12340
>>>   > signif(0.12345,digits=4)
>>>   [1] 0.1235
>>
>> It's easy to make mistakes in this, but a little outside-of-R  
>> experimentation suggests those are the right answers.  The number  
>> 12345 is exactly representable, so it is exactly half-way between  
>> 12340 and 12350, so 12340 is the right answer by the unbiased round- 
>> to-even rule.  The number 0.12345 is not exactly representable, but  
>> (I think) it is represented by something slightly closer to 0.1235  
>> than to 0.1234.  So it looks as though Windows gets it right.
>>
>>
>>> OS X (10.5.2/intel) does not have that problem.
>>
>> Which would seem to imply OS X gets it wrong.
> 
> This has nothing to do with OS X, you get that same answer on pretty  
> much all other platforms (Intel/Linux, MIPS/IRIX, Sparc/Sun, ...).  
> Windows is the only one delivering the incorrect result here.
> 
> 
>>  Both are supposed to be using the 64 bit floating point standard,  
>> so they should both give the same answer:
> 
> Should, yes, but Windows doesn't. In fact 10000.0 is exactly  
> representable and so is 1234.5 which is the correct result that all  
> except Windows get. 

I think you skipped a step.  The correct answer is either 0.1234 or 
0.1235, not something 10000 times bigger.  The first important question 
is whether 0.12345 is exactly representable, and the answer is no.  The 
second question is whether it is represented by a number bigger or 
smaller than the real number 0.12345.  If it is bigger, the answer 
should be 0.1235, and if it is smaller, the answer is 0.1234.  My 
experiments suggest it is bigger.  Yours don't look relevant.  It 
certainly isn't exactly equal to 1234.5/10000, because that number is 
not representable.  It's equal to x/2^y, for some x and y, and it's a 
pain to figure out exactly what they are.

However, I am pretty sure R is representing it (at least on Windows) as 
the binary expansion

0.000111111001101001101011010100001011000011110010011111

while the true binary expansion (using exact rational arithmetic) starts 
out

0.00011111100110100110101101010000101100001111001001111011101...

If you line those up, you'll see that the first number is bigger than 
the second.  (Ugly code to derive these is down below.)

Clearly the top representation is the correct one to that number of 
binary digits, so I think Windows got it right, and all those other 
systems didn't.  This is probably because R on Windows is using extended 
precision (64 bit mantissas) for intermediate results, and those other 
systems stick with 53 bit mantissas.

Duncan Murdoch

# Convert number to binary expansion; add the decimal point manually

x <- 0.12345
while (x != 0) {
   cat(trunc(x))
   x <- x - trunc(x)
   x <- x * 2
}

# Do the same thing in exact rational arithmetic

num <- 12345
denom <- 100000
for (i in 1:60) {
   cat(ifelse(num > 100000, "1", "0"))
   num <- num %% 100000
   num <- 2*num
}

# Manually cut and paste the results to get these:

"0.000111111001101001101011010100001011000011110010011111"
"0.00011111100110100110101101010000101100001111001001111011101"


From murdoch at stats.uwo.ca  Tue Jun  3 23:15:16 2008
From: murdoch at stats.uwo.ca (murdoch at stats.uwo.ca)
Date: Tue,  3 Jun 2008 23:15:16 +0200 (CEST)
Subject: [Rd] significant digits (PR#9682)
Message-ID: <20080603211516.3970C2834157@mail.pubhealth.ku.dk>

On 6/3/2008 4:36 PM, Simon Urbanek wrote:
> On Jun 3, 2008, at 2:48 PM, Duncan Murdoch wrote:
> 
>> On 6/3/2008 11:43 AM, Patrick Carr wrote:
>>> On 6/3/08, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>>>>
>>>> because signif(0.90, digits=2) == 0.9.  Those two objects are  
>>>> identical.
>>> My text above that is poorly worded. They're identical internally,
>>> yes. But in terms of the number of significant digits, 0.9 and 0.90
>>> are different. And that matters when the number is printed, say as an
>>> annotation on a graph. Passing it through sprintf() or format() later
>>> requires you to specify the number of digits after the decimal, which
>>> is different than the number of significant digits, and requires case
>>> testing for numbers of different orders of magnitude.
>>> The original complainant (and I) expected this behavior from  
>>> signif(),
>>> not merely rounding. As I said before, I wrote my own workaround so
>>> this is somewhat academic, but I don't think we're alone.
>>>> As far as I know, rounding is fine in Windows:
>>>>
>>>> > round(1:10 + 0.5)
>>>> [1]  2  2  4  4  6  6  8  8 10 10
>>>>
>>> It might not be the rounding, then. (windows xp sp3)
>>>   > signif(12345,digits=4)
>>>   [1] 12340
>>>   > signif(0.12345,digits=4)
>>>   [1] 0.1235
>>
>> It's easy to make mistakes in this, but a little outside-of-R  
>> experimentation suggests those are the right answers.  The number  
>> 12345 is exactly representable, so it is exactly half-way between  
>> 12340 and 12350, so 12340 is the right answer by the unbiased round- 
>> to-even rule.  The number 0.12345 is not exactly representable, but  
>> (I think) it is represented by something slightly closer to 0.1235  
>> than to 0.1234.  So it looks as though Windows gets it right.
>>
>>
>>> OS X (10.5.2/intel) does not have that problem.
>>
>> Which would seem to imply OS X gets it wrong.
> 
> This has nothing to do with OS X, you get that same answer on pretty  
> much all other platforms (Intel/Linux, MIPS/IRIX, Sparc/Sun, ...).  
> Windows is the only one delivering the incorrect result here.
> 
> 
>>  Both are supposed to be using the 64 bit floating point standard,  
>> so they should both give the same answer:
> 
> Should, yes, but Windows doesn't. In fact 10000.0 is exactly  
> representable and so is 1234.5 which is the correct result that all  
> except Windows get. 

I think you skipped a step.  The correct answer is either 0.1234 or 
0.1235, not something 10000 times bigger.  The first important question 
is whether 0.12345 is exactly representable, and the answer is no.  The 
second question is whether it is represented by a number bigger or 
smaller than the real number 0.12345.  If it is bigger, the answer 
should be 0.1235, and if it is smaller, the answer is 0.1234.  My 
experiments suggest it is bigger.  Yours don't look relevant.  It 
certainly isn't exactly equal to 1234.5/10000, because that number is 
not representable.  It's equal to x/2^y, for some x and y, and it's a 
pain to figure out exactly what they are.

However, I am pretty sure R is representing it (at least on Windows) as 
the binary expansion

0.000111111001101001101011010100001011000011110010011111

while the true binary expansion (using exact rational arithmetic) starts 
out

0.00011111100110100110101101010000101100001111001001111011101...

If you line those up, you'll see that the first number is bigger than 
the second.  (Ugly code to derive these is down below.)

Clearly the top representation is the correct one to that number of 
binary digits, so I think Windows got it right, and all those other 
systems didn't.  This is probably because R on Windows is using extended 
precision (64 bit mantissas) for intermediate results, and those other 
systems stick with 53 bit mantissas.

Duncan Murdoch

# Convert number to binary expansion; add the decimal point manually

x <- 0.12345
while (x != 0) {
   cat(trunc(x))
   x <- x - trunc(x)
   x <- x * 2
}

# Do the same thing in exact rational arithmetic

num <- 12345
denom <- 100000
for (i in 1:60) {
   cat(ifelse(num > 100000, "1", "0"))
   num <- num %% 100000
   num <- 2*num
}

# Manually cut and paste the results to get these:

"0.000111111001101001101011010100001011000011110010011111"
"0.00011111100110100110101101010000101100001111001001111011101"


From pmc1 at cornell.edu  Tue Jun  3 17:43:05 2008
From: pmc1 at cornell.edu (Patrick Carr)
Date: Tue, 3 Jun 2008 11:43:05 -0400
Subject: [Rd] significant digits (PR#9682)
In-Reply-To: <48451EBC.1000207@stats.uwo.ca>
References: <20080602234017.CB1FD282C786@mail.pubhealth.ku.dk>
	<48451EBC.1000207@stats.uwo.ca>
Message-ID: <a696b2f20806030843i5c290c87u1125b280b8a7672e@mail.gmail.com>

On 6/3/08, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>
>  because signif(0.90, digits=2) == 0.9.  Those two objects are identical.

My text above that is poorly worded. They're identical internally,
yes. But in terms of the number of significant digits, 0.9 and 0.90
are different. And that matters when the number is printed, say as an
annotation on a graph. Passing it through sprintf() or format() later
requires you to specify the number of digits after the decimal, which
is different than the number of significant digits, and requires case
testing for numbers of different orders of magnitude.

The original complainant (and I) expected this behavior from signif(),
not merely rounding. As I said before, I wrote my own workaround so
this is somewhat academic, but I don't think we're alone.

>  As far as I know, rounding is fine in Windows:
>
>  > round(1:10 + 0.5)
>  [1]  2  2  4  4  6  6  8  8 10 10
>

It might not be the rounding, then. (windows xp sp3)

   > signif(12345,digits=4)
   [1] 12340
   > signif(0.12345,digits=4)
   [1] 0.1235

OS X (10.5.2/intel) does not have that problem. But (on both windows and OS X):

   > signif(12345.12345,digits=10)
   [1] 12345.12

Pat Carr


From leydold at statmath.wu-wien.ac.at  Tue Jun  3 15:50:10 2008
From: leydold at statmath.wu-wien.ac.at (leydold at statmath.wu-wien.ac.at)
Date: Tue,  3 Jun 2008 15:50:10 +0200 (CEST)
Subject: [Rd] bug in sockconn.c: invalid memory allocation (PR#11565)
Message-ID: <20080603135011.062D72834157@mail.pubhealth.ku.dk>

Dear R developers,

The following patch should fix a memory allocation bug:

Index: src/modules/internet/sockconn.c
===================================================================
--- src/modules/internet/sockconn.c     (revision 45828)
+++ src/modules/internet/sockconn.c     (working copy)
@@ -174,7 +174,7 @@
 
     new = (Rconnection) malloc(sizeof(struct Rconn));
     if(!new) error(_("allocation of socket connection failed"));
-    new->class = (char *) malloc(strlen("socket") + 1);
+    new->class = (char *) malloc(strlen("sockconn") + 1);
     if(!new->class) {
        free(new);
        error(_("allocation of socket connection failed"));


The in release 45780 there has been changed a strcpy command without
changing the size of the character array.
The following diff also contains the above change to show the problem:

Index: src/modules/internet/sockconn.c
===================================================================
--- src/modules/internet/sockconn.c     (revision 45779)
+++ src/modules/internet/sockconn.c     (working copy)
@@ -174,12 +174,12 @@
 
     new = (Rconnection) malloc(sizeof(struct Rconn));
     if(!new) error(_("allocation of socket connection failed"));
-    new->class = (char *) malloc(strlen("socket") + 1);
+    new->class = (char *) malloc(strlen("sockconn") + 1);
     if(!new->class) {
        free(new);
        error(_("allocation of socket connection failed"));
     }
-    strcpy(new->class, "socket");
+    strcpy(new->class, "sockconn");
     new->description = (char *) malloc(strlen(host) + 10);
     if(!new->description) {
        free(new->class); free(new);

$ svn info
Path: .
URL: https://svn.R-project.org/R/trunk
Repository Root: https://svn.R-project.org/R
Repository UUID: 00db46b3-68df-0310-9c12-caf00c1e9a41
Revision: 45828
Node Kind: directory
Schedule: normal
Last Changed Author: hornik
Last Changed Rev: 45827
Last Changed Date: 2008-06-03 08:44:26 +0200 (Tue, 03 Jun 2008)



Josef


From pmc1 at cornell.edu  Tue Jun  3 22:07:10 2008
From: pmc1 at cornell.edu (Patrick Carr)
Date: Tue, 3 Jun 2008 16:07:10 -0400
Subject: [Rd] significant digits (PR#9682)
In-Reply-To: <48459200.20401@stats.uwo.ca>
References: <20080602234017.CB1FD282C786@mail.pubhealth.ku.dk>
	<48451EBC.1000207@stats.uwo.ca>
	<a696b2f20806030843i5c290c87u1125b280b8a7672e@mail.gmail.com>
	<48459200.20401@stats.uwo.ca>
Message-ID: <a696b2f20806031307m4b38c2a7o85c619b5b34dbc1c@mail.gmail.com>

On 6/3/08, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>
>  It's easy to make mistakes in this, but a little outside-of-R
> experimentation suggests those are the right answers.  The number 12345 is
> exactly representable, so it is exactly half-way between 12340 and 12350, so
> 12340 is the right answer by the unbiased round-to-even rule.  The number
> 0.12345 is not exactly representable, but (I think) it is represented by
> something slightly closer to 0.1235 than to 0.1234.  So it looks as though
> Windows gets it right.

Well, right within the limitations of binary floating-point
arithmetic. Not right right.

In the grander scheme, this is a nicety which is largely
inconsequential--if I need a real measure precision (precise
precision?) I'll use a +/- notation of a propagated error and/or edit
the typography of the numbers by hand immediately before the final
output. But again, final printed output of the number is basically the
useful use I see for a function that returns significant digits. And
for that purpose I think it should be right right, and actually output
the number of significant digits requested.

> >   > signif(12345.12345,digits=10)
> >   [1] 12345.12
>
>  This is a different problem.  The number is correctly computed as
> 12345.12345 (or at least a representable number quite close to that), and
> then the default display rounds it some more.  Set options(digits=19) to see
> it in its full glory.

Aha, my mistake; I missed that setting.

Pat Carr


From simon.urbanek at r-project.org  Tue Jun  3 23:33:01 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 3 Jun 2008 17:33:01 -0400
Subject: [Rd] significant digits (PR#9682)
In-Reply-To: <4845B3D4.1090504@stats.uwo.ca>
References: <20080602234017.CB1FD282C786@mail.pubhealth.ku.dk>	
	<48451EBC.1000207@stats.uwo.ca>
	<a696b2f20806030843i5c290c87u1125b280b8a7672e@mail.gmail.com>
	<48459200.20401@stats.uwo.ca>
	<A900A60E-2026-416C-B7B3-E5D5A77479D7@r-project.org>
	<4845B3D4.1090504@stats.uwo.ca>
Message-ID: <9358372B-AC8E-419C-8E37-487CDBCF3175@r-project.org>


On Jun 3, 2008, at 5:12 PM, Duncan Murdoch wrote:

> On 6/3/2008 4:36 PM, Simon Urbanek wrote:
>> On Jun 3, 2008, at 2:48 PM, Duncan Murdoch wrote:
>>> On 6/3/2008 11:43 AM, Patrick Carr wrote:
>>>> On 6/3/08, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>>>>>
>>>>> because signif(0.90, digits=2) == 0.9.  Those two objects are   
>>>>> identical.
>>>> My text above that is poorly worded. They're identical internally,
>>>> yes. But in terms of the number of significant digits, 0.9 and 0.90
>>>> are different. And that matters when the number is printed, say  
>>>> as an
>>>> annotation on a graph. Passing it through sprintf() or format()  
>>>> later
>>>> requires you to specify the number of digits after the decimal,  
>>>> which
>>>> is different than the number of significant digits, and requires  
>>>> case
>>>> testing for numbers of different orders of magnitude.
>>>> The original complainant (and I) expected this behavior from   
>>>> signif(),
>>>> not merely rounding. As I said before, I wrote my own workaround so
>>>> this is somewhat academic, but I don't think we're alone.
>>>>> As far as I know, rounding is fine in Windows:
>>>>>
>>>>> > round(1:10 + 0.5)
>>>>> [1]  2  2  4  4  6  6  8  8 10 10
>>>>>
>>>> It might not be the rounding, then. (windows xp sp3)
>>>>  > signif(12345,digits=4)
>>>>  [1] 12340
>>>>  > signif(0.12345,digits=4)
>>>>  [1] 0.1235
>>>
>>> It's easy to make mistakes in this, but a little outside-of-R   
>>> experimentation suggests those are the right answers.  The number   
>>> 12345 is exactly representable, so it is exactly half-way between   
>>> 12340 and 12350, so 12340 is the right answer by the unbiased  
>>> round- to-even rule.  The number 0.12345 is not exactly  
>>> representable, but  (I think) it is represented by something  
>>> slightly closer to 0.1235  than to 0.1234.  So it looks as though  
>>> Windows gets it right.
>>>
>>>
>>>> OS X (10.5.2/intel) does not have that problem.
>>>
>>> Which would seem to imply OS X gets it wrong.
>> This has nothing to do with OS X, you get that same answer on  
>> pretty  much all other platforms (Intel/Linux, MIPS/IRIX, Sparc/ 
>> Sun, ...).  Windows is the only one delivering the incorrect result  
>> here.
>>> Both are supposed to be using the 64 bit floating point standard,   
>>> so they should both give the same answer:
>> Should, yes, but Windows doesn't. In fact 10000.0 is exactly   
>> representable and so is 1234.5 which is the correct result that  
>> all  except Windows get.
>
> I think you skipped a step.

I didn't - I was just pointing out that what you are trying to show is  
irrelevant. We are dealing with FP arithmetics here, so although your  
reasoning is valid algebraically, it's not in FP world. You missed the  
fact that FP operations are used to actually get the result (*10000.0,  
round and divide again) and thus those operation will influence it as  
well.


>  The correct answer is either 0.1234 or 0.1235, not something 10000  
> times bigger.  The first important question is whether 0.12345 is  
> exactly representable, and the answer is no.  The second question is  
> whether it is represented by a number bigger or smaller than the  
> real number 0.12345.  If it is bigger, the answer should be 0.1235,  
> and if it is smaller, the answer is 0.1234.

No. That was what I was trying to point out. You can see clearly from  
my post that 0.12345 is not exactly representable and that the  
representation is slightly bigger. This is, however, irrelevant,  
because the next step is to multiply that number by 10000 (see fprec  
source) and this is where your reasoning breaks down - the result is  
exact representation of 1234.5, because the imprecision gets lost in  
the operation on all platforms but Windows. The result is that Windows  
is inconsistent with others, whether that is a bug or feature I don't  
care. All I really wanted to say is that this has nothing to do with  
OS X - if anything then it's a Windows issue.


>  My experiments suggest it is bigger.

I was not claiming otherwise.


>  Yours don't look relevant.

Vice versa as it turns out.

Cheers,
Simon


> It certainly isn't exactly equal to 1234.5/10000, because that  
> number is not representable.  It's equal to x/2^y, for some x and y,  
> and it's a pain to figure out exactly what they are.
>
> However, I am pretty sure R is representing it (at least on Windows)  
> as the binary expansion
>
> 0.000111111001101001101011010100001011000011110010011111
>
> while the true binary expansion (using exact rational arithmetic)  
> starts out
>
> 0.00011111100110100110101101010000101100001111001001111011101...
>
> If you line those up, you'll see that the first number is bigger  
> than the second.  (Ugly code to derive these is down below.)
>
> Clearly the top representation is the correct one to that number of  
> binary digits, so I think Windows got it right, and all those other  
> systems didn't.  This is probably because R on Windows is using  
> extended precision (64 bit mantissas) for intermediate results, and  
> those other systems stick with 53 bit mantissas.
>

However, this means that Windows doesn't conform

> Duncan Murdoch
>
> # Convert number to binary expansion; add the decimal point manually
>
> x <- 0.12345
> while (x != 0) {
>  cat(trunc(x))
>  x <- x - trunc(x)
>  x <- x * 2
> }
>
> # Do the same thing in exact rational arithmetic
>
> num <- 12345
> denom <- 100000
> for (i in 1:60) {
>  cat(ifelse(num > 100000, "1", "0"))
>  num <- num %% 100000
>  num <- 2*num
> }
>
> # Manually cut and paste the results to get these:
>
> "0.000111111001101001101011010100001011000011110010011111"
> "0.00011111100110100110101101010000101100001111001001111011101"
>
>


From simon.urbanek at r-project.org  Tue Jun  3 23:35:15 2008
From: simon.urbanek at r-project.org (simon.urbanek at r-project.org)
Date: Tue,  3 Jun 2008 23:35:15 +0200 (CEST)
Subject: [Rd] significant digits (PR#9682)
Message-ID: <20080603213515.117B12834157@mail.pubhealth.ku.dk>


On Jun 3, 2008, at 5:12 PM, Duncan Murdoch wrote:

> On 6/3/2008 4:36 PM, Simon Urbanek wrote:
>> On Jun 3, 2008, at 2:48 PM, Duncan Murdoch wrote:
>>> On 6/3/2008 11:43 AM, Patrick Carr wrote:
>>>> On 6/3/08, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>>>>>
>>>>> because signif(0.90, digits=2) == 0.9.  Those two objects are   
>>>>> identical.
>>>> My text above that is poorly worded. They're identical internally,
>>>> yes. But in terms of the number of significant digits, 0.9 and 0.90
>>>> are different. And that matters when the number is printed, say  
>>>> as an
>>>> annotation on a graph. Passing it through sprintf() or format()  
>>>> later
>>>> requires you to specify the number of digits after the decimal,  
>>>> which
>>>> is different than the number of significant digits, and requires  
>>>> case
>>>> testing for numbers of different orders of magnitude.
>>>> The original complainant (and I) expected this behavior from   
>>>> signif(),
>>>> not merely rounding. As I said before, I wrote my own workaround so
>>>> this is somewhat academic, but I don't think we're alone.
>>>>> As far as I know, rounding is fine in Windows:
>>>>>
>>>>> > round(1:10 + 0.5)
>>>>> [1]  2  2  4  4  6  6  8  8 10 10
>>>>>
>>>> It might not be the rounding, then. (windows xp sp3)
>>>>  > signif(12345,digits=4)
>>>>  [1] 12340
>>>>  > signif(0.12345,digits=4)
>>>>  [1] 0.1235
>>>
>>> It's easy to make mistakes in this, but a little outside-of-R   
>>> experimentation suggests those are the right answers.  The number   
>>> 12345 is exactly representable, so it is exactly half-way between   
>>> 12340 and 12350, so 12340 is the right answer by the unbiased  
>>> round- to-even rule.  The number 0.12345 is not exactly  
>>> representable, but  (I think) it is represented by something  
>>> slightly closer to 0.1235  than to 0.1234.  So it looks as though  
>>> Windows gets it right.
>>>
>>>
>>>> OS X (10.5.2/intel) does not have that problem.
>>>
>>> Which would seem to imply OS X gets it wrong.
>> This has nothing to do with OS X, you get that same answer on  
>> pretty  much all other platforms (Intel/Linux, MIPS/IRIX, Sparc/ 
>> Sun, ...).  Windows is the only one delivering the incorrect result  
>> here.
>>> Both are supposed to be using the 64 bit floating point standard,   
>>> so they should both give the same answer:
>> Should, yes, but Windows doesn't. In fact 10000.0 is exactly   
>> representable and so is 1234.5 which is the correct result that  
>> all  except Windows get.
>
> I think you skipped a step.

I didn't - I was just pointing out that what you are trying to show is  
irrelevant. We are dealing with FP arithmetics here, so although your  
reasoning is valid algebraically, it's not in FP world. You missed the  
fact that FP operations are used to actually get the result (*10000.0,  
round and divide again) and thus those operation will influence it as  
well.


>  The correct answer is either 0.1234 or 0.1235, not something 10000  
> times bigger.  The first important question is whether 0.12345 is  
> exactly representable, and the answer is no.  The second question is  
> whether it is represented by a number bigger or smaller than the  
> real number 0.12345.  If it is bigger, the answer should be 0.1235,  
> and if it is smaller, the answer is 0.1234.

No. That was what I was trying to point out. You can see clearly from  
my post that 0.12345 is not exactly representable and that the  
representation is slightly bigger. This is, however, irrelevant,  
because the next step is to multiply that number by 10000 (see fprec  
source) and this is where your reasoning breaks down - the result is  
exact representation of 1234.5, because the imprecision gets lost in  
the operation on all platforms but Windows. The result is that Windows  
is inconsistent with others, whether that is a bug or feature I don't  
care. All I really wanted to say is that this has nothing to do with  
OS X - if anything then it's a Windows issue.


>  My experiments suggest it is bigger.

I was not claiming otherwise.


>  Yours don't look relevant.

Vice versa as it turns out.

Cheers,
Simon


> It certainly isn't exactly equal to 1234.5/10000, because that  
> number is not representable.  It's equal to x/2^y, for some x and y,  
> and it's a pain to figure out exactly what they are.
>
> However, I am pretty sure R is representing it (at least on Windows)  
> as the binary expansion
>
> 0.000111111001101001101011010100001011000011110010011111
>
> while the true binary expansion (using exact rational arithmetic)  
> starts out
>
> 0.00011111100110100110101101010000101100001111001001111011101...
>
> If you line those up, you'll see that the first number is bigger  
> than the second.  (Ugly code to derive these is down below.)
>
> Clearly the top representation is the correct one to that number of  
> binary digits, so I think Windows got it right, and all those other  
> systems didn't.  This is probably because R on Windows is using  
> extended precision (64 bit mantissas) for intermediate results, and  
> those other systems stick with 53 bit mantissas.
>

However, this means that Windows doesn't conform

> Duncan Murdoch
>
> # Convert number to binary expansion; add the decimal point manually
>
> x <- 0.12345
> while (x != 0) {
>  cat(trunc(x))
>  x <- x - trunc(x)
>  x <- x * 2
> }
>
> # Do the same thing in exact rational arithmetic
>
> num <- 12345
> denom <- 100000
> for (i in 1:60) {
>  cat(ifelse(num > 100000, "1", "0"))
>  num <- num %% 100000
>  num <- 2*num
> }
>
> # Manually cut and paste the results to get these:
>
> "0.000111111001101001101011010100001011000011110010011111"
> "0.00011111100110100110101101010000101100001111001001111011101"
>
>


From mwkimpel at gmail.com  Wed Jun  4 00:14:10 2008
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Tue, 3 Jun 2008 18:14:10 -0400
Subject: [Rd] benchmarking R installations
In-Reply-To: <20080603151634.GA5771@master.debian.org>
References: <6b93d1830806022056o274e97c3i8d954748e17f6a81@mail.gmail.com>
	<20080603041851.GA14088@eddelbuettel.com>
	<6b93d1830806030809w7139ee32g7b85a6210922784d@mail.gmail.com>
	<20080603151634.GA5771@master.debian.org>
Message-ID: <6b93d1830806031514w486f5762ta3a00a03acecd190@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080603/5757c14b/attachment.pl>

From maechler at stat.math.ethz.ch  Wed Jun  4 01:04:26 2008
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 4 Jun 2008 01:04:26 +0200
Subject: [Rd] benchmarking R installations
In-Reply-To: <339D6E60-D926-4351-93DB-1E7C7D366800@r-project.org>
References: <6b93d1830806022056o274e97c3i8d954748e17f6a81@mail.gmail.com>
	<20080603095219.G53049@xs7.xs4all.nl>
	<339D6E60-D926-4351-93DB-1E7C7D366800@r-project.org>
Message-ID: <18501.52730.350059.509071@cmath-5.math.ethz.ch>

>>>>> "SU" == Simon Urbanek <simon.urbanek at r-project.org>
>>>>>     on Tue, 3 Jun 2008 11:52:14 -0400 writes:

    SU> On Jun 3, 2008, at 3:58 AM, Ludo Pagie wrote:

    >> recently there was a post on R-help/Rd ?? with this link
    >> on benchmarking different 'number crunching
    >> packages'. They used a series of tests, although I didn't
    >> check they used all the types you mentioned. I couldn't
    >> find test code at first glance but myyebe it is available
    >> on request???
    >> 
    >> http://www.sciviews.org/benchmark/
    >> 

    SU> It's quite outdated and doesn't work with the current R versions, 

Yes, that was the topic of the recent R-help post mentioned
above.  And because of that I did post an updated version back to the
list.
Here's the posting, as found on http://search.r-project.org :
    http://finzi.psych.upenn.edu/R/Rhelp02a/archive/130270.html
and the R script here
   https://stat.ethz.ch/pipermail/r-help/attachments/20080514/0ccea72b/attachment.pl

    SU> but I have an updated version that works. I have put some
    SU> benchmarks I'm aware of at

    SU> http://r.research.att.com/benchmarks/

That's cool!  Thanks, Simon!
Martin

    >> On Mon, 2 Jun 2008, Mark Kimpel wrote:
    >> 
    >>> Recently I posted to this list with a question about
    >>> using the Intel 10.1 compilers in building R and one
    >>> response was basically, "why in the heck would you want
    >>> to do that?" The answer is that my sysadmin believes
    >>> that there will be a performance boost with the Intel
    >>> vs. Gnu compilers on our Linux cluster, of which I am
    >>> one of many users. Wanting to be a good citizen and use
    >>> my machine time wisely, I'd of course like to use right
    >>> tool to build the most efficient installation of R and
    >>> associated packages.  BTW, we got R to compile nicely
    >>> using the settings at the end of this post.
    >>> 
    >>> Looking back on previous posts, however, it seems that
    >>> there is no consensus as to how to benchmark R. I
    >>> realize such a task is not trivial, nor controversial,
    >>> but does anyone have a set of time-consuming tasks that
    >>> can be used to compare R installations? It would seem
    >>> logical that such a benchmark would include
    >>> sub-benchmarks on file access, interpreted intensive
    >>> tasks, C intensive tasks, BLAS intensive tasks, etc. You
    >>> developers know more about this than I do, but I know
    >>> enough to realize that there won't be one simple
    >>> answer. Nevertheless, I'd like to make my usage
    >>> decisions on something rather than anedotal claims.
    >>> 
    >>> So, does anyone know of a good benchmarking script or
    >>> would be willing to contribute one?
    >>> 
    >>> And here are the settings we used to compile R with
    >>> Intel 10.1 compilers:
    >>> 
    >>> ../configure
    >>> --prefix=/N/u/mkimpel/R_HOME/R-patched/R-build \
    >>> --with-system-zlib=/usr/lib64
    >>> --with-system-bzlib=/usr/lib64 \
    >>> --with-mpi=/N/soft/linux-rhel4-x86_64/openmpi/1.2.5/intel-64
    >>> --with- tcltk \
    >>> --with-tcl-config=/N/soft/linux-rhel4-x86_64/tcl8.4.16/lib64/
    >>> tclConfig.sh \
    >>> --with-tk-config=/N/soft/linux-rhel4-x86_64/tk8.4.16/lib64/
    >>> tkConfig.sh \ --without-x --without-readline
    >>> --without-iconv \
    >>> CC="/N/soft/linux-rhel4-x86_64/intel/cce/10.1.013/bin/icc"
    >>> \ CFLAGS="-O3 -no-prec-div -unroll" \
    >>> F77="/N/soft/linux-rhel4-x86_64/intel/fce/10.1.013/bin/ifort"
    >>> \ FFLAGS="-O3 -no-prec-div -unroll" \
    >>> CXX="/N/soft/linux-rhel4-x86_64/intel/cce/10.1.013/bin/icpc"
    >>> \ CXXFLAGS="-O3 -no-prec-div -unroll" \
    >>> FC="/N/soft/linux-rhel4-x86_64/intel/fce/10.1.013/bin/ifort"
    >>> \ FCFLAGS="-O3 -no-prec-div -unroll" \
    >>> OBJC="/N/soft/linux-rhel4-x86_64/intel/cce/10.1.013/bin/icc"
    >>> \ OBJCFLAGS="-O3 -no-prec-div -unroll" \
    >>> --disable-R-profiling --disable-memory-profiling
    >>> ##
    >>> make all make install
    >>> 
    >>> Mark
    >>> 
    >>> -- 
    >>> Mark W. Kimpel MD ** Neuroinformatics ** Dept. of
    >>> Psychiatry Indiana University School of Medicine
    >>> 
    >>> 15032 Hunter Court, Westfield, IN 46074
    >>> 
    >>> (317) 490-5129 Work, & Mobile & VoiceMail (317) 663-0513
    >>> Home (no voice mail please)
    >>> 
    >>> ******************************************************************
    >>> 
    >>> [[alternative HTML version deleted]]
    >>> 
    >>> ______________________________________________
    >>> R-devel at r-project.org mailing list
    >>> https://stat.ethz.ch/mailman/listinfo/r-devel
    >>> 
    >> 
> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >> 
    >> 

______________________________________________
    SU> R-devel at r-project.org mailing list
    SU> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch at stats.uwo.ca  Wed Jun  4 01:06:01 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 03 Jun 2008 19:06:01 -0400
Subject: [Rd] significant digits (PR#9682)
In-Reply-To: <20080603213515.117B12834157@mail.pubhealth.ku.dk>
References: <20080603213515.117B12834157@mail.pubhealth.ku.dk>
Message-ID: <4845CE59.9040504@stats.uwo.ca>

simon.urbanek at r-project.org wrote:
> On Jun 3, 2008, at 5:12 PM, Duncan Murdoch wrote:
>
>   
>> On 6/3/2008 4:36 PM, Simon Urbanek wrote:
>>     
>>> On Jun 3, 2008, at 2:48 PM, Duncan Murdoch wrote:
>>>       
>>>> On 6/3/2008 11:43 AM, Patrick Carr wrote:
>>>>         
>>>>> On 6/3/08, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>>>>>           
>>>>>> because signif(0.90, digits=2) == 0.9.  Those two objects are   
>>>>>> identical.
>>>>>>             
>>>>> My text above that is poorly worded. They're identical internally,
>>>>> yes. But in terms of the number of significant digits, 0.9 and 0.90
>>>>> are different. And that matters when the number is printed, say  
>>>>> as an
>>>>> annotation on a graph. Passing it through sprintf() or format()  
>>>>> later
>>>>> requires you to specify the number of digits after the decimal,  
>>>>> which
>>>>> is different than the number of significant digits, and requires  
>>>>> case
>>>>> testing for numbers of different orders of magnitude.
>>>>> The original complainant (and I) expected this behavior from   
>>>>> signif(),
>>>>> not merely rounding. As I said before, I wrote my own workaround so
>>>>> this is somewhat academic, but I don't think we're alone.
>>>>>           
>>>>>> As far as I know, rounding is fine in Windows:
>>>>>>
>>>>>>             
>>>>>>> round(1:10 + 0.5)
>>>>>>>               
>>>>>> [1]  2  2  4  4  6  6  8  8 10 10
>>>>>>
>>>>>>             
>>>>> It might not be the rounding, then. (windows xp sp3)
>>>>>  > signif(12345,digits=4)
>>>>>  [1] 12340
>>>>>  > signif(0.12345,digits=4)
>>>>>  [1] 0.1235
>>>>>           
>>>> It's easy to make mistakes in this, but a little outside-of-R   
>>>> experimentation suggests those are the right answers.  The number   
>>>> 12345 is exactly representable, so it is exactly half-way between   
>>>> 12340 and 12350, so 12340 is the right answer by the unbiased  
>>>> round- to-even rule.  The number 0.12345 is not exactly  
>>>> representable, but  (I think) it is represented by something  
>>>> slightly closer to 0.1235  than to 0.1234.  So it looks as though  
>>>> Windows gets it right.
>>>>
>>>>
>>>>         
>>>>> OS X (10.5.2/intel) does not have that problem.
>>>>>           
>>>> Which would seem to imply OS X gets it wrong.
>>>>         
>>> This has nothing to do with OS X, you get that same answer on  
>>> pretty  much all other platforms (Intel/Linux, MIPS/IRIX, Sparc/ 
>>> Sun, ...).  Windows is the only one delivering the incorrect result  
>>> here.
>>>       
>>>> Both are supposed to be using the 64 bit floating point standard,   
>>>> so they should both give the same answer:
>>>>         
>>> Should, yes, but Windows doesn't. In fact 10000.0 is exactly   
>>> representable and so is 1234.5 which is the correct result that  
>>> all  except Windows get.
>>>       
>> I think you skipped a step.
>>     
>
> I didn't - I was just pointing out that what you are trying to show is  
> irrelevant. We are dealing with FP arithmetics here, so although your  
> reasoning is valid algebraically, it's not in FP world. You missed the  
> fact that FP operations are used to actually get the result (*10000.0,  
> round and divide again) and thus those operation will influence it as  
> well.
>   

But your multiplication isn't accurate:  10000 is 16 times 625.  
Multiplying by 16 will shift the binary representation by 4 places, but 
multiplying by an odd number should leave the last 1 bit in place.  If 
you go through the following series of operations, you get a different 
answer than multiplying by 10000:

 > x <- 0.12345
 > x <- 16*x
 > y <- x
 > x <- 624*x
 > x + y - 1234.5
[1] 2.273737e-13

versus

 > x <- 0.12345
 > x <- 10000*x
 > x - 1234.5
[1] 0

I get identical results for both of these calculations on a Mac and on 
Windows.  Looks strange, but I think the explanation is that multiplying 
by 625 (or 10000) needs one more bit than multiplying by 624 needs, so 
we lose a bit at that point.  Windows does the multiplication by 10000 
accurately in its 64 bit registers, and then loses the last bit on 
storing the result into x in 53 bits.  But in the signif() calculation, 
everything stays in 64 bit precision, so Windows gets the right result 
(0.1235), while those systems that round intermediate results get it 
wrong (0.1234).

It's all FP calculations, but in Windows we've programmed the run-time 
to keep extra bits around for intermediate results and get more accurate 
results in cases where things stay in registers, whereas the other 
systems throw away the bits and get more consistent results regardless 
of the execution path. 

Duncan Murdoch


>
>   
>>  The correct answer is either 0.1234 or 0.1235, not something 10000  
>> times bigger.  The first important question is whether 0.12345 is  
>> exactly representable, and the answer is no.  The second question is  
>> whether it is represented by a number bigger or smaller than the  
>> real number 0.12345.  If it is bigger, the answer should be 0.1235,  
>> and if it is smaller, the answer is 0.1234.
>>     
>
> No. That was what I was trying to point out. You can see clearly from  
> my post that 0.12345 is not exactly representable and that the  
> representation is slightly bigger. This is, however, irrelevant,  
> because the next step is to multiply that number by 10000 (see fprec  
> source) and this is where your reasoning breaks down - the result is  
> exact representation of 1234.5, because the imprecision gets lost in  
> the operation on all platforms but Windows. The result is that Windows  
> is inconsistent with others, whether that is a bug or feature I don't  
> care. All I really wanted to say is that this has nothing to do with  
> OS X - if anything then it's a Windows issue.
>
>
>   
>>  My experiments suggest it is bigger.
>>     
>
> I was not claiming otherwise.
>
>
>   
>>  Yours don't look relevant.
>>     
>
> Vice versa as it turns out.
>
> Cheers,
> Simon
>
>
>   
>> It certainly isn't exactly equal to 1234.5/10000, because that  
>> number is not representable.  It's equal to x/2^y, for some x and y,  
>> and it's a pain to figure out exactly what they are.
>>
>> However, I am pretty sure R is representing it (at least on Windows)  
>> as the binary expansion
>>
>> 0.000111111001101001101011010100001011000011110010011111
>>
>> while the true binary expansion (using exact rational arithmetic)  
>> starts out
>>
>> 0.00011111100110100110101101010000101100001111001001111011101...
>>
>> If you line those up, you'll see that the first number is bigger  
>> than the second.  (Ugly code to derive these is down below.)
>>
>> Clearly the top representation is the correct one to that number of  
>> binary digits, so I think Windows got it right, and all those other  
>> systems didn't.  This is probably because R on Windows is using  
>> extended precision (64 bit mantissas) for intermediate results, and  
>> those other systems stick with 53 bit mantissas.
>>
>>     
>
> However, this means that Windows doesn't conform
>
>   
>> Duncan Murdoch
>>
>> # Convert number to binary expansion; add the decimal point manually
>>
>> x <- 0.12345
>> while (x != 0) {
>>  cat(trunc(x))
>>  x <- x - trunc(x)
>>  x <- x * 2
>> }
>>
>> # Do the same thing in exact rational arithmetic
>>
>> num <- 12345
>> denom <- 100000
>> for (i in 1:60) {
>>  cat(ifelse(num > 100000, "1", "0"))
>>  num <- num %% 100000
>>  num <- 2*num
>> }
>>
>> # Manually cut and paste the results to get these:
>>
>> "0.000111111001101001101011010100001011000011110010011111"
>> "0.00011111100110100110101101010000101100001111001001111011101"
>>
>>
>>     
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From murdoch at stats.uwo.ca  Wed Jun  4 02:40:03 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 03 Jun 2008 20:40:03 -0400
Subject: [Rd] savePlot() no longer automatically adds an extension to
 the	filename.
In-Reply-To: <ou2b449rirr8tkv0con6u598vhocp2kmfk@4ax.com>
References: <s8456fea.037@tedmail.lgc.co.uk>
	<ou2b449rirr8tkv0con6u598vhocp2kmfk@4ax.com>
Message-ID: <4845E463.8020907@stats.uwo.ca>

On 03/06/2008 2:35 PM, Mike Prager wrote:
> "S Ellison" <S.Ellison at lgc.co.uk> wrote:
> 
>> Plaintive squeak: Why the change? 
>>
>> Some OS's and desktops use the extension, so forgetting it causes
>> trouble. The new default filename keeps a filetype (as before) but the
>> user now has to type a filetype twice (once as the type, once as
>> extension) to get the same effect fo rtheir own filenames. And the
>> extension isn't then checked for consistency with valid file types, so
>> it can be mistyped and saved with no warning. Hard to see the advantage
>> of doing away with it...
> 
> Just for the record. . .
> 
> This change broke a *lot* of my code, including code used by
> others.  Windows depends on file extensions.  Fortunately, fixes
> using getRversion are not too difficult.
> 

Then you'll be happy to hear that Steve put together a patch and it's 
already committed, so it should make it into 2.7.1.  The patch adds the 
extension if there's no dot in the name, leaves the filename as-is if it 
sees one.  So this should be compatible with the majority of uses, only 
messing up cases where people really don't want an extension (now 
they'll have to add a dot at the end of their filename), or where they 
want an automatic one, but have another dot in the name.

Duncan Murdoch


From mwkimpel at gmail.com  Wed Jun  4 04:17:33 2008
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Tue, 3 Jun 2008 22:17:33 -0400
Subject: [Rd] benchmarking R installations
In-Reply-To: <18501.52730.350059.509071@cmath-5.math.ethz.ch>
References: <6b93d1830806022056o274e97c3i8d954748e17f6a81@mail.gmail.com>
	<20080603095219.G53049@xs7.xs4all.nl>
	<339D6E60-D926-4351-93DB-1E7C7D366800@r-project.org>
	<18501.52730.350059.509071@cmath-5.math.ethz.ch>
Message-ID: <6b93d1830806031917g39677670m8671ced32a7805fe@mail.gmail.com>

Thanks, once I get my new Intel installation running in tandem with a
gcc one, I'll report back. mark

On Tue, Jun 3, 2008 at 7:04 PM, Martin Maechler
<maechler at stat.math.ethz.ch> wrote:
>>>>>> "SU" == Simon Urbanek <simon.urbanek at r-project.org>
>>>>>>     on Tue, 3 Jun 2008 11:52:14 -0400 writes:
>
>    SU> On Jun 3, 2008, at 3:58 AM, Ludo Pagie wrote:
>
>    >> recently there was a post on R-help/Rd ?? with this link
>    >> on benchmarking different 'number crunching
>    >> packages'. They used a series of tests, although I didn't
>    >> check they used all the types you mentioned. I couldn't
>    >> find test code at first glance but myyebe it is available
>    >> on request???
>    >>
>    >> http://www.sciviews.org/benchmark/
>    >>
>
>    SU> It's quite outdated and doesn't work with the current R versions,
>
> Yes, that was the topic of the recent R-help post mentioned
> above.  And because of that I did post an updated version back to the
> list.
> Here's the posting, as found on http://search.r-project.org :
>    http://finzi.psych.upenn.edu/R/Rhelp02a/archive/130270.html
> and the R script here
>   https://stat.ethz.ch/pipermail/r-help/attachments/20080514/0ccea72b/attachment.pl
>
>    SU> but I have an updated version that works. I have put some
>    SU> benchmarks I'm aware of at
>
>    SU> http://r.research.att.com/benchmarks/
>
> That's cool!  Thanks, Simon!
> Martin
>
>    >> On Mon, 2 Jun 2008, Mark Kimpel wrote:
>    >>
>    >>> Recently I posted to this list with a question about
>    >>> using the Intel 10.1 compilers in building R and one
>    >>> response was basically, "why in the heck would you want
>    >>> to do that?" The answer is that my sysadmin believes
>    >>> that there will be a performance boost with the Intel
>    >>> vs. Gnu compilers on our Linux cluster, of which I am
>    >>> one of many users. Wanting to be a good citizen and use
>    >>> my machine time wisely, I'd of course like to use right
>    >>> tool to build the most efficient installation of R and
>    >>> associated packages.  BTW, we got R to compile nicely
>    >>> using the settings at the end of this post.
>    >>>
>    >>> Looking back on previous posts, however, it seems that
>    >>> there is no consensus as to how to benchmark R. I
>    >>> realize such a task is not trivial, nor controversial,
>    >>> but does anyone have a set of time-consuming tasks that
>    >>> can be used to compare R installations? It would seem
>    >>> logical that such a benchmark would include
>    >>> sub-benchmarks on file access, interpreted intensive
>    >>> tasks, C intensive tasks, BLAS intensive tasks, etc. You
>    >>> developers know more about this than I do, but I know
>    >>> enough to realize that there won't be one simple
>    >>> answer. Nevertheless, I'd like to make my usage
>    >>> decisions on something rather than anedotal claims.
>    >>>
>    >>> So, does anyone know of a good benchmarking script or
>    >>> would be willing to contribute one?
>    >>>
>    >>> And here are the settings we used to compile R with
>    >>> Intel 10.1 compilers:
>    >>>
>    >>> ../configure
>    >>> --prefix=/N/u/mkimpel/R_HOME/R-patched/R-build \
>    >>> --with-system-zlib=/usr/lib64
>    >>> --with-system-bzlib=/usr/lib64 \
>    >>> --with-mpi=/N/soft/linux-rhel4-x86_64/openmpi/1.2.5/intel-64
>    >>> --with- tcltk \
>    >>> --with-tcl-config=/N/soft/linux-rhel4-x86_64/tcl8.4.16/lib64/
>    >>> tclConfig.sh \
>    >>> --with-tk-config=/N/soft/linux-rhel4-x86_64/tk8.4.16/lib64/
>    >>> tkConfig.sh \ --without-x --without-readline
>    >>> --without-iconv \
>    >>> CC="/N/soft/linux-rhel4-x86_64/intel/cce/10.1.013/bin/icc"
>    >>> \ CFLAGS="-O3 -no-prec-div -unroll" \
>    >>> F77="/N/soft/linux-rhel4-x86_64/intel/fce/10.1.013/bin/ifort"
>    >>> \ FFLAGS="-O3 -no-prec-div -unroll" \
>    >>> CXX="/N/soft/linux-rhel4-x86_64/intel/cce/10.1.013/bin/icpc"
>    >>> \ CXXFLAGS="-O3 -no-prec-div -unroll" \
>    >>> FC="/N/soft/linux-rhel4-x86_64/intel/fce/10.1.013/bin/ifort"
>    >>> \ FCFLAGS="-O3 -no-prec-div -unroll" \
>    >>> OBJC="/N/soft/linux-rhel4-x86_64/intel/cce/10.1.013/bin/icc"
>    >>> \ OBJCFLAGS="-O3 -no-prec-div -unroll" \
>    >>> --disable-R-profiling --disable-memory-profiling
>    >>> ##
>    >>> make all make install
>    >>>
>    >>> Mark
>    >>>
>    >>> --
>    >>> Mark W. Kimpel MD ** Neuroinformatics ** Dept. of
>    >>> Psychiatry Indiana University School of Medicine
>    >>>
>    >>> 15032 Hunter Court, Westfield, IN 46074
>    >>>
>    >>> (317) 490-5129 Work, & Mobile & VoiceMail (317) 663-0513
>    >>> Home (no voice mail please)
>    >>>
>    >>> ******************************************************************
>    >>>
>    >>> [[alternative HTML version deleted]]
>    >>>
>    >>> ______________________________________________
>    >>> R-devel at r-project.org mailing list
>    >>> https://stat.ethz.ch/mailman/listinfo/r-devel
>    >>>
>    >>
>> ______________________________________________
>    >> R-devel at r-project.org mailing list
>    >> https://stat.ethz.ch/mailman/listinfo/r-devel
>    >>
>    >>
>
> ______________________________________________
>    SU> R-devel at r-project.org mailing list
>    SU> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Mark W. Kimpel MD ** Neuroinformatics ** Dept. of Psychiatry
Indiana University School of Medicine

15032 Hunter Court, Westfield, IN 46074

(317) 490-5129 Work, & Mobile & VoiceMail
(317) 663-0513 Home (no voice mail please)


From simon.urbanek at r-project.org  Wed Jun  4 04:36:05 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 3 Jun 2008 22:36:05 -0400
Subject: [Rd] savePlot() no longer automatically adds an extension to
	the	filename.
In-Reply-To: <4845E463.8020907@stats.uwo.ca>
References: <s8456fea.037@tedmail.lgc.co.uk>
	<ou2b449rirr8tkv0con6u598vhocp2kmfk@4ax.com>
	<4845E463.8020907@stats.uwo.ca>
Message-ID: <105532E2-2C4C-4299-81B2-CA949078C468@r-project.org>


On Jun 3, 2008, at 8:40 PM, Duncan Murdoch wrote:

> On 03/06/2008 2:35 PM, Mike Prager wrote:
>> "S Ellison" <S.Ellison at lgc.co.uk> wrote:
>>> Plaintive squeak: Why the change?
>>> Some OS's and desktops use the extension, so forgetting it causes
>>> trouble. The new default filename keeps a filetype (as before) but  
>>> the
>>> user now has to type a filetype twice (once as the type, once as
>>> extension) to get the same effect fo rtheir own filenames. And the
>>> extension isn't then checked for consistency with valid file  
>>> types, so
>>> it can be mistyped and saved with no warning. Hard to see the  
>>> advantage
>>> of doing away with it...
>> Just for the record. . .
>> This change broke a *lot* of my code, including code used by
>> others.  Windows depends on file extensions.  Fortunately, fixes
>> using getRversion are not too difficult.
>
> Then you'll be happy to hear that Steve put together a patch and  
> it's already committed, so it should make it into 2.7.1.  The patch  
> adds the extension if there's no dot in the name, leaves the  
> filename as-is if it sees one.  So this should be compatible with  
> the majority of uses, only messing up cases where people really  
> don't want an extension (now they'll have to add a dot at the end of  
> their filename), or where they want an automatic one, but have  
> another dot in the name.
>

AFAICS the savePlot() behavior is now (as of r45830) inconsistent  
across platforms due to the patch (r458229). The inconsistency is IMHO  
a bad thing - you shouldn't expect the same function to behave  
differently across platforms.

I'd strongly recommend against this change for several reasons: it  
changes the behavior of the function between 2.7.0 and 2.7.1, so that  
now you have to special-case three different versions (pre 2.7.0,  
2.7.0 and 2.7.1), there is now no way to specify a file without a dot  
(which is quite common in non-Windows world) and the behavior is  
incompatible with other similar functions.

I think the change of behavior in 2.7.0 was deliberate and in favor of  
consistency, because a filename specification should not be randomly  
mangled by the function (I have made that mistake myself before, so I  
know the pitfalls ;)). Extension is part of the filename, it's not a  
separate concept (also note that ".foo" is a valid  filename that  
doesn't have an extension). The argument about typos is moot since you  
can always define functions like
saveFoo <- function(prefix) savePlot(filename = paste(prefix, "foo",  
sep="."), type="foo")
At any rate I don't see how this can realistically be part of 2.7.1  
since it's not a bugfix and it changes the meaning of a function  
parameter. (And I usually don't mind disguising small features as  
bugfixes ;P)

Whether the change in 2.7.0 could be done differently (e.g. using  
another parameter for a full file name) is a different story, but I  
suspect that it should have been discussed before the 2.7.0 release...

Cheers,
Simon


From ggrothendieck at gmail.com  Wed Jun  4 04:50:16 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Tue, 3 Jun 2008 22:50:16 -0400
Subject: [Rd] savePlot() no longer automatically adds an extension to
	the filename.
In-Reply-To: <105532E2-2C4C-4299-81B2-CA949078C468@r-project.org>
References: <s8456fea.037@tedmail.lgc.co.uk>
	<ou2b449rirr8tkv0con6u598vhocp2kmfk@4ax.com>
	<4845E463.8020907@stats.uwo.ca>
	<105532E2-2C4C-4299-81B2-CA949078C468@r-project.org>
Message-ID: <971536df0806031950m663c6154v3b92bffed7c16bd6@mail.gmail.com>

On Tue, Jun 3, 2008 at 10:36 PM, Simon Urbanek
<simon.urbanek at r-project.org> wrote:
>
> On Jun 3, 2008, at 8:40 PM, Duncan Murdoch wrote:
>
>> On 03/06/2008 2:35 PM, Mike Prager wrote:
>>>
>>> "S Ellison" <S.Ellison at lgc.co.uk> wrote:
>>>>
>>>> Plaintive squeak: Why the change?
>>>> Some OS's and desktops use the extension, so forgetting it causes
>>>> trouble. The new default filename keeps a filetype (as before) but the
>>>> user now has to type a filetype twice (once as the type, once as
>>>> extension) to get the same effect fo rtheir own filenames. And the
>>>> extension isn't then checked for consistency with valid file types, so
>>>> it can be mistyped and saved with no warning. Hard to see the advantage
>>>> of doing away with it...
>>>
>>> Just for the record. . .
>>> This change broke a *lot* of my code, including code used by
>>> others.  Windows depends on file extensions.  Fortunately, fixes
>>> using getRversion are not too difficult.
>>
>> Then you'll be happy to hear that Steve put together a patch and it's
>> already committed, so it should make it into 2.7.1.  The patch adds the
>> extension if there's no dot in the name, leaves the filename as-is if it
>> sees one.  So this should be compatible with the majority of uses, only
>> messing up cases where people really don't want an extension (now they'll
>> have to add a dot at the end of their filename), or where they want an
>> automatic one, but have another dot in the name.
>>
>
> AFAICS the savePlot() behavior is now (as of r45830) inconsistent across
> platforms due to the patch (r458229). The inconsistency is IMHO a bad thing
> - you shouldn't expect the same function to behave differently across
> platforms.
>
> I'd strongly recommend against this change for several reasons: it changes
> the behavior of the function between 2.7.0 and 2.7.1, so that now you have
> to special-case three different versions (pre 2.7.0, 2.7.0 and 2.7.1), there
> is now no way to specify a file without a dot (which is quite common in
> non-Windows world) and the behavior is incompatible with other similar
> functions.
>
> I think the change of behavior in 2.7.0 was deliberate and in favor of
> consistency, because a filename specification should not be randomly mangled
> by the function (I have made that mistake myself before, so I know the
> pitfalls ;)). Extension is part of the filename, it's not a separate concept
> (also note that ".foo" is a valid  filename that doesn't have an extension).
> The argument about typos is moot since you can always define functions like
> saveFoo <- function(prefix) savePlot(filename = paste(prefix, "foo",
> sep="."), type="foo")
> At any rate I don't see how this can realistically be part of 2.7.1 since
> it's not a bugfix and it changes the meaning of a function parameter. (And I
> usually don't mind disguising small features as bugfixes ;P)
>
> Whether the change in 2.7.0 could be done differently (e.g. using another
> parameter for a full file name) is a different story, but I suspect that it
> should have been discussed before the 2.7.0 release...
>

One way to fix this so that the filename is a complete name is to derive
the default type from the filename rather than the default filename
from the type.

That is if type is not specified and the last four characters of the file name
are .wmf, .jpg, ..., etc. then the type would be set to that.


From Mike.Prager at noaa.gov  Wed Jun  4 05:28:20 2008
From: Mike.Prager at noaa.gov (Michael Prager)
Date: Tue, 03 Jun 2008 23:28:20 -0400
Subject: [Rd] savePlot() no longer automatically adds an extension to
	the	filename.
In-Reply-To: <105532E2-2C4C-4299-81B2-CA949078C468@r-project.org>
References: <s8456fea.037@tedmail.lgc.co.uk>
	<ou2b449rirr8tkv0con6u598vhocp2kmfk@4ax.com>
	<4845E463.8020907@stats.uwo.ca>
	<105532E2-2C4C-4299-81B2-CA949078C468@r-project.org>
Message-ID: <48460BD4.3040502@noaa.gov>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080603/9e52a619/attachment.pl>

From murdoch at stats.uwo.ca  Wed Jun  4 12:53:42 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 04 Jun 2008 06:53:42 -0400
Subject: [Rd] savePlot() no longer automatically adds an extension to
 the	filename.
In-Reply-To: <105532E2-2C4C-4299-81B2-CA949078C468@r-project.org>
References: <s8456fea.037@tedmail.lgc.co.uk>
	<ou2b449rirr8tkv0con6u598vhocp2kmfk@4ax.com>
	<4845E463.8020907@stats.uwo.ca>
	<105532E2-2C4C-4299-81B2-CA949078C468@r-project.org>
Message-ID: <48467436.8050403@stats.uwo.ca>

Simon Urbanek wrote:
> On Jun 3, 2008, at 8:40 PM, Duncan Murdoch wrote:
>
>   
>> On 03/06/2008 2:35 PM, Mike Prager wrote:
>>     
>>> "S Ellison" <S.Ellison at lgc.co.uk> wrote:
>>>       
>>>> Plaintive squeak: Why the change?
>>>> Some OS's and desktops use the extension, so forgetting it causes
>>>> trouble. The new default filename keeps a filetype (as before) but  
>>>> the
>>>> user now has to type a filetype twice (once as the type, once as
>>>> extension) to get the same effect fo rtheir own filenames. And the
>>>> extension isn't then checked for consistency with valid file  
>>>> types, so
>>>> it can be mistyped and saved with no warning. Hard to see the  
>>>> advantage
>>>> of doing away with it...
>>>>         
>>> Just for the record. . .
>>> This change broke a *lot* of my code, including code used by
>>> others.  Windows depends on file extensions.  Fortunately, fixes
>>> using getRversion are not too difficult.
>>>       
>> Then you'll be happy to hear that Steve put together a patch and  
>> it's already committed, so it should make it into 2.7.1.  The patch  
>> adds the extension if there's no dot in the name, leaves the  
>> filename as-is if it sees one.  So this should be compatible with  
>> the majority of uses, only messing up cases where people really  
>> don't want an extension (now they'll have to add a dot at the end of  
>> their filename), or where they want an automatic one, but have  
>> another dot in the name.
>>
>>     
>
> AFAICS the savePlot() behavior is now (as of r45830) inconsistent  
> across platforms due to the patch (r458229). The inconsistency is IMHO  
> a bad thing - you shouldn't expect the same function to behave  
> differently across platforms.
>   
savePlot has been a Windows function for at least 4 years, defined in 
the grDevices/R/windows directory, and documented in the 
grDevices/man/windows directory.  An incompatible X11 version was added 
in February 2008.  So if compatibility across
platforms is the goal, we should change the X11 version to match the 
Windows version, not vice versa.

However, the convention of automatically adding an extension is a 
Windows convention, not a Unix convention.  So I think that would be a 
bad change.  This is a user interface issue, and it is reasonable to 
have differences in user interfaces across platforms.

> I'd strongly recommend against this change for several reasons: it  
> changes the behavior of the function between 2.7.0 and 2.7.1, so that  
> now you have to special-case three different versions (pre 2.7.0,  
> 2.7.0 and 2.7.1), there is now no way to specify a file without a dot  
> (which is quite common in non-Windows world) and the behavior is  
> incompatible with other similar functions.
>
> I think the change of behavior in 2.7.0 was deliberate and in favor of  
> consistency, because a filename specification should not be randomly  
> mangled by the function (I have made that mistake myself before, so I  
> know the pitfalls ;)). Extension is part of the filename, it's not a  
> separate concept (also note that ".foo" is a valid  filename that  
> doesn't have an extension). The argument about typos is moot since you  
> can always define functions like
> saveFoo <- function(prefix) savePlot(filename = paste(prefix, "foo",  
> sep="."), type="foo")
> At any rate I don't see how this can realistically be part of 2.7.1  
> since it's not a bugfix and it changes the meaning of a function  
> parameter. (And I usually don't mind disguising small features as  
> bugfixes ;P)
>
> Whether the change in 2.7.0 could be done differently (e.g. using  
> another parameter for a full file name) is a different story, but I  
> suspect that it should have been discussed before the 2.7.0 release...
>
>   
I agree it should have been discussed earlier, but it wasn't.  There are 
lots of precedents for behaviour changes between .0 and .1 releases, for 
the sake of back-compatibility.

So I think Steve's change is appropriate, and I'm planning to leave it in.

Duncan Murdoch

> Cheers,
> Simon
>
>


From murdoch at stats.uwo.ca  Wed Jun  4 13:03:00 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 04 Jun 2008 07:03:00 -0400
Subject: [Rd] savePlot() no longer automatically adds an extension to
 the filename.
In-Reply-To: <971536df0806031950m663c6154v3b92bffed7c16bd6@mail.gmail.com>
References: <s8456fea.037@tedmail.lgc.co.uk>	
	<ou2b449rirr8tkv0con6u598vhocp2kmfk@4ax.com>	
	<4845E463.8020907@stats.uwo.ca>	
	<105532E2-2C4C-4299-81B2-CA949078C468@r-project.org>
	<971536df0806031950m663c6154v3b92bffed7c16bd6@mail.gmail.com>
Message-ID: <48467664.2090703@stats.uwo.ca>

Gabor Grothendieck wrote:
> On Tue, Jun 3, 2008 at 10:36 PM, Simon Urbanek
> <simon.urbanek at r-project.org> wrote:
>   
>> On Jun 3, 2008, at 8:40 PM, Duncan Murdoch wrote:
>>
>>     
>>> On 03/06/2008 2:35 PM, Mike Prager wrote:
>>>       
>>>> "S Ellison" <S.Ellison at lgc.co.uk> wrote:
>>>>         
>>>>> Plaintive squeak: Why the change?
>>>>> Some OS's and desktops use the extension, so forgetting it causes
>>>>> trouble. The new default filename keeps a filetype (as before) but the
>>>>> user now has to type a filetype twice (once as the type, once as
>>>>> extension) to get the same effect fo rtheir own filenames. And the
>>>>> extension isn't then checked for consistency with valid file types, so
>>>>> it can be mistyped and saved with no warning. Hard to see the advantage
>>>>> of doing away with it...
>>>>>           
>>>> Just for the record. . .
>>>> This change broke a *lot* of my code, including code used by
>>>> others.  Windows depends on file extensions.  Fortunately, fixes
>>>> using getRversion are not too difficult.
>>>>         
>>> Then you'll be happy to hear that Steve put together a patch and it's
>>> already committed, so it should make it into 2.7.1.  The patch adds the
>>> extension if there's no dot in the name, leaves the filename as-is if it
>>> sees one.  So this should be compatible with the majority of uses, only
>>> messing up cases where people really don't want an extension (now they'll
>>> have to add a dot at the end of their filename), or where they want an
>>> automatic one, but have another dot in the name.
>>>
>>>       
>> AFAICS the savePlot() behavior is now (as of r45830) inconsistent across
>> platforms due to the patch (r458229). The inconsistency is IMHO a bad thing
>> - you shouldn't expect the same function to behave differently across
>> platforms.
>>
>> I'd strongly recommend against this change for several reasons: it changes
>> the behavior of the function between 2.7.0 and 2.7.1, so that now you have
>> to special-case three different versions (pre 2.7.0, 2.7.0 and 2.7.1), there
>> is now no way to specify a file without a dot (which is quite common in
>> non-Windows world) and the behavior is incompatible with other similar
>> functions.
>>
>> I think the change of behavior in 2.7.0 was deliberate and in favor of
>> consistency, because a filename specification should not be randomly mangled
>> by the function (I have made that mistake myself before, so I know the
>> pitfalls ;)). Extension is part of the filename, it's not a separate concept
>> (also note that ".foo" is a valid  filename that doesn't have an extension).
>> The argument about typos is moot since you canf always define functions like
>> saveFoo <- function(prefix) savePlot(filename = paste(prefix, "foo",
>> sep="."), type="foo")
>> At any rate I don't see how this can realistically be part of 2.7.1 since
>> it's not a bugfix and it changes the meaning of a function parameter. (And I
>> usually don't mind disguising small features as bugfixes ;P)
>>
>> Whether the change in 2.7.0 could be done differently (e.g. using another
>> parameter for a full file name) is a different story, but I suspect that it
>> should have been discussed before the 2.7.0 release...
>>
>>     
>
> One way to fix this so that the filename is a complete name is to derive
> the default type from the filename rather than the default filename
> from the type.
>
> That is if type is not specified and the last four characters of the file name
> are .wmf, .jpg, ..., etc. then the type would be set to that.
>   

I think that would have been a better design when savePlot was 
introduced many years ago, but the goal here is to maintain back 
compatibility.  It wouldn't help with that, because before February, 
savePlot got the type from the "type" arg, and modified the filename to 
match.

Duncan Murdoch


From Karl.Hufthammer at math.uib.no  Wed Jun  4 13:17:52 2008
From: Karl.Hufthammer at math.uib.no (Karl Ove Hufthammer)
Date: Wed, 04 Jun 2008 13:17:52 +0200
Subject: [Rd] significant digits (PR#9682)
References: <20080602234017.CB1FD282C786@mail.pubhealth.ku.dk>
	<48451EBC.1000207@stats.uwo.ca>
	<a696b2f20806030843i5c290c87u1125b280b8a7672e@mail.gmail.com>
	<48459200.20401@stats.uwo.ca>
Message-ID: <g25tl0$bbi$1@ger.gmane.org>

Duncan Murdoch:

> The number 0.12345 is not exactly representable, but (I think) it is
> represented by something slightly closer to 0.1235 than to 0.1234.

I like using formatC for checking such things. On my (Linux) system, I get:

$ formatC(.12345,digits=50)
[1] "0.12345000000000000417443857259058859199285507202148"

> So it looks as though Windows gets it right.

-- 
Karl Ove Hufthammer


From S.Ellison at lgc.co.uk  Wed Jun  4 13:44:05 2008
From: S.Ellison at lgc.co.uk (S Ellison)
Date: Wed, 04 Jun 2008 12:44:05 +0100
Subject: [Rd] savePlot() no longer automatically adds an extension	to
	the	filename.
Message-ID: <s8468e26.039@tedmail.lgc.co.uk>

>>> Michael Prager <Mike.Prager at noaa.gov> 06/04/08 4:28 AM >>>
>There is much to be said for consistency (across platforms and 
>functions) and stability (across versions) in software.

I could not agree more. But while consistency  is an excellent reason
for making the patch consistent across platforms, it doesn't help decide
what the consistent behaviour should be. It is as strong an argument for
retaining the original behaviour at 2.6.x as for keeping a change. 

As to filename extensions or their lack; in practice, RGui.exe addds a
defult Rdata extension on saving a workspace via the GUI, and so does
saving history, so we already have overwriteable default extensions for
those purposes even though the command line behaviour doesn't do that. 
And it genuinely does help, which is my main motivation here.

The main advantage of the present patch is that it delivers _most_ of
the optional behaviours missing from both 2.6.2 and 2.7.0 without adding
an extra parameter. But it isn't the best that could be done. If there
is a platform-independent way of keeping the default extension-by-type
and allowing the option of removing it entirely (in other words, an
extra parameter to savePlot) I'd personally see that as a better way
forward than the present patch. 
An alternative might be to keep the 2.7.0 savePlot and define a new
convenience function (SavePlot, say, or save.plot for extra dottiness) 
which provides the wrapper. It would have impact on legacy code, but it
is a lot easier to change a function name throughout legacy code than to
change supplied parameters.

In the mean time, consistency arguments would indicate that the present
patch should be applied to all platforms if at all.

Steve E

*******************************************************************
This email and any attachments are confidential. Any use...{{dropped:8}}


From S.Ellison at lgc.co.uk  Wed Jun  4 13:57:05 2008
From: S.Ellison at lgc.co.uk (S Ellison)
Date: Wed, 04 Jun 2008 12:57:05 +0100
Subject: [Rd] savePlot() no longer automatically adds an	extension	to
	the	filename.
Message-ID: <s8469131.004@tedmail.lgc.co.uk>

Apologies; in my last post (below) I should have distinguished between
action on the current patch and suggested action for the future.

I bow to Duncan on the fate of the current patch, as he's managing it.

The suggestions of an extra savePlot parameter or a wrapper function
with extension default were suggestions for possible future tidying-up
in subsequent releases.

Steve E

>>> "S Ellison" <S.Ellison at lgc.co.uk> 06/04/08 12:44 PM >>>
>>> Michael Prager <Mike.Prager at noaa.gov> 06/04/08 4:28 AM >>>
>There is much to be said for consistency (across platforms and 
>functions) and stability (across versions) in software.

I could not agree more. But while consistency  is an excellent reason
for making the patch consistent across platforms, it doesn't help decide
what the consistent behaviour should be. It is as strong an argument for
retaining the original behaviour at 2.6.x as for keeping a change. 

As to filename extensions or their lack; in practice, RGui.exe addds a
defult Rdata extension on saving a workspace via the GUI, and so does
saving history, so we already have overwriteable default extensions for
those purposes even though the command line behaviour doesn't do that. 
And it genuinely does help, which is my main motivation here.

The main advantage of the present patch is that it delivers _most_ of
the optional behaviours missing from both 2.6.2 and 2.7.0 without adding
an extra parameter. But it isn't the best that could be done. If there
is a platform-independent way of keeping the default extension-by-type
and allowing the option of removing it entirely (in other words, an
extra parameter to savePlot) I'd personally see that as a better way
forward than the present patch. 
An alternative might be to keep the 2.7.0 savePlot and define a new
convenience function (SavePlot, say, or save.plot for extra dottiness) 
which provides the wrapper. It would have impact on legacy code, but it
is a lot easier to change a function name throughout legacy code than to
change supplied parameters.

In the mean time, consistency arguments would indicate that the present
patch should be applied to all platforms if at all.

Steve E

*******************************************************************
This email and any attachments are confidential. Any use...{{dropped:16}}


From ripley at stats.ox.ac.uk  Wed Jun  4 14:18:26 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 4 Jun 2008 13:18:26 +0100 (BST)
Subject: [Rd] significant digits (PR#9682)
In-Reply-To: <g25tl0$bbi$1@ger.gmane.org>
References: <20080602234017.CB1FD282C786@mail.pubhealth.ku.dk>
	<48451EBC.1000207@stats.uwo.ca>
	<a696b2f20806030843i5c290c87u1125b280b8a7672e@mail.gmail.com>
	<48459200.20401@stats.uwo.ca> <g25tl0$bbi$1@ger.gmane.org>
Message-ID: <alpine.LFD.1.10.0806041230470.24876@gannet.stats.ox.ac.uk>

That (and simpler, sprintf()) merely tell you about your OS's sprintf 
function.  That is not required to accurately give a decimal 
representation of more than DECIMAL_DIG digits, and certainly not 50.
The help for formatC does warn you about this.

On my F8 system DECIMAL_DIG is mentioned in math.h but not defined there. 
(It is defined in the compiler, AFAICS -- SunStudio has it as 21, and gcc 
computes __DECIMAL_DIG__ also as 21.)  The C99 standard says that it 
should be at least 10 and that 17 is appropriate for IEC60559 arithmetic.


On Wed, 4 Jun 2008, Karl Ove Hufthammer wrote:

> Duncan Murdoch:
>
>> The number 0.12345 is not exactly representable, but (I think) it is
>> represented by something slightly closer to 0.1235 than to 0.1234.
>
> I like using formatC for checking such things. On my (Linux) system, I get:
>
> $ formatC(.12345,digits=50)
> [1] "0.12345000000000000417443857259058859199285507202148"
>
>> So it looks as though Windows gets it right.
>
> -- 
> Karl Ove Hufthammer
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From dna_jin at hotmail.com  Wed Jun  4 16:18:37 2008
From: dna_jin at hotmail.com (Rongrong)
Date: Wed, 4 Jun 2008 07:18:37 -0700 (PDT)
Subject: [Rd]  An issue happens Embed R and redirt png file
Message-ID: <17647871.post@talk.nabble.com>


I am a new R user and I have a question of embedding R to generate png
On Debian, I installed R by source code.

Now I want to embed R in an application which name is MyApp, and run
the following syntax:
png(filename="/tmp/Rplot%03d.png)
example(rect)
dev.off()
 
Unfortunately I get the following error message:

Error in X11(paste("png::", filename, sep = ""), width, height, pointsize, 
: 
  unable to start device PNG 
Calls: png 
In addition: Warning message: 
In png(filename = "/tmp/test%03d.png") : 
  unable to open connection to X11 display ''

But I could run above syntax from R, and the result is correct, I can get
two png files from /tmp/ folder.
  
I try to respectively run same syntax(the syntax is:
capabilities()[["png"]])
under two modes, the result is different:
In R the result is TRUE, but when MyApp embed R the result is FALSE

Then I used bitmap(file="/tmp/test") when embed R in MyApp, but get another
error message:

Error in bitmap(file = "/tmp/test") : sorry, 'gs' cannot be found

Besides, I have installed xvfb. What I need do?

Thanks
-- 
View this message in context: http://www.nabble.com/An-issue-happens-Embed-R-and-redirt-png-file-tp17647871p17647871.html
Sent from the R devel mailing list archive at Nabble.com.


From obnoxious_one at hotmail.com  Wed Jun  4 12:50:07 2008
From: obnoxious_one at hotmail.com (obnoxious_one at hotmail.com)
Date: Wed,  4 Jun 2008 12:50:07 +0200 (CEST)
Subject: [Rd] permsn incorrect when x==m (library: prob) (PR#11571)
Message-ID: <20080604105007.EA4C0282EFF7@mail.pubhealth.ku.dk>

Full_Name: Obnoxious
Version: 2.7.0
OS: Windows
Submission from: (NULL) (121.223.77.238)


Objective: 
Generate all permutations of the elements of x taken m at a time.

Library: 
prob

Function: 
permsn

Issue:
Does not appear to be working correctly when x==m.

Example:
libary(prob)
permsn(2,1) i.e., x > m
#Gives the correct result of
     [,1] [,2]
[1,]    1    2

#Yet
permsn(2,2) i.e., x==m
#Gives the incorrect? result of
[1] 1 2

#Shouldn't the result be
     [,1] [,2]???
[1]    1    2???
[2]    2    1???

#Workaround:
permsn(3,2) i.e. permsn(x+1,m)
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    1    2    1    3    2    3
[2,]    2    1    3    1    3    2

#but then we have to remove the results with x==3 in them

#hope that all makes sense

Thankyou,

Obby


From mikehallquist at hotmail.com  Wed Jun  4 15:05:04 2008
From: mikehallquist at hotmail.com (mikehallquist at hotmail.com)
Date: Wed,  4 Jun 2008 15:05:04 +0200 (CEST)
Subject: [Rd] Enter key in data editor bombs program in MDI (PR#11579)
Message-ID: <20080604130504.55E85283416D@mail.pubhealth.ku.dk>

Full_Name: Michael H
Version: 2.7
OS: Windows XP SP3
Submission from: (NULL) (74.74.76.1)


When running R with the multiple document interface, pressing enter in the data
editor causes the program to crash with the following command:

Dataset <- edit(as.data.frame(NULL))

This problem persists when using the fix command, such as fix(Dataset).

Interestingly, the arrow keys and mouse work fine in navigating through the
dataset.

Also, this problem only occurs for me in MDI mode, not in SDI mode.


From gkerns at ysu.edu  Wed Jun  4 18:04:41 2008
From: gkerns at ysu.edu (G. Jay Kerns)
Date: Wed, 4 Jun 2008 12:04:41 -0400
Subject: [Rd] permsn incorrect when x==m (library: prob) (PR#11571)
In-Reply-To: <20080604105007.EA4C0282EFF7@mail.pubhealth.ku.dk>
References: <20080604105007.EA4C0282EFF7@mail.pubhealth.ku.dk>
Message-ID: <a695148b0806040904m438f1cd6v3ca506e440563086@mail.gmail.com>

Dear Obby,

Thanks. In the future, when you have a question about something that
happens in a particular package, keep in mind that it is customary to
contact the package maintainer (me), rather than file a bug report
with the R developers.

In that case, I would have alerted you that this problem has already
been found and a fix was posted:  please see

http://tolstoy.newcastle.edu.au/R/e4/help/08/04/8178.html

This will be included in the next release of prob, on which I am
currently working.  I expect it to be ready by August.

Best,
Jay





On Wed, Jun 4, 2008 at 6:50 AM,  <obnoxious_one at hotmail.com> wrote:
> Full_Name: Obnoxious
> Version: 2.7.0
> OS: Windows
> Submission from: (NULL) (121.223.77.238)
>
>
> Objective:
> Generate all permutations of the elements of x taken m at a time.
>
> Library:
> prob
>
> Function:
> permsn
>
> Issue:
> Does not appear to be working correctly when x==m.
>
> Example:
> libary(prob)
> permsn(2,1) i.e., x > m
> #Gives the correct result of
>     [,1] [,2]
> [1,]    1    2
>
> #Yet
> permsn(2,2) i.e., x==m
> #Gives the incorrect? result of
> [1] 1 2
>
> #Shouldn't the result be
>     [,1] [,2]???
> [1]    1    2???
> [2]    2    1???
>
> #Workaround:
> permsn(3,2) i.e. permsn(x+1,m)
>     [,1] [,2] [,3] [,4] [,5] [,6]
> [1,]    1    2    1    3    2    3
> [2,]    2    1    3    1    3    2
>
> #but then we have to remove the results with x==3 in them
>
> #hope that all makes sense
>
> Thankyou,
>
> Obby
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 


***************************************************
G. Jay Kerns, Ph.D.
Assistant Professor / Statistics Coordinator
Department of Mathematics & Statistics
Youngstown State University
Youngstown, OH 44555-0002 USA
Office: 1035 Cushwa Hall
Phone: (330) 941-3310 Office (voice mail)
-3302 Department
-3170 FAX
E-mail: gkerns at ysu.edu
http://www.cc.ysu.edu/~gjkerns/


From murdoch at stats.uwo.ca  Wed Jun  4 18:26:34 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 04 Jun 2008 12:26:34 -0400
Subject: [Rd] Enter key in data editor bombs program in MDI (PR#11579)
In-Reply-To: <20080604130504.55E85283416D@mail.pubhealth.ku.dk>
References: <20080604130504.55E85283416D@mail.pubhealth.ku.dk>
Message-ID: <4846C23A.9030301@stats.uwo.ca>

On 6/4/2008 9:05 AM, mikehallquist at hotmail.com wrote:
> Full_Name: Michael H
> Version: 2.7

Which 2.7?  The 2.7.0 release?  (sessionInfo() would be more specific.) 
  I see a crash there, but not in R-patched.  Please give it a try (it's 
downloadable from cran.r-project.org/bin/windows/base).

Duncan Murdoch

> OS: Windows XP SP3
> Submission from: (NULL) (74.74.76.1)
> 
> 
> When running R with the multiple document interface, pressing enter in the data
> editor causes the program to crash with the following command:
> 
> Dataset <- edit(as.data.frame(NULL))
> 
> This problem persists when using the fix command, such as fix(Dataset).
> 
> Interestingly, the arrow keys and mouse work fine in navigating through the
> dataset.
> 
> Also, this problem only occurs for me in MDI mode, not in SDI mode.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From seth at userprimary.net  Wed Jun  4 21:13:29 2008
From: seth at userprimary.net (Seth Falcon)
Date: Wed, 4 Jun 2008 12:13:29 -0700
Subject: [Rd] RSQLite bug fix for install with icc
In-Reply-To: <6b93d1830806041128u6e1eabe9u7e2419207fa073f9@mail.gmail.com>
References: <6b93d1830806041128u6e1eabe9u7e2419207fa073f9@mail.gmail.com>
Message-ID: <20080604191329.GX647@ziti.local>

Hi Mark,

[the r-sig-db list might have been a better spot for this...]

* On 2008-06-04 at 14:28 -0400 Mark Kimpel wrote:
> I encountered problems installing RSQLite, R-2.7.0, on RHEL4 using
> Intel 10.1 icc, My sysadmin helped me track down the problem and
> kindly forwarded me the fix, which corrected the problem.
> 
> What follows is from the sysadmin.  Mark
> 
> 
> I looked at the error, looks like there is a bug in the source code.
> I've attached a new tarball, hopefully fixed.
> 
> I added
> #include <sys/types.h>
> immediately before
> #include <unistd.h>
> in
> RSQLite/src/RS-DBI.h

I will see about making such a change.  I suspect the correct fix is
one that tweaks configure to determine where things are based on the
current system (the current code is correct for gcc I believe).

Anyhow, thanks for the report.  I will try to have an update within a
week.

+ seth



-- 
Seth Falcon | http://userprimary.net/user/


From bill at insightful.com  Wed Jun  4 21:25:04 2008
From: bill at insightful.com (Bill Dunlap)
Date: Wed, 4 Jun 2008 12:25:04 -0700 (PDT)
Subject: [Rd] Splus/R typedef for C equivalent of S "integer"
Message-ID: <Pine.GSO.4.56.0806041159280.791@octopus>

We've been working on making it easier to write
packages that work in both R and Splus.  One issue
is that R and Splus use different internal representations
of integers and this makes a difference on their 64-bit
versions: R uses ints (32 bits on 32-bit and 64-bit versions
of R) and Splus uses longs (32 bits on 32-bit Splus and
64 bits on 64-bit Splus).  The obvious ways to deal with
the difference are to use a typedef or a #define to map
those to a common name.  I think it would be handy to
put this definition into R.h or some other R header file
(Splus now has an R.h and other header files with the R
names that we recommend for all package work.)

Should this be a typedef or a #define?  What should its
name be?

There is a file, RSCommon.h (from omegahat?), that I've seen
in a few packages which uses a typedef, RSInt, for this.
Repeated typedefs, even with the same definition, are illegal
so putting typedef ... RSInt into R.h would break those packages.
(C doesn't yet have an if-typedef-exists or untypedef construct,
does it?)

I like XXXinteger, since it refers to the R/Splus name of
the class, "integer", instead of the C-like name.  Should
the "XXX" prefix be "RS" or "RSplus" or "S"?

I like typedefs since you can use them in the debugger.
Should a typedef be accompanied by a #define XXXinteger_defined
so one can write code that works on older versions of R or
Splus without the typedef?

I think R.h would be a good place for it, but I don't
have strong feeling about that one.

If we can come to a consensus on the name, typedef/#define,
and which *.h file, I can put it into Splus.

----------------------------------------------------------------------------
Bill Dunlap
Insightful Corporation
bill at insightful dot com

 "All statements in this message represent the opinions of the author and do
 not necessarily reflect Insightful Corporation policy or position."


From ripley at stats.ox.ac.uk  Wed Jun  4 21:48:47 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 4 Jun 2008 20:48:47 +0100 (BST)
Subject: [Rd] Splus/R typedef for C equivalent of S "integer"
In-Reply-To: <Pine.GSO.4.56.0806041159280.791@octopus>
References: <Pine.GSO.4.56.0806041159280.791@octopus>
Message-ID: <alpine.LFD.1.10.0806042044140.3688@gannet.stats.ox.ac.uk>

Bill,

R's R.h already has

typedef double Sfloat;
typedef int Sint;
#define SINT_MAX INT_MAX
#define SINT_MIN INT_MIN

for this purpose, and it is used in a lot of packages.

It goes back a long way, and I don't remember its origins but 'S 
Programming' is one source.

Brian

On Wed, 4 Jun 2008, Bill Dunlap wrote:

> We've been working on making it easier to write
> packages that work in both R and Splus.  One issue
> is that R and Splus use different internal representations
> of integers and this makes a difference on their 64-bit
> versions: R uses ints (32 bits on 32-bit and 64-bit versions
> of R) and Splus uses longs (32 bits on 32-bit Splus and
> 64 bits on 64-bit Splus).  The obvious ways to deal with
> the difference are to use a typedef or a #define to map
> those to a common name.  I think it would be handy to
> put this definition into R.h or some other R header file
> (Splus now has an R.h and other header files with the R
> names that we recommend for all package work.)
>
> Should this be a typedef or a #define?  What should its
> name be?
>
> There is a file, RSCommon.h (from omegahat?), that I've seen
> in a few packages which uses a typedef, RSInt, for this.
> Repeated typedefs, even with the same definition, are illegal
> so putting typedef ... RSInt into R.h would break those packages.
> (C doesn't yet have an if-typedef-exists or untypedef construct,
> does it?)
>
> I like XXXinteger, since it refers to the R/Splus name of
> the class, "integer", instead of the C-like name.  Should
> the "XXX" prefix be "RS" or "RSplus" or "S"?
>
> I like typedefs since you can use them in the debugger.
> Should a typedef be accompanied by a #define XXXinteger_defined
> so one can write code that works on older versions of R or
> Splus without the typedef?
>
> I think R.h would be a good place for it, but I don't
> have strong feeling about that one.
>
> If we can come to a consensus on the name, typedef/#define,
> and which *.h file, I can put it into Splus.
>
> ----------------------------------------------------------------------------
> Bill Dunlap
> Insightful Corporation
> bill at insightful dot com
>
> "All statements in this message represent the opinions of the author and do
> not necessarily reflect Insightful Corporation policy or position."
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From bill at insightful.com  Wed Jun  4 22:23:26 2008
From: bill at insightful.com (Bill Dunlap)
Date: Wed, 4 Jun 2008 13:23:26 -0700 (PDT)
Subject: [Rd] Splus/R typedef for C equivalent of S "integer"
In-Reply-To: <alpine.LFD.1.10.0806042044140.3688@gannet.stats.ox.ac.uk>
References: <Pine.GSO.4.56.0806041159280.791@octopus>
	<alpine.LFD.1.10.0806042044140.3688@gannet.stats.ox.ac.uk>
Message-ID: <Pine.GSO.4.56.0806041259250.24796@devsun3201.insightful.com>

On Wed, 4 Jun 2008, Prof Brian Ripley wrote:

> Bill,
>
> R's R.h already has
>
> typedef double Sfloat;
> typedef int Sint;
> #define SINT_MAX INT_MAX
> #define SINT_MIN INT_MIN

Whoops, I forgot the name and that I'd put it into
Splus's R.h (and now in someing included by it)
a while back.  Quite a few R packages use it.

I was looking through "Writing R Extensions" for mention
of such a thing and didn't find it.  Perhaps the 'int's
in the examples in Chapter 5 could be changed to 'Sint's.

A few packages (gee,lasso2,locfit,AnalyzeFMRI) used to
typedef Sint (for R and Splus), but since you already
have it in R we can go with it.

In the current development version of Splus it has an
associated #ifdef/#define so packages can avoid it if
needed:

  #ifndef HAVE_SINT_TYPEDEF
  typedef long Sint ; /* C type for S language "integer", is int in R */
  #define HAVE_SINT_TYPEDEF
  #endif

To make the packages even more portable with respect
to int/long things, we need to encourage the use of casts
when interfacing to non-S code.  E.g.,
  Sint x_zero = INTEGER(x)[0] ;
  Rprintf("First element of x is %ld\n", (long)x_zero);
will print x[0] properly in R and Splus but
  Rprintf("First element of x is %d\n", x_zero);
will not work properly in Splus.

Thanks,
  Bill

----------------------------------------------------------------------------
Bill Dunlap
Insightful Corporation
bill at insightful dot com
360-428-8146

 "All statements in this message represent the opinions of the author and do
 not necessarily reflect Insightful Corporation policy or position."


From mflawren at fhcrc.org  Thu Jun  5 05:05:04 2008
From: mflawren at fhcrc.org (Michael Lawrence)
Date: Wed, 4 Jun 2008 20:05:04 -0700
Subject: [Rd] is() and S3 classes
Message-ID: <509e0620806042005v650e7f6cya52738318918da93@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080604/89e6ff25/attachment.pl>

From mflawren at fhcrc.org  Thu Jun  5 05:19:25 2008
From: mflawren at fhcrc.org (Michael Lawrence)
Date: Wed, 4 Jun 2008 20:19:25 -0700
Subject: [Rd] is() and S3 classes
In-Reply-To: <509e0620806042005v650e7f6cya52738318918da93@mail.gmail.com>
References: <509e0620806042005v650e7f6cya52738318918da93@mail.gmail.com>
Message-ID: <509e0620806042019g12b6b3ebgb810bcdc330709b2@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080604/fdf60b02/attachment.pl>

From mwkimpel at gmail.com  Wed Jun  4 20:28:52 2008
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Wed, 4 Jun 2008 14:28:52 -0400
Subject: [Rd] RSQLite bug fix for install with icc
Message-ID: <6b93d1830806041128u6e1eabe9u7e2419207fa073f9@mail.gmail.com>

Seth,

I encountered problems installing RSQLite, R-2.7.0, on RHEL4 using
Intel 10.1 icc, My sysadmin helped me track down the problem and
kindly forwarded me the fix, which corrected the problem.

What follows is from the sysadmin.  Mark


I looked at the error, looks like there is a bug in the source code.
I've attached a new tarball, hopefully fixed.

I added
#include <sys/types.h>
immediately before
#include <unistd.h>
in
RSQLite/src/RS-DBI.h

-- 
Mark W. Kimpel MD ** Neuroinformatics ** Dept. of Psychiatry
Indiana University School of Medicine

15032 Hunter Court, Westfield, IN 46074

(317) 490-5129 Work, & Mobile & VoiceMail
(317) 663-0513 Home (no voice mail please)

******************************************************************
-------------- next part --------------
A non-text attachment was scrubbed...
Name: RSQLite_0.6-8.tar.gz
Type: application/x-gzip
Size: 726970 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080604/cba4fef7/attachment-0001.gz>

From c.beale at macaulay.ac.uk  Thu Jun  5 11:15:08 2008
From: c.beale at macaulay.ac.uk (c.beale at macaulay.ac.uk)
Date: Thu,  5 Jun 2008 11:15:08 +0200 (CEST)
Subject: [Rd] bug in barplot.default (graphics) (PR#11585)
Message-ID: <20080605091508.70574283416A@mail.pubhealth.ku.dk>

There seems to be a minor bug in barplot.default when used with log scale w=
here one or more values is NA:

dat <- matrix(1:25, 5)
dat[2,3] <- NA
barplot(dat, beside =3D T)   #Plots and appropriate barplot with gaps for m=
issing data
barplot(dat, beside =3D T, log =3D "y")
#Error in if (min(height + offset) <=3D 0) stop("log scale error: at least =
one 'height + offset' value <=3D 0") :
#  missing value where TRUE/FALSE needed

This is easily corrected by adding na.rm =3D TRUE to this logical test and =
to the calculation of rectbase where min() is used, as per code below

Best wishes,

Colin

sessionInfo()
R version 2.7.0 (2008-04-22)=20
i386-pc-mingw32=20

locale:
LC_COLLATE=3DEnglish_United Kingdom.1252;LC_CTYPE=3DEnglish_United Kingdom.=
1252;LC_MONETARY=3DEnglish_United Kingdom.1252;LC_NUMERIC=3DC;LC_TIME=3DEng=
lish_United Kingdom.1252

attached base packages:
[1] stats     graphics  grDevices datasets  tcltk     utils     methods=20=
=20
[8] base=20=20=20=20=20

other attached packages:
[1] debug_1.1.0    mvbutils_1.1.1 svSocket_0.9-5 svIO_0.9-5     R2HTML_1.58=
=20=20=20
[6] svMisc_0.9-5   svIDE_0.9-5=20=20=20

loaded via a namespace (and not attached):
[1] tools_2.7.0


barplot.default <- function (height, width =3D 1, space =3D NULL, names.arg=
 =3D NULL,
    legend.text =3D NULL, beside =3D FALSE, horiz =3D FALSE, density =3D NU=
LL,
    angle =3D 45, col =3D NULL, border =3D par("fg"), main =3D NULL,
    sub =3D NULL, xlab =3D NULL, ylab =3D NULL, xlim =3D NULL, ylim =3D NUL=
L,
    xpd =3D TRUE, log =3D "", axes =3D TRUE, axisnames =3D TRUE, cex.axis =
=3D par("cex.axis"),
    cex.names =3D par("cex.axis"), inside =3D TRUE, plot =3D TRUE,
    axis.lty =3D 0, offset =3D 0, add =3D FALSE, ...)
{
    if (!missing(inside))
        .NotYetUsed("inside", error =3D FALSE)
    if (is.null(space))
        space <- if (is.matrix(height) && beside)
            c(0, 1)
        else 0.2
    space <- space * mean(width)
    if (plot && axisnames && is.null(names.arg))
        names.arg <- if (is.matrix(height))
            colnames(height)
        else names(height)
    if (is.vector(height) || (is.array(height) && (length(dim(height)) =3D=
=3D
        1))) {
        height <- cbind(height)
        beside <- TRUE
        if (is.null(col))
            col <- "grey"
    }
    else if (is.matrix(height)) {
        if (is.null(col))
            col <- grey.colors(nrow(height))
    }
    else stop("'height' must be a vector or a matrix")
    if (is.logical(legend.text))
        legend.text <- if (legend.text && is.matrix(height))
            rownames(height)
    stopifnot(is.character(log))
    logx <- logy <- FALSE
    if (log !=3D "") {
        logx <- length(grep("x", log)) > 0L
        logy <- length(grep("y", log)) > 0L
    }
    if ((logx || logy) && !is.null(density))
        stop("Cannot use shading lines in bars when log scale is used")
    NR <- nrow(height)
    NC <- ncol(height)
    if (beside) {
        if (length(space) =3D=3D 2)
            space <- rep.int(c(space[2], rep.int(space[1], NR -
                1)), NC)
        width <- rep(width, length.out =3D NR)
    }
    else {
        width <- rep(width, length.out =3D NC)
    }
    offset <- rep(as.vector(offset), length.out =3D length(width))
    delta <- width/2
    w.r <- cumsum(space + width)
    w.m <- w.r - delta
    w.l <- w.m - delta
    log.dat <- (logx && horiz) || (logy && !horiz)
    if (log.dat) {
        if (min(height + offset, na.rm =3D T) <=3D 0)
            stop("log scale error: at least one 'height + offset' value <=
=3D 0")
        if (logx && !is.null(xlim) && min(xlim) <=3D 0)
            stop("log scale error: 'xlim' <=3D 0")
        if (logy && !is.null(ylim) && min(ylim) <=3D 0)
            stop("log scale error: 'ylim' <=3D 0")
        rectbase <- if (logy && !horiz && !is.null(ylim))
            ylim[1]
        else if (logx && horiz && !is.null(xlim))
            xlim[1]
        else 0.9 * min(height, na.rm =3D T)
    }
    else rectbase <- 0
    if (!beside)
        height <- rbind(rectbase, apply(height, 2, cumsum))
    rAdj <- offset + (if (log.dat)
        0.9 * height
    else -0.01 * height)
    delta <- width/2
    w.r <- cumsum(space + width)
    w.m <- w.r - delta
    w.l <- w.m - delta
    if (horiz) {
        if (is.null(xlim))
            xlim <- range(rAdj, height + offset, na.rm =3D TRUE)
        if (is.null(ylim))
            ylim <- c(min(w.l), max(w.r))
    }
    else {
        if (is.null(xlim))
            xlim <- c(min(w.l), max(w.r))
        if (is.null(ylim))
            ylim <- range(rAdj, height + offset, na.rm =3D TRUE)
    }
    if (beside)
        w.m <- matrix(w.m, ncol =3D NC)
    if (plot) {
        opar <- if (horiz)
            par(xaxs =3D "i", xpd =3D xpd)
        else par(yaxs =3D "i", xpd =3D xpd)
        on.exit(par(opar))
        if (!add) {
            plot.new()
            plot.window(xlim, ylim, log =3D log, ...)
        }
        xyrect <- function(x1, y1, x2, y2, horizontal =3D TRUE,
            ...) {
            if (horizontal)
                rect(x1, y1, x2, y2, ...)
            else rect(y1, x1, y2, x2, ...)
        }
        if (beside)
            xyrect(rectbase + offset, w.l, c(height) + offset,
                w.r, horizontal =3D horiz, angle =3D angle, density =3D den=
sity,
                col =3D col, border =3D border)
        else {
            for (i in 1:NC) {
                xyrect(height[1:NR, i] + offset[i], w.l[i], height[-1,
                  i] + offset[i], w.r[i], horizontal =3D horiz,
                  angle =3D angle, density =3D density, col =3D col,
                  border =3D border)
            }
        }
        if (axisnames && !is.null(names.arg)) {
            at.l <- if (length(names.arg) !=3D length(w.m)) {
                if (length(names.arg) =3D=3D NC)
                  colMeans(w.m)
                else stop("incorrect number of names")
            }
            else w.m
            axis(if (horiz)
                2
            else 1, at =3D at.l, labels =3D names.arg, lty =3D axis.lty,
                cex.axis =3D cex.names, ...)
        }
        if (!is.null(legend.text)) {
            legend.col <- rep(col, length.out =3D length(legend.text))
            if ((horiz & beside) || (!horiz & !beside)) {
                legend.text <- rev(legend.text)
                legend.col <- rev(legend.col)
                density <- rev(density)
                angle <- rev(angle)
            }
            xy <- par("usr")
            legend(xy[2] - xinch(0.1), xy[4] - yinch(0.1), legend =3D legen=
d.text,
                angle =3D angle, density =3D density, fill =3D legend.col,
                xjust =3D 1, yjust =3D 1)
        }
        title(main =3D main, sub =3D sub, xlab =3D xlab, ylab =3D ylab,
            ...)
        if (axes)
            axis(if (horiz)
                1
            else 2, cex.axis =3D cex.axis, ...)
        invisible(w.m)
    }
    else w.m
}


Dr. Colin Beale
Spatial Ecologist
The Macaulay Institute
Craigiebuckler
Aberdeen
AB15 8QH
UK

Tel: 01224 498245 ext. 2427
Fax: 01224 311556
Email: c.beale at macaulay.ac.uk=20



--=20
Please note that the views expressed in this e-mail are those of the
sender and do not necessarily represent the views of the Macaulay
Institute. This email and any attachments are confidential and are
intended solely for the use of the recipient(s) to whom they are
addressed. If you are not the intended recipient, you should not read,
copy, disclose or rely on any information contained in this e-mail, and
we would ask you to contact the sender immediately and delete the email
from your system. Thank you.
Macaulay Institute and Associated Companies, Macaulay Drive,
Craigiebuckler, Aberdeen, AB15 8QH.


From j.van_den_hoff at fzd.de  Thu Jun  5 13:41:45 2008
From: j.van_den_hoff at fzd.de (Joerg van den Hoff)
Date: Thu, 5 Jun 2008 13:41:45 +0200
Subject: [Rd] prevent `R CMD INSTALL' from reading  `.Rprofile'
Message-ID: <20080605114145.GD29136@marco.fz-rossendorf.de>

I tripped over the following problem:

due  to  (my?) unresolved problems with cairo graphics under
MacOS (graphic window blocks unrecoverably)  I  modified  my
`.Rprofile'      to  issue `X11(type =  "Xlib")`   on each R
startup (as a workaround to automatic opening of  a  `cairo'
device when issuing a plotting command).

I  now  noted  that  `R  CMD  INSTALL'   obviously processes
.Rprofile since the graphics window pops  up  every  time  I
install a package.

I want to avoid this, but options, notably

--no-site-file 
--no-init-file

are ignored when using `R CMD' (yes: as stated in the help).

question:   could   this  behaviour  be  changed,  at  least
concerning the above mentioned options? or is there  another
way to avoid processing/sourcing of .Rprofile?

regards, 

joerg


ps: R 2.7.0, Mac OS 10.4.11. (PPC)


From simon.urbanek at r-project.org  Thu Jun  5 14:57:58 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Thu, 5 Jun 2008 08:57:58 -0400
Subject: [Rd] prevent `R CMD INSTALL' from reading  `.Rprofile'
In-Reply-To: <20080605114145.GD29136@marco.fz-rossendorf.de>
References: <20080605114145.GD29136@marco.fz-rossendorf.de>
Message-ID: <A4F42DDF-D096-46D4-9468-A48DE2E7588E@r-project.org>


On Jun 5, 2008, at 7:41 AM, Joerg van den Hoff wrote:

> I tripped over the following problem:
>
> due  to  (my?) unresolved problems with cairo graphics under
> MacOS (graphic window blocks unrecoverably)  I  modified  my
> `.Rprofile'      to  issue `X11(type =  "Xlib")`   on each R
> startup (as a workaround to automatic opening of  a  `cairo'
> device when issuing a plotting command).
>

That is not a good work-around (you are always forcing a device to  
open). You should consider using
grDevices::X11.options(type="Xlib")
instead.

Cheers,
Simon



> I  now  noted  that  `R  CMD  INSTALL'   obviously processes
> .Rprofile since the graphics window pops  up  every  time  I
> install a package.
>
> I want to avoid this, but options, notably
>
> --no-site-file
> --no-init-file
>
> are ignored when using `R CMD' (yes: as stated in the help).
>
> question:   could   this  behaviour  be  changed,  at  least
> concerning the above mentioned options? or is there  another
> way to avoid processing/sourcing of .Rprofile?
>
> regards,
>
> joerg
>
>
> ps: R 2.7.0, Mac OS 10.4.11. (PPC)
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From edd at debian.org  Thu Jun  5 16:06:01 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 5 Jun 2008 09:06:01 -0500
Subject: [Rd] RFC: Add 'postinstall' hook to R CMD INSTALL ?
Message-ID: <18503.62153.774662.127482@ron.nulle.part>


I have been mulling over an idea I had meant to flesh out with a prototype
but haven't gotten around to.   So here it goes in the abstract without
working code:


What:  Extend 'R CMD INSTALL' to also work on sources that are not strictly
       CRAN packages

Why:  'R CMD INSTALL' is very good and very successful for CRAN packages. It
      has solved most issues related to configure, make, ... etc by relying
      on pre-computed and stored values.

      CRAN is also very good as a mirror network to distribute content that
      is easy to obtain by useRs.
       
      So there are cases where I'd like to use CRAN / R CMD INSTALL to work
      on non-package code. Two case are

        i)  littler which is easy to 'configure; make; make install' but 
            would want to live in $PREFIX/bin -- and I need to copy it there

        ii) RCpp which is a library / glue code making live easier for C++
  	    code to interface with R; also easy to configure but I'd then
  	    libRcpp.{so,a} to be in $PREFIX/bin -- and I need to copy it
	    there

How:  Similar to 'cleanup' we could have a script 'postinstall' in the
      top-level directory, and if present, R would execute it.


As I'm the one with the itch, I'd be happy to work on code towards
implementing this -- but before I go overboard with it, I'd love to hear
comments, suggestions, questions, ...  It is worthwhile? Is it feasible?
What did I overlook?

Thanks, Dirk

-- 
Three out of two people have difficulties with fractions.


From j.van_den_hoff at fzd.de  Thu Jun  5 16:43:47 2008
From: j.van_den_hoff at fzd.de (Joerg van den Hoff)
Date: Thu, 5 Jun 2008 16:43:47 +0200
Subject: [Rd] prevent `R CMD INSTALL' from reading  `.Rprofile'
In-Reply-To: <A4F42DDF-D096-46D4-9468-A48DE2E7588E@r-project.org>
References: <20080605114145.GD29136@marco.fz-rossendorf.de>
	<A4F42DDF-D096-46D4-9468-A48DE2E7588E@r-project.org>
Message-ID: <20080605144347.GF29136@marco.fz-rossendorf.de>

On Thu, Jun 05, 2008 at 08:57:58AM -0400, Simon Urbanek wrote:
> 
> On Jun 5, 2008, at 7:41 AM, Joerg van den Hoff wrote:
> 
> >I tripped over the following problem:
> >
> >due  to  (my?) unresolved problems with cairo graphics under
> >MacOS (graphic window blocks unrecoverably)  I  modified  my
> >`.Rprofile'      to  issue `X11(type =  "Xlib")`   on each R
> >startup (as a workaround to automatic opening of  a  `cairo'
> >device when issuing a plotting command).
> >
> 
> That is not a good work-around (you are always forcing a device to  
> open). You should consider using

yes, I know...

> grDevices::X11.options(type="Xlib")
> instead.

did'nt  know  this  function. this is of course much better.
thanks a lot!

as  an  aside: after pestering the r-mac list two times with
my cairo problem (blocking) I won't do it a third time  ;-).
nevertheless  I'd  like  to  ask  directly:  is  this  issue
recognized as "real" (at least  1-2  people  apart  from  me
reported  it)?   is their any idea it what direction I could
search for the reason (concering configuration of  R  and/or
my machine)?

regards,

joerg


> 
> Cheers,
> Simon
> 
> 
> 
> >I  now  noted  that  `R  CMD  INSTALL'   obviously processes
> >.Rprofile since the graphics window pops  up  every  time  I
> >install a package.
> >
> >I want to avoid this, but options, notably
> >
> >--no-site-file
> >--no-init-file
> >
> >are ignored when using `R CMD' (yes: as stated in the help).
> >
> >question:   could   this  behaviour  be  changed,  at  least
> >concerning the above mentioned options? or is there  another
> >way to avoid processing/sourcing of .Rprofile?
> >
> >regards,
> >
> >joerg
> >
> >
> >ps: R 2.7.0, Mac OS 10.4.11. (PPC)
> >
> >______________________________________________
> >R-devel at r-project.org mailing list
> >https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> >
>


From sgiannerini at gmail.com  Thu Jun  5 16:49:25 2008
From: sgiannerini at gmail.com (Simone Giannerini)
Date: Thu, 5 Jun 2008 16:49:25 +0200
Subject: [Rd] qf with infinite df
Message-ID: <3c12769c0806050749t43df1e8ck4ec36fa2e14fee91@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080605/2f396203/attachment.pl>

From ripley at stats.ox.ac.uk  Thu Jun  5 17:13:14 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 5 Jun 2008 16:13:14 +0100 (BST)
Subject: [Rd] qf with infinite df
In-Reply-To: <3c12769c0806050749t43df1e8ck4ec36fa2e14fee91@mail.gmail.com>
References: <3c12769c0806050749t43df1e8ck4ec36fa2e14fee91@mail.gmail.com>
Message-ID: <alpine.LFD.1.10.0806051558250.7716@gannet.stats.ox.ac.uk>

On Thu, 5 Jun 2008, Simone Giannerini wrote:

> Dear all,
>
> I found the following behaviour
>
>> rf(5,Inf,Inf)
> [1] 1 1 1 1 1
>
> but
>
>> qf(0.1,Inf,Inf)
> [1] NaN
> Warning messages:
> 1: In qf(0.1, Inf, Inf) : value out of range in 'lgamma'
> 2: In qf(p, df1, df2, lower.tail, log.p) : NaNs produced

Could do better here.

> incidentally,
>
>
>> pf(1.00000000000001,Inf,Inf)
> [1] 1
>> pf(1.0000000000000001,Inf,Inf)
> [1] 0.5
>
> Is this the expected behaviour?

I think so. 1.0000000000000001 is the same as 1 in computer arithmetic, 
and pf(1, m, n) = 0.5 for all large m, n.

>
> Thanks
>
> Simone
>
>> R.version
>               _
> platform       i386-pc-mingw32
> arch           i386
> os             mingw32
> system         i386, mingw32
> status         Patched
> major          2
> minor          7.0
> year           2008
> month          04
> day            22
> svn rev        45451
> language       R
> version.string R version 2.7.0 Patched (2008-04-22 r45451)
>
> platform       x86_64-unknown-linux-gnu
> arch           x86_64
> os             linux-gnu
> system         x86_64, linux-gnu
> status         Patched
> major          2
> minor          6.1
> year           2008
> month          01
> day            17
> svn rev        44036
> language       R
> version.string R version 2.6.1 Patched (2008-01-17 r44036)
>
> ______________________________________________________
>
> Simone Giannerini
> Dipartimento di Scienze Statistiche "Paolo Fortunati"
> Universita' di Bologna
> Via delle belle arti 41 - 40126 Bologna, ITALY
> Tel: +39 051 2098262 Fax: +39 051 232153
> http://www2.stat.unibo.it/giannerini/
> ______________________________________________________
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From maechler at stat.math.ethz.ch  Thu Jun  5 17:51:46 2008
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 5 Jun 2008 17:51:46 +0200
Subject: [Rd] qf with infinite df
In-Reply-To: <3c12769c0806050749t43df1e8ck4ec36fa2e14fee91@mail.gmail.com>
References: <3c12769c0806050749t43df1e8ck4ec36fa2e14fee91@mail.gmail.com>
Message-ID: <18504.2962.834051.943967@stat.math.ethz.ch>

Thank you, Simone,

>>>>> "SG" == Simone Giannerini <sgiannerini at gmail.com>
>>>>>     on Thu, 5 Jun 2008 16:49:25 +0200 writes:

    SG> Dear all, I found the following behaviour

    >> rf(5,Inf,Inf)
    SG> [1] 1 1 1 1 1

    SG> but

    >> qf(0.1,Inf,Inf)
    SG> [1] NaN Warning messages: 1: In qf(0.1, Inf, Inf) :
    SG> value out of range in 'lgamma' 2: In qf(p, df1, df2,
    SG> lower.tail, log.p) : NaNs produced


    SG> incidentally,


    >> pf(1.00000000000001,Inf,Inf)
    SG> [1] 1
    >> pf(1.0000000000000001,Inf,Inf)
    SG> [1] 0.5

    SG> Is this the expected behaviour?
    	   ^^^^
What is   "this"?

rf() and pf() are.

qf() may still be "expected" if you think a bit how it
might be computed.

OTOH, we could clearly do better there.
Notably, qf()'s behavior is really not good enough, for the case
of large df1 and/or df2.

I'll have a look but won't promise much for now.

Martin Maechler, ETH Zurich


    SG> Thanks

    SG> Simone

    >> R.version
    SG>                _ platform i386-pc-mingw32 arch i386 os
    SG> mingw32 system i386, mingw32 status Patched major 2
    SG> minor 7.0 year 2008 month 04 day 22 svn rev 45451
    SG> language R version.string R version 2.7.0 Patched
    SG> (2008-04-22 r45451)

    SG> platform x86_64-unknown-linux-gnu arch x86_64 os
    SG> linux-gnu system x86_64, linux-gnu status Patched major
    SG> 2 minor 6.1 year 2008 month 01 day 17 svn rev 44036
    SG> language R version.string R version 2.6.1 Patched
    SG> (2008-01-17 r44036)

    SG> ______________________________________________________

    SG> Simone Giannerini Dipartimento di Scienze Statistiche
    SG> "Paolo Fortunati" Universita' di Bologna Via delle belle
    SG> arti 41 - 40126 Bologna, ITALY Tel: +39 051 2098262 Fax:
    SG> +39 051 232153 http://www2.stat.unibo.it/giannerini/
    SG> ______________________________________________________


From pietro.parodi at aon.co.uk  Thu Jun  5 19:01:50 2008
From: pietro.parodi at aon.co.uk (pietro.parodi at aon.co.uk)
Date: Thu, 5 Jun 2008 18:01:50 +0100
Subject: [Rd] R-code embedded in VBE -- Type mismatch errors
Message-ID: <OFAA684FCE.52F40FF8-ON8025745F.005A5717-8025745F.005D8DBC@aon.co.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080605/725eeec9/attachment.pl>

From sgiannerini at gmail.com  Thu Jun  5 19:26:46 2008
From: sgiannerini at gmail.com (Simone Giannerini)
Date: Thu, 5 Jun 2008 19:26:46 +0200
Subject: [Rd] qf with infinite df
In-Reply-To: <alpine.LFD.1.10.0806051558250.7716@gannet.stats.ox.ac.uk>
References: <3c12769c0806050749t43df1e8ck4ec36fa2e14fee91@mail.gmail.com>
	<alpine.LFD.1.10.0806051558250.7716@gannet.stats.ox.ac.uk>
Message-ID: <3c12769c0806051026g2f896a5aya0c423794abb37ec@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080605/e37ce0db/attachment.pl>

From rfolgueira at yahoo.com  Thu Jun  5 15:10:03 2008
From: rfolgueira at yahoo.com (rfolgueira at yahoo.com)
Date: Thu,  5 Jun 2008 15:10:03 +0200 (CEST)
Subject: [Rd] sd function (PR#11586)
Message-ID: <20080605131003.4C2F6282EFF7@mail.pubhealth.ku.dk>

Full_Name: Ram?n Folgueira Roque
Version: 2.7.0
OS: Windows
Submission from: (NULL) (200.11.210.98)


The sd function doesn`t give the same results than older version, when it?s
applied to a data frame object and the object contains some character data.

Ex:
datos=data.frame( )
fix(datos)
          Grupo Vel 
          A     10.1       
          A     9.8            
          B     10             
          B     10             
          A     9.9           
          A     10.1          
          B     NA           
          A     10            

sd(datos,na.rm=T)


From plroebuck at mdanderson.org  Thu Jun  5 17:55:54 2008
From: plroebuck at mdanderson.org (Paul Roebuck)
Date: Thu, 5 Jun 2008 10:55:54 -0500 (CDT)
Subject: [Rd] doc buglet / as.Date method
Message-ID: <Pine.OSF.4.58.0806051052170.104746@wotan.mdacc.tmc.edu>

Under Details section for as.Date:

as.Date will accept numeric data (the number of days
since an epoch), but only is origin is supplied.
                          ^^
should be "if"


R version 2.7.0 Patched (2008-06-04 r45830)

----------------------------------------------------------
SIGSIG -- signature too long (core dumped)


From bowden at stats.ox.ac.uk  Thu Jun  5 18:10:08 2008
From: bowden at stats.ox.ac.uk (bowden at stats.ox.ac.uk)
Date: Thu,  5 Jun 2008 18:10:08 +0200 (CEST)
Subject: [Rd] memory.size() for large memory usage (PR#11596)
Message-ID: <20080605161008.563BB2834155@mail.pubhealth.ku.dk>

This amusing behaviour is from R2.6.1 on WinXP Pro SP2 running with boot.in=
i /3GB flag, exploring memory limits.

=20

When actual (object, not total) memory usage hits 2048 MB, memory.size star=
ts counting down again, but reports a negative amount, e.g. -2046.333. Is t=
his an intended (or unavoidable) feature?)

=20

Thanks,

=20

Rory Bowden

bowden at stats.ox.ac.uk

=20


	[[alternative HTML version deleted]]


From ripley at stats.ox.ac.uk  Fri Jun  6 09:55:14 2008
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Fri,  6 Jun 2008 09:55:14 +0200 (CEST)
Subject: [Rd] memory.size() for large memory usage (PR#11596)
Message-ID: <20080606075514.8F4D6283460D@mail.pubhealth.ku.dk>

On Thu, 5 Jun 2008, bowden at stats.ox.ac.uk wrote:

> This amusing behaviour is from R2.6.1 on WinXP Pro SP2 running with boot.in=
> i /3GB flag, exploring memory limits.
>
> =20
>
> When actual (object, not total) memory usage hits 2048 MB, memory.size star=
> ts counting down again, but reports a negative amount, e.g. -2046.333. Is t=
> his an intended (or unavoidable) feature?)

Not any more (it was a feature of the malloc used, but that has been 
updated and R hasn't followed.).

Will be changed for 2.7.1.

>
> =20
>
> Thanks,
>
> =20
>
> Rory Bowden
>
> bowden at stats.ox.ac.uk

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Fri Jun  6 12:34:17 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 6 Jun 2008 11:34:17 +0100 (BST)
Subject: [Rd] RFC: Add 'postinstall' hook to R CMD INSTALL ?
In-Reply-To: <18503.62153.774662.127482@ron.nulle.part>
References: <18503.62153.774662.127482@ron.nulle.part>
Message-ID: <alpine.LFD.1.10.0806051514190.6771@gannet.stats.ox.ac.uk>

Isn't this what Type: Frontend is for?  That gives you complete control 
and would seem appropriate for both of your examples.

On Thu, 5 Jun 2008, Dirk Eddelbuettel wrote:

>
> I have been mulling over an idea I had meant to flesh out with a prototype
> but haven't gotten around to.   So here it goes in the abstract without
> working code:
>
>
> What:  Extend 'R CMD INSTALL' to also work on sources that are not strictly
>       CRAN packages
>
> Why:  'R CMD INSTALL' is very good and very successful for CRAN packages. It
>      has solved most issues related to configure, make, ... etc by relying
>      on pre-computed and stored values.
>
>      CRAN is also very good as a mirror network to distribute content that
>      is easy to obtain by useRs.
>
>      So there are cases where I'd like to use CRAN / R CMD INSTALL to work
>      on non-package code. Two case are
>
>        i)  littler which is easy to 'configure; make; make install' but
>            would want to live in $PREFIX/bin -- and I need to copy it there
>
>        ii) RCpp which is a library / glue code making live easier for C++
>  	    code to interface with R; also easy to configure but I'd then
>  	    libRcpp.{so,a} to be in $PREFIX/bin -- and I need to copy it
> 	    there

I hope not in 'bin' -- I am not sure if you mean $PREFIX/lib[64] or 
$R_HOME/lib?

> How:  Similar to 'cleanup' we could have a script 'postinstall' in the
>      top-level directory, and if present, R would execute it.
>
>
> As I'm the one with the itch, I'd be happy to work on code towards
> implementing this -- but before I go overboard with it, I'd love to hear
> comments, suggestions, questions, ...  It is worthwhile? Is it feasible?
> What did I overlook?
>
> Thanks, Dirk
>
> -- 
> Three out of two people have difficulties with fractions.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From edd at debian.org  Fri Jun  6 14:01:13 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 6 Jun 2008 07:01:13 -0500
Subject: [Rd] RFC: Add 'postinstall' hook to R CMD INSTALL ?
In-Reply-To: <alpine.LFD.1.10.0806051514190.6771@gannet.stats.ox.ac.uk>
References: <18503.62153.774662.127482@ron.nulle.part>
	<alpine.LFD.1.10.0806051514190.6771@gannet.stats.ox.ac.uk>
Message-ID: <18505.9993.574030.720761@ron.nulle.part>


Brian,

Thanks for the follow-up.

On 6 June 2008 at 11:34, Prof Brian Ripley wrote:
| Isn't this what Type: Frontend is for?  That gives you complete control 
| and would seem appropriate for both of your examples.

Interesting.  But the R Extensions manual says

   1.10.1 Frontend
   ---------------
   
   This is a rather general mechanism, designed for adding new front-ends
   such as the *gnomeGUI* package.  If a `configure' file is found in the
   top-level directory of the package it is executed, and then if a
   `Makefile' is found (often generated by `configure'), `make' is called.
   If `R CMD INSTALL --clean' is used `make clean' is called.  No other
   action is taken.

I am talking about the need for 'other action' such as 'make install', say.

Are you suggesting I shoehorn what I want done into the main 'make' target ?

| On Thu, 5 Jun 2008, Dirk Eddelbuettel wrote:
| 
| >
| > I have been mulling over an idea I had meant to flesh out with a prototype
| > but haven't gotten around to.   So here it goes in the abstract without
| > working code:
| >
| >
| > What:  Extend 'R CMD INSTALL' to also work on sources that are not strictly
| >       CRAN packages
| >
| > Why:  'R CMD INSTALL' is very good and very successful for CRAN packages. It
| >      has solved most issues related to configure, make, ... etc by relying
| >      on pre-computed and stored values.
| >
| >      CRAN is also very good as a mirror network to distribute content that
| >      is easy to obtain by useRs.
| >
| >      So there are cases where I'd like to use CRAN / R CMD INSTALL to work
| >      on non-package code. Two case are
| >
| >        i)  littler which is easy to 'configure; make; make install' but
| >            would want to live in $PREFIX/bin -- and I need to copy it there
| >
| >        ii) RCpp which is a library / glue code making live easier for C++
| >  	    code to interface with R; also easy to configure but I'd then
| >  	    libRcpp.{so,a} to be in $PREFIX/bin -- and I need to copy it
| > 	    there
| 
| I hope not in 'bin' -- I am not sure if you mean $PREFIX/lib[64] or 
| $R_HOME/lib?

Yes, cut&paste error. $PREFIX/lib is of course what I had in mind.

Other cases that may profit from this are

           iii)  Some other 'content' such as CRANberries or the cran2deb
              efforts could use it to synchronise / update SQLite database
              files in agreed upon locations.

	   iv)  Web-based R add-ons could possibly use this mechanism to hook
	      into the web server.

Dirk
 
| > How:  Similar to 'cleanup' we could have a script 'postinstall' in the
| >      top-level directory, and if present, R would execute it.
| >
| >
| > As I'm the one with the itch, I'd be happy to work on code towards
| > implementing this -- but before I go overboard with it, I'd love to hear
| > comments, suggestions, questions, ...  It is worthwhile? Is it feasible?
| > What did I overlook?
| >
| > Thanks, Dirk
| >
| > -- 
| > Three out of two people have difficulties with fractions.
| >
| > ______________________________________________
| > R-devel at r-project.org mailing list
| > https://stat.ethz.ch/mailman/listinfo/r-devel
| >
| 
| -- 
| Brian D. Ripley,                  ripley at stats.ox.ac.uk
| Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
| University of Oxford,             Tel:  +44 1865 272861 (self)
| 1 South Parks Road,                     +44 1865 272866 (PA)
| Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-- 
Three out of two people have difficulties with fractions.


From ripley at stats.ox.ac.uk  Fri Jun  6 14:13:01 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 6 Jun 2008 13:13:01 +0100 (BST)
Subject: [Rd] RFC: Add 'postinstall' hook to R CMD INSTALL ?
In-Reply-To: <18505.9993.574030.720761@ron.nulle.part>
References: <18503.62153.774662.127482@ron.nulle.part>
	<alpine.LFD.1.10.0806051514190.6771@gannet.stats.ox.ac.uk>
	<18505.9993.574030.720761@ron.nulle.part>
Message-ID: <alpine.LFD.1.10.0806061310320.16732@gannet.stats.ox.ac.uk>

On Fri, 6 Jun 2008, Dirk Eddelbuettel wrote:

>
> Brian,
>
> Thanks for the follow-up.
>
> On 6 June 2008 at 11:34, Prof Brian Ripley wrote:
> | Isn't this what Type: Frontend is for?  That gives you complete control
> | and would seem appropriate for both of your examples.
>
> Interesting.  But the R Extensions manual says
>
>   1.10.1 Frontend
>   ---------------
>
>   This is a rather general mechanism, designed for adding new front-ends
>   such as the *gnomeGUI* package.  If a `configure' file is found in the
>   top-level directory of the package it is executed, and then if a
>   `Makefile' is found (often generated by `configure'), `make' is called.
>   If `R CMD INSTALL --clean' is used `make clean' is called.  No other
>   action is taken.
>
> I am talking about the need for 'other action' such as 'make install', say.
>
> Are you suggesting I shoehorn what I want done into the main 'make' target ?

Yes.  I don't see it as 'shoehorn' -- it is the install step.

>
> | On Thu, 5 Jun 2008, Dirk Eddelbuettel wrote:
> |
> | >
> | > I have been mulling over an idea I had meant to flesh out with a prototype
> | > but haven't gotten around to.   So here it goes in the abstract without
> | > working code:
> | >
> | >
> | > What:  Extend 'R CMD INSTALL' to also work on sources that are not strictly
> | >       CRAN packages
> | >
> | > Why:  'R CMD INSTALL' is very good and very successful for CRAN packages. It
> | >      has solved most issues related to configure, make, ... etc by relying
> | >      on pre-computed and stored values.
> | >
> | >      CRAN is also very good as a mirror network to distribute content that
> | >      is easy to obtain by useRs.
> | >
> | >      So there are cases where I'd like to use CRAN / R CMD INSTALL to work
> | >      on non-package code. Two case are
> | >
> | >        i)  littler which is easy to 'configure; make; make install' but
> | >            would want to live in $PREFIX/bin -- and I need to copy it there
> | >
> | >        ii) RCpp which is a library / glue code making live easier for C++
> | >  	    code to interface with R; also easy to configure but I'd then
> | >  	    libRcpp.{so,a} to be in $PREFIX/bin -- and I need to copy it
> | > 	    there
> |
> | I hope not in 'bin' -- I am not sure if you mean $PREFIX/lib[64] or
> | $R_HOME/lib?
>
> Yes, cut&paste error. $PREFIX/lib is of course what I had in mind.
>
> Other cases that may profit from this are
>
>           iii)  Some other 'content' such as CRANberries or the cran2deb
>              efforts could use it to synchronise / update SQLite database
>              files in agreed upon locations.
>
> 	   iv)  Web-based R add-ons could possibly use this mechanism to hook
> 	      into the web server.
>
> Dirk
>
> | > How:  Similar to 'cleanup' we could have a script 'postinstall' in the
> | >      top-level directory, and if present, R would execute it.
> | >
> | >
> | > As I'm the one with the itch, I'd be happy to work on code towards
> | > implementing this -- but before I go overboard with it, I'd love to hear
> | > comments, suggestions, questions, ...  It is worthwhile? Is it feasible?
> | > What did I overlook?
> | >
> | > Thanks, Dirk
> | >
> | > --
> | > Three out of two people have difficulties with fractions.
> | >
> | > ______________________________________________
> | > R-devel at r-project.org mailing list
> | > https://stat.ethz.ch/mailman/listinfo/r-devel
> | >
> |
> | --
> | Brian D. Ripley,                  ripley at stats.ox.ac.uk
> | Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> | University of Oxford,             Tel:  +44 1865 272861 (self)
> | 1 South Parks Road,                     +44 1865 272866 (PA)
> | Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> -- 
> Three out of two people have difficulties with fractions.
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From edd at debian.org  Fri Jun  6 14:33:38 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 6 Jun 2008 07:33:38 -0500
Subject: [Rd] RFC: Add 'postinstall' hook to R CMD INSTALL ?
In-Reply-To: <alpine.LFD.1.10.0806061310320.16732@gannet.stats.ox.ac.uk>
References: <18503.62153.774662.127482@ron.nulle.part>
	<alpine.LFD.1.10.0806051514190.6771@gannet.stats.ox.ac.uk>
	<18505.9993.574030.720761@ron.nulle.part>
	<alpine.LFD.1.10.0806061310320.16732@gannet.stats.ox.ac.uk>
Message-ID: <18505.11938.823368.34327@ron.nulle.part>


On 6 June 2008 at 13:13, Prof Brian Ripley wrote:
| > On 6 June 2008 at 11:34, Prof Brian Ripley wrote:
| > | Isn't this what Type: Frontend is for?  That gives you complete control
| > | and would seem appropriate for both of your examples.
| >
| > Interesting.  But the R Extensions manual says
| >
| >   1.10.1 Frontend
| >   ---------------
| >
| >   This is a rather general mechanism, designed for adding new front-ends
| >   such as the *gnomeGUI* package.  If a `configure' file is found in the
| >   top-level directory of the package it is executed, and then if a
| >   `Makefile' is found (often generated by `configure'), `make' is called.
| >   If `R CMD INSTALL --clean' is used `make clean' is called.  No other
| >   action is taken.
| >
| > I am talking about the need for 'other action' such as 'make install', say.
| >
| > Are you suggesting I shoehorn what I want done into the main 'make' target ?
| 
| Yes.  I don't see it as 'shoehorn' -- it is the install step.

I have to think about this. I was envisioning a degree of freedom between
'make' and 'make install'. I may need some optionality here.

Anyway -- thanks for the suggestions. It is indeed very close to what I had
asked for.

Dirk

-- 
Three out of two people have difficulties with fractions.


From jeff.horner at vanderbilt.edu  Fri Jun  6 15:18:46 2008
From: jeff.horner at vanderbilt.edu (Jeffrey Horner)
Date: Fri, 06 Jun 2008 08:18:46 -0500
Subject: [Rd] RFC: Add 'postinstall' hook to R CMD INSTALL ?
In-Reply-To: <alpine.LFD.1.10.0806061310320.16732@gannet.stats.ox.ac.uk>
References: <18503.62153.774662.127482@ron.nulle.part>	<alpine.LFD.1.10.0806051514190.6771@gannet.stats.ox.ac.uk>	<18505.9993.574030.720761@ron.nulle.part>
	<alpine.LFD.1.10.0806061310320.16732@gannet.stats.ox.ac.uk>
Message-ID: <48493936.9080505@vanderbilt.edu>

Prof Brian Ripley wrote:
> On Fri, 6 Jun 2008, Dirk Eddelbuettel wrote:
> 
>>
>> Brian,
>>
>> Thanks for the follow-up.
>>
>> On 6 June 2008 at 11:34, Prof Brian Ripley wrote:
>> | Isn't this what Type: Frontend is for?  That gives you complete control
>> | and would seem appropriate for both of your examples.
>>
>> Interesting.  But the R Extensions manual says
>>
>>   1.10.1 Frontend
>>   ---------------
>>
>>   This is a rather general mechanism, designed for adding new front-ends
>>   such as the *gnomeGUI* package.  If a `configure' file is found in the
>>   top-level directory of the package it is executed, and then if a
>>   `Makefile' is found (often generated by `configure'), `make' is called.
>>   If `R CMD INSTALL --clean' is used `make clean' is called.  No other
>>   action is taken.
>>
>> I am talking about the need for 'other action' such as 'make install', 
>> say.
>>
>> Are you suggesting I shoehorn what I want done into the main 'make' 
>> target ?
> 
> Yes.  I don't see it as 'shoehorn' -- it is the install step.


Indeed, most GNU software follow the convention of:

configure
make
make install

Surely `R CMD INSTALL` can be augmented to call `make install` as well 
if the `Makefile` is found.

Best

Jeff

> 
>>
>> | On Thu, 5 Jun 2008, Dirk Eddelbuettel wrote:
>> |
>> | >
>> | > I have been mulling over an idea I had meant to flesh out with a 
>> prototype
>> | > but haven't gotten around to.   So here it goes in the abstract 
>> without
>> | > working code:
>> | >
>> | >
>> | > What:  Extend 'R CMD INSTALL' to also work on sources that are not 
>> strictly
>> | >       CRAN packages
>> | >
>> | > Why:  'R CMD INSTALL' is very good and very successful for CRAN 
>> packages. It
>> | >      has solved most issues related to configure, make, ... etc by 
>> relying
>> | >      on pre-computed and stored values.
>> | >
>> | >      CRAN is also very good as a mirror network to distribute 
>> content that
>> | >      is easy to obtain by useRs.
>> | >
>> | >      So there are cases where I'd like to use CRAN / R CMD INSTALL 
>> to work
>> | >      on non-package code. Two case are
>> | >
>> | >        i)  littler which is easy to 'configure; make; make 
>> install' but
>> | >            would want to live in $PREFIX/bin -- and I need to copy 
>> it there
>> | >
>> | >        ii) RCpp which is a library / glue code making live easier 
>> for C++
>> | >          code to interface with R; also easy to configure but I'd 
>> then
>> | >          libRcpp.{so,a} to be in $PREFIX/bin -- and I need to copy it
>> | >         there
>> |
>> | I hope not in 'bin' -- I am not sure if you mean $PREFIX/lib[64] or
>> | $R_HOME/lib?
>>
>> Yes, cut&paste error. $PREFIX/lib is of course what I had in mind.
>>
>> Other cases that may profit from this are
>>
>>           iii)  Some other 'content' such as CRANberries or the cran2deb
>>              efforts could use it to synchronise / update SQLite database
>>              files in agreed upon locations.
>>
>>        iv)  Web-based R add-ons could possibly use this mechanism to hook
>>           into the web server.
>>
>> Dirk
>>
>> | > How:  Similar to 'cleanup' we could have a script 'postinstall' in 
>> the
>> | >      top-level directory, and if present, R would execute it.
>> | >
>> | >
>> | > As I'm the one with the itch, I'd be happy to work on code towards
>> | > implementing this -- but before I go overboard with it, I'd love 
>> to hear
>> | > comments, suggestions, questions, ...  It is worthwhile? Is it 
>> feasible?
>> | > What did I overlook?
>> | >
>> | > Thanks, Dirk
>> | >
>> | > --
>> | > Three out of two people have difficulties with fractions.
>> | >
>> | > ______________________________________________
>> | > R-devel at r-project.org mailing list
>> | > https://stat.ethz.ch/mailman/listinfo/r-devel
>> | >
>> |
>> | --
>> | Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> | Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> | University of Oxford,             Tel:  +44 1865 272861 (self)
>> | 1 South Parks Road,                     +44 1865 272866 (PA)
>> | Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>
>> -- 
>> Three out of two people have difficulties with fractions.
>>
> 


-- 
http://biostat.mc.vanderbilt.edu/JeffreyHorner


From Holger.Mitterer at mpi.nl  Fri Jun  6 14:10:08 2008
From: Holger.Mitterer at mpi.nl (Holger.Mitterer at mpi.nl)
Date: Fri,  6 Jun 2008 14:10:08 +0200 (CEST)
Subject: [Rd] read.table underR2.7.0 (PR#11605)
Message-ID: <20080606121008.6DA7A283416D@mail.pubhealth.ku.dk>

L.S.,

after having updated to 2.7.0, read.table seems
to have bug. I read in a file (see a view lines
pasted below) with:

phon = 
read.table("D:/Data/underspec/FULish/exp1/analysis/phoned111_200.txt", 
header = T);

the second variable, being "+" or "-" is converted into zeros (0)
and treated as a numerical variable.

Kind regards,
Holger


pp	type	item	target	comp	distr	
   1	-	sik.bmp	 270.52	 274.73	 495.50	
   1	+	meid.bmp	  66.33	 484.62	 540.24	
   1	+	flipper.bmp	 247.79	 453.23	 413.18	
   1	-	dood.bmp	 275.22	 359.80	 451.38	
   1	-	nat.bmp	 176.65	 531.24	 419.50	
   1	+	fauna.bmp	 200.57	 501.46	 456.97	
   1	-	daad.bmp	 174.50	 531.96	 465.20	
   1	-	sok.bmp	  46.90	 418.95	 597.41	
   1	+	flik.bmp	 230.59	 546.53	 397.22	
   1	-	noorden.bmp	 202.76	 354.77	 545.87	
   1	-	sabel.bmp	  63.98	 633.96	 444.06	
...


-- 

- - - - - - - - - - - - - - - - - - - - - - - -
Holger Mitterer, Ph.D.
Max-Planck-Institut f?r Psycholinguistik
Postbus 310
6500 AH Nijmegen
The Netherlands
Phone: (+31) (0)24 - 3521375
Fax: (+31) (0)24 - 3521213
- - - - - - - - - - - - - - - - - - - - - - - -


From Jan.Matthias at uni-koeln.de  Fri Jun  6 11:20:11 2008
From: Jan.Matthias at uni-koeln.de (Jan.Matthias at uni-koeln.de)
Date: Fri,  6 Jun 2008 11:20:11 +0200 (CEST)
Subject: [Rd] Error Message (PR#11602)
Message-ID: <20080606092011.95BC62834619@mail.pubhealth.ku.dk>

Hello!

My Name is Jan Matthias and I am from Cologne University in Germany. I have=
 problems with R , version 1.9.1.
I also use the package tcltk and follow the instructions from a command fil=
e which i will send with.

My problem is that the program always stops at the same step, showing diffe=
rent Error Messages sometimes. My Hope is that you have a suggestion what t=
he problem is and how to solve it. Because this is the first time I use thi=
s program and I have no idea anymore.

First an example log (I also got other Error messages as I wrote, but in th=
e same step! For example that the file could not be found):

R : Copyright 2004, The R Foundation for Statistical Computing
Version 1.9.1  (2004-06-21), ISBN 3-900051-00-3

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> local({pkg <- select.list(sort(.packages(all.available =3D TRUE)))
+ if(nchar(pkg)) library(pkg, character.only=3DTRUE)})
> library(GOAT)
> initGOAT()
[1] "Showing the Tk GUI..."
[1] "Analyzing enrichment..."
Done.
>
> write.table(1h.txt.proc, file=3D"1h.proc.xls", sep=3D"\t",quote=3DF, col.=
names=3DF, row.names=3DF)
Error: syntax error

I checked the file names, but still I got that message.

Additionally here the instructions I followed step by step:

turn on R 1.9.1.
load package tcltk
type in: library(GOAT)
  initGOAT()
#a new window will open
select your inputfile and your organism
analyze


write.table(atest.txt.proc, file=3D"goatest.proc.xls", sep=3D"\t",quote=3DF=
, col.names=3DF, row.names=3DF)=20
write.table(atest.txt.func, file=3D"goatest.func.xls", sep=3D"\t",quote=3DF=
, col.names=3DF, row.names=3DF)
write.table(atest.txt.comp, file=3D"goatest.comp.xls", sep=3D"\t",quote=3DF=
, col.names=3DF, row.names=3DF)

#atest.text.proc or func or comp says from which graph to get the data

I would be very thankful if you can give me any suggestion or help.

Kindly regards
Jan Matthias
Jan.Matthias at uni-koeln.de







	[[alternative HTML version deleted]]


From iverson at biostat.wisc.edu  Fri Jun  6 16:38:07 2008
From: iverson at biostat.wisc.edu (Erik Iverson)
Date: Fri, 06 Jun 2008 09:38:07 -0500
Subject: [Rd] Error Message (PR#11602)
In-Reply-To: <20080606092011.95BC62834619@mail.pubhealth.ku.dk>
References: <20080606092011.95BC62834619@mail.pubhealth.ku.dk>
Message-ID: <48494BCF.5070903@biostat.wisc.edu>

Jan.Matthias at uni-koeln.de wrote:
> Hello!
> 
> My Name is Jan Matthias and I am from Cologne University in Germany. I have=
>  problems with R , version 1.9.1.

Is this a new record?  Jan, update to the latest R, which is about 4 
years newer than 1.9.1.


From ripley at stats.ox.ac.uk  Fri Jun  6 17:40:15 2008
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Fri,  6 Jun 2008 17:40:15 +0200 (CEST)
Subject: [Rd] read.table underR2.7.0 (PR#11605)
Message-ID: <20080606154015.6F03D283460D@mail.pubhealth.ku.dk>

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.

--27464147-621931503-1212766709=:10799
Content-Type: TEXT/PLAIN; charset=iso-8859-1; format=flowed
Content-Transfer-Encoding: 8BIT

Not a bug, since this was platform-specific and undocumented before.

However, the behaviour has been changed in R-patched, docunented in the 
NEWS file, discussed on R-help ....

Please do the homework the R FAQ and posting guide asks of you.

On Fri, 6 Jun 2008, Holger.Mitterer at mpi.nl wrote:

> L.S.,
>
> after having updated to 2.7.0, read.table seems
> to have bug. I read in a file (see a view lines
> pasted below) with:
>
> phon =
> read.table("D:/Data/underspec/FULish/exp1/analysis/phoned111_200.txt",
> header = T);
>
> the second variable, being "+" or "-" is converted into zeros (0)
> and treated as a numerical variable.
>
> Kind regards,
> Holger
>
>
> pp	type	item	target	comp	distr
>   1	-	sik.bmp	 270.52	 274.73	 495.50
>   1	+	meid.bmp	  66.33	 484.62	 540.24
>   1	+	flipper.bmp	 247.79	 453.23	 413.18
>   1	-	dood.bmp	 275.22	 359.80	 451.38
>   1	-	nat.bmp	 176.65	 531.24	 419.50
>   1	+	fauna.bmp	 200.57	 501.46	 456.97
>   1	-	daad.bmp	 174.50	 531.96	 465.20
>   1	-	sok.bmp	  46.90	 418.95	 597.41
>   1	+	flik.bmp	 230.59	 546.53	 397.22
>   1	-	noorden.bmp	 202.76	 354.77	 545.87
>   1	-	sabel.bmp	  63.98	 633.96	 444.06
> ...
>
>
> -- 
>
> - - - - - - - - - - - - - - - - - - - - - - - -
> Holger Mitterer, Ph.D.
> Max-Planck-Institut f?r Psycholinguistik
> Postbus 310
> 6500 AH Nijmegen
> The Netherlands
> Phone: (+31) (0)24 - 3521375
> Fax: (+31) (0)24 - 3521213
> - - - - - - - - - - - - - - - - - - - - - - - -
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595
--27464147-621931503-1212766709=:10799--


From ggrothendieck at gmail.com  Fri Jun  6 19:30:25 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 6 Jun 2008 13:30:25 -0400
Subject: [Rd] Posting Guide
Message-ID: <971536df0806061030i75474172xff100ece76a23eec@mail.gmail.com>

People read the posting guide yet they are still unable to create an acceptable
post. e.g.
https://stat.ethz.ch/pipermail/r-help/2008-June/164092.html

I think the problem is that the guide is not clear or concise enough.
I suggest we add a summary at the beginning which gets to the heart
of what a poster is expected to provide:

Summary

To maximize your change of getting a response when posting provide (1)
commented,
(2) minimal, (3) self-contained and (4) reproducible code.  (This one
line summary
also appears at the end of each message to r-help.)

"Self-contained" and "reproducible" mean that a responder can copy the
questioner's code to
the clipboard, paste it into their R session and see the same problem
you as the questioner
see.  Note that dput(mydata) will display mydata in a reproducible way.
Self-contained and reproducible are needed because:
(1) Self-Effort. It shows that the questioner tried to solve the
problem by themself first.
(2) Test framework. Often the responder needs to play with the code a
bit in order to respond
or at least to give the best answer.  They can't do that without a
test framework that includes
the data and the code to run it and its not fair to ask them to not
only answer the question but
also to come up with test data and to complete incomplete code.
(3) Archives. Questions and answers go into the archives so they are
not only for the benefit of
of the questioner but also for the benefit of all future searchers of
the archive.  That means
that its not finished if you have solved the problem for yourself.
You still need to ensure that
the thread has a complete solution. (For that reason its also
important to give a meaningful
subject to each post.)

"Commented" and "minimal" also reduce the time it takes to understand
the problem.
Don't just dump your code as is into the message since you are just
wasting your own
time. Its not likely anyone will answer a message if the questioner
has not taken the
time to reduce it to its essential elements.  Surprisingly, quite
often understanding what
the problem is takes the responder most of the time -- not solving the
problem. Once the
question is actually understood its often quite fast to answer.  Thus
in addition to posting
it in a minimal form, comment on it sufficiently so that the responder
knows what the code
does and is intended to produce.  It may be obvious to the questioner
who is embroiled in
the problem but that does not mean its obvious to others.

Introduction

.... rest of posting guide ...


From tadakado at gmail.com  Fri Jun  6 20:38:23 2008
From: tadakado at gmail.com (Tadashi Kadowaki)
Date: Sat, 7 Jun 2008 03:38:23 +0900
Subject: [Rd] Makevars or congiure for multi platforms
Message-ID: <dcb3073c0806061138n2f376a24r100f281ae248497a@mail.gmail.com>

Dear all,

As previously submitted, I wrote an extending pdf device to embed
pop up text and web links.
(Patches are available at http://pdf2.r-forge.r-project.org/patches)

Now, I'm making a library version of the pdf device.
However, with my skill, I'm not sure about writing Makevars or configure file
for multi platforms. A following line in Makevars works on my mac,
-----
PKG_CFLAGS=-I/Library/Frameworks/R.framework/PrivateHeaders -DHAVE_CONFIG_H
-----
(Note that the PrivateHeaders directory contains Fileio.h and Defn.h)

My question is,
How do I write Makevars or congiure for Unix/Linux and Windows?
I would like to support those platforms in my library.

Regards,

Tadashi Kadowaki


From spencer.graves at pdf.com  Fri Jun  6 21:41:30 2008
From: spencer.graves at pdf.com (Spencer Graves)
Date: Fri, 06 Jun 2008 12:41:30 -0700
Subject: [Rd] Testing development code?
Message-ID: <484992EA.2040401@pdf.com>

Hi, R Core Team: 

      How do you test the latest changes to the core R code?  Is it just 
"R CMD check"?  Or do you use other tools, like the perl "prove" module? 

      I ask, because I'm about to start developing routine testing for 
other (non-R) software, for which I can't do "R CMD check", and I'd like 
to know what you do. 

      Thanks,
      Spencer Graves


From murdoch at stats.uwo.ca  Fri Jun  6 21:54:45 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 06 Jun 2008 15:54:45 -0400
Subject: [Rd] Testing development code?
In-Reply-To: <484992EA.2040401@pdf.com>
References: <484992EA.2040401@pdf.com>
Message-ID: <48499605.5080504@stats.uwo.ca>

Spencer Graves wrote:
> Hi, R Core Team: 
>
>       How do you test the latest changes to the core R code?  Is it just 
> "R CMD check"?  Or do you use other tools, like the perl "prove" module? 
>
>       I ask, because I'm about to start developing routine testing for 
> other (non-R) software, for which I can't do "R CMD check", and I'd like 
> to know what you do. 
>   
There are a few make targets, e.g. "make check", "make check-all", etc.  
See the Admin manual for a number of choices, or R_HOME/tests/README.

Duncan Murdoch


From ripley at stats.ox.ac.uk  Fri Jun  6 22:18:29 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 6 Jun 2008 21:18:29 +0100 (BST)
Subject: [Rd] Testing development code?
In-Reply-To: <484992EA.2040401@pdf.com>
References: <484992EA.2040401@pdf.com>
Message-ID: <alpine.LFD.1.10.0806062111430.16422@gannet.stats.ox.ac.uk>

On Fri, 6 Jun 2008, Spencer Graves wrote:

> Hi, R Core Team:
>     How do you test the latest changes to the core R code?  Is it just "R 
> CMD check"?  Or do you use other tools, like the perl "prove" module?
>     I ask, because I'm about to start developing routine testing for other 
> (non-R) software, for which I can't do "R CMD check", and I'd like to know 
> what you do.

'make check-devel', 'make check-all' and regression tests of (essentially) 
R CMD check over CRAN/BioC (the latter in arrears via daily checking 
unless the change is thought likely to break things).

If we were starting from scatch we would probably use a unit-testing 
framework such as provided by Runits.

C-based projects often use DejaGnu and similar -- scripting languages 
usually use themselves to run their test suites.


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From smckinney at bccrc.ca  Fri Jun  6 22:24:13 2008
From: smckinney at bccrc.ca (Steven McKinney)
Date: Fri, 6 Jun 2008 13:24:13 -0700
Subject: [Rd] Posting Guide
References: <971536df0806061030i75474172xff100ece76a23eec@mail.gmail.com>
Message-ID: <0BE438149FF2254DB4199E2682C8DFEB0328A352@crcmail1.BCCRC.CA>

I'd recommend either having two or three good examples
of acceptable posts at the end of the posting guide
or at least some hyperlinks to good examples.  Two or
three contrasting poor posts would also be helpful.

If people can see a brief email with working code
AND the ever-essential sessionInfo() output
I think they will be more likely to compose
a reasonable post.

It's not rocket science when you see a few examples
of good posts, but reading lines and lines of text
describing a good post clearly is not getting
through to many people.

Steve McKinney

-----Original Message-----
From: r-devel-bounces at r-project.org on behalf of Gabor Grothendieck
Sent: Fri 6/6/2008 10:30 AM
To: R Development List
Subject: [Rd] Posting Guide
 
People read the posting guide yet they are still unable to create an acceptable
post. e.g.
https://stat.ethz.ch/pipermail/r-help/2008-June/164092.html

I think the problem is that the guide is not clear or concise enough.
I suggest we add a summary at the beginning which gets to the heart
of what a poster is expected to provide:

Summary

To maximize your change of getting a response when posting provide (1)
commented,
(2) minimal, (3) self-contained and (4) reproducible code.  (This one
line summary
also appears at the end of each message to r-help.)

"Self-contained" and "reproducible" mean that a responder can copy the
questioner's code to
the clipboard, paste it into their R session and see the same problem
you as the questioner
see.  Note that dput(mydata) will display mydata in a reproducible way.
Self-contained and reproducible are needed because:
(1) Self-Effort. It shows that the questioner tried to solve the
problem by themself first.
(2) Test framework. Often the responder needs to play with the code a
bit in order to respond
or at least to give the best answer.  They can't do that without a
test framework that includes
the data and the code to run it and its not fair to ask them to not
only answer the question but
also to come up with test data and to complete incomplete code.
(3) Archives. Questions and answers go into the archives so they are
not only for the benefit of
of the questioner but also for the benefit of all future searchers of
the archive.  That means
that its not finished if you have solved the problem for yourself.
You still need to ensure that
the thread has a complete solution. (For that reason its also
important to give a meaningful
subject to each post.)

"Commented" and "minimal" also reduce the time it takes to understand
the problem.
Don't just dump your code as is into the message since you are just
wasting your own
time. Its not likely anyone will answer a message if the questioner
has not taken the
time to reduce it to its essential elements.  Surprisingly, quite
often understanding what
the problem is takes the responder most of the time -- not solving the
problem. Once the
question is actually understood its often quite fast to answer.  Thus
in addition to posting
it in a minimal form, comment on it sufficiently so that the responder
knows what the code
does and is intended to produce.  It may be obvious to the questioner
who is embroiled in
the problem but that does not mean its obvious to others.

Introduction

.... rest of posting guide ...

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From spencer.graves at pdf.com  Sat Jun  7 00:07:19 2008
From: spencer.graves at pdf.com (Spencer Graves)
Date: Fri, 06 Jun 2008 15:07:19 -0700
Subject: [Rd] Testing development code?
In-Reply-To: <alpine.LFD.1.10.0806062111430.16422@gannet.stats.ox.ac.uk>
References: <484992EA.2040401@pdf.com>
	<alpine.LFD.1.10.0806062111430.16422@gannet.stats.ox.ac.uk>
Message-ID: <4849B517.10008@pdf.com>

Dear Prof. Ripley: 

<in line>     

Prof Brian Ripley wrote:
> On Fri, 6 Jun 2008, Spencer Graves wrote:
>
>> Hi, R Core Team:
>>     How do you test the latest changes to the core R code?  Is it 
>> just "R CMD check"?  Or do you use other tools, like the perl "prove" 
>> module?
>>     I ask, because I'm about to start developing routine testing for 
>> other (non-R) software, for which I can't do "R CMD check", and I'd 
>> like to know what you do.
>
> 'make check-devel', 'make check-all' and regression tests of 
> (essentially) R CMD check over CRAN/BioC (the latter in arrears via 
> daily checking unless the change is thought likely to break things).
>
> If we were starting from scatch we would probably use a unit-testing 
> framework such as provided by Runits.
      How can I find information on 'Runits'?  Google led me to 
'http://en.wikipedia.org/wiki/Unit_test'.  The other hits I got did not 
seem as informative as Wikipedia. 

      Thanks for the reply.  This is helpful. 
      Spencer Graves
>
> C-based projects often use DejaGnu and similar -- scripting languages 
> usually use themselves to run their test suites.
>
>


From bolker at ufl.edu  Sat Jun  7 01:48:23 2008
From: bolker at ufl.edu (Ben Bolker)
Date: Fri, 6 Jun 2008 23:48:23 +0000 (UTC)
Subject: [Rd] sd function (PR#11586)
References: <20080605131003.4C2F6282EFF7@mail.pubhealth.ku.dk>
Message-ID: <loom.20080606T233028-608@post.gmane.org>

 <rfolgueira <at> yahoo.com> writes:

> 
> Full_Name: Ram?n Folgueira Roque
> Version: 2.7.0
> OS: Windows
> Submission from: (NULL) (200.11.210.98)
> 
> The sd function doesn`t give the same results than older version, when it?s
> applied to a data frame object and the object contains some character data.
> 
> Ex:
> datos=data.frame( )
> fix(datos)
>           Grupo Vel 
>           A     10.1       
>           A     9.8            
>           B     10             
>           B     10             
>           A     9.9           
>           A     10.1          
>           B     NA           
>           A     10            
> 
> sd(datos,na.rm=T)
> 
> ___________________

  This is almost certainly a consequence of the following
change in R 2.7.0:

    o	co[rv](use = "complete.obs") now always gives an error if there
	are no complete cases: they used to give NA if
	method = "pearson" but an error for the other two methods.
	(Note that this is pretty arbitrary, but zero-length vectors
	always give an error so it is at least consistent.)
What's happening is that R tries to run sd() on each column.
The first column is coerced to a character, then var() says
there are no non-missing observations.

  This has been discussed (and complained about) previously.
(I'd like to add my vote for reversion of this behavior, because
it screws up one of the examples in my soon-to-be-published
book ... argh.)

  cheers
    Ben Bolker


From ripley at stats.ox.ac.uk  Sat Jun  7 06:49:06 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 7 Jun 2008 05:49:06 +0100 (BST)
Subject: [Rd] Testing development code?
In-Reply-To: <4849B517.10008@pdf.com>
References: <484992EA.2040401@pdf.com>
	<alpine.LFD.1.10.0806062111430.16422@gannet.stats.ox.ac.uk>
	<4849B517.10008@pdf.com>
Message-ID: <alpine.LFD.1.10.0806070543310.28358@gannet.stats.ox.ac.uk>

On Fri, 6 Jun 2008, Spencer Graves wrote:

> Dear Prof. Ripley: 
> <in line> 
> Prof Brian Ripley wrote:
>> On Fri, 6 Jun 2008, Spencer Graves wrote:
>> 
>>> Hi, R Core Team:
>>>     How do you test the latest changes to the core R code?  Is it just "R 
>>> CMD check"?  Or do you use other tools, like the perl "prove" module?
>>>     I ask, because I'm about to start developing routine testing for other 
>>> (non-R) software, for which I can't do "R CMD check", and I'd like to know 
>>> what you do.
>> 
>> 'make check-devel', 'make check-all' and regression tests of (essentially) 
>> R CMD check over CRAN/BioC (the latter in arrears via daily checking unless 
>> the change is thought likely to break things).
>> 
>> If we were starting from scatch we would probably use a unit-testing 
>> framework such as provided by Runits.
>     How can I find information on 'Runits'?  Google led me to 
> 'http://en.wikipedia.org/wiki/Unit_test'.  The other hits I got did not seem 
> as informative as Wikipedia.

CRAN package RUnit and its vignette provides another slant.

>     Thanks for the reply.  This is helpful.      Spencer Graves
>> 
>> C-based projects often use DejaGnu and similar -- scripting languages 
>> usually use themselves to run their test suites.
>> 
>> 
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From seanpor at acm.org  Sat Jun  7 09:10:01 2008
From: seanpor at acm.org (Sean O'Riordain)
Date: Sat, 7 Jun 2008 08:10:01 +0100
Subject: [Rd] Posting Guide
In-Reply-To: <971536df0806061030i75474172xff100ece76a23eec@mail.gmail.com>
References: <971536df0806061030i75474172xff100ece76a23eec@mail.gmail.com>
Message-ID: <8ed68eed0806070010q4d447cffr2b5d92e849c145e0@mail.gmail.com>

Gabor,
I agree.  Furthermore I think it might be useful to add that in my
experience (and I'm sure others as well) that the process of creating
a simple reproduceable example for an email to r-help will in most
cases clarify what I'm trying to do and actually solve my own problem
for me - once or twice I've been tempted to email my problem and my
own solution for the archive.

As a side note I tend to put a fair bit of work (i.e. measured in days
of calendar time and hours of work) for fear of being abused on the
list for not doing enough prep work.  Fear is probably not the idea
motivator though...

Regards,
Sean


2008/6/6 Gabor Grothendieck <ggrothendieck at gmail.com>:
> People read the posting guide yet they are still unable to create an acceptable
> post. e.g.
> https://stat.ethz.ch/pipermail/r-help/2008-June/164092.html
>
> I think the problem is that the guide is not clear or concise enough.
> I suggest we add a summary at the beginning which gets to the heart
> of what a poster is expected to provide:
>
> Summary
>
> To maximize your change of getting a response when posting provide (1)
> commented,
> (2) minimal, (3) self-contained and (4) reproducible code.  (This one
> line summary
> also appears at the end of each message to r-help.)
>
> "Self-contained" and "reproducible" mean that a responder can copy the
> questioner's code to
> the clipboard, paste it into their R session and see the same problem
> you as the questioner
> see.  Note that dput(mydata) will display mydata in a reproducible way.
> Self-contained and reproducible are needed because:
> (1) Self-Effort. It shows that the questioner tried to solve the
> problem by themself first.
> (2) Test framework. Often the responder needs to play with the code a
> bit in order to respond
> or at least to give the best answer.  They can't do that without a
> test framework that includes
> the data and the code to run it and its not fair to ask them to not
> only answer the question but
> also to come up with test data and to complete incomplete code.
> (3) Archives. Questions and answers go into the archives so they are
> not only for the benefit of
> of the questioner but also for the benefit of all future searchers of
> the archive.  That means
> that its not finished if you have solved the problem for yourself.
> You still need to ensure that
> the thread has a complete solution. (For that reason its also
> important to give a meaningful
> subject to each post.)
>
> "Commented" and "minimal" also reduce the time it takes to understand
> the problem.
> Don't just dump your code as is into the message since you are just
> wasting your own
> time. Its not likely anyone will answer a message if the questioner
> has not taken the
> time to reduce it to its essential elements.  Surprisingly, quite
> often understanding what
> the problem is takes the responder most of the time -- not solving the
> problem. Once the
> question is actually understood its often quite fast to answer.  Thus
> in addition to posting
> it in a minimal form, comment on it sufficiently so that the responder
> knows what the code
> does and is intended to produce.  It may be obvious to the questioner
> who is embroiled in
> the problem but that does not mean its obvious to others.
>
> Introduction
>
> .... rest of posting guide ...
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From david.kirkby at onetel.net  Sat Jun  7 13:20:11 2008
From: david.kirkby at onetel.net (Dr. David Kirkby)
Date: Sat, 07 Jun 2008 12:20:11 +0100
Subject: [Rd] Fail to call AC_CACHE_CHECK on R 2.7.0 for Solaris
Message-ID: <484A6EEB.10704@onetel.net>

I've tried to build R 2.6.1 and 2.7.0 on Solaris 10 update 4 (SPARC) and 
both configure ok, so you might ask why I suspect there is a problem.

I tried to build the maths program Sage

http://www.sagemath.org/

version 3.0.3alpha1. Sage fails when building R 2.6.1 - (Sage includes R 
in the package). The relavant bit of Sage, which is only using an 
unmodified R configure script is:

checking iconv.h usability... yes
checking iconv.h presence... yes
checking for iconv.h... yes
checking for iconv... in libiconv
checking whether iconv accepts "UTF-8", "latin1" and "UCS-*"... no
checking for iconvlist... yes
configure: error: --with-iconv=yes (default) and a suitable iconv is
not available

Looking at the Sage problem in detail, I believe I know the reason and 
are somewhat surprised R builds at all on Solaris. I think this problem 
is an R problem, not a Sage problem.

For some reason the R "configure" script was not happy with my readline, 
but after trying to configure with the configure option

--with-readline=no

The R 2.6.1 source configured ok. I did not bother running 'make' but 
there were
no failures when the configure script was run.  I then repeated this
with the latest version of R (2.7.0) and got similar results.

Looking at the file configure.ac in R (both 2.6.1 and 2.7.0), I see:

## iconv headers and function.
if test "${use_iconv}" = yes; then
  R_ICONV
  if test "$r_cv_iconv_latin1" != yes; then
    AC_MSG_ERROR([--with-iconv=yes (default) and a suitable iconv is
not available])
  fi
else
    AC_MSG_WARN([--with-iconv=no is deprecated and will be withdrawn
shortly])
fi

Clearly the value of r_cv_iconv_latin1 determines if this test passes
or fails and so whether the error message that I get is printed or not.

The variable r_cv_iconv_latin1 is never set directly in configure, but
by in a Macro called AC_CACHE_CHECK in the file m4/R.m4.

Looking in that macro r4/R.m4 we see:

  AC_CACHE_CHECK([whether iconv accepts "UTF-8", "latin1" and "UCS-
*"],
  [r_cv_iconv_latin1],

So it would appear to me that AC_CACHE_CHECK needs to be run in order
that r_cv_iconv_latin will be set properly. But looking at
configure.ac, I think AC_CACHE_CHECK is only called on Linux, and not
on Solaris. Obviously this could explain why this bit of Sage works on
Linux, but not Solaris.

## check for visible __libc_stack_end on Linux
case "${host_os}" in
  linux*)
    AC_CACHE_CHECK([for visible __lib_stack_end],
    [r_cv_libc_stack_end],
    [AC_RUN_IFELSE([AC_LANG_SOURCE([[
#include "confdefs.h"
#include <stdlib.h>
extern void * __libc_stack_end;

So it seems to me this will never work, as the the relevant macro is
not run on Solaris. It begs the obvious question why does this work
when I download the source of R. I can't see the answer to that one,
but there are reports of R failing to build on Solaris, but for me at
least, it configures ok.


From ripley at stats.ox.ac.uk  Sat Jun  7 14:11:54 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 7 Jun 2008 13:11:54 +0100 (BST)
Subject: [Rd] Fail to call AC_CACHE_CHECK on R 2.7.0 for Solaris
In-Reply-To: <484A6EEB.10704@onetel.net>
References: <484A6EEB.10704@onetel.net>
Message-ID: <alpine.LFD.1.10.0806071308510.13253@gannet.stats.ox.ac.uk>

This is covered in the 'R Installation and Administration' manual that
INSTALL asked you to read.  Specifically for Solaris:

  Modern Solaris systems allow a large selection of Open Source software
  to be installed via @command{pkg-get}: a Sparc Solaris 10 system came
  with @code{libreadline} and @code{libiconv} and a choice of @code{gcc3}
  and @code{gcc4} compilers, installed under @file{/opt/csw}.  (You will
  need GNU @code{libiconv}: the Solaris version of @code{iconv} is not
  sufficiently powerful.)

R 2.7.0 is documented to build on several versions of Solaris in that 
manual, so the problem is definitely not 'R on Solaris'.

You analysis is plain wrong.  Search for r_cv_iconv_latin1 in 
configure and you will see three lines which set it (plus one that checks 
if it was set in the cache).

On Sat, 7 Jun 2008, Dr. David Kirkby wrote:

> I've tried to build R 2.6.1 and 2.7.0 on Solaris 10 update 4 (SPARC) and both 
> configure ok, so you might ask why I suspect there is a problem.
>
> I tried to build the maths program Sage
>
> http://www.sagemath.org/
>
> version 3.0.3alpha1. Sage fails when building R 2.6.1 - (Sage includes R in 
> the package). The relavant bit of Sage, which is only using an unmodified R 
> configure script is:
>
> checking iconv.h usability... yes
> checking iconv.h presence... yes
> checking for iconv.h... yes
> checking for iconv... in libiconv
> checking whether iconv accepts "UTF-8", "latin1" and "UCS-*"... no
> checking for iconvlist... yes
> configure: error: --with-iconv=yes (default) and a suitable iconv is
> not available
>
> Looking at the Sage problem in detail, I believe I know the reason and are 
> somewhat surprised R builds at all on Solaris. I think this problem is an R 
> problem, not a Sage problem.
>
> For some reason the R "configure" script was not happy with my readline, but 
> after trying to configure with the configure option
>
> --with-readline=no
>
> The R 2.6.1 source configured ok. I did not bother running 'make' but there 
> were
> no failures when the configure script was run.  I then repeated this
> with the latest version of R (2.7.0) and got similar results.
>
> Looking at the file configure.ac in R (both 2.6.1 and 2.7.0), I see:
>
> ## iconv headers and function.
> if test "${use_iconv}" = yes; then
> R_ICONV
> if test "$r_cv_iconv_latin1" != yes; then
>   AC_MSG_ERROR([--with-iconv=yes (default) and a suitable iconv is
> not available])
> fi
> else
>   AC_MSG_WARN([--with-iconv=no is deprecated and will be withdrawn
> shortly])
> fi
>
> Clearly the value of r_cv_iconv_latin1 determines if this test passes
> or fails and so whether the error message that I get is printed or not.
>
> The variable r_cv_iconv_latin1 is never set directly in configure, but
> by in a Macro called AC_CACHE_CHECK in the file m4/R.m4.
>
> Looking in that macro r4/R.m4 we see:
>
> AC_CACHE_CHECK([whether iconv accepts "UTF-8", "latin1" and "UCS-
> *"],
> [r_cv_iconv_latin1],
>
> So it would appear to me that AC_CACHE_CHECK needs to be run in order
> that r_cv_iconv_latin will be set properly. But looking at
> configure.ac, I think AC_CACHE_CHECK is only called on Linux, and not
> on Solaris. Obviously this could explain why this bit of Sage works on
> Linux, but not Solaris.
>
> ## check for visible __libc_stack_end on Linux
> case "${host_os}" in
> linux*)
>   AC_CACHE_CHECK([for visible __lib_stack_end],
>   [r_cv_libc_stack_end],
>   [AC_RUN_IFELSE([AC_LANG_SOURCE([[
> #include "confdefs.h"
> #include <stdlib.h>
> extern void * __libc_stack_end;
>
> So it seems to me this will never work, as the the relevant macro is
> not run on Solaris. It begs the obvious question why does this work
> when I download the source of R. I can't see the answer to that one,
> but there are reports of R failing to build on Solaris, but for me at
> least, it configures ok.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From david.kirkby at onetel.net  Sat Jun  7 14:35:11 2008
From: david.kirkby at onetel.net (Dr. David Kirkby)
Date: Sat, 07 Jun 2008 13:35:11 +0100
Subject: [Rd] Fail to call AC_CACHE_CHECK on R 2.7.0 for Solaris
In-Reply-To: <alpine.LFD.1.10.0806071308510.13253@gannet.stats.ox.ac.uk>
References: <484A6EEB.10704@onetel.net>
	<alpine.LFD.1.10.0806071308510.13253@gannet.stats.ox.ac.uk>
Message-ID: <484A807F.5050207@onetel.net>

Prof Brian Ripley wrote:
> This is covered in the 'R Installation and Administration' manual that
> INSTALL asked you to read.  Specifically for Solaris:
>
>  Modern Solaris systems allow a large selection of Open Source software
>  to be installed via @command{pkg-get}: a Sparc Solaris 10 system came
>  with @code{libreadline} and @code{libiconv} and a choice of @code{gcc3}
>  and @code{gcc4} compilers, installed under @file{/opt/csw}.  (You will
>  need GNU @code{libiconv}: the Solaris version of @code{iconv} is not
>  sufficiently powerful.)
>
> R 2.7.0 is documented to build on several versions of Solaris in that 
> manual, so the problem is definitely not 'R on Solaris'.
>
> You analysis is plain wrong.  Search for r_cv_iconv_latin1 in 
> configure and you will see three lines which set it (plus one that 
> checks if it was set in the cache). 


Thanks a lot. Clearly when I compiled R directly, it see my GNU libiconv 
rather than the Sun supplied one, but when built as part of Sage, it see 
the Sun one. That should be easy to fix.

Dave


From ggrothendieck at gmail.com  Sat Jun  7 15:38:34 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat, 7 Jun 2008 09:38:34 -0400
Subject: [Rd] Posting Guide
In-Reply-To: <971536df0806061030i75474172xff100ece76a23eec@mail.gmail.com>
References: <971536df0806061030i75474172xff100ece76a23eec@mail.gmail.com>
Message-ID: <971536df0806070638w48afb954y77278659edd37802@mail.gmail.com>

Here is a second version of the summary.  Its been rearranged to
place most important info at top.  Also shortened it a bit.

It still needs links to example posts, as suggested.  Anyone?

Summary

Surprisingly, the main problem for responders is not to answer the
posted questions but to quickly figure out what the question is, reproduce
it in their own R session and test their answer.

Test Framework.  To faciliate that provide a test framework of:

  (1) reproducible self-contained minimal code and data.  That means
      responders can copy it from the questioner's post and paste it
      into their session to see the same output without having to
      enter even one R command.
      NB. dput(mydata) produces mydata in reproducible form.
  (2) comments/explanations of what the code is intended to produce and
  (3) versions of all software used, e.g. sessionInfo().

Without self-contained reproducible code the responder must not only
understand the question but must also create a test framework and that
typically takes more time than answering the question!  Its not fair
to ask the responder to provide all that on top of answering the
question.  Do NOT assume the problem is so simple that it is not
necessary.

Effort. The effort taken to reduce the problem to its essentials and
produce a test framework often solves the problem avoiding the need
for a post in the first place.  It at the least shows that the
questioner tried to solve it themself.

Subscribers.  The questioner should ensure that the thread is complete
and that it has an appropriate Subject.  The purpose of the post is
not only to help the questioner but also the other list subscribers
and those later searching the archives.



On Fri, Jun 6, 2008 at 1:30 PM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:
> People read the posting guide yet they are still unable to create an acceptable
> post. e.g.
> https://stat.ethz.ch/pipermail/r-help/2008-June/164092.html
>
> I think the problem is that the guide is not clear or concise enough.
> I suggest we add a summary at the beginning which gets to the heart
> of what a poster is expected to provide:
>
> Summary
>
> To maximize your change of getting a response when posting provide (1)
> commented,
> (2) minimal, (3) self-contained and (4) reproducible code.  (This one
> line summary
> also appears at the end of each message to r-help.)
>
> "Self-contained" and "reproducible" mean that a responder can copy the
> questioner's code to
> the clipboard, paste it into their R session and see the same problem
> you as the questioner
> see.  Note that dput(mydata) will display mydata in a reproducible way.
> Self-contained and reproducible are needed because:
> (1) Self-Effort. It shows that the questioner tried to solve the
> problem by themself first.
> (2) Test framework. Often the responder needs to play with the code a
> bit in order to respond
> or at least to give the best answer.  They can't do that without a
> test framework that includes
> the data and the code to run it and its not fair to ask them to not
> only answer the question but
> also to come up with test data and to complete incomplete code.
> (3) Archives. Questions and answers go into the archives so they are
> not only for the benefit of
> of the questioner but also for the benefit of all future searchers of
> the archive.  That means
> that its not finished if you have solved the problem for yourself.
> You still need to ensure that
> the thread has a complete solution. (For that reason its also
> important to give a meaningful
> subject to each post.)
>
> "Commented" and "minimal" also reduce the time it takes to understand
> the problem.
> Don't just dump your code as is into the message since you are just
> wasting your own
> time. Its not likely anyone will answer a message if the questioner
> has not taken the
> time to reduce it to its essential elements.  Surprisingly, quite
> often understanding what
> the problem is takes the responder most of the time -- not solving the
> problem. Once the
> question is actually understood its often quite fast to answer.  Thus
> in addition to posting
> it in a minimal form, comment on it sufficiently so that the responder
> knows what the code
> does and is intended to produce.  It may be obvious to the questioner
> who is embroiled in
> the problem but that does not mean its obvious to others.
>
> Introduction
>
> .... rest of posting guide ...
>


From h.wickham at gmail.com  Sat Jun  7 16:48:37 2008
From: h.wickham at gmail.com (hadley wickham)
Date: Sat, 7 Jun 2008 09:48:37 -0500
Subject: [Rd] Posting Guide
In-Reply-To: <971536df0806070638w48afb954y77278659edd37802@mail.gmail.com>
References: <971536df0806061030i75474172xff100ece76a23eec@mail.gmail.com>
	<971536df0806070638w48afb954y77278659edd37802@mail.gmail.com>
Message-ID: <f8e6ff050806070748g38e91821wc0808249316ecd80@mail.gmail.com>

Here's my attempt at making a little more friendly:

Removed self-contained - implied by reproducible
Used slightly less formal language (and you instead of the questioner)
Fixed a couple of spelling mistakes
Removed references to testing framework - I don't think that that term
needs to be introduced

-------

For most questions, the main problem isn't answering the question, but
understanding exactly what the question is, reproducing the problem and
checking the answer. To make easy for others to help you, you should provide:

 (1) reproducible, minimal code, and the data needed to run it.  That means
     others can copy and paste from your email and see the same
     output that you did.  An easy way to include data in an email is to
     include the output of dput(mydata)

 (2) comments/explanations of what the code is supposed to do, and

 (3) the version of R and the packages that you used, easily produced by
     sessionInfo().

Without reproducible code, others have to spend a lot of time
recreating the problem so that they can provide an answer that works.
Do NOT assume the problem is so simple that it is not necessary.

This can seem like a lot of work, but it often pays off by revealing the
solution without having to ask anyone else. Even if it doesn't, your effort
shows the list that you have tried to solve it yourself.

It's also worthwhile spending some time writing a good subject line that
succinctly summarises your problem. This also helps others trying to solve the
same problem in the future as they can more easily locate relevant messages.

Hadley

On Sat, Jun 7, 2008 at 8:38 AM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:
> Here is a second version of the summary.  Its been rearranged to
> place most important info at top.  Also shortened it a bit.
>
> It still needs links to example posts, as suggested.  Anyone?
>
> Summary
>
> Surprisingly, the main problem for responders is not to answer the
> posted questions but to quickly figure out what the question is, reproduce
> it in their own R session and test their answer.
>
> Test Framework.  To faciliate that provide a test framework of:
>
>  (1) reproducible self-contained minimal code and data.  That means
>      responders can copy it from the questioner's post and paste it
>      into their session to see the same output without having to
>      enter even one R command.
>      NB. dput(mydata) produces mydata in reproducible form.
>  (2) comments/explanations of what the code is intended to produce and
>  (3) versions of all software used, e.g. sessionInfo().
>
> Without self-contained reproducible code the responder must not only
> understand the question but must also create a test framework and that
> typically takes more time than answering the question!  Its not fair
> to ask the responder to provide all that on top of answering the
> question.  Do NOT assume the problem is so simple that it is not
> necessary.
>
> Effort. The effort taken to reduce the problem to its essentials and
> produce a test framework often solves the problem avoiding the need
> for a post in the first place.  It at the least shows that the
> questioner tried to solve it themself.
>
> Subscribers.  The questioner should ensure that the thread is complete
> and that it has an appropriate Subject.  The purpose of the post is
> not only to help the questioner but also the other list subscribers
> and those later searching the archives.
>
>
>
> On Fri, Jun 6, 2008 at 1:30 PM, Gabor Grothendieck
> <ggrothendieck at gmail.com> wrote:
>> People read the posting guide yet they are still unable to create an acceptable
>> post. e.g.
>> https://stat.ethz.ch/pipermail/r-help/2008-June/164092.html
>>
>> I think the problem is that the guide is not clear or concise enough.
>> I suggest we add a summary at the beginning which gets to the heart
>> of what a poster is expected to provide:
>>
>> Summary
>>
>> To maximize your change of getting a response when posting provide (1)
>> commented,
>> (2) minimal, (3) self-contained and (4) reproducible code.  (This one
>> line summary
>> also appears at the end of each message to r-help.)
>>
>> "Self-contained" and "reproducible" mean that a responder can copy the
>> questioner's code to
>> the clipboard, paste it into their R session and see the same problem
>> you as the questioner
>> see.  Note that dput(mydata) will display mydata in a reproducible way.
>> Self-contained and reproducible are needed because:
>> (1) Self-Effort. It shows that the questioner tried to solve the
>> problem by themself first.
>> (2) Test framework. Often the responder needs to play with the code a
>> bit in order to respond
>> or at least to give the best answer.  They can't do that without a
>> test framework that includes
>> the data and the code to run it and its not fair to ask them to not
>> only answer the question but
>> also to come up with test data and to complete incomplete code.
>> (3) Archives. Questions and answers go into the archives so they are
>> not only for the benefit of
>> of the questioner but also for the benefit of all future searchers of
>> the archive.  That means
>> that its not finished if you have solved the problem for yourself.
>> You still need to ensure that
>> the thread has a complete solution. (For that reason its also
>> important to give a meaningful
>> subject to each post.)
>>
>> "Commented" and "minimal" also reduce the time it takes to understand
>> the problem.
>> Don't just dump your code as is into the message since you are just
>> wasting your own
>> time. Its not likely anyone will answer a message if the questioner
>> has not taken the
>> time to reduce it to its essential elements.  Surprisingly, quite
>> often understanding what
>> the problem is takes the responder most of the time -- not solving the
>> problem. Once the
>> question is actually understood its often quite fast to answer.  Thus
>> in addition to posting
>> it in a minimal form, comment on it sufficiently so that the responder
>> knows what the code
>> does and is intended to produce.  It may be obvious to the questioner
>> who is embroiled in
>> the problem but that does not mean its obvious to others.
>>
>> Introduction
>>
>> .... rest of posting guide ...
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
http://had.co.nz/


From cskiadas at gmail.com  Sat Jun  7 17:07:18 2008
From: cskiadas at gmail.com (Charilaos Skiadas)
Date: Sat, 7 Jun 2008 11:07:18 -0400
Subject: [Rd] Posting Guide
In-Reply-To: <f8e6ff050806070748g38e91821wc0808249316ecd80@mail.gmail.com>
References: <971536df0806061030i75474172xff100ece76a23eec@mail.gmail.com>
	<971536df0806070638w48afb954y77278659edd37802@mail.gmail.com>
	<f8e6ff050806070748g38e91821wc0808249316ecd80@mail.gmail.com>
Message-ID: <A1279CD0-9C18-4FE6-8145-F3E900917D6B@gmail.com>

Might I suggest the following two additions:

For item (1), I suggest adding to the end of it something like  
"Consider attaching this output/data as a txt file if it is too  
large, or consider using one of the built in data sets (as produced  
e.g. by data() ) if they suffice to illustrate the problem."
I find it rather distracting to have to wade through pages and pages  
of the the output of dput before I can read the questions to be  
answered, and perhaps they are the kinds of questions that indeed can  
be answered without that output, in which case having it pasted  
straight into the text can be quite distracting. Unless we can at  
least convince them to append the output to the end, instead of the  
core of the message.

With regards to sessionInfo, I would consider it equally important,  
many times, to have the output of ls(), to make sure that functions  
etc are not masked by user defined global variables. But perhaps I'm  
alone in that? At least mention clearly that the code provided should  
be reproducible on a clean R workspace, or something like that?

I think creating this summary section to the posting guide is a great  
idea. The posting guide, though chock full with useful information on  
how to do a proper post, ends up having just way too much  
information, resulting, as experienced, in people not following it.

Haris Skiadas
Department of Mathematics and Computer Science
Hanover College

On Jun 7, 2008, at 10:48 AM, hadley wickham wrote:

> Here's my attempt at making a little more friendly:
>
> Removed self-contained - implied by reproducible
> Used slightly less formal language (and you instead of the questioner)
> Fixed a couple of spelling mistakes
> Removed references to testing framework - I don't think that that term
> needs to be introduced
>
> -------
>
> For most questions, the main problem isn't answering the question, but
> understanding exactly what the question is, reproducing the problem  
> and
> checking the answer. To make easy for others to help you, you  
> should provide:
>
>  (1) reproducible, minimal code, and the data needed to run it.   
> That means
>      others can copy and paste from your email and see the same
>      output that you did.  An easy way to include data in an email  
> is to
>      include the output of dput(mydata)
>
>  (2) comments/explanations of what the code is supposed to do, and
>
>  (3) the version of R and the packages that you used, easily  
> produced by
>      sessionInfo().
>
> Without reproducible code, others have to spend a lot of time
> recreating the problem so that they can provide an answer that works.
> Do NOT assume the problem is so simple that it is not necessary.
>
> This can seem like a lot of work, but it often pays off by  
> revealing the
> solution without having to ask anyone else. Even if it doesn't,  
> your effort
> shows the list that you have tried to solve it yourself.
>
> It's also worthwhile spending some time writing a good subject line  
> that
> succinctly summarises your problem. This also helps others trying  
> to solve the
> same problem in the future as they can more easily locate relevant  
> messages.
>
> Hadley
>
> On Sat, Jun 7, 2008 at 8:38 AM, Gabor Grothendieck
> <ggrothendieck at gmail.com> wrote:
>> Here is a second version of the summary.  Its been rearranged to
>> place most important info at top.  Also shortened it a bit.
>>
>> It still needs links to example posts, as suggested.  Anyone?
>>
>> Summary
>>
>> Surprisingly, the main problem for responders is not to answer the
>> posted questions but to quickly figure out what the question is,  
>> reproduce
>> it in their own R session and test their answer.
>>
>> Test Framework.  To faciliate that provide a test framework of:
>>
>>  (1) reproducible self-contained minimal code and data.  That means
>>      responders can copy it from the questioner's post and paste it
>>      into their session to see the same output without having to
>>      enter even one R command.
>>      NB. dput(mydata) produces mydata in reproducible form.
>>  (2) comments/explanations of what the code is intended to produce  
>> and
>>  (3) versions of all software used, e.g. sessionInfo().
>>
>> Without self-contained reproducible code the responder must not only
>> understand the question but must also create a test framework and  
>> that
>> typically takes more time than answering the question!  Its not fair
>> to ask the responder to provide all that on top of answering the
>> question.  Do NOT assume the problem is so simple that it is not
>> necessary.
>>
>> Effort. The effort taken to reduce the problem to its essentials and
>> produce a test framework often solves the problem avoiding the need
>> for a post in the first place.  It at the least shows that the
>> questioner tried to solve it themself.
>>
>> Subscribers.  The questioner should ensure that the thread is  
>> complete
>> and that it has an appropriate Subject.  The purpose of the post is
>> not only to help the questioner but also the other list subscribers
>> and those later searching the archives.
>>
>>
>>
>> On Fri, Jun 6, 2008 at 1:30 PM, Gabor Grothendieck
>> <ggrothendieck at gmail.com> wrote:
>>> People read the posting guide yet they are still unable to create  
>>> an acceptable
>>> post. e.g.
>>> https://stat.ethz.ch/pipermail/r-help/2008-June/164092.html
>>>
>>> I think the problem is that the guide is not clear or concise  
>>> enough.
>>> I suggest we add a summary at the beginning which gets to the heart
>>> of what a poster is expected to provide:
>>>
>>> Summary
>>>
>>> To maximize your change of getting a response when posting  
>>> provide (1)
>>> commented,
>>> (2) minimal, (3) self-contained and (4) reproducible code.  (This  
>>> one
>>> line summary
>>> also appears at the end of each message to r-help.)
>>>
>>> "Self-contained" and "reproducible" mean that a responder can  
>>> copy the
>>> questioner's code to
>>> the clipboard, paste it into their R session and see the same  
>>> problem
>>> you as the questioner
>>> see.  Note that dput(mydata) will display mydata in a  
>>> reproducible way.
>>> Self-contained and reproducible are needed because:
>>> (1) Self-Effort. It shows that the questioner tried to solve the
>>> problem by themself first.
>>> (2) Test framework. Often the responder needs to play with the  
>>> code a
>>> bit in order to respond
>>> or at least to give the best answer.  They can't do that without a
>>> test framework that includes
>>> the data and the code to run it and its not fair to ask them to not
>>> only answer the question but
>>> also to come up with test data and to complete incomplete code.
>>> (3) Archives. Questions and answers go into the archives so they are
>>> not only for the benefit of
>>> of the questioner but also for the benefit of all future  
>>> searchers of
>>> the archive.  That means
>>> that its not finished if you have solved the problem for yourself.
>>> You still need to ensure that
>>> the thread has a complete solution. (For that reason its also
>>> important to give a meaningful
>>> subject to each post.)
>>>
>>> "Commented" and "minimal" also reduce the time it takes to  
>>> understand
>>> the problem.
>>> Don't just dump your code as is into the message since you are just
>>> wasting your own
>>> time. Its not likely anyone will answer a message if the questioner
>>> has not taken the
>>> time to reduce it to its essential elements.  Surprisingly, quite
>>> often understanding what
>>> the problem is takes the responder most of the time -- not  
>>> solving the
>>> problem. Once the
>>> question is actually understood its often quite fast to answer.   
>>> Thus
>>> in addition to posting
>>> it in a minimal form, comment on it sufficiently so that the  
>>> responder
>>> knows what the code
>>> does and is intended to produce.  It may be obvious to the  
>>> questioner
>>> who is embroiled in
>>> the problem but that does not mean its obvious to others.
>>>
>>> Introduction
>>>
>>> .... rest of posting guide ...
>>>


From ggrothendieck at gmail.com  Sat Jun  7 19:24:27 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat, 7 Jun 2008 13:24:27 -0400
Subject: [Rd] Posting Guide
In-Reply-To: <971536df0806070638w48afb954y77278659edd37802@mail.gmail.com>
References: <971536df0806061030i75474172xff100ece76a23eec@mail.gmail.com>
	<971536df0806070638w48afb954y77278659edd37802@mail.gmail.com>
Message-ID: <971536df0806071024x688e1bcfvac6a1c8a43182170@mail.gmail.com>

Here is another update.  I have added the following:

- info about using a fresh R session.  (In that case ls() output is less
  essential; however, the developers of sessionInfo() might consider
  adding that as a default or as an option.)

- questioner should consider use of functions.

- for data use dump(x, file = "") to reproducibly display data or use
  builtin datasets listed by data()

- minimal versions of slow code should be presented in cases where
  questioner is looking for faster code.

- we still need to add links to illustrative sample questions in r-help

The following were not added for the reason cited:

- guide is not just for questioners.  Important to distinguish roles
  of questioner, responder and reader.

- what is to be provided ought to be given a name to make it easier
  to refer to.  An unlabelled set of points is too vague.  Test
  framework seems appropriately descriptive.  By giving it a name
  one can request that a questioner "provide a test framework as
  defined in the posting guide summary".

- self contained is not implied by reproducible.  Reproducible
  only means that info is available somewhere -- not that its all
  available right in the questioner's post and all in a manner that
  is readily accessible.

- focus should be on making data minimal.  Don't like attachments
  since responder must save them and read them in.  It encourages
  use of large rather than minimal data sets.

Summary

Surprisingly, the main problem for responders is not to answer the
question but to quickly figure out what the question is, reproduce it
in their own R session and test their answer.

Test Framework.  To faciliate this provide a test framework of:

  (1) minimal reproducible self-contained commented code and data
      that has been run in a fresh R session.  That means code and
      data have been cut down as far as possible to the essentials
      needed to illustrate the problem and were run are just after
	  starting up R.  Also it means that its possible for responders
      to just copy the code and data section from the questioner's
      post to the clipboard and paste it into their session to see
      the same output without having to enter even one R command.
      In some cases there may be an advantage to present the code as
      a function and in the case of needing a speedup be sure to post
      a minimal version of the slow code.  Use builtin data sets such
      as those listed by data() to illustrate problem or reduce your
      data to a minimum and present it reproducibly by using:
         dump("mydata", file = "")

  (2) comments/explanation of what the code is intended to produce
	  -- Don't assume its obvious!

  (3) versions of all software used, e.g. sessionInfo(),
	  or R.version.string; packageDescription("zoo")$Version

Without self-contained reproducible code the responder must not only
understand the question but must also create a test framework and that
typically takes more time than answering the question!  Its not fair
to ask the responder to provide all that on top of answering the
question.  Do NOT assume the problem is so simple that it is not
necessary.

Effort. The effort taken to reduce the problem to its essentials and
produce a test framework often solves the problem avoiding the need
for a post in the first place.  It at the least shows that the
questioner tried to solve it themself.

Subscribers.  The questioner should ensure that the thread is complete
and that it has an appropriate Subject.  The purpose of the post is
not only to help the questioner but also the other list subscribers
and those later searching the archives.





On Sat, Jun 7, 2008 at 9:38 AM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:
> Here is a second version of the summary.  Its been rearranged to
> place most important info at top.  Also shortened it a bit.
>
> It still needs links to example posts, as suggested.  Anyone?
>
> Summary
>
> Surprisingly, the main problem for responders is not to answer the
> posted questions but to quickly figure out what the question is, reproduce
> it in their own R session and test their answer.
>
> Test Framework.  To faciliate that provide a test framework of:
>
>  (1) reproducible self-contained minimal code and data.  That means
>      responders can copy it from the questioner's post and paste it
>      into their session to see the same output without having to
>      enter even one R command.
>      NB. dput(mydata) produces mydata in reproducible form.
>  (2) comments/explanations of what the code is intended to produce and
>  (3) versions of all software used, e.g. sessionInfo().
>
> Without self-contained reproducible code the responder must not only
> understand the question but must also create a test framework and that
> typically takes more time than answering the question!  Its not fair
> to ask the responder to provide all that on top of answering the
> question.  Do NOT assume the problem is so simple that it is not
> necessary.
>
> Effort. The effort taken to reduce the problem to its essentials and
> produce a test framework often solves the problem avoiding the need
> for a post in the first place.  It at the least shows that the
> questioner tried to solve it themself.
>
> Subscribers.  The questioner should ensure that the thread is complete
> and that it has an appropriate Subject.  The purpose of the post is
> not only to help the questioner but also the other list subscribers
> and those later searching the archives.
>
>
>
> On Fri, Jun 6, 2008 at 1:30 PM, Gabor Grothendieck
> <ggrothendieck at gmail.com> wrote:
>> People read the posting guide yet they are still unable to create an acceptable
>> post. e.g.
>> https://stat.ethz.ch/pipermail/r-help/2008-June/164092.html
>>
>> I think the problem is that the guide is not clear or concise enough.
>> I suggest we add a summary at the beginning which gets to the heart
>> of what a poster is expected to provide:
>>
>> Summary
>>
>> To maximize your change of getting a response when posting provide (1)
>> commented,
>> (2) minimal, (3) self-contained and (4) reproducible code.  (This one
>> line summary
>> also appears at the end of each message to r-help.)
>>
>> "Self-contained" and "reproducible" mean that a responder can copy the
>> questioner's code to
>> the clipboard, paste it into their R session and see the same problem
>> you as the questioner
>> see.  Note that dput(mydata) will display mydata in a reproducible way.
>> Self-contained and reproducible are needed because:
>> (1) Self-Effort. It shows that the questioner tried to solve the
>> problem by themself first.
>> (2) Test framework. Often the responder needs to play with the code a
>> bit in order to respond
>> or at least to give the best answer.  They can't do that without a
>> test framework that includes
>> the data and the code to run it and its not fair to ask them to not
>> only answer the question but
>> also to come up with test data and to complete incomplete code.
>> (3) Archives. Questions and answers go into the archives so they are
>> not only for the benefit of
>> of the questioner but also for the benefit of all future searchers of
>> the archive.  That means
>> that its not finished if you have solved the problem for yourself.
>> You still need to ensure that
>> the thread has a complete solution. (For that reason its also
>> important to give a meaningful
>> subject to each post.)
>>
>> "Commented" and "minimal" also reduce the time it takes to understand
>> the problem.
>> Don't just dump your code as is into the message since you are just
>> wasting your own
>> time. Its not likely anyone will answer a message if the questioner
>> has not taken the
>> time to reduce it to its essential elements.  Surprisingly, quite
>> often understanding what
>> the problem is takes the responder most of the time -- not solving the
>> problem. Once the
>> question is actually understood its often quite fast to answer.  Thus
>> in addition to posting
>> it in a minimal form, comment on it sufficiently so that the responder
>> knows what the code
>> does and is intended to produce.  It may be obvious to the questioner
>> who is embroiled in
>> the problem but that does not mean its obvious to others.
>>
>> Introduction
>>
>> .... rest of posting guide ...
>>
>


From plroebuck at mdanderson.org  Sat Jun  7 10:44:31 2008
From: plroebuck at mdanderson.org (Paul Roebuck)
Date: Sat, 7 Jun 2008 03:44:31 -0500 (CDT)
Subject: [Rd] slot(obj, "nosuch") documentation question
Message-ID: <Pine.OSF.4.58.0806070258001.292185@wotan.mdacc.tmc.edu>

Using slot() on object (or "@") and using a nonexistent
slotname returns an error (see example code).

R> setClass("foobar", representation=list(a="numeric"))
[1] "foobar"
R> foobar <- new("foobar", a=5)
R> foobar at a
[1] 5
R> foobar at b
Error: no slot of name "b" for this object of class "foobar"

The details section of manpage has a paragraph that
seems to agree with above:

    Unlike attributes, slots are not partially matched,
    and asking for (or trying to set) a slot with an
    invalid name for that class generates an error.

But then the last paragraph in that same section seems to
suggest otherwise.

    Currently the @ extraction operator and slot function
    do no checking, neither that object has a formal class
    nor that name is a valid slot name for the class. (They
    will extract the attribute of the given name if it
    exists from any R object.) The replacement forms do
    check (at least if check=TRUE).

Are these two paragraphs not in partial conflict with each
other? I had initially expected (my initial bottom-up
quick glance only read last paragraph) to get NULL from
invalid slotname.

This is in reference to writing method that might be
passed an object created by previous version of software,
and new slots were added to class in later revisions.

For such situations, is the norm then to do
"slotNames(obj) %in% <slotname>" prior to accessing any
slotname from extended class?


TIA


R version 2.7.0 Patched (2008-06-04 r45830)

----------------------------------------------------------
SIGSIG -- signature too long (core dumped)


From zhongwent at yahoo.com  Sat Jun  7 00:59:54 2008
From: zhongwent at yahoo.com (ZT2008)
Date: Fri, 6 Jun 2008 15:59:54 -0700 (PDT)
Subject: [Rd]  Computational singularity of a positive definite matrix
Message-ID: <17702809.post@talk.nabble.com>


I'm trying to use function "solve" to find the inverse of a matrix, which is
positive definite in theory. But for some situations, I get error message
because of computational singularity. I'm wondering if I can set the
tolerance for detecting linear independence to an infinitely small value to
avoid this problem. Is there any serious consequence by doing this? Are
there other solutions to this problem? Thanks.
-- 
View this message in context: http://www.nabble.com/Computational-singularity-of-a-positive-definite-matrix-tp17702809p17702809.html
Sent from the R devel mailing list archive at Nabble.com.


From maechler at stat.math.ethz.ch  Sat Jun  7 22:33:14 2008
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Sat, 7 Jun 2008 22:33:14 +0200
Subject: [Rd] doc buglet / as.Date method
In-Reply-To: <Pine.OSF.4.58.0806051052170.104746@wotan.mdacc.tmc.edu>
References: <Pine.OSF.4.58.0806051052170.104746@wotan.mdacc.tmc.edu>
Message-ID: <18506.61578.838082.695359@cmath-5.math.ethz.ch>

>>>>> "PR" == Paul Roebuck <plroebuck at mdanderson.org>
>>>>>     on Thu, 5 Jun 2008 10:55:54 -0500 (CDT) writes:

    PR> Under Details section for as.Date:

    PR> as.Date will accept numeric data (the number of days
    PR> since an epoch), but only is origin is supplied.
    PR>                           ^^
    PR> should be "if"

Thank you; that's fixed now.


From lgautier at gmail.com  Sun Jun  8 12:49:09 2008
From: lgautier at gmail.com (Laurent Gautier)
Date: Sun, 8 Jun 2008 12:49:09 +0200
Subject: [Rd] Makevars or congiure for multi platforms
Message-ID: <27d1e6020806080349v28b60a51vf9661ae726aa8e90@mail.gmail.com>

2008/6/7  <r-devel-request at r-project.org>:
>
> Message: 11
> Date: Sat, 7 Jun 2008 03:38:23 +0900
> From: "Tadashi Kadowaki" <tadakado at gmail.com>
> Subject: [Rd] Makevars or congiure for multi platforms
> To: r-devel at r-project.org
> Message-ID:
>        <dcb3073c0806061138n2f376a24r100f281ae248497a at mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1
>
> Dear all,
>
> As previously submitted, I wrote an extending pdf device to embed
> pop up text and web links.
> (Patches are available at http://pdf2.r-forge.r-project.org/patches)
>
> Now, I'm making a library version of the pdf device.
> However, with my skill, I'm not sure about writing Makevars or configure file
> for multi platforms. A following line in Makevars works on my mac,
> -----
> PKG_CFLAGS=-I/Library/Frameworks/R.framework/PrivateHeaders -DHAVE_CONFIG_H
> -----
> (Note that the PrivateHeaders directory contains Fileio.h and Defn.h)
>
> My question is,
> How do I write Makevars or congiure for Unix/Linux and Windows?
> I would like to support those platforms in my library.

You could try looking into a package that has configure, configure.win
and has built binaries for macosX and windows. Try the package 'rgl'
on CRAN, for example.


Hoping this helps,


L.



> Regards,
>
> Tadashi Kadowaki
>
>
>


From edd at debian.org  Sun Jun  8 19:05:06 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 8 Jun 2008 12:05:06 -0500
Subject: [Rd] RFC: Add 'postinstall' hook to R CMD INSTALL ?
In-Reply-To: <18505.11938.823368.34327@ron.nulle.part>
References: <18503.62153.774662.127482@ron.nulle.part>
	<alpine.LFD.1.10.0806051514190.6771@gannet.stats.ox.ac.uk>
	<18505.9993.574030.720761@ron.nulle.part>
	<alpine.LFD.1.10.0806061310320.16732@gannet.stats.ox.ac.uk>
	<18505.11938.823368.34327@ron.nulle.part>
Message-ID: <18508.4418.322433.885976@ron.nulle.part>


Brian,

On 6 June 2008 at 07:33, Dirk Eddelbuettel wrote:
| 
| On 6 June 2008 at 13:13, Prof Brian Ripley wrote:
| | > On 6 June 2008 at 11:34, Prof Brian Ripley wrote:
| | > | Isn't this what Type: Frontend is for?  That gives you complete control
| | > | and would seem appropriate for both of your examples.
| | >
| | > Interesting.  But the R Extensions manual says
| | >
| | >   1.10.1 Frontend
| | >   ---------------
| | >
| | >   This is a rather general mechanism, designed for adding new front-ends
| | >   such as the *gnomeGUI* package.  If a `configure' file is found in the
| | >   top-level directory of the package it is executed, and then if a
| | >   `Makefile' is found (often generated by `configure'), `make' is called.
| | >   If `R CMD INSTALL --clean' is used `make clean' is called.  No other
| | >   action is taken.
| | >
| | > I am talking about the need for 'other action' such as 'make install', say.
| | >
| | > Are you suggesting I shoehorn what I want done into the main 'make' target ?
| | 
| | Yes.  I don't see it as 'shoehorn' -- it is the install step.
| 
| I have to think about this. I was envisioning a degree of freedom between
| 'make' and 'make install'. I may need some optionality here.
| 
| Anyway -- thanks for the suggestions. It is indeed very close to what I had
| asked for.

Thanks again for the gnomeGui suggestion. I looked at it and it comes close
but offer no cigar yet.  So looking at the code in $R_HOME/bin/INSTALL:

  if test "$Type" = "Frontend" ; then
    message "Installing *Frontend* package '${pkg_name}' ..."
    if ${preclean}; then
      ${MAKE} clean
    fi
    if ${use_configure} && test -x ./configure ; then
      eval ${configure_vars} ./configure ${configure_args}
      if test ${?} -ne 0; then
	error "configuration failed for package '${pkg_name}'"
	do_exit_on_error
      fi
    fi
    if test -f ./Makefile ; then
	${MAKE}
      if test ${?} -ne 0; then
	error "make failed for package '${pkg_name}'"
	do_exit_on_error
      fi
      if ${clean}; then
	${MAKE} clean
      fi
      return
    fi
    return
  fi

it is clear that the 'make install' step Jeff and I have asked about is not
there.  

Seeing how behaviour in the 'Frontend' case can be conditioned on flags like
--preclean, would there be objections to a patch implementing a new option,
say, --frontendinstall (or something similar that is shorter and more
expressive) that would, if set, call '${MAKE} install' before the 'make
clean' step ?

Better still, and in order to make things more autoMAGIC so that we can use
features like update.packages(), could the 'make install' case be conditional
on a) the 'Type = Frontend' choice in DESCRIPTION _and_ b) a top-level script
frontend-install in the package?  So instead of an user the user had to
choose, could we just run this for her a la

      if test -f ./frontend-install; then
	./frontend-install
	## alternatively, run ${MAKE} install
      if test ${?} -ne 0; then
	error "make install failed for package '${pkg_name}'"
	do_exit_on_error
      fi

Thirdly, I don't really see why we can't just run 'make install'
unconditionally.  That may need a minor patch to gnomeGUI to move the
(somewhat non-standard) 'install' target out of the 'make all' dependencies.
	 
I'd be happy to work on a complete patch that also updates the discussion in
the R Extensions manual, R Admin manual and the INSTALL help text, plus
whereever else INSTALL is documented.

Regards, Dirk

-- 
Three out of two people have difficulties with fractions.


From tadakado at gmail.com  Sun Jun  8 19:17:00 2008
From: tadakado at gmail.com (Tadashi Kadowaki)
Date: Mon, 9 Jun 2008 02:17:00 +0900
Subject: [Rd] Makevars or congiure for multi platforms
In-Reply-To: <27d1e6020806080349v28b60a51vf9661ae726aa8e90@mail.gmail.com>
References: <27d1e6020806080349v28b60a51vf9661ae726aa8e90@mail.gmail.com>
Message-ID: <dcb3073c0806081017k7aa4d89bv2f3a4528ac822fb8@mail.gmail.com>

Hi, Laurent and Tobias

Thanks a lot.

I could make configure script and upload it to r-forge.
https://r-forge.r-project.org/projects/pdf2/
It still works only on mac by default.
For Linux and Windows, it needs additional option like
-----
R CMD INSTALL --configure-vars="R_INTERNAL_HEADER_DIR=/path/to/src/include"
pdf2/pkg
-----
,where /path/to/src/include is the directory in the R source.
I didn't check it for Linux and Windows...

Regards,

Tadashi Kadowaki

2008/6/8 Laurent Gautier <lgautier at gmail.com>:
> 2008/6/7  <r-devel-request at r-project.org>:
>>
>> Message: 11
>> Date: Sat, 7 Jun 2008 03:38:23 +0900
>> From: "Tadashi Kadowaki" <tadakado at gmail.com>
>> Subject: [Rd] Makevars or congiure for multi platforms
>> To: r-devel at r-project.org
>> Message-ID:
>>        <dcb3073c0806061138n2f376a24r100f281ae248497a at mail.gmail.com>
>> Content-Type: text/plain; charset=ISO-8859-1
>>
>> Dear all,
>>
>> As previously submitted, I wrote an extending pdf device to embed
>> pop up text and web links.
>> (Patches are available at http://pdf2.r-forge.r-project.org/patches)
>>
>> Now, I'm making a library version of the pdf device.
>> However, with my skill, I'm not sure about writing Makevars or configure file
>> for multi platforms. A following line in Makevars works on my mac,
>> -----
>> PKG_CFLAGS=-I/Library/Frameworks/R.framework/PrivateHeaders -DHAVE_CONFIG_H
>> -----
>> (Note that the PrivateHeaders directory contains Fileio.h and Defn.h)
>>
>> My question is,
>> How do I write Makevars or congiure for Unix/Linux and Windows?
>> I would like to support those platforms in my library.
>
> You could try looking into a package that has configure, configure.win
> and has built binaries for macosX and windows. Try the package 'rgl'
> on CRAN, for example.
>
>
> Hoping this helps,
>
>
> L.
>
>
>
>> Regards,
>>
>> Tadashi Kadowaki
>>
>>
>>
>


From jmc at r-project.org  Sun Jun  8 22:25:17 2008
From: jmc at r-project.org (John Chambers)
Date: Sun, 08 Jun 2008 16:25:17 -0400
Subject: [Rd] slot(obj, "nosuch") documentation question
In-Reply-To: <Pine.OSF.4.58.0806070258001.292185@wotan.mdacc.tmc.edu>
References: <Pine.OSF.4.58.0806070258001.292185@wotan.mdacc.tmc.edu>
Message-ID: <484C402D.1030408@r-project.org>

Paul Roebuck wrote:
> Using slot() on object (or "@") and using a nonexistent
> slotname returns an error (see example code).
>
> R> setClass("foobar", representation=list(a="numeric"))
> [1] "foobar"
> R> foobar <- new("foobar", a=5)
> R> foobar at a
> [1] 5
> R> foobar at b
> Error: no slot of name "b" for this object of class "foobar"
>
> The details section of manpage has a paragraph that
> seems to agree with above:
>
>     Unlike attributes, slots are not partially matched,
>     and asking for (or trying to set) a slot with an
>     invalid name for that class generates an error.
>
> But then the last paragraph in that same section seems to
> suggest otherwise.
>
>     Currently the @ extraction operator and slot function
>     do no checking, neither that object has a formal class
>     nor that name is a valid slot name for the class. (They
>     will extract the attribute of the given name if it
>     exists from any R object.) The replacement forms do
>     check (at least if check=TRUE).
>
> Are these two paragraphs not in partial conflict with each
> other? 

No, but a little more detail in the documentation would have been 
helpful.  See my previous thread on this list:  the methods 
documentation is getting a major rewrite at the moment.

What's guaranteed is that foobar at b <- 1  will be disallowed if "b" is 
not a valid slot name or the right hand side is not coerceable to the 
appropriate class.  So as long as nobody cheats, only valid slot names 
will be found and not finding a slot of an invalid name generates an error.

However.

For various reasons, slots in R were implemented as attributes, and in 
the immediate future seem likely to remain so.  And, for now, there is 
no guarantee that code has not gone around assigning attributes with 
other names.

The access function @ or slot() doesn't go off to the class definition 
to check the name, so once such an  attribute is inserted, it looks like 
a "slot".  But you still will get an error assigning a value, because 
that computation _does_ check validity.  All this is in pursuit of 
efficiency, arguing that slot access tends to happen more often than 
replacement.

The following extension of your example illustrates:

 > setClass("foobar", representation=list(a="numeric"))
[1] "foobar"
 > foobar <- new("foobar", a=5)
 > foobar at a
[1] 5
 > foobar at b
Error: no slot of name "b" for this object of class "foobar"
 > attr(foobar, "b") <- 10
 > foobar at b
[1] 10
 > foobar at b <- 1
Error in checkSlotAssignment(object, name, value) :
  "b" is not a slot in class "foobar"

> I had initially expected (my initial bottom-up
> quick glance only read last paragraph) to get NULL from
> invalid slotname.
>
> This is in reference to writing method that might be
> passed an object created by previous version of software,
> and new slots were added to class in later revisions.
>
> For such situations, is the norm then to do
> "slotNames(obj) %in% <slotname>" prior to accessing any
> slotname from extended class?
>   
Dangerous practice.  I presume what happens is that objects are saved, 
then restored after the class has been redefined.  Restoring the old 
object creates an invalid object of the class.  You really should follow 
the restore by "fixing" any out of date objects.

It would be nice if R had versioning software that did some of this 
automatically, although in general it's a tough problem.

Perhaps other users who have encountered the problem of revising classes 
might comment on what their practice is.  Managing changing class 
definitions is an interesting and important topic.

John
>
> TIA
>
>
> R version 2.7.0 Patched (2008-06-04 r45830)
>
> ----------------------------------------------------------
> SIGSIG -- signature too long (core dumped)
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From mtmorgan at fhcrc.org  Mon Jun  9 00:04:36 2008
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Sun, 08 Jun 2008 15:04:36 -0700
Subject: [Rd] R CMD CHECK WARNING inappropriate for S4 method?
Message-ID: <6phd4mr7fd7.fsf@lamprey.fhcrc.org>

The package 'graph' defines classes graph and graphNEL (extending
graph) and a union,graph,graph-method. These are all exported and
fully documented.

The package 'GSEABase' Imports: graph and importClassesFrom(graph,
graphNEL). GSEABase defines methods on union for its own classes (not
graph / graphNEL), and has exportMethods(union).
union,graph,graph-method is not used in GSEABase.

R version 2.8.0 Under development (unstable) (2008-06-08 r45879)
reports from R CMD CHECK GSEABase

* checking for missing documentation entries ... WARNING
Undocumented S4 methods:
  generic 'union' and siglist 'graph,graph'

I guess union,graph,graph-method is exposed to the user indirectly by
its import along with the graph class and export along with the
newly-defined union methods.

It would seem inappropriate to document union,graph,graph-method in
GSEABase. Making GSEABase Depend: graph rather than Import: graph does
not help.

Any guidance welcome.

Thanks,

Martin
-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M2 B169
Phone: (206) 667-2793


From mtmorgan at fhcrc.org  Mon Jun  9 00:54:53 2008
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Sun, 08 Jun 2008 15:54:53 -0700
Subject: [Rd] slot(obj, "nosuch") documentation question
In-Reply-To: <484C402D.1030408@r-project.org> (John Chambers's message of
	"Sun, 08 Jun 2008 16:25:17 -0400")
References: <Pine.OSF.4.58.0806070258001.292185@wotan.mdacc.tmc.edu>
	<484C402D.1030408@r-project.org>
Message-ID: <6ph63sj7d1e.fsf@lamprey.fhcrc.org>

John Chambers <jmc at r-project.org> writes:

> Paul Roebuck wrote:
>> Using slot() on object (or "@") and using a nonexistent
>> slotname returns an error (see example code).

[snip]

>> This is in reference to writing method that might be
>> passed an object created by previous version of software,
>> and new slots were added to class in later revisions.
>>
>> For such situations, is the norm then to do
>> "slotNames(obj) %in% <slotname>" prior to accessing any
>> slotname from extended class?
>>   
> Dangerous practice.  I presume what happens is that objects are saved,
> then restored after the class has been redefined.  Restoring the old
> object creates an invalid object of the class.  You really should
> follow the restore by "fixing" any out of date objects.
>
> It would be nice if R had versioning software that did some of this
> automatically, although in general it's a tough problem.
>
> Perhaps other users who have encountered the problem of revising
> classes might comment on what their practice is.  Managing changing
> class definitions is an interesting and important topic.

The not completely satisfactory solution in the Bioconductor package
Biobase is classes Versioned (a 'mix-in' class to provide versioning
information and dispatch) and Versions (to represent version strings),
plus generics isVersioned, isCurrent, classVersion, classVersion<- for
accessing Versioned, and updateObject for providing a common interface
to the update operation.

Versioned is a class with slot .__classVersion__ that the developer
populates with a vector of Version objects. isCurrent is meant to be
the main entry point for assessing version, and compares the class
version of the object with the class version recorded in the class
definition. It also grandfathers in instances that existed before
Versioned itself was added to the class by checking that the object
has its S4 bit set, and that the instance is actually versioned. The
developer is expected to write updateObject methods that know how to
update from previous versions to the current version, and
callNextMethod to delegate responsibility to inherited methods
(including a default that tries to create a new instance by copying
slots from the current object into a newly created instance).

There are several complexities. isCurrent has to make decisions about
the current-ness of slot content (much as validObject
does). Inheritance means that only a portion of the class hierarchy
might be out-of-date so length(Versions) > 1 is the norm. Methods are
not associated with classes, so in a sense and for reproducibility
'isCurrent' might mean that the object was created with the same
version of R and relevant packages as are currently in
use. updateObject would really like to have a semantic and method
dispatch like validObject, where each updateObject method takes
responsibility for updating only the portion of the class that the
method is responsible for.

There are a number of aspects that are unsatisfactory about the
implementation. The developer has to manage class version numbering
(there's no hashing, say, of the class definition to automatically
register a new class; hashing is more complicated than at first sight
because components of the class can be out of date), including an
awkward way of capturing versions of inherited classes. Out-of-date
objects are not detected when loaded, but typically when a method
fails (and then the user writes to the bioc mailing list and is told
to use updateObject; key methods in Biobase check for class version,
but this is too expensive for every operation and many packages
outside Biobase make use of Biobase classes without checking version
information). Writing updateObject methods is challenging, in part
because updateObject uses 'standardGeneric' for dispatch and the
developer has to manage both updating the object and dispatching to
appropriate 'next' methods.

>From the user perspective, updateObject seems to have been quite
successful -- it provides a clean way for the user to solve a problem,
once it's been diagnosed.

Improvements on an iteration of this might (a) develop a default
updateObject method that 'did the right thing' more reliably, much as
'initialize,ANY-method' does. In fact, the current
updateObject,ANY-method does seem to be moderately successful at
this. (b) generalize the 'validObject' dispatch model and use that to
more clearly delineate the responsibilities of updateObject methods
(which currently have to be update their part of the object and
dispatch to the 'next' method and slots, if appropriate). (c) check
object version on load, which would require a change to R itself, or
some unique discipline on the part of objects from the package.

Martin

> John
>>
>> TIA
>>
>>
>> R version 2.7.0 Patched (2008-06-04 r45830)
>>
>> ----------------------------------------------------------
>> SIGSIG -- signature too long (core dumped)
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M2 B169
Phone: (206) 667-2793


From david.kirkby at onetel.net  Mon Jun  9 06:39:56 2008
From: david.kirkby at onetel.net (Dr. David Kirkby)
Date: Mon, 09 Jun 2008 05:39:56 +0100
Subject: [Rd] SHLIB_CXXLDFLAGS needs quotes on Solaris section of admin
	manual.
Message-ID: <484CB41C.20106@onetel.net>

In the admin manual, there is some information about flags etc for Solaris:

CC="cc -xc99"
CPPFLAGS=-I/opt/csw/include
CFLAGS="-O -xlibmieee"
F77=f95
FFLAGS=-O4
CXX=CC
CXXFLAGS=-O
FC=f95
FCFLAGS=$FFLAGS
LDFLAGS=-L/opt/csw/lib
SHLIB_CXXLDFLAGS=-G -lCstd

Where as the CC command is quoted, the SHLIB_CXXLDFLAGS one is not. 
Failure to put quotes around it results in configure script aborting.


From david.kirkby at onetel.net  Mon Jun  9 06:42:23 2008
From: david.kirkby at onetel.net (Dr. David Kirkby)
Date: Mon, 09 Jun 2008 05:42:23 +0100
Subject: [Rd] SHLIB_CXXLDFLAGS needs quotes on Solaris section of admin
	manual.
In-Reply-To: <484CB41C.20106@onetel.net>
References: <484CB41C.20106@onetel.net>
Message-ID: <484CB4AF.4050004@onetel.net>

Dr. David Kirkby wrote:
> In the admin manual, there is some information about flags etc for 
> Solaris:
>
> CC="cc -xc99"
> CPPFLAGS=-I/opt/csw/include
> CFLAGS="-O -xlibmieee"
> F77=f95
> FFLAGS=-O4
> CXX=CC
> CXXFLAGS=-O
> FC=f95
> FCFLAGS=$FFLAGS
> LDFLAGS=-L/opt/csw/lib
> SHLIB_CXXLDFLAGS=-G -lCstd
>
> Where as the CC command is quoted, the SHLIB_CXXLDFLAGS one is not. 
> Failure to put quotes around it results in configure script aborting.
>
>
>
i.e. I think it should read:
 
SHLIB_CXXLDFLAGS="-G -lCstd"

rather than

SHLIB_CXXLDFLAGS=-G -lCstd


From spencer.graves at pdf.com  Mon Jun  9 06:55:51 2008
From: spencer.graves at pdf.com (Spencer Graves)
Date: Sun, 08 Jun 2008 21:55:51 -0700
Subject: [Rd] eigenvector dimname convention?
Message-ID: <484CB7D7.8060103@pdf.com>

      What are reasonable conventions for dimnames for eigenvectors? 

      The standard 'eigen' function discards dimnames. 

      If a matrix X is symmetric (and rownames = colnames), it seems 
more sensible to assign rownames(eigen(X)$vectors) <- rownames(X).  The 
eigenvalues seem different, so I'm inclined to assign names like ev1, 
ev2, ..., to the eigenvectors and use those names for the columns of 
eigen(...)$vectors. 

      However, this analysis does not apply if rownames != colnames.  
What should be done in that case?  The 'solve' function uses a 
convention that might help here: 

 tst <- matrix(1:4, 2, dimnames=list(LETTERS[1:2], letters[3:4]))
 > tst
  c d
A 1 3
B 2 4

solve(tst)
   A    B
c -2  1.5
d  1 -0.5

      Tentative conclusion:  If rownames != colnames (or the matrix is 
not symmetric), then dimnames(eigen(X)$vectors) = dimnames(X).  That's 
because X = (vectors %*% values %*% solve(vectors)).  If desired, the 
eigenvalues can be assigned names matching colnames(X). 

      Does this make sense? 

      I ask, because I'm writing a function 'EIGEN' as a wrapper for 
'eigen' that tries to preserve dimnames.  This analysis suggests that 
how dimnames are assigned is at least partly a matter of convention 
rather than mathematics. 

      Thanks,
      Spencer Graves


From ripley at stats.ox.ac.uk  Mon Jun  9 07:25:49 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 9 Jun 2008 06:25:49 +0100 (BST)
Subject: [Rd] Makevars or congiure for multi platforms
In-Reply-To: <dcb3073c0806081017k7aa4d89bv2f3a4528ac822fb8@mail.gmail.com>
References: <27d1e6020806080349v28b60a51vf9661ae726aa8e90@mail.gmail.com>
	<dcb3073c0806081017k7aa4d89bv2f3a4528ac822fb8@mail.gmail.com>
Message-ID: <alpine.LFD.1.10.0806081949080.8051@gannet.stats.ox.ac.uk>

Private headers are just that, private.  They are not intended to be 
available to packages, and not installed by the standard R makefiles on 
either Unix-alikes or Windows.

I don't see it documented that they are available on MacOS X, and will 
leave it to that platform's maintainers as to why they have been installed 
on that platform.

You need to rewrite your code to use only documented headers and entry 
points if you intend to distribute it.


On Mon, 9 Jun 2008, Tadashi Kadowaki wrote:

> Hi, Laurent and Tobias
>
> Thanks a lot.
>
> I could make configure script and upload it to r-forge.
> https://r-forge.r-project.org/projects/pdf2/
> It still works only on mac by default.
> For Linux and Windows, it needs additional option like
> -----
> R CMD INSTALL --configure-vars="R_INTERNAL_HEADER_DIR=/path/to/src/include"
> pdf2/pkg
> -----
> ,where /path/to/src/include is the directory in the R source.
> I didn't check it for Linux and Windows...
>
> Regards,
>
> Tadashi Kadowaki
>
> 2008/6/8 Laurent Gautier <lgautier at gmail.com>:
>> 2008/6/7  <r-devel-request at r-project.org>:
>>>
>>> Message: 11
>>> Date: Sat, 7 Jun 2008 03:38:23 +0900
>>> From: "Tadashi Kadowaki" <tadakado at gmail.com>
>>> Subject: [Rd] Makevars or congiure for multi platforms
>>> To: r-devel at r-project.org
>>> Message-ID:
>>>        <dcb3073c0806061138n2f376a24r100f281ae248497a at mail.gmail.com>
>>> Content-Type: text/plain; charset=ISO-8859-1
>>>
>>> Dear all,
>>>
>>> As previously submitted, I wrote an extending pdf device to embed
>>> pop up text and web links.
>>> (Patches are available at http://pdf2.r-forge.r-project.org/patches)
>>>
>>> Now, I'm making a library version of the pdf device.
>>> However, with my skill, I'm not sure about writing Makevars or configure file
>>> for multi platforms. A following line in Makevars works on my mac,
>>> -----
>>> PKG_CFLAGS=-I/Library/Frameworks/R.framework/PrivateHeaders -DHAVE_CONFIG_H
>>> -----
>>> (Note that the PrivateHeaders directory contains Fileio.h and Defn.h)
>>>
>>> My question is,
>>> How do I write Makevars or congiure for Unix/Linux and Windows?
>>> I would like to support those platforms in my library.
>>
>> You could try looking into a package that has configure, configure.win
>> and has built binaries for macosX and windows. Try the package 'rgl'
>> on CRAN, for example.
>>
>>
>> Hoping this helps,
>>
>>
>> L.
>>
>>
>>
>>> Regards,
>>>
>>> Tadashi Kadowaki
>>>
>>>
>>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From adb014 at gmail.com  Sun Jun  8 20:25:05 2008
From: adb014 at gmail.com (David Bateman)
Date: Sun, 08 Jun 2008 20:25:05 +0200
Subject: [Rd] Issue with NA value and Octave compatibility
Message-ID: <484C2401.6010708@gmail.com>

Dear R developers,

I'm an Octave developer in the process of implementing a single
precision type in Octave and I have an issue with the NA value. The
choice of NA value in Octave was made a few years back so that the high
word of the NA value was 0x7ff00000 and the low word was 0x000007A2 for
compatibility with R and to ease any possible issue with the exchange of
data files between Octave and R.

However, now that I'm in the process of implementing the single
precision type I have a problem with this choice for the NA value as the
above when cast to a float results in the loss of the 0x7A2 value
creating a positive Infinity in IEE754, and so conversion of the NA
values between double and float with the above value does not work.

I have several possible choices of how to treat this, but as the reason
for the choice of Octave's NA value was made for compatibility with R,
the choice I'll make might very well be determined by how the R
developers react to any changes that Octave makes in this direction.

I can't realistically wrap the double and float types in Octave and
overload the assignment operators to handle the assignment of a float to
a double and visa versa as this would completely replace the underlying
data types in Octave. Its also impossible to trap everywhere where a
double might be assigned to a float and special case NA values as there
are just too many places that might occur.

I'm therefore assuming that I have to replace Octave's internal
representation of the NA value to allow easy conversion of the NA value
between double and floats. This can be done by replacing the NA value
with one that has zeros in the lower 19 bits of the mantissa of the
double, so that the cast from a double to float and visa versa works
correctly. For example using 0x7FF840F4 and 0x40000000 for the low and
high word of the double NA value. and 0x7FC207A2 for the float NA value
works. However then I have an issue of exchange of NA values with R and
with older versions of Octave.

Its easy enough to check for old NA values in files when reading and
alter them to the new NA values. So forward compatibility with older
versions of Octave and from R to Octave would be ok. However, the
reverse is not true. Actually saving the with the old NA value is
equally possible and would allow full compatible with older versions of
Octave and with R. The downside is that there are many places I'd have
to make a copy of the data when saving to allow this (for example saving
to HDF files), and so I'd prefer not to have to do this if possible.

As backwards compatibility is the smaller concern and self correcting
with time, if R was to also accept the an additional possible NA value
such as 0x7FF840F4/0x40000000, at least when loading files then
compatibility of the NA value between Octave and R could be maintained
and I wouldn't have to pay the penalty of making a copy of the data to
treat the NA values. Would the R developers be willing to make such a
change in R? If not I will maintain the R compatible NA value in
Octave's output and pay the performance penalty within Octave for this.

In any case if R intends at some point to support a single precision
type you will come across the same issue.

Regards
David


From jean.brefort at normalesup.org  Sun Jun  8 13:27:34 2008
From: jean.brefort at normalesup.org (Jean =?ISO-8859-1?Q?Br=E9fort?=)
Date: Sun, 08 Jun 2008 13:27:34 +0200
Subject: [Rd] R and Gnumeric
Message-ID: <1212924455.3923.25.camel@acer>

Hi,

I just read the "Embedding R in Gnumeric" idea at
http://www.r-project.org/SoC08/ideas.html. On my side, I intend to add
as many statistics related plot types to the current gnumeric charting
engine as possible. We already have boxplots and partial support for
histograms. My immediate plans are to finish the histogram code and add
probability plots (http://bugzilla.gnome.org/show_bug.cgi?id=500168)
during the summer if time permits (importing some code from R).
For the future, I see two options: either add all necessary plot types
to the gnumeric charting engine or embedding R charts directly using
either a new SheetObject class or the goffice component system (which
would allow inserting these charts in abiword as well).

One other totally unrelated thing. We got recently a bug report about an
incorrect R squared in gnumeric regression code
(http://bugzilla.gnome.org/show_bug.cgi?id=534659). R (version 2.7.0)
give the same result as Gnumeric as can be seen below:

> mydata <- read.csv(file="data.csv",sep=",")
> mydata
  X  Y
1 1  2
2 2  4
3 3  5
4 4  8
5 5  0
6 6  7
7 7  8
8 8  9
9 9 10
> summary(lm(mydata$Y~mydata$X))

Call:
lm(formula = mydata$Y ~ mydata$X)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.8889  0.2444  0.5111  0.7111  2.9778 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)  
(Intercept)   1.5556     1.8587   0.837   0.4303  
mydata$X      0.8667     0.3303   2.624   0.0342 *
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1 

Residual standard error: 2.559 on 7 degrees of freedom
Multiple R-squared: 0.4958,	Adjusted R-squared: 0.4238 
F-statistic: 6.885 on 1 and 7 DF,  p-value: 0.03422 

> summary(lm(mydata$Y~mydata$X-1))

Call:
lm(formula = mydata$Y ~ mydata$X - 1)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.5614  0.1018  0.3263  1.6632  3.5509 

Coefficients:
         Estimate Std. Error t value Pr(>|t|)    
mydata$X   1.1123     0.1487   7.481 7.06e-05 ***
---
Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1 

Residual standard error: 2.51 on 8 degrees of freedom
Multiple R-squared: 0.8749,	Adjusted R-squared: 0.8593 
F-statistic: 55.96 on 1 and 8 DF,  p-value: 7.056e-05 

I am unable to figure out what this 0.8749 value might represent. If it
is intended to be the Pearson moment, it should be 0.4958, and if it is
the coefficient of determination, I think the correct value would be
0.4454 as given by Excel. It's of course nice to have the same result in
R and Gnumeric,but it would be better if this result was accurate (if it
is, we need some documentation fix). Btw, I am not a statistics expert
at all.

Best regards,
Jean Brefort


From thomas.baier at logicals.com  Mon Jun  9 08:02:20 2008
From: thomas.baier at logicals.com (Thomas Baier)
Date: Mon, 9 Jun 2008 08:02:20 +0200 
Subject: [Rd] R-code embedded in VBE -- Type mismatch errors
Message-ID: <20C08B94D1CCDB11A0280004761A51130348AC@exchange-server.ow.ks>

Pietro,

pietro.parodi at aon.co.uk wrote:
> Hello,
> 
> I am trying to embed R-code inside VB for Excel (probably a perverse
> endeavour anyway) and I am running into difficulties, especially when
> passing vectors back and forth between the two environments.
> 
> (1) I am using the RExcel package.

There is a mailing list for RExcel where this should be discussed. Please
re-post your message to rcom-l.

Please be sure to browse the list archives first. Have a look at the RExcel
documentation for sources of information.

Thomas


From hangphan at gmail.com  Mon Jun  9 13:41:34 2008
From: hangphan at gmail.com (Hang PHAN)
Date: Mon, 9 Jun 2008 12:41:34 +0100
Subject: [Rd] Questions about building R extensions from C, data/ and man/,
	sbml file
Message-ID: <d3a410c80806090441u2c98f65ct697819c582522c30@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080609/9176b63b/attachment.pl>

From ripley at stats.ox.ac.uk  Mon Jun  9 13:56:19 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 9 Jun 2008 12:56:19 +0100 (BST)
Subject: [Rd] Questions about building R extensions from C,
 data/ and man/, sbml file
In-Reply-To: <d3a410c80806090441u2c98f65ct697819c582522c30@mail.gmail.com>
References: <d3a410c80806090441u2c98f65ct697819c582522c30@mail.gmail.com>
Message-ID: <alpine.LFD.1.10.0806091249150.4265@gannet.stats.ox.ac.uk>

Use system.file().  But please don't put your files in the data directory: 
as the manual says.

   The data subdirectory is for additional data files the package makes
   available for loading using data().

So if you put your data files in inst/sbml, your example becomes

abc(fname = system.file(package="mypackage", "sbml", "xxx.sbml"))

since this will be mypackage/sbml/xxx.sbml when installed.

There are several examples on CRAN, e.g. rgdal.


On Mon, 9 Jun 2008, Hang PHAN wrote:

> Hi,
>
> I am building the package in R using
>
>> R CMD build -force ./mypackage
>
> and check it using
>
>> R CMD check ./mypackage
>
> However I have a problem when running the examples in the manual files. The
> problem is that I used a specifice type of file that is not table, thus I
> guess data() can't be use to indicate the use of that particular file in the
> directory data/. Do you have any idea how I can pass the name of this data
> file as a string into the arguments of my function
>
> e.g. in abc.Rd
> \Examples{
> ss<- abc(fname = "xxx.sbml")
> }
> where xxx.sbml is a file in the data/ directory.
>
> Again, thanks very much and looking forwards to your reply.
>
> Phan Hang
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From hangphan at gmail.com  Mon Jun  9 14:54:18 2008
From: hangphan at gmail.com (Hang PHAN)
Date: Mon, 9 Jun 2008 13:54:18 +0100
Subject: [Rd] Questions about building R extensions from C,
	data/ and man/, sbml file
In-Reply-To: <alpine.LFD.1.10.0806091249150.4265@gannet.stats.ox.ac.uk>
References: <d3a410c80806090441u2c98f65ct697819c582522c30@mail.gmail.com>
	<alpine.LFD.1.10.0806091249150.4265@gannet.stats.ox.ac.uk>
Message-ID: <d3a410c80806090554t7a0f9601l7286dcabd7b276c5@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080609/46266db0/attachment.pl>

From P.Dalgaard at biostat.ku.dk  Mon Jun  9 16:34:53 2008
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon, 09 Jun 2008 16:34:53 +0200
Subject: [Rd] R and Gnumeric
In-Reply-To: <1212924455.3923.25.camel@acer>
References: <1212924455.3923.25.camel@acer>
Message-ID: <484D3F8D.7090502@biostat.ku.dk>

Jean Br?fort wrote:
> One other totally unrelated thing. We got recently a bug report about an
> incorrect R squared in gnumeric regression code
> (http://bugzilla.gnome.org/show_bug.cgi?id=534659). R (version 2.7.0)
> give the same result as Gnumeric as can be seen below:
>
>   
>> mydata <- read.csv(file="data.csv",sep=",")
>> mydata
>>     
>   X  Y
> 1 1  2
> 2 2  4
> 3 3  5
> 4 4  8
> 5 5  0
> 6 6  7
> 7 7  8
> 8 8  9
> 9 9 10
>   
>> summary(lm(mydata$Y~mydata$X))
>>     
>
> Call:
> lm(formula = mydata$Y ~ mydata$X)
>
> Residuals:
>     Min      1Q  Median      3Q     Max 
> -5.8889  0.2444  0.5111  0.7111  2.9778 
>
> Coefficients:
>             Estimate Std. Error t value Pr(>|t|)  
> (Intercept)   1.5556     1.8587   0.837   0.4303  
> mydata$X      0.8667     0.3303   2.624   0.0342 *
> ---
> Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1 
>
> Residual standard error: 2.559 on 7 degrees of freedom
> Multiple R-squared: 0.4958,	Adjusted R-squared: 0.4238 
> F-statistic: 6.885 on 1 and 7 DF,  p-value: 0.03422 
>
>   
>> summary(lm(mydata$Y~mydata$X-1))
>>     
>
> Call:
> lm(formula = mydata$Y ~ mydata$X - 1)
>
> Residuals:
>     Min      1Q  Median      3Q     Max 
> -5.5614  0.1018  0.3263  1.6632  3.5509 
>
> Coefficients:
>          Estimate Std. Error t value Pr(>|t|)    
> mydata$X   1.1123     0.1487   7.481 7.06e-05 ***
> ---
> Signif. codes:  0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1 
>
> Residual standard error: 2.51 on 8 degrees of freedom
> Multiple R-squared: 0.8749,	Adjusted R-squared: 0.8593 
> F-statistic: 55.96 on 1 and 8 DF,  p-value: 7.056e-05 
>
> I am unable to figure out what this 0.8749 value might represent. If it
> is intended to be the Pearson moment, it should be 0.4958, and if it is
> the coefficient of determination, I think the correct value would be
> 0.4454 as given by Excel. It's of course nice to have the same result in
> R and Gnumeric,but it would be better if this result was accurate (if it
> is, we need some documentation fix). Btw, I am not a statistics expert
> at all.
>   
This horse has been flogged multiple times on the list.

It is of course mainly a matter of convention, but the convention used
by R has been around at least since Genstat in the mid-1970s. In the
no-intercept case, you get the _uncentered_ version of R-squared; that
is, the proportion of the sum of squares explained by the model (as
opposed to sum of squares of _deviations_ in the usual case.) The
rationale is that the R^2 should be based on a reduction in residual
variation between two nested models, and if theres no intercept, the
only well-determined nested model is the one where mydata$Y has mean
zero for all x corresponding to all-zero regression coefficients. The
resulting R^2 is directly related to the F statistic, which you'll see
is also larger and more significant when the intercept is removed.

BTW:  lm(mydata$Y~mydata$X) is bad practice, use lm(Y~X, data=mydata).
Use of predict() will demonstrate why.

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From Heather.Turner at warwick.ac.uk  Mon Jun  9 16:35:09 2008
From: Heather.Turner at warwick.ac.uk (Dr Heather Turner)
Date: Mon, 09 Jun 2008 15:35:09 +0100
Subject: [Rd] Posting Guide - help.request() function?
In-Reply-To: <971536df0806071024x688e1bcfvac6a1c8a43182170@mail.gmail.com>
References: <971536df0806061030i75474172xff100ece76a23eec@mail.gmail.com>	<971536df0806070638w48afb954y77278659edd37802@mail.gmail.com>
	<971536df0806071024x688e1bcfvac6a1c8a43182170@mail.gmail.com>
Message-ID: <484D3F9D.7010404@warwick.ac.uk>

Whilst it is a good idea to improve the posting guide, it seems to me 
that it would be useful to have a function along the lines of 
bug.report(), to help a potential questioner make sure they have done 
their homework and have the relevant information to put into a post to 
R-help.

Even those of us who know what ought to go into a post can sometimes 
forget to check something obvious - I recently got caught out by not 
checking an error was reproducible in the patched version for example.

So I have written a help.request() function (see below), which
- prompts the user to check the relevant resources, stopping and opening 
the relevant url where necessary
- checks their R version is up-to-date (in a rather messy way - please 
suggest improvements!)
- prompts them to prepare appropriate example code and test it in a 
fresh R session
- prompts them to give a meaningful subject line
- automatically adds system info to the post (as in bug.report)
- sends the message for them (ensuring a fresh thread is started)

Is this an idea worth taking further? I would be happy to make 
improvements as suggested and write a help file if so.

Heather

------------------------------------------------------------

help.request <- function (subject = "",
                           ccaddress = Sys.getenv("USER"),
                           method = getOption("mailer"),
                           address = "r-help at R-project.org",
                           file = "R.help.request")
{
     no <- function(answer) answer == "n"
     yes <- function(answer) answer == "y"
     go <- function(url) {
         cat("Please do this first - the site has been loaded in your 
web browser\n")
         browseURL(url)
     }
     cat("Checklist:\n")
     post <- readline("Have you read the posting guide? (y/n) ")
     if (no(post)) return(go("http://www.r-project.org/posting-guide.html"))
     FAQ <- readline("Have you checked the FAQ? (y/n) ")
     if (no(FAQ)) return(go("http://cran.r-project.org/faqs.html"))
     intro <- readline("Have you checked An Introduction to R? (y/n) ")
     if (no(intro)) 
return(go("http://cran.r-project.org/doc/manuals/R-intro.html"))
     NEWS <- readline("Have you checked the NEWS of the latest 
development release? (y/n) ")
     if (no(NEWS)) return(go("https://svn.r-project.org/R/trunk/NEWS"))
     rsitesearch <- readline("Have you looked on RSiteSearch? (y/n) ")
     if (no(rsitesearch)) {
         cat("Please do this first - the site has been loaded in your 
web browser\n")
         return(RSiteSearch(subject))
     }
     inf <- sessionInfo()
     if ("otherPkgs" %in% names(inf)){
         other <- readline("You have packages other than the base 
packages loaded.",
                           "\nIf your query relates to one of these, 
have you ",
                           "checked any corresponding books/manuals \nand ",
                           "considered contacting the package 
maintainer? (y/n/NA) ")
         if(no(other)) return("Please do this first.")
     }

     man <- url("http://cran.r-project.org/manuals.html")
     ver <- scan(man, what = character(0), sep = "\n", skip = 13, nlines 
= 1, quiet = TRUE)
     major <- as.numeric(substr(ver, start = 18, stop = 18))
     minor <- as.numeric(substr(ver, start = 20, stop = 22))
     if (major < as.numeric(R.Version()$major) ||
         minor < as.numeric(R.Version()$major)) {
         update <- readline("Your R version is out-of-date, would you 
like to update now? (y/n) ")
         if (yes(update)) {
             return(go(getOption("repos")))
         }
     }
     ## To get long prompt!
     cat("Have you written example code that is\n",
         "- minimal\n - reproducible\n - self-contained\n - commented",
         "\nusing data that is either\n",
         "- constructed by the code\n - loaded by data()\n",
         "- reproduced using dump(\"mydata\", file = \"\")\n")
     code <- readline(paste("have you checked this code in a fresh R 
session",
                            "\n(invoking R with the --vanilla option if 
possible)",
                            "\nand is this code copied to the clipboard? 
(y/n) "))
     if (no(code))
         return(cat("\nIf your query is not directly related to code",
                "(e.g. a general query \nabout R's capabilities),",
                "email R-help at r-project.org directly. ",
                "\nOtherwise prepare some example code first.\n"))
     change <- readline(paste("Would you like to change your subject 
line:\n",
                              subject, "\nto something more meaningful? 
(y/n) "))
     if (yes(change))
         subject <- readline("Enter subject: \n")

     methods <- c("mailx", "gnudoit", "none", "ess")
     method <- if (is.null(method))
         "none"
     else methods[pmatch(method, methods)]
     body <- paste("\\n<<Write your query here, using your example code 
to illustrate>>",
                   "\\n<<End with your name and affiliation>>\\n\\n\\n\\n",
                   "--please do not edit the information below--\\n\\n",
                   "Version:\\n ", paste(names(R.version), R.version, 
sep = " = ",
                                         collapse = "\\n "), if 
(nzchar(Sys.getenv("R_GUI_APP_VERSION")))
                   paste("\\n\\nGUI:\\n R-GUI ", 
Sys.getenv("R_GUI_APP_VERSION"),
                         " (", Sys.getenv("R_GUI_APP_REVISION"), ")",
                         sep = "")
                                         else "", "\\n\\n", 
"Locale:\\n", Sys.getlocale(), "\\n\\n",
                   "Search Path:\\n ", paste(search(), collapse = ", "),
                   "\\n", sep = "", collapse = "")
     if (method == "gnudoit") {
         cmd <- paste("gnudoit -q '", "(mail nil \"", address,
                      "\")", "(insert \"", body, "\")", 
"(search-backward \"Subject:\")",
                      "(end-of-line)'", sep = "")
         system(cmd)
     }
     else if (method == "none") {
         disclaimer <- paste("# Your mailer is set to \"none\" (default 
on Windows),\n",
             "# hence we cannot send the help request directly from R.\n",
             "# Please copy the help request (after finishing it) to\n",
             "# your favorite email program and send it to\n#\n",
             "#       ", address, "\n#\n", 
"######################################################\n",
             "\n\n", sep = "")
         cat(disclaimer, file = file)
         body <- gsub("\\\\n", "\n", body)
         cat(body, file = file, append = TRUE)
         cat("Please edit the help request.\n")
         system(paste(getOption("editor"), file))
         cat("The unsent help request can be found in file", file,
             "\n")
     }
     else if (method == "mailx") {
         if (missing(subject))
             stop("'subject' missing")
         body <- gsub("\\\\n", "\n", body)
         cat(body, file = file, append = FALSE)
         cat("Please edit the help request.\n")
         system(paste(getOption("editor"), file))
         if (is.character(ccaddress) && nzchar(ccaddress)) {
             cmdargs <- paste("-s '", subject, "' -c", ccaddress,
                 address, "<", file, "2>/dev/null")
         }
         else cmdargs <- paste("-s '", subject, "'", address,
             "<", file, "2>/dev/null")
         status <- 1
         cat("Submit the help request? ")
         answer <- readline()
         answer <- grep("y", answer, ignore.case = TRUE)
         if (length(answer) > 0) {
             cat("Sending email ...\n")
             status <- system(paste("mailx", cmdargs))
             if (status > 0)
                 status <- system(paste("Mail", cmdargs))
             if (status > 0)
                 status <- system(paste("/usr/ucb/mail", cmdargs))
             if (status == 0)
                 unlink(file)
             else {
                 cat("Sending email failed!\n")
                 cat("The unsent help request can be found in file",
                   file, "\n")
             }
         }
         else cat("The unsent help request can be found in file",
             file, "\n")
     }
     else if (method == "ess") {
         body <- gsub("\\\\n", "\n", body)
         cat(body)
     }
}

-----------------------------------------------------------------------

Gabor Grothendieck wrote:
> Here is another update.  I have added the following:
> 
> - info about using a fresh R session.  (In that case ls() output is less
>   essential; however, the developers of sessionInfo() might consider
>   adding that as a default or as an option.)
> 
> - questioner should consider use of functions.
> 
> - for data use dump(x, file = "") to reproducibly display data or use
>   builtin datasets listed by data()
> 
> - minimal versions of slow code should be presented in cases where
>   questioner is looking for faster code.
> 
> - we still need to add links to illustrative sample questions in r-help
> 
> The following were not added for the reason cited:
> 
> - guide is not just for questioners.  Important to distinguish roles
>   of questioner, responder and reader.
> 
> - what is to be provided ought to be given a name to make it easier
>   to refer to.  An unlabelled set of points is too vague.  Test
>   framework seems appropriately descriptive.  By giving it a name
>   one can request that a questioner "provide a test framework as
>   defined in the posting guide summary".
> 
> - self contained is not implied by reproducible.  Reproducible
>   only means that info is available somewhere -- not that its all
>   available right in the questioner's post and all in a manner that
>   is readily accessible.
> 
> - focus should be on making data minimal.  Don't like attachments
>   since responder must save them and read them in.  It encourages
>   use of large rather than minimal data sets.
> 
> Summary
> 
> Surprisingly, the main problem for responders is not to answer the
> question but to quickly figure out what the question is, reproduce it
> in their own R session and test their answer.
> 
> Test Framework.  To faciliate this provide a test framework of:
> 
>   (1) minimal reproducible self-contained commented code and data
>       that has been run in a fresh R session.  That means code and
>       data have been cut down as far as possible to the essentials
>       needed to illustrate the problem and were run are just after
> 	  starting up R.  Also it means that its possible for responders
>       to just copy the code and data section from the questioner's
>       post to the clipboard and paste it into their session to see
>       the same output without having to enter even one R command.
>       In some cases there may be an advantage to present the code as
>       a function and in the case of needing a speedup be sure to post
>       a minimal version of the slow code.  Use builtin data sets such
>       as those listed by data() to illustrate problem or reduce your
>       data to a minimum and present it reproducibly by using:
>          dump("mydata", file = "")
> 
>   (2) comments/explanation of what the code is intended to produce
> 	  -- Don't assume its obvious!
> 
>   (3) versions of all software used, e.g. sessionInfo(),
> 	  or R.version.string; packageDescription("zoo")$Version
> 
> Without self-contained reproducible code the responder must not only
> understand the question but must also create a test framework and that
> typically takes more time than answering the question!  Its not fair
> to ask the responder to provide all that on top of answering the
> question.  Do NOT assume the problem is so simple that it is not
> necessary.
> 
> Effort. The effort taken to reduce the problem to its essentials and
> produce a test framework often solves the problem avoiding the need
> for a post in the first place.  It at the least shows that the
> questioner tried to solve it themself.
> 
> Subscribers.  The questioner should ensure that the thread is complete
> and that it has an appropriate Subject.  The purpose of the post is
> not only to help the questioner but also the other list subscribers
> and those later searching the archives.
> 
> 
> 
> 
> 
> On Sat, Jun 7, 2008 at 9:38 AM, Gabor Grothendieck
> <ggrothendieck at gmail.com> wrote:
>> Here is a second version of the summary.  Its been rearranged to
>> place most important info at top.  Also shortened it a bit.
>>
>> It still needs links to example posts, as suggested.  Anyone?
>>
>> Summary
>>
>> Surprisingly, the main problem for responders is not to answer the
>> posted questions but to quickly figure out what the question is, reproduce
>> it in their own R session and test their answer.
>>
>> Test Framework.  To faciliate that provide a test framework of:
>>
>>  (1) reproducible self-contained minimal code and data.  That means
>>      responders can copy it from the questioner's post and paste it
>>      into their session to see the same output without having to
>>      enter even one R command.
>>      NB. dput(mydata) produces mydata in reproducible form.
>>  (2) comments/explanations of what the code is intended to produce and
>>  (3) versions of all software used, e.g. sessionInfo().
>>
>> Without self-contained reproducible code the responder must not only
>> understand the question but must also create a test framework and that
>> typically takes more time than answering the question!  Its not fair
>> to ask the responder to provide all that on top of answering the
>> question.  Do NOT assume the problem is so simple that it is not
>> necessary.
>>
>> Effort. The effort taken to reduce the problem to its essentials and
>> produce a test framework often solves the problem avoiding the need
>> for a post in the first place.  It at the least shows that the
>> questioner tried to solve it themself.
>>
>> Subscribers.  The questioner should ensure that the thread is complete
>> and that it has an appropriate Subject.  The purpose of the post is
>> not only to help the questioner but also the other list subscribers
>> and those later searching the archives.
>>
>>
>>
>> On Fri, Jun 6, 2008 at 1:30 PM, Gabor Grothendieck
>> <ggrothendieck at gmail.com> wrote:
>>> People read the posting guide yet they are still unable to create an acceptable
>>> post. e.g.
>>> https://stat.ethz.ch/pipermail/r-help/2008-June/164092.html
>>>
>>> I think the problem is that the guide is not clear or concise enough.
>>> I suggest we add a summary at the beginning which gets to the heart
>>> of what a poster is expected to provide:
>>>
>>> Summary
>>>
>>> To maximize your change of getting a response when posting provide (1)
>>> commented,
>>> (2) minimal, (3) self-contained and (4) reproducible code.  (This one
>>> line summary
>>> also appears at the end of each message to r-help.)
>>>
>>> "Self-contained" and "reproducible" mean that a responder can copy the
>>> questioner's code to
>>> the clipboard, paste it into their R session and see the same problem
>>> you as the questioner
>>> see.  Note that dput(mydata) will display mydata in a reproducible way.
>>> Self-contained and reproducible are needed because:
>>> (1) Self-Effort. It shows that the questioner tried to solve the
>>> problem by themself first.
>>> (2) Test framework. Often the responder needs to play with the code a
>>> bit in order to respond
>>> or at least to give the best answer.  They can't do that without a
>>> test framework that includes
>>> the data and the code to run it and its not fair to ask them to not
>>> only answer the question but
>>> also to come up with test data and to complete incomplete code.
>>> (3) Archives. Questions and answers go into the archives so they are
>>> not only for the benefit of
>>> of the questioner but also for the benefit of all future searchers of
>>> the archive.  That means
>>> that its not finished if you have solved the problem for yourself.
>>> You still need to ensure that
>>> the thread has a complete solution. (For that reason its also
>>> important to give a meaningful
>>> subject to each post.)
>>>
>>> "Commented" and "minimal" also reduce the time it takes to understand
>>> the problem.
>>> Don't just dump your code as is into the message since you are just
>>> wasting your own
>>> time. Its not likely anyone will answer a message if the questioner
>>> has not taken the
>>> time to reduce it to its essential elements.  Surprisingly, quite
>>> often understanding what
>>> the problem is takes the responder most of the time -- not solving the
>>> problem. Once the
>>> question is actually understood its often quite fast to answer.  Thus
>>> in addition to posting
>>> it in a minimal form, comment on it sufficiently so that the responder
>>> knows what the code
>>> does and is intended to produce.  It may be obvious to the questioner
>>> who is embroiled in
>>> the problem but that does not mean its obvious to others.
>>>
>>> Introduction
>>>
>>> .... rest of posting guide ...
>>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Dr H Turner
Research Fellow
Dept. of Statistics
The University of Warwick
Coventry
CV4 7AL

Tel: 024 76575870
Fax: 024 76524532
Url: www.warwick.ac.uk/go/heatherturner


From ggrothendieck at gmail.com  Mon Jun  9 17:18:28 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 9 Jun 2008 11:18:28 -0400
Subject: [Rd] Posting Guide - help.request() function?
In-Reply-To: <484D3F9D.7010404@warwick.ac.uk>
References: <971536df0806061030i75474172xff100ece76a23eec@mail.gmail.com>
	<971536df0806070638w48afb954y77278659edd37802@mail.gmail.com>
	<971536df0806071024x688e1bcfvac6a1c8a43182170@mail.gmail.com>
	<484D3F9D.7010404@warwick.ac.uk>
Message-ID: <971536df0806090818l7acc330cy51746b3f815b9a7a@mail.gmail.com>

That's an excellent idea.

One other item that could be checkable would
be if the user has the most recent versions of the packages involved
in the query.    Perhaps it could display the unupdated packages
and ask the user if any of those are involved in the query.

Probably needs to give fair warning that it is sending
off an email so people don't wind up sending out emails when they
are really just trying out the system.  Probably "none" should be the
default for email so that its not regarded as obnoxious.

Might be nice if it used local versions of documents if they exist
locally.  On Windows they do.

Check out ?getRversion

On Mon, Jun 9, 2008 at 10:35 AM, Dr Heather Turner
<Heather.Turner at warwick.ac.uk> wrote:
> Whilst it is a good idea to improve the posting guide, it seems to me that
> it would be useful to have a function along the lines of bug.report(), to
> help a potential questioner make sure they have done their homework and have
> the relevant information to put into a post to R-help.
>
> Even those of us who know what ought to go into a post can sometimes forget
> to check something obvious - I recently got caught out by not checking an
> error was reproducible in the patched version for example.
>
> So I have written a help.request() function (see below), which
> - prompts the user to check the relevant resources, stopping and opening the
> relevant url where necessary
> - checks their R version is up-to-date (in a rather messy way - please
> suggest improvements!)
> - prompts them to prepare appropriate example code and test it in a fresh R
> session
> - prompts them to give a meaningful subject line
> - automatically adds system info to the post (as in bug.report)
> - sends the message for them (ensuring a fresh thread is started)
>
> Is this an idea worth taking further? I would be happy to make improvements
> as suggested and write a help file if so.
>
> Heather
>
> ------------------------------------------------------------
>
> help.request <- function (subject = "",
>                          ccaddress = Sys.getenv("USER"),
>                          method = getOption("mailer"),
>                          address = "r-help at R-project.org",
>                          file = "R.help.request")
> {
>    no <- function(answer) answer == "n"
>    yes <- function(answer) answer == "y"
>    go <- function(url) {
>        cat("Please do this first - the site has been loaded in your web
> browser\n")
>        browseURL(url)
>    }
>    cat("Checklist:\n")
>    post <- readline("Have you read the posting guide? (y/n) ")
>    if (no(post)) return(go("http://www.r-project.org/posting-guide.html"))
>    FAQ <- readline("Have you checked the FAQ? (y/n) ")
>    if (no(FAQ)) return(go("http://cran.r-project.org/faqs.html"))
>    intro <- readline("Have you checked An Introduction to R? (y/n) ")
>    if (no(intro))
> return(go("http://cran.r-project.org/doc/manuals/R-intro.html"))
>    NEWS <- readline("Have you checked the NEWS of the latest development
> release? (y/n) ")
>    if (no(NEWS)) return(go("https://svn.r-project.org/R/trunk/NEWS"))
>    rsitesearch <- readline("Have you looked on RSiteSearch? (y/n) ")
>    if (no(rsitesearch)) {
>        cat("Please do this first - the site has been loaded in your web
> browser\n")
>        return(RSiteSearch(subject))
>    }
>    inf <- sessionInfo()
>    if ("otherPkgs" %in% names(inf)){
>        other <- readline("You have packages other than the base packages
> loaded.",
>                          "\nIf your query relates to one of these, have you
> ",
>                          "checked any corresponding books/manuals \nand ",
>                          "considered contacting the package maintainer?
> (y/n/NA) ")
>        if(no(other)) return("Please do this first.")
>    }
>
>    man <- url("http://cran.r-project.org/manuals.html")
>    ver <- scan(man, what = character(0), sep = "\n", skip = 13, nlines = 1,
> quiet = TRUE)
>    major <- as.numeric(substr(ver, start = 18, stop = 18))
>    minor <- as.numeric(substr(ver, start = 20, stop = 22))
>    if (major < as.numeric(R.Version()$major) ||
>        minor < as.numeric(R.Version()$major)) {
>        update <- readline("Your R version is out-of-date, would you like to
> update now? (y/n) ")
>        if (yes(update)) {
>            return(go(getOption("repos")))
>        }
>    }
>    ## To get long prompt!
>    cat("Have you written example code that is\n",
>        "- minimal\n - reproducible\n - self-contained\n - commented",
>        "\nusing data that is either\n",
>        "- constructed by the code\n - loaded by data()\n",
>        "- reproduced using dump(\"mydata\", file = \"\")\n")
>    code <- readline(paste("have you checked this code in a fresh R session",
>                           "\n(invoking R with the --vanilla option if
> possible)",
>                           "\nand is this code copied to the clipboard? (y/n)
> "))
>    if (no(code))
>        return(cat("\nIf your query is not directly related to code",
>               "(e.g. a general query \nabout R's capabilities),",
>               "email R-help at r-project.org directly. ",
>               "\nOtherwise prepare some example code first.\n"))
>    change <- readline(paste("Would you like to change your subject line:\n",
>                             subject, "\nto something more meaningful? (y/n)
> "))
>    if (yes(change))
>        subject <- readline("Enter subject: \n")
>
>    methods <- c("mailx", "gnudoit", "none", "ess")
>    method <- if (is.null(method))
>        "none"
>    else methods[pmatch(method, methods)]
>    body <- paste("\\n<<Write your query here, using your example code to
> illustrate>>",
>                  "\\n<<End with your name and affiliation>>\\n\\n\\n\\n",
>                  "--please do not edit the information below--\\n\\n",
>                  "Version:\\n ", paste(names(R.version), R.version, sep = "
> = ",
>                                        collapse = "\\n "), if
> (nzchar(Sys.getenv("R_GUI_APP_VERSION")))
>                  paste("\\n\\nGUI:\\n R-GUI ",
> Sys.getenv("R_GUI_APP_VERSION"),
>                        " (", Sys.getenv("R_GUI_APP_REVISION"), ")",
>                        sep = "")
>                                        else "", "\\n\\n", "Locale:\\n",
> Sys.getlocale(), "\\n\\n",
>                  "Search Path:\\n ", paste(search(), collapse = ", "),
>                  "\\n", sep = "", collapse = "")
>    if (method == "gnudoit") {
>        cmd <- paste("gnudoit -q '", "(mail nil \"", address,
>                     "\")", "(insert \"", body, "\")", "(search-backward
> \"Subject:\")",
>                     "(end-of-line)'", sep = "")
>        system(cmd)
>    }
>    else if (method == "none") {
>        disclaimer <- paste("# Your mailer is set to \"none\" (default on
> Windows),\n",
>            "# hence we cannot send the help request directly from R.\n",
>            "# Please copy the help request (after finishing it) to\n",
>            "# your favorite email program and send it to\n#\n",
>            "#       ", address, "\n#\n",
> "######################################################\n",
>            "\n\n", sep = "")
>        cat(disclaimer, file = file)
>        body <- gsub("\\\\n", "\n", body)
>        cat(body, file = file, append = TRUE)
>        cat("Please edit the help request.\n")
>        system(paste(getOption("editor"), file))
>        cat("The unsent help request can be found in file", file,
>            "\n")
>    }
>    else if (method == "mailx") {
>        if (missing(subject))
>            stop("'subject' missing")
>        body <- gsub("\\\\n", "\n", body)
>        cat(body, file = file, append = FALSE)
>        cat("Please edit the help request.\n")
>        system(paste(getOption("editor"), file))
>        if (is.character(ccaddress) && nzchar(ccaddress)) {
>            cmdargs <- paste("-s '", subject, "' -c", ccaddress,
>                address, "<", file, "2>/dev/null")
>        }
>        else cmdargs <- paste("-s '", subject, "'", address,
>            "<", file, "2>/dev/null")
>        status <- 1
>        cat("Submit the help request? ")
>        answer <- readline()
>        answer <- grep("y", answer, ignore.case = TRUE)
>        if (length(answer) > 0) {
>            cat("Sending email ...\n")
>            status <- system(paste("mailx", cmdargs))
>            if (status > 0)
>                status <- system(paste("Mail", cmdargs))
>            if (status > 0)
>                status <- system(paste("/usr/ucb/mail", cmdargs))
>            if (status == 0)
>                unlink(file)
>            else {
>                cat("Sending email failed!\n")
>                cat("The unsent help request can be found in file",
>                  file, "\n")
>            }
>        }
>        else cat("The unsent help request can be found in file",
>            file, "\n")
>    }
>    else if (method == "ess") {
>        body <- gsub("\\\\n", "\n", body)
>        cat(body)
>    }
> }
>
> -----------------------------------------------------------------------
>
> Gabor Grothendieck wrote:
>>
>> Here is another update.  I have added the following:
>>
>> - info about using a fresh R session.  (In that case ls() output is less
>>  essential; however, the developers of sessionInfo() might consider
>>  adding that as a default or as an option.)
>>
>> - questioner should consider use of functions.
>>
>> - for data use dump(x, file = "") to reproducibly display data or use
>>  builtin datasets listed by data()
>>
>> - minimal versions of slow code should be presented in cases where
>>  questioner is looking for faster code.
>>
>> - we still need to add links to illustrative sample questions in r-help
>>
>> The following were not added for the reason cited:
>>
>> - guide is not just for questioners.  Important to distinguish roles
>>  of questioner, responder and reader.
>>
>> - what is to be provided ought to be given a name to make it easier
>>  to refer to.  An unlabelled set of points is too vague.  Test
>>  framework seems appropriately descriptive.  By giving it a name
>>  one can request that a questioner "provide a test framework as
>>  defined in the posting guide summary".
>>
>> - self contained is not implied by reproducible.  Reproducible
>>  only means that info is available somewhere -- not that its all
>>  available right in the questioner's post and all in a manner that
>>  is readily accessible.
>>
>> - focus should be on making data minimal.  Don't like attachments
>>  since responder must save them and read them in.  It encourages
>>  use of large rather than minimal data sets.
>>
>> Summary
>>
>> Surprisingly, the main problem for responders is not to answer the
>> question but to quickly figure out what the question is, reproduce it
>> in their own R session and test their answer.
>>
>> Test Framework.  To faciliate this provide a test framework of:
>>
>>  (1) minimal reproducible self-contained commented code and data
>>      that has been run in a fresh R session.  That means code and
>>      data have been cut down as far as possible to the essentials
>>      needed to illustrate the problem and were run are just after
>>          starting up R.  Also it means that its possible for responders
>>      to just copy the code and data section from the questioner's
>>      post to the clipboard and paste it into their session to see
>>      the same output without having to enter even one R command.
>>      In some cases there may be an advantage to present the code as
>>      a function and in the case of needing a speedup be sure to post
>>      a minimal version of the slow code.  Use builtin data sets such
>>      as those listed by data() to illustrate problem or reduce your
>>      data to a minimum and present it reproducibly by using:
>>         dump("mydata", file = "")
>>
>>  (2) comments/explanation of what the code is intended to produce
>>          -- Don't assume its obvious!
>>
>>  (3) versions of all software used, e.g. sessionInfo(),
>>          or R.version.string; packageDescription("zoo")$Version
>>
>> Without self-contained reproducible code the responder must not only
>> understand the question but must also create a test framework and that
>> typically takes more time than answering the question!  Its not fair
>> to ask the responder to provide all that on top of answering the
>> question.  Do NOT assume the problem is so simple that it is not
>> necessary.
>>
>> Effort. The effort taken to reduce the problem to its essentials and
>> produce a test framework often solves the problem avoiding the need
>> for a post in the first place.  It at the least shows that the
>> questioner tried to solve it themself.
>>
>> Subscribers.  The questioner should ensure that the thread is complete
>> and that it has an appropriate Subject.  The purpose of the post is
>> not only to help the questioner but also the other list subscribers
>> and those later searching the archives.
>>
>>
>>
>>
>>
>> On Sat, Jun 7, 2008 at 9:38 AM, Gabor Grothendieck
>> <ggrothendieck at gmail.com> wrote:
>>>
>>> Here is a second version of the summary.  Its been rearranged to
>>> place most important info at top.  Also shortened it a bit.
>>>
>>> It still needs links to example posts, as suggested.  Anyone?
>>>
>>> Summary
>>>
>>> Surprisingly, the main problem for responders is not to answer the
>>> posted questions but to quickly figure out what the question is,
>>> reproduce
>>> it in their own R session and test their answer.
>>>
>>> Test Framework.  To faciliate that provide a test framework of:
>>>
>>>  (1) reproducible self-contained minimal code and data.  That means
>>>     responders can copy it from the questioner's post and paste it
>>>     into their session to see the same output without having to
>>>     enter even one R command.
>>>     NB. dput(mydata) produces mydata in reproducible form.
>>>  (2) comments/explanations of what the code is intended to produce and
>>>  (3) versions of all software used, e.g. sessionInfo().
>>>
>>> Without self-contained reproducible code the responder must not only
>>> understand the question but must also create a test framework and that
>>> typically takes more time than answering the question!  Its not fair
>>> to ask the responder to provide all that on top of answering the
>>> question.  Do NOT assume the problem is so simple that it is not
>>> necessary.
>>>
>>> Effort. The effort taken to reduce the problem to its essentials and
>>> produce a test framework often solves the problem avoiding the need
>>> for a post in the first place.  It at the least shows that the
>>> questioner tried to solve it themself.
>>>
>>> Subscribers.  The questioner should ensure that the thread is complete
>>> and that it has an appropriate Subject.  The purpose of the post is
>>> not only to help the questioner but also the other list subscribers
>>> and those later searching the archives.
>>>
>>>
>>>
>>> On Fri, Jun 6, 2008 at 1:30 PM, Gabor Grothendieck
>>> <ggrothendieck at gmail.com> wrote:
>>>>
>>>> People read the posting guide yet they are still unable to create an
>>>> acceptable
>>>> post. e.g.
>>>> https://stat.ethz.ch/pipermail/r-help/2008-June/164092.html
>>>>
>>>> I think the problem is that the guide is not clear or concise enough.
>>>> I suggest we add a summary at the beginning which gets to the heart
>>>> of what a poster is expected to provide:
>>>>
>>>> Summary
>>>>
>>>> To maximize your change of getting a response when posting provide (1)
>>>> commented,
>>>> (2) minimal, (3) self-contained and (4) reproducible code.  (This one
>>>> line summary
>>>> also appears at the end of each message to r-help.)
>>>>
>>>> "Self-contained" and "reproducible" mean that a responder can copy the
>>>> questioner's code to
>>>> the clipboard, paste it into their R session and see the same problem
>>>> you as the questioner
>>>> see.  Note that dput(mydata) will display mydata in a reproducible way.
>>>> Self-contained and reproducible are needed because:
>>>> (1) Self-Effort. It shows that the questioner tried to solve the
>>>> problem by themself first.
>>>> (2) Test framework. Often the responder needs to play with the code a
>>>> bit in order to respond
>>>> or at least to give the best answer.  They can't do that without a
>>>> test framework that includes
>>>> the data and the code to run it and its not fair to ask them to not
>>>> only answer the question but
>>>> also to come up with test data and to complete incomplete code.
>>>> (3) Archives. Questions and answers go into the archives so they are
>>>> not only for the benefit of
>>>> of the questioner but also for the benefit of all future searchers of
>>>> the archive.  That means
>>>> that its not finished if you have solved the problem for yourself.
>>>> You still need to ensure that
>>>> the thread has a complete solution. (For that reason its also
>>>> important to give a meaningful
>>>> subject to each post.)
>>>>
>>>> "Commented" and "minimal" also reduce the time it takes to understand
>>>> the problem.
>>>> Don't just dump your code as is into the message since you are just
>>>> wasting your own
>>>> time. Its not likely anyone will answer a message if the questioner
>>>> has not taken the
>>>> time to reduce it to its essential elements.  Surprisingly, quite
>>>> often understanding what
>>>> the problem is takes the responder most of the time -- not solving the
>>>> problem. Once the
>>>> question is actually understood its often quite fast to answer.  Thus
>>>> in addition to posting
>>>> it in a minimal form, comment on it sufficiently so that the responder
>>>> knows what the code
>>>> does and is intended to produce.  It may be obvious to the questioner
>>>> who is embroiled in
>>>> the problem but that does not mean its obvious to others.
>>>>
>>>> Introduction
>>>>
>>>> .... rest of posting guide ...
>>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> --
> Dr H Turner
> Research Fellow
> Dept. of Statistics
> The University of Warwick
> Coventry
> CV4 7AL
>
> Tel: 024 76575870
> Fax: 024 76524532
> Url: www.warwick.ac.uk/go/heatherturner
>


From Heather.Turner at warwick.ac.uk  Mon Jun  9 18:21:17 2008
From: Heather.Turner at warwick.ac.uk (Dr Heather Turner)
Date: Mon, 09 Jun 2008 17:21:17 +0100
Subject: [Rd] Posting Guide - help.request() function?
In-Reply-To: <971536df0806090818l7acc330cy51746b3f815b9a7a@mail.gmail.com>
References: <971536df0806061030i75474172xff100ece76a23eec@mail.gmail.com>	
	<971536df0806070638w48afb954y77278659edd37802@mail.gmail.com>	
	<971536df0806071024x688e1bcfvac6a1c8a43182170@mail.gmail.com>	
	<484D3F9D.7010404@warwick.ac.uk>
	<971536df0806090818l7acc330cy51746b3f815b9a7a@mail.gmail.com>
Message-ID: <484D587D.9040101@warwick.ac.uk>

Thanks for the helpful tips and suggestions, I'll work them in. You get 
local versions of the documents on Unix too - RShowDoc() will do the trick.

I'll post an updated version in due course,

Heather


Gabor Grothendieck wrote:
> That's an excellent idea.
> 
> One other item that could be checkable would
> be if the user has the most recent versions of the packages involved
> in the query.    Perhaps it could display the unupdated packages
> and ask the user if any of those are involved in the query.
> 
> Probably needs to give fair warning that it is sending
> off an email so people don't wind up sending out emails when they
> are really just trying out the system.  Probably "none" should be the
> default for email so that its not regarded as obnoxious.
> 
> Might be nice if it used local versions of documents if they exist
> locally.  On Windows they do.
> 
> Check out ?getRversion
> 
> On Mon, Jun 9, 2008 at 10:35 AM, Dr Heather Turner
> <Heather.Turner at warwick.ac.uk> wrote:
>> Whilst it is a good idea to improve the posting guide, it seems to me that
>> it would be useful to have a function along the lines of bug.report(), to
>> help a potential questioner make sure they have done their homework and have
>> the relevant information to put into a post to R-help.
>>
>> Even those of us who know what ought to go into a post can sometimes forget
>> to check something obvious - I recently got caught out by not checking an
>> error was reproducible in the patched version for example.
>>
>> So I have written a help.request() function (see below), which
>> - prompts the user to check the relevant resources, stopping and opening the
>> relevant url where necessary
>> - checks their R version is up-to-date (in a rather messy way - please
>> suggest improvements!)
>> - prompts them to prepare appropriate example code and test it in a fresh R
>> session
>> - prompts them to give a meaningful subject line
>> - automatically adds system info to the post (as in bug.report)
>> - sends the message for them (ensuring a fresh thread is started)
>>
>> Is this an idea worth taking further? I would be happy to make improvements
>> as suggested and write a help file if so.
>>
>> Heather
>>
>> ------------------------------------------------------------
>>
>> help.request <- function (subject = "",
>>                          ccaddress = Sys.getenv("USER"),
>>                          method = getOption("mailer"),
>>                          address = "r-help at R-project.org",
>>                          file = "R.help.request")
>> {
>>    no <- function(answer) answer == "n"
>>    yes <- function(answer) answer == "y"
>>    go <- function(url) {
>>        cat("Please do this first - the site has been loaded in your web
>> browser\n")
>>        browseURL(url)
>>    }
>>    cat("Checklist:\n")
>>    post <- readline("Have you read the posting guide? (y/n) ")
>>    if (no(post)) return(go("http://www.r-project.org/posting-guide.html"))
>>    FAQ <- readline("Have you checked the FAQ? (y/n) ")
>>    if (no(FAQ)) return(go("http://cran.r-project.org/faqs.html"))
>>    intro <- readline("Have you checked An Introduction to R? (y/n) ")
>>    if (no(intro))
>> return(go("http://cran.r-project.org/doc/manuals/R-intro.html"))
>>    NEWS <- readline("Have you checked the NEWS of the latest development
>> release? (y/n) ")
>>    if (no(NEWS)) return(go("https://svn.r-project.org/R/trunk/NEWS"))
>>    rsitesearch <- readline("Have you looked on RSiteSearch? (y/n) ")
>>    if (no(rsitesearch)) {
>>        cat("Please do this first - the site has been loaded in your web
>> browser\n")
>>        return(RSiteSearch(subject))
>>    }
>>    inf <- sessionInfo()
>>    if ("otherPkgs" %in% names(inf)){
>>        other <- readline("You have packages other than the base packages
>> loaded.",
>>                          "\nIf your query relates to one of these, have you
>> ",
>>                          "checked any corresponding books/manuals \nand ",
>>                          "considered contacting the package maintainer?
>> (y/n/NA) ")
>>        if(no(other)) return("Please do this first.")
>>    }
>>
>>    man <- url("http://cran.r-project.org/manuals.html")
>>    ver <- scan(man, what = character(0), sep = "\n", skip = 13, nlines = 1,
>> quiet = TRUE)
>>    major <- as.numeric(substr(ver, start = 18, stop = 18))
>>    minor <- as.numeric(substr(ver, start = 20, stop = 22))
>>    if (major < as.numeric(R.Version()$major) ||
>>        minor < as.numeric(R.Version()$major)) {
>>        update <- readline("Your R version is out-of-date, would you like to
>> update now? (y/n) ")
>>        if (yes(update)) {
>>            return(go(getOption("repos")))
>>        }
>>    }
>>    ## To get long prompt!
>>    cat("Have you written example code that is\n",
>>        "- minimal\n - reproducible\n - self-contained\n - commented",
>>        "\nusing data that is either\n",
>>        "- constructed by the code\n - loaded by data()\n",
>>        "- reproduced using dump(\"mydata\", file = \"\")\n")
>>    code <- readline(paste("have you checked this code in a fresh R session",
>>                           "\n(invoking R with the --vanilla option if
>> possible)",
>>                           "\nand is this code copied to the clipboard? (y/n)
>> "))
>>    if (no(code))
>>        return(cat("\nIf your query is not directly related to code",
>>               "(e.g. a general query \nabout R's capabilities),",
>>               "email R-help at r-project.org directly. ",
>>               "\nOtherwise prepare some example code first.\n"))
>>    change <- readline(paste("Would you like to change your subject line:\n",
>>                             subject, "\nto something more meaningful? (y/n)
>> "))
>>    if (yes(change))
>>        subject <- readline("Enter subject: \n")
>>
>>    methods <- c("mailx", "gnudoit", "none", "ess")
>>    method <- if (is.null(method))
>>        "none"
>>    else methods[pmatch(method, methods)]
>>    body <- paste("\\n<<Write your query here, using your example code to
>> illustrate>>",
>>                  "\\n<<End with your name and affiliation>>\\n\\n\\n\\n",
>>                  "--please do not edit the information below--\\n\\n",
>>                  "Version:\\n ", paste(names(R.version), R.version, sep = "
>> = ",
>>                                        collapse = "\\n "), if
>> (nzchar(Sys.getenv("R_GUI_APP_VERSION")))
>>                  paste("\\n\\nGUI:\\n R-GUI ",
>> Sys.getenv("R_GUI_APP_VERSION"),
>>                        " (", Sys.getenv("R_GUI_APP_REVISION"), ")",
>>                        sep = "")
>>                                        else "", "\\n\\n", "Locale:\\n",
>> Sys.getlocale(), "\\n\\n",
>>                  "Search Path:\\n ", paste(search(), collapse = ", "),
>>                  "\\n", sep = "", collapse = "")
>>    if (method == "gnudoit") {
>>        cmd <- paste("gnudoit -q '", "(mail nil \"", address,
>>                     "\")", "(insert \"", body, "\")", "(search-backward
>> \"Subject:\")",
>>                     "(end-of-line)'", sep = "")
>>        system(cmd)
>>    }
>>    else if (method == "none") {
>>        disclaimer <- paste("# Your mailer is set to \"none\" (default on
>> Windows),\n",
>>            "# hence we cannot send the help request directly from R.\n",
>>            "# Please copy the help request (after finishing it) to\n",
>>            "# your favorite email program and send it to\n#\n",
>>            "#       ", address, "\n#\n",
>> "######################################################\n",
>>            "\n\n", sep = "")
>>        cat(disclaimer, file = file)
>>        body <- gsub("\\\\n", "\n", body)
>>        cat(body, file = file, append = TRUE)
>>        cat("Please edit the help request.\n")
>>        system(paste(getOption("editor"), file))
>>        cat("The unsent help request can be found in file", file,
>>            "\n")
>>    }
>>    else if (method == "mailx") {
>>        if (missing(subject))
>>            stop("'subject' missing")
>>        body <- gsub("\\\\n", "\n", body)
>>        cat(body, file = file, append = FALSE)
>>        cat("Please edit the help request.\n")
>>        system(paste(getOption("editor"), file))
>>        if (is.character(ccaddress) && nzchar(ccaddress)) {
>>            cmdargs <- paste("-s '", subject, "' -c", ccaddress,
>>                address, "<", file, "2>/dev/null")
>>        }
>>        else cmdargs <- paste("-s '", subject, "'", address,
>>            "<", file, "2>/dev/null")
>>        status <- 1
>>        cat("Submit the help request? ")
>>        answer <- readline()
>>        answer <- grep("y", answer, ignore.case = TRUE)
>>        if (length(answer) > 0) {
>>            cat("Sending email ...\n")
>>            status <- system(paste("mailx", cmdargs))
>>            if (status > 0)
>>                status <- system(paste("Mail", cmdargs))
>>            if (status > 0)
>>                status <- system(paste("/usr/ucb/mail", cmdargs))
>>            if (status == 0)
>>                unlink(file)
>>            else {
>>                cat("Sending email failed!\n")
>>                cat("The unsent help request can be found in file",
>>                  file, "\n")
>>            }
>>        }
>>        else cat("The unsent help request can be found in file",
>>            file, "\n")
>>    }
>>    else if (method == "ess") {
>>        body <- gsub("\\\\n", "\n", body)
>>        cat(body)
>>    }
>> }
>>
>> -----------------------------------------------------------------------
>>
>> Gabor Grothendieck wrote:
>>> Here is another update.  I have added the following:
>>>
>>> - info about using a fresh R session.  (In that case ls() output is less
>>>  essential; however, the developers of sessionInfo() might consider
>>>  adding that as a default or as an option.)
>>>
>>> - questioner should consider use of functions.
>>>
>>> - for data use dump(x, file = "") to reproducibly display data or use
>>>  builtin datasets listed by data()
>>>
>>> - minimal versions of slow code should be presented in cases where
>>>  questioner is looking for faster code.
>>>
>>> - we still need to add links to illustrative sample questions in r-help
>>>
>>> The following were not added for the reason cited:
>>>
>>> - guide is not just for questioners.  Important to distinguish roles
>>>  of questioner, responder and reader.
>>>
>>> - what is to be provided ought to be given a name to make it easier
>>>  to refer to.  An unlabelled set of points is too vague.  Test
>>>  framework seems appropriately descriptive.  By giving it a name
>>>  one can request that a questioner "provide a test framework as
>>>  defined in the posting guide summary".
>>>
>>> - self contained is not implied by reproducible.  Reproducible
>>>  only means that info is available somewhere -- not that its all
>>>  available right in the questioner's post and all in a manner that
>>>  is readily accessible.
>>>
>>> - focus should be on making data minimal.  Don't like attachments
>>>  since responder must save them and read them in.  It encourages
>>>  use of large rather than minimal data sets.
>>>
>>> Summary
>>>
>>> Surprisingly, the main problem for responders is not to answer the
>>> question but to quickly figure out what the question is, reproduce it
>>> in their own R session and test their answer.
>>>
>>> Test Framework.  To faciliate this provide a test framework of:
>>>
>>>  (1) minimal reproducible self-contained commented code and data
>>>      that has been run in a fresh R session.  That means code and
>>>      data have been cut down as far as possible to the essentials
>>>      needed to illustrate the problem and were run are just after
>>>          starting up R.  Also it means that its possible for responders
>>>      to just copy the code and data section from the questioner's
>>>      post to the clipboard and paste it into their session to see
>>>      the same output without having to enter even one R command.
>>>      In some cases there may be an advantage to present the code as
>>>      a function and in the case of needing a speedup be sure to post
>>>      a minimal version of the slow code.  Use builtin data sets such
>>>      as those listed by data() to illustrate problem or reduce your
>>>      data to a minimum and present it reproducibly by using:
>>>         dump("mydata", file = "")
>>>
>>>  (2) comments/explanation of what the code is intended to produce
>>>          -- Don't assume its obvious!
>>>
>>>  (3) versions of all software used, e.g. sessionInfo(),
>>>          or R.version.string; packageDescription("zoo")$Version
>>>
>>> Without self-contained reproducible code the responder must not only
>>> understand the question but must also create a test framework and that
>>> typically takes more time than answering the question!  Its not fair
>>> to ask the responder to provide all that on top of answering the
>>> question.  Do NOT assume the problem is so simple that it is not
>>> necessary.
>>>
>>> Effort. The effort taken to reduce the problem to its essentials and
>>> produce a test framework often solves the problem avoiding the need
>>> for a post in the first place.  It at the least shows that the
>>> questioner tried to solve it themself.
>>>
>>> Subscribers.  The questioner should ensure that the thread is complete
>>> and that it has an appropriate Subject.  The purpose of the post is
>>> not only to help the questioner but also the other list subscribers
>>> and those later searching the archives.
>>>
>>>
>>>
>>>
>>>
>>> On Sat, Jun 7, 2008 at 9:38 AM, Gabor Grothendieck
>>> <ggrothendieck at gmail.com> wrote:
>>>> Here is a second version of the summary.  Its been rearranged to
>>>> place most important info at top.  Also shortened it a bit.
>>>>
>>>> It still needs links to example posts, as suggested.  Anyone?
>>>>
>>>> Summary
>>>>
>>>> Surprisingly, the main problem for responders is not to answer the
>>>> posted questions but to quickly figure out what the question is,
>>>> reproduce
>>>> it in their own R session and test their answer.
>>>>
>>>> Test Framework.  To faciliate that provide a test framework of:
>>>>
>>>>  (1) reproducible self-contained minimal code and data.  That means
>>>>     responders can copy it from the questioner's post and paste it
>>>>     into their session to see the same output without having to
>>>>     enter even one R command.
>>>>     NB. dput(mydata) produces mydata in reproducible form.
>>>>  (2) comments/explanations of what the code is intended to produce and
>>>>  (3) versions of all software used, e.g. sessionInfo().
>>>>
>>>> Without self-contained reproducible code the responder must not only
>>>> understand the question but must also create a test framework and that
>>>> typically takes more time than answering the question!  Its not fair
>>>> to ask the responder to provide all that on top of answering the
>>>> question.  Do NOT assume the problem is so simple that it is not
>>>> necessary.
>>>>
>>>> Effort. The effort taken to reduce the problem to its essentials and
>>>> produce a test framework often solves the problem avoiding the need
>>>> for a post in the first place.  It at the least shows that the
>>>> questioner tried to solve it themself.
>>>>
>>>> Subscribers.  The questioner should ensure that the thread is complete
>>>> and that it has an appropriate Subject.  The purpose of the post is
>>>> not only to help the questioner but also the other list subscribers
>>>> and those later searching the archives.
>>>>
>>>>
>>>>
>>>> On Fri, Jun 6, 2008 at 1:30 PM, Gabor Grothendieck
>>>> <ggrothendieck at gmail.com> wrote:
>>>>> People read the posting guide yet they are still unable to create an
>>>>> acceptable
>>>>> post. e.g.
>>>>> https://stat.ethz.ch/pipermail/r-help/2008-June/164092.html
>>>>>
>>>>> I think the problem is that the guide is not clear or concise enough.
>>>>> I suggest we add a summary at the beginning which gets to the heart
>>>>> of what a poster is expected to provide:
>>>>>
>>>>> Summary
>>>>>
>>>>> To maximize your change of getting a response when posting provide (1)
>>>>> commented,
>>>>> (2) minimal, (3) self-contained and (4) reproducible code.  (This one
>>>>> line summary
>>>>> also appears at the end of each message to r-help.)
>>>>>
>>>>> "Self-contained" and "reproducible" mean that a responder can copy the
>>>>> questioner's code to
>>>>> the clipboard, paste it into their R session and see the same problem
>>>>> you as the questioner
>>>>> see.  Note that dput(mydata) will display mydata in a reproducible way.
>>>>> Self-contained and reproducible are needed because:
>>>>> (1) Self-Effort. It shows that the questioner tried to solve the
>>>>> problem by themself first.
>>>>> (2) Test framework. Often the responder needs to play with the code a
>>>>> bit in order to respond
>>>>> or at least to give the best answer.  They can't do that without a
>>>>> test framework that includes
>>>>> the data and the code to run it and its not fair to ask them to not
>>>>> only answer the question but
>>>>> also to come up with test data and to complete incomplete code.
>>>>> (3) Archives. Questions and answers go into the archives so they are
>>>>> not only for the benefit of
>>>>> of the questioner but also for the benefit of all future searchers of
>>>>> the archive.  That means
>>>>> that its not finished if you have solved the problem for yourself.
>>>>> You still need to ensure that
>>>>> the thread has a complete solution. (For that reason its also
>>>>> important to give a meaningful
>>>>> subject to each post.)
>>>>>
>>>>> "Commented" and "minimal" also reduce the time it takes to understand
>>>>> the problem.
>>>>> Don't just dump your code as is into the message since you are just
>>>>> wasting your own
>>>>> time. Its not likely anyone will answer a message if the questioner
>>>>> has not taken the
>>>>> time to reduce it to its essential elements.  Surprisingly, quite
>>>>> often understanding what
>>>>> the problem is takes the responder most of the time -- not solving the
>>>>> problem. Once the
>>>>> question is actually understood its often quite fast to answer.  Thus
>>>>> in addition to posting
>>>>> it in a minimal form, comment on it sufficiently so that the responder
>>>>> knows what the code
>>>>> does and is intended to produce.  It may be obvious to the questioner
>>>>> who is embroiled in
>>>>> the problem but that does not mean its obvious to others.
>>>>>
>>>>> Introduction
>>>>>
>>>>> .... rest of posting guide ...
>>>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> --
>> Dr H Turner
>> Research Fellow
>> Dept. of Statistics
>> The University of Warwick
>> Coventry
>> CV4 7AL
>>
>> Tel: 024 76575870
>> Fax: 024 76524532
>> Url: www.warwick.ac.uk/go/heatherturner
>>

-- 
Dr H Turner
Research Fellow
Dept. of Statistics
The University of Warwick
Coventry
CV4 7AL

Tel: 024 76575870
Fax: 024 76524532
Url: www.warwick.ac.uk/go/heatherturner


From tadakado at gmail.com  Mon Jun  9 20:04:17 2008
From: tadakado at gmail.com (Tadashi Kadowaki)
Date: Tue, 10 Jun 2008 03:04:17 +0900
Subject: [Rd] Makevars or congiure for multi platforms
In-Reply-To: <alpine.LFD.1.10.0806081949080.8051@gannet.stats.ox.ac.uk>
References: <27d1e6020806080349v28b60a51vf9661ae726aa8e90@mail.gmail.com>
	<dcb3073c0806081017k7aa4d89bv2f3a4528ac822fb8@mail.gmail.com>
	<alpine.LFD.1.10.0806081949080.8051@gannet.stats.ox.ac.uk>
Message-ID: <dcb3073c0806091104o21f52b1g49d4a70074fca272@mail.gmail.com>

Prof Ripley,

I fixed and uploaded.

However, it is still useful for development of a package that is close
to R core,
if Rconfig.h contains all definitions in config.h. If Rconfig
contained all information,
I didn't have to refer the private header directory.

Regards,

Tadashi Kadowaki

2008/6/9 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
> Private headers are just that, private.  They are not intended to be
> available to packages, and not installed by the standard R makefiles on
> either Unix-alikes or Windows.
>
> I don't see it documented that they are available on MacOS X, and will leave
> it to that platform's maintainers as to why they have been installed on that
> platform.
>
> You need to rewrite your code to use only documented headers and entry
> points if you intend to distribute it.
>
>
> On Mon, 9 Jun 2008, Tadashi Kadowaki wrote:
>
>> Hi, Laurent and Tobias
>>
>> Thanks a lot.
>>
>> I could make configure script and upload it to r-forge.
>> https://r-forge.r-project.org/projects/pdf2/
>> It still works only on mac by default.
>> For Linux and Windows, it needs additional option like
>> -----
>> R CMD INSTALL
>> --configure-vars="R_INTERNAL_HEADER_DIR=/path/to/src/include"
>> pdf2/pkg
>> -----
>> ,where /path/to/src/include is the directory in the R source.
>> I didn't check it for Linux and Windows...
>>
>> Regards,
>>
>> Tadashi Kadowaki
>>
>> 2008/6/8 Laurent Gautier <lgautier at gmail.com>:
>>>
>>> 2008/6/7  <r-devel-request at r-project.org>:
>>>>
>>>> Message: 11
>>>> Date: Sat, 7 Jun 2008 03:38:23 +0900
>>>> From: "Tadashi Kadowaki" <tadakado at gmail.com>
>>>> Subject: [Rd] Makevars or congiure for multi platforms
>>>> To: r-devel at r-project.org
>>>> Message-ID:
>>>>       <dcb3073c0806061138n2f376a24r100f281ae248497a at mail.gmail.com>
>>>> Content-Type: text/plain; charset=ISO-8859-1
>>>>
>>>> Dear all,
>>>>
>>>> As previously submitted, I wrote an extending pdf device to embed
>>>> pop up text and web links.
>>>> (Patches are available at http://pdf2.r-forge.r-project.org/patches)
>>>>
>>>> Now, I'm making a library version of the pdf device.
>>>> However, with my skill, I'm not sure about writing Makevars or configure
>>>> file
>>>> for multi platforms. A following line in Makevars works on my mac,
>>>> -----
>>>> PKG_CFLAGS=-I/Library/Frameworks/R.framework/PrivateHeaders
>>>> -DHAVE_CONFIG_H
>>>> -----
>>>> (Note that the PrivateHeaders directory contains Fileio.h and Defn.h)
>>>>
>>>> My question is,
>>>> How do I write Makevars or congiure for Unix/Linux and Windows?
>>>> I would like to support those platforms in my library.
>>>
>>> You could try looking into a package that has configure, configure.win
>>> and has built binaries for macosX and windows. Try the package 'rgl'
>>> on CRAN, for example.
>>>
>>>
>>> Hoping this helps,
>>>
>>>
>>> L.
>>>
>>>
>>>
>>>> Regards,
>>>>
>>>> Tadashi Kadowaki
>>>>
>>>>
>>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>


From ripley at stats.ox.ac.uk  Mon Jun  9 20:21:35 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 9 Jun 2008 19:21:35 +0100 (BST)
Subject: [Rd] Makevars or congiure for multi platforms
In-Reply-To: <dcb3073c0806091104o21f52b1g49d4a70074fca272@mail.gmail.com>
References: <27d1e6020806080349v28b60a51vf9661ae726aa8e90@mail.gmail.com>
	<dcb3073c0806081017k7aa4d89bv2f3a4528ac822fb8@mail.gmail.com>
	<alpine.LFD.1.10.0806081949080.8051@gannet.stats.ox.ac.uk>
	<dcb3073c0806091104o21f52b1g49d4a70074fca272@mail.gmail.com>
Message-ID: <alpine.LFD.1.10.0806091919490.13495@gannet.stats.ox.ac.uk>

On Tue, 10 Jun 2008, Tadashi Kadowaki wrote:

> Prof Ripley,
>
> I fixed and uploaded.
>
> However, it is still useful for development of a package that is close
> to R core,
> if Rconfig.h contains all definitions in config.h. If Rconfig
> contained all information,
> I didn't have to refer the private header directory.

But your package can run its own configure to find such things itself. 
Which entries were you wanting to use?

>
> Regards,
>
> Tadashi Kadowaki
>
> 2008/6/9 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
>> Private headers are just that, private.  They are not intended to be
>> available to packages, and not installed by the standard R makefiles on
>> either Unix-alikes or Windows.
>>
>> I don't see it documented that they are available on MacOS X, and will leave
>> it to that platform's maintainers as to why they have been installed on that
>> platform.
>>
>> You need to rewrite your code to use only documented headers and entry
>> points if you intend to distribute it.
>>
>>
>> On Mon, 9 Jun 2008, Tadashi Kadowaki wrote:
>>
>>> Hi, Laurent and Tobias
>>>
>>> Thanks a lot.
>>>
>>> I could make configure script and upload it to r-forge.
>>> https://r-forge.r-project.org/projects/pdf2/
>>> It still works only on mac by default.
>>> For Linux and Windows, it needs additional option like
>>> -----
>>> R CMD INSTALL
>>> --configure-vars="R_INTERNAL_HEADER_DIR=/path/to/src/include"
>>> pdf2/pkg
>>> -----
>>> ,where /path/to/src/include is the directory in the R source.
>>> I didn't check it for Linux and Windows...
>>>
>>> Regards,
>>>
>>> Tadashi Kadowaki
>>>
>>> 2008/6/8 Laurent Gautier <lgautier at gmail.com>:
>>>>
>>>> 2008/6/7  <r-devel-request at r-project.org>:
>>>>>
>>>>> Message: 11
>>>>> Date: Sat, 7 Jun 2008 03:38:23 +0900
>>>>> From: "Tadashi Kadowaki" <tadakado at gmail.com>
>>>>> Subject: [Rd] Makevars or congiure for multi platforms
>>>>> To: r-devel at r-project.org
>>>>> Message-ID:
>>>>>       <dcb3073c0806061138n2f376a24r100f281ae248497a at mail.gmail.com>
>>>>> Content-Type: text/plain; charset=ISO-8859-1
>>>>>
>>>>> Dear all,
>>>>>
>>>>> As previously submitted, I wrote an extending pdf device to embed
>>>>> pop up text and web links.
>>>>> (Patches are available at http://pdf2.r-forge.r-project.org/patches)
>>>>>
>>>>> Now, I'm making a library version of the pdf device.
>>>>> However, with my skill, I'm not sure about writing Makevars or configure
>>>>> file
>>>>> for multi platforms. A following line in Makevars works on my mac,
>>>>> -----
>>>>> PKG_CFLAGS=-I/Library/Frameworks/R.framework/PrivateHeaders
>>>>> -DHAVE_CONFIG_H
>>>>> -----
>>>>> (Note that the PrivateHeaders directory contains Fileio.h and Defn.h)
>>>>>
>>>>> My question is,
>>>>> How do I write Makevars or congiure for Unix/Linux and Windows?
>>>>> I would like to support those platforms in my library.
>>>>
>>>> You could try looking into a package that has configure, configure.win
>>>> and has built binaries for macosX and windows. Try the package 'rgl'
>>>> on CRAN, for example.
>>>>
>>>>
>>>> Hoping this helps,
>>>>
>>>>
>>>> L.
>>>>
>>>>
>>>>
>>>>> Regards,
>>>>>
>>>>> Tadashi Kadowaki
>>>>>
>>>>>
>>>>>
>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>> --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From jmc at r-project.org  Mon Jun  9 20:35:46 2008
From: jmc at r-project.org (John Chambers)
Date: Mon, 09 Jun 2008 14:35:46 -0400
Subject: [Rd] R CMD CHECK WARNING inappropriate for S4 method?
In-Reply-To: <6phd4mr7fd7.fsf@lamprey.fhcrc.org>
References: <6phd4mr7fd7.fsf@lamprey.fhcrc.org>
Message-ID: <484D7802.3060804@r-project.org>

This one is subtle, and has mostly to do with namespace and imports, 
only secondarily to do with methods.  Bear with a fairly long story.

The description below is for a simple package P1 that imitates the 
pattern of imports in GSEABase.

First, what's generating the warning?  The function undoc() in the tools 
package looks for all the methods defined in the current package, for 
"union" in this case.  In r-devel, that uses the function findMethods().

What it gets is:
 > names(findMethods("union", where = 2))
[1] "ANY#ANY"             "graph#graph"         "testClass#testClass"

(where "testClass" is the new class that P1 is adding.)

What it "normally" gets in these circumstances is:
 > names(findMethods("union", where = 2))
[1] "testClass#testClass"

In the first case, undoc() naturally assumes you created all the methods 
and wants you to document them.

The question, then, is why are you getting the extra methods?

The answer, to the extent I understand it, is that P1 (and GSEABase) 
used the
  Imports:graph
directive in the DESCRIPTION file, instead of explicitly doing the 
import() commands in the NAMESPACE file.  Just what this does 
differently  I'm not sure, but the effect is that the generic version of 
union() in the "graph" package is no longer in the imports environment 
for package P1:

 > n1 = asNamespace("P1")
 > objects(parent.env(n1), all=TRUE, pattern="union")
character(0)

The result is that P1 owns the union() generic and all its methods.  In 
particular, a generic function "union" is created in P1.

The alternative way to specify the imports is to use the NAMESPACE file, 
say with:

import(graph)

Package "graph" must be added to the Depends: line of the DESCRIPTION 
file, instead of being in the Imports: line.  (Otherwise, you still get 
the new generic, owning all the methods.)

Now the generic version of union() is in the imports environment for P1; 
the setMethod() call in P1 does not create a new generic.  We can see 
this by:
 > n1 = asNamespace("P1")
 > objects(parent.env(n1), all=TRUE, pattern="union")
[1] ".__M__union:base" ".__T__union:base" "union"          


One final catch: In this version, you do need to ensure that the user's 
call to union() sees the generic version at run time, and not the 
nongeneric version in base.  Either require(graph) or, in P1's NAMESPACE:

export(union)

Perhaps needless to say, this is all a bit more subtle than one would like.

John





Martin Morgan wrote:
> The package 'graph' defines classes graph and graphNEL (extending
> graph) and a union,graph,graph-method. These are all exported and
> fully documented.
>
> The package 'GSEABase' Imports: graph and importClassesFrom(graph,
> graphNEL). GSEABase defines methods on union for its own classes (not
> graph / graphNEL), and has exportMethods(union).
> union,graph,graph-method is not used in GSEABase.
>
> R version 2.8.0 Under development (unstable) (2008-06-08 r45879)
> reports from R CMD CHECK GSEABase
>
> * checking for missing documentation entries ... WARNING
> Undocumented S4 methods:
>   generic 'union' and siglist 'graph,graph'
>
> I guess union,graph,graph-method is exposed to the user indirectly by
> its import along with the graph class and export along with the
> newly-defined union methods.
>
> It would seem inappropriate to document union,graph,graph-method in
> GSEABase. Making GSEABase Depend: graph rather than Import: graph does
> not help.
>
> Any guidance welcome.
>
> Thanks,
>
> Martin
>


From usickim at ewha.ac.kr  Mon Jun  9 10:15:04 2008
From: usickim at ewha.ac.kr (usickim at ewha.ac.kr)
Date: Mon,  9 Jun 2008 10:15:04 +0200 (CEST)
Subject: [Rd] error with R 2.7.0 (PR#11609)
Message-ID: <20080609081504.B429F283461A@mail.pubhealth.ku.dk>

Full_Name: Usic Kim
Version: 2.7.0.
OS: Windows XP, Windows Vista Home ed.
Submission from: (NULL) (203.255.173.162)


I installed R 2.7.0 in my PC with Windows XP Professional (in the Korean
language), and tried to start it by double-clicking the icon. I could see a wide
rectangle appearing but soon faced an error message saying Rgui.exe has kind of
"exception", or Rgui front-end has some problem. I also tried this with other PC
with Windows Vista Home edition (also in the Korean language). I tried the same
with "R 2.7.0 patched", and got the same problem. I had no problem with earlier
versions of R.


From mtmorgan at fhcrc.org  Mon Jun  9 21:51:08 2008
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Mon, 09 Jun 2008 12:51:08 -0700
Subject: [Rd] R CMD CHECK WARNING inappropriate for S4 method?
In-Reply-To: <484D7802.3060804@r-project.org> (John Chambers's message of
	"Mon, 09 Jun 2008 14:35:46 -0400")
References: <6phd4mr7fd7.fsf@lamprey.fhcrc.org>
	<484D7802.3060804@r-project.org>
Message-ID: <6phprqq1j6b.fsf@lamprey.fhcrc.org>

Thank you for the assistance.

I moved graph from Imports to Depends (arguably appropriate anyway, as
the reason for graph is that GSEABase defines setAs(..., "graphNEL"))
added importFrom(graph, union) to NAMESPACE, and removed
setGeneric("union", ...) in GSEABase; union was already being exported
from GSEABase.

For information, this has the consequence of invalidating what I
thought was 'careful' code invoking GSEABase::union(), since the union
I want is now graph::union (moderately inexplicable to users who
though they were dealing with gene sets and not graphs; and different
from GSEABase::intersect, which graph does not provide a generic
for). Mostly the user will never know, as unqualified 'union' or
'intersect' work appropriately.

Thanks again

Martin

John Chambers <jmc at r-project.org> writes:

> This one is subtle, and has mostly to do with namespace and imports,
> only secondarily to do with methods.  Bear with a fairly long story.
>
> The description below is for a simple package P1 that imitates the
> pattern of imports in GSEABase.
>
> First, what's generating the warning?  The function undoc() in the
> tools package looks for all the methods defined in the current
> package, for "union" in this case.  In r-devel, that uses the function
> findMethods().
>
> What it gets is:
>  > names(findMethods("union", where = 2))
> [1] "ANY#ANY"             "graph#graph"         "testClass#testClass"
>
> (where "testClass" is the new class that P1 is adding.)
>
> What it "normally" gets in these circumstances is:
>  > names(findMethods("union", where = 2))
> [1] "testClass#testClass"
>
> In the first case, undoc() naturally assumes you created all the
> methods and wants you to document them.
>
> The question, then, is why are you getting the extra methods?
>
> The answer, to the extent I understand it, is that P1 (and GSEABase)
> used the
>   Imports:graph
> directive in the DESCRIPTION file, instead of explicitly doing the
> import() commands in the NAMESPACE file.  Just what this does
> differently  I'm not sure, but the effect is that the generic version
> of union() in the "graph" package is no longer in the imports
> environment for package P1:
>
>  > n1 = asNamespace("P1")
>  > objects(parent.env(n1), all=TRUE, pattern="union")
> character(0)
>
> The result is that P1 owns the union() generic and all its methods.
> In particular, a generic function "union" is created in P1.
>
> The alternative way to specify the imports is to use the NAMESPACE
> file, say with:
>
> import(graph)
>
> Package "graph" must be added to the Depends: line of the DESCRIPTION
> file, instead of being in the Imports: line.  (Otherwise, you still
> get the new generic, owning all the methods.)
>
> Now the generic version of union() is in the imports environment for
> P1; the setMethod() call in P1 does not create a new generic.  We can
> see this by:
>  > n1 = asNamespace("P1")
>  > objects(parent.env(n1), all=TRUE, pattern="union")
> [1] ".__M__union:base" ".__T__union:base" "union"          
>
>
> One final catch: In this version, you do need to ensure that the
> user's call to union() sees the generic version at run time, and not
> the nongeneric version in base.  Either require(graph) or, in P1's
> NAMESPACE:
>
> export(union)
>
> Perhaps needless to say, this is all a bit more subtle than one would like.
>
> John
>
>
>
>
>
> Martin Morgan wrote:
>> The package 'graph' defines classes graph and graphNEL (extending
>> graph) and a union,graph,graph-method. These are all exported and
>> fully documented.
>>
>> The package 'GSEABase' Imports: graph and importClassesFrom(graph,
>> graphNEL). GSEABase defines methods on union for its own classes (not
>> graph / graphNEL), and has exportMethods(union).
>> union,graph,graph-method is not used in GSEABase.
>>
>> R version 2.8.0 Under development (unstable) (2008-06-08 r45879)
>> reports from R CMD CHECK GSEABase
>>
>> * checking for missing documentation entries ... WARNING
>> Undocumented S4 methods:
>>   generic 'union' and siglist 'graph,graph'
>>
>> I guess union,graph,graph-method is exposed to the user indirectly by
>> its import along with the graph class and export along with the
>> newly-defined union methods.
>>
>> It would seem inappropriate to document union,graph,graph-method in
>> GSEABase. Making GSEABase Depend: graph rather than Import: graph does
>> not help.
>>
>> Any guidance welcome.
>>
>> Thanks,
>>
>> Martin
>>   

-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M2 B169
Phone: (206) 667-2793


From maechler at stat.math.ethz.ch  Mon Jun  9 22:45:23 2008
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 9 Jun 2008 22:45:23 +0200
Subject: [Rd] Posting Guide - help.request() function?
In-Reply-To: <484D587D.9040101@warwick.ac.uk>
References: <971536df0806061030i75474172xff100ece76a23eec@mail.gmail.com>
	<971536df0806070638w48afb954y77278659edd37802@mail.gmail.com>
	<971536df0806071024x688e1bcfvac6a1c8a43182170@mail.gmail.com>
	<484D3F9D.7010404@warwick.ac.uk>
	<971536df0806090818l7acc330cy51746b3f815b9a7a@mail.gmail.com>
	<484D587D.9040101@warwick.ac.uk>
Message-ID: <18509.38499.830075.619012@cmath-5.math.ethz.ch>

>>>>> "HT" == Heather Turner <Heather.Turner at warwick.ac.uk>
>>>>>     on Mon, 09 Jun 2008 17:21:17 +0100 writes:

    HT> Thanks for the helpful tips and suggestions, I'll work
    HT> them in. You get local versions of the documents on Unix
    HT> too - RShowDoc() will do the trick.

    HT> I'll post an updated version in due course,

Thank you, Heather and Gabor (and the other contributors).
Indeed, I too like the idea of providing a new R function for
this.
Ideally, Heather, you'd try to "factor out" some of the common
functionality of bug.report() and help.request() into a few
utils-namespace hidden auxiliary functions.

Ideally, you'd attach text/plain attachments (base64 encoded) so
there won't be line wrap arounds.

Martin



    HT> Gabor Grothendieck wrote:
    >> That's an excellent idea.
    >> 
    >> One other item that could be checkable would be if the
    >> user has the most recent versions of the packages
    >> involved in the query.  Perhaps it could display the
    >> unupdated packages and ask the user if any of those are
    >> involved in the query.
    >> 
    >> Probably needs to give fair warning that it is sending
    >> off an email so people don't wind up sending out emails
    >> when they are really just trying out the system.
    >> Probably "none" should be the default for email so that
    >> its not regarded as obnoxious.
    >> 
    >> Might be nice if it used local versions of documents if
    >> they exist locally.  On Windows they do.
    >> 
    >> Check out ?getRversion
    >> 
    >> On Mon, Jun 9, 2008 at 10:35 AM, Dr Heather Turner
    >> <Heather.Turner at warwick.ac.uk> wrote:
    >>> Whilst it is a good idea to improve the posting guide,
    >>> it seems to me that it would be useful to have a
    >>> function along the lines of bug.report(), to help a
    >>> potential questioner make sure they have done their
    >>> homework and have the relevant information to put into a
    >>> post to R-help.
    >>> 
    >>> Even those of us who know what ought to go into a post
    >>> can sometimes forget to check something obvious - I
    >>> recently got caught out by not checking an error was
    >>> reproducible in the patched version for example.
    >>> 
    >>> So I have written a help.request() function (see below),
    >>> which - prompts the user to check the relevant
    >>> resources, stopping and opening the relevant url where
    >>> necessary - checks their R version is up-to-date (in a
    >>> rather messy way - please suggest improvements!)  -
    >>> prompts them to prepare appropriate example code and
    >>> test it in a fresh R session - prompts them to give a
    >>> meaningful subject line - automatically adds system info
    >>> to the post (as in bug.report) - sends the message for
    >>> them (ensuring a fresh thread is started)
    >>> 
    >>> Is this an idea worth taking further? I would be happy
    >>> to make improvements as suggested and write a help file
    >>> if so.
    >>> 
    >>> Heather
    >>> 
    >>> ------------------------------------------------------------
    >>> 
    >>> help.request <- function (subject = "", ccaddress =
    >>> Sys.getenv("USER"), method = getOption("mailer"),
    >>> address = "r-help at R-project.org", file =
    >>> "R.help.request") { no <- function(answer) answer == "n"
    >>> yes <- function(answer) answer == "y" go <-
    >>> function(url) { cat("Please do this first - the site has
    >>> been loaded in your web browser\n") browseURL(url) }
    >>> cat("Checklist:\n") post <- readline("Have you read the
    >>> posting guide? (y/n) ") if (no(post))
    >>> return(go("http://www.r-project.org/posting-guide.html"))
    >>> FAQ <- readline("Have you checked the FAQ? (y/n) ") if
    >>> (no(FAQ))
    >>> return(go("http://cran.r-project.org/faqs.html")) intro
    >>> <- readline("Have you checked An Introduction to R?
    >>> (y/n) ") if (no(intro))
    >>> return(go("http://cran.r-project.org/doc/manuals/R-intro.html"))
    >>> NEWS <- readline("Have you checked the NEWS of the
    >>> latest development release? (y/n) ") if (no(NEWS))
    >>> return(go("https://svn.r-project.org/R/trunk/NEWS"))
    >>> rsitesearch <- readline("Have you looked on RSiteSearch?
    >>> (y/n) ") if (no(rsitesearch)) { cat("Please do this
    >>> first - the site has been loaded in your web browser\n")
    >>> return(RSiteSearch(subject)) } inf <- sessionInfo() if
    >>> ("otherPkgs" %in% names(inf)){ other <- readline("You
    >>> have packages other than the base packages loaded.",
    >>> "\nIf your query relates to one of these, have you ",
    >>> "checked any corresponding books/manuals \nand ",
    >>> "considered contacting the package maintainer?  (y/n/NA)
    >>> ") if(no(other)) return("Please do this first.")  }
    >>> 
    >>> man <- url("http://cran.r-project.org/manuals.html") ver
    >>> <- scan(man, what = character(0), sep = "\n", skip = 13,
    >>> nlines = 1, quiet = TRUE) major <-
    >>> as.numeric(substr(ver, start = 18, stop = 18)) minor <-
    >>> as.numeric(substr(ver, start = 20, stop = 22)) if (major
    >>> < as.numeric(R.Version()$major) || minor <
    >>> as.numeric(R.Version()$major)) { update <-
    >>> readline("Your R version is out-of-date, would you like
    >>> to update now? (y/n) ") if (yes(update)) {
    >>> return(go(getOption("repos"))) } } ## To get long
    >>> prompt!  cat("Have you written example code that is\n",
    >>> "- minimal\n - reproducible\n - self-contained\n -
    >>> commented", "\nusing data that is either\n", "-
    >>> constructed by the code\n - loaded by data()\n", "-
    >>> reproduced using dump(\"mydata\", file = \"\")\n") code
    >>> <- readline(paste("have you checked this code in a fresh
    >>> R session", "\n(invoking R with the --vanilla option if
    >>> possible)", "\nand is this code copied to the clipboard?
    >>> (y/n) ")) if (no(code)) return(cat("\nIf your query is
    >>> not directly related to code", "(e.g. a general query
    >>> \nabout R's capabilities),", "email R-help at r-project.org
    >>> directly. ", "\nOtherwise prepare some example code
    >>> first.\n")) change <- readline(paste("Would you like to
    >>> change your subject line:\n", subject, "\nto something
    >>> more meaningful? (y/n) ")) if (yes(change)) subject <-
    >>> readline("Enter subject: \n")
    >>> 
    >>> methods <- c("mailx", "gnudoit", "none", "ess") method
    >>> <- if (is.null(method)) "none" else
    >>> methods[pmatch(method, methods)] body <-
    >>> paste("\\n<<Write your query here, using your example
    >>> code to
    illustrate> ",
    >>> "\\n<<End with your name and affiliation>>\\n\\n\\n\\n",
    >>> "--please do not edit the information below--\\n\\n",
    >>> "Version:\\n ", paste(names(R.version), R.version, sep =
    >>> " = ", collapse = "\\n "), if
    >>> (nzchar(Sys.getenv("R_GUI_APP_VERSION")))
    >>> paste("\\n\\nGUI:\\n R-GUI ",
    >>> Sys.getenv("R_GUI_APP_VERSION"), " (",
    >>> Sys.getenv("R_GUI_APP_REVISION"), ")", sep = "") else
    >>> "", "\\n\\n", "Locale:\\n", Sys.getlocale(), "\\n\\n",
    >>> "Search Path:\\n ", paste(search(), collapse = ", "),
    >>> "\\n", sep = "", collapse = "") if (method == "gnudoit")
    >>> { cmd <- paste("gnudoit -q '", "(mail nil \"", address,
    >>> "\")", "(insert \"", body, "\")", "(search-backward
    >>> \"Subject:\")", "(end-of-line)'", sep = "") system(cmd)
    >>> } else if (method == "none") { disclaimer <- paste("#
    >>> Your mailer is set to \"none\" (default on Windows),\n",
    >>> "# hence we cannot send the help request directly from
    >>> R.\n", "# Please copy the help request (after finishing
    >>> it) to\n", "# your favorite email program and send it
    >>> to\n#\n", "# ", address, "\n#\n",
    >>> "######################################################\n",
    >>> "\n\n", sep = "") cat(disclaimer, file = file) body <-
    >>> gsub("\\\\n", "\n", body) cat(body, file = file, append
    >>> = TRUE) cat("Please edit the help request.\n")
    >>> system(paste(getOption("editor"), file)) cat("The unsent
    >>> help request can be found in file", file, "\n") } else
    >>> if (method == "mailx") { if (missing(subject))
    >>> stop("'subject' missing") body <- gsub("\\\\n", "\n",
    >>> body) cat(body, file = file, append = FALSE) cat("Please
    >>> edit the help request.\n")
    >>> system(paste(getOption("editor"), file)) if
    >>> (is.character(ccaddress) && nzchar(ccaddress)) { cmdargs
    >>> <- paste("-s '", subject, "' -c", ccaddress, address,
    >>> "<", file, "2>/dev/null") } else cmdargs <- paste("-s
    >>> '", subject, "'", address, "<", file, "2>/dev/null")
    >>> status <- 1 cat("Submit the help request? ") answer <-
    >>> readline() answer <- grep("y", answer, ignore.case =
    >>> TRUE) if (length(answer) > 0) { cat("Sending email
    >>> ...\n") status <- system(paste("mailx", cmdargs)) if
    >>> (status > 0) status <- system(paste("Mail", cmdargs)) if
    >>> (status > 0) status <- system(paste("/usr/ucb/mail",
    >>> cmdargs)) if (status == 0) unlink(file) else {
    >>> cat("Sending email failed!\n") cat("The unsent help
    >>> request can be found in file", file, "\n") } } else
    >>> cat("The unsent help request can be found in file",
    >>> file, "\n") } else if (method == "ess") { body <-
    >>> gsub("\\\\n", "\n", body) cat(body) } }
    >>> 
    >>> -----------------------------------------------------------------------
    >>> 
    >>> Gabor Grothendieck wrote:
    >>>> Here is another update.  I have added the following:
    >>>> 
    >>>> - info about using a fresh R session.  (In that case
    >>>> ls() output is less essential; however, the developers
    >>>> of sessionInfo() might consider adding that as a
    >>>> default or as an option.)
    >>>> 
    >>>> - questioner should consider use of functions.
    >>>> 
    >>>> - for data use dump(x, file = "") to reproducibly
    >>>> display data or use builtin datasets listed by data()
    >>>> 
    >>>> - minimal versions of slow code should be presented in
    >>>> cases where questioner is looking for faster code.
    >>>> 
    >>>> - we still need to add links to illustrative sample
    >>>> questions in r-help
    >>>> 
    >>>> The following were not added for the reason cited:
    >>>> 
    >>>> - guide is not just for questioners.  Important to
    >>>> distinguish roles of questioner, responder and reader.
    >>>> 
    >>>> - what is to be provided ought to be given a name to
    >>>> make it easier to refer to.  An unlabelled set of
    >>>> points is too vague.  Test framework seems
    >>>> appropriately descriptive.  By giving it a name one can
    >>>> request that a questioner "provide a test framework as
    >>>> defined in the posting guide summary".
    >>>> 
    >>>> - self contained is not implied by reproducible.
    >>>> Reproducible only means that info is available
    >>>> somewhere -- not that its all available right in the
    >>>> questioner's post and all in a manner that is readily
    >>>> accessible.
    >>>> 
    >>>> - focus should be on making data minimal.  Don't like
    >>>> attachments since responder must save them and read
    >>>> them in.  It encourages use of large rather than
    >>>> minimal data sets.
    >>>> 
    >>>> Summary
    >>>> 
    >>>> Surprisingly, the main problem for responders is not to
    >>>> answer the question but to quickly figure out what the
    >>>> question is, reproduce it in their own R session and
    >>>> test their answer.
    >>>> 
    >>>> Test Framework.  To faciliate this provide a test
    >>>> framework of:
    >>>> 
    >>>> (1) minimal reproducible self-contained commented code
    >>>> and data that has been run in a fresh R session.  That
    >>>> means code and data have been cut down as far as
    >>>> possible to the essentials needed to illustrate the
    >>>> problem and were run are just after starting up R.
    >>>> Also it means that its possible for responders to just
    >>>> copy the code and data section from the questioner's
    >>>> post to the clipboard and paste it into their session
    >>>> to see the same output without having to enter even one
    >>>> R command.  In some cases there may be an advantage to
    >>>> present the code as a function and in the case of
    >>>> needing a speedup be sure to post a minimal version of
    >>>> the slow code.  Use builtin data sets such as those
    >>>> listed by data() to illustrate problem or reduce your
    >>>> data to a minimum and present it reproducibly by using:
    >>>> dump("mydata", file = "")
    >>>> 
    >>>> (2) comments/explanation of what the code is intended
    >>>> to produce -- Don't assume its obvious!
    >>>> 
    >>>> (3) versions of all software used, e.g. sessionInfo(),
    >>>> or R.version.string; packageDescription("zoo")$Version
    >>>> 
    >>>> Without self-contained reproducible code the responder
    >>>> must not only understand the question but must also
    >>>> create a test framework and that typically takes more
    >>>> time than answering the question!  Its not fair to ask
    >>>> the responder to provide all that on top of answering
    >>>> the question.  Do NOT assume the problem is so simple
    >>>> that it is not necessary.
    >>>> 
    >>>> Effort. The effort taken to reduce the problem to its
    >>>> essentials and produce a test framework often solves
    >>>> the problem avoiding the need for a post in the first
    >>>> place.  It at the least shows that the questioner tried
    >>>> to solve it themself.
    >>>> 
    >>>> Subscribers.  The questioner should ensure that the
    >>>> thread is complete and that it has an appropriate
    >>>> Subject.  The purpose of the post is not only to help
    >>>> the questioner but also the other list subscribers and
    >>>> those later searching the archives.
    >>>> 
    >>>> 
    >>>> 
    >>>> 
    >>>> 
    >>>> On Sat, Jun 7, 2008 at 9:38 AM, Gabor Grothendieck
    >>>> <ggrothendieck at gmail.com> wrote:
    >>>>> Here is a second version of the summary.  Its been
    >>>>> rearranged to place most important info at top.  Also
    >>>>> shortened it a bit.
    >>>>> 
    >>>>> It still needs links to example posts, as suggested.
    >>>>> Anyone?
    >>>>> 
    >>>>> Summary
    >>>>> 
    >>>>> Surprisingly, the main problem for responders is not
    >>>>> to answer the posted questions but to quickly figure
    >>>>> out what the question is, reproduce it in their own R
    >>>>> session and test their answer.
    >>>>> 
    >>>>> Test Framework.  To faciliate that provide a test
    >>>>> framework of:
    >>>>> 
    >>>>> (1) reproducible self-contained minimal code and data.
    >>>>> That means responders can copy it from the
    >>>>> questioner's post and paste it into their session to
    >>>>> see the same output without having to enter even one R
    >>>>> command.  NB. dput(mydata) produces mydata in
    >>>>> reproducible form.  (2) comments/explanations of what
    >>>>> the code is intended to produce and (3) versions of
    >>>>> all software used, e.g. sessionInfo().
    >>>>> 
    >>>>> Without self-contained reproducible code the responder
    >>>>> must not only understand the question but must also
    >>>>> create a test framework and that typically takes more
    >>>>> time than answering the question!  Its not fair to ask
    >>>>> the responder to provide all that on top of answering
    >>>>> the question.  Do NOT assume the problem is so simple
    >>>>> that it is not necessary.
    >>>>> 
    >>>>> Effort. The effort taken to reduce the problem to its
    >>>>> essentials and produce a test framework often solves
    >>>>> the problem avoiding the need for a post in the first
    >>>>> place.  It at the least shows that the questioner
    >>>>> tried to solve it themself.
    >>>>> 
    >>>>> Subscribers.  The questioner should ensure that the
    >>>>> thread is complete and that it has an appropriate
    >>>>> Subject.  The purpose of the post is not only to help
    >>>>> the questioner but also the other list subscribers and
    >>>>> those later searching the archives.
    >>>>> 
    >>>>> 
    >>>>> 
    >>>>> On Fri, Jun 6, 2008 at 1:30 PM, Gabor Grothendieck
    >>>>> <ggrothendieck at gmail.com> wrote:
>>>>> People read the posting guide yet they are still unable to
    >>>>> create an
>>>>> acceptable
>>>>> post. e.g.
>>>>> https://stat.ethz.ch/pipermail/r-help/2008-June/164092.html
    >>>>>> 
>>>>> I think the problem is that the guide is not clear or
    >>>>>> concise enough.
>>>>> I suggest we add a summary at the beginning which gets to
    >>>>>> the heart
>>>>> of what a poster is expected to provide:
    >>>>>> 
>>>>> Summary
    >>>>>> 
>>>>> To maximize your change of getting a response when posting
    >>>>>> provide (1)
>>>>> commented,
>>>>> (2) minimal, (3) self-contained and (4) reproducible code.
    >>>>>> (This one
>>>>> line summary
>>>>> also appears at the end of each message to r-help.)
    >>>>>> 
>>>>> "Self-contained" and "reproducible" mean that a responder
    >>>>>> can copy the
>>>>> questioner's code to
>>>>> the clipboard, paste it into their R session and see the
    >>>>>> same problem
>>>>> you as the questioner
>>>>> see.  Note that dput(mydata) will display mydata in a
    >>>>>> reproducible way.
>>>>> Self-contained and reproducible are needed because:
>>>>> (1) Self-Effort. It shows that the questioner tried to
    >>>>>> solve the
>>>>> problem by themself first.
>>>>> (2) Test framework. Often the responder needs to play with
    >>>>>> the code a
>>>>> bit in order to respond
>>>>> or at least to give the best answer.  They can't do that
    >>>>>> without a
>>>>> test framework that includes
>>>>> the data and the code to run it and its not fair to ask
    >>>>>> them to not
>>>>> only answer the question but
>>>>> also to come up with test data and to complete incomplete
    >>>>>> code.
>>>>> (3) Archives. Questions and answers go into the archives
    >>>>>> so they are
>>>>> not only for the benefit of
>>>>> of the questioner but also for the benefit of all future
    >>>>>> searchers of
>>>>> the archive.  That means
>>>>> that its not finished if you have solved the problem for
    >>>>>> yourself.
>>>>> You still need to ensure that
>>>>> the thread has a complete solution. (For that reason its
    >>>>>> also
>>>>> important to give a meaningful
>>>>> subject to each post.)
    >>>>>> 
>>>>> "Commented" and "minimal" also reduce the time it takes to
    >>>>>> understand
>>>>> the problem.
>>>>> Don't just dump your code as is into the message since you
    >>>>>> are just
>>>>> wasting your own
>>>>> time. Its not likely anyone will answer a message if the
    >>>>>> questioner
>>>>> has not taken the
>>>>> time to reduce it to its essential elements.
    >>>>>> Surprisingly, quite
>>>>> often understanding what
>>>>> the problem is takes the responder most of the time -- not
    >>>>>> solving the
>>>>> problem. Once the
>>>>> question is actually understood its often quite fast to
    >>>>>> answer.  Thus
>>>>> in addition to posting
>>>>> it in a minimal form, comment on it sufficiently so that
    >>>>>> the responder
>>>>> knows what the code
>>>>> does and is intended to produce.  It may be obvious to the
    >>>>>> questioner
>>>>> who is embroiled in
>>>>> the problem but that does not mean its obvious to others.
    >>>>>> 
>>>>> Introduction
    >>>>>> 
>>>>> .... rest of posting guide ...
    >>>>>> 
    >>>> ______________________________________________
    >>>> R-devel at r-project.org mailing list
    >>>> https://stat.ethz.ch/mailman/listinfo/r-devel
    >>> --
    >>> Dr H Turner Research Fellow Dept. of Statistics The
    >>> University of Warwick Coventry CV4 7AL
    >>> 
    >>> Tel: 024 76575870 Fax: 024 76524532 Url:
    >>> www.warwick.ac.uk/go/heatherturner
    >>> 

-- 
Dr H Turner
    HT> Research Fellow Dept. of Statistics The University of
    HT> Warwick Coventry CV4 7AL

    HT> Tel: 024 76575870 Fax: 024 76524532 Url:
    HT> www.warwick.ac.uk/go/heatherturner

    HT> ______________________________________________
    HT> R-devel at r-project.org mailing list
    HT> https://stat.ethz.ch/mailman/listinfo/r-devel


From lgautier at gmail.com  Tue Jun 10 06:23:34 2008
From: lgautier at gmail.com (Laurent Gautier)
Date: Tue, 10 Jun 2008 06:23:34 +0200
Subject: [Rd] Error in "getClass" when calling the function "show"
Message-ID: <27d1e6020806092123v16e25f38hf1739d486fda232d@mail.gmail.com>

Dear List,

Calling "show" on an object of class "summary.lm" gives:
Error in getClass(class(object)) : "summary.lm" is not a defined class

Is this a miss on my end ?


> x <- seq(1, 10)
> show(x)
 [1]  1  2  3  4  5  6  7  8  9 10
> y <- runif(10)
> fit <- lm(y ~ x)
> show(fit)

Call:
lm(formula = y ~ x)

Coefficients:
(Intercept)            x
    1.04938     -0.08869

> show(summary(fit))
Error in getClass(class(object)) : "summary.lm" is not a defined class
> class(summary(fit))
[1] "summary.lm"
> class((fit))
[1] "lm"
> getClass("lm")
Virtual Class

No Slots, prototype of class "S4"

Extends: "oldClass"

Known Subclasses:
Class "mlm", directly
Class "aov", directly
Class "glm", directly
Class "maov", by class "mlm", distance 2
Class "glm.null", by class "glm", distance 2
> getClass("summary.lm")
Error in getClass("summary.lm") : "summary.lm" is not a defined class
>
> sessionInfo()
R version 2.7.0 Patched (2008-06-07 r45877)
i686-pc-linux-gnu

locale:
LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base


Laurent


From ripley at stats.ox.ac.uk  Tue Jun 10 08:03:36 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 10 Jun 2008 07:03:36 +0100 (BST)
Subject: [Rd] Error in "getClass" when calling the function "show"
In-Reply-To: <27d1e6020806092123v16e25f38hf1739d486fda232d@mail.gmail.com>
References: <27d1e6020806092123v16e25f38hf1739d486fda232d@mail.gmail.com>
Message-ID: <alpine.LFD.1.10.0806100659010.28008@gannet.stats.ox.ac.uk>

showDefault has

     clDef <- getClass(class(object))

Looks like the showDefault code intended

     clDef <- getClass(class(object), .force=TRUE)

However, why are you calling show() on a non-S4 object?  I cannot see any 
advtanges in doing so.

On Tue, 10 Jun 2008, Laurent Gautier wrote:

> Dear List,
>
> Calling "show" on an object of class "summary.lm" gives:
> Error in getClass(class(object)) : "summary.lm" is not a defined class
>
> Is this a miss on my end ?
>
>
>> x <- seq(1, 10)
>> show(x)
> [1]  1  2  3  4  5  6  7  8  9 10
>> y <- runif(10)
>> fit <- lm(y ~ x)
>> show(fit)
>
> Call:
> lm(formula = y ~ x)
>
> Coefficients:
> (Intercept)            x
>    1.04938     -0.08869
>
>> show(summary(fit))
> Error in getClass(class(object)) : "summary.lm" is not a defined class
>> class(summary(fit))
> [1] "summary.lm"
>> class((fit))
> [1] "lm"
>> getClass("lm")
> Virtual Class
>
> No Slots, prototype of class "S4"
>
> Extends: "oldClass"
>
> Known Subclasses:
> Class "mlm", directly
> Class "aov", directly
> Class "glm", directly
> Class "maov", by class "mlm", distance 2
> Class "glm.null", by class "glm", distance 2
>> getClass("summary.lm")
> Error in getClass("summary.lm") : "summary.lm" is not a defined class
>>
>> sessionInfo()
> R version 2.7.0 Patched (2008-06-07 r45877)
> i686-pc-linux-gnu
>
> locale:
> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
>
> Laurent
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From lgautier at gmail.com  Tue Jun 10 09:20:11 2008
From: lgautier at gmail.com (Laurent Gautier)
Date: Tue, 10 Jun 2008 09:20:11 +0200
Subject: [Rd] Error in "getClass" when calling the function "show"
In-Reply-To: <alpine.LFD.1.10.0806100659010.28008@gannet.stats.ox.ac.uk>
References: <27d1e6020806092123v16e25f38hf1739d486fda232d@mail.gmail.com>
	<alpine.LFD.1.10.0806100659010.28008@gannet.stats.ox.ac.uk>
Message-ID: <27d1e6020806100020l4bcb3645n88f3b4ebc968eee6@mail.gmail.com>

2008/6/10 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
> showDefault has
>
>    clDef <- getClass(class(object))
>
> Looks like the showDefault code intended
>
>    clDef <- getClass(class(object), .force=TRUE)
>
> However, why are you calling show() on a non-S4 object?  I cannot see any
> advtanges in doing so.

I'd like *one* printing method for all objects, and the generic "show"
is registered as working for ANYthing (see below) ?
Or is defining one's own function currently recommended ?

myPrint <- function(x, ...)
{
  if (isS4(x)) {
    show(x, ...)
  } else {
    print(x, ...)
  }
}

> showMethods("show")
Function: show (package methods)
object="ANY"
object="classRepresentation"
object="derivedDefaultMethod"
    (inherited from: object="MethodDefinition")
object="function"
    (inherited from: object="ANY")
object="genericFunction"
object="MethodDefinition"
object="MethodsList"
    (inherited from: object="ANY")
object="MethodWithNext"
object="ObjectsWithPackage"
object="signature"
object="traceable"

> showMethods("print")

Function "print":
 <not a generic function>
> getMethod("show", "ANY")
Method Definition (Class "derivedDefaultMethod"):

function (object)
showDefault(object, FALSE)
<environment: namespace:methods>

Signatures:
        object
target  "ANY"
defined "ANY"


> On Tue, 10 Jun 2008, Laurent Gautier wrote:
>
>> Dear List,
>>
>> Calling "show" on an object of class "summary.lm" gives:
>> Error in getClass(class(object)) : "summary.lm" is not a defined class
>>
>> Is this a miss on my end ?
>>
>>
>>> x <- seq(1, 10)
>>> show(x)
>>
>> [1]  1  2  3  4  5  6  7  8  9 10
>>>
>>> y <- runif(10)
>>> fit <- lm(y ~ x)
>>> show(fit)
>>
>> Call:
>> lm(formula = y ~ x)
>>
>> Coefficients:
>> (Intercept)            x
>>   1.04938     -0.08869
>>
>>> show(summary(fit))
>>
>> Error in getClass(class(object)) : "summary.lm" is not a defined class
>>>
>>> class(summary(fit))
>>
>> [1] "summary.lm"
>>>
>>> class((fit))
>>
>> [1] "lm"
>>>
>>> getClass("lm")
>>
>> Virtual Class
>>
>> No Slots, prototype of class "S4"
>>
>> Extends: "oldClass"
>>
>> Known Subclasses:
>> Class "mlm", directly
>> Class "aov", directly
>> Class "glm", directly
>> Class "maov", by class "mlm", distance 2
>> Class "glm.null", by class "glm", distance 2
>>>
>>> getClass("summary.lm")
>>
>> Error in getClass("summary.lm") : "summary.lm" is not a defined class
>>>
>>> sessionInfo()
>>
>> R version 2.7.0 Patched (2008-06-07 r45877)
>> i686-pc-linux-gnu
>>
>> locale:
>>
>> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>>
>> Laurent
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>


From ripley at stats.ox.ac.uk  Tue Jun 10 09:49:27 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 10 Jun 2008 08:49:27 +0100 (BST)
Subject: [Rd] Error in "getClass" when calling the function "show"
In-Reply-To: <27d1e6020806100020l4bcb3645n88f3b4ebc968eee6@mail.gmail.com>
References: <27d1e6020806092123v16e25f38hf1739d486fda232d@mail.gmail.com>
	<alpine.LFD.1.10.0806100659010.28008@gannet.stats.ox.ac.uk>
	<27d1e6020806100020l4bcb3645n88f3b4ebc968eee6@mail.gmail.com>
Message-ID: <alpine.LFD.1.10.0806100846550.8527@gannet.stats.ox.ac.uk>

On Tue, 10 Jun 2008, Laurent Gautier wrote:

> 2008/6/10 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
>> showDefault has
>>
>>    clDef <- getClass(class(object))
>>
>> Looks like the showDefault code intended
>>
>>    clDef <- getClass(class(object), .force=TRUE)
>>
>> However, why are you calling show() on a non-S4 object?  I cannot see any
>> advtanges in doing so.
>
> I'd like *one* printing method for all objects, and the generic "show"
> is registered as working for ANYthing (see below) ?

print() calls show() for S4 objects (with no additional arguments).

I agree show() ought to do what it is documented to, but calling it on 
non-S4 objects is inefficient.

> Or is defining one's own function currently recommended ?
>
> myPrint <- function(x, ...)
> {
>  if (isS4(x)) {
>    show(x, ...)
>  } else {
>    print(x, ...)
>  }
> }
>
>> showMethods("show")
> Function: show (package methods)
> object="ANY"
> object="classRepresentation"
> object="derivedDefaultMethod"
>    (inherited from: object="MethodDefinition")
> object="function"
>    (inherited from: object="ANY")
> object="genericFunction"
> object="MethodDefinition"
> object="MethodsList"
>    (inherited from: object="ANY")
> object="MethodWithNext"
> object="ObjectsWithPackage"
> object="signature"
> object="traceable"
>
>> showMethods("print")
>
> Function "print":
> <not a generic function>
>> getMethod("show", "ANY")
> Method Definition (Class "derivedDefaultMethod"):
>
> function (object)
> showDefault(object, FALSE)
> <environment: namespace:methods>
>
> Signatures:
>        object
> target  "ANY"
> defined "ANY"
>
>
>> On Tue, 10 Jun 2008, Laurent Gautier wrote:
>>
>>> Dear List,
>>>
>>> Calling "show" on an object of class "summary.lm" gives:
>>> Error in getClass(class(object)) : "summary.lm" is not a defined class
>>>
>>> Is this a miss on my end ?
>>>
>>>
>>>> x <- seq(1, 10)
>>>> show(x)
>>>
>>> [1]  1  2  3  4  5  6  7  8  9 10
>>>>
>>>> y <- runif(10)
>>>> fit <- lm(y ~ x)
>>>> show(fit)
>>>
>>> Call:
>>> lm(formula = y ~ x)
>>>
>>> Coefficients:
>>> (Intercept)            x
>>>   1.04938     -0.08869
>>>
>>>> show(summary(fit))
>>>
>>> Error in getClass(class(object)) : "summary.lm" is not a defined class
>>>>
>>>> class(summary(fit))
>>>
>>> [1] "summary.lm"
>>>>
>>>> class((fit))
>>>
>>> [1] "lm"
>>>>
>>>> getClass("lm")
>>>
>>> Virtual Class
>>>
>>> No Slots, prototype of class "S4"
>>>
>>> Extends: "oldClass"
>>>
>>> Known Subclasses:
>>> Class "mlm", directly
>>> Class "aov", directly
>>> Class "glm", directly
>>> Class "maov", by class "mlm", distance 2
>>> Class "glm.null", by class "glm", distance 2
>>>>
>>>> getClass("summary.lm")
>>>
>>> Error in getClass("summary.lm") : "summary.lm" is not a defined class
>>>>
>>>> sessionInfo()
>>>
>>> R version 2.7.0 Patched (2008-06-07 r45877)
>>> i686-pc-linux-gnu
>>>
>>> locale:
>>>
>>> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>>
>>> Laurent
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>> --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From lgautier at gmail.com  Tue Jun 10 09:58:17 2008
From: lgautier at gmail.com (Laurent Gautier)
Date: Tue, 10 Jun 2008 09:58:17 +0200
Subject: [Rd] Error in "getClass" when calling the function "show"
In-Reply-To: <alpine.LFD.1.10.0806100846550.8527@gannet.stats.ox.ac.uk>
References: <27d1e6020806092123v16e25f38hf1739d486fda232d@mail.gmail.com>
	<alpine.LFD.1.10.0806100659010.28008@gannet.stats.ox.ac.uk>
	<27d1e6020806100020l4bcb3645n88f3b4ebc968eee6@mail.gmail.com>
	<alpine.LFD.1.10.0806100846550.8527@gannet.stats.ox.ac.uk>
Message-ID: <27d1e6020806100058y2a22a796kb319cbe974b649dc@mail.gmail.com>

2008/6/10 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
> On Tue, 10 Jun 2008, Laurent Gautier wrote:
>
>> 2008/6/10 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
>>>
>>> showDefault has
>>>
>>>   clDef <- getClass(class(object))
>>>
>>> Looks like the showDefault code intended
>>>
>>>   clDef <- getClass(class(object), .force=TRUE)
>>>
>>> However, why are you calling show() on a non-S4 object?  I cannot see any
>>> advtanges in doing so.
>>
>> I'd like *one* printing method for all objects, and the generic "show"
>> is registered as working for ANYthing (see below) ?
>
> print() calls show() for S4 objects (with no additional arguments).
>
> I agree show() ought to do what it is documented to, but calling it on
> non-S4 objects is inefficient.

Fair enough.
May be that word of caution could appear in the documentation for "show" then ?

A good place could be where the documentation says:
The 'methods' package overrides the base definition of
'print.default' to arrange for automatic printing to honor methods
for the function 'show'.

which led me to think that "show" is covering more cases than "print" does
(while apparently the opposite is happening with "print" delegating to "show").



Thanks,



Laurent




>> Or is defining one's own function currently recommended ?
>>
>> myPrint <- function(x, ...)
>> {
>>  if (isS4(x)) {
>>   show(x, ...)
>>  } else {
>>   print(x, ...)
>>  }
>> }
>>
>>> showMethods("show")
>>
>> Function: show (package methods)
>> object="ANY"
>> object="classRepresentation"
>> object="derivedDefaultMethod"
>>   (inherited from: object="MethodDefinition")
>> object="function"
>>   (inherited from: object="ANY")
>> object="genericFunction"
>> object="MethodDefinition"
>> object="MethodsList"
>>   (inherited from: object="ANY")
>> object="MethodWithNext"
>> object="ObjectsWithPackage"
>> object="signature"
>> object="traceable"
>>
>>> showMethods("print")
>>
>> Function "print":
>> <not a generic function>
>>>
>>> getMethod("show", "ANY")
>>
>> Method Definition (Class "derivedDefaultMethod"):
>>
>> function (object)
>> showDefault(object, FALSE)
>> <environment: namespace:methods>
>>
>> Signatures:
>>       object
>> target  "ANY"
>> defined "ANY"
>>
>>
>>> On Tue, 10 Jun 2008, Laurent Gautier wrote:
>>>
>>>> Dear List,
>>>>
>>>> Calling "show" on an object of class "summary.lm" gives:
>>>> Error in getClass(class(object)) : "summary.lm" is not a defined class
>>>>
>>>> Is this a miss on my end ?
>>>>
>>>>
>>>>> x <- seq(1, 10)
>>>>> show(x)
>>>>
>>>> [1]  1  2  3  4  5  6  7  8  9 10
>>>>>
>>>>> y <- runif(10)
>>>>> fit <- lm(y ~ x)
>>>>> show(fit)
>>>>
>>>> Call:
>>>> lm(formula = y ~ x)
>>>>
>>>> Coefficients:
>>>> (Intercept)            x
>>>>  1.04938     -0.08869
>>>>
>>>>> show(summary(fit))
>>>>
>>>> Error in getClass(class(object)) : "summary.lm" is not a defined class
>>>>>
>>>>> class(summary(fit))
>>>>
>>>> [1] "summary.lm"
>>>>>
>>>>> class((fit))
>>>>
>>>> [1] "lm"
>>>>>
>>>>> getClass("lm")
>>>>
>>>> Virtual Class
>>>>
>>>> No Slots, prototype of class "S4"
>>>>
>>>> Extends: "oldClass"
>>>>
>>>> Known Subclasses:
>>>> Class "mlm", directly
>>>> Class "aov", directly
>>>> Class "glm", directly
>>>> Class "maov", by class "mlm", distance 2
>>>> Class "glm.null", by class "glm", distance 2
>>>>>
>>>>> getClass("summary.lm")
>>>>
>>>> Error in getClass("summary.lm") : "summary.lm" is not a defined class
>>>>>
>>>>> sessionInfo()
>>>>
>>>> R version 2.7.0 Patched (2008-06-07 r45877)
>>>> i686-pc-linux-gnu
>>>>
>>>> locale:
>>>>
>>>>
>>>> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
>>>>
>>>> attached base packages:
>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>
>>>>
>>>> Laurent
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>> --
>>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>>> University of Oxford,             Tel:  +44 1865 272861 (self)
>>> 1 South Parks Road,                     +44 1865 272866 (PA)
>>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>>
>>
>
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>


From jmc at r-project.org  Tue Jun 10 15:17:19 2008
From: jmc at r-project.org (John Chambers)
Date: Tue, 10 Jun 2008 09:17:19 -0400
Subject: [Rd] Error in "getClass" when calling the function "show"
In-Reply-To: <27d1e6020806100058y2a22a796kb319cbe974b649dc@mail.gmail.com>
References: <27d1e6020806092123v16e25f38hf1739d486fda232d@mail.gmail.com>	<alpine.LFD.1.10.0806100659010.28008@gannet.stats.ox.ac.uk>	<27d1e6020806100020l4bcb3645n88f3b4ebc968eee6@mail.gmail.com>	<alpine.LFD.1.10.0806100846550.8527@gannet.stats.ox.ac.uk>
	<27d1e6020806100058y2a22a796kb319cbe974b649dc@mail.gmail.com>
Message-ID: <484E7EDF.4020002@r-project.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080610/6abbfbd7/attachment.pl>

From maechler at stat.math.ethz.ch  Tue Jun 10 15:22:56 2008
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 10 Jun 2008 15:22:56 +0200
Subject: [Rd] Error in "getClass" when calling the function "show"
In-Reply-To: <27d1e6020806100058y2a22a796kb319cbe974b649dc@mail.gmail.com>
References: <27d1e6020806092123v16e25f38hf1739d486fda232d@mail.gmail.com>
	<alpine.LFD.1.10.0806100659010.28008@gannet.stats.ox.ac.uk>
	<27d1e6020806100020l4bcb3645n88f3b4ebc968eee6@mail.gmail.com>
	<alpine.LFD.1.10.0806100846550.8527@gannet.stats.ox.ac.uk>
	<27d1e6020806100058y2a22a796kb319cbe974b649dc@mail.gmail.com>
Message-ID: <18510.32816.696792.688141@stat.math.ethz.ch>

>>>>> "LG" == Laurent Gautier <lgautier at gmail.com>
>>>>>     on Tue, 10 Jun 2008 09:58:17 +0200 writes:

    LG> 2008/6/10 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
    >> On Tue, 10 Jun 2008, Laurent Gautier wrote:
    >> 
    >>> 2008/6/10 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
    >>>> 
    >>>> showDefault has
    >>>> 
    >>>> clDef <- getClass(class(object))
    >>>> 
    >>>> Looks like the showDefault code intended
    >>>> 
    >>>> clDef <- getClass(class(object), .force=TRUE)
    >>>> 
    >>>> However, why are you calling show() on a non-S4 object?
    >>>> I cannot see any advtanges in doing so.
    >>> 
    >>> I'd like *one* printing method for all objects, and the
    >>> generic "show" is registered as working for ANYthing
    >>> (see below) ?
    >> 
    >> print() calls show() for S4 objects (with no additional
    >> arguments).
    >> 
    >> I agree show() ought to do what it is documented to, but
    >> calling it on non-S4 objects is inefficient.

In any case, the buglet that Laurent reported  has now been
fixed in R-patched and R-devel, using  ", .Force = TRUE "
almost as Brian Ripley had proposed.

Martin

    LG> Fair enough.  May be that word of caution could appear
    LG> in the documentation for "show" then ?

    LG> A good place could be where the documentation says: The
    LG> 'methods' package overrides the base definition of
    LG> 'print.default' to arrange for automatic printing to
    LG> honor methods for the function 'show'.

    LG> which led me to think that "show" is covering more cases
    LG> than "print" does (while apparently the opposite is
    LG> happening with "print" delegating to "show").



    LG> Thanks,



    LG> Laurent




    >>> Or is defining one's own function currently recommended
    >>> ?
    >>> 
    >>> myPrint <- function(x, ...)  { if (isS4(x)) { show(x,
    >>> ...)  } else { print(x, ...)  } }
    >>> 
    >>>> showMethods("show")
    >>> 
    >>> Function: show (package methods) object="ANY"
    >>> object="classRepresentation"
    >>> object="derivedDefaultMethod" (inherited from:
    >>> object="MethodDefinition") object="function" (inherited
    >>> from: object="ANY") object="genericFunction"
    >>> object="MethodDefinition" object="MethodsList"
    >>> (inherited from: object="ANY") object="MethodWithNext"
    >>> object="ObjectsWithPackage" object="signature"
    >>> object="traceable"
    >>> 
    >>>> showMethods("print")
    >>> 
    >>> Function "print": <not a generic function>
    >>>> 
    >>>> getMethod("show", "ANY")
    >>> 
    >>> Method Definition (Class "derivedDefaultMethod"):
    >>> 
    >>> function (object) showDefault(object, FALSE)
    >>> <environment: namespace:methods>
    >>> 
    >>> Signatures: object target "ANY" defined "ANY"
    >>> 
    >>> 
    >>>> On Tue, 10 Jun 2008, Laurent Gautier wrote:
    >>>> 
    >>>>> Dear List,
    >>>>> 
    >>>>> Calling "show" on an object of class "summary.lm"
    >>>>> gives: Error in getClass(class(object)) : "summary.lm"
    >>>>> is not a defined class
    >>>>> 
    >>>>> Is this a miss on my end ?
    >>>>> 
    >>>>> 
>>>>> x <- seq(1, 10)
>>>>> show(x)
    >>>>> 
    >>>>> [1] 1 2 3 4 5 6 7 8 9 10
    >>>>>> 
>>>>> y <- runif(10)
>>>>> fit <- lm(y ~ x)
>>>>> show(fit)
    >>>>> 
    >>>>> Call: lm(formula = y ~ x)
    >>>>> 
    >>>>> Coefficients: (Intercept) x 1.04938 -0.08869
    >>>>> 
>>>>> show(summary(fit))
    >>>>> 
    >>>>> Error in getClass(class(object)) : "summary.lm" is not
    >>>>> a defined class
    >>>>>> 
>>>>> class(summary(fit))
    >>>>> 
    >>>>> [1] "summary.lm"
    >>>>>> 
>>>>> class((fit))
    >>>>> 
    >>>>> [1] "lm"
    >>>>>> 
>>>>> getClass("lm")
    >>>>> 
    >>>>> Virtual Class
    >>>>> 
    >>>>> No Slots, prototype of class "S4"
    >>>>> 
    >>>>> Extends: "oldClass"
    >>>>> 
    >>>>> Known Subclasses: Class "mlm", directly Class "aov",
    >>>>> directly Class "glm", directly Class "maov", by class
    >>>>> "mlm", distance 2 Class "glm.null", by class "glm",
    >>>>> distance 2
    >>>>>> 
>>>>> getClass("summary.lm")
    >>>>> 
    >>>>> Error in getClass("summary.lm") : "summary.lm" is not
    >>>>> a defined class
    >>>>>> 
>>>>> sessionInfo()
    >>>>> 
    >>>>> R version 2.7.0 Patched (2008-06-07 r45877)
    >>>>> i686-pc-linux-gnu
    >>>>> 
    >>>>> locale:
    >>>>> 
    >>>>> 
    >>>>> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
    >>>>> 
    >>>>> attached base packages: [1] stats graphics grDevices
    >>>>> utils datasets methods base
    >>>>> 
    >>>>> 
    >>>>> Laurent
    >>>>> 
    >>>>> ______________________________________________
    >>>>> R-devel at r-project.org mailing list
    >>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
    >>>>> 
    >>>> 
>>> --
>>> Brian D. Ripley, ripley at stats.ox.ac.uk Professor of Applied
    >>>> Statistics, http://www.stats.ox.ac.uk/~ripley/
    >>>> University of Oxford, Tel: +44 1865 272861 (self) 1
    >>>> South Parks Road, +44 1865 272866 (PA) Oxford OX1 3TG,
    >>>> UK Fax: +44 1865 272595
    >>>> 
    >>> 
>
> --
> Brian D. Ripley, ripley at stats.ox.ac.uk
    >> Professor of Applied Statistics,
    >> http://www.stats.ox.ac.uk/~ripley/ University of Oxford,
    >> Tel: +44 1865 272861 (self) 1 South Parks Road, +44 1865
    >> 272866 (PA) Oxford OX1 3TG, UK Fax: +44 1865 272595
    >> 

______________________________________________
    LG> R-devel at r-project.org mailing list
    LG> https://stat.ethz.ch/mailman/listinfo/r-devel


From ripley at stats.ox.ac.uk  Tue Jun 10 15:44:10 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 10 Jun 2008 14:44:10 +0100 (BST)
Subject: [Rd] Error in "getClass" when calling the function "show"
In-Reply-To: <484E7EDF.4020002@r-project.org>
References: <27d1e6020806092123v16e25f38hf1739d486fda232d@mail.gmail.com>
	<alpine.LFD.1.10.0806100659010.28008@gannet.stats.ox.ac.uk>
	<27d1e6020806100020l4bcb3645n88f3b4ebc968eee6@mail.gmail.com>
	<alpine.LFD.1.10.0806100846550.8527@gannet.stats.ox.ac.uk>
	<27d1e6020806100058y2a22a796kb319cbe974b649dc@mail.gmail.com>
	<484E7EDF.4020002@r-project.org>
Message-ID: <alpine.LFD.1.10.0806101433060.21538@gannet.stats.ox.ac.uk>

On Tue, 10 Jun 2008, John Chambers wrote:

> The function show() is intended as a mechanism for automatic display of
> objects, a vehicle for writing methods that control the automatic display
> of new classes of objects (as noted in its documentation and in
> "Programming with Data").
> 
> That's why, unlike print() or plot(), it has no optional arguments to
> control its behavior.
> 
> That said, it was always intended to call print() for S3 objects, as
> would be obvious from reading the code for showDefault().? It's just a
> glitch that it doesn't, as Brian inferred.? We'll fix it, and your usage
> should then be perfectly OK.? (The relevance of efficiency? when one is
> printing objects for humans to look at is not compelling.)

Not compelling, but there are more hoops to jump through, and hence more 
to fail (as here).  One point that is a little more serious is that show() 
is in methods, and with S3 objects it might be the case that the methods 
package is not loaded and hence show() is not visible.

For completeness, I should point out that you can define S4 methods for 
print() and S4 methods for show() for S3 classes.  If you do that, things 
may not work consistently (not least because you will have an S4 generic 
'print' that may not be found in preference to base::print), but we do 
discourage it.

I find it is rarely needed to call print() or show() explicitly, and when 
I do I follow the same rule as auto-printing - use show() when I know I 
have an S4 object and print() otherwise.

> 
> John
> 
> Laurent Gautier wrote:
>
>  2008/6/10 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
> 
>
>  On Tue, 10 Jun 2008, Laurent Gautier wrote:
>
> 
>
>  2008/6/10 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
> 
>
>  showDefault has
>
>   clDef <- getClass(class(object))
> 
> Looks like the showDefault code intended
>
>   clDef <- getClass(class(object), .force=TRUE)
> 
> However, why are you calling show() on a non-S4 object?  I cannot see any
> advtanges in doing so.
> 
>
>  I'd like *one* printing method for all objects, and the generic "show"
> is registered as working for ANYthing (see below) ?
> 
>
>  print() calls show() for S4 objects (with no additional arguments).
> 
> I agree show() ought to do what it is documented to, but calling it on
> non-S4 objects is inefficient.
> 
>
>  Fair enough.
> May be that word of caution could appear in the documentation for "show" then ?
> 
> A good place could be where the documentation says:
> The 'methods' package overrides the base definition of
> 'print.default' to arrange for automatic printing to honor methods
> for the function 'show'.
> 
> which led me to think that "show" is covering more cases than "print" does
> (while apparently the opposite is happening with "print" delegating to "show").
> 
> 
> 
> Thanks,
> 
> 
> 
> Laurent
> 
> 
> 
>
> 
>
>  Or is defining one's own function currently recommended ?
> 
> myPrint <- function(x, ...)
> {
>  if (isS4(x)) {
>   show(x, ...)
>  } else {
>   print(x, ...)
>  }
> }
>
> 
>
>  showMethods("show")
> 
>
>  Function: show (package methods)
> object="ANY"
> object="classRepresentation"
> object="derivedDefaultMethod"
>   (inherited from: object="MethodDefinition")
> object="function"
>   (inherited from: object="ANY")
> object="genericFunction"
> object="MethodDefinition"
> object="MethodsList"
>   (inherited from: object="ANY")
> object="MethodWithNext"
> object="ObjectsWithPackage"
> object="signature"
> object="traceable"
>
> 
>
>  showMethods("print")
> 
>
>  Function "print":
> <not a generic function>
> 
>
>  getMethod("show", "ANY")
> 
>
>  Method Definition (Class "derivedDefaultMethod"):
> 
> function (object)
> showDefault(object, FALSE)
> <environment: namespace:methods>
> 
> Signatures:
>       object
> target  "ANY"
> defined "ANY"
> 
>
> 
>
>  On Tue, 10 Jun 2008, Laurent Gautier wrote:
>
> 
>
>  Dear List,
> 
> Calling "show" on an object of class "summary.lm" gives:
> Error in getClass(class(object)) : "summary.lm" is not a defined class
> 
> Is this a miss on my end ?
> 
>
> 
>
>  x <- seq(1, 10)
> show(x)
> 
>
>  [1]  1  2  3  4  5  6  7  8  9 10
> 
>
>  y <- runif(10)
> fit <- lm(y ~ x)
> show(fit)
> 
>
>  Call:
> lm(formula = y ~ x)
> 
> Coefficients:
> (Intercept)            x
>  1.04938     -0.08869
>
> 
>
>  show(summary(fit))
> 
>
>  Error in getClass(class(object)) : "summary.lm" is not a defined class
> 
>
>  class(summary(fit))
> 
>
>  [1] "summary.lm"
> 
>
>  class((fit))
> 
>
>  [1] "lm"
> 
>
>  getClass("lm")
> 
>
>  Virtual Class
> 
> No Slots, prototype of class "S4"
> 
> Extends: "oldClass"
> 
> Known Subclasses:
> Class "mlm", directly
> Class "aov", directly
> Class "glm", directly
> Class "maov", by class "mlm", distance 2
> Class "glm.null", by class "glm", distance 2
> 
>
>  getClass("summary.lm")
> 
>
>  Error in getClass("summary.lm") : "summary.lm" is not a defined class
> 
>
>  sessionInfo()
> 
>
>  R version 2.7.0 Patched (2008-06-07 r45877)
> i686-pc-linux-gnu
> 
> locale:
> 
> 
> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> 
> Laurent
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> 
>
>  --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> 
>
>  --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> 
>
>  ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> 
> 
> 
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From jmc at r-project.org  Tue Jun 10 17:07:29 2008
From: jmc at r-project.org (John Chambers)
Date: Tue, 10 Jun 2008 11:07:29 -0400
Subject: [Rd] show vs print (Re: Error in "getClass" when calling the
 function "show")
In-Reply-To: <alpine.LFD.1.10.0806101433060.21538@gannet.stats.ox.ac.uk>
References: <27d1e6020806092123v16e25f38hf1739d486fda232d@mail.gmail.com>
	<alpine.LFD.1.10.0806100659010.28008@gannet.stats.ox.ac.uk>
	<27d1e6020806100020l4bcb3645n88f3b4ebc968eee6@mail.gmail.com>
	<alpine.LFD.1.10.0806100846550.8527@gannet.stats.ox.ac.uk>
	<27d1e6020806100058y2a22a796kb319cbe974b649dc@mail.gmail.com>
	<484E7EDF.4020002@r-project.org>
	<alpine.LFD.1.10.0806101433060.21538@gannet.stats.ox.ac.uk>
Message-ID: <484E98B1.5070302@r-project.org>

It's now perhaps only a historical point, but one motivation for 
introducing show() in S4 was the thought that something other than 
"printing" might evolve to be better for "showing" an object (e.g., a 
method that displayed the object graphically).  The name was chosen to 
be neutral about how the object was shown.

Perhaps, though, this is an idea that might be due for revival.  There 
have been some striking uses of interactive tables/graphs in the 
non-scientific literature recently to display rich data "objects".  
Maybe we should be looking more closely at these for ideas.  For 
example, several people have pointed out a New York Times graphic

 http://graphics8.nytimes.com/packages/flash/politics/20080603_MARGINS_GRAPHIC/margins.swf

(Jan de Leeuw, and others) for displaying tables of results of the 
recent US presidential primaries.  Might we design interactive "show" 
methods for complex objects?

Prof Brian Ripley wrote:
> On Tue, 10 Jun 2008, John Chambers wrote:
>
>> The function show() is intended as a mechanism for automatic display of
>> objects, a vehicle for writing methods that control the automatic 
>> display
>> of new classes of objects (as noted in its documentation and in
>> "Programming with Data").
>>
>> That's why, unlike print() or plot(), it has no optional arguments to
>> control its behavior.
>>
>> That said, it was always intended to call print() for S3 objects, as
>> would be obvious from reading the code for showDefault().  It's just a
>> glitch that it doesn't, as Brian inferred.  We'll fix it, and your usage
>> should then be perfectly OK.  (The relevance of efficiency  when one is
>> printing objects for humans to look at is not compelling.)
>
> Not compelling, but there are more hoops to jump through, and hence 
> more to fail (as here).  One point that is a little more serious is 
> that show() is in methods, and with S3 objects it might be the case 
> that the methods package is not loaded and hence show() is not visible.
>
> For completeness, I should point out that you can define S4 methods 
> for print() and S4 methods for show() for S3 classes.  If you do that, 
> things may not work consistently (not least because you will have an 
> S4 generic 'print' that may not be found in preference to 
> base::print), but we do discourage it.
>
> I find it is rarely needed to call print() or show() explicitly, and 
> when I do I follow the same rule as auto-printing - use show() when I 
> know I have an S4 object and print() otherwise.
>
>>
>> John
>>
>> Laurent Gautier wrote:
>>
>>  2008/6/10 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
>>
>>
>>  On Tue, 10 Jun 2008, Laurent Gautier wrote:
>>
>>
>>
>>  2008/6/10 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
>>
>>
>>  showDefault has
>>
>>   clDef <- getClass(class(object))
>>
>> Looks like the showDefault code intended
>>
>>   clDef <- getClass(class(object), .force=TRUE)
>>
>> However, why are you calling show() on a non-S4 object?  I cannot see 
>> any
>> advtanges in doing so.
>>
>>
>>  I'd like *one* printing method for all objects, and the generic "show"
>> is registered as working for ANYthing (see below) ?
>>
>>
>>  print() calls show() for S4 objects (with no additional arguments).
>>
>> I agree show() ought to do what it is documented to, but calling it on
>> non-S4 objects is inefficient.
>>
>>
>>  Fair enough.
>> May be that word of caution could appear in the documentation for 
>> "show" then ?
>>
>> A good place could be where the documentation says:
>> The 'methods' package overrides the base definition of
>> 'print.default' to arrange for automatic printing to honor methods
>> for the function 'show'.
>>
>> which led me to think that "show" is covering more cases than "print" 
>> does
>> (while apparently the opposite is happening with "print" delegating 
>> to "show").
>>
>>
>>
>> Thanks,
>>
>>
>>
>> Laurent
>>
>>
>>
>>
>>
>>
>>  Or is defining one's own function currently recommended ?
>>
>> myPrint <- function(x, ...)
>> {
>>  if (isS4(x)) {
>>   show(x, ...)
>>  } else {
>>   print(x, ...)
>>  }
>> }
>>
>>
>>
>>  showMethods("show")
>>
>>
>>  Function: show (package methods)
>> object="ANY"
>> object="classRepresentation"
>> object="derivedDefaultMethod"
>>   (inherited from: object="MethodDefinition")
>> object="function"
>>   (inherited from: object="ANY")
>> object="genericFunction"
>> object="MethodDefinition"
>> object="MethodsList"
>>   (inherited from: object="ANY")
>> object="MethodWithNext"
>> object="ObjectsWithPackage"
>> object="signature"
>> object="traceable"
>>
>>
>>
>>  showMethods("print")
>>
>>
>>  Function "print":
>> <not a generic function>
>>
>>
>>  getMethod("show", "ANY")
>>
>>
>>  Method Definition (Class "derivedDefaultMethod"):
>>
>> function (object)
>> showDefault(object, FALSE)
>> <environment: namespace:methods>
>>
>> Signatures:
>>       object
>> target  "ANY"
>> defined "ANY"
>>
>>
>>
>>
>>  On Tue, 10 Jun 2008, Laurent Gautier wrote:
>>
>>
>>
>>  Dear List,
>>
>> Calling "show" on an object of class "summary.lm" gives:
>> Error in getClass(class(object)) : "summary.lm" is not a defined class
>>
>> Is this a miss on my end ?
>>
>>
>>
>>
>>  x <- seq(1, 10)
>> show(x)
>>
>>
>>  [1]  1  2  3  4  5  6  7  8  9 10
>>
>>
>>  y <- runif(10)
>> fit <- lm(y ~ x)
>> show(fit)
>>
>>
>>  Call:
>> lm(formula = y ~ x)
>>
>> Coefficients:
>> (Intercept)            x
>>  1.04938     -0.08869
>>
>>
>>
>>  show(summary(fit))
>>
>>
>>  Error in getClass(class(object)) : "summary.lm" is not a defined class
>>
>>
>>  class(summary(fit))
>>
>>
>>  [1] "summary.lm"
>>
>>
>>  class((fit))
>>
>>
>>  [1] "lm"
>>
>>
>>  getClass("lm")
>>
>>
>>  Virtual Class
>>
>> No Slots, prototype of class "S4"
>>
>> Extends: "oldClass"
>>
>> Known Subclasses:
>> Class "mlm", directly
>> Class "aov", directly
>> Class "glm", directly
>> Class "maov", by class "mlm", distance 2
>> Class "glm.null", by class "glm", distance 2
>>
>>
>>  getClass("summary.lm")
>>
>>
>>  Error in getClass("summary.lm") : "summary.lm" is not a defined class
>>
>>
>>  sessionInfo()
>>
>>
>>  R version 2.7.0 Patched (2008-06-07 r45877)
>> i686-pc-linux-gnu
>>
>> locale:
>>
>>
>> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C 
>>
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>>
>> Laurent
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>>
>>  --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>
>>
>>
>>  --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>
>>
>>
>>  ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>>
>>
>>
>


From tadakado at gmail.com  Tue Jun 10 17:44:22 2008
From: tadakado at gmail.com (Tadashi Kadowaki)
Date: Wed, 11 Jun 2008 00:44:22 +0900
Subject: [Rd] Makevars or congiure for multi platforms
In-Reply-To: <alpine.LFD.1.10.0806091919490.13495@gannet.stats.ox.ac.uk>
References: <27d1e6020806080349v28b60a51vf9661ae726aa8e90@mail.gmail.com>
	<dcb3073c0806081017k7aa4d89bv2f3a4528ac822fb8@mail.gmail.com>
	<alpine.LFD.1.10.0806081949080.8051@gannet.stats.ox.ac.uk>
	<dcb3073c0806091104o21f52b1g49d4a70074fca272@mail.gmail.com>
	<alpine.LFD.1.10.0806091919490.13495@gannet.stats.ox.ac.uk>
Message-ID: <dcb3073c0806100844x715e361epf822e4439809b97f@mail.gmail.com>

Prof. Ripley,

Yes, I can configure when I write configure.ac correctly.
But, If you provide all settings in Rconfig.h, I don't have to
write configure.ac. That is a big benefit for package developers.
Actually I haven't written correct configure.ac yet.

Regards,

Tadashi Kadowaki

2008/6/10 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
> On Tue, 10 Jun 2008, Tadashi Kadowaki wrote:
>
>> Prof Ripley,
>>
>> I fixed and uploaded.
>>
>> However, it is still useful for development of a package that is close
>> to R core,
>> if Rconfig.h contains all definitions in config.h. If Rconfig
>> contained all information,
>> I didn't have to refer the private header directory.
>
> But your package can run its own configure to find such things itself. Which
> entries were you wanting to use?
>
>>
>> Regards,
>>
>> Tadashi Kadowaki
>>
>> 2008/6/9 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
>>>
>>> Private headers are just that, private.  They are not intended to be
>>> available to packages, and not installed by the standard R makefiles on
>>> either Unix-alikes or Windows.
>>>
>>> I don't see it documented that they are available on MacOS X, and will
>>> leave
>>> it to that platform's maintainers as to why they have been installed on
>>> that
>>> platform.
>>>
>>> You need to rewrite your code to use only documented headers and entry
>>> points if you intend to distribute it.
>>>
>>>
>>> On Mon, 9 Jun 2008, Tadashi Kadowaki wrote:
>>>
>>>> Hi, Laurent and Tobias
>>>>
>>>> Thanks a lot.
>>>>
>>>> I could make configure script and upload it to r-forge.
>>>> https://r-forge.r-project.org/projects/pdf2/
>>>> It still works only on mac by default.
>>>> For Linux and Windows, it needs additional option like
>>>> -----
>>>> R CMD INSTALL
>>>> --configure-vars="R_INTERNAL_HEADER_DIR=/path/to/src/include"
>>>> pdf2/pkg
>>>> -----
>>>> ,where /path/to/src/include is the directory in the R source.
>>>> I didn't check it for Linux and Windows...
>>>>
>>>> Regards,
>>>>
>>>> Tadashi Kadowaki
>>>>
>>>> 2008/6/8 Laurent Gautier <lgautier at gmail.com>:
>>>>>
>>>>> 2008/6/7  <r-devel-request at r-project.org>:
>>>>>>
>>>>>> Message: 11
>>>>>> Date: Sat, 7 Jun 2008 03:38:23 +0900
>>>>>> From: "Tadashi Kadowaki" <tadakado at gmail.com>
>>>>>> Subject: [Rd] Makevars or congiure for multi platforms
>>>>>> To: r-devel at r-project.org
>>>>>> Message-ID:
>>>>>>      <dcb3073c0806061138n2f376a24r100f281ae248497a at mail.gmail.com>
>>>>>> Content-Type: text/plain; charset=ISO-8859-1
>>>>>>
>>>>>> Dear all,
>>>>>>
>>>>>> As previously submitted, I wrote an extending pdf device to embed
>>>>>> pop up text and web links.
>>>>>> (Patches are available at http://pdf2.r-forge.r-project.org/patches)
>>>>>>
>>>>>> Now, I'm making a library version of the pdf device.
>>>>>> However, with my skill, I'm not sure about writing Makevars or
>>>>>> configure
>>>>>> file
>>>>>> for multi platforms. A following line in Makevars works on my mac,
>>>>>> -----
>>>>>> PKG_CFLAGS=-I/Library/Frameworks/R.framework/PrivateHeaders
>>>>>> -DHAVE_CONFIG_H
>>>>>> -----
>>>>>> (Note that the PrivateHeaders directory contains Fileio.h and Defn.h)
>>>>>>
>>>>>> My question is,
>>>>>> How do I write Makevars or congiure for Unix/Linux and Windows?
>>>>>> I would like to support those platforms in my library.
>>>>>
>>>>> You could try looking into a package that has configure, configure.win
>>>>> and has built binaries for macosX and windows. Try the package 'rgl'
>>>>> on CRAN, for example.
>>>>>
>>>>>
>>>>> Hoping this helps,
>>>>>
>>>>>
>>>>> L.
>>>>>
>>>>>
>>>>>
>>>>>> Regards,
>>>>>>
>>>>>> Tadashi Kadowaki
>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>> --
>>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>>> University of Oxford,             Tel:  +44 1865 272861 (self)
>>> 1 South Parks Road,                     +44 1865 272866 (PA)
>>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>>
>>
>
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>


From seth at userprimary.net  Tue Jun 10 17:28:32 2008
From: seth at userprimary.net (Seth Falcon)
Date: Tue, 10 Jun 2008 08:28:32 -0700
Subject: [Rd] RSQLite 0.6-9 uploaded to CRAN [was: RSQLite bug fix for
	install	with icc]
In-Reply-To: <6b93d1830806041128u6e1eabe9u7e2419207fa073f9@mail.gmail.com>
References: <6b93d1830806041128u6e1eabe9u7e2419207fa073f9@mail.gmail.com>
Message-ID: <20080610152832.GP32568@ziti.local>

Hi all,

A new version of RSQLite has been uploaded to CRAN and should be
available soon.  This update contains a minor change to the C code
that should improve compatibility on various unix OS.

+ seth

-- 
Seth Falcon | http://userprimary.net/user/


From Gregory_Warnes at URMC.Rochester.edu  Tue Jun 10 19:18:19 2008
From: Gregory_Warnes at URMC.Rochester.edu (Warnes, Gregory)
Date: Tue, 10 Jun 2008 13:18:19 -0400
Subject: [Rd] RFC: Add 'postinstall' hook to R CMD INSTALL ?
In-Reply-To: <18508.4418.322433.885976@ron.nulle.part>
Message-ID: <C4742F9B.2AC%Gregory_Warnes@URMC.Rochester.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080610/030de9b8/attachment.pl>

From timhesterberg at gmail.com  Wed Jun 11 01:50:12 2008
From: timhesterberg at gmail.com (timhesterberg at gmail.com)
Date: Wed, 11 Jun 2008 01:50:12 +0200 (CEST)
Subject: [Rd] browser() exits when not desired,
	in three different scenarios (PR#11623)
Message-ID: <20080610235012.6E04F282EFF7@mail.pubhealth.ku.dk>

Here are three different scenarios in which the browser() exits
when I don't want it to.  These are all related to the browser
accepting either c or (return) to exit.  I would like an option
to turn off the (return) behavior in order to avoid these problems.



# Case 1 - when calling help
# Note, I am using ESS in emacs; this is probably an interaction
# with ESS handling of ? help.
> f <- function(x){
+   browser()
+   length(x)
+ }
> f(1:4)
Called from: f(1:4)
Browse[1]> ?rep
[1] 4
>
# The help was given, but the browser exits.


# Case 2 - when pasting in a command that stretches over
# two lines.
# With f defined as above, call f, select the following two lines in
# an emacs buffer (using c-w clipboard-kill-ring-save) and yank them
into the *R* buffer:
mean(x,
     trim = .2)
# The result:
> f(1:4)
Called from: f(1:4)
Browse[1]> mean(x,
     trim = .2)

mean(x,
+      trim = .2)
[1] 2.5
Browse[1]>
[1] 4
>
# The multi-line command was echoed (twice--this is probably an ESS
problem or misconfiguration), ran, and the browser exits.


# Case 3 - when pasting in a line at a time, including blank lines.
I like to include blank lines in my code for readability.
When I paste in multiple lines, the blank lines cause the browser
to exit.

I reported case 3 before; it is the single thing that bothers
me most about R.  Someone suggested using
ess-eval-line-and-step in ESS; this is nice for one line, but does not
support C-u for sending multiple lines, and doesn't apply when
I'm not using ESS.

Tim Hesterberg

--please do not edit the information below--

Version:
 platform = i486-pc-linux-gnu
 arch = i486
 os = linux-gnu
 system = i486, linux-gnu
 status =
 major = 2
 minor = 7.0
 year = 2008
 month = 04
 day = 22
 svn rev = 45424
 language = R
 version.string = R version 2.7.0 (2008-04-22)

Locale:
LC_CTYPE=en_US;LC_NUMERIC=C;LC_TIME=C;LC_COLLATE=C;LC_MONETARY=C;LC_MESSAGES=en_US;LC_PAPER=en_US;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US;LC_IDENTIFICATION=C

Search Path:
 .GlobalEnv, package:stats, package:graphics, package:grDevices,
package:utils, package:datasets, package:showStructure, package:Rcode,
package:splus2R, package:methods, Autoloads, package:base

	[[alternative HTML version deleted]]


From mflawren at fhcrc.org  Wed Jun 11 06:39:04 2008
From: mflawren at fhcrc.org (Michael Lawrence)
Date: Tue, 10 Jun 2008 21:39:04 -0700
Subject: [Rd] show vs print (Re: Error in "getClass" when calling the
	function "show")
In-Reply-To: <484E98B1.5070302@r-project.org>
References: <27d1e6020806092123v16e25f38hf1739d486fda232d@mail.gmail.com>
	<alpine.LFD.1.10.0806100659010.28008@gannet.stats.ox.ac.uk>
	<27d1e6020806100020l4bcb3645n88f3b4ebc968eee6@mail.gmail.com>
	<alpine.LFD.1.10.0806100846550.8527@gannet.stats.ox.ac.uk>
	<27d1e6020806100058y2a22a796kb319cbe974b649dc@mail.gmail.com>
	<484E7EDF.4020002@r-project.org>
	<alpine.LFD.1.10.0806101433060.21538@gannet.stats.ox.ac.uk>
	<484E98B1.5070302@r-project.org>
Message-ID: <509e0620806102139y561a66aanbbc48f4d6ad42213@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080610/d954ac90/attachment.pl>

From mwkimpel at gmail.com  Wed Jun 11 06:46:51 2008
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Wed, 11 Jun 2008 00:46:51 -0400
Subject: [Rd] Rmpi segfault after install on Ubuntu Hardy Heron
Message-ID: <6b93d1830806102146k1f91b723q2f7918d4a95043e6@mail.gmail.com>

I just installed Rmpi on my 64-bit Ubuntu Hardy Heron OS and using the
following without errors:
"R CMD INSTALL Rmpi_0.5-5.tar.gz --configure-args=--with-mpi=/usr/lib64/openmpi"

Immediately at library(Rmpi) I get the segfault displayed in my
complete output below. My first thought is that perhaps I used the
wrong library for openmpi, but with my 64 bit install it seemed like a
logical choice and the install went without a hitch.

Two other general comments:
1. Am I addressing this to the correct list or should I use R-help? As
I read the posting guide, I'm not sure.
2. Has anyone considered an R-SIG-HPC list? Anyone besides me interested?

Mark


R version 2.7.0 Patched (2008-05-18 r45728)
Copyright (C) 2008 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

Loading required package: datasets
Loading required package: utils
Loading required package: grDevices
Loading required package: graphics
Loading required package: stats
Loading required package: graph
[1] "packages do not need updated"
> options(STERM='iESS', editor='emacsclient')
> library("Rmpi")

 *** caught segfault ***
address 0x2104008, cause 'memory not mapped'

Traceback:
 1: .Call("mpi_initialize", PACKAGE = "Rmpi")
 2: f(libname, pkgname)
 3: firstlib(which.lib.loc, package)
 4: doTryCatch(return(expr), name, parentenv, handler)
 5: tryCatchOne(expr, names, parentenv, handlers[[1]])
 6: tryCatchList(expr, classes, parentenv, handlers)
 7: tryCatch(expr, error = function(e) {    call <- conditionCall(e)
 if (!is.null(call)) {        if (identical(call[[1]],
quote(doTryCatch)))             call <- sys.call(-4)        dcall <-
deparse(call)[1]        prefix <- paste("Error in", dcall, ": ")
 LONG <- 75        msg <- conditionMessage(e)        sm <-
strsplit(msg, "\n")[[1]]        if (14 + nchar(dcall, type = "w") +
nchar(sm[1], type = "w") >             LONG)             prefix <-
paste(prefix, "\n  ", sep = "")    }    else prefix <- "Error : "
msg <- paste(prefix, conditionMessage(e), "\n", sep = "")
.Internal(seterrmessage(msg[1]))    if (!silent &&
identical(getOption("show.error.messages"),         TRUE)) {
cat(msg, file = stderr())        .Internal(printDeferredWarnings())
}    invisible(structure(msg, class = "try-error"))})
 8: try(firstlib(which.lib.loc, package))
 9: library("Rmpi")

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection:

-- 
Mark W. Kimpel MD ** Neuroinformatics ** Dept. of Psychiatry
Indiana University School of Medicine

15032 Hunter Court, Westfield, IN 46074

(317) 490-5129 Work, & Mobile & VoiceMail
(317) 663-0513 Home (no voice mail please)


From ripley at stats.ox.ac.uk  Wed Jun 11 07:51:56 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 11 Jun 2008 06:51:56 +0100 (BST)
Subject: [Rd] Makevars or congiure for multi platforms
In-Reply-To: <dcb3073c0806100844x715e361epf822e4439809b97f@mail.gmail.com>
References: <27d1e6020806080349v28b60a51vf9661ae726aa8e90@mail.gmail.com>
	<dcb3073c0806081017k7aa4d89bv2f3a4528ac822fb8@mail.gmail.com>
	<alpine.LFD.1.10.0806081949080.8051@gannet.stats.ox.ac.uk>
	<dcb3073c0806091104o21f52b1g49d4a70074fca272@mail.gmail.com>
	<alpine.LFD.1.10.0806091919490.13495@gannet.stats.ox.ac.uk>
	<dcb3073c0806100844x715e361epf822e4439809b97f@mail.gmail.com>
Message-ID: <alpine.LFD.1.10.0806101645010.24415@gannet.stats.ox.ac.uk>

On Wed, 11 Jun 2008, Tadashi Kadowaki wrote:

> Prof. Ripley,
>
> Yes, I can configure when I write configure.ac correctly.
> But, If you provide all settings in Rconfig.h, I don't have to
> write configure.ac. That is a big benefit for package developers.

Well, unlikely as no one else has requested it and I don't see configure 
scripts in packages repeating that in R.  So let me repeat

>> Which entries were you wanting to use?


> Actually I haven't written correct configure.ac yet.
>
> Regards,
>
> Tadashi Kadowaki
>
> 2008/6/10 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
>> On Tue, 10 Jun 2008, Tadashi Kadowaki wrote:
>>
>>> Prof Ripley,
>>>
>>> I fixed and uploaded.
>>>
>>> However, it is still useful for development of a package that is close
>>> to R core,
>>> if Rconfig.h contains all definitions in config.h. If Rconfig
>>> contained all information,
>>> I didn't have to refer the private header directory.
>>
>> But your package can run its own configure to find such things itself. Which
>> entries were you wanting to use?
>>
>>>
>>> Regards,
>>>
>>> Tadashi Kadowaki
>>>
>>> 2008/6/9 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
>>>>
>>>> Private headers are just that, private.  They are not intended to be
>>>> available to packages, and not installed by the standard R makefiles on
>>>> either Unix-alikes or Windows.
>>>>
>>>> I don't see it documented that they are available on MacOS X, and will
>>>> leave
>>>> it to that platform's maintainers as to why they have been installed on
>>>> that
>>>> platform.
>>>>
>>>> You need to rewrite your code to use only documented headers and entry
>>>> points if you intend to distribute it.
>>>>
>>>>
>>>> On Mon, 9 Jun 2008, Tadashi Kadowaki wrote:
>>>>
>>>>> Hi, Laurent and Tobias
>>>>>
>>>>> Thanks a lot.
>>>>>
>>>>> I could make configure script and upload it to r-forge.
>>>>> https://r-forge.r-project.org/projects/pdf2/
>>>>> It still works only on mac by default.
>>>>> For Linux and Windows, it needs additional option like
>>>>> -----
>>>>> R CMD INSTALL
>>>>> --configure-vars="R_INTERNAL_HEADER_DIR=/path/to/src/include"
>>>>> pdf2/pkg
>>>>> -----
>>>>> ,where /path/to/src/include is the directory in the R source.
>>>>> I didn't check it for Linux and Windows...
>>>>>
>>>>> Regards,
>>>>>
>>>>> Tadashi Kadowaki
>>>>>
>>>>> 2008/6/8 Laurent Gautier <lgautier at gmail.com>:
>>>>>>
>>>>>> 2008/6/7  <r-devel-request at r-project.org>:
>>>>>>>
>>>>>>> Message: 11
>>>>>>> Date: Sat, 7 Jun 2008 03:38:23 +0900
>>>>>>> From: "Tadashi Kadowaki" <tadakado at gmail.com>
>>>>>>> Subject: [Rd] Makevars or congiure for multi platforms
>>>>>>> To: r-devel at r-project.org
>>>>>>> Message-ID:
>>>>>>>      <dcb3073c0806061138n2f376a24r100f281ae248497a at mail.gmail.com>
>>>>>>> Content-Type: text/plain; charset=ISO-8859-1
>>>>>>>
>>>>>>> Dear all,
>>>>>>>
>>>>>>> As previously submitted, I wrote an extending pdf device to embed
>>>>>>> pop up text and web links.
>>>>>>> (Patches are available at http://pdf2.r-forge.r-project.org/patches)
>>>>>>>
>>>>>>> Now, I'm making a library version of the pdf device.
>>>>>>> However, with my skill, I'm not sure about writing Makevars or
>>>>>>> configure
>>>>>>> file
>>>>>>> for multi platforms. A following line in Makevars works on my mac,
>>>>>>> -----
>>>>>>> PKG_CFLAGS=-I/Library/Frameworks/R.framework/PrivateHeaders
>>>>>>> -DHAVE_CONFIG_H
>>>>>>> -----
>>>>>>> (Note that the PrivateHeaders directory contains Fileio.h and Defn.h)
>>>>>>>
>>>>>>> My question is,
>>>>>>> How do I write Makevars or congiure for Unix/Linux and Windows?
>>>>>>> I would like to support those platforms in my library.
>>>>>>
>>>>>> You could try looking into a package that has configure, configure.win
>>>>>> and has built binaries for macosX and windows. Try the package 'rgl'
>>>>>> on CRAN, for example.
>>>>>>
>>>>>>
>>>>>> Hoping this helps,
>>>>>>
>>>>>>
>>>>>> L.
>>>>>>
>>>>>>
>>>>>>
>>>>>>> Regards,
>>>>>>>
>>>>>>> Tadashi Kadowaki
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>
>>>> --
>>>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>>>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>>>> University of Oxford,             Tel:  +44 1865 272861 (self)
>>>> 1 South Parks Road,                     +44 1865 272866 (PA)
>>>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>>>
>>>
>>
>> --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From juho.vuori at fimr.fi  Wed Jun 11 07:40:03 2008
From: juho.vuori at fimr.fi (juho.vuori at fimr.fi)
Date: Wed, 11 Jun 2008 07:40:03 +0200 (CEST)
Subject: [Rd] read.table() causes segfault with incorrect data (PR#11627)
Message-ID: <20080611054003.D1E67283416D@mail.pubhealth.ku.dk>

Full_Name: Juho Vuori
Version: 2.7.0 (2008-04-22)
OS: Linux poseidon.fimr.fi 2.6.23.17-88.fc7PAE #1 SMP Thu May 15 00:22:53 EDT 2008 i686 i686 i386 GNU/Linux
Submission from: (NULL) (193.166.188.194)


Calling read.table() twice the following way causes a segmentation fault in R.
Run R and type the following commands:

> read.table(stdin())
0: 1 2 3
1: 3
2: 
Error in scan(file, what, nmax, sep, dec, quote, skip, nlines, na.strings,  : 
  line 2 did not have 3 elements
> read.table(stdin())

 *** caught segfault ***
address 0x64616572, cause 'memory not mapped'

Traceback:
 1: read.table(stdin())



Segmentation fault only occurs if the first call failed due to incorrect data.


From jdowty at unimelb.edu.au  Wed Jun 11 06:30:07 2008
From: jdowty at unimelb.edu.au (jdowty at unimelb.edu.au)
Date: Wed, 11 Jun 2008 06:30:07 +0200 (CEST)
Subject: [Rd] write.table (PR#11625)
Message-ID: <20080611043008.CE318282EFF7@mail.pubhealth.ku.dk>

Hi,=20

=20

I am writing to suggest a change in write.table().  Currently one
feature of this function is so counter-intuitive that it could be
considered to be a bug.  I use R 2.6.1 under Windows XP.=20=20

=20

When appending to a file, write.table() automatically writes the column
names first, even though this means writing the variable names in the
middle of a column of numeric values.  The function gives a warning but
if you have the function in a loop then usually all you will see is a
non-specific message ("there were 50 or more warnings") which can be
easy to miss.  In almost all cases it would make more sense for
"col.names=3DTRUE" to be interpreted to mean that the function should
print the column names if it has created the file but not otherwise, I
think.=20=20

=20

James.=20=20

=20

=20

=20


	[[alternative HTML version deleted]]


From osklyar at maninvestments.com  Wed Jun 11 11:38:59 2008
From: osklyar at maninvestments.com (Sklyar, Oleg (MI London))
Date: Wed, 11 Jun 2008 10:38:59 +0100
Subject: [Rd] Rmpi segfault after install on Ubuntu Hardy Heron
In-Reply-To: <6b93d1830806102146k1f91b723q2f7918d4a95043e6@mail.gmail.com>
References: <6b93d1830806102146k1f91b723q2f7918d4a95043e6@mail.gmail.com>
Message-ID: <1A68FCB28DE72F4BA3B967E6506CCE4302294977@mildnpexmb01.maninvestments.ad.man.com>

Does Rmpi work with OpenMPI at all? It calls lamboot on load from LAM
MPI. I would think that mpi_initialize calls a shared library function
from LAM MPI which simply does not exist in OpenMPI or which does
something different from what it expects. If you ever make Rmpi working
with OpenMPI I would be thankful for the solution. It does compile
against OpenMPI though because the header seems to be matching.

Dr Oleg Sklyar
Technology Group
Man Investments Ltd
+44 (0)20 7144 3803
osklyar at maninvestments.com 

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Mark Kimpel
> Sent: 11 June 2008 05:47
> To: r-devel at stat.math.ethz.ch; Dirk Eddelbuettel
> Subject: [Rd] Rmpi segfault after install on Ubuntu Hardy Heron
> 
> I just installed Rmpi on my 64-bit Ubuntu Hardy Heron OS and 
> using the following without errors:
> "R CMD INSTALL Rmpi_0.5-5.tar.gz 
> --configure-args=--with-mpi=/usr/lib64/openmpi"
> 
> Immediately at library(Rmpi) I get the segfault displayed in 
> my complete output below. My first thought is that perhaps I 
> used the wrong library for openmpi, but with my 64 bit 
> install it seemed like a logical choice and the install went 
> without a hitch.
> 
> Two other general comments:
> 1. Am I addressing this to the correct list or should I use 
> R-help? As I read the posting guide, I'm not sure.
> 2. Has anyone considered an R-SIG-HPC list? Anyone besides me 
> interested?
> 
> Mark
> 
> 
> R version 2.7.0 Patched (2008-05-18 r45728) Copyright (C) 
> 2008 The R Foundation for Statistical Computing ISBN 3-900051-07-0
> 
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
> 
>   Natural language support but running in an English locale
> 
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and 'citation()' 
> on how to cite R or R packages in publications.
> 
> Type 'demo()' for some demos, 'help()' for on-line help, or 
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
> 
> Loading required package: datasets
> Loading required package: utils
> Loading required package: grDevices
> Loading required package: graphics
> Loading required package: stats
> Loading required package: graph
> [1] "packages do not need updated"
> > options(STERM='iESS', editor='emacsclient')
> > library("Rmpi")
> 
>  *** caught segfault ***
> address 0x2104008, cause 'memory not mapped'
> 
> Traceback:
>  1: .Call("mpi_initialize", PACKAGE = "Rmpi")
>  2: f(libname, pkgname)
>  3: firstlib(which.lib.loc, package)
>  4: doTryCatch(return(expr), name, parentenv, handler)
>  5: tryCatchOne(expr, names, parentenv, handlers[[1]])
>  6: tryCatchList(expr, classes, parentenv, handlers)
>  7: tryCatch(expr, error = function(e) {    call <- conditionCall(e)
>  if (!is.null(call)) {        if (identical(call[[1]],
> quote(doTryCatch)))             call <- sys.call(-4)        dcall <-
> deparse(call)[1]        prefix <- paste("Error in", dcall, ": ")
>  LONG <- 75        msg <- conditionMessage(e)        sm <-
> strsplit(msg, "\n")[[1]]        if (14 + nchar(dcall, type = "w") +
> nchar(sm[1], type = "w") >             LONG)             prefix <-
> paste(prefix, "\n  ", sep = "")    }    else prefix <- "Error : "
> msg <- paste(prefix, conditionMessage(e), "\n", sep = "")
> .Internal(seterrmessage(msg[1]))    if (!silent &&
> identical(getOption("show.error.messages"),         TRUE)) {
> cat(msg, file = stderr())        .Internal(printDeferredWarnings())
> }    invisible(structure(msg, class = "try-error"))})
>  8: try(firstlib(which.lib.loc, package))
>  9: library("Rmpi")
> 
> Possible actions:
> 1: abort (with core dump, if enabled)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> Selection:
> 
> --
> Mark W. Kimpel MD ** Neuroinformatics ** Dept. of Psychiatry 
> Indiana University School of Medicine
> 
> 15032 Hunter Court, Westfield, IN 46074
> 
> (317) 490-5129 Work, & Mobile & VoiceMail
> (317) 663-0513 Home (no voice mail please)
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


**********************************************************************
The contents of this email are for the named addressee(s...{{dropped:22}}


From edd at debian.org  Wed Jun 11 12:10:37 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 11 Jun 2008 05:10:37 -0500
Subject: [Rd] Rmpi segfault after install on Ubuntu Hardy Heron
In-Reply-To: <1A68FCB28DE72F4BA3B967E6506CCE4302294977@mildnpexmb01.maninvestments.ad.man.com>
References: <6b93d1830806102146k1f91b723q2f7918d4a95043e6@mail.gmail.com>
	<1A68FCB28DE72F4BA3B967E6506CCE4302294977@mildnpexmb01.maninvestments.ad.man.com>
Message-ID: <18511.42141.954683.646681@ron.nulle.part>


On 11 June 2008 at 10:38, Sklyar, Oleg \(MI London\) wrote:
| Does Rmpi work with OpenMPI at all? It calls lamboot on load from LAM

Yes. 

| MPI. I would think that mpi_initialize calls a shared library function
| from LAM MPI which simply does not exist in OpenMPI or which does
| something different from what it expects. If you ever make Rmpi working
| with OpenMPI I would be thankful for the solution. It does compile
| against OpenMPI though because the header seems to be matching.

Debian switched in October 2007 and with Rmpi 0.5-4. Rmpi 0.5-5 definitely
supports it, Hao Yu made some upstream changes.

I have been using it on Ubuntu/x86 at work all that time (but then I was also
testing the newer Open MPI code). You may want Open MPI 1.2.* though it may
work with 1.1.* as well.

Dirk

-- 
Three out of two people have difficulties with fractions.


From Heather.Turner at warwick.ac.uk  Wed Jun 11 13:50:49 2008
From: Heather.Turner at warwick.ac.uk (Dr Heather Turner)
Date: Wed, 11 Jun 2008 12:50:49 +0100
Subject: [Rd] Posting Guide - help.request() function?
In-Reply-To: <18509.38499.830075.619012@cmath-5.math.ethz.ch>
References: <971536df0806061030i75474172xff100ece76a23eec@mail.gmail.com><971536df0806070638w48afb954y77278659edd37802@mail.gmail.com><971536df0806071024x688e1bcfvac6a1c8a43182170@mail.gmail.com><484D3F9D.7010404@warwick.ac.uk><971536df0806090818l7acc330cy51746b3f815b9a7a@mail.gmail.com><484D587D.9040101@warwick.ac.uk>
	<18509.38499.830075.619012@cmath-5.math.ethz.ch>
Message-ID: <484FBC19.3040805@warwick.ac.uk>

Okay, here's the update.

I've created a new function create.post() (with Windows and Unix 
versions) which would be the internal function that creates the post 
template ready to edit and optionally send. In the Windows version I've 
added an experimental method == "mailto" option, which will open the 
post template in the default mailer (e.g. Outlook) ready to edit and 
post. Maybe a Unix version would also be nice, e.g.

browseURL("mailto:r-bugs at r-project.org?subject=my bug&body=%0A<<insert 
bug report here>>%0A%0A%0A%0A--please do not edit the information 
below--%0A%0AVersion:%0A platform = x86_64-unknown-linux-gnu%0A ...")

would open the post template in e.g. Thunderbird, but has the side 
effect of opening an empty page in the web browser. I don't know if 
there's a neater solution?

The create.post() function is basically the old bug.report() with two 
extra arguments: 'description' (e.g. "bug report") and 'instructions' 
(e.g. "\\n<<Type your message here>>\\n") for customization. It could be 
used directly e.g to post to R-devel with session information.

The new bug.report() simply calls create.post() with the appropriate 
arguments.

The improved help-request() function calls create.post() after running 
through the checks described before.

In response to Gabor's comments, help.request():

  - now checks packages are up-to-date and gives option to update 
on-the-fly (user may not know whether involved in query, so check all)

  - keeps default mailing options as in old bug.report() but 
create.post() gives clearer message ("Email the post now?\n (yes/no)") 
requiring definite response ("yes" vs "y")

  - still uses online documents because some are only available online 
(R Site Search, posting guide), it ensures the most up-to-date 
documentation is used, and it allows direction to global FAQ page, 
avoiding need to check whether user is on Windows/Mac

  - uses more robust method of checking R version is up-to-date

I've also written a help file for help.request() which includes the 
method="mailto" option. The help file for bug.report would need updating 
if this option was kept.

Best wishes,

Heather


Martin Maechler wrote:
>  >>>>> "HT" == Heather Turner <Heather.Turner at warwick.ac.uk>
>  >>>>>     on Mon, 09 Jun 2008 17:21:17 +0100 writes:
> 
>     HT> Thanks for the helpful tips and suggestions, I'll work
>     HT> them in. You get local versions of the documents on Unix
>     HT> too - RShowDoc() will do the trick.
> 
>     HT> I'll post an updated version in due course,
> 
> Thank you, Heather and Gabor (and the other contributors).
> Indeed, I too like the idea of providing a new R function for
> this.
> Ideally, Heather, you'd try to "factor out" some of the common
> functionality of bug.report() and help.request() into a few
> utils-namespace hidden auxiliary functions.
> 
> Ideally, you'd attach text/plain attachments (base64 encoded) so
> there won't be line wrap arounds.
> 
> Martin
> 
> 
> 
>     HT> Gabor Grothendieck wrote:
>     >> That's an excellent idea.
>     >>
>     >> One other item that could be checkable would be if the
>     >> user has the most recent versions of the packages
>     >> involved in the query.  Perhaps it could display the
>     >> unupdated packages and ask the user if any of those are
>     >> involved in the query.
>     >>
>     >> Probably needs to give fair warning that it is sending
>     >> off an email so people don't wind up sending out emails
>     >> when they are really just trying out the system.
>     >> Probably "none" should be the default for email so that
>     >> its not regarded as obnoxious.
>     >>
>     >> Might be nice if it used local versions of documents if
>     >> they exist locally.  On Windows they do.
>     >>
>     >> Check out ?getRversion
>     >>
>     >> On Mon, Jun 9, 2008 at 10:35 AM, Dr Heather Turner
>     >> <Heather.Turner at warwick.ac.uk> wrote:
>     >>> Whilst it is a good idea to improve the posting guide,
>     >>> it seems to me that it would be useful to have a
>     >>> function along the lines of bug.report(), to help a
>     >>> potential questioner make sure they have done their
>     >>> homework and have the relevant information to put into a
>     >>> post to R-help.
>     >>>
>     >>> Even those of us who know what ought to go into a post
>     >>> can sometimes forget to check something obvious - I
>     >>> recently got caught out by not checking an error was
>     >>> reproducible in the patched version for example.
>     >>>
>     >>> So I have written a help.request() function (see below),
>     >>> which - prompts the user to check the relevant
>     >>> resources, stopping and opening the relevant url where
>     >>> necessary - checks their R version is up-to-date (in a
>     >>> rather messy way - please suggest improvements!)  -
>     >>> prompts them to prepare appropriate example code and
>     >>> test it in a fresh R session - prompts them to give a
>     >>> meaningful subject line - automatically adds system info
>     >>> to the post (as in bug.report) - sends the message for
>     >>> them (ensuring a fresh thread is started)
>     >>>
>     >>> Is this an idea worth taking further? I would be happy
>     >>> to make improvements as suggested and write a help file
>     >>> if so.
>     >>>
>     >>> Heather
>     >>>
>     >>> ------------------------------------------------------------
>     >>>
>     >>> help.request <- function (subject = "", ccaddress =
>     >>> Sys.getenv("USER"), method = getOption("mailer"),
>     >>> address = "r-help at R-project.org", file =
>     >>> "R.help.request") { no <- function(answer) answer == "n"
>     >>> yes <- function(answer) answer == "y" go <-
>     >>> function(url) { cat("Please do this first - the site has
>     >>> been loaded in your web browser\n") browseURL(url) }
>     >>> cat("Checklist:\n") post <- readline("Have you read the
>     >>> posting guide? (y/n) ") if (no(post))
>     >>> return(go("http://www.r-project.org/posting-guide.html"))
>     >>> FAQ <- readline("Have you checked the FAQ? (y/n) ") if
>     >>> (no(FAQ))
>     >>> return(go("http://cran.r-project.org/faqs.html")) intro
>     >>> <- readline("Have you checked An Introduction to R?
>     >>> (y/n) ") if (no(intro))
>     >>> return(go("http://cran.r-project.org/doc/manuals/R-intro.html"))
>     >>> NEWS <- readline("Have you checked the NEWS of the
>     >>> latest development release? (y/n) ") if (no(NEWS))
>     >>> return(go("https://svn.r-project.org/R/trunk/NEWS"))
>     >>> rsitesearch <- readline("Have you looked on RSiteSearch?
>     >>> (y/n) ") if (no(rsitesearch)) { cat("Please do this
>     >>> first - the site has been loaded in your web browser\n")
>     >>> return(RSiteSearch(subject)) } inf <- sessionInfo() if
>     >>> ("otherPkgs" %in% names(inf)){ other <- readline("You
>     >>> have packages other than the base packages loaded.",
>     >>> "\nIf your query relates to one of these, have you ",
>     >>> "checked any corresponding books/manuals \nand ",
>     >>> "considered contacting the package maintainer?  (y/n/NA)
>     >>> ") if(no(other)) return("Please do this first.")  }
>     >>>
>     >>> man <- url("http://cran.r-project.org/manuals.html") ver
>     >>> <- scan(man, what = character(0), sep = "\n", skip = 13,
>     >>> nlines = 1, quiet = TRUE) major <-
>     >>> as.numeric(substr(ver, start = 18, stop = 18)) minor <-
>     >>> as.numeric(substr(ver, start = 20, stop = 22)) if (major
>     >>> < as.numeric(R.Version()$major) || minor <
>     >>> as.numeric(R.Version()$major)) { update <-
>     >>> readline("Your R version is out-of-date, would you like
>     >>> to update now? (y/n) ") if (yes(update)) {
>     >>> return(go(getOption("repos"))) } } ## To get long
>     >>> prompt!  cat("Have you written example code that is\n",
>     >>> "- minimal\n - reproducible\n - self-contained\n -
>     >>> commented", "\nusing data that is either\n", "-
>     >>> constructed by the code\n - loaded by data()\n", "-
>     >>> reproduced using dump(\"mydata\", file = \"\")\n") code
>     >>> <- readline(paste("have you checked this code in a fresh
>     >>> R session", "\n(invoking R with the --vanilla option if
>     >>> possible)", "\nand is this code copied to the clipboard?
>     >>> (y/n) ")) if (no(code)) return(cat("\nIf your query is
>     >>> not directly related to code", "(e.g. a general query
>     >>> \nabout R's capabilities),", "email R-help at r-project.org
>     >>> directly. ", "\nOtherwise prepare some example code
>     >>> first.\n")) change <- readline(paste("Would you like to
>     >>> change your subject line:\n", subject, "\nto something
>     >>> more meaningful? (y/n) ")) if (yes(change)) subject <-
>     >>> readline("Enter subject: \n")
>     >>>
>     >>> methods <- c("mailx", "gnudoit", "none", "ess") method
>     >>> <- if (is.null(method)) "none" else
>     >>> methods[pmatch(method, methods)] body <-
>     >>> paste("\\n<<Write your query here, using your example
>     >>> code to
>     illustrate> ",
>     >>> "\\n<<End with your name and affiliation>>\\n\\n\\n\\n",
>     >>> "--please do not edit the information below--\\n\\n",
>     >>> "Version:\\n ", paste(names(R.version), R.version, sep =
>     >>> " = ", collapse = "\\n "), if
>     >>> (nzchar(Sys.getenv("R_GUI_APP_VERSION")))
>     >>> paste("\\n\\nGUI:\\n R-GUI ",
>     >>> Sys.getenv("R_GUI_APP_VERSION"), " (",
>     >>> Sys.getenv("R_GUI_APP_REVISION"), ")", sep = "") else
>     >>> "", "\\n\\n", "Locale:\\n", Sys.getlocale(), "\\n\\n",
>     >>> "Search Path:\\n ", paste(search(), collapse = ", "),
>     >>> "\\n", sep = "", collapse = "") if (method == "gnudoit")
>     >>> { cmd <- paste("gnudoit -q '", "(mail nil \"", address,
>     >>> "\")", "(insert \"", body, "\")", "(search-backward
>     >>> \"Subject:\")", "(end-of-line)'", sep = "") system(cmd)
>     >>> } else if (method == "none") { disclaimer <- paste("#
>     >>> Your mailer is set to \"none\" (default on Windows),\n",
>     >>> "# hence we cannot send the help request directly from
>     >>> R.\n", "# Please copy the help request (after finishing
>     >>> it) to\n", "# your favorite email program and send it
>     >>> to\n#\n", "# ", address, "\n#\n",
>     >>> "######################################################\n",
>     >>> "\n\n", sep = "") cat(disclaimer, file = file) body <-
>     >>> gsub("\\\\n", "\n", body) cat(body, file = file, append
>     >>> = TRUE) cat("Please edit the help request.\n")
>     >>> system(paste(getOption("editor"), file)) cat("The unsent
>     >>> help request can be found in file", file, "\n") } else
>     >>> if (method == "mailx") { if (missing(subject))
>     >>> stop("'subject' missing") body <- gsub("\\\\n", "\n",
>     >>> body) cat(body, file = file, append = FALSE) cat("Please
>     >>> edit the help request.\n")
>     >>> system(paste(getOption("editor"), file)) if
>     >>> (is.character(ccaddress) && nzchar(ccaddress)) { cmdargs
>     >>> <- paste("-s '", subject, "' -c", ccaddress, address,
>     >>> "<", file, "2>/dev/null") } else cmdargs <- paste("-s
>     >>> '", subject, "'", address, "<", file, "2>/dev/null")
>     >>> status <- 1 cat("Submit the help request? ") answer <-
>     >>> readline() answer <- grep("y", answer, ignore.case =
>     >>> TRUE) if (length(answer) > 0) { cat("Sending email
>     >>> ...\n") status <- system(paste("mailx", cmdargs)) if
>     >>> (status > 0) status <- system(paste("Mail", cmdargs)) if
>     >>> (status > 0) status <- system(paste("/usr/ucb/mail",
>     >>> cmdargs)) if (status == 0) unlink(file) else {
>     >>> cat("Sending email failed!\n") cat("The unsent help
>     >>> request can be found in file", file, "\n") } } else
>     >>> cat("The unsent help request can be found in file",
>     >>> file, "\n") } else if (method == "ess") { body <-
>     >>> gsub("\\\\n", "\n", body) cat(body) } }
>     >>>
>     >>> 
> -----------------------------------------------------------------------
>     >>>
>     >>> Gabor Grothendieck wrote:
>     >>>> Here is another update.  I have added the following:
>     >>>>
>     >>>> - info about using a fresh R session.  (In that case
>     >>>> ls() output is less essential; however, the developers
>     >>>> of sessionInfo() might consider adding that as a
>     >>>> default or as an option.)
>     >>>>
>     >>>> - questioner should consider use of functions.
>     >>>>
>     >>>> - for data use dump(x, file = "") to reproducibly
>     >>>> display data or use builtin datasets listed by data()
>     >>>>
>     >>>> - minimal versions of slow code should be presented in
>     >>>> cases where questioner is looking for faster code.
>     >>>>
>     >>>> - we still need to add links to illustrative sample
>     >>>> questions in r-help
>     >>>>
>     >>>> The following were not added for the reason cited:
>     >>>>
>     >>>> - guide is not just for questioners.  Important to
>     >>>> distinguish roles of questioner, responder and reader.
>     >>>>
>     >>>> - what is to be provided ought to be given a name to
>     >>>> make it easier to refer to.  An unlabelled set of
>     >>>> points is too vague.  Test framework seems
>     >>>> appropriately descriptive.  By giving it a name one can
>     >>>> request that a questioner "provide a test framework as
>     >>>> defined in the posting guide summary".
>     >>>>
>     >>>> - self contained is not implied by reproducible.
>     >>>> Reproducible only means that info is available
>     >>>> somewhere -- not that its all available right in the
>     >>>> questioner's post and all in a manner that is readily
>     >>>> accessible.
>     >>>>
>     >>>> - focus should be on making data minimal.  Don't like
>     >>>> attachments since responder must save them and read
>     >>>> them in.  It encourages use of large rather than
>     >>>> minimal data sets.
>     >>>>
>     >>>> Summary
>     >>>>
>     >>>> Surprisingly, the main problem for responders is not to
>     >>>> answer the question but to quickly figure out what the
>     >>>> question is, reproduce it in their own R session and
>     >>>> test their answer.
>     >>>>
>     >>>> Test Framework.  To faciliate this provide a test
>     >>>> framework of:
>     >>>>
>     >>>> (1) minimal reproducible self-contained commented code
>     >>>> and data that has been run in a fresh R session.  That
>     >>>> means code and data have been cut down as far as
>     >>>> possible to the essentials needed to illustrate the
>     >>>> problem and were run are just after starting up R.
>     >>>> Also it means that its possible for responders to just
>     >>>> copy the code and data section from the questioner's
>     >>>> post to the clipboard and paste it into their session
>     >>>> to see the same output without having to enter even one
>     >>>> R command.  In some cases there may be an advantage to
>     >>>> present the code as a function and in the case of
>     >>>> needing a speedup be sure to post a minimal version of
>     >>>> the slow code.  Use builtin data sets such as those
>     >>>> listed by data() to illustrate problem or reduce your
>     >>>> data to a minimum and present it reproducibly by using:
>     >>>> dump("mydata", file = "")
>     >>>>
>     >>>> (2) comments/explanation of what the code is intended
>     >>>> to produce -- Don't assume its obvious!
>     >>>>
>     >>>> (3) versions of all software used, e.g. sessionInfo(),
>     >>>> or R.version.string; packageDescription("zoo")$Version
>     >>>>
>     >>>> Without self-contained reproducible code the responder
>     >>>> must not only understand the question but must also
>     >>>> create a test framework and that typically takes more
>     >>>> time than answering the question!  Its not fair to ask
>     >>>> the responder to provide all that on top of answering
>     >>>> the question.  Do NOT assume the problem is so simple
>     >>>> that it is not necessary.
>     >>>>
>     >>>> Effort. The effort taken to reduce the problem to its
>     >>>> essentials and produce a test framework often solves
>     >>>> the problem avoiding the need for a post in the first
>     >>>> place.  It at the least shows that the questioner tried
>     >>>> to solve it themself.
>     >>>>
>     >>>> Subscribers.  The questioner should ensure that the
>     >>>> thread is complete and that it has an appropriate
>     >>>> Subject.  The purpose of the post is not only to help
>     >>>> the questioner but also the other list subscribers and
>     >>>> those later searching the archives.
>     >>>>
>     >>>>
>     >>>>
>     >>>>
>     >>>>
>     >>>> On Sat, Jun 7, 2008 at 9:38 AM, Gabor Grothendieck
>     >>>> <ggrothendieck at gmail.com> wrote:
>     >>>>> Here is a second version of the summary.  Its been
>     >>>>> rearranged to place most important info at top.  Also
>     >>>>> shortened it a bit.
>     >>>>>
>     >>>>> It still needs links to example posts, as suggested.
>     >>>>> Anyone?
>     >>>>>
>     >>>>> Summary
>     >>>>>
>     >>>>> Surprisingly, the main problem for responders is not
>     >>>>> to answer the posted questions but to quickly figure
>     >>>>> out what the question is, reproduce it in their own R
>     >>>>> session and test their answer.
>     >>>>>
>     >>>>> Test Framework.  To faciliate that provide a test
>     >>>>> framework of:
>     >>>>>
>     >>>>> (1) reproducible self-contained minimal code and data.
>     >>>>> That means responders can copy it from the
>     >>>>> questioner's post and paste it into their session to
>     >>>>> see the same output without having to enter even one R
>     >>>>> command.  NB. dput(mydata) produces mydata in
>     >>>>> reproducible form.  (2) comments/explanations of what
>     >>>>> the code is intended to produce and (3) versions of
>     >>>>> all software used, e.g. sessionInfo().
>     >>>>>
>     >>>>> Without self-contained reproducible code the responder
>     >>>>> must not only understand the question but must also
>     >>>>> create a test framework and that typically takes more
>     >>>>> time than answering the question!  Its not fair to ask
>     >>>>> the responder to provide all that on top of answering
>     >>>>> the question.  Do NOT assume the problem is so simple
>     >>>>> that it is not necessary.
>     >>>>>
>     >>>>> Effort. The effort taken to reduce the problem to its
>     >>>>> essentials and produce a test framework often solves
>     >>>>> the problem avoiding the need for a post in the first
>     >>>>> place.  It at the least shows that the questioner
>     >>>>> tried to solve it themself.
>     >>>>>
>     >>>>> Subscribers.  The questioner should ensure that the
>     >>>>> thread is complete and that it has an appropriate
>     >>>>> Subject.  The purpose of the post is not only to help
>     >>>>> the questioner but also the other list subscribers and
>     >>>>> those later searching the archives.
>     >>>>>
>     >>>>>
>     >>>>>
>     >>>>> On Fri, Jun 6, 2008 at 1:30 PM, Gabor Grothendieck
>     >>>>> <ggrothendieck at gmail.com> wrote:
>  >>>>> People read the posting guide yet they are still unable to
>     >>>>> create an
>  >>>>> acceptable
>  >>>>> post. e.g.
>  >>>>> https://stat.ethz.ch/pipermail/r-help/2008-June/164092.html
>     >>>>>>
>  >>>>> I think the problem is that the guide is not clear or
>     >>>>>> concise enough.
>  >>>>> I suggest we add a summary at the beginning which gets to
>     >>>>>> the heart
>  >>>>> of what a poster is expected to provide:
>     >>>>>>
>  >>>>> Summary
>     >>>>>>
>  >>>>> To maximize your change of getting a response when posting
>     >>>>>> provide (1)
>  >>>>> commented,
>  >>>>> (2) minimal, (3) self-contained and (4) reproducible code.
>     >>>>>> (This one
>  >>>>> line summary
>  >>>>> also appears at the end of each message to r-help.)
>     >>>>>>
>  >>>>> "Self-contained" and "reproducible" mean that a responder
>     >>>>>> can copy the
>  >>>>> questioner's code to
>  >>>>> the clipboard, paste it into their R session and see the
>     >>>>>> same problem
>  >>>>> you as the questioner
>  >>>>> see.  Note that dput(mydata) will display mydata in a
>     >>>>>> reproducible way.
>  >>>>> Self-contained and reproducible are needed because:
>  >>>>> (1) Self-Effort. It shows that the questioner tried to
>     >>>>>> solve the
>  >>>>> problem by themself first.
>  >>>>> (2) Test framework. Often the responder needs to play with
>     >>>>>> the code a
>  >>>>> bit in order to respond
>  >>>>> or at least to give the best answer.  They can't do that
>     >>>>>> without a
>  >>>>> test framework that includes
>  >>>>> the data and the code to run it and its not fair to ask
>     >>>>>> them to not
>  >>>>> only answer the question but
>  >>>>> also to come up with test data and to complete incomplete
>     >>>>>> code.
>  >>>>> (3) Archives. Questions and answers go into the archives
>     >>>>>> so they are
>  >>>>> not only for the benefit of
>  >>>>> of the questioner but also for the benefit of all future
>     >>>>>> searchers of
>  >>>>> the archive.  That means
>  >>>>> that its not finished if you have solved the problem for
>     >>>>>> yourself.
>  >>>>> You still need to ensure that
>  >>>>> the thread has a complete solution. (For that reason its
>     >>>>>> also
>  >>>>> important to give a meaningful
>  >>>>> subject to each post.)
>     >>>>>>
>  >>>>> "Commented" and "minimal" also reduce the time it takes to
>     >>>>>> understand
>  >>>>> the problem.
>  >>>>> Don't just dump your code as is into the message since you
>     >>>>>> are just
>  >>>>> wasting your own
>  >>>>> time. Its not likely anyone will answer a message if the
>     >>>>>> questioner
>  >>>>> has not taken the
>  >>>>> time to reduce it to its essential elements.
>     >>>>>> Surprisingly, quite
>  >>>>> often understanding what
>  >>>>> the problem is takes the responder most of the time -- not
>     >>>>>> solving the
>  >>>>> problem. Once the
>  >>>>> question is actually understood its often quite fast to
>     >>>>>> answer.  Thus
>  >>>>> in addition to posting
>  >>>>> it in a minimal form, comment on it sufficiently so that
>     >>>>>> the responder
>  >>>>> knows what the code
>  >>>>> does and is intended to produce.  It may be obvious to the
>     >>>>>> questioner
>  >>>>> who is embroiled in
>  >>>>> the problem but that does not mean its obvious to others.
>     >>>>>>
>  >>>>> Introduction
>     >>>>>>
>  >>>>> .... rest of posting guide ...
>     >>>>>>
>     >>>> ______________________________________________
>     >>>> R-devel at r-project.org mailing list
>     >>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>     >>> --
>     >>> Dr H Turner Research Fellow Dept. of Statistics The
>     >>> University of Warwick Coventry CV4 7AL
>     >>>
>     >>> Tel: 024 76575870 Fax: 024 76524532 Url:
>     >>> www.warwick.ac.uk/go/heatherturner
>     >>>
> 
> --
> Dr H Turner
>     HT> Research Fellow Dept. of Statistics The University of
>     HT> Warwick Coventry CV4 7AL
> 
>     HT> Tel: 024 76575870 Fax: 024 76524532 Url:
>     HT> www.warwick.ac.uk/go/heatherturner
> 
>     HT> ______________________________________________
>     HT> R-devel at r-project.org mailing list
>     HT> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> No virus found in this incoming message.
> Checked by AVG.
> Version: 8.0.100 / Virus Database: 270.2.0/1494 - Release Date: 
> 6/10/2008 7:22 AM
> 

-- 
Dr H Turner
Research Fellow
Dept. of Statistics
The University of Warwick
Coventry
CV4 7AL

Tel: 024 76575870
Fax: 024 76524532
Url: www.warwick.ac.uk/go/heatherturner
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: bug.report.R
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080611/fe474b10/attachment.pl>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: create.post_unix.R
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080611/fe474b10/attachment-0001.pl>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: create.post_win.R
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080611/fe474b10/attachment-0002.pl>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: help.request.R
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080611/fe474b10/attachment-0003.pl>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: help.request.Rd
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080611/fe474b10/attachment-0004.pl>

From paul.hewson at plymouth.ac.uk  Wed Jun 11 13:52:34 2008
From: paul.hewson at plymouth.ac.uk (Paul Hewson)
Date: Wed, 11 Jun 2008 12:52:34 +0100
Subject: [Rd] Rmpi segfault after install on Ubuntu Hardy Heron
In-Reply-To: <1A68FCB28DE72F4BA3B967E6506CCE4302294977@mildnpexmb01.maninvestments.ad.man.com>
References: <6b93d1830806102146k1f91b723q2f7918d4a95043e6@mail.gmail.com>,
	<1A68FCB28DE72F4BA3B967E6506CCE4302294977@mildnpexmb01.maninvestments.ad.man.com>
Message-ID: <D316C48934DDC340AEC96EF223BC53C913ED1F2053@ILS130.uopnet.plymouth.ac.uk>

Hello,
I can confirm that Rmpi 0.5.5 works fine with openmpi 1.1

But if (a) the cluster you are running on is set up to allow spawning and (b) you have lam-mpi installed, there is a function within zzz.R which will spawn a lam-mpi process as well which you might need to prevent.

The package README tells you what to do to prevent lam-mpi starting up.   You either hack at the zzz.R, or you set up a file called lamnodes (I think) as a shell script which contains echo lamnodes NULL (or similar) and put this somewhere on your path.   That tells Rmpi not to fire up lammpi, you can run it under mpirun -np 1 -hostfile myhosts R --vanilla --slave CMD BATCH diddlededoo.R &

Best

Paul

-=-=-==-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Paul Hewson
Lecturer in Statistics
University of Plymouth
Drake Circus
Plymouth PL4 8AA

tel ++44(0)1752 232778
email paul.hewson at plymouth.ac.uk
web http://www.plymouth.ac.uk/staff/phewson

________________________________________
From: r-devel-bounces at r-project.org [r-devel-bounces at r-project.org] On Behalf Of Sklyar, Oleg (MI London) [osklyar at maninvestments.com]
Sent: 11 June 2008 10:38
To: Mark Kimpel; r-devel at stat.math.ethz.ch; Dirk Eddelbuettel
Subject: Re: [Rd] Rmpi segfault after install on Ubuntu Hardy Heron

Does Rmpi work with OpenMPI at all? It calls lamboot on load from LAM
MPI. I would think that mpi_initialize calls a shared library function
from LAM MPI which simply does not exist in OpenMPI or which does
something different from what it expects. If you ever make Rmpi working
with OpenMPI I would be thankful for the solution. It does compile
against OpenMPI though because the header seems to be matching.

Dr Oleg Sklyar
Technology Group
Man Investments Ltd
+44 (0)20 7144 3803
osklyar at maninvestments.com

> -----Original Message-----
> From: r-devel-bounces at r-project.org
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Mark Kimpel
> Sent: 11 June 2008 05:47
> To: r-devel at stat.math.ethz.ch; Dirk Eddelbuettel
> Subject: [Rd] Rmpi segfault after install on Ubuntu Hardy Heron
>
> I just installed Rmpi on my 64-bit Ubuntu Hardy Heron OS and
> using the following without errors:
> "R CMD INSTALL Rmpi_0.5-5.tar.gz
> --configure-args=--with-mpi=/usr/lib64/openmpi"
>
> Immediately at library(Rmpi) I get the segfault displayed in
> my complete output below. My first thought is that perhaps I
> used the wrong library for openmpi, but with my 64 bit
> install it seemed like a logical choice and the install went
> without a hitch.
>
> Two other general comments:
> 1. Am I addressing this to the correct list or should I use
> R-help? As I read the posting guide, I'm not sure.
> 2. Has anyone considered an R-SIG-HPC list? Anyone besides me
> interested?
>
> Mark
>
>
> R version 2.7.0 Patched (2008-05-18 r45728) Copyright (C)
> 2008 The R Foundation for Statistical Computing ISBN 3-900051-07-0
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
>   Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and 'citation()'
> on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
>
> Loading required package: datasets
> Loading required package: utils
> Loading required package: grDevices
> Loading required package: graphics
> Loading required package: stats
> Loading required package: graph
> [1] "packages do not need updated"
> > options(STERM='iESS', editor='emacsclient')
> > library("Rmpi")
>
>  *** caught segfault ***
> address 0x2104008, cause 'memory not mapped'
>
> Traceback:
>  1: .Call("mpi_initialize", PACKAGE = "Rmpi")
>  2: f(libname, pkgname)
>  3: firstlib(which.lib.loc, package)
>  4: doTryCatch(return(expr), name, parentenv, handler)
>  5: tryCatchOne(expr, names, parentenv, handlers[[1]])
>  6: tryCatchList(expr, classes, parentenv, handlers)
>  7: tryCatch(expr, error = function(e) {    call <- conditionCall(e)
>  if (!is.null(call)) {        if (identical(call[[1]],
> quote(doTryCatch)))             call <- sys.call(-4)        dcall <-
> deparse(call)[1]        prefix <- paste("Error in", dcall, ": ")
>  LONG <- 75        msg <- conditionMessage(e)        sm <-
> strsplit(msg, "\n")[[1]]        if (14 + nchar(dcall, type = "w") +
> nchar(sm[1], type = "w") >             LONG)             prefix <-
> paste(prefix, "\n  ", sep = "")    }    else prefix <- "Error : "
> msg <- paste(prefix, conditionMessage(e), "\n", sep = "")
> .Internal(seterrmessage(msg[1]))    if (!silent &&
> identical(getOption("show.error.messages"),         TRUE)) {
> cat(msg, file = stderr())        .Internal(printDeferredWarnings())
> }    invisible(structure(msg, class = "try-error"))})
>  8: try(firstlib(which.lib.loc, package))
>  9: library("Rmpi")
>
> Possible actions:
> 1: abort (with core dump, if enabled)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> Selection:
>
> --
> Mark W. Kimpel MD ** Neuroinformatics ** Dept. of Psychiatry
> Indiana University School of Medicine
>
> 15032 Hunter Court, Westfield, IN 46074
>
> (317) 490-5129 Work, & Mobile & VoiceMail
> (317) 663-0513 Home (no voice mail please)
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


**********************************************************************
The contents of this email are for the named addressee(s...{{dropped:6}}


From edd at debian.org  Wed Jun 11 14:22:21 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 11 Jun 2008 07:22:21 -0500
Subject: [Rd] Rmpi segfault after install on Ubuntu Hardy Heron
In-Reply-To: <6b93d1830806102146k1f91b723q2f7918d4a95043e6@mail.gmail.com>
References: <6b93d1830806102146k1f91b723q2f7918d4a95043e6@mail.gmail.com>
Message-ID: <18511.50045.300225.144687@ron.nulle.part>


On 11 June 2008 at 00:46, Mark Kimpel wrote:
| I just installed Rmpi on my 64-bit Ubuntu Hardy Heron OS and using the
| following without errors:
| "R CMD INSTALL Rmpi_0.5-5.tar.gz --configure-args=--with-mpi=/usr/lib64/openmpi"

And it concluded without warnings or errors? Configure found all the right files?

As Paul suggested, make sure you're not getting it mixed with
exisiting LAM headers or MPICH2 headers or, say, that you're getting your gcc
and icc experiemenst mixed up or ...  ?

I control this by locally re-building the Debian packages for Open MPI. That
way I only keep one -dev package for MPI and can ensure that I do not get
mixups with other MPI installation. But then I do buy into the Package
Management mantra, but not everybody does...
 
| Immediately at library(Rmpi) I get the segfault displayed in my
| complete output below. My first thought is that perhaps I used the
| wrong library for openmpi, but with my 64 bit install it seemed like a
| logical choice and the install went without a hitch.

Check ldd on Rmpi.so to ensure that you linked against what you thought you
should link against.

And if everything else fails, debug the compiled code and run R under the
debuggger.  See the 'R Extensions' manual.
 
| Two other general comments:
| 1. Am I addressing this to the correct list or should I use R-help? As
| I read the posting guide, I'm not sure.
| 2. Has anyone considered an R-SIG-HPC list? Anyone besides me interested?

I'd join.

Dirk

-- 
Three out of two people have difficulties with fractions.


From maechler at stat.math.ethz.ch  Wed Jun 11 16:12:02 2008
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 11 Jun 2008 16:12:02 +0200
Subject: [Rd] Posting Guide - help.request() function?
In-Reply-To: <484FBC19.3040805@warwick.ac.uk>
References: <971536df0806061030i75474172xff100ece76a23eec@mail.gmail.com>
	<971536df0806070638w48afb954y77278659edd37802@mail.gmail.com>
	<971536df0806071024x688e1bcfvac6a1c8a43182170@mail.gmail.com>
	<484D3F9D.7010404@warwick.ac.uk>
	<971536df0806090818l7acc330cy51746b3f815b9a7a@mail.gmail.com>
	<484D587D.9040101@warwick.ac.uk>
	<18509.38499.830075.619012@cmath-5.math.ethz.ch>
	<484FBC19.3040805@warwick.ac.uk>
Message-ID: <18511.56626.589004.791676@stat.math.ethz.ch>

>>>>> "HT" == Heather Turner <Heather.Turner at warwick.ac.uk>
>>>>>     on Wed, 11 Jun 2008 12:50:49 +0100 writes:

    HT> Okay, here's the update.
    HT> I've created a new function create.post() (with Windows and Unix 
    HT> versions) which would be the internal function that creates the post 
    HT> template ready to edit and optionally send. In the Windows version I've 
    HT> added an experimental method == "mailto" option, which will open the 
    HT> post template in the default mailer (e.g. Outlook) ready to edit and 
    HT> post. Maybe a Unix version would also be nice, e.g.

    HT> browseURL("mailto:r-bugs at r-project.org?subject=my bug&body=%0A<<insert 
    HT> bug report here>>%0A%0A%0A%0A--please do not edit the information 
    HT> below--%0A%0AVersion:%0A platform = x86_64-unknown-linux-gnu%0A ...")

    HT> would open the post template in e.g. Thunderbird, but has the side 
    HT> effect of opening an empty page in the web browser. I don't know if 
    HT> there's a neater solution?

Well, the current solution {for bug.report()} seems quite
desirable to me on unix.

    HT> The create.post() function is basically the old bug.report() with two 
    HT> extra arguments: 'description' (e.g. "bug report") and 'instructions' 
    HT> (e.g. "\\n<<Type your message here>>\\n") for customization. It could be 
    HT> used directly e.g to post to R-devel with session information.

    HT> The new bug.report() simply calls create.post() with the appropriate 
    HT> arguments.

Thank you; that's a really nice example of code reuse!

    HT> The improved help-request() function calls create.post() after running 
    HT> through the checks described before.

    HT> In response to Gabor's comments, help.request():

    HT> - now checks packages are up-to-date and gives option to update 
    HT> on-the-fly (user may not know whether involved in query, so check all)

This is a bit problematic as now.
E.g., we have about 1500 packages installed, and inspite of automatic
updating, never all are current, and the updating should typically
not happen on a user (but a site-wide) level anyway.
Also, the call to old.packages()  takes minutes (the
first time in an R session) if you have so many packages in a
dozen libraries.  

This should really not interfere with an e-mail for help,
rather I think that the "packages-up-to-date check"
should only happen for those non-standard packages that are
currently in use as from sessionInfo().

Unfortunately, that functionality to do that is not yet there
in old.packages(), but I am about to add that option to R-devel
as well.

No need to send me a new version of your code, BTW, since I have
already worked on it in several places.

    HT> - keeps default mailing options as in old bug.report() but 
    HT> create.post() gives clearer message ("Email the post now?\n (yes/no)") 
    HT> requiring definite response ("yes" vs "y")

ok.

    HT> - still uses online documents because some are only available online 
    HT> (R Site Search, posting guide), it ensures the most up-to-date 
    HT> documentation is used, and it allows direction to global FAQ page, 
    HT> avoiding need to check whether user is on Windows/Mac

    HT> - uses more robust method of checking R version is up-to-date

    HT> I've also written a help file for help.request() which includes the 
    HT> method="mailto" option. 
ok {it did need some correction}.

    HT> The help file for bug.report would need updating 
    HT> if this option was kept.

I think this is mainly a windows feature (but maybe not).
I'd definitely like to get some feedback from Windows users
about this.

    HT> Best wishes,
    HT> Heather

Thanks again, Heather, for this.
This is becoming a very nice new feature!

Martin


From tadakado at gmail.com  Wed Jun 11 16:12:09 2008
From: tadakado at gmail.com (Tadashi Kadowaki)
Date: Wed, 11 Jun 2008 23:12:09 +0900
Subject: [Rd] Makevars or congiure for multi platforms
In-Reply-To: <alpine.LFD.1.10.0806101645010.24415@gannet.stats.ox.ac.uk>
References: <27d1e6020806080349v28b60a51vf9661ae726aa8e90@mail.gmail.com>
	<dcb3073c0806081017k7aa4d89bv2f3a4528ac822fb8@mail.gmail.com>
	<alpine.LFD.1.10.0806081949080.8051@gannet.stats.ox.ac.uk>
	<dcb3073c0806091104o21f52b1g49d4a70074fca272@mail.gmail.com>
	<alpine.LFD.1.10.0806091919490.13495@gannet.stats.ox.ac.uk>
	<dcb3073c0806100844x715e361epf822e4439809b97f@mail.gmail.com>
	<alpine.LFD.1.10.0806101645010.24415@gannet.stats.ox.ac.uk>
Message-ID: <dcb3073c0806110712w7f13847etae8886ed84a8990c@mail.gmail.com>

Prof. Ripley,

>>> Which entries were you wanting to use?

In this case, I would use the followings in Rconfig.h,
then I don't have to add extra settings in congure.ac

#define HAVE_ERRNO_H 1
#define HAVE_ICONV 1
#define HAVE_INTPTR_T 1
#define HAVE_UINTPTR_T 1
#define ICONV_LATIN1 1
#define RETSIGTYPE void
#define Unix 1
(or #define Win 1)

But, I would say that If Rconfig.h contains all entries in config.h,
I don't have to use congure at all. Just write #include <Rconfig.h>.

Regards,

Tadashi Kadowaki

2008/6/11 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
> On Wed, 11 Jun 2008, Tadashi Kadowaki wrote:
>
>> Prof. Ripley,
>>
>> Yes, I can configure when I write configure.ac correctly.
>> But, If you provide all settings in Rconfig.h, I don't have to
>> write configure.ac. That is a big benefit for package developers.
>
> Well, unlikely as no one else has requested it and I don't see configure
> scripts in packages repeating that in R.  So let me repeat
>
>>> Which entries were you wanting to use?
>
>
>> Actually I haven't written correct configure.ac yet.
>>
>> Regards,
>>
>> Tadashi Kadowaki
>>
>> 2008/6/10 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
>>>
>>> On Tue, 10 Jun 2008, Tadashi Kadowaki wrote:
>>>
>>>> Prof Ripley,
>>>>
>>>> I fixed and uploaded.
>>>>
>>>> However, it is still useful for development of a package that is close
>>>> to R core,
>>>> if Rconfig.h contains all definitions in config.h. If Rconfig
>>>> contained all information,
>>>> I didn't have to refer the private header directory.
>>>
>>> But your package can run its own configure to find such things itself.
>>> Which
>>> entries were you wanting to use?
>>>
>>>>
>>>> Regards,
>>>>
>>>> Tadashi Kadowaki
>>>>
>>>> 2008/6/9 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
>>>>>
>>>>> Private headers are just that, private.  They are not intended to be
>>>>> available to packages, and not installed by the standard R makefiles on
>>>>> either Unix-alikes or Windows.
>>>>>
>>>>> I don't see it documented that they are available on MacOS X, and will
>>>>> leave
>>>>> it to that platform's maintainers as to why they have been installed on
>>>>> that
>>>>> platform.
>>>>>
>>>>> You need to rewrite your code to use only documented headers and entry
>>>>> points if you intend to distribute it.
>>>>>
>>>>>
>>>>> On Mon, 9 Jun 2008, Tadashi Kadowaki wrote:
>>>>>
>>>>>> Hi, Laurent and Tobias
>>>>>>
>>>>>> Thanks a lot.
>>>>>>
>>>>>> I could make configure script and upload it to r-forge.
>>>>>> https://r-forge.r-project.org/projects/pdf2/
>>>>>> It still works only on mac by default.
>>>>>> For Linux and Windows, it needs additional option like
>>>>>> -----
>>>>>> R CMD INSTALL
>>>>>> --configure-vars="R_INTERNAL_HEADER_DIR=/path/to/src/include"
>>>>>> pdf2/pkg
>>>>>> -----
>>>>>> ,where /path/to/src/include is the directory in the R source.
>>>>>> I didn't check it for Linux and Windows...
>>>>>>
>>>>>> Regards,
>>>>>>
>>>>>> Tadashi Kadowaki
>>>>>>
>>>>>> 2008/6/8 Laurent Gautier <lgautier at gmail.com>:
>>>>>>>
>>>>>>> 2008/6/7  <r-devel-request at r-project.org>:
>>>>>>>>
>>>>>>>> Message: 11
>>>>>>>> Date: Sat, 7 Jun 2008 03:38:23 +0900
>>>>>>>> From: "Tadashi Kadowaki" <tadakado at gmail.com>
>>>>>>>> Subject: [Rd] Makevars or congiure for multi platforms
>>>>>>>> To: r-devel at r-project.org
>>>>>>>> Message-ID:
>>>>>>>>     <dcb3073c0806061138n2f376a24r100f281ae248497a at mail.gmail.com>
>>>>>>>> Content-Type: text/plain; charset=ISO-8859-1
>>>>>>>>
>>>>>>>> Dear all,
>>>>>>>>
>>>>>>>> As previously submitted, I wrote an extending pdf device to embed
>>>>>>>> pop up text and web links.
>>>>>>>> (Patches are available at http://pdf2.r-forge.r-project.org/patches)
>>>>>>>>
>>>>>>>> Now, I'm making a library version of the pdf device.
>>>>>>>> However, with my skill, I'm not sure about writing Makevars or
>>>>>>>> configure
>>>>>>>> file
>>>>>>>> for multi platforms. A following line in Makevars works on my mac,
>>>>>>>> -----
>>>>>>>> PKG_CFLAGS=-I/Library/Frameworks/R.framework/PrivateHeaders
>>>>>>>> -DHAVE_CONFIG_H
>>>>>>>> -----
>>>>>>>> (Note that the PrivateHeaders directory contains Fileio.h and
>>>>>>>> Defn.h)
>>>>>>>>
>>>>>>>> My question is,
>>>>>>>> How do I write Makevars or congiure for Unix/Linux and Windows?
>>>>>>>> I would like to support those platforms in my library.
>>>>>>>
>>>>>>> You could try looking into a package that has configure,
>>>>>>> configure.win
>>>>>>> and has built binaries for macosX and windows. Try the package 'rgl'
>>>>>>> on CRAN, for example.
>>>>>>>
>>>>>>>
>>>>>>> Hoping this helps,
>>>>>>>
>>>>>>>
>>>>>>> L.
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>> Regards,
>>>>>>>>
>>>>>>>> Tadashi Kadowaki
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>
>>>>>
>>>>> --
>>>>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>>>>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>>>>> University of Oxford,             Tel:  +44 1865 272861 (self)
>>>>> 1 South Parks Road,                     +44 1865 272866 (PA)
>>>>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>>>>
>>>>
>>>
>>> --
>>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>>> University of Oxford,             Tel:  +44 1865 272861 (self)
>>> 1 South Parks Road,                     +44 1865 272866 (PA)
>>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>>
>>
>
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>


From kw.statr at gmail.com  Wed Jun 11 16:50:22 2008
From: kw.statr at gmail.com (kw.statr at gmail.com)
Date: Wed, 11 Jun 2008 16:50:22 +0200 (CEST)
Subject: [Rd] [ESS] browser() exits when not desired,
	in three different scenarios (PR#11634)
Message-ID: <20080611145022.D776B283416D@mail.pubhealth.ku.dk>

Tim, I have reported some similar issues a while back and there was
some discussion on this topic:
http://tolstoy.newcastle.edu.au/R/devel/06/03/4609.html
Good luck,
Kevin


On Tue, Jun 10, 2008 at 6:47 PM, Tim Hesterberg <timhesterberg at gmail.com> wrote:
> Here are three different scenarios in which the browser() exits
> when I don't want it to.  These are all related to the browser
> accepting either c or (return) to exit.  I would like an option
> to turn off the (return) behavior in order to avoid these problems.
>
>
>
> # Case 1 - when calling help
> # Note, I am using ESS in emacs; this is probably an interaction
> # with ESS handling of ? help.
>> f <- function(x){
> +   browser()
> +   length(x)
> + }
>> f(1:4)
> Called from: f(1:4)
> Browse[1]> ?rep
> [1] 4
>>
> # The help was given, but the browser exits.
>
>
> # Case 2 - when pasting in a command that stretches over
> # two lines.
> # With f defined as above, call f, select the following two lines in
> # an emacs buffer (using c-w clipboard-kill-ring-save) and yank them
> into the *R* buffer:
> mean(x,
>     trim = .2)
> # The result:
>> f(1:4)
> Called from: f(1:4)
> Browse[1]> mean(x,
>     trim = .2)
>
> mean(x,
> +      trim = .2)
> [1] 2.5
> Browse[1]>
> [1] 4
>>
> # The multi-line command was echoed (twice--this is probably an ESS
> problem or misconfiguration), ran, and the browser exits.
>
>
> # Case 3 - when pasting in a line at a time, including blank lines.
> I like to include blank lines in my code for readability.
> When I paste in multiple lines, the blank lines cause the browser
> to exit.
>
> I reported case 3 before; it is the single thing that bothers
> me most about R.  Someone suggested using
> ess-eval-line-and-step in ESS; this is nice for one line, but does not
> support C-u for sending multiple lines, and doesn't apply when
> I'm not using ESS.
>
> Tim Hesterberg
>
> --please do not edit the information below--
>
> Version:
>  platform = i486-pc-linux-gnu
>  arch = i486
>  os = linux-gnu
>  system = i486, linux-gnu
>  status =
>  major = 2
>  minor = 7.0
>  year = 2008
>  month = 04
>  day = 22
>  svn rev = 45424
>  language = R
>  version.string = R version 2.7.0 (2008-04-22)
>
> Locale:
> LC_CTYPE=en_US;LC_NUMERIC=C;LC_TIME=C;LC_COLLATE=C;LC_MONETARY=C;LC_MESSAGES=en_US;LC_PAPER=en_US;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US;LC_IDENTIFICATION=C
>
> Search Path:
>  .GlobalEnv, package:stats, package:graphics, package:grDevices,
> package:utils, package:datasets, package:showStructure, package:Rcode,
> package:splus2R, package:methods, Autoloads, package:base
>
>        [[alternative HTML version deleted]]
>
> ______________________________________________
> ESS-help at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/ess-help
>


From krcoombes at mdacc.tmc.edu  Wed Jun 11 17:05:34 2008
From: krcoombes at mdacc.tmc.edu (Kevin R. Coombes)
Date: Wed, 11 Jun 2008 10:05:34 -0500
Subject: [Rd] Routine and Deep testing with R CMD check
Message-ID: <484FE9BE.2040904@mdacc.tmc.edu>

Hi,

I recently provoked some discussion over on the BioConductor developer 
list about testing and R CMD check. In brief, the salient points that 
arose from the discussion are:

[1] Because of the need for a nightly build of BioConductor, the tests 
(in the ./tests directory) of a package that run routinely as part of "R 
CMD check" must complete in five minutes.
[2] Nontrivial regression testing of complex algorithms on real data can 
easily take longer than five minutes.
[3] Maintaining and improving code that works on various kinds of 
"omics" data is greatly facilitated by the inclusion of nontrivial 
regression tests.

Of course, points [1] and [3] are incompatible in the current setup. 
Both could, however, be accommodated by changing the way "R CMD check" 
runs test scripts. There are at least two ways this could be accomplished.

One possibility would be to define a separate directory as part of the 
package structure to store the more complex, longer, "deep" tests. That 
is, one might have
	package/R
	package/man
	package/tests
	package/deeptests  [or some better name]
Then the default for "R CMD check" would be to run all the .R scripts in 
tests but none of the .R scripts in deep tests. However, one would also 
have to add an option, perhaps something like
	R CMD check --run-deeptests [package]
to run the more elaborate test scripts.

The second possibility would be to keep all the tests in the same 
(existing ./tests) directory but include a standard file in that 
directory to indicate which scripts are more complex.  This would be a 
little trickier to design, since it would be nice to keep the existing 
behavior for someone who ignores the new structure. One, could however, 
allow for something like

----------------------------
## CONTROLTESTS

complex: test1.R, test3.R
simple:  test2.R, test4.R
-----------------------------

The default (in the absence of A CONTROLTESTS file or for scripts in the 
directory that are not listed in the file) is to assume "simple", which 
would then get the existing behavior without changes to existing packages.

How hard would it be to implement one of these approaches for R CMD check?

  -- Kevin


From jeff.a.ryan at gmail.com  Wed Jun 11 17:25:40 2008
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Wed, 11 Jun 2008 10:25:40 -0500
Subject: [Rd] Routine and Deep testing with R CMD check
In-Reply-To: <484FE9BE.2040904@mdacc.tmc.edu>
References: <484FE9BE.2040904@mdacc.tmc.edu>
Message-ID: <e8e755250806110825n66ece21cy14ff377a623e5cf5@mail.gmail.com>

A combination of RUnit from CRAN and .Rbuildignore provide a workable
solution for the 'xts' package I work on, though this obviously
removes the tests from the distributed code.

http://cran.r-project.org/web/packages/RUnit/index.html

--and--

http://wiki.r-project.org/rwiki/doku.php?id=developers:runit

Jeff

On Wed, Jun 11, 2008 at 10:05 AM, Kevin R. Coombes
<krcoombes at mdacc.tmc.edu> wrote:
> Hi,
>
> I recently provoked some discussion over on the BioConductor developer list
> about testing and R CMD check. In brief, the salient points that arose from
> the discussion are:
>
> [1] Because of the need for a nightly build of BioConductor, the tests (in
> the ./tests directory) of a package that run routinely as part of "R CMD
> check" must complete in five minutes.
> [2] Nontrivial regression testing of complex algorithms on real data can
> easily take longer than five minutes.
> [3] Maintaining and improving code that works on various kinds of "omics"
> data is greatly facilitated by the inclusion of nontrivial regression tests.
>
> Of course, points [1] and [3] are incompatible in the current setup. Both
> could, however, be accommodated by changing the way "R CMD check" runs test
> scripts. There are at least two ways this could be accomplished.
>
> One possibility would be to define a separate directory as part of the
> package structure to store the more complex, longer, "deep" tests. That is,
> one might have
>        package/R
>        package/man
>        package/tests
>        package/deeptests  [or some better name]
> Then the default for "R CMD check" would be to run all the .R scripts in
> tests but none of the .R scripts in deep tests. However, one would also have
> to add an option, perhaps something like
>        R CMD check --run-deeptests [package]
> to run the more elaborate test scripts.
>
> The second possibility would be to keep all the tests in the same (existing
> ./tests) directory but include a standard file in that directory to indicate
> which scripts are more complex.  This would be a little trickier to design,
> since it would be nice to keep the existing behavior for someone who ignores
> the new structure. One, could however, allow for something like
>
> ----------------------------
> ## CONTROLTESTS
>
> complex: test1.R, test3.R
> simple:  test2.R, test4.R
> -----------------------------
>
> The default (in the absence of A CONTROLTESTS file or for scripts in the
> directory that are not listed in the file) is to assume "simple", which
> would then get the existing behavior without changes to existing packages.
>
> How hard would it be to implement one of these approaches for R CMD check?
>
>  -- Kevin
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
There's a way to do it better - find it.
Thomas A. Edison


From bill at insightful.com  Wed Jun 11 18:17:54 2008
From: bill at insightful.com (Bill Dunlap)
Date: Wed, 11 Jun 2008 09:17:54 -0700 (PDT)
Subject: [Rd] Routine and Deep testing with R CMD check
In-Reply-To: <484FE9BE.2040904@mdacc.tmc.edu>
References: <484FE9BE.2040904@mdacc.tmc.edu>
Message-ID: <Pine.GSO.4.56.0806110911130.9359@devsun3201.insightful.com>

On Wed, 11 Jun 2008, Kevin R. Coombes wrote:

> [1] Because of the need for a nightly build of BioConductor, the tests
> (in the ./tests directory) of a package that run routinely as part of "R
> CMD check" must complete in five minutes.
> [2] Nontrivial regression testing of complex algorithms on real data can
> easily take longer than five minutes.
> [3] Maintaining and improving code that works on various kinds of
> "omics" data is greatly facilitated by the inclusion of nontrivial
> regression tests.
>
> Of course, points [1] and [3] are incompatible in the current setup.
> Both could, however, be accommodated by changing the way "R CMD check"
> runs test scripts. There are at least two ways this could be accomplished.

Another approach is to have check use the new-to-2.8.0 function
setSessionTimeLimit() to let the checker put a time limit on
the tests.  In a time-constrained environment you could ask check
to spend no more than 5 minutes running the tests but you could
also set the limit to 3 hours or Inf or anything else.

This would only be useful if the quicker tests were done first,
so you'd have to alphabetize your test files.

It might be nice if check could print the time it took to do
each test.

----------------------------------------------------------------------------
Bill Dunlap
Insightful Corporation
bill at insightful dot com

 "All statements in this message represent the opinions of the author and do
 not necessarily reflect Insightful Corporation policy or position."


From bill at insightful.com  Wed Jun 11 18:37:56 2008
From: bill at insightful.com (Bill Dunlap)
Date: Wed, 11 Jun 2008 09:37:56 -0700 (PDT)
Subject: [Rd] read.table() causes segfault with incorrect data (PR#11627)
In-Reply-To: <20080611054003.D1E67283416D@mail.pubhealth.ku.dk>
References: <20080611054003.D1E67283416D@mail.pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.56.0806110932260.9359@devsun3201.insightful.com>

On Wed, 11 Jun 2008 juho.vuori at fimr.fi wrote:

> Full_Name: Juho Vuori
> Version: 2.7.0 (2008-04-22)
> OS: Linux poseidon.fimr.fi 2.6.23.17-88.fc7PAE #1 SMP Thu May 15 00:22:53 EDT 2008 i686 i686 i386 GNU/Linux
> Submission from: (NULL) (193.166.188.194)
>
>
> Calling read.table() twice the following way causes a segmentation fault in R.
> Run R and type the following commands:
>
> > read.table(stdin())
> 0: 1 2 3
> 1: 3
> 2:
> Error in scan(file, what, nmax, sep, dec, quote, skip, nlines, na.strings,  :
>   line 2 did not have 3 elements
> > read.table(stdin())
>
>  *** caught segfault ***
> address 0x64616572, cause 'memory not mapped'
>

valgrind shows that con->nPushBack>0 but con->PushBack
has already been freed by do_clearpushback:

    > read.table(stdin())
    0: 1 2 3
    1: 3
    2:
    Error in scan(file, what, nmax, sep, dec, quote, skip, nlines, na.strings,  :
      line 2 did not have 3 elements
    > read.table(stdin())
    ==11631== Invalid read of size 4
    ==11631==    at 0x80B3281: ConsoleGetcharWithPushBack (scan.c:130)
    ==11631==    by 0x80B348E: scanchar (scan.c:214)
    ==11631==    by 0x80B7E24: do_readtablehead (scan.c:1568)
    ==11631==    by 0x80653E0: do_internal (names.c:1129)
    ...
    ==11631==  Address 0x443E638 is 0 bytes inside a block of size 20 free'd
    ==11631==    at 0x40052A3: free (vg_replace_malloc.c:233)
    ==11631==    by 0x8128A41: do_clearpushback (connections.c:3671)
    ==11631==    by 0x80653E0: do_internal (names.c:1129)
    ==11631==    by 0x815EA27: Rf_eval (eval.c:461)
    ==11631==    by 0x812B133: R_run_onexits (context.c:147)

    0x080b3281 in ConsoleGetcharWithPushBack (con=0x4067c50) at scan.c:130
    130             curLine = con->PushBack[con->nPushBack-1];
    (gdb) print con
    $1 = 0x4067c50
    (gdb) print con->PushBack
    $2 = (char **) 0x443e638

The following change to connections.c:do_clearpushback() seems to fix it.

Index: connections.c
===================================================================
--- connections.c       (revision 45893)
+++ connections.c       (working copy)
@@ -3669,6 +3669,7 @@
     if(con->nPushBack > 0) {
        for(j = 0; j < con->nPushBack; j++) free(con->PushBack[j]);
        free(con->PushBack);
+        con->nPushBack = 0 ;
     }
     return R_NilValue;
 }

----------------------------------------------------------------------------
Bill Dunlap
Insightful Corporation
bill at insightful dot com

 "All statements in this message represent the opinions of the author and do
 not necessarily reflect Insightful Corporation policy or position."


From ripley at stats.ox.ac.uk  Wed Jun 11 19:24:40 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 11 Jun 2008 18:24:40 +0100 (BST)
Subject: [Rd] Routine and Deep testing with R CMD check
In-Reply-To: <Pine.GSO.4.56.0806110911130.9359@devsun3201.insightful.com>
References: <484FE9BE.2040904@mdacc.tmc.edu>
	<Pine.GSO.4.56.0806110911130.9359@devsun3201.insightful.com>
Message-ID: <alpine.LFD.1.10.0806111815130.30216@gannet.stats.ox.ac.uk>

On Wed, 11 Jun 2008, Bill Dunlap wrote:

> On Wed, 11 Jun 2008, Kevin R. Coombes wrote:
>
>> [1] Because of the need for a nightly build of BioConductor, the tests
>> (in the ./tests directory) of a package that run routinely as part of "R
>> CMD check" must complete in five minutes.
>> [2] Nontrivial regression testing of complex algorithms on real data can
>> easily take longer than five minutes.
>> [3] Maintaining and improving code that works on various kinds of
>> "omics" data is greatly facilitated by the inclusion of nontrivial
>> regression tests.
>>
>> Of course, points [1] and [3] are incompatible in the current setup.
>> Both could, however, be accommodated by changing the way "R CMD check"
>> runs test scripts. There are at least two ways this could be accomplished.
>
> Another approach is to have check use the new-to-2.8.0 function
> setSessionTimeLimit() to let the checker put a time limit on
> the tests.  In a time-constrained environment you could ask check
> to spend no more than 5 minutes running the tests but you could
> also set the limit to 3 hours or Inf or anything else.
>
> This would only be useful if the quicker tests were done first,
> so you'd have to alphabetize your test files.

Or to use environment variable(s) to select which tests to do (which is 
what I had started to write a reply to suggest when I got diverted to 
something more urgent).  E.g. 'foreign' has a slow test that needs 
Internet access, and it will become optional via an environment variable 
in the next release.

BTW, some of us run checks with a Unix-level time limit set: there are a 
few CRAN packages that infinite-loop on 64-bit systems so it is a 
necessary precaution.

> It might be nice if check could print the time it took to do
> each test.

That's an existing request for various parts of the checking procedure. 
When the time to run a package check jumps up, it is sometimes tedious to 
find out where the time went.  But the tests are currently scripted by 
make, so difficult to produce timings portably.

> Bill Dunlap

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From bill at insightful.com  Wed Jun 11 19:45:05 2008
From: bill at insightful.com (Bill Dunlap)
Date: Wed, 11 Jun 2008 10:45:05 -0700 (PDT)
Subject: [Rd] Routine and Deep testing with R CMD check
In-Reply-To: <alpine.LFD.1.10.0806111815130.30216@gannet.stats.ox.ac.uk>
References: <484FE9BE.2040904@mdacc.tmc.edu>
	<Pine.GSO.4.56.0806110911130.9359@devsun3201.insightful.com>
	<alpine.LFD.1.10.0806111815130.30216@gannet.stats.ox.ac.uk>
Message-ID: <Pine.GSO.4.56.0806111032390.9359@devsun3201.insightful.com>

On Wed, 11 Jun 2008, Prof Brian Ripley wrote:

> Bill Dunlap wrote:
> > It might be nice if check could print the time it took to do
> > each test.
>
> That's an existing request for various parts of the checking procedure.
> When the time to run a package check jumps up, it is sometimes tedious to
> find out where the time went.  But the tests are currently scripted by
> make, so difficult to produce timings portably.

In Splus, if you set options(verbose=TRUE), then the time
for each top level expression is printed to stdout (or
to a log file, depending on other options).  The Time:
line tells which top level expression it refers to and
whether the expression succeeded or failed.  E.g.,

   > options(verbose=TRUE)
      Time: Task #2 succeeded (Seconds = 0.01 CPU, 0.01 elapsed)
   > for(i in 1:1e5)log(i)
      Time: Task #3 succeeded (Seconds = 1.49 CPU, 1.5 elapsed)
   > for(i in 1:1e5) if (i==1e5) stop("i is too big") else log(i)
     Error: Problem: i is too big
   Problem: i is too big
   Use traceback() to see the call stack
      Time: Task #4 failed (Seconds = 3.18 CPU, 3.2 elapsed)

If R had this sort of logging then check could turn it on
when desired.

Splus also uses this logging mechanism to log calls to
read.table() and inputData(), to record the initial
value of .Random.seed, etc., so one can run a perl script
over the log file for a batch run to see if there were
significant problems and have enough information to
reproduce the problems found.

----------------------------------------------------------------------------
Bill Dunlap
Insightful Corporation
bill at insightful dot com

 "All statements in this message represent the opinions of the author and do
 not necessarily reflect Insightful Corporation policy or position."


From Ray.Brownrigg at mcs.vuw.ac.nz  Thu Jun 12 06:05:59 2008
From: Ray.Brownrigg at mcs.vuw.ac.nz (Ray Brownrigg)
Date: Thu, 12 Jun 2008 16:05:59 +1200
Subject: [Rd] arima() bug
Message-ID: <200806121605.59981.Ray.Brownrigg@mcs.vuw.ac.nz>

I guess this is more r-devel than r-help.

Note, I am just the messenger - I have no idea what the user is trying to model here.

arima() crashes R (segfault) with Linux R-2.7.0, Solaris R-2.6.0:

 *** caught segfault ***
address 42400000, cause 'memory not mapped'

Traceback:
 1: .Call(R_getQ0, phi, theta)
 2: makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa)
 3: arima(x, c(1, 0, 1), c(1, 0, 1))

Under rw-2.7.0 or R version 2.8.0 Under development (unstable) (2008-06-10 r45893)
it gets:
Error: cannot allocate vector of size 1010.9 Mb
In addition: Warning messages:
1: In makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa) :
  Reached total allocation of 447Mb: see help(memory.size)
2: In makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa) :
  Reached total allocation of 447Mb: see help(memory.size)
3: In makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa) :
  Reached total allocation of 447Mb: see help(memory.size)
4: In makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa) :
  Reached total allocation of 447Mb: see help(memory.size)

Reproduce by:

# 2 years of daily temperature data
set.seed(1); x <- ts(20*sin((1:731)*2*pi/365) + 10 + rnorm(731, 0, 4), freq=365)
arima(x, c(1, 0, 1), c(1, 0, 1))

Ray Brownrigg


From antonio.fabio at gmail.com  Thu Jun 12 09:27:45 2008
From: antonio.fabio at gmail.com (Antonio, Fabio Di Narzo)
Date: Thu, 12 Jun 2008 09:27:45 +0200
Subject: [Rd] arima() bug
In-Reply-To: <200806121605.59981.Ray.Brownrigg@mcs.vuw.ac.nz>
References: <200806121605.59981.Ray.Brownrigg@mcs.vuw.ac.nz>
Message-ID: <b0808fdc0806120027j394df03cwf3d8e98f8ad74241@mail.gmail.com>

No segfault with my r-patched version on linux-i686:

> set.seed(1); x <- ts(20*sin((1:731)*2*pi/365) + 10 + rnorm(731, 0, 4), freq=365)
> arima(x, c(1, 0, 1), c(1, 0, 1))
Errore: cannot allocate vector of size 1010.9 Mb

F.

> R.version
               _
platform       i686-pc-linux-gnu
arch           i686
os             linux-gnu
system         i686, linux-gnu
status         Patched
major          2
minor          7.0
year           2008
month          05
day            29
svn rev        45820
language       R
version.string R version 2.7.0 Patched (2008-05-29 r45820)


2008/6/12 Ray Brownrigg <Ray.Brownrigg at mcs.vuw.ac.nz>:
> I guess this is more r-devel than r-help.
>
> Note, I am just the messenger - I have no idea what the user is trying to model here.
>
> arima() crashes R (segfault) with Linux R-2.7.0, Solaris R-2.6.0:
>
>  *** caught segfault ***
> address 42400000, cause 'memory not mapped'
>
> Traceback:
>  1: .Call(R_getQ0, phi, theta)
>  2: makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa)
>  3: arima(x, c(1, 0, 1), c(1, 0, 1))
>
> Under rw-2.7.0 or R version 2.8.0 Under development (unstable) (2008-06-10 r45893)
> it gets:
> Error: cannot allocate vector of size 1010.9 Mb
> In addition: Warning messages:
> 1: In makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa) :
>  Reached total allocation of 447Mb: see help(memory.size)
> 2: In makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa) :
>  Reached total allocation of 447Mb: see help(memory.size)
> 3: In makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa) :
>  Reached total allocation of 447Mb: see help(memory.size)
> 4: In makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa) :
>  Reached total allocation of 447Mb: see help(memory.size)
>
> Reproduce by:
>
> # 2 years of daily temperature data
> set.seed(1); x <- ts(20*sin((1:731)*2*pi/365) + 10 + rnorm(731, 0, 4), freq=365)
> arima(x, c(1, 0, 1), c(1, 0, 1))
>
> Ray Brownrigg
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Antonio, Fabio Di Narzo
Ph.D. student at
Department of Statistical Sciences
University of Bologna, Italy


From ripley at stats.ox.ac.uk  Thu Jun 12 09:48:34 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 12 Jun 2008 08:48:34 +0100 (BST)
Subject: [Rd] arima() bug
In-Reply-To: <b0808fdc0806120027j394df03cwf3d8e98f8ad74241@mail.gmail.com>
References: <200806121605.59981.Ray.Brownrigg@mcs.vuw.ac.nz>
	<b0808fdc0806120027j394df03cwf3d8e98f8ad74241@mail.gmail.com>
Message-ID: <alpine.LFD.1.10.0806120845170.21937@gannet.stats.ox.ac.uk>

On Thu, 12 Jun 2008, Antonio, Fabio Di Narzo wrote:

> No segfault with my r-patched version on linux-i686:
>
>> set.seed(1); x <- ts(20*sin((1:731)*2*pi/365) + 10 + rnorm(731, 0, 4), freq=365)
>> arima(x, c(1, 0, 1), c(1, 0, 1))
> Errore: cannot allocate vector of size 1010.9 Mb

Yes, you need a lot of memory to reproduce it.  It's a nonsensical 
calculation but nevertheless we need to track down the cause.

>
> F.
>
>> R.version
>               _
> platform       i686-pc-linux-gnu
> arch           i686
> os             linux-gnu
> system         i686, linux-gnu
> status         Patched
> major          2
> minor          7.0
> year           2008
> month          05
> day            29
> svn rev        45820
> language       R
> version.string R version 2.7.0 Patched (2008-05-29 r45820)
>
>
> 2008/6/12 Ray Brownrigg <Ray.Brownrigg at mcs.vuw.ac.nz>:
>> I guess this is more r-devel than r-help.
>>
>> Note, I am just the messenger - I have no idea what the user is trying to model here.
>>
>> arima() crashes R (segfault) with Linux R-2.7.0, Solaris R-2.6.0:
>>
>>  *** caught segfault ***
>> address 42400000, cause 'memory not mapped'
>>
>> Traceback:
>>  1: .Call(R_getQ0, phi, theta)
>>  2: makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa)
>>  3: arima(x, c(1, 0, 1), c(1, 0, 1))
>>
>> Under rw-2.7.0 or R version 2.8.0 Under development (unstable) (2008-06-10 r45893)
>> it gets:
>> Error: cannot allocate vector of size 1010.9 Mb
>> In addition: Warning messages:
>> 1: In makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa) :
>>  Reached total allocation of 447Mb: see help(memory.size)
>> 2: In makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa) :
>>  Reached total allocation of 447Mb: see help(memory.size)
>> 3: In makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa) :
>>  Reached total allocation of 447Mb: see help(memory.size)
>> 4: In makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa) :
>>  Reached total allocation of 447Mb: see help(memory.size)
>>
>> Reproduce by:
>>
>> # 2 years of daily temperature data
>> set.seed(1); x <- ts(20*sin((1:731)*2*pi/365) + 10 + rnorm(731, 0, 4), freq=365)
>> arima(x, c(1, 0, 1), c(1, 0, 1))
>>
>> Ray Brownrigg
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
>
> -- 
> Antonio, Fabio Di Narzo
> Ph.D. student at
> Department of Statistical Sciences
> University of Bologna, Italy
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From P.Dalgaard at biostat.ku.dk  Thu Jun 12 11:26:09 2008
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 12 Jun 2008 11:26:09 +0200
Subject: [Rd]  2.7.1 scheduled for November 26
Message-ID: <4850EBB1.8010109@biostat.ku.dk>

This is to announce that we plan to release R version 2.7.1 on Monday,
June 23, 2008.

Release procedures start tomorrow, Friday June 13.

The source tarballs will be made available daily (barring build
troubles) by a cron job running at 4AM CET, and the tarballs can be
picked up at

http://cran.r-project.org/src/base-prerelease/

a little later.

Binary builds are expected to appear starting Monday 16 at the latest.

	For the Core Team
	Peter Dalgaard


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From P.Dalgaard at biostat.ku.dk  Thu Jun 12 13:10:33 2008
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 12 Jun 2008 13:10:33 +0200
Subject: [Rd]  2.7.1 scheduled for JUNE 23
Message-ID: <48510429.8040502@biostat.ku.dk>

(Resent, now with correct date in subject. Doh!)

This is to announce that we plan to release R version 2.7.1 on Monday,
June 23, 2008.

Release procedures start tomorrow, Friday June 13.

The source tarballs will be made available daily (barring build
troubles) by a cron job running at 4AM CET, and the tarballs can be
picked up at

http://cran.r-project.org/src/base-prerelease/

a little later.

Binary builds are expected to appear starting Monday 16 at the latest.

	For the Core Team
	Peter Dalgaard


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From sgiannerini at gmail.com  Thu Jun 12 15:30:10 2008
From: sgiannerini at gmail.com (Simone Giannerini)
Date: Thu, 12 Jun 2008 15:30:10 +0200
Subject: [Rd] arima() bug
In-Reply-To: <b0808fdc0806120027j394df03cwf3d8e98f8ad74241@mail.gmail.com>
References: <200806121605.59981.Ray.Brownrigg@mcs.vuw.ac.nz>
	<b0808fdc0806120027j394df03cwf3d8e98f8ad74241@mail.gmail.com>
Message-ID: <3c12769c0806120630u7153b88fk61ea7c1a86558dc8@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080612/fa0b7501/attachment.pl>

From bill at insightful.com  Thu Jun 12 18:18:26 2008
From: bill at insightful.com (Bill Dunlap)
Date: Thu, 12 Jun 2008 09:18:26 -0700 (PDT)
Subject: [Rd] arima() bug
In-Reply-To: <200806121605.59981.Ray.Brownrigg@mcs.vuw.ac.nz>
References: <200806121605.59981.Ray.Brownrigg@mcs.vuw.ac.nz>
Message-ID: <Pine.GSO.4.56.0806120905500.20960@devsun3201.insightful.com>

On Thu, 12 Jun 2008, Ray Brownrigg wrote:

> arima() crashes R (segfault) with Linux R-2.7.0, Solaris R-2.6.0:
>
> Reproduce by:
>
> # 2 years of daily temperature data
> set.seed(1); x <- ts(20*sin((1:731)*2*pi/365) + 10 + rnorm(731, 0, 4), freq=365)
> arima(x, c(1, 0, 1), c(1, 0, 1))

I put a breakpoint in Rf_allocVector when its length argument
was more than 10 million and it stopped when library/stats/src/arima.c:getQ0
asked for a vector of nrbar=132497980 doubles, a number proportional
to the 4th power of max(length(phi),length(theta)) from the R arima():upARIMA()
function:

SEXP getQ0(SEXP sPhi, SEXP sTheta)
{
    ...
    int  p = LENGTH(sPhi), q = LENGTH(sTheta);
    ...
    int r = max(p, q + 1), np = r * (r + 1) / 2, nrbar = np * (np - 1) / 2;
    ...
    rbar = (double *) R_alloc(nrbar, sizeof(double));

(gdb) print nrbar
$1 = 132497980
(gdb) print np
$2 = 67528
(gdb) print r
$3 = 367
(gdb)  print q
$4 = 366

Trying to recover from running out of memory probably
causes the crash.

rbar is a scratch array.

----------------------------------------------------------------------------
Bill Dunlap
Insightful Corporation
bill at insightful dot com

 "All statements in this message represent the opinions of the author and do
 not necessarily reflect Insightful Corporation policy or position."


From mwkimpel at gmail.com  Fri Jun 13 00:38:56 2008
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Thu, 12 Jun 2008 18:38:56 -0400
Subject: [Rd] Rmpi segfault after install on Ubuntu Hardy Heron
In-Reply-To: <18511.50045.300225.144687@ron.nulle.part>
References: <6b93d1830806102146k1f91b723q2f7918d4a95043e6@mail.gmail.com>
	<18511.50045.300225.144687@ron.nulle.part>
Message-ID: <6b93d1830806121538t766daad8v367290677b799993@mail.gmail.com>

Dirk,

Configure concluded without errors. I am not running this on the HPC
cluster with icc, rather a separate local box used for testing and
learning. Its just an 64-bit Ubuntu 8.04 install on a 4-core machine.
LAM is not installed (I checked to make sure).

So, that leaves me with you last two options. Before I make my first
foray into using the R-debugger, I'd like to try you suggestion to
"Check ldd on Rmpi.so" but don't have a clue how to do so. Could you
instruct me?

Thanks to all for the helpful comments.
Mark

On Wed, Jun 11, 2008 at 8:22 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
>
> On 11 June 2008 at 00:46, Mark Kimpel wrote:
> | I just installed Rmpi on my 64-bit Ubuntu Hardy Heron OS and using the
> | following without errors:
> | "R CMD INSTALL Rmpi_0.5-5.tar.gz --configure-args=--with-mpi=/usr/lib64/openmpi"
>
> And it concluded without warnings or errors? Configure found all the right files?
>
> As Paul suggested, make sure you're not getting it mixed with
> exisiting LAM headers or MPICH2 headers or, say, that you're getting your gcc
> and icc experiemenst mixed up or ...  ?
>
> I control this by locally re-building the Debian packages for Open MPI. That
> way I only keep one -dev package for MPI and can ensure that I do not get
> mixups with other MPI installation. But then I do buy into the Package
> Management mantra, but not everybody does...
>
> | Immediately at library(Rmpi) I get the segfault displayed in my
> | complete output below. My first thought is that perhaps I used the
> | wrong library for openmpi, but with my 64 bit install it seemed like a
> | logical choice and the install went without a hitch.
>
> Check ldd on Rmpi.so to ensure that you linked against what you thought you
> should link against.
>
> And if everything else fails, debug the compiled code and run R under the
> debuggger.  See the 'R Extensions' manual.
>
> | Two other general comments:
> | 1. Am I addressing this to the correct list or should I use R-help? As
> | I read the posting guide, I'm not sure.
> | 2. Has anyone considered an R-SIG-HPC list? Anyone besides me interested?
>
> I'd join.
>
> Dirk
>
> --
> Three out of two people have difficulties with fractions.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Mark W. Kimpel MD ** Neuroinformatics ** Dept. of Psychiatry
Indiana University School of Medicine

15032 Hunter Court, Westfield, IN 46074

(317) 490-5129 Work, & Mobile & VoiceMail
(317) 663-0513 Home (no voice mail please)


From osklyar at ebi.ac.uk  Fri Jun 13 01:43:45 2008
From: osklyar at ebi.ac.uk (Oleg Sklyar)
Date: Fri, 13 Jun 2008 00:43:45 +0100
Subject: [Rd] Rmpi segfault after install on Ubuntu Hardy Heron
In-Reply-To: <6b93d1830806121538t766daad8v367290677b799993@mail.gmail.com>
References: <6b93d1830806102146k1f91b723q2f7918d4a95043e6@mail.gmail.com>	<18511.50045.300225.144687@ron.nulle.part>
	<6b93d1830806121538t766daad8v367290677b799993@mail.gmail.com>
Message-ID: <4851B4B1.2090508@ebi.ac.uk>

simply cd to $R_HOME/library/Rmpi/libs and do on the command line

ldd -r Rmpi.so

this will display you a list of dependencies of Rmpi.so and you can see 
if you find there the libraries that you expected to link against, or 
there will be some libraries from unexpected paths or missing ones

Mark Kimpel wrote:
> Dirk,
> 
> Configure concluded without errors. I am not running this on the HPC
> cluster with icc, rather a separate local box used for testing and
> learning. Its just an 64-bit Ubuntu 8.04 install on a 4-core machine.
> LAM is not installed (I checked to make sure).
> 
> So, that leaves me with you last two options. Before I make my first
> foray into using the R-debugger, I'd like to try you suggestion to
> "Check ldd on Rmpi.so" but don't have a clue how to do so. Could you
> instruct me?
> 
> Thanks to all for the helpful comments.
> Mark
> 
> On Wed, Jun 11, 2008 at 8:22 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
>> On 11 June 2008 at 00:46, Mark Kimpel wrote:
>> | I just installed Rmpi on my 64-bit Ubuntu Hardy Heron OS and using the
>> | following without errors:
>> | "R CMD INSTALL Rmpi_0.5-5.tar.gz --configure-args=--with-mpi=/usr/lib64/openmpi"
>>
>> And it concluded without warnings or errors? Configure found all the right files?
>>
>> As Paul suggested, make sure you're not getting it mixed with
>> exisiting LAM headers or MPICH2 headers or, say, that you're getting your gcc
>> and icc experiemenst mixed up or ...  ?
>>
>> I control this by locally re-building the Debian packages for Open MPI. That
>> way I only keep one -dev package for MPI and can ensure that I do not get
>> mixups with other MPI installation. But then I do buy into the Package
>> Management mantra, but not everybody does...
>>
>> | Immediately at library(Rmpi) I get the segfault displayed in my
>> | complete output below. My first thought is that perhaps I used the
>> | wrong library for openmpi, but with my 64 bit install it seemed like a
>> | logical choice and the install went without a hitch.
>>
>> Check ldd on Rmpi.so to ensure that you linked against what you thought you
>> should link against.
>>
>> And if everything else fails, debug the compiled code and run R under the
>> debuggger.  See the 'R Extensions' manual.
>>
>> | Two other general comments:
>> | 1. Am I addressing this to the correct list or should I use R-help? As
>> | I read the posting guide, I'm not sure.
>> | 2. Has anyone considered an R-SIG-HPC list? Anyone besides me interested?
>>
>> I'd join.
>>
>> Dirk
>>
>> --
>> Three out of two people have difficulties with fractions.
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
> 
> 

-- 
Dr Oleg Sklyar * EBI-EMBL, Cambridge CB10 1SD, UK * +44-1223-494466


From mtmorgan at fhcrc.org  Fri Jun 13 01:52:50 2008
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Thu, 12 Jun 2008 16:52:50 -0700
Subject: [Rd] Rmpi segfault after install on Ubuntu Hardy Heron
In-Reply-To: <4851B4B1.2090508@ebi.ac.uk>
References: <6b93d1830806102146k1f91b723q2f7918d4a95043e6@mail.gmail.com>	<18511.50045.300225.144687@ron.nulle.part>	<6b93d1830806121538t766daad8v367290677b799993@mail.gmail.com>
	<4851B4B1.2090508@ebi.ac.uk>
Message-ID: <4851B6D2.6050503@fhcrc.org>

Oleg Sklyar wrote:
> simply cd to $R_HOME/library/Rmpi/libs and do on the command line
> 
> ldd -r Rmpi.so

I think you'll want to

R CMD ldd $R_HOME/library/Rmpi/libs/Rmpi.so

which picks up the R configuration environment, e.g., compare BLAS below:

mtmorgan at lamprey:~/> R CMD ldd $R_HOME/library/stats/libs/stats.so
         libRblas.so => 
/home/mtmorgan/arch/x86_64/R-devel/lib/libRblas.so (0x00002b543f98b000)
         libgfortran.so.2 => /usr/lib64/libgfortran.so.2 
(0x00002b543fc09000)
         libm.so.6 => /lib64/libm.so.6 (0x00002b543fec4000)
         libc.so.6 => /lib64/libc.so.6 (0x00002b5440118000)
         /lib64/ld-linux-x86-64.so.2 (0x0000555555554000)
mtmorgan at lamprey:~/s> ldd $R_HOME/library/stats/libs/stats.so
         libRblas.so => not found
         libgfortran.so.2 => /usr/lib64/libgfortran.so.2 
(0x00002aeabd923000)
         libm.so.6 => /lib64/libm.so.6 (0x00002aeabdbde000)
         libc.so.6 => /lib64/libc.so.6 (0x00002aeabde32000)
         /lib64/ld-linux-x86-64.so.2 (0x0000555555554000)

Martin

> 
> this will display you a list of dependencies of Rmpi.so and you can see 
> if you find there the libraries that you expected to link against, or 
> there will be some libraries from unexpected paths or missing ones
> 
> Mark Kimpel wrote:
>> Dirk,
>>
>> Configure concluded without errors. I am not running this on the HPC
>> cluster with icc, rather a separate local box used for testing and
>> learning. Its just an 64-bit Ubuntu 8.04 install on a 4-core machine.
>> LAM is not installed (I checked to make sure).
>>
>> So, that leaves me with you last two options. Before I make my first
>> foray into using the R-debugger, I'd like to try you suggestion to
>> "Check ldd on Rmpi.so" but don't have a clue how to do so. Could you
>> instruct me?
>>
>> Thanks to all for the helpful comments.
>> Mark
>>
>> On Wed, Jun 11, 2008 at 8:22 AM, Dirk Eddelbuettel <edd at debian.org> 
>> wrote:
>>> On 11 June 2008 at 00:46, Mark Kimpel wrote:
>>> | I just installed Rmpi on my 64-bit Ubuntu Hardy Heron OS and using the
>>> | following without errors:
>>> | "R CMD INSTALL Rmpi_0.5-5.tar.gz 
>>> --configure-args=--with-mpi=/usr/lib64/openmpi"
>>>
>>> And it concluded without warnings or errors? Configure found all the 
>>> right files?
>>>
>>> As Paul suggested, make sure you're not getting it mixed with
>>> exisiting LAM headers or MPICH2 headers or, say, that you're getting 
>>> your gcc
>>> and icc experiemenst mixed up or ...  ?
>>>
>>> I control this by locally re-building the Debian packages for Open 
>>> MPI. That
>>> way I only keep one -dev package for MPI and can ensure that I do not 
>>> get
>>> mixups with other MPI installation. But then I do buy into the Package
>>> Management mantra, but not everybody does...
>>>
>>> | Immediately at library(Rmpi) I get the segfault displayed in my
>>> | complete output below. My first thought is that perhaps I used the
>>> | wrong library for openmpi, but with my 64 bit install it seemed like a
>>> | logical choice and the install went without a hitch.
>>>
>>> Check ldd on Rmpi.so to ensure that you linked against what you 
>>> thought you
>>> should link against.
>>>
>>> And if everything else fails, debug the compiled code and run R under 
>>> the
>>> debuggger.  See the 'R Extensions' manual.
>>>
>>> | Two other general comments:
>>> | 1. Am I addressing this to the correct list or should I use R-help? As
>>> | I read the posting guide, I'm not sure.
>>> | 2. Has anyone considered an R-SIG-HPC list? Anyone besides me 
>>> interested?
>>>
>>> I'd join.
>>>
>>> Dirk
>>>
>>> -- 
>>> Three out of two people have difficulties with fractions.
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>>
>>
> 


-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M2 B169
Phone: (206) 667-2793


From edd at debian.org  Fri Jun 13 03:17:09 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 12 Jun 2008 20:17:09 -0500
Subject: [Rd] Rmpi segfault after install on Ubuntu Hardy Heron
In-Reply-To: <6b93d1830806121538t766daad8v367290677b799993@mail.gmail.com>
References: <6b93d1830806102146k1f91b723q2f7918d4a95043e6@mail.gmail.com>
	<18511.50045.300225.144687@ron.nulle.part>
	<6b93d1830806121538t766daad8v367290677b799993@mail.gmail.com>
Message-ID: <18513.51861.102932.518310@ron.nulle.part>


On 12 June 2008 at 18:38, Mark Kimpel wrote:
| Dirk,
| 
| Configure concluded without errors. I am not running this on the HPC
| cluster with icc, rather a separate local box used for testing and
| learning. Its just an 64-bit Ubuntu 8.04 install on a 4-core machine.
| LAM is not installed (I checked to make sure).
| 
| So, that leaves me with you last two options. Before I make my first
| foray into using the R-debugger, I'd like to try you suggestion to
| "Check ldd on Rmpi.so" but don't have a clue how to do so. Could you
| instruct me?

ldd is a command so try 'man ldd'; or just use what Oleg and Martin showed
you.

You still told us where you got R, Rmpi, and Open MPI from.  You could just
do

	$ sudo apt-get install r-cran-rmpi

and get Rmpi installed along with its dependencies (eg R and Open MPI).  That
just works on Debian.  It also worked, as I recall, on Ubuntu 'Gutsy' aka 7.10.

However, on Ubuntu 'Hardy' aka 8.04, this may be broken as I discovered
during some testing for the HPC presentation I'll be giving at Use R. I
filed an Ubuntu bug report at

     https://bugs.launchpad.net/ubuntu/+source/binutils/+bug/234837

but no follow-up has happened.

That said, this still all works for me at 

     a) at work which is x86 and all Ubuntu machines

     b) at home where it is x86 and a mix of Debian and Ubuntu machines

_but_ only after I rebuilt openmpi_1.2.5 on an older Gutsy machine as
detailed in the bugreport. Something on Hardy breaks it. 

I am not an Ubuntu maintainer, so I am not sure who to talk to.  I'll forward
a copy of this to the Ubuntu folks.

As an aside, the Debian packages all work.

Dirk
 
| Thanks to all for the helpful comments.
| Mark
| 
| On Wed, Jun 11, 2008 at 8:22 AM, Dirk Eddelbuettel <edd at debian.org> wrote:
| >
| > On 11 June 2008 at 00:46, Mark Kimpel wrote:
| > | I just installed Rmpi on my 64-bit Ubuntu Hardy Heron OS and using the
| > | following without errors:
| > | "R CMD INSTALL Rmpi_0.5-5.tar.gz --configure-args=--with-mpi=/usr/lib64/openmpi"
| >
| > And it concluded without warnings or errors? Configure found all the right files?
| >
| > As Paul suggested, make sure you're not getting it mixed with
| > exisiting LAM headers or MPICH2 headers or, say, that you're getting your gcc
| > and icc experiemenst mixed up or ...  ?
| >
| > I control this by locally re-building the Debian packages for Open MPI. That
| > way I only keep one -dev package for MPI and can ensure that I do not get
| > mixups with other MPI installation. But then I do buy into the Package
| > Management mantra, but not everybody does...
| >
| > | Immediately at library(Rmpi) I get the segfault displayed in my
| > | complete output below. My first thought is that perhaps I used the
| > | wrong library for openmpi, but with my 64 bit install it seemed like a
| > | logical choice and the install went without a hitch.
| >
| > Check ldd on Rmpi.so to ensure that you linked against what you thought you
| > should link against.
| >
| > And if everything else fails, debug the compiled code and run R under the
| > debuggger.  See the 'R Extensions' manual.
| >
| > | Two other general comments:
| > | 1. Am I addressing this to the correct list or should I use R-help? As
| > | I read the posting guide, I'm not sure.
| > | 2. Has anyone considered an R-SIG-HPC list? Anyone besides me interested?
| >
| > I'd join.
| >
| > Dirk
| >
| > --
| > Three out of two people have difficulties with fractions.
| >
| > ______________________________________________
| > R-devel at r-project.org mailing list
| > https://stat.ethz.ch/mailman/listinfo/r-devel
| >
| 
| 
| 
| -- 
| Mark W. Kimpel MD ** Neuroinformatics ** Dept. of Psychiatry
| Indiana University School of Medicine
| 
| 15032 Hunter Court, Westfield, IN 46074
| 
| (317) 490-5129 Work, & Mobile & VoiceMail
| (317) 663-0513 Home (no voice mail please)
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Three out of two people have difficulties with fractions.


From mwkimpel at gmail.com  Fri Jun 13 04:00:11 2008
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Thu, 12 Jun 2008 22:00:11 -0400
Subject: [Rd] Rmpi segfault after install on Ubuntu Hardy Heron
In-Reply-To: <18513.51861.102932.518310@ron.nulle.part>
References: <6b93d1830806102146k1f91b723q2f7918d4a95043e6@mail.gmail.com>
	<18511.50045.300225.144687@ron.nulle.part>
	<6b93d1830806121538t766daad8v367290677b799993@mail.gmail.com>
	<18513.51861.102932.518310@ron.nulle.part>
Message-ID: <6b93d1830806121900y1d77821aq818113f7aed89cb0@mail.gmail.com>

Dirk,

Did R CMD ldd $R_HOME/library/Rmpi/libs/Rmpi.so as suggested and
things looked okay. Not really wanting to mess with the debugger I
decided to use your prepackaged version. I completely uninstalled all
openmpi packages on my system using Synaptic and deleted my compiled
from source Rmpi from my site-library. Then I executed "sudo apt-get
install r-cran-rmpi" and things seemed to go smoothly. I put a soft
link from the library aptitude installed Rmpi into to my
~/R_HOME/site-library. I get exactly the same error as before. Does
the minimal debugging info below "options(error = recover) provide any
insight?  Mark

> require(Rmpi)
Loading required package: Rmpi

 *** caught segfault ***
address 0x2224008, cause 'memory not mapped'

Traceback:
 1: .Call("mpi_initialize", PACKAGE = "Rmpi")
 2: f(libname, pkgname)
 3: firstlib(which.lib.loc, package)
 4: doTryCatch(return(expr), name, parentenv, handler)
 5: tryCatchOne(expr, names, parentenv, handlers[[1]])
 6: tryCatchList(expr, classes, parentenv, handlers)
 7: tryCatch(expr, error = function(e) {    call <- conditionCall(e)
 if (!is.null(call)) {        if (identical(call[[1]],
quote(doTryCatch)))             call <- sys.call(-4)        dcall <-
deparse(call)[1]        prefix <- paste("Error in", dcall, ": ")
 LONG <- 75        msg <- conditionMessage(e)        sm <-
strsplit(msg, "\n")[[1]]        if (14 + nchar(dcall, type = "w") +
nchar(sm[1], type = "w") >             LONG)             prefix <-
paste(prefix, "\n  ", sep = "")    }    else prefix <- "Error : "
msg <- paste(prefix, conditionMessage(e), "\n", sep = "")
.Internal(seterrmessage(msg[1]))    if (!silent &&
identical(getOption("show.error.messages"),         TRUE)) {
cat(msg, file = stderr())        .Internal(printDeferredWarnings())
}    invisible(structure(msg, class = "try-error"))})
 8: try(firstlib(which.lib.loc, package))
 9: library(package, lib.loc = lib.loc, character.only = TRUE,
logical.return = TRUE,     warn.conflicts = warn.conflicts,
keep.source = keep.source,     version = version)
10: require(Rmpi)

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection: 2
Save workspace image? [y/n/c]: n
mkimpel at mkimpel-xps600:~/R_HOME/site-library-2.7.0/Rmpi$ R

R version 2.7.0 Patched (2008-05-18 r45728)
________________________________
#stuff deleted for brevity
______________________________________

> sessionInfo()
R version 2.7.0 Patched (2008-05-18 r45728)
x86_64-unknown-linux-gnu

locale:
LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] graph_1.18.1

loaded via a namespace (and not attached):
[1] cluster_1.11.10 tools_2.7.0



Mark W. Kimpel MD ** Neuroinformatics ** Dept. of Psychiatry
Indiana University School of Medicine

15032 Hunter Court, Westfield, IN 46074

(317) 490-5129 Work, & Mobile & VoiceMail
(317) 663-0513 Home (no voice mail please)


From Scott.Wilkinson at csiro.au  Fri Jun 13 06:10:17 2008
From: Scott.Wilkinson at csiro.au (Scott.Wilkinson at csiro.au)
Date: Fri, 13 Jun 2008 06:10:17 +0200 (CEST)
Subject: [Rd] significant digits (PR#9682)
Message-ID: <20080613041018.A24062834169@mail.pubhealth.ku.dk>

Thanks Patrick, your function is a neat work-around to include trailing
zeroes when specifying significant digits.
It worked better with this modification to the "format" arguments: =20
  else if (sigdigs<=3Dleft+right)
{out<-format(signum,nsmall=3Dsigdigs-left)}

Agree would be nice to include this in signif()
Regards, Scott.

> -----Original Message-----
> From: patcarr at gmail.com [mailto:patcarr at gmail.com] On Behalf=20
> Of Patrick Carr
> Sent: Tuesday, 3 June 2008 11:28 AM
> To: r-bugs at r-project.org
> Cc: Wilkinson, Scott (CLW, Townsville)
> Subject: Re: significant digits (PR#9682)
>=20
> To reply to my own message, that function wasn't quite right. I think
> this one works better:
>=20
> signif.string <- function(signum,sigdigs){
>   test <- abs(signum)
>   left <- nchar(trunc(test))
>   right <- nchar(test)-left-1
>   if (test<1) {left<-left-1}
>   if (right<0) {right<-0}
>   if (sigdigs<left) =
{out<-as.character(signif(signum,digits=3Dsigdigs))}
>   else if (sigdigs=3D=3Dleft & trunc(signum) %% 10 =3D=3D 0)
> {out<-paste(round(signum),".",sep=3D"")}
>   else if (sigdigs<=3Dleft+right) =
{out<-format(signum,digits=3Dsigdigs)}
>   else {out<-sprintf(paste("%.",sigdigs-left,"f",sep=3D""),signum)}
>   return(noquote(out))
> }
>=20
> But it should still have error checking and vector capability, yadda
> yadda. Also, I forgot what year it was, so sorry, Scott, for spamming
> you with something you're hopefully not still stuck on.
>=20
> Pat Carr
>=20


From kjell.konis at epfl.ch  Fri Jun 13 14:28:23 2008
From: kjell.konis at epfl.ch (Kjell Konis)
Date: Fri, 13 Jun 2008 14:28:23 +0200
Subject: [Rd] how to install header files in package
Message-ID: <C71798B1-3A0E-4EA3-A079-51C5DF34C6BE@epfl.ch>

Is there a way to get R CMD INSTALL (and friends) to copy the header  
files from a source package's src directory to the include directory?

Thanks.
Kjell


From edd at debian.org  Fri Jun 13 15:40:43 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 13 Jun 2008 08:40:43 -0500
Subject: [Rd] how to install header files in package
In-Reply-To: <C71798B1-3A0E-4EA3-A079-51C5DF34C6BE@epfl.ch>
References: <C71798B1-3A0E-4EA3-A079-51C5DF34C6BE@epfl.ch>
Message-ID: <18514.30939.151586.554494@ron.nulle.part>


On 13 June 2008 at 14:28, Kjell Konis wrote:
| Is there a way to get R CMD INSTALL (and friends) to copy the header  
| files from a source package's src directory to the include directory?

Only if you (ab-)use the 'make all' target in src/Makefile to copy them, as a
recent thread on r-devel showed.  Some of us suggested that a 'make install'
target would be a nice thing to have.  

No resolution, or for that matter comment, comment from R Core, though.

Dirk

-- 
Three out of two people have difficulties with fractions.


From bill at insightful.com  Fri Jun 13 16:54:27 2008
From: bill at insightful.com (Bill Dunlap)
Date: Fri, 13 Jun 2008 07:54:27 -0700 (PDT)
Subject: [Rd] how to install header files in package
In-Reply-To: <18514.30939.151586.554494@ron.nulle.part>
References: <C71798B1-3A0E-4EA3-A079-51C5DF34C6BE@epfl.ch>
	<18514.30939.151586.554494@ron.nulle.part>
Message-ID: <Pine.GSO.4.56.0806130747080.12010@devsun3201.insightful.com>

On Fri, 13 Jun 2008, Dirk Eddelbuettel wrote:

>
> On 13 June 2008 at 14:28, Kjell Konis wrote:
> | Is there a way to get R CMD INSTALL (and friends) to copy the header
> | files from a source package's src directory to the include directory?
>
> Only if you (ab-)use the 'make all' target in src/Makefile to copy them, as a
> recent thread on r-devel showed.  Some of us suggested that a 'make install'
> target would be a nice thing to have.

Which 'include' directory do you mean?  $RHOME/include or
<pkg>/include?

You could put a copy of the *.h files into inst/include
to get them into <pkg>/include.

Putting them into $RHOME/include isn't always desirable
or possible (permission problems).  If you install
*.h files then you are probably also distributing
*.so, *.dll, and *.lib (on Windows) files and they
should go into a parallel directory.  Where should
they go?

----------------------------------------------------------------------------
Bill Dunlap
Insightful Corporation
bill at insightful dot com

 "All statements in this message represent the opinions of the author and do
 not necessarily reflect Insightful Corporation policy or position."


From forum.query at gmail.com  Fri Jun 13 17:03:03 2008
From: forum.query at gmail.com (evan cooch)
Date: Fri, 13 Jun 2008 11:03:03 -0400
Subject: [Rd] compiling 2.7.0 GNU/Linux | BLAS & Lapack query
Message-ID: <458675ec0806130803n14950ea6p1b27c73a1ddd80ba@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080613/7fbf07ca/attachment.pl>

From seth at userprimary.net  Fri Jun 13 17:16:06 2008
From: seth at userprimary.net (Seth Falcon)
Date: Fri, 13 Jun 2008 08:16:06 -0700
Subject: [Rd] how to install header files in package
In-Reply-To: <18514.30939.151586.554494@ron.nulle.part>
References: <C71798B1-3A0E-4EA3-A079-51C5DF34C6BE@epfl.ch>
	<18514.30939.151586.554494@ron.nulle.part>
Message-ID: <20080613151606.GL351@ziti.local>

* On 2008-06-13 at 08:40 -0500 Dirk Eddelbuettel wrote:
> On 13 June 2008 at 14:28, Kjell Konis wrote:
> | Is there a way to get R CMD INSTALL (and friends) to copy the header  
> | files from a source package's src directory to the include directory?
> 
> Only if you (ab-)use the 'make all' target in src/Makefile to copy
> them, as a recent thread on r-devel showed.  Some of us suggested
> that a 'make install' target would be a nice thing to have.

Can you elaborate on the use case?  If the desire is to allow pkgB to
access header files provided by pkgA, then you can use the LinkingTo
field in the DESCRIPTION file as described in Writing R Extensions
in the "Registering native routines" section.

+ seth

-- 
Seth Falcon | http://userprimary.net/user/


From sgiannerini at gmail.com  Fri Jun 13 17:45:45 2008
From: sgiannerini at gmail.com (Simone Giannerini)
Date: Fri, 13 Jun 2008 17:45:45 +0200
Subject: [Rd] compiling 2.7.0 GNU/Linux | BLAS & Lapack query
In-Reply-To: <458675ec0806130803n14950ea6p1b27c73a1ddd80ba@mail.gmail.com>
References: <458675ec0806130803n14950ea6p1b27c73a1ddd80ba@mail.gmail.com>
Message-ID: <3c12769c0806130845t712f40c4ud8f0d38feb77caef@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080613/9f58a6b9/attachment.pl>

From kjell.konis at epfl.ch  Fri Jun 13 17:54:14 2008
From: kjell.konis at epfl.ch (Kjell Konis)
Date: Fri, 13 Jun 2008 17:54:14 +0200
Subject: [Rd] how to install header files in package
In-Reply-To: <Pine.GSO.4.56.0806130747080.12010@devsun3201.insightful.com>
References: <C71798B1-3A0E-4EA3-A079-51C5DF34C6BE@epfl.ch>
	<18514.30939.151586.554494@ron.nulle.part>
	<Pine.GSO.4.56.0806130747080.12010@devsun3201.insightful.com>
Message-ID: <362D5567-0041-4FD3-8422-E2DC5A4FD470@epfl.ch>

Here's what I'm doing: I define some C functions in pkgA and register  
them with R_RegisterCCallable and I want to use them in pkgB. When  
building pkgB, R CMD INSTALL expects to find the header files for the  
registered C functions in pkgA*/include (where the * denotes the  
installed version of pkgA). AFAICT there is no mechanism to put the  
header files from pkgA into pkgA*/include.

Putting the header files in pkgA/inst/include solves the problem but  
it seems like there should be a better way to do this.

Kjell



On 13 juin 08, at 16:54, Bill Dunlap wrote:

> On Fri, 13 Jun 2008, Dirk Eddelbuettel wrote:
>
>>
>> On 13 June 2008 at 14:28, Kjell Konis wrote:
>> | Is there a way to get R CMD INSTALL (and friends) to copy the  
>> header
>> | files from a source package's src directory to the include  
>> directory?
>>
>> Only if you (ab-)use the 'make all' target in src/Makefile to copy  
>> them, as a
>> recent thread on r-devel showed.  Some of us suggested that a 'make  
>> install'
>> target would be a nice thing to have.
>
> Which 'include' directory do you mean?  $RHOME/include or
> <pkg>/include?
>
> You could put a copy of the *.h files into inst/include
> to get them into <pkg>/include.
>
> Putting them into $RHOME/include isn't always desirable
> or possible (permission problems).  If you install
> *.h files then you are probably also distributing
> *.so, *.dll, and *.lib (on Windows) files and they
> should go into a parallel directory.  Where should
> they go?
>
> ----------------------------------------------------------------------------
> Bill Dunlap
> Insightful Corporation
> bill at insightful dot com
>
> "All statements in this message represent the opinions of the author  
> and do
> not necessarily reflect Insightful Corporation policy or position."


From ripley at stats.ox.ac.uk  Fri Jun 13 18:05:54 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 13 Jun 2008 17:05:54 +0100 (BST)
Subject: [Rd] how to install header files in package
In-Reply-To: <362D5567-0041-4FD3-8422-E2DC5A4FD470@epfl.ch>
References: <C71798B1-3A0E-4EA3-A079-51C5DF34C6BE@epfl.ch>
	<18514.30939.151586.554494@ron.nulle.part>
	<Pine.GSO.4.56.0806130747080.12010@devsun3201.insightful.com>
	<362D5567-0041-4FD3-8422-E2DC5A4FD470@epfl.ch>
Message-ID: <alpine.LFD.1.10.0806131703200.12707@gannet.stats.ox.ac.uk>

On Fri, 13 Jun 2008, Kjell Konis wrote:

> Here's what I'm doing: I define some C functions in pkgA and register them 
> with R_RegisterCCallable and I want to use them in pkgB. When building pkgB, 
> R CMD INSTALL expects to find the header files for the registered C functions 
> in pkgA*/include (where the * denotes the installed version of pkgA). AFAICT 
> there is no mechanism to put the header files from pkgA into pkgA*/include.
>
> Putting the header files in pkgA/inst/include solves the problem but it seems 
> like there should be a better way to do this.

That is the intended way.  The headers you want to install may not be the 
same as those you use to build the package.  See e.g. Matrix for an 
example.

>
> Kjell
>
>
>
> On 13 juin 08, at 16:54, Bill Dunlap wrote:
>
>> On Fri, 13 Jun 2008, Dirk Eddelbuettel wrote:
>> 
>>> 
>>> On 13 June 2008 at 14:28, Kjell Konis wrote:
>>> | Is there a way to get R CMD INSTALL (and friends) to copy the header
>>> | files from a source package's src directory to the include directory?
>>> 
>>> Only if you (ab-)use the 'make all' target in src/Makefile to copy them, 
>>> as a
>>> recent thread on r-devel showed.  Some of us suggested that a 'make 
>>> install'
>>> target would be a nice thing to have.
>> 
>> Which 'include' directory do you mean?  $RHOME/include or
>> <pkg>/include?
>> 
>> You could put a copy of the *.h files into inst/include
>> to get them into <pkg>/include.
>> 
>> Putting them into $RHOME/include isn't always desirable
>> or possible (permission problems).  If you install
>> *.h files then you are probably also distributing
>> *.so, *.dll, and *.lib (on Windows) files and they
>> should go into a parallel directory.  Where should
>> they go?
>> 
>> ----------------------------------------------------------------------------
>> Bill Dunlap
>> Insightful Corporation
>> bill at insightful dot com
>> 
>> "All statements in this message represent the opinions of the author and do
>> not necessarily reflect Insightful Corporation policy or position."
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From simon.debernard at altrabio.com  Fri Jun 13 18:45:25 2008
From: simon.debernard at altrabio.com (simon.debernard at altrabio.com)
Date: Fri, 13 Jun 2008 18:45:25 +0200 (CEST)
Subject: [Rd] (PR#11064) how to reproduce...
Message-ID: <20080613164526.1D8012834158@mail.pubhealth.ku.dk>

You can try this:

data <- cbind("a"=sample(1:100000), "b"=sample(1:100000))
fact <- sample(rep(1:10000, each=10))
system.time(std <- by(data, fact, colSums))
by.matrix <- function (data, INDICES, FUN, ...) {
     if (!is.list(INDICES)) {
         IND <- vector("list", 1)
         IND[[1]] <- INDICES
         names(IND) <- deparse(substitute(INDICES))[1]
     }
     else IND <- INDICES
     FUNx <- function(x) FUN(data[x, , drop = FALSE], ...)
     nd <- nrow(data)
     ans <- eval(substitute(tapply(1:nd, IND, FUNx)), as.data.frame 
(data))
     attr(ans, "call") <- match.call()
     class(ans) <- "by"
     ans
}
system.time(mod <- by(data, fact, colSums))
all.equal(std, mod)

I get a 30x speed up
(I'm not sure why the attributes differ, but I'm sure this can be  
fixed...)


From ripley at stats.ox.ac.uk  Fri Jun 13 21:53:22 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 13 Jun 2008 20:53:22 +0100 (BST)
Subject: [Rd] compiling 2.7.0 GNU/Linux | BLAS & Lapack query
In-Reply-To: <458675ec0806130803n14950ea6p1b27c73a1ddd80ba@mail.gmail.com>
References: <458675ec0806130803n14950ea6p1b27c73a1ddd80ba@mail.gmail.com>
Message-ID: <alpine.LFD.1.10.0806132043290.7352@gannet.stats.ox.ac.uk>

You need to look in config.log to see what happened.

But note what 'R Installation and Administration' says about

   See @pxref{Shared BLAS} for an alternative (and in many ways preferable)
   way to use ACML.


On Fri, 13 Jun 2008, evan cooch wrote:

> Greetings -
>
> For a host of reasons I chose (was forced) to upgrade my multi-Opteron box
> from Fedora 7 -> Fedora 8. In the process, I also updated the ACML I had
> installed from 4.0.0 to 4.1.0.
>
> While I get no errors (that I can find) in the config -> make -> make
> install sequence, I'm pretty sure (based on some benchmarks) that I'm not
> getting BLAS and/or Lapack to compile in. So, either something has changed
> from 2.6.2 -> 2.7.0, or something has changed from Fedora 7 -> Fedora 8, or
> both.
>
> Here is the sequence I follow to do the config (which seemed to work
> perfectly before - note: using bash shell):
>
> 1. LD_LIBRARY_PATH=/opt/acml4.1.0/gfortran64/lib
>
> 2. export LD_LIBRARY_PATH
>
> 3. ./configure --with-lapack="-L/usr/lib64"
> --with-blas="L/opt/acml4.1.0/gfortran64/lib -lacml"
>
>
> However, when I try this, at the end of the config script I'm told
>
> Interfaces supported:      X11
> External libraries:           readline
> Additional capabilites:   PNG, JPEG, iconv, MBCS, NLS, cairo
> Options enabled:           shared BLAS, R profiling, Java
>
>
> I'm pretty sure that readline being the only external library being reported
> is diagnostic of some sort of issue - normally, I'm given information about
> lapack, and generic BLAS being linked. But, no more.
>
> Suggestions? Points to the obvious? Both ACML and Lapack are where they
> should be, so I'm quite frankly puzzled as to what is going on.
>
>
> Thanks very much in advance.
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Sun Jun 15 16:15:30 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 15 Jun 2008 15:15:30 +0100 (BST)
Subject: [Rd] arima() bug
In-Reply-To: <alpine.LFD.1.10.0806120845170.21937@gannet.stats.ox.ac.uk>
References: <200806121605.59981.Ray.Brownrigg@mcs.vuw.ac.nz>
	<b0808fdc0806120027j394df03cwf3d8e98f8ad74241@mail.gmail.com>
	<alpine.LFD.1.10.0806120845170.21937@gannet.stats.ox.ac.uk>
Message-ID: <alpine.LFD.1.10.0806151512470.3338@gannet.stats.ox.ac.uk>

On Thu, 12 Jun 2008, Prof Brian Ripley wrote:

> On Thu, 12 Jun 2008, Antonio, Fabio Di Narzo wrote:
>
>> No segfault with my r-patched version on linux-i686:
>> 
>>> set.seed(1); x <- ts(20*sin((1:731)*2*pi/365) + 10 + rnorm(731, 0, 4), 
>>> freq=365)
>>> arima(x, c(1, 0, 1), c(1, 0, 1))
>> Errore: cannot allocate vector of size 1010.9 Mb
>
> Yes, you need a lot of memory to reproduce it.  It's a nonsensical 
> calculation but nevertheless we need to track down the cause.

Which is an integer overflow in an integer calculation of a dimension. 
The current code is only able to code with lags up to 350, and this is 
attempting a fit with lag 366.  I've added an explicit check.

>
>> 
>> F.
>> 
>>> R.version
>>               _
>> platform       i686-pc-linux-gnu
>> arch           i686
>> os             linux-gnu
>> system         i686, linux-gnu
>> status         Patched
>> major          2
>> minor          7.0
>> year           2008
>> month          05
>> day            29
>> svn rev        45820
>> language       R
>> version.string R version 2.7.0 Patched (2008-05-29 r45820)
>> 
>> 
>> 2008/6/12 Ray Brownrigg <Ray.Brownrigg at mcs.vuw.ac.nz>:
>>> I guess this is more r-devel than r-help.
>>> 
>>> Note, I am just the messenger - I have no idea what the user is trying to 
>>> model here.
>>> 
>>> arima() crashes R (segfault) with Linux R-2.7.0, Solaris R-2.6.0:
>>>
>>>  *** caught segfault ***
>>> address 42400000, cause 'memory not mapped'
>>> 
>>> Traceback:
>>>  1: .Call(R_getQ0, phi, theta)
>>>  2: makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa)
>>>  3: arima(x, c(1, 0, 1), c(1, 0, 1))
>>> 
>>> Under rw-2.7.0 or R version 2.8.0 Under development (unstable) (2008-06-10 
>>> r45893)
>>> it gets:
>>> Error: cannot allocate vector of size 1010.9 Mb
>>> In addition: Warning messages:
>>> 1: In makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa) :
>>>  Reached total allocation of 447Mb: see help(memory.size)
>>> 2: In makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa) :
>>>  Reached total allocation of 447Mb: see help(memory.size)
>>> 3: In makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa) :
>>>  Reached total allocation of 447Mb: see help(memory.size)
>>> 4: In makeARIMA(trarma[[1]], trarma[[2]], Delta, kappa) :
>>>  Reached total allocation of 447Mb: see help(memory.size)
>>> 
>>> Reproduce by:
>>> 
>>> # 2 years of daily temperature data
>>> set.seed(1); x <- ts(20*sin((1:731)*2*pi/365) + 10 + rnorm(731, 0, 4), 
>>> freq=365)
>>> arima(x, c(1, 0, 1), c(1, 0, 1))
>>> 
>>> Ray Brownrigg
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>> 
>> 
>> 
>> -- 
>> Antonio, Fabio Di Narzo
>> Ph.D. student at
>> Department of Statistical Sciences
>> University of Bologna, Italy
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From Ray.Brownrigg at mcs.vuw.ac.nz  Sun Jun 15 22:57:41 2008
From: Ray.Brownrigg at mcs.vuw.ac.nz (Ray Brownrigg)
Date: Mon, 16 Jun 2008 08:57:41 +1200
Subject: [Rd] c.noquote() weirdness
Message-ID: <200806160857.41265.Ray.Brownrigg@mcs.vuw.ac.nz>

I haven't been able to get anywhere tracking this down.  It seems that c.noquote() does 
something strange with its third (and subsequent) parameters:

R-2.7.0 under NetBSD, R-2.6.0 under Solaris, and R-2.8.0 (unstable) (2008-06-10 r45893) 
under WinXP, I get:

> c(noquote('z'), 'y', 'x', '*')
[1] z y x * x *
> 

or:
> c(noquote('z'), 'y', '***', letters)
 [1] z   y   *** a   b   c   d   e   f   g   h   i   j   k   l   m   n   o   p
[20] q   r   s   t   u   v   w   x   y   z   *** a   b   c   d   e   f   g   h
[39] i   j   k   l   m   n   o   p   q   r   s   t   u   v   w   x   y   z
> 

Again, I am only the messenger (so don't shoot me :-)).

Regards,
Ray Brownrigg


From ripley at stats.ox.ac.uk  Mon Jun 16 09:33:58 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 16 Jun 2008 08:33:58 +0100 (BST)
Subject: [Rd] c.noquote() weirdness
In-Reply-To: <200806160857.41265.Ray.Brownrigg@mcs.vuw.ac.nz>
References: <200806160857.41265.Ray.Brownrigg@mcs.vuw.ac.nz>
Message-ID: <alpine.LFD.1.10.0806160828500.19791@gannet.stats.ox.ac.uk>

Yes, it is misusing the ... argument to NextMethod.  The first two 
arguments to c() match the first two arguments to NextMethod, the rest are 
set as additional arguments.

Will fix for 2.7.1RC shortly.  Thanks for the report.

On Mon, 16 Jun 2008, Ray Brownrigg wrote:

> I haven't been able to get anywhere tracking this down.  It seems that c.noquote() does
> something strange with its third (and subsequent) parameters:
>
> R-2.7.0 under NetBSD, R-2.6.0 under Solaris, and R-2.8.0 (unstable) (2008-06-10 r45893)
> under WinXP, I get:
>
>> c(noquote('z'), 'y', 'x', '*')
> [1] z y x * x *
>>
>
> or:
>> c(noquote('z'), 'y', '***', letters)
> [1] z   y   *** a   b   c   d   e   f   g   h   i   j   k   l   m   n   o   p
> [20] q   r   s   t   u   v   w   x   y   z   *** a   b   c   d   e   f   g   h
> [39] i   j   k   l   m   n   o   p   q   r   s   t   u   v   w   x   y   z
>>
>
> Again, I am only the messenger (so don't shoot me :-)).
>
> Regards,
> Ray Brownrigg
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From phgrosjean at sciviews.org  Mon Jun 16 10:04:28 2008
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Mon, 16 Jun 2008 10:04:28 +0200
Subject: [Rd] Execute expr with a timeout?
Message-ID: <48561E8C.7020806@sciviews.org>

Hello,

Does someone know how to execute an expression in R, limiting the time 
to evaluate it and raising an exception if it takes too long to run? 
Something like:

 > with.timeout(expr, timeout = 10)

which stops the evaluation of 'expr' if it is not done after 10 sec?
Best,

Philippe Grosjean


From ripley at stats.ox.ac.uk  Mon Jun 16 10:31:41 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 16 Jun 2008 09:31:41 +0100 (BST)
Subject: [Rd] Execute expr with a timeout?
In-Reply-To: <48561E8C.7020806@sciviews.org>
References: <48561E8C.7020806@sciviews.org>
Message-ID: <alpine.LFD.1.10.0806160928550.14927@gannet.stats.ox.ac.uk>

See (R-devel)

     o	Experimental setTimeLimit() function to set limits on the CPU
 	and/or elapsed time for each top-level computation.

Note that this is unfinished, and the interface may well change before 
release.

On Mon, 16 Jun 2008, Philippe Grosjean wrote:

> Hello,
>
> Does someone know how to execute an expression in R, limiting the time to 
> evaluate it and raising an exception if it takes too long to run? Something 
> like:
>
>> with.timeout(expr, timeout = 10)
>
> which stops the evaluation of 'expr' if it is not done after 10 sec?
> Best,
>
> Philippe Grosjean
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From phgrosjean at sciviews.org  Mon Jun 16 10:45:10 2008
From: phgrosjean at sciviews.org (Philippe Grosjean)
Date: Mon, 16 Jun 2008 10:45:10 +0200
Subject: [Rd] Execute expr with a timeout?
In-Reply-To: <alpine.LFD.1.10.0806160928550.14927@gannet.stats.ox.ac.uk>
References: <48561E8C.7020806@sciviews.org>
	<alpine.LFD.1.10.0806160928550.14927@gannet.stats.ox.ac.uk>
Message-ID: <48562816.6030007@sciviews.org>

Prof Brian Ripley wrote:
> See (R-devel)
> 
>     o    Experimental setTimeLimit() function to set limits on the CPU
>     and/or elapsed time for each top-level computation.

Oh yes! Many thanks.

> Note that this is unfinished, and the interface may well change before 
> release.

OK, I can wait.
Have a nice day,

Philippe

> On Mon, 16 Jun 2008, Philippe Grosjean wrote:
> 
>> Hello,
>>
>> Does someone know how to execute an expression in R, limiting the time 
>> to evaluate it and raising an exception if it takes too long to run? 
>> Something like:
>>
>>> with.timeout(expr, timeout = 10)
>>
>> which stops the evaluation of 'expr' if it is not done after 10 sec?
>> Best,
>>
>> Philippe Grosjean
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From songeeta at mitre.org  Mon Jun 16 16:40:04 2008
From: songeeta at mitre.org (songeeta at mitre.org)
Date: Mon, 16 Jun 2008 16:40:04 +0200 (CEST)
Subject: [Rd] R crashing (PR#11702)
Message-ID: <20080616144004.AAA18282EFF7@mail.pubhealth.ku.dk>

Full_Name: Songeeta Palchaudhuri
Version: 2.7
OS: Windows XP
Submission from: (NULL) (129.83.31.1)


Hi, RGui crashes when I try to launch it from the Start Menu or any other
shortcut placed on my Desktop. It used to work if I went the long way through
explorer and double clicked the exe file directly, but that no longer works
either. I've tried reinstalling and not sure what else to do.
Thanks,
Songeeta


From talbot at clipper.ens.fr  Mon Jun 16 18:45:21 2008
From: talbot at clipper.ens.fr (talbot at clipper.ens.fr)
Date: Mon, 16 Jun 2008 18:45:21 +0200 (CEST)
Subject: [Rd] bug with function seq() (PR#11705)
Message-ID: <20080616164521.D3846282EFF7@mail.pubhealth.ku.dk>

Full_Name: Gr?goire Talbot
Version: 2.7.0
OS: windows 2000
Submission from: (NULL) (147.99.1.149)


Try this :

> a=seq(from=0.1,to=1,by=0.1)
> a
 [1] 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0

Ok

> a[1]==0.1
[1] TRUE

Ok

> a[3]==0.3
[1] FALSE

!!!

> a[3]
[1] 0.3

!!!

> a[3]=0.3
> a[3]==0.3
[1] TRUE


??????????????????????????


From murdoch at stats.uwo.ca  Mon Jun 16 19:04:24 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 16 Jun 2008 13:04:24 -0400
Subject: [Rd] R crashing (PR#11702)
In-Reply-To: <20080616144004.AAA18282EFF7@mail.pubhealth.ku.dk>
References: <20080616144004.AAA18282EFF7@mail.pubhealth.ku.dk>
Message-ID: <48569D18.9000700@stats.uwo.ca>

On 6/16/2008 10:40 AM, songeeta at mitre.org wrote:
> Full_Name: Songeeta Palchaudhuri
> Version: 2.7
> OS: Windows XP
> Submission from: (NULL) (129.83.31.1)
> 
> 
> Hi, RGui crashes when I try to launch it from the Start Menu or any other
> shortcut placed on my Desktop. It used to work if I went the long way through
> explorer and double clicked the exe file directly, but that no longer works
> either. I've tried reinstalling and not sure what else to do.
> Thanks,
> Songeeta

You could start by giving some information about what happens. 
"Crashes" means a lot of different things to different people.

Please post as exact a description as possible of what you see when you 
start it from the shortcut.  Include the "Target" command line that the 
shortcut executes, and any other information that might be relevant.

Duncan Murdoch


From murdoch at stats.uwo.ca  Mon Jun 16 19:05:44 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 16 Jun 2008 13:05:44 -0400
Subject: [Rd] bug with function seq() (PR#11705)
In-Reply-To: <20080616164521.D3846282EFF7@mail.pubhealth.ku.dk>
References: <20080616164521.D3846282EFF7@mail.pubhealth.ku.dk>
Message-ID: <48569D68.2030000@stats.uwo.ca>

On 6/16/2008 12:45 PM, talbot at clipper.ens.fr wrote:
> Full_Name: Gr?goire Talbot
> Version: 2.7.0
> OS: windows 2000
> Submission from: (NULL) (147.99.1.149)

Not a bug.  See FAQ 7.31 (which should really be FAQ 1, I think.)

Duncan Murdoch

> 
> 
> Try this :
> 
>> a=seq(from=0.1,to=1,by=0.1)
>> a
>  [1] 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0
> 
> Ok
> 
>> a[1]==0.1
> [1] TRUE
> 
> Ok
> 
>> a[3]==0.3
> [1] FALSE
> 
> !!!
> 
>> a[3]
> [1] 0.3
> 
> !!!
> 
>> a[3]=0.3
>> a[3]==0.3
> [1] TRUE
> 
> 
> ??????????????????????????
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From csardi at rmki.kfki.hu  Mon Jun 16 19:05:13 2008
From: csardi at rmki.kfki.hu (Gabor Csardi)
Date: Mon, 16 Jun 2008 12:05:13 -0500
Subject: [Rd] bug with function seq() (PR#11705)
In-Reply-To: <20080616164521.D3846282EFF7@mail.pubhealth.ku.dk>
References: <20080616164521.D3846282EFF7@mail.pubhealth.ku.dk>
Message-ID: <20080616170513.GA22218@localdomain>

See R FAQ 7.31 and also
http://docs.sun.com/source/806-3568/ncg_goldberg.html

G.

On Mon, Jun 16, 2008 at 06:45:21PM +0200, talbot at clipper.ens.fr wrote:
> Full_Name: Gr?goire Talbot
> Version: 2.7.0
> OS: windows 2000
> Submission from: (NULL) (147.99.1.149)
> 
> 
> Try this :
> 
> > a=seq(from=0.1,to=1,by=0.1)
> > a
>  [1] 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0
> 
> Ok
> 
> > a[1]==0.1
> [1] TRUE
> 
> Ok
> 
> > a[3]==0.3
> [1] FALSE
> 
> !!!
> 
> > a[3]
> [1] 0.3
> 
> !!!
> 
> > a[3]=0.3
> > a[3]==0.3
> [1] TRUE
> 
> 
> ??????????????????????????
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Csardi Gabor <csardi at rmki.kfki.hu>    UNIL DGM


From Weigand.Stephen at mayo.edu  Mon Jun 16 23:16:42 2008
From: Weigand.Stephen at mayo.edu (Weigand, Stephen D.)
Date: Mon, 16 Jun 2008 16:16:42 -0500
Subject: [Rd] tiff(), jpeg(),
 and png() in R 2.7.0: problems if 'units = "in"' but default height
 and width
Message-ID: <4856D83A.40505@mayo.edu>

I love the new tiff(), jpeg(), and png() in R 2.7.0 but found
an issue that I didn't see reported.

When specifying 'units = "in"' but forgetting to change the
default height and width (so the figure is unintentionally
going to be 480 inches by 480 inches) I run into problems.

Here's the reproducible example:

tiff("a.tiff", units = "in", res = 1200,
      compression = "lzw")
hist(rnorm(10))
dev.off()

Before dev.off(), I get these warnings:

Warning messages:
1: In title(main = main, sub = sub, xlab = xlab, ylab = ylab,
   ... :
   X11 protocol error: BadAlloc (insufficient resources for
operation)
2: In title(main = main, sub = sub, xlab = xlab, ylab = ylab,
... :
   X11 protocol error: BadDrawable (invalid Pixmap or Window
parameter)

and the dev.off() line will give me:

  *** caught segfault ***
address 48, cause 'memory not mapped'

Traceback:
  1: dev.off()

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace


My sessionInfo()

R version 2.7.0 (2008-04-22)
sparc-sun-solaris2.10

locale:
C

attached base packages:
[1] stats     graphics  grDevices utils
[5] datasets  methods   base


My capabilities()
     jpeg      png    tcltk      X11
     TRUE     TRUE     TRUE     TRUE
     aqua http/ftp  sockets   libxml
    FALSE     TRUE     TRUE     TRUE
     fifo   cledit    iconv      NLS
     TRUE     TRUE     TRUE     TRUE
  profmem    cairo
    FALSE    FALSE


Thanks,

Stephen

-- 
::::::::::::::::::::::::::::::::::
Stephen Weigand
Division of Biostatistics
Mayo Clinic Rochester, Minn., USA
Phone (507) 266-1650, fax 284-9542


From wei.boca at gmail.com  Tue Jun 17 16:05:04 2008
From: wei.boca at gmail.com (wei.boca at gmail.com)
Date: Tue, 17 Jun 2008 16:05:04 +0200 (CEST)
Subject: [Rd] error with solveLP(linprog) (PR#11721)
Message-ID: <20080617140504.21FC1282EFF7@mail.pubhealth.ku.dk>

Full_Name: wfeng
Version: 2.7
OS: windows xp
Submission from: (NULL) (208.62.252.2)


for solveLP(linprog), the program is specified as 

Minimizes c'x, subject to A x >= b and x >= 0. 

However, what I found is the actual constraints that works with the function
are

A x <= b and x >= 0.


From ripley at stats.ox.ac.uk  Wed Jun 18 10:13:24 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 18 Jun 2008 09:13:24 +0100 (BST)
Subject: [Rd] tiff(), jpeg(),
 and png() in R 2.7.0: problems if 'units = "in"' but default height
 and width
In-Reply-To: <4856D83A.40505@mayo.edu>
References: <4856D83A.40505@mayo.edu>
Message-ID: <alpine.LFD.1.10.0806180908450.6531@auk.stats.ox.ac.uk>

Clearly you don't have cairo installed or functional, since the preferred 
versions of these devices do not use X11, and do trap this error.

> tiff("a.tiff", units = "in", res = 1200)
Error in tiff("a.tiff", units = "in", res = 1200) :
   unable to start device 'tiff'
In addition: Warning message:
In tiff("a.tiff", units = "in", res = 1200) : cairo error 'out of memory'

There is nothing new here (Xlib-based devices would crash with 
insufficient memory 'for ever'), but we will see if we can trap this.


On Mon, 16 Jun 2008, Weigand, Stephen D. wrote:

> I love the new tiff(), jpeg(), and png() in R 2.7.0 but found
> an issue that I didn't see reported.
>
> When specifying 'units = "in"' but forgetting to change the
> default height and width (so the figure is unintentionally
> going to be 480 inches by 480 inches) I run into problems.
>
> Here's the reproducible example:
>
> tiff("a.tiff", units = "in", res = 1200,
>     compression = "lzw")
> hist(rnorm(10))
> dev.off()
>
> Before dev.off(), I get these warnings:
>
> Warning messages:
> 1: In title(main = main, sub = sub, xlab = xlab, ylab = ylab,
>  ... :
>  X11 protocol error: BadAlloc (insufficient resources for
> operation)
> 2: In title(main = main, sub = sub, xlab = xlab, ylab = ylab,
> ... :
>  X11 protocol error: BadDrawable (invalid Pixmap or Window
> parameter)
>
> and the dev.off() line will give me:
>
> *** caught segfault ***
> address 48, cause 'memory not mapped'
>
> Traceback:
> 1: dev.off()
>
> Possible actions:
> 1: abort (with core dump, if enabled)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
>
>
> My sessionInfo()
>
> R version 2.7.0 (2008-04-22)
> sparc-sun-solaris2.10
>
> locale:
> C
>
> attached base packages:
> [1] stats     graphics  grDevices utils
> [5] datasets  methods   base
>
>
> My capabilities()
>    jpeg      png    tcltk      X11
>    TRUE     TRUE     TRUE     TRUE
>    aqua http/ftp  sockets   libxml
>   FALSE     TRUE     TRUE     TRUE
>    fifo   cledit    iconv      NLS
>    TRUE     TRUE     TRUE     TRUE
> profmem    cairo
>   FALSE    FALSE
>
>
> Thanks,
>
> Stephen
>
> -- 
> ::::::::::::::::::::::::::::::::::
> Stephen Weigand
> Division of Biostatistics
> Mayo Clinic Rochester, Minn., USA
> Phone (507) 266-1650, fax 284-9542
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From Peter.Peyk at unibas.ch  Wed Jun 18 14:13:14 2008
From: Peter.Peyk at unibas.ch (Peter.Peyk at unibas.ch)
Date: Wed, 18 Jun 2008 14:13:14 +0200
Subject: [Rd] embedding R in c++ (Qt) application
Message-ID: <20080618141314.bcfilb6nr4wowgw8@webmail.unibas.ch>

Hi R-Developers,

I'm working on running statistical analyses with embedded R from a  
Qt-GUI-application (C++).

I've been able to link with R libraries, but I'm having a hard time to  
understand the C-coding examples. I'm a C++, not a C programmer (never  
used malloc before), and many of the R-specific  
functions/keywords/macros (for instance (UN)PROTECT, SETCAR, all the  
data types (SEXP, CHARSXP etc..) ) don't mean anything to me. The  
section on the SEXP type in the R-internals doc didn't tell me much.  
How can I create such objects containing my data? how can I extract  
numbers or strings from SEXPs?
Can you suggest me a helpfile/documentation to read to get into  
understanding this? Is there an index of the R C-exports/keywords to  
look up these things?
I've been digging in the sources, but I thought there may be a better  
way....? I've been able to extract all the exported symbols from the  
R.dll, but without arguments types (and of course without descriptions  
...)

My goal is to prepare some data for R to run an ANOVA on, run it, and  
retrieve the results to display them on the GUI. Can you suggest me a  
helpfiles/documentations to read for this?

Thanks for any suggestions
Peter


From gavin.simpson at ucl.ac.uk  Wed Jun 18 14:28:20 2008
From: gavin.simpson at ucl.ac.uk (Gavin Simpson)
Date: Wed, 18 Jun 2008 13:28:20 +0100
Subject: [Rd] example() and "ask"
Message-ID: <1213792100.30251.48.camel@prometheus.geog.ucl.ac.uk>

Dear list,

Is it intentional that example() opens a new device and leaves it in a
mode where it asks (prompts) the user to Press return to see the next
plot for *all* subsequent plots on that device.

For example; with an already opened device, example() works as I would
expect:

> par("ask")
[1] FALSE
> example(lm)
.... OUTPUT CLIPPED ....
lm> plot(lm.D9, las = 1)      # Residuals, Fitted, ...
Hit <Return> to see next plot: 

lm> par(opar)

lm> ## model frame :
lm> stopifnot(identical(lm(weight ~ group, method = "model.frame"),
lm+                     model.frame(lm.D9)))
> plot(1:10)
>

So with an already opened device, plots /within/ example prompt the user
(by default) but at the end of the example, we return to default and we
are not prompted to display subsequent plots on that device (par("ask)
== FALSE)

However, if example opens a device (i.e. example is the first plotting
function called in a session), then the device remains in "prompt" mode:

> # continue example from above, so close the device
> dev.off()
null device 
          1 
> example(lm) # will open device when required
.... output suppressed ....
lm> plot(lm.D9, las = 1)      # Residuals, Fitted, ...
Hit <Return> to see next plot: 

lm> par(opar)

lm> ## model frame :
lm> stopifnot(identical(lm(weight ~ group, method = "model.frame"),
lm+                     model.frame(lm.D9)))
> par("ask")
[1] TRUE
> plot(1:10)
Hit <Return> to see next plot: 

Device remains in "prompt" mode.

I would have expected example() to clean up and return par("ask") to
what it was before example() was called in the case where it opens it's
own device, just as it does if called with an already open and active
device.

If this is intentional, it doesn't strike me as being intuitive or user
friendly. Is there scope and a will to change this behaviour?

This is with R 2.7.1RC and R 2.8.0 to be:

> version
               _                                     
platform       x86_64-unknown-linux-gnu              
arch           x86_64                                
os             linux-gnu                             
system         x86_64, linux-gnu                     
status         RC                                    
major          2                                     
minor          7.1                                   
year           2008                                  
month          06                                    
day            16                                    
svn rev        45948                                 
language       R                                     
version.string R version 2.7.1 RC (2008-06-16 r45948)

> version
               _                                                               
platform       x86_64-unknown-linux-gnu                                        
arch           x86_64                                                          
os             linux-gnu                                                       
system         x86_64, linux-gnu                                               
status         Under development (unstable)                                    
major          2                                                               
minor          8.0                                                             
year           2008                                                            
month          06                                                              
day            18                                                              
svn rev        45948                                                           
language       R                                                               
version.string R version 2.8.0 Under development (unstable) (2008-06-18 r45948)

Many thanks,

G
-- 
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
 Dr. Gavin Simpson             [t] +44 (0)20 7679 0522
 ECRC, UCL Geography,          [f] +44 (0)20 7679 0565
 Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk
 Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/
 UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%


From Waclaw.Marcin.Kusnierczyk at idi.ntnu.no  Wed Jun 18 14:45:36 2008
From: Waclaw.Marcin.Kusnierczyk at idi.ntnu.no (Wacek Kusnierczyk)
Date: Wed, 18 Jun 2008 14:45:36 +0200
Subject: [Rd] strsplit and the empty string
Message-ID: <48590370.9040702@idi.ntnu.no>

Hello,

I am wondering about the behaviour of strsplit.  When the pattern
matches the beginning of the search string, the mepty string is added to
the result, but that's not the case when the pattern matches the end of
the search string:

strsplit(" hello dolly ")
[1] "" "hello" "dolly"

The man for strsplit explains the algorithm:

"
 The algorithm applied to each input string is


         repeat {
             if the string is empty
                 break.
             if there is a match
                 add the string to the left of the match to the output.
                 remove the match and all to the left of it.
             else
                 add the string to the output.
                 break.
         }

     Note that this means that if there is a match at the beginning of
     a (non-empty) string, the first element of the output is '""', but
     if there is a match at the end of the string, the output is the
     same as with the match removed.
"

I do not see how this algorithm specifies that there should be no empty
string at the end of the output if the pattern matches the end of the
input string.
If the pattern matches, (second if above), the match is added to the
output, and removed from the input -- which after this step is the empty
string; in the next step, there is no match (else above), so the rest of
the input string (= the empty string) *should* be added, but it is not
what happens. 

I think that the implementation of the algorithm (and the explanation
that "if there is a match at the end of the string, the output is the
same as with the match removed") is both unintuitive (i see no good
reason for including the empty string at the beginning but not at the
end of the output; no other language i know would do that this way) and
actually wrong wrt. the algorithm.

Any opinion?  What was the ground for this design?

vQ




-- 
-------------------------------------------------------------------------------
Wacek Kusnierczyk, MD PhD

Email: waku at idi.ntnu.no
Phone: +47 73591875, +47 72574609

Department of Computer and Information Science (IDI)
Faculty of Information Technology, Mathematics and Electrical Engineering (IME)
Norwegian University of Science and Technology (NTNU)
Sem Saelands vei 7, 7491 Trondheim, Norway
Room itv303

Bioinformatics & Gene Regulation Group
Department of Cancer Research and Molecular Medicine (IKM)
Faculty of Medicine (DMF)
Norwegian University of Science and Technology (NTNU)
Laboratory Center, Erling Skjalgsons gt. 1, 7030 Trondheim, Norway
Room 231.05.060


From edd at debian.org  Wed Jun 18 14:46:13 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 18 Jun 2008 07:46:13 -0500
Subject: [Rd] embedding R in c++ (Qt) application
In-Reply-To: <20080618141314.bcfilb6nr4wowgw8@webmail.unibas.ch>
References: <20080618141314.bcfilb6nr4wowgw8@webmail.unibas.ch>
Message-ID: <18521.917.139728.502094@ron.nulle.part>


Peter,

On 18 June 2008 at 14:13, Peter.Peyk at unibas.ch wrote:
| Hi R-Developers,
| 
| I'm working on running statistical analyses with embedded R from a  
| Qt-GUI-application (C++).
| 
| I've been able to link with R libraries, but I'm having a hard time to  
| understand the C-coding examples. I'm a C++, not a C programmer (never  
| used malloc before), and many of the R-specific  
| functions/keywords/macros (for instance (UN)PROTECT, SETCAR, all the  
| data types (SEXP, CHARSXP etc..) ) don't mean anything to me. The  
| section on the SEXP type in the R-internals doc didn't tell me much.  
| How can I create such objects containing my data? how can I extract  
| numbers or strings from SEXPs?

Have a look at RCpp at http://r-forge.r-project.org. While initially written
for accessing C++ from R, it works perfectly well the other way too.  Thanks
to a number of (templated) classes, it abstracts away a lot of the underlying
C representation.

I also use for embedded R inside of C++. 

[...]

| My goal is to prepare some data for R to run an ANOVA on, run it, and  
| retrieve the results to display them on the GUI. Can you suggest me a  
| helpfiles/documentations to read for this?

That should work just fine. One of my apps at work gathers simulation data in
STL vectors of vectors, passes that to an R matrix via one RCpp invocation. I
then assign that object to an R object in the embedded R instances, and let R
run analysis on it.  Much nicer / easier than going the old route of export
to csv, calling R, reimportting, ....

Hth, Dirk

-- 
Three out of two people have difficulties with fractions.


From arne.henningsen at googlemail.com  Wed Jun 18 16:24:12 2008
From: arne.henningsen at googlemail.com (Arne Henningsen)
Date: Wed, 18 Jun 2008 16:24:12 +0200
Subject: [Rd] error with solveLP(linprog) (PR#11721)
In-Reply-To: <20080617140504.21FC1282EFF7@mail.pubhealth.ku.dk>
References: <20080617140504.21FC1282EFF7@mail.pubhealth.ku.dk>
Message-ID: <200806181624.14656.arne.henningsen@googlemail.com>

On Tuesday 17 June 2008 16:05:04, wei.boca at gmail.com wrote:
> Full_Name: wfeng
> Version: 2.7
> OS: windows xp
> Submission from: (NULL) (208.62.252.2)
>
>
> for solveLP(linprog), the program is specified as
>
> Minimizes c'x, subject to A x >= b and x >= 0.
>
> However, what I found is the actual constraints that works with the
> function are
>
> A x <= b and x >= 0.


Thanks for reporting this error. I have corrected this bug and uploaded a 
fixed version of this package to the incoming folder on CRAN. It will be 
available there within the next few days. 

Arne

-- 
Arne Henningsen
http://www.arne-henningsen.name
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080618/a53525fc/attachment.bin>

From arne.henningsen at googlemail.com  Wed Jun 18 16:37:50 2008
From: arne.henningsen at googlemail.com (Arne Henningsen)
Date: Wed, 18 Jun 2008 16:37:50 +0200
Subject: [Rd] HTML help solveLP(linprog) (PR#11250)
In-Reply-To: <20080423142513.60BBF283416D@mail.pubhealth.ku.dk>
References: <20080423142513.60BBF283416D@mail.pubhealth.ku.dk>
Message-ID: <200806181637.58654.arne.henningsen@googlemail.com>

On Wednesday 23 April 2008 16:25:13, Ludek.Salom at rsj.cz wrote:
> Dear R team!
>
> I found in HTML help for function solveLP(linprog) a small mistake. It
> says in Description "Minimizes c'x, subject to A x >=3D b and x >=3D 0",
> but tests show that there should be A x <=3D b.

Thanks for reporting this mistake. I have corrected it and uploaded a 
fixed version of the linprog package to the incoming folder on CRAN. 
It will be available there within the next few days. 
Sorry for fixing this so late,
Arne

-- 
Arne Henningsen
http://www.arne-henningsen.name


From supersubu123 at gmail.com  Wed Jun 18 16:38:39 2008
From: supersubu123 at gmail.com (subramanian R)
Date: Wed, 18 Jun 2008 20:08:39 +0530
Subject: [Rd] Question about Node Classes
Message-ID: <b2d9df730806180738x2a839b79u8227110eafae6d81@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080618/243ae56d/attachment.pl>

From brechbuehler at gmail.com  Wed Jun 18 16:59:39 2008
From: brechbuehler at gmail.com (=?ISO-8859-1?Q?Christian_Brechb=FChler?=)
Date: Wed, 18 Jun 2008 10:59:39 -0400
Subject: [Rd] strsplit and the empty string
In-Reply-To: <48590370.9040702@idi.ntnu.no>
References: <48590370.9040702@idi.ntnu.no>
Message-ID: <c0177e5a0806180759m75c85c07pd80a5630190e0d7d@mail.gmail.com>

On Wed, Jun 18, 2008 at 8:45 AM, Wacek Kusnierczyk
<Waclaw.Marcin.Kusnierczyk at idi.ntnu.no> asked
for opinions:
>
> When the pattern
> matches the beginning of the search string, the empty string is added to
> the result, but that's not the case when the pattern matches the end of
> the search string:
>
> strsplit(" hello dolly ")
> [1] "" "hello" "dolly"

With R version 2.6.1 Patched (2007-11-26 r43541), I get
    Error in strsplit(" hello dolly ") :
      argument "split" is missing, with no default

But strsplit(" hello dolly ", " ") reproduces your results.

> The man for strsplit explains the algorithm:
>
> "
>  The algorithm applied to each input string is
>
>
>         repeat {
>             if the string is empty
>                 break.
>             if there is a match
>                 add the string to the left of the match to the output.
>                 remove the match and all to the left of it.
>             else
>                 add the string to the output.
>                 break.
>         }
>
>     Note that this means that if there is a match at the beginning of
>     a (non-empty) string, the first element of the output is '""', but
>     if there is a match at the end of the string, the output is the
>     same as with the match removed.
> "

The algorithm, the comment after it, and your results are consistent.
Whether it is intuitive is a matter of taste.  I agree it's not as
symmetric as one might like.

> If the pattern matches, (second if above), the match is added to the
> output, and removed from the input -- which after this step is the empty
> string;

Close.  The string to the left of the match, "dolly", is added to the output.
I agree, the input is now the empty string.

> in the next step, there is no match (else above), so the rest of
> the input string (= the empty string) *should* be added, but it is not
> what happens.

No, in the next step, the string is empty (first 'if' above), and we break.
The else branch never applies in your example.

> (i see no good
> reason for including the empty string at the beginning but not at the
> end of the output; no other language i know would do that this way)

I checked Perl, and it does exactly the same:
  print join "==", split / /, " hello dolly "
==hello==dolly
(that's 3 elements: "", "hello",  and "dolly").

Cheers,
/Christian


From Peter.Peyk at unibas.ch  Wed Jun 18 17:02:26 2008
From: Peter.Peyk at unibas.ch (Peter.Peyk at unibas.ch)
Date: Wed, 18 Jun 2008 17:02:26 +0200
Subject: [Rd] embedding R in c++ (Qt) application
In-Reply-To: <18521.917.139728.502094@ron.nulle.part>
References: <20080618141314.bcfilb6nr4wowgw8@webmail.unibas.ch>
	<18521.917.139728.502094@ron.nulle.part>
Message-ID: <20080618170226.is1zzb73acckkk04@webmail.unibas.ch>

Dirk, that sounds exactly like what I've been looking for.
Thanks a lot!
Peter


>
> Peter,
>
> On 18 June 2008 at 14:13, Peter.Peyk at unibas.ch wrote:
> | Hi R-Developers,
> |
> | I'm working on running statistical analyses with embedded R from a
> | Qt-GUI-application (C++).
> |
> | I've been able to link with R libraries, but I'm having a hard time to
> | understand the C-coding examples. I'm a C++, not a C programmer (never
> | used malloc before), and many of the R-specific
> | functions/keywords/macros (for instance (UN)PROTECT, SETCAR, all the
> | data types (SEXP, CHARSXP etc..) ) don't mean anything to me. The
> | section on the SEXP type in the R-internals doc didn't tell me much.
> | How can I create such objects containing my data? how can I extract
> | numbers or strings from SEXPs?
>
> Have a look at RCpp at http://r-forge.r-project.org. While initially written
> for accessing C++ from R, it works perfectly well the other way too.  Thanks
> to a number of (templated) classes, it abstracts away a lot of the underlying
> C representation.
>
> I also use for embedded R inside of C++.
>
> [...]
>
> | My goal is to prepare some data for R to run an ANOVA on, run it, and
> | retrieve the results to display them on the GUI. Can you suggest me a
> | helpfiles/documentations to read for this?
>
> That should work just fine. One of my apps at work gathers simulation data in
> STL vectors of vectors, passes that to an R matrix via one RCpp invocation. I
> then assign that object to an R object in the embedded R instances, and let R
> run analysis on it.  Much nicer / easier than going the old route of export
> to csv, calling R, reimportting, ....
>
> Hth, Dirk
>
> --
> Three out of two people have difficulties with fractions.
>


From gavin.simpson at ucl.ac.uk  Wed Jun 18 21:47:51 2008
From: gavin.simpson at ucl.ac.uk (Gavin Simpson)
Date: Wed, 18 Jun 2008 20:47:51 +0100
Subject: [Rd] bug in (and patch for) example preserving device 'ask' state
	[Was	Re: example() and "ask"]
In-Reply-To: <1213792100.30251.48.camel@prometheus.geog.ucl.ac.uk>
References: <1213792100.30251.48.camel@prometheus.geog.ucl.ac.uk>
Message-ID: <1213818471.30251.100.camel@prometheus.geog.ucl.ac.uk>

Dear List,

In investigating this a bit more, I've just realised that the source has
this nice comment (in the svn trunk) indicating that there is a problem,
and it is known about:

        ## <FIXME>
        ## This ensures that any device opened by the examples will
        ## have ask = TRUE set, but it does not return the device to
        ## the expected 'ask' state if it is left as the current device.
        ## </FIXME>
        op <- options(device.ask.default = TRUE)
        on.exit(options(op), add = TRUE)

I can get what appears to be correct behaviour if I replace the two
lines above with:

        oldask <- grDevices::devAskNewPage(ask = TRUE)
        on.exit(grDevices::devAskNewPage(oldask), add = TRUE)

Which are the same as the two lines in the if statement directly above,
which checks if .Device is not "null device". This suggests that the
check for "null device" is not needed and we can just reset the 'ask'
status to what it was before example was called. This is the approach I
have taken in the attached patch.

If I understand what ?example means when discussing argument 'ask',
there is an added complication, in that an example may open new devices.
If we take the above fix then the device that is returned to
the /original/ 'ask' state will be the last newly opened device. An
alternative might be to recall which device was current upon calling
example() and then to make that device active and reset its 'ask' state.

This is the approach I have taken in the attached patch, produced via
svn diff against the current R devel trunk.

In the event that the device that was current gets closed during the
example, then upon exit and attempt to reset what was the current
device, the next device is made active and its 'ask' status is set to
the original 'ask' status. This is the behaviour of dev.set when
argument 'which' is not an available device.

I've built R devel (r45948) and tested this patch as best I can here
within an R session and it works ok for the limited use-cases I tried. I
didn't try an explicit example that opens an additional new device as
part of the example as I don't have one of those to hand. I did run make
check-all and there were no problems, but I guess this was all not
interactive so didn't really test the new code. If anyone knows of such
an example, I'd be happy to run it in my local R devel build and see how
the new code performs.

All the best,

G

On Wed, 2008-06-18 at 13:28 +0100, Gavin Simpson wrote:
> Dear list,
> 
> Is it intentional that example() opens a new device and leaves it in a
> mode where it asks (prompts) the user to Press return to see the next
> plot for *all* subsequent plots on that device.
> 
> For example; with an already opened device, example() works as I would
> expect:
> 
> > par("ask")
> [1] FALSE
> > example(lm)
> .... OUTPUT CLIPPED ....
> lm> plot(lm.D9, las = 1)      # Residuals, Fitted, ...
> Hit <Return> to see next plot: 
> 
> lm> par(opar)
> 
> lm> ## model frame :
> lm> stopifnot(identical(lm(weight ~ group, method = "model.frame"),
> lm+                     model.frame(lm.D9)))
> > plot(1:10)
> >
> 
> So with an already opened device, plots /within/ example prompt the user
> (by default) but at the end of the example, we return to default and we
> are not prompted to display subsequent plots on that device (par("ask)
> == FALSE)
> 
> However, if example opens a device (i.e. example is the first plotting
> function called in a session), then the device remains in "prompt" mode:
> 
> > # continue example from above, so close the device
> > dev.off()
> null device 
>           1 
> > example(lm) # will open device when required
> .... output suppressed ....
> lm> plot(lm.D9, las = 1)      # Residuals, Fitted, ...
> Hit <Return> to see next plot: 
> 
> lm> par(opar)
> 
> lm> ## model frame :
> lm> stopifnot(identical(lm(weight ~ group, method = "model.frame"),
> lm+                     model.frame(lm.D9)))
> > par("ask")
> [1] TRUE
> > plot(1:10)
> Hit <Return> to see next plot: 
> 
> Device remains in "prompt" mode.
> 
> I would have expected example() to clean up and return par("ask") to
> what it was before example() was called in the case where it opens it's
> own device, just as it does if called with an already open and active
> device.
> 
> If this is intentional, it doesn't strike me as being intuitive or user
> friendly. Is there scope and a will to change this behaviour?
> 
> This is with R 2.7.1RC and R 2.8.0 to be:
> 
> > version
>                _                                     
> platform       x86_64-unknown-linux-gnu              
> arch           x86_64                                
> os             linux-gnu                             
> system         x86_64, linux-gnu                     
> status         RC                                    
> major          2                                     
> minor          7.1                                   
> year           2008                                  
> month          06                                    
> day            16                                    
> svn rev        45948                                 
> language       R                                     
> version.string R version 2.7.1 RC (2008-06-16 r45948)
> 
> > version
>                _                                                               
> platform       x86_64-unknown-linux-gnu                                        
> arch           x86_64                                                          
> os             linux-gnu                                                       
> system         x86_64, linux-gnu                                               
> status         Under development (unstable)                                    
> major          2                                                               
> minor          8.0                                                             
> year           2008                                                            
> month          06                                                              
> day            18                                                              
> svn rev        45948                                                           
> language       R                                                               
> version.string R version 2.8.0 Under development (unstable) (2008-06-18 r45948)
> 
> Many thanks,
> 
> G
> -- 
> %~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
>  Dr. Gavin Simpson             [t] +44 (0)20 7679 0522
>  ECRC, UCL Geography,          [f] +44 (0)20 7679 0565
>  Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk
>  Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/
>  UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk
> %~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
-- 
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
 Dr. Gavin Simpson             [t] +44 (0)20 7679 0522
 ECRC, UCL Geography,          [f] +44 (0)20 7679 0565
 Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk
 Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/
 UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
-------------- next part --------------
A non-text attachment was scrubbed...
Name: patch_example.diff
Type: text/x-patch
Size: 1212 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080618/5a784b84/attachment.bin>

From Waclaw.Marcin.Kusnierczyk at idi.ntnu.no  Wed Jun 18 23:22:23 2008
From: Waclaw.Marcin.Kusnierczyk at idi.ntnu.no (Wacek Kusnierczyk)
Date: Wed, 18 Jun 2008 23:22:23 +0200
Subject: [Rd] strsplit and the empty string
In-Reply-To: <c0177e5a0806180759m75c85c07pd80a5630190e0d7d@mail.gmail.com>
References: <48590370.9040702@idi.ntnu.no>
	<c0177e5a0806180759m75c85c07pd80a5630190e0d7d@mail.gmail.com>
Message-ID: <48597C8F.9040802@idi.ntnu.no>

Oh my, I regret my stupidity.

Christian Brechb?hler wrote:
>
> With R version 2.6.1 Patched (2007-11-26 r43541), I get
>     Error in strsplit(" hello dolly ") :
>       argument "split" is missing, with no default
>
> But strsplit(" hello dolly ", " ") reproduces your results.
>
>   
of course, that was my test code.

>
>
> The algorithm, the comment after it, and your results are consistent.
> Whether it is intuitive is a matter of taste.  I agree it's not as
> symmetric as one might like.
>
>   
the problem is that one needs to check for the empty string at the
beginning, if there could be one in the output.  perhaps an additional
logical argument to strsplit would be useful, e.g., 'reduce', 'sparse',
or whatever the name.

>> If the pattern matches, (second if above), the match is added to the
>> output, and removed from the input -- which after this step is the empty
>> string;
>>     
>
> Close.  The string to the left of the match, "dolly", is added to the output.
>   
that was what i should have written.  that was all too hasty.

> I agree, the input is now the empty string.
>
>   
>> in the next step, there is no match (else above), so the rest of
>> the input string (= the empty string) *should* be added, but it is not
>> what happens.
>>     
>
> No, in the next step, the string is empty (first 'if' above), and we break.
> The else branch never applies in your example.
>
>   

there's where my stupidity becomes apparent, i'm afraid ,(

>> (i see no good
>> reason for including the empty string at the beginning but not at the
>> end of the output; no other language i know would do that this way)
>>     
>
> I checked Perl, and it does exactly the same:
>   print join "==", split / /, " hello dolly "
> ==hello==dolly
> (that's 3 elements: "", "hello",  and "dolly").
>   

indeed, i must have mistyped while checking it.  so the results in a few
other languages are:

3 elements: java (and groovy), oz
4 elements: python, javascript, php, boo
2 elements: ruby,

while they are not mutually coherent, the last two approaches are at
least symmetric, which i find much more intuitive.

thanks for the reponse.  a good lesson ;)

vQ


From Luc.Menut at supagro.inra.fr  Wed Jun 18 23:40:31 2008
From: Luc.Menut at supagro.inra.fr (Luc Menut)
Date: Wed, 18 Jun 2008 23:40:31 +0200
Subject: [Rd] problem with personal library (R_LIBS_USER) when R_LIBS is
 defined (patch)
Message-ID: <485980CF.801@supagro.inra.fr>

As from R 2.5.0 users can install packages in their home directories, in 
directory specified by the environment variable R_LIBS_USER. It's a 
great feature.
But I have a problem with this feature, when R_LIBS is defined.
It works well the first time, when R creates the directory defined in 
R_LIBS_USER.

 > install.packages('BayesTree')
Warning in install.packages("BayesTree") :
   argument 'lib' is missing: using '/usr/lib64/R/lib'
Warning in install.packages("BayesTree") :
   'lib = "/usr/lib64/R/lib"' is not writable
Would you like to create a personal library
'~/R/x86_64-mandriva-linux-gnu-library/2.7'
to install packages into?  (y/n) y
.....
 > q()

But if you close R, then launch R again, R fails to reuse this directory 
(R_LIBS_USER) to install another package, because the directories 
defined in R_LIBS are in first in the libPaths (and it fails if R_LIBS 
isn't writable by user).

 > .libPaths()
[1] "/usr/lib64/R/lib"
[2] "/home/menut/R/x86_64-mandriva-linux-gnu-library/2.7"
[3] "/usr/lib64/R/library"

 > install.packages('BayesValidate')
Warning in install.packages("BayesValidate") :
   argument 'lib' is missing: using '/usr/lib64/R/lib'
Warning in install.packages("BayesValidate") :
   'lib = "/usr/lib64/R/lib"' is not writable
Error in install.packages("BayesValidate") : unable to install packages

I attach a patch, which try to reuse existing user directory R_LIBS_USER 
(tested under Linux).
with this patch
 > .libPaths()
[1] "/usr/lib64/R/lib"
[2] "/home/menut/R/x86_64-mandriva-linux-gnu-library/2.7"
[3] "/usr/lib64/R/library"
 > install.packages('BayesValidate')
Warning in install.packages("BayesValidate") :
   argument 'lib' is missing: using '/usr/lib64/R/lib'
Warning in install.packages("BayesValidate") :
   'lib = "/usr/lib64/R/lib"' is not writable
Warning in install.packages("BayesValidate") :
   using '~/R/x86_64-mandriva-linux-gnu-library/2.7'
...


Please could you review it and tell me if such things are worth 
including into upstream version.

Best regards,
Luc

-- 
Luc MENUT
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: R-2.7.0-install_packages-R_LIBS_USER-fix.patch
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080618/17c7248b/attachment.pl>

From mjbauer at eecs.tufts.edu  Wed Jun 18 22:30:56 2008
From: mjbauer at eecs.tufts.edu (mjbauer at eecs.tufts.edu)
Date: Wed, 18 Jun 2008 22:30:56 +0200 (CEST)
Subject: [Rd] Improper directory removal causes file system havoc (PR#11738)
Message-ID: <20080618203056.D2213283460E@mail.pubhealth.ku.dk>

Full_Name: Michael Bauer
Version: 2.7.0
OS: Solaris 10 (sparc)
Submission from: (NULL) (130.64.21.7)


When running 'make check' on a fresh R 2.7.0 build on Solaris 10 (sparc),
reg-tests-1.R fails consistently because the test directory /tmp/R<random>
cannot be deleted.  The reason for the deletion failure is because the file
system thinks that the directory is still full, as its link count is not 2 -- it
is 5.  The key bit of reg-tests-1.R is:

dd <- c("dir1", "dir2", "dirs", "moredirs")
for(d in dd) dir.create(d)
dir(".")
file.create(file.path(dd, "somefile"))
dir(".", recursive=TRUE)
stopifnot(unlink("dir?") == 1) # not an error
unlink("dir?", recursive = TRUE)
stopifnot(file.exists(dd) == c(FALSE, FALSE, FALSE, TRUE))
unlink("*dir*", recursive = TRUE)
stopifnot(!file.exists(dd))

I've run this code snippet in the R command line.  The initial state of the
directory is:

root at sunfire16# mkdir testdir
root at sunfire16# cd testdir
root at sunfire16# ls -al
total 34
drwx------   2 root          512 Jun 18 16:12 .
drwxrwxrwt  18 root        33280 Jun 18 16:12 ..


After the file.create command, the directory state is:

root at sunfire16# ls -al
total 38
drwx------   6 root          512 Jun 18 16:13 .
drwxrwxrwt  19 root        33280 Jun 18 16:13 ..
drwx------   2 root          512 Jun 18 16:13 dir1
drwx------   2 root          512 Jun 18 16:13 dir2
drwx------   2 root          512 Jun 18 16:13 dirs
drwx------   2 root          512 Jun 18 16:13 moredirs
root at sunfire16# ls -al *
dir1:
total 2
drwx------   2 root          512 Jun 18 16:13 .
drwx------   6 root          512 Jun 18 16:13 ..
-rw-------   1 root            0 Jun 18 16:13 somefile

dir2:
total 2
drwx------   2 root          512 Jun 18 16:13 .
drwx------   6 root          512 Jun 18 16:13 ..
-rw-------   1 root            0 Jun 18 16:13 somefile

dirs:
total 2
drwx------   2 root          512 Jun 18 16:13 .
drwx------   6 root          512 Jun 18 16:13 ..
-rw-------   1 root            0 Jun 18 16:13 somefile

moredirs:
total 2
drwx------   2 root          512 Jun 18 16:13 .
drwx------   6 root          512 Jun 18 16:13 ..
-rw-------   1 root            0 Jun 18 16:13 somefile


However, immediately after the unlink("dir?") command, the directory state is
incorrect.  Note that in addition to dir1, dir2, and dirs being missing, the
link count on the parent directory is still 6, not 3.

root at sunfire16# ls -al
total 35
drwx------   6 root          512 Jun 18 16:13 .
drwxrwxrwt  20 root        33280 Jun 18 16:20 ..
drwx------   2 root          512 Jun 18 16:13 moredirs
root at sunfire16# ls -al *
total 2
drwx------   2 root          512 Jun 18 16:13 .
drwx------   6 root          512 Jun 18 16:13 ..
-rw-------   1 root            0 Jun 18 16:13 somefile


Once the rest of the code runs, the directory state is still incorrect, with the
link count on a now-empty directory still being 5 instead of 2:

root at sunfire16# ls -al
total 34
drwx------   5 root          512 Jun 18 16:23 .
drwxrwxrwt  20 root        33280 Jun 18 16:20 ..


The directory now cannot be removed, either within R or by hand in the shell:

root at sunfire16# cd ..
root at sunfire16# rmdir testdir
rmdir: directory "testdir": Directory not empty


The only thing I've found to fix this is unmounting the file system and running
fsck on it.  This finds the mis-deleted directories and fixes the broken link
counts.

I'm not certain if this is a bug in R or in Solaris, though it certainly looks
like a Solaris bug.  I have submitted the bug to both you and Solaris.

I also have truss output from a run of this, which shows R using a mix of
unlink() and unlinkat() for directory removal.  unlink() is the call that
incorrectly removes the directories.  The pertinent bits are:

17500:  unlink("dir1")                                  = 0
17500:  unlink("dir2")                                  = 0
17500:  unlink("dirs")                                  = 0
17500:  unlink("/tmp/RtmpKrefN4/41c6167e")              = 0
17702:  lstat64("/", 0xFFBFF640)                        = 0
17702:  fstatat64(-3041965, "/tmp/RtmpKrefN4", 0xFFBFF5C8, 0x00001000) = 0
17702:  unlinkat(-3041965, "/tmp/RtmpKrefN4", 0x00000000) Err#1 EPERM
[sys_linkd
ir]
17702:  unlinkat(3, "file153e1776", 0x00000000)         = 0
17702:  unlinkat(3, "file47b5546c", 0x00000000)         = 0
17702:  unlinkat(3, "moredirs", 0x00000000)             Err#1 EPERM
[sys_linkdir
]
17702:  fstatat64(3, "moredirs", 0xFFBFF530, 0x00001000) = 0
17702:  openat64(3, "moredirs", O_RDONLY|O_NONBLOCK|O_NOCTTY|O_NOFOLLOW) = 4
17702:  unlinkat(4, "somefile", 0x00000000)             = 0
17702:  unlinkat(3, "moredirs", 0x00000001)             = 0
17702:  unlinkat(-3041965, "/tmp/RtmpKrefN4", 0x00000001) Err#22 EINVAL


I can provide the full truss output if desired.


From ripley at stats.ox.ac.uk  Thu Jun 19 08:40:24 2008
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Thu, 19 Jun 2008 08:40:24 +0200 (CEST)
Subject: [Rd] Improper directory removal causes file system havoc
	(PR#11747)
Message-ID: <20080619064024.1877C283416C@mail.pubhealth.ku.dk>

This is not general on Solaris 10 -- it works for others, as the R-admin 
manual told you.

What sort of file system is the test being run on?

It does look very like a Solaris file system bug.

On Wed, 18 Jun 2008, mjbauer at eecs.tufts.edu wrote:

> Full_Name: Michael Bauer
> Version: 2.7.0
> OS: Solaris 10 (sparc)
> Submission from: (NULL) (130.64.21.7)
>
>
> When running 'make check' on a fresh R 2.7.0 build on Solaris 10 (sparc),
> reg-tests-1.R fails consistently because the test directory /tmp/R<random>
> cannot be deleted.  The reason for the deletion failure is because the file
> system thinks that the directory is still full, as its link count is not 2 -- it
> is 5.  The key bit of reg-tests-1.R is:
>
> dd <- c("dir1", "dir2", "dirs", "moredirs")
> for(d in dd) dir.create(d)
> dir(".")
> file.create(file.path(dd, "somefile"))
> dir(".", recursive=TRUE)
> stopifnot(unlink("dir?") == 1) # not an error
> unlink("dir?", recursive = TRUE)
> stopifnot(file.exists(dd) == c(FALSE, FALSE, FALSE, TRUE))
> unlink("*dir*", recursive = TRUE)
> stopifnot(!file.exists(dd))
>
> I've run this code snippet in the R command line.  The initial state of the
> directory is:
>
> root at sunfire16# mkdir testdir
> root at sunfire16# cd testdir
> root at sunfire16# ls -al
> total 34
> drwx------   2 root          512 Jun 18 16:12 .
> drwxrwxrwt  18 root        33280 Jun 18 16:12 ..
>
>
> After the file.create command, the directory state is:
>
> root at sunfire16# ls -al
> total 38
> drwx------   6 root          512 Jun 18 16:13 .
> drwxrwxrwt  19 root        33280 Jun 18 16:13 ..
> drwx------   2 root          512 Jun 18 16:13 dir1
> drwx------   2 root          512 Jun 18 16:13 dir2
> drwx------   2 root          512 Jun 18 16:13 dirs
> drwx------   2 root          512 Jun 18 16:13 moredirs
> root at sunfire16# ls -al *
> dir1:
> total 2
> drwx------   2 root          512 Jun 18 16:13 .
> drwx------   6 root          512 Jun 18 16:13 ..
> -rw-------   1 root            0 Jun 18 16:13 somefile
>
> dir2:
> total 2
> drwx------   2 root          512 Jun 18 16:13 .
> drwx------   6 root          512 Jun 18 16:13 ..
> -rw-------   1 root            0 Jun 18 16:13 somefile
>
> dirs:
> total 2
> drwx------   2 root          512 Jun 18 16:13 .
> drwx------   6 root          512 Jun 18 16:13 ..
> -rw-------   1 root            0 Jun 18 16:13 somefile
>
> moredirs:
> total 2
> drwx------   2 root          512 Jun 18 16:13 .
> drwx------   6 root          512 Jun 18 16:13 ..
> -rw-------   1 root            0 Jun 18 16:13 somefile
>
>
> However, immediately after the unlink("dir?") command, the directory state is
> incorrect.  Note that in addition to dir1, dir2, and dirs being missing, the
> link count on the parent directory is still 6, not 3.
>
> root at sunfire16# ls -al
> total 35
> drwx------   6 root          512 Jun 18 16:13 .
> drwxrwxrwt  20 root        33280 Jun 18 16:20 ..
> drwx------   2 root          512 Jun 18 16:13 moredirs
> root at sunfire16# ls -al *
> total 2
> drwx------   2 root          512 Jun 18 16:13 .
> drwx------   6 root          512 Jun 18 16:13 ..
> -rw-------   1 root            0 Jun 18 16:13 somefile
>
>
> Once the rest of the code runs, the directory state is still incorrect, with the
> link count on a now-empty directory still being 5 instead of 2:
>
> root at sunfire16# ls -al
> total 34
> drwx------   5 root          512 Jun 18 16:23 .
> drwxrwxrwt  20 root        33280 Jun 18 16:20 ..
>
>
> The directory now cannot be removed, either within R or by hand in the shell:
>
> root at sunfire16# cd ..
> root at sunfire16# rmdir testdir
> rmdir: directory "testdir": Directory not empty
>
>
> The only thing I've found to fix this is unmounting the file system and running
> fsck on it.  This finds the mis-deleted directories and fixes the broken link
> counts.
>
> I'm not certain if this is a bug in R or in Solaris, though it certainly looks
> like a Solaris bug.  I have submitted the bug to both you and Solaris.
>
> I also have truss output from a run of this, which shows R using a mix of
> unlink() and unlinkat() for directory removal.  unlink() is the call that
> incorrectly removes the directories.  The pertinent bits are:
>
> 17500:  unlink("dir1")                                  = 0
> 17500:  unlink("dir2")                                  = 0
> 17500:  unlink("dirs")                                  = 0
> 17500:  unlink("/tmp/RtmpKrefN4/41c6167e")              = 0
> 17702:  lstat64("/", 0xFFBFF640)                        = 0
> 17702:  fstatat64(-3041965, "/tmp/RtmpKrefN4", 0xFFBFF5C8, 0x00001000) = 0
> 17702:  unlinkat(-3041965, "/tmp/RtmpKrefN4", 0x00000000) Err#1 EPERM
> [sys_linkd
> ir]
> 17702:  unlinkat(3, "file153e1776", 0x00000000)         = 0
> 17702:  unlinkat(3, "file47b5546c", 0x00000000)         = 0
> 17702:  unlinkat(3, "moredirs", 0x00000000)             Err#1 EPERM
> [sys_linkdir
> ]
> 17702:  fstatat64(3, "moredirs", 0xFFBFF530, 0x00001000) = 0
> 17702:  openat64(3, "moredirs", O_RDONLY|O_NONBLOCK|O_NOCTTY|O_NOFOLLOW) = 4
> 17702:  unlinkat(4, "somefile", 0x00000000)             = 0
> 17702:  unlinkat(3, "moredirs", 0x00000001)             = 0
> 17702:  unlinkat(-3041965, "/tmp/RtmpKrefN4", 0x00000001) Err#22 EINVAL
>
>
> I can provide the full truss output if desired.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From Rory.WINSTON at rbs.com  Thu Jun 19 12:25:59 2008
From: Rory.WINSTON at rbs.com (WINSTON, Rory, GBM)
Date: Thu, 19 Jun 2008 11:25:59 +0100
Subject: [Rd] embedding R in c++ (Qt) application
In-Reply-To: <mailman.19.1213869605.26571.r-devel@r-project.org>
References: <mailman.19.1213869605.26571.r-devel@r-project.org>
Message-ID: <F5AB27C222D4164382737207F9869F2B51675A9D00@LONMC01014.rbsres07.net>

Hi Peter

Just a note on the SETCAR, SETCADR, macros etc. - if you look at an introductory Lisp or Scheme tutorial, you will see the origins of these names, and hopefully their behaviour will make sense ;-)

Cheers
Rory

***********************************************************************************
The Royal Bank of Scotland plc. Registered in Scotland No 90312. Registered Office: 36 St Andrew Square, Edinburgh EH2 2YB. 
Authorised and regulated by the Financial Services Authority

This e-mail message is confidential and for use by the 
addressee only. If the message is received by anyone other 
than the addressee, please return the message to the sender 
by replying to it and then delete the message from your 
computer. Internet e-mails are not necessarily secure. The 
Royal Bank of Scotland plc does not accept responsibility for 
changes made to this message after it was sent. 

Whilst all reasonable care has been taken to avoid the 
transmission of viruses, it is the responsibility of the recipient to 
ensure that the onward transmission, opening or use of this 
message and any attachments will not adversely affect its 
systems or data. No responsibility is accepted by The 
Royal Bank of Scotland plc in this regard and the recipient should carry 
out such virus and other checks as it considers appropriate. 
Visit our websites at: 
www.rbs.com
www.rbs.com/gbm
www.rbsgc.com
***********************************************************************************


______________________________________________________________________
This email has been scanned by the MessageLabs Email Security System.
For more information please visit http://www.messagelabs.com/email 


From Peter.Peyk at unibas.ch  Thu Jun 19 17:37:30 2008
From: Peter.Peyk at unibas.ch (Peter.Peyk at unibas.ch)
Date: Thu, 19 Jun 2008 17:37:30 +0200
Subject: [Rd] embedding R in c++ (Qt) application
In-Reply-To: <18521.917.139728.502094@ron.nulle.part>
References: <20080618141314.bcfilb6nr4wowgw8@webmail.unibas.ch>
	<18521.917.139728.502094@ron.nulle.part>
Message-ID: <20080619173730.6tdkscsm8ks848o8@webmail.unibas.ch>

Hi Dirk,

I've had a closer look now at Rcpp and I've found a lot
of constructors and functions that take SEXPs as input - so the way back from
R to C++ seems clear to me.

However, I don't know how to pass my data from c++ to R . I've managed
to have the embedded R evaluate commands (construct vectors and do  
something with them) with the help of the official manual,
but I couldn't assign for instance an RcppVector to an SEXP or any of  
these constructed vectors ...
The only clue I had is the dataframe that is constructed in the  
included Rcpp example  - but it's used only with a custom made  
function - not with standard R functions which would be my goal with  
the ANOVA.

Thanks for your help!!!
Peter





>
> Peter,
>
> On 18 June 2008 at 14:13, Peter.Peyk at unibas.ch wrote:
> | Hi R-Developers,
> |
> | I'm working on running statistical analyses with embedded R from a
> | Qt-GUI-application (C++).
> |
> | I've been able to link with R libraries, but I'm having a hard time to
> | understand the C-coding examples. I'm a C++, not a C programmer (never
> | used malloc before), and many of the R-specific
> | functions/keywords/macros (for instance (UN)PROTECT, SETCAR, all the
> | data types (SEXP, CHARSXP etc..) ) don't mean anything to me. The
> | section on the SEXP type in the R-internals doc didn't tell me much.
> | How can I create such objects containing my data? how can I extract
> | numbers or strings from SEXPs?
>
> Have a look at RCpp at http://r-forge.r-project.org. While initially written
> for accessing C++ from R, it works perfectly well the other way too.  Thanks
> to a number of (templated) classes, it abstracts away a lot of the underlying
> C representation.
>
> I also use for embedded R inside of C++.
>
> [...]
>
> | My goal is to prepare some data for R to run an ANOVA on, run it, and
> | retrieve the results to display them on the GUI. Can you suggest me a
> | helpfiles/documentations to read for this?
>
> That should work just fine. One of my apps at work gathers simulation data in
> STL vectors of vectors, passes that to an R matrix via one RCpp invocation. I
> then assign that object to an R object in the embedded R instances, and let R
> run analysis on it.  Much nicer / easier than going the old route of export
> to csv, calling R, reimportting, ....
>
> Hth, Dirk
>
> --
> Three out of two people have difficulties with fractions.
>


From luke at stat.uiowa.edu  Thu Jun 19 17:45:21 2008
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Thu, 19 Jun 2008 10:45:21 -0500 (CDT)
Subject: [Rd] unix.time() scoping problem (PR#11169)
In-Reply-To: <20080414193013.224F4282EF48@mail.pubhealth.ku.dk>
References: <20080414193013.224F4282EF48@mail.pubhealth.ku.dk>
Message-ID: <alpine.DEB.1.00.0806191043020.6574@luke-inspiron>

This is now fixed in R-devel (r 45953).

luke

On Mon, 14 Apr 2008, bill at insightful.com wrote:

> Full_Name: Bill Dunlap
> Version: 2.8.0 Under development (unstable) svn 45325
> OS: Linux
> Submission from: (NULL) (76.28.245.14)
>
>
> It is difficult to write wrapper functions
> for unix.time(expr) because it uses the idiom
>    expr <- substitute(expr)
>    eval(expr, envir=sys.parent())
> to evaluate the input expression.  Here is an
> example of the problem
>    > elapsed.time<-function(...)unix.time(...)[3]
>    > sapply(1:3, function(seconds.arg)elapsed.time(Sys.sleep(seconds.arg)))
>    Error in Sys.sleep(seconds.arg) : object "seconds.arg" not found
>    Timing stopped at: 0.002 0 0.002
>
> I think thatif unix.time(expr) made use of lazy evaluation of
> arguments and used just
>    expr
> at the point where it wanted expr to be evaluated,
> then the evaluation would take place in the right frame.
> If I make the following change
> diff -c /tmp/unix.time.R /tmp/my.unix.time.R
> *** /tmp/unix.time.R    2008-04-14 12:22:39.000000000 -0700
> --- /tmp/my.unix.time.R 2008-04-14 12:22:32.000000000 -0700
> ***************
> *** 10,23 ****
>      }
>      if (!exists("proc.time"))
>          return(rep(NA_real_, 5))
> -     loc.frame <- parent.frame()
>      if (gcFirst)
>          gc(FALSE)
> -     expr <- substitute(expr)
>      time <- proc.time()
>      on.exit(cat("Timing stopped at:", ppt(proc.time() - time),
>          "\n"))
> !     eval(expr, envir = loc.frame)
>      new.time <- proc.time()
>      on.exit()
>      structure(new.time - time, class = "proc_time")
> --- 10,21 ----
>      }
>      if (!exists("proc.time"))
>          return(rep(NA_real_, 5))
>      if (gcFirst)
>          gc(FALSE)
>      time <- proc.time()
>      on.exit(cat("Timing stopped at:", ppt(proc.time() - time),
>          "\n"))
> !     expr # evaluate in its original frame by lazy evaluation
>      new.time <- proc.time()
>      on.exit()
>      structure(new.time - time, class = "proc_time")
>
> then my wrapper function works as expected:
>> sapply(1:3, function(seconds.arg)elapsed.time(Sys.sleep(seconds.arg)))
> elapsed elapsed elapsed
>  1.001   2.001   3.001
>
> Another approach would be to find the environment that expr
> came from and feed that into eval().  Is there a way to get
> the environment that an unevaluated argument was created in?
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From edd at debian.org  Fri Jun 20 05:32:38 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 19 Jun 2008 22:32:38 -0500
Subject: [Rd] embedding R in c++ (Qt) application
In-Reply-To: <20080619173730.6tdkscsm8ks848o8@webmail.unibas.ch>
References: <20080618141314.bcfilb6nr4wowgw8@webmail.unibas.ch>
	<18521.917.139728.502094@ron.nulle.part>
	<20080619173730.6tdkscsm8ks848o8@webmail.unibas.ch>
Message-ID: <18523.9430.134967.89745@ron.nulle.part>


Peter,

On 19 June 2008 at 17:37, Peter.Peyk at unibas.ch wrote:
| Hi Dirk,
| 
| I've had a closer look now at Rcpp and I've found a lot
| of constructors and functions that take SEXPs as input - so the way back from
| R to C++ seems clear to me.
| 
| However, I don't know how to pass my data from c++ to R . I've managed
| to have the embedded R evaluate commands (construct vectors and do  
| something with them) with the help of the official manual,
| but I couldn't assign for instance an RcppVector to an SEXP or any of  
| these constructed vectors ...

I think you are halfway there. You have an embedded R session, you can assign
variables and evaluate commands. You also see RCpp and how to pass data
out. I think all I did at that point was to invert a few of those functions
to pass data in ... and there you have it in your embedded R session.

Hope this helps, Dirk

-- 
Three out of two people have difficulties with fractions.


From Peter.Peyk at unibas.ch  Fri Jun 20 08:36:52 2008
From: Peter.Peyk at unibas.ch (Peter.Peyk at unibas.ch)
Date: Fri, 20 Jun 2008 08:36:52 +0200
Subject: [Rd] embedding R in c++ (Qt) application
In-Reply-To: <18523.9430.134967.89745@ron.nulle.part>
References: <20080618141314.bcfilb6nr4wowgw8@webmail.unibas.ch>
	<18521.917.139728.502094@ron.nulle.part>
	<20080619173730.6tdkscsm8ks848o8@webmail.unibas.ch>
	<18523.9430.134967.89745@ron.nulle.part>
Message-ID: <20080620083652.pl7hgeykz4skcss0@webmail.unibas.ch>

Hi Dirk,

ok - now it works. All the MACROs scared me a little,
but now I've found them in Rinternals.h and Rdefines.h .
There was a section in the official manual referring to these,
but this section was not introduced for embedded R but for calling c++  
from R - this is why i didn't find it at first.

Thanks again for you help!!
Best
Peter

>
> Peter,
>
> On 19 June 2008 at 17:37, Peter.Peyk at unibas.ch wrote:
> | Hi Dirk,
> |
> | I've had a closer look now at Rcpp and I've found a lot
> | of constructors and functions that take SEXPs as input - so the   
> way back from
> | R to C++ seems clear to me.
> |
> | However, I don't know how to pass my data from c++ to R . I've managed
> | to have the embedded R evaluate commands (construct vectors and do
> | something with them) with the help of the official manual,
> | but I couldn't assign for instance an RcppVector to an SEXP or any of
> | these constructed vectors ...
>
> I think you are halfway there. You have an embedded R session, you can assign
> variables and evaluate commands. You also see RCpp and how to pass data
> out. I think all I did at that point was to invert a few of those functions
> to pass data in ... and there you have it in your embedded R session.
>
> Hope this helps, Dirk
>
> --
> Three out of two people have difficulties with fractions.
>


From dsuo at fas.harvard.edu  Fri Jun 20 20:50:12 2008
From: dsuo at fas.harvard.edu (dsuo at fas.harvard.edu)
Date: Fri, 20 Jun 2008 20:50:12 +0200 (CEST)
Subject: [Rd] NAMESPACE file should be checked (PR#11765)
Message-ID: <20080620185012.61A25282C786@mail.pubhealth.ku.dk>

Full_Name: Daniel Suo
Version: 2.7.0
OS: OS X
Submission from: (NULL) (128.12.16.145)


The NAMESPACE file should be checked for validity. For example, the following
entry will pass R CMD check:

dfgphofgohkpo(sdfpsodfk)

I'm not sure if the other files are checked rigorously, but this is the first
that I've noticed.

Thanks,
Daniel


From edd at debian.org  Sat Jun 21 19:04:28 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 21 Jun 2008 12:04:28 -0500
Subject: [Rd] Minor configure bug in R 2.7.1-rc
Message-ID: <18525.13468.615927.404761@ron.nulle.part>


Updating the Debian package to the current 2.7.1 rc, I noticed that R decides
to use its own bzip2 sources.  Looking at configure, I see the test is
essentially a strcmp on '1.0.5' from the version-returning function:
 
   #ifdef HAVE_BZLIB_H
   #include <bzlib.h>
   #endif
   int main() {
      char *ver = BZ2_bzlibVersion();
      exit(strcmp(ver, "1.0.5") < 0);
   }

but unfortunately, bzip2 returns a different string that includes the date:

   edd at ron:~/src/debian/R/R-2.7.1.20080621> cat /tmp/bzver.c
   #include <bzlib.h>
   #include <string.h>
   int main() {
       const char *ver = BZ2_bzlibVersion();
       printf("[%s] strcmp: %d strncmp(5): %d\n", ver, strcmp(ver, "1.0.5"), strncmp(ver, "1.0.5", 5));
       return 0;
   }
   edd at ron:~/src/debian/R/R-2.7.1.20080621> gcc -Wall -O2 -o /tmp/bzver  /tmp/bzver.c -lbz2
   edd at ron:~/src/debian/R/R-2.7.1.20080621> /tmp/bzver
   [1.0.5, 10-Dec-2007] strcmp: 1 strncmp(5): 0

Switching to strnmp with a limit of 5 'fixes' the issue but it probably too
fragile to be generally recommended.  

Dirk   


-- 
Three out of two people have difficulties with fractions.


From ds5j at excite.com  Sun Jun 22 19:58:44 2008
From: ds5j at excite.com (DS)
Date: Sun, 22 Jun 2008 13:58:44 -0400 (EDT)
Subject: [Rd] R truncated regularized iteratively re-weighted least squares
	(TR-IRLS)
Message-ID: <20080622175844.505048B31C@xprdmxin.myway.com>


Hi,

is there any R version of

logistic regression implementation using  truncated regularized iteratively re-weighted least squares (TR-IRLS) ?

if not can someone create it as this seems to be an important advancement of logistic regression.



thanks

D

http://autonlab.org/autonweb/10538.html


From s.blomberg1 at uq.edu.au  Mon Jun 23 08:58:17 2008
From: s.blomberg1 at uq.edu.au (Simon Blomberg)
Date: Mon, 23 Jun 2008 16:58:17 +1000
Subject: [Rd] R truncated regularized iteratively re-weighted
	least	squares (TR-IRLS)
In-Reply-To: <20080622175844.505048B31C@xprdmxin.myway.com>
References: <20080622175844.505048B31C@xprdmxin.myway.com>
Message-ID: <1214204297.28042.28.camel@sib-sblomber01d.sib.uq.edu.au>

R can already do IRLS, conjugate gradient optimisation and ridge
regression, so pulling all of them together may not be too hard. Care to
contribute any code?

Cheers,

Simon.

On Sun, 2008-06-22 at 13:58 -0400, DS wrote:
> Hi,
> 
> is there any R version of
> 
> logistic regression implementation using  truncated regularized iteratively re-weighted least squares (TR-IRLS) ?
> 
> if not can someone create it as this seems to be an important advancement of logistic regression.
> 
> 
> 
> thanks
> 
> D
> 
> http://autonlab.org/autonweb/10538.html
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
-- 
Simon Blomberg, BSc (Hons), PhD, MAppStat. 
Lecturer and Consultant Statistician 
Faculty of Biological and Chemical Sciences 
The University of Queensland 
St. Lucia Queensland 4072 
Australia
Room 320 Goddard Building (8)
T: +61 7 3365 2506
http://www.uq.edu.au/~uqsblomb
email: S.Blomberg1_at_uq.edu.au

Policies:
1.  I will NOT analyse your data for you.
2.  Your deadline is your problem.

The combination of some data and an aching desire for 
an answer does not ensure that a reasonable answer can 
be extracted from a given body of data. - John Tukey.


From tobias.verbeke at telenet.be  Mon Jun 23 16:01:53 2008
From: tobias.verbeke at telenet.be (Tobias Verbeke)
Date: Mon, 23 Jun 2008 16:01:53 +0200
Subject: [Rd] trivial typo ?title
Message-ID: <485FACD1.20600@telenet.be>

There is a trivial typo in ?title.
Please find a patch below.

Kind regards,
Tobias



Index: 
/home/tobias/Documents/workspace/Rdevel_svn/src/library/graphics/man/title.Rd
===================================================================
--- 
/home/tobias/Documents/workspace/Rdevel_svn/src/library/graphics/man/title.Rd 
(revision 45972)
+++ 
/home/tobias/Documents/workspace/Rdevel_svn/src/library/graphics/man/title.Rd 
(working copy)
@@ -41,7 +41,7 @@
    greek letters, fractions, etc: see \link{plotmath}
  }
  \details{
-  The labels passed to \code{title} can be a character strings or
+  The labels passed to \code{title} can be character strings or
    language objects (names, calls or expressions), or a list
    containing the string to be plotted, and a selection of the optional
    modifying graphical parameters \code{cex=}, \code{col=} and


From murdoch at stats.uwo.ca  Mon Jun 23 18:19:00 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 23 Jun 2008 12:19:00 -0400
Subject: [Rd] trivial typo ?title
In-Reply-To: <485FACD1.20600@telenet.be>
References: <485FACD1.20600@telenet.be>
Message-ID: <485FCCF4.9040409@stats.uwo.ca>

On 6/23/2008 10:01 AM, Tobias Verbeke wrote:
> There is a trivial typo in ?title.
> Please find a patch below.

Thanks, I'll fix it.

Duncan Murdoch

> 
> Kind regards,
> Tobias
> 
> 
> 
> Index: 
> /home/tobias/Documents/workspace/Rdevel_svn/src/library/graphics/man/title.Rd
> ===================================================================
> --- 
> /home/tobias/Documents/workspace/Rdevel_svn/src/library/graphics/man/title.Rd 
> (revision 45972)
> +++ 
> /home/tobias/Documents/workspace/Rdevel_svn/src/library/graphics/man/title.Rd 
> (working copy)
> @@ -41,7 +41,7 @@
>     greek letters, fractions, etc: see \link{plotmath}
>   }
>   \details{
> -  The labels passed to \code{title} can be a character strings or
> +  The labels passed to \code{title} can be character strings or
>     language objects (names, calls or expressions), or a list
>     containing the string to be plotted, and a selection of the optional
>     modifying graphical parameters \code{cex=}, \code{col=} and
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From edd at debian.org  Mon Jun 23 20:53:24 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 23 Jun 2008 18:53:24 +0000
Subject: [Rd] r-base build: failure to convert R-FAQ to pdf
In-Reply-To: <200806231754.05298.norsetto@ubuntu.com>
References: <200806231754.05298.norsetto@ubuntu.com>
Message-ID: <20080623185324.GA30368@master.debian.org>


Hi Cesare,

On Mon, Jun 23, 2008 at 05:54:04PM +0200, Cesare Tirabassi wrote:
> We have received an email in Ubuntu alerting us that something strange was 
> going on during the r-base 2.7.1 rc build (see [1]).
> 
> It seems that there is an error during the convertion of R-FAQ.texi to pdf.
> The following excerpt, taken from [2], shows the problem:
> 
> /bin/sh: line 0: test: too many arguments
> TEXINPUTS=".:$TEXINPUTS" /usr/bin/texi2dvi --texinfo="@set 
> UseExternalXrefs " --pdf R-FAQ.texi
> /usr/bin/texi2dvi: Running 
> pdfetex --file-line-error '/build/buildd/r-base-2.7.1~20080621/doc/manual/R-FAQ.t2d/pdf/xtr/R-FAQ.texi' ...
> This is pdfTeXk, Version 3.141592-1.40.3 (Web2C 7.5.6)
>  file:line:error style messages enabled.
>  %&-line parsing enabled.
> entering extended mode
> ! I can't find file `/build/buildd/r-base-2.7.1'.
> <to be read again> 
>                    \penalty 
> ~->\penalty 
>             \@M \ 
> <*> /build/buildd/r-base-2.7.1~
>                                
> 20080621/doc/manual/R-FAQ.t2d/pdf/xtr/R-FAQ.texi
> Please type another input file name: 
> ! Emergency stop.
> <to be read again> 
>                    \penalty 
> ~->\penalty 
>             \@M \ 
> <*> /build/buildd/r-base-2.7.1~
>                                
> 20080621/doc/manual/R-FAQ.t2d/pdf/xtr/R-FAQ.texi
> 
> !  ==> Fatal error occurred, no output PDF file produced!
> Transcript written on texput.log.
> /usr/bin/texi2dvi: pdfetex exited with bad status, quitting.
> make[2]: *** [R-FAQ.pdf] Error 1
> 
> Opinions?

Known deficiency in texinfo which pukes on the ~ in the directory
name. I have been told (by a member of R Core with whom I had been
corresponding on this) that it has been fixed upstream in texinfo, but
not yet in Debian unstable.

It is a non-issue for R as I uploaded 2.7.1 (without any ~ in the
revision as I did for the beta and rc of 2.7.1) earlier today so
proper packages are already in Debian, and will populate to Ubuntu in
due course.

And finally, if I may: this really is not an R issue at all but rather
a bug exposed by a Debian version naming convention -- so next time
just bug me and escalate to r-devel in case I don't respond.

Hth, Dirk

> 
> Cheers,
> 
> Cesare
> 
> [1]https://lists.ubuntu.com/archives/ubuntu-motu/2008-June/004125.html
> [2]http://buildd.debian.org/fetch.cgi?pkg=r-base;ver=2.7.1%7E20080621-1;arch=amd64;stamp=1214071405

-- 
Three out of two people have difficulties with fractions.


From cesare.tirabassi at gmail.com  Mon Jun 23 17:54:04 2008
From: cesare.tirabassi at gmail.com (Cesare Tirabassi)
Date: Mon, 23 Jun 2008 17:54:04 +0200
Subject: [Rd] r-base build: failure to convert R-FAQ to pdf
Message-ID: <200806231754.05298.norsetto@ubuntu.com>

We have received an email in Ubuntu alerting us that something strange was 
going on during the r-base 2.7.1 rc build (see [1]).

It seems that there is an error during the convertion of R-FAQ.texi to pdf.
The following excerpt, taken from [2], shows the problem:

/bin/sh: line 0: test: too many arguments
TEXINPUTS=".:$TEXINPUTS" /usr/bin/texi2dvi --texinfo="@set 
UseExternalXrefs " --pdf R-FAQ.texi
/usr/bin/texi2dvi: Running 
pdfetex --file-line-error '/build/buildd/r-base-2.7.1~20080621/doc/manual/R-FAQ.t2d/pdf/xtr/R-FAQ.texi' ...
This is pdfTeXk, Version 3.141592-1.40.3 (Web2C 7.5.6)
 file:line:error style messages enabled.
 %&-line parsing enabled.
entering extended mode
! I can't find file `/build/buildd/r-base-2.7.1'.
<to be read again> 
                   \penalty 
~->\penalty 
            \@M \ 
<*> /build/buildd/r-base-2.7.1~
                               
20080621/doc/manual/R-FAQ.t2d/pdf/xtr/R-FAQ.texi
Please type another input file name: 
! Emergency stop.
<to be read again> 
                   \penalty 
~->\penalty 
            \@M \ 
<*> /build/buildd/r-base-2.7.1~
                               
20080621/doc/manual/R-FAQ.t2d/pdf/xtr/R-FAQ.texi

!  ==> Fatal error occurred, no output PDF file produced!
Transcript written on texput.log.
/usr/bin/texi2dvi: pdfetex exited with bad status, quitting.
make[2]: *** [R-FAQ.pdf] Error 1

Opinions?

Cheers,

Cesare

[1]https://lists.ubuntu.com/archives/ubuntu-motu/2008-June/004125.html
[2]http://buildd.debian.org/fetch.cgi?pkg=r-base;ver=2.7.1%7E20080621-1;arch=amd64;stamp=1214071405


From plroebuck at mdanderson.org  Mon Jun 23 21:38:55 2008
From: plroebuck at mdanderson.org (Paul Roebuck)
Date: Mon, 23 Jun 2008 14:38:55 -0500 (CDT)
Subject: [Rd] doc buglet / dim method
Message-ID: <Pine.OSF.4.58.0806231435120.156189@wotan.mdacc.tmc.edu>

Under Value section for dim:

The replacemnt method changes the "dim" attribute...
    ^^^^^^^^^^

should be "replacement"


R version 2.7.1 RC (2008-06-20 r45965)

----------------------------------------------------------
SIGSIG -- signature too long (core dumped)


From supersubu123 at gmail.com  Tue Jun 24 13:21:18 2008
From: supersubu123 at gmail.com (subramanian R)
Date: Tue, 24 Jun 2008 16:51:18 +0530
Subject: [Rd] Using Huge Pages for R
Message-ID: <b2d9df730806240421j3908bbf8w5dae2b7f93aebeca@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080624/ac3b0331/attachment.pl>

From supersubu123 at gmail.com  Wed Jun 25 09:12:30 2008
From: supersubu123 at gmail.com (subramanian R)
Date: Wed, 25 Jun 2008 12:42:30 +0530
Subject: [Rd] huge data?
In-Reply-To: <d4588dec0806241052o9266e16x88e87880927baae0@mail.gmail.com>
References: <d4588dec0806241052o9266e16x88e87880927baae0@mail.gmail.com>
Message-ID: <b2d9df730806250012g67298804n7837c48a8d80f132@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080625/67897526/attachment.pl>

From Rory.WINSTON at rbs.com  Wed Jun 25 12:26:28 2008
From: Rory.WINSTON at rbs.com (WINSTON, Rory, GBM)
Date: Wed, 25 Jun 2008 11:26:28 +0100
Subject: [Rd]  Using Huge Pages for R
In-Reply-To: <mailman.25.1214388007.9851.r-devel@r-project.org>
References: <mailman.25.1214388007.9851.r-devel@r-project.org>
Message-ID: <F5AB27C222D4164382737207F9869F2B51675A9D31@LONMC01014.rbsres07.net>

Have you looked at the [ff] package?

user2007.org/program/posters/adler.pdf

Rory


***********************************************************************************
The Royal Bank of Scotland plc. Registered in Scotland No 90312. Registered Office: 36 St Andrew Square, Edinburgh EH2 2YB. 
Authorised and regulated by the Financial Services Authority

This e-mail message is confidential and for use by the 
addressee only. If the message is received by anyone other 
than the addressee, please return the message to the sender 
by replying to it and then delete the message from your 
computer. Internet e-mails are not necessarily secure. The 
Royal Bank of Scotland plc does not accept responsibility for 
changes made to this message after it was sent. 

Whilst all reasonable care has been taken to avoid the 
transmission of viruses, it is the responsibility of the recipient to 
ensure that the onward transmission, opening or use of this 
message and any attachments will not adversely affect its 
systems or data. No responsibility is accepted by The 
Royal Bank of Scotland plc in this regard and the recipient should carry 
out such virus and other checks as it considers appropriate. 
Visit our websites at: 
www.rbs.com
www.rbs.com/gbm
www.rbsgc.com
***********************************************************************************


______________________________________________________________________
This email has been scanned by the MessageLabs Email Security System.
For more information please visit http://www.messagelabs.com/email 


From gustaf.rydevik at gmail.com  Wed Jun 25 10:25:22 2008
From: gustaf.rydevik at gmail.com (gustaf.rydevik at gmail.com)
Date: Wed, 25 Jun 2008 10:25:22 +0200 (CEST)
Subject: [Rd] tiff() causes R to crash on WinXP (PR#11804)
Message-ID: <20080625082522.7F57B282EF48@mail.pubhealth.ku.dk>

Full_Name: Gustaf Rydevik
Version: 2.7.1
OS: Win XP professional
Submission from: (NULL) (130.237.97.254)


The following lines of code crash R 2.7.1 (=cause R to show "The R gui has
encountered a problem and needs to close"....). Replicated on two WinXp
professional machines, as well as by Uwe Ligges.


> sessionInfo()
R version 2.7.1 (2008-06-23) 
i386-pc-mingw32 

locale:
LC_COLLATE=Swedish_Sweden.1252;LC_CTYPE=Swedish_Sweden.1252;LC_MONETARY=Swedish_Sweden.1252;LC_NUMERIC=C;LC_TIME=Swedish_Sweden.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] boot_1.2-33    lattice_0.17-8 nlme_3.1-89    RWinEdt_1.8-0 

loaded via a namespace (and not attached):
[1] grid_2.7.1  tools_2.7.1

>tiff()
>plot(1:1000)
>dev.off()


From =?ISO-8859-15?Q?Hans-J=FCrgen_Auinger?= at pubhealth.ku.dk  Wed Jun 25 13:40:07 2008
From: =?ISO-8859-15?Q?Hans-J=FCrgen_Auinger?= at pubhealth.ku.dk (=?ISO-8859-15?Q?Hans-J=FCrgen_Auinger?= at pubhealth.ku.dk)
Date: Wed, 25 Jun 2008 13:40:07 +0200 (CEST)
Subject: [Rd] R 2.7.1 und WinEdt (PR#11806)
Message-ID: <20080625114008.0A4C52834612@mail.pubhealth.ku.dk>

Hi,

under the new version R 2.7.1 I can't use WinEdt. It seems that there is 
a bug in that version. To use older versions of the package RWinEdt 
doens't bring success. The Use of R 2.7.0 doesn't cause that Problem.

Regards,

Hans-J?rgen Auinger

-- 
----------------------------------------------
Hans-J?rgen Auinger

Lehrstuhl f?r Pflanzenz?chtung
Wissenschaftszentrum Weihenstephan
Technische Universit?t M?nchen

Plant Breeding
Center of Life and Food Sciences Weihenstephan
Technische Universit?t M?nchen

Am Hochanger 4
85350 Freising

Phone:    +49 (81 61) 71 - 51 41
Fax:      +49 (81 61) 71 - 45 11
e-mail:   hans-juergen.auinger at wzw.tum.de
Homepage: www.wzw.tum.de/plantbreeding


From murdoch at stats.uwo.ca  Wed Jun 25 14:31:21 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 25 Jun 2008 08:31:21 -0400
Subject: [Rd] R 2.7.1 und WinEdt (PR#11806)
In-Reply-To: <20080625114008.0A4C52834612@mail.pubhealth.ku.dk>
References: <20080625114008.0A4C52834612@mail.pubhealth.ku.dk>
Message-ID: <48623A99.6070407@stats.uwo.ca>

On 6/25/2008 7:40 AM, Hans-J?rgen Auinger at pubhealth.ku.dk wrote:
> Hi,
> 
> under the new version R 2.7.1 I can't use WinEdt. It seems that there is 
> a bug in that version. To use older versions of the package RWinEdt 
> doens't bring success. The Use of R 2.7.0 doesn't cause that Problem.


You should report this to the RWinEdt maintainer, not to the general R 
bug list.

For what it's worth, I just used RWinEdt without error; perhaps you need 
to upgrade.

Duncan Murdoch


From murdoch at stats.uwo.ca  Wed Jun 25 14:33:59 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 25 Jun 2008 08:33:59 -0400
Subject: [Rd] tiff() causes R to crash on WinXP (PR#11804)
In-Reply-To: <20080625082522.7F57B282EF48@mail.pubhealth.ku.dk>
References: <20080625082522.7F57B282EF48@mail.pubhealth.ku.dk>
Message-ID: <48623B37.8080003@stats.uwo.ca>

On 6/25/2008 4:25 AM, gustaf.rydevik at gmail.com wrote:
> Full_Name: Gustaf Rydevik
> Version: 2.7.1
> OS: Win XP professional
> Submission from: (NULL) (130.237.97.254)
> 
> 
> The following lines of code crash R 2.7.1 (=cause R to show "The R gui has
> encountered a problem and needs to close"....). Replicated on two WinXp
> professional machines, as well as by Uwe Ligges.

I can reproduce this error, but only when lattice is loaded.  I'll see 
if I can track it down...

Duncan Murdoch

> 
> 
>> sessionInfo()
> R version 2.7.1 (2008-06-23) 
> i386-pc-mingw32 
> 
> locale:
> LC_COLLATE=Swedish_Sweden.1252;LC_CTYPE=Swedish_Sweden.1252;LC_MONETARY=Swedish_Sweden.1252;LC_NUMERIC=C;LC_TIME=Swedish_Sweden.1252
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base     
> 
> other attached packages:
> [1] boot_1.2-33    lattice_0.17-8 nlme_3.1-89    RWinEdt_1.8-0 
> 
> loaded via a namespace (and not attached):
> [1] grid_2.7.1  tools_2.7.1
> 
>>tiff()
>>plot(1:1000)
>>dev.off()
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From jayemerson at gmail.com  Wed Jun 25 14:59:11 2008
From: jayemerson at gmail.com (Jay Emerson)
Date: Wed, 25 Jun 2008 08:59:11 -0400
Subject: [Rd] huge data?
Message-ID: <d4588dec0806250559w436f1495m1dfc549142f8dbb5@mail.gmail.com>

I'm afraid I don't have anything to add to this discussion.  I don't
know enough (or anything) about "huge pages" to be able to assess
possible performance gains, but my instinct is that they will be
negligible when compared to other costs (e.g. a copy-on-write kicking
in with a big R object).  In which case this would not be a good way
to spend your time.  I would encourage you to make sure you understand
other aspects of handling large objects with R before investing too
much time and effort in this one direction.

Jay


<<previous message copied below>>

Hi Jay Emerson,
     Our Intention is to primarily optimize "R" to utilize the Parallel
Processing Capabilities of CELL BE Processor.(has any work been done in this
area?)

We have huge pages(of size 1MB 16MB ) available in the system and as you
pointed out our data is also in the GB ranges.So the idea is if Vectors of
this huge size are allocated from Huge Pages the performance will naturally
increase.How to implement it?
So How can we proceed in this case?

Also the Upper Limit of Class 6 is specified as 128 bytes(Node Classes)
Will there be any side effect in increasing this to 512 bytes or so
(depending on the average of the Application data)




Advance Thanks & Regards
R.Subramanian

-- 
John W. Emerson (Jay)
Assistant Professor of Statistics
Department of Statistics
Yale University
http://www.stat.yale.edu/~jay


From murdoch at stats.uwo.ca  Wed Jun 25 15:33:13 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 25 Jun 2008 09:33:13 -0400
Subject: [Rd] tiff() causes R to crash on WinXP (PR#11804)
In-Reply-To: <48623B37.8080003@stats.uwo.ca>
References: <20080625082522.7F57B282EF48@mail.pubhealth.ku.dk>
	<48623B37.8080003@stats.uwo.ca>
Message-ID: <48624919.3050106@stats.uwo.ca>

On 6/25/2008 8:33 AM, Duncan Murdoch wrote:
> On 6/25/2008 4:25 AM, gustaf.rydevik at gmail.com wrote:
>> Full_Name: Gustaf Rydevik
>> Version: 2.7.1
>> OS: Win XP professional
>> Submission from: (NULL) (130.237.97.254)
>> 
>> 
>> The following lines of code crash R 2.7.1 (=cause R to show "The R gui has
>> encountered a problem and needs to close"....). Replicated on two WinXp
>> professional machines, as well as by Uwe Ligges.
> 
> I can reproduce this error, but only when lattice is loaded.  I'll see 
> if I can track it down...

lattice was just coincidental, the problem was in the Windows device 
code.  Should be fixed soon.

Duncan Murdoch


From ligges at statistik.tu-dortmund.de  Wed Jun 25 16:45:15 2008
From: ligges at statistik.tu-dortmund.de (ligges at statistik.tu-dortmund.de)
Date: Wed, 25 Jun 2008 16:45:15 +0200 (CEST)
Subject: [Rd] R 2.7.1 und WinEdt (PR#11806)
Message-ID: <20080625144515.A52192834337@mail.pubhealth.ku.dk>



Duncan Murdoch wrote:
> On 6/25/2008 7:40 AM, Hans-J?rgen Auinger at pubhealth.ku.dk wrote:
>> Hi,
>>
>> under the new version R 2.7.1 I can't use WinEdt. It seems that there 
>> is a bug in that version. To use older versions of the package RWinEdt 
>> doens't bring success. The Use of R 2.7.0 doesn't cause that Problem.
> 
> 
> You should report this to the RWinEdt maintainer, not to the general R 
> bug list.
> 
> For what it's worth, I just used RWinEdt without error; perhaps you need 
> to upgrade.

Works for me as well....

So, it would be helpful to tell me what went wrong (and no need to CC to 
the bug repository and more).

Best wishes,
Uwe


> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From gavin.simpson at ucl.ac.uk  Wed Jun 25 20:05:41 2008
From: gavin.simpson at ucl.ac.uk (Gavin Simpson)
Date: Wed, 25 Jun 2008 19:05:41 +0100
Subject: [Rd] Patch for minor typo in legend.Rd
Message-ID: <1214417141.26479.56.camel@prometheus.geog.ucl.ac.uk>

There is a typo in a comment in the example section of legend.Rd, line
224. The comment refers the reader to 'example(plotfactor)'. It should
read 'example(plot.factor)'

The attached patch (against R 2.8.0 to be r45988) makes this change to
legend.Rd.

All the best,

G
-- 
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
 Dr. Gavin Simpson             [t] +44 (0)20 7679 0522
 ECRC, UCL Geography,          [f] +44 (0)20 7679 0565
 Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk
 Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/
 UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
-------------- next part --------------
A non-text attachment was scrubbed...
Name: legend.patch
Type: text/x-patch
Size: 627 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080625/af4db348/attachment.bin>

From terra at gnome.org  Thu Jun 26 03:55:07 2008
From: terra at gnome.org (terra at gnome.org)
Date: Thu, 26 Jun 2008 03:55:07 +0200 (CEST)
Subject: [Rd] phyper hang (PR#11813)
Message-ID: <20080626015507.64BBE2834158@mail.pubhealth.ku.dk>

Full_Name: Morten Welinder
Version: 
OS: Linux
Submission from: (NULL) (69.113.253.99)


It appears that phyper hangs for insanely large x, such as the call

    phyper(1e67,0,0,0)

Adding something like this after the tail swap seems to cure that.

    if (x >= NR)
	return R_DT_1;


From stvjc at channing.harvard.edu  Thu Jun 26 13:53:46 2008
From: stvjc at channing.harvard.edu (Vincent Carey 525-2265)
Date: Thu, 26 Jun 2008 07:53:46 -0400 (EDT)
Subject: [Rd] version stamp details missing on current checkout
Message-ID: <Pine.GSO.4.58.0806260751120.28185@capecod.bwh.harvard.edu>

this is from a fresh svn checkout:

[stvjc at stvjc1 R-devel]$ ls -tl Makefile
-rw-rw-r--  1 stvjc stvjc 12833 Jun 26 07:24 Makefile
[stvjc at stvjc1 R-devel]$ svn up
At revision 45988.
[stvjc at stvjc1 R-devel]$ bin/R

R version 2.8.0 Under development (unstable) (--)
Copyright (C)  The R Foundation for Statistical Computing
ISBN 3-900051-07-0

..

> sessionInfo()
R version 2.8.0 Under development (unstable) (--)
x86_64-unknown-linux-gnu

locale:
LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base



---
Vince Carey, PhD
Assoc. Prof Med (Biostatistics)
Harvard Medical School
Channing Laboratory - ph 6175252265 fa 6177311541
181 Longwood Ave Boston MA 02115 USA
stvjc at channing.harvard.edu

The information transmitted in this electronic communica...{{dropped:10}}


From p.dalgaard at biostat.ku.dk  Thu Jun 26 15:03:31 2008
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 26 Jun 2008 15:03:31 +0200
Subject: [Rd] version stamp details missing on current checkout
In-Reply-To: <Pine.GSO.4.58.0806260751120.28185@capecod.bwh.harvard.edu>
References: <Pine.GSO.4.58.0806260751120.28185@capecod.bwh.harvard.edu>
Message-ID: <486393A3.4020900@biostat.ku.dk>

Vincent Carey 525-2265 wrote:

Works for me... what's in your SVN-REVISION file? Notice that there is 
some slightly weird logic to distinguish whether you are building from 
SVN or from tarballs, based on the existence of $(srcdir)/doc/FAQ and 
$(builddir)/non-tarball. If you have the former and not the latter, it 
is assumed that there will be a ready-made SVN-REVISION.

There's a bug in the Makefile, though:

svnonly:
    @if test ! -f "$(srcdir)/doc/FAQ" || test -f non-tarball ; then \
      (cd doc/manual && $(MAKE) front-matter html-non-svn) ; \
      touch non-tarball ; \
      (cd $(srcdir); LC_ALL=C TZ=GMT svn -rHEAD info || $(ECHO) 
"Revision: unknown") 2> /dev/null \
        | sed -n -e '/^Revision/p' -e '/^Last Changed Date/'p \
        | cut -d' ' -f1,2,3,4 > SVN-REVISION-tmp ; \
...etc...

I don't think we want the -rHEAD there since it can cause the version 
stamp to become different from the version of the source files in case 
of an intervening commit.

> this is from a fresh svn checkout:
>
> [stvjc at stvjc1 R-devel]$ ls -tl Makefile
> -rw-rw-r--  1 stvjc stvjc 12833 Jun 26 07:24 Makefile
> [stvjc at stvjc1 R-devel]$ svn up
> At revision 45988.
> [stvjc at stvjc1 R-devel]$ bin/R
>
> R version 2.8.0 Under development (unstable) (--)
> Copyright (C)  The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
>
> ..
>
>   
>> sessionInfo()
>>     
> R version 2.8.0 Under development (unstable) (--)
> x86_64-unknown-linux-gnu
>
> locale:
> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
>
>
> ---
> Vince Carey, PhD
> Assoc. Prof Med (Biostatistics)
> Harvard Medical School
> Channing Laboratory - ph 6175252265 fa 6177311541
> 181 Longwood Ave Boston MA 02115 USA
> stvjc at channing.harvard.edu
>
> The information transmitted in this electronic communica...{{dropped:10}}
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>   


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From maechler at stat.math.ethz.ch  Thu Jun 26 15:29:21 2008
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Thu, 26 Jun 2008 15:29:21 +0200
Subject: [Rd] version stamp details missing on current checkout
In-Reply-To: <486393A3.4020900@biostat.ku.dk>
References: <Pine.GSO.4.58.0806260751120.28185@capecod.bwh.harvard.edu>
	<486393A3.4020900@biostat.ku.dk>
Message-ID: <18531.39345.741660.90096@stat.math.ethz.ch>

>>>>> "PD" == Peter Dalgaard <p.dalgaard at biostat.ku.dk>
>>>>>     on Thu, 26 Jun 2008 15:03:31 +0200 writes:

    PD> Vincent Carey 525-2265 wrote:
    PD> Works for me... what's in your SVN-REVISION file? Notice that there is 
    PD> some slightly weird logic to distinguish whether you are building from 
    PD> SVN or from tarballs, based on the existence of $(srcdir)/doc/FAQ and 
    PD> $(builddir)/non-tarball. If you have the former and not the latter, it 
    PD> is assumed that there will be a ready-made SVN-REVISION.

    PD> There's a bug in the Makefile, though:

    PD> svnonly:
    PD> @if test ! -f "$(srcdir)/doc/FAQ" || test -f non-tarball ; then \
    PD> (cd doc/manual && $(MAKE) front-matter html-non-svn) ; \
    PD> touch non-tarball ; \
    PD> (cd $(srcdir); LC_ALL=C TZ=GMT svn -rHEAD info || $(ECHO) 
    PD> "Revision: unknown") 2> /dev/null \
    PD> | sed -n -e '/^Revision/p' -e '/^Last Changed Date/'p \
    PD> | cut -d' ' -f1,2,3,4 > SVN-REVISION-tmp ; \
    PD> ...etc...

    PD> I don't think we want the -rHEAD there since it can cause the version 
    PD> stamp to become different from the version of the source files in case 
    PD> of an intervening commit.

Hmm, I have added the  -rHEAD   there  about a week ago, 
since there is a bug if it's not there:

SVN-REVISION easily won't be updated correctly, and if you don't
use HEAD : The implicit default seems to be  '-rBASE'
and that can lag behind quite a bit.

It had bitten me so many times that I wanted to see something better.

Martin


    >> this is from a fresh svn checkout:
    >> 
    >> [stvjc at stvjc1 R-devel]$ ls -tl Makefile
    >> -rw-rw-r--  1 stvjc stvjc 12833 Jun 26 07:24 Makefile
    >> [stvjc at stvjc1 R-devel]$ svn up
    >> At revision 45988.
    >> [stvjc at stvjc1 R-devel]$ bin/R
    >> 
    >> R version 2.8.0 Under development (unstable) (--)
    >> Copyright (C)  The R Foundation for Statistical Computing
    >> ISBN 3-900051-07-0
    >> 
    >> ..
    >> 
    >> 
    >>> sessionInfo()
    >>> 
    >> R version 2.8.0 Under development (unstable) (--)
    >> x86_64-unknown-linux-gnu
    >> 
    >> locale:
    >> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
    >> 
    >> attached base packages:
    >> [1] stats     graphics  grDevices utils     datasets  methods   base
    >> 
    >> 
    >> 
    >> ---
    >> Vince Carey, PhD
    >> Assoc. Prof Med (Biostatistics)
    >> Harvard Medical School
    >> Channing Laboratory - ph 6175252265 fa 6177311541
    >> 181 Longwood Ave Boston MA 02115 USA
    >> stvjc at channing.harvard.edu
    >> 
    >> The information transmitted in this electronic communica...{{dropped:10}}
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >> 


    PD> -- 
    PD> O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
    PD> c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
    PD> (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
    PD> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907

    PD> ______________________________________________
    PD> R-devel at r-project.org mailing list
    PD> https://stat.ethz.ch/mailman/listinfo/r-devel


From stvjc at channing.harvard.edu  Thu Jun 26 17:18:23 2008
From: stvjc at channing.harvard.edu (Vincent Carey 525-2265)
Date: Thu, 26 Jun 2008 11:18:23 -0400 (EDT)
Subject: [Rd] version stamp details missing on current checkout
In-Reply-To: <486393A3.4020900@biostat.ku.dk>
References: <Pine.GSO.4.58.0806260751120.28185@capecod.bwh.harvard.edu>
	<486393A3.4020900@biostat.ku.dk>
Message-ID: <Pine.GSO.4.58.0806261115300.17813@capecod.bwh.harvard.edu>


On Thu, 26 Jun 2008, Peter Dalgaard wrote:

> Vincent Carey 525-2265 wrote:
>
> Works for me... what's in your SVN-REVISION file? Notice that there is

[stvjc at stvjc1 R-devel]$ svn up
At revision 45991.
[stvjc at stvjc1 R-devel]$ cat SVN-REV*
Revision: unknown

[stvjc at stvjc1 R-devel]$ ls -tl non-tarball
-rw-rw-r--  1 stvjc stvjc 0 Jun 26 11:07 non-tarball
[stvjc at stvjc1 R-devel]$ ls -tl doc/FAQ
-rw-rw-r--  1 stvjc stvjc 271978 Jun 26 07:24 doc/FAQ

the sessionInfo() gives the same data as before.

> some slightly weird logic to distinguish whether you are building from
> SVN or from tarballs, based on the existence of $(srcdir)/doc/FAQ and
> $(builddir)/non-tarball. If you have the former and not the latter, it
> is assumed that there will be a ready-made SVN-REVISION.
>
> There's a bug in the Makefile, though:
>
> svnonly:
>     @if test ! -f "$(srcdir)/doc/FAQ" || test -f non-tarball ; then \
>       (cd doc/manual && $(MAKE) front-matter html-non-svn) ; \
>       touch non-tarball ; \
>       (cd $(srcdir); LC_ALL=C TZ=GMT svn -rHEAD info || $(ECHO)
> "Revision: unknown") 2> /dev/null \
>         | sed -n -e '/^Revision/p' -e '/^Last Changed Date/'p \
>         | cut -d' ' -f1,2,3,4 > SVN-REVISION-tmp ; \
> ...etc...
>
> I don't think we want the -rHEAD there since it can cause the version
> stamp to become different from the version of the source files in case
> of an intervening commit.
>
> > this is from a fresh svn checkout:
> >
> > [stvjc at stvjc1 R-devel]$ ls -tl Makefile
> > -rw-rw-r--  1 stvjc stvjc 12833 Jun 26 07:24 Makefile
> > [stvjc at stvjc1 R-devel]$ svn up
> > At revision 45988.
> > [stvjc at stvjc1 R-devel]$ bin/R
> >
> > R version 2.8.0 Under development (unstable) (--)
> > Copyright (C)  The R Foundation for Statistical Computing
> > ISBN 3-900051-07-0
> >
> > ..
> >
> >
> >> sessionInfo()
> >>
> > R version 2.8.0 Under development (unstable) (--)
> > x86_64-unknown-linux-gnu
> >
> > locale:
> > LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
> >
> > attached base packages:
> > [1] stats     graphics  grDevices utils     datasets  methods   base
> >
> >
> >
> > ---
> > Vince Carey, PhD
> > Assoc. Prof Med (Biostatistics)
> > Harvard Medical School
> > Channing Laboratory - ph 6175252265 fa 6177311541
> > 181 Longwood Ave Boston MA 02115 USA
> > stvjc at channing.harvard.edu
> >
> > The information transmitted in this electronic communica...{{dropped:10}}
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
>
>
> --
>    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
>  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907
>
>
-------------- next part --------------

The information transmitted in this electronic communica...{{dropped:18}}


From David.Bateman at motorola.com  Thu Jun 26 17:18:07 2008
From: David.Bateman at motorola.com (David Bateman)
Date: Thu, 26 Jun 2008 17:18:07 +0200
Subject: [Rd] Issue with NA value and Octave compatibility
In-Reply-To: <484C2401.6010708@gmail.com>
References: <484C2401.6010708@gmail.com>
Message-ID: <4863B32F.5020600@motorola.com>

ping

David Bateman wrote:
> Dear R developers,
>
> I'm an Octave developer in the process of implementing a single
> precision type in Octave and I have an issue with the NA value. The
> choice of NA value in Octave was made a few years back so that the high
> word of the NA value was 0x7ff00000 and the low word was 0x000007A2 for
> compatibility with R and to ease any possible issue with the exchange of
> data files between Octave and R.
>
> However, now that I'm in the process of implementing the single
> precision type I have a problem with this choice for the NA value as the
> above when cast to a float results in the loss of the 0x7A2 value
> creating a positive Infinity in IEE754, and so conversion of the NA
> values between double and float with the above value does not work.
>
> I have several possible choices of how to treat this, but as the reason
> for the choice of Octave's NA value was made for compatibility with R,
> the choice I'll make might very well be determined by how the R
> developers react to any changes that Octave makes in this direction.
>
> I can't realistically wrap the double and float types in Octave and
> overload the assignment operators to handle the assignment of a float to
> a double and visa versa as this would completely replace the underlying
> data types in Octave. Its also impossible to trap everywhere where a
> double might be assigned to a float and special case NA values as there
> are just too many places that might occur.
>
> I'm therefore assuming that I have to replace Octave's internal
> representation of the NA value to allow easy conversion of the NA value
> between double and floats. This can be done by replacing the NA value
> with one that has zeros in the lower 19 bits of the mantissa of the
> double, so that the cast from a double to float and visa versa works
> correctly. For example using 0x7FF840F4 and 0x40000000 for the low and
> high word of the double NA value. and 0x7FC207A2 for the float NA value
> works. However then I have an issue of exchange of NA values with R and
> with older versions of Octave.
>
> Its easy enough to check for old NA values in files when reading and
> alter them to the new NA values. So forward compatibility with older
> versions of Octave and from R to Octave would be ok. However, the
> reverse is not true. Actually saving the with the old NA value is
> equally possible and would allow full compatible with older versions of
> Octave and with R. The downside is that there are many places I'd have
> to make a copy of the data when saving to allow this (for example saving
> to HDF files), and so I'd prefer not to have to do this if possible.
>
> As backwards compatibility is the smaller concern and self correcting
> with time, if R was to also accept the an additional possible NA value
> such as 0x7FF840F4/0x40000000, at least when loading files then
> compatibility of the NA value between Octave and R could be maintained
> and I wouldn't have to pay the penalty of making a copy of the data to
> treat the NA values. Would the R developers be willing to make such a
> change in R? If not I will maintain the R compatible NA value in
> Octave's output and pay the performance penalty within Octave for this.
>
> In any case if R intends at some point to support a single precision
> type you will come across the same issue.
>
> Regards
> David
>
>   


-- 
David Bateman                                David.Bateman at motorola.com
Motorola Labs - Paris                        +33 1 69 35 48 04 (Ph) 
Parc Les Algorithmes, Commune de St Aubin    +33 6 72 01 06 33 (Mob) 
91193 Gif-Sur-Yvette FRANCE                  +33 1 69 35 77 01 (Fax) 

The information contained in this communication has been classified as: 

[x] General Business Information 
[ ] Motorola Internal Use Only 
[ ] Motorola Confidential Proprietary


From nadeemshafique at gmail.com  Fri Jun 27 06:03:32 2008
From: nadeemshafique at gmail.com (Nadeem Shafique)
Date: Fri, 27 Jun 2008 05:03:32 +0100
Subject: [Rd] Problem in conditional looping
Message-ID: <1e1cef7f0806262103j1f3c9b5ar64d666f68109d383@mail.gmail.com>

Respected All,

I am writing a program in R and facing some problem with applying "if statment".

Program first draw random numbers from bivariate normal distribution
        then compute variable say Pi and Pij from that sample and
then further computation
.....
.....
.....
In some samples Pij is appearing with negitive sign and ultimately
resulted in an negative variance estimator.  Now i want to design the
program like this if the Pij is negative then go back and draw another
sample until we get a sample that produces positive Pij and then move
forward for further processing.

Best Regards,

Nadeem Shafique Butt


From mathieu.ribatet at epfl.ch  Fri Jun 27 12:53:55 2008
From: mathieu.ribatet at epfl.ch (Mathieu Ribatet)
Date: Fri, 27 Jun 2008 12:53:55 +0200
Subject: [Rd] Problem in conditional looping
In-Reply-To: <1e1cef7f0806262103j1f3c9b5ar64d666f68109d383@mail.gmail.com>
References: <1e1cef7f0806262103j1f3c9b5ar64d666f68109d383@mail.gmail.com>
Message-ID: <4864C6C3.4090109@epfl.ch>

Why don't you consider a "while" loop e.g.

while (Pij < 0)
 ##Then you resample according to your code

Nadeem Shafique a ?crit :
> Respected All,
>
> I am writing a program in R and facing some problem with applying "if statment".
>
> Program first draw random numbers from bivariate normal distribution
>         then compute variable say Pi and Pij from that sample and
> then further computation
> .....
> .....
> .....
> In some samples Pij is appearing with negitive sign and ultimately
> resulted in an negative variance estimator.  Now i want to design the
> program like this if the Pij is negative then go back and draw another
> sample until we get a sample that produces positive Pij and then move
> forward for further processing.
>
> Best Regards,
>
> Nadeem Shafique Butt
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>   

-- 
Institute of Mathematics
Ecole Polytechnique F?d?rale de Lausanne
STAT-IMA-FSB-EPFL, Station 8
CH-1015 Lausanne   Switzerland
http://stat.epfl.ch/
Tel: + 41 (0)21 693 7907


From radiosity at gmail.com  Fri Jun 27 13:38:23 2008
From: radiosity at gmail.com (Richard Martin)
Date: Fri, 27 Jun 2008 12:38:23 +0100
Subject: [Rd] plot(type="l") disjoint between 100 and 101st datapoint
In-Reply-To: <eea558470806270329s40e512f1vba68a4ac3938231e@mail.gmail.com>
References: <eea558470806270329s40e512f1vba68a4ac3938231e@mail.gmail.com>
Message-ID: <eea558470806270438h4c9e7242v274d84c4b872c36a@mail.gmail.com>

Dear All:

We have been experiencing networking issues so I don't know if this
got through; I can't see it in the archive.  My sincere apologies if
this appears twice.

I may have found an unusual bug and am posting here to see if anyone
can reproduce it on their system. First of all, sessionInfo():

> sessionInfo()
R version 2.7.1 (2008-06-23)
i386-apple-darwin8.10.1

locale:
en_GB.UTF-8/en_GB.UTF-8/C/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

The bug is in the plot() command; it does not draw the line between
the 100th and 101st point in a dataset when plotting in line mode
(type="l").

plot(1:102, type="l") reproduces the problem consistently on my
machine, on both png and quartz devices. The result of saving this to
the png device by the code below can be seen at
http://imagebin.ca/view/txKBk2M.html

> png(filename="disjoint.png")
> plot(1:102, type="l")
> dev.off()
quartz
    2

I had a look through the archives but couldn't see any discussion of
this; apologies if I missed it. Is this purely a mac issue?
Unfortunately I don't have any other machines to test it on.

Kind regards,

Richard Martin




--
Contendere, Explorare, Invenire, et non Cedere



-- 
Contendere, Explorare, Invenire, et non Cedere


From osklyar at maninvestments.com  Fri Jun 27 16:15:43 2008
From: osklyar at maninvestments.com (Sklyar, Oleg (MI London))
Date: Fri, 27 Jun 2008 15:15:43 +0100
Subject: [Rd] plot(type="l") disjoint between 100 and 101st datapoint
In-Reply-To: <eea558470806270438h4c9e7242v274d84c4b872c36a@mail.gmail.com>
References: <eea558470806270329s40e512f1vba68a4ac3938231e@mail.gmail.com> 
	<eea558470806270438h4c9e7242v274d84c4b872c36a@mail.gmail.com>
Message-ID: <1A68FCB28DE72F4BA3B967E6506CCE430304956D@mildnpexmb01.maninvestments.ad.man.com>

I do not see any disjoint on 2.7.0 patched (r45879) or 2.8.0 devel
(r45830) on RHEL5 64bit.

Dr Oleg Sklyar
Technology Group
Man Investments Ltd
+44 (0)20 7144 3803
osklyar at maninvestments.com 

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Richard Martin
> Sent: 27 June 2008 12:38
> To: r-devel at r-project.org
> Subject: [Rd] plot(type="l") disjoint between 100 and 101st datapoint
> 
> Dear All:
> 
> We have been experiencing networking issues so I don't know 
> if this got through; I can't see it in the archive.  My 
> sincere apologies if this appears twice.
> 
> I may have found an unusual bug and am posting here to see if 
> anyone can reproduce it on their system. First of all, sessionInfo():
> 
> > sessionInfo()
> R version 2.7.1 (2008-06-23)
> i386-apple-darwin8.10.1
> 
> locale:
> en_GB.UTF-8/en_GB.UTF-8/C/C/en_GB.UTF-8/en_GB.UTF-8
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> The bug is in the plot() command; it does not draw the line 
> between the 100th and 101st point in a dataset when plotting 
> in line mode (type="l").
> 
> plot(1:102, type="l") reproduces the problem consistently on 
> my machine, on both png and quartz devices. The result of 
> saving this to the png device by the code below can be seen 
> at http://imagebin.ca/view/txKBk2M.html
> 
> > png(filename="disjoint.png")
> > plot(1:102, type="l")
> > dev.off()
> quartz
>     2
> 
> I had a look through the archives but couldn't see any 
> discussion of this; apologies if I missed it. Is this purely 
> a mac issue?
> Unfortunately I don't have any other machines to test it on.
> 
> Kind regards,
> 
> Richard Martin
> 
> 
> 
> 
> --
> Contendere, Explorare, Invenire, et non Cedere
> 
> 
> 
> --
> Contendere, Explorare, Invenire, et non Cedere
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


**********************************************************************
The contents of this email are for the named addressee(s...{{dropped:22}}


From osklyar at maninvestments.com  Fri Jun 27 16:33:45 2008
From: osklyar at maninvestments.com (Sklyar, Oleg (MI London))
Date: Fri, 27 Jun 2008 15:33:45 +0100
Subject: [Rd] plot(type="l") disjoint between 100 and 101st datapoint
In-Reply-To: <eea558470806270732w58bb03d1j7be34f58aeb447a6@mail.gmail.com>
References: <eea558470806270329s40e512f1vba68a4ac3938231e@mail.gmail.com>
	<eea558470806270438h4c9e7242v274d84c4b872c36a@mail.gmail.com>
	<1A68FCB28DE72F4BA3B967E6506CCE430304956D@mildnpexmb01.maninvestments.ad.man.com>
	<eea558470806270732w58bb03d1j7be34f58aeb447a6@mail.gmail.com>
Message-ID: <1A68FCB28DE72F4BA3B967E6506CCE430304956E@mildnpexmb01.maninvestments.ad.man.com>

No, it does not happen here and I tested other ranges as well.

Dr Oleg Sklyar
Technology Group
Man Investments Ltd
+44 (0)20 7144 3803
osklyar at maninvestments.com 

> -----Original Message-----
> From: Richard Martin [mailto:radiosity at gmail.com] 
> Sent: 27 June 2008 15:32
> To: Sklyar, Oleg (MI London)
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] plot(type="l") disjoint between 100 and 
> 101st datapoint
> 
> Hi Dr Sklyar,
> 
> This is interesting to know - I have just noticed that it 
> also happens every 100 points, there is another disjoint 
> between 200 and 201. I have attached a file showing this.
> 
> The file was created using the following code:
> 
> > png("disjoint2.png")
> > plot(1:210, type="l")
> > dev.off()
> 
> Regards,
> 
> Richard
> 
> 
> 
> 2008/6/27 Sklyar, Oleg (MI London) <osklyar at maninvestments.com>:
> > I do not see any disjoint on 2.7.0 patched (r45879) or 2.8.0 devel
> > (r45830) on RHEL5 64bit.
> >
> > Dr Oleg Sklyar
> > Technology Group
> > Man Investments Ltd
> > +44 (0)20 7144 3803
> > osklyar at maninvestments.com
> >
> >> -----Original Message-----
> >> From: r-devel-bounces at r-project.org
> >> [mailto:r-devel-bounces at r-project.org] On Behalf Of Richard Martin
> >> Sent: 27 June 2008 12:38
> >> To: r-devel at r-project.org
> >> Subject: [Rd] plot(type="l") disjoint between 100 and 
> 101st datapoint
> >>
> >> Dear All:
> >>
> >> We have been experiencing networking issues so I don't 
> know if this 
> >> got through; I can't see it in the archive.  My sincere 
> apologies if 
> >> this appears twice.
> >>
> >> I may have found an unusual bug and am posting here to see 
> if anyone 
> >> can reproduce it on their system. First of all, sessionInfo():
> >>
> >> > sessionInfo()
> >> R version 2.7.1 (2008-06-23)
> >> i386-apple-darwin8.10.1
> >>
> >> locale:
> >> en_GB.UTF-8/en_GB.UTF-8/C/C/en_GB.UTF-8/en_GB.UTF-8
> >>
> >> attached base packages:
> >> [1] stats     graphics  grDevices utils     datasets  
> methods   base
> >>
> >> The bug is in the plot() command; it does not draw the 
> line between 
> >> the 100th and 101st point in a dataset when plotting in line mode 
> >> (type="l").
> >>
> >> plot(1:102, type="l") reproduces the problem consistently on my 
> >> machine, on both png and quartz devices. The result of 
> saving this to 
> >> the png device by the code below can be seen at 
> >> http://imagebin.ca/view/txKBk2M.html
> >>
> >> > png(filename="disjoint.png")
> >> > plot(1:102, type="l")
> >> > dev.off()
> >> quartz
> >>     2
> >>
> >> I had a look through the archives but couldn't see any 
> discussion of 
> >> this; apologies if I missed it. Is this purely a mac issue?
> >> Unfortunately I don't have any other machines to test it on.
> >>
> >> Kind regards,
> >>
> >> Richard Martin
> >>
> >>
> >>
> >>
> >> --
> >> Contendere, Explorare, Invenire, et non Cedere
> >>
> >>
> >>
> >> --
> >> Contendere, Explorare, Invenire, et non Cedere
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>
> >
> >
> > 
> **********************************************************************
> > The contents of this email are for the named addressee(s) only.
> > It contains information which may be confidential and privileged.
> > If you are not the intended recipient, please notify the sender 
> > immediately, destroy this email and any attachments and do not 
> > otherwise disclose or use them. Email transmission is not a secure 
> > method of communication and Man Investments cannot accept 
> > responsibility for the completeness or accuracy of this 
> email or any 
> > attachments. Whilst Man Investments makes every effort to keep its 
> > network free from viruses, it does not accept 
> responsibility for any 
> > computer virus which might be transferred by way of this 
> email or any 
> > attachments. This email does not constitute a request, offer, 
> > recommendation or solicitation of any kind to buy, 
> subscribe, sell or 
> > redeem any investment instruments or to perform other such 
> > transactions of any kind. Man Investments reserves the right to 
> > monitor, record and retain all electronic communications 
> through its 
> > network to ensure the integrity of its systems, for record 
> keeping and 
> > regulatory purposes.
> >
> > Visit us at: www.maninvestments.com
> >
> > 
> **********************************************************************
> >
> >
> 
> 
> 
> --
> Contendere, Explorare, Invenire, et non Cedere
> 


From maechler at stat.math.ethz.ch  Fri Jun 27 16:45:18 2008
From: maechler at stat.math.ethz.ch (maechler at stat.math.ethz.ch)
Date: Fri, 27 Jun 2008 16:45:18 +0200 (CEST)
Subject: [Rd] phyper hang (PR#11813)
Message-ID: <20080627144518.BD20B2834337@mail.pubhealth.ku.dk>

>>>>> "MW" == Morten Welinder <terra at gnome.org>
>>>>>     on Thu, 26 Jun 2008 03:55:07 +0200 (CEST) writes:

    MW> Full_Name: Morten Welinder
    MW> Version: 
    MW> OS: Linux
    MW> Submission from: (NULL) (69.113.253.99)


    MW> It appears that phyper hangs for insanely large x, such as the call

    MW> phyper(1e67,0,0,0)

Yes.  I think it only happens for  (x, 0,0,0)  though.

    MW> Adding something like this after the tail swap seems to cure that.

    MW> if (x >= NR)
    MW>    return R_DT_1;

yes, and that also cures  phyper(1,0,0,0)  which gave NaN
instead of 1.
Is going to be fixed for R-devel and R-patched.

Thank you, Matt!

Martin Maechler, ETH Zurich


From ripley at stats.ox.ac.uk  Fri Jun 27 17:53:13 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 27 Jun 2008 16:53:13 +0100 (BST)
Subject: [Rd] plot(type="l") disjoint between 100 and 101st datapoint
In-Reply-To: <eea558470806270438h4c9e7242v274d84c4b872c36a@mail.gmail.com>
References: <eea558470806270329s40e512f1vba68a4ac3938231e@mail.gmail.com>
	<eea558470806270438h4c9e7242v274d84c4b872c36a@mail.gmail.com>
Message-ID: <alpine.LFD.1.10.0806271649570.23779@gannet.stats.ox.ac.uk>

Please, this is specific to your device (since png() on MacOS defaults to 
quartz).  So discuss it on R-sig-mac.

Try a different device (you do have several of those on your system!) 
including a different version of png().

I think it is related to the fix for excessively slow plotting in 2.7.0, 
but I'm not near my Mac.

On Fri, 27 Jun 2008, Richard Martin wrote:

> Dear All:
>
> We have been experiencing networking issues so I don't know if this
> got through; I can't see it in the archive.  My sincere apologies if
> this appears twice.
>
> I may have found an unusual bug and am posting here to see if anyone
> can reproduce it on their system. First of all, sessionInfo():
>
>> sessionInfo()
> R version 2.7.1 (2008-06-23)
> i386-apple-darwin8.10.1
>
> locale:
> en_GB.UTF-8/en_GB.UTF-8/C/C/en_GB.UTF-8/en_GB.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> The bug is in the plot() command; it does not draw the line between
> the 100th and 101st point in a dataset when plotting in line mode
> (type="l").
>
> plot(1:102, type="l") reproduces the problem consistently on my
> machine, on both png and quartz devices. The result of saving this to
> the png device by the code below can be seen at
> http://imagebin.ca/view/txKBk2M.html
>
>> png(filename="disjoint.png")
>> plot(1:102, type="l")
>> dev.off()
> quartz
>    2
>
> I had a look through the archives but couldn't see any discussion of
> this; apologies if I missed it. Is this purely a mac issue?
> Unfortunately I don't have any other machines to test it on.
>
> Kind regards,
>
> Richard Martin
>
>
>
>
> --
> Contendere, Explorare, Invenire, et non Cedere
>
>
>
> -- 
> Contendere, Explorare, Invenire, et non Cedere
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From rene.locher at zhaw.ch  Fri Jun 27 16:30:04 2008
From: rene.locher at zhaw.ch (rene.locher at zhaw.ch)
Date: Fri, 27 Jun 2008 16:30:04 +0200 (CEST)
Subject: [Rd] unexpected lining up of labels in axis(4,hadj=1) (PR#11836)
Message-ID: <20080627143004.57FD3283460D@mail.pubhealth.ku.dk>

Full_Name: Rene Locher
Version:  2.7.1
OS: i386-pc-mingw32
Submission from: (NULL) (160.85.231.140)


Here is the example:

par(las=1,mar=rep(4,4))
plot(c(-1000,1000),axes=FALSE)
box()
axis(4,hadj=1)
## axis labels are positioned in an awkward way

## I would expect to see label positions like here:
axis(4,hadj=1,mgp=c(3,3,0))

These are my sessionInfos:
R version 2.7.1 (2008-06-23) 
i386-pc-mingw32 

locale:
LC_COLLATE=German_Switzerland.1252;LC_CTYPE=German_Switzerland.1252;LC_MONETARY=German_Switzerland.1252;LC_NUMERIC=C;LC_TIME=German_Switzerland.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base


From radiosity at gmail.com  Fri Jun 27 16:32:09 2008
From: radiosity at gmail.com (Richard Martin)
Date: Fri, 27 Jun 2008 15:32:09 +0100
Subject: [Rd] plot(type="l") disjoint between 100 and 101st datapoint
In-Reply-To: <1A68FCB28DE72F4BA3B967E6506CCE430304956D@mildnpexmb01.maninvestments.ad.man.com>
References: <eea558470806270329s40e512f1vba68a4ac3938231e@mail.gmail.com>
	<eea558470806270438h4c9e7242v274d84c4b872c36a@mail.gmail.com>
	<1A68FCB28DE72F4BA3B967E6506CCE430304956D@mildnpexmb01.maninvestments.ad.man.com>
Message-ID: <eea558470806270732w58bb03d1j7be34f58aeb447a6@mail.gmail.com>

Hi Dr Sklyar,

This is interesting to know - I have just noticed that it also happens
every 100 points, there is another disjoint between 200 and 201. I
have attached a file showing this.

The file was created using the following code:

> png("disjoint2.png")
> plot(1:210, type="l")
> dev.off()

Regards,

Richard



2008/6/27 Sklyar, Oleg (MI London) <osklyar at maninvestments.com>:
> I do not see any disjoint on 2.7.0 patched (r45879) or 2.8.0 devel
> (r45830) on RHEL5 64bit.
>
> Dr Oleg Sklyar
> Technology Group
> Man Investments Ltd
> +44 (0)20 7144 3803
> osklyar at maninvestments.com
>
>> -----Original Message-----
>> From: r-devel-bounces at r-project.org
>> [mailto:r-devel-bounces at r-project.org] On Behalf Of Richard Martin
>> Sent: 27 June 2008 12:38
>> To: r-devel at r-project.org
>> Subject: [Rd] plot(type="l") disjoint between 100 and 101st datapoint
>>
>> Dear All:
>>
>> We have been experiencing networking issues so I don't know
>> if this got through; I can't see it in the archive.  My
>> sincere apologies if this appears twice.
>>
>> I may have found an unusual bug and am posting here to see if
>> anyone can reproduce it on their system. First of all, sessionInfo():
>>
>> > sessionInfo()
>> R version 2.7.1 (2008-06-23)
>> i386-apple-darwin8.10.1
>>
>> locale:
>> en_GB.UTF-8/en_GB.UTF-8/C/C/en_GB.UTF-8/en_GB.UTF-8
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> The bug is in the plot() command; it does not draw the line
>> between the 100th and 101st point in a dataset when plotting
>> in line mode (type="l").
>>
>> plot(1:102, type="l") reproduces the problem consistently on
>> my machine, on both png and quartz devices. The result of
>> saving this to the png device by the code below can be seen
>> at http://imagebin.ca/view/txKBk2M.html
>>
>> > png(filename="disjoint.png")
>> > plot(1:102, type="l")
>> > dev.off()
>> quartz
>>     2
>>
>> I had a look through the archives but couldn't see any
>> discussion of this; apologies if I missed it. Is this purely
>> a mac issue?
>> Unfortunately I don't have any other machines to test it on.
>>
>> Kind regards,
>>
>> Richard Martin
>>
>>
>>
>>
>> --
>> Contendere, Explorare, Invenire, et non Cedere
>>
>>
>>
>> --
>> Contendere, Explorare, Invenire, et non Cedere
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
> **********************************************************************
> The contents of this email are for the named addressee(s) only.
> It contains information which may be confidential and privileged.
> If you are not the intended recipient, please notify the sender
> immediately, destroy this email and any attachments and do not
> otherwise disclose or use them. Email transmission is not a
> secure method of communication and Man Investments cannot accept
> responsibility for the completeness or accuracy of this email or
> any attachments. Whilst Man Investments makes every effort to keep
> its network free from viruses, it does not accept responsibility
> for any computer virus which might be transferred by way of this
> email or any attachments. This email does not constitute a request,
> offer, recommendation or solicitation of any kind to buy, subscribe,
> sell or redeem any investment instruments or to perform other such
> transactions of any kind. Man Investments reserves the right to
> monitor, record and retain all electronic communications through
> its network to ensure the integrity of its systems, for record
> keeping and regulatory purposes.
>
> Visit us at: www.maninvestments.com
>
> **********************************************************************
>
>



-- 
Contendere, Explorare, Invenire, et non Cedere
-------------- next part --------------
A non-text attachment was scrubbed...
Name: disjoint2.png
Type: image/png
Size: 13895 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20080627/1300757f/attachment.png>

From radiosity at gmail.com  Fri Jun 27 17:59:38 2008
From: radiosity at gmail.com (Richard Martin)
Date: Fri, 27 Jun 2008 16:59:38 +0100
Subject: [Rd] plot(type="l") disjoint between 100 and 101st datapoint
In-Reply-To: <alpine.LFD.1.10.0806271649570.23779@gannet.stats.ox.ac.uk>
References: <eea558470806270329s40e512f1vba68a4ac3938231e@mail.gmail.com>
	<eea558470806270438h4c9e7242v274d84c4b872c36a@mail.gmail.com>
	<alpine.LFD.1.10.0806271649570.23779@gannet.stats.ox.ac.uk>
Message-ID: <eea558470806270859ga73e71ap9bdc66916847612b@mail.gmail.com>

Dear Prof. Ripley,

Thanks for your advice; indeed, plotting with cairo is not disjointed
and therefore this is a quartz issue. I will inquire further on sig
mac.

Have a nice weekend,

Regards,

Richard Martin

2008/6/27 Prof Brian Ripley <ripley at stats.ox.ac.uk>:
> Please, this is specific to your device (since png() on MacOS defaults to
> quartz).  So discuss it on R-sig-mac.
>
> Try a different device (you do have several of those on your system!)
> including a different version of png().
>
> I think it is related to the fix for excessively slow plotting in 2.7.0, but
> I'm not near my Mac.
>
> On Fri, 27 Jun 2008, Richard Martin wrote:
>
>> Dear All:
>>
>> We have been experiencing networking issues so I don't know if this
>> got through; I can't see it in the archive.  My sincere apologies if
>> this appears twice.
>>
>> I may have found an unusual bug and am posting here to see if anyone
>> can reproduce it on their system. First of all, sessionInfo():
>>
>>> sessionInfo()
>>
>> R version 2.7.1 (2008-06-23)
>> i386-apple-darwin8.10.1
>>
>> locale:
>> en_GB.UTF-8/en_GB.UTF-8/C/C/en_GB.UTF-8/en_GB.UTF-8
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> The bug is in the plot() command; it does not draw the line between
>> the 100th and 101st point in a dataset when plotting in line mode
>> (type="l").
>>
>> plot(1:102, type="l") reproduces the problem consistently on my
>> machine, on both png and quartz devices. The result of saving this to
>> the png device by the code below can be seen at
>> http://imagebin.ca/view/txKBk2M.html
>>
>>> png(filename="disjoint.png")
>>> plot(1:102, type="l")
>>> dev.off()
>>
>> quartz
>>   2
>>
>> I had a look through the archives but couldn't see any discussion of
>> this; apologies if I missed it. Is this purely a mac issue?
>> Unfortunately I don't have any other machines to test it on.
>>
>> Kind regards,
>>
>> Richard Martin
>>
>>
>>
>>
>> --
>> Contendere, Explorare, Invenire, et non Cedere
>>
>>
>>
>> --
>> Contendere, Explorare, Invenire, et non Cedere
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>



-- 
Contendere, Explorare, Invenire, et non Cedere


From mwkimpel at gmail.com  Fri Jun 27 18:14:00 2008
From: mwkimpel at gmail.com (Mark Kimpel)
Date: Fri, 27 Jun 2008 12:14:00 -0400
Subject: [Rd] RBGL not compiling on Debian Lenny with c++ (Debian 4.3.1-2)
	4.3.1
Message-ID: <6b93d1830806270914l36321e58na5f749d40f699eaf@mail.gmail.com>

I've just installed Debian Lenny and RBGL fails compilation with the
following errors (sessionInfo() follows).

* Installing *source* package 'RBGL' ...
untarring boost include tree...
** libs
g++ -I/home/mkimpel/R_HOME/R-patched/R-build/lib64/R/include
-I/usr/local/include   -IboostIncl  -fpic  -g -O2 -c bbc.cpp -o bbc.o
In file included from /usr/include/c++/4.3/ext/hash_set:64,
                 from boostIncl/boost/graph/adjacency_list.hpp:22,
                 from RBGL.hpp:26,
                 from bbc.cpp:1:
/usr/include/c++/4.3/backward/backward_warning.h:32:2: warning:
#warning This file includes at least one deprecated or antiquated
header which may be removed without further notice at a future date.
Please use a non-deprecated interface with equivalent functionality
instead. For a listing of replacement headers and interfaces, consult
the file backward_warning.h. To disable this warning use
-Wno-deprecated.
In file included from boostIncl/boost/graph/dijkstra_shortest_paths.hpp:19,
                 from boostIncl/boost/graph/betweenness_centrality.hpp:14,
                 from bbc.cpp:2:
boostIncl/boost/pending/relaxed_heap.hpp: In member function 'size_t
boost::relaxed_heap<IndexedType, Compare, ID>::log_base_2(size_t)':
boostIncl/boost/pending/relaxed_heap.hpp:101: error: 'CHAR_BIT' was
not declared in this scope
make: *** [bbc.o] Error 1

> sessionInfo()
R version 2.7.1 Patched (2008-06-26 r45997)
x86_64-unknown-linux-gnu

locale:
LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] graph_1.18.1

loaded via a namespace (and not attached):
[1] cluster_1.11.11 tcltk_2.7.1     tools_2.7.1

-- 
Mark W. Kimpel MD ** Neuroinformatics ** Dept. of Psychiatry
Indiana University School of Medicine

15032 Hunter Court, Westfield, IN 46074

(317) 490-5129 Work, & Mobile & VoiceMail
(317) 663-0513 Home (no voice mail please)


From khansen at stat.Berkeley.EDU  Fri Jun 27 18:42:12 2008
From: khansen at stat.Berkeley.EDU (Kasper Daniel Hansen)
Date: Fri, 27 Jun 2008 09:42:12 -0700
Subject: [Rd] RBGL not compiling on Debian Lenny with c++ (Debian
	4.3.1-2) 4.3.1
In-Reply-To: <6b93d1830806270914l36321e58na5f749d40f699eaf@mail.gmail.com>
References: <6b93d1830806270914l36321e58na5f749d40f699eaf@mail.gmail.com>
Message-ID: <748FD7C5-B405-4D33-BC61-DA38FCEBF02A@stat.berkeley.edu>

Hi Mark

This issue (I think) was recently discussed on the BioC list. The  
upshot of that conversation was that Boost (not RBGL) has a problem  
with GCC 4.3. You'll need to fix the headers of boost which is rather  
simple, there is a fix in the Bioconductor thread.

Kasper

On Jun 27, 2008, at 9:14 AM, Mark Kimpel wrote:

> I've just installed Debian Lenny and RBGL fails compilation with the
> following errors (sessionInfo() follows).
>
> * Installing *source* package 'RBGL' ...
> untarring boost include tree...
> ** libs
> g++ -I/home/mkimpel/R_HOME/R-patched/R-build/lib64/R/include
> -I/usr/local/include   -IboostIncl  -fpic  -g -O2 -c bbc.cpp -o bbc.o
> In file included from /usr/include/c++/4.3/ext/hash_set:64,
>                 from boostIncl/boost/graph/adjacency_list.hpp:22,
>                 from RBGL.hpp:26,
>                 from bbc.cpp:1:
> /usr/include/c++/4.3/backward/backward_warning.h:32:2: warning:
> #warning This file includes at least one deprecated or antiquated
> header which may be removed without further notice at a future date.
> Please use a non-deprecated interface with equivalent functionality
> instead. For a listing of replacement headers and interfaces, consult
> the file backward_warning.h. To disable this warning use
> -Wno-deprecated.
> In file included from boostIncl/boost/graph/ 
> dijkstra_shortest_paths.hpp:19,
>                 from boostIncl/boost/graph/ 
> betweenness_centrality.hpp:14,
>                 from bbc.cpp:2:
> boostIncl/boost/pending/relaxed_heap.hpp: In member function 'size_t
> boost::relaxed_heap<IndexedType, Compare, ID>::log_base_2(size_t)':
> boostIncl/boost/pending/relaxed_heap.hpp:101: error: 'CHAR_BIT' was
> not declared in this scope
> make: *** [bbc.o] Error 1
>
>> sessionInfo()
> R version 2.7.1 Patched (2008-06-26 r45997)
> x86_64-unknown-linux-gnu
>
> locale:
> LC_CTYPE 
> = 
> en_US 
> .UTF 
> -8 
> ;LC_NUMERIC 
> = 
> C 
> ;LC_TIME 
> = 
> en_US 
> .UTF 
> -8 
> ;LC_COLLATE 
> = 
> en_US 
> .UTF 
> -8 
> ;LC_MONETARY 
> = 
> C 
> ;LC_MESSAGES 
> = 
> en_US 
> .UTF 
> -8 
> ;LC_PAPER 
> = 
> en_US 
> .UTF 
> -8 
> ;LC_NAME 
> = 
> C 
> ;LC_ADDRESS 
> =C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] graph_1.18.1
>
> loaded via a namespace (and not attached):
> [1] cluster_1.11.11 tcltk_2.7.1     tools_2.7.1
>
> -- 
> Mark W. Kimpel MD ** Neuroinformatics ** Dept. of Psychiatry
> Indiana University School of Medicine
>
> 15032 Hunter Court, Westfield, IN 46074
>
> (317) 490-5129 Work, & Mobile & VoiceMail
> (317) 663-0513 Home (no voice mail please)
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ripley at stats.ox.ac.uk  Fri Jun 27 20:10:11 2008
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Fri, 27 Jun 2008 20:10:11 +0200 (CEST)
Subject: [Rd] unexpected lining up of labels in axis(4,
	hadj=1) (PR#11840)
Message-ID: <20080627181011.D5BC7282EFF1@mail.pubhealth.ku.dk>

Please explain (I am quoting the FAQ) how you 'are sure you know for
certain what it ought to have done'.  Please quote and give exact 
references to the documentation that led you to expect what you expected 
(but did not actually describe).

I would have expected it to work as documented using the default value 
mgp=c(3,1,0), and that is what I see when I run the example.  As far as I 
can see this is the result of not wanting what you actually asked for.


On Fri, 27 Jun 2008, rene.locher at zhaw.ch wrote:

> Full_Name: Rene Locher
> Version:  2.7.1
> OS: i386-pc-mingw32
> Submission from: (NULL) (160.85.231.140)
>
>
> Here is the example:
>
> par(las=1,mar=rep(4,4))
> plot(c(-1000,1000),axes=FALSE)
> box()
> axis(4,hadj=1)
> ## axis labels are positioned in an awkward way
>
> ## I would expect to see label positions like here:
> axis(4,hadj=1,mgp=c(3,3,0))
>
> These are my sessionInfos:
> R version 2.7.1 (2008-06-23)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=German_Switzerland.1252;LC_CTYPE=German_Switzerland.1252;LC_MONETARY=German_Switzerland.1252;LC_NUMERIC=C;LC_TIME=German_Switzerland.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From rene.locher at zhaw.ch  Sat Jun 28 11:50:32 2008
From: rene.locher at zhaw.ch (rene.locher at zhaw.ch)
Date: Sat, 28 Jun 2008 11:50:32 +0200 (CEST)
Subject: [Rd] header containing (PR#11840)
Message-ID: <20080628095033.205C62834157@mail.pubhealth.ku.dk>

Sorry for having been imprecise. The documentation does indeed not 
explicitly claim that axis(3,hadj=1) behaves as I expected it to do. So 
take my input as a whish.
I think that it would be more sensible (for axes on the right side of 
the plot with hadj=1) to line up the labels in such a way that the 
longest label starts at the line defined by mgp and, at the same time, 
that the right end of all labels are lined up as defined by hadj=1.

Ren? Locher                                       
Institute of Data Analysis and Process Design       
Zurich University of Applied Sciences  
CH-8401 Winterthur 
rene.locher at zhaw.ch                               
http://www.idp.zhaw.ch


From ggrothendieck at gmail.com  Sat Jun 28 21:46:12 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat, 28 Jun 2008 15:46:12 -0400
Subject: [Rd] get ...
Message-ID: <971536df0806281246o75249479gaab3a059952e0f85@mail.gmail.com>

Suppose we do this:

> f <- function(...) environment()
> e <- f(a = 1, b = 2)
> ls(e, all = TRUE)
[1] "..."
> e$...
<...>
> class(e$...)
[1] "..."

Is there any way of getting a and b given e without
modifying f?


From p.dalgaard at biostat.ku.dk  Sat Jun 28 22:39:16 2008
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sat, 28 Jun 2008 22:39:16 +0200
Subject: [Rd] get ...
In-Reply-To: <971536df0806281246o75249479gaab3a059952e0f85@mail.gmail.com>
References: <971536df0806281246o75249479gaab3a059952e0f85@mail.gmail.com>
Message-ID: <4866A174.4050706@biostat.ku.dk>

Gabor Grothendieck wrote:
> Suppose we do this:
>
>   
>> f <- function(...) environment()
>> e <- f(a = 1, b = 2)
>> ls(e, all = TRUE)
>>     
> [1] "..."
>   
>> e$...
>>     
> <...>
>   
>> class(e$...)
>>     
> [1] "..."
>
> Is there any way of getting a and b given e without
> modifying f?
>   
 > evalq(list(...),e)
$a
[1] 1

$b
[1] 2

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From gb at stat.umu.se  Mon Jun 30 00:45:21 2008
From: gb at stat.umu.se (gb at stat.umu.se)
Date: Mon, 30 Jun 2008 00:45:21 +0200 (CEST)
Subject: [Rd] Bug in plnorm (PR#11867)
Message-ID: <20080629224521.78393282C786@mail.pubhealth.ku.dk>

Full_Name: G?ran Brostr?m
Version: 2.7.1
OS: Ubuntu 8.04 (x86_64)
Submission from: (NULL) (85.11.40.53)


> plnorm(0, lower.tail = FALSE, log.p = TRUE)

returns 1 instead of the correct 0 (zero).

The same seems to hold for 

> plnorm(x, lower.tail = FALSE, log.p = TRUE)

for any negative value of x.


From lgautier at gmail.com  Mon Jun 30 13:48:45 2008
From: lgautier at gmail.com (Laurent Gautier)
Date: Mon, 30 Jun 2008 13:48:45 +0200
Subject: [Rd] Embedded R, last errormessage, and stack smashing
Message-ID: <27d1e6020806300448r10d55c38jd6400c923e5a74cc@mail.gmail.com>

Dear list,

I am having an embedded R, dying with
*** stack smashing detected *** in one specific case.

My code is such as I evaluate R expression with C code like

res = R_tryEval(expr, env, &error);

and in case of error, get the error message (usually sucessfully) with
code like below:

SEXP geterrmessage = findVar(install("geterrmessage"), R_BaseNamespace);
PROTECT(expr = allocVector(LANGSXP, 1));
SETCAR(expr, geterrmessage);
PROTECT(res = Rf_eval(expr, R_GlobalEnv));
// ---> *** stack smashing detected ***

The call to Rf_eval does not return as the stack smashing error stops the show.

Tracing with gdb where the problem occurs, I follow the path:
eval -> R_CheckStack in main/error.c -> errorcall in main/error.c


In errorcall, I narrow down the origin of the problem around the lines:
658    va_start(ap, format);
659    verrorcall_dflt(call, format, ap);
660    va_end(ap);
and add a breakpoint on each one of those lines.


My gdb session till the stack smashing crashing is then looking like:

Breakpoint 7, Rf_errorcall (call=0x828ef8, format=0x7f4dbdc87698 "C
stack usage is too close to the limit")
    at errors.c:658
658	    va_start(ap, format);
(gdb) p ap
$2 = {{gp_offset = 16, fp_offset = 48, overflow_arg_area = 0x41c22f60,
reg_save_area = 0x41c22e70}}
(gdb) p format
$3 = 0x7f4dbdc87698 "C stack usage is too close to the limit"
(gdb) continue
Continuing.

Breakpoint 8, Rf_errorcall (call=0x828ef8, format=0x7f4dbdc87698 "C
stack usage is too close to the limit")
    at errors.c:659
659	    verrorcall_dflt(call, format, ap);
(gdb) continue
Continuing.

Breakpoint 6, Rf_errorcall (call=0x828ef8, format=0x7f4dbdc87406 "%s")
at errors.c:648
648	    if (R_ErrorHook != NULL) {
(gdb) continue
Continuing.

Breakpoint 7, Rf_errorcall (call=0x828ef8, format=0x7f4dbdc87406 "%s")
at errors.c:658
658	    va_start(ap, format);
(gdb) continue
Continuing.

Breakpoint 8, Rf_errorcall (call=0x828ef8, format=0x7f4dbdc87406 "%s")
at errors.c:659
659	    verrorcall_dflt(call, format, ap);
(gdb) continue
Continuing.
*** stack smashing detected ***: /usr/bin/python terminated


My understanding is that there is a C stack problem about to happen R
tries to report, but in the process of reporting it
causes a C stack-related crash. Is there something odd with R handling
the situation, or should I look for the cause
of the problem elsewhere ?

Thanks,


L.


From luke at stat.uiowa.edu  Mon Jun 30 16:56:00 2008
From: luke at stat.uiowa.edu (Luke Tierney)
Date: Mon, 30 Jun 2008 09:56:00 -0500 (CDT)
Subject: [Rd] get ...
In-Reply-To: <4866A174.4050706@biostat.ku.dk>
References: <971536df0806281246o75249479gaab3a059952e0f85@mail.gmail.com>
	<4866A174.4050706@biostat.ku.dk>
Message-ID: <alpine.LFD.1.10.0806300950510.2815@nokomis.stat.uiowa.edu>

On Sat, 28 Jun 2008, Peter Dalgaard wrote:

> Gabor Grothendieck wrote:
>> Suppose we do this:
>>
>> 
>>> f <- function(...) environment()
>>> e <- f(a = 1, b = 2)
>>> ls(e, all = TRUE)
>>> 
>> [1] "..."
>> 
>>> e$...
>>> 
>> <...>
>> 
>>> class(e$...)
>>> 
>> [1] "..."
>> 
>> Is there any way of getting a and b given e without
>> modifying f?
>> 
>> evalq(list(...),e)
> $a
> [1] 1
>
> $b
> [1] 2
>
>

I'm wondering though whether we should allow the internal DOTSXP value
of "..." to escape to the user level.  Might be more appropriate for
get(e,"..."), e$... (and as.list.environment and maybe a few other
things) to give the "Error: '...' used in an incorrect context" error
if the value is a DOTSXP.

luke

-- 
Luke Tierney
Chair, Statistics and Actuarial Science
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:      luke at stat.uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu


From Jagat.K.Sheth at wellsfargo.com  Mon Jun 30 18:47:50 2008
From: Jagat.K.Sheth at wellsfargo.com (Jagat.K.Sheth at wellsfargo.com)
Date: Mon, 30 Jun 2008 11:47:50 -0500
Subject: [Rd] AIX 5.3 --enable-R-shlib make error with R-2.7.1
Message-ID: <8A880C79FFE28546933CE022FE244C7C02BDC611@msgswbiadsm48.wellsfargo.com>

Using AIX 5.3 and gcc-4.2.1 for building R-2.7.1 with the following
configure flags

OBJECT_MODE=64
CC="gcc -maix64" 
CXX="g++ -maix64" 
F77="gfortran -maix64" 
FC="gfortran -maix64" 
CFLAGS="-g -O3" 
CXXFLAGS="-g -O3" 
FFLAGS="-g -O3" 
FCFLAGS="-g -O3" 
LDFLAGS="-L/$HOME/usr/local/lib/ppc64 -L/$HOME/usr/local/lib" 
CPPFLAGS="-I/$HOME/usr/include" 
./configure --disable-nls --without-iconv --prefix=$HOME/usr/local
--enable-R-shlib 

After a successful configuration, the make stops with the following
error on this system

make[3]: Entering directory
`/home/apps/crm_cm/n731661x/src/R-2.7.1/src/main'
gcc -maix64 -std=gnu99 -I../../src/extra/zlib -I../../src/extra/bzip2
-I../../src/extra/pcre  -I. -I../../src/include -I../../src/include
-I//users/apps/crm_cm/n731661x/usr/include -DHAVE_CONFIG_H
-mminimal-toc   -g -O3 -c Rmain.c -o Rmain.o
gcc -maix64 -std=gnu99 -Wl,-brtl -Wl,-bexpall -Wl,-bpT:0x100000000
-Wl,-bpD:0x110000000 -lc
-L//users/apps/crm_cm/n731661x/usr/local/lib/ppc64
-L//users/apps/crm_cm/n731661x/usr/local/lib -o R.bin Rmain.o
-L../../lib -lR
ld: 0711-317 ERROR: Undefined symbol: R_running_as_main_program
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more
information.
collect2: ld returned 8 exit status
make[3]: *** [R.bin] Error 1
make[3]: Leaving directory
`/home/apps/crm_cm/n731661x/src/R-2.7.1/src/main'
make[2]: *** [R] Error 2
make[2]: Leaving directory
`/home/apps/crm_cm/n731661x/src/R-2.7.1/src/main'
make[1]: *** [R] Error 1
make[1]: Leaving directory `/home/apps/crm_cm/n731661x/src/R-2.7.1/src'
make: *** [R] Error 1

On the other hand, no problems on this system with the above
configuration building R<=2.6.2. Can also successfully build R-2.7.1
here without --enable-R-shlib.

Will be glad to experiment or provide more details if needed anytime. 

Thanks,
Jagat 


--
Jagat K. Sheth                                       
Prepayment Modeling and Economics  
Wells Fargo Home Mortgage                 
7911 Forsyth Boulevard
Suite 500, M5001-061
Clayton, MO 63105

Tel: (314)-726-4496
Fax: (314)-726-4483
jagat.k.sheth at wellsfargo.com


