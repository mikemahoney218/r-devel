From ben@eno.Princeton.EDU  Mon Feb  1 16:59:18 1999
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Mon, 1 Feb 1999 11:59:18 -0500 (EST)
Subject: PostScript bugs in R-0.63.1
Message-ID: <Pine.SUN.3.95.990201111153.607A-100000@paca>


  I have a minor problem with the PostScript generated by R-0.63.1.

  Specifically, the files generated *will* work in:

    ghostview
    on an HP LaserJet
    on an Apple LaserWriter

  *will not* work in:

     ghostscript under xdvi
     on a SPARCprinter
 
  The error message on the SPARCprinter was

Error: /invalidfont
Command: 'definefont'
Ostack: /Font5 /Font5 font(Symbol,1)
Estack:
  [and quite a bit more ...]

  This was a picture with no Symbol font involved, so I was able to
comment out the following line:

%/Font5 /Symbol findfont definefont

and then the PostScript worked under xdvi and on the SPARCprinter.

  Any ideas?

  A meta-question: should I submit this to the bug-tracking system 1) in
addition 2) instead of sending to R-devel?  It seems the bug-tracking
system isn't heavily used, and that its value is proportional to how much
it's used (otherwise you just have to search the R-devel and R-help
archives).

  thanks,
    Ben Bolker

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Feb  1 17:26:22 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 01 Feb 1999 18:26:22 +0100
Subject: PostScript bugs in R-0.63.1
In-Reply-To: Ben Bolker's message of Mon, 1 Feb 1999 11:59:18 -0500 (EST)
References: <Pine.SUN.3.95.990201111153.607A-100000@paca>
Message-ID: <x2btjef329.fsf@blueberry.kubism.ku.dk>

Ben Bolker <ben@eno.princeton.edu> writes:

>   A meta-question: should I submit this to the bug-tracking system 1) in
> addition 2) instead of sending to R-devel?  It seems the bug-tracking
> system isn't heavily used, and that its value is proportional to how much
> it's used (otherwise you just have to search the R-devel and R-help
> archives).

Well, the difference between R-bugs and R-devel is that bugs are
remembered if entered into the former. Bugs on the mailing lists tend
to get "now-or-never" service.

Noone is going through months of mailing list traffic to check whether
all reported problems have been fixed. I try to make mental notes of
what I see, but my DRAM chips seems to need frequent refresh. I'm sure
many of the others feel likewise. I do, however, take an occasional
stroll through the bug repository and check for fixed bugs, sort the
incoming ones, and sometimes also make a stab at analysing/fixing some
of them.

I'm currently looking at the R-bugs interface to see if it would be
possible to redirect all traffic on R-bugs through R-devel (except
"private" messages, which go to the core team only, of course). It's a
little sticky, because it requires changes to the Jitterbug sources,
but it doesn't look hopeless at all.

That way, there would be no excuse for not using R-bugs, and R-devel
may turn into a somewhat more constructive[*] forum than it is at the
moment. The bug.report() function has also been substantially improved
for 0.63.3, BTW.

[*] I know, everyone in here is doing their best to chip in to the R
development. The problem is rather the opposite: discussions tending
to remain within the core team.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Ted.Harding@nessie.mcc.ac.uk  Mon Feb  1 17:58:27 1999
From: Ted.Harding@nessie.mcc.ac.uk ( (Ted Harding))
Date: Mon, 01 Feb 1999 17:58:27 -0000 (GMT)
Subject: PostScript bugs in R-0.63.1
In-Reply-To: <Pine.SUN.3.95.990201111153.607A-100000@paca>
Message-ID: <XFMail.990201175827.Ted.Harding@nessie.mcc.ac.uk>

On 01-Feb-99 Ben Bolker wrote:
> 
>   I have a minor problem with the PostScript generated by R-0.63.1.
>   Specifically, the files generated *will* work in:
> 
>     ghostview; on an HP LaserJet; on an Apple LaserWriter
> 
>   *will not* work in:
> 
>      ghostscript under xdvi; on a SPARCprinter
>  
>   The error message on the SPARCprinter was
> 
> Error: /invalidfont
> Command: 'definefont'
> Ostack: /Font5 /Font5 font(Symbol,1)
> Estack:
>   [and quite a bit more ...]

This looks (especially since it sometimes works & sometimes doesn't) like
a PostScript Level-1 vs Level-2 issue.

definefont:  key font definefont font
...
In Level-2 it is permissible to associate a font dictionary with more
than one key. If /font/ has already been registered, definefont does
not alter it in any way
(PostScript Language Ref Manual)

The "invalidfont" error can arise "on discovering that a font dictionary
is malformed".

I don't know the details of R's PS implementation; however, if it is
using definefont attempting to register more than one key for the Symbol
font then that would be consistent with your results. Ghostscript and
ghostview should both be able to handle Level-2; I'm not sure why
ghostscript under xdvi should not be able to (unless xdvi somehow
inhibits it). Apart from that, the observed behaviour is compatible with
HPLJ and AppleLW being Level-2, while the SPARCprinter is Level-1.

Good PostScript code tests the value of "languagelevel": OK if =2, else
if =1 or if undefined in systemdict then Level-2 features may not work
and alternative Level-1 code should be executed (and of course needs to
be supplied in the file ... ).

Ted.

--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding@nessie.mcc.ac.uk>
Date: 01-Feb-99                                       Time: 17:58:27
------------------------------ XFMail ------------------------------
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Arne.Kovac@uni-essen.de  Tue Feb  2 00:35:39 1999
From: Arne.Kovac@uni-essen.de (Arne Kovac)
Date: Tue, 2 Feb 1999 01:35:39 +0100 (NFT)
Subject: PostScript bugs in R-0.63.1
In-Reply-To: <XFMail.990201175827.Ted.Harding@nessie.mcc.ac.uk>
Message-ID: <Pine.A41.4.02.9902020132140.20020-100000@gauss.mathematik.uni-essen.de>

On Mon, 1 Feb 1999, Ted.Harding wrote:

> On 01-Feb-99 Ben Bolker wrote:
> 
> I don't know the details of R's PS implementation; however, if it is
> using definefont attempting to register more than one key for the Symbol
> font then that would be consistent with your results. Ghostscript and
> ghostview should both be able to handle Level-2; I'm not sure why
> ghostscript under xdvi should not be able to (unless xdvi somehow
> inhibits it). Apart from that, the observed behaviour is compatible with
> HPLJ and AppleLW being Level-2, while the SPARCprinter is Level-1.

I have similar problems with R 0-63.1 and LaTeX even without xdvi: after
compiling my LaTeX-document with latex and dvips I can't view it with
ghostview 1.5 anymore due to some error messages. Printing on a Laserjet
4MP works.

Arne

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jean@stat.ubc.ca  Tue Feb  2 20:38:35 1999
From: jean@stat.ubc.ca (Jean Meloche)
Date: Tue, 02 Feb 1999 20:38:35 +0000
Subject: Suggestion
Message-ID: <36B7624B.80E92237@stat.ubc.ca>

I have to write extensions to R regularly.

One of them was an interface to a mysql database on a
different computer. The best way to do that is to have
something like

mysql<-function (dbname, host = "zap", user = "nobody", password = "ok") 
{
    handle <<- .RC("mysqlconnect", c(host, user, password, dbname))
}

and

query<-function (cmd) 
{
    .RC("mysqlquery", handle, cmd)
}

In other words, my mysql (written in C) functions return a true R object.
The .RC function above simply calls the C funtion, passing R objects as
arguments and returns the R object created within the C function.

I think that R should give the ability to write C functions that build
R objects. Eventually, it would be best to have an API to standardize
the process of building R object too...

I'd like to see .RC added to the standard R distribution. Right now, I'm
applying my patch every time I upgrade R. Here is my diff


diff -r R-0.63/src/main/dotcode.c R-0.63.orig/src/main/dotcode.c
264,286d263
< SEXP do_dotRCode(SEXP call, SEXP op, SEXP args, SEXP env)
< {
<       DL_FUNC fun;
<       char buf[128], *p, *q, *vmax;
<       SEXP retval;
<
<       vmax = vmaxget();
<       op = CAR(args);
<       if (!isString(op)) errorcall(call,"function name must be a string\n");
<
<       /* make up load symbol & look it up */
<       p = CHAR(STRING(op)[0]);
<       q = buf; while ((*q = *p) != '\0') { p++; q++; }
<
<       if (!(fun=R_FindSymbol(buf))) errorcall(call,
<               "C-R function not in load table\n");
<
<       retval=fun(args);
<
<       vmaxset(vmax);
<       return retval;
< }
<
969c946
<       }
---
>         }
diff -r R-0.63/src/main/names.c R-0.63.orig/src/main/names.c
497d496
< {".RC",         do_dotRCode,    0,      1,      -1,     PP_FOREIGN},
diff -r R-0.63/src/main/names.h R-0.63.orig/src/main/names.h
128d127
< SEXP do_dotRCode(SEXP, SEXP, SEXP, SEXP);


If it is of interest, I could also provide the module that implements
the mysql interface.

Many thanks.

-- 
Jean Meloche
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Feb  5 08:03:32 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 5 Feb 1999 09:03:32 +0100
Subject: Installing R programs (PROBLEMS !!!!)
In-Reply-To: <36B9DF9B.C76F5A86@ime.unicamp.br> (samira@ime.unicamp.br)
References: <36B9DF9B.C76F5A86@ime.unicamp.br>
Message-ID: <199902050803.JAA08173@sophie.ethz.ch>

[forwarded to R-devel, where this really belongs]

>>>>> "Samira" == Samira M Ismail <samira@ime.unicamp.br> writes:

(to me in a private mail)

    Samira> We have been trying to install R.0.63 for Unix (SunOS 4.1.4 -
    Samira> SPARC 20) and we detected the following problem which makes
    Samira> impossible to run R.  We have got the following message:

    Samira> =======

    Samira> gcc -g -O2 -I../include -I../../src/include -c sunif.c -o sunif.o
    Samira> sunif.c: In function `unif_rand':
    Samira> sunif.c:131: `RAND_MAX' undeclared (first use this function)
    Samira> sunif.c:131: (Each undeclared identifier is reported only once
    Samira> sunif.c:131: for each function it appears in.)
    Samira> sunif.c: In function `Randomize':
    Samira> sunif.c:213: `NULL' undeclared (first use this function)
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `sunif.o'
    Samira> Current working directory /usr/R-0.63.1/src/nmath
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `R'
    Samira> Current working directory /usr/R-0.63.1/src
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `R'

Both  NULL  and  RAND_MAX   are ANSI C.
      (p.102)	 (p.252)    of my Kernighan & Ritchie, 2nd. ed.
      <stdio.h>	 <stdlib.h>

However, I've experienced myself and heard more than once that
SunOS 4.x.x  has always had broken header (*.h) files.
Actually I had thought that the headers that come with gcc would 
``ifdef around these''...

Anyway,  add the following lines to your  src/include/Platform.h

#ifndef NULL
#define	NULL	0
#endif

#ifndef RAND_MAX
#define	RAND_MAX	32767
#endif

(or just to the beginning of src/nmath/sunif.c).

-----------

Kurt, could we add this bug-workaround to configure.in and Platform.in
such that something like

#ifdef SunOS4
/*-- define missing ANSI C --*/
#define	NULL	0
#define	RAND_MAX	32767
#endif

---
Un(?)fortunately, I haven't had access to SunOS4 machines for more than a
year now.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Feb  5 08:04:41 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 5 Feb 1999 09:04:41 +0100
Subject: [Fwd] Problems installing R on SunOS 4.1.4
In-Reply-To: <36B9DF9B.C76F5A86@ime.unicamp.br> (samira@ime.unicamp.br)
References: <36B9DF9B.C76F5A86@ime.unicamp.br>
Message-ID: <199902050804.JAA08175@sophie.ethz.ch>

[forwarded to R-devel, where this really belongs]

>>>>> "Samira" == Samira M Ismail <samira@ime.unicamp.br> writes:

(to me in a private mail)

    Samira> We have been trying to install R.0.63 for Unix (SunOS 4.1.4 -
    Samira> SPARC 20) and we detected the following problem which makes
    Samira> impossible to run R.  We have got the following message:

    Samira> =======

    Samira> gcc -g -O2 -I../include -I../../src/include -c sunif.c -o sunif.o
    Samira> sunif.c: In function `unif_rand':
    Samira> sunif.c:131: `RAND_MAX' undeclared (first use this function)
    Samira> sunif.c:131: (Each undeclared identifier is reported only once
    Samira> sunif.c:131: for each function it appears in.)
    Samira> sunif.c: In function `Randomize':
    Samira> sunif.c:213: `NULL' undeclared (first use this function)
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `sunif.o'
    Samira> Current working directory /usr/R-0.63.1/src/nmath
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `R'
    Samira> Current working directory /usr/R-0.63.1/src
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `R'

Both  NULL  and  RAND_MAX   are ANSI C.
      (p.102)	 (p.252)    of my Kernighan & Ritchie, 2nd. ed.
      <stdio.h>	 <stdlib.h>

However, I've experienced myself and heard more than once that
SunOS 4.x.x  has always had broken header (*.h) files.
Actually I had thought that the headers that come with gcc would 
``ifdef around these''...

Anyway,  add the following lines to your  src/include/Platform.h

#ifndef NULL
#define	NULL	0
#endif

#ifndef RAND_MAX
#define	RAND_MAX	32767
#endif

(or just to the beginning of src/nmath/sunif.c).

-----------

Kurt, could we add this bug-workaround to configure.in and Platform.in
such that something like

#ifdef SunOS4
/*-- define missing ANSI C --*/
#define	NULL	0
#define	RAND_MAX	32767
#endif

---
Un(?)fortunately, I haven't had access to SunOS4 machines for more than a
year now.

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum SOL G1;	Sonneggstr.33
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From me@naxgul.kais.kyoto-u.ac.jp  Sat Feb  6 12:24:01 1999
From: me@naxgul.kais.kyoto-u.ac.jp (Yusuke Uchiyama)
Date: Sat, 6 Feb 1999 12:24:01 GMT
Subject: Partial implementation of "symbols"
Message-ID: <199902061224.MAA00206@naxgul.kais.kyoto-u.ac.jp>

Hello, 

I partially implemented the function "symbols". I would like to know if there have been already other person doing so. If not, would you please check my implementation and, if acceptable, please use it. I would like to implement other arguments if my function is accepted.

P.S. I am very glad to find that R is added to the software page of GNU web site. 

Yusuke Uchiyama
yusuke@kais.kyoto-u.ac.jp

---cut here---

"symbols" <-
function (x, y = NULL, squares = NULL, rectangles = NULL, add = FALSE, 
    inches = TRUE, ...) 
{
    if (is.list(x)) {
        y <- x[[2]]
        x <- x[[1]]
    }
    if (is.array(x)) {
        y <- x[, 2]
        x <- x[, 1]
    }
    if (!is.null(rectangles)) {
        symbols.rectangles(x, y, rectangles = rectangles, ...)
        invisible()
    }
    if (!is.null(squares)) {
        symbols.squares(x, y, squares = squares, ...)
        invisible()
    }
}

"symbols.rectangles" <-
function (x, y, rectangles, add = FALSE, inches = TRUE, ...) 
{
    xleft <- x - rectangles[1, ]/2
    ybottom <- y - rectangles[2, ]/2
    xright <- x + rectangles[1, ]/2
    ytop <- y + rectangles[2, ]/2
    if (add == FALSE) {
        plot.new()
        xlim <- c(min(xleft), max(xright))
        ylim <- c(min(ybottom), max(ytop))
        plot.window(xlim, ylim)
    }
    rect(xleft, ybottom, xright, ytop, ...)
    invisible()
}

"symbols.squares" <-
function (x, y, squares, add = FALSE, inches = TRUE, ...) 
{
    xleft <- x - squares/2
    ybottom <- y - squares/2
    xright <- x + squares/2
    ytop <- y + squares/2
    if (add == FALSE) {
        plot.new()
        xlim <- c(min(xleft), max(xright))
        ylim <- c(min(ybottom), max(ytop))
        plot.window(xlim, ylim)
    }
    rect(xleft, ybottom, xright, ytop, ...)
    invisible()
}



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Sat Feb  6 09:50:37 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Sat, 6 Feb 1999 10:50:37 +0100
Subject: Install R-0.63.1 on Solaris7
In-Reply-To: <36BB9B7F.1926@math.ubc.ca> (message from Yoko Wong on Fri, 05
 Feb 1999 17:31:43 -0800)
References: <36BB9B7F.1926@math.ubc.ca>
Message-ID: <199902060950.KAA04765@florence.ethz.ch>

(Again: 
	please send these things to  R-devel or R-help !!)

>>>>> "Yoko" == Yoko Wong <yoko@math.ubc.ca> writes:

    Yoko> Dear Martin,
    Yoko> I run into following errors when I try to compile R-0.63.1 on
    Yoko> Solaris7.  

>From all I see in the following, this looks like a Solaris 7 bug.
I don't have access to this OS.   

Anyone else ?

    Yoko> **********
    Yoko> /usr/include/sys/tihdr.h:458: warning: no semicolon at end of
    Yoko> struct or union
    Yoko> /usr/include/sys/tihdr.h:459: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:460: parse error before `SRC_offset'
    Yoko> /usr/include/sys/tihdr.h:460: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:461: parse error before `OPT_length'
    Yoko> /usr/include/sys/tihdr.h:461: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:462: parse error before `OPT_offset'
    Yoko> /usr/include/sys/tihdr.h:462: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:468: parse error before `t_scalar_t'
    Yoko> /usr/include/sys/tihdr.h:468: warning: no semicolon at end of
    Yoko> struct or union
    Yoko> /usr/include/sys/tihdr.h:469: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:470: parse error before `DEST_offset'
    Yoko> /usr/include/sys/tihdr.h:470: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:471: parse error before `OPT_length'
    Yoko> *****

    Yoko> Is this version support Solaris7.


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Feb  6 11:11:18 1999
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 6 Feb 1999 11:11:18 +0000 (GMT)
Subject: Install R-0.63.1 on Solaris 7
In-Reply-To: <199902060950.KAA04765@florence.ethz.ch>
Message-ID: <Pine.GSO.4.05.9902061104150.12417-100000@toucan.stats>

On Sat, 6 Feb 1999, Martin Maechler wrote:

> (Again: 
> 	please send these things to  R-devel or R-help !!)
> 
> >>>>> "Yoko" == Yoko Wong <yoko@math.ubc.ca> writes:
> 
>     Yoko> Dear Martin,
>     Yoko> I run into following errors when I try to compile R-0.63.1 on
>     Yoko> Solaris7.  
> 
> >From all I see in the following, this looks like a Solaris 7 bug.
> I don't have access to this OS.   
> 
> Anyone else ?

I do. (Don't ask why we have all of Solaris 2.5, 2.5.1, 2.6 and 2.7 aka 
7. Upgrades always seem just too big for the current partitioning.)  But
before I investigate:

(i) is there a good reason to be trying 0.63.1 rather than 0.63.2?

(ii) which compilers were you trying to use, e.g. what is reported
when configure is run, and what versions are those compilers?

B

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Feb  8 10:50:15 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 8 Feb 1999 10:50:15 +0000 (GMT)
Subject: Install R-0.63.1 on Solaris 7
Message-ID: <199902081050.KAA20019@toucan.stats.ox.ac.uk>

I received the following message. I had no problems building R 0.63.2
on Solaris 7 (aka Solaris 2.7, SunOS 5.7) with each of

gcc2.8.1  f77 version SC4.0
cc version SC4.0  f77 version SC4.0
egcs 1.1 (gcc/g77)

------------- Begin Forwarded Message -------------

From: Yoko Wong <yoko@math.ubc.ca>
Subject: Re: Install R-0.63.1 on Solaris 7
To: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 6 Feb 1999 17:41:57 -0800 (PST)
X-Keywords: 

Thanks. I think it might be the gcc I am using.  I have
compiled on other solaris7 machine. 

Cheers,

Yoko


------------- End Forwarded Message -------------


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kye@ams.sunysb.edu  Mon Feb  8 23:43:54 1999
From: kye@ams.sunysb.edu (Kenny Ye)
Date: Mon, 8 Feb 1999 18:43:54 -0500 (EST)
Subject: bug on cancor
Message-ID: <Pine.SO4.4.02.9902081842340.23770-100000@fisher>


When I use the function cancor of mva package, I found that it doesn't
work when one of the matrix has only one column, or both have only
one column. The function in Splus 5 with the same name works under those
situations.

The version of R I am using is 0.63.2 (released on Jan., 1999) on Solaris.

Kenny Ye
Assistant Professor
Department of Applied Math and Statistics
SUNY at  Stony Brook
Stony Brook, New York 11794-3600
(516)632 9344


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kye@ams.sunysb.edu  Tue Feb  9 00:00:58 1999
From: kye@ams.sunysb.edu (kye@ams.sunysb.edu)
Date: Tue, 9 Feb 1999 01:00:58 +0100
Subject: bug on cancor (PR#116)
Message-ID: <199902090000.BAA00511@biostat.ku.dk>


When I use the function cancor of mva package, I found that it doesn't
work when one of the matrix has only one column, or both have only
one column. The function in Splus 5 with the same name works under those
situations.

The version of R I am using is 0.63.2 (released on Jan., 1999) on Solaris.

Kenny Ye
Assistant Professor
Department of Applied Math and Statistics
SUNY at  Stony Brook
Stony Brook, New York 11794-3600
(516)632 9344


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Feb  9 00:16:37 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 09 Feb 1999 01:16:37 +0100
Subject: bug on cancor (PR#116)
In-Reply-To: kye@ams.sunysb.edu's message of Tue, 9 Feb 1999 01:00:58 +0100
References: <199902090000.BAA00511@biostat.ku.dk>
Message-ID: <x21zk0qvmi.fsf@blueberry.kubism.ku.dk>

kye@ams.sunysb.edu writes:

> When I use the function cancor of mva package, I found that it doesn't
> work when one of the matrix has only one column, or both have only
> one column. The function in Splus 5 with the same name works under those
> situations.

Just for those who wondered: I resent the message to R-bugs, making it
appear on R-devel for the 2nd time but with a PR#. (Resending - in my
mailer at least - leaves the original author as sender, which I think
is desirable. It also came out with a double R-devel signature, but
that probably can't be helped).

This is clearly a bug:

> cancor(1:10,1:10)
Error in qr.qty(qx, qr.qy(qy, diag(1, nr, dy)))[1:dx, , drop = FALSE]
: incorrect number of dimensions

Probably a dimension getting dropped somewhere...
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From warnes@biostat.washington.edu  Tue Feb  9 02:10:36 1999
From: warnes@biostat.washington.edu (Gregory R. Warnes)
Date: Mon, 8 Feb 1999 18:10:36 -0800 (PST)
Subject: load() -> segfault
Message-ID: <Pine.LNX.4.04.9902081753120.560-100000@localhost>


OK.  Now that I've saved the results of some simulations using the save()
patch that I supplied earlier, I've gotten around to finding out why
load segfaults when I try to restore the data.

The reason is that I have several variable names which have
become horribly long during the simulation -- on the order of 20K
characters!  

save() is perfectly happy to write these variable names out, but load()
segfaults because the "InString" family of functions use fixed size
buffer but don't check for overflow!  The buffer is MAXELTSIZE bytes,
defined in $RHOME/src/inclide/Defn.h as 512. As you would expect,
reading a 20K object into a 512 byte buffer can really mess things up.

As noted in the comments of saveload.c,
    /* FIXME : the fixed size buffer here is an abomination */
but that's not as bad as failing to check for overflow.

I don't really have time to fix this, so for the moment I'm just refining
MAXELTSIZE to 32768 bytes (32K).  This fixes my problem, but is a horrid
hack.

Does anyone want to run through saveload.c fixing the code to check for
buffer overruns?   

-Greg

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From warnes@biostat.washington.edu  Tue Feb  9 02:11:34 1999
From: warnes@biostat.washington.edu (warnes@biostat.washington.edu)
Date: Tue, 9 Feb 1999 03:11:34 +0100
Subject: load() -> segfault (PR#117)
Message-ID: <199902090211.DAA00532@biostat.ku.dk>


OK.  Now that I've saved the results of some simulations using the save()
patch that I supplied earlier, I've gotten around to finding out why
load segfaults when I try to restore the data.

The reason is that I have several variable names which have
become horribly long during the simulation -- on the order of 20K
characters!  

save() is perfectly happy to write these variable names out, but load()
segfaults because the "InString" family of functions use fixed size
buffer but don't check for overflow!  The buffer is MAXELTSIZE bytes,
defined in $RHOME/src/inclide/Defn.h as 512. As you would expect,
reading a 20K object into a 512 byte buffer can really mess things up.

As noted in the comments of saveload.c,
    /* FIXME : the fixed size buffer here is an abomination */
but that's not as bad as failing to check for overflow.

I don't really have time to fix this, so for the moment I'm just refining
MAXELTSIZE to 32768 bytes (32K).  This fixes my problem, but is a horrid
hack.

Does anyone want to run through saveload.c fixing the code to check for
buffer overruns?   

-Greg


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Feb  9 08:07:57 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 9 Feb 1999 08:07:57 +0000 (GMT)
Subject: bug on cancor (PR#116)
In-Reply-To: <x21zk0qvmi.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.9902090741290.17438-100000@auk.stats>

On 9 Feb 1999, Peter Dalgaard BSA wrote:

> kye@ams.sunysb.edu writes:
> 
> > When I use the function cancor of mva package, I found that it doesn't
> > work when one of the matrix has only one column, or both have only
> > one column. The function in Splus 5 with the same name works under those
> > situations.

Yes, it does, but whether this makes statistical sense is debatable:
you are then doing regression in a roundabout way. (Least-squares
regression maximizes the correlation of y with a linear combination of the
cols of X.)

> Just for those who wondered: I resent the message to R-bugs, making it
> appear on R-devel for the 2nd time but with a PR#. (Resending - in my
> mailer at least - leaves the original author as sender, which I think
> is desirable. It also came out with a double R-devel signature, but
> that probably can't be helped).
> 
> This is clearly a bug:
> 
> > cancor(1:10,1:10)
> Error in qr.qty(qx, qr.qy(qy, diag(1, nr, dy)))[1:dx, , drop = FALSE]
> : incorrect number of dimensions
> 
> Probably a dimension getting dropped somewhere...

Nope. As someone who has suffered here before, I saw it is that pesky
mat.or.vec construction that someone in R likes to use. Function
qr.qr returns a vector when given an n x 1 y, by design.  So

qr.qy(qy, diag(1, nr, dy))
qr.qty(qx, qr.qy(qy, diag(1, nr, dy)))

are vectors.  So this is an R design decision.
To work around this in cancor, use

    zz <- qr.qty(qx, qr.qy(qy, diag(1, nr, dy)))
    z <- svd(as.matrix(zz)[1:dx, , drop=FALSE], dx, dy)


BTW, the help page for qr.qy says the value is

Value:

     The QR decomposition of the matrix as computed by LIN-
     PACK.  The components in the returned value correspond
     directly to the values returned by DQRDC.

which is nonsense for 8 of the 9 functions documented on that page.

I was using 0.63.2, in case anything has been altered since.

It may be too late to change this design decision (I know of quite a few
workarounds in other code) but it will come back to haunt users. At least
it could be documented!

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Feb  9 09:18:05 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 9 Feb 1999 10:18:05 +0100
Subject: bug on cancor (PR#116)
In-Reply-To: <Pine.GSO.4.05.9902090741290.17438-100000@auk.stats> (message
 from Prof Brian D Ripley on Tue, 9 Feb 1999 08:07:57 +0000 (GMT))
References: <Pine.GSO.4.05.9902090741290.17438-100000@auk.stats>
Message-ID: <199902090918.KAA15254@sophie.ethz.ch>

In the ``release-patch'' aka 0.63.3  version, the  functions
qr.xxx  *have* changed about 10 days ago.

NEWS has

    o	backsolve(), qr.solve... now return a vector when x (or y) is a vector.


In today's snapshot,

  > library(mva)
  > str(cancor(1:9,c(1:4,6:10)))
  List of 5
   $ cor    : num 0.997
   $ xcoef  : num 0.129
   $ ycoef  : num 0.110
   $ xcenter: num 5
   $ ycenter: num 5.56

However, 
I'm not sure if this addresses all issues (apart from docu)
that Prof Ripley has addressed. 

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From nlewin@iastate.edu  Tue Feb  9 15:59:01 1999
From: nlewin@iastate.edu (Nicholas Lewin)
Date: Tue, 09 Feb 1999 09:59:01 CST
Subject: Inter-application communication protocols for R
Message-ID: <199902091559.JAA07685@environ.stat.iastate.edu>

Dear R development people,
  We have developed a bi-directional link between the GIS package ArcView and 
XGobi. The link operates using RPC calls transparent to the user. We are 
interested in expanding the link to a stats package such as R, and would like 
to know if there is any interest in implementing inter-application protocols. 
We are interested in implementing a link where data could be passed from 
ArcView to both XGobi and R. Once the data is passed different views of the 
data could be displayed in both packages and linked to the map in ArcView for 
brushing. We also envision calculating various spatial statistics in R and 
passing them back to ArcView for display.

We would also be interested in implementing better sturctures for display of 
spatial data in R. If there is interest please let us know.

Sincerely,
Nicholas Lewin-Koh



                      CH3                  
                       |                          
                       N                 Nicholas Lewin-Koh
                      / \                GIS Support and Research Facility
                N----C   C==O            218 Durham Center
               ||   ||   |               Iowa State University
               ||   ||   |               Ames, IA 50011
               CH    C   N--CH3
                 \  / \ /                nlewin@iastate.edu
                  N    C                 515-294-2279 
                  |   ||                 515-294-1717 (Fax)
                 CH3   O                 http://www.public.iastate.edu/~nlewin

          The Real Part of Coffee 



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Ben Bolker <ben@eno.Princeton.EDU>  Wed Feb 10 01:58:03 1999
From: Ben Bolker <ben@eno.Princeton.EDU> (Ben Bolker)
Date: Tue, 9 Feb 1999 20:58:03 -0500 (EST)
Subject: wish list
Message-ID: <Pine.SUN.3.95.990125135010.14441A-100000@paca>


  Some of these I can implement pretty easily myself, others are harder
...

GRAPHICS:

    - a new option(), "plot.type", that allows one to set the default plot
type for pairs of points to something other than "p";

    - the ability to set just the lower or upper limits on an axis and
have the other limit auto-scaled (somewhat trickier: I don't know the
most convenient way for the user to specify this)

    - the ability to add points, text, etc. to persp() plots for
annotation (when Ross discussed this, I wasn't sure whether there were
going to be two separate kinds of 3-D plots) 

MISC:

  either an option or a separate function that makes edit() change the
underlying object:

pedit <- function (y) 
{
    assign(deparse(substitute(y)), edit(y), inherits = TRUE)
}

  regexp/tab completion for the help system (ha!)




Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Feb 10 07:56:42 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 10 Feb 1999 07:56:42 +0000 (GMT)
Subject: Ben Bolker's wish list
In-Reply-To: <Pine.SUN.3.95.990125135010.14441A-100000@paca>
Message-ID: <Pine.GSO.4.05.9902100731060.18640-100000@auk.stats>

On Tue, 9 Feb 1999, Ben Bolker wrote:

>     - the ability to set just the lower or upper limits on an axis and
> have the other limit auto-scaled (somewhat trickier: I don't know the
> most convenient way for the user to specify this)

The obvious idea is to use NA to specify a limit to be computed.
 
>   either an option or a separate function that makes edit() change the
> underlying object:
> 
> pedit <- function (y) 
> {
>     assign(deparse(substitute(y)), edit(y), inherits = TRUE)
> }

Why do you want that? In particular, what do you want inherits = TRUE to
achieve?  (As I understand R's documentation, this replaces objects
found down the search path in the global environment, so you must
envisage calling pedit from within a nested set of expressions.)

If you take a closer look at fix(), you will see that you only want
to deparse names and it would be better to check if y (why `y'?) exists.
As I see it all you want to do is to change the last line of fix, and I am
puzzled as to why you want to do that.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Wed Feb 10 13:44:35 1999
From: J.C.Rougier@durham.ac.uk (J.C.Rougier@durham.ac.uk)
Date: Wed, 10 Feb 1999 14:44:35 +0100
Subject: Function parsing (PR#118)
Message-ID: <199902101344.OAA02583@biostat.ku.dk>

Is anyone else concerned with the way in which the R function parser
relocates comments that occur after condional expressions in functions to
before, i.e. 

fred <- function(x) {
 # wonder what x is like
 if (x>0) stop("Sorry non-positive x only")
 # that showed x big-time!
 x
}

but then fred is parsed and stored as 

"fred" <-
function (x) 
{
    # wonder what x is like
    # that showed x big-time!
    if (x > 0) 
        stop("Sorry non-positive x only")
    x
}

It turns out that my programming style often includes comments after
conditionals, and I find this re-location a bit confusing.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Feb 10 14:28:19 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 10 Feb 1999 15:28:19 +0100
Subject: Function parsing (PR#118)
In-Reply-To: J.C.Rougier@durham.ac.uk's message of Wed, 10 Feb 1999 14:44:35 +0100
References: <199902101344.OAA02583@biostat.ku.dk>
Message-ID: <x290e6tjss.fsf@blueberry.kubism.ku.dk>

J.C.Rougier@durham.ac.uk writes:

> Is anyone else concerned with the way in which the R function parser
> relocates comments that occur after condional expressions in functions to
> before, i.e. 
...
> It turns out that my programming style often includes comments after
> conditionals, and I find this re-location a bit confusing.

You're not alone, it's just that nobody has had the stamina to
pinpoint how exactly this happens. An even more drastic version is in
glm.fit:

    ##-------------- end IRLS iteration -------------------------------
    for (iter in 1:control$maxit) {
        mu.eta.val <- mu.eta(eta)
        .. IRLS iteration! ..

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ben@eno.Princeton.EDU  Wed Feb 10 14:29:34 1999
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Wed, 10 Feb 1999 09:29:34 -0500 (EST)
Subject: Ben Bolker's wish list
In-Reply-To: <Pine.GSO.4.05.9902100731060.18640-100000@auk.stats>
Message-ID: <Pine.SUN.3.95.990210092129.19391A-100000@paca>


  I'm sorry, I didn't know that fix() existed.  That's what I wanted, the
"pedit" function I gave was an attempt to do the same thing.  And yes, it
is there in the "See Also" section of the help on edit().  Perhaps we
could add a sentence to the documentation of edit:

*** edit.Rd.orig        Wed Feb 10 09:26:03 1999
--- edit.Rd     Wed Feb 10 09:26:59 1999
***************
*** 29,34 ****
--- 29,35 ----
  Instead, a copy of name is made and it is that copy which is changed.
  Should you want the changes to apply to the object \code{name}
  you must assign the result of \code{edit} to \code{name}.
+ (Try \code{fix} if you want to make permanent changes to an object.)
  
  In the form \code{edit(name)},
  \code{edit} deparses \code{name} into a temporary file and invokes the



  I *don't* claim to understand the ins and outs of parsing, deparsing,
etc. in R, but the pedit() function seemed to do what I wanted (although
probably not as generally or as robustly as fix()).

  Thanks for the info.

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Feb 11 15:14:20 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 11 Feb 1999 16:14:20 +0100
Subject: Problems with warnings from loess under Windows, at least (PR#119)
Message-ID: <199902111514.QAA15364@biostat.ku.dk>

There are two separate problems with loess under Guido's rw0632 on
Windows, neither of which appear unless you try to do something that it is
trying to tell you is inadvisable.  It bombs trying to tell you. I have
put up a replacement modreg.zip in the CRAN contrib collection that will
be mirrored tonight.

Both of these could potentially affect other platforms.

(1) A problem relating to the declaration of problem_buf in S.h.

> On Fri, 5 Feb 1999, Guido Masarotto wrote:

> On Thu, Feb 04, 1999 at 06:54:34PM +0000, Prof Brian D Ripley wrote:
> > OK, I have got to the bottom of this.
> > 
> > For some reason Guido has problem_buf in globalvar.h, twice. It should
> > not be there, and used not to be.  That means that any call to warning() or
> > stop() from compiled code in a DLL will bomb R. The solution is to remove
> > those lines and re-compile modreg.  I can do that for you if you need it.

>   The problem seems to happen
>   since every file which includes S.h declare a 'public' version
>   of problem_buf,i.e, got a declaration of the type
>   char problem_buf[4096];
>   I suspect that problem_buf should or declared extern (with memory
>   allocated somewhere, e.g.,in src/main.c) or static.
>   (BTW, the two files are appl/loglin.c and main/print.c).
>   In general, I am beginning to think that my 'automatic'
>   approch for globalvar.h is too much dangerous. It assumes
>   that global variables in all the 'main' files are 
>   properly declared and named. And, this is not the case now.

This needs resolving to static or extern for all the platforms. Those
writing `main' files might like to be aware that leaving symbols exposed
causes some problems, as on Windows we have to declare as imports all the
variables used from the R engine. The current scheme is to assume that all
exposed variables are intended to be imported.  (Can f1 and f2 in
approx.c be declared static?)

(2) Problems mixing Fortran and C.

> > The messages are then not very clear, because loessf.f passes strings
> > to loessc.c to call the warning/stop routines, and in Windows (but not
> > Unix) those strings seem to be missing a '\0' terminator. So you gets of
> > the next string, .... That will need rather more extensive changes to fix.

The problem here is that the loess code (not mine!) assumes that Fortran
uses strings in C format. This is not a safe assumption, but I was
surprised to find it not true for a port of g77. There may be no universal
answer, but I have modified the code to pass to C what Fortran thinks the
length is, and this works on the platforms I have. I will submit the
changed code shortly.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 11 17:46:54 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 11 Feb 1999 18:46:54 +0100
Subject: An idea for something better than read.table
Message-ID: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk>


I was recently converting some datasets for use in an R package and it
occurred to me that there really is no "neat" way to input a data
frame if it is to contain factor variables. 

One can use dput()/source or dump() after massaging data into the
right format, of course, but there isn't really anything which allows
you to store the input instructions with the data beyond the simple
header=T type format. 

So I thought of ways to enhance the header. The best idea I've been
able to come up with this far is to 

(a) Write a function - basically an extension of scan() - which allows
    you to specify the column data type in more detail. Let's call it
    data.file() for now. It would pretty much have to deparse all of
    its arguments and interpret things in slightly unusual ways, but R
    can do that, and some of functions (notably help() and data())
    already play this kind of game with the parser...

(b) Have a function, say read(), which parses the 1st expression in a
    file and executes it *with the remainder of the file as the
    argument*. (Currently, this is impossible, but it would be if
    one just kept track of the line number while parsing. parse()
    could stick it on as an attribute of the parsed expression list if
    asked to do so.)

This would make a file format something like the following possible.

[There's another loose idea in there involving a control item to handle
separators, na.strings, etc. - the intention being that read() plugs
in the file= and skip= arguments for the actual call.]

Would this be an approach worth pursuing?

--- Top of file ---
data.file(control(sep="w",na="."),
        Item = factor(levels=1:4,labels=c("A","B","C","D")),
        Size = numeric(),
        Year = factor(levels=1980:1985)
)
1       0     1980    
1       10    1981    
1       14    1982    
1       20    1983    
1       25    1984    
1       30    1985    
2       0     1980    
2       5     1981    
2       6     1982    
2       8     1984    
3       0     1984    
3       2     1985    
4       0     1980    
4       20    1981    
4       30    1982    
4       30    1984    
4       35    1985    
--- End of file ---

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Feb 11 18:10:27 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 11 Feb 1999 19:10:27 +0100 (CET)
Subject: An idea for something better than read.table
In-Reply-To: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk>
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk>
Message-ID: <14019.7443.446135.700056@pc87.maho.magnaeu.com>

>>>>> Peter Dalgaard BSA writes:

> I was recently converting some datasets for use in an R package and it
> occurred to me that there really is no "neat" way to input a data
> frame if it is to contain factor variables. 

> One can use dput()/source or dump() after massaging data into the
> right format, of course, but there isn't really anything which allows
> you to store the input instructions with the data beyond the simple
> header=T type format. 

> So I thought of ways to enhance the header. The best idea I've been
> able to come up with this far is to 

> (a) Write a function - basically an extension of scan() - which allows
>     you to specify the column data type in more detail. Let's call it
>     data.file() for now. It would pretty much have to deparse all of
>     its arguments and interpret things in slightly unusual ways, but R
>     can do that, and some of functions (notably help() and data())
>     already play this kind of game with the parser...

> (b) Have a function, say read(), which parses the 1st expression in a
>     file and executes it *with the remainder of the file as the
>     argument*. (Currently, this is impossible, but it would be if
>     one just kept track of the line number while parsing. parse()
>     could stick it on as an attribute of the parsed expression list if
>     asked to do so.)

> This would make a file format something like the following possible.

> [There's another loose idea in there involving a control item to handle
> separators, na.strings, etc. - the intention being that read() plugs
> in the file= and skip= arguments for the actual call.]

> Would this be an approach worth pursuing?

I think so.  However, why can't we extend scan() accordingly?

E.g.,

  scan(FILE,
       what = list(Item = factor(levels=1:4,labels=c("A","B","C","D")),
                   Size = numeric(),
                   Year = factor(levels=1980:1985)))

???

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 11 18:31:55 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 11 Feb 1999 19:31:55 +0100
Subject: An idea for something better than read.table
In-Reply-To: Kurt Hornik's message of Thu, 11 Feb 1999 19:10:27 +0100 (CET)
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk> <14019.7443.446135.700056@pc87.maho.magnaeu.com>
Message-ID: <x2d83g3i78.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> > [There's another loose idea in there involving a control item to handle
> > separators, na.strings, etc. - the intention being that read() plugs
> > in the file= and skip= arguments for the actual call.]
> 
> > Would this be an approach worth pursuing?
> 
> I think so.  However, why can't we extend scan() accordingly?
> 
> E.g.,
> 
>   scan(FILE,
>        what = list(Item = factor(levels=1:4,labels=c("A","B","C","D")),
>                    Size = numeric(),
>                    Year = factor(levels=1980:1985)))
> 
> ???

We could, and in a sense that is what I'm suggesting, but:

- the argument syntax is a bit clumsy, I'd like to have the variables
through a ... argument.

- scan *evaluates* the arguments and then looks at the type.
Evaluating things like

factor(levels=1:4,labels=c("A","B","C","D")) 

currently gives a "missing x" error, but even if we fixed that, it
could never give anything better than

> structure(integer(0),class="factor",levels=c("A","B","C","D"))
factor(0)
Levels:  A B C D 

i.e. the levels= specification would be forgotten. The only way to
circumvent that is to have scan working on nonevaluated arguments.

So I thought that one might as well start over with a completely new
function. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Feb 11 18:56:05 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 11 Feb 1999 13:56:05 -0500
Subject: dput truncation
Message-ID: <99Feb11.140632est.13485@mailgate.bank-banque-canada.ca>

dput() seems to be truncating data (either using single precision or some
formatting). In general my data is not so accurate that I should worry about
this and the small difference after dput then dget is mostly just an annoyance.
However, in some circumstances the truncation is enough that tsp attributes are
no longer valid, and that causes more serious difficulties. Is there any way to
modify the behavior of dput?

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From me@naxgul.kais.kyoto-u.ac.jp  Fri Feb 12 18:22:59 1999
From: me@naxgul.kais.kyoto-u.ac.jp (Yusuke Uchiyama)
Date: Fri, 12 Feb 1999 18:22:59 GMT
Subject: A subroutine for plotting stars
Message-ID: <199902121822.SAA00623@naxgul.kais.kyoto-u.ac.jp>


Hello,

I implemented "symbols.stars", a sub routine plotting stars.

It is intended to be called from "symbols".

Please use it if it is acceptable.

Yusuke Uchiyama

Laboratory of Insect Physiology
Graduate School of Agriculture
Kyoto University

e-mail: yusuke@kais.kyoto-u.ac.jp

---cut here---

"symbols.stars" <-
function (x, y, stars, add = FALSE, ...) 
{
    stars <- t(stars)
    i <- dim(stars)[1]
    anstep <- 2 * pi/i
    anstep <- anstep * 0:(i - 1) + pi/2
    dim(anstep) <- length(anstep)
    anstep <- t(apply(anstep, 1, rep, dim(stars)[2]))
    dim(x) <- length(x)
    dim(y) <- length(y)
    x <- apply(x, 1, rep, i)
    y <- apply(y, 1, rep, i)
    x <- x + stars * cos(anstep)
    y <- y + stars * sin(anstep)
    x <- c(apply(x, 2, c, NA))
    y <- c(apply(y, 2, c, NA))
    if (add == FALSE) {
        xlim <- c(min(x[!is.na(x)]) - 1.5, max(x[!is.na(x)]) + 
            1.5)
        ylim <- c(min(y[!is.na(y)]) - 1.5, max(y[!is.na(y)]) + 
            1.5)
        plot.new()
        plot.window(xlim, ylim)
    }
    polygon(x, y)
}





-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Feb 12 19:06:41 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 12 Feb 1999 14:06:41 -0500
Subject: more on dput
Message-ID: <99Feb12.150245est.13483@mailgate.bank-banque-canada.ca>

I would like to write data so that I can re-read it and reproduce results,
preferably in both R and Splus. In the past when I have done this my data has
been relatively simple and I've just scan()ed it. Now I have a fairly
complicated structure I would like to preserve and I've been trying to use dput
and dget. Is there a better way?  If not, the following truncation by dput,
which I mentioned yesterday, is causing me a fair amount of trouble. Suggestions
on how to fix it would be appreciated.

Paul Gilbert
_______

R:
> dput (1/3, "zot")
> (1/3) - dget("zot")
[1] 3.333333e-08

Splus 3.3:
> dput(1/3, "zot")
> (1/3) - dget("zot")
[1] 3.330669e-16

written by Splus, read in R:
> (1/3) - dget("zot")
[1] 3.330669e-16

so the problem seems pretty clearly to be in R's dput.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Feb 12 20:58:22 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 12 Feb 1999 20:58:22 +0000 (GMT)
Subject: more on dput
In-Reply-To: <99Feb12.150245est.13483@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.9902122056380.19025-100000@auk.stats>

On Fri, 12 Feb 1999, Paul Gilbert wrote:

> I would like to write data so that I can re-read it and reproduce results,
> preferably in both R and Splus. In the past when I have done this my data has
> been relatively simple and I've just scan()ed it. Now I have a fairly
> complicated structure I would like to preserve and I've been trying to use dput
> and dget. Is there a better way?  If not, the following truncation by dput,
> which I mentioned yesterday, is causing me a fair amount of trouble. Suggestions
> on how to fix it would be appreciated.
> 
> Paul Gilbert
> _______
> 
> R:
> > dput (1/3, "zot")
> > (1/3) - dget("zot")
> [1] 3.333333e-08
> 
> Splus 3.3:
> > dput(1/3, "zot")
> > (1/3) - dget("zot")
> [1] 3.330669e-16
> 
> written by Splus, read in R:
> > (1/3) - dget("zot")
> [1] 3.330669e-16
> 
> so the problem seems pretty clearly to be in R's dput.

I find:

> dput(1/3)
0.3333333
> as.character(1/3)
[1] "0.333333333333333"
> options(digits=16)
> dput(1/3)
0.3333333333333333

so either use as.character or set digits to something large.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Feb 12 21:16:05 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 12 Feb 1999 16:16:05 -0500
Subject: more on dput
References: <Pine.GSO.4.05.9902122056380.19025-100000@auk.stats>
Message-ID: <99Feb12.162703est.13453@mailgate.bank-banque-canada.ca>

> options(digits=16)

Thanks Brian, that works fine. I'm not so sure that it is a good idea having
dput depend on this, but if it's not changed it should at least be documented.

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From me@naxgul.kais.kyoto-u.ac.jp  Tue Feb 16 14:20:09 1999
From: me@naxgul.kais.kyoto-u.ac.jp (Yusuke Uchiyama)
Date: Tue, 16 Feb 1999 14:20:09 GMT
Subject: How to call do_circle from .Internal
Message-ID: <199902161420.OAA01141@naxgul.kais.kyoto-u.ac.jp>

Hello,

I would like to implement "circle" argument of "symbols", and want to call do_circle by name "circle" from .Internal.

I suppose I can do that by adding following lines to src/main/names.c and names.h:

names.c 
{"circle"	do_circle	0 ....}

names.h
SEXP do_circle(...)

Is it right?

Yusuke Uchiyama
yusuke@kais.kyoto-u.ac.jp
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 13:15:39 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 14:15:39 +0100
Subject: eval problem in Math.data.frame [.. DispathGroup / mean==sum ..] (PR#84)
Message-ID: <199902161315.OAA21263@biostat.ku.dk>

>> log(data.frame(x=1:4),base=2)
> Error: Object "base" not found

This one seems to be fixed. Move to Language-fixed.

(Note: there seems to be some strangeness with composing replies like this
in the web interface to JitterBug. Watch the headers if you want to followup.)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Feb 16 13:50:04 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 16 Feb 1999 14:50:04 +0100
Subject: eval problem in Math.data.frame [.. DispathGroup / mean==sum ..] (PR#84)
In-Reply-To: Peter Dalgaard's message of Tue, 16 Feb 1999 14:15:39 +0100
References: <199902161315.OAA21263@biostat.ku.dk>
Message-ID: <x21zjq5ugj.fsf@blueberry.kubism.ku.dk>

Peter Dalgaard <R-bugs@biostat.ku.dk> writes:

> (Note: there seems to be some strangeness with composing replies like this
> in the web interface to JitterBug. Watch the headers if you want to followup.)

OK, this seems to be relatively harmless. If I Cc: replies to R-devel,
or put it in the To: field, the sender becomes r-bugs@biostat.ku.dk so
any further correspondence goes on record. The only thing to note is
that even though my name occurs, my email does not, so you cannot
easily mail me back privately.

Still, it's a bit odd that JitterBug replies are sent directly from
the web interface, whereas nearly everything else goes via email to
r-bugs (which handles the list forwarding directly), even if entered
on a web form. Oh, well...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 14:11:43 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 15:11:43 +0100
Subject: lists (PR#88)
Message-ID: <199902161411.PAA21293@biostat.ku.dk>

> > 
>> > mode(c(23,42))
>> > is.vector(c(23,42),mode="numeric")
>> > is.vector(c(23,42),mode=c("integer","double","logical"))
>> 
>> Not sure I understand the problem:
> 
> 
> What I had in mind was that it would give TRUE if any of the vector
> had any of these modes i.e. some way of checking several modes at the
> same time without calling is.vector several times. I am looking for
> vectors upon which I can do calculations, as in those given. In
> retrospective, the example is poor. More logically, it should either
> use any() or ||.

I believe this is not a bug. You can get the effect you want fairly easily with

either 

any(sapply(modes,function(y)is.vector(x,mode=y)))

or

any(mode(x) == modes) # or storage.mode to distinguish double/integer

Moving report to "trashcan" (it can be picked up again, don't worry.)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 14:48:19 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 15:48:19 +0100
Subject: possible bug (PR#91)
Message-ID: <199902161448.PAA21336@biostat.ku.dk>

> bug.report:
> =====================
> Version:
>  platform = i586-unknown-linux
>  arch = i586
...
> 1. 
> bug.report() gives above information: however, my computer is a 486,
> not 586, but I am not knowldedgeable enough to tell whether
> bug.report() or the operating system is the optimist.

Your OS is the optimist, and R is not checking during configure. 
You may lose a little efficiency from this, but it's relatively 
harmless. Recompile your kernel with the right CPU setting if it bothers you.

> 2.
> It would be helpful if help(bug.report) showed how to exit
> bug.report() back to R. 

Hmm. It dumps you into your favourite editor, as specified in options()$editor,
and how to get out of that is editor-dependent... Not much we can do about that,

I'm afraid (or can we?). The bug.report() interface got cleaned up
substantially, 
by the way.

> 3.
> Using "expression" as ylab or xlab parameter of plot(): label is not
> centered (too high or too far to the right); this is particularly
> obvious if, e.g., margins are set wide:
> 
> e.g., with:
> 
> par(mai=c(1.8,2,1.8,2))
> 
> I padded the label with spaces to approximately center it:
> 
> ylab=expression(paste("[Ca]"[i]," (nM)                            ")

Still with us, I'm afraid. Don't see the mai= thing, though, but

 plot(1:3,ylab=expression(paste("[Ca]"[i]," (nM) "))) 

shows the effect badly enough.

Moving PR to "graphics"
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 14:48:40 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue Feb 16 14:48:40 1999
Subject: possible bug (PR#91)
Message-ID: <199902161506.QAA21358@biostat.ku.dk>

> bug.report:
> =====================
> Version:
>  platform = i586-unknown-linux
>  arch = i586
...
> 1. 
> bug.report() gives above information: however, my computer is a 486,
> not 586, but I am not knowldedgeable enough to tell whether
> bug.report() or the operating system is the optimist.

Your OS is the optimist, and R is not checking during configure. 
You may lose a little efficiency from this, but it's relatively 
harmless. Recompile your kernel with the right CPU setting if it bothers you.

> 2.
> It would be helpful if help(bug.report) showed how to exit
> bug.report() back to R. 

Hmm. It dumps you into your favourite editor, as specified in options()$editor,
and how to get out of that is editor-dependent... Not much we can do about that,

I'm afraid (or can we?). The bug.report() interface got cleaned up
substantially, 
by the way.

> 3.
> Using "expression" as ylab or xlab parameter of plot(): label is not
> centered (too high or too far to the right); this is particularly
> obvious if, e.g., margins are set wide:
> 
> e.g., with:
> 
> par(mai=c(1.8,2,1.8,2))
> 
> I padded the label with spaces to approximately center it:
> 
> ylab=expression(paste("[Ca]"[i]," (nM)                            ")

Still with us, I'm afraid. Don't see the mai= thing, though, but

 plot(1:3,ylab=expression(paste("[Ca]"[i]," (nM) "))) 

shows the effect badly enough.

Moving PR to "graphics"
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 15:15:48 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 16:15:48 +0100
Subject: possible bug (PR#91)
Message-ID: <199902161515.QAA21371@biostat.ku.dk>

> 3.
> Using "expression" as ylab or xlab parameter of plot(): label is not
> centered (too high or too far to the right); this is particularly
> obvious if, e.g., margins are set wide:
> 
> e.g., with:
> 
> par(mai=c(1.8,2,1.8,2))
> 
> I padded the label with spaces to approximately center it:
> 
> ylab=expression(paste("[Ca]"[i]," (nM)                            ")

Er, wait a minute. I think you are trying to do

plot(1:3,ylab=expression("[Ca]"[i]*" (nM) "))

which *does* get centered correctly.

This leaves the bug.report issue, so I'll put the report in a new "Misc" folder.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 15:33:09 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 16:33:09 +0100
Subject: source() / eval() bug ??? (PR#96)
Message-ID: <199902161533.QAA21404@biostat.ku.dk>

This one got fixed, I believe.

> R-0.63.2 and  ``0.63.3 in progress'' :
> 
> Put the following in a file
> 
> ------ 8< -- snip ----------------------------- ...../source-bug.R -------
> rm(list=ls())
> cat("before c(..):\n")
> c(F=(f <- .3), "Tail area" = 2 * if(f < 1) 30 else 90)
> ------ 8< -- snip -------------------------- end ..../source-bug.R -------
> 
> then
> 
> source("......../source-bug.R")
> 	^^^^^^^^
> 	proper path name
> 
> [[or  source("......../source-bug.R", verbose=TRUE) ]]
> 
> ends with
> 	=============================================
> 	before c(..):
> 	Error: getAttrib: invalid type for TAG
> 	> 
> 	=============================================
> 
> On interactive usage, or if you use
> 
> 	R --vanilla < ..../source-bug.R
> 
> there's no problem !
> 
> 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 15:49:53 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 16:49:53 +0100
Subject: [R] Pairlist & Dataframe (PR#100)
Message-ID: <199902161549.QAA21432@biostat.ku.dk>

> Ennapadam Venkatraman <venkat@biosta.mskcc.org> writes:

>>     > x <- NULL
>>     > x$x1 <- rnorm(10)
>>     > x$x2 <- rnorm(10)
>>     > mode(x)
>>     [1] "pairlist"
>>     > as.data.frame(x)
>>     Error: can't coerce pairlist into a data.frame

Fixed in 0.63.3
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 17:22:23 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 18:22:23 +0100
Subject: saveload.c (PR#107)
Message-ID: <199902161722.SAA26043@biostat.ku.dk>

> and so all depends from this function.  Using a Win32 version of SUNRPC
> assembled by Brian R. I was unable to load xdr images since after an
> xdr_destroy the xdr_int function fails.
> 
> Solution seems be as easy as
>   i = InInteger(fp);
>   InTerm(fp);
>   return OffsetToNode(i);

Fixed as suggested for 0.63.3
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mcw@ln.nimh.nih.gov  Tue Feb 16 20:33:52 1999
From: mcw@ln.nimh.nih.gov (mcw@ln.nimh.nih.gov)
Date: Tue, 16 Feb 1999 21:33:52 +0100
Subject: graphics bug: type="l" (PR#120)
Message-ID: <199902162033.VAA26161@biostat.ku.dk>


The following commands illustrate a problem with graphing relatively large
data sets using the "line" option to plot:

temp <- runif(200000)  # or whatever other numbers you like;
			# same thing happens with a sine wave
plot(1:200000, temp)    # everything fine
plot(1:200000, temp, type="l")   # data gets cut off


The number of points isn't crucial.  The cutoff point appears to be about
65,000 points.  (70,000 points demonstrates the cutoff; with 50,000 points
there's no cutoff.) 

As far as I can tell, the problem only occurs when using the
option type="l".  It's unaffected by color, line type, and line width.

Matt Wiener



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Feb 16 21:34:17 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 16 Feb 1999 22:34:17 +0100
Subject: graphics bug: type="l" (PR#120)
In-Reply-To: mcw@ln.nimh.nih.gov's message of Tue, 16 Feb 1999 21:33:52 +0100
References: <199902162033.VAA26161@biostat.ku.dk>
Message-ID: <x2btiuuj6u.fsf@blueberry.kubism.ku.dk>

mcw@ln.nimh.nih.gov writes:

> The following commands illustrate a problem with graphing relatively large
> data sets using the "line" option to plot:
> 
> temp <- runif(200000)  # or whatever other numbers you like;
> 			# same thing happens with a sine wave
> plot(1:200000, temp)    # everything fine
> plot(1:200000, temp, type="l")   # data gets cut off
> 
> 
> The number of points isn't crucial.  The cutoff point appears to be about
> 65,000 points.  (70,000 points demonstrates the cutoff; with 50,000 points
> there's no cutoff.) 
> 
> As far as I can tell, the problem only occurs when using the
> option type="l".  It's unaffected by color, line type, and line width.
> 
> Matt Wiener

Doesn't happen to me with 0.63.pre-3 on RedHat Linux. I can't offhand
see any documented fixes that would affect this, perhaps there's an OS
difference? Looks a bit like a short integer overrun (65536=2^16)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Feb 16 21:54:16 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 16 Feb 1999 21:54:16 +0000 (GMT)
Subject: graphics bug: type="l" (PR#120)
In-Reply-To: <199902162033.VAA26161@biostat.ku.dk>
Message-ID: <Pine.GSO.4.05.9902162134030.24074-100000@auk.stats>

On Tue, 16 Feb 1999 Matt Wiener, mcw@ln.nimh.nih.gov wrote:

> 
> The following commands illustrate a problem with graphing relatively large
> data sets using the "line" option to plot:
> 
> temp <- runif(200000)  # or whatever other numbers you like;
> 			# same thing happens with a sine wave
> plot(1:200000, temp)    # everything fine
> plot(1:200000, temp, type="l")   # data gets cut off
> 
> 
> The number of points isn't crucial.  The cutoff point appears to be about
> 65,000 points.  (70,000 points demonstrates the cutoff; with 50,000 points
> there's no cutoff.) 

This is device-specific (and which device was not mentioned). It does not
happen on Windows (rw0632) nor on a postscript device. It does happen on
the Unix x11() device for me, and my guess is that it is a limitation in
the X library used.  (Not in the X server, for this works in gs
displaying postscript, and in S-PLUS. The lines are drawn in a single Xlib
call.)

Do you really want to plot such a dataset in one go? What do you
expect to see of significance in 200000 points? (There are by default only 
about twice that many pixels on the device surface.) Are they really one
group? Would some group colour coding help? ....

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Feb 17 11:08:37 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Wed, 17 Feb 1999 12:08:37 +0100
Subject: graphics bug: type="l" (PR#120)
Message-ID: <199902171108.MAA26572@biostat.ku.dk>

Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> On Tue, 16 Feb 1999 Matt Wiener, mcw@ln.nimh.nih.gov wrote:
> 
> > 
> > The following commands illustrate a problem with graphing relatively large
> > data sets using the "line" option to plot:
> > 
> > temp <- runif(200000)  # or whatever other numbers you like;
> > 			# same thing happens with a sine wave
> > plot(1:200000, temp)    # everything fine
> > plot(1:200000, temp, type="l")   # data gets cut off
> > 
> > 
> > The number of points isn't crucial.  The cutoff point appears to be about
> > 65,000 points.  (70,000 points demonstrates the cutoff; with 50,000 points
> > there's no cutoff.) 
> 
> This is device-specific (and which device was not mentioned). It does not
> happen on Windows (rw0632) nor on a postscript device. It does happen on
> the Unix x11() device for me, and my guess is that it is a limitation in
> the X library used.  (Not in the X server, for this works in gs
> displaying postscript, and in S-PLUS. The lines are drawn in a single Xlib
> call.)

Apparently, this is not only device-specific but X-server specific as
the following network experiment shows:

Run on Linux,   display Linux   OK
Run on Solaris, display Linux   OK
Run on Solaris, display Solaris Error
Run on Linux,   display Solaris Error

So it seems that the Solaris OpenWindows X Server cannot handle
requests for drawing lines through more than 64K points. I suppose we
*could* fix this by splitting all XDrawLines into blocks of max 64K.

The man page for XDrawLines and friends have the following blob:

       All x and y members are signed integers.  The width and
       height members are 16-bit unsigned integers.  You should
       be careful not to generate coordinates and sizes out of
       the 16-bit ranges, because the protocol only has 16-bit
       fields for these values.

The "and sizes" bit might be taken to mean that you should do the
above, although it's beyond me how it would work on any platform if
there's only room for 16 bits in the protocol (perhaps the protocol
has changed from X11R5 to R6?). XDrawLines only occurs twice in
devX11.c, so I suppose it's no big deal to fix up.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Wed Feb 17 15:06:44 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Wed, 17 Feb 1999 16:06:44 +0100
Subject: HREFS for private packages - fixed? (PR#19)
Message-ID: <199902171506.QAA27186@biostat.ku.dk>

Anyone know if this is still with us? -pd

> There is however, a small problem with installing the HTML documention in a
> private (i.e. not RHOME/library) location. The file
> 
>    RHOME/doc/html/packages.html
> 
> linking the main documention to the packages is written (BTW this will
probably
> fail if the package owner and the R owner are not the same) but the links in
it
> are not quite correct. For me the link indicated in that file is
> 
>   <A HREF="../../library/dse/html/00Index.html">
> which would be RHOME/library/dse/html/00Index.html, but it should be
>  <A HREF="{package_location}/dse/html/00Index.html">

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Feb 17 16:01:02 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 17 Feb 1999 11:01:02 -0500
Subject: HREFS for private packages - fixed? (PR#19)
References: <199902171506.QAA27186@biostat.ku.dk>
Message-ID: <99Feb17.111432est.13468@mailgate.bank-banque-canada.ca>

I just checked and it still seems to be a problem in R 0.63.2.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Feb 17 16:19:23 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 17 Feb 1999 17:19:23 +0100 (CET)
Subject: HREFS for private packages - fixed? (PR#19)
In-Reply-To: <199902171506.QAA27186@biostat.ku.dk>
References: <199902171506.QAA27186@biostat.ku.dk>
Message-ID: <14026.60427.68697.231072@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 17 Feb 1999 16:06:44 +0100,
>>>>> Peter Dalgaard (PD) wrote:

PD> Anyone know if this is still with us? -pd
>> There is however, a small problem with installing the HTML documention in a
>> private (i.e. not RHOME/library) location. The file
>> 
>> RHOME/doc/html/packages.html
>> 
>> linking the main documention to the packages is written (BTW this will
PD> probably
>> fail if the package owner and the R owner are not the same) but the links in
PD> it
>> are not quite correct. For me the link indicated in that file is
>> 
>> <A HREF="../../library/dse/html/00Index.html">
>> which would be RHOME/library/dse/html/00Index.html, but it should be
>> <A HREF="{package_location}/dse/html/00Index.html">


It SHOULD contain only functions in RHOME/library, as this file serves
only as a default fallback. The complete list should be built at
runtime (using all in .lib.loc) and this works for me. However, there
is a problem if installing as root (or whoever is allowed to write to
RHOME) to someplace different than RHOME ... I'll dig into that
tomorrow (I've got to leave in 10 minutes).

.f

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Feb 17 17:42:01 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 17 Feb 1999 12:42:01 -0500
Subject: HREFS for private packages - fixed? (PR#19)
References: <199902171506.QAA27186@biostat.ku.dk> <14026.60427.68697.231072@galadriel.ci.tuwien.ac.at>
Message-ID: <99Feb17.125537est.13476@mailgate.bank-banque-canada.ca>

Friedrich

Just to make sure we're taking about the same problem, if I do

R INSTALL               dse

everything works fine (so that is what I've been using) but if I do

R INSTALL           -l rlibs  dse

I get the problem we are discussing. My understanding is that this is suppose to
install in the subdirectory rlib under where I run it, not in RHOME. The code
installs fine like this but the pointer in the HTML gets messed up.

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Wed Feb 17 18:00:13 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Wed, 17 Feb 1999 19:00:13 +0100
Subject: menu buglet (PR#12)
Message-ID: <199902171800.TAA30374@biostat.ku.dk>

Fixed. 

Actually, this one had been sitting around since *blush* August, bug
reproduction 
instructions, detailed patch, and everything.

Oh well, goes to show that an least submissions to r-bugs are never completely
forgotten...
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Feb 18 08:41:59 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 18 Feb 1999 09:41:59 +0100 (CET)
Subject: HREFS for private packages - fixed? (PR#19)
In-Reply-To: <99Feb17.125537est.13476@mailgate.bank-banque-canada.ca>
References: <199902171506.QAA27186@biostat.ku.dk>
 <14026.60427.68697.231072@galadriel.ci.tuwien.ac.at>
 <99Feb17.125537est.13476@mailgate.bank-banque-canada.ca>
Message-ID: <14027.53847.599276.209725@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 17 Feb 1999 12:42:01 -0500,
>>>>> Paul Gilbert (PG) wrote:

PG> Friedrich
PG> Just to make sure we're taking about the same problem, if I do

PG> R INSTALL               dse

PG> everything works fine (so that is what I've been using) but if I do

PG> R INSTALL           -l rlibs  dse

PG> I get the problem we are discussing. My understanding is that this is suppose to
PG> install in the subdirectory rlib under where I run it, not in RHOME. The code
PG> installs fine like this but the pointer in the HTML gets messed up.


Yes, that's exactly what I was meaning. IMO, only

	R INSTALL dse

should change the global packages file, because only the we have
guarantee that a user can actually access the installed packages
(anything installed somewhere else might belong to somebody different
etc.).

So

	R INSTALL -l rlibs  dse

shouldn't modify the global packages file, as a new one conforming to
the current .lib.loc get's built anyway when running help.start().

Any objections if I commit that change?

.f
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Feb 18 10:39:47 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 18 Feb 1999 11:39:47 +0100 (CET)
Subject: HREFS for private packages - fixed? (PR#19)
In-Reply-To: <14027.53847.599276.209725@galadriel.ci.tuwien.ac.at>
References: <199902171506.QAA27186@biostat.ku.dk>
 <14026.60427.68697.231072@galadriel.ci.tuwien.ac.at>
 <99Feb17.125537est.13476@mailgate.bank-banque-canada.ca>
 <14027.53847.599276.209725@galadriel.ci.tuwien.ac.at>
Message-ID: <14027.60915.528270.991492@galadriel.ci.tuwien.ac.at>


I committed the bug fixes.

.f


>>>>> On Thu, 18 Feb 1999 09:41:59 +0100 (CET),
>>>>> Friedrich Leisch (FL) wrote:

>>>>> On Wed, 17 Feb 1999 12:42:01 -0500,
>>>>> Paul Gilbert (PG) wrote:

PG> Friedrich
PG> Just to make sure we're taking about the same problem, if I do

PG> R INSTALL               dse

PG> everything works fine (so that is what I've been using) but if I do

PG> R INSTALL           -l rlibs  dse

PG> I get the problem we are discussing. My understanding is that this is suppose to
PG> install in the subdirectory rlib under where I run it, not in RHOME. The code
PG> installs fine like this but the pointer in the HTML gets messed up.


FL> Yes, that's exactly what I was meaning. IMO, only

FL> 	R INSTALL dse

FL> should change the global packages file, because only the we have
FL> guarantee that a user can actually access the installed packages
FL> (anything installed somewhere else might belong to somebody different
FL> etc.).

FL> So

FL> 	R INSTALL -l rlibs  dse

FL> shouldn't modify the global packages file, as a new one conforming to
FL> the current .lib.loc get's built anyway when running help.start().

FL> Any objections if I commit that change?




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@biostat.ku.dk  Thu Feb 18 14:47:27 1999
From: pd@biostat.ku.dk (pd@biostat.ku.dk)
Date: Thu, 18 Feb 1999 15:47:27 +0100
Subject: model.frame mangles time series (PR#121)
Message-ID: <199902181447.PAA11889@biostat.ku.dk>

This one showed up while looking at one of Ripley's other reports:

> data(freeny)
> model.frame(y~1,data=freeny,subset=1:10)
              y
1962.25 8.79236
1962.5  8.79137
1962.75 8.81486
1963    8.81301
1963.25 8.90751
1963.5  8.93673
1963.75 8.96161
1964    8.96044
1964.25 9.00868
1964.5  9.03049
> model.frame(y~1,data=freeny,subset=1:10)$y
Warning: Replacement length not a multiple of the elements to replace in matrix(...) 
Error: length of dimnames[1] not equal to array extent
> model.frame(y~1,data=freeny[1:10,])$y
         Qtr1    Qtr2    Qtr3    Qtr4
1962:      NA 8.79236 8.79137 8.81486
1963: 8.81301 8.90751 8.93673 8.96161
1964: 8.96044 9.00868 9.03049      NA
> dput(model.frame(y~1,data=freeny,subset=1:10)$y)
structure(c(8.79236, 8.79137, 8.81486, 8.81301, 8.90751, 8.93673, 
8.96161, 8.96044, 9.00868, 9.03049), .Tsp = c(1962.25, 1971.75, 
4), class = "ts")

The upshot of this is that glm(...,subset=...) fails on the freeny data.

The cause is seen by 

> model.frame(y~1,data=freeny[1:10,])$y
         Qtr1    Qtr2    Qtr3    Qtr4
1962:      NA 8.79236 8.79137 8.81486
1963: 8.81301 8.90751 8.93673 8.96161
1964: 8.96044 9.00868 9.03049      NA
> dput(model.frame(y~1,data=freeny,subset=1:10)$y)
structure(c(8.79236, 8.79137, 8.81486, 8.81301, 8.90751, 8.93673, 
8.96161, 8.96044, 9.00868, 9.03049), .Tsp = c(1962.25, 1971.75, 
4), class = "ts")

Notice that the .Tsp attribute doesn't reflect the shorter time series
(1971.75 should be 1964.5).

--please do not edit the information below--

Version:
 platform = i586-unknown-linux
 arch = i586
 os = linux
 system = i586, linux
 status = in progress
 status.rev = 0
 major = 0
 minor = 63.3
 year = 1999
 month = February
 day = 19
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Feb 18 16:24:37 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 18 Feb 1999 08:24:37 -0800 (PST)
Subject: model.frame mangles time series (PR#121)
In-Reply-To: <199902181447.PAA11889@biostat.ku.dk>
Message-ID: <Pine.GSO.4.10.9902180818370.2878-100000@wompom.biostat.washington.edu>

On Thu, 18 Feb 1999 pd@biostat.ku.dk wrote:

> This one showed up while looking at one of Ripley's other reports:

> The upshot of this is that glm(...,subset=...) fails on the freeny data.
> 
> The cause is seen by 
> 
> > model.frame(y~1,data=freeny[1:10,])$y
>          Qtr1    Qtr2    Qtr3    Qtr4
> 1962:      NA 8.79236 8.79137 8.81486
> 1963: 8.81301 8.90751 8.93673 8.96161
> 1964: 8.96044 9.00868 9.03049      NA
> > dput(model.frame(y~1,data=freeny,subset=1:10)$y)
> structure(c(8.79236, 8.79137, 8.81486, 8.81301, 8.90751, 8.93673, 
> 8.96161, 8.96044, 9.00868, 9.03049), .Tsp = c(1962.25, 1971.75, 
> 4), class = "ts")
> 
> Notice that the .Tsp attribute doesn't reflect the shorter time series
> (1971.75 should be 1964.5).


This is the attributes/subsetting problem rearing its ugly head again.
model.frame(,subset) has to copy *some* attributes over (eg contrasts) and
can't copy *all* of them (eg dim).

Currently we use copyMostAttributes to drop the dangerous ones. It
clearly didn't know about tsp. 

Questions:
(1) How do we know which attributes to copy?
(2) For an unknown attribute what should the default be?
(3) Is there just one set of attributes that needs special treatment (in
which case copyMostAttributes is broken) or are there different sets in
different circumstances (in which case we need a new function)?
(4) Could we just handle this by having the subset operator retain
attributes?

	-thomas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 18 16:51:01 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Feb 1999 17:51:01 +0100
Subject: model.frame mangles time series (PR#121)
In-Reply-To: Thomas Lumley's message of Thu, 18 Feb 1999 08:24:37 -0800 (PST)
References: <Pine.GSO.4.10.9902180818370.2878-100000@wompom.biostat.washington.edu>
Message-ID: <x2678zlkp6.fsf@blueberry.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> This is the attributes/subsetting problem rearing its ugly head again.
> model.frame(,subset) has to copy *some* attributes over (eg contrasts) and
> can't copy *all* of them (eg dim).
> 
> Currently we use copyMostAttributes to drop the dangerous ones. It
> clearly didn't know about tsp. 
> 
> Questions:
> (1) How do we know which attributes to copy?
> (2) For an unknown attribute what should the default be?
> (3) Is there just one set of attributes that needs special treatment (in
> which case copyMostAttributes is broken) or are there different sets in
> different circumstances (in which case we need a new function)?
> (4) Could we just handle this by having the subset operator retain
> attributes?

(5) is there really any reason to do subsetting in the .Internal code?
the hot spot is 

    variables <- eval(attr(formula, "variables"), data, sys.frame(sys.parent()))
    extranames <- as.character(substitute(list(...))[-1])
    extras <- substitute(list(...))
    extras <- eval(extras, data, sys.frame(sys.parent()))
    subset <- eval(substitute(subset), data, sys.frame(sys.parent()))
    data <- .Internal(model.frame(formula, rownames, variables, 
        varnames, extras, extranames, subset, na.action))

but what's keeping us from saying 
    data <- .Internal(model.frame(formula, rownames, variables, 
        varnames, extras, extranames, na.action))[subset,]

or ("Uncle Scrooge" version)

   data <- .Internal(model.frame(formula, rownames, variables[subset,], 
        varnames, extras[subset,], extranames, na.action))

(well, variables and extras are lists, not dataframes, but you get the
picture. Do we allow unequal length variables anyway?)

(6) since [subset,] seems to work, perhaps do_subset is what should be
called from inside do_modelframe?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Feb 18 16:52:15 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 18 Feb 1999 08:52:15 -0800 (PST)
Subject: model.frame mangles time series (PR#121)
In-Reply-To: <x2678zlkp6.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.10.9902180851110.2878-100000@wompom.biostat.washington.edu>

On 18 Feb 1999, Peter Dalgaard BSA wrote:

> 
> (6) since [subset,] seems to work, perhaps do_subset is what should be
> called from inside do_modelframe?

No, subset doesn't work -- it loses contrasts

R>  contrasts(df$x)
  [,1] [,2]
1    1    0
2    0    1
3   -1   -1
R> contrasts(df[1:5,]$x)
  2 3
1 0 0
2 1 0
3 0 1
 
	-thomas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From D.A.Wooff@durham.ac.uk  Thu Feb 18 17:09:33 1999
From: D.A.Wooff@durham.ac.uk (D.A.Wooff@durham.ac.uk)
Date: Thu, 18 Feb 1999 18:09:33 +0100
Subject: [R] possible bug in loglm (PR#122)
Message-ID: <199902181709.SAA12157@biostat.ku.dk>

Bug report: there is a problem with loglm (or some underlying code)
when used with updating within a function. For example, this code
works as expected, when used outside a function:


-------------------------------------------------
library(MASS)
cts<-c(25,13,99,45,128,78,151,153,173,171,49,62,1308,236,989,264,622,201,492,244,382,237,122,102,39,5,67,28,53,29,27,20,18,17,1,2,41,11,54,44,64,76,102,83,104,160,41,54,1232,321,1015,348,755,328,530,395,414,370,160,147,25,11,48,20,29,23,20,16,14,11,1,3)

foo<-cbind(expand.grid(f1=factor(c("A","B")),f2=factor(11:16),f3=factor(c("S","N","E")),f4=factor(c("F","M"))),cts=cts)

d0<-loglm(cts~f1+f2+f3+f4,data=foo)
d1<-update(d0,.~.^2)
-------------------------------------------------


but, unless d0 is visible outside the function, 
the same code does not work as expected when within a function:

-------------------------------------------------
rm(list=ls())
library(MASS)

tester<-function(){

cts<-c(25,13,99,45,128,78,151,153,173,171,49,62,1308,236,989,264,622,201,492,244,382,237,122,102,39,5,67,28,53,29,27,20,18,17,1,2,41,11,54,44,64,76,102,83,104,160,41,54,1232,321,1015,348,755,328,530,395,414,370,160,147,25,11,48,20,29,23,20,16,14,11,1,3)

foo<-cbind(expand.grid(f1=factor(c("A","B")),f2=factor(11:16),f3=factor(c("S","N","E")),f4=factor(c("F","M"))),cts=cts)

d0<-loglm(cts~f1+f2+f3+f4,data=foo)
d1<-update(d0,.~.^2)
}

tester()
-------------------------------------------------

results in the message:

Error: Object "foo" not found




David.

---------------------------------------------------------------------
  David Wooff, Director, Statistics and Mathematics Consultancy Unit,
  Department of Mathematical Sciences, University of Durham.
  Science Laboratories, South Road, Durham, DH1 3LE, UK.
  Tel. 0191 374 4531, Fax 0191 374 7388.
---------------------------------------------------------------------
  


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 18 17:27:11 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Feb 1999 18:27:11 +0100
Subject: model.frame mangles time series (PR#121)
In-Reply-To: Thomas Lumley's message of Thu, 18 Feb 1999 08:52:15 -0800 (PST)
References: <Pine.GSO.4.10.9902180851110.2878-100000@wompom.biostat.washington.edu>
Message-ID: <x23e43lj0w.fsf@blueberry.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> On 18 Feb 1999, Peter Dalgaard BSA wrote:
> 
> > 
> > (6) since [subset,] seems to work, perhaps do_subset is what should be
> > called from inside do_modelframe?
> 
> No, subset doesn't work -- it loses contrasts
> 
> R>  contrasts(df$x)
>   [,1] [,2]
> 1    1    0
> 2    0    1
> 3   -1   -1
> R> contrasts(df[1:5,]$x)
>   2 3
> 1 0 0
> 2 1 0
> 3 0 1

That can be fixed by a one-line change to [.factor :

> contrasts(df[1:3,]$x)
          .L   .Q         .C
1 -0.6708204  0.5 -0.2236068
2 -0.2236068 -0.5  0.6708204
3  0.2236068 -0.5 -0.6708204
4  0.6708204  0.5  0.2236068

I suspect that is the correct solution.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From venkat@biosta.mskcc.org  Thu Feb 18 18:08:28 1999
From: venkat@biosta.mskcc.org (venkat@biosta.mskcc.org)
Date: Thu, 18 Feb 1999 19:08:28 +0100
Subject: Text in plot (PR#123)
Message-ID: <199902181808.TAA12266@biostat.ku.dk>

I am trying to place a multi-line text in a plot.  R-0.63.2 on Linux however
writes only the first line.  Is this a known bug?  Example is given below.

R : Copyright 1999, The R Development Core Team
Version 0.63.2  (January 12, 1999)

> x11()
> plot(0,0)
> text(0,-0.5,"test \n line2")

Thanks,
Venkat
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-help mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-help-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Thu Feb 18 18:06:52 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Thu, 18 Feb 1999 18:06:52 +0000 (GMT)
Subject: [R] possible bug in loglm (PR#122)
Message-ID: <199902181806.SAA28066@toucan.stats.ox.ac.uk>


> From: D.A.Wooff@durham.ac.uk
> Date: Thu, 18 Feb 1999 18:09:33 +0100
> To: r-devel@stat.math.ethz.ch
> Subject: [R] possible bug in loglm (PR#122)
> CC: R-bugs@biostat.ku.dk
> X-Loop: R-bugs@biostat.ku.dk
> 
> Bug report: there is a problem with loglm (or some underlying code)
> when used with updating within a function. For example, this code
> works as expected, when used outside a function:

Well, loglm is not part of R per se, so I was a little surprised to see
this going to R-bugs. The answer is along the lines of `yes, we know,
this is part of the limitations of update and NextMethod', and this occurs
in S-PLUS too, and for lots of other applications of update. You could
alter update.loglm to be

update.loglm <- function (object, formula., ...) 
{
    setdiff <- function(x, y) if (length(x) == 0 || length(y) == 0) x
    else x[match(x, y, 0) == 0]
    if (is.null(call <- object$call)) 
        stop("object has no call component.  Updating not possible")
    if (fix <- !missing(formula.)) {
        object$formula <- denumerate(object$formula)
        formula. <- denumerate(formula.)
        call$formula <- update.formula(formula(object), formula.)
    }
    extras <- match.call(expand.dots = FALSE)$...
    if (length(extras) > 0) {
        existing <- !is.na(match(names(extras), names(call)))
        ## do these individually to allow NULL to remove entries.
        for (a in names(extras)[existing]) call[[a]] <- extras[[a]]
        if (any(!existing)) {
            call <- c(as.list(call), extras[!existing])
            call <- as.call(call)
        }
    }
    result <- eval(call, sys.frame(sys.parent()))
    if (fix) {
        form <- renumerate(result$formula)
        result$call$formula <- unclass(result$formula <- form)
    }
    result
}

that is to remove the NextMethod call.  But this sort of thing is quite
common, and the usual workaround is to make sure that the dataframe is visible.



-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 18 18:14:03 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Feb 1999 19:14:03 +0100
Subject: model.frame mangles time series (PR#121)
In-Reply-To: Peter Dalgaard BSA's message of 18 Feb 1999 18:27:11 +0100
References: <Pine.GSO.4.10.9902180851110.2878-100000@wompom.biostat.washington.edu> <x23e43lj0w.fsf@blueberry.kubism.ku.dk>
Message-ID: <x2zp6bk2ac.fsf@blueberry.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> That can be fixed by a one-line change to [.factor :
> 
> > contrasts(df[1:3,]$x)
>           .L   .Q         .C
> 1 -0.6708204  0.5 -0.2236068
> 2 -0.2236068 -0.5  0.6708204
> 3  0.2236068 -0.5 -0.6708204
> 4  0.6708204  0.5  0.2236068
> 
> I suspect that is the correct solution.

A quick check shows that S does the same, ergo: change committed.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jlindsey@alpha.luc.ac.be  Thu Feb 18 18:52:28 1999
From: jlindsey@alpha.luc.ac.be (jlindsey@alpha.luc.ac.be)
Date: Thu, 18 Feb 1999 19:52:28 +0100
Subject: library help (PR#87)
Message-ID: <199902181852.TAA13340@biostat.ku.dk>

Testing

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 18 18:57:00 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Feb 1999 19:57:00 +0100
Subject: library help (PR#87)
In-Reply-To: jlindsey@alpha.luc.ac.be's message of Thu, 18 Feb 1999 19:52:28 +0100
References: <199902181852.TAA13340@biostat.ku.dk>
Message-ID: <x2vhgzk0ar.fsf@blueberry.kubism.ku.dk>

jlindsey@alpha.luc.ac.be writes:

> Testing

OK, seems that I've finally squashed an embarassing bug I introduced in
JitterBug... 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Feb 18 22:17:19 1999
From: pgilbert@bank-banque-canada.ca (pgilbert@bank-banque-canada.ca)
Date: Thu, 18 Feb 1999 23:17:19 +0100
Subject: function.html gets clobbered (PR#18)
Message-ID: <199902182217.XAA13651@biostat.ku.dk>

>The changes I committed related to packages.html should also fix this
>problem ... please try.

Freidrich

I grabbed R-devel.tar.gz from fangorn.ci.tuwien.ac.at  at about 9pm GMT Thur.
Feb 18. It does not seem to have the problem fixed, but I'm not sure if that was
the version I was suppose to try.

I won't be at work tomorrow. I can try again Monday.

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Feb 20 16:31:21 1999
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 20 Feb 1999 16:31:21 +0000 (GMT)
Subject: Port of sm library, installing library components
Message-ID: <Pine.GSO.4.05.9902201610280.4961-100000@toucan.stats>

I have an almost complete port of the sm library/package (only things
depending on gam are not operational) at

http://www.stats.ox.ac.uk/pub/R/sm_1.0-1.tar.gz

Before I send it to CRAN, I would appreciate some help in checking that
you can install it. The problem is that the Fortran it uses on Solaris
calls a routine in a Fortran library not linked into R. I have a Makefile
(supplied but not the default) that works on Solaris, and I have no
problem with g77 on any of the platforms I have (Solarises, RH5.2-i586,
win32). If people who use a Fortran compiler other that g77 could try this
and let me know what is needed it would help me write more comprehensive
instructions.  Beware of lazy binding: the file Install tells you how to
run a test of the problematical routine.

Incidentally, the sm package includes a large number of S scripts that
need to be installed. I have cheated by putting these in the exec
sub-directory, but there appears to be no mechanism (except on Windows) to
use R INSTALL to install components other than R code, C/Fortran, exec
scripts and help. Should we have one? E.g.

cp -r packagesrc/install_extras/*  Rlibrary/packagename/

One advantage would be to make it easy for package packagers to specify
what they wanted to be distributed in all binary distributions. (I would
like to see the DESCRIPTION file installed so the version information is
always there, and in some packages, including sm, there is a Licence
file.)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From John.Peters@tip.csiro.au  Sun Feb 21 23:12:12 1999
From: John.Peters@tip.csiro.au (John.Peters@tip.csiro.au)
Date: Mon, 22 Feb 1999 00:12:12 +0100
Subject: scan rejects complex (PR#125)
Message-ID: <199902212312.AAA19317@biostat.ku.dk>


"Scan" does not currently accept mode "complex".  (Splus3.4 does).
The help file does not make plain the intention.
Version is 0.632.

#----------------------------------------
xx_1+2i
cat(xx,file="testfile1")

yy_scan("testfile1",what=complex()) 

print(yy)
print(mode(yy))

# Says: Error: "scan" invalid "what=" specified
# yy_as.complex(scan("testfile1",what=character())) # workaround
#----------------------------------------

Many thanks.

----------------------------------------------------------------------------
John Peters
CSIRO National Measurement Laboratory
PO Box 218                                Phone:    +61 2 9413 7503
Lindfield NSW 2070                        Fax:      +61 2 9413 7202
Australia                                 Internet: John.Peters@tip.CSIRO.AU
----------------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Mon Feb 22 09:03:42 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Mon, 22 Feb 1999 10:03:42 +0100 (CET)
Subject: Port of sm library, installing library components
In-Reply-To: <Pine.GSO.4.05.9902201610280.4961-100000@toucan.stats>
References: <Pine.GSO.4.05.9902201610280.4961-100000@toucan.stats>
Message-ID: <14033.7534.629426.653899@galadriel.ci.tuwien.ac.at>

>>>>> On Sat, 20 Feb 1999 16:31:21 +0000 (GMT),
>>>>> Prof Brian Ripley (PBR) wrote:


PBR> (I would
PBR> like to see the DESCRIPTION file installed so the version information is
PBR> always there,

good idea, committed the change.


.f



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Mon Feb 22 16:29:14 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Mon, 22 Feb 1999 17:29:14 +0100 (CET)
Subject: "as" functions should be generic
Message-ID: <XFMail.990222172914.plummer@iarc.fr>

It would be very useful if all "as.*" functions were generic,
so that a user who creates a new class can write methods to
coerce objects of that class to standard R objects.

In fact, most of the "as.*" functions are generic, but there
are a few that aren't:
as.array
as.factor
as.ordered
as.pairlist
as.formula
as.ts

It's actually "as.array" and "as.ts" that are a problem for
me, but I mention the others because this seems like a good
general principle.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Feb 23 07:50:29 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 23 Feb 1999 08:50:29 +0100 (CET)
Subject: "as" functions should be generic
In-Reply-To: <XFMail.990222172914.plummer@iarc.fr>
References: <XFMail.990222172914.plummer@iarc.fr>
Message-ID: <14034.24005.535659.918027@pc87.maho.magnaeu.com>

>>>>> Martyn Plummer writes:

> It would be very useful if all "as.*" functions were generic,
> so that a user who creates a new class can write methods to
> coerce objects of that class to standard R objects.

> In fact, most of the "as.*" functions are generic, but there
> are a few that aren't:
> as.array
> as.factor
> as.ordered
> as.pairlist
> as.formula
> as.ts

> It's actually "as.array" and "as.ts" that are a problem for
> me, but I mention the others because this seems like a good
> general principle.

This may be a good idea.

-k

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From khal@alumni.uv.es  Wed Feb 24 20:54:47 1999
From: khal@alumni.uv.es (Kjetil Halvorsen)
Date: Wed, 24 Feb 1999 21:54:47 +0100
Subject: An idea for something better than read.table
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk>
Message-ID: <36D46716.4819BF52@alumni.uv.es>

It is nice if data files can have formats not to heavily
dependent on the package.  What I do to read in data is
having data (whith header) in, say, data.dat, and then data.R
with the commands for defining factors, levels, contrast or
whatever. That seems cleaner than mixing in one file data and
definitions.

Kjetil Halvorsen


Peter Dalgaard BSA wrote:
> 
> I was recently converting some datasets for use in an R package and it
> occurred to me that there really is no "neat" way to input a data
> frame if it is to contain factor variables.
> 
> One can use dput()/source or dump() after massaging data into the
> right format, of course, but there isn't really anything which allows
> you to store the input instructions with the data beyond the simple
> header=T type format.
> 
> So I thought of ways to enhance the header. The best idea I've been
> able to come up with this far is to
> 
> (a) Write a function - basically an extension of scan() - which allows
>     you to specify the column data type in more detail. Let's call it
>     data.file() for now. It would pretty much have to deparse all of
>     its arguments and interpret things in slightly unusual ways, but R
>     can do that, and some of functions (notably help() and data())
>     already play this kind of game with the parser...
> 
> (b) Have a function, say read(), which parses the 1st expression in a
>     file and executes it *with the remainder of the file as the
>     argument*. (Currently, this is impossible, but it would be if
>     one just kept track of the line number while parsing. parse()
>     could stick it on as an attribute of the parsed expression list if
>     asked to do so.)
> 
> This would make a file format something like the following possible.
> 
> [There's another loose idea in there involving a control item to handle
> separators, na.strings, etc. - the intention being that read() plugs
> in the file= and skip= arguments for the actual call.]
> 
> Would this be an approach worth pursuing?
> 
> --- Top of file ---
> data.file(control(sep="w",na="."),
>         Item = factor(levels=1:4,labels=c("A","B","C","D")),
>         Size = numeric(),
>         Year = factor(levels=1980:1985)
> )
> 1       0     1980
> 1       10    1981
> 1       14    1982
> 1       20    1983
> 1       25    1984
> 1       30    1985
> 2       0     1980
> 2       5     1981
> 2       6     1982
> 2       8     1984
> 3       0     1984
> 3       2     1985
> 4       0     1980
> 4       20    1981
> 4       30    1982
> 4       30    1984
> 4       35    1985
> --- End of file ---
> 
> --
>    O__  ---- Peter Dalgaard             Blegdamsvej 3
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@hal.stat.unipd.it (Guido Masarotto)  Wed Feb 24 22:26:11 1999
From: guido@hal.stat.unipd.it (Guido Masarotto) (Guido Masarotto)
Date: Wed, 24 Feb 1999 23:26:11 +0100
Subject: [R] rw0632 makes stray .Rhistory orphans
In-Reply-To: <36D4644A.2C61BFC9@alumni.uv.es>; from Kjetil Halvorsen on Wed, Feb 24, 1999 at 09:42:50PM +0100
References: <000001be5f1c$ef0b70e0$6f1abb81@fenris> <19990223134026.06314@hal.stat.unipd.it> <36D4644A.2C61BFC9@alumni.uv.es>
Message-ID: <19990224232611.16861@hal.stat.unipd.it>

On Wed, Feb 24, 1999 at 09:42:50PM +0100, Kjetil Halvorsen wrote:
> Opened the tema, another small mal-function which could be easily
> repaired:  When sourcing a file from the menu, the working directory
> (HOME?) changes to the files directory, then leaving R the Rdata
> gets saved in the wrong place! I feel that sourcing shouldnt change
> HOME, it surprised me more than once.
> 
  K.,
  I think you are perfectly right.
  Any opinion by others before I change the source?
  And, what about loading and saving the workspaces?
  I haven't checked but since code is essentialy the same
  I suppose behaviour is the same  and, hence, it must be
  changed too.

  g. 
  
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Feb 25 17:06:05 1999
From: thomas@biostat.washington.edu (thomas@biostat.washington.edu)
Date: Thu, 25 Feb 1999 18:06:05 +0100
Subject: locator() and log axes (PR#126)
Message-ID: <199902251706.SAA30920@biostat.ku.dk>

In both the versions of 0.63.3 I have compiled locator() gives silly
results for log axes eg

> plot(1:10,log="x")
> locator(1) #click on the point at (4,4)
$x
[1] 9694.383

$y
[1] 4.034130

It appears that the x coordinate is 10^right number -- it's getting
unlogged twice
	

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = in progress
 status.rev = 0
 major = 0
 minor = 63.3
 year = 1999
 month = February
 day = 24
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 25 17:28:10 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 25 Feb 1999 18:28:10 +0100
Subject: locator() and log axes (PR#126)
In-Reply-To: thomas@biostat.washington.edu's message of Thu, 25 Feb 1999 18:06:05 +0100
References: <199902251706.SAA30920@biostat.ku.dk>
Message-ID: <x2678q2y1h.fsf@blueberry.kubism.ku.dk>

thomas@biostat.washington.edu writes:

> In both the versions of 0.63.3 I have compiled locator() gives silly
> results for log axes eg
> 
> > plot(1:10,log="x")
> > locator(1) #click on the point at (4,4)
> $x
> [1] 9694.383
> 
> $y
> [1] 4.034130
> 
> It appears that the x coordinate is 10^right number -- it's getting
> unlogged twice

Exactly. Fixed for 0.63.3.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Feb 26 11:22:27 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 26 Feb 1999 12:22:27 +0100
Subject: An idea for something better than read.table
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk> <36D46716.4819BF52@alumni.uv.es>
Message-ID: <36D683F3.E0B49464@iarc.fr>

Kjetil Halvorsen wrote:
> 
> It is nice if data files can have formats not to heavily
> dependent on the package.  What I do to read in data is
> having data (whith header) in, say, data.dat, and then data.R
> with the commands for defining factors, levels, contrast or
> whatever. That seems cleaner than mixing in one file data and
> definitions.
> 

If you want a file format for R datasets which describe their
own metadata, it might be worth thinking about defining it in
XML.

This probably goes a long way beyong Peter's suggestion, but
presumably it could be done in the same way, by adding a header
to the top of a data file. It does leave open the possibility
that other statistical packages will be able to read the data
and extract any meta data (storage type, variable labels, value
labels, ...) they want to use.

I have been thinking for a long time that it would be nice if
statistical packages could exchange datasets using a common
file format and (unless I have drastically misunderstood) XML
seems the way to go.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rossini@biostat.washington.edu  Fri Feb 26 14:15:17 1999
From: rossini@biostat.washington.edu (A.J. Rossini)
Date: 26 Feb 1999 06:15:17 -0800
Subject: An idea for something better than read.table
In-Reply-To: Martyn Plummer's message of "Fri, 26 Feb 1999 12:22:27 +0100"
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk> <36D46716.4819BF52@alumni.uv.es> <36D683F3.E0B49464@iarc.fr>
Message-ID: <877lt5dzey.fsf@alpha.cfas.washington.edu>


>>>>> "MP" == Martyn Plummer <plummer@iarc.fr> writes:

    MP> If you want a file format for R datasets which describe their
    MP> own metadata, it might be worth thinking about defining it in
    MP> XML.

Maybe...

    MP> This probably goes a long way beyong Peter's suggestion, but
    MP> presumably it could be done in the same way, by adding a
    MP> header to the top of a data file. It does leave open the
    MP> possibility that other statistical packages will be able to
    MP> read the data and extract any meta data (storage type,
    MP> variable labels, value labels, ...) they want to use.

The only caveat is that your data set looks like an HTML(SGML) file.
However, there are parsers for nearly any language (well, Java, C++,
C, PERL, and Python come to mind), which are nicely licensed.

Writing out the XML DTD for statistical datasets (and for
communicating the need for procedures of a certain type on those
datasets) has been simmering in the back of my mind for a while, now.
I'd be interested in hearing from anyone else who has been playing
with XML for passing data (my application is for inter-stat package
communication, but might not be bad for with-in package communication,
but it needs a bit more exploration).

It would also lead to WWW-friendly processing :-).

best,
-tony

-- 
A.J. Rossini
UW Biostatistics & Center for AIDS Research 
206-543-1044 / 206-720-4282                 
rossini@biostat.washington.edu              
http://www.biostat.washington.edu/~rossini/ 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rcreecy@census.gov  Fri Feb 26 17:08:46 1999
From: rcreecy@census.gov (Rob Creecy)
Date: Fri, 26 Feb 1999 12:08:46 -0500
Subject: XML for Data
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk> <36D46716.4819BF52@alumni.uv.es> <36D683F3.E0B49464@iarc.fr> <877lt5dzey.fsf@alpha.cfas.washington.edu>
Message-ID: <36D6D51E.6AF2410D@census.gov>

A.J. Rossini wrote:
> 

> I'd be interested in hearing from anyone else who has been playing
> with XML for passing data (my application is for inter-stat package
> communication, but might not be bad for with-in package communication,
> but it needs a bit more exploration).
> 
> It would also lead to WWW-friendly processing :-).
>

I got some of the following information from Dan Gillman at the
Census Bureau that is related. As you might imagine, we are very
interested in any technology that might help in the exchange of
data between statistical packages, the publishing of data on the WWW,
and making data more useful to a wider audience.
 
The Data Documentation Initiative sponsored by ICPSR (Univ of Mich) 
is a statistical data set documentation standard written as an XML DTD.  
Marty Appel and Dan Gillman here at the Census Bureau are on the
committee
that is developing the work.  There is a web site at
http://www.icpsr.umich.edu/DDI.

Unisys has software for converting a UML model to an XML DTD through the
use of XML.

The San Diego Supercomputer Center (SDSC) has  a variety of projects
related to 
describing data with XML. See http://www.npaci.edu/DICE/MIX/index.html 

Rob Creecy
Statistical Research Division
U.S. Bureau of the Census
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From naras@stat.Stanford.EDU  Fri Feb 26 22:34:04 1999
From: naras@stat.Stanford.EDU (Balasubramanian Narasimhan)
Date: Fri, 26 Feb 1999 14:34:04 -0800 (PST)
Subject: XML for Data
In-Reply-To: Your message of "Fri, 26 Feb 1999 12:08:46 -0500"
 <36D6D51E.6AF2410D@census.gov>
References: <36D6D51E.6AF2410D@census.gov>
Message-ID: <19990226143404V.naras@stat.Stanford.EDU>


Sometime ago, I  created a DTD for the Omega  project as an experiment
and was able to  parse it and convert it to a  DOM as was needed using
some freely available IBM tools. 

However, it was quite experimental and the design clearly reflected my
own frustrations  with dealing  with Intro Stat  text books  data. Time
constraints prevented me from really using it in Fall 1998, especially
because software was not readily available as it is now.

The combination of  XML and Java is especially  seamless. IBM, Sun all
provide automatic tools for creating DOMs. 

The DDI  project sounds  interesting and I  think input from  us would
really be nice. 

________________________________________________________________
B. Narasimhan                            naras@stat.stanford.edu
                             http://www-stat.stanford.edu/~naras





-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jmhughes@globalnet.co.uk  Sat Feb 27 20:32:59 1999
From: jmhughes@globalnet.co.uk (jmhughes@globalnet.co.uk)
Date: Sat, 27 Feb 1999 21:32:59 +0100
Subject: history (PR#127)
Message-ID: <199902272032.VAA04276@biostat.ku.dk>

Full_Name: john hughes
Version: 0.63
OS: Linux 4.2
Submission from: 195.147.221.243 (195.147.221.243)


Unable to get previous commands(history)using the cursor key. Cursor UP Arrow
Key produces '[A' or something similar backspace produces '[B'. No .Rprofile or
.B file created on installation.  I've tried creating them but couldn't find out
what commands to put in to get previous commands recalled. This didn't happen
with version 0.43 under Linux 4.1. 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Feb 28 00:08:12 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Feb 1999 01:08:12 +0100
Subject: history (PR#127)
In-Reply-To: jmhughes@globalnet.co.uk's message of Sat, 27 Feb 1999 21:32:59 +0100
References: <199902272032.VAA04276@biostat.ku.dk>
Message-ID: <x2btifcrv7.fsf@blueberry.kubism.ku.dk>

jmhughes@globalnet.co.uk writes:

> Full_Name: john hughes
> Version: 0.63
> OS: Linux 4.2
> Submission from: 195.147.221.243 (195.147.221.243)
> 
> 
> Unable to get previous commands(history)using the cursor key. Cursor UP Arrow
> Key produces '[A' or something similar backspace produces '[B'. No .Rprofile or
> .B file created on installation.  I've tried creating them but couldn't find out
> what commands to put in to get previous commands recalled. This didn't happen
> with version 0.43 under Linux 4.1. 

You may need a newer version of the readline library. Current versions
of R needs readline-2.1 or better.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Feb 28 08:57:50 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sun, 28 Feb 1999 09:57:50 +0100
Subject: Formatting in formatC and format (PR#129)
Message-ID: <199902280857.JAA04735@biostat.ku.dk>

[This turned into a bug report which will go to r-devel, so I have taken it
off r-help.]

Bugs reported here:

(1) formatC's help page need some clarification.

(2) formatC needs to treat modes "double" and "real" as equivalent.

(3) format's help page or (preferably) format needs correction re the
meaning of `digits'


On Sun, 28 Feb 1999, Martin Maechler wrote:

> >>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

`should not 5.96 print as 6.0 with 2 dignificant digits?'

>     BDR> S-PLUS has an option nsmall to format to do precisely this, and
>     BDR> there was a question asking how to do it on s-news today.  I have
>     BDR> thought for a while that we need to implement something like this
>     BDR> in R: maybe I had better do it....
> 
> Is it necessary?

Yes, as I want to do things that C's printf does not do, AFAIK.

> In R, we've always been having   formatC(.) as an alternative to format(.)
> allowing more precise formatting specifications.
> However, maybe I didn't understand what yuo were alluding to..

I find formatC useful (if hard to understand) but it does not in my hands
do what I want. I don't think formatC's help page defines precisely what it
does. In particular, it does not say what format=NULL, the default, does.  
So if I try

formatC(6.0, digits=1)
[1] " 6"

I do not get what I expected. It looks as if I need

formatC(6.0, digits=1, format="f")
[1] "6.0"

My guess is that the default is "g" for doubles. (I also find that what 
happens when I give format="g" for an integer and or give the `wrong' mode
is not defined or even inconsistent:

> formatC(as.integer(12345678), mode="real")
Error: `type' must be "real" for this format
> formatC(as.integer(12345678), mode="double")
[1] "1.235e+07"
> formatC(as.integer(12345678), mode="double", format="d")
[1] "12345678"

What are the rules here?)

The help page for formatC references the pre-ANSI C 2nd edition of
Kernighan & Ritchie, but I think the ANSI standard is that same. There is a
reference to leading zeroes, none to trailing zeroes. I believe printf can
be system-dependent (and some of it certainly is: win32 libraries use
n.ddde+nnn and Solaris ones use n.ddde+nn not n.dddenn as your help page
says).  I think, pessimistically, that it is not safe to rely on how the C
runtime library does this.


BTW, there is a trick here:

format(c(5.9, 6.0), digits=2)[-1]
[1] "6.0"

does what Dr Carsten wanted (but see later for the meaning of digits=2).


In any case, 

formatC(6.01, digits=1, format="f")
[1] "6.0"

is not what I am looking for, but (from S-PLUS)

> format(6.0, nsmall=1)
[1] "6.0"
> format(6.01, nsmall=1)
[1] "6.01"


Here is something else I find useful, and I think R is not as documented:
In S-PLUS I get (by default) alignment on the (implied) decimal point:

> format(c(6.11, 13.1), digits=2)
[1] " 6.1" "13  "

whereas in R

> format(c(6.11, 13.1), digits=2)
[1] " 6.1" "13.1"

Now R says (?format)

  digits: how many significant digits are to be used for `numeric x'.

but that is not what happens.  And I can't see how to do this in formatC:

> formatC(c(6.11, 13.1), digits=2, format="fg")
[1] "6.1" " 13"

as the alignment is wrong.  I think in print/format, digits=2 means that
data are rounded so that the smallest (in magnitude) number has two
significant digits, and then the result is converted dropping trailing
zeroes, as in

> format(c(6.0, 13.1), digits=2)
[1] " 6" "13"

(That is what S-PLUS gives too, aargh.)


Another, minor, point: format is generic and can be applied to lists,
for example, whereas formatC cannot.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Feb 28 20:45:45 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Sun, 28 Feb 1999 21:45:45 +0100
Subject: lty=0 -- shouldn't it give an invisible line? (PR#130)
Message-ID: <199902282045.VAA04952@biostat.ku.dk>


Currently, it seems that setting lty=0 gives a solid line in most
contexts (lines(), e.g.) but a strangely dotted-dash line in others
(axis()). This shows up on barplots, and looks fairly odd:

x<-c(a=1,b=2,c=3)
barplot(x)

barplot() is doing an axis(...,lty=0), presumably with the intention
of plotting the labels, but not the actual axis.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ben@eno.Princeton.EDU  Mon Feb  1 16:59:18 1999
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Mon, 1 Feb 1999 11:59:18 -0500 (EST)
Subject: PostScript bugs in R-0.63.1
Message-ID: <Pine.SUN.3.95.990201111153.607A-100000@paca>


  I have a minor problem with the PostScript generated by R-0.63.1.

  Specifically, the files generated *will* work in:

    ghostview
    on an HP LaserJet
    on an Apple LaserWriter

  *will not* work in:

     ghostscript under xdvi
     on a SPARCprinter
 
  The error message on the SPARCprinter was

Error: /invalidfont
Command: 'definefont'
Ostack: /Font5 /Font5 font(Symbol,1)
Estack:
  [and quite a bit more ...]

  This was a picture with no Symbol font involved, so I was able to
comment out the following line:

%/Font5 /Symbol findfont definefont

and then the PostScript worked under xdvi and on the SPARCprinter.

  Any ideas?

  A meta-question: should I submit this to the bug-tracking system 1) in
addition 2) instead of sending to R-devel?  It seems the bug-tracking
system isn't heavily used, and that its value is proportional to how much
it's used (otherwise you just have to search the R-devel and R-help
archives).

  thanks,
    Ben Bolker

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Feb  1 17:26:22 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 01 Feb 1999 18:26:22 +0100
Subject: PostScript bugs in R-0.63.1
In-Reply-To: Ben Bolker's message of Mon, 1 Feb 1999 11:59:18 -0500 (EST)
References: <Pine.SUN.3.95.990201111153.607A-100000@paca>
Message-ID: <x2btjef329.fsf@blueberry.kubism.ku.dk>

Ben Bolker <ben@eno.princeton.edu> writes:

>   A meta-question: should I submit this to the bug-tracking system 1) in
> addition 2) instead of sending to R-devel?  It seems the bug-tracking
> system isn't heavily used, and that its value is proportional to how much
> it's used (otherwise you just have to search the R-devel and R-help
> archives).

Well, the difference between R-bugs and R-devel is that bugs are
remembered if entered into the former. Bugs on the mailing lists tend
to get "now-or-never" service.

Noone is going through months of mailing list traffic to check whether
all reported problems have been fixed. I try to make mental notes of
what I see, but my DRAM chips seems to need frequent refresh. I'm sure
many of the others feel likewise. I do, however, take an occasional
stroll through the bug repository and check for fixed bugs, sort the
incoming ones, and sometimes also make a stab at analysing/fixing some
of them.

I'm currently looking at the R-bugs interface to see if it would be
possible to redirect all traffic on R-bugs through R-devel (except
"private" messages, which go to the core team only, of course). It's a
little sticky, because it requires changes to the Jitterbug sources,
but it doesn't look hopeless at all.

That way, there would be no excuse for not using R-bugs, and R-devel
may turn into a somewhat more constructive[*] forum than it is at the
moment. The bug.report() function has also been substantially improved
for 0.63.3, BTW.

[*] I know, everyone in here is doing their best to chip in to the R
development. The problem is rather the opposite: discussions tending
to remain within the core team.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Ted.Harding@nessie.mcc.ac.uk  Mon Feb  1 17:58:27 1999
From: Ted.Harding@nessie.mcc.ac.uk ( (Ted Harding))
Date: Mon, 01 Feb 1999 17:58:27 -0000 (GMT)
Subject: PostScript bugs in R-0.63.1
In-Reply-To: <Pine.SUN.3.95.990201111153.607A-100000@paca>
Message-ID: <XFMail.990201175827.Ted.Harding@nessie.mcc.ac.uk>

On 01-Feb-99 Ben Bolker wrote:
> 
>   I have a minor problem with the PostScript generated by R-0.63.1.
>   Specifically, the files generated *will* work in:
> 
>     ghostview; on an HP LaserJet; on an Apple LaserWriter
> 
>   *will not* work in:
> 
>      ghostscript under xdvi; on a SPARCprinter
>  
>   The error message on the SPARCprinter was
> 
> Error: /invalidfont
> Command: 'definefont'
> Ostack: /Font5 /Font5 font(Symbol,1)
> Estack:
>   [and quite a bit more ...]

This looks (especially since it sometimes works & sometimes doesn't) like
a PostScript Level-1 vs Level-2 issue.

definefont:  key font definefont font
...
In Level-2 it is permissible to associate a font dictionary with more
than one key. If /font/ has already been registered, definefont does
not alter it in any way
(PostScript Language Ref Manual)

The "invalidfont" error can arise "on discovering that a font dictionary
is malformed".

I don't know the details of R's PS implementation; however, if it is
using definefont attempting to register more than one key for the Symbol
font then that would be consistent with your results. Ghostscript and
ghostview should both be able to handle Level-2; I'm not sure why
ghostscript under xdvi should not be able to (unless xdvi somehow
inhibits it). Apart from that, the observed behaviour is compatible with
HPLJ and AppleLW being Level-2, while the SPARCprinter is Level-1.

Good PostScript code tests the value of "languagelevel": OK if =2, else
if =1 or if undefined in systemdict then Level-2 features may not work
and alternative Level-1 code should be executed (and of course needs to
be supplied in the file ... ).

Ted.

--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding@nessie.mcc.ac.uk>
Date: 01-Feb-99                                       Time: 17:58:27
------------------------------ XFMail ------------------------------
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Arne.Kovac@uni-essen.de  Tue Feb  2 00:35:39 1999
From: Arne.Kovac@uni-essen.de (Arne Kovac)
Date: Tue, 2 Feb 1999 01:35:39 +0100 (NFT)
Subject: PostScript bugs in R-0.63.1
In-Reply-To: <XFMail.990201175827.Ted.Harding@nessie.mcc.ac.uk>
Message-ID: <Pine.A41.4.02.9902020132140.20020-100000@gauss.mathematik.uni-essen.de>

On Mon, 1 Feb 1999, Ted.Harding wrote:

> On 01-Feb-99 Ben Bolker wrote:
> 
> I don't know the details of R's PS implementation; however, if it is
> using definefont attempting to register more than one key for the Symbol
> font then that would be consistent with your results. Ghostscript and
> ghostview should both be able to handle Level-2; I'm not sure why
> ghostscript under xdvi should not be able to (unless xdvi somehow
> inhibits it). Apart from that, the observed behaviour is compatible with
> HPLJ and AppleLW being Level-2, while the SPARCprinter is Level-1.

I have similar problems with R 0-63.1 and LaTeX even without xdvi: after
compiling my LaTeX-document with latex and dvips I can't view it with
ghostview 1.5 anymore due to some error messages. Printing on a Laserjet
4MP works.

Arne

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jean@stat.ubc.ca  Tue Feb  2 20:38:35 1999
From: jean@stat.ubc.ca (Jean Meloche)
Date: Tue, 02 Feb 1999 20:38:35 +0000
Subject: Suggestion
Message-ID: <36B7624B.80E92237@stat.ubc.ca>

I have to write extensions to R regularly.

One of them was an interface to a mysql database on a
different computer. The best way to do that is to have
something like

mysql<-function (dbname, host = "zap", user = "nobody", password = "ok") 
{
    handle <<- .RC("mysqlconnect", c(host, user, password, dbname))
}

and

query<-function (cmd) 
{
    .RC("mysqlquery", handle, cmd)
}

In other words, my mysql (written in C) functions return a true R object.
The .RC function above simply calls the C funtion, passing R objects as
arguments and returns the R object created within the C function.

I think that R should give the ability to write C functions that build
R objects. Eventually, it would be best to have an API to standardize
the process of building R object too...

I'd like to see .RC added to the standard R distribution. Right now, I'm
applying my patch every time I upgrade R. Here is my diff


diff -r R-0.63/src/main/dotcode.c R-0.63.orig/src/main/dotcode.c
264,286d263
< SEXP do_dotRCode(SEXP call, SEXP op, SEXP args, SEXP env)
< {
<       DL_FUNC fun;
<       char buf[128], *p, *q, *vmax;
<       SEXP retval;
<
<       vmax = vmaxget();
<       op = CAR(args);
<       if (!isString(op)) errorcall(call,"function name must be a string\n");
<
<       /* make up load symbol & look it up */
<       p = CHAR(STRING(op)[0]);
<       q = buf; while ((*q = *p) != '\0') { p++; q++; }
<
<       if (!(fun=R_FindSymbol(buf))) errorcall(call,
<               "C-R function not in load table\n");
<
<       retval=fun(args);
<
<       vmaxset(vmax);
<       return retval;
< }
<
969c946
<       }
---
>         }
diff -r R-0.63/src/main/names.c R-0.63.orig/src/main/names.c
497d496
< {".RC",         do_dotRCode,    0,      1,      -1,     PP_FOREIGN},
diff -r R-0.63/src/main/names.h R-0.63.orig/src/main/names.h
128d127
< SEXP do_dotRCode(SEXP, SEXP, SEXP, SEXP);


If it is of interest, I could also provide the module that implements
the mysql interface.

Many thanks.

-- 
Jean Meloche
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Feb  5 08:03:32 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 5 Feb 1999 09:03:32 +0100
Subject: Installing R programs (PROBLEMS !!!!)
In-Reply-To: <36B9DF9B.C76F5A86@ime.unicamp.br> (samira@ime.unicamp.br)
References: <36B9DF9B.C76F5A86@ime.unicamp.br>
Message-ID: <199902050803.JAA08173@sophie.ethz.ch>

[forwarded to R-devel, where this really belongs]

>>>>> "Samira" == Samira M Ismail <samira@ime.unicamp.br> writes:

(to me in a private mail)

    Samira> We have been trying to install R.0.63 for Unix (SunOS 4.1.4 -
    Samira> SPARC 20) and we detected the following problem which makes
    Samira> impossible to run R.  We have got the following message:

    Samira> =======

    Samira> gcc -g -O2 -I../include -I../../src/include -c sunif.c -o sunif.o
    Samira> sunif.c: In function `unif_rand':
    Samira> sunif.c:131: `RAND_MAX' undeclared (first use this function)
    Samira> sunif.c:131: (Each undeclared identifier is reported only once
    Samira> sunif.c:131: for each function it appears in.)
    Samira> sunif.c: In function `Randomize':
    Samira> sunif.c:213: `NULL' undeclared (first use this function)
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `sunif.o'
    Samira> Current working directory /usr/R-0.63.1/src/nmath
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `R'
    Samira> Current working directory /usr/R-0.63.1/src
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `R'

Both  NULL  and  RAND_MAX   are ANSI C.
      (p.102)	 (p.252)    of my Kernighan & Ritchie, 2nd. ed.
      <stdio.h>	 <stdlib.h>

However, I've experienced myself and heard more than once that
SunOS 4.x.x  has always had broken header (*.h) files.
Actually I had thought that the headers that come with gcc would 
``ifdef around these''...

Anyway,  add the following lines to your  src/include/Platform.h

#ifndef NULL
#define	NULL	0
#endif

#ifndef RAND_MAX
#define	RAND_MAX	32767
#endif

(or just to the beginning of src/nmath/sunif.c).

-----------

Kurt, could we add this bug-workaround to configure.in and Platform.in
such that something like

#ifdef SunOS4
/*-- define missing ANSI C --*/
#define	NULL	0
#define	RAND_MAX	32767
#endif

---
Un(?)fortunately, I haven't had access to SunOS4 machines for more than a
year now.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Feb  5 08:04:41 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 5 Feb 1999 09:04:41 +0100
Subject: [Fwd] Problems installing R on SunOS 4.1.4
In-Reply-To: <36B9DF9B.C76F5A86@ime.unicamp.br> (samira@ime.unicamp.br)
References: <36B9DF9B.C76F5A86@ime.unicamp.br>
Message-ID: <199902050804.JAA08175@sophie.ethz.ch>

[forwarded to R-devel, where this really belongs]

>>>>> "Samira" == Samira M Ismail <samira@ime.unicamp.br> writes:

(to me in a private mail)

    Samira> We have been trying to install R.0.63 for Unix (SunOS 4.1.4 -
    Samira> SPARC 20) and we detected the following problem which makes
    Samira> impossible to run R.  We have got the following message:

    Samira> =======

    Samira> gcc -g -O2 -I../include -I../../src/include -c sunif.c -o sunif.o
    Samira> sunif.c: In function `unif_rand':
    Samira> sunif.c:131: `RAND_MAX' undeclared (first use this function)
    Samira> sunif.c:131: (Each undeclared identifier is reported only once
    Samira> sunif.c:131: for each function it appears in.)
    Samira> sunif.c: In function `Randomize':
    Samira> sunif.c:213: `NULL' undeclared (first use this function)
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `sunif.o'
    Samira> Current working directory /usr/R-0.63.1/src/nmath
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `R'
    Samira> Current working directory /usr/R-0.63.1/src
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `R'

Both  NULL  and  RAND_MAX   are ANSI C.
      (p.102)	 (p.252)    of my Kernighan & Ritchie, 2nd. ed.
      <stdio.h>	 <stdlib.h>

However, I've experienced myself and heard more than once that
SunOS 4.x.x  has always had broken header (*.h) files.
Actually I had thought that the headers that come with gcc would 
``ifdef around these''...

Anyway,  add the following lines to your  src/include/Platform.h

#ifndef NULL
#define	NULL	0
#endif

#ifndef RAND_MAX
#define	RAND_MAX	32767
#endif

(or just to the beginning of src/nmath/sunif.c).

-----------

Kurt, could we add this bug-workaround to configure.in and Platform.in
such that something like

#ifdef SunOS4
/*-- define missing ANSI C --*/
#define	NULL	0
#define	RAND_MAX	32767
#endif

---
Un(?)fortunately, I haven't had access to SunOS4 machines for more than a
year now.

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum SOL G1;	Sonneggstr.33
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From me@naxgul.kais.kyoto-u.ac.jp  Sat Feb  6 12:24:01 1999
From: me@naxgul.kais.kyoto-u.ac.jp (Yusuke Uchiyama)
Date: Sat, 6 Feb 1999 12:24:01 GMT
Subject: Partial implementation of "symbols"
Message-ID: <199902061224.MAA00206@naxgul.kais.kyoto-u.ac.jp>

Hello, 

I partially implemented the function "symbols". I would like to know if there have been already other person doing so. If not, would you please check my implementation and, if acceptable, please use it. I would like to implement other arguments if my function is accepted.

P.S. I am very glad to find that R is added to the software page of GNU web site. 

Yusuke Uchiyama
yusuke@kais.kyoto-u.ac.jp

---cut here---

"symbols" <-
function (x, y = NULL, squares = NULL, rectangles = NULL, add = FALSE, 
    inches = TRUE, ...) 
{
    if (is.list(x)) {
        y <- x[[2]]
        x <- x[[1]]
    }
    if (is.array(x)) {
        y <- x[, 2]
        x <- x[, 1]
    }
    if (!is.null(rectangles)) {
        symbols.rectangles(x, y, rectangles = rectangles, ...)
        invisible()
    }
    if (!is.null(squares)) {
        symbols.squares(x, y, squares = squares, ...)
        invisible()
    }
}

"symbols.rectangles" <-
function (x, y, rectangles, add = FALSE, inches = TRUE, ...) 
{
    xleft <- x - rectangles[1, ]/2
    ybottom <- y - rectangles[2, ]/2
    xright <- x + rectangles[1, ]/2
    ytop <- y + rectangles[2, ]/2
    if (add == FALSE) {
        plot.new()
        xlim <- c(min(xleft), max(xright))
        ylim <- c(min(ybottom), max(ytop))
        plot.window(xlim, ylim)
    }
    rect(xleft, ybottom, xright, ytop, ...)
    invisible()
}

"symbols.squares" <-
function (x, y, squares, add = FALSE, inches = TRUE, ...) 
{
    xleft <- x - squares/2
    ybottom <- y - squares/2
    xright <- x + squares/2
    ytop <- y + squares/2
    if (add == FALSE) {
        plot.new()
        xlim <- c(min(xleft), max(xright))
        ylim <- c(min(ybottom), max(ytop))
        plot.window(xlim, ylim)
    }
    rect(xleft, ybottom, xright, ytop, ...)
    invisible()
}



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Sat Feb  6 09:50:37 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Sat, 6 Feb 1999 10:50:37 +0100
Subject: Install R-0.63.1 on Solaris7
In-Reply-To: <36BB9B7F.1926@math.ubc.ca> (message from Yoko Wong on Fri, 05
 Feb 1999 17:31:43 -0800)
References: <36BB9B7F.1926@math.ubc.ca>
Message-ID: <199902060950.KAA04765@florence.ethz.ch>

(Again: 
	please send these things to  R-devel or R-help !!)

>>>>> "Yoko" == Yoko Wong <yoko@math.ubc.ca> writes:

    Yoko> Dear Martin,
    Yoko> I run into following errors when I try to compile R-0.63.1 on
    Yoko> Solaris7.  

>From all I see in the following, this looks like a Solaris 7 bug.
I don't have access to this OS.   

Anyone else ?

    Yoko> **********
    Yoko> /usr/include/sys/tihdr.h:458: warning: no semicolon at end of
    Yoko> struct or union
    Yoko> /usr/include/sys/tihdr.h:459: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:460: parse error before `SRC_offset'
    Yoko> /usr/include/sys/tihdr.h:460: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:461: parse error before `OPT_length'
    Yoko> /usr/include/sys/tihdr.h:461: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:462: parse error before `OPT_offset'
    Yoko> /usr/include/sys/tihdr.h:462: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:468: parse error before `t_scalar_t'
    Yoko> /usr/include/sys/tihdr.h:468: warning: no semicolon at end of
    Yoko> struct or union
    Yoko> /usr/include/sys/tihdr.h:469: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:470: parse error before `DEST_offset'
    Yoko> /usr/include/sys/tihdr.h:470: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:471: parse error before `OPT_length'
    Yoko> *****

    Yoko> Is this version support Solaris7.


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Feb  6 11:11:18 1999
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 6 Feb 1999 11:11:18 +0000 (GMT)
Subject: Install R-0.63.1 on Solaris 7
In-Reply-To: <199902060950.KAA04765@florence.ethz.ch>
Message-ID: <Pine.GSO.4.05.9902061104150.12417-100000@toucan.stats>

On Sat, 6 Feb 1999, Martin Maechler wrote:

> (Again: 
> 	please send these things to  R-devel or R-help !!)
> 
> >>>>> "Yoko" == Yoko Wong <yoko@math.ubc.ca> writes:
> 
>     Yoko> Dear Martin,
>     Yoko> I run into following errors when I try to compile R-0.63.1 on
>     Yoko> Solaris7.  
> 
> >From all I see in the following, this looks like a Solaris 7 bug.
> I don't have access to this OS.   
> 
> Anyone else ?

I do. (Don't ask why we have all of Solaris 2.5, 2.5.1, 2.6 and 2.7 aka 
7. Upgrades always seem just too big for the current partitioning.)  But
before I investigate:

(i) is there a good reason to be trying 0.63.1 rather than 0.63.2?

(ii) which compilers were you trying to use, e.g. what is reported
when configure is run, and what versions are those compilers?

B

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Feb  8 10:50:15 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 8 Feb 1999 10:50:15 +0000 (GMT)
Subject: Install R-0.63.1 on Solaris 7
Message-ID: <199902081050.KAA20019@toucan.stats.ox.ac.uk>

I received the following message. I had no problems building R 0.63.2
on Solaris 7 (aka Solaris 2.7, SunOS 5.7) with each of

gcc2.8.1  f77 version SC4.0
cc version SC4.0  f77 version SC4.0
egcs 1.1 (gcc/g77)

------------- Begin Forwarded Message -------------

From: Yoko Wong <yoko@math.ubc.ca>
Subject: Re: Install R-0.63.1 on Solaris 7
To: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 6 Feb 1999 17:41:57 -0800 (PST)
X-Keywords: 

Thanks. I think it might be the gcc I am using.  I have
compiled on other solaris7 machine. 

Cheers,

Yoko


------------- End Forwarded Message -------------


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kye@ams.sunysb.edu  Mon Feb  8 23:43:54 1999
From: kye@ams.sunysb.edu (Kenny Ye)
Date: Mon, 8 Feb 1999 18:43:54 -0500 (EST)
Subject: bug on cancor
Message-ID: <Pine.SO4.4.02.9902081842340.23770-100000@fisher>


When I use the function cancor of mva package, I found that it doesn't
work when one of the matrix has only one column, or both have only
one column. The function in Splus 5 with the same name works under those
situations.

The version of R I am using is 0.63.2 (released on Jan., 1999) on Solaris.

Kenny Ye
Assistant Professor
Department of Applied Math and Statistics
SUNY at  Stony Brook
Stony Brook, New York 11794-3600
(516)632 9344


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kye@ams.sunysb.edu  Tue Feb  9 00:00:58 1999
From: kye@ams.sunysb.edu (kye@ams.sunysb.edu)
Date: Tue, 9 Feb 1999 01:00:58 +0100
Subject: bug on cancor (PR#116)
Message-ID: <199902090000.BAA00511@biostat.ku.dk>


When I use the function cancor of mva package, I found that it doesn't
work when one of the matrix has only one column, or both have only
one column. The function in Splus 5 with the same name works under those
situations.

The version of R I am using is 0.63.2 (released on Jan., 1999) on Solaris.

Kenny Ye
Assistant Professor
Department of Applied Math and Statistics
SUNY at  Stony Brook
Stony Brook, New York 11794-3600
(516)632 9344


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Feb  9 00:16:37 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 09 Feb 1999 01:16:37 +0100
Subject: bug on cancor (PR#116)
In-Reply-To: kye@ams.sunysb.edu's message of Tue, 9 Feb 1999 01:00:58 +0100
References: <199902090000.BAA00511@biostat.ku.dk>
Message-ID: <x21zk0qvmi.fsf@blueberry.kubism.ku.dk>

kye@ams.sunysb.edu writes:

> When I use the function cancor of mva package, I found that it doesn't
> work when one of the matrix has only one column, or both have only
> one column. The function in Splus 5 with the same name works under those
> situations.

Just for those who wondered: I resent the message to R-bugs, making it
appear on R-devel for the 2nd time but with a PR#. (Resending - in my
mailer at least - leaves the original author as sender, which I think
is desirable. It also came out with a double R-devel signature, but
that probably can't be helped).

This is clearly a bug:

> cancor(1:10,1:10)
Error in qr.qty(qx, qr.qy(qy, diag(1, nr, dy)))[1:dx, , drop = FALSE]
: incorrect number of dimensions

Probably a dimension getting dropped somewhere...
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From warnes@biostat.washington.edu  Tue Feb  9 02:10:36 1999
From: warnes@biostat.washington.edu (Gregory R. Warnes)
Date: Mon, 8 Feb 1999 18:10:36 -0800 (PST)
Subject: load() -> segfault
Message-ID: <Pine.LNX.4.04.9902081753120.560-100000@localhost>


OK.  Now that I've saved the results of some simulations using the save()
patch that I supplied earlier, I've gotten around to finding out why
load segfaults when I try to restore the data.

The reason is that I have several variable names which have
become horribly long during the simulation -- on the order of 20K
characters!  

save() is perfectly happy to write these variable names out, but load()
segfaults because the "InString" family of functions use fixed size
buffer but don't check for overflow!  The buffer is MAXELTSIZE bytes,
defined in $RHOME/src/inclide/Defn.h as 512. As you would expect,
reading a 20K object into a 512 byte buffer can really mess things up.

As noted in the comments of saveload.c,
    /* FIXME : the fixed size buffer here is an abomination */
but that's not as bad as failing to check for overflow.

I don't really have time to fix this, so for the moment I'm just refining
MAXELTSIZE to 32768 bytes (32K).  This fixes my problem, but is a horrid
hack.

Does anyone want to run through saveload.c fixing the code to check for
buffer overruns?   

-Greg

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From warnes@biostat.washington.edu  Tue Feb  9 02:11:34 1999
From: warnes@biostat.washington.edu (warnes@biostat.washington.edu)
Date: Tue, 9 Feb 1999 03:11:34 +0100
Subject: load() -> segfault (PR#117)
Message-ID: <199902090211.DAA00532@biostat.ku.dk>


OK.  Now that I've saved the results of some simulations using the save()
patch that I supplied earlier, I've gotten around to finding out why
load segfaults when I try to restore the data.

The reason is that I have several variable names which have
become horribly long during the simulation -- on the order of 20K
characters!  

save() is perfectly happy to write these variable names out, but load()
segfaults because the "InString" family of functions use fixed size
buffer but don't check for overflow!  The buffer is MAXELTSIZE bytes,
defined in $RHOME/src/inclide/Defn.h as 512. As you would expect,
reading a 20K object into a 512 byte buffer can really mess things up.

As noted in the comments of saveload.c,
    /* FIXME : the fixed size buffer here is an abomination */
but that's not as bad as failing to check for overflow.

I don't really have time to fix this, so for the moment I'm just refining
MAXELTSIZE to 32768 bytes (32K).  This fixes my problem, but is a horrid
hack.

Does anyone want to run through saveload.c fixing the code to check for
buffer overruns?   

-Greg


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Feb  9 08:07:57 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 9 Feb 1999 08:07:57 +0000 (GMT)
Subject: bug on cancor (PR#116)
In-Reply-To: <x21zk0qvmi.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.9902090741290.17438-100000@auk.stats>

On 9 Feb 1999, Peter Dalgaard BSA wrote:

> kye@ams.sunysb.edu writes:
> 
> > When I use the function cancor of mva package, I found that it doesn't
> > work when one of the matrix has only one column, or both have only
> > one column. The function in Splus 5 with the same name works under those
> > situations.

Yes, it does, but whether this makes statistical sense is debatable:
you are then doing regression in a roundabout way. (Least-squares
regression maximizes the correlation of y with a linear combination of the
cols of X.)

> Just for those who wondered: I resent the message to R-bugs, making it
> appear on R-devel for the 2nd time but with a PR#. (Resending - in my
> mailer at least - leaves the original author as sender, which I think
> is desirable. It also came out with a double R-devel signature, but
> that probably can't be helped).
> 
> This is clearly a bug:
> 
> > cancor(1:10,1:10)
> Error in qr.qty(qx, qr.qy(qy, diag(1, nr, dy)))[1:dx, , drop = FALSE]
> : incorrect number of dimensions
> 
> Probably a dimension getting dropped somewhere...

Nope. As someone who has suffered here before, I saw it is that pesky
mat.or.vec construction that someone in R likes to use. Function
qr.qr returns a vector when given an n x 1 y, by design.  So

qr.qy(qy, diag(1, nr, dy))
qr.qty(qx, qr.qy(qy, diag(1, nr, dy)))

are vectors.  So this is an R design decision.
To work around this in cancor, use

    zz <- qr.qty(qx, qr.qy(qy, diag(1, nr, dy)))
    z <- svd(as.matrix(zz)[1:dx, , drop=FALSE], dx, dy)


BTW, the help page for qr.qy says the value is

Value:

     The QR decomposition of the matrix as computed by LIN-
     PACK.  The components in the returned value correspond
     directly to the values returned by DQRDC.

which is nonsense for 8 of the 9 functions documented on that page.

I was using 0.63.2, in case anything has been altered since.

It may be too late to change this design decision (I know of quite a few
workarounds in other code) but it will come back to haunt users. At least
it could be documented!

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Feb  9 09:18:05 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 9 Feb 1999 10:18:05 +0100
Subject: bug on cancor (PR#116)
In-Reply-To: <Pine.GSO.4.05.9902090741290.17438-100000@auk.stats> (message
 from Prof Brian D Ripley on Tue, 9 Feb 1999 08:07:57 +0000 (GMT))
References: <Pine.GSO.4.05.9902090741290.17438-100000@auk.stats>
Message-ID: <199902090918.KAA15254@sophie.ethz.ch>

In the ``release-patch'' aka 0.63.3  version, the  functions
qr.xxx  *have* changed about 10 days ago.

NEWS has

    o	backsolve(), qr.solve... now return a vector when x (or y) is a vector.


In today's snapshot,

  > library(mva)
  > str(cancor(1:9,c(1:4,6:10)))
  List of 5
   $ cor    : num 0.997
   $ xcoef  : num 0.129
   $ ycoef  : num 0.110
   $ xcenter: num 5
   $ ycenter: num 5.56

However, 
I'm not sure if this addresses all issues (apart from docu)
that Prof Ripley has addressed. 

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From nlewin@iastate.edu  Tue Feb  9 15:59:01 1999
From: nlewin@iastate.edu (Nicholas Lewin)
Date: Tue, 09 Feb 1999 09:59:01 CST
Subject: Inter-application communication protocols for R
Message-ID: <199902091559.JAA07685@environ.stat.iastate.edu>

Dear R development people,
  We have developed a bi-directional link between the GIS package ArcView and 
XGobi. The link operates using RPC calls transparent to the user. We are 
interested in expanding the link to a stats package such as R, and would like 
to know if there is any interest in implementing inter-application protocols. 
We are interested in implementing a link where data could be passed from 
ArcView to both XGobi and R. Once the data is passed different views of the 
data could be displayed in both packages and linked to the map in ArcView for 
brushing. We also envision calculating various spatial statistics in R and 
passing them back to ArcView for display.

We would also be interested in implementing better sturctures for display of 
spatial data in R. If there is interest please let us know.

Sincerely,
Nicholas Lewin-Koh



                      CH3                  
                       |                          
                       N                 Nicholas Lewin-Koh
                      / \                GIS Support and Research Facility
                N----C   C==O            218 Durham Center
               ||   ||   |               Iowa State University
               ||   ||   |               Ames, IA 50011
               CH    C   N--CH3
                 \  / \ /                nlewin@iastate.edu
                  N    C                 515-294-2279 
                  |   ||                 515-294-1717 (Fax)
                 CH3   O                 http://www.public.iastate.edu/~nlewin

          The Real Part of Coffee 



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Ben Bolker <ben@eno.Princeton.EDU>  Wed Feb 10 01:58:03 1999
From: Ben Bolker <ben@eno.Princeton.EDU> (Ben Bolker)
Date: Tue, 9 Feb 1999 20:58:03 -0500 (EST)
Subject: wish list
Message-ID: <Pine.SUN.3.95.990125135010.14441A-100000@paca>


  Some of these I can implement pretty easily myself, others are harder
...

GRAPHICS:

    - a new option(), "plot.type", that allows one to set the default plot
type for pairs of points to something other than "p";

    - the ability to set just the lower or upper limits on an axis and
have the other limit auto-scaled (somewhat trickier: I don't know the
most convenient way for the user to specify this)

    - the ability to add points, text, etc. to persp() plots for
annotation (when Ross discussed this, I wasn't sure whether there were
going to be two separate kinds of 3-D plots) 

MISC:

  either an option or a separate function that makes edit() change the
underlying object:

pedit <- function (y) 
{
    assign(deparse(substitute(y)), edit(y), inherits = TRUE)
}

  regexp/tab completion for the help system (ha!)




Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Feb 10 07:56:42 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 10 Feb 1999 07:56:42 +0000 (GMT)
Subject: Ben Bolker's wish list
In-Reply-To: <Pine.SUN.3.95.990125135010.14441A-100000@paca>
Message-ID: <Pine.GSO.4.05.9902100731060.18640-100000@auk.stats>

On Tue, 9 Feb 1999, Ben Bolker wrote:

>     - the ability to set just the lower or upper limits on an axis and
> have the other limit auto-scaled (somewhat trickier: I don't know the
> most convenient way for the user to specify this)

The obvious idea is to use NA to specify a limit to be computed.
 
>   either an option or a separate function that makes edit() change the
> underlying object:
> 
> pedit <- function (y) 
> {
>     assign(deparse(substitute(y)), edit(y), inherits = TRUE)
> }

Why do you want that? In particular, what do you want inherits = TRUE to
achieve?  (As I understand R's documentation, this replaces objects
found down the search path in the global environment, so you must
envisage calling pedit from within a nested set of expressions.)

If you take a closer look at fix(), you will see that you only want
to deparse names and it would be better to check if y (why `y'?) exists.
As I see it all you want to do is to change the last line of fix, and I am
puzzled as to why you want to do that.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Wed Feb 10 13:44:35 1999
From: J.C.Rougier@durham.ac.uk (J.C.Rougier@durham.ac.uk)
Date: Wed, 10 Feb 1999 14:44:35 +0100
Subject: Function parsing (PR#118)
Message-ID: <199902101344.OAA02583@biostat.ku.dk>

Is anyone else concerned with the way in which the R function parser
relocates comments that occur after condional expressions in functions to
before, i.e. 

fred <- function(x) {
 # wonder what x is like
 if (x>0) stop("Sorry non-positive x only")
 # that showed x big-time!
 x
}

but then fred is parsed and stored as 

"fred" <-
function (x) 
{
    # wonder what x is like
    # that showed x big-time!
    if (x > 0) 
        stop("Sorry non-positive x only")
    x
}

It turns out that my programming style often includes comments after
conditionals, and I find this re-location a bit confusing.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Feb 10 14:28:19 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 10 Feb 1999 15:28:19 +0100
Subject: Function parsing (PR#118)
In-Reply-To: J.C.Rougier@durham.ac.uk's message of Wed, 10 Feb 1999 14:44:35 +0100
References: <199902101344.OAA02583@biostat.ku.dk>
Message-ID: <x290e6tjss.fsf@blueberry.kubism.ku.dk>

J.C.Rougier@durham.ac.uk writes:

> Is anyone else concerned with the way in which the R function parser
> relocates comments that occur after condional expressions in functions to
> before, i.e. 
...
> It turns out that my programming style often includes comments after
> conditionals, and I find this re-location a bit confusing.

You're not alone, it's just that nobody has had the stamina to
pinpoint how exactly this happens. An even more drastic version is in
glm.fit:

    ##-------------- end IRLS iteration -------------------------------
    for (iter in 1:control$maxit) {
        mu.eta.val <- mu.eta(eta)
        .. IRLS iteration! ..

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ben@eno.Princeton.EDU  Wed Feb 10 14:29:34 1999
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Wed, 10 Feb 1999 09:29:34 -0500 (EST)
Subject: Ben Bolker's wish list
In-Reply-To: <Pine.GSO.4.05.9902100731060.18640-100000@auk.stats>
Message-ID: <Pine.SUN.3.95.990210092129.19391A-100000@paca>


  I'm sorry, I didn't know that fix() existed.  That's what I wanted, the
"pedit" function I gave was an attempt to do the same thing.  And yes, it
is there in the "See Also" section of the help on edit().  Perhaps we
could add a sentence to the documentation of edit:

*** edit.Rd.orig        Wed Feb 10 09:26:03 1999
--- edit.Rd     Wed Feb 10 09:26:59 1999
***************
*** 29,34 ****
--- 29,35 ----
  Instead, a copy of name is made and it is that copy which is changed.
  Should you want the changes to apply to the object \code{name}
  you must assign the result of \code{edit} to \code{name}.
+ (Try \code{fix} if you want to make permanent changes to an object.)
  
  In the form \code{edit(name)},
  \code{edit} deparses \code{name} into a temporary file and invokes the



  I *don't* claim to understand the ins and outs of parsing, deparsing,
etc. in R, but the pedit() function seemed to do what I wanted (although
probably not as generally or as robustly as fix()).

  Thanks for the info.

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Feb 11 15:14:20 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 11 Feb 1999 16:14:20 +0100
Subject: Problems with warnings from loess under Windows, at least (PR#119)
Message-ID: <199902111514.QAA15364@biostat.ku.dk>

There are two separate problems with loess under Guido's rw0632 on
Windows, neither of which appear unless you try to do something that it is
trying to tell you is inadvisable.  It bombs trying to tell you. I have
put up a replacement modreg.zip in the CRAN contrib collection that will
be mirrored tonight.

Both of these could potentially affect other platforms.

(1) A problem relating to the declaration of problem_buf in S.h.

> On Fri, 5 Feb 1999, Guido Masarotto wrote:

> On Thu, Feb 04, 1999 at 06:54:34PM +0000, Prof Brian D Ripley wrote:
> > OK, I have got to the bottom of this.
> > 
> > For some reason Guido has problem_buf in globalvar.h, twice. It should
> > not be there, and used not to be.  That means that any call to warning() or
> > stop() from compiled code in a DLL will bomb R. The solution is to remove
> > those lines and re-compile modreg.  I can do that for you if you need it.

>   The problem seems to happen
>   since every file which includes S.h declare a 'public' version
>   of problem_buf,i.e, got a declaration of the type
>   char problem_buf[4096];
>   I suspect that problem_buf should or declared extern (with memory
>   allocated somewhere, e.g.,in src/main.c) or static.
>   (BTW, the two files are appl/loglin.c and main/print.c).
>   In general, I am beginning to think that my 'automatic'
>   approch for globalvar.h is too much dangerous. It assumes
>   that global variables in all the 'main' files are 
>   properly declared and named. And, this is not the case now.

This needs resolving to static or extern for all the platforms. Those
writing `main' files might like to be aware that leaving symbols exposed
causes some problems, as on Windows we have to declare as imports all the
variables used from the R engine. The current scheme is to assume that all
exposed variables are intended to be imported.  (Can f1 and f2 in
approx.c be declared static?)

(2) Problems mixing Fortran and C.

> > The messages are then not very clear, because loessf.f passes strings
> > to loessc.c to call the warning/stop routines, and in Windows (but not
> > Unix) those strings seem to be missing a '\0' terminator. So you gets of
> > the next string, .... That will need rather more extensive changes to fix.

The problem here is that the loess code (not mine!) assumes that Fortran
uses strings in C format. This is not a safe assumption, but I was
surprised to find it not true for a port of g77. There may be no universal
answer, but I have modified the code to pass to C what Fortran thinks the
length is, and this works on the platforms I have. I will submit the
changed code shortly.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 11 17:46:54 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 11 Feb 1999 18:46:54 +0100
Subject: An idea for something better than read.table
Message-ID: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk>


I was recently converting some datasets for use in an R package and it
occurred to me that there really is no "neat" way to input a data
frame if it is to contain factor variables. 

One can use dput()/source or dump() after massaging data into the
right format, of course, but there isn't really anything which allows
you to store the input instructions with the data beyond the simple
header=T type format. 

So I thought of ways to enhance the header. The best idea I've been
able to come up with this far is to 

(a) Write a function - basically an extension of scan() - which allows
    you to specify the column data type in more detail. Let's call it
    data.file() for now. It would pretty much have to deparse all of
    its arguments and interpret things in slightly unusual ways, but R
    can do that, and some of functions (notably help() and data())
    already play this kind of game with the parser...

(b) Have a function, say read(), which parses the 1st expression in a
    file and executes it *with the remainder of the file as the
    argument*. (Currently, this is impossible, but it would be if
    one just kept track of the line number while parsing. parse()
    could stick it on as an attribute of the parsed expression list if
    asked to do so.)

This would make a file format something like the following possible.

[There's another loose idea in there involving a control item to handle
separators, na.strings, etc. - the intention being that read() plugs
in the file= and skip= arguments for the actual call.]

Would this be an approach worth pursuing?

--- Top of file ---
data.file(control(sep="w",na="."),
        Item = factor(levels=1:4,labels=c("A","B","C","D")),
        Size = numeric(),
        Year = factor(levels=1980:1985)
)
1       0     1980    
1       10    1981    
1       14    1982    
1       20    1983    
1       25    1984    
1       30    1985    
2       0     1980    
2       5     1981    
2       6     1982    
2       8     1984    
3       0     1984    
3       2     1985    
4       0     1980    
4       20    1981    
4       30    1982    
4       30    1984    
4       35    1985    
--- End of file ---

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Feb 11 18:10:27 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 11 Feb 1999 19:10:27 +0100 (CET)
Subject: An idea for something better than read.table
In-Reply-To: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk>
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk>
Message-ID: <14019.7443.446135.700056@pc87.maho.magnaeu.com>

>>>>> Peter Dalgaard BSA writes:

> I was recently converting some datasets for use in an R package and it
> occurred to me that there really is no "neat" way to input a data
> frame if it is to contain factor variables. 

> One can use dput()/source or dump() after massaging data into the
> right format, of course, but there isn't really anything which allows
> you to store the input instructions with the data beyond the simple
> header=T type format. 

> So I thought of ways to enhance the header. The best idea I've been
> able to come up with this far is to 

> (a) Write a function - basically an extension of scan() - which allows
>     you to specify the column data type in more detail. Let's call it
>     data.file() for now. It would pretty much have to deparse all of
>     its arguments and interpret things in slightly unusual ways, but R
>     can do that, and some of functions (notably help() and data())
>     already play this kind of game with the parser...

> (b) Have a function, say read(), which parses the 1st expression in a
>     file and executes it *with the remainder of the file as the
>     argument*. (Currently, this is impossible, but it would be if
>     one just kept track of the line number while parsing. parse()
>     could stick it on as an attribute of the parsed expression list if
>     asked to do so.)

> This would make a file format something like the following possible.

> [There's another loose idea in there involving a control item to handle
> separators, na.strings, etc. - the intention being that read() plugs
> in the file= and skip= arguments for the actual call.]

> Would this be an approach worth pursuing?

I think so.  However, why can't we extend scan() accordingly?

E.g.,

  scan(FILE,
       what = list(Item = factor(levels=1:4,labels=c("A","B","C","D")),
                   Size = numeric(),
                   Year = factor(levels=1980:1985)))

???

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 11 18:31:55 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 11 Feb 1999 19:31:55 +0100
Subject: An idea for something better than read.table
In-Reply-To: Kurt Hornik's message of Thu, 11 Feb 1999 19:10:27 +0100 (CET)
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk> <14019.7443.446135.700056@pc87.maho.magnaeu.com>
Message-ID: <x2d83g3i78.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> > [There's another loose idea in there involving a control item to handle
> > separators, na.strings, etc. - the intention being that read() plugs
> > in the file= and skip= arguments for the actual call.]
> 
> > Would this be an approach worth pursuing?
> 
> I think so.  However, why can't we extend scan() accordingly?
> 
> E.g.,
> 
>   scan(FILE,
>        what = list(Item = factor(levels=1:4,labels=c("A","B","C","D")),
>                    Size = numeric(),
>                    Year = factor(levels=1980:1985)))
> 
> ???

We could, and in a sense that is what I'm suggesting, but:

- the argument syntax is a bit clumsy, I'd like to have the variables
through a ... argument.

- scan *evaluates* the arguments and then looks at the type.
Evaluating things like

factor(levels=1:4,labels=c("A","B","C","D")) 

currently gives a "missing x" error, but even if we fixed that, it
could never give anything better than

> structure(integer(0),class="factor",levels=c("A","B","C","D"))
factor(0)
Levels:  A B C D 

i.e. the levels= specification would be forgotten. The only way to
circumvent that is to have scan working on nonevaluated arguments.

So I thought that one might as well start over with a completely new
function. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Feb 11 18:56:05 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 11 Feb 1999 13:56:05 -0500
Subject: dput truncation
Message-ID: <99Feb11.140632est.13485@mailgate.bank-banque-canada.ca>

dput() seems to be truncating data (either using single precision or some
formatting). In general my data is not so accurate that I should worry about
this and the small difference after dput then dget is mostly just an annoyance.
However, in some circumstances the truncation is enough that tsp attributes are
no longer valid, and that causes more serious difficulties. Is there any way to
modify the behavior of dput?

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From me@naxgul.kais.kyoto-u.ac.jp  Fri Feb 12 18:22:59 1999
From: me@naxgul.kais.kyoto-u.ac.jp (Yusuke Uchiyama)
Date: Fri, 12 Feb 1999 18:22:59 GMT
Subject: A subroutine for plotting stars
Message-ID: <199902121822.SAA00623@naxgul.kais.kyoto-u.ac.jp>


Hello,

I implemented "symbols.stars", a sub routine plotting stars.

It is intended to be called from "symbols".

Please use it if it is acceptable.

Yusuke Uchiyama

Laboratory of Insect Physiology
Graduate School of Agriculture
Kyoto University

e-mail: yusuke@kais.kyoto-u.ac.jp

---cut here---

"symbols.stars" <-
function (x, y, stars, add = FALSE, ...) 
{
    stars <- t(stars)
    i <- dim(stars)[1]
    anstep <- 2 * pi/i
    anstep <- anstep * 0:(i - 1) + pi/2
    dim(anstep) <- length(anstep)
    anstep <- t(apply(anstep, 1, rep, dim(stars)[2]))
    dim(x) <- length(x)
    dim(y) <- length(y)
    x <- apply(x, 1, rep, i)
    y <- apply(y, 1, rep, i)
    x <- x + stars * cos(anstep)
    y <- y + stars * sin(anstep)
    x <- c(apply(x, 2, c, NA))
    y <- c(apply(y, 2, c, NA))
    if (add == FALSE) {
        xlim <- c(min(x[!is.na(x)]) - 1.5, max(x[!is.na(x)]) + 
            1.5)
        ylim <- c(min(y[!is.na(y)]) - 1.5, max(y[!is.na(y)]) + 
            1.5)
        plot.new()
        plot.window(xlim, ylim)
    }
    polygon(x, y)
}





-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Feb 12 19:06:41 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 12 Feb 1999 14:06:41 -0500
Subject: more on dput
Message-ID: <99Feb12.150245est.13483@mailgate.bank-banque-canada.ca>

I would like to write data so that I can re-read it and reproduce results,
preferably in both R and Splus. In the past when I have done this my data has
been relatively simple and I've just scan()ed it. Now I have a fairly
complicated structure I would like to preserve and I've been trying to use dput
and dget. Is there a better way?  If not, the following truncation by dput,
which I mentioned yesterday, is causing me a fair amount of trouble. Suggestions
on how to fix it would be appreciated.

Paul Gilbert
_______

R:
> dput (1/3, "zot")
> (1/3) - dget("zot")
[1] 3.333333e-08

Splus 3.3:
> dput(1/3, "zot")
> (1/3) - dget("zot")
[1] 3.330669e-16

written by Splus, read in R:
> (1/3) - dget("zot")
[1] 3.330669e-16

so the problem seems pretty clearly to be in R's dput.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Feb 12 20:58:22 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 12 Feb 1999 20:58:22 +0000 (GMT)
Subject: more on dput
In-Reply-To: <99Feb12.150245est.13483@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.9902122056380.19025-100000@auk.stats>

On Fri, 12 Feb 1999, Paul Gilbert wrote:

> I would like to write data so that I can re-read it and reproduce results,
> preferably in both R and Splus. In the past when I have done this my data has
> been relatively simple and I've just scan()ed it. Now I have a fairly
> complicated structure I would like to preserve and I've been trying to use dput
> and dget. Is there a better way?  If not, the following truncation by dput,
> which I mentioned yesterday, is causing me a fair amount of trouble. Suggestions
> on how to fix it would be appreciated.
> 
> Paul Gilbert
> _______
> 
> R:
> > dput (1/3, "zot")
> > (1/3) - dget("zot")
> [1] 3.333333e-08
> 
> Splus 3.3:
> > dput(1/3, "zot")
> > (1/3) - dget("zot")
> [1] 3.330669e-16
> 
> written by Splus, read in R:
> > (1/3) - dget("zot")
> [1] 3.330669e-16
> 
> so the problem seems pretty clearly to be in R's dput.

I find:

> dput(1/3)
0.3333333
> as.character(1/3)
[1] "0.333333333333333"
> options(digits=16)
> dput(1/3)
0.3333333333333333

so either use as.character or set digits to something large.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Feb 12 21:16:05 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 12 Feb 1999 16:16:05 -0500
Subject: more on dput
References: <Pine.GSO.4.05.9902122056380.19025-100000@auk.stats>
Message-ID: <99Feb12.162703est.13453@mailgate.bank-banque-canada.ca>

> options(digits=16)

Thanks Brian, that works fine. I'm not so sure that it is a good idea having
dput depend on this, but if it's not changed it should at least be documented.

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From me@naxgul.kais.kyoto-u.ac.jp  Tue Feb 16 14:20:09 1999
From: me@naxgul.kais.kyoto-u.ac.jp (Yusuke Uchiyama)
Date: Tue, 16 Feb 1999 14:20:09 GMT
Subject: How to call do_circle from .Internal
Message-ID: <199902161420.OAA01141@naxgul.kais.kyoto-u.ac.jp>

Hello,

I would like to implement "circle" argument of "symbols", and want to call do_circle by name "circle" from .Internal.

I suppose I can do that by adding following lines to src/main/names.c and names.h:

names.c 
{"circle"	do_circle	0 ....}

names.h
SEXP do_circle(...)

Is it right?

Yusuke Uchiyama
yusuke@kais.kyoto-u.ac.jp
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 13:15:39 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 14:15:39 +0100
Subject: eval problem in Math.data.frame [.. DispathGroup / mean==sum ..] (PR#84)
Message-ID: <199902161315.OAA21263@biostat.ku.dk>

>> log(data.frame(x=1:4),base=2)
> Error: Object "base" not found

This one seems to be fixed. Move to Language-fixed.

(Note: there seems to be some strangeness with composing replies like this
in the web interface to JitterBug. Watch the headers if you want to followup.)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Feb 16 13:50:04 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 16 Feb 1999 14:50:04 +0100
Subject: eval problem in Math.data.frame [.. DispathGroup / mean==sum ..] (PR#84)
In-Reply-To: Peter Dalgaard's message of Tue, 16 Feb 1999 14:15:39 +0100
References: <199902161315.OAA21263@biostat.ku.dk>
Message-ID: <x21zjq5ugj.fsf@blueberry.kubism.ku.dk>

Peter Dalgaard <R-bugs@biostat.ku.dk> writes:

> (Note: there seems to be some strangeness with composing replies like this
> in the web interface to JitterBug. Watch the headers if you want to followup.)

OK, this seems to be relatively harmless. If I Cc: replies to R-devel,
or put it in the To: field, the sender becomes r-bugs@biostat.ku.dk so
any further correspondence goes on record. The only thing to note is
that even though my name occurs, my email does not, so you cannot
easily mail me back privately.

Still, it's a bit odd that JitterBug replies are sent directly from
the web interface, whereas nearly everything else goes via email to
r-bugs (which handles the list forwarding directly), even if entered
on a web form. Oh, well...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 14:11:43 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 15:11:43 +0100
Subject: lists (PR#88)
Message-ID: <199902161411.PAA21293@biostat.ku.dk>

> > 
>> > mode(c(23,42))
>> > is.vector(c(23,42),mode="numeric")
>> > is.vector(c(23,42),mode=c("integer","double","logical"))
>> 
>> Not sure I understand the problem:
> 
> 
> What I had in mind was that it would give TRUE if any of the vector
> had any of these modes i.e. some way of checking several modes at the
> same time without calling is.vector several times. I am looking for
> vectors upon which I can do calculations, as in those given. In
> retrospective, the example is poor. More logically, it should either
> use any() or ||.

I believe this is not a bug. You can get the effect you want fairly easily with

either 

any(sapply(modes,function(y)is.vector(x,mode=y)))

or

any(mode(x) == modes) # or storage.mode to distinguish double/integer

Moving report to "trashcan" (it can be picked up again, don't worry.)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 14:48:19 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 15:48:19 +0100
Subject: possible bug (PR#91)
Message-ID: <199902161448.PAA21336@biostat.ku.dk>

> bug.report:
> =====================
> Version:
>  platform = i586-unknown-linux
>  arch = i586
...
> 1. 
> bug.report() gives above information: however, my computer is a 486,
> not 586, but I am not knowldedgeable enough to tell whether
> bug.report() or the operating system is the optimist.

Your OS is the optimist, and R is not checking during configure. 
You may lose a little efficiency from this, but it's relatively 
harmless. Recompile your kernel with the right CPU setting if it bothers you.

> 2.
> It would be helpful if help(bug.report) showed how to exit
> bug.report() back to R. 

Hmm. It dumps you into your favourite editor, as specified in options()$editor,
and how to get out of that is editor-dependent... Not much we can do about that,

I'm afraid (or can we?). The bug.report() interface got cleaned up
substantially, 
by the way.

> 3.
> Using "expression" as ylab or xlab parameter of plot(): label is not
> centered (too high or too far to the right); this is particularly
> obvious if, e.g., margins are set wide:
> 
> e.g., with:
> 
> par(mai=c(1.8,2,1.8,2))
> 
> I padded the label with spaces to approximately center it:
> 
> ylab=expression(paste("[Ca]"[i]," (nM)                            ")

Still with us, I'm afraid. Don't see the mai= thing, though, but

 plot(1:3,ylab=expression(paste("[Ca]"[i]," (nM) "))) 

shows the effect badly enough.

Moving PR to "graphics"
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 14:48:40 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue Feb 16 14:48:40 1999
Subject: possible bug (PR#91)
Message-ID: <199902161506.QAA21358@biostat.ku.dk>

> bug.report:
> =====================
> Version:
>  platform = i586-unknown-linux
>  arch = i586
...
> 1. 
> bug.report() gives above information: however, my computer is a 486,
> not 586, but I am not knowldedgeable enough to tell whether
> bug.report() or the operating system is the optimist.

Your OS is the optimist, and R is not checking during configure. 
You may lose a little efficiency from this, but it's relatively 
harmless. Recompile your kernel with the right CPU setting if it bothers you.

> 2.
> It would be helpful if help(bug.report) showed how to exit
> bug.report() back to R. 

Hmm. It dumps you into your favourite editor, as specified in options()$editor,
and how to get out of that is editor-dependent... Not much we can do about that,

I'm afraid (or can we?). The bug.report() interface got cleaned up
substantially, 
by the way.

> 3.
> Using "expression" as ylab or xlab parameter of plot(): label is not
> centered (too high or too far to the right); this is particularly
> obvious if, e.g., margins are set wide:
> 
> e.g., with:
> 
> par(mai=c(1.8,2,1.8,2))
> 
> I padded the label with spaces to approximately center it:
> 
> ylab=expression(paste("[Ca]"[i]," (nM)                            ")

Still with us, I'm afraid. Don't see the mai= thing, though, but

 plot(1:3,ylab=expression(paste("[Ca]"[i]," (nM) "))) 

shows the effect badly enough.

Moving PR to "graphics"
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 15:15:48 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 16:15:48 +0100
Subject: possible bug (PR#91)
Message-ID: <199902161515.QAA21371@biostat.ku.dk>

> 3.
> Using "expression" as ylab or xlab parameter of plot(): label is not
> centered (too high or too far to the right); this is particularly
> obvious if, e.g., margins are set wide:
> 
> e.g., with:
> 
> par(mai=c(1.8,2,1.8,2))
> 
> I padded the label with spaces to approximately center it:
> 
> ylab=expression(paste("[Ca]"[i]," (nM)                            ")

Er, wait a minute. I think you are trying to do

plot(1:3,ylab=expression("[Ca]"[i]*" (nM) "))

which *does* get centered correctly.

This leaves the bug.report issue, so I'll put the report in a new "Misc" folder.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 15:33:09 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 16:33:09 +0100
Subject: source() / eval() bug ??? (PR#96)
Message-ID: <199902161533.QAA21404@biostat.ku.dk>

This one got fixed, I believe.

> R-0.63.2 and  ``0.63.3 in progress'' :
> 
> Put the following in a file
> 
> ------ 8< -- snip ----------------------------- ...../source-bug.R -------
> rm(list=ls())
> cat("before c(..):\n")
> c(F=(f <- .3), "Tail area" = 2 * if(f < 1) 30 else 90)
> ------ 8< -- snip -------------------------- end ..../source-bug.R -------
> 
> then
> 
> source("......../source-bug.R")
> 	^^^^^^^^
> 	proper path name
> 
> [[or  source("......../source-bug.R", verbose=TRUE) ]]
> 
> ends with
> 	=============================================
> 	before c(..):
> 	Error: getAttrib: invalid type for TAG
> 	> 
> 	=============================================
> 
> On interactive usage, or if you use
> 
> 	R --vanilla < ..../source-bug.R
> 
> there's no problem !
> 
> 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 15:49:53 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 16:49:53 +0100
Subject: [R] Pairlist & Dataframe (PR#100)
Message-ID: <199902161549.QAA21432@biostat.ku.dk>

> Ennapadam Venkatraman <venkat@biosta.mskcc.org> writes:

>>     > x <- NULL
>>     > x$x1 <- rnorm(10)
>>     > x$x2 <- rnorm(10)
>>     > mode(x)
>>     [1] "pairlist"
>>     > as.data.frame(x)
>>     Error: can't coerce pairlist into a data.frame

Fixed in 0.63.3
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 17:22:23 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 18:22:23 +0100
Subject: saveload.c (PR#107)
Message-ID: <199902161722.SAA26043@biostat.ku.dk>

> and so all depends from this function.  Using a Win32 version of SUNRPC
> assembled by Brian R. I was unable to load xdr images since after an
> xdr_destroy the xdr_int function fails.
> 
> Solution seems be as easy as
>   i = InInteger(fp);
>   InTerm(fp);
>   return OffsetToNode(i);

Fixed as suggested for 0.63.3
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mcw@ln.nimh.nih.gov  Tue Feb 16 20:33:52 1999
From: mcw@ln.nimh.nih.gov (mcw@ln.nimh.nih.gov)
Date: Tue, 16 Feb 1999 21:33:52 +0100
Subject: graphics bug: type="l" (PR#120)
Message-ID: <199902162033.VAA26161@biostat.ku.dk>


The following commands illustrate a problem with graphing relatively large
data sets using the "line" option to plot:

temp <- runif(200000)  # or whatever other numbers you like;
			# same thing happens with a sine wave
plot(1:200000, temp)    # everything fine
plot(1:200000, temp, type="l")   # data gets cut off


The number of points isn't crucial.  The cutoff point appears to be about
65,000 points.  (70,000 points demonstrates the cutoff; with 50,000 points
there's no cutoff.) 

As far as I can tell, the problem only occurs when using the
option type="l".  It's unaffected by color, line type, and line width.

Matt Wiener



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Feb 16 21:34:17 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 16 Feb 1999 22:34:17 +0100
Subject: graphics bug: type="l" (PR#120)
In-Reply-To: mcw@ln.nimh.nih.gov's message of Tue, 16 Feb 1999 21:33:52 +0100
References: <199902162033.VAA26161@biostat.ku.dk>
Message-ID: <x2btiuuj6u.fsf@blueberry.kubism.ku.dk>

mcw@ln.nimh.nih.gov writes:

> The following commands illustrate a problem with graphing relatively large
> data sets using the "line" option to plot:
> 
> temp <- runif(200000)  # or whatever other numbers you like;
> 			# same thing happens with a sine wave
> plot(1:200000, temp)    # everything fine
> plot(1:200000, temp, type="l")   # data gets cut off
> 
> 
> The number of points isn't crucial.  The cutoff point appears to be about
> 65,000 points.  (70,000 points demonstrates the cutoff; with 50,000 points
> there's no cutoff.) 
> 
> As far as I can tell, the problem only occurs when using the
> option type="l".  It's unaffected by color, line type, and line width.
> 
> Matt Wiener

Doesn't happen to me with 0.63.pre-3 on RedHat Linux. I can't offhand
see any documented fixes that would affect this, perhaps there's an OS
difference? Looks a bit like a short integer overrun (65536=2^16)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Feb 16 21:54:16 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 16 Feb 1999 21:54:16 +0000 (GMT)
Subject: graphics bug: type="l" (PR#120)
In-Reply-To: <199902162033.VAA26161@biostat.ku.dk>
Message-ID: <Pine.GSO.4.05.9902162134030.24074-100000@auk.stats>

On Tue, 16 Feb 1999 Matt Wiener, mcw@ln.nimh.nih.gov wrote:

> 
> The following commands illustrate a problem with graphing relatively large
> data sets using the "line" option to plot:
> 
> temp <- runif(200000)  # or whatever other numbers you like;
> 			# same thing happens with a sine wave
> plot(1:200000, temp)    # everything fine
> plot(1:200000, temp, type="l")   # data gets cut off
> 
> 
> The number of points isn't crucial.  The cutoff point appears to be about
> 65,000 points.  (70,000 points demonstrates the cutoff; with 50,000 points
> there's no cutoff.) 

This is device-specific (and which device was not mentioned). It does not
happen on Windows (rw0632) nor on a postscript device. It does happen on
the Unix x11() device for me, and my guess is that it is a limitation in
the X library used.  (Not in the X server, for this works in gs
displaying postscript, and in S-PLUS. The lines are drawn in a single Xlib
call.)

Do you really want to plot such a dataset in one go? What do you
expect to see of significance in 200000 points? (There are by default only 
about twice that many pixels on the device surface.) Are they really one
group? Would some group colour coding help? ....

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Feb 17 11:08:37 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Wed, 17 Feb 1999 12:08:37 +0100
Subject: graphics bug: type="l" (PR#120)
Message-ID: <199902171108.MAA26572@biostat.ku.dk>

Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> On Tue, 16 Feb 1999 Matt Wiener, mcw@ln.nimh.nih.gov wrote:
> 
> > 
> > The following commands illustrate a problem with graphing relatively large
> > data sets using the "line" option to plot:
> > 
> > temp <- runif(200000)  # or whatever other numbers you like;
> > 			# same thing happens with a sine wave
> > plot(1:200000, temp)    # everything fine
> > plot(1:200000, temp, type="l")   # data gets cut off
> > 
> > 
> > The number of points isn't crucial.  The cutoff point appears to be about
> > 65,000 points.  (70,000 points demonstrates the cutoff; with 50,000 points
> > there's no cutoff.) 
> 
> This is device-specific (and which device was not mentioned). It does not
> happen on Windows (rw0632) nor on a postscript device. It does happen on
> the Unix x11() device for me, and my guess is that it is a limitation in
> the X library used.  (Not in the X server, for this works in gs
> displaying postscript, and in S-PLUS. The lines are drawn in a single Xlib
> call.)

Apparently, this is not only device-specific but X-server specific as
the following network experiment shows:

Run on Linux,   display Linux   OK
Run on Solaris, display Linux   OK
Run on Solaris, display Solaris Error
Run on Linux,   display Solaris Error

So it seems that the Solaris OpenWindows X Server cannot handle
requests for drawing lines through more than 64K points. I suppose we
*could* fix this by splitting all XDrawLines into blocks of max 64K.

The man page for XDrawLines and friends have the following blob:

       All x and y members are signed integers.  The width and
       height members are 16-bit unsigned integers.  You should
       be careful not to generate coordinates and sizes out of
       the 16-bit ranges, because the protocol only has 16-bit
       fields for these values.

The "and sizes" bit might be taken to mean that you should do the
above, although it's beyond me how it would work on any platform if
there's only room for 16 bits in the protocol (perhaps the protocol
has changed from X11R5 to R6?). XDrawLines only occurs twice in
devX11.c, so I suppose it's no big deal to fix up.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Wed Feb 17 15:06:44 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Wed, 17 Feb 1999 16:06:44 +0100
Subject: HREFS for private packages - fixed? (PR#19)
Message-ID: <199902171506.QAA27186@biostat.ku.dk>

Anyone know if this is still with us? -pd

> There is however, a small problem with installing the HTML documention in a
> private (i.e. not RHOME/library) location. The file
> 
>    RHOME/doc/html/packages.html
> 
> linking the main documention to the packages is written (BTW this will
probably
> fail if the package owner and the R owner are not the same) but the links in
it
> are not quite correct. For me the link indicated in that file is
> 
>   <A HREF="../../library/dse/html/00Index.html">
> which would be RHOME/library/dse/html/00Index.html, but it should be
>  <A HREF="{package_location}/dse/html/00Index.html">

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Feb 17 16:01:02 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 17 Feb 1999 11:01:02 -0500
Subject: HREFS for private packages - fixed? (PR#19)
References: <199902171506.QAA27186@biostat.ku.dk>
Message-ID: <99Feb17.111432est.13468@mailgate.bank-banque-canada.ca>

I just checked and it still seems to be a problem in R 0.63.2.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Feb 17 16:19:23 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 17 Feb 1999 17:19:23 +0100 (CET)
Subject: HREFS for private packages - fixed? (PR#19)
In-Reply-To: <199902171506.QAA27186@biostat.ku.dk>
References: <199902171506.QAA27186@biostat.ku.dk>
Message-ID: <14026.60427.68697.231072@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 17 Feb 1999 16:06:44 +0100,
>>>>> Peter Dalgaard (PD) wrote:

PD> Anyone know if this is still with us? -pd
>> There is however, a small problem with installing the HTML documention in a
>> private (i.e. not RHOME/library) location. The file
>> 
>> RHOME/doc/html/packages.html
>> 
>> linking the main documention to the packages is written (BTW this will
PD> probably
>> fail if the package owner and the R owner are not the same) but the links in
PD> it
>> are not quite correct. For me the link indicated in that file is
>> 
>> <A HREF="../../library/dse/html/00Index.html">
>> which would be RHOME/library/dse/html/00Index.html, but it should be
>> <A HREF="{package_location}/dse/html/00Index.html">


It SHOULD contain only functions in RHOME/library, as this file serves
only as a default fallback. The complete list should be built at
runtime (using all in .lib.loc) and this works for me. However, there
is a problem if installing as root (or whoever is allowed to write to
RHOME) to someplace different than RHOME ... I'll dig into that
tomorrow (I've got to leave in 10 minutes).

.f

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Feb 17 17:42:01 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 17 Feb 1999 12:42:01 -0500
Subject: HREFS for private packages - fixed? (PR#19)
References: <199902171506.QAA27186@biostat.ku.dk> <14026.60427.68697.231072@galadriel.ci.tuwien.ac.at>
Message-ID: <99Feb17.125537est.13476@mailgate.bank-banque-canada.ca>

Friedrich

Just to make sure we're taking about the same problem, if I do

R INSTALL               dse

everything works fine (so that is what I've been using) but if I do

R INSTALL           -l rlibs  dse

I get the problem we are discussing. My understanding is that this is suppose to
install in the subdirectory rlib under where I run it, not in RHOME. The code
installs fine like this but the pointer in the HTML gets messed up.

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Wed Feb 17 18:00:13 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Wed, 17 Feb 1999 19:00:13 +0100
Subject: menu buglet (PR#12)
Message-ID: <199902171800.TAA30374@biostat.ku.dk>

Fixed. 

Actually, this one had been sitting around since *blush* August, bug
reproduction 
instructions, detailed patch, and everything.

Oh well, goes to show that an least submissions to r-bugs are never completely
forgotten...
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Feb 18 08:41:59 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 18 Feb 1999 09:41:59 +0100 (CET)
Subject: HREFS for private packages - fixed? (PR#19)
In-Reply-To: <99Feb17.125537est.13476@mailgate.bank-banque-canada.ca>
References: <199902171506.QAA27186@biostat.ku.dk>
 <14026.60427.68697.231072@galadriel.ci.tuwien.ac.at>
 <99Feb17.125537est.13476@mailgate.bank-banque-canada.ca>
Message-ID: <14027.53847.599276.209725@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 17 Feb 1999 12:42:01 -0500,
>>>>> Paul Gilbert (PG) wrote:

PG> Friedrich
PG> Just to make sure we're taking about the same problem, if I do

PG> R INSTALL               dse

PG> everything works fine (so that is what I've been using) but if I do

PG> R INSTALL           -l rlibs  dse

PG> I get the problem we are discussing. My understanding is that this is suppose to
PG> install in the subdirectory rlib under where I run it, not in RHOME. The code
PG> installs fine like this but the pointer in the HTML gets messed up.


Yes, that's exactly what I was meaning. IMO, only

	R INSTALL dse

should change the global packages file, because only the we have
guarantee that a user can actually access the installed packages
(anything installed somewhere else might belong to somebody different
etc.).

So

	R INSTALL -l rlibs  dse

shouldn't modify the global packages file, as a new one conforming to
the current .lib.loc get's built anyway when running help.start().

Any objections if I commit that change?

.f
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Feb 18 10:39:47 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 18 Feb 1999 11:39:47 +0100 (CET)
Subject: HREFS for private packages - fixed? (PR#19)
In-Reply-To: <14027.53847.599276.209725@galadriel.ci.tuwien.ac.at>
References: <199902171506.QAA27186@biostat.ku.dk>
 <14026.60427.68697.231072@galadriel.ci.tuwien.ac.at>
 <99Feb17.125537est.13476@mailgate.bank-banque-canada.ca>
 <14027.53847.599276.209725@galadriel.ci.tuwien.ac.at>
Message-ID: <14027.60915.528270.991492@galadriel.ci.tuwien.ac.at>


I committed the bug fixes.

.f


>>>>> On Thu, 18 Feb 1999 09:41:59 +0100 (CET),
>>>>> Friedrich Leisch (FL) wrote:

>>>>> On Wed, 17 Feb 1999 12:42:01 -0500,
>>>>> Paul Gilbert (PG) wrote:

PG> Friedrich
PG> Just to make sure we're taking about the same problem, if I do

PG> R INSTALL               dse

PG> everything works fine (so that is what I've been using) but if I do

PG> R INSTALL           -l rlibs  dse

PG> I get the problem we are discussing. My understanding is that this is suppose to
PG> install in the subdirectory rlib under where I run it, not in RHOME. The code
PG> installs fine like this but the pointer in the HTML gets messed up.


FL> Yes, that's exactly what I was meaning. IMO, only

FL> 	R INSTALL dse

FL> should change the global packages file, because only the we have
FL> guarantee that a user can actually access the installed packages
FL> (anything installed somewhere else might belong to somebody different
FL> etc.).

FL> So

FL> 	R INSTALL -l rlibs  dse

FL> shouldn't modify the global packages file, as a new one conforming to
FL> the current .lib.loc get's built anyway when running help.start().

FL> Any objections if I commit that change?




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@biostat.ku.dk  Thu Feb 18 14:47:27 1999
From: pd@biostat.ku.dk (pd@biostat.ku.dk)
Date: Thu, 18 Feb 1999 15:47:27 +0100
Subject: model.frame mangles time series (PR#121)
Message-ID: <199902181447.PAA11889@biostat.ku.dk>

This one showed up while looking at one of Ripley's other reports:

> data(freeny)
> model.frame(y~1,data=freeny,subset=1:10)
              y
1962.25 8.79236
1962.5  8.79137
1962.75 8.81486
1963    8.81301
1963.25 8.90751
1963.5  8.93673
1963.75 8.96161
1964    8.96044
1964.25 9.00868
1964.5  9.03049
> model.frame(y~1,data=freeny,subset=1:10)$y
Warning: Replacement length not a multiple of the elements to replace in matrix(...) 
Error: length of dimnames[1] not equal to array extent
> model.frame(y~1,data=freeny[1:10,])$y
         Qtr1    Qtr2    Qtr3    Qtr4
1962:      NA 8.79236 8.79137 8.81486
1963: 8.81301 8.90751 8.93673 8.96161
1964: 8.96044 9.00868 9.03049      NA
> dput(model.frame(y~1,data=freeny,subset=1:10)$y)
structure(c(8.79236, 8.79137, 8.81486, 8.81301, 8.90751, 8.93673, 
8.96161, 8.96044, 9.00868, 9.03049), .Tsp = c(1962.25, 1971.75, 
4), class = "ts")

The upshot of this is that glm(...,subset=...) fails on the freeny data.

The cause is seen by 

> model.frame(y~1,data=freeny[1:10,])$y
         Qtr1    Qtr2    Qtr3    Qtr4
1962:      NA 8.79236 8.79137 8.81486
1963: 8.81301 8.90751 8.93673 8.96161
1964: 8.96044 9.00868 9.03049      NA
> dput(model.frame(y~1,data=freeny,subset=1:10)$y)
structure(c(8.79236, 8.79137, 8.81486, 8.81301, 8.90751, 8.93673, 
8.96161, 8.96044, 9.00868, 9.03049), .Tsp = c(1962.25, 1971.75, 
4), class = "ts")

Notice that the .Tsp attribute doesn't reflect the shorter time series
(1971.75 should be 1964.5).

--please do not edit the information below--

Version:
 platform = i586-unknown-linux
 arch = i586
 os = linux
 system = i586, linux
 status = in progress
 status.rev = 0
 major = 0
 minor = 63.3
 year = 1999
 month = February
 day = 19
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Feb 18 16:24:37 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 18 Feb 1999 08:24:37 -0800 (PST)
Subject: model.frame mangles time series (PR#121)
In-Reply-To: <199902181447.PAA11889@biostat.ku.dk>
Message-ID: <Pine.GSO.4.10.9902180818370.2878-100000@wompom.biostat.washington.edu>

On Thu, 18 Feb 1999 pd@biostat.ku.dk wrote:

> This one showed up while looking at one of Ripley's other reports:

> The upshot of this is that glm(...,subset=...) fails on the freeny data.
> 
> The cause is seen by 
> 
> > model.frame(y~1,data=freeny[1:10,])$y
>          Qtr1    Qtr2    Qtr3    Qtr4
> 1962:      NA 8.79236 8.79137 8.81486
> 1963: 8.81301 8.90751 8.93673 8.96161
> 1964: 8.96044 9.00868 9.03049      NA
> > dput(model.frame(y~1,data=freeny,subset=1:10)$y)
> structure(c(8.79236, 8.79137, 8.81486, 8.81301, 8.90751, 8.93673, 
> 8.96161, 8.96044, 9.00868, 9.03049), .Tsp = c(1962.25, 1971.75, 
> 4), class = "ts")
> 
> Notice that the .Tsp attribute doesn't reflect the shorter time series
> (1971.75 should be 1964.5).


This is the attributes/subsetting problem rearing its ugly head again.
model.frame(,subset) has to copy *some* attributes over (eg contrasts) and
can't copy *all* of them (eg dim).

Currently we use copyMostAttributes to drop the dangerous ones. It
clearly didn't know about tsp. 

Questions:
(1) How do we know which attributes to copy?
(2) For an unknown attribute what should the default be?
(3) Is there just one set of attributes that needs special treatment (in
which case copyMostAttributes is broken) or are there different sets in
different circumstances (in which case we need a new function)?
(4) Could we just handle this by having the subset operator retain
attributes?

	-thomas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 18 16:51:01 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Feb 1999 17:51:01 +0100
Subject: model.frame mangles time series (PR#121)
In-Reply-To: Thomas Lumley's message of Thu, 18 Feb 1999 08:24:37 -0800 (PST)
References: <Pine.GSO.4.10.9902180818370.2878-100000@wompom.biostat.washington.edu>
Message-ID: <x2678zlkp6.fsf@blueberry.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> This is the attributes/subsetting problem rearing its ugly head again.
> model.frame(,subset) has to copy *some* attributes over (eg contrasts) and
> can't copy *all* of them (eg dim).
> 
> Currently we use copyMostAttributes to drop the dangerous ones. It
> clearly didn't know about tsp. 
> 
> Questions:
> (1) How do we know which attributes to copy?
> (2) For an unknown attribute what should the default be?
> (3) Is there just one set of attributes that needs special treatment (in
> which case copyMostAttributes is broken) or are there different sets in
> different circumstances (in which case we need a new function)?
> (4) Could we just handle this by having the subset operator retain
> attributes?

(5) is there really any reason to do subsetting in the .Internal code?
the hot spot is 

    variables <- eval(attr(formula, "variables"), data, sys.frame(sys.parent()))
    extranames <- as.character(substitute(list(...))[-1])
    extras <- substitute(list(...))
    extras <- eval(extras, data, sys.frame(sys.parent()))
    subset <- eval(substitute(subset), data, sys.frame(sys.parent()))
    data <- .Internal(model.frame(formula, rownames, variables, 
        varnames, extras, extranames, subset, na.action))

but what's keeping us from saying 
    data <- .Internal(model.frame(formula, rownames, variables, 
        varnames, extras, extranames, na.action))[subset,]

or ("Uncle Scrooge" version)

   data <- .Internal(model.frame(formula, rownames, variables[subset,], 
        varnames, extras[subset,], extranames, na.action))

(well, variables and extras are lists, not dataframes, but you get the
picture. Do we allow unequal length variables anyway?)

(6) since [subset,] seems to work, perhaps do_subset is what should be
called from inside do_modelframe?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Feb 18 16:52:15 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 18 Feb 1999 08:52:15 -0800 (PST)
Subject: model.frame mangles time series (PR#121)
In-Reply-To: <x2678zlkp6.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.10.9902180851110.2878-100000@wompom.biostat.washington.edu>

On 18 Feb 1999, Peter Dalgaard BSA wrote:

> 
> (6) since [subset,] seems to work, perhaps do_subset is what should be
> called from inside do_modelframe?

No, subset doesn't work -- it loses contrasts

R>  contrasts(df$x)
  [,1] [,2]
1    1    0
2    0    1
3   -1   -1
R> contrasts(df[1:5,]$x)
  2 3
1 0 0
2 1 0
3 0 1
 
	-thomas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From D.A.Wooff@durham.ac.uk  Thu Feb 18 17:09:33 1999
From: D.A.Wooff@durham.ac.uk (D.A.Wooff@durham.ac.uk)
Date: Thu, 18 Feb 1999 18:09:33 +0100
Subject: [R] possible bug in loglm (PR#122)
Message-ID: <199902181709.SAA12157@biostat.ku.dk>

Bug report: there is a problem with loglm (or some underlying code)
when used with updating within a function. For example, this code
works as expected, when used outside a function:


-------------------------------------------------
library(MASS)
cts<-c(25,13,99,45,128,78,151,153,173,171,49,62,1308,236,989,264,622,201,492,244,382,237,122,102,39,5,67,28,53,29,27,20,18,17,1,2,41,11,54,44,64,76,102,83,104,160,41,54,1232,321,1015,348,755,328,530,395,414,370,160,147,25,11,48,20,29,23,20,16,14,11,1,3)

foo<-cbind(expand.grid(f1=factor(c("A","B")),f2=factor(11:16),f3=factor(c("S","N","E")),f4=factor(c("F","M"))),cts=cts)

d0<-loglm(cts~f1+f2+f3+f4,data=foo)
d1<-update(d0,.~.^2)
-------------------------------------------------


but, unless d0 is visible outside the function, 
the same code does not work as expected when within a function:

-------------------------------------------------
rm(list=ls())
library(MASS)

tester<-function(){

cts<-c(25,13,99,45,128,78,151,153,173,171,49,62,1308,236,989,264,622,201,492,244,382,237,122,102,39,5,67,28,53,29,27,20,18,17,1,2,41,11,54,44,64,76,102,83,104,160,41,54,1232,321,1015,348,755,328,530,395,414,370,160,147,25,11,48,20,29,23,20,16,14,11,1,3)

foo<-cbind(expand.grid(f1=factor(c("A","B")),f2=factor(11:16),f3=factor(c("S","N","E")),f4=factor(c("F","M"))),cts=cts)

d0<-loglm(cts~f1+f2+f3+f4,data=foo)
d1<-update(d0,.~.^2)
}

tester()
-------------------------------------------------

results in the message:

Error: Object "foo" not found




David.

---------------------------------------------------------------------
  David Wooff, Director, Statistics and Mathematics Consultancy Unit,
  Department of Mathematical Sciences, University of Durham.
  Science Laboratories, South Road, Durham, DH1 3LE, UK.
  Tel. 0191 374 4531, Fax 0191 374 7388.
---------------------------------------------------------------------
  


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 18 17:27:11 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Feb 1999 18:27:11 +0100
Subject: model.frame mangles time series (PR#121)
In-Reply-To: Thomas Lumley's message of Thu, 18 Feb 1999 08:52:15 -0800 (PST)
References: <Pine.GSO.4.10.9902180851110.2878-100000@wompom.biostat.washington.edu>
Message-ID: <x23e43lj0w.fsf@blueberry.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> On 18 Feb 1999, Peter Dalgaard BSA wrote:
> 
> > 
> > (6) since [subset,] seems to work, perhaps do_subset is what should be
> > called from inside do_modelframe?
> 
> No, subset doesn't work -- it loses contrasts
> 
> R>  contrasts(df$x)
>   [,1] [,2]
> 1    1    0
> 2    0    1
> 3   -1   -1
> R> contrasts(df[1:5,]$x)
>   2 3
> 1 0 0
> 2 1 0
> 3 0 1

That can be fixed by a one-line change to [.factor :

> contrasts(df[1:3,]$x)
          .L   .Q         .C
1 -0.6708204  0.5 -0.2236068
2 -0.2236068 -0.5  0.6708204
3  0.2236068 -0.5 -0.6708204
4  0.6708204  0.5  0.2236068

I suspect that is the correct solution.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From venkat@biosta.mskcc.org  Thu Feb 18 18:08:28 1999
From: venkat@biosta.mskcc.org (venkat@biosta.mskcc.org)
Date: Thu, 18 Feb 1999 19:08:28 +0100
Subject: Text in plot (PR#123)
Message-ID: <199902181808.TAA12266@biostat.ku.dk>

I am trying to place a multi-line text in a plot.  R-0.63.2 on Linux however
writes only the first line.  Is this a known bug?  Example is given below.

R : Copyright 1999, The R Development Core Team
Version 0.63.2  (January 12, 1999)

> x11()
> plot(0,0)
> text(0,-0.5,"test \n line2")

Thanks,
Venkat
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-help mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-help-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Thu Feb 18 18:06:52 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Thu, 18 Feb 1999 18:06:52 +0000 (GMT)
Subject: [R] possible bug in loglm (PR#122)
Message-ID: <199902181806.SAA28066@toucan.stats.ox.ac.uk>


> From: D.A.Wooff@durham.ac.uk
> Date: Thu, 18 Feb 1999 18:09:33 +0100
> To: r-devel@stat.math.ethz.ch
> Subject: [R] possible bug in loglm (PR#122)
> CC: R-bugs@biostat.ku.dk
> X-Loop: R-bugs@biostat.ku.dk
> 
> Bug report: there is a problem with loglm (or some underlying code)
> when used with updating within a function. For example, this code
> works as expected, when used outside a function:

Well, loglm is not part of R per se, so I was a little surprised to see
this going to R-bugs. The answer is along the lines of `yes, we know,
this is part of the limitations of update and NextMethod', and this occurs
in S-PLUS too, and for lots of other applications of update. You could
alter update.loglm to be

update.loglm <- function (object, formula., ...) 
{
    setdiff <- function(x, y) if (length(x) == 0 || length(y) == 0) x
    else x[match(x, y, 0) == 0]
    if (is.null(call <- object$call)) 
        stop("object has no call component.  Updating not possible")
    if (fix <- !missing(formula.)) {
        object$formula <- denumerate(object$formula)
        formula. <- denumerate(formula.)
        call$formula <- update.formula(formula(object), formula.)
    }
    extras <- match.call(expand.dots = FALSE)$...
    if (length(extras) > 0) {
        existing <- !is.na(match(names(extras), names(call)))
        ## do these individually to allow NULL to remove entries.
        for (a in names(extras)[existing]) call[[a]] <- extras[[a]]
        if (any(!existing)) {
            call <- c(as.list(call), extras[!existing])
            call <- as.call(call)
        }
    }
    result <- eval(call, sys.frame(sys.parent()))
    if (fix) {
        form <- renumerate(result$formula)
        result$call$formula <- unclass(result$formula <- form)
    }
    result
}

that is to remove the NextMethod call.  But this sort of thing is quite
common, and the usual workaround is to make sure that the dataframe is visible.



-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 18 18:14:03 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Feb 1999 19:14:03 +0100
Subject: model.frame mangles time series (PR#121)
In-Reply-To: Peter Dalgaard BSA's message of 18 Feb 1999 18:27:11 +0100
References: <Pine.GSO.4.10.9902180851110.2878-100000@wompom.biostat.washington.edu> <x23e43lj0w.fsf@blueberry.kubism.ku.dk>
Message-ID: <x2zp6bk2ac.fsf@blueberry.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> That can be fixed by a one-line change to [.factor :
> 
> > contrasts(df[1:3,]$x)
>           .L   .Q         .C
> 1 -0.6708204  0.5 -0.2236068
> 2 -0.2236068 -0.5  0.6708204
> 3  0.2236068 -0.5 -0.6708204
> 4  0.6708204  0.5  0.2236068
> 
> I suspect that is the correct solution.

A quick check shows that S does the same, ergo: change committed.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jlindsey@alpha.luc.ac.be  Thu Feb 18 18:52:28 1999
From: jlindsey@alpha.luc.ac.be (jlindsey@alpha.luc.ac.be)
Date: Thu, 18 Feb 1999 19:52:28 +0100
Subject: library help (PR#87)
Message-ID: <199902181852.TAA13340@biostat.ku.dk>

Testing

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 18 18:57:00 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Feb 1999 19:57:00 +0100
Subject: library help (PR#87)
In-Reply-To: jlindsey@alpha.luc.ac.be's message of Thu, 18 Feb 1999 19:52:28 +0100
References: <199902181852.TAA13340@biostat.ku.dk>
Message-ID: <x2vhgzk0ar.fsf@blueberry.kubism.ku.dk>

jlindsey@alpha.luc.ac.be writes:

> Testing

OK, seems that I've finally squashed an embarassing bug I introduced in
JitterBug... 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Feb 18 22:17:19 1999
From: pgilbert@bank-banque-canada.ca (pgilbert@bank-banque-canada.ca)
Date: Thu, 18 Feb 1999 23:17:19 +0100
Subject: function.html gets clobbered (PR#18)
Message-ID: <199902182217.XAA13651@biostat.ku.dk>

>The changes I committed related to packages.html should also fix this
>problem ... please try.

Freidrich

I grabbed R-devel.tar.gz from fangorn.ci.tuwien.ac.at  at about 9pm GMT Thur.
Feb 18. It does not seem to have the problem fixed, but I'm not sure if that was
the version I was suppose to try.

I won't be at work tomorrow. I can try again Monday.

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Feb 20 16:31:21 1999
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 20 Feb 1999 16:31:21 +0000 (GMT)
Subject: Port of sm library, installing library components
Message-ID: <Pine.GSO.4.05.9902201610280.4961-100000@toucan.stats>

I have an almost complete port of the sm library/package (only things
depending on gam are not operational) at

http://www.stats.ox.ac.uk/pub/R/sm_1.0-1.tar.gz

Before I send it to CRAN, I would appreciate some help in checking that
you can install it. The problem is that the Fortran it uses on Solaris
calls a routine in a Fortran library not linked into R. I have a Makefile
(supplied but not the default) that works on Solaris, and I have no
problem with g77 on any of the platforms I have (Solarises, RH5.2-i586,
win32). If people who use a Fortran compiler other that g77 could try this
and let me know what is needed it would help me write more comprehensive
instructions.  Beware of lazy binding: the file Install tells you how to
run a test of the problematical routine.

Incidentally, the sm package includes a large number of S scripts that
need to be installed. I have cheated by putting these in the exec
sub-directory, but there appears to be no mechanism (except on Windows) to
use R INSTALL to install components other than R code, C/Fortran, exec
scripts and help. Should we have one? E.g.

cp -r packagesrc/install_extras/*  Rlibrary/packagename/

One advantage would be to make it easy for package packagers to specify
what they wanted to be distributed in all binary distributions. (I would
like to see the DESCRIPTION file installed so the version information is
always there, and in some packages, including sm, there is a Licence
file.)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From John.Peters@tip.csiro.au  Sun Feb 21 23:12:12 1999
From: John.Peters@tip.csiro.au (John.Peters@tip.csiro.au)
Date: Mon, 22 Feb 1999 00:12:12 +0100
Subject: scan rejects complex (PR#125)
Message-ID: <199902212312.AAA19317@biostat.ku.dk>


"Scan" does not currently accept mode "complex".  (Splus3.4 does).
The help file does not make plain the intention.
Version is 0.632.

#----------------------------------------
xx_1+2i
cat(xx,file="testfile1")

yy_scan("testfile1",what=complex()) 

print(yy)
print(mode(yy))

# Says: Error: "scan" invalid "what=" specified
# yy_as.complex(scan("testfile1",what=character())) # workaround
#----------------------------------------

Many thanks.

----------------------------------------------------------------------------
John Peters
CSIRO National Measurement Laboratory
PO Box 218                                Phone:    +61 2 9413 7503
Lindfield NSW 2070                        Fax:      +61 2 9413 7202
Australia                                 Internet: John.Peters@tip.CSIRO.AU
----------------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Mon Feb 22 09:03:42 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Mon, 22 Feb 1999 10:03:42 +0100 (CET)
Subject: Port of sm library, installing library components
In-Reply-To: <Pine.GSO.4.05.9902201610280.4961-100000@toucan.stats>
References: <Pine.GSO.4.05.9902201610280.4961-100000@toucan.stats>
Message-ID: <14033.7534.629426.653899@galadriel.ci.tuwien.ac.at>

>>>>> On Sat, 20 Feb 1999 16:31:21 +0000 (GMT),
>>>>> Prof Brian Ripley (PBR) wrote:


PBR> (I would
PBR> like to see the DESCRIPTION file installed so the version information is
PBR> always there,

good idea, committed the change.


.f



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Mon Feb 22 16:29:14 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Mon, 22 Feb 1999 17:29:14 +0100 (CET)
Subject: "as" functions should be generic
Message-ID: <XFMail.990222172914.plummer@iarc.fr>

It would be very useful if all "as.*" functions were generic,
so that a user who creates a new class can write methods to
coerce objects of that class to standard R objects.

In fact, most of the "as.*" functions are generic, but there
are a few that aren't:
as.array
as.factor
as.ordered
as.pairlist
as.formula
as.ts

It's actually "as.array" and "as.ts" that are a problem for
me, but I mention the others because this seems like a good
general principle.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Feb 23 07:50:29 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 23 Feb 1999 08:50:29 +0100 (CET)
Subject: "as" functions should be generic
In-Reply-To: <XFMail.990222172914.plummer@iarc.fr>
References: <XFMail.990222172914.plummer@iarc.fr>
Message-ID: <14034.24005.535659.918027@pc87.maho.magnaeu.com>

>>>>> Martyn Plummer writes:

> It would be very useful if all "as.*" functions were generic,
> so that a user who creates a new class can write methods to
> coerce objects of that class to standard R objects.

> In fact, most of the "as.*" functions are generic, but there
> are a few that aren't:
> as.array
> as.factor
> as.ordered
> as.pairlist
> as.formula
> as.ts

> It's actually "as.array" and "as.ts" that are a problem for
> me, but I mention the others because this seems like a good
> general principle.

This may be a good idea.

-k

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From khal@alumni.uv.es  Wed Feb 24 20:54:47 1999
From: khal@alumni.uv.es (Kjetil Halvorsen)
Date: Wed, 24 Feb 1999 21:54:47 +0100
Subject: An idea for something better than read.table
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk>
Message-ID: <36D46716.4819BF52@alumni.uv.es>

It is nice if data files can have formats not to heavily
dependent on the package.  What I do to read in data is
having data (whith header) in, say, data.dat, and then data.R
with the commands for defining factors, levels, contrast or
whatever. That seems cleaner than mixing in one file data and
definitions.

Kjetil Halvorsen


Peter Dalgaard BSA wrote:
> 
> I was recently converting some datasets for use in an R package and it
> occurred to me that there really is no "neat" way to input a data
> frame if it is to contain factor variables.
> 
> One can use dput()/source or dump() after massaging data into the
> right format, of course, but there isn't really anything which allows
> you to store the input instructions with the data beyond the simple
> header=T type format.
> 
> So I thought of ways to enhance the header. The best idea I've been
> able to come up with this far is to
> 
> (a) Write a function - basically an extension of scan() - which allows
>     you to specify the column data type in more detail. Let's call it
>     data.file() for now. It would pretty much have to deparse all of
>     its arguments and interpret things in slightly unusual ways, but R
>     can do that, and some of functions (notably help() and data())
>     already play this kind of game with the parser...
> 
> (b) Have a function, say read(), which parses the 1st expression in a
>     file and executes it *with the remainder of the file as the
>     argument*. (Currently, this is impossible, but it would be if
>     one just kept track of the line number while parsing. parse()
>     could stick it on as an attribute of the parsed expression list if
>     asked to do so.)
> 
> This would make a file format something like the following possible.
> 
> [There's another loose idea in there involving a control item to handle
> separators, na.strings, etc. - the intention being that read() plugs
> in the file= and skip= arguments for the actual call.]
> 
> Would this be an approach worth pursuing?
> 
> --- Top of file ---
> data.file(control(sep="w",na="."),
>         Item = factor(levels=1:4,labels=c("A","B","C","D")),
>         Size = numeric(),
>         Year = factor(levels=1980:1985)
> )
> 1       0     1980
> 1       10    1981
> 1       14    1982
> 1       20    1983
> 1       25    1984
> 1       30    1985
> 2       0     1980
> 2       5     1981
> 2       6     1982
> 2       8     1984
> 3       0     1984
> 3       2     1985
> 4       0     1980
> 4       20    1981
> 4       30    1982
> 4       30    1984
> 4       35    1985
> --- End of file ---
> 
> --
>    O__  ---- Peter Dalgaard             Blegdamsvej 3
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@hal.stat.unipd.it (Guido Masarotto)  Wed Feb 24 22:26:11 1999
From: guido@hal.stat.unipd.it (Guido Masarotto) (Guido Masarotto)
Date: Wed, 24 Feb 1999 23:26:11 +0100
Subject: [R] rw0632 makes stray .Rhistory orphans
In-Reply-To: <36D4644A.2C61BFC9@alumni.uv.es>; from Kjetil Halvorsen on Wed, Feb 24, 1999 at 09:42:50PM +0100
References: <000001be5f1c$ef0b70e0$6f1abb81@fenris> <19990223134026.06314@hal.stat.unipd.it> <36D4644A.2C61BFC9@alumni.uv.es>
Message-ID: <19990224232611.16861@hal.stat.unipd.it>

On Wed, Feb 24, 1999 at 09:42:50PM +0100, Kjetil Halvorsen wrote:
> Opened the tema, another small mal-function which could be easily
> repaired:  When sourcing a file from the menu, the working directory
> (HOME?) changes to the files directory, then leaving R the Rdata
> gets saved in the wrong place! I feel that sourcing shouldnt change
> HOME, it surprised me more than once.
> 
  K.,
  I think you are perfectly right.
  Any opinion by others before I change the source?
  And, what about loading and saving the workspaces?
  I haven't checked but since code is essentialy the same
  I suppose behaviour is the same  and, hence, it must be
  changed too.

  g. 
  
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Feb 25 17:06:05 1999
From: thomas@biostat.washington.edu (thomas@biostat.washington.edu)
Date: Thu, 25 Feb 1999 18:06:05 +0100
Subject: locator() and log axes (PR#126)
Message-ID: <199902251706.SAA30920@biostat.ku.dk>

In both the versions of 0.63.3 I have compiled locator() gives silly
results for log axes eg

> plot(1:10,log="x")
> locator(1) #click on the point at (4,4)
$x
[1] 9694.383

$y
[1] 4.034130

It appears that the x coordinate is 10^right number -- it's getting
unlogged twice
	

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = in progress
 status.rev = 0
 major = 0
 minor = 63.3
 year = 1999
 month = February
 day = 24
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 25 17:28:10 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 25 Feb 1999 18:28:10 +0100
Subject: locator() and log axes (PR#126)
In-Reply-To: thomas@biostat.washington.edu's message of Thu, 25 Feb 1999 18:06:05 +0100
References: <199902251706.SAA30920@biostat.ku.dk>
Message-ID: <x2678q2y1h.fsf@blueberry.kubism.ku.dk>

thomas@biostat.washington.edu writes:

> In both the versions of 0.63.3 I have compiled locator() gives silly
> results for log axes eg
> 
> > plot(1:10,log="x")
> > locator(1) #click on the point at (4,4)
> $x
> [1] 9694.383
> 
> $y
> [1] 4.034130
> 
> It appears that the x coordinate is 10^right number -- it's getting
> unlogged twice

Exactly. Fixed for 0.63.3.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Feb 26 11:22:27 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 26 Feb 1999 12:22:27 +0100
Subject: An idea for something better than read.table
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk> <36D46716.4819BF52@alumni.uv.es>
Message-ID: <36D683F3.E0B49464@iarc.fr>

Kjetil Halvorsen wrote:
> 
> It is nice if data files can have formats not to heavily
> dependent on the package.  What I do to read in data is
> having data (whith header) in, say, data.dat, and then data.R
> with the commands for defining factors, levels, contrast or
> whatever. That seems cleaner than mixing in one file data and
> definitions.
> 

If you want a file format for R datasets which describe their
own metadata, it might be worth thinking about defining it in
XML.

This probably goes a long way beyong Peter's suggestion, but
presumably it could be done in the same way, by adding a header
to the top of a data file. It does leave open the possibility
that other statistical packages will be able to read the data
and extract any meta data (storage type, variable labels, value
labels, ...) they want to use.

I have been thinking for a long time that it would be nice if
statistical packages could exchange datasets using a common
file format and (unless I have drastically misunderstood) XML
seems the way to go.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rossini@biostat.washington.edu  Fri Feb 26 14:15:17 1999
From: rossini@biostat.washington.edu (A.J. Rossini)
Date: 26 Feb 1999 06:15:17 -0800
Subject: An idea for something better than read.table
In-Reply-To: Martyn Plummer's message of "Fri, 26 Feb 1999 12:22:27 +0100"
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk> <36D46716.4819BF52@alumni.uv.es> <36D683F3.E0B49464@iarc.fr>
Message-ID: <877lt5dzey.fsf@alpha.cfas.washington.edu>


>>>>> "MP" == Martyn Plummer <plummer@iarc.fr> writes:

    MP> If you want a file format for R datasets which describe their
    MP> own metadata, it might be worth thinking about defining it in
    MP> XML.

Maybe...

    MP> This probably goes a long way beyong Peter's suggestion, but
    MP> presumably it could be done in the same way, by adding a
    MP> header to the top of a data file. It does leave open the
    MP> possibility that other statistical packages will be able to
    MP> read the data and extract any meta data (storage type,
    MP> variable labels, value labels, ...) they want to use.

The only caveat is that your data set looks like an HTML(SGML) file.
However, there are parsers for nearly any language (well, Java, C++,
C, PERL, and Python come to mind), which are nicely licensed.

Writing out the XML DTD for statistical datasets (and for
communicating the need for procedures of a certain type on those
datasets) has been simmering in the back of my mind for a while, now.
I'd be interested in hearing from anyone else who has been playing
with XML for passing data (my application is for inter-stat package
communication, but might not be bad for with-in package communication,
but it needs a bit more exploration).

It would also lead to WWW-friendly processing :-).

best,
-tony

-- 
A.J. Rossini
UW Biostatistics & Center for AIDS Research 
206-543-1044 / 206-720-4282                 
rossini@biostat.washington.edu              
http://www.biostat.washington.edu/~rossini/ 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rcreecy@census.gov  Fri Feb 26 17:08:46 1999
From: rcreecy@census.gov (Rob Creecy)
Date: Fri, 26 Feb 1999 12:08:46 -0500
Subject: XML for Data
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk> <36D46716.4819BF52@alumni.uv.es> <36D683F3.E0B49464@iarc.fr> <877lt5dzey.fsf@alpha.cfas.washington.edu>
Message-ID: <36D6D51E.6AF2410D@census.gov>

A.J. Rossini wrote:
> 

> I'd be interested in hearing from anyone else who has been playing
> with XML for passing data (my application is for inter-stat package
> communication, but might not be bad for with-in package communication,
> but it needs a bit more exploration).
> 
> It would also lead to WWW-friendly processing :-).
>

I got some of the following information from Dan Gillman at the
Census Bureau that is related. As you might imagine, we are very
interested in any technology that might help in the exchange of
data between statistical packages, the publishing of data on the WWW,
and making data more useful to a wider audience.
 
The Data Documentation Initiative sponsored by ICPSR (Univ of Mich) 
is a statistical data set documentation standard written as an XML DTD.  
Marty Appel and Dan Gillman here at the Census Bureau are on the
committee
that is developing the work.  There is a web site at
http://www.icpsr.umich.edu/DDI.

Unisys has software for converting a UML model to an XML DTD through the
use of XML.

The San Diego Supercomputer Center (SDSC) has  a variety of projects
related to 
describing data with XML. See http://www.npaci.edu/DICE/MIX/index.html 

Rob Creecy
Statistical Research Division
U.S. Bureau of the Census
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From naras@stat.Stanford.EDU  Fri Feb 26 22:34:04 1999
From: naras@stat.Stanford.EDU (Balasubramanian Narasimhan)
Date: Fri, 26 Feb 1999 14:34:04 -0800 (PST)
Subject: XML for Data
In-Reply-To: Your message of "Fri, 26 Feb 1999 12:08:46 -0500"
 <36D6D51E.6AF2410D@census.gov>
References: <36D6D51E.6AF2410D@census.gov>
Message-ID: <19990226143404V.naras@stat.Stanford.EDU>


Sometime ago, I  created a DTD for the Omega  project as an experiment
and was able to  parse it and convert it to a  DOM as was needed using
some freely available IBM tools. 

However, it was quite experimental and the design clearly reflected my
own frustrations  with dealing  with Intro Stat  text books  data. Time
constraints prevented me from really using it in Fall 1998, especially
because software was not readily available as it is now.

The combination of  XML and Java is especially  seamless. IBM, Sun all
provide automatic tools for creating DOMs. 

The DDI  project sounds  interesting and I  think input from  us would
really be nice. 

________________________________________________________________
B. Narasimhan                            naras@stat.stanford.edu
                             http://www-stat.stanford.edu/~naras





-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jmhughes@globalnet.co.uk  Sat Feb 27 20:32:59 1999
From: jmhughes@globalnet.co.uk (jmhughes@globalnet.co.uk)
Date: Sat, 27 Feb 1999 21:32:59 +0100
Subject: history (PR#127)
Message-ID: <199902272032.VAA04276@biostat.ku.dk>

Full_Name: john hughes
Version: 0.63
OS: Linux 4.2
Submission from: 195.147.221.243 (195.147.221.243)


Unable to get previous commands(history)using the cursor key. Cursor UP Arrow
Key produces '[A' or something similar backspace produces '[B'. No .Rprofile or
.B file created on installation.  I've tried creating them but couldn't find out
what commands to put in to get previous commands recalled. This didn't happen
with version 0.43 under Linux 4.1. 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Feb 28 00:08:12 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Feb 1999 01:08:12 +0100
Subject: history (PR#127)
In-Reply-To: jmhughes@globalnet.co.uk's message of Sat, 27 Feb 1999 21:32:59 +0100
References: <199902272032.VAA04276@biostat.ku.dk>
Message-ID: <x2btifcrv7.fsf@blueberry.kubism.ku.dk>

jmhughes@globalnet.co.uk writes:

> Full_Name: john hughes
> Version: 0.63
> OS: Linux 4.2
> Submission from: 195.147.221.243 (195.147.221.243)
> 
> 
> Unable to get previous commands(history)using the cursor key. Cursor UP Arrow
> Key produces '[A' or something similar backspace produces '[B'. No .Rprofile or
> .B file created on installation.  I've tried creating them but couldn't find out
> what commands to put in to get previous commands recalled. This didn't happen
> with version 0.43 under Linux 4.1. 

You may need a newer version of the readline library. Current versions
of R needs readline-2.1 or better.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Feb 28 08:57:50 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sun, 28 Feb 1999 09:57:50 +0100
Subject: Formatting in formatC and format (PR#129)
Message-ID: <199902280857.JAA04735@biostat.ku.dk>

[This turned into a bug report which will go to r-devel, so I have taken it
off r-help.]

Bugs reported here:

(1) formatC's help page need some clarification.

(2) formatC needs to treat modes "double" and "real" as equivalent.

(3) format's help page or (preferably) format needs correction re the
meaning of `digits'


On Sun, 28 Feb 1999, Martin Maechler wrote:

> >>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

`should not 5.96 print as 6.0 with 2 dignificant digits?'

>     BDR> S-PLUS has an option nsmall to format to do precisely this, and
>     BDR> there was a question asking how to do it on s-news today.  I have
>     BDR> thought for a while that we need to implement something like this
>     BDR> in R: maybe I had better do it....
> 
> Is it necessary?

Yes, as I want to do things that C's printf does not do, AFAIK.

> In R, we've always been having   formatC(.) as an alternative to format(.)
> allowing more precise formatting specifications.
> However, maybe I didn't understand what yuo were alluding to..

I find formatC useful (if hard to understand) but it does not in my hands
do what I want. I don't think formatC's help page defines precisely what it
does. In particular, it does not say what format=NULL, the default, does.  
So if I try

formatC(6.0, digits=1)
[1] " 6"

I do not get what I expected. It looks as if I need

formatC(6.0, digits=1, format="f")
[1] "6.0"

My guess is that the default is "g" for doubles. (I also find that what 
happens when I give format="g" for an integer and or give the `wrong' mode
is not defined or even inconsistent:

> formatC(as.integer(12345678), mode="real")
Error: `type' must be "real" for this format
> formatC(as.integer(12345678), mode="double")
[1] "1.235e+07"
> formatC(as.integer(12345678), mode="double", format="d")
[1] "12345678"

What are the rules here?)

The help page for formatC references the pre-ANSI C 2nd edition of
Kernighan & Ritchie, but I think the ANSI standard is that same. There is a
reference to leading zeroes, none to trailing zeroes. I believe printf can
be system-dependent (and some of it certainly is: win32 libraries use
n.ddde+nnn and Solaris ones use n.ddde+nn not n.dddenn as your help page
says).  I think, pessimistically, that it is not safe to rely on how the C
runtime library does this.


BTW, there is a trick here:

format(c(5.9, 6.0), digits=2)[-1]
[1] "6.0"

does what Dr Carsten wanted (but see later for the meaning of digits=2).


In any case, 

formatC(6.01, digits=1, format="f")
[1] "6.0"

is not what I am looking for, but (from S-PLUS)

> format(6.0, nsmall=1)
[1] "6.0"
> format(6.01, nsmall=1)
[1] "6.01"


Here is something else I find useful, and I think R is not as documented:
In S-PLUS I get (by default) alignment on the (implied) decimal point:

> format(c(6.11, 13.1), digits=2)
[1] " 6.1" "13  "

whereas in R

> format(c(6.11, 13.1), digits=2)
[1] " 6.1" "13.1"

Now R says (?format)

  digits: how many significant digits are to be used for `numeric x'.

but that is not what happens.  And I can't see how to do this in formatC:

> formatC(c(6.11, 13.1), digits=2, format="fg")
[1] "6.1" " 13"

as the alignment is wrong.  I think in print/format, digits=2 means that
data are rounded so that the smallest (in magnitude) number has two
significant digits, and then the result is converted dropping trailing
zeroes, as in

> format(c(6.0, 13.1), digits=2)
[1] " 6" "13"

(That is what S-PLUS gives too, aargh.)


Another, minor, point: format is generic and can be applied to lists,
for example, whereas formatC cannot.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Feb 28 20:45:45 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Sun, 28 Feb 1999 21:45:45 +0100
Subject: lty=0 -- shouldn't it give an invisible line? (PR#130)
Message-ID: <199902282045.VAA04952@biostat.ku.dk>


Currently, it seems that setting lty=0 gives a solid line in most
contexts (lines(), e.g.) but a strangely dotted-dash line in others
(axis()). This shows up on barplots, and looks fairly odd:

x<-c(a=1,b=2,c=3)
barplot(x)

barplot() is doing an axis(...,lty=0), presumably with the intention
of plotting the labels, but not the actual axis.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ben@eno.Princeton.EDU  Mon Feb  1 16:59:18 1999
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Mon, 1 Feb 1999 11:59:18 -0500 (EST)
Subject: PostScript bugs in R-0.63.1
Message-ID: <Pine.SUN.3.95.990201111153.607A-100000@paca>


  I have a minor problem with the PostScript generated by R-0.63.1.

  Specifically, the files generated *will* work in:

    ghostview
    on an HP LaserJet
    on an Apple LaserWriter

  *will not* work in:

     ghostscript under xdvi
     on a SPARCprinter
 
  The error message on the SPARCprinter was

Error: /invalidfont
Command: 'definefont'
Ostack: /Font5 /Font5 font(Symbol,1)
Estack:
  [and quite a bit more ...]

  This was a picture with no Symbol font involved, so I was able to
comment out the following line:

%/Font5 /Symbol findfont definefont

and then the PostScript worked under xdvi and on the SPARCprinter.

  Any ideas?

  A meta-question: should I submit this to the bug-tracking system 1) in
addition 2) instead of sending to R-devel?  It seems the bug-tracking
system isn't heavily used, and that its value is proportional to how much
it's used (otherwise you just have to search the R-devel and R-help
archives).

  thanks,
    Ben Bolker

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Feb  1 17:26:22 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 01 Feb 1999 18:26:22 +0100
Subject: PostScript bugs in R-0.63.1
In-Reply-To: Ben Bolker's message of Mon, 1 Feb 1999 11:59:18 -0500 (EST)
References: <Pine.SUN.3.95.990201111153.607A-100000@paca>
Message-ID: <x2btjef329.fsf@blueberry.kubism.ku.dk>

Ben Bolker <ben@eno.princeton.edu> writes:

>   A meta-question: should I submit this to the bug-tracking system 1) in
> addition 2) instead of sending to R-devel?  It seems the bug-tracking
> system isn't heavily used, and that its value is proportional to how much
> it's used (otherwise you just have to search the R-devel and R-help
> archives).

Well, the difference between R-bugs and R-devel is that bugs are
remembered if entered into the former. Bugs on the mailing lists tend
to get "now-or-never" service.

Noone is going through months of mailing list traffic to check whether
all reported problems have been fixed. I try to make mental notes of
what I see, but my DRAM chips seems to need frequent refresh. I'm sure
many of the others feel likewise. I do, however, take an occasional
stroll through the bug repository and check for fixed bugs, sort the
incoming ones, and sometimes also make a stab at analysing/fixing some
of them.

I'm currently looking at the R-bugs interface to see if it would be
possible to redirect all traffic on R-bugs through R-devel (except
"private" messages, which go to the core team only, of course). It's a
little sticky, because it requires changes to the Jitterbug sources,
but it doesn't look hopeless at all.

That way, there would be no excuse for not using R-bugs, and R-devel
may turn into a somewhat more constructive[*] forum than it is at the
moment. The bug.report() function has also been substantially improved
for 0.63.3, BTW.

[*] I know, everyone in here is doing their best to chip in to the R
development. The problem is rather the opposite: discussions tending
to remain within the core team.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Ted.Harding@nessie.mcc.ac.uk  Mon Feb  1 17:58:27 1999
From: Ted.Harding@nessie.mcc.ac.uk ( (Ted Harding))
Date: Mon, 01 Feb 1999 17:58:27 -0000 (GMT)
Subject: PostScript bugs in R-0.63.1
In-Reply-To: <Pine.SUN.3.95.990201111153.607A-100000@paca>
Message-ID: <XFMail.990201175827.Ted.Harding@nessie.mcc.ac.uk>

On 01-Feb-99 Ben Bolker wrote:
> 
>   I have a minor problem with the PostScript generated by R-0.63.1.
>   Specifically, the files generated *will* work in:
> 
>     ghostview; on an HP LaserJet; on an Apple LaserWriter
> 
>   *will not* work in:
> 
>      ghostscript under xdvi; on a SPARCprinter
>  
>   The error message on the SPARCprinter was
> 
> Error: /invalidfont
> Command: 'definefont'
> Ostack: /Font5 /Font5 font(Symbol,1)
> Estack:
>   [and quite a bit more ...]

This looks (especially since it sometimes works & sometimes doesn't) like
a PostScript Level-1 vs Level-2 issue.

definefont:  key font definefont font
...
In Level-2 it is permissible to associate a font dictionary with more
than one key. If /font/ has already been registered, definefont does
not alter it in any way
(PostScript Language Ref Manual)

The "invalidfont" error can arise "on discovering that a font dictionary
is malformed".

I don't know the details of R's PS implementation; however, if it is
using definefont attempting to register more than one key for the Symbol
font then that would be consistent with your results. Ghostscript and
ghostview should both be able to handle Level-2; I'm not sure why
ghostscript under xdvi should not be able to (unless xdvi somehow
inhibits it). Apart from that, the observed behaviour is compatible with
HPLJ and AppleLW being Level-2, while the SPARCprinter is Level-1.

Good PostScript code tests the value of "languagelevel": OK if =2, else
if =1 or if undefined in systemdict then Level-2 features may not work
and alternative Level-1 code should be executed (and of course needs to
be supplied in the file ... ).

Ted.

--------------------------------------------------------------------
E-Mail: (Ted Harding) <Ted.Harding@nessie.mcc.ac.uk>
Date: 01-Feb-99                                       Time: 17:58:27
------------------------------ XFMail ------------------------------
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Arne.Kovac@uni-essen.de  Tue Feb  2 00:35:39 1999
From: Arne.Kovac@uni-essen.de (Arne Kovac)
Date: Tue, 2 Feb 1999 01:35:39 +0100 (NFT)
Subject: PostScript bugs in R-0.63.1
In-Reply-To: <XFMail.990201175827.Ted.Harding@nessie.mcc.ac.uk>
Message-ID: <Pine.A41.4.02.9902020132140.20020-100000@gauss.mathematik.uni-essen.de>

On Mon, 1 Feb 1999, Ted.Harding wrote:

> On 01-Feb-99 Ben Bolker wrote:
> 
> I don't know the details of R's PS implementation; however, if it is
> using definefont attempting to register more than one key for the Symbol
> font then that would be consistent with your results. Ghostscript and
> ghostview should both be able to handle Level-2; I'm not sure why
> ghostscript under xdvi should not be able to (unless xdvi somehow
> inhibits it). Apart from that, the observed behaviour is compatible with
> HPLJ and AppleLW being Level-2, while the SPARCprinter is Level-1.

I have similar problems with R 0-63.1 and LaTeX even without xdvi: after
compiling my LaTeX-document with latex and dvips I can't view it with
ghostview 1.5 anymore due to some error messages. Printing on a Laserjet
4MP works.

Arne

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jean@stat.ubc.ca  Tue Feb  2 20:38:35 1999
From: jean@stat.ubc.ca (Jean Meloche)
Date: Tue, 02 Feb 1999 20:38:35 +0000
Subject: Suggestion
Message-ID: <36B7624B.80E92237@stat.ubc.ca>

I have to write extensions to R regularly.

One of them was an interface to a mysql database on a
different computer. The best way to do that is to have
something like

mysql<-function (dbname, host = "zap", user = "nobody", password = "ok") 
{
    handle <<- .RC("mysqlconnect", c(host, user, password, dbname))
}

and

query<-function (cmd) 
{
    .RC("mysqlquery", handle, cmd)
}

In other words, my mysql (written in C) functions return a true R object.
The .RC function above simply calls the C funtion, passing R objects as
arguments and returns the R object created within the C function.

I think that R should give the ability to write C functions that build
R objects. Eventually, it would be best to have an API to standardize
the process of building R object too...

I'd like to see .RC added to the standard R distribution. Right now, I'm
applying my patch every time I upgrade R. Here is my diff


diff -r R-0.63/src/main/dotcode.c R-0.63.orig/src/main/dotcode.c
264,286d263
< SEXP do_dotRCode(SEXP call, SEXP op, SEXP args, SEXP env)
< {
<       DL_FUNC fun;
<       char buf[128], *p, *q, *vmax;
<       SEXP retval;
<
<       vmax = vmaxget();
<       op = CAR(args);
<       if (!isString(op)) errorcall(call,"function name must be a string\n");
<
<       /* make up load symbol & look it up */
<       p = CHAR(STRING(op)[0]);
<       q = buf; while ((*q = *p) != '\0') { p++; q++; }
<
<       if (!(fun=R_FindSymbol(buf))) errorcall(call,
<               "C-R function not in load table\n");
<
<       retval=fun(args);
<
<       vmaxset(vmax);
<       return retval;
< }
<
969c946
<       }
---
>         }
diff -r R-0.63/src/main/names.c R-0.63.orig/src/main/names.c
497d496
< {".RC",         do_dotRCode,    0,      1,      -1,     PP_FOREIGN},
diff -r R-0.63/src/main/names.h R-0.63.orig/src/main/names.h
128d127
< SEXP do_dotRCode(SEXP, SEXP, SEXP, SEXP);


If it is of interest, I could also provide the module that implements
the mysql interface.

Many thanks.

-- 
Jean Meloche
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Feb  5 08:03:32 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 5 Feb 1999 09:03:32 +0100
Subject: Installing R programs (PROBLEMS !!!!)
In-Reply-To: <36B9DF9B.C76F5A86@ime.unicamp.br> (samira@ime.unicamp.br)
References: <36B9DF9B.C76F5A86@ime.unicamp.br>
Message-ID: <199902050803.JAA08173@sophie.ethz.ch>

[forwarded to R-devel, where this really belongs]

>>>>> "Samira" == Samira M Ismail <samira@ime.unicamp.br> writes:

(to me in a private mail)

    Samira> We have been trying to install R.0.63 for Unix (SunOS 4.1.4 -
    Samira> SPARC 20) and we detected the following problem which makes
    Samira> impossible to run R.  We have got the following message:

    Samira> =======

    Samira> gcc -g -O2 -I../include -I../../src/include -c sunif.c -o sunif.o
    Samira> sunif.c: In function `unif_rand':
    Samira> sunif.c:131: `RAND_MAX' undeclared (first use this function)
    Samira> sunif.c:131: (Each undeclared identifier is reported only once
    Samira> sunif.c:131: for each function it appears in.)
    Samira> sunif.c: In function `Randomize':
    Samira> sunif.c:213: `NULL' undeclared (first use this function)
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `sunif.o'
    Samira> Current working directory /usr/R-0.63.1/src/nmath
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `R'
    Samira> Current working directory /usr/R-0.63.1/src
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `R'

Both  NULL  and  RAND_MAX   are ANSI C.
      (p.102)	 (p.252)    of my Kernighan & Ritchie, 2nd. ed.
      <stdio.h>	 <stdlib.h>

However, I've experienced myself and heard more than once that
SunOS 4.x.x  has always had broken header (*.h) files.
Actually I had thought that the headers that come with gcc would 
``ifdef around these''...

Anyway,  add the following lines to your  src/include/Platform.h

#ifndef NULL
#define	NULL	0
#endif

#ifndef RAND_MAX
#define	RAND_MAX	32767
#endif

(or just to the beginning of src/nmath/sunif.c).

-----------

Kurt, could we add this bug-workaround to configure.in and Platform.in
such that something like

#ifdef SunOS4
/*-- define missing ANSI C --*/
#define	NULL	0
#define	RAND_MAX	32767
#endif

---
Un(?)fortunately, I haven't had access to SunOS4 machines for more than a
year now.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Feb  5 08:04:41 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 5 Feb 1999 09:04:41 +0100
Subject: [Fwd] Problems installing R on SunOS 4.1.4
In-Reply-To: <36B9DF9B.C76F5A86@ime.unicamp.br> (samira@ime.unicamp.br)
References: <36B9DF9B.C76F5A86@ime.unicamp.br>
Message-ID: <199902050804.JAA08175@sophie.ethz.ch>

[forwarded to R-devel, where this really belongs]

>>>>> "Samira" == Samira M Ismail <samira@ime.unicamp.br> writes:

(to me in a private mail)

    Samira> We have been trying to install R.0.63 for Unix (SunOS 4.1.4 -
    Samira> SPARC 20) and we detected the following problem which makes
    Samira> impossible to run R.  We have got the following message:

    Samira> =======

    Samira> gcc -g -O2 -I../include -I../../src/include -c sunif.c -o sunif.o
    Samira> sunif.c: In function `unif_rand':
    Samira> sunif.c:131: `RAND_MAX' undeclared (first use this function)
    Samira> sunif.c:131: (Each undeclared identifier is reported only once
    Samira> sunif.c:131: for each function it appears in.)
    Samira> sunif.c: In function `Randomize':
    Samira> sunif.c:213: `NULL' undeclared (first use this function)
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `sunif.o'
    Samira> Current working directory /usr/R-0.63.1/src/nmath
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `R'
    Samira> Current working directory /usr/R-0.63.1/src
    Samira> *** Error code 1
    Samira> make: Fatal error: Command failed for target `R'

Both  NULL  and  RAND_MAX   are ANSI C.
      (p.102)	 (p.252)    of my Kernighan & Ritchie, 2nd. ed.
      <stdio.h>	 <stdlib.h>

However, I've experienced myself and heard more than once that
SunOS 4.x.x  has always had broken header (*.h) files.
Actually I had thought that the headers that come with gcc would 
``ifdef around these''...

Anyway,  add the following lines to your  src/include/Platform.h

#ifndef NULL
#define	NULL	0
#endif

#ifndef RAND_MAX
#define	RAND_MAX	32767
#endif

(or just to the beginning of src/nmath/sunif.c).

-----------

Kurt, could we add this bug-workaround to configure.in and Platform.in
such that something like

#ifdef SunOS4
/*-- define missing ANSI C --*/
#define	NULL	0
#define	RAND_MAX	32767
#endif

---
Un(?)fortunately, I haven't had access to SunOS4 machines for more than a
year now.

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum SOL G1;	Sonneggstr.33
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1086			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From me@naxgul.kais.kyoto-u.ac.jp  Sat Feb  6 12:24:01 1999
From: me@naxgul.kais.kyoto-u.ac.jp (Yusuke Uchiyama)
Date: Sat, 6 Feb 1999 12:24:01 GMT
Subject: Partial implementation of "symbols"
Message-ID: <199902061224.MAA00206@naxgul.kais.kyoto-u.ac.jp>

Hello, 

I partially implemented the function "symbols". I would like to know if there have been already other person doing so. If not, would you please check my implementation and, if acceptable, please use it. I would like to implement other arguments if my function is accepted.

P.S. I am very glad to find that R is added to the software page of GNU web site. 

Yusuke Uchiyama
yusuke@kais.kyoto-u.ac.jp

---cut here---

"symbols" <-
function (x, y = NULL, squares = NULL, rectangles = NULL, add = FALSE, 
    inches = TRUE, ...) 
{
    if (is.list(x)) {
        y <- x[[2]]
        x <- x[[1]]
    }
    if (is.array(x)) {
        y <- x[, 2]
        x <- x[, 1]
    }
    if (!is.null(rectangles)) {
        symbols.rectangles(x, y, rectangles = rectangles, ...)
        invisible()
    }
    if (!is.null(squares)) {
        symbols.squares(x, y, squares = squares, ...)
        invisible()
    }
}

"symbols.rectangles" <-
function (x, y, rectangles, add = FALSE, inches = TRUE, ...) 
{
    xleft <- x - rectangles[1, ]/2
    ybottom <- y - rectangles[2, ]/2
    xright <- x + rectangles[1, ]/2
    ytop <- y + rectangles[2, ]/2
    if (add == FALSE) {
        plot.new()
        xlim <- c(min(xleft), max(xright))
        ylim <- c(min(ybottom), max(ytop))
        plot.window(xlim, ylim)
    }
    rect(xleft, ybottom, xright, ytop, ...)
    invisible()
}

"symbols.squares" <-
function (x, y, squares, add = FALSE, inches = TRUE, ...) 
{
    xleft <- x - squares/2
    ybottom <- y - squares/2
    xright <- x + squares/2
    ytop <- y + squares/2
    if (add == FALSE) {
        plot.new()
        xlim <- c(min(xleft), max(xright))
        ylim <- c(min(ybottom), max(ytop))
        plot.window(xlim, ylim)
    }
    rect(xleft, ybottom, xright, ytop, ...)
    invisible()
}



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Sat Feb  6 09:50:37 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Sat, 6 Feb 1999 10:50:37 +0100
Subject: Install R-0.63.1 on Solaris7
In-Reply-To: <36BB9B7F.1926@math.ubc.ca> (message from Yoko Wong on Fri, 05
 Feb 1999 17:31:43 -0800)
References: <36BB9B7F.1926@math.ubc.ca>
Message-ID: <199902060950.KAA04765@florence.ethz.ch>

(Again: 
	please send these things to  R-devel or R-help !!)

>>>>> "Yoko" == Yoko Wong <yoko@math.ubc.ca> writes:

    Yoko> Dear Martin,
    Yoko> I run into following errors when I try to compile R-0.63.1 on
    Yoko> Solaris7.  

>From all I see in the following, this looks like a Solaris 7 bug.
I don't have access to this OS.   

Anyone else ?

    Yoko> **********
    Yoko> /usr/include/sys/tihdr.h:458: warning: no semicolon at end of
    Yoko> struct or union
    Yoko> /usr/include/sys/tihdr.h:459: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:460: parse error before `SRC_offset'
    Yoko> /usr/include/sys/tihdr.h:460: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:461: parse error before `OPT_length'
    Yoko> /usr/include/sys/tihdr.h:461: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:462: parse error before `OPT_offset'
    Yoko> /usr/include/sys/tihdr.h:462: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:468: parse error before `t_scalar_t'
    Yoko> /usr/include/sys/tihdr.h:468: warning: no semicolon at end of
    Yoko> struct or union
    Yoko> /usr/include/sys/tihdr.h:469: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:470: parse error before `DEST_offset'
    Yoko> /usr/include/sys/tihdr.h:470: warning: data definition has no type
    Yoko> or storage class
    Yoko> /usr/include/sys/tihdr.h:471: parse error before `OPT_length'
    Yoko> *****

    Yoko> Is this version support Solaris7.


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Feb  6 11:11:18 1999
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 6 Feb 1999 11:11:18 +0000 (GMT)
Subject: Install R-0.63.1 on Solaris 7
In-Reply-To: <199902060950.KAA04765@florence.ethz.ch>
Message-ID: <Pine.GSO.4.05.9902061104150.12417-100000@toucan.stats>

On Sat, 6 Feb 1999, Martin Maechler wrote:

> (Again: 
> 	please send these things to  R-devel or R-help !!)
> 
> >>>>> "Yoko" == Yoko Wong <yoko@math.ubc.ca> writes:
> 
>     Yoko> Dear Martin,
>     Yoko> I run into following errors when I try to compile R-0.63.1 on
>     Yoko> Solaris7.  
> 
> >From all I see in the following, this looks like a Solaris 7 bug.
> I don't have access to this OS.   
> 
> Anyone else ?

I do. (Don't ask why we have all of Solaris 2.5, 2.5.1, 2.6 and 2.7 aka 
7. Upgrades always seem just too big for the current partitioning.)  But
before I investigate:

(i) is there a good reason to be trying 0.63.1 rather than 0.63.2?

(ii) which compilers were you trying to use, e.g. what is reported
when configure is run, and what versions are those compilers?

B

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Feb  8 10:50:15 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 8 Feb 1999 10:50:15 +0000 (GMT)
Subject: Install R-0.63.1 on Solaris 7
Message-ID: <199902081050.KAA20019@toucan.stats.ox.ac.uk>

I received the following message. I had no problems building R 0.63.2
on Solaris 7 (aka Solaris 2.7, SunOS 5.7) with each of

gcc2.8.1  f77 version SC4.0
cc version SC4.0  f77 version SC4.0
egcs 1.1 (gcc/g77)

------------- Begin Forwarded Message -------------

From: Yoko Wong <yoko@math.ubc.ca>
Subject: Re: Install R-0.63.1 on Solaris 7
To: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 6 Feb 1999 17:41:57 -0800 (PST)
X-Keywords: 

Thanks. I think it might be the gcc I am using.  I have
compiled on other solaris7 machine. 

Cheers,

Yoko


------------- End Forwarded Message -------------


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kye@ams.sunysb.edu  Mon Feb  8 23:43:54 1999
From: kye@ams.sunysb.edu (Kenny Ye)
Date: Mon, 8 Feb 1999 18:43:54 -0500 (EST)
Subject: bug on cancor
Message-ID: <Pine.SO4.4.02.9902081842340.23770-100000@fisher>


When I use the function cancor of mva package, I found that it doesn't
work when one of the matrix has only one column, or both have only
one column. The function in Splus 5 with the same name works under those
situations.

The version of R I am using is 0.63.2 (released on Jan., 1999) on Solaris.

Kenny Ye
Assistant Professor
Department of Applied Math and Statistics
SUNY at  Stony Brook
Stony Brook, New York 11794-3600
(516)632 9344


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From kye@ams.sunysb.edu  Tue Feb  9 00:00:58 1999
From: kye@ams.sunysb.edu (kye@ams.sunysb.edu)
Date: Tue, 9 Feb 1999 01:00:58 +0100
Subject: bug on cancor (PR#116)
Message-ID: <199902090000.BAA00511@biostat.ku.dk>


When I use the function cancor of mva package, I found that it doesn't
work when one of the matrix has only one column, or both have only
one column. The function in Splus 5 with the same name works under those
situations.

The version of R I am using is 0.63.2 (released on Jan., 1999) on Solaris.

Kenny Ye
Assistant Professor
Department of Applied Math and Statistics
SUNY at  Stony Brook
Stony Brook, New York 11794-3600
(516)632 9344


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Feb  9 00:16:37 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 09 Feb 1999 01:16:37 +0100
Subject: bug on cancor (PR#116)
In-Reply-To: kye@ams.sunysb.edu's message of Tue, 9 Feb 1999 01:00:58 +0100
References: <199902090000.BAA00511@biostat.ku.dk>
Message-ID: <x21zk0qvmi.fsf@blueberry.kubism.ku.dk>

kye@ams.sunysb.edu writes:

> When I use the function cancor of mva package, I found that it doesn't
> work when one of the matrix has only one column, or both have only
> one column. The function in Splus 5 with the same name works under those
> situations.

Just for those who wondered: I resent the message to R-bugs, making it
appear on R-devel for the 2nd time but with a PR#. (Resending - in my
mailer at least - leaves the original author as sender, which I think
is desirable. It also came out with a double R-devel signature, but
that probably can't be helped).

This is clearly a bug:

> cancor(1:10,1:10)
Error in qr.qty(qx, qr.qy(qy, diag(1, nr, dy)))[1:dx, , drop = FALSE]
: incorrect number of dimensions

Probably a dimension getting dropped somewhere...
-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From warnes@biostat.washington.edu  Tue Feb  9 02:10:36 1999
From: warnes@biostat.washington.edu (Gregory R. Warnes)
Date: Mon, 8 Feb 1999 18:10:36 -0800 (PST)
Subject: load() -> segfault
Message-ID: <Pine.LNX.4.04.9902081753120.560-100000@localhost>


OK.  Now that I've saved the results of some simulations using the save()
patch that I supplied earlier, I've gotten around to finding out why
load segfaults when I try to restore the data.

The reason is that I have several variable names which have
become horribly long during the simulation -- on the order of 20K
characters!  

save() is perfectly happy to write these variable names out, but load()
segfaults because the "InString" family of functions use fixed size
buffer but don't check for overflow!  The buffer is MAXELTSIZE bytes,
defined in $RHOME/src/inclide/Defn.h as 512. As you would expect,
reading a 20K object into a 512 byte buffer can really mess things up.

As noted in the comments of saveload.c,
    /* FIXME : the fixed size buffer here is an abomination */
but that's not as bad as failing to check for overflow.

I don't really have time to fix this, so for the moment I'm just refining
MAXELTSIZE to 32768 bytes (32K).  This fixes my problem, but is a horrid
hack.

Does anyone want to run through saveload.c fixing the code to check for
buffer overruns?   

-Greg

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From warnes@biostat.washington.edu  Tue Feb  9 02:11:34 1999
From: warnes@biostat.washington.edu (warnes@biostat.washington.edu)
Date: Tue, 9 Feb 1999 03:11:34 +0100
Subject: load() -> segfault (PR#117)
Message-ID: <199902090211.DAA00532@biostat.ku.dk>


OK.  Now that I've saved the results of some simulations using the save()
patch that I supplied earlier, I've gotten around to finding out why
load segfaults when I try to restore the data.

The reason is that I have several variable names which have
become horribly long during the simulation -- on the order of 20K
characters!  

save() is perfectly happy to write these variable names out, but load()
segfaults because the "InString" family of functions use fixed size
buffer but don't check for overflow!  The buffer is MAXELTSIZE bytes,
defined in $RHOME/src/inclide/Defn.h as 512. As you would expect,
reading a 20K object into a 512 byte buffer can really mess things up.

As noted in the comments of saveload.c,
    /* FIXME : the fixed size buffer here is an abomination */
but that's not as bad as failing to check for overflow.

I don't really have time to fix this, so for the moment I'm just refining
MAXELTSIZE to 32768 bytes (32K).  This fixes my problem, but is a horrid
hack.

Does anyone want to run through saveload.c fixing the code to check for
buffer overruns?   

-Greg


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Feb  9 08:07:57 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 9 Feb 1999 08:07:57 +0000 (GMT)
Subject: bug on cancor (PR#116)
In-Reply-To: <x21zk0qvmi.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.05.9902090741290.17438-100000@auk.stats>

On 9 Feb 1999, Peter Dalgaard BSA wrote:

> kye@ams.sunysb.edu writes:
> 
> > When I use the function cancor of mva package, I found that it doesn't
> > work when one of the matrix has only one column, or both have only
> > one column. The function in Splus 5 with the same name works under those
> > situations.

Yes, it does, but whether this makes statistical sense is debatable:
you are then doing regression in a roundabout way. (Least-squares
regression maximizes the correlation of y with a linear combination of the
cols of X.)

> Just for those who wondered: I resent the message to R-bugs, making it
> appear on R-devel for the 2nd time but with a PR#. (Resending - in my
> mailer at least - leaves the original author as sender, which I think
> is desirable. It also came out with a double R-devel signature, but
> that probably can't be helped).
> 
> This is clearly a bug:
> 
> > cancor(1:10,1:10)
> Error in qr.qty(qx, qr.qy(qy, diag(1, nr, dy)))[1:dx, , drop = FALSE]
> : incorrect number of dimensions
> 
> Probably a dimension getting dropped somewhere...

Nope. As someone who has suffered here before, I saw it is that pesky
mat.or.vec construction that someone in R likes to use. Function
qr.qr returns a vector when given an n x 1 y, by design.  So

qr.qy(qy, diag(1, nr, dy))
qr.qty(qx, qr.qy(qy, diag(1, nr, dy)))

are vectors.  So this is an R design decision.
To work around this in cancor, use

    zz <- qr.qty(qx, qr.qy(qy, diag(1, nr, dy)))
    z <- svd(as.matrix(zz)[1:dx, , drop=FALSE], dx, dy)


BTW, the help page for qr.qy says the value is

Value:

     The QR decomposition of the matrix as computed by LIN-
     PACK.  The components in the returned value correspond
     directly to the values returned by DQRDC.

which is nonsense for 8 of the 9 functions documented on that page.

I was using 0.63.2, in case anything has been altered since.

It may be too late to change this design decision (I know of quite a few
workarounds in other code) but it will come back to haunt users. At least
it could be documented!

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Feb  9 09:18:05 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 9 Feb 1999 10:18:05 +0100
Subject: bug on cancor (PR#116)
In-Reply-To: <Pine.GSO.4.05.9902090741290.17438-100000@auk.stats> (message
 from Prof Brian D Ripley on Tue, 9 Feb 1999 08:07:57 +0000 (GMT))
References: <Pine.GSO.4.05.9902090741290.17438-100000@auk.stats>
Message-ID: <199902090918.KAA15254@sophie.ethz.ch>

In the ``release-patch'' aka 0.63.3  version, the  functions
qr.xxx  *have* changed about 10 days ago.

NEWS has

    o	backsolve(), qr.solve... now return a vector when x (or y) is a vector.


In today's snapshot,

  > library(mva)
  > str(cancor(1:9,c(1:4,6:10)))
  List of 5
   $ cor    : num 0.997
   $ xcoef  : num 0.129
   $ ycoef  : num 0.110
   $ xcenter: num 5
   $ ycenter: num 5.56

However, 
I'm not sure if this addresses all issues (apart from docu)
that Prof Ripley has addressed. 

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From nlewin@iastate.edu  Tue Feb  9 15:59:01 1999
From: nlewin@iastate.edu (Nicholas Lewin)
Date: Tue, 09 Feb 1999 09:59:01 CST
Subject: Inter-application communication protocols for R
Message-ID: <199902091559.JAA07685@environ.stat.iastate.edu>

Dear R development people,
  We have developed a bi-directional link between the GIS package ArcView and 
XGobi. The link operates using RPC calls transparent to the user. We are 
interested in expanding the link to a stats package such as R, and would like 
to know if there is any interest in implementing inter-application protocols. 
We are interested in implementing a link where data could be passed from 
ArcView to both XGobi and R. Once the data is passed different views of the 
data could be displayed in both packages and linked to the map in ArcView for 
brushing. We also envision calculating various spatial statistics in R and 
passing them back to ArcView for display.

We would also be interested in implementing better sturctures for display of 
spatial data in R. If there is interest please let us know.

Sincerely,
Nicholas Lewin-Koh



                      CH3                  
                       |                          
                       N                 Nicholas Lewin-Koh
                      / \                GIS Support and Research Facility
                N----C   C==O            218 Durham Center
               ||   ||   |               Iowa State University
               ||   ||   |               Ames, IA 50011
               CH    C   N--CH3
                 \  / \ /                nlewin@iastate.edu
                  N    C                 515-294-2279 
                  |   ||                 515-294-1717 (Fax)
                 CH3   O                 http://www.public.iastate.edu/~nlewin

          The Real Part of Coffee 



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Ben Bolker <ben@eno.Princeton.EDU>  Wed Feb 10 01:58:03 1999
From: Ben Bolker <ben@eno.Princeton.EDU> (Ben Bolker)
Date: Tue, 9 Feb 1999 20:58:03 -0500 (EST)
Subject: wish list
Message-ID: <Pine.SUN.3.95.990125135010.14441A-100000@paca>


  Some of these I can implement pretty easily myself, others are harder
...

GRAPHICS:

    - a new option(), "plot.type", that allows one to set the default plot
type for pairs of points to something other than "p";

    - the ability to set just the lower or upper limits on an axis and
have the other limit auto-scaled (somewhat trickier: I don't know the
most convenient way for the user to specify this)

    - the ability to add points, text, etc. to persp() plots for
annotation (when Ross discussed this, I wasn't sure whether there were
going to be two separate kinds of 3-D plots) 

MISC:

  either an option or a separate function that makes edit() change the
underlying object:

pedit <- function (y) 
{
    assign(deparse(substitute(y)), edit(y), inherits = TRUE)
}

  regexp/tab completion for the help system (ha!)




Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Feb 10 07:56:42 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 10 Feb 1999 07:56:42 +0000 (GMT)
Subject: Ben Bolker's wish list
In-Reply-To: <Pine.SUN.3.95.990125135010.14441A-100000@paca>
Message-ID: <Pine.GSO.4.05.9902100731060.18640-100000@auk.stats>

On Tue, 9 Feb 1999, Ben Bolker wrote:

>     - the ability to set just the lower or upper limits on an axis and
> have the other limit auto-scaled (somewhat trickier: I don't know the
> most convenient way for the user to specify this)

The obvious idea is to use NA to specify a limit to be computed.
 
>   either an option or a separate function that makes edit() change the
> underlying object:
> 
> pedit <- function (y) 
> {
>     assign(deparse(substitute(y)), edit(y), inherits = TRUE)
> }

Why do you want that? In particular, what do you want inherits = TRUE to
achieve?  (As I understand R's documentation, this replaces objects
found down the search path in the global environment, so you must
envisage calling pedit from within a nested set of expressions.)

If you take a closer look at fix(), you will see that you only want
to deparse names and it would be better to check if y (why `y'?) exists.
As I see it all you want to do is to change the last line of fix, and I am
puzzled as to why you want to do that.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Wed Feb 10 13:44:35 1999
From: J.C.Rougier@durham.ac.uk (J.C.Rougier@durham.ac.uk)
Date: Wed, 10 Feb 1999 14:44:35 +0100
Subject: Function parsing (PR#118)
Message-ID: <199902101344.OAA02583@biostat.ku.dk>

Is anyone else concerned with the way in which the R function parser
relocates comments that occur after condional expressions in functions to
before, i.e. 

fred <- function(x) {
 # wonder what x is like
 if (x>0) stop("Sorry non-positive x only")
 # that showed x big-time!
 x
}

but then fred is parsed and stored as 

"fred" <-
function (x) 
{
    # wonder what x is like
    # that showed x big-time!
    if (x > 0) 
        stop("Sorry non-positive x only")
    x
}

It turns out that my programming style often includes comments after
conditionals, and I find this re-location a bit confusing.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Feb 10 14:28:19 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 10 Feb 1999 15:28:19 +0100
Subject: Function parsing (PR#118)
In-Reply-To: J.C.Rougier@durham.ac.uk's message of Wed, 10 Feb 1999 14:44:35 +0100
References: <199902101344.OAA02583@biostat.ku.dk>
Message-ID: <x290e6tjss.fsf@blueberry.kubism.ku.dk>

J.C.Rougier@durham.ac.uk writes:

> Is anyone else concerned with the way in which the R function parser
> relocates comments that occur after condional expressions in functions to
> before, i.e. 
...
> It turns out that my programming style often includes comments after
> conditionals, and I find this re-location a bit confusing.

You're not alone, it's just that nobody has had the stamina to
pinpoint how exactly this happens. An even more drastic version is in
glm.fit:

    ##-------------- end IRLS iteration -------------------------------
    for (iter in 1:control$maxit) {
        mu.eta.val <- mu.eta(eta)
        .. IRLS iteration! ..

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ben@eno.Princeton.EDU  Wed Feb 10 14:29:34 1999
From: ben@eno.Princeton.EDU (Ben Bolker)
Date: Wed, 10 Feb 1999 09:29:34 -0500 (EST)
Subject: Ben Bolker's wish list
In-Reply-To: <Pine.GSO.4.05.9902100731060.18640-100000@auk.stats>
Message-ID: <Pine.SUN.3.95.990210092129.19391A-100000@paca>


  I'm sorry, I didn't know that fix() existed.  That's what I wanted, the
"pedit" function I gave was an attempt to do the same thing.  And yes, it
is there in the "See Also" section of the help on edit().  Perhaps we
could add a sentence to the documentation of edit:

*** edit.Rd.orig        Wed Feb 10 09:26:03 1999
--- edit.Rd     Wed Feb 10 09:26:59 1999
***************
*** 29,34 ****
--- 29,35 ----
  Instead, a copy of name is made and it is that copy which is changed.
  Should you want the changes to apply to the object \code{name}
  you must assign the result of \code{edit} to \code{name}.
+ (Try \code{fix} if you want to make permanent changes to an object.)
  
  In the form \code{edit(name)},
  \code{edit} deparses \code{name} into a temporary file and invokes the



  I *don't* claim to understand the ins and outs of parsing, deparsing,
etc. in R, but the pedit() function seemed to do what I wanted (although
probably not as generally or as robustly as fix()).

  Thanks for the info.

Benjamin Bolker          Dep't of Ecology and Evolutionary Biology,
ben@eno.princeton.edu    Princeton University
tel: (609) 258-6886,     fax: (609) 258-1334

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Feb 11 15:14:20 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 11 Feb 1999 16:14:20 +0100
Subject: Problems with warnings from loess under Windows, at least (PR#119)
Message-ID: <199902111514.QAA15364@biostat.ku.dk>

There are two separate problems with loess under Guido's rw0632 on
Windows, neither of which appear unless you try to do something that it is
trying to tell you is inadvisable.  It bombs trying to tell you. I have
put up a replacement modreg.zip in the CRAN contrib collection that will
be mirrored tonight.

Both of these could potentially affect other platforms.

(1) A problem relating to the declaration of problem_buf in S.h.

> On Fri, 5 Feb 1999, Guido Masarotto wrote:

> On Thu, Feb 04, 1999 at 06:54:34PM +0000, Prof Brian D Ripley wrote:
> > OK, I have got to the bottom of this.
> > 
> > For some reason Guido has problem_buf in globalvar.h, twice. It should
> > not be there, and used not to be.  That means that any call to warning() or
> > stop() from compiled code in a DLL will bomb R. The solution is to remove
> > those lines and re-compile modreg.  I can do that for you if you need it.

>   The problem seems to happen
>   since every file which includes S.h declare a 'public' version
>   of problem_buf,i.e, got a declaration of the type
>   char problem_buf[4096];
>   I suspect that problem_buf should or declared extern (with memory
>   allocated somewhere, e.g.,in src/main.c) or static.
>   (BTW, the two files are appl/loglin.c and main/print.c).
>   In general, I am beginning to think that my 'automatic'
>   approch for globalvar.h is too much dangerous. It assumes
>   that global variables in all the 'main' files are 
>   properly declared and named. And, this is not the case now.

This needs resolving to static or extern for all the platforms. Those
writing `main' files might like to be aware that leaving symbols exposed
causes some problems, as on Windows we have to declare as imports all the
variables used from the R engine. The current scheme is to assume that all
exposed variables are intended to be imported.  (Can f1 and f2 in
approx.c be declared static?)

(2) Problems mixing Fortran and C.

> > The messages are then not very clear, because loessf.f passes strings
> > to loessc.c to call the warning/stop routines, and in Windows (but not
> > Unix) those strings seem to be missing a '\0' terminator. So you gets of
> > the next string, .... That will need rather more extensive changes to fix.

The problem here is that the loess code (not mine!) assumes that Fortran
uses strings in C format. This is not a safe assumption, but I was
surprised to find it not true for a port of g77. There may be no universal
answer, but I have modified the code to pass to C what Fortran thinks the
length is, and this works on the platforms I have. I will submit the
changed code shortly.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 11 17:46:54 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 11 Feb 1999 18:46:54 +0100
Subject: An idea for something better than read.table
Message-ID: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk>


I was recently converting some datasets for use in an R package and it
occurred to me that there really is no "neat" way to input a data
frame if it is to contain factor variables. 

One can use dput()/source or dump() after massaging data into the
right format, of course, but there isn't really anything which allows
you to store the input instructions with the data beyond the simple
header=T type format. 

So I thought of ways to enhance the header. The best idea I've been
able to come up with this far is to 

(a) Write a function - basically an extension of scan() - which allows
    you to specify the column data type in more detail. Let's call it
    data.file() for now. It would pretty much have to deparse all of
    its arguments and interpret things in slightly unusual ways, but R
    can do that, and some of functions (notably help() and data())
    already play this kind of game with the parser...

(b) Have a function, say read(), which parses the 1st expression in a
    file and executes it *with the remainder of the file as the
    argument*. (Currently, this is impossible, but it would be if
    one just kept track of the line number while parsing. parse()
    could stick it on as an attribute of the parsed expression list if
    asked to do so.)

This would make a file format something like the following possible.

[There's another loose idea in there involving a control item to handle
separators, na.strings, etc. - the intention being that read() plugs
in the file= and skip= arguments for the actual call.]

Would this be an approach worth pursuing?

--- Top of file ---
data.file(control(sep="w",na="."),
        Item = factor(levels=1:4,labels=c("A","B","C","D")),
        Size = numeric(),
        Year = factor(levels=1980:1985)
)
1       0     1980    
1       10    1981    
1       14    1982    
1       20    1983    
1       25    1984    
1       30    1985    
2       0     1980    
2       5     1981    
2       6     1982    
2       8     1984    
3       0     1984    
3       2     1985    
4       0     1980    
4       20    1981    
4       30    1982    
4       30    1984    
4       35    1985    
--- End of file ---

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Feb 11 18:10:27 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 11 Feb 1999 19:10:27 +0100 (CET)
Subject: An idea for something better than read.table
In-Reply-To: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk>
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk>
Message-ID: <14019.7443.446135.700056@pc87.maho.magnaeu.com>

>>>>> Peter Dalgaard BSA writes:

> I was recently converting some datasets for use in an R package and it
> occurred to me that there really is no "neat" way to input a data
> frame if it is to contain factor variables. 

> One can use dput()/source or dump() after massaging data into the
> right format, of course, but there isn't really anything which allows
> you to store the input instructions with the data beyond the simple
> header=T type format. 

> So I thought of ways to enhance the header. The best idea I've been
> able to come up with this far is to 

> (a) Write a function - basically an extension of scan() - which allows
>     you to specify the column data type in more detail. Let's call it
>     data.file() for now. It would pretty much have to deparse all of
>     its arguments and interpret things in slightly unusual ways, but R
>     can do that, and some of functions (notably help() and data())
>     already play this kind of game with the parser...

> (b) Have a function, say read(), which parses the 1st expression in a
>     file and executes it *with the remainder of the file as the
>     argument*. (Currently, this is impossible, but it would be if
>     one just kept track of the line number while parsing. parse()
>     could stick it on as an attribute of the parsed expression list if
>     asked to do so.)

> This would make a file format something like the following possible.

> [There's another loose idea in there involving a control item to handle
> separators, na.strings, etc. - the intention being that read() plugs
> in the file= and skip= arguments for the actual call.]

> Would this be an approach worth pursuing?

I think so.  However, why can't we extend scan() accordingly?

E.g.,

  scan(FILE,
       what = list(Item = factor(levels=1:4,labels=c("A","B","C","D")),
                   Size = numeric(),
                   Year = factor(levels=1980:1985)))

???

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 11 18:31:55 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 11 Feb 1999 19:31:55 +0100
Subject: An idea for something better than read.table
In-Reply-To: Kurt Hornik's message of Thu, 11 Feb 1999 19:10:27 +0100 (CET)
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk> <14019.7443.446135.700056@pc87.maho.magnaeu.com>
Message-ID: <x2d83g3i78.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> > [There's another loose idea in there involving a control item to handle
> > separators, na.strings, etc. - the intention being that read() plugs
> > in the file= and skip= arguments for the actual call.]
> 
> > Would this be an approach worth pursuing?
> 
> I think so.  However, why can't we extend scan() accordingly?
> 
> E.g.,
> 
>   scan(FILE,
>        what = list(Item = factor(levels=1:4,labels=c("A","B","C","D")),
>                    Size = numeric(),
>                    Year = factor(levels=1980:1985)))
> 
> ???

We could, and in a sense that is what I'm suggesting, but:

- the argument syntax is a bit clumsy, I'd like to have the variables
through a ... argument.

- scan *evaluates* the arguments and then looks at the type.
Evaluating things like

factor(levels=1:4,labels=c("A","B","C","D")) 

currently gives a "missing x" error, but even if we fixed that, it
could never give anything better than

> structure(integer(0),class="factor",levels=c("A","B","C","D"))
factor(0)
Levels:  A B C D 

i.e. the levels= specification would be forgotten. The only way to
circumvent that is to have scan working on nonevaluated arguments.

So I thought that one might as well start over with a completely new
function. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Feb 11 18:56:05 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Thu, 11 Feb 1999 13:56:05 -0500
Subject: dput truncation
Message-ID: <99Feb11.140632est.13485@mailgate.bank-banque-canada.ca>

dput() seems to be truncating data (either using single precision or some
formatting). In general my data is not so accurate that I should worry about
this and the small difference after dput then dget is mostly just an annoyance.
However, in some circumstances the truncation is enough that tsp attributes are
no longer valid, and that causes more serious difficulties. Is there any way to
modify the behavior of dput?

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From me@naxgul.kais.kyoto-u.ac.jp  Fri Feb 12 18:22:59 1999
From: me@naxgul.kais.kyoto-u.ac.jp (Yusuke Uchiyama)
Date: Fri, 12 Feb 1999 18:22:59 GMT
Subject: A subroutine for plotting stars
Message-ID: <199902121822.SAA00623@naxgul.kais.kyoto-u.ac.jp>


Hello,

I implemented "symbols.stars", a sub routine plotting stars.

It is intended to be called from "symbols".

Please use it if it is acceptable.

Yusuke Uchiyama

Laboratory of Insect Physiology
Graduate School of Agriculture
Kyoto University

e-mail: yusuke@kais.kyoto-u.ac.jp

---cut here---

"symbols.stars" <-
function (x, y, stars, add = FALSE, ...) 
{
    stars <- t(stars)
    i <- dim(stars)[1]
    anstep <- 2 * pi/i
    anstep <- anstep * 0:(i - 1) + pi/2
    dim(anstep) <- length(anstep)
    anstep <- t(apply(anstep, 1, rep, dim(stars)[2]))
    dim(x) <- length(x)
    dim(y) <- length(y)
    x <- apply(x, 1, rep, i)
    y <- apply(y, 1, rep, i)
    x <- x + stars * cos(anstep)
    y <- y + stars * sin(anstep)
    x <- c(apply(x, 2, c, NA))
    y <- c(apply(y, 2, c, NA))
    if (add == FALSE) {
        xlim <- c(min(x[!is.na(x)]) - 1.5, max(x[!is.na(x)]) + 
            1.5)
        ylim <- c(min(y[!is.na(y)]) - 1.5, max(y[!is.na(y)]) + 
            1.5)
        plot.new()
        plot.window(xlim, ylim)
    }
    polygon(x, y)
}





-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Feb 12 19:06:41 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 12 Feb 1999 14:06:41 -0500
Subject: more on dput
Message-ID: <99Feb12.150245est.13483@mailgate.bank-banque-canada.ca>

I would like to write data so that I can re-read it and reproduce results,
preferably in both R and Splus. In the past when I have done this my data has
been relatively simple and I've just scan()ed it. Now I have a fairly
complicated structure I would like to preserve and I've been trying to use dput
and dget. Is there a better way?  If not, the following truncation by dput,
which I mentioned yesterday, is causing me a fair amount of trouble. Suggestions
on how to fix it would be appreciated.

Paul Gilbert
_______

R:
> dput (1/3, "zot")
> (1/3) - dget("zot")
[1] 3.333333e-08

Splus 3.3:
> dput(1/3, "zot")
> (1/3) - dget("zot")
[1] 3.330669e-16

written by Splus, read in R:
> (1/3) - dget("zot")
[1] 3.330669e-16

so the problem seems pretty clearly to be in R's dput.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Feb 12 20:58:22 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 12 Feb 1999 20:58:22 +0000 (GMT)
Subject: more on dput
In-Reply-To: <99Feb12.150245est.13483@mailgate.bank-banque-canada.ca>
Message-ID: <Pine.GSO.4.05.9902122056380.19025-100000@auk.stats>

On Fri, 12 Feb 1999, Paul Gilbert wrote:

> I would like to write data so that I can re-read it and reproduce results,
> preferably in both R and Splus. In the past when I have done this my data has
> been relatively simple and I've just scan()ed it. Now I have a fairly
> complicated structure I would like to preserve and I've been trying to use dput
> and dget. Is there a better way?  If not, the following truncation by dput,
> which I mentioned yesterday, is causing me a fair amount of trouble. Suggestions
> on how to fix it would be appreciated.
> 
> Paul Gilbert
> _______
> 
> R:
> > dput (1/3, "zot")
> > (1/3) - dget("zot")
> [1] 3.333333e-08
> 
> Splus 3.3:
> > dput(1/3, "zot")
> > (1/3) - dget("zot")
> [1] 3.330669e-16
> 
> written by Splus, read in R:
> > (1/3) - dget("zot")
> [1] 3.330669e-16
> 
> so the problem seems pretty clearly to be in R's dput.

I find:

> dput(1/3)
0.3333333
> as.character(1/3)
[1] "0.333333333333333"
> options(digits=16)
> dput(1/3)
0.3333333333333333

so either use as.character or set digits to something large.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Fri Feb 12 21:16:05 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 12 Feb 1999 16:16:05 -0500
Subject: more on dput
References: <Pine.GSO.4.05.9902122056380.19025-100000@auk.stats>
Message-ID: <99Feb12.162703est.13453@mailgate.bank-banque-canada.ca>

> options(digits=16)

Thanks Brian, that works fine. I'm not so sure that it is a good idea having
dput depend on this, but if it's not changed it should at least be documented.

Paul

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From me@naxgul.kais.kyoto-u.ac.jp  Tue Feb 16 14:20:09 1999
From: me@naxgul.kais.kyoto-u.ac.jp (Yusuke Uchiyama)
Date: Tue, 16 Feb 1999 14:20:09 GMT
Subject: How to call do_circle from .Internal
Message-ID: <199902161420.OAA01141@naxgul.kais.kyoto-u.ac.jp>

Hello,

I would like to implement "circle" argument of "symbols", and want to call do_circle by name "circle" from .Internal.

I suppose I can do that by adding following lines to src/main/names.c and names.h:

names.c 
{"circle"	do_circle	0 ....}

names.h
SEXP do_circle(...)

Is it right?

Yusuke Uchiyama
yusuke@kais.kyoto-u.ac.jp
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 13:15:39 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 14:15:39 +0100
Subject: eval problem in Math.data.frame [.. DispathGroup / mean==sum ..] (PR#84)
Message-ID: <199902161315.OAA21263@biostat.ku.dk>

>> log(data.frame(x=1:4),base=2)
> Error: Object "base" not found

This one seems to be fixed. Move to Language-fixed.

(Note: there seems to be some strangeness with composing replies like this
in the web interface to JitterBug. Watch the headers if you want to followup.)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Feb 16 13:50:04 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 16 Feb 1999 14:50:04 +0100
Subject: eval problem in Math.data.frame [.. DispathGroup / mean==sum ..] (PR#84)
In-Reply-To: Peter Dalgaard's message of Tue, 16 Feb 1999 14:15:39 +0100
References: <199902161315.OAA21263@biostat.ku.dk>
Message-ID: <x21zjq5ugj.fsf@blueberry.kubism.ku.dk>

Peter Dalgaard <R-bugs@biostat.ku.dk> writes:

> (Note: there seems to be some strangeness with composing replies like this
> in the web interface to JitterBug. Watch the headers if you want to followup.)

OK, this seems to be relatively harmless. If I Cc: replies to R-devel,
or put it in the To: field, the sender becomes r-bugs@biostat.ku.dk so
any further correspondence goes on record. The only thing to note is
that even though my name occurs, my email does not, so you cannot
easily mail me back privately.

Still, it's a bit odd that JitterBug replies are sent directly from
the web interface, whereas nearly everything else goes via email to
r-bugs (which handles the list forwarding directly), even if entered
on a web form. Oh, well...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 14:11:43 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 15:11:43 +0100
Subject: lists (PR#88)
Message-ID: <199902161411.PAA21293@biostat.ku.dk>

> > 
>> > mode(c(23,42))
>> > is.vector(c(23,42),mode="numeric")
>> > is.vector(c(23,42),mode=c("integer","double","logical"))
>> 
>> Not sure I understand the problem:
> 
> 
> What I had in mind was that it would give TRUE if any of the vector
> had any of these modes i.e. some way of checking several modes at the
> same time without calling is.vector several times. I am looking for
> vectors upon which I can do calculations, as in those given. In
> retrospective, the example is poor. More logically, it should either
> use any() or ||.

I believe this is not a bug. You can get the effect you want fairly easily with

either 

any(sapply(modes,function(y)is.vector(x,mode=y)))

or

any(mode(x) == modes) # or storage.mode to distinguish double/integer

Moving report to "trashcan" (it can be picked up again, don't worry.)
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 14:48:19 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 15:48:19 +0100
Subject: possible bug (PR#91)
Message-ID: <199902161448.PAA21336@biostat.ku.dk>

> bug.report:
> =====================
> Version:
>  platform = i586-unknown-linux
>  arch = i586
...
> 1. 
> bug.report() gives above information: however, my computer is a 486,
> not 586, but I am not knowldedgeable enough to tell whether
> bug.report() or the operating system is the optimist.

Your OS is the optimist, and R is not checking during configure. 
You may lose a little efficiency from this, but it's relatively 
harmless. Recompile your kernel with the right CPU setting if it bothers you.

> 2.
> It would be helpful if help(bug.report) showed how to exit
> bug.report() back to R. 

Hmm. It dumps you into your favourite editor, as specified in options()$editor,
and how to get out of that is editor-dependent... Not much we can do about that,

I'm afraid (or can we?). The bug.report() interface got cleaned up
substantially, 
by the way.

> 3.
> Using "expression" as ylab or xlab parameter of plot(): label is not
> centered (too high or too far to the right); this is particularly
> obvious if, e.g., margins are set wide:
> 
> e.g., with:
> 
> par(mai=c(1.8,2,1.8,2))
> 
> I padded the label with spaces to approximately center it:
> 
> ylab=expression(paste("[Ca]"[i]," (nM)                            ")

Still with us, I'm afraid. Don't see the mai= thing, though, but

 plot(1:3,ylab=expression(paste("[Ca]"[i]," (nM) "))) 

shows the effect badly enough.

Moving PR to "graphics"
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 14:48:40 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue Feb 16 14:48:40 1999
Subject: possible bug (PR#91)
Message-ID: <199902161506.QAA21358@biostat.ku.dk>

> bug.report:
> =====================
> Version:
>  platform = i586-unknown-linux
>  arch = i586
...
> 1. 
> bug.report() gives above information: however, my computer is a 486,
> not 586, but I am not knowldedgeable enough to tell whether
> bug.report() or the operating system is the optimist.

Your OS is the optimist, and R is not checking during configure. 
You may lose a little efficiency from this, but it's relatively 
harmless. Recompile your kernel with the right CPU setting if it bothers you.

> 2.
> It would be helpful if help(bug.report) showed how to exit
> bug.report() back to R. 

Hmm. It dumps you into your favourite editor, as specified in options()$editor,
and how to get out of that is editor-dependent... Not much we can do about that,

I'm afraid (or can we?). The bug.report() interface got cleaned up
substantially, 
by the way.

> 3.
> Using "expression" as ylab or xlab parameter of plot(): label is not
> centered (too high or too far to the right); this is particularly
> obvious if, e.g., margins are set wide:
> 
> e.g., with:
> 
> par(mai=c(1.8,2,1.8,2))
> 
> I padded the label with spaces to approximately center it:
> 
> ylab=expression(paste("[Ca]"[i]," (nM)                            ")

Still with us, I'm afraid. Don't see the mai= thing, though, but

 plot(1:3,ylab=expression(paste("[Ca]"[i]," (nM) "))) 

shows the effect badly enough.

Moving PR to "graphics"
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 15:15:48 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 16:15:48 +0100
Subject: possible bug (PR#91)
Message-ID: <199902161515.QAA21371@biostat.ku.dk>

> 3.
> Using "expression" as ylab or xlab parameter of plot(): label is not
> centered (too high or too far to the right); this is particularly
> obvious if, e.g., margins are set wide:
> 
> e.g., with:
> 
> par(mai=c(1.8,2,1.8,2))
> 
> I padded the label with spaces to approximately center it:
> 
> ylab=expression(paste("[Ca]"[i]," (nM)                            ")

Er, wait a minute. I think you are trying to do

plot(1:3,ylab=expression("[Ca]"[i]*" (nM) "))

which *does* get centered correctly.

This leaves the bug.report issue, so I'll put the report in a new "Misc" folder.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 15:33:09 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 16:33:09 +0100
Subject: source() / eval() bug ??? (PR#96)
Message-ID: <199902161533.QAA21404@biostat.ku.dk>

This one got fixed, I believe.

> R-0.63.2 and  ``0.63.3 in progress'' :
> 
> Put the following in a file
> 
> ------ 8< -- snip ----------------------------- ...../source-bug.R -------
> rm(list=ls())
> cat("before c(..):\n")
> c(F=(f <- .3), "Tail area" = 2 * if(f < 1) 30 else 90)
> ------ 8< -- snip -------------------------- end ..../source-bug.R -------
> 
> then
> 
> source("......../source-bug.R")
> 	^^^^^^^^
> 	proper path name
> 
> [[or  source("......../source-bug.R", verbose=TRUE) ]]
> 
> ends with
> 	=============================================
> 	before c(..):
> 	Error: getAttrib: invalid type for TAG
> 	> 
> 	=============================================
> 
> On interactive usage, or if you use
> 
> 	R --vanilla < ..../source-bug.R
> 
> there's no problem !
> 
> 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 15:49:53 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 16:49:53 +0100
Subject: [R] Pairlist & Dataframe (PR#100)
Message-ID: <199902161549.QAA21432@biostat.ku.dk>

> Ennapadam Venkatraman <venkat@biosta.mskcc.org> writes:

>>     > x <- NULL
>>     > x$x1 <- rnorm(10)
>>     > x$x2 <- rnorm(10)
>>     > mode(x)
>>     [1] "pairlist"
>>     > as.data.frame(x)
>>     Error: can't coerce pairlist into a data.frame

Fixed in 0.63.3
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Tue Feb 16 17:22:23 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Tue, 16 Feb 1999 18:22:23 +0100
Subject: saveload.c (PR#107)
Message-ID: <199902161722.SAA26043@biostat.ku.dk>

> and so all depends from this function.  Using a Win32 version of SUNRPC
> assembled by Brian R. I was unable to load xdr images since after an
> xdr_destroy the xdr_int function fails.
> 
> Solution seems be as easy as
>   i = InInteger(fp);
>   InTerm(fp);
>   return OffsetToNode(i);

Fixed as suggested for 0.63.3
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mcw@ln.nimh.nih.gov  Tue Feb 16 20:33:52 1999
From: mcw@ln.nimh.nih.gov (mcw@ln.nimh.nih.gov)
Date: Tue, 16 Feb 1999 21:33:52 +0100
Subject: graphics bug: type="l" (PR#120)
Message-ID: <199902162033.VAA26161@biostat.ku.dk>


The following commands illustrate a problem with graphing relatively large
data sets using the "line" option to plot:

temp <- runif(200000)  # or whatever other numbers you like;
			# same thing happens with a sine wave
plot(1:200000, temp)    # everything fine
plot(1:200000, temp, type="l")   # data gets cut off


The number of points isn't crucial.  The cutoff point appears to be about
65,000 points.  (70,000 points demonstrates the cutoff; with 50,000 points
there's no cutoff.) 

As far as I can tell, the problem only occurs when using the
option type="l".  It's unaffected by color, line type, and line width.

Matt Wiener



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Feb 16 21:34:17 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 16 Feb 1999 22:34:17 +0100
Subject: graphics bug: type="l" (PR#120)
In-Reply-To: mcw@ln.nimh.nih.gov's message of Tue, 16 Feb 1999 21:33:52 +0100
References: <199902162033.VAA26161@biostat.ku.dk>
Message-ID: <x2btiuuj6u.fsf@blueberry.kubism.ku.dk>

mcw@ln.nimh.nih.gov writes:

> The following commands illustrate a problem with graphing relatively large
> data sets using the "line" option to plot:
> 
> temp <- runif(200000)  # or whatever other numbers you like;
> 			# same thing happens with a sine wave
> plot(1:200000, temp)    # everything fine
> plot(1:200000, temp, type="l")   # data gets cut off
> 
> 
> The number of points isn't crucial.  The cutoff point appears to be about
> 65,000 points.  (70,000 points demonstrates the cutoff; with 50,000 points
> there's no cutoff.) 
> 
> As far as I can tell, the problem only occurs when using the
> option type="l".  It's unaffected by color, line type, and line width.
> 
> Matt Wiener

Doesn't happen to me with 0.63.pre-3 on RedHat Linux. I can't offhand
see any documented fixes that would affect this, perhaps there's an OS
difference? Looks a bit like a short integer overrun (65536=2^16)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Feb 16 21:54:16 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 16 Feb 1999 21:54:16 +0000 (GMT)
Subject: graphics bug: type="l" (PR#120)
In-Reply-To: <199902162033.VAA26161@biostat.ku.dk>
Message-ID: <Pine.GSO.4.05.9902162134030.24074-100000@auk.stats>

On Tue, 16 Feb 1999 Matt Wiener, mcw@ln.nimh.nih.gov wrote:

> 
> The following commands illustrate a problem with graphing relatively large
> data sets using the "line" option to plot:
> 
> temp <- runif(200000)  # or whatever other numbers you like;
> 			# same thing happens with a sine wave
> plot(1:200000, temp)    # everything fine
> plot(1:200000, temp, type="l")   # data gets cut off
> 
> 
> The number of points isn't crucial.  The cutoff point appears to be about
> 65,000 points.  (70,000 points demonstrates the cutoff; with 50,000 points
> there's no cutoff.) 

This is device-specific (and which device was not mentioned). It does not
happen on Windows (rw0632) nor on a postscript device. It does happen on
the Unix x11() device for me, and my guess is that it is a limitation in
the X library used.  (Not in the X server, for this works in gs
displaying postscript, and in S-PLUS. The lines are drawn in a single Xlib
call.)

Do you really want to plot such a dataset in one go? What do you
expect to see of significance in 200000 points? (There are by default only 
about twice that many pixels on the device surface.) Are they really one
group? Would some group colour coding help? ....

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Feb 17 11:08:37 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Wed, 17 Feb 1999 12:08:37 +0100
Subject: graphics bug: type="l" (PR#120)
Message-ID: <199902171108.MAA26572@biostat.ku.dk>

Prof Brian D Ripley <ripley@stats.ox.ac.uk> writes:

> On Tue, 16 Feb 1999 Matt Wiener, mcw@ln.nimh.nih.gov wrote:
> 
> > 
> > The following commands illustrate a problem with graphing relatively large
> > data sets using the "line" option to plot:
> > 
> > temp <- runif(200000)  # or whatever other numbers you like;
> > 			# same thing happens with a sine wave
> > plot(1:200000, temp)    # everything fine
> > plot(1:200000, temp, type="l")   # data gets cut off
> > 
> > 
> > The number of points isn't crucial.  The cutoff point appears to be about
> > 65,000 points.  (70,000 points demonstrates the cutoff; with 50,000 points
> > there's no cutoff.) 
> 
> This is device-specific (and which device was not mentioned). It does not
> happen on Windows (rw0632) nor on a postscript device. It does happen on
> the Unix x11() device for me, and my guess is that it is a limitation in
> the X library used.  (Not in the X server, for this works in gs
> displaying postscript, and in S-PLUS. The lines are drawn in a single Xlib
> call.)

Apparently, this is not only device-specific but X-server specific as
the following network experiment shows:

Run on Linux,   display Linux   OK
Run on Solaris, display Linux   OK
Run on Solaris, display Solaris Error
Run on Linux,   display Solaris Error

So it seems that the Solaris OpenWindows X Server cannot handle
requests for drawing lines through more than 64K points. I suppose we
*could* fix this by splitting all XDrawLines into blocks of max 64K.

The man page for XDrawLines and friends have the following blob:

       All x and y members are signed integers.  The width and
       height members are 16-bit unsigned integers.  You should
       be careful not to generate coordinates and sizes out of
       the 16-bit ranges, because the protocol only has 16-bit
       fields for these values.

The "and sizes" bit might be taken to mean that you should do the
above, although it's beyond me how it would work on any platform if
there's only room for 16 bits in the protocol (perhaps the protocol
has changed from X11R5 to R6?). XDrawLines only occurs twice in
devX11.c, so I suppose it's no big deal to fix up.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Wed Feb 17 15:06:44 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Wed, 17 Feb 1999 16:06:44 +0100
Subject: HREFS for private packages - fixed? (PR#19)
Message-ID: <199902171506.QAA27186@biostat.ku.dk>

Anyone know if this is still with us? -pd

> There is however, a small problem with installing the HTML documention in a
> private (i.e. not RHOME/library) location. The file
> 
>    RHOME/doc/html/packages.html
> 
> linking the main documention to the packages is written (BTW this will
probably
> fail if the package owner and the R owner are not the same) but the links in
it
> are not quite correct. For me the link indicated in that file is
> 
>   <A HREF="../../library/dse/html/00Index.html">
> which would be RHOME/library/dse/html/00Index.html, but it should be
>  <A HREF="{package_location}/dse/html/00Index.html">

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Feb 17 16:01:02 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 17 Feb 1999 11:01:02 -0500
Subject: HREFS for private packages - fixed? (PR#19)
References: <199902171506.QAA27186@biostat.ku.dk>
Message-ID: <99Feb17.111432est.13468@mailgate.bank-banque-canada.ca>

I just checked and it still seems to be a problem in R 0.63.2.

Paul Gilbert

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Wed Feb 17 16:19:23 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Wed, 17 Feb 1999 17:19:23 +0100 (CET)
Subject: HREFS for private packages - fixed? (PR#19)
In-Reply-To: <199902171506.QAA27186@biostat.ku.dk>
References: <199902171506.QAA27186@biostat.ku.dk>
Message-ID: <14026.60427.68697.231072@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 17 Feb 1999 16:06:44 +0100,
>>>>> Peter Dalgaard (PD) wrote:

PD> Anyone know if this is still with us? -pd
>> There is however, a small problem with installing the HTML documention in a
>> private (i.e. not RHOME/library) location. The file
>> 
>> RHOME/doc/html/packages.html
>> 
>> linking the main documention to the packages is written (BTW this will
PD> probably
>> fail if the package owner and the R owner are not the same) but the links in
PD> it
>> are not quite correct. For me the link indicated in that file is
>> 
>> <A HREF="../../library/dse/html/00Index.html">
>> which would be RHOME/library/dse/html/00Index.html, but it should be
>> <A HREF="{package_location}/dse/html/00Index.html">


It SHOULD contain only functions in RHOME/library, as this file serves
only as a default fallback. The complete list should be built at
runtime (using all in .lib.loc) and this works for me. However, there
is a problem if installing as root (or whoever is allowed to write to
RHOME) to someplace different than RHOME ... I'll dig into that
tomorrow (I've got to leave in 10 minutes).

.f

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Wed Feb 17 17:42:01 1999
From: pgilbert@bank-banque-canada.ca (Paul Gilbert)
Date: Wed, 17 Feb 1999 12:42:01 -0500
Subject: HREFS for private packages - fixed? (PR#19)
References: <199902171506.QAA27186@biostat.ku.dk> <14026.60427.68697.231072@galadriel.ci.tuwien.ac.at>
Message-ID: <99Feb17.125537est.13476@mailgate.bank-banque-canada.ca>

Friedrich

Just to make sure we're taking about the same problem, if I do

R INSTALL               dse

everything works fine (so that is what I've been using) but if I do

R INSTALL           -l rlibs  dse

I get the problem we are discussing. My understanding is that this is suppose to
install in the subdirectory rlib under where I run it, not in RHOME. The code
installs fine like this but the pointer in the HTML gets messed up.

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From R-bugs@biostat.ku.dk  Wed Feb 17 18:00:13 1999
From: R-bugs@biostat.ku.dk (Peter Dalgaard)
Date: Wed, 17 Feb 1999 19:00:13 +0100
Subject: menu buglet (PR#12)
Message-ID: <199902171800.TAA30374@biostat.ku.dk>

Fixed. 

Actually, this one had been sitting around since *blush* August, bug
reproduction 
instructions, detailed patch, and everything.

Oh well, goes to show that an least submissions to r-bugs are never completely
forgotten...
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Feb 18 08:41:59 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 18 Feb 1999 09:41:59 +0100 (CET)
Subject: HREFS for private packages - fixed? (PR#19)
In-Reply-To: <99Feb17.125537est.13476@mailgate.bank-banque-canada.ca>
References: <199902171506.QAA27186@biostat.ku.dk>
 <14026.60427.68697.231072@galadriel.ci.tuwien.ac.at>
 <99Feb17.125537est.13476@mailgate.bank-banque-canada.ca>
Message-ID: <14027.53847.599276.209725@galadriel.ci.tuwien.ac.at>

>>>>> On Wed, 17 Feb 1999 12:42:01 -0500,
>>>>> Paul Gilbert (PG) wrote:

PG> Friedrich
PG> Just to make sure we're taking about the same problem, if I do

PG> R INSTALL               dse

PG> everything works fine (so that is what I've been using) but if I do

PG> R INSTALL           -l rlibs  dse

PG> I get the problem we are discussing. My understanding is that this is suppose to
PG> install in the subdirectory rlib under where I run it, not in RHOME. The code
PG> installs fine like this but the pointer in the HTML gets messed up.


Yes, that's exactly what I was meaning. IMO, only

	R INSTALL dse

should change the global packages file, because only the we have
guarantee that a user can actually access the installed packages
(anything installed somewhere else might belong to somebody different
etc.).

So

	R INSTALL -l rlibs  dse

shouldn't modify the global packages file, as a new one conforming to
the current .lib.loc get's built anyway when running help.start().

Any objections if I commit that change?

.f
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Thu Feb 18 10:39:47 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Thu, 18 Feb 1999 11:39:47 +0100 (CET)
Subject: HREFS for private packages - fixed? (PR#19)
In-Reply-To: <14027.53847.599276.209725@galadriel.ci.tuwien.ac.at>
References: <199902171506.QAA27186@biostat.ku.dk>
 <14026.60427.68697.231072@galadriel.ci.tuwien.ac.at>
 <99Feb17.125537est.13476@mailgate.bank-banque-canada.ca>
 <14027.53847.599276.209725@galadriel.ci.tuwien.ac.at>
Message-ID: <14027.60915.528270.991492@galadriel.ci.tuwien.ac.at>


I committed the bug fixes.

.f


>>>>> On Thu, 18 Feb 1999 09:41:59 +0100 (CET),
>>>>> Friedrich Leisch (FL) wrote:

>>>>> On Wed, 17 Feb 1999 12:42:01 -0500,
>>>>> Paul Gilbert (PG) wrote:

PG> Friedrich
PG> Just to make sure we're taking about the same problem, if I do

PG> R INSTALL               dse

PG> everything works fine (so that is what I've been using) but if I do

PG> R INSTALL           -l rlibs  dse

PG> I get the problem we are discussing. My understanding is that this is suppose to
PG> install in the subdirectory rlib under where I run it, not in RHOME. The code
PG> installs fine like this but the pointer in the HTML gets messed up.


FL> Yes, that's exactly what I was meaning. IMO, only

FL> 	R INSTALL dse

FL> should change the global packages file, because only the we have
FL> guarantee that a user can actually access the installed packages
FL> (anything installed somewhere else might belong to somebody different
FL> etc.).

FL> So

FL> 	R INSTALL -l rlibs  dse

FL> shouldn't modify the global packages file, as a new one conforming to
FL> the current .lib.loc get's built anyway when running help.start().

FL> Any objections if I commit that change?




-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@biostat.ku.dk  Thu Feb 18 14:47:27 1999
From: pd@biostat.ku.dk (pd@biostat.ku.dk)
Date: Thu, 18 Feb 1999 15:47:27 +0100
Subject: model.frame mangles time series (PR#121)
Message-ID: <199902181447.PAA11889@biostat.ku.dk>

This one showed up while looking at one of Ripley's other reports:

> data(freeny)
> model.frame(y~1,data=freeny,subset=1:10)
              y
1962.25 8.79236
1962.5  8.79137
1962.75 8.81486
1963    8.81301
1963.25 8.90751
1963.5  8.93673
1963.75 8.96161
1964    8.96044
1964.25 9.00868
1964.5  9.03049
> model.frame(y~1,data=freeny,subset=1:10)$y
Warning: Replacement length not a multiple of the elements to replace in matrix(...) 
Error: length of dimnames[1] not equal to array extent
> model.frame(y~1,data=freeny[1:10,])$y
         Qtr1    Qtr2    Qtr3    Qtr4
1962:      NA 8.79236 8.79137 8.81486
1963: 8.81301 8.90751 8.93673 8.96161
1964: 8.96044 9.00868 9.03049      NA
> dput(model.frame(y~1,data=freeny,subset=1:10)$y)
structure(c(8.79236, 8.79137, 8.81486, 8.81301, 8.90751, 8.93673, 
8.96161, 8.96044, 9.00868, 9.03049), .Tsp = c(1962.25, 1971.75, 
4), class = "ts")

The upshot of this is that glm(...,subset=...) fails on the freeny data.

The cause is seen by 

> model.frame(y~1,data=freeny[1:10,])$y
         Qtr1    Qtr2    Qtr3    Qtr4
1962:      NA 8.79236 8.79137 8.81486
1963: 8.81301 8.90751 8.93673 8.96161
1964: 8.96044 9.00868 9.03049      NA
> dput(model.frame(y~1,data=freeny,subset=1:10)$y)
structure(c(8.79236, 8.79137, 8.81486, 8.81301, 8.90751, 8.93673, 
8.96161, 8.96044, 9.00868, 9.03049), .Tsp = c(1962.25, 1971.75, 
4), class = "ts")

Notice that the .Tsp attribute doesn't reflect the shorter time series
(1971.75 should be 1964.5).

--please do not edit the information below--

Version:
 platform = i586-unknown-linux
 arch = i586
 os = linux
 system = i586, linux
 status = in progress
 status.rev = 0
 major = 0
 minor = 63.3
 year = 1999
 month = February
 day = 19
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Feb 18 16:24:37 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 18 Feb 1999 08:24:37 -0800 (PST)
Subject: model.frame mangles time series (PR#121)
In-Reply-To: <199902181447.PAA11889@biostat.ku.dk>
Message-ID: <Pine.GSO.4.10.9902180818370.2878-100000@wompom.biostat.washington.edu>

On Thu, 18 Feb 1999 pd@biostat.ku.dk wrote:

> This one showed up while looking at one of Ripley's other reports:

> The upshot of this is that glm(...,subset=...) fails on the freeny data.
> 
> The cause is seen by 
> 
> > model.frame(y~1,data=freeny[1:10,])$y
>          Qtr1    Qtr2    Qtr3    Qtr4
> 1962:      NA 8.79236 8.79137 8.81486
> 1963: 8.81301 8.90751 8.93673 8.96161
> 1964: 8.96044 9.00868 9.03049      NA
> > dput(model.frame(y~1,data=freeny,subset=1:10)$y)
> structure(c(8.79236, 8.79137, 8.81486, 8.81301, 8.90751, 8.93673, 
> 8.96161, 8.96044, 9.00868, 9.03049), .Tsp = c(1962.25, 1971.75, 
> 4), class = "ts")
> 
> Notice that the .Tsp attribute doesn't reflect the shorter time series
> (1971.75 should be 1964.5).


This is the attributes/subsetting problem rearing its ugly head again.
model.frame(,subset) has to copy *some* attributes over (eg contrasts) and
can't copy *all* of them (eg dim).

Currently we use copyMostAttributes to drop the dangerous ones. It
clearly didn't know about tsp. 

Questions:
(1) How do we know which attributes to copy?
(2) For an unknown attribute what should the default be?
(3) Is there just one set of attributes that needs special treatment (in
which case copyMostAttributes is broken) or are there different sets in
different circumstances (in which case we need a new function)?
(4) Could we just handle this by having the subset operator retain
attributes?

	-thomas

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 18 16:51:01 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Feb 1999 17:51:01 +0100
Subject: model.frame mangles time series (PR#121)
In-Reply-To: Thomas Lumley's message of Thu, 18 Feb 1999 08:24:37 -0800 (PST)
References: <Pine.GSO.4.10.9902180818370.2878-100000@wompom.biostat.washington.edu>
Message-ID: <x2678zlkp6.fsf@blueberry.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> This is the attributes/subsetting problem rearing its ugly head again.
> model.frame(,subset) has to copy *some* attributes over (eg contrasts) and
> can't copy *all* of them (eg dim).
> 
> Currently we use copyMostAttributes to drop the dangerous ones. It
> clearly didn't know about tsp. 
> 
> Questions:
> (1) How do we know which attributes to copy?
> (2) For an unknown attribute what should the default be?
> (3) Is there just one set of attributes that needs special treatment (in
> which case copyMostAttributes is broken) or are there different sets in
> different circumstances (in which case we need a new function)?
> (4) Could we just handle this by having the subset operator retain
> attributes?

(5) is there really any reason to do subsetting in the .Internal code?
the hot spot is 

    variables <- eval(attr(formula, "variables"), data, sys.frame(sys.parent()))
    extranames <- as.character(substitute(list(...))[-1])
    extras <- substitute(list(...))
    extras <- eval(extras, data, sys.frame(sys.parent()))
    subset <- eval(substitute(subset), data, sys.frame(sys.parent()))
    data <- .Internal(model.frame(formula, rownames, variables, 
        varnames, extras, extranames, subset, na.action))

but what's keeping us from saying 
    data <- .Internal(model.frame(formula, rownames, variables, 
        varnames, extras, extranames, na.action))[subset,]

or ("Uncle Scrooge" version)

   data <- .Internal(model.frame(formula, rownames, variables[subset,], 
        varnames, extras[subset,], extranames, na.action))

(well, variables and extras are lists, not dataframes, but you get the
picture. Do we allow unequal length variables anyway?)

(6) since [subset,] seems to work, perhaps do_subset is what should be
called from inside do_modelframe?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Feb 18 16:52:15 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 18 Feb 1999 08:52:15 -0800 (PST)
Subject: model.frame mangles time series (PR#121)
In-Reply-To: <x2678zlkp6.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.4.10.9902180851110.2878-100000@wompom.biostat.washington.edu>

On 18 Feb 1999, Peter Dalgaard BSA wrote:

> 
> (6) since [subset,] seems to work, perhaps do_subset is what should be
> called from inside do_modelframe?

No, subset doesn't work -- it loses contrasts

R>  contrasts(df$x)
  [,1] [,2]
1    1    0
2    0    1
3   -1   -1
R> contrasts(df[1:5,]$x)
  2 3
1 0 0
2 1 0
3 0 1
 
	-thomas


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From D.A.Wooff@durham.ac.uk  Thu Feb 18 17:09:33 1999
From: D.A.Wooff@durham.ac.uk (D.A.Wooff@durham.ac.uk)
Date: Thu, 18 Feb 1999 18:09:33 +0100
Subject: [R] possible bug in loglm (PR#122)
Message-ID: <199902181709.SAA12157@biostat.ku.dk>

Bug report: there is a problem with loglm (or some underlying code)
when used with updating within a function. For example, this code
works as expected, when used outside a function:


-------------------------------------------------
library(MASS)
cts<-c(25,13,99,45,128,78,151,153,173,171,49,62,1308,236,989,264,622,201,492,244,382,237,122,102,39,5,67,28,53,29,27,20,18,17,1,2,41,11,54,44,64,76,102,83,104,160,41,54,1232,321,1015,348,755,328,530,395,414,370,160,147,25,11,48,20,29,23,20,16,14,11,1,3)

foo<-cbind(expand.grid(f1=factor(c("A","B")),f2=factor(11:16),f3=factor(c("S","N","E")),f4=factor(c("F","M"))),cts=cts)

d0<-loglm(cts~f1+f2+f3+f4,data=foo)
d1<-update(d0,.~.^2)
-------------------------------------------------


but, unless d0 is visible outside the function, 
the same code does not work as expected when within a function:

-------------------------------------------------
rm(list=ls())
library(MASS)

tester<-function(){

cts<-c(25,13,99,45,128,78,151,153,173,171,49,62,1308,236,989,264,622,201,492,244,382,237,122,102,39,5,67,28,53,29,27,20,18,17,1,2,41,11,54,44,64,76,102,83,104,160,41,54,1232,321,1015,348,755,328,530,395,414,370,160,147,25,11,48,20,29,23,20,16,14,11,1,3)

foo<-cbind(expand.grid(f1=factor(c("A","B")),f2=factor(11:16),f3=factor(c("S","N","E")),f4=factor(c("F","M"))),cts=cts)

d0<-loglm(cts~f1+f2+f3+f4,data=foo)
d1<-update(d0,.~.^2)
}

tester()
-------------------------------------------------

results in the message:

Error: Object "foo" not found




David.

---------------------------------------------------------------------
  David Wooff, Director, Statistics and Mathematics Consultancy Unit,
  Department of Mathematical Sciences, University of Durham.
  Science Laboratories, South Road, Durham, DH1 3LE, UK.
  Tel. 0191 374 4531, Fax 0191 374 7388.
---------------------------------------------------------------------
  


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 18 17:27:11 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Feb 1999 18:27:11 +0100
Subject: model.frame mangles time series (PR#121)
In-Reply-To: Thomas Lumley's message of Thu, 18 Feb 1999 08:52:15 -0800 (PST)
References: <Pine.GSO.4.10.9902180851110.2878-100000@wompom.biostat.washington.edu>
Message-ID: <x23e43lj0w.fsf@blueberry.kubism.ku.dk>

Thomas Lumley <thomas@biostat.washington.edu> writes:

> On 18 Feb 1999, Peter Dalgaard BSA wrote:
> 
> > 
> > (6) since [subset,] seems to work, perhaps do_subset is what should be
> > called from inside do_modelframe?
> 
> No, subset doesn't work -- it loses contrasts
> 
> R>  contrasts(df$x)
>   [,1] [,2]
> 1    1    0
> 2    0    1
> 3   -1   -1
> R> contrasts(df[1:5,]$x)
>   2 3
> 1 0 0
> 2 1 0
> 3 0 1

That can be fixed by a one-line change to [.factor :

> contrasts(df[1:3,]$x)
          .L   .Q         .C
1 -0.6708204  0.5 -0.2236068
2 -0.2236068 -0.5  0.6708204
3  0.2236068 -0.5 -0.6708204
4  0.6708204  0.5  0.2236068

I suspect that is the correct solution.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From venkat@biosta.mskcc.org  Thu Feb 18 18:08:28 1999
From: venkat@biosta.mskcc.org (venkat@biosta.mskcc.org)
Date: Thu, 18 Feb 1999 19:08:28 +0100
Subject: Text in plot (PR#123)
Message-ID: <199902181808.TAA12266@biostat.ku.dk>

I am trying to place a multi-line text in a plot.  R-0.63.2 on Linux however
writes only the first line.  Is this a known bug?  Example is given below.

R : Copyright 1999, The R Development Core Team
Version 0.63.2  (January 12, 1999)

> x11()
> plot(0,0)
> text(0,-0.5,"test \n line2")

Thanks,
Venkat
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-help mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-help-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Thu Feb 18 18:06:52 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Thu, 18 Feb 1999 18:06:52 +0000 (GMT)
Subject: [R] possible bug in loglm (PR#122)
Message-ID: <199902181806.SAA28066@toucan.stats.ox.ac.uk>


> From: D.A.Wooff@durham.ac.uk
> Date: Thu, 18 Feb 1999 18:09:33 +0100
> To: r-devel@stat.math.ethz.ch
> Subject: [R] possible bug in loglm (PR#122)
> CC: R-bugs@biostat.ku.dk
> X-Loop: R-bugs@biostat.ku.dk
> 
> Bug report: there is a problem with loglm (or some underlying code)
> when used with updating within a function. For example, this code
> works as expected, when used outside a function:

Well, loglm is not part of R per se, so I was a little surprised to see
this going to R-bugs. The answer is along the lines of `yes, we know,
this is part of the limitations of update and NextMethod', and this occurs
in S-PLUS too, and for lots of other applications of update. You could
alter update.loglm to be

update.loglm <- function (object, formula., ...) 
{
    setdiff <- function(x, y) if (length(x) == 0 || length(y) == 0) x
    else x[match(x, y, 0) == 0]
    if (is.null(call <- object$call)) 
        stop("object has no call component.  Updating not possible")
    if (fix <- !missing(formula.)) {
        object$formula <- denumerate(object$formula)
        formula. <- denumerate(formula.)
        call$formula <- update.formula(formula(object), formula.)
    }
    extras <- match.call(expand.dots = FALSE)$...
    if (length(extras) > 0) {
        existing <- !is.na(match(names(extras), names(call)))
        ## do these individually to allow NULL to remove entries.
        for (a in names(extras)[existing]) call[[a]] <- extras[[a]]
        if (any(!existing)) {
            call <- c(as.list(call), extras[!existing])
            call <- as.call(call)
        }
    }
    result <- eval(call, sys.frame(sys.parent()))
    if (fix) {
        form <- renumerate(result$formula)
        result$call$formula <- unclass(result$formula <- form)
    }
    result
}

that is to remove the NextMethod call.  But this sort of thing is quite
common, and the usual workaround is to make sure that the dataframe is visible.



-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 18 18:14:03 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Feb 1999 19:14:03 +0100
Subject: model.frame mangles time series (PR#121)
In-Reply-To: Peter Dalgaard BSA's message of 18 Feb 1999 18:27:11 +0100
References: <Pine.GSO.4.10.9902180851110.2878-100000@wompom.biostat.washington.edu> <x23e43lj0w.fsf@blueberry.kubism.ku.dk>
Message-ID: <x2zp6bk2ac.fsf@blueberry.kubism.ku.dk>

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> That can be fixed by a one-line change to [.factor :
> 
> > contrasts(df[1:3,]$x)
>           .L   .Q         .C
> 1 -0.6708204  0.5 -0.2236068
> 2 -0.2236068 -0.5  0.6708204
> 3  0.2236068 -0.5 -0.6708204
> 4  0.6708204  0.5  0.2236068
> 
> I suspect that is the correct solution.

A quick check shows that S does the same, ergo: change committed.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jlindsey@alpha.luc.ac.be  Thu Feb 18 18:52:28 1999
From: jlindsey@alpha.luc.ac.be (jlindsey@alpha.luc.ac.be)
Date: Thu, 18 Feb 1999 19:52:28 +0100
Subject: library help (PR#87)
Message-ID: <199902181852.TAA13340@biostat.ku.dk>

Testing

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 18 18:57:00 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Feb 1999 19:57:00 +0100
Subject: library help (PR#87)
In-Reply-To: jlindsey@alpha.luc.ac.be's message of Thu, 18 Feb 1999 19:52:28 +0100
References: <199902181852.TAA13340@biostat.ku.dk>
Message-ID: <x2vhgzk0ar.fsf@blueberry.kubism.ku.dk>

jlindsey@alpha.luc.ac.be writes:

> Testing

OK, seems that I've finally squashed an embarassing bug I introduced in
JitterBug... 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgilbert@bank-banque-canada.ca  Thu Feb 18 22:17:19 1999
From: pgilbert@bank-banque-canada.ca (pgilbert@bank-banque-canada.ca)
Date: Thu, 18 Feb 1999 23:17:19 +0100
Subject: function.html gets clobbered (PR#18)
Message-ID: <199902182217.XAA13651@biostat.ku.dk>

>The changes I committed related to packages.html should also fix this
>problem ... please try.

Freidrich

I grabbed R-devel.tar.gz from fangorn.ci.tuwien.ac.at  at about 9pm GMT Thur.
Feb 18. It does not seem to have the problem fixed, but I'm not sure if that was
the version I was suppose to try.

I won't be at work tomorrow. I can try again Monday.

Paul


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Feb 20 16:31:21 1999
From: ripley@stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 20 Feb 1999 16:31:21 +0000 (GMT)
Subject: Port of sm library, installing library components
Message-ID: <Pine.GSO.4.05.9902201610280.4961-100000@toucan.stats>

I have an almost complete port of the sm library/package (only things
depending on gam are not operational) at

http://www.stats.ox.ac.uk/pub/R/sm_1.0-1.tar.gz

Before I send it to CRAN, I would appreciate some help in checking that
you can install it. The problem is that the Fortran it uses on Solaris
calls a routine in a Fortran library not linked into R. I have a Makefile
(supplied but not the default) that works on Solaris, and I have no
problem with g77 on any of the platforms I have (Solarises, RH5.2-i586,
win32). If people who use a Fortran compiler other that g77 could try this
and let me know what is needed it would help me write more comprehensive
instructions.  Beware of lazy binding: the file Install tells you how to
run a test of the problematical routine.

Incidentally, the sm package includes a large number of S scripts that
need to be installed. I have cheated by putting these in the exec
sub-directory, but there appears to be no mechanism (except on Windows) to
use R INSTALL to install components other than R code, C/Fortran, exec
scripts and help. Should we have one? E.g.

cp -r packagesrc/install_extras/*  Rlibrary/packagename/

One advantage would be to make it easy for package packagers to specify
what they wanted to be distributed in all binary distributions. (I would
like to see the DESCRIPTION file installed so the version information is
always there, and in some packages, including sm, there is a Licence
file.)

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From John.Peters@tip.csiro.au  Sun Feb 21 23:12:12 1999
From: John.Peters@tip.csiro.au (John.Peters@tip.csiro.au)
Date: Mon, 22 Feb 1999 00:12:12 +0100
Subject: scan rejects complex (PR#125)
Message-ID: <199902212312.AAA19317@biostat.ku.dk>


"Scan" does not currently accept mode "complex".  (Splus3.4 does).
The help file does not make plain the intention.
Version is 0.632.

#----------------------------------------
xx_1+2i
cat(xx,file="testfile1")

yy_scan("testfile1",what=complex()) 

print(yy)
print(mode(yy))

# Says: Error: "scan" invalid "what=" specified
# yy_as.complex(scan("testfile1",what=character())) # workaround
#----------------------------------------

Many thanks.

----------------------------------------------------------------------------
John Peters
CSIRO National Measurement Laboratory
PO Box 218                                Phone:    +61 2 9413 7503
Lindfield NSW 2070                        Fax:      +61 2 9413 7202
Australia                                 Internet: John.Peters@tip.CSIRO.AU
----------------------------------------------------------------------------

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Friedrich.Leisch@ci.tuwien.ac.at  Mon Feb 22 09:03:42 1999
From: Friedrich.Leisch@ci.tuwien.ac.at (Friedrich Leisch)
Date: Mon, 22 Feb 1999 10:03:42 +0100 (CET)
Subject: Port of sm library, installing library components
In-Reply-To: <Pine.GSO.4.05.9902201610280.4961-100000@toucan.stats>
References: <Pine.GSO.4.05.9902201610280.4961-100000@toucan.stats>
Message-ID: <14033.7534.629426.653899@galadriel.ci.tuwien.ac.at>

>>>>> On Sat, 20 Feb 1999 16:31:21 +0000 (GMT),
>>>>> Prof Brian Ripley (PBR) wrote:


PBR> (I would
PBR> like to see the DESCRIPTION file installed so the version information is
PBR> always there,

good idea, committed the change.


.f



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Mon Feb 22 16:29:14 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Mon, 22 Feb 1999 17:29:14 +0100 (CET)
Subject: "as" functions should be generic
Message-ID: <XFMail.990222172914.plummer@iarc.fr>

It would be very useful if all "as.*" functions were generic,
so that a user who creates a new class can write methods to
coerce objects of that class to standard R objects.

In fact, most of the "as.*" functions are generic, but there
are a few that aren't:
as.array
as.factor
as.ordered
as.pairlist
as.formula
as.ts

It's actually "as.array" and "as.ts" that are a problem for
me, but I mention the others because this seems like a good
general principle.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Tue Feb 23 07:50:29 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Tue, 23 Feb 1999 08:50:29 +0100 (CET)
Subject: "as" functions should be generic
In-Reply-To: <XFMail.990222172914.plummer@iarc.fr>
References: <XFMail.990222172914.plummer@iarc.fr>
Message-ID: <14034.24005.535659.918027@pc87.maho.magnaeu.com>

>>>>> Martyn Plummer writes:

> It would be very useful if all "as.*" functions were generic,
> so that a user who creates a new class can write methods to
> coerce objects of that class to standard R objects.

> In fact, most of the "as.*" functions are generic, but there
> are a few that aren't:
> as.array
> as.factor
> as.ordered
> as.pairlist
> as.formula
> as.ts

> It's actually "as.array" and "as.ts" that are a problem for
> me, but I mention the others because this seems like a good
> general principle.

This may be a good idea.

-k

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From khal@alumni.uv.es  Wed Feb 24 20:54:47 1999
From: khal@alumni.uv.es (Kjetil Halvorsen)
Date: Wed, 24 Feb 1999 21:54:47 +0100
Subject: An idea for something better than read.table
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk>
Message-ID: <36D46716.4819BF52@alumni.uv.es>

It is nice if data files can have formats not to heavily
dependent on the package.  What I do to read in data is
having data (whith header) in, say, data.dat, and then data.R
with the commands for defining factors, levels, contrast or
whatever. That seems cleaner than mixing in one file data and
definitions.

Kjetil Halvorsen


Peter Dalgaard BSA wrote:
> 
> I was recently converting some datasets for use in an R package and it
> occurred to me that there really is no "neat" way to input a data
> frame if it is to contain factor variables.
> 
> One can use dput()/source or dump() after massaging data into the
> right format, of course, but there isn't really anything which allows
> you to store the input instructions with the data beyond the simple
> header=T type format.
> 
> So I thought of ways to enhance the header. The best idea I've been
> able to come up with this far is to
> 
> (a) Write a function - basically an extension of scan() - which allows
>     you to specify the column data type in more detail. Let's call it
>     data.file() for now. It would pretty much have to deparse all of
>     its arguments and interpret things in slightly unusual ways, but R
>     can do that, and some of functions (notably help() and data())
>     already play this kind of game with the parser...
> 
> (b) Have a function, say read(), which parses the 1st expression in a
>     file and executes it *with the remainder of the file as the
>     argument*. (Currently, this is impossible, but it would be if
>     one just kept track of the line number while parsing. parse()
>     could stick it on as an attribute of the parsed expression list if
>     asked to do so.)
> 
> This would make a file format something like the following possible.
> 
> [There's another loose idea in there involving a control item to handle
> separators, na.strings, etc. - the intention being that read() plugs
> in the file= and skip= arguments for the actual call.]
> 
> Would this be an approach worth pursuing?
> 
> --- Top of file ---
> data.file(control(sep="w",na="."),
>         Item = factor(levels=1:4,labels=c("A","B","C","D")),
>         Size = numeric(),
>         Year = factor(levels=1980:1985)
> )
> 1       0     1980
> 1       10    1981
> 1       14    1982
> 1       20    1983
> 1       25    1984
> 1       30    1985
> 2       0     1980
> 2       5     1981
> 2       6     1982
> 2       8     1984
> 3       0     1984
> 3       2     1985
> 4       0     1980
> 4       20    1981
> 4       30    1982
> 4       30    1984
> 4       35    1985
> --- End of file ---
> 
> --
>    O__  ---- Peter Dalgaard             Blegdamsvej 3
>   c/ /'_ --- Dept. of Biostatistics     2200 Cph. N
>  (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
> r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
> Send "info", "help", or "[un]subscribe"
> (in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From guido@hal.stat.unipd.it (Guido Masarotto)  Wed Feb 24 22:26:11 1999
From: guido@hal.stat.unipd.it (Guido Masarotto) (Guido Masarotto)
Date: Wed, 24 Feb 1999 23:26:11 +0100
Subject: [R] rw0632 makes stray .Rhistory orphans
In-Reply-To: <36D4644A.2C61BFC9@alumni.uv.es>; from Kjetil Halvorsen on Wed, Feb 24, 1999 at 09:42:50PM +0100
References: <000001be5f1c$ef0b70e0$6f1abb81@fenris> <19990223134026.06314@hal.stat.unipd.it> <36D4644A.2C61BFC9@alumni.uv.es>
Message-ID: <19990224232611.16861@hal.stat.unipd.it>

On Wed, Feb 24, 1999 at 09:42:50PM +0100, Kjetil Halvorsen wrote:
> Opened the tema, another small mal-function which could be easily
> repaired:  When sourcing a file from the menu, the working directory
> (HOME?) changes to the files directory, then leaving R the Rdata
> gets saved in the wrong place! I feel that sourcing shouldnt change
> HOME, it surprised me more than once.
> 
  K.,
  I think you are perfectly right.
  Any opinion by others before I change the source?
  And, what about loading and saving the workspaces?
  I haven't checked but since code is essentialy the same
  I suppose behaviour is the same  and, hence, it must be
  changed too.

  g. 
  
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Feb 25 17:06:05 1999
From: thomas@biostat.washington.edu (thomas@biostat.washington.edu)
Date: Thu, 25 Feb 1999 18:06:05 +0100
Subject: locator() and log axes (PR#126)
Message-ID: <199902251706.SAA30920@biostat.ku.dk>

In both the versions of 0.63.3 I have compiled locator() gives silly
results for log axes eg

> plot(1:10,log="x")
> locator(1) #click on the point at (4,4)
$x
[1] 9694.383

$y
[1] 4.034130

It appears that the x coordinate is 10^right number -- it's getting
unlogged twice
	

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = in progress
 status.rev = 0
 major = 0
 minor = 63.3
 year = 1999
 month = February
 day = 24
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Feb 25 17:28:10 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 25 Feb 1999 18:28:10 +0100
Subject: locator() and log axes (PR#126)
In-Reply-To: thomas@biostat.washington.edu's message of Thu, 25 Feb 1999 18:06:05 +0100
References: <199902251706.SAA30920@biostat.ku.dk>
Message-ID: <x2678q2y1h.fsf@blueberry.kubism.ku.dk>

thomas@biostat.washington.edu writes:

> In both the versions of 0.63.3 I have compiled locator() gives silly
> results for log axes eg
> 
> > plot(1:10,log="x")
> > locator(1) #click on the point at (4,4)
> $x
> [1] 9694.383
> 
> $y
> [1] 4.034130
> 
> It appears that the x coordinate is 10^right number -- it's getting
> unlogged twice

Exactly. Fixed for 0.63.3.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Fri Feb 26 11:22:27 1999
From: plummer@iarc.fr (Martyn Plummer)
Date: Fri, 26 Feb 1999 12:22:27 +0100
Subject: An idea for something better than read.table
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk> <36D46716.4819BF52@alumni.uv.es>
Message-ID: <36D683F3.E0B49464@iarc.fr>

Kjetil Halvorsen wrote:
> 
> It is nice if data files can have formats not to heavily
> dependent on the package.  What I do to read in data is
> having data (whith header) in, say, data.dat, and then data.R
> with the commands for defining factors, levels, contrast or
> whatever. That seems cleaner than mixing in one file data and
> definitions.
> 

If you want a file format for R datasets which describe their
own metadata, it might be worth thinking about defining it in
XML.

This probably goes a long way beyong Peter's suggestion, but
presumably it could be done in the same way, by adding a header
to the top of a data file. It does leave open the possibility
that other statistical packages will be able to read the data
and extract any meta data (storage type, variable labels, value
labels, ...) they want to use.

I have been thinking for a long time that it would be nice if
statistical packages could exchange datasets using a common
file format and (unless I have drastically misunderstood) XML
seems the way to go.

Martyn
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rossini@biostat.washington.edu  Fri Feb 26 14:15:17 1999
From: rossini@biostat.washington.edu (A.J. Rossini)
Date: 26 Feb 1999 06:15:17 -0800
Subject: An idea for something better than read.table
In-Reply-To: Martyn Plummer's message of "Fri, 26 Feb 1999 12:22:27 +0100"
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk> <36D46716.4819BF52@alumni.uv.es> <36D683F3.E0B49464@iarc.fr>
Message-ID: <877lt5dzey.fsf@alpha.cfas.washington.edu>


>>>>> "MP" == Martyn Plummer <plummer@iarc.fr> writes:

    MP> If you want a file format for R datasets which describe their
    MP> own metadata, it might be worth thinking about defining it in
    MP> XML.

Maybe...

    MP> This probably goes a long way beyong Peter's suggestion, but
    MP> presumably it could be done in the same way, by adding a
    MP> header to the top of a data file. It does leave open the
    MP> possibility that other statistical packages will be able to
    MP> read the data and extract any meta data (storage type,
    MP> variable labels, value labels, ...) they want to use.

The only caveat is that your data set looks like an HTML(SGML) file.
However, there are parsers for nearly any language (well, Java, C++,
C, PERL, and Python come to mind), which are nicely licensed.

Writing out the XML DTD for statistical datasets (and for
communicating the need for procedures of a certain type on those
datasets) has been simmering in the back of my mind for a while, now.
I'd be interested in hearing from anyone else who has been playing
with XML for passing data (my application is for inter-stat package
communication, but might not be bad for with-in package communication,
but it needs a bit more exploration).

It would also lead to WWW-friendly processing :-).

best,
-tony

-- 
A.J. Rossini
UW Biostatistics & Center for AIDS Research 
206-543-1044 / 206-720-4282                 
rossini@biostat.washington.edu              
http://www.biostat.washington.edu/~rossini/ 
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rcreecy@census.gov  Fri Feb 26 17:08:46 1999
From: rcreecy@census.gov (Rob Creecy)
Date: Fri, 26 Feb 1999 12:08:46 -0500
Subject: XML for Data
References: <x2g18c3ka9.fsf@blueberry.kubism.ku.dk> <36D46716.4819BF52@alumni.uv.es> <36D683F3.E0B49464@iarc.fr> <877lt5dzey.fsf@alpha.cfas.washington.edu>
Message-ID: <36D6D51E.6AF2410D@census.gov>

A.J. Rossini wrote:
> 

> I'd be interested in hearing from anyone else who has been playing
> with XML for passing data (my application is for inter-stat package
> communication, but might not be bad for with-in package communication,
> but it needs a bit more exploration).
> 
> It would also lead to WWW-friendly processing :-).
>

I got some of the following information from Dan Gillman at the
Census Bureau that is related. As you might imagine, we are very
interested in any technology that might help in the exchange of
data between statistical packages, the publishing of data on the WWW,
and making data more useful to a wider audience.
 
The Data Documentation Initiative sponsored by ICPSR (Univ of Mich) 
is a statistical data set documentation standard written as an XML DTD.  
Marty Appel and Dan Gillman here at the Census Bureau are on the
committee
that is developing the work.  There is a web site at
http://www.icpsr.umich.edu/DDI.

Unisys has software for converting a UML model to an XML DTD through the
use of XML.

The San Diego Supercomputer Center (SDSC) has  a variety of projects
related to 
describing data with XML. See http://www.npaci.edu/DICE/MIX/index.html 

Rob Creecy
Statistical Research Division
U.S. Bureau of the Census
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From naras@stat.Stanford.EDU  Fri Feb 26 22:34:04 1999
From: naras@stat.Stanford.EDU (Balasubramanian Narasimhan)
Date: Fri, 26 Feb 1999 14:34:04 -0800 (PST)
Subject: XML for Data
In-Reply-To: Your message of "Fri, 26 Feb 1999 12:08:46 -0500"
 <36D6D51E.6AF2410D@census.gov>
References: <36D6D51E.6AF2410D@census.gov>
Message-ID: <19990226143404V.naras@stat.Stanford.EDU>


Sometime ago, I  created a DTD for the Omega  project as an experiment
and was able to  parse it and convert it to a  DOM as was needed using
some freely available IBM tools. 

However, it was quite experimental and the design clearly reflected my
own frustrations  with dealing  with Intro Stat  text books  data. Time
constraints prevented me from really using it in Fall 1998, especially
because software was not readily available as it is now.

The combination of  XML and Java is especially  seamless. IBM, Sun all
provide automatic tools for creating DOMs. 

The DDI  project sounds  interesting and I  think input from  us would
really be nice. 

________________________________________________________________
B. Narasimhan                            naras@stat.stanford.edu
                             http://www-stat.stanford.edu/~naras





-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jmhughes@globalnet.co.uk  Sat Feb 27 20:32:59 1999
From: jmhughes@globalnet.co.uk (jmhughes@globalnet.co.uk)
Date: Sat, 27 Feb 1999 21:32:59 +0100
Subject: history (PR#127)
Message-ID: <199902272032.VAA04276@biostat.ku.dk>

Full_Name: john hughes
Version: 0.63
OS: Linux 4.2
Submission from: 195.147.221.243 (195.147.221.243)


Unable to get previous commands(history)using the cursor key. Cursor UP Arrow
Key produces '[A' or something similar backspace produces '[B'. No .Rprofile or
.B file created on installation.  I've tried creating them but couldn't find out
what commands to put in to get previous commands recalled. This didn't happen
with version 0.43 under Linux 4.1. 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Feb 28 00:08:12 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Feb 1999 01:08:12 +0100
Subject: history (PR#127)
In-Reply-To: jmhughes@globalnet.co.uk's message of Sat, 27 Feb 1999 21:32:59 +0100
References: <199902272032.VAA04276@biostat.ku.dk>
Message-ID: <x2btifcrv7.fsf@blueberry.kubism.ku.dk>

jmhughes@globalnet.co.uk writes:

> Full_Name: john hughes
> Version: 0.63
> OS: Linux 4.2
> Submission from: 195.147.221.243 (195.147.221.243)
> 
> 
> Unable to get previous commands(history)using the cursor key. Cursor UP Arrow
> Key produces '[A' or something similar backspace produces '[B'. No .Rprofile or
> .B file created on installation.  I've tried creating them but couldn't find out
> what commands to put in to get previous commands recalled. This didn't happen
> with version 0.43 under Linux 4.1. 

You may need a newer version of the readline library. Current versions
of R needs readline-2.1 or better.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sun Feb 28 08:57:50 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sun, 28 Feb 1999 09:57:50 +0100
Subject: Formatting in formatC and format (PR#129)
Message-ID: <199902280857.JAA04735@biostat.ku.dk>

[This turned into a bug report which will go to r-devel, so I have taken it
off r-help.]

Bugs reported here:

(1) formatC's help page need some clarification.

(2) formatC needs to treat modes "double" and "real" as equivalent.

(3) format's help page or (preferably) format needs correction re the
meaning of `digits'


On Sun, 28 Feb 1999, Martin Maechler wrote:

> >>>>> "BDR" == Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

`should not 5.96 print as 6.0 with 2 dignificant digits?'

>     BDR> S-PLUS has an option nsmall to format to do precisely this, and
>     BDR> there was a question asking how to do it on s-news today.  I have
>     BDR> thought for a while that we need to implement something like this
>     BDR> in R: maybe I had better do it....
> 
> Is it necessary?

Yes, as I want to do things that C's printf does not do, AFAIK.

> In R, we've always been having   formatC(.) as an alternative to format(.)
> allowing more precise formatting specifications.
> However, maybe I didn't understand what yuo were alluding to..

I find formatC useful (if hard to understand) but it does not in my hands
do what I want. I don't think formatC's help page defines precisely what it
does. In particular, it does not say what format=NULL, the default, does.  
So if I try

formatC(6.0, digits=1)
[1] " 6"

I do not get what I expected. It looks as if I need

formatC(6.0, digits=1, format="f")
[1] "6.0"

My guess is that the default is "g" for doubles. (I also find that what 
happens when I give format="g" for an integer and or give the `wrong' mode
is not defined or even inconsistent:

> formatC(as.integer(12345678), mode="real")
Error: `type' must be "real" for this format
> formatC(as.integer(12345678), mode="double")
[1] "1.235e+07"
> formatC(as.integer(12345678), mode="double", format="d")
[1] "12345678"

What are the rules here?)

The help page for formatC references the pre-ANSI C 2nd edition of
Kernighan & Ritchie, but I think the ANSI standard is that same. There is a
reference to leading zeroes, none to trailing zeroes. I believe printf can
be system-dependent (and some of it certainly is: win32 libraries use
n.ddde+nnn and Solaris ones use n.ddde+nn not n.dddenn as your help page
says).  I think, pessimistically, that it is not safe to rely on how the C
runtime library does this.


BTW, there is a trick here:

format(c(5.9, 6.0), digits=2)[-1]
[1] "6.0"

does what Dr Carsten wanted (but see later for the meaning of digits=2).


In any case, 

formatC(6.01, digits=1, format="f")
[1] "6.0"

is not what I am looking for, but (from S-PLUS)

> format(6.0, nsmall=1)
[1] "6.0"
> format(6.01, nsmall=1)
[1] "6.01"


Here is something else I find useful, and I think R is not as documented:
In S-PLUS I get (by default) alignment on the (implied) decimal point:

> format(c(6.11, 13.1), digits=2)
[1] " 6.1" "13  "

whereas in R

> format(c(6.11, 13.1), digits=2)
[1] " 6.1" "13.1"

Now R says (?format)

  digits: how many significant digits are to be used for `numeric x'.

but that is not what happens.  And I can't see how to do this in formatC:

> formatC(c(6.11, 13.1), digits=2, format="fg")
[1] "6.1" " 13"

as the alignment is wrong.  I think in print/format, digits=2 means that
data are rounded so that the smallest (in magnitude) number has two
significant digits, and then the result is converted dropping trailing
zeroes, as in

> format(c(6.0, 13.1), digits=2)
[1] " 6" "13"

(That is what S-PLUS gives too, aargh.)


Another, minor, point: format is generic and can be applied to lists,
for example, whereas formatC cannot.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Feb 28 20:45:45 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Sun, 28 Feb 1999 21:45:45 +0100
Subject: lty=0 -- shouldn't it give an invisible line? (PR#130)
Message-ID: <199902282045.VAA04952@biostat.ku.dk>


Currently, it seems that setting lty=0 gives a solid line in most
contexts (lines(), e.g.) but a strangely dotted-dash line in others
(axis()). This shows up on barplots, and looks fairly odd:

x<-c(a=1,b=2,c=3)
barplot(x)

barplot() is doing an axis(...,lty=0), presumably with the intention
of plotting the labels, but not the actual axis.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

