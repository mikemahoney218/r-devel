From simon.urbanek at r-project.org  Mon Dec  1 02:21:32 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 1 Dec 2008 09:21:32 +0800
Subject: [Rd] unrelated software install triggering an error from R's
	install script on Mac OS X 10.5
In-Reply-To: <49330FA2.1030604@gmail.com>
References: <49315329.7050703@gmail.com>
	<5EF06ADB-867B-4151-BBD2-E8293BE42745@uos.de>
	<49330FA2.1030604@gmail.com>
Message-ID: <4FC00087-A387-48CA-88EB-5823AE70BF85@r-project.org>


On Dec 1, 2008, at 6:11 AM, Laurent Gautier wrote:

> Stefan Evert wrote:
>>> The steps needed to generate the error are:
>>>
>>> - install a binary distribution of R (default location)
>>> - add R to the PATH
>> Did you actually add
>>    /Library/Frameworks/R.framework/Resources/bin/
>> to your PATH?  You're not supposed to do that!  What made you think  
>> so?
>
> Coming from an UNIX background, adding a directory like bin/ to the  
> PATH   does not appear unreasonable.
>

... if you really want those files to prepend your PATH. You get what  
you deserve ;) I this case you don't want that and this is true for  
all unix platforms.


>> This directory contains a range of support scripts for R which are  
>> not intended for direct use from the command line or other  
>> programs.  In my installation, there's just a symlink from /usr/bin/ 
>> R to the R binary in the directory above, which AFAIK is the only  
>> program you need to invoke directly.
>
> I am relatively new to OS X, so I cannot tell whether this is an R  
> specificity, or the way things are usually done on OS X are somewhat  
> very different from the UNIX way.

Then you seem to be very unfamiliar with the unix way as it appears...


> I am surprised by this cherry pick one executable in bin/ / don't  
> touch the PATH.
>

You are apparently unaware of the way R is setup ... Note that on most  
unix systems this is exactly what you get - the R_HOME/bin directory  
is tucked away in /usr/local/lib/R/bin which is never on your PATH  
since R installs the user-visible scripts to /usr/local/bin. The same  
happens here.


>
>> In your case, R's "INSTALL" script, which implements the "R CMD  
>> INSTALL" functionality masks the standard "install" program in /usr/ 
>> bin/install, so Python's installer now picks up a completely wrong  
>> program.  Even if you edit R's "INSTALL" script, it'll do something  
>> entirely different from what you expect.
>
> To my great dismay I am hearing here that Mac OS X is not case- 
> sensitive.
>

Mac OS X is case-sensitive. Case-sensitivity is an option of the  
mounted file system and you can choose either. It is common to use  
case-insensitive fs for historical reasons (compatibility with older  
software), but you don't have to.


>> BTW, putting the R binary directory ahead of system directories  
>> such as /usr/bin in your PATH is an even worse idea than including  
>> it there in the first place. ;-)
>
> I am used to the fact that adding a bin/ directory in the PATH (and  
> *ahead* of all other components in the PATH) is the way to add  
> custom binaries.

If you want to override the system ones, yes. But you better know what  
you're doing ;).


> I cannot exclude that I am missing some specificities of Mac OS X,  
> but that idea seems to be at least shared by the fink project (their  
> default install puts /sw/bin ahead of all the rest).
>

.. which leads to quite a few problems on its own. That's why you're  
entirely on your own if you do so (and likely to run into problems  
where Fink replaces systems parts with non-standard binaries).

> I suppose that there is a documentation for R-on-OS-X and that I  
> overlooked it.
>

You overlooked quite a bit of documentation of unix and R - pretty  
much none of it is OS X - specific.


Cheers,
S
>


From spencer.graves at pdf.com  Mon Dec  1 07:31:54 2008
From: spencer.graves at pdf.com (Spencer Graves)
Date: Sun, 30 Nov 2008 22:31:54 -0800
Subject: [Rd] Warning: missing text for item ... in \describe?
Message-ID: <493384DA.9060504@pdf.com>

Hello: 

      What might be the problem generating messages like "Warning: 
missing text for item ... in \describe" with "R CMD check" and "R CMD 
install"? 

      With the current version of "fda" on R-Forge, I get the following: 


Warning: missing text for item 'fd' in \describe
Warning: missing text for item 'fdPar' in \describe


      I found a where someone else asked about essentially this warning 
message, but I didn't find a reply.  I also found that 
"https://svn.r-project.org/R/trunk/share/perl/R/Rdconv.pm" is coded to 
issue such messages.  However, I still don't know what I'm doing to 
generate it. 

      Thanks in advance for any suggestions. 

      Best Wishes,
      Spencer


From berwin at maths.uwa.edu.au  Mon Dec  1 08:40:04 2008
From: berwin at maths.uwa.edu.au (Berwin A Turlach)
Date: Mon, 1 Dec 2008 15:40:04 +0800
Subject: [Rd] Warning: missing text for item ... in \describe?
In-Reply-To: <493384DA.9060504@pdf.com>
References: <493384DA.9060504@pdf.com>
Message-ID: <20081201154004.79ef748b@berwin-nus1>

G'day Spencer,

On Sun, 30 Nov 2008 22:31:54 -0800
Spencer Graves <spencer.graves at pdf.com> wrote:

> Hello: 
> 
>       What might be the problem generating messages like "Warning: 
> missing text for item ... in \describe" with "R CMD check" and "R CMD 
> install"? 
> 
>       With the current version of "fda" on R-Forge, I get the
> following: 
> 
> 
> Warning: missing text for item 'fd' in \describe
> Warning: missing text for item 'fdPar' in \describe

fRegress.Rd, which contains

\item{fd} { ...
\item{fdPar} {...

Apparently the space between the closing and the opening bracket leads
to some confusion; remove the space and the warning goes away.

I am not sure why an extra space here leads to problems, would be nicer
if it would not.  If it have to lead to a problem, then it would be
nice if the name of the .Rd files that produces the problem is actually
mentioned. :)

Don't ask me how I found this, let us just say that long live
find-grep-dired in emacs and perseverance (or should that be
stubbornness?) 

HTH.

Cheers,

	Berwin

=========================== Full address =============================
Berwin A Turlach                            Tel.: +65 6516 4416 (secr)
Dept of Statistics and Applied Probability        +65 6516 6650 (self)
Faculty of Science                          FAX : +65 6872 3919       
National University of Singapore     
6 Science Drive 2, Blk S16, Level 7          e-mail: statba at nus.edu.sg
Singapore 117546                    http://www.stat.nus.edu.sg/~statba


From ligges at statistik.tu-dortmund.de  Mon Dec  1 10:36:37 2008
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 01 Dec 2008 10:36:37 +0100
Subject: [Rd] parallel build for package? (equivalent of make -j8)
In-Reply-To: <4932CD8A.6000402@biostat.ku.dk>
References: <8ec76080811300725v1021f0b2l987da0db33c2f961@mail.gmail.com>
	<4932CD8A.6000402@biostat.ku.dk>
Message-ID: <4933B025.7000701@statistik.tu-dortmund.de>



Peter Dalgaard wrote:
> Whit Armstrong wrote:
>> I have a package that takes about 20 minutes to compile which tends to
>> prolong the compile/test/compile cycle.
>>
>> Does anyone know how to get R CMD check or R CMD INSTALL to use 
>> parallel make?
>>
>> I looked at R CMD INSTALL --help, but I don't see anything obvious
>> arguments to do this.
> 
> Platform?
> 
> Does
> 
> MAKE="make -j8" R CMD INSTALL ...
 >
> not work?

I cannot believe this works safely, at least when installing into the 
same library, because of R's lock mechanism that locks a library if 
*one* installation is running ...

Best,
Uwe


> (Beware: Here there be Tygers. Parallel makes have their surprises....)
>


From ripley at stats.ox.ac.uk  Mon Dec  1 11:22:04 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 1 Dec 2008 10:22:04 +0000 (GMT)
Subject: [Rd] normal-bracket50bracket-normal?
In-Reply-To: <4933074E.9020708@pdf.com>
References: <4933074E.9020708@pdf.com>
Message-ID: <alpine.LFD.2.00.0812011014160.29048@gannet.stats.ox.ac.uk>

These usually indicate incorrect files. Have you looked at the 
experimental Rd parser in R-devel to see if it pinpoints an error?

For example, in both Fperm.Rd and compareDerivatives.Rd there is an 
\itemize{} construct inside \value, which is incorrect as \value is itself 
an implicit \itemize.  Please do check the description in 'Writing R 
Extensions' (and \value is definitely quirky).

On Sun, 30 Nov 2008, Spencer Graves wrote:

> Hello:
>
>
>     I've found structures like "normal-bracket50bracket-normal" in
> help files for R packages including the following:
>
>          * "mergeprepare" and "mergematrices" in a document dated
> March 3, 2004 by Richard Mott;  the second contains
> "normal-bracket30bracket-normal".

Which is insufficient for the rest of us to get access to it.

>          * "Fperm.fd" and "tperm.fd" in the "fda" package;  these help pages 
> were written primarily by Giles Hooker.
>
>          * "compareDerivatives" in the "maxLik" package;  this help page was 
> written by Ott Toomet and me.
>
>
>     What can we do to eliminate this nonsense comment?
>
>     Constructs like this seem to be generated in perl code used in "R
> CMD" processing
> (https://svn.r-project.org/R/trunk/share/perl/R/Rdconv.pm).
>
>     Thanks,
>     Spencer Graves
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Mon Dec  1 11:26:03 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 1 Dec 2008 10:26:03 +0000 (GMT)
Subject: [Rd] parallel build for package? (equivalent of make -j8)
In-Reply-To: <4933B025.7000701@statistik.tu-dortmund.de>
References: <8ec76080811300725v1021f0b2l987da0db33c2f961@mail.gmail.com>
	<4932CD8A.6000402@biostat.ku.dk>
	<4933B025.7000701@statistik.tu-dortmund.de>
Message-ID: <alpine.LFD.2.00.0812011022320.29048@gannet.stats.ox.ac.uk>

On Mon, 1 Dec 2008, Uwe Ligges wrote:

>
>
> Peter Dalgaard wrote:
>> Whit Armstrong wrote:
>>> I have a package that takes about 20 minutes to compile which tends to
>>> prolong the compile/test/compile cycle.
>>> 
>>> Does anyone know how to get R CMD check or R CMD INSTALL to use parallel 
>>> make?
>>> 
>>> I looked at R CMD INSTALL --help, but I don't see anything obvious
>>> arguments to do this.
>> 
>> Platform?
>> 
>> Does
>> 
>> MAKE="make -j8" R CMD INSTALL ...
>>
>> not work?
>
> I cannot believe this works safely, at least when installing into the same 
> library, because of R's lock mechanism that locks a library if *one* 
> installation is running ...

It does say 'package' (singular).  It you know what you are doing you can 
switch off the locking (and you also need to worry about installing 
dependencies in the right order, at least for source installs).

I don't see the issue though: if you run R CMD INSTALL on a package 
directory (rather than a tarball), 'make' will only re-make the compiled 
code whose sources have changed.  Or is 'compile' being used loosely for 
'install' (and even so it is rare for the bits that are always done, e.g. 
dumping R code, to take long).

>
> Best,
> Uwe
>
>
>> (Beware: Here there be Tygers. Parallel makes have their surprises....)
>> 
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From dawiacount at gmx.de  Mon Dec  1 11:37:51 2008
From: dawiacount at gmx.de (Wilm Schumacher)
Date: Mon, 01 Dec 2008 11:37:51 +0100
Subject: [Rd] Legal problems
In-Reply-To: <49330F7E.2000408@ufl.edu>
References: <49330F7E.2000408@ufl.edu>
Message-ID: <20081201103751.201600@gmx.net>

Hello R-devel,

I have legal problems and perhaps you can help me.

Long story short: Do have the licence of R the linking exception?
http://en.wikipedia.org/wiki/GPL_linking_exception

Is it possible to build a frontend for R under the e.u.l.a. or another proprietary licence? 

Greetings

Wilm
-- 
Sensationsangebot verl?ngert: GMX FreeDSL - Telefonanschluss + DSL 
f?r nur 16,37 Euro/mtl.!* http://dsl.gmx.de/?ac=OM.AD.PD003K1308T4569a


From lgautier at gmail.com  Mon Dec  1 11:38:21 2008
From: lgautier at gmail.com (Laurent Gautier)
Date: Mon, 01 Dec 2008 11:38:21 +0100
Subject: [Rd] unrelated software install triggering an error from R's
 install script on Mac OS X 10.5
In-Reply-To: <4FC00087-A387-48CA-88EB-5823AE70BF85@r-project.org>
References: <49315329.7050703@gmail.com>
	<5EF06ADB-867B-4151-BBD2-E8293BE42745@uos.de>
	<49330FA2.1030604@gmail.com>
	<4FC00087-A387-48CA-88EB-5823AE70BF85@r-project.org>
Message-ID: <4933BE9D.1080204@gmail.com>

Simon Urbanek wrote:
> 
> On Dec 1, 2008, at 6:11 AM, Laurent Gautier wrote:
> 
>> Stefan Evert wrote:
>>>> The steps needed to generate the error are:
>>>>
>>>> - install a binary distribution of R (default location)
>>>> - add R to the PATH
>>> Did you actually add
>>>    /Library/Frameworks/R.framework/Resources/bin/
>>> to your PATH?  You're not supposed to do that!  What made you think so?
>>
>> Coming from an UNIX background, adding a directory like bin/ to the 
>> PATH   does not appear unreasonable.
>>
> 
> ... if you really want those files to prepend your PATH. You get what 
> you deserve ;) I this case you don't want that and this is true for all 
> unix platforms.
> 

The point seems to be slightly missed here: the result of installing R 
is that there is no R executable in the path, and that adding the only 
bin/ directory coming with the install to be path results in a broken 
system.




> 
>>> This directory contains a range of support scripts for R which are 
>>> not intended for direct use from the command line or other programs.  
>>> In my installation, there's just a symlink from /usr/bin/R to the R 
>>> binary in the directory above, which AFAIK is the only program you 
>>> need to invoke directly.
>>
>> I am relatively new to OS X, so I cannot tell whether this is an R 
>> specificity, or the way things are usually done on OS X are somewhat 
>> very different from the UNIX way.
> 
> Then you seem to be very unfamiliar with the unix way as it appears...
> 

Ah ! the flourishing pronouncements on the R-lists...


>> I am surprised by this cherry pick one executable in bin/ / don't 
>> touch the PATH.
>>
> 
> You are apparently unaware of the way R is setup ... Note that on most 
> unix systems this is exactly what you get - the R_HOME/bin directory is 
> tucked away in /usr/local/lib/R/bin which is never on your PATH since R 
> installs the user-visible scripts to /usr/local/bin. The same happens here.
> 

I guess that we this comparing apples with oranges here:
a default R install is leaving binaries in the path when performing a 
default install, which does not seem to be the case here (therefore 
forcing a hunt for the executable for the R console and resulting in the 
present thread).

The point here is that there is no user-exposed bin/ directory (or 
copying of the "right" executables by default to a place commonly agreed 
by some UNIX audiences as proper for binaries), and that the only bin/ 
found contains executables one should not get in his/her PATH.


>>
>>> In your case, R's "INSTALL" script, which implements the "R CMD 
>>> INSTALL" functionality masks the standard "install" program in 
>>> /usr/bin/install, so Python's installer now picks up a completely 
>>> wrong program.  Even if you edit R's "INSTALL" script, it'll do 
>>> something entirely different from what you expect.
>>
>> To my great dismay I am hearing here that Mac OS X is not case-sensitive.
>>
> 
> Mac OS X is case-sensitive. Case-sensitivity is an option of the mounted 
> file system and you can choose either. It is common to use 
> case-insensitive fs for historical reasons (compatibility with older 
> software), but you don't have to.
> 



>>> BTW, putting the R binary directory ahead of system directories such 
>>> as /usr/bin in your PATH is an even worse idea than including it 
>>> there in the first place. ;-)
>>
>> I am used to the fact that adding a bin/ directory in the PATH (and 
>> *ahead* of all other components in the PATH) is the way to add custom 
>> binaries.
> 
> If you want to override the system ones, yes. But you better know what 
> you're doing ;).
> 
> 
>> I cannot exclude that I am missing some specificities of Mac OS X, but 
>> that idea seems to be at least shared by the fink project (their 
>> default install puts /sw/bin ahead of all the rest).
>>
> 
> .. which leads to quite a few problems on its own. That's why you're 
> entirely on your own if you do so (and likely to run into problems where 
> Fink replaces systems parts with non-standard binaries).
> 
>> I suppose that there is a documentation for R-on-OS-X and that I 
>> overlooked it.
>>
> 
> You overlooked quite a bit of documentation of unix and R - pretty much 
> none of it is OS X - specific.
> 
> 
> Cheers,
> S
>>
>


From ligges at statistik.tu-dortmund.de  Mon Dec  1 12:01:55 2008
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Mon, 01 Dec 2008 12:01:55 +0100
Subject: [Rd] parallel build for package? (equivalent of make -j8)
In-Reply-To: <alpine.LFD.2.00.0812011022320.29048@gannet.stats.ox.ac.uk>
References: <8ec76080811300725v1021f0b2l987da0db33c2f961@mail.gmail.com>	<4932CD8A.6000402@biostat.ku.dk>	<4933B025.7000701@statistik.tu-dortmund.de>
	<alpine.LFD.2.00.0812011022320.29048@gannet.stats.ox.ac.uk>
Message-ID: <4933C423.807@statistik.tu-dortmund.de>



Prof Brian Ripley wrote:
> On Mon, 1 Dec 2008, Uwe Ligges wrote:
> 
>>
>>
>> Peter Dalgaard wrote:
>>> Whit Armstrong wrote:
>>>> I have a package that takes about 20 minutes to compile which tends to
>>>> prolong the compile/test/compile cycle.
>>>>
>>>> Does anyone know how to get R CMD check or R CMD INSTALL to use 
>>>> parallel make?
>>>>
>>>> I looked at R CMD INSTALL --help, but I don't see anything obvious
>>>> arguments to do this.
>>>
>>> Platform?
>>>
>>> Does
>>>
>>> MAKE="make -j8" R CMD INSTALL ...
>>>
>>> not work?
>>
>> I cannot believe this works safely, at least when installing into the 
>> same library, because of R's lock mechanism that locks a library if 
>> *one* installation is running ...
> 
> It does say 'package' (singular).

Good point, I thought we were talking about parallelizing many packages' 
installations. One should read the original question more carefully 
rather than starting from a response.....
My apologies for the nonsense - and you all know fortune("talking 
nonsense") anyway:

Uwe Ligges: I just told nonsense, stepclass() does not make sense with 
randomForest(), obviously ... (wonder why nobody shouted?).
Douglas Bates: Oh, we're just so used to you talking nonsense that we 
don't bother to point it out any more :-)
    -- Uwe Ligges and Douglas Bates
       R-help (July 2005)


Best,
Uwe



 > It you know what you are doing you
> can switch off the locking (and you also need to worry about installing 
> dependencies in the right order, at least for source installs).
 >
> I don't see the issue though: if you run R CMD INSTALL on a package 
> directory (rather than a tarball), 'make' will only re-make the compiled 
> code whose sources have changed.  Or is 'compile' being used loosely for 
> 'install' (and even so it is rare for the bits that are always done, 
> e.g. dumping R code, to take long).
> 
>>
>> Best,
>> Uwe
>>
>>
>>> (Beware: Here there be Tygers. Parallel makes have their surprises....)
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From ripley at stats.ox.ac.uk  Mon Dec  1 12:30:01 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 1 Dec 2008 11:30:01 +0000 (GMT)
Subject: [Rd] Legal problems
In-Reply-To: <20081201103751.201600@gmx.net>
References: <49330F7E.2000408@ufl.edu> <20081201103751.201600@gmx.net>
Message-ID: <alpine.LFD.2.00.0812011116120.12361@gannet.stats.ox.ac.uk>

On Mon, 1 Dec 2008, Wilm Schumacher wrote:

> Hello R-devel,
>
> I have legal problems and perhaps you can help me.

You really do need ask legally qualified people about legal problems, not 
least because you have not even stated the jurisdiction that applies.

> Long story short: Do have the licence of R the linking exception?
> http://en.wikipedia.org/wiki/GPL_linking_exception

I suggest you read the actual licence (see the start of every R session).

> Is it possible to build a frontend for R under the e.u.l.a. or another 
> proprietary licence?

(EULA usually means 'End User Licence Agreement', and is not well 
defined.)

These licences are about distribution, not building nor using.  So you 
need to consult with your lawyers about exactly what you want to do (and 
you have not told us).

> Greetings
>
> Wilm

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Mon Dec  1 13:34:19 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 1 Dec 2008 12:34:19 +0000 (GMT)
Subject: [Rd] Rtools28 - undefined references with gfortran
In-Reply-To: <OF6B6AE998.718395DA-ON8525750D.005F0106-8525750D.005F011D@american.edu>
References: <OF6B6AE998.718395DA-ON8525750D.005F0106-8525750D.005F011D@american.edu>
Message-ID: <alpine.LFD.2.00.0812011230060.10803@gannet.stats.ox.ac.uk>

On Wed, 26 Nov 2008, John Nolan wrote:

>
> I recently upgraded to Rtools28 to build a package under
> Windows.  I see that g77 is no longer in Rtools, but it
> does have gfortran, and it uses version:
>   GNU Fortran (GCC) 4.2.1-sjlj (mingw32-2)
>
> I am compiling some old fortran code as part of a larger
> project.  When I do that, I get undefined references:
>
> gcc.exe: s_cmp.o: No such file or directory
> gcc.exe: s_copy.o: No such file or directory
> gcc.exe: s_cat.o: No such file or directory
> gcc.exe: F77_aloc.o: No such file or directory
>
> I don't see these entry points in any of the accompanying
> library files.   I hunted around and found the above
> functions in an old MinGW library libg2c.lib

libg2c.a, perhaps?

> When I link them in, I get different undefined references:
>
> ilaenv.o:ilaenv.f:(.text+0x55): undefined reference to
> `_gfortran_compare_string
> dlamch.o:dlamch.f:(.text+0x3bf): undefined reference to
> `_gfortran_pow_r8_i4'
> dormlq.o:dormlq.f:(.text+0x281): undefined reference to
> `_gfortran_concat_string
>
>
> Any guidance on how to solve this problem?

Give a reproducible example (or at least all the steps you used) : see the 
posting guide.

At a guess you are using gcc.exe to link Fortran code, not gfortran.exe. 
You can sometimes do that by adding -lgfortran to the link line.  But 
don't expect your helpers to be prepared to guess ....

>
> John Nolan
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Mon Dec  1 13:44:27 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 1 Dec 2008 12:44:27 +0000 (GMT)
Subject: [Rd] file.access() on network (mounted) drive on Windows Vista?
In-Reply-To: <59d7961d0811261122v44f187a8s7f78512d264894bd@mail.gmail.com>
References: <59d7961d0811261122v44f187a8s7f78512d264894bd@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.0812011235250.10803@gannet.stats.ox.ac.uk>

It is a 'feature' of Windows Vista.  Why not just use tryCatch()?
The older version of file.access() used to report access when there was 
none, so the error have happened both ways.

(I think any OS with multiple filesystems potentially has problems like 
this: we saw them with Unix (Solaris) file systems mounted on MacOS X via 
Samba, even when the same thing works correctly on Linux.)

On Wed, 26 Nov 2008, Henrik Bengtsson wrote:

> Hi,
>
> I have a writable and readable file on a small network file system
> (Cisco NSLU2 Unslung; non-NTFS) that I access via a mounted drive on
> Windows Vista.  My problem could be due to a "funny" file
> system/server, but here it goes:
>
>> pathname <- "Q:/foo.txt"
>> cat(file=pathname, "Hello world!\n")
>> readLines(pathname)
> [1] "Hello world!"
>> file.info(pathname)
>           size isdir mode               mtime               ctime
> Q:/foo.txt   14 FALSE  666 2008-11-26 11:45:53 2008-11-26 11:45:53
>                         atime exe
> Q:/foo.txt 2008-11-26 11:45:57  no
>
> The mode == 666 reported by file.info() indicates that it is readable
> & writable by all users.  This is also what Windows Vista file
> properties reports.  So far so good.  However, when I use
> file.access() to test for file permissions, I get:
>
>> file.access(pathname, 0)  # 0 test for existence.
> Q:/foo.txt
>         0
>> file.access(pathname, 1) # 1 test for execute permission.
> Q:/foo.txt
>        -1
>> file.access(pathname, 2) # 2 test for write permission.
> Q:/foo.txt
>        -1
>> file.access(pathname, 4) # 4 test for read permission.
> Q:/foo.txt
>        -1
>
> I obviously can write to and read from the file, and this is what
> file.info()$mode says too.  However, file.access() tells a different
> story.  More troubleshooting: When I log into the file server and do:
>
> # chmod ugo-w foo.txt
> # ls -l foo.txt
> -r-xr-----    1 admin    everyone       14 Nov 26 11:48 foo.txt
>
> The changes in permission are seen by file.info():
>
>> file.info(pathname)
>           size isdir mode               mtime               ctime
> Q:/foo.txt   14 FALSE  444 2008-11-26 11:48:50 2008-11-26 11:48:50
>                         atime exe
> Q:/foo.txt 2008-11-26 11:56:40  no
>
> The output from file.access() remains the same though.
>
>> From help(file.info) I read:
>
>     File modes are probably only useful on NTFS file systems, and it
>     seems all three digits refer to the file's owner. The
>     execute/search bits are set for directories, and for files based
>     on their extensions (e.g., '.exe', '.com', '.cmd' and '.bat'
>     files).  'file.access' will give a more reliable view of
>     read/write access availability to the R process.
>
>> From what I conclude, file.access() is not reliable in this case.  Is
> this a feature or a bug?
>
> I need a cross-platform test for file permissions, and I am looking
> for safer workaround.  For instance, could it be that a zero result
> from file.access() can be trusted, but a -1 could occur either from a
> true lack of permission as well as a failure to test for the
> permission?  If that would be case, I could try other measures (e.g.
> try to open the file) whenever I receive a -1 before throwing an
> exception.
>
> Any feedback or suggestions would be great.
>
> Thanks
>
> /Henrik
>
>> sessionInfo()
> R version 2.8.0 Patched (2008-10-21 r46766)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United States.1252;LC_MON
> ETARY=English_United States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From osklyar at maninvestments.com  Mon Dec  1 13:49:57 2008
From: osklyar at maninvestments.com (Sklyar, Oleg (London))
Date: Mon, 1 Dec 2008 12:49:57 -0000
Subject: [Rd] handling a matrix and .C
In-Reply-To: <20081124185855.152920@gmx.net>
References: <20081124185855.152920@gmx.net>
Message-ID: <1A68FCB28DE72F4BA3B967E6506CCE430304991E@mildnpexmb01.maninvestments.ad.man.com>

You should not have started with R/C API without reading this (first
link in google): "Writing R Extensions". For your particular question
you want pages 72+ and sections 5.9.3 and 5.9.4, possibly further as
well

Dr Oleg Sklyar
Research Technologist
AHL / Man Investments Ltd
+44 (0)20 7144 3107
osklyar at maninvestments.com 

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Wilm Schumacher
> Sent: 24 November 2008 18:59
> To: r-devel at r-project.org
> Subject: [Rd] handling a matrix and .C
> 
> Hello R-devel,
> 
> I want to write extensions for R in C (maybe C++ and Fortran 
> later) and it works fine, but there is one problem, which I 
> cannot solve (in my view).
> 
> I want to handle a matrix from R in C. For arrays there is 
> "as.double(...)", but nothing for a matrix.
> 
> I searched a while, but didn't find something.
> 
> Last I looked at the source code of e1071 and of the core 
> itself and recognized (I hope I understood this), that you 
> (and the "e1071" people) use "as.double()" and give ".C" an 
> array and one have to "parse" the matrix again in the C function.
> 
> This sounds a little complicate. Isn't there another way? A 
> more adapted way?
> 
> Greetings
> 
> Wilm
> 
> ps: I joined the R-devel list, but didn't get an confirmation 
> mail. I hope this is normal
> --
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

**********************************************************************
Please consider the environment before printing this email or its attachments.

The contents of this email are for the named addressees ...{{dropped:19}}


From P.Dalgaard at biostat.ku.dk  Mon Dec  1 14:15:54 2008
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon, 01 Dec 2008 14:15:54 +0100
Subject: [Rd] Bug repo may have stalled
Message-ID: <4933E38A.7020602@biostat.ku.dk>

We have a local certificate problem on our servers. As a result,
fetchmail may not be fetching mails to be processed by the bug tracker.

I expect that the problem wil go away by itself fairly soon, but please
don't do anything silly (like sending the same report 15 times).


-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From stefan.evert at uos.de  Mon Dec  1 15:31:22 2008
From: stefan.evert at uos.de (Stefan Evert)
Date: Mon, 1 Dec 2008 15:31:22 +0100
Subject: [Rd] unrelated software install triggering an error from R's
	install script on Mac OS X 10.5
In-Reply-To: <4933BE9D.1080204@gmail.com>
References: <49315329.7050703@gmail.com>
	<5EF06ADB-867B-4151-BBD2-E8293BE42745@uos.de>
	<49330FA2.1030604@gmail.com>
	<4FC00087-A387-48CA-88EB-5823AE70BF85@r-project.org>
	<4933BE9D.1080204@gmail.com>
Message-ID: <9D857E3D-B10A-4CD2-A46B-C62285B86BE2@uos.de>

>
> I guess that we this comparing apples with oranges here:
> a default R install is leaving binaries in the path when performing  
> a default install, which does not seem to be the case here  
> (therefore forcing a hunt for the executable for the R console and  
> resulting in the present thread).


Well, the assumption seems to be that end users who just run an  
installer without reading the associated documentation won't be  
interested in a command-line version and will just start the R GUI  
that shows up in their /Applications folder ...

> The point seems to be slightly missed here: the result of installing  
> R is that there is no R executable in the path, and that adding the  
> only bin/ directory coming with the install to be path results in a  
> broken system.

... and that people who add directories to their PATH tend to read  
instructions carefully.  The download page for the Mac OS X binaries  
says:

> You may also want to read the R FAQ and R for Mac OS X FAQ.

and in the Mac OS X FAQ you'll easily find the necessary instructions  
for using the command-line version:

> 3 Command line version of R
> The command line version of R is identical to R as used on other  
> unix operating systems. Therefore general documentation forR applies  
> to this version as well. On each release (and patched-release) ready  
> to use binaries are distributed through CRAN. These binaries come  
> with a common installer used by R.app so please read the related  
> notes (see How to get R.app). To use Ryou probably need to add a  
> symbolic link on your system as the R binary is located inside the  
> framework. Suppose you have the/usr/local/bin directory on your  
> system (if you do not have one, you can use /usr/bin instead) you  
> should just type in your Terminal (a root password is required)
>
> sudo ln -s /Library/Frameworks/R.framework/Resources/R /usr/local/ 
> bin/R
> Assuming that you have /usr/local/bin in your PATH environment  
> variable, you will be able to launch R from any location on your  
> system just by typing R. In this way, when you install a new version  
> of the R.framework this link will point to the latest R binary.
>

I suppose that with "doing things the Unix way" you've probably been  
referring to the package managers / installers that most Linux  
distributions use and which do indeed make their installed programs  
available from the command line.





Best regards,
Stefan Evert

[ stefan.evert at uos.de | http://purl.org/stefan.evert ]


From spencer.graves at pdf.com  Mon Dec  1 16:31:37 2008
From: spencer.graves at pdf.com (Spencer Graves)
Date: Mon, 01 Dec 2008 07:31:37 -0800
Subject: [Rd] normal-bracket50bracket-normal?
In-Reply-To: <alpine.LFD.2.00.0812011014160.29048@gannet.stats.ox.ac.uk>
References: <4933074E.9020708@pdf.com>
	<alpine.LFD.2.00.0812011014160.29048@gannet.stats.ox.ac.uk>
Message-ID: <49340359.300@pdf.com>

Dear Prof. Ripley: 

      Thanks very much.  It looks like removing the "\itemize" from 
within "\value" should fix the problem, though I haven't fully tested it 
yet.  I previously removed that from "Fperm.fd" and the problem is fixed 
there.  I haven't yet tested it with "tperm.fd" and "compareDerivatives". 

      Thanks again. 
      Spencer

Prof Brian Ripley wrote:
> These usually indicate incorrect files. Have you looked at the 
> experimental Rd parser in R-devel to see if it pinpoints an error?
>
> For example, in both Fperm.Rd and compareDerivatives.Rd there is an 
> \itemize{} construct inside \value, which is incorrect as \value is 
> itself an implicit \itemize.  Please do check the description in 
> 'Writing R Extensions' (and \value is definitely quirky).
>
> On Sun, 30 Nov 2008, Spencer Graves wrote:
>
>> Hello:
>>
>>
>>     I've found structures like "normal-bracket50bracket-normal" in
>> help files for R packages including the following:
>>
>>          * "mergeprepare" and "mergematrices" in a document dated
>> March 3, 2004 by Richard Mott;  the second contains
>> "normal-bracket30bracket-normal".
>
> Which is insufficient for the rest of us to get access to it.
>
>>          * "Fperm.fd" and "tperm.fd" in the "fda" package;  these 
>> help pages were written primarily by Giles Hooker.
>>
>>          * "compareDerivatives" in the "maxLik" package;  this help 
>> page was written by Ott Toomet and me.
>>
>>
>>     What can we do to eliminate this nonsense comment?
>>
>>     Constructs like this seem to be generated in perl code used in "R
>> CMD" processing
>> (https://svn.r-project.org/R/trunk/share/perl/R/Rdconv.pm).
>>
>>     Thanks,
>>     Spencer Graves
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From martin.becker at mx.uni-saarland.de  Mon Dec  1 17:49:38 2008
From: martin.becker at mx.uni-saarland.de (Martin Becker)
Date: Mon, 01 Dec 2008 17:49:38 +0100
Subject: [Rd] Small bug in axis.POSIXct
Message-ID: <493415A2.3080106@mx.uni-saarland.de>

Dear developers,

the tick marks and labels produced by axis.POSIXct look strange for time 
horizons of a few hours, see the following example:

  
plot(seq(as.POSIXct("14:00",format="%H:%M"),as.POSIXct("18:00",format="%H:%M"),length.out=20),1:20)

This (copy&paste error?) is easily fixed, see the attached patch (for 
revision 47031).

Best wishes,

  Martin

-- 
Dr. Martin Becker
Statistics and Econometrics
Saarland University
Campus C3 1, Room 206
66123 Saarbruecken
Germany

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: datetime.R.diff.txt
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081201/7e069a46/attachment.txt>

From seanpor at acm.org  Mon Dec  1 20:32:13 2008
From: seanpor at acm.org (Sean O'Riordain)
Date: Mon, 1 Dec 2008 19:32:13 +0000
Subject: [Rd] trivial spelling correction
Message-ID: <8ed68eed0812011132x58ce0f5o886d919203590a63@mail.gmail.com>

Good evening,

Spotted a very minor spelling mistake in the source for the grep help.

And thanks to R-Core for all their work - it's a tribute to R-Core,
that these sort of "problems" are rare indeed.

Best regards,
Sean O'Riordain
Dublin


sean at sean7:~/R/RSVN/R/trunk/src/library/base/man$ svn diff
Index: grep.Rd
===================================================================
--- grep.Rd	(revision 47031)
+++ grep.Rd	(working copy)
@@ -102,7 +102,7 @@

   For \code{sub} and \code{gsub} a character vector of the same length
   and with the same attributes as \code{x} (after possible coercion).
-  Elements of character vectors \code{x} which are not subsituted will
+  Elements of character vectors \code{x} which are not substituted will
   be return unchanged (including any declared encoding).  If
   \code{useBytes = FALSE}, either \code{perl = TRUE} or \code{fixed =
     TRUE} and any element of \code{pattern}, \code{replacement} and


From hb at stat.berkeley.edu  Mon Dec  1 21:03:00 2008
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Mon, 1 Dec 2008 12:03:00 -0800
Subject: [Rd] file.access() on network (mounted) drive on Windows Vista?
In-Reply-To: <alpine.LFD.2.00.0812011235250.10803@gannet.stats.ox.ac.uk>
References: <59d7961d0811261122v44f187a8s7f78512d264894bd@mail.gmail.com>
	<alpine.LFD.2.00.0812011235250.10803@gannet.stats.ox.ac.uk>
Message-ID: <59d7961d0812011203ydfb727fx8eeab4f1c6c85749@mail.gmail.com>

Hi,

thank you very much for this information.  I now know that it is safer
to use tryCatch() to test for this.

Details: I have a function pn <- getReadablePathname(pn) that I use to
assess that a pathname (which also follows Windows Shortcuts) passed
to a function specifies a file that exists and that can be read.  If
not, it throws an exception.  I only need to update this function to
try to open the file for reading ("rb") and then try to read a raw
byte (for an even more trusted result).  If this fails, I conclude
that the file is not a readable pathname.  I also have an analogus
getWritablePathname().

/Henrik

On Mon, Dec 1, 2008 at 4:44 AM, Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
> It is a 'feature' of Windows Vista.  Why not just use tryCatch()?
> The older version of file.access() used to report access when there was
> none, so the error have happened both ways.
>
> (I think any OS with multiple filesystems potentially has problems like
> this: we saw them with Unix (Solaris) file systems mounted on MacOS X via
> Samba, even when the same thing works correctly on Linux.)
>
> On Wed, 26 Nov 2008, Henrik Bengtsson wrote:
>
>> Hi,
>>
>> I have a writable and readable file on a small network file system
>> (Cisco NSLU2 Unslung; non-NTFS) that I access via a mounted drive on
>> Windows Vista.  My problem could be due to a "funny" file
>> system/server, but here it goes:
>>
>>> pathname <- "Q:/foo.txt"
>>> cat(file=pathname, "Hello world!\n")
>>> readLines(pathname)
>>
>> [1] "Hello world!"
>>>
>>> file.info(pathname)
>>
>>          size isdir mode               mtime               ctime
>> Q:/foo.txt   14 FALSE  666 2008-11-26 11:45:53 2008-11-26 11:45:53
>>                        atime exe
>> Q:/foo.txt 2008-11-26 11:45:57  no
>>
>> The mode == 666 reported by file.info() indicates that it is readable
>> & writable by all users.  This is also what Windows Vista file
>> properties reports.  So far so good.  However, when I use
>> file.access() to test for file permissions, I get:
>>
>>> file.access(pathname, 0)  # 0 test for existence.
>>
>> Q:/foo.txt
>>        0
>>>
>>> file.access(pathname, 1) # 1 test for execute permission.
>>
>> Q:/foo.txt
>>       -1
>>>
>>> file.access(pathname, 2) # 2 test for write permission.
>>
>> Q:/foo.txt
>>       -1
>>>
>>> file.access(pathname, 4) # 4 test for read permission.
>>
>> Q:/foo.txt
>>       -1
>>
>> I obviously can write to and read from the file, and this is what
>> file.info()$mode says too.  However, file.access() tells a different
>> story.  More troubleshooting: When I log into the file server and do:
>>
>> # chmod ugo-w foo.txt
>> # ls -l foo.txt
>> -r-xr-----    1 admin    everyone       14 Nov 26 11:48 foo.txt
>>
>> The changes in permission are seen by file.info():
>>
>>> file.info(pathname)
>>
>>          size isdir mode               mtime               ctime
>> Q:/foo.txt   14 FALSE  444 2008-11-26 11:48:50 2008-11-26 11:48:50
>>                        atime exe
>> Q:/foo.txt 2008-11-26 11:56:40  no
>>
>> The output from file.access() remains the same though.
>>
>>> From help(file.info) I read:
>>
>>    File modes are probably only useful on NTFS file systems, and it
>>    seems all three digits refer to the file's owner. The
>>    execute/search bits are set for directories, and for files based
>>    on their extensions (e.g., '.exe', '.com', '.cmd' and '.bat'
>>    files).  'file.access' will give a more reliable view of
>>    read/write access availability to the R process.
>>
>>> From what I conclude, file.access() is not reliable in this case.  Is
>>
>> this a feature or a bug?
>>
>> I need a cross-platform test for file permissions, and I am looking
>> for safer workaround.  For instance, could it be that a zero result
>> from file.access() can be trusted, but a -1 could occur either from a
>> true lack of permission as well as a failure to test for the
>> permission?  If that would be case, I could try other measures (e.g.
>> try to open the file) whenever I receive a -1 before throwing an
>> exception.
>>
>> Any feedback or suggestions would be great.
>>
>> Thanks
>>
>> /Henrik
>>
>>> sessionInfo()
>>
>> R version 2.8.0 Patched (2008-10-21 r46766)
>> i386-pc-mingw32
>>
>> locale:
>> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
>> States.1252;LC_MON
>> ETARY=English_United States.1252;LC_NUMERIC=C;LC_TIME=English_United
>> States.1252
>>
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> --
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>


From armstrong.whit at gmail.com  Tue Dec  2 00:33:26 2008
From: armstrong.whit at gmail.com (Whit Armstrong)
Date: Mon, 1 Dec 2008 18:33:26 -0500
Subject: [Rd] parallel build for package? (equivalent of make -j8)
In-Reply-To: <4933C423.807@statistik.tu-dortmund.de>
References: <8ec76080811300725v1021f0b2l987da0db33c2f961@mail.gmail.com>
	<4932CD8A.6000402@biostat.ku.dk>
	<4933B025.7000701@statistik.tu-dortmund.de>
	<alpine.LFD.2.00.0812011022320.29048@gannet.stats.ox.ac.uk>
	<4933C423.807@statistik.tu-dortmund.de>
Message-ID: <8ec76080812011533w772853dcudd234a88304a50e8@mail.gmail.com>

yes, this was just a parallel build within one package.

Thanks very much for your help.

-Whit


On Mon, Dec 1, 2008 at 6:01 AM, Uwe Ligges
<ligges at statistik.tu-dortmund.de> wrote:
>
>
> Prof Brian Ripley wrote:
>>
>> On Mon, 1 Dec 2008, Uwe Ligges wrote:
>>
>>>
>>>
>>> Peter Dalgaard wrote:
>>>>
>>>> Whit Armstrong wrote:
>>>>>
>>>>> I have a package that takes about 20 minutes to compile which tends to
>>>>> prolong the compile/test/compile cycle.
>>>>>
>>>>> Does anyone know how to get R CMD check or R CMD INSTALL to use
>>>>> parallel make?
>>>>>
>>>>> I looked at R CMD INSTALL --help, but I don't see anything obvious
>>>>> arguments to do this.
>>>>
>>>> Platform?
>>>>
>>>> Does
>>>>
>>>> MAKE="make -j8" R CMD INSTALL ...
>>>>
>>>> not work?
>>>
>>> I cannot believe this works safely, at least when installing into the
>>> same library, because of R's lock mechanism that locks a library if *one*
>>> installation is running ...
>>
>> It does say 'package' (singular).
>
> Good point, I thought we were talking about parallelizing many packages'
> installations. One should read the original question more carefully rather
> than starting from a response.....
> My apologies for the nonsense - and you all know fortune("talking nonsense")
> anyway:
>
> Uwe Ligges: I just told nonsense, stepclass() does not make sense with
> randomForest(), obviously ... (wonder why nobody shouted?).
> Douglas Bates: Oh, we're just so used to you talking nonsense that we don't
> bother to point it out any more :-)
>   -- Uwe Ligges and Douglas Bates
>      R-help (July 2005)
>
>
> Best,
> Uwe
>
>
>
>> It you know what you are doing you
>>
>> can switch off the locking (and you also need to worry about installing
>> dependencies in the right order, at least for source installs).
>
>>
>>
>> I don't see the issue though: if you run R CMD INSTALL on a package
>> directory (rather than a tarball), 'make' will only re-make the compiled
>> code whose sources have changed.  Or is 'compile' being used loosely for
>> 'install' (and even so it is rare for the bits that are always done, e.g.
>> dumping R code, to take long).
>>
>>>
>>> Best,
>>> Uwe
>>>
>>>
>>>> (Beware: Here there be Tygers. Parallel makes have their surprises....)
>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From simon.urbanek at r-project.org  Tue Dec  2 07:31:07 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 2 Dec 2008 14:31:07 +0800
Subject: [Rd] unrelated software install triggering an error from R's
	install script on Mac OS X 10.5
In-Reply-To: <4933BE9D.1080204@gmail.com>
References: <49315329.7050703@gmail.com>
	<5EF06ADB-867B-4151-BBD2-E8293BE42745@uos.de>
	<49330FA2.1030604@gmail.com>
	<4FC00087-A387-48CA-88EB-5823AE70BF85@r-project.org>
	<4933BE9D.1080204@gmail.com>
Message-ID: <CAB8C164-81CE-4E93-813B-6BC62AFA8879@r-project.org>


On Dec 1, 2008, at 6:38 PM, Laurent Gautier wrote:

> Simon Urbanek wrote:
>> On Dec 1, 2008, at 6:11 AM, Laurent Gautier wrote:
>>> Stefan Evert wrote:
>>>>> The steps needed to generate the error are:
>>>>>
>>>>> - install a binary distribution of R (default location)
>>>>> - add R to the PATH
>>>> Did you actually add
>>>>   /Library/Frameworks/R.framework/Resources/bin/
>>>> to your PATH?  You're not supposed to do that!  What made you  
>>>> think so?
>>>
>>> Coming from an UNIX background, adding a directory like bin/ to  
>>> the PATH   does not appear unreasonable.
>>>
>> ... if you really want those files to prepend your PATH. You get  
>> what you deserve ;) I this case you don't want that and this is  
>> true for all unix platforms.
>
> The point seems to be slightly missed here: the result of installing  
> R is that there is no R executable in the path,


Clearly a false statement, look in /usr/bin (both R and Rscript are  
installed there) - hence there is no need for you to add anything ...  
which is why I think this discussion is quite redundant ;).

Cheers,
S


> and that adding the only bin/ directory coming with the install to  
> be path results in a broken system.
>
>
>
>
>>>> This directory contains a range of support scripts for R which  
>>>> are not intended for direct use from the command line or other  
>>>> programs.  In my installation, there's just a symlink from /usr/ 
>>>> bin/R to the R binary in the directory above, which AFAIK is the  
>>>> only program you need to invoke directly.
>>>
>>> I am relatively new to OS X, so I cannot tell whether this is an R  
>>> specificity, or the way things are usually done on OS X are  
>>> somewhat very different from the UNIX way.
>> Then you seem to be very unfamiliar with the unix way as it  
>> appears...
>
> Ah ! the flourishing pronouncements on the R-lists...
>
>
>>> I am surprised by this cherry pick one executable in bin/ / don't  
>>> touch the PATH.
>>>
>> You are apparently unaware of the way R is setup ... Note that on  
>> most unix systems this is exactly what you get - the R_HOME/bin  
>> directory is tucked away in /usr/local/lib/R/bin which is never on  
>> your PATH since R installs the user-visible scripts to /usr/local/ 
>> bin. The same happens here.
>
> I guess that we this comparing apples with oranges here:
> a default R install is leaving binaries in the path when performing  
> a default install, which does not seem to be the case here  
> (therefore forcing a hunt for the executable for the R console and  
> resulting in the present thread).
>
> The point here is that there is no user-exposed bin/ directory (or  
> copying of the "right" executables by default to a place commonly  
> agreed by some UNIX audiences as proper for binaries), and that the  
> only bin/ found contains executables one should not get in his/her  
> PATH.
>
>
>>>
>>>> In your case, R's "INSTALL" script, which implements the "R CMD  
>>>> INSTALL" functionality masks the standard "install" program in / 
>>>> usr/bin/install, so Python's installer now picks up a completely  
>>>> wrong program.  Even if you edit R's "INSTALL" script, it'll do  
>>>> something entirely different from what you expect.
>>>
>>> To my great dismay I am hearing here that Mac OS X is not case- 
>>> sensitive.
>>>
>> Mac OS X is case-sensitive. Case-sensitivity is an option of the  
>> mounted file system and you can choose either. It is common to use  
>> case-insensitive fs for historical reasons (compatibility with  
>> older software), but you don't have to.
>
>
>
>>>> BTW, putting the R binary directory ahead of system directories  
>>>> such as /usr/bin in your PATH is an even worse idea than  
>>>> including it there in the first place. ;-)
>>>
>>> I am used to the fact that adding a bin/ directory in the PATH  
>>> (and *ahead* of all other components in the PATH) is the way to  
>>> add custom binaries.
>> If you want to override the system ones, yes. But you better know  
>> what you're doing ;).
>>> I cannot exclude that I am missing some specificities of Mac OS X,  
>>> but that idea seems to be at least shared by the fink project  
>>> (their default install puts /sw/bin ahead of all the rest).
>>>
>> .. which leads to quite a few problems on its own. That's why  
>> you're entirely on your own if you do so (and likely to run into  
>> problems where Fink replaces systems parts with non-standard  
>> binaries).
>>> I suppose that there is a documentation for R-on-OS-X and that I  
>>> overlooked it.
>>>
>> You overlooked quite a bit of documentation of unix and R - pretty  
>> much none of it is OS X - specific.
>> Cheers,
>> S
>>>
>
>


From maechler at stat.math.ethz.ch  Wed Dec  3 11:19:34 2008
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Wed, 3 Dec 2008 11:19:34 +0100
Subject: [Rd] trivial spelling correction
In-Reply-To: <8ed68eed0812011132x58ce0f5o886d919203590a63@mail.gmail.com>
References: <8ed68eed0812011132x58ce0f5o886d919203590a63@mail.gmail.com>
Message-ID: <18742.23862.335367.891466@stat.math.ethz.ch>

>>>>> "SO" == Sean O'Riordain <seanpor at acm.org>
>>>>>     on Mon, 1 Dec 2008 19:32:13 +0000 writes:

    SO> Good evening,
    SO> Spotted a very minor spelling mistake in the source for the grep help.

    SO> And thanks to R-Core for all their work - it's a tribute to R-Core,
    SO> that these sort of "problems" are rare indeed.

Thank you, Sean, that's fixed now.

Martin

    SO> Best regards,
    SO> Sean O'Riordain
    SO> Dublin


    SO> sean at sean7:~/R/RSVN/R/trunk/src/library/base/man$ svn diff
    SO> Index: grep.Rd
    SO> ===================================================================
    SO> --- grep.Rd	(revision 47031)
    SO> +++ grep.Rd	(working copy)
    SO> @@ -102,7 +102,7 @@

    SO> For \code{sub} and \code{gsub} a character vector of the same length
    SO> and with the same attributes as \code{x} (after possible coercion).
    SO> -  Elements of character vectors \code{x} which are not subsituted will
    SO> +  Elements of character vectors \code{x} which are not substituted will
    SO> be return unchanged (including any declared encoding).  If
    SO> \code{useBytes = FALSE}, either \code{perl = TRUE} or \code{fixed =
    SO> TRUE} and any element of \code{pattern}, \code{replacement} and


From Thomas.Petzoldt at tu-dresden.de  Wed Dec  3 12:18:25 2008
From: Thomas.Petzoldt at tu-dresden.de (Thomas Petzoldt)
Date: Wed, 03 Dec 2008 12:18:25 +0100
Subject: [Rd] nlminb: names of parameter vector not passed to objective
	function
Message-ID: <49366B01.8070202@tu-dresden.de>

Dear R developers,

I tried to use nlminb instead of optim for a current problem (fitting 
parameters of a differential equation model). The PORT algorithm 
converged much better than any of optim's methods and the identified 
parameters are plausible. However, it took me a while before spotting 
the reason of a technical problem that nlminb, in contrast to optim, 
does not pass names of the start parameters to the objective function.

Please find below a minimum reproducible example. There is, of course, a 
workaround, but in order to make optim and nlme more compatible I would 
ask whether it would be possible to change this idiosyncratic behavior?

Tested with:

R version 2.8.0 Patched (2008-11-04 r46830) i386-pc-mingw32

and also

R version 2.9.0 Under development (unstable) (2008-12-03 r47039)
i386-pc-mingw32

Thanks a lot

Thomas Petzoldt



set.seed(3577) # make it reproducible

## 1) example taken from  ?nlminb -------------------------------------
x <- rnbinom(100, mu = 10, size = 10)
hdev <- function(par) {
     -sum(dnbinom(x, mu = par[1], size = par[2], log = TRUE))
}
nlminb(c(20, 20), hdev, lower = 0.001, upper = Inf)
## --> works without problems

## 2) same example, but with named vectors -----------------------------
hdev <- function(par) {
     cat(names(par), "\n")  # show what happens
     -sum(dnbinom(x, mu = par["mu"], size = par["size"], log = TRUE))
}
start <- c(mu=20, size=20)

optim(start, hdev, lower = 0.001, upper = Inf, method="L-BFGS-B")
## --> works without problems

## 3) THE PROBLEM
nlminb(start, hdev, lower = 0.001, upper = Inf)
## --> $objective is NA because names of "start" are not passed through

## 4) workaround -------------------------------------------------------
hdev <- function(par, pnames) {
     names(par) <- pnames
     -sum(dnbinom(x, mu = par["mu"], size = par["size"], log = TRUE))
}

nlminb(start, hdev, pnames = names(start), lower = 0.001, upper = Inf)

## --> works, but is it possible to improve nlminb
##     so that the workaround can be avoided ?






-- 
Thomas Petzoldt
Technische Universitaet Dresden
Institut fuer Hydrobiologie        thomas.petzoldt at tu-dresden.de
01062 Dresden                      http://tu-dresden.de/hydrobiologie/
GERMANY


From ripley at stats.ox.ac.uk  Wed Dec  3 12:49:06 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 3 Dec 2008 11:49:06 +0000 (GMT)
Subject: [Rd] nlminb: names of parameter vector not passed to objective
 function
In-Reply-To: <49366B01.8070202@tu-dresden.de>
References: <49366B01.8070202@tu-dresden.de>
Message-ID: <alpine.LFD.2.00.0812031144110.28671@gannet.stats.ox.ac.uk>

On Wed, 3 Dec 2008, Thomas Petzoldt wrote:

> Dear R developers,
>
> I tried to use nlminb instead of optim for a current problem (fitting 
> parameters of a differential equation model). The PORT algorithm converged 
> much better than any of optim's methods and the identified parameters are 
> plausible. However, it took me a while before spotting the reason of a 
> technical problem that nlminb, in contrast to optim, does not pass names of 
> the start parameters to the objective function.
>
> Please find below a minimum reproducible example. There is, of course, a 
> workaround, but in order to make optim and nlme more compatible I would ask 
> whether it would be possible to change this idiosyncratic behavior?

The 'idiosyncratic behavior' is to expect that a new vector of parameters 
will magically inherit names from the start vector.  optim() was changed 
(and documented) because some users asked for this, and if a user who 
wants it for nlminb provides a tested patch, I am sure it will be 
considered.

Note the documentation difference.

>
> Tested with:
>
> R version 2.8.0 Patched (2008-11-04 r46830) i386-pc-mingw32
>
> and also
>
> R version 2.9.0 Under development (unstable) (2008-12-03 r47039)
> i386-pc-mingw32
>
> Thanks a lot
>
> Thomas Petzoldt
>
>
>
> set.seed(3577) # make it reproducible
>
> ## 1) example taken from  ?nlminb -------------------------------------
> x <- rnbinom(100, mu = 10, size = 10)
> hdev <- function(par) {
>    -sum(dnbinom(x, mu = par[1], size = par[2], log = TRUE))
> }
> nlminb(c(20, 20), hdev, lower = 0.001, upper = Inf)
> ## --> works without problems
>
> ## 2) same example, but with named vectors -----------------------------
> hdev <- function(par) {
>    cat(names(par), "\n")  # show what happens
>    -sum(dnbinom(x, mu = par["mu"], size = par["size"], log = TRUE))
> }
> start <- c(mu=20, size=20)
>
> optim(start, hdev, lower = 0.001, upper = Inf, method="L-BFGS-B")
> ## --> works without problems
>
> ## 3) THE PROBLEM
> nlminb(start, hdev, lower = 0.001, upper = Inf)
> ## --> $objective is NA because names of "start" are not passed through
>
> ## 4) workaround -------------------------------------------------------
> hdev <- function(par, pnames) {
>    names(par) <- pnames
>    -sum(dnbinom(x, mu = par["mu"], size = par["size"], log = TRUE))
> }
>
> nlminb(start, hdev, pnames = names(start), lower = 0.001, upper = Inf)
>
> ## --> works, but is it possible to improve nlminb
> ##     so that the workaround can be avoided ?
>
>
>
>
>
>
> -- 
> Thomas Petzoldt
> Technische Universitaet Dresden
> Institut fuer Hydrobiologie        thomas.petzoldt at tu-dresden.de
> 01062 Dresden                      http://tu-dresden.de/hydrobiologie/
> GERMANY
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From Thomas.Petzoldt at tu-dresden.de  Wed Dec  3 13:59:00 2008
From: Thomas.Petzoldt at tu-dresden.de (Thomas Petzoldt)
Date: Wed, 03 Dec 2008 13:59:00 +0100
Subject: [Rd] nlminb: names of parameter vector not passed to objective
 function
In-Reply-To: <alpine.LFD.2.00.0812031144110.28671@gannet.stats.ox.ac.uk>
References: <49366B01.8070202@tu-dresden.de>
	<alpine.LFD.2.00.0812031144110.28671@gannet.stats.ox.ac.uk>
Message-ID: <49368294.1060901@tu-dresden.de>

Dear Prof. Ripley,

thank you very much for the fast response. I am very grateful for all 
the work that the R Core does and so I try to contribute my humble part 
as a tester.

Prof Brian Ripley wrote:
> On Wed, 3 Dec 2008, Thomas Petzoldt wrote:
> 
>> Dear R developers,
>>
>> I tried to use nlminb instead of optim for a current problem (fitting 
>> parameters of a differential equation model). The PORT algorithm 
>> converged much better than any of optim's methods and the identified 
>> parameters are plausible. However, it took me a while before spotting 
>> the reason of a technical problem that nlminb, in contrast to optim, 
>> does not pass names of the start parameters to the objective function.
>>
>> Please find below a minimum reproducible example. There is, of course, 
>> a workaround, but in order to make optim and nlme more compatible I 
>> would ask whether it would be possible to change this idiosyncratic 
>> behavior?
> 
> The 'idiosyncratic behavior' is to expect that a new vector of 
> parameters will magically inherit names from the start vector.  optim() 
> was changed (and documented) because some users asked for this, and if a 
> user who wants it for nlminb provides a tested patch, I am sure it will 
> be considered.

O.K., than I will make my, surely naive, suggestion to change file:

src/library/stats/R/nlminb.R

As far I can oversee it, names are dropped at the beginning in:

  ## Establish the working vectors and check and set options
     n <- length(par <- as.double(start))

so it may be sufficient to add something like:

     names(par) <- names(start)

anywhere before:

    assign(".par", par, envir = rho)

This change was sufficient to make my example working and (at a first 
look) I did not find negative side-effects. At least:

R CMD check stats

passed without problems. I had also a look into port.c and found nothing 
obvious there so I, again naively, assume that there is (hopefully) 
nothing to do at the C level. It would be very kind if someone more 
experienced can validate (or falsify) this.

Thank you very much

Thomas Petzoldt



Index: nlminb.R
===================================================================
--- nlminb.R	(revision 47039)
+++ nlminb.R	(working copy)
@@ -48,6 +48,7 @@
      ## Establish the objective function and its environment
      obj <- quote(objective(.par, ...))
      rho <- new.env(parent = environment())
+    names(par) <- names(start)
      assign(".par", par, envir = rho)

      ## Create values of other arguments if needed


From awylie at une.edu.au  Wed Dec  3 06:20:07 2008
From: awylie at une.edu.au (awylie at une.edu.au)
Date: Wed,  3 Dec 2008 06:20:07 +0100 (CET)
Subject: [Rd] Error code query (PR#13360)
Message-ID: <20081203052009.35917282EFF6@mail.pubhealth.ku.dk>

Hi

I'm working on installing R and Rcmdr on a Mac running Leopard. I've  
had it running in the past and had to reinstall 11X iwhen putting some  
notes together for students. To get screen shots I reinstalled 11X  
without unstalling it first.

Having loaded the additional packages with Rcmdr, when I try to open  
Rcmdr I now get the following error messages:

Error: .onload failed in 'loadNamespace' for 'Rcmdr'
Error: package/namespace load failed for Rcmdr''
_X11TransSocketINTETConnect() can't get address for /tmp/launch- 
vCmK4L/:6000: nodename nor servname provided, or not know

The last line X11 etc appears in red text.

Any suggestion help would be grateful.
Cheers,
Alan.


Alan Wylie
Educational Developer
Faculty of Arts and Sciences
University of New England
Armidale
NSW 2351
Phone: 02 6773 2988
Mobile: 0403 335 964
email: awylie at une.edu.au
Room 384 Mcclymont building

CRICOS Provider Number 00003G


	[[alternative HTML version deleted]]


From anne.c.bracy at intel.com  Mon Dec  1 20:30:15 2008
From: anne.c.bracy at intel.com (anne.c.bracy at intel.com)
Date: Mon,  1 Dec 2008 20:30:15 +0100 (CET)
Subject: [Rd] syntax error in platform.c (PR#13354)
Message-ID: <20081201193015.31B01282EFF6@mail.pubhealth.ku.dk>

Full_Name: Anne Bracy
Version: 2.8.0
OS: linux
Submission from: (NULL) (192.55.52.12)


syntax error in platform.c

line 1657, missing ";" after the word FALSE


From arnima at u.washington.edu  Wed Dec  3 13:50:09 2008
From: arnima at u.washington.edu (arnima at u.washington.edu)
Date: Wed,  3 Dec 2008 13:50:09 +0100 (CET)
Subject: [Rd] Matrix dimnames crash (PR#13361)
Message-ID: <20081203125009.42B49282EFF6@mail.pubhealth.ku.dk>

In Windows XP, the matrix() function crashes the program when 'dimnames' 
is an empty list:

   matrix(1:4, nrow=2, dimnames=list())
   # R has encountered a problem and needs to close ...

This bug is specific to WinXP, as Linux64 handles this situation more 
gracefully:

   matrix(1:4, nrow=2, dimnames=list())
   Error in matrix(1:4, nrow = 2, dimnames = list()) :
     invalid type (environment) for 'dimnames' (must be a vector)

Thanks,
Arni

R 2.8.0-patched on WinXP


From ripley at stats.ox.ac.uk  Wed Dec  3 17:53:23 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 3 Dec 2008 16:53:23 +0000 (GMT)
Subject: [Rd] syntax error in platform.c (PR#13354)
In-Reply-To: <20081201193015.31B01282EFF6@mail.pubhealth.ku.dk>
References: <20081201193015.31B01282EFF6@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0812031651510.13408@gannet.stats.ox.ac.uk>

This was corrected way back in October.

Please do read the FAQ and not report already fixed issues.

On Mon, 1 Dec 2008, anne.c.bracy at intel.com wrote:

> Full_Name: Anne Bracy
> Version: 2.8.0
> OS: linux
> Submission from: (NULL) (192.55.52.12)
>
>
> syntax error in platform.c
>
> line 1657, missing ";" after the word FALSE
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Wed Dec  3 18:13:32 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 3 Dec 2008 17:13:32 +0000 (GMT)
Subject: [Rd] Matrix dimnames crash (PR#13361)
In-Reply-To: <20081203125009.42B49282EFF6@mail.pubhealth.ku.dk>
References: <20081203125009.42B49282EFF6@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0812031702110.13705@gannet.stats.ox.ac.uk>

On Wed, 3 Dec 2008, arnima at u.washington.edu wrote:

> In Windows XP, the matrix() function crashes the program when 'dimnames'
> is an empty list:
>
>   matrix(1:4, nrow=2, dimnames=list())
>   # R has encountered a problem and needs to close ...
>
> This bug is specific to WinXP, as Linux64 handles this situation more
> gracefully:
>
>   matrix(1:4, nrow=2, dimnames=list())
>   Error in matrix(1:4, nrow = 2, dimnames = list()) :
>     invalid type (environment) for 'dimnames' (must be a vector)

Actually no (the reported type is wrong, and my x86_64 Linux system also 
crashes).

This case slips though the error-checking, and I've added a final error 
check that will catch it in R-patched.

Thank you for the report.

>
> Thanks,
> Arni
>
> R 2.8.0-patched on WinXP
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From wdunlap at tibco.com  Wed Dec  3 19:38:05 2008
From: wdunlap at tibco.com (William Dunlap)
Date: Wed, 3 Dec 2008 10:38:05 -0800
Subject: [Rd] Matrix dimnames crash (PR#13361)
In-Reply-To: <alpine.LFD.2.00.0812031702110.13705@gannet.stats.ox.ac.uk>
References: <20081203125009.42B49282EFF6@mail.pubhealth.ku.dk>
	<alpine.LFD.2.00.0812031702110.13705@gannet.stats.ox.ac.uk>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D700491A51@NA-PA-VBE03.na.tibco.com>

Brian,
   Your change to src/main/attrib.c:dimnamesgets(),
--- attrib.c    (revision 47045)
+++ attrib.c    (working copy)
@@ -857,6 +857,9 @@
        UNPROTECT(1);
        PROTECT(val = newval);
     }
+    if (k != length(val))
+       error(_("length of 'dimnames' [%d] must match that of 'dims'
[%d]"),
+             length(val), k);
     for (i = 0; i < k; i++) {
        SEXP _this = VECTOR_ELT(val, i);
        if (_this != R_NilValue) {
results in array() and matrix() treating dimnames=list() differently
and I think they ought to act the same when feasible.
Also, the error message is not really the right one, as the length
of the dimnames handed to the array() or matrix() function does not
have to be the length of dim - a short one gets padded with NULL's.
(I don't know if this padding is the best thing to do -- R does it
and S+ does not -- and I think it generally reflects user error.)
E.g., in R:

> f<-function(dimnames){
    mat<-try(matrix(1:6,nrow=2,dimnames=dimnames), silent=TRUE)
    arr<-try(array(1:6,dim=c(2,3),dimnames=dimnames), silent=TRUE)
    list(matrix=mat, array=arr, identical=identical(mat, arr))
}

> f(dimnames=NULL)
$matrix
     [,1] [,2] [,3]
[1,]    1    3    5
[2,]    2    4    6

$array
     [,1] [,2] [,3]
[1,]    1    3    5
[2,]    2    4    6

$identical
[1] TRUE

> f(dimnames=list())
$matrix
[1] "Error in matrix(1:6, nrow = 2, dimnames = dimnames) : \n  length of
'dimnames' [0] must match that of 'dims' [2]\n"
attr(,"class")
[1] "try-error"

$array
     [,1] [,2] [,3]
[1,]    1    3    5
[2,]    2    4    6

$identical
[1] FALSE

> f(dimnames=list(Row=LETTERS[24:25])) # short dimnames
$matrix

Row [,1] [,2] [,3]
  X    1    3    5
  Y    2    4    6

$array

Row [,1] [,2] [,3]
  X    1    3    5
  Y    2    4    6

$identical
[1] TRUE


The following change to src/main/array.c makes array() and matrix()
treat dimnames=list() in the same way (equivalent to dimnames=NULL.

--- array.c     (revision 47047)
+++ array.c     (working copy)
@@ -152,7 +152,7 @@
            ;
        }
     }
-    if(!isNull(dimnames)) ans = dimnamesgets(ans, dimnames);
+    if(!isNull(dimnames) && length(dimnames)>0) ans = dimnamesgets(ans,
dimnames);
     UNPROTECT(1);
     return ans;
 }

The change to attrib.c:dimnamesgets() is fine: this change to
array.c:do_matrix just avoids the call.

Bill Dunlap
TIBCO Software Inc - Spotfire Division
wdunlap tibco.com  

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Prof Brian Ripley
> Sent: Wednesday, December 03, 2008 9:14 AM
> To: arnima at u.washington.edu
> Cc: R-bugs at r-project.org; r-devel at stat.math.ethz.ch
> Subject: Re: [Rd] Matrix dimnames crash (PR#13361)
> 
> On Wed, 3 Dec 2008, arnima at u.washington.edu wrote:
> 
> > In Windows XP, the matrix() function crashes the program 
> when 'dimnames'
> > is an empty list:
> >
> >   matrix(1:4, nrow=2, dimnames=list())
> >   # R has encountered a problem and needs to close ...
> >
> > This bug is specific to WinXP, as Linux64 handles this 
> situation more
> > gracefully:
> >
> >   matrix(1:4, nrow=2, dimnames=list())
> >   Error in matrix(1:4, nrow = 2, dimnames = list()) :
> >     invalid type (environment) for 'dimnames' (must be a vector)
> 
> Actually no (the reported type is wrong, and my x86_64 Linux 
> system also 
> crashes).
> 
> This case slips though the error-checking, and I've added a 
> final error 
> check that will catch it in R-patched.
> 
> Thank you for the report.
> 
> >
> > Thanks,
> > Arni
> >
> > R 2.8.0-patched on WinXP
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> 
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From ripley at stats.ox.ac.uk  Wed Dec  3 20:18:41 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 3 Dec 2008 19:18:41 +0000 (GMT)
Subject: [Rd] Matrix dimnames crash (PR#13361)
In-Reply-To: <77EB52C6DD32BA4D87471DCD70C8D700491A51@NA-PA-VBE03.na.tibco.com>
References: <20081203125009.42B49282EFF6@mail.pubhealth.ku.dk>
	<alpine.LFD.2.00.0812031702110.13705@gannet.stats.ox.ac.uk>
	<77EB52C6DD32BA4D87471DCD70C8D700491A51@NA-PA-VBE03.na.tibco.com>
Message-ID: <alpine.LFD.2.00.0812031914570.21586@gannet.stats.ox.ac.uk>

On Wed, 3 Dec 2008, William Dunlap wrote:

> Brian,
>   Your change to src/main/attrib.c:dimnamesgets(),
> --- attrib.c    (revision 47045)
> +++ attrib.c    (working copy)
> @@ -857,6 +857,9 @@
>        UNPROTECT(1);
>        PROTECT(val = newval);
>     }
> +    if (k != length(val))
> +       error(_("length of 'dimnames' [%d] must match that of 'dims'
> [%d]"),
> +             length(val), k);
>     for (i = 0; i < k; i++) {
>        SEXP _this = VECTOR_ELT(val, i);
>        if (_this != R_NilValue) {
> results in array() and matrix() treating dimnames=list() differently
> and I think they ought to act the same when feasible.
> Also, the error message is not really the right one, as the length
> of the dimnames handed to the array() or matrix() function does not
> have to be the length of dim - a short one gets padded with NULL's.
> (I don't know if this padding is the best thing to do -- R does it
> and S+ does not -- and I think it generally reflects user error.)

Not always: setting dimnames(A)[[1]] is the crux example.

> E.g., in R:
>
>> f<-function(dimnames){
>    mat<-try(matrix(1:6,nrow=2,dimnames=dimnames), silent=TRUE)
>    arr<-try(array(1:6,dim=c(2,3),dimnames=dimnames), silent=TRUE)
>    list(matrix=mat, array=arr, identical=identical(mat, arr))
> }
>
>> f(dimnames=NULL)
> $matrix
>     [,1] [,2] [,3]
> [1,]    1    3    5
> [2,]    2    4    6
>
> $array
>     [,1] [,2] [,3]
> [1,]    1    3    5
> [2,]    2    4    6
>
> $identical
> [1] TRUE
>
>> f(dimnames=list())
> $matrix
> [1] "Error in matrix(1:6, nrow = 2, dimnames = dimnames) : \n  length of
> 'dimnames' [0] must match that of 'dims' [2]\n"
> attr(,"class")
> [1] "try-error"
>
> $array
>     [,1] [,2] [,3]
> [1,]    1    3    5
> [2,]    2    4    6
>
> $identical
> [1] FALSE
>
>> f(dimnames=list(Row=LETTERS[24:25])) # short dimnames
> $matrix
>
> Row [,1] [,2] [,3]
>  X    1    3    5
>  Y    2    4    6
>
> $array
>
> Row [,1] [,2] [,3]
>  X    1    3    5
>  Y    2    4    6
>
> $identical
> [1] TRUE
>
>
> The following change to src/main/array.c makes array() and matrix()
> treat dimnames=list() in the same way (equivalent to dimnames=NULL.

which is not obvious to me is correct.

> --- array.c     (revision 47047)
> +++ array.c     (working copy)
> @@ -152,7 +152,7 @@
>            ;
>        }
>     }
> -    if(!isNull(dimnames)) ans = dimnamesgets(ans, dimnames);
> +    if(!isNull(dimnames) && length(dimnames)>0) ans = dimnamesgets(ans,
> dimnames);
>     UNPROTECT(1);
>     return ans;
> }
>
> The change to attrib.c:dimnamesgets() is fine: this change to
> array.c:do_matrix just avoids the call.
>
> Bill Dunlap
> TIBCO Software Inc - Spotfire Division
> wdunlap tibco.com
>
>> -----Original Message-----
>> From: r-devel-bounces at r-project.org
>> [mailto:r-devel-bounces at r-project.org] On Behalf Of Prof Brian Ripley
>> Sent: Wednesday, December 03, 2008 9:14 AM
>> To: arnima at u.washington.edu
>> Cc: R-bugs at r-project.org; r-devel at stat.math.ethz.ch
>> Subject: Re: [Rd] Matrix dimnames crash (PR#13361)
>>
>> On Wed, 3 Dec 2008, arnima at u.washington.edu wrote:
>>
>>> In Windows XP, the matrix() function crashes the program
>> when 'dimnames'
>>> is an empty list:
>>>
>>>   matrix(1:4, nrow=2, dimnames=list())
>>>   # R has encountered a problem and needs to close ...
>>>
>>> This bug is specific to WinXP, as Linux64 handles this
>> situation more
>>> gracefully:
>>>
>>>   matrix(1:4, nrow=2, dimnames=list())
>>>   Error in matrix(1:4, nrow = 2, dimnames = list()) :
>>>     invalid type (environment) for 'dimnames' (must be a vector)
>>
>> Actually no (the reported type is wrong, and my x86_64 Linux
>> system also
>> crashes).
>>
>> This case slips though the error-checking, and I've added a
>> final error
>> check that will catch it in R-patched.
>>
>> Thank you for the report.
>>
>>>
>>> Thanks,
>>> Arni
>>>
>>> R 2.8.0-patched on WinXP
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>> --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From chalabi at phys.ethz.ch  Wed Dec  3 20:28:07 2008
From: chalabi at phys.ethz.ch (Yohan Chalabi)
Date: Wed, 3 Dec 2008 20:28:07 +0100
Subject: [Rd] reduce limit number of arguments in methods:::cbind
Message-ID: <20081203202807.228a879e@mimi>

Dear all,

As far as I understand, the number of arguments in methods:::cbind is
limited by the "self recursive" construction of the function
which generates nested loops.

A workaround could be to use the internal cbind function on blocks of
non S4 objects. The limitation would then be reduced to the number of
consecutive S4 objects.

##### R code #####

dfr  <- data.frame(matrix(0, nrow = 1 , ncol = 1000))
dfr2 <- is.na(dfr)

mlist <- rep(list(matrix(0, 2, 1)), 400)
cb1 <- do.call("cbind", c(mlist, mlist))

methods:::bind_activation(TRUE)

dfr2 <- is.na(dfr) # fails
cb2 <- do.call("cbind", mlist) # ok
cb3 <- do.call("cbind", c(mlist, mlist)) # fails

# This could be avoided by first checking that the arguments has no S4
# objects. If this is the case, the function falls back to the
# internal cbind function.

# But this would not be very helpful if the arguments are a mixture of
# S4 and non S4 objects

library(Matrix)

Mlist <- rep(list(Matrix(0, 2, 1)), 400)

cb4 <- do.call("cbind", Mlist) # ok
cb5 <- do.call("cbind", c(Mlist, Mlist)) # fails
cb6 <- do.call("cbind", c(Mlist, mlist)) # fails

# A workaround could be to use the internal cbind function on blocks of
# non S4 objects. The limitation would be reduced to the number of
# consecutive S4 objects

# After modifications

dfr2 <- is.na(dfr) # ok
cb7 <- do.call("cbind", mlist) # ok
cb8 <- do.call("cbind", c(mlist, mlist)) # ok

cb9 <- do.call("cbind", c(Mlist, mlist)) # ok

cb10 <- do.call("cbind", c(Mlist, Mlist)) # fails as expected

##### END #####

The code bellow gives an idea how to do it but was not fully tested!

Hope it helps,
Yohan


Index: methods/R/cbind.R
===================================================================
--- methods/R/cbind.R	(revision 47045)
+++ methods/R/cbind.R	(working copy)
@@ -39,11 +39,10 @@
     ## remove trailing 'NULL's:
     while(na > 0 && is.null(argl[[na]])) { argl <- argl[-na]; na <- na - 1 }
     if(na == 0) return(NULL)
-    if(na == 1) {
-	if(isS4(..1))
-	    return(cbind2(..1))
-	else return(.Internal(cbind(deparse.level, ...)))
-    }
+    if (!any(aS4 <- unlist(lapply(argl, isS4))))
+        return(.Internal(cbind(deparse.level, ...)))
+    if(na == 1)
+        return(cbind2(..1))

     ## else :  na >= 2

@@ -64,6 +63,15 @@
     else { ## na >= 3 arguments: -- RECURSION -- with care
 	## determine nrow(<result>)  for e.g.,	cbind(diag(2), 1, 2)
 	## only when the last two argument have *no* dim attribute:
+        idx.aS4 <- 0
+        while (!rev(aS4)[idx.aS4+1])
+            idx.aS4 <- idx.aS4 + 1
+        if (idx.aS4 > 1) {
+            argl0 <- argl[(na-idx.aS4+1):na]
+            argl1 <- do.call(cbind, c(argl0, list(deparse.level=deparse.level)))
+            argl2 <- c(argl[1L:(na-idx.aS4)], list(argl1))
+            return(do.call(cbind, c(argl2, list(deparse.level=deparse.level))))
+        }
 	nrs <- unname(lapply(argl, nrow)) # of length na
 	iV <- sapply(nrs, is.null)# is 'vector'
 	fix.na <- identical(nrs[(na-1):na], list(NULL,NULL))


From jeff.a.ryan at gmail.com  Wed Dec  3 22:22:24 2008
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Wed, 3 Dec 2008 15:22:24 -0600
Subject: [Rd] reduce limit number of arguments in methods:::cbind
In-Reply-To: <20081203202807.228a879e@mimi>
References: <20081203202807.228a879e@mimi>
Message-ID: <e8e755250812031322n2d94b819ha05d97cf2ff50e93@mail.gmail.com>

My 2c:

The real issue for me is that this approach to handling S4 objects by
altering R functions for the worse is incorrect. (by calling
bind_activation)

m <- matrix(1:2e6L)  # 2 million obs
> system.time(cbind(m,m))
   user  system elapsed
  0.027   0.017   0.044
> methods:::bind_activation(TRUE)
[1] FALSE

# the additional overhead of cbind is now damaging to cbind S3 methods
> system.time(cbind(m,m))
   user  system elapsed
  0.043   0.034   0.077 [~175% of the original time]

Wouldn't a better near-term approach involve writing S3 methods to dispatch on.

> methods:::bind_activation(FALSE)
> library(Matrix)
> M <- Matrix(1:10)
> cbind(M,M)
     M M
[1,] ? ?

> cbind.dgeMatrix <- function(..., deparse.level=1) methods:::cbind(..., deparse.level=deparse.level)
> cbind(M,M)
10 x 2 Matrix of class "dgeMatrix"
      [,1] [,2]
 [1,]    1    1
 [2,]    2    2
 [3,]    3    3
 [4,]    4    4
 [5,]    5    5
 [6,]    6    6
 [7,]    7    7
 [8,]    8    8
 [9,]    9    9
[10,]   10   10

# this approach "does no harm" to regular S3 methods
> system.time(cbind(m,m))
   user  system elapsed
  0.028   0.017   0.045

Obviously this negates part of the S4 dispatch value, but that can be
had by calling cbind2 directly.


Jeff

-- 
Jeffrey Ryan
jeffrey.ryan at insightalgo.com

ia: insight algorithmics
www.insightalgo.com


From ggrothendieck at gmail.com  Thu Dec  4 05:00:08 2008
From: ggrothendieck at gmail.com (ggrothendieck at gmail.com)
Date: Thu,  4 Dec 2008 05:00:08 +0100 (CET)
Subject: [Rd] Date + difftime (PR#13369)
Message-ID: <20081204040008.EFFF9282BEBC@mail.pubhealth.ku.dk>

Full_Name: G. Grothendieck
Version: 2.8.0
OS: Vista
Submission from: (NULL) (69.63.52.10)



Get rid of the annoying warning.  This is supposed to be valid according to
?Ops.Date (shown at end):

> today <- Sys.Date()
> tomorrow <- today + 1
> dt <- tomorrow - today
> today + dt
[1] "2008-12-05"
Warning message:
Incompatible methods ("+.Date", "Ops.difftime") for "+" 

---

Operators on the Date Class
Description
Operators for the "Date" class. 

There is an Ops method and specific methods for + and - for the Date class. 

Usage
date + x
date - x
date1 lop date2

Arguments
date date objects 
date1, date2 date objects or character vectors. (Character vectors are converted
by as.Date.) 
x a numeric vector (in days) or an object of class "difftime". 
lop One of ==, !=, <, <=, > or >=.


From hpages at fhcrc.org  Thu Dec  4 08:34:38 2008
From: hpages at fhcrc.org (hpages at fhcrc.org)
Date: Wed, 03 Dec 2008 23:34:38 -0800
Subject: [Rd] Recent snapshot tarballs of R-devel don't compile
Message-ID: <20081203233438.v7h3y4q0go08k4os@webmail.fhcrc.org>

Hi,

Trying to compile one of the latest snapshot tarballs of R-devel gives
me the following error (64-bit openSUSE 10.3):
   ...
   make[2]: Entering directory  
`/loc/home/biocbuild/bbs-2.4-bioc/R/src/library/Recommended'
   make[2]: *** No rule to make target `VR.ts', needed by  
`stamp-recommended'.  Stop.
   make[2]: Leaving directory  
`/loc/home/biocbuild/bbs-2.4-bioc/R/src/library/Recommended'
   make[1]: *** [recommended-packages] Error 2
   make[1]: Leaving directory  
`/loc/home/biocbuild/bbs-2.4-bioc/R/src/library/Recommended'
   make: *** [stamp-recommended] Error 2

Maybe because these tarballs don't contain the symlinks that are
normally defined in the src/library/Recommended/ folder?

Cheers,
H.


From ripley at stats.ox.ac.uk  Thu Dec  4 09:30:04 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 4 Dec 2008 08:30:04 +0000 (GMT)
Subject: [Rd] Recent snapshot tarballs of R-devel don't compile
In-Reply-To: <20081203233438.v7h3y4q0go08k4os@webmail.fhcrc.org>
References: <20081203233438.v7h3y4q0go08k4os@webmail.fhcrc.org>
Message-ID: <alpine.LFD.2.00.0812040820060.15746@gannet.stats.ox.ac.uk>

On Wed, 3 Dec 2008, hpages at fhcrc.org wrote:

> Hi,
>
> Trying to compile one of the latest snapshot tarballs of R-devel gives
> me the following error (64-bit openSUSE 10.3):

We don't know what file that is, though.  Problems with snapshots need to 
be reported to the site which makes them.

Perhaps you mean 
ftp://ftp.stat.math.ethz.ch/Software/R/R-devel_2008-12-03.tar.bz2
?  In which case see the README in that directory for how to report a 
problem.

> ...
> make[2]: Entering directory 
> `/loc/home/biocbuild/bbs-2.4-bioc/R/src/library/Recommended'
> make[2]: *** No rule to make target `VR.ts', needed by `stamp-recommended'. 
> Stop.
> make[2]: Leaving directory 
> `/loc/home/biocbuild/bbs-2.4-bioc/R/src/library/Recommended'
> make[1]: *** [recommended-packages] Error 2
> make[1]: Leaving directory 
> `/loc/home/biocbuild/bbs-2.4-bioc/R/src/library/Recommended'
> make: *** [stamp-recommended] Error 2
>
> Maybe because these tarballs don't contain the symlinks that are
> normally defined in the src/library/Recommended/ folder?

Maybe, in which case running tools/link-recommended will fix it.  Works 
for me with the snapshot mentioned above.

>
> Cheers,
> H.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From chalabi at phys.ethz.ch  Thu Dec  4 10:07:50 2008
From: chalabi at phys.ethz.ch (Yohan Chalabi)
Date: Thu, 4 Dec 2008 10:07:50 +0100
Subject: [Rd] reduce limit number of arguments in methods:::cbind
In-Reply-To: <e8e755250812031322n2d94b819ha05d97cf2ff50e93@mail.gmail.com>
References: <20081203202807.228a879e@mimi>
	<e8e755250812031322n2d94b819ha05d97cf2ff50e93@mail.gmail.com>
Message-ID: <20081204100750.70a55387@mimi>

>>>> "JR" == "Jeff Ryan" <jeff.a.ryan at gmail.com>
>>>> on Wed, 3 Dec 2008 15:22:24 -0600

   JR> My 2c:
   JR> 
   JR> The real issue for me is that this approach to handling S4 objects by
   JR> altering R functions for the worse is incorrect. (by calling
   JR> bind_activation)
   JR> 
   JR> m <- matrix(1:2e6L)  # 2 million obs
   JR> > system.time(cbind(m,m))
   JR>    user  system elapsed
   JR>   0.027   0.017   0.044
   JR> > methods:::bind_activation(TRUE)
   JR> [1] FALSE
   JR> 
   JR> # the additional overhead of cbind is now damaging to cbind S3 methods
   JR> > system.time(cbind(m,m))
   JR>    user  system elapsed
   JR>   0.043   0.034   0.077 [~175% of the original time]
   JR> 
   JR> Wouldn't a better near-term approach involve writing S3 methods to dispatch on.
   JR> 
   JR> > methods:::bind_activation(FALSE)
   JR> > library(Matrix)
   JR> > M <- Matrix(1:10)
   JR> > cbind(M,M)
   JR>      M M
   JR> [1,] ? ?
   JR> 
   JR> > cbind.dgeMatrix <- function(..., deparse.level=1) methods:::cbind(..., deparse.level=deparse.level)
   JR> > cbind(M,M)
   JR> 10 x 2 Matrix of class "dgeMatrix"
   JR>       [,1] [,2]
   JR>  [1,]    1    1
   JR>  [2,]    2    2
   JR>  [3,]    3    3
   JR>  [4,]    4    4
   JR>  [5,]    5    5
   JR>  [6,]    6    6
   JR>  [7,]    7    7
   JR>  [8,]    8    8
   JR>  [9,]    9    9
   JR> [10,]   10   10
   JR> 
   JR> # this approach "does no harm" to regular S3 methods
   JR> > system.time(cbind(m,m))
   JR>    user  system elapsed
   JR>   0.028   0.017   0.045
   JR> 
   JR> Obviously this negates part of the S4 dispatch value, but that can be
   JR> had by calling cbind2 directly.
   JR> 
   JR> 
   JR> Jeff


There is no surprise that the default cbind function is faster because
it calls a C routine in contrast with methods:::cbind  which reduces
the problem "self recursively" to two arguments.

if you try the patch I sent in my previous message, you will notice
that the problem you mentioned is essentially improved.

regards,
Yohan


From gerard at mail.generacio.com  Wed Dec  3 19:15:09 2008
From: gerard at mail.generacio.com (gerard at mail.generacio.com)
Date: Wed,  3 Dec 2008 19:15:09 +0100 (CET)
Subject: [Rd] function qt can fails if ndf < 1 (PR#13364)
Message-ID: <20081203181509.C42AD282C765@mail.pubhealth.ku.dk>

Full_Name: Gerard Torrent
Version: R version 2.8.0 (2008-10-20)
OS: Linux 2.6.27.5-41.fc9.x86_64 #1 SMP
Submission from: (NULL) (85.52.227.233)


In some cases qt complains about NaNs and don't gives the correct result:

> qt(0.1,, 0.1)
[1] NaN
Warning message:
In qt(p, df, lower.tail, log.p) : NaNs produced

But the result can be found:
> pt(-1.60443e+06, 0.1)
[1] 0.09999997

If I replace the current method by bisection method in file file src/nmath/qt.c
the result is computed fine.

int cont=0;
do {
	cont++;
	nx = lx + (ux - lx)/2.0;
	if ((pp = pt(nx, ndf, TRUE, FALSE)) > p) {
		ux = nx; pu = pp;
	} else {
		lx = nx; pl = pp;
	}
}
while ((ux - lx) / fabs(nx) > accu && cont < 100);



From bolker at ufl.edu  Thu Dec  4 19:26:27 2008
From: bolker at ufl.edu (Ben Bolker)
Date: Thu, 04 Dec 2008 13:26:27 -0500
Subject: [Rd] rgl.snapshot() on Vista
Message-ID: <493820D3.70201@ufl.edu>


  Dear Daniel (and Duncan):

 back in January you reported that you were having trouble saving an rgl
movie on Vista.  I don't know if you ever got that resolved, but a
student of mine is now having a similar problem, not specific to dynamic
graphics (which would have to be a problem outside of rgl anyway).  He
may report more on the symptoms, but essentially rgl.snapshot produces
black or funky output on a simple static image.  rgl.postscript hangs.
I am afraid this might be a generic Vista problem ... I haven't yet
gotten around to rebooting my Linux machine into Vista so that I can
check on it.

http://www.nabble.com/Can-a-dynamic-graphic-produced-by-rgl-be-saved--td14649977.html

  The example we ran would be something as simple as

library(rgl)
rgl.open()
rgl.spheres(1:3,1:3,1:3,col="red")
rgl.snapshot("test.png")
  ## brings rgl window to top, creates funky gray and white png file
rgl.postscript("test.ps")  ## hangs

  Duncan, do you have any ideas?  Do you have any reports (positive
or negative) from people running rgl.snapshot() on Vista?
RSiteSearch("rgl vista") turned up only this thread ...

  cheers
    Ben Bolker

-- 
Ben Bolker
Associate professor, Biology Dep't, Univ. of Florida
bolker at ufl.edu / www.zoology.ufl.edu/bolker
GPG key: www.zoology.ufl.edu/bolker/benbolker-publickey.asc

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 260 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081204/e3c84ba5/attachment.bin>

From hpages at fhcrc.org  Thu Dec  4 20:22:23 2008
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Thu, 04 Dec 2008 11:22:23 -0800
Subject: [Rd] Recent snapshot tarballs of R-devel don't compile
In-Reply-To: <alpine.LFD.2.00.0812040820060.15746@gannet.stats.ox.ac.uk>
References: <20081203233438.v7h3y4q0go08k4os@webmail.fhcrc.org>
	<alpine.LFD.2.00.0812040820060.15746@gannet.stats.ox.ac.uk>
Message-ID: <49382DEF.6000707@fhcrc.org>

Prof Brian Ripley wrote:
> On Wed, 3 Dec 2008, hpages at fhcrc.org wrote:
> 
>> Hi,
>>
>> Trying to compile one of the latest snapshot tarballs of R-devel gives
>> me the following error (64-bit openSUSE 10.3):
> 
> We don't know what file that is, though.

All of them.

>  Problems with snapshots need 
> to be reported to the site which makes them.
> 
> Perhaps you mean 
> ftp://ftp.stat.math.ethz.ch/Software/R/R-devel_2008-12-03.tar.bz2
> ?  In which case see the README in that directory for how to report a 
> problem.

Will do. Thanks!

H.


-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From murdoch at stats.uwo.ca  Fri Dec  5 00:05:53 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 04 Dec 2008 18:05:53 -0500
Subject: [Rd] rgl.snapshot() on Vista
In-Reply-To: <493820D3.70201@ufl.edu>
References: <493820D3.70201@ufl.edu>
Message-ID: <49386251.5020906@stats.uwo.ca>

Ben Bolker wrote:
>   Dear Daniel (and Duncan):
>
>  back in January you reported that you were having trouble saving an rgl
> movie on Vista.  I don't know if you ever got that resolved, but a
> student of mine is now having a similar problem, not specific to dynamic
> graphics (which would have to be a problem outside of rgl anyway).  He
> may report more on the symptoms, but essentially rgl.snapshot produces
> black or funky output on a simple static image.  rgl.postscript hangs.
> I am afraid this might be a generic Vista problem ... I haven't yet
> gotten around to rebooting my Linux machine into Vista so that I can
> check on it.
>   

I haven't heard of this problem before.  I would guess it is more likely 
related to your video driver (which may be Vista-specific), rather than 
Vista per se.  If that's the case, it's really hard to fix or work 
around, but it may be worthwhile seeing if the video card maker has an 
update.

Duncan Murdoch
> http://www.nabble.com/Can-a-dynamic-graphic-produced-by-rgl-be-saved--td14649977.html
>
>   The example we ran would be something as simple as
>
> library(rgl)
> rgl.open()
> rgl.spheres(1:3,1:3,1:3,col="red")
> rgl.snapshot("test.png")
>   ## brings rgl window to top, creates funky gray and white png file
> rgl.postscript("test.ps")  ## hangs
>
>   Duncan, do you have any ideas?  Do you have any reports (positive
> or negative) from people running rgl.snapshot() on Vista?
> RSiteSearch("rgl vista") turned up only this thread ...
>
>   cheers
>     Ben Bolker
>
>


From rgentlem at fhcrc.org  Fri Dec  5 06:55:28 2008
From: rgentlem at fhcrc.org (Robert Gentleman)
Date: Thu, 04 Dec 2008 21:55:28 -0800
Subject: [Rd] wish: exportClassPattern
In-Reply-To: <alpine.LFD.2.00.0811220623570.7736@gannet.stats.ox.ac.uk>
References: <509e0620811211945i5d26ad64lad026de4928fabdb@mail.gmail.com>
	<alpine.LFD.2.00.0811220623570.7736@gannet.stats.ox.ac.uk>
Message-ID: <4938C250.5000409@fhcrc.org>

should be in the most recent devel,


Prof Brian Ripley wrote:
> Michael,
> 
> This seems a reasonable request, but most of us will not have enough
> classes in a package for it to make a difference.
> 
> A patch to do this would certainly speed up implementation.
> 
> On Fri, 21 Nov 2008, Michael Lawrence wrote:
> 
>> It would be nice to have a more convenient means of exporting multiple
>> classes from a package namespace. Why not have something like
>> exportClassPattern() that worked like exportPattern() except for classes?
>>
>> Thanks,
>> Michael
>>
>>     [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 

-- 
Robert Gentleman, PhD
Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
PO Box 19024
Seattle, Washington 98109-1024
206-667-7700
rgentlem at fhcrc.org


From maechler at stat.math.ethz.ch  Fri Dec  5 08:45:13 2008
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 5 Dec 2008 08:45:13 +0100
Subject: [Rd] Recent snapshot tarballs of R-devel don't compile
In-Reply-To: <alpine.LFD.2.00.0812040820060.15746@gannet.stats.ox.ac.uk>
References: <20081203233438.v7h3y4q0go08k4os@webmail.fhcrc.org>
	<alpine.LFD.2.00.0812040820060.15746@gannet.stats.ox.ac.uk>
Message-ID: <18744.56329.489440.432766@stat.math.ethz.ch>

[oops .. I wanted to send this off  one day earlier ...]

>>>>> "BDR" == Prof Brian Ripley <ripley at stats.ox.ac.uk>
>>>>>     on Thu, 4 Dec 2008 08:30:04 +0000 (GMT) writes:

    BDR> On Wed, 3 Dec 2008, hpages at fhcrc.org wrote:
    >> Hi,
    >> 
    >> Trying to compile one of the latest snapshot tarballs of
    >> R-devel gives me the following error (64-bit openSUSE
    >> 10.3):

    BDR> We don't know what file that is, though.  Problems with
    BDR> snapshots need to be reported to the site which makes
    BDR> them.

    BDR> Perhaps you mean
    BDR> ftp://ftp.stat.math.ethz.ch/Software/R/R-devel_2008-12-03.tar.bz2
    BDR> ?  In which case see the README in that directory for
    BDR> how to report a problem.

    >> ...  make[2]: Entering directory
    >> `/loc/home/biocbuild/bbs-2.4-bioc/R/src/library/Recommended'
    >> make[2]: *** No rule to make target `VR.ts', needed by
    >> `stamp-recommended'.  Stop.  make[2]: Leaving directory
    >> `/loc/home/biocbuild/bbs-2.4-bioc/R/src/library/Recommended'
    >> make[1]: *** [recommended-packages] Error 2 make[1]:
    >> Leaving directory
    >> `/loc/home/biocbuild/bbs-2.4-bioc/R/src/library/Recommended'
    >> make: *** [stamp-recommended] Error 2
    >> 
    >> Maybe because these tarballs don't contain the symlinks
    >> that are normally defined in the src/library/Recommended/
    >> folder?

    BDR> Maybe, in which case running tools/link-recommended
    BDR> will fix it.  Works for me with the snapshot mentioned
    BDR> above.

Yes.

But also we know that we don't want to require that from people
working with the tarball.


The question remains why the automated build procedures ... that
I have setup and have been running for years, 
suddenly fail to put the *.tgz symbolic links into 
src/library/Recommended/ as they used to.





    >> 
    >> Cheers, H.
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel

    BDR> -- Brian D. Ripley, ripley at stats.ox.ac.uk Professor of
    BDR> Applied Statistics, http://www.stats.ox.ac.uk/~ripley/
    BDR> University of Oxford, Tel: +44 1865 272861 (self) 1
    BDR> South Parks Road, +44 1865 272866 (PA) Oxford OX1 3TG,
    BDR> UK Fax: +44 1865 272595

    BDR> ______________________________________________
    BDR> R-devel at r-project.org mailing list
    BDR> https://stat.ethz.ch/mailman/listinfo/r-devel


From ripley at stats.ox.ac.uk  Fri Dec  5 12:43:16 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 5 Dec 2008 11:43:16 +0000 (GMT)
Subject: [Rd] Small bug in axis.POSIXct
In-Reply-To: <493415A2.3080106@mx.uni-saarland.de>
References: <493415A2.3080106@mx.uni-saarland.de>
Message-ID: <alpine.LFD.2.00.0812051142570.7840@gannet.stats.ox.ac.uk>

Thank you, fixed now in R-patched.

On Mon, 1 Dec 2008, Martin Becker wrote:

> Dear developers,
>
> the tick marks and labels produced by axis.POSIXct look strange for time 
> horizons of a few hours, see the following example:
>
> plot(seq(as.POSIXct("14:00",format="%H:%M"),as.POSIXct("18:00",format="%H:%M"),length.out=20),1:20)
>
> This (copy&paste error?) is easily fixed, see the attached patch (for 
> revision 47031).
>
> Best wishes,
>
> Martin
>
> -- 
> Dr. Martin Becker
> Statistics and Econometrics
> Saarland University
> Campus C3 1, Room 206
> 66123 Saarbruecken
> Germany
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From rksh1 at cam.ac.uk  Fri Dec  5 16:12:17 2008
From: rksh1 at cam.ac.uk (Robin Hankin)
Date: Fri, 05 Dec 2008 15:12:17 +0000
Subject: [Rd] array indexing
Message-ID: <493944D1.7060903@cam.ac.uk>

Hi.

I have been pondering array indexing via matrices.

 > a <- array(1:27,rep(3,3))
 >  index <- matrix(c(1,1,1,1,2,3),2,3,byrow=TRUE)
 > a[index]
[1]  1 22


as expected and documented.  But what was the thinking
behind the decision to access the array by rows rather
than columns?

The 'index' matrix is ordered as [1,1,1,2,1,3] and so
the extraction is  a[index[c(1,3,5)]] for the first element
and a[index[c(2,3,6)]] for the second. 

If the indexing was by columns then we would have

<fantasy>
 > a <- array(1:27,rep(3,3))
 >  index <- matrix(c(1,1,1,1,2,3),2,3)
 > a[index]
[1]  1 22
</fantasy>

Thus the extraction is a[index[1:3]] and a[index[4:6]].

This seems to be a sensible way of going about array indexing.
For example, even *defining* the 'index'
matrix is simpler.

 So, what is the thinking behind the  behaviour as implemented?

I'm asking because I want to understand the thinking behind the
decision.


rksh

-- 
Robin K. S. Hankin
Uncertainty Analyst
University of Cambridge
19 Silver Street
Cambridge CB3 9EP
01223-764877


From ripley at stats.ox.ac.uk  Fri Dec  5 16:35:00 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 5 Dec 2008 15:35:00 +0000 (GMT)
Subject: [Rd] Warning: missing text for item ... in \describe?
In-Reply-To: <20081201154004.79ef748b@berwin-nus1>
References: <493384DA.9060504@pdf.com> <20081201154004.79ef748b@berwin-nus1>
Message-ID: <alpine.LFD.2.00.0812051527430.15310@gannet.stats.ox.ac.uk>

On Mon, 1 Dec 2008, Berwin A Turlach wrote:

> G'day Spencer,
>
> On Sun, 30 Nov 2008 22:31:54 -0800
> Spencer Graves <spencer.graves at pdf.com> wrote:
>
>> Hello:
>>
>>       What might be the problem generating messages like "Warning:
>> missing text for item ... in \describe" with "R CMD check" and "R CMD
>> install"?
>>
>>       With the current version of "fda" on R-Forge, I get the
>> following:
>>
>>
>> Warning: missing text for item 'fd' in \describe
>> Warning: missing text for item 'fdPar' in \describe
>
> fRegress.Rd, which contains
>
> \item{fd} { ...
> \item{fdPar} {...
>
> Apparently the space between the closing and the opening bracket leads
> to some confusion; remove the space and the warning goes away.
>
> I am not sure why an extra space here leads to problems, would be nicer
> if it would not.  If it have to lead to a problem, then it would be
> nice if the name of the .Rd files that produces the problem is actually
> mentioned. :)

Well, the warning/errors always come out just before the file with the 
problem (unless you have stdout buffered and stderr not).  So finding 
which file does not seem so hard.

This *is* an error: nothing in the description allows whitespace between 
arguments to \item (nor \section).  It seems that only a few people 
misread the documentation (sometimes even after their error is pointed out 
to them).  What we can do is detect the error, and I am about to commit 
code in R-devel to do so.

Note that we don't have a complete description of the Rd language, but 
three partial parsers (Rdconv, tools::Rdparse and from R-devel, parseRd). 
If Duncan M's work on parseRd comes to fruition we may have a grammar and 
a parser, but it is likely to be for 'Rd2' format since no one wants to 
enshrine all the quirks of the current format.

> Don't ask me how I found this, let us just say that long live
> find-grep-dired in emacs and perseverance (or should that be
> stubbornness?)
>
> HTH.
>
> Cheers,
>
> 	Berwin
>
> =========================== Full address =============================
> Berwin A Turlach                            Tel.: +65 6516 4416 (secr)
> Dept of Statistics and Applied Probability        +65 6516 6650 (self)
> Faculty of Science                          FAX : +65 6872 3919
> National University of Singapore
> 6 Science Drive 2, Blk S16, Level 7          e-mail: statba at nus.edu.sg
> Singapore 117546                    http://www.stat.nus.edu.sg/~statba
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From berwin at maths.uwa.edu.au  Fri Dec  5 17:35:04 2008
From: berwin at maths.uwa.edu.au (Berwin A Turlach)
Date: Sat, 6 Dec 2008 00:35:04 +0800
Subject: [Rd] Warning: missing text for item ... in \describe?
In-Reply-To: <alpine.LFD.2.00.0812051527430.15310@gannet.stats.ox.ac.uk>
References: <493384DA.9060504@pdf.com> <20081201154004.79ef748b@berwin-nus1>
	<alpine.LFD.2.00.0812051527430.15310@gannet.stats.ox.ac.uk>
Message-ID: <20081206003504.208fbbce@berwin5>

G'day Brian,

On Fri, 5 Dec 2008 15:35:00 +0000 (GMT)
Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:

> On Mon, 1 Dec 2008, Berwin A Turlach wrote:
> 
> > G'day Spencer,
> >
> > On Sun, 30 Nov 2008 22:31:54 -0800
> > Spencer Graves <spencer.graves at pdf.com> wrote:
> >
> >> Hello:
> >>
> >>       What might be the problem generating messages like "Warning:
> >> missing text for item ... in \describe" with "R CMD check" and "R
> >> CMD install"?
> >>
> >>       With the current version of "fda" on R-Forge, I get the
> >> following:
> >>
> >>
> >> Warning: missing text for item 'fd' in \describe
> >> Warning: missing text for item 'fdPar' in \describe
> >
> > fRegress.Rd, which contains
> >
> > \item{fd} { ...
> > \item{fdPar} {...
[...]
> Well, the warning/errors always come out just before the file with
> the problem (unless you have stdout buffered and stderr not).  So
> finding which file does not seem so hard.

Which platform are we talking here?  I was using linux and "R CMD check
fda", using R 2.8.0, on the command line said:

[...]
* checking for executable files ... OK
* checking whether package 'fda' can be installed ... WARNING
Found the following significant warnings:
  Warning: missing text for item 'fd' in \describe
  Warning: missing text for item 'fd' in \describe
  Warning: missing text for item 'fdPar' in \describe
See '/home/berwin/lang/R/Develop/Others/fda.Rcheck/00install.out' for
details.
* checking package directory ... OK
[...]

And 00install.out said:

[...]
Attaching package: 'zoo'


        The following object(s) are masked from package:base :

         as.Date.numeric

** help
Warning: missing text for item 'fd' in \describe
Warning: missing text for item 'fd' in \describe
Warning: missing text for item 'fdPar' in \describe
 >>> Building/Updating help pages for package 'fda'
     Formats: text html latex example
  CSTR                              text    html    latex   example
  CanadianWeather                   text    html    latex   example
[...]

I am not aware that either stdout or stderr are buffered on my linux
box.

> This *is* an error: nothing in the description allows whitespace
> between arguments to \item (nor \section). It seems that only a few
> people misread the documentation (sometimes even after their error is
> pointed out to them). 

But there is also nothing that explicitly forbid such whitespace, is
it?  I guess this comes down to the question whether "everything is
allowed that is not expressively forbidden" or "everything is forbidden
unless it is expressively allowed".  Strangely enough, though I am
German, I don't tend to subscribe to the latter philosophy.  

The language of Rd files, and the notation used, seems to have some
clear roots in (La)TeX;  and in (La)TeX whitespace between arguments to
macros is ignored.  So one may argue that it is a bit of a surprise
that whitespace between arguments to \item matter here.

> What we can do is detect the error, and I am about to commit code in
> R-devel to do so. 

Thanks.  I am sure Spencer will be happy about this. :)

Cheers,

	Berwin


From ligges at statistik.tu-dortmund.de  Fri Dec  5 18:13:46 2008
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 05 Dec 2008 18:13:46 +0100
Subject: [Rd] array indexing
In-Reply-To: <493944D1.7060903@cam.ac.uk>
References: <493944D1.7060903@cam.ac.uk>
Message-ID: <4939614A.3080107@statistik.tu-dortmund.de>



Robin Hankin wrote:
> Hi.
> 
> I have been pondering array indexing via matrices.
> 
>  > a <- array(1:27,rep(3,3))
>  >  index <- matrix(c(1,1,1,1,2,3),2,3,byrow=TRUE)
>  > a[index]
> [1]  1 22
> 
> 
> as expected and documented.  But what was the thinking
> behind the decision to access the array by rows rather
> than columns?
> 
> The 'index' matrix is ordered as [1,1,1,2,1,3] and so
> the extraction is  a[index[c(1,3,5)]] for the first element
> and a[index[c(2,3,6)]] for the second.
> If the indexing was by columns then we would have
> 
> <fantasy>
>  > a <- array(1:27,rep(3,3))
>  >  index <- matrix(c(1,1,1,1,2,3),2,3)
>  > a[index]
> [1]  1 22
> </fantasy>
> 
> Thus the extraction is a[index[1:3]] and a[index[4:6]].
> 
> This seems to be a sensible way of going about array indexing.
> For example, even *defining* the 'index'
> matrix is simpler.
> 
> So, what is the thinking behind the  behaviour as implemented?
> 
> I'm asking because I want to understand the thinking behind the
> decision.


 From my point of view common thinking with matrices and data.frames is 
that one row corresponds to one observation (that should be extracted).

Uwe Ligges

> 
> rksh
>


From ripley at stats.ox.ac.uk  Fri Dec  5 18:32:58 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 5 Dec 2008 17:32:58 +0000 (GMT)
Subject: [Rd] Warning: missing text for item ... in \describe?
In-Reply-To: <20081206003504.208fbbce@berwin5>
References: <493384DA.9060504@pdf.com> <20081201154004.79ef748b@berwin-nus1>
	<alpine.LFD.2.00.0812051527430.15310@gannet.stats.ox.ac.uk>
	<20081206003504.208fbbce@berwin5>
Message-ID: <alpine.LFD.2.00.0812051727410.22493@gannet.stats.ox.ac.uk>

On Sat, 6 Dec 2008, Berwin A Turlach wrote:

> G'day Brian,
>
> On Fri, 5 Dec 2008 15:35:00 +0000 (GMT)
> Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
>
>> On Mon, 1 Dec 2008, Berwin A Turlach wrote:
>>
>>> G'day Spencer,
>>>
>>> On Sun, 30 Nov 2008 22:31:54 -0800
>>> Spencer Graves <spencer.graves at pdf.com> wrote:
>>>
>>>> Hello:
>>>>
>>>>       What might be the problem generating messages like "Warning:
>>>> missing text for item ... in \describe" with "R CMD check" and "R
>>>> CMD install"?
>>>>
>>>>       With the current version of "fda" on R-Forge, I get the
>>>> following:
>>>>
>>>>
>>>> Warning: missing text for item 'fd' in \describe
>>>> Warning: missing text for item 'fdPar' in \describe
>>>
>>> fRegress.Rd, which contains
>>>
>>> \item{fd} { ...
>>> \item{fdPar} {...

> [...]
>> Well, the warning/errors always come out just before the file with
>> the problem (unless you have stdout buffered and stderr not).  So
>> finding which file does not seem so hard.
>
> Which platform are we talking here?  I was using linux and "R CMD check
> fda", using R 2.8.0, on the command line said:

That writes to a file, and writes to a file are buffered.  Try R CMD 
INSTALL, where they are not.  We do recommend getting a clean install 
before R CMD check.

> [...]
> * checking for executable files ... OK
> * checking whether package 'fda' can be installed ... WARNING
> Found the following significant warnings:
>  Warning: missing text for item 'fd' in \describe
>  Warning: missing text for item 'fd' in \describe
>  Warning: missing text for item 'fdPar' in \describe
> See '/home/berwin/lang/R/Develop/Others/fda.Rcheck/00install.out' for
> details.
> * checking package directory ... OK
> [...]
>
> And 00install.out said:
>
> [...]
> Attaching package: 'zoo'
>
>
>        The following object(s) are masked from package:base :
>
>         as.Date.numeric
>
> ** help
> Warning: missing text for item 'fd' in \describe
> Warning: missing text for item 'fd' in \describe
> Warning: missing text for item 'fdPar' in \describe
> >>> Building/Updating help pages for package 'fda'
>     Formats: text html latex example
>  CSTR                              text    html    latex   example
>  CanadianWeather                   text    html    latex   example
> [...]
>
> I am not aware that either stdout or stderr are buffered on my linux
> box.

Wriitng to a file, stdout almost always is.

>
>> This *is* an error: nothing in the description allows whitespace
>> between arguments to \item (nor \section). It seems that only a few
>> people misread the documentation (sometimes even after their error is
>> pointed out to them).
>
> But there is also nothing that explicitly forbid such whitespace, is
> it?  I guess this comes down to the question whether "everything is
> allowed that is not expressively forbidden" or "everything is forbidden
> unless it is expressively allowed".  Strangely enough, though I am
> German, I don't tend to subscribe to the latter philosophy.

It really doesn't matter: the author of the convertor (not me) decidedly 
to silently ignore arguments after whitespace so you get an incorrect 
conversion. I also added sentences to the documentation that say that 
explicitly.  But if I see documentation that says

\item{foo}{bar}

I don't see why anyone would be surprised that

\item {foo} {bar}

goes haywire.

> The language of Rd files, and the notation used, seems to have some
> clear roots in (La)TeX;  and in (La)TeX whitespace between arguments to

More like texinfo.

> macros is ignored.  So one may argue that it is a bit of a surprise
> that whitespace between arguments to \item matter here.
>
>> What we can do is detect the error, and I am about to commit code in
>> R-devel to do so.
>
> Thanks.  I am sure Spencer will be happy about this. :)
>
> Cheers,
>
> 	Berwin
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From hpages at fhcrc.org  Fri Dec  5 19:20:55 2008
From: hpages at fhcrc.org (=?ISO-8859-1?Q?Herv=E9_Pag=E8s?=)
Date: Fri, 05 Dec 2008 10:20:55 -0800
Subject: [Rd] Recent snapshot tarballs of R-devel don't compile
In-Reply-To: <18744.56329.489440.432766@stat.math.ethz.ch>
References: <20081203233438.v7h3y4q0go08k4os@webmail.fhcrc.org>	<alpine.LFD.2.00.0812040820060.15746@gannet.stats.ox.ac.uk>
	<18744.56329.489440.432766@stat.math.ethz.ch>
Message-ID: <49397107.2060004@fhcrc.org>

Hi Martin,

Martin Maechler wrote:
[...]
>     BDR> Maybe, in which case running tools/link-recommended
>     BDR> will fix it.  Works for me with the snapshot mentioned
>     BDR> above.
> 
> Yes.
> 
> But also we know that we don't want to require that from people
> working with the tarball.

Yes, and that's one of the reasons we use these tarballs for the
Bioconductor build system. They are a little bit more convenient
than pulling the source from svn.

> 
> 
> The question remains why the automated build procedures ... that
> I have setup and have been running for years, 
> suddenly fail to put the *.tgz symbolic links into 
> src/library/Recommended/ as they used to.

I don't know what OS this procedure is running on but maybe 'tar'
started to do some strange strings with symlinks after an OS
update/upgrade...

Thanks,
H.

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fhcrc.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From cmr.pent at gmail.com  Fri Dec  5 15:40:11 2008
From: cmr.pent at gmail.com (cmr.pent at gmail.com)
Date: Fri,  5 Dec 2008 15:40:11 +0100 (CET)
Subject: [Rd] par(mfrow = ) resets par('cex'), not reduces it (PR#13373)
Message-ID: <20081205144011.B8FE0282EFC1@mail.pubhealth.ku.dk>

help(par) says:

  'mfcol, mfrow' ...

    In a layout with exactly two rows and columns the base value of
    '"cex"' is reduced by a factor of 0.83: if there are three or more
    of either rows or columns, the reduction factor is 0.66.

In reality, par(mfrow =) *resets* par ('cex'), not reduces it as
documented. To reproduce:

par(cex = 0.5)
par(mfrow = c(2, 2))
print(par('cex'))

It outputs 0.83, not 0.415 as expected.

Particularly such a behavior makes plot.ts and plot.acf effectively
ignore par('cex') value for the multivariate case. I guess there are
more situations where the documented behavior would be more
appropriate.

I'm ready to provide any additional info,
Andrey

--please do not edit the information below--

Version:
 platform = i486-pc-linux-gnu
 arch = i486
 os = linux-gnu
 system = i486, linux-gnu
 status =
 major = 2
 minor = 8.0
 year = 2008
 month = 10
 day = 20
 svn rev = 46754
 language = R
 version.string = R version 2.8.0 (2008-10-20)

Locale:
LC_CTYPE=ru_RU.UTF-8;LC_NUMERIC=C;LC_TIME=ru_RU.UTF-8;LC_COLLATE=ru_RU.UTF-8;LC_MONETARY=C;LC_MESSAGES=ru_RU.UTF-8;LC_PAPER=ru_RU.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=ru_RU.UTF-8;LC_IDENTIFICATION=C

Search Path:
 .GlobalEnv, package:stats, package:graphics, package:grDevices,
package:utils, package:datasets, package:methods, Autoloads,
package:base


From cstrato at aon.at  Fri Dec  5 20:49:51 2008
From: cstrato at aon.at (cstrato)
Date: Fri, 05 Dec 2008 20:49:51 +0100
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
Message-ID: <493985DF.7090303@aon.at>

Dear all

When trying to install my package on Windows XP on my Mac, I get the 
following error:

---------- Making package xps ------------
...
...
xpsDict.cxx
"C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll /def:xps.def 
/out:xps.dll fp10.obj  -opt:noref  -nologo -include:_G__cpp_setupG__Hist 
-include:_G__cpp_setupG__Graf1 -include:_G__cpp_setupG__G3D 
-include:_G__cpp_setupG__GPad -include:_G__cpp_setupG__Tree 
-include:_G__cpp_setupG__Rint -include:_G__cpp_setupG__PostScript 
-include:_G__cpp_setupG__Matrix -include:_G__cpp_setupG__Physics 
-include:_G__cpp_setupG__Ged  "C:\root/lib/libCore.lib" 
"C:\root/lib/libCint.lib" "C:\root/lib/libHist.lib" 
"C:\root/lib/libGraf.lib" "C:\root/lib/libGraf3d.lib" 
"C:\root/lib/libGpad.lib" "C:\root/lib/libTree.lib" 
"C:\root/lib/libRint.lib" "C:\root/lib/libPostscript.lib" 
"C:\root/lib/libMatrix.lib" "C:\root/lib/libPhysics.lib" 
"C:\root/lib/libNet.lib" "C:\root/lib/libRIO.lib" 
"C:\root/lib/libMathCore.lib" "C:\root/lib/libGui.lib" 
"C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib" 
"C:\root/lib/libGed.lib" "C:\root/lib/libTreePlayer.lib" 
"C:\root/lib/libTreeViewer.lib" *.obj
   Creating library xps.lib and object xps.exp
  ... done
  installing DLL
  installing R files
  installing inst files
FIND: Parameterformat falsch
make[2]: *** [C:/home/Rabbitus/CRAN/xps.Rcheck/xps/inst] Error 2
make[1]: *** [all] Error 2
make: *** [pkg-xps] Error 2
*** Installation of xps failed ***


However, when I install my package on my Windows XP laptop, everything 
is ok:

---------- Making package xps ------------
...
...
xpsDict.cxx
"C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll /def:xps.def 
/out:xps.dll fp10.obj  -opt:noref  -nologo -include:_G__cpp_setupG__Hist 
-include:_G__cpp_setupG__Graf1 -include:_G__cpp_setupG__G3D 
-include:_G__cpp_setupG__GPad -include:_G__cpp_setupG__Tree 
-include:_G__cpp_setupG__Rint -include:_G__cpp_setupG__PostScript 
-include:_G__cpp_setupG__Matrix -include:_G__cpp_setupG__Physics 
-include:_G__cpp_setupG__Ged  "C:\root/lib/libCore.lib" 
"C:\root/lib/libCint.lib" "C:\root/lib/libHist.lib" 
"C:\root/lib/libGraf.lib" "C:\root/lib/libGraf3d.lib" 
"C:\root/lib/libGpad.lib" "C:\root/lib/libTree.lib" 
"C:\root/lib/libRint.lib" "C:\root/lib/libPostscript.lib" 
"C:\root/lib/libMatrix.lib" "C:\root/lib/libPhysics.lib" 
"C:\root/lib/libNet.lib" "C:\root/lib/libRIO.lib" 
"C:\root/lib/libMathCore.lib" "C:\root/lib/libGui.lib" 
"C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib" 
"C:\root/lib/libGed.lib" "C:\root/lib/libTreePlayer.lib" 
"C:\root/lib/libTreeViewer.lib" *.obj
   Creating library xps.lib and object xps.exp
  ... done
  installing DLL
  installing R files
  installing inst files
  preparing package xps for lazy loading
  installing man source files
  installing indices
Warning messages:
1: In file.create(f.tg) :
  kann Datei 'c:/Programme/R/R-2.8.0/doc/html/packages.html' nicht 
erzeugen. Grund 'Permission denied'
2: In tools:::win.packages.html(.Library) :
  kann HTML Paketindex nicht aktualisieren
  installing help
 >>> Building/Updating help pages for package 'xps'
...

To my knowledge I have only made one difference when installing 
everything necessary to build my package:
On my laptop I have installed Rtools27.exe, while on WinXP on my Mac I 
have installed Rtools28.exe.

Do you know what the reason for the error might be?

Thank you in advance.
Best regards
Christian
_._._._._._._._._._._._._._._._._._
C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
V.i.e.n.n.a           A.u.s.t.r.i.a
e.m.a.i.l:        cstrato at aon.at
_._._._._._._._._._._._._._._._._._


From ripley at stats.ox.ac.uk  Fri Dec  5 21:02:41 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 5 Dec 2008 20:02:41 +0000 (GMT)
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <493985DF.7090303@aon.at>
References: <493985DF.7090303@aon.at>
Message-ID: <alpine.LFD.2.00.0812052000240.4333@gannet.stats.ox.ac.uk>

This is a PATH error: you must have Rtools/bin before Windows system 
directories in your path.  As the R-admin manual tells you explicitly ....

fortune("WTFM") applies.

On Fri, 5 Dec 2008, cstrato wrote:

> Dear all
>
> When trying to install my package on Windows XP on my Mac, I get the 
> following error:
>
> ---------- Making package xps ------------
> ...
> ...
> xpsDict.cxx
> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll /def:xps.def 
> /out:xps.dll fp10.obj  -opt:noref  -nologo -include:_G__cpp_setupG__Hist 
> -include:_G__cpp_setupG__Graf1 -include:_G__cpp_setupG__G3D 
> -include:_G__cpp_setupG__GPad -include:_G__cpp_setupG__Tree 
> -include:_G__cpp_setupG__Rint -include:_G__cpp_setupG__PostScript 
> -include:_G__cpp_setupG__Matrix -include:_G__cpp_setupG__Physics 
> -include:_G__cpp_setupG__Ged  "C:\root/lib/libCore.lib" 
> "C:\root/lib/libCint.lib" "C:\root/lib/libHist.lib" "C:\root/lib/libGraf.lib" 
> "C:\root/lib/libGraf3d.lib" "C:\root/lib/libGpad.lib" 
> "C:\root/lib/libTree.lib" "C:\root/lib/libRint.lib" 
> "C:\root/lib/libPostscript.lib" "C:\root/lib/libMatrix.lib" 
> "C:\root/lib/libPhysics.lib" "C:\root/lib/libNet.lib" 
> "C:\root/lib/libRIO.lib" "C:\root/lib/libMathCore.lib" 
> "C:\root/lib/libGui.lib" "C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib" 
> "C:\root/lib/libGed.lib" "C:\root/lib/libTreePlayer.lib" 
> "C:\root/lib/libTreeViewer.lib" *.obj
>  Creating library xps.lib and object xps.exp
> ... done
> installing DLL
> installing R files
> installing inst files
> FIND: Parameterformat falsch
> make[2]: *** [C:/home/Rabbitus/CRAN/xps.Rcheck/xps/inst] Error 2
> make[1]: *** [all] Error 2
> make: *** [pkg-xps] Error 2
> *** Installation of xps failed ***
>
>
> However, when I install my package on my Windows XP laptop, everything is ok:
>
> ---------- Making package xps ------------
> ...
> ...
> xpsDict.cxx
> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll /def:xps.def 
> /out:xps.dll fp10.obj  -opt:noref  -nologo -include:_G__cpp_setupG__Hist 
> -include:_G__cpp_setupG__Graf1 -include:_G__cpp_setupG__G3D 
> -include:_G__cpp_setupG__GPad -include:_G__cpp_setupG__Tree 
> -include:_G__cpp_setupG__Rint -include:_G__cpp_setupG__PostScript 
> -include:_G__cpp_setupG__Matrix -include:_G__cpp_setupG__Physics 
> -include:_G__cpp_setupG__Ged  "C:\root/lib/libCore.lib" 
> "C:\root/lib/libCint.lib" "C:\root/lib/libHist.lib" "C:\root/lib/libGraf.lib" 
> "C:\root/lib/libGraf3d.lib" "C:\root/lib/libGpad.lib" 
> "C:\root/lib/libTree.lib" "C:\root/lib/libRint.lib" 
> "C:\root/lib/libPostscript.lib" "C:\root/lib/libMatrix.lib" 
> "C:\root/lib/libPhysics.lib" "C:\root/lib/libNet.lib" 
> "C:\root/lib/libRIO.lib" "C:\root/lib/libMathCore.lib" 
> "C:\root/lib/libGui.lib" "C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib" 
> "C:\root/lib/libGed.lib" "C:\root/lib/libTreePlayer.lib" 
> "C:\root/lib/libTreeViewer.lib" *.obj
>  Creating library xps.lib and object xps.exp
> ... done
> installing DLL
> installing R files
> installing inst files
> preparing package xps for lazy loading
> installing man source files
> installing indices
> Warning messages:
> 1: In file.create(f.tg) :
> kann Datei 'c:/Programme/R/R-2.8.0/doc/html/packages.html' nicht erzeugen. 
> Grund 'Permission denied'
> 2: In tools:::win.packages.html(.Library) :
> kann HTML Paketindex nicht aktualisieren
> installing help
>>>> Building/Updating help pages for package 'xps'
> ...
>
> To my knowledge I have only made one difference when installing everything 
> necessary to build my package:
> On my laptop I have installed Rtools27.exe, while on WinXP on my Mac I have 
> installed Rtools28.exe.
>
> Do you know what the reason for the error might be?
>
> Thank you in advance.
> Best regards
> Christian
> _._._._._._._._._._._._._._._._._._
> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
> V.i.e.n.n.a           A.u.s.t.r.i.a
> e.m.a.i.l:        cstrato at aon.at
> _._._._._._._._._._._._._._._._._._
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ggrothendieck at gmail.com  Fri Dec  5 21:10:24 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 5 Dec 2008 15:10:24 -0500
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <493985DF.7090303@aon.at>
References: <493985DF.7090303@aon.at>
Message-ID: <971536df0812051210u6caa7e23g9f9aa0943555f93@mail.gmail.com>

One difference between rtools27.exe and rtools28.exe is that the latter
sets a value in the registry to where rtools is located whereas the former
does not.

On Fri, Dec 5, 2008 at 2:49 PM, cstrato <cstrato at aon.at> wrote:
> Dear all
>
> When trying to install my package on Windows XP on my Mac, I get the
> following error:
>
> ---------- Making package xps ------------
> ...
> ...
> xpsDict.cxx
> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll /def:xps.def
> /out:xps.dll fp10.obj  -opt:noref  -nologo -include:_G__cpp_setupG__Hist
> -include:_G__cpp_setupG__Graf1 -include:_G__cpp_setupG__G3D
> -include:_G__cpp_setupG__GPad -include:_G__cpp_setupG__Tree
> -include:_G__cpp_setupG__Rint -include:_G__cpp_setupG__PostScript
> -include:_G__cpp_setupG__Matrix -include:_G__cpp_setupG__Physics
> -include:_G__cpp_setupG__Ged  "C:\root/lib/libCore.lib"
> "C:\root/lib/libCint.lib" "C:\root/lib/libHist.lib"
> "C:\root/lib/libGraf.lib" "C:\root/lib/libGraf3d.lib"
> "C:\root/lib/libGpad.lib" "C:\root/lib/libTree.lib"
> "C:\root/lib/libRint.lib" "C:\root/lib/libPostscript.lib"
> "C:\root/lib/libMatrix.lib" "C:\root/lib/libPhysics.lib"
> "C:\root/lib/libNet.lib" "C:\root/lib/libRIO.lib"
> "C:\root/lib/libMathCore.lib" "C:\root/lib/libGui.lib"
> "C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib" "C:\root/lib/libGed.lib"
> "C:\root/lib/libTreePlayer.lib" "C:\root/lib/libTreeViewer.lib" *.obj
>  Creating library xps.lib and object xps.exp
>  ... done
>  installing DLL
>  installing R files
>  installing inst files
> FIND: Parameterformat falsch
> make[2]: *** [C:/home/Rabbitus/CRAN/xps.Rcheck/xps/inst] Error 2
> make[1]: *** [all] Error 2
> make: *** [pkg-xps] Error 2
> *** Installation of xps failed ***
>
>
> However, when I install my package on my Windows XP laptop, everything is
> ok:
>
> ---------- Making package xps ------------
> ...
> ...
> xpsDict.cxx
> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll /def:xps.def
> /out:xps.dll fp10.obj  -opt:noref  -nologo -include:_G__cpp_setupG__Hist
> -include:_G__cpp_setupG__Graf1 -include:_G__cpp_setupG__G3D
> -include:_G__cpp_setupG__GPad -include:_G__cpp_setupG__Tree
> -include:_G__cpp_setupG__Rint -include:_G__cpp_setupG__PostScript
> -include:_G__cpp_setupG__Matrix -include:_G__cpp_setupG__Physics
> -include:_G__cpp_setupG__Ged  "C:\root/lib/libCore.lib"
> "C:\root/lib/libCint.lib" "C:\root/lib/libHist.lib"
> "C:\root/lib/libGraf.lib" "C:\root/lib/libGraf3d.lib"
> "C:\root/lib/libGpad.lib" "C:\root/lib/libTree.lib"
> "C:\root/lib/libRint.lib" "C:\root/lib/libPostscript.lib"
> "C:\root/lib/libMatrix.lib" "C:\root/lib/libPhysics.lib"
> "C:\root/lib/libNet.lib" "C:\root/lib/libRIO.lib"
> "C:\root/lib/libMathCore.lib" "C:\root/lib/libGui.lib"
> "C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib" "C:\root/lib/libGed.lib"
> "C:\root/lib/libTreePlayer.lib" "C:\root/lib/libTreeViewer.lib" *.obj
>  Creating library xps.lib and object xps.exp
>  ... done
>  installing DLL
>  installing R files
>  installing inst files
>  preparing package xps for lazy loading
>  installing man source files
>  installing indices
> Warning messages:
> 1: In file.create(f.tg) :
>  kann Datei 'c:/Programme/R/R-2.8.0/doc/html/packages.html' nicht erzeugen.
> Grund 'Permission denied'
> 2: In tools:::win.packages.html(.Library) :
>  kann HTML Paketindex nicht aktualisieren
>  installing help
>>>> Building/Updating help pages for package 'xps'
> ...
>
> To my knowledge I have only made one difference when installing everything
> necessary to build my package:
> On my laptop I have installed Rtools27.exe, while on WinXP on my Mac I have
> installed Rtools28.exe.
>
> Do you know what the reason for the error might be?
>
> Thank you in advance.
> Best regards
> Christian
> _._._._._._._._._._._._._._._._._._
> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
> V.i.e.n.n.a           A.u.s.t.r.i.a
> e.m.a.i.l:        cstrato at aon.at
> _._._._._._._._._._._._._._._._._._
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From maechler at stat.math.ethz.ch  Fri Dec  5 21:12:33 2008
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 05 Dec 2008 21:12:33 +0100
Subject: [Rd] Recent snapshot tarballs of R-devel don't compile
In-Reply-To: <49397107.2060004@fhcrc.org>
References: <20081203233438.v7h3y4q0go08k4os@webmail.fhcrc.org>
	<alpine.LFD.2.00.0812040820060.15746@gannet.stats.ox.ac.uk>
	<18744.56329.489440.432766@stat.math.ethz.ch>
	<49397107.2060004@fhcrc.org>
Message-ID: <18745.35633.513221.510620@cmath-7.math.ethz.ch>

>>>>> "HP" == Herv? Pag?s <hpages at fhcrc.org>
>>>>>     on Fri, 05 Dec 2008 10:20:55 -0800 writes:

    HP> Hi Martin, Martin Maechler wrote: [...]
    BDR> Maybe, in which case running tools/link-recommended
    BDR> will fix it.  Works for me with the snapshot mentioned
    BDR> above.
    >> 
    >> Yes.
    >> 
    >> But also we know that we don't want to require that from
    >> people working with the tarball.

    HP> Yes, and that's one of the reasons we use these tarballs
    HP> for the Bioconductor build system. They are a little bit
    HP> more convenient than pulling the source from svn.

yes.
I've finally found the cause.
Indeed it's been a change to R-devel, on Novemeber 17 I think,
 a "pdf -cleanup"
which breaks  'make vignettes'  which breaks 'distdir' ...
..

Huhh, finally! ....   so I assume we will have a fix in place
relatively soon.


Thank you, Herve, for you perseverance ;-)
Martin


    >> 
    >> The question remains why the automated build procedures
    >> ... that I have setup and have been running for years,
    >> suddenly fail to put the *.tgz symbolic links into
    >> src/library/Recommended/ as they used to.

    HP> I don't know what OS this procedure is running on but
    HP> maybe 'tar' started to do some strange strings with
    HP> symlinks after an OS update/upgrade...

    HP> Thanks, H.

    HP> -- Herv? Pag?s

    HP> Program in Computational Biology Division of Public
    HP> Health Sciences Fred Hutchinson Cancer Research Center
    HP> 1100 Fairview Ave. N, M2-B876 P.O. Box 19024 Seattle, WA
    HP> 98109-1024

    HP> E-mail: hpages at fhcrc.org Phone: (206) 667-5791 Fax:
    HP> (206) 667-1319


From cstrato at aon.at  Fri Dec  5 21:23:37 2008
From: cstrato at aon.at (cstrato)
Date: Fri, 05 Dec 2008 21:23:37 +0100
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <alpine.LFD.2.00.0812052000240.4333@gannet.stats.ox.ac.uk>
References: <493985DF.7090303@aon.at>
	<alpine.LFD.2.00.0812052000240.4333@gannet.stats.ox.ac.uk>
Message-ID: <49398DC9.20600@aon.at>

Dear all

Thank you all for you fast reply.

As I said, everything on my laptop and Mac is identical, here are my 
user defined environment variables:

HOME: c:\home\Rabbitus
INCLUDE: C:\Programme\Microsoft Visual Studio 
9.0\VC\include;C:\Programme\Microsoft SDKs\Windows\v6.0A\Include
LIB: C:\Programme\Microsoft Visual Studio 
9.0\VC\lib;C:\Programme\Microsoft SDKs\Windows\v6.0A\Lib;C:\root\lib
PATH: 
C:\Rtools\bin;C:\Rtools\perl\bin;C:\Rtools\MinGW\bin;C:\Programme\HTML 
Help Workshop;C:\Programme\R\R-2.8.0\bin;C:\root\bin;
MSVSPATH: C:\Programme\Microsoft Visual Studio 9.0\VC\bin
ROOTSYS: c:\root
R_LIBS: cd "C:\home\Rabbitus\CRAN"
TMPDIR: c:\home\Rabbitus\temp

I have just checked again, all variables are identical on both systems.

Could there be another reason?
What about the registry setting mentioned by Gabor Grothendieck?

Best regaards
Christian


Prof Brian Ripley wrote:
> This is a PATH error: you must have Rtools/bin before Windows system 
> directories in your path.  As the R-admin manual tells you explicitly 
> ....
>
> fortune("WTFM") applies.
>
> On Fri, 5 Dec 2008, cstrato wrote:
>
>> Dear all
>>
>> When trying to install my package on Windows XP on my Mac, I get the 
>> following error:
>>
>> ---------- Making package xps ------------
>> ...
>> ...
>> xpsDict.cxx
>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll 
>> /def:xps.def /out:xps.dll fp10.obj  -opt:noref  -nologo 
>> -include:_G__cpp_setupG__Hist -include:_G__cpp_setupG__Graf1 
>> -include:_G__cpp_setupG__G3D -include:_G__cpp_setupG__GPad 
>> -include:_G__cpp_setupG__Tree -include:_G__cpp_setupG__Rint 
>> -include:_G__cpp_setupG__PostScript -include:_G__cpp_setupG__Matrix 
>> -include:_G__cpp_setupG__Physics -include:_G__cpp_setupG__Ged  
>> "C:\root/lib/libCore.lib" "C:\root/lib/libCint.lib" 
>> "C:\root/lib/libHist.lib" "C:\root/lib/libGraf.lib" 
>> "C:\root/lib/libGraf3d.lib" "C:\root/lib/libGpad.lib" 
>> "C:\root/lib/libTree.lib" "C:\root/lib/libRint.lib" 
>> "C:\root/lib/libPostscript.lib" "C:\root/lib/libMatrix.lib" 
>> "C:\root/lib/libPhysics.lib" "C:\root/lib/libNet.lib" 
>> "C:\root/lib/libRIO.lib" "C:\root/lib/libMathCore.lib" 
>> "C:\root/lib/libGui.lib" "C:\root/lib/libGraf.lib" 
>> "C:\root/lib/libGpad.lib" "C:\root/lib/libGed.lib" 
>> "C:\root/lib/libTreePlayer.lib" "C:\root/lib/libTreeViewer.lib" *.obj
>>  Creating library xps.lib and object xps.exp
>> ... done
>> installing DLL
>> installing R files
>> installing inst files
>> FIND: Parameterformat falsch
>> make[2]: *** [C:/home/Rabbitus/CRAN/xps.Rcheck/xps/inst] Error 2
>> make[1]: *** [all] Error 2
>> make: *** [pkg-xps] Error 2
>> *** Installation of xps failed ***
>>
>>
>> However, when I install my package on my Windows XP laptop, 
>> everything is ok:
>>
>> ---------- Making package xps ------------
>> ...
>> ...
>> xpsDict.cxx
>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll 
>> /def:xps.def /out:xps.dll fp10.obj  -opt:noref  -nologo 
>> -include:_G__cpp_setupG__Hist -include:_G__cpp_setupG__Graf1 
>> -include:_G__cpp_setupG__G3D -include:_G__cpp_setupG__GPad 
>> -include:_G__cpp_setupG__Tree -include:_G__cpp_setupG__Rint 
>> -include:_G__cpp_setupG__PostScript -include:_G__cpp_setupG__Matrix 
>> -include:_G__cpp_setupG__Physics -include:_G__cpp_setupG__Ged  
>> "C:\root/lib/libCore.lib" "C:\root/lib/libCint.lib" 
>> "C:\root/lib/libHist.lib" "C:\root/lib/libGraf.lib" 
>> "C:\root/lib/libGraf3d.lib" "C:\root/lib/libGpad.lib" 
>> "C:\root/lib/libTree.lib" "C:\root/lib/libRint.lib" 
>> "C:\root/lib/libPostscript.lib" "C:\root/lib/libMatrix.lib" 
>> "C:\root/lib/libPhysics.lib" "C:\root/lib/libNet.lib" 
>> "C:\root/lib/libRIO.lib" "C:\root/lib/libMathCore.lib" 
>> "C:\root/lib/libGui.lib" "C:\root/lib/libGraf.lib" 
>> "C:\root/lib/libGpad.lib" "C:\root/lib/libGed.lib" 
>> "C:\root/lib/libTreePlayer.lib" "C:\root/lib/libTreeViewer.lib" *.obj
>>  Creating library xps.lib and object xps.exp
>> ... done
>> installing DLL
>> installing R files
>> installing inst files
>> preparing package xps for lazy loading
>> installing man source files
>> installing indices
>> Warning messages:
>> 1: In file.create(f.tg) :
>> kann Datei 'c:/Programme/R/R-2.8.0/doc/html/packages.html' nicht 
>> erzeugen. Grund 'Permission denied'
>> 2: In tools:::win.packages.html(.Library) :
>> kann HTML Paketindex nicht aktualisieren
>> installing help
>>>>> Building/Updating help pages for package 'xps'
>> ...
>>
>> To my knowledge I have only made one difference when installing 
>> everything necessary to build my package:
>> On my laptop I have installed Rtools27.exe, while on WinXP on my Mac 
>> I have installed Rtools28.exe.
>>
>> Do you know what the reason for the error might be?
>>
>> Thank you in advance.
>> Best regards
>> Christian
>> _._._._._._._._._._._._._._._._._._
>> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
>> V.i.e.n.n.a           A.u.s.t.r.i.a
>> e.m.a.i.l:        cstrato at aon.at
>> _._._._._._._._._._._._._._._._._._
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>


From murdoch at stats.uwo.ca  Fri Dec  5 21:44:47 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 05 Dec 2008 15:44:47 -0500
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <49398DC9.20600@aon.at>
References: <493985DF.7090303@aon.at>	<alpine.LFD.2.00.0812052000240.4333@gannet.stats.ox.ac.uk>
	<49398DC9.20600@aon.at>
Message-ID: <493992BF.9070407@stats.uwo.ca>

cstrato wrote:
> Dear all
>
> Thank you all for you fast reply.
>
> As I said, everything on my laptop and Mac is identical, here are my 
> user defined environment variables:
>
> HOME: c:\home\Rabbitus
> INCLUDE: C:\Programme\Microsoft Visual Studio 
> 9.0\VC\include;C:\Programme\Microsoft SDKs\Windows\v6.0A\Include
> LIB: C:\Programme\Microsoft Visual Studio
> 9.0\VC\lib;C:\Programme\Microsoft SDKs\Windows\v6.0A\Lib;C:\root\lib
> PATH: 
> C:\Rtools\bin;C:\Rtools\perl\bin;C:\Rtools\MinGW\bin;C:\Programme\HTML 
> Help Workshop;C:\Programme\R\R-2.8.0\bin;C:\root\bin;
> MSVSPATH: C:\Programme\Microsoft Visual Studio 9.0\VC\bin
> ROOTSYS: c:\root
> R_LIBS: cd "C:\home\Rabbitus\CRAN"
> TMPDIR: c:\home\Rabbitus\temp
>   
I think Brian was right, your PATH is not what is shown above.  (That 
doesn't include the Windows directories, for instance.)

Were you running Rcmd INSTALL from a shell?  Which shell?  What does the 
shell report as your PATH just before running it? 

On Windows, the PATH is handled in a fairly complicated way.  I believe 
this description is correct, but it may not apply to all Windows versions:

The thing you set from within the Control Panel only applies to the 
currently running copy of Explorer.  Other applications that are 
currently running (e.g. an existing CMD shell) do not have their path 
updated.

There are both system and user level PATH settings.  Explorer combines 
them by putting the system settings *first*. 

Within a CMD shell, you can override the PATH completely, just by 
setting it to a new set of directories.

So it looks as though your problem is that your are showing us the user 
settings for the PATH, but not the system settings, and the system 
settings are messing you up.

Duncan Murdoch
> I have just checked again, all variables are identical on both systems.
>
> Could there be another reason?
> What about the registry setting mentioned by Gabor Grothendieck?
>
> Best regaards
> Christian
>
>
> Prof Brian Ripley wrote:
>   
>> This is a PATH error: you must have Rtools/bin before Windows system 
>> directories in your path.  As the R-admin manual tells you explicitly 
>> ....
>>
>> fortune("WTFM") applies.
>>
>> On Fri, 5 Dec 2008, cstrato wrote:
>>
>>     
>>> Dear all
>>>
>>> When trying to install my package on Windows XP on my Mac, I get the 
>>> following error:
>>>
>>> ---------- Making package xps ------------
>>> ...
>>> ...
>>> xpsDict.cxx
>>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll 
>>> /def:xps.def /out:xps.dll fp10.obj  -opt:noref  -nologo 
>>> -include:_G__cpp_setupG__Hist -include:_G__cpp_setupG__Graf1 
>>> -include:_G__cpp_setupG__G3D -include:_G__cpp_setupG__GPad 
>>> -include:_G__cpp_setupG__Tree -include:_G__cpp_setupG__Rint 
>>> -include:_G__cpp_setupG__PostScript -include:_G__cpp_setupG__Matrix 
>>> -include:_G__cpp_setupG__Physics -include:_G__cpp_setupG__Ged  
>>> "C:\root/lib/libCore.lib" "C:\root/lib/libCint.lib" 
>>> "C:\root/lib/libHist.lib" "C:\root/lib/libGraf.lib" 
>>> "C:\root/lib/libGraf3d.lib" "C:\root/lib/libGpad.lib" 
>>> "C:\root/lib/libTree.lib" "C:\root/lib/libRint.lib" 
>>> "C:\root/lib/libPostscript.lib" "C:\root/lib/libMatrix.lib" 
>>> "C:\root/lib/libPhysics.lib" "C:\root/lib/libNet.lib" 
>>> "C:\root/lib/libRIO.lib" "C:\root/lib/libMathCore.lib" 
>>> "C:\root/lib/libGui.lib" "C:\root/lib/libGraf.lib" 
>>> "C:\root/lib/libGpad.lib" "C:\root/lib/libGed.lib" 
>>> "C:\root/lib/libTreePlayer.lib" "C:\root/lib/libTreeViewer.lib" *.obj
>>>  Creating library xps.lib and object xps.exp
>>> ... done
>>> installing DLL
>>> installing R files
>>> installing inst files
>>> FIND: Parameterformat falsch
>>> make[2]: *** [C:/home/Rabbitus/CRAN/xps.Rcheck/xps/inst] Error 2
>>> make[1]: *** [all] Error 2
>>> make: *** [pkg-xps] Error 2
>>> *** Installation of xps failed ***
>>>
>>>
>>> However, when I install my package on my Windows XP laptop, 
>>> everything is ok:
>>>
>>> ---------- Making package xps ------------
>>> ...
>>> ...
>>> xpsDict.cxx
>>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll 
>>> /def:xps.def /out:xps.dll fp10.obj  -opt:noref  -nologo 
>>> -include:_G__cpp_setupG__Hist -include:_G__cpp_setupG__Graf1 
>>> -include:_G__cpp_setupG__G3D -include:_G__cpp_setupG__GPad 
>>> -include:_G__cpp_setupG__Tree -include:_G__cpp_setupG__Rint 
>>> -include:_G__cpp_setupG__PostScript -include:_G__cpp_setupG__Matrix 
>>> -include:_G__cpp_setupG__Physics -include:_G__cpp_setupG__Ged  
>>> "C:\root/lib/libCore.lib" "C:\root/lib/libCint.lib" 
>>> "C:\root/lib/libHist.lib" "C:\root/lib/libGraf.lib" 
>>> "C:\root/lib/libGraf3d.lib" "C:\root/lib/libGpad.lib" 
>>> "C:\root/lib/libTree.lib" "C:\root/lib/libRint.lib" 
>>> "C:\root/lib/libPostscript.lib" "C:\root/lib/libMatrix.lib" 
>>> "C:\root/lib/libPhysics.lib" "C:\root/lib/libNet.lib" 
>>> "C:\root/lib/libRIO.lib" "C:\root/lib/libMathCore.lib" 
>>> "C:\root/lib/libGui.lib" "C:\root/lib/libGraf.lib" 
>>> "C:\root/lib/libGpad.lib" "C:\root/lib/libGed.lib" 
>>> "C:\root/lib/libTreePlayer.lib" "C:\root/lib/libTreeViewer.lib" *.obj
>>>  Creating library xps.lib and object xps.exp
>>> ... done
>>> installing DLL
>>> installing R files
>>> installing inst files
>>> preparing package xps for lazy loading
>>> installing man source files
>>> installing indices
>>> Warning messages:
>>> 1: In file.create(f.tg) :
>>> kann Datei 'c:/Programme/R/R-2.8.0/doc/html/packages.html' nicht 
>>> erzeugen. Grund 'Permission denied'
>>> 2: In tools:::win.packages.html(.Library) :
>>> kann HTML Paketindex nicht aktualisieren
>>> installing help
>>>       
>>>>>> Building/Updating help pages for package 'xps'
>>>>>>             
>>> ...
>>>
>>> To my knowledge I have only made one difference when installing 
>>> everything necessary to build my package:
>>> On my laptop I have installed Rtools27.exe, while on WinXP on my Mac 
>>> I have installed Rtools28.exe.
>>>
>>> Do you know what the reason for the error might be?
>>>
>>> Thank you in advance.
>>> Best regards
>>> Christian
>>> _._._._._._._._._._._._._._._._._._
>>> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
>>> V.i.e.n.n.a           A.u.s.t.r.i.a
>>> e.m.a.i.l:        cstrato at aon.at
>>> _._._._._._._._._._._._._._._._._._
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>       
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From cstrato at aon.at  Fri Dec  5 22:06:09 2008
From: cstrato at aon.at (cstrato)
Date: Fri, 05 Dec 2008 22:06:09 +0100
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <493992BF.9070407@stats.uwo.ca>
References: <493985DF.7090303@aon.at>	<alpine.LFD.2.00.0812052000240.4333@gannet.stats.ox.ac.uk>
	<49398DC9.20600@aon.at> <493992BF.9070407@stats.uwo.ca>
Message-ID: <493997C1.2080900@aon.at>

Dear Duncan

Thank you for this explicit explanation, you are right:

When setting the system variable "Path" (as administrator) in addition 
to setting the user variable "PATH" (as user), now everything works fine.

Interestingly, setting the system variable "Path" on my laptop with 
Rtools27 seems not to be necessary.

May I suggest that  this could be clarified in "R Installation and 
Administration" since there only the user variable "PATH" is mentioned 
(as far as I see).

Thank you all one more time.
Best regards
Christian


Duncan Murdoch wrote:
> cstrato wrote:
>> Dear all
>>
>> Thank you all for you fast reply.
>>
>> As I said, everything on my laptop and Mac is identical, here are my 
>> user defined environment variables:
>>
>> HOME: c:\home\Rabbitus
>> INCLUDE: C:\Programme\Microsoft Visual Studio 
>> 9.0\VC\include;C:\Programme\Microsoft SDKs\Windows\v6.0A\Include
>> LIB: C:\Programme\Microsoft Visual Studio
>> 9.0\VC\lib;C:\Programme\Microsoft SDKs\Windows\v6.0A\Lib;C:\root\lib
>> PATH: 
>> C:\Rtools\bin;C:\Rtools\perl\bin;C:\Rtools\MinGW\bin;C:\Programme\HTML 
>> Help Workshop;C:\Programme\R\R-2.8.0\bin;C:\root\bin;
>> MSVSPATH: C:\Programme\Microsoft Visual Studio 9.0\VC\bin
>> ROOTSYS: c:\root
>> R_LIBS: cd "C:\home\Rabbitus\CRAN"
>> TMPDIR: c:\home\Rabbitus\temp
>>   
> I think Brian was right, your PATH is not what is shown above.  (That 
> doesn't include the Windows directories, for instance.)
>
> Were you running Rcmd INSTALL from a shell?  Which shell?  What does 
> the shell report as your PATH just before running it?
> On Windows, the PATH is handled in a fairly complicated way.  I 
> believe this description is correct, but it may not apply to all 
> Windows versions:
>
> The thing you set from within the Control Panel only applies to the 
> currently running copy of Explorer.  Other applications that are 
> currently running (e.g. an existing CMD shell) do not have their path 
> updated.
>
> There are both system and user level PATH settings.  Explorer combines 
> them by putting the system settings *first*.
> Within a CMD shell, you can override the PATH completely, just by 
> setting it to a new set of directories.
>
> So it looks as though your problem is that your are showing us the 
> user settings for the PATH, but not the system settings, and the 
> system settings are messing you up.
>
> Duncan Murdoch
>> I have just checked again, all variables are identical on both systems.
>>
>> Could there be another reason?
>> What about the registry setting mentioned by Gabor Grothendieck?
>>
>> Best regaards
>> Christian
>>
>>
>> Prof Brian Ripley wrote:
>>  
>>> This is a PATH error: you must have Rtools/bin before Windows system 
>>> directories in your path.  As the R-admin manual tells you 
>>> explicitly ....
>>>
>>> fortune("WTFM") applies.
>>>
>>> On Fri, 5 Dec 2008, cstrato wrote:
>>>
>>>    
>>>> Dear all
>>>>
>>>> When trying to install my package on Windows XP on my Mac, I get 
>>>> the following error:
>>>>
>>>> ---------- Making package xps ------------
>>>> ...
>>>> ...
>>>> xpsDict.cxx
>>>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll 
>>>> /def:xps.def /out:xps.dll fp10.obj  -opt:noref  -nologo 
>>>> -include:_G__cpp_setupG__Hist -include:_G__cpp_setupG__Graf1 
>>>> -include:_G__cpp_setupG__G3D -include:_G__cpp_setupG__GPad 
>>>> -include:_G__cpp_setupG__Tree -include:_G__cpp_setupG__Rint 
>>>> -include:_G__cpp_setupG__PostScript -include:_G__cpp_setupG__Matrix 
>>>> -include:_G__cpp_setupG__Physics -include:_G__cpp_setupG__Ged  
>>>> "C:\root/lib/libCore.lib" "C:\root/lib/libCint.lib" 
>>>> "C:\root/lib/libHist.lib" "C:\root/lib/libGraf.lib" 
>>>> "C:\root/lib/libGraf3d.lib" "C:\root/lib/libGpad.lib" 
>>>> "C:\root/lib/libTree.lib" "C:\root/lib/libRint.lib" 
>>>> "C:\root/lib/libPostscript.lib" "C:\root/lib/libMatrix.lib" 
>>>> "C:\root/lib/libPhysics.lib" "C:\root/lib/libNet.lib" 
>>>> "C:\root/lib/libRIO.lib" "C:\root/lib/libMathCore.lib" 
>>>> "C:\root/lib/libGui.lib" "C:\root/lib/libGraf.lib" 
>>>> "C:\root/lib/libGpad.lib" "C:\root/lib/libGed.lib" 
>>>> "C:\root/lib/libTreePlayer.lib" "C:\root/lib/libTreeViewer.lib" *.obj
>>>>  Creating library xps.lib and object xps.exp
>>>> ... done
>>>> installing DLL
>>>> installing R files
>>>> installing inst files
>>>> FIND: Parameterformat falsch
>>>> make[2]: *** [C:/home/Rabbitus/CRAN/xps.Rcheck/xps/inst] Error 2
>>>> make[1]: *** [all] Error 2
>>>> make: *** [pkg-xps] Error 2
>>>> *** Installation of xps failed ***
>>>>
>>>>
>>>> However, when I install my package on my Windows XP laptop, 
>>>> everything is ok:
>>>>
>>>> ---------- Making package xps ------------
>>>> ...
>>>> ...
>>>> xpsDict.cxx
>>>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll 
>>>> /def:xps.def /out:xps.dll fp10.obj  -opt:noref  -nologo 
>>>> -include:_G__cpp_setupG__Hist -include:_G__cpp_setupG__Graf1 
>>>> -include:_G__cpp_setupG__G3D -include:_G__cpp_setupG__GPad 
>>>> -include:_G__cpp_setupG__Tree -include:_G__cpp_setupG__Rint 
>>>> -include:_G__cpp_setupG__PostScript -include:_G__cpp_setupG__Matrix 
>>>> -include:_G__cpp_setupG__Physics -include:_G__cpp_setupG__Ged  
>>>> "C:\root/lib/libCore.lib" "C:\root/lib/libCint.lib" 
>>>> "C:\root/lib/libHist.lib" "C:\root/lib/libGraf.lib" 
>>>> "C:\root/lib/libGraf3d.lib" "C:\root/lib/libGpad.lib" 
>>>> "C:\root/lib/libTree.lib" "C:\root/lib/libRint.lib" 
>>>> "C:\root/lib/libPostscript.lib" "C:\root/lib/libMatrix.lib" 
>>>> "C:\root/lib/libPhysics.lib" "C:\root/lib/libNet.lib" 
>>>> "C:\root/lib/libRIO.lib" "C:\root/lib/libMathCore.lib" 
>>>> "C:\root/lib/libGui.lib" "C:\root/lib/libGraf.lib" 
>>>> "C:\root/lib/libGpad.lib" "C:\root/lib/libGed.lib" 
>>>> "C:\root/lib/libTreePlayer.lib" "C:\root/lib/libTreeViewer.lib" *.obj
>>>>  Creating library xps.lib and object xps.exp
>>>> ... done
>>>> installing DLL
>>>> installing R files
>>>> installing inst files
>>>> preparing package xps for lazy loading
>>>> installing man source files
>>>> installing indices
>>>> Warning messages:
>>>> 1: In file.create(f.tg) :
>>>> kann Datei 'c:/Programme/R/R-2.8.0/doc/html/packages.html' nicht 
>>>> erzeugen. Grund 'Permission denied'
>>>> 2: In tools:::win.packages.html(.Library) :
>>>> kann HTML Paketindex nicht aktualisieren
>>>> installing help
>>>>      
>>>>>>> Building/Updating help pages for package 'xps'
>>>>>>>             
>>>> ...
>>>>
>>>> To my knowledge I have only made one difference when installing 
>>>> everything necessary to build my package:
>>>> On my laptop I have installed Rtools27.exe, while on WinXP on my 
>>>> Mac I have installed Rtools28.exe.
>>>>
>>>> Do you know what the reason for the error might be?
>>>>
>>>> Thank you in advance.
>>>> Best regards
>>>> Christian
>>>> _._._._._._._._._._._._._._._._._._
>>>> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
>>>> V.i.e.n.n.a           A.u.s.t.r.i.a
>>>> e.m.a.i.l:        cstrato at aon.at
>>>> _._._._._._._._._._._._._._._._._._
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>       
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>   
>
>
>


From ggrothendieck at gmail.com  Fri Dec  5 22:17:44 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 5 Dec 2008 16:17:44 -0500
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <493997C1.2080900@aon.at>
References: <493985DF.7090303@aon.at>
	<alpine.LFD.2.00.0812052000240.4333@gannet.stats.ox.ac.uk>
	<49398DC9.20600@aon.at> <493992BF.9070407@stats.uwo.ca>
	<493997C1.2080900@aon.at>
Message-ID: <971536df0812051317o5d9d7e8cn90dc9dc35ded674d@mail.gmail.com>

Note that there is an Rcmd.bat batch file in http://batchfiles.googlecode.com
which automatically sets all environment variables for you including the
PATH making it unnecessary to set your PATH or any environment
variables.

On Fri, Dec 5, 2008 at 4:06 PM, cstrato <cstrato at aon.at> wrote:
> Dear Duncan
>
> Thank you for this explicit explanation, you are right:
>
> When setting the system variable "Path" (as administrator) in addition to
> setting the user variable "PATH" (as user), now everything works fine.
>
> Interestingly, setting the system variable "Path" on my laptop with Rtools27
> seems not to be necessary.
>
> May I suggest that  this could be clarified in "R Installation and
> Administration" since there only the user variable "PATH" is mentioned (as
> far as I see).
>
> Thank you all one more time.
> Best regards
> Christian
>
>
> Duncan Murdoch wrote:
>>
>> cstrato wrote:
>>>
>>> Dear all
>>>
>>> Thank you all for you fast reply.
>>>
>>> As I said, everything on my laptop and Mac is identical, here are my user
>>> defined environment variables:
>>>
>>> HOME: c:\home\Rabbitus
>>> INCLUDE: C:\Programme\Microsoft Visual Studio
>>> 9.0\VC\include;C:\Programme\Microsoft SDKs\Windows\v6.0A\Include
>>> LIB: C:\Programme\Microsoft Visual Studio
>>> 9.0\VC\lib;C:\Programme\Microsoft SDKs\Windows\v6.0A\Lib;C:\root\lib
>>> PATH:
>>> C:\Rtools\bin;C:\Rtools\perl\bin;C:\Rtools\MinGW\bin;C:\Programme\HTML Help
>>> Workshop;C:\Programme\R\R-2.8.0\bin;C:\root\bin;
>>> MSVSPATH: C:\Programme\Microsoft Visual Studio 9.0\VC\bin
>>> ROOTSYS: c:\root
>>> R_LIBS: cd "C:\home\Rabbitus\CRAN"
>>> TMPDIR: c:\home\Rabbitus\temp
>>>
>>
>> I think Brian was right, your PATH is not what is shown above.  (That
>> doesn't include the Windows directories, for instance.)
>>
>> Were you running Rcmd INSTALL from a shell?  Which shell?  What does the
>> shell report as your PATH just before running it?
>> On Windows, the PATH is handled in a fairly complicated way.  I believe
>> this description is correct, but it may not apply to all Windows versions:
>>
>> The thing you set from within the Control Panel only applies to the
>> currently running copy of Explorer.  Other applications that are currently
>> running (e.g. an existing CMD shell) do not have their path updated.
>>
>> There are both system and user level PATH settings.  Explorer combines
>> them by putting the system settings *first*.
>> Within a CMD shell, you can override the PATH completely, just by setting
>> it to a new set of directories.
>>
>> So it looks as though your problem is that your are showing us the user
>> settings for the PATH, but not the system settings, and the system settings
>> are messing you up.
>>
>> Duncan Murdoch
>>>
>>> I have just checked again, all variables are identical on both systems.
>>>
>>> Could there be another reason?
>>> What about the registry setting mentioned by Gabor Grothendieck?
>>>
>>> Best regaards
>>> Christian
>>>
>>>
>>> Prof Brian Ripley wrote:
>>>
>>>>
>>>> This is a PATH error: you must have Rtools/bin before Windows system
>>>> directories in your path.  As the R-admin manual tells you explicitly ....
>>>>
>>>> fortune("WTFM") applies.
>>>>
>>>> On Fri, 5 Dec 2008, cstrato wrote:
>>>>
>>>>
>>>>>
>>>>> Dear all
>>>>>
>>>>> When trying to install my package on Windows XP on my Mac, I get the
>>>>> following error:
>>>>>
>>>>> ---------- Making package xps ------------
>>>>> ...
>>>>> ...
>>>>> xpsDict.cxx
>>>>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll
>>>>> /def:xps.def /out:xps.dll fp10.obj  -opt:noref  -nologo
>>>>> -include:_G__cpp_setupG__Hist -include:_G__cpp_setupG__Graf1
>>>>> -include:_G__cpp_setupG__G3D -include:_G__cpp_setupG__GPad
>>>>> -include:_G__cpp_setupG__Tree -include:_G__cpp_setupG__Rint
>>>>> -include:_G__cpp_setupG__PostScript -include:_G__cpp_setupG__Matrix
>>>>> -include:_G__cpp_setupG__Physics -include:_G__cpp_setupG__Ged
>>>>>  "C:\root/lib/libCore.lib" "C:\root/lib/libCint.lib"
>>>>> "C:\root/lib/libHist.lib" "C:\root/lib/libGraf.lib"
>>>>> "C:\root/lib/libGraf3d.lib" "C:\root/lib/libGpad.lib"
>>>>> "C:\root/lib/libTree.lib" "C:\root/lib/libRint.lib"
>>>>> "C:\root/lib/libPostscript.lib" "C:\root/lib/libMatrix.lib"
>>>>> "C:\root/lib/libPhysics.lib" "C:\root/lib/libNet.lib"
>>>>> "C:\root/lib/libRIO.lib" "C:\root/lib/libMathCore.lib"
>>>>> "C:\root/lib/libGui.lib" "C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib"
>>>>> "C:\root/lib/libGed.lib" "C:\root/lib/libTreePlayer.lib"
>>>>> "C:\root/lib/libTreeViewer.lib" *.obj
>>>>>  Creating library xps.lib and object xps.exp
>>>>> ... done
>>>>> installing DLL
>>>>> installing R files
>>>>> installing inst files
>>>>> FIND: Parameterformat falsch
>>>>> make[2]: *** [C:/home/Rabbitus/CRAN/xps.Rcheck/xps/inst] Error 2
>>>>> make[1]: *** [all] Error 2
>>>>> make: *** [pkg-xps] Error 2
>>>>> *** Installation of xps failed ***
>>>>>
>>>>>
>>>>> However, when I install my package on my Windows XP laptop, everything
>>>>> is ok:
>>>>>
>>>>> ---------- Making package xps ------------
>>>>> ...
>>>>> ...
>>>>> xpsDict.cxx
>>>>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll
>>>>> /def:xps.def /out:xps.dll fp10.obj  -opt:noref  -nologo
>>>>> -include:_G__cpp_setupG__Hist -include:_G__cpp_setupG__Graf1
>>>>> -include:_G__cpp_setupG__G3D -include:_G__cpp_setupG__GPad
>>>>> -include:_G__cpp_setupG__Tree -include:_G__cpp_setupG__Rint
>>>>> -include:_G__cpp_setupG__PostScript -include:_G__cpp_setupG__Matrix
>>>>> -include:_G__cpp_setupG__Physics -include:_G__cpp_setupG__Ged
>>>>>  "C:\root/lib/libCore.lib" "C:\root/lib/libCint.lib"
>>>>> "C:\root/lib/libHist.lib" "C:\root/lib/libGraf.lib"
>>>>> "C:\root/lib/libGraf3d.lib" "C:\root/lib/libGpad.lib"
>>>>> "C:\root/lib/libTree.lib" "C:\root/lib/libRint.lib"
>>>>> "C:\root/lib/libPostscript.lib" "C:\root/lib/libMatrix.lib"
>>>>> "C:\root/lib/libPhysics.lib" "C:\root/lib/libNet.lib"
>>>>> "C:\root/lib/libRIO.lib" "C:\root/lib/libMathCore.lib"
>>>>> "C:\root/lib/libGui.lib" "C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib"
>>>>> "C:\root/lib/libGed.lib" "C:\root/lib/libTreePlayer.lib"
>>>>> "C:\root/lib/libTreeViewer.lib" *.obj
>>>>>  Creating library xps.lib and object xps.exp
>>>>> ... done
>>>>> installing DLL
>>>>> installing R files
>>>>> installing inst files
>>>>> preparing package xps for lazy loading
>>>>> installing man source files
>>>>> installing indices
>>>>> Warning messages:
>>>>> 1: In file.create(f.tg) :
>>>>> kann Datei 'c:/Programme/R/R-2.8.0/doc/html/packages.html' nicht
>>>>> erzeugen. Grund 'Permission denied'
>>>>> 2: In tools:::win.packages.html(.Library) :
>>>>> kann HTML Paketindex nicht aktualisieren
>>>>> installing help
>>>>>
>>>>>>>>
>>>>>>>> Building/Updating help pages for package 'xps'
>>>>>>>>
>>>>>
>>>>> ...
>>>>>
>>>>> To my knowledge I have only made one difference when installing
>>>>> everything necessary to build my package:
>>>>> On my laptop I have installed Rtools27.exe, while on WinXP on my Mac I
>>>>> have installed Rtools28.exe.
>>>>>
>>>>> Do you know what the reason for the error might be?
>>>>>
>>>>> Thank you in advance.
>>>>> Best regards
>>>>> Christian
>>>>> _._._._._._._._._._._._._._._._._._
>>>>> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
>>>>> V.i.e.n.n.a           A.u.s.t.r.i.a
>>>>> e.m.a.i.l:        cstrato at aon.at
>>>>> _._._._._._._._._._._._._._._._._._
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>>
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From cstrato at aon.at  Fri Dec  5 22:28:54 2008
From: cstrato at aon.at (cstrato)
Date: Fri, 05 Dec 2008 22:28:54 +0100
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <971536df0812051317o5d9d7e8cn90dc9dc35ded674d@mail.gmail.com>
References: <493985DF.7090303@aon.at>	
	<alpine.LFD.2.00.0812052000240.4333@gannet.stats.ox.ac.uk>	
	<49398DC9.20600@aon.at> <493992BF.9070407@stats.uwo.ca>	
	<493997C1.2080900@aon.at>
	<971536df0812051317o5d9d7e8cn90dc9dc35ded674d@mail.gmail.com>
Message-ID: <49399D16.40908@aon.at>

Dear Gabor

Thank you for this interesting link.

Since I have also to set the PATH and LIB for Visual Studio AND for 
ROOT, I am not sure if this would be an option for me.

Best regards
Christian


Gabor Grothendieck wrote:
> Note that there is an Rcmd.bat batch file in http://batchfiles.googlecode.com
> which automatically sets all environment variables for you including the
> PATH making it unnecessary to set your PATH or any environment
> variables.
>
> On Fri, Dec 5, 2008 at 4:06 PM, cstrato <cstrato at aon.at> wrote:
>   
>> Dear Duncan
>>
>> Thank you for this explicit explanation, you are right:
>>
>> When setting the system variable "Path" (as administrator) in addition to
>> setting the user variable "PATH" (as user), now everything works fine.
>>
>> Interestingly, setting the system variable "Path" on my laptop with Rtools27
>> seems not to be necessary.
>>
>> May I suggest that  this could be clarified in "R Installation and
>> Administration" since there only the user variable "PATH" is mentioned (as
>> far as I see).
>>
>> Thank you all one more time.
>> Best regards
>> Christian
>>
>>
>> Duncan Murdoch wrote:
>>     
>>> cstrato wrote:
>>>       
>>>> Dear all
>>>>
>>>> Thank you all for you fast reply.
>>>>
>>>> As I said, everything on my laptop and Mac is identical, here are my user
>>>> defined environment variables:
>>>>
>>>> HOME: c:\home\Rabbitus
>>>> INCLUDE: C:\Programme\Microsoft Visual Studio
>>>> 9.0\VC\include;C:\Programme\Microsoft SDKs\Windows\v6.0A\Include
>>>> LIB: C:\Programme\Microsoft Visual Studio
>>>> 9.0\VC\lib;C:\Programme\Microsoft SDKs\Windows\v6.0A\Lib;C:\root\lib
>>>> PATH:
>>>> C:\Rtools\bin;C:\Rtools\perl\bin;C:\Rtools\MinGW\bin;C:\Programme\HTML Help
>>>> Workshop;C:\Programme\R\R-2.8.0\bin;C:\root\bin;
>>>> MSVSPATH: C:\Programme\Microsoft Visual Studio 9.0\VC\bin
>>>> ROOTSYS: c:\root
>>>> R_LIBS: cd "C:\home\Rabbitus\CRAN"
>>>> TMPDIR: c:\home\Rabbitus\temp
>>>>
>>>>         
>>> I think Brian was right, your PATH is not what is shown above.  (That
>>> doesn't include the Windows directories, for instance.)
>>>
>>> Were you running Rcmd INSTALL from a shell?  Which shell?  What does the
>>> shell report as your PATH just before running it?
>>> On Windows, the PATH is handled in a fairly complicated way.  I believe
>>> this description is correct, but it may not apply to all Windows versions:
>>>
>>> The thing you set from within the Control Panel only applies to the
>>> currently running copy of Explorer.  Other applications that are currently
>>> running (e.g. an existing CMD shell) do not have their path updated.
>>>
>>> There are both system and user level PATH settings.  Explorer combines
>>> them by putting the system settings *first*.
>>> Within a CMD shell, you can override the PATH completely, just by setting
>>> it to a new set of directories.
>>>
>>> So it looks as though your problem is that your are showing us the user
>>> settings for the PATH, but not the system settings, and the system settings
>>> are messing you up.
>>>
>>> Duncan Murdoch
>>>       
>>>> I have just checked again, all variables are identical on both systems.
>>>>
>>>> Could there be another reason?
>>>> What about the registry setting mentioned by Gabor Grothendieck?
>>>>
>>>> Best regaards
>>>> Christian
>>>>
>>>>
>>>> Prof Brian Ripley wrote:
>>>>
>>>>         
>>>>> This is a PATH error: you must have Rtools/bin before Windows system
>>>>> directories in your path.  As the R-admin manual tells you explicitly ....
>>>>>
>>>>> fortune("WTFM") applies.
>>>>>
>>>>> On Fri, 5 Dec 2008, cstrato wrote:
>>>>>
>>>>>
>>>>>           
>>>>>> Dear all
>>>>>>
>>>>>> When trying to install my package on Windows XP on my Mac, I get the
>>>>>> following error:
>>>>>>
>>>>>> ---------- Making package xps ------------
>>>>>> ...
>>>>>> ...
>>>>>> xpsDict.cxx
>>>>>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll
>>>>>> /def:xps.def /out:xps.dll fp10.obj  -opt:noref  -nologo
>>>>>> -include:_G__cpp_setupG__Hist -include:_G__cpp_setupG__Graf1
>>>>>> -include:_G__cpp_setupG__G3D -include:_G__cpp_setupG__GPad
>>>>>> -include:_G__cpp_setupG__Tree -include:_G__cpp_setupG__Rint
>>>>>> -include:_G__cpp_setupG__PostScript -include:_G__cpp_setupG__Matrix
>>>>>> -include:_G__cpp_setupG__Physics -include:_G__cpp_setupG__Ged
>>>>>>  "C:\root/lib/libCore.lib" "C:\root/lib/libCint.lib"
>>>>>> "C:\root/lib/libHist.lib" "C:\root/lib/libGraf.lib"
>>>>>> "C:\root/lib/libGraf3d.lib" "C:\root/lib/libGpad.lib"
>>>>>> "C:\root/lib/libTree.lib" "C:\root/lib/libRint.lib"
>>>>>> "C:\root/lib/libPostscript.lib" "C:\root/lib/libMatrix.lib"
>>>>>> "C:\root/lib/libPhysics.lib" "C:\root/lib/libNet.lib"
>>>>>> "C:\root/lib/libRIO.lib" "C:\root/lib/libMathCore.lib"
>>>>>> "C:\root/lib/libGui.lib" "C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib"
>>>>>> "C:\root/lib/libGed.lib" "C:\root/lib/libTreePlayer.lib"
>>>>>> "C:\root/lib/libTreeViewer.lib" *.obj
>>>>>>  Creating library xps.lib and object xps.exp
>>>>>> ... done
>>>>>> installing DLL
>>>>>> installing R files
>>>>>> installing inst files
>>>>>> FIND: Parameterformat falsch
>>>>>> make[2]: *** [C:/home/Rabbitus/CRAN/xps.Rcheck/xps/inst] Error 2
>>>>>> make[1]: *** [all] Error 2
>>>>>> make: *** [pkg-xps] Error 2
>>>>>> *** Installation of xps failed ***
>>>>>>
>>>>>>
>>>>>> However, when I install my package on my Windows XP laptop, everything
>>>>>> is ok:
>>>>>>
>>>>>> ---------- Making package xps ------------
>>>>>> ...
>>>>>> ...
>>>>>> xpsDict.cxx
>>>>>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll
>>>>>> /def:xps.def /out:xps.dll fp10.obj  -opt:noref  -nologo
>>>>>> -include:_G__cpp_setupG__Hist -include:_G__cpp_setupG__Graf1
>>>>>> -include:_G__cpp_setupG__G3D -include:_G__cpp_setupG__GPad
>>>>>> -include:_G__cpp_setupG__Tree -include:_G__cpp_setupG__Rint
>>>>>> -include:_G__cpp_setupG__PostScript -include:_G__cpp_setupG__Matrix
>>>>>> -include:_G__cpp_setupG__Physics -include:_G__cpp_setupG__Ged
>>>>>>  "C:\root/lib/libCore.lib" "C:\root/lib/libCint.lib"
>>>>>> "C:\root/lib/libHist.lib" "C:\root/lib/libGraf.lib"
>>>>>> "C:\root/lib/libGraf3d.lib" "C:\root/lib/libGpad.lib"
>>>>>> "C:\root/lib/libTree.lib" "C:\root/lib/libRint.lib"
>>>>>> "C:\root/lib/libPostscript.lib" "C:\root/lib/libMatrix.lib"
>>>>>> "C:\root/lib/libPhysics.lib" "C:\root/lib/libNet.lib"
>>>>>> "C:\root/lib/libRIO.lib" "C:\root/lib/libMathCore.lib"
>>>>>> "C:\root/lib/libGui.lib" "C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib"
>>>>>> "C:\root/lib/libGed.lib" "C:\root/lib/libTreePlayer.lib"
>>>>>> "C:\root/lib/libTreeViewer.lib" *.obj
>>>>>>  Creating library xps.lib and object xps.exp
>>>>>> ... done
>>>>>> installing DLL
>>>>>> installing R files
>>>>>> installing inst files
>>>>>> preparing package xps for lazy loading
>>>>>> installing man source files
>>>>>> installing indices
>>>>>> Warning messages:
>>>>>> 1: In file.create(f.tg) :
>>>>>> kann Datei 'c:/Programme/R/R-2.8.0/doc/html/packages.html' nicht
>>>>>> erzeugen. Grund 'Permission denied'
>>>>>> 2: In tools:::win.packages.html(.Library) :
>>>>>> kann HTML Paketindex nicht aktualisieren
>>>>>> installing help
>>>>>>
>>>>>>             
>>>>>>>>> Building/Updating help pages for package 'xps'
>>>>>>>>>
>>>>>>>>>                   
>>>>>> ...
>>>>>>
>>>>>> To my knowledge I have only made one difference when installing
>>>>>> everything necessary to build my package:
>>>>>> On my laptop I have installed Rtools27.exe, while on WinXP on my Mac I
>>>>>> have installed Rtools28.exe.
>>>>>>
>>>>>> Do you know what the reason for the error might be?
>>>>>>
>>>>>> Thank you in advance.
>>>>>> Best regards
>>>>>> Christian
>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
>>>>>> V.i.e.n.n.a           A.u.s.t.r.i.a
>>>>>> e.m.a.i.l:        cstrato at aon.at
>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>
>>>>>>
>>>>>>             
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>         
>>>
>>>       
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>     
>
>
>


From ripley at stats.ox.ac.uk  Fri Dec  5 22:33:17 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 5 Dec 2008 21:33:17 +0000 (GMT)
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <493997C1.2080900@aon.at>
References: <493985DF.7090303@aon.at>
	<alpine.LFD.2.00.0812052000240.4333@gannet.stats.ox.ac.uk>
	<49398DC9.20600@aon.at> <493992BF.9070407@stats.uwo.ca>
	<493997C1.2080900@aon.at>
Message-ID: <alpine.LFD.2.00.0812052132220.7012@gannet.stats.ox.ac.uk>

On Fri, 5 Dec 2008, cstrato wrote:

> Dear Duncan
>
> Thank you for this explicit explanation, you are right:
>
> When setting the system variable "Path" (as administrator) in addition to 
> setting the user variable "PATH" (as user), now everything works fine.
>
> Interestingly, setting the system variable "Path" on my laptop with Rtools27 
> seems not to be necessary.
>
> May I suggest that  this could be clarified in "R Installation and 
> Administration" since there only the user variable "PATH" is mentioned (as 
> far as I see).

In a shell there is only one PATH, so the manual is correct.

>
> Thank you all one more time.
> Best regards
> Christian
>
>
> Duncan Murdoch wrote:
>> cstrato wrote:
>>> Dear all
>>> 
>>> Thank you all for you fast reply.
>>> 
>>> As I said, everything on my laptop and Mac is identical, here are my user 
>>> defined environment variables:
>>> 
>>> HOME: c:\home\Rabbitus
>>> INCLUDE: C:\Programme\Microsoft Visual Studio 
>>> 9.0\VC\include;C:\Programme\Microsoft SDKs\Windows\v6.0A\Include
>>> LIB: C:\Programme\Microsoft Visual Studio
>>> 9.0\VC\lib;C:\Programme\Microsoft SDKs\Windows\v6.0A\Lib;C:\root\lib
>>> PATH: 
>>> C:\Rtools\bin;C:\Rtools\perl\bin;C:\Rtools\MinGW\bin;C:\Programme\HTML 
>>> Help Workshop;C:\Programme\R\R-2.8.0\bin;C:\root\bin;
>>> MSVSPATH: C:\Programme\Microsoft Visual Studio 9.0\VC\bin
>>> ROOTSYS: c:\root
>>> R_LIBS: cd "C:\home\Rabbitus\CRAN"
>>> TMPDIR: c:\home\Rabbitus\temp
>>> 
>> I think Brian was right, your PATH is not what is shown above.  (That 
>> doesn't include the Windows directories, for instance.)
>> 
>> Were you running Rcmd INSTALL from a shell?  Which shell?  What does the 
>> shell report as your PATH just before running it?
>> On Windows, the PATH is handled in a fairly complicated way.  I believe 
>> this description is correct, but it may not apply to all Windows versions:
>> 
>> The thing you set from within the Control Panel only applies to the 
>> currently running copy of Explorer.  Other applications that are currently 
>> running (e.g. an existing CMD shell) do not have their path updated.
>> 
>> There are both system and user level PATH settings.  Explorer combines them 
>> by putting the system settings *first*.
>> Within a CMD shell, you can override the PATH completely, just by setting 
>> it to a new set of directories.
>> 
>> So it looks as though your problem is that your are showing us the user 
>> settings for the PATH, but not the system settings, and the system settings 
>> are messing you up.
>> 
>> Duncan Murdoch
>>> I have just checked again, all variables are identical on both systems.
>>> 
>>> Could there be another reason?
>>> What about the registry setting mentioned by Gabor Grothendieck?
>>> 
>>> Best regaards
>>> Christian
>>> 
>>> 
>>> Prof Brian Ripley wrote:
>>> 
>>>> This is a PATH error: you must have Rtools/bin before Windows system 
>>>> directories in your path.  As the R-admin manual tells you explicitly 
>>>> ....
>>>> 
>>>> fortune("WTFM") applies.
>>>> 
>>>> On Fri, 5 Dec 2008, cstrato wrote:
>>>>
>>>> 
>>>>> Dear all
>>>>> 
>>>>> When trying to install my package on Windows XP on my Mac, I get the 
>>>>> following error:
>>>>> 
>>>>> ---------- Making package xps ------------
>>>>> ...
>>>>> ...
>>>>> xpsDict.cxx
>>>>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll /def:xps.def 
>>>>> /out:xps.dll fp10.obj  -opt:noref  -nologo -include:_G__cpp_setupG__Hist 
>>>>> -include:_G__cpp_setupG__Graf1 -include:_G__cpp_setupG__G3D 
>>>>> -include:_G__cpp_setupG__GPad -include:_G__cpp_setupG__Tree 
>>>>> -include:_G__cpp_setupG__Rint -include:_G__cpp_setupG__PostScript 
>>>>> -include:_G__cpp_setupG__Matrix -include:_G__cpp_setupG__Physics 
>>>>> -include:_G__cpp_setupG__Ged  "C:\root/lib/libCore.lib" 
>>>>> "C:\root/lib/libCint.lib" "C:\root/lib/libHist.lib" 
>>>>> "C:\root/lib/libGraf.lib" "C:\root/lib/libGraf3d.lib" 
>>>>> "C:\root/lib/libGpad.lib" "C:\root/lib/libTree.lib" 
>>>>> "C:\root/lib/libRint.lib" "C:\root/lib/libPostscript.lib" 
>>>>> "C:\root/lib/libMatrix.lib" "C:\root/lib/libPhysics.lib" 
>>>>> "C:\root/lib/libNet.lib" "C:\root/lib/libRIO.lib" 
>>>>> "C:\root/lib/libMathCore.lib" "C:\root/lib/libGui.lib" 
>>>>> "C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib" 
>>>>> "C:\root/lib/libGed.lib" "C:\root/lib/libTreePlayer.lib" 
>>>>> "C:\root/lib/libTreeViewer.lib" *.obj
>>>>>  Creating library xps.lib and object xps.exp
>>>>> ... done
>>>>> installing DLL
>>>>> installing R files
>>>>> installing inst files
>>>>> FIND: Parameterformat falsch
>>>>> make[2]: *** [C:/home/Rabbitus/CRAN/xps.Rcheck/xps/inst] Error 2
>>>>> make[1]: *** [all] Error 2
>>>>> make: *** [pkg-xps] Error 2
>>>>> *** Installation of xps failed ***
>>>>> 
>>>>> 
>>>>> However, when I install my package on my Windows XP laptop, everything 
>>>>> is ok:
>>>>> 
>>>>> ---------- Making package xps ------------
>>>>> ...
>>>>> ...
>>>>> xpsDict.cxx
>>>>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll /def:xps.def 
>>>>> /out:xps.dll fp10.obj  -opt:noref  -nologo -include:_G__cpp_setupG__Hist 
>>>>> -include:_G__cpp_setupG__Graf1 -include:_G__cpp_setupG__G3D 
>>>>> -include:_G__cpp_setupG__GPad -include:_G__cpp_setupG__Tree 
>>>>> -include:_G__cpp_setupG__Rint -include:_G__cpp_setupG__PostScript 
>>>>> -include:_G__cpp_setupG__Matrix -include:_G__cpp_setupG__Physics 
>>>>> -include:_G__cpp_setupG__Ged  "C:\root/lib/libCore.lib" 
>>>>> "C:\root/lib/libCint.lib" "C:\root/lib/libHist.lib" 
>>>>> "C:\root/lib/libGraf.lib" "C:\root/lib/libGraf3d.lib" 
>>>>> "C:\root/lib/libGpad.lib" "C:\root/lib/libTree.lib" 
>>>>> "C:\root/lib/libRint.lib" "C:\root/lib/libPostscript.lib" 
>>>>> "C:\root/lib/libMatrix.lib" "C:\root/lib/libPhysics.lib" 
>>>>> "C:\root/lib/libNet.lib" "C:\root/lib/libRIO.lib" 
>>>>> "C:\root/lib/libMathCore.lib" "C:\root/lib/libGui.lib" 
>>>>> "C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib" 
>>>>> "C:\root/lib/libGed.lib" "C:\root/lib/libTreePlayer.lib" 
>>>>> "C:\root/lib/libTreeViewer.lib" *.obj
>>>>>  Creating library xps.lib and object xps.exp
>>>>> ... done
>>>>> installing DLL
>>>>> installing R files
>>>>> installing inst files
>>>>> preparing package xps for lazy loading
>>>>> installing man source files
>>>>> installing indices
>>>>> Warning messages:
>>>>> 1: In file.create(f.tg) :
>>>>> kann Datei 'c:/Programme/R/R-2.8.0/doc/html/packages.html' nicht 
>>>>> erzeugen. Grund 'Permission denied'
>>>>> 2: In tools:::win.packages.html(.Library) :
>>>>> kann HTML Paketindex nicht aktualisieren
>>>>> installing help
>>>>> 
>>>>>>>> Building/Updating help pages for package 'xps'
>>>>>>>> 
>>>>> ...
>>>>> 
>>>>> To my knowledge I have only made one difference when installing 
>>>>> everything necessary to build my package:
>>>>> On my laptop I have installed Rtools27.exe, while on WinXP on my Mac I 
>>>>> have installed Rtools28.exe.
>>>>> 
>>>>> Do you know what the reason for the error might be?
>>>>> 
>>>>> Thank you in advance.
>>>>> Best regards
>>>>> Christian
>>>>> _._._._._._._._._._._._._._._._._._
>>>>> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
>>>>> V.i.e.n.n.a           A.u.s.t.r.i.a
>>>>> e.m.a.i.l:        cstrato at aon.at
>>>>> _._._._._._._._._._._._._._._._._._
>>>>> 
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>> 
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
>> 
>> 
>> 
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From cstrato at aon.at  Fri Dec  5 22:47:08 2008
From: cstrato at aon.at (cstrato)
Date: Fri, 05 Dec 2008 22:47:08 +0100
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <alpine.LFD.2.00.0812052132220.7012@gannet.stats.ox.ac.uk>
References: <493985DF.7090303@aon.at>
	<alpine.LFD.2.00.0812052000240.4333@gannet.stats.ox.ac.uk>
	<49398DC9.20600@aon.at> <493992BF.9070407@stats.uwo.ca>
	<493997C1.2080900@aon.at>
	<alpine.LFD.2.00.0812052132220.7012@gannet.stats.ox.ac.uk>
Message-ID: <4939A15C.7080900@aon.at>

Prof Brian Ripley wrote:
> On Fri, 5 Dec 2008, cstrato wrote:
>
>> Dear Duncan
>>
>> Thank you for this explicit explanation, you are right:
>>
>> When setting the system variable "Path" (as administrator) in 
>> addition to setting the user variable "PATH" (as user), now 
>> everything works fine.
>>
>> Interestingly, setting the system variable "Path" on my laptop with 
>> Rtools27 seems not to be necessary.
>>
>> May I suggest that  this could be clarified in "R Installation and 
>> Administration" since there only the user variable "PATH" is 
>> mentioned (as far as I see).
>
> In a shell there is only one PATH, so the manual is correct.
I did not say that the manual is not correct, I only suggested to 
clarify the issue, since when running R CMD INSTALL from the Command 
Console I need to set also the system variable "Path".
>
>>
>> Thank you all one more time.
>> Best regards
>> Christian
>>
>>
>> Duncan Murdoch wrote:
>>> cstrato wrote:
>>>> Dear all
>>>>
>>>> Thank you all for you fast reply.
>>>>
>>>> As I said, everything on my laptop and Mac is identical, here are 
>>>> my user defined environment variables:
>>>>
>>>> HOME: c:\home\Rabbitus
>>>> INCLUDE: C:\Programme\Microsoft Visual Studio 
>>>> 9.0\VC\include;C:\Programme\Microsoft SDKs\Windows\v6.0A\Include
>>>> LIB: C:\Programme\Microsoft Visual Studio
>>>> 9.0\VC\lib;C:\Programme\Microsoft SDKs\Windows\v6.0A\Lib;C:\root\lib
>>>> PATH: 
>>>> C:\Rtools\bin;C:\Rtools\perl\bin;C:\Rtools\MinGW\bin;C:\Programme\HTML 
>>>> Help Workshop;C:\Programme\R\R-2.8.0\bin;C:\root\bin;
>>>> MSVSPATH: C:\Programme\Microsoft Visual Studio 9.0\VC\bin
>>>> ROOTSYS: c:\root
>>>> R_LIBS: cd "C:\home\Rabbitus\CRAN"
>>>> TMPDIR: c:\home\Rabbitus\temp
>>>>
>>> I think Brian was right, your PATH is not what is shown above.  
>>> (That doesn't include the Windows directories, for instance.)
>>>
>>> Were you running Rcmd INSTALL from a shell?  Which shell?  What does 
>>> the shell report as your PATH just before running it?
>>> On Windows, the PATH is handled in a fairly complicated way.  I 
>>> believe this description is correct, but it may not apply to all 
>>> Windows versions:
>>>
>>> The thing you set from within the Control Panel only applies to the 
>>> currently running copy of Explorer.  Other applications that are 
>>> currently running (e.g. an existing CMD shell) do not have their 
>>> path updated.
>>>
>>> There are both system and user level PATH settings.  Explorer 
>>> combines them by putting the system settings *first*.
>>> Within a CMD shell, you can override the PATH completely, just by 
>>> setting it to a new set of directories.
>>>
>>> So it looks as though your problem is that your are showing us the 
>>> user settings for the PATH, but not the system settings, and the 
>>> system settings are messing you up.
>>>
>>> Duncan Murdoch
>>>> I have just checked again, all variables are identical on both 
>>>> systems.
>>>>
>>>> Could there be another reason?
>>>> What about the registry setting mentioned by Gabor Grothendieck?
>>>>
>>>> Best regaards
>>>> Christian
>>>>
>>>>
>>>> Prof Brian Ripley wrote:
>>>>
>>>>> This is a PATH error: you must have Rtools/bin before Windows 
>>>>> system directories in your path.  As the R-admin manual tells you 
>>>>> explicitly ....
>>>>>
>>>>> fortune("WTFM") applies.
>>>>>
>>>>> On Fri, 5 Dec 2008, cstrato wrote:
>>>>>
>>>>>
>>>>>> Dear all
>>>>>>
>>>>>> When trying to install my package on Windows XP on my Mac, I get 
>>>>>> the following error:
>>>>>>
>>>>>> ---------- Making package xps ------------
>>>>>> ...
>>>>>> ...
>>>>>> xpsDict.cxx
>>>>>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll 
>>>>>> /def:xps.def /out:xps.dll fp10.obj  -opt:noref  -nologo 
>>>>>> -include:_G__cpp_setupG__Hist -include:_G__cpp_setupG__Graf1 
>>>>>> -include:_G__cpp_setupG__G3D -include:_G__cpp_setupG__GPad 
>>>>>> -include:_G__cpp_setupG__Tree -include:_G__cpp_setupG__Rint 
>>>>>> -include:_G__cpp_setupG__PostScript 
>>>>>> -include:_G__cpp_setupG__Matrix -include:_G__cpp_setupG__Physics 
>>>>>> -include:_G__cpp_setupG__Ged  "C:\root/lib/libCore.lib" 
>>>>>> "C:\root/lib/libCint.lib" "C:\root/lib/libHist.lib" 
>>>>>> "C:\root/lib/libGraf.lib" "C:\root/lib/libGraf3d.lib" 
>>>>>> "C:\root/lib/libGpad.lib" "C:\root/lib/libTree.lib" 
>>>>>> "C:\root/lib/libRint.lib" "C:\root/lib/libPostscript.lib" 
>>>>>> "C:\root/lib/libMatrix.lib" "C:\root/lib/libPhysics.lib" 
>>>>>> "C:\root/lib/libNet.lib" "C:\root/lib/libRIO.lib" 
>>>>>> "C:\root/lib/libMathCore.lib" "C:\root/lib/libGui.lib" 
>>>>>> "C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib" 
>>>>>> "C:\root/lib/libGed.lib" "C:\root/lib/libTreePlayer.lib" 
>>>>>> "C:\root/lib/libTreeViewer.lib" *.obj
>>>>>>  Creating library xps.lib and object xps.exp
>>>>>> ... done
>>>>>> installing DLL
>>>>>> installing R files
>>>>>> installing inst files
>>>>>> FIND: Parameterformat falsch
>>>>>> make[2]: *** [C:/home/Rabbitus/CRAN/xps.Rcheck/xps/inst] Error 2
>>>>>> make[1]: *** [all] Error 2
>>>>>> make: *** [pkg-xps] Error 2
>>>>>> *** Installation of xps failed ***
>>>>>>
>>>>>>
>>>>>> However, when I install my package on my Windows XP laptop, 
>>>>>> everything is ok:
>>>>>>
>>>>>> ---------- Making package xps ------------
>>>>>> ...
>>>>>> ...
>>>>>> xpsDict.cxx
>>>>>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll 
>>>>>> /def:xps.def /out:xps.dll fp10.obj  -opt:noref  -nologo 
>>>>>> -include:_G__cpp_setupG__Hist -include:_G__cpp_setupG__Graf1 
>>>>>> -include:_G__cpp_setupG__G3D -include:_G__cpp_setupG__GPad 
>>>>>> -include:_G__cpp_setupG__Tree -include:_G__cpp_setupG__Rint 
>>>>>> -include:_G__cpp_setupG__PostScript 
>>>>>> -include:_G__cpp_setupG__Matrix -include:_G__cpp_setupG__Physics 
>>>>>> -include:_G__cpp_setupG__Ged  "C:\root/lib/libCore.lib" 
>>>>>> "C:\root/lib/libCint.lib" "C:\root/lib/libHist.lib" 
>>>>>> "C:\root/lib/libGraf.lib" "C:\root/lib/libGraf3d.lib" 
>>>>>> "C:\root/lib/libGpad.lib" "C:\root/lib/libTree.lib" 
>>>>>> "C:\root/lib/libRint.lib" "C:\root/lib/libPostscript.lib" 
>>>>>> "C:\root/lib/libMatrix.lib" "C:\root/lib/libPhysics.lib" 
>>>>>> "C:\root/lib/libNet.lib" "C:\root/lib/libRIO.lib" 
>>>>>> "C:\root/lib/libMathCore.lib" "C:\root/lib/libGui.lib" 
>>>>>> "C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib" 
>>>>>> "C:\root/lib/libGed.lib" "C:\root/lib/libTreePlayer.lib" 
>>>>>> "C:\root/lib/libTreeViewer.lib" *.obj
>>>>>>  Creating library xps.lib and object xps.exp
>>>>>> ... done
>>>>>> installing DLL
>>>>>> installing R files
>>>>>> installing inst files
>>>>>> preparing package xps for lazy loading
>>>>>> installing man source files
>>>>>> installing indices
>>>>>> Warning messages:
>>>>>> 1: In file.create(f.tg) :
>>>>>> kann Datei 'c:/Programme/R/R-2.8.0/doc/html/packages.html' nicht 
>>>>>> erzeugen. Grund 'Permission denied'
>>>>>> 2: In tools:::win.packages.html(.Library) :
>>>>>> kann HTML Paketindex nicht aktualisieren
>>>>>> installing help
>>>>>>
>>>>>>>>> Building/Updating help pages for package 'xps'
>>>>>>>>>
>>>>>> ...
>>>>>>
>>>>>> To my knowledge I have only made one difference when installing 
>>>>>> everything necessary to build my package:
>>>>>> On my laptop I have installed Rtools27.exe, while on WinXP on my 
>>>>>> Mac I have installed Rtools28.exe.
>>>>>>
>>>>>> Do you know what the reason for the error might be?
>>>>>>
>>>>>> Thank you in advance.
>>>>>> Best regards
>>>>>> Christian
>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
>>>>>> V.i.e.n.n.a           A.u.s.t.r.i.a
>>>>>> e.m.a.i.l:        cstrato at aon.at
>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>
>>>>>> ______________________________________________
>>>>>> R-devel at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>
>>>>>>
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>>
>>>
>>
>


From ggrothendieck at gmail.com  Sat Dec  6 02:58:50 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 5 Dec 2008 20:58:50 -0500
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <49399D16.40908@aon.at>
References: <493985DF.7090303@aon.at>
	<alpine.LFD.2.00.0812052000240.4333@gannet.stats.ox.ac.uk>
	<49398DC9.20600@aon.at> <493992BF.9070407@stats.uwo.ca>
	<493997C1.2080900@aon.at>
	<971536df0812051317o5d9d7e8cn90dc9dc35ded674d@mail.gmail.com>
	<49399D16.40908@aon.at>
Message-ID: <971536df0812051758h607b32cat240a2819e8f41155@mail.gmail.com>

On Fri, Dec 5, 2008 at 4:28 PM, cstrato <cstrato at aon.at> wrote:
> Dear Gabor
>
> Thank you for this interesting link.
>
> Since I have also to set the PATH and LIB for Visual Studio AND for ROOT, I
> am not sure if this would be an option for me.

Rcmd.bat will not override settings you make yourself.   It basically
defines R_HOME, R_MIKTEX and R_TOOLS environment variables by
looking at the registry or using heuristics but in each case it only
sets the environment variable if its not already set.  Then it uses those
to set up an environment for running R.

If you do want to set them yourself but don't want to muck with the
system Rcmd.bat can look into special files where they can be defined.

There is more info on features and limitations on the homepage and
README.


From berwin at maths.uwa.edu.au  Sat Dec  6 06:13:50 2008
From: berwin at maths.uwa.edu.au (Berwin A Turlach)
Date: Sat, 6 Dec 2008 13:13:50 +0800
Subject: [Rd] Warning: missing text for item ... in \describe?
In-Reply-To: <alpine.LFD.2.00.0812051727410.22493@gannet.stats.ox.ac.uk>
References: <493384DA.9060504@pdf.com> <20081201154004.79ef748b@berwin-nus1>
	<alpine.LFD.2.00.0812051527430.15310@gannet.stats.ox.ac.uk>
	<20081206003504.208fbbce@berwin5>
	<alpine.LFD.2.00.0812051727410.22493@gannet.stats.ox.ac.uk>
Message-ID: <20081206131350.2eba98d6@absentia>

G'day Brian,

On Fri, 5 Dec 2008 17:32:58 +0000 (GMT)
Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:

[...]
> > Which platform are we talking here?  I was using linux and "R CMD
> > check fda", using R 2.8.0, on the command line said:
> 
> That writes to a file, and writes to a file are buffered.  Try R CMD 
> INSTALL, where they are not.  We do recommend getting a clean install 
> before R CMD check.

Indeed, forgot about that.  Thanks for reminding me.  With R CMD
INSTALL the messages are right next to the help files with the problems.

> >> This *is* an error: nothing in the description allows whitespace
> >> between arguments to \item (nor \section). It seems that only a few
> >> people misread the documentation (sometimes even after their error
> >> is pointed out to them).
> >
> > But there is also nothing that explicitly forbid such whitespace, is
> > it?  I guess this comes down to the question whether "everything is
> > allowed that is not expressively forbidden" or "everything is
> > forbidden unless it is expressively allowed".  Strangely enough,
> > though I am German, I don't tend to subscribe to the latter
> > philosophy.
> 
> It really doesn't matter: the author of the convertor (not me)
> decidedly to silently ignore arguments after whitespace so you get an
> incorrect conversion. I also added sentences to the documentation
> that say that explicitly.  But if I see documentation that says
> 
> \item{foo}{bar}
> 
> I don't see why anyone would be surprised that
> 
> \item {foo} {bar}
> 
> goes haywire.

Well, I was. :)  And I guess anybody who knows that the TeX parser does
not care about whitespaces between arguments to macros but forgets
that .Rd files are not directly parsed by the TeX parser would have
been surprised too.

Use of whitespace and indentation is pretty much a matter of taste and
personal style to improve readability; and while there are languages
where they matter (Python, makefiles, &c), and some projects (including
R) have style-guides, usually a developer is left with a lot of
flexibility to suit her or his style.  But I guess only Spencer knows
why a whitespace at this place was desirable and/or improved
readability. 
 
Cheers,

	Berwin


From murdoch at stats.uwo.ca  Sat Dec  6 08:35:02 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 06 Dec 2008 02:35:02 -0500
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <49399D16.40908@aon.at>
References: <493985DF.7090303@aon.at>		<alpine.LFD.2.00.0812052000240.4333@gannet.stats.ox.ac.uk>		<49398DC9.20600@aon.at>
	<493992BF.9070407@stats.uwo.ca>		<493997C1.2080900@aon.at>	<971536df0812051317o5d9d7e8cn90dc9dc35ded674d@mail.gmail.com>
	<49399D16.40908@aon.at>
Message-ID: <493A2B26.5070102@stats.uwo.ca>

cstrato wrote:
> Dear Gabor
>
> Thank you for this interesting link.
>
> Since I have also to set the PATH and LIB for Visual Studio AND for 
> ROOT, I am not sure if this would be an option for me.
>   

The strategy I use (which I think Gabor's batch file would support, but 
I do it with my own script) is to have a batch file/script to set the 
path up.  I run it within the command shell, and the changes only last 
for the life of that window, they don't affect shells opened in any 
other way.

If you need to build VS projects and also build R packages in the same 
shell, things would be trickier, because there are conflicts with some 
of the R tools and some Microsoft tools (which was the source of your 
original problem).  It is possible to rename the R tools, and modify the 
MkRules file to point to the new versions; it may also be possible to 
rename the MS tools and reconfigure their build system to accommodate.

Duncan Murdoch
> Best regards
> Christian
>
>
> Gabor Grothendieck wrote:
>   
>> Note that there is an Rcmd.bat batch file in http://batchfiles.googlecode.com
>> which automatically sets all environment variables for you including the
>> PATH making it unnecessary to set your PATH or any environment
>> variables.
>>
>> On Fri, Dec 5, 2008 at 4:06 PM, cstrato <cstrato at aon.at> wrote:
>>   
>>     
>>> Dear Duncan
>>>
>>> Thank you for this explicit explanation, you are right:
>>>
>>> When setting the system variable "Path" (as administrator) in addition to
>>> setting the user variable "PATH" (as user), now everything works fine.
>>>
>>> Interestingly, setting the system variable "Path" on my laptop with Rtools27
>>> seems not to be necessary.
>>>
>>> May I suggest that  this could be clarified in "R Installation and
>>> Administration" since there only the user variable "PATH" is mentioned (as
>>> far as I see).
>>>
>>> Thank you all one more time.
>>> Best regards
>>> Christian
>>>
>>>
>>> Duncan Murdoch wrote:
>>>     
>>>       
>>>> cstrato wrote:
>>>>       
>>>>         
>>>>> Dear all
>>>>>
>>>>> Thank you all for you fast reply.
>>>>>
>>>>> As I said, everything on my laptop and Mac is identical, here are my user
>>>>> defined environment variables:
>>>>>
>>>>> HOME: c:\home\Rabbitus
>>>>> INCLUDE: C:\Programme\Microsoft Visual Studio
>>>>> 9.0\VC\include;C:\Programme\Microsoft SDKs\Windows\v6.0A\Include
>>>>> LIB: C:\Programme\Microsoft Visual Studio
>>>>> 9.0\VC\lib;C:\Programme\Microsoft SDKs\Windows\v6.0A\Lib;C:\root\lib
>>>>> PATH:
>>>>> C:\Rtools\bin;C:\Rtools\perl\bin;C:\Rtools\MinGW\bin;C:\Programme\HTML Help
>>>>> Workshop;C:\Programme\R\R-2.8.0\bin;C:\root\bin;
>>>>> MSVSPATH: C:\Programme\Microsoft Visual Studio 9.0\VC\bin
>>>>> ROOTSYS: c:\root
>>>>> R_LIBS: cd "C:\home\Rabbitus\CRAN"
>>>>> TMPDIR: c:\home\Rabbitus\temp
>>>>>
>>>>>         
>>>>>           
>>>> I think Brian was right, your PATH is not what is shown above.  (That
>>>> doesn't include the Windows directories, for instance.)
>>>>
>>>> Were you running Rcmd INSTALL from a shell?  Which shell?  What does the
>>>> shell report as your PATH just before running it?
>>>> On Windows, the PATH is handled in a fairly complicated way.  I believe
>>>> this description is correct, but it may not apply to all Windows versions:
>>>>
>>>> The thing you set from within the Control Panel only applies to the
>>>> currently running copy of Explorer.  Other applications that are currently
>>>> running (e.g. an existing CMD shell) do not have their path updated.
>>>>
>>>> There are both system and user level PATH settings.  Explorer combines
>>>> them by putting the system settings *first*.
>>>> Within a CMD shell, you can override the PATH completely, just by setting
>>>> it to a new set of directories.
>>>>
>>>> So it looks as though your problem is that your are showing us the user
>>>> settings for the PATH, but not the system settings, and the system settings
>>>> are messing you up.
>>>>
>>>> Duncan Murdoch
>>>>       
>>>>         
>>>>> I have just checked again, all variables are identical on both systems.
>>>>>
>>>>> Could there be another reason?
>>>>> What about the registry setting mentioned by Gabor Grothendieck?
>>>>>
>>>>> Best regaards
>>>>> Christian
>>>>>
>>>>>
>>>>> Prof Brian Ripley wrote:
>>>>>
>>>>>         
>>>>>           
>>>>>> This is a PATH error: you must have Rtools/bin before Windows system
>>>>>> directories in your path.  As the R-admin manual tells you explicitly ....
>>>>>>
>>>>>> fortune("WTFM") applies.
>>>>>>
>>>>>> On Fri, 5 Dec 2008, cstrato wrote:
>>>>>>
>>>>>>
>>>>>>           
>>>>>>             
>>>>>>> Dear all
>>>>>>>
>>>>>>> When trying to install my package on Windows XP on my Mac, I get the
>>>>>>> following error:
>>>>>>>
>>>>>>> ---------- Making package xps ------------
>>>>>>> ...
>>>>>>> ...
>>>>>>> xpsDict.cxx
>>>>>>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll
>>>>>>> /def:xps.def /out:xps.dll fp10.obj  -opt:noref  -nologo
>>>>>>> -include:_G__cpp_setupG__Hist -include:_G__cpp_setupG__Graf1
>>>>>>> -include:_G__cpp_setupG__G3D -include:_G__cpp_setupG__GPad
>>>>>>> -include:_G__cpp_setupG__Tree -include:_G__cpp_setupG__Rint
>>>>>>> -include:_G__cpp_setupG__PostScript -include:_G__cpp_setupG__Matrix
>>>>>>> -include:_G__cpp_setupG__Physics -include:_G__cpp_setupG__Ged
>>>>>>>  "C:\root/lib/libCore.lib" "C:\root/lib/libCint.lib"
>>>>>>> "C:\root/lib/libHist.lib" "C:\root/lib/libGraf.lib"
>>>>>>> "C:\root/lib/libGraf3d.lib" "C:\root/lib/libGpad.lib"
>>>>>>> "C:\root/lib/libTree.lib" "C:\root/lib/libRint.lib"
>>>>>>> "C:\root/lib/libPostscript.lib" "C:\root/lib/libMatrix.lib"
>>>>>>> "C:\root/lib/libPhysics.lib" "C:\root/lib/libNet.lib"
>>>>>>> "C:\root/lib/libRIO.lib" "C:\root/lib/libMathCore.lib"
>>>>>>> "C:\root/lib/libGui.lib" "C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib"
>>>>>>> "C:\root/lib/libGed.lib" "C:\root/lib/libTreePlayer.lib"
>>>>>>> "C:\root/lib/libTreeViewer.lib" *.obj
>>>>>>>  Creating library xps.lib and object xps.exp
>>>>>>> ... done
>>>>>>> installing DLL
>>>>>>> installing R files
>>>>>>> installing inst files
>>>>>>> FIND: Parameterformat falsch
>>>>>>> make[2]: *** [C:/home/Rabbitus/CRAN/xps.Rcheck/xps/inst] Error 2
>>>>>>> make[1]: *** [all] Error 2
>>>>>>> make: *** [pkg-xps] Error 2
>>>>>>> *** Installation of xps failed ***
>>>>>>>
>>>>>>>
>>>>>>> However, when I install my package on my Windows XP laptop, everything
>>>>>>> is ok:
>>>>>>>
>>>>>>> ---------- Making package xps ------------
>>>>>>> ...
>>>>>>> ...
>>>>>>> xpsDict.cxx
>>>>>>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll
>>>>>>> /def:xps.def /out:xps.dll fp10.obj  -opt:noref  -nologo
>>>>>>> -include:_G__cpp_setupG__Hist -include:_G__cpp_setupG__Graf1
>>>>>>> -include:_G__cpp_setupG__G3D -include:_G__cpp_setupG__GPad
>>>>>>> -include:_G__cpp_setupG__Tree -include:_G__cpp_setupG__Rint
>>>>>>> -include:_G__cpp_setupG__PostScript -include:_G__cpp_setupG__Matrix
>>>>>>> -include:_G__cpp_setupG__Physics -include:_G__cpp_setupG__Ged
>>>>>>>  "C:\root/lib/libCore.lib" "C:\root/lib/libCint.lib"
>>>>>>> "C:\root/lib/libHist.lib" "C:\root/lib/libGraf.lib"
>>>>>>> "C:\root/lib/libGraf3d.lib" "C:\root/lib/libGpad.lib"
>>>>>>> "C:\root/lib/libTree.lib" "C:\root/lib/libRint.lib"
>>>>>>> "C:\root/lib/libPostscript.lib" "C:\root/lib/libMatrix.lib"
>>>>>>> "C:\root/lib/libPhysics.lib" "C:\root/lib/libNet.lib"
>>>>>>> "C:\root/lib/libRIO.lib" "C:\root/lib/libMathCore.lib"
>>>>>>> "C:\root/lib/libGui.lib" "C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib"
>>>>>>> "C:\root/lib/libGed.lib" "C:\root/lib/libTreePlayer.lib"
>>>>>>> "C:\root/lib/libTreeViewer.lib" *.obj
>>>>>>>  Creating library xps.lib and object xps.exp
>>>>>>> ... done
>>>>>>> installing DLL
>>>>>>> installing R files
>>>>>>> installing inst files
>>>>>>> preparing package xps for lazy loading
>>>>>>> installing man source files
>>>>>>> installing indices
>>>>>>> Warning messages:
>>>>>>> 1: In file.create(f.tg) :
>>>>>>> kann Datei 'c:/Programme/R/R-2.8.0/doc/html/packages.html' nicht
>>>>>>> erzeugen. Grund 'Permission denied'
>>>>>>> 2: In tools:::win.packages.html(.Library) :
>>>>>>> kann HTML Paketindex nicht aktualisieren
>>>>>>> installing help
>>>>>>>
>>>>>>>             
>>>>>>>               
>>>>>>>>>> Building/Updating help pages for package 'xps'
>>>>>>>>>>
>>>>>>>>>>                   
>>>>>>>>>>                     
>>>>>>> ...
>>>>>>>
>>>>>>> To my knowledge I have only made one difference when installing
>>>>>>> everything necessary to build my package:
>>>>>>> On my laptop I have installed Rtools27.exe, while on WinXP on my Mac I
>>>>>>> have installed Rtools28.exe.
>>>>>>>
>>>>>>> Do you know what the reason for the error might be?
>>>>>>>
>>>>>>> Thank you in advance.
>>>>>>> Best regards
>>>>>>> Christian
>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
>>>>>>> V.i.e.n.n.a           A.u.s.t.r.i.a
>>>>>>> e.m.a.i.l:        cstrato at aon.at
>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>
>>>>>>>
>>>>>>>             
>>>>>>>               
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>>         
>>>>>           
>>>>       
>>>>         
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>     
>>>       
>>
>>     
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From murdoch at stats.uwo.ca  Sat Dec  6 14:08:02 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Sat, 06 Dec 2008 08:08:02 -0500
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <4939A15C.7080900@aon.at>
References: <493985DF.7090303@aon.at>	<alpine.LFD.2.00.0812052000240.4333@gannet.stats.ox.ac.uk>	<49398DC9.20600@aon.at>
	<493992BF.9070407@stats.uwo.ca>	<493997C1.2080900@aon.at>	<alpine.LFD.2.00.0812052132220.7012@gannet.stats.ox.ac.uk>
	<4939A15C.7080900@aon.at>
Message-ID: <493A7932.3030408@stats.uwo.ca>

cstrato wrote:
> Prof Brian Ripley wrote:
>   
>> On Fri, 5 Dec 2008, cstrato wrote:
>>
>>     
>>> Dear Duncan
>>>
>>> Thank you for this explicit explanation, you are right:
>>>
>>> When setting the system variable "Path" (as administrator) in 
>>> addition to setting the user variable "PATH" (as user), now 
>>> everything works fine.
>>>
>>> Interestingly, setting the system variable "Path" on my laptop with 
>>> Rtools27 seems not to be necessary.
>>>
>>> May I suggest that  this could be clarified in "R Installation and 
>>> Administration" since there only the user variable "PATH" is 
>>> mentioned (as far as I see).
>>>       
>> In a shell there is only one PATH, so the manual is correct.
>>     
> I did not say that the manual is not correct, I only suggested to 
> clarify the issue, since when running R CMD INSTALL from the Command 
> Console I need to set also the system variable "Path".
>   

I'd be reluctant to do this, for the same reason Brian was:  the 
documentation is correct.  You need to set the PATH environment variable 
correctly, and that's what we say.  The fact that doing this is 
complicated and confusing on Windows is a problem with the Windows 
design and documentation, not the R documentation, and Microsoft 
certainly has more resources than we do to address it.  What was their 
response when you asked them to improve their documentation? 

Duncan Murdoch

>>> Thank you all one more time.
>>> Best regards
>>> Christian
>>>
>>>
>>> Duncan Murdoch wrote:
>>>       
>>>> cstrato wrote:
>>>>         
>>>>> Dear all
>>>>>
>>>>> Thank you all for you fast reply.
>>>>>
>>>>> As I said, everything on my laptop and Mac is identical, here are 
>>>>> my user defined environment variables:
>>>>>
>>>>> HOME: c:\home\Rabbitus
>>>>> INCLUDE: C:\Programme\Microsoft Visual Studio 
>>>>> 9.0\VC\include;C:\Programme\Microsoft SDKs\Windows\v6.0A\Include
>>>>> LIB: C:\Programme\Microsoft Visual Studio
>>>>> 9.0\VC\lib;C:\Programme\Microsoft SDKs\Windows\v6.0A\Lib;C:\root\lib
>>>>> PATH: 
>>>>> C:\Rtools\bin;C:\Rtools\perl\bin;C:\Rtools\MinGW\bin;C:\Programme\HTML 
>>>>> Help Workshop;C:\Programme\R\R-2.8.0\bin;C:\root\bin;
>>>>> MSVSPATH: C:\Programme\Microsoft Visual Studio 9.0\VC\bin
>>>>> ROOTSYS: c:\root
>>>>> R_LIBS: cd "C:\home\Rabbitus\CRAN"
>>>>> TMPDIR: c:\home\Rabbitus\temp
>>>>>
>>>>>           
>>>> I think Brian was right, your PATH is not what is shown above.  
>>>> (That doesn't include the Windows directories, for instance.)
>>>>
>>>> Were you running Rcmd INSTALL from a shell?  Which shell?  What does 
>>>> the shell report as your PATH just before running it?
>>>> On Windows, the PATH is handled in a fairly complicated way.  I 
>>>> believe this description is correct, but it may not apply to all 
>>>> Windows versions:
>>>>
>>>> The thing you set from within the Control Panel only applies to the 
>>>> currently running copy of Explorer.  Other applications that are 
>>>> currently running (e.g. an existing CMD shell) do not have their 
>>>> path updated.
>>>>
>>>> There are both system and user level PATH settings.  Explorer 
>>>> combines them by putting the system settings *first*.
>>>> Within a CMD shell, you can override the PATH completely, just by 
>>>> setting it to a new set of directories.
>>>>
>>>> So it looks as though your problem is that your are showing us the 
>>>> user settings for the PATH, but not the system settings, and the 
>>>> system settings are messing you up.
>>>>
>>>> Duncan Murdoch
>>>>         
>>>>> I have just checked again, all variables are identical on both 
>>>>> systems.
>>>>>
>>>>> Could there be another reason?
>>>>> What about the registry setting mentioned by Gabor Grothendieck?
>>>>>
>>>>> Best regaards
>>>>> Christian
>>>>>
>>>>>
>>>>> Prof Brian Ripley wrote:
>>>>>
>>>>>           
>>>>>> This is a PATH error: you must have Rtools/bin before Windows 
>>>>>> system directories in your path.  As the R-admin manual tells you 
>>>>>> explicitly ....
>>>>>>
>>>>>> fortune("WTFM") applies.
>>>>>>
>>>>>> On Fri, 5 Dec 2008, cstrato wrote:
>>>>>>
>>>>>>
>>>>>>             
>>>>>>> Dear all
>>>>>>>
>>>>>>> When trying to install my package on Windows XP on my Mac, I get 
>>>>>>> the following error:
>>>>>>>
>>>>>>> ---------- Making package xps ------------
>>>>>>> ...
>>>>>>> ...
>>>>>>> xpsDict.cxx
>>>>>>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll 
>>>>>>> /def:xps.def /out:xps.dll fp10.obj  -opt:noref  -nologo 
>>>>>>> -include:_G__cpp_setupG__Hist -include:_G__cpp_setupG__Graf1 
>>>>>>> -include:_G__cpp_setupG__G3D -include:_G__cpp_setupG__GPad 
>>>>>>> -include:_G__cpp_setupG__Tree -include:_G__cpp_setupG__Rint 
>>>>>>> -include:_G__cpp_setupG__PostScript 
>>>>>>> -include:_G__cpp_setupG__Matrix -include:_G__cpp_setupG__Physics 
>>>>>>> -include:_G__cpp_setupG__Ged  "C:\root/lib/libCore.lib" 
>>>>>>> "C:\root/lib/libCint.lib" "C:\root/lib/libHist.lib" 
>>>>>>> "C:\root/lib/libGraf.lib" "C:\root/lib/libGraf3d.lib" 
>>>>>>> "C:\root/lib/libGpad.lib" "C:\root/lib/libTree.lib" 
>>>>>>> "C:\root/lib/libRint.lib" "C:\root/lib/libPostscript.lib" 
>>>>>>> "C:\root/lib/libMatrix.lib" "C:\root/lib/libPhysics.lib" 
>>>>>>> "C:\root/lib/libNet.lib" "C:\root/lib/libRIO.lib" 
>>>>>>> "C:\root/lib/libMathCore.lib" "C:\root/lib/libGui.lib" 
>>>>>>> "C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib" 
>>>>>>> "C:\root/lib/libGed.lib" "C:\root/lib/libTreePlayer.lib" 
>>>>>>> "C:\root/lib/libTreeViewer.lib" *.obj
>>>>>>>  Creating library xps.lib and object xps.exp
>>>>>>> ... done
>>>>>>> installing DLL
>>>>>>> installing R files
>>>>>>> installing inst files
>>>>>>> FIND: Parameterformat falsch
>>>>>>> make[2]: *** [C:/home/Rabbitus/CRAN/xps.Rcheck/xps/inst] Error 2
>>>>>>> make[1]: *** [all] Error 2
>>>>>>> make: *** [pkg-xps] Error 2
>>>>>>> *** Installation of xps failed ***
>>>>>>>
>>>>>>>
>>>>>>> However, when I install my package on my Windows XP laptop, 
>>>>>>> everything is ok:
>>>>>>>
>>>>>>> ---------- Making package xps ------------
>>>>>>> ...
>>>>>>> ...
>>>>>>> xpsDict.cxx
>>>>>>> "C:\Programme\Microsoft Visual Studio 9.0\VC\bin/link" /dll 
>>>>>>> /def:xps.def /out:xps.dll fp10.obj  -opt:noref  -nologo 
>>>>>>> -include:_G__cpp_setupG__Hist -include:_G__cpp_setupG__Graf1 
>>>>>>> -include:_G__cpp_setupG__G3D -include:_G__cpp_setupG__GPad 
>>>>>>> -include:_G__cpp_setupG__Tree -include:_G__cpp_setupG__Rint 
>>>>>>> -include:_G__cpp_setupG__PostScript 
>>>>>>> -include:_G__cpp_setupG__Matrix -include:_G__cpp_setupG__Physics 
>>>>>>> -include:_G__cpp_setupG__Ged  "C:\root/lib/libCore.lib" 
>>>>>>> "C:\root/lib/libCint.lib" "C:\root/lib/libHist.lib" 
>>>>>>> "C:\root/lib/libGraf.lib" "C:\root/lib/libGraf3d.lib" 
>>>>>>> "C:\root/lib/libGpad.lib" "C:\root/lib/libTree.lib" 
>>>>>>> "C:\root/lib/libRint.lib" "C:\root/lib/libPostscript.lib" 
>>>>>>> "C:\root/lib/libMatrix.lib" "C:\root/lib/libPhysics.lib" 
>>>>>>> "C:\root/lib/libNet.lib" "C:\root/lib/libRIO.lib" 
>>>>>>> "C:\root/lib/libMathCore.lib" "C:\root/lib/libGui.lib" 
>>>>>>> "C:\root/lib/libGraf.lib" "C:\root/lib/libGpad.lib" 
>>>>>>> "C:\root/lib/libGed.lib" "C:\root/lib/libTreePlayer.lib" 
>>>>>>> "C:\root/lib/libTreeViewer.lib" *.obj
>>>>>>>  Creating library xps.lib and object xps.exp
>>>>>>> ... done
>>>>>>> installing DLL
>>>>>>> installing R files
>>>>>>> installing inst files
>>>>>>> preparing package xps for lazy loading
>>>>>>> installing man source files
>>>>>>> installing indices
>>>>>>> Warning messages:
>>>>>>> 1: In file.create(f.tg) :
>>>>>>> kann Datei 'c:/Programme/R/R-2.8.0/doc/html/packages.html' nicht 
>>>>>>> erzeugen. Grund 'Permission denied'
>>>>>>> 2: In tools:::win.packages.html(.Library) :
>>>>>>> kann HTML Paketindex nicht aktualisieren
>>>>>>> installing help
>>>>>>>
>>>>>>>               
>>>>>>>>>> Building/Updating help pages for package 'xps'
>>>>>>>>>>
>>>>>>>>>>                     
>>>>>>> ...
>>>>>>>
>>>>>>> To my knowledge I have only made one difference when installing 
>>>>>>> everything necessary to build my package:
>>>>>>> On my laptop I have installed Rtools27.exe, while on WinXP on my 
>>>>>>> Mac I have installed Rtools28.exe.
>>>>>>>
>>>>>>> Do you know what the reason for the error might be?
>>>>>>>
>>>>>>> Thank you in advance.
>>>>>>> Best regards
>>>>>>> Christian
>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
>>>>>>> V.i.e.n.n.a           A.u.s.t.r.i.a
>>>>>>> e.m.a.i.l:        cstrato at aon.at
>>>>>>> _._._._._._._._._._._._._._._._._._
>>>>>>>
>>>>>>> ______________________________________________
>>>>>>> R-devel at r-project.org mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>>>
>>>>>>>
>>>>>>>               
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>>           
>>>>
>>>>         
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ggrothendieck at gmail.com  Sat Dec  6 14:14:27 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat, 6 Dec 2008 08:14:27 -0500
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <493A7932.3030408@stats.uwo.ca>
References: <493985DF.7090303@aon.at>
	<alpine.LFD.2.00.0812052000240.4333@gannet.stats.ox.ac.uk>
	<49398DC9.20600@aon.at> <493992BF.9070407@stats.uwo.ca>
	<493997C1.2080900@aon.at>
	<alpine.LFD.2.00.0812052132220.7012@gannet.stats.ox.ac.uk>
	<4939A15C.7080900@aon.at> <493A7932.3030408@stats.uwo.ca>
Message-ID: <971536df0812060514r2b2e6e5bi828bab85b786e8a8@mail.gmail.com>

On Sat, Dec 6, 2008 at 8:08 AM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> cstrato wrote:
>>
>> Prof Brian Ripley wrote:
>>
>>>
>>> On Fri, 5 Dec 2008, cstrato wrote:
>>>
>>>
>>>>
>>>> Dear Duncan
>>>>
>>>> Thank you for this explicit explanation, you are right:
>>>>
>>>> When setting the system variable "Path" (as administrator) in addition
>>>> to setting the user variable "PATH" (as user), now everything works fine.
>>>>
>>>> Interestingly, setting the system variable "Path" on my laptop with
>>>> Rtools27 seems not to be necessary.
>>>>
>>>> May I suggest that  this could be clarified in "R Installation and
>>>> Administration" since there only the user variable "PATH" is mentioned (as
>>>> far as I see).
>>>>
>>>
>>> In a shell there is only one PATH, so the manual is correct.
>>>
>>
>> I did not say that the manual is not correct, I only suggested to clarify
>> the issue, since when running R CMD INSTALL from the Command Console I need
>> to set also the system variable "Path".
>>
>
> I'd be reluctant to do this, for the same reason Brian was:  the
> documentation is correct.  You need to set the PATH environment variable
> correctly, and that's what we say.  The fact that doing this is complicated
> and confusing on Windows is a problem with the Windows design and
> documentation, not the R documentation, and Microsoft certainly has more
> resources than we do to address it.  What was their response when you asked
> them to improve their documentation?
> Duncan Murdoch
>

The http://batchfiles.googlecode.com home page does give some tips for setting
paths just in case.  Of course if you are using the batchfiles you
won't have to set
any paths in the first place.


From cstrato at aon.at  Sat Dec  6 15:41:12 2008
From: cstrato at aon.at (cstrato)
Date: Sat, 06 Dec 2008 15:41:12 +0100
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <971536df0812060514r2b2e6e5bi828bab85b786e8a8@mail.gmail.com>
References: <493985DF.7090303@aon.at>	
	<alpine.LFD.2.00.0812052000240.4333@gannet.stats.ox.ac.uk>	
	<49398DC9.20600@aon.at> <493992BF.9070407@stats.uwo.ca>	
	<493997C1.2080900@aon.at>	
	<alpine.LFD.2.00.0812052132220.7012@gannet.stats.ox.ac.uk>	
	<4939A15C.7080900@aon.at> <493A7932.3030408@stats.uwo.ca>
	<971536df0812060514r2b2e6e5bi828bab85b786e8a8@mail.gmail.com>
Message-ID: <493A8F08.5010603@aon.at>

Dear Duncan, dear Gabor,

Thank you for this additional information and all these great tips.

Setting the system path in the following way solved my problem:
c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;c:\Programme\Microsoft 
SQL Server\90\Tools\binn\

Luckily this solves also the problem with potential conflicts between R 
tools, Microsoft tools and ROOT, so that I do not have to rename any 
tools (which I would be reluctant to do).

Since at the moment everything seems to work fine, and I am no Windows 
expert (I do all my development on my Mac), I will keep the current 
setting, however, the next time I have to set up everything, I will try 
to take advantage of Rcmd.bat since Gabor mentions that it will not 
override any of my settings.

Regarding the R installation documentation, I understand now that this 
seems to be a problem of my complicated setup and not a general problem, 
so adding this information may confuse other people.

Best regards
Christian


Gabor Grothendieck wrote:
> On Sat, Dec 6, 2008 at 8:08 AM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>   
>> cstrato wrote:
>>     
>>> Prof Brian Ripley wrote:
>>>
>>>       
>>>> On Fri, 5 Dec 2008, cstrato wrote:
>>>>
>>>>
>>>>         
>>>>> Dear Duncan
>>>>>
>>>>> Thank you for this explicit explanation, you are right:
>>>>>
>>>>> When setting the system variable "Path" (as administrator) in addition
>>>>> to setting the user variable "PATH" (as user), now everything works fine.
>>>>>
>>>>> Interestingly, setting the system variable "Path" on my laptop with
>>>>> Rtools27 seems not to be necessary.
>>>>>
>>>>> May I suggest that  this could be clarified in "R Installation and
>>>>> Administration" since there only the user variable "PATH" is mentioned (as
>>>>> far as I see).
>>>>>
>>>>>           
>>>> In a shell there is only one PATH, so the manual is correct.
>>>>
>>>>         
>>> I did not say that the manual is not correct, I only suggested to clarify
>>> the issue, since when running R CMD INSTALL from the Command Console I need
>>> to set also the system variable "Path".
>>>
>>>       
>> I'd be reluctant to do this, for the same reason Brian was:  the
>> documentation is correct.  You need to set the PATH environment variable
>> correctly, and that's what we say.  The fact that doing this is complicated
>> and confusing on Windows is a problem with the Windows design and
>> documentation, not the R documentation, and Microsoft certainly has more
>> resources than we do to address it.  What was their response when you asked
>> them to improve their documentation?
>> Duncan Murdoch
>>
>>     
>
> The http://batchfiles.googlecode.com home page does give some tips for setting
> paths just in case.  Of course if you are using the batchfiles you
> won't have to set
> any paths in the first place.
>
>
>


From edd at debian.org  Sat Dec  6 15:43:00 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 6 Dec 2008 08:43:00 -0600
Subject: [Rd] R 2.8.1 ?
Message-ID: <18746.36724.97066.872813@ron.nulle.part>


Duncan's 'R changes' feed at 

	http://developer.r-project.org/blosxom.cgi/R-devel 

showed a steady flow of bugfixes and patches in 2.8.0 yet 

	http://developer.r-project.org/

is silent on the topic.  Is there any expectation of a point release before
2.9.0 rolls around in April?

Cheers, Dirk

-- 
Three out of two people have difficulties with fractions.


From ripley at stats.ox.ac.uk  Sat Dec  6 15:54:06 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 6 Dec 2008 14:54:06 +0000 (GMT)
Subject: [Rd] R 2.8.1 ?
In-Reply-To: <18746.36724.97066.872813@ron.nulle.part>
References: <18746.36724.97066.872813@ron.nulle.part>
Message-ID: <alpine.LFD.2.00.0812061449570.24398@gannet.stats.ox.ac.uk>

The current plan is for 2.8.1 on Dec 22nd: I don't think that is final as 
yet but will need to become so shortly.

On Sat, 6 Dec 2008, Dirk Eddelbuettel wrote:

> Duncan's 'R changes' feed at
>
> 	http://developer.r-project.org/blosxom.cgi/R-devel
>
> showed a steady flow of bugfixes and patches in 2.8.0 yet
>
> 	http://developer.r-project.org/
>
> is silent on the topic.  Is there any expectation of a point release before
> 2.9.0 rolls around in April?
>
> Cheers, Dirk

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ggrothendieck at gmail.com  Sat Dec  6 15:59:19 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat, 6 Dec 2008 09:59:19 -0500
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <493A8F08.5010603@aon.at>
References: <493985DF.7090303@aon.at>
	<alpine.LFD.2.00.0812052000240.4333@gannet.stats.ox.ac.uk>
	<49398DC9.20600@aon.at> <493992BF.9070407@stats.uwo.ca>
	<493997C1.2080900@aon.at>
	<alpine.LFD.2.00.0812052132220.7012@gannet.stats.ox.ac.uk>
	<4939A15C.7080900@aon.at> <493A7932.3030408@stats.uwo.ca>
	<971536df0812060514r2b2e6e5bi828bab85b786e8a8@mail.gmail.com>
	<493A8F08.5010603@aon.at>
Message-ID: <971536df0812060659w5a40970el855e7eaa50cb3de5@mail.gmail.com>

You could leave your path at:

%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;c:\Programme\Microsoft
SQL Server\90\Tools\binn\

and then use Rcmd.bat or rtools.bat to add the rest.

Also there are still two problems:

1. one of the dangers of your setup is that
Rtools has a conflict with Windows since it
has its own find which takes over from Windows' find
and can cause Windows batch files not related to R to fail.
As a result its not a good idea to permanently set your
path to include the rtools but better to do it session
by session so that non-R sessions are unaffected.

2. Also you still don't seem to have MiKTeX on your path
so I don't think its correct yet.  Rcmd.bat or rtools.bat
would add the path to MiKTeX too (if you have it in a
standard location).

On Sat, Dec 6, 2008 at 9:41 AM, cstrato <cstrato at aon.at> wrote:
> Dear Duncan, dear Gabor,
>
> Thank you for this additional information and all these great tips.
>
> Setting the system path in the following way solved my problem:
> c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;c:\Programme\Microsoft
> SQL Server\90\Tools\binn\
>
> Luckily this solves also the problem with potential conflicts between R
> tools, Microsoft tools and ROOT, so that I do not have to rename any tools
> (which I would be reluctant to do).
>
> Since at the moment everything seems to work fine, and I am no Windows
> expert (I do all my development on my Mac), I will keep the current setting,
> however, the next time I have to set up everything, I will try to take
> advantage of Rcmd.bat since Gabor mentions that it will not override any of
> my settings.
>
> Regarding the R installation documentation, I understand now that this seems
> to be a problem of my complicated setup and not a general problem, so adding
> this information may confuse other people.
>
> Best regards
> Christian
>
>
> Gabor Grothendieck wrote:
>>
>> On Sat, Dec 6, 2008 at 8:08 AM, Duncan Murdoch <murdoch at stats.uwo.ca>
>> wrote:
>>
>>>
>>> cstrato wrote:
>>>
>>>>
>>>> Prof Brian Ripley wrote:
>>>>
>>>>
>>>>>
>>>>> On Fri, 5 Dec 2008, cstrato wrote:
>>>>>
>>>>>
>>>>>
>>>>>>
>>>>>> Dear Duncan
>>>>>>
>>>>>> Thank you for this explicit explanation, you are right:
>>>>>>
>>>>>> When setting the system variable "Path" (as administrator) in addition
>>>>>> to setting the user variable "PATH" (as user), now everything works
>>>>>> fine.
>>>>>>
>>>>>> Interestingly, setting the system variable "Path" on my laptop with
>>>>>> Rtools27 seems not to be necessary.
>>>>>>
>>>>>> May I suggest that  this could be clarified in "R Installation and
>>>>>> Administration" since there only the user variable "PATH" is mentioned
>>>>>> (as
>>>>>> far as I see).
>>>>>>
>>>>>>
>>>>>
>>>>> In a shell there is only one PATH, so the manual is correct.
>>>>>
>>>>>
>>>>
>>>> I did not say that the manual is not correct, I only suggested to
>>>> clarify
>>>> the issue, since when running R CMD INSTALL from the Command Console I
>>>> need
>>>> to set also the system variable "Path".
>>>>
>>>>
>>>
>>> I'd be reluctant to do this, for the same reason Brian was:  the
>>> documentation is correct.  You need to set the PATH environment variable
>>> correctly, and that's what we say.  The fact that doing this is
>>> complicated
>>> and confusing on Windows is a problem with the Windows design and
>>> documentation, not the R documentation, and Microsoft certainly has more
>>> resources than we do to address it.  What was their response when you
>>> asked
>>> them to improve their documentation?
>>> Duncan Murdoch
>>>
>>>
>>
>> The http://batchfiles.googlecode.com home page does give some tips for
>> setting
>> paths just in case.  Of course if you are using the batchfiles you
>> won't have to set
>> any paths in the first place.
>>
>>
>>
>
>


From ripley at stats.ox.ac.uk  Sat Dec  6 16:36:01 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 6 Dec 2008 15:36:01 +0000 (GMT)
Subject: [Rd] Warning: missing text for item ... in \describe?
In-Reply-To: <20081206131350.2eba98d6@absentia>
References: <493384DA.9060504@pdf.com> <20081201154004.79ef748b@berwin-nus1>
	<alpine.LFD.2.00.0812051527430.15310@gannet.stats.ox.ac.uk>
	<20081206003504.208fbbce@berwin5>
	<alpine.LFD.2.00.0812051727410.22493@gannet.stats.ox.ac.uk>
	<20081206131350.2eba98d6@absentia>
Message-ID: <alpine.LFD.2.00.0812060710380.15789@gannet.stats.ox.ac.uk>

1) Having run tests on CRAN and BioC overnight, the results are quite 
depressing.  There are 112 packages on CRAN and a score on BioC with 
incorrectly rendered help pages because of spaces after \item{foo}.  In 
two cases (fields and MANOR) the text skipped is invalid, so it is not 
simply a case of ignoring the whitespace.


2) On the original subject line, I found a different reason.  E.g. I get 
the message on distrMod, which has (sqrt-methods.Rd, also 
solve-methods.Rd)

\section{Methods}{\describe{
\item{sqrt}{\code{signature(x = "PosSemDefSymmMatrix")}: produces a 
symmetric, p.s.d. matrix \eqn{y} such that  \eqn{x = y^2}}
}}

That is rendered incorrectly, and the issue is that \eqn is a one- or 
two-argument macro and the trailing } confuses the Rdconv code.  That is 
an Rdconv bug which is proving very tricky to fix.  In any case a fix will 
only apply to future versions of R, so the packages affected (at least 
distr, geepack, geoR, psychometric, robustbase, uroot) need to be altered.

Note that grammatical help files will almost always have punctation at the 
end of an item (even a space will do), and all the examples appropriate 
punctuation is missing.


On Sat, 6 Dec 2008, Berwin A Turlach wrote:

> G'day Brian,
>
> On Fri, 5 Dec 2008 17:32:58 +0000 (GMT)
> Prof Brian Ripley <ripley at stats.ox.ac.uk> wrote:
>
> [...]
>>> Which platform are we talking here?  I was using linux and "R CMD
>>> check fda", using R 2.8.0, on the command line said:
>>
>> That writes to a file, and writes to a file are buffered.  Try R CMD
>> INSTALL, where they are not.  We do recommend getting a clean install
>> before R CMD check.
>
> Indeed, forgot about that.  Thanks for reminding me.  With R CMD
> INSTALL the messages are right next to the help files with the problems.
>
>>>> This *is* an error: nothing in the description allows whitespace
>>>> between arguments to \item (nor \section). It seems that only a few
>>>> people misread the documentation (sometimes even after their error
>>>> is pointed out to them).
>>>
>>> But there is also nothing that explicitly forbid such whitespace, is
>>> it?  I guess this comes down to the question whether "everything is
>>> allowed that is not expressively forbidden" or "everything is
>>> forbidden unless it is expressively allowed".  Strangely enough,
>>> though I am German, I don't tend to subscribe to the latter
>>> philosophy.
>>
>> It really doesn't matter: the author of the convertor (not me)
>> decidedly to silently ignore arguments after whitespace so you get an
>> incorrect conversion. I also added sentences to the documentation
>> that say that explicitly.  But if I see documentation that says
>>
>> \item{foo}{bar}
>>
>> I don't see why anyone would be surprised that
>>
>> \item {foo} {bar}
>>
>> goes haywire.
>
> Well, I was. :)  And I guess anybody who knows that the TeX parser does
> not care about whitespaces between arguments to macros but forgets
> that .Rd files are not directly parsed by the TeX parser would have
> been surprised too.
>
> Use of whitespace and indentation is pretty much a matter of taste and
> personal style to improve readability; and while there are languages
> where they matter (Python, makefiles, &c), and some projects (including
> R) have style-guides, usually a developer is left with a lot of
> flexibility to suit her or his style.  But I guess only Spencer knows
> why a whitespace at this place was desirable and/or improved
> readability.
>
> Cheers,
>
> 	Berwin
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From cstrato at aon.at  Sat Dec  6 19:08:20 2008
From: cstrato at aon.at (cstrato)
Date: Sat, 06 Dec 2008 19:08:20 +0100
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <971536df0812060659w5a40970el855e7eaa50cb3de5@mail.gmail.com>
References: <493985DF.7090303@aon.at>	
	<alpine.LFD.2.00.0812052000240.4333@gannet.stats.ox.ac.uk>	
	<49398DC9.20600@aon.at> <493992BF.9070407@stats.uwo.ca>	
	<493997C1.2080900@aon.at>	
	<alpine.LFD.2.00.0812052132220.7012@gannet.stats.ox.ac.uk>	
	<4939A15C.7080900@aon.at> <493A7932.3030408@stats.uwo.ca>	
	<971536df0812060514r2b2e6e5bi828bab85b786e8a8@mail.gmail.com>	
	<493A8F08.5010603@aon.at>
	<971536df0812060659w5a40970el855e7eaa50cb3de5@mail.gmail.com>
Message-ID: <493ABF94.4020500@aon.at>

Dear Gabor,

Sorry, my mistake, here are my correct path settings:

System Path:
C:\Rtools\bin;C:\Rtools\perl\bin;C:\Rtools\MinGW\bin;C:\Programme\MiKTeX 
2.7\miktex\bin;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem

User PATH:
C:\Rtools\bin;C:\Rtools\perl\bin;C:\Rtools\MinGW\bin;C:\Programme\HTML 
Help Workshop;C:\Programme\R\R-2.8.0\bin;C:\root\bin;

I have just tested again that:
- R CMD check is ok and produces the vignettes
- I can compile my C++ source code with VC++ independently of R

Thus at the moment there seem to be no conflicts, however, this could be 
the case in the future.
Do you have any examples, where the Rtools find can cause conflicts with 
Windows?

Best regards
Christian


Gabor Grothendieck wrote:
> You could leave your path at:
>
> %SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;c:\Programme\Microsoft
> SQL Server\90\Tools\binn\
>
> and then use Rcmd.bat or rtools.bat to add the rest.
>
> Also there are still two problems:
>
> 1. one of the dangers of your setup is that
> Rtools has a conflict with Windows since it
> has its own find which takes over from Windows' find
> and can cause Windows batch files not related to R to fail.
> As a result its not a good idea to permanently set your
> path to include the rtools but better to do it session
> by session so that non-R sessions are unaffected.
>
> 2. Also you still don't seem to have MiKTeX on your path
> so I don't think its correct yet.  Rcmd.bat or rtools.bat
> would add the path to MiKTeX too (if you have it in a
> standard location).
>
> On Sat, Dec 6, 2008 at 9:41 AM, cstrato <cstrato at aon.at> wrote:
>   
>> Dear Duncan, dear Gabor,
>>
>> Thank you for this additional information and all these great tips.
>>
>> Setting the system path in the following way solved my problem:
>> c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;c:\Programme\Microsoft
>> SQL Server\90\Tools\binn\
>>
>> Luckily this solves also the problem with potential conflicts between R
>> tools, Microsoft tools and ROOT, so that I do not have to rename any tools
>> (which I would be reluctant to do).
>>
>> Since at the moment everything seems to work fine, and I am no Windows
>> expert (I do all my development on my Mac), I will keep the current setting,
>> however, the next time I have to set up everything, I will try to take
>> advantage of Rcmd.bat since Gabor mentions that it will not override any of
>> my settings.
>>
>> Regarding the R installation documentation, I understand now that this seems
>> to be a problem of my complicated setup and not a general problem, so adding
>> this information may confuse other people.
>>
>> Best regards
>> Christian
>>
>>
>> Gabor Grothendieck wrote:
>>     
>>> On Sat, Dec 6, 2008 at 8:08 AM, Duncan Murdoch <murdoch at stats.uwo.ca>
>>> wrote:
>>>
>>>       
>>>> cstrato wrote:
>>>>
>>>>         
>>>>> Prof Brian Ripley wrote:
>>>>>
>>>>>
>>>>>           
>>>>>> On Fri, 5 Dec 2008, cstrato wrote:
>>>>>>
>>>>>>
>>>>>>
>>>>>>             
>>>>>>> Dear Duncan
>>>>>>>
>>>>>>> Thank you for this explicit explanation, you are right:
>>>>>>>
>>>>>>> When setting the system variable "Path" (as administrator) in addition
>>>>>>> to setting the user variable "PATH" (as user), now everything works
>>>>>>> fine.
>>>>>>>
>>>>>>> Interestingly, setting the system variable "Path" on my laptop with
>>>>>>> Rtools27 seems not to be necessary.
>>>>>>>
>>>>>>> May I suggest that  this could be clarified in "R Installation and
>>>>>>> Administration" since there only the user variable "PATH" is mentioned
>>>>>>> (as
>>>>>>> far as I see).
>>>>>>>
>>>>>>>
>>>>>>>               
>>>>>> In a shell there is only one PATH, so the manual is correct.
>>>>>>
>>>>>>
>>>>>>             
>>>>> I did not say that the manual is not correct, I only suggested to
>>>>> clarify
>>>>> the issue, since when running R CMD INSTALL from the Command Console I
>>>>> need
>>>>> to set also the system variable "Path".
>>>>>
>>>>>
>>>>>           
>>>> I'd be reluctant to do this, for the same reason Brian was:  the
>>>> documentation is correct.  You need to set the PATH environment variable
>>>> correctly, and that's what we say.  The fact that doing this is
>>>> complicated
>>>> and confusing on Windows is a problem with the Windows design and
>>>> documentation, not the R documentation, and Microsoft certainly has more
>>>> resources than we do to address it.  What was their response when you
>>>> asked
>>>> them to improve their documentation?
>>>> Duncan Murdoch
>>>>
>>>>
>>>>         
>>> The http://batchfiles.googlecode.com home page does give some tips for
>>> setting
>>> paths just in case.  Of course if you are using the batchfiles you
>>> won't have to set
>>> any paths in the first place.
>>>
>>>
>>>
>>>       
>>     
>
>
>


From ggrothendieck at gmail.com  Sun Dec  7 04:51:12 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat, 6 Dec 2008 22:51:12 -0500
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <493ABF94.4020500@aon.at>
References: <493985DF.7090303@aon.at> <493992BF.9070407@stats.uwo.ca>
	<493997C1.2080900@aon.at>
	<alpine.LFD.2.00.0812052132220.7012@gannet.stats.ox.ac.uk>
	<4939A15C.7080900@aon.at> <493A7932.3030408@stats.uwo.ca>
	<971536df0812060514r2b2e6e5bi828bab85b786e8a8@mail.gmail.com>
	<493A8F08.5010603@aon.at>
	<971536df0812060659w5a40970el855e7eaa50cb3de5@mail.gmail.com>
	<493ABF94.4020500@aon.at>
Message-ID: <971536df0812061951g131ede5bk336ca42fb76f978e@mail.gmail.com>

Any Windows batch script that uses the Windows find command.

On Sat, Dec 6, 2008 at 1:08 PM, cstrato <cstrato at aon.at> wrote:
> Dear Gabor,
>
> Sorry, my mistake, here are my correct path settings:
>
> System Path:
> C:\Rtools\bin;C:\Rtools\perl\bin;C:\Rtools\MinGW\bin;C:\Programme\MiKTeX
> 2.7\miktex\bin;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem
>
> User PATH:
> C:\Rtools\bin;C:\Rtools\perl\bin;C:\Rtools\MinGW\bin;C:\Programme\HTML Help
> Workshop;C:\Programme\R\R-2.8.0\bin;C:\root\bin;
>
> I have just tested again that:
> - R CMD check is ok and produces the vignettes
> - I can compile my C++ source code with VC++ independently of R
>
> Thus at the moment there seem to be no conflicts, however, this could be the
> case in the future.
> Do you have any examples, where the Rtools find can cause conflicts with
> Windows?
>
> Best regards
> Christian
>
>
> Gabor Grothendieck wrote:
>>
>> You could leave your path at:
>>
>>
>> %SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;c:\Programme\Microsoft
>> SQL Server\90\Tools\binn\
>>
>> and then use Rcmd.bat or rtools.bat to add the rest.
>>
>> Also there are still two problems:
>>
>> 1. one of the dangers of your setup is that
>> Rtools has a conflict with Windows since it
>> has its own find which takes over from Windows' find
>> and can cause Windows batch files not related to R to fail.
>> As a result its not a good idea to permanently set your
>> path to include the rtools but better to do it session
>> by session so that non-R sessions are unaffected.
>>
>> 2. Also you still don't seem to have MiKTeX on your path
>> so I don't think its correct yet.  Rcmd.bat or rtools.bat
>> would add the path to MiKTeX too (if you have it in a
>> standard location).
>>
>> On Sat, Dec 6, 2008 at 9:41 AM, cstrato <cstrato at aon.at> wrote:
>>
>>>
>>> Dear Duncan, dear Gabor,
>>>
>>> Thank you for this additional information and all these great tips.
>>>
>>> Setting the system path in the following way solved my problem:
>>>
>>> c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;c:\Programme\Microsoft
>>> SQL Server\90\Tools\binn\
>>>
>>> Luckily this solves also the problem with potential conflicts between R
>>> tools, Microsoft tools and ROOT, so that I do not have to rename any
>>> tools
>>> (which I would be reluctant to do).
>>>
>>> Since at the moment everything seems to work fine, and I am no Windows
>>> expert (I do all my development on my Mac), I will keep the current
>>> setting,
>>> however, the next time I have to set up everything, I will try to take
>>> advantage of Rcmd.bat since Gabor mentions that it will not override any
>>> of
>>> my settings.
>>>
>>> Regarding the R installation documentation, I understand now that this
>>> seems
>>> to be a problem of my complicated setup and not a general problem, so
>>> adding
>>> this information may confuse other people.
>>>
>>> Best regards
>>> Christian
>>>
>>>
>>> Gabor Grothendieck wrote:
>>>
>>>>
>>>> On Sat, Dec 6, 2008 at 8:08 AM, Duncan Murdoch <murdoch at stats.uwo.ca>
>>>> wrote:
>>>>
>>>>
>>>>>
>>>>> cstrato wrote:
>>>>>
>>>>>
>>>>>>
>>>>>> Prof Brian Ripley wrote:
>>>>>>
>>>>>>
>>>>>>
>>>>>>>
>>>>>>> On Fri, 5 Dec 2008, cstrato wrote:
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>>
>>>>>>>> Dear Duncan
>>>>>>>>
>>>>>>>> Thank you for this explicit explanation, you are right:
>>>>>>>>
>>>>>>>> When setting the system variable "Path" (as administrator) in
>>>>>>>> addition
>>>>>>>> to setting the user variable "PATH" (as user), now everything works
>>>>>>>> fine.
>>>>>>>>
>>>>>>>> Interestingly, setting the system variable "Path" on my laptop with
>>>>>>>> Rtools27 seems not to be necessary.
>>>>>>>>
>>>>>>>> May I suggest that  this could be clarified in "R Installation and
>>>>>>>> Administration" since there only the user variable "PATH" is
>>>>>>>> mentioned
>>>>>>>> (as
>>>>>>>> far as I see).
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>
>>>>>>> In a shell there is only one PATH, so the manual is correct.
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>
>>>>>> I did not say that the manual is not correct, I only suggested to
>>>>>> clarify
>>>>>> the issue, since when running R CMD INSTALL from the Command Console I
>>>>>> need
>>>>>> to set also the system variable "Path".
>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>> I'd be reluctant to do this, for the same reason Brian was:  the
>>>>> documentation is correct.  You need to set the PATH environment
>>>>> variable
>>>>> correctly, and that's what we say.  The fact that doing this is
>>>>> complicated
>>>>> and confusing on Windows is a problem with the Windows design and
>>>>> documentation, not the R documentation, and Microsoft certainly has
>>>>> more
>>>>> resources than we do to address it.  What was their response when you
>>>>> asked
>>>>> them to improve their documentation?
>>>>> Duncan Murdoch
>>>>>
>>>>>
>>>>>
>>>>
>>>> The http://batchfiles.googlecode.com home page does give some tips for
>>>> setting
>>>> paths just in case.  Of course if you are using the batchfiles you
>>>> won't have to set
>>>> any paths in the first place.
>>>>
>>>>
>>>>
>>>>
>>>
>>>
>>
>>
>>
>
>


From cstrato at aon.at  Sun Dec  7 11:48:11 2008
From: cstrato at aon.at (cstrato)
Date: Sun, 07 Dec 2008 11:48:11 +0100
Subject: [Rd] Error in R CMD INSTALL on Windows XP using Rtools28
In-Reply-To: <971536df0812061951g131ede5bk336ca42fb76f978e@mail.gmail.com>
References: <493985DF.7090303@aon.at> <493992BF.9070407@stats.uwo.ca>	
	<493997C1.2080900@aon.at>	
	<alpine.LFD.2.00.0812052132220.7012@gannet.stats.ox.ac.uk>	
	<4939A15C.7080900@aon.at> <493A7932.3030408@stats.uwo.ca>	
	<971536df0812060514r2b2e6e5bi828bab85b786e8a8@mail.gmail.com>	
	<493A8F08.5010603@aon.at>	
	<971536df0812060659w5a40970el855e7eaa50cb3de5@mail.gmail.com>	
	<493ABF94.4020500@aon.at>
	<971536df0812061951g131ede5bk336ca42fb76f978e@mail.gmail.com>
Message-ID: <493BA9EB.8020106@aon.at>

I understand, thank you, Christian

Gabor Grothendieck wrote:
> Any Windows batch script that uses the Windows find command.
>
> On Sat, Dec 6, 2008 at 1:08 PM, cstrato <cstrato at aon.at> wrote:
>   
>> Dear Gabor,
>>
>> Sorry, my mistake, here are my correct path settings:
>>
>> System Path:
>> C:\Rtools\bin;C:\Rtools\perl\bin;C:\Rtools\MinGW\bin;C:\Programme\MiKTeX
>> 2.7\miktex\bin;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem
>>
>> User PATH:
>> C:\Rtools\bin;C:\Rtools\perl\bin;C:\Rtools\MinGW\bin;C:\Programme\HTML Help
>> Workshop;C:\Programme\R\R-2.8.0\bin;C:\root\bin;
>>
>> I have just tested again that:
>> - R CMD check is ok and produces the vignettes
>> - I can compile my C++ source code with VC++ independently of R
>>
>> Thus at the moment there seem to be no conflicts, however, this could be the
>> case in the future.
>> Do you have any examples, where the Rtools find can cause conflicts with
>> Windows?
>>
>> Best regards
>> Christian
>>
>>
>> Gabor Grothendieck wrote:
>>     
>>> You could leave your path at:
>>>
>>>
>>> %SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;c:\Programme\Microsoft
>>> SQL Server\90\Tools\binn\
>>>
>>> and then use Rcmd.bat or rtools.bat to add the rest.
>>>
>>> Also there are still two problems:
>>>
>>> 1. one of the dangers of your setup is that
>>> Rtools has a conflict with Windows since it
>>> has its own find which takes over from Windows' find
>>> and can cause Windows batch files not related to R to fail.
>>> As a result its not a good idea to permanently set your
>>> path to include the rtools but better to do it session
>>> by session so that non-R sessions are unaffected.
>>>
>>> 2. Also you still don't seem to have MiKTeX on your path
>>> so I don't think its correct yet.  Rcmd.bat or rtools.bat
>>> would add the path to MiKTeX too (if you have it in a
>>> standard location).
>>>
>>> On Sat, Dec 6, 2008 at 9:41 AM, cstrato <cstrato at aon.at> wrote:
>>>
>>>       
>>>> Dear Duncan, dear Gabor,
>>>>
>>>> Thank you for this additional information and all these great tips.
>>>>
>>>> Setting the system path in the following way solved my problem:
>>>>
>>>> c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;c:\Programme\Microsoft
>>>> SQL Server\90\Tools\binn\
>>>>
>>>> Luckily this solves also the problem with potential conflicts between R
>>>> tools, Microsoft tools and ROOT, so that I do not have to rename any
>>>> tools
>>>> (which I would be reluctant to do).
>>>>
>>>> Since at the moment everything seems to work fine, and I am no Windows
>>>> expert (I do all my development on my Mac), I will keep the current
>>>> setting,
>>>> however, the next time I have to set up everything, I will try to take
>>>> advantage of Rcmd.bat since Gabor mentions that it will not override any
>>>> of
>>>> my settings.
>>>>
>>>> Regarding the R installation documentation, I understand now that this
>>>> seems
>>>> to be a problem of my complicated setup and not a general problem, so
>>>> adding
>>>> this information may confuse other people.
>>>>
>>>> Best regards
>>>> Christian
>>>>
>>>>
>>>> Gabor Grothendieck wrote:
>>>>
>>>>         
>>>>> On Sat, Dec 6, 2008 at 8:08 AM, Duncan Murdoch <murdoch at stats.uwo.ca>
>>>>> wrote:
>>>>>
>>>>>
>>>>>           
>>>>>> cstrato wrote:
>>>>>>
>>>>>>
>>>>>>             
>>>>>>> Prof Brian Ripley wrote:
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>               
>>>>>>>> On Fri, 5 Dec 2008, cstrato wrote:
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>                 
>>>>>>>>> Dear Duncan
>>>>>>>>>
>>>>>>>>> Thank you for this explicit explanation, you are right:
>>>>>>>>>
>>>>>>>>> When setting the system variable "Path" (as administrator) in
>>>>>>>>> addition
>>>>>>>>> to setting the user variable "PATH" (as user), now everything works
>>>>>>>>> fine.
>>>>>>>>>
>>>>>>>>> Interestingly, setting the system variable "Path" on my laptop with
>>>>>>>>> Rtools27 seems not to be necessary.
>>>>>>>>>
>>>>>>>>> May I suggest that  this could be clarified in "R Installation and
>>>>>>>>> Administration" since there only the user variable "PATH" is
>>>>>>>>> mentioned
>>>>>>>>> (as
>>>>>>>>> far as I see).
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>                   
>>>>>>>> In a shell there is only one PATH, so the manual is correct.
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>                 
>>>>>>> I did not say that the manual is not correct, I only suggested to
>>>>>>> clarify
>>>>>>> the issue, since when running R CMD INSTALL from the Command Console I
>>>>>>> need
>>>>>>> to set also the system variable "Path".
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>               
>>>>>> I'd be reluctant to do this, for the same reason Brian was:  the
>>>>>> documentation is correct.  You need to set the PATH environment
>>>>>> variable
>>>>>> correctly, and that's what we say.  The fact that doing this is
>>>>>> complicated
>>>>>> and confusing on Windows is a problem with the Windows design and
>>>>>> documentation, not the R documentation, and Microsoft certainly has
>>>>>> more
>>>>>> resources than we do to address it.  What was their response when you
>>>>>> asked
>>>>>> them to improve their documentation?
>>>>>> Duncan Murdoch
>>>>>>
>>>>>>
>>>>>>
>>>>>>             
>>>>> The http://batchfiles.googlecode.com home page does give some tips for
>>>>> setting
>>>>> paths just in case.  Of course if you are using the batchfiles you
>>>>> won't have to set
>>>>> any paths in the first place.
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>           
>>>>         
>>>
>>>       
>>     
>
>
>


From ripley at stats.ox.ac.uk  Sun Dec  7 11:51:00 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 7 Dec 2008 10:51:00 +0000 (GMT)
Subject: [Rd] Checking your package's help files
Message-ID: <alpine.LFD.2.00.0812071023060.26715@gannet.stats.ox.ac.uk>

It seems that many package authors do not proofread the help installed 
with their packages.  The Rd converter is not a parser, and it will 
silently produce incorrect results on incorrect input (and some correct 
input).

Here are a few hints about some common errors:

1) When you run R CMD check you get a PDF manual at 
<pkg>.Rcheck/<pkg>-manual.pdf.  Read through it looking for missing/empty 
and mis-formatted entries.


2) Try installing the package under a current R-devel (as of today). 
This will report on errors of the form

\item{foo} {item text}

with, NB, invalid space between the two arguments.   Earlier versions of 
R assume that the item had no text and so '{item text}' is never 
processed (not even checked for validity).  This results in at best 
missing information and at worse nonsense.


3) Grep the installed help for internal constructs, e.g.

grep nornal-bracket <installed-package>/help/*

Three ways I have found such constructs to appear in the processed files:

a) If you see 'eqnnormal-bracket' then you have a one-argument \eqn (or 
possibly \deqn) command immediately followed by }.  This is correct Rd but 
mis-processed in earlier versions of R.  In all the cases I have seen it 
comes from grammatically incorrect help files of the form

\item{foo}{... \eqn{x}}

where the item should end in ',' or '.'.  But if you don't want to do 
that, at least use a space before the brace.  I found this in packages
distrMod, flexclust, geepack, geoR, psychometric, robustbase and uroot.

b) Many packages have help files with 'normal-bracket' at the end of a 
processed \value section.  In all the cases I looked at, this results from 
using \itemize{} inside \value -- that does not work as \value is 
implicitly an itemize environment.

c) Using markup in verbatim-like environments will lead to nonsensical 
output: it seems the most common error is to use \code inside \examples. 
What markup is allowed where is not very well defined: Duncan Murdoch has 
started to document this at http://developer.r-project.org/parseRd.pdf but 
that currently is more a description of what should happen, not what has 
been implemented.

These issues are not rare (except 3a): about 10% of CRAN packages have 
them.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From p.dalgaard at biostat.ku.dk  Sun Dec  7 12:01:42 2008
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Sun, 07 Dec 2008 12:01:42 +0100
Subject: [Rd] Checking your package's help files
In-Reply-To: <alpine.LFD.2.00.0812071023060.26715@gannet.stats.ox.ac.uk>
References: <alpine.LFD.2.00.0812071023060.26715@gannet.stats.ox.ac.uk>
Message-ID: <493BAD16.9030507@biostat.ku.dk>

Prof Brian Ripley wrote:

> 3) Grep the installed help for internal constructs, e.g.
> 
> grep nornal-bracket <installed-package>/help/*

I see that you're following the time-honored empirical law, that every 
spelling flame contains at least one misteak itself...

-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From b.rowlingson at lancaster.ac.uk  Sun Dec  7 12:11:34 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 7 Dec 2008 11:11:34 +0000
Subject: [Rd] R in a sandbox/jail
Message-ID: <d8ad40b50812070311j29a9febh7183317b9fdf7fc9@mail.gmail.com>

Someone recently suggested building a system for automatically testing
student's R programs. They would upload them to our Virtual Learning
Environment, which would then run the code on some inputs and see if
it got the right output. If it does, the student scores points for
that course.

My first thought was "you want to run unchecked, student-submitted
code on a server that has access to students' grades?".

Can this be done securely? The idea might be to run R in a
chroot-jail, freshly generated for each run. The jail would not be
able to access anything outside of it, and once the R session has
finished the calling process can pick up the output from within the
jail.

Maybe that's overkill. Perhaps if you run the user's code as an
ordinary user and store the answers/results in a directory only root
can read that would work (given no local root exploits). Other
precautions could include limiting the runtime or cputime for the R
session. It might be necessary to limit network access too.

 Anyone done anything like this? Personally I think there are too many
other problems with automated systems like this, particularly that
just because a program produces the correct output that makes it a
good one. Sure, at the production stage that's a requirement, but I'd
rather students learnt to program well than to program correctly -
since correctness follows goodness but goodness does not follow
correctness. But that's an argument for another day!

Barry


From thpe at simecol.de  Sun Dec  7 14:36:26 2008
From: thpe at simecol.de (Thomas Petzoldt)
Date: Sun, 07 Dec 2008 14:36:26 +0100
Subject: [Rd] nlminb: names of parameter vector not passed to objective
 function (fixed)
In-Reply-To: <49368294.1060901@tu-dresden.de>
References: <49366B01.8070202@tu-dresden.de>	<alpine.LFD.2.00.0812031144110.28671@gannet.stats.ox.ac.uk>
	<49368294.1060901@tu-dresden.de>
Message-ID: <493BD15A.7000807@simecol.de>

NEWS, rev. 47094 now says:

     o	nlminb() copies names from 'start' to the parameter vector
	used (for consistency with optim()).



Dear Prof. Ripley,

thank you very much for doing this.

Thomas Petzoldt


From bolker at ufl.edu  Sun Dec  7 21:00:50 2008
From: bolker at ufl.edu (Ben Bolker)
Date: Sun, 07 Dec 2008 15:00:50 -0500
Subject: [Rd] Florida mirror (cran.hostingzero.net) dead?
Message-ID: <493C2B72.4020602@ufl.edu>


  The CRAN host in Tampa, FL (cran.hostingzero.net)
isn't responding, and hasn't responded in quite a while --
at least problems were reported more than a year ago
(Oct 2007)

http://finzi.psych.upenn.edu/R/Rhelp02a/archive/116706.html

although someone apparently succeeded in July 2008

http://finzi.psych.upenn.edu/R/Rhelp02a/archive/137451.html

  Perhaps it's just flaky, and not permanently missing,
but it still causes problems (especially for new users
who have no idea what's wrong, they just selected the
repository that was geographically closest to them).

  cheers
    Ben Bolker

-- 
Ben Bolker
Associate professor, Biology Dep't, Univ. of Florida
bolker at ufl.edu / www.zoology.ufl.edu/bolker
GPG key: www.zoology.ufl.edu/bolker/benbolker-publickey.asc


From marc_schwartz at comcast.net  Sun Dec  7 21:21:38 2008
From: marc_schwartz at comcast.net (Marc Schwartz)
Date: Sun, 07 Dec 2008 14:21:38 -0600
Subject: [Rd] Florida mirror (cran.hostingzero.net) dead?
In-Reply-To: <493C2B72.4020602@ufl.edu>
References: <493C2B72.4020602@ufl.edu>
Message-ID: <493C3052.2010605@comcast.net>

on 12/07/2008 02:00 PM Ben Bolker wrote:
>   The CRAN host in Tampa, FL (cran.hostingzero.net)
> isn't responding, and hasn't responded in quite a while --
> at least problems were reported more than a year ago
> (Oct 2007)
> 
> http://finzi.psych.upenn.edu/R/Rhelp02a/archive/116706.html
> 
> although someone apparently succeeded in July 2008
> 
> http://finzi.psych.upenn.edu/R/Rhelp02a/archive/137451.html
> 
>   Perhaps it's just flaky, and not permanently missing,
> but it still causes problems (especially for new users
> who have no idea what's wrong, they just selected the
> repository that was geographically closest to them).
> 
>   cheers
>     Ben Bolker

There appears to be not much at the main host page either:

  http://hostingzero.net/

which suggests that the host is defunct.

The whois info for the domain shows that they are using WhoisGuard,
which is a service that protects the domain owner information from whois
data harvesting bots.

It would seem reasonable to remove this host from the CRAN mirror list.

BTW Ben, congrats on the Gators win over Bama last night...hopefully
they get into the BCS Championship Game. Is it true that Superman wears
Tim Tebow pajamas...  ;-)

Regards,

Marc


From peter.ruckdeschel at itwm.fraunhofer.de  Mon Dec  8 11:57:35 2008
From: peter.ruckdeschel at itwm.fraunhofer.de (Dr. Peter Ruckdeschel)
Date: Mon, 08 Dec 2008 11:57:35 +0100
Subject: [Rd] Warning: missing text for item ... in \describe?
In-Reply-To: <alpine.LFD.2.00.0812060710380.15789@gannet.stats.ox.ac.uk>
References: <493384DA.9060504@pdf.com> <20081201154004.79ef748b@berwin-nus1>
	<alpine.LFD.2.00.0812051527430.15310@gannet.stats.ox.ac.uk>
	<20081206003504.208fbbce@berwin5>
	<alpine.LFD.2.00.0812051727410.22493@gannet.stats.ox.ac.uk>
	<20081206131350.2eba98d6@absentia>
	<alpine.LFD.2.00.0812060710380.15789@gannet.stats.ox.ac.uk>
Message-ID: <493CFD9F.1070406@itwm.fraunhofer.de>

Hi Brian and Berwin,

thanks for finding the reason for all this trouble.
> 1) Having run tests on CRAN and BioC overnight, the results are
> quite depressing.  There are 112 packages on CRAN and a score
> on BioC with incorrectly rendered help pages because of spaces
> after \item{foo}. 
> In two cases (fields and MANOR) the text skipped is invalid, so it
> is not simply a case of ignoring the whitespace.
As you already have found out the "depressing" number of 112, could you
please alert the maintainers of these packages --- I would not be surprised
if I were among them ...
> 2) On the original subject line, I found a different reason.  E.g. I
> get the
> message on distrMod, which has (sqrt-methods.Rd, also
> solve-methods.Rd)
>
> \section{Methods}{\describe{
> \item{sqrt}{\code{signature(x = "PosSemDefSymmMatrix")}: produces a
> symmetric, p.s.d. matrix \eqn{y} such that  \eqn{x = y^2}}
> }}

You indicate that the problem could easily be solved by inserting
punctuation.

I would have no problems with this as a binding restriction, and
probably the same
goes for other maintainers.
So could you perhaps add a corresponding recommendation
to the "Writing R extensions" manual?

I have just uploaded a quick patch for the sqrt() and solve() ".Rd"
files of distrMod
inserting a "." at the closing brace of \eqn{} in both cases.

Should be on CRAN  soon...

Best,
Peter

-- 
Dr. Peter Ruckdeschel, Abteilung Finanzmathematik, F3.17
Fraunhofer ITWM, Fraunhofer Platz 1, 67663 Kaiserslautern
Telefon:  +49 631/31600-4699
Fax    :  +49 631/31600-5699
E-Mail :  peter.ruckdeschel at itwm.fraunhofer.de



From ripley at stats.ox.ac.uk  Mon Dec  8 13:18:21 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 8 Dec 2008 12:18:21 +0000 (GMT)
Subject: [Rd] Warning: missing text for item ... in \describe?
In-Reply-To: <493CFD9F.1070406@itwm.fraunhofer.de>
References: <493384DA.9060504@pdf.com> <20081201154004.79ef748b@berwin-nus1>
	<alpine.LFD.2.00.0812051527430.15310@gannet.stats.ox.ac.uk>
	<20081206003504.208fbbce@berwin5>
	<alpine.LFD.2.00.0812051727410.22493@gannet.stats.ox.ac.uk>
	<20081206131350.2eba98d6@absentia>
	<alpine.LFD.2.00.0812060710380.15789@gannet.stats.ox.ac.uk>
	<493CFD9F.1070406@itwm.fraunhofer.de>
Message-ID: <alpine.LFD.2.00.0812081205080.15434@auk.stats.ox.ac.uk>

On Mon, 8 Dec 2008, Dr. Peter Ruckdeschel wrote:

> Hi Brian and Berwin,
>
> thanks for finding the reason for all this trouble.
>> 1) Having run tests on CRAN and BioC overnight, the results are
>> quite depressing.  There are 112 packages on CRAN and a score
>> on BioC with incorrectly rendered help pages because of spaces
>> after \item{foo}.
>> In two cases (fields and MANOR) the text skipped is invalid, so it
>> is not simply a case of ignoring the whitespace.

> As you already have found out the "depressing" number of 112, could you
> please alert the maintainers of these packages --- I would not be surprised
> if I were among them ...

Well, needing to do so on that scale is one of the depressing things. 
However, I am waiting for the CRAN daily checking to catch up, as this 
will appear as warnings in the logs there once they are using a current 
R-devel (the last results are for Dec 4's R-devel).  The current list is 
for CRAN

AIS AMORE BARD BCE BLCOP BSDA BaM Biodem BootCL ElemStatLearn FactoMineR 
FitAR GLDEX GSA Geneland HH Hmisc MBESS MCPAN MSBVAR MiscPsycho 
NestedCohort PASWR PHYLOGR PTAk R2HTML RArcInfo RBGL RFOC RGraphics RII 
RSEIS RobAStBase Rsge SNPassoc SciViews TinnR VDCutil WaveCGH accuracy ada 
ade4 agricolae ars assist bayesm bim bipartite bitops calib candisc 
cghFLasso coda colorRamps compositions crq cwhmisc distrTEst dprep emu 
equivalence fImport fOptions fields fossil gamlss gclus geiger geometry 
gllm gnm impute its kin kknn klaR knnTree lgtdl limSolve locpol logilasso 
logspline modeest muStat netmodels nplplot orthopolynom paleoTS pamr pbatR 
pcalg phangorn playwith polspline psych rankreg rbugs relaimpo rgl rjacobi 
rootSolve samr siar space spectralGP survrec tpr tseriesChaos varSelRF 
varmixt

and for BioC-devel

ABarray GSEAlm GeneticsBase Harshlight KCsmart LPEadj MANOR MCRestimate 
MassSpecWavelet MeasurementError Mfuzz OLIN PLPE RBGL RankProd SAGx SLGI 
VanillaICE affyQCReport affylmGUI cghMCR copa ecolitk explorase flowCore 
flowViz gcrma genArise impute limmaGUI lumi made4 pamr rama rflowcyt 
rtracklayer simpleaffy snapCGH splicegear sscore


>> 2) On the original subject line, I found a different reason.  E.g. I
>> get the
>> message on distrMod, which has (sqrt-methods.Rd, also
>> solve-methods.Rd)
>>
>> \section{Methods}{\describe{
>> \item{sqrt}{\code{signature(x = "PosSemDefSymmMatrix")}: produces a
>> symmetric, p.s.d. matrix \eqn{y} such that  \eqn{x = y^2}}
>> }}
>
> You indicate that the problem could easily be solved by inserting
> punctuation.
>
> I would have no problems with this as a binding restriction, and
> probably the same
> goes for other maintainers.
> So could you perhaps add a corresponding recommendation
> to the "Writing R extensions" manual?

Yes, I am working on some recommendations for R-exts.  Hopefully more of 
these problems can be detected and given as warnings now we are aware of 
them.

> I have just uploaded a quick patch for the sqrt() and solve() ".Rd"
> files of distrMod
> inserting a "." at the closing brace of \eqn{} in both cases.
>
> Should be on CRAN  soon...
>
> Best,
> Peter
>
> -- 
> Dr. Peter Ruckdeschel, Abteilung Finanzmathematik, F3.17
> Fraunhofer ITWM, Fraunhofer Platz 1, 67663 Kaiserslautern
> Telefon:  +49 631/31600-4699
> Fax    :  +49 631/31600-5699
> E-Mail :  peter.ruckdeschel at itwm.fraunhofer.de
>
>
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From rpeng at jhsph.edu  Mon Dec  8 14:19:20 2008
From: rpeng at jhsph.edu (Roger D. Peng)
Date: Mon, 8 Dec 2008 08:19:20 -0500
Subject: [Rd] R in a sandbox/jail
In-Reply-To: <d8ad40b50812070311j29a9febh7183317b9fdf7fc9@mail.gmail.com>
References: <d8ad40b50812070311j29a9febh7183317b9fdf7fc9@mail.gmail.com>
Message-ID: <493D1ED8.9000203@jhsph.edu>

I've not tried an automated system like you describe but I have tried to make 
test scripts available that compare the output of their programs to correct 
output.  That way the students can check their progress as they work.  In 
general, I find this approach doesn't work well for grading because in order to 
specify a homework to the point where the students' output matches your output, 
the homework ends up being 10 pages long (not unlike a legal document).

For example, in a number of instances I'd say "the function should return a 
number..." and then I'd compare the returned result to the actual answer.  But a 
student would 'print' the number instead, not knowing the difference between 
'return+autoprint' and 'print'.  I found it difficult to write a test script 
that gives partial credit for getting the answer right but the concept wrong. 
Perhaps that's a problem with the way I grade things, but I found it difficult 
to write an acceptable test script.

-roger

Barry Rowlingson wrote:
> Someone recently suggested building a system for automatically testing
> student's R programs. They would upload them to our Virtual Learning
> Environment, which would then run the code on some inputs and see if
> it got the right output. If it does, the student scores points for
> that course.
> 
> My first thought was "you want to run unchecked, student-submitted
> code on a server that has access to students' grades?".
> 
> Can this be done securely? The idea might be to run R in a
> chroot-jail, freshly generated for each run. The jail would not be
> able to access anything outside of it, and once the R session has
> finished the calling process can pick up the output from within the
> jail.
> 
> Maybe that's overkill. Perhaps if you run the user's code as an
> ordinary user and store the answers/results in a directory only root
> can read that would work (given no local root exploits). Other
> precautions could include limiting the runtime or cputime for the R
> session. It might be necessary to limit network access too.
> 
>  Anyone done anything like this? Personally I think there are too many
> other problems with automated systems like this, particularly that
> just because a program produces the correct output that makes it a
> good one. Sure, at the production stage that's a requirement, but I'd
> rather students learnt to program well than to program correctly -
> since correctness follows goodness but goodness does not follow
> correctness. But that's an argument for another day!
> 
> Barry
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> .
> 

-- 
Roger D. Peng  |  http://www.biostat.jhsph.edu/~rpeng/


From vogranovich at jumptrading.com  Tue Dec  9 01:01:39 2008
From: vogranovich at jumptrading.com (Vadim Ogranovich)
Date: Mon, 8 Dec 2008 18:01:39 -0600
Subject: [Rd] weekly update 20081208
Message-ID: <22D850BC39A25742977325ADDE208E770270618DCC@chiexchange02.w2k.jumptrading.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081208/73d308b1/attachment.pl>

From davison at stats.ox.ac.uk  Tue Dec  9 01:45:21 2008
From: davison at stats.ox.ac.uk (Dan Davison)
Date: Mon, 8 Dec 2008 19:45:21 -0500
Subject: [Rd] repeat bug report: as.factor argument to row / col fails if
	NULL	dimnames
Message-ID: <20081209004521.GA25854@stats.ox.ac.uk>

This bug was reported to r-devel by Martin Morgan on 13th May 2008
(original email pasted below). However I couldn't locate it in the bug
tracker (with searches for row, col, as\.factor) It is still present
in today's svn version (rev 47115). I hope I'm doing something useful
by bringing it up again. I have not sent this to r-bugs, as I'm
concerned that not locating it in the bug tracker could be my failing.

Dan

original report:
------------------------------------------------------------------
col(matrix(0, 5, 5), as.factor=TRUE) fails

> col(matrix(0, 5, 5), as.factor=TRUE)
Error in factor(.Internal(col(dim(x))), labels = colnames(x)) :
  invalid labels; length 0 should be 1 or 5

when the matrix has no dimnames. This is not as advertised. I would
have expected the equivalent of

factor(.Internal(col(dim(x))),
       labels=colnames(x, do.NULL=FALSE, prefix=""))

> sessionInfo()
R version 2.8.0 Under development (unstable) (2008-05-13 r45682)
x86_64-unknown-linux-gnu

Martin
-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M2 B169
Phone: (206) 667-2793
------------------------------------------------------------------


-- 
http://www.stats.ox.ac.uk/~davison


From p.murrell at auckland.ac.nz  Tue Dec  9 03:33:19 2008
From: p.murrell at auckland.ac.nz (Paul Murrell)
Date: Tue, 09 Dec 2008 15:33:19 +1300
Subject: [Rd] R in a sandbox/jail
In-Reply-To: <d8ad40b50812070311j29a9febh7183317b9fdf7fc9@mail.gmail.com>
References: <d8ad40b50812070311j29a9febh7183317b9fdf7fc9@mail.gmail.com>
Message-ID: <493DD8EF.8060901@stat.auckland.ac.nz>

Hi

I set up R in a chroot jail for a course and it worked fine (students
were able to submit R code via a web form, which was
password-protected).  I recall it taking a bit of setting up, but hard
to estimate how much of that was figuring out how to use chroot.  I have
some notes, so might be able to help out if you have questions.

I no longer maintain the R-via-web set up, but I do automate some of the
marking of student R code submissions.  See the R News 8(2) for a
description of how I use the 'compare' package for this sort of thing.
The R code submissions still need to be viewed by eye for style and
sanity, but I find it worthwhile to automate the monotonous task of
checking whether the code produces the right answer.

Paul


Barry Rowlingson wrote:
> Someone recently suggested building a system for automatically testing
> student's R programs. They would upload them to our Virtual Learning
> Environment, which would then run the code on some inputs and see if
> it got the right output. If it does, the student scores points for
> that course.
> 
> My first thought was "you want to run unchecked, student-submitted
> code on a server that has access to students' grades?".
> 
> Can this be done securely? The idea might be to run R in a
> chroot-jail, freshly generated for each run. The jail would not be
> able to access anything outside of it, and once the R session has
> finished the calling process can pick up the output from within the
> jail.
> 
> Maybe that's overkill. Perhaps if you run the user's code as an
> ordinary user and store the answers/results in a directory only root
> can read that would work (given no local root exploits). Other
> precautions could include limiting the runtime or cputime for the R
> session. It might be necessary to limit network access too.
> 
>  Anyone done anything like this? Personally I think there are too many
> other problems with automated systems like this, particularly that
> just because a program produces the correct output that makes it a
> good one. Sure, at the production stage that's a requirement, but I'd
> rather students learnt to program well than to program correctly -
> since correctness follows goodness but goodness does not follow
> correctness. But that's an argument for another day!
> 
> Barry
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Dr Paul Murrell
Department of Statistics
The University of Auckland
Private Bag 92019
Auckland
New Zealand
64 9 3737599 x85392
paul at stat.auckland.ac.nz
http://www.stat.auckland.ac.nz/~paul/


From Andy.Bunn at wwu.edu  Mon Dec  8 19:28:42 2008
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Mon, 8 Dec 2008 10:28:42 -0800
Subject: [Rd] R CMD check not running examples under Windows
Message-ID: <366AA6C6662BAB4796FF54F8D8BFC74202B7973647@ExchMailbox1.univ.dir.wwu.edu>

All, 


I have a fresh build of R 2.8.0 from source on Windows XP using the latest Rtools binary (Rtools29.exe). All appears to be well with the install and make check-all exits cleanly. However, when running R CMD check mypkg the program jumps from checking for non-ASCII to checking the PDF version of the manual:

* checking data for non-ASCII characters ... OK
* checking PDF version of manual ... OK

It skips the making the R-ex subdir and checking the examples. Here is the complete log:


* using log directory 'C:/Data/research/dplR_dev/dplR.Rcheck'
* using R version 2.8.0 (2008-10-20)
* using session charset: ISO8859-1
* checking for file 'dplR/DESCRIPTION' ... OK
* checking extension type ... Package
* this is package 'dplR' version '1.1.5'
* checking package name space information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking for .dll and .exe files ... OK
* checking whether package 'dplR' can be installed ... OK
* checking package directory ... OK
* checking for portable file names ... OK
* checking DESCRIPTION meta-information ... OK
* checking top-level files ... OK
* checking index information ... OK
* checking package subdirectories ... OK
* checking R files for non-ASCII characters ... OK
* checking R files for syntax errors ... OK
* checking whether the package can be loaded ... OK
* checking whether the package can be loaded with stated dependencies ... OK
* checking whether the name space can be loaded with stated dependencies ... OK
* checking for unstated dependencies in R code ... OK
* checking S3 generic/method consistency ... OK
* checking replacement functions ... OK
* checking foreign function calls ... OK
* checking R code for possible problems ... OK
* checking Rd files ... OK
* checking Rd cross-references ... OK
* checking for missing documentation entries ... OK
* checking for code/documentation mismatches ... OK
* checking Rd \usage sections ... OK
* checking data for non-ASCII characters ... OK
* checking PDF version of manual ... OK

I am running this with no flags yet it seems like I'm outside this line in the check script:
  if($opt_examples && (-d &file_path($library, $pkgname, "R-ex"))) {

Here is the version:
> version
               _                           
platform       i386-pc-mingw32             
arch           i386                        
os             mingw32                     
system         i386, mingw32               
status                                     
major          2                           
minor          8.0                         
year           2008                        
month          10                          
day            20                          
svn rev        46754                       
language       R                           
version.string R version 2.8.0 (2008-10-20)
>


And the PATH:
C:\Data\research\dplR_dev>PATH
PATH=c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;C:\R\R-2.8.0\bin\;C:\P
rogram Files\HTML Help Workshop\;C:\Program Files\MiKTeX 2.6\miktex\bin;C:\cygwi
n\bin;C:\FWTools2.2.6\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbe
m;C:\WINDOWS\system32\nls;C:\WINDOWS\system32\nls\ENGLISH;C:\Program Files\Novel
l\ZENworks\;C:\Program Files\QuickTime\QTSystem;C:\ArcGIS\arcexe9x\bin;C:\Progra
m Files\Common Files\GTK\2.0\bin;C:\Program Files\GPS Pathfinder Office 3.10;C:\
dpl;C:\Program Files\QuickTime\QTSystem\;C:\Program Files\SSH Communications Sec
urity\SSH Secure Shell;Z:.;

I expect some cygwin or perl issue but I'm not sure how to proceed in tracking this down. Cygwin is a fresh install as well. Any suggestions on what to do next greatly appreciated.

-A

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Andy Bunn
Environmental Sciences, Huxley College
Western Washington University
Bellingham, WA 98225-9181
Skype: andy.bunn
Phone: 360-650-4252
Fax: 360-650-7284
http://myweb.facstaff.wwu.edu/bunna/


From ligges at statistik.tu-dortmund.de  Tue Dec  9 11:02:33 2008
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 09 Dec 2008 11:02:33 +0100
Subject: [Rd] R CMD check not running examples under Windows
In-Reply-To: <366AA6C6662BAB4796FF54F8D8BFC74202B7973647@ExchMailbox1.univ.dir.wwu.edu>
References: <366AA6C6662BAB4796FF54F8D8BFC74202B7973647@ExchMailbox1.univ.dir.wwu.edu>
Message-ID: <493E4239.2090300@statistik.tu-dortmund.de>

My suggestion is to submit the package to the win-builder service and 
look whether that one checks your example, then you know if it is the 
package or your setup that causes the problem.

Best,
Uwe Ligges


Andy Bunn wrote:
> All, 
> 
> 
> I have a fresh build of R 2.8.0 from source on Windows XP using the latest Rtools binary (Rtools29.exe). All appears to be well with the install and make check-all exits cleanly. However, when running R CMD check mypkg the program jumps from checking for non-ASCII to checking the PDF version of the manual:
> 
> * checking data for non-ASCII characters ... OK
> * checking PDF version of manual ... OK
> 
> It skips the making the R-ex subdir and checking the examples. Here is the complete log:
> 
> 
> * using log directory 'C:/Data/research/dplR_dev/dplR.Rcheck'
> * using R version 2.8.0 (2008-10-20)
> * using session charset: ISO8859-1
> * checking for file 'dplR/DESCRIPTION' ... OK
> * checking extension type ... Package
> * this is package 'dplR' version '1.1.5'
> * checking package name space information ... OK
> * checking package dependencies ... OK
> * checking if this is a source package ... OK
> * checking for .dll and .exe files ... OK
> * checking whether package 'dplR' can be installed ... OK
> * checking package directory ... OK
> * checking for portable file names ... OK
> * checking DESCRIPTION meta-information ... OK
> * checking top-level files ... OK
> * checking index information ... OK
> * checking package subdirectories ... OK
> * checking R files for non-ASCII characters ... OK
> * checking R files for syntax errors ... OK
> * checking whether the package can be loaded ... OK
> * checking whether the package can be loaded with stated dependencies ... OK
> * checking whether the name space can be loaded with stated dependencies ... OK
> * checking for unstated dependencies in R code ... OK
> * checking S3 generic/method consistency ... OK
> * checking replacement functions ... OK
> * checking foreign function calls ... OK
> * checking R code for possible problems ... OK
> * checking Rd files ... OK
> * checking Rd cross-references ... OK
> * checking for missing documentation entries ... OK
> * checking for code/documentation mismatches ... OK
> * checking Rd \usage sections ... OK
> * checking data for non-ASCII characters ... OK
> * checking PDF version of manual ... OK
> 
> I am running this with no flags yet it seems like I'm outside this line in the check script:
>   if($opt_examples && (-d &file_path($library, $pkgname, "R-ex"))) {
> 
> Here is the version:
>> version
>                _                           
> platform       i386-pc-mingw32             
> arch           i386                        
> os             mingw32                     
> system         i386, mingw32               
> status                                     
> major          2                           
> minor          8.0                         
> year           2008                        
> month          10                          
> day            20                          
> svn rev        46754                       
> language       R                           
> version.string R version 2.8.0 (2008-10-20)
> 
> 
> And the PATH:
> C:\Data\research\dplR_dev>PATH
> PATH=c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;C:\R\R-2.8.0\bin\;C:\P
> rogram Files\HTML Help Workshop\;C:\Program Files\MiKTeX 2.6\miktex\bin;C:\cygwi
> n\bin;C:\FWTools2.2.6\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbe
> m;C:\WINDOWS\system32\nls;C:\WINDOWS\system32\nls\ENGLISH;C:\Program Files\Novel
> l\ZENworks\;C:\Program Files\QuickTime\QTSystem;C:\ArcGIS\arcexe9x\bin;C:\Progra
> m Files\Common Files\GTK\2.0\bin;C:\Program Files\GPS Pathfinder Office 3.10;C:\
> dpl;C:\Program Files\QuickTime\QTSystem\;C:\Program Files\SSH Communications Sec
> urity\SSH Secure Shell;Z:.;
> 
> I expect some cygwin or perl issue but I'm not sure how to proceed in tracking this down. Cygwin is a fresh install as well. Any suggestions on what to do next greatly appreciated.
> 
> -A
> 
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> Andy Bunn
> Environmental Sciences, Huxley College
> Western Washington University
> Bellingham, WA 98225-9181
> Skype: andy.bunn
> Phone: 360-650-4252
> Fax: 360-650-7284
> http://myweb.facstaff.wwu.edu/bunna/
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From Andy.Bunn at wwu.edu  Tue Dec  9 18:32:33 2008
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Tue, 9 Dec 2008 09:32:33 -0800
Subject: [Rd] R CMD check not running examples under Windows
In-Reply-To: <493E4239.2090300@statistik.tu-dortmund.de>
References: <366AA6C6662BAB4796FF54F8D8BFC74202B7973647@ExchMailbox1.univ.dir.wwu.edu>
	<493E4239.2090300@statistik.tu-dortmund.de>
Message-ID: <366AA6C6662BAB4796FF54F8D8BFC74202B7A10AFA@ExchMailbox1.univ.dir.wwu.edu>

> -----Original Message-----
> From: Uwe Ligges [mailto:ligges at statistik.tu-dortmund.de]
> Sent: Tuesday, December 09, 2008 2:03 AM
> To: Andy Bunn
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] R CMD check not running examples under Windows
> 
> My suggestion is to submit the package to the win-builder service and
> look whether that one checks your example, then you know if it is the
> package or your setup that causes the problem.

Uwe, thanks for the tip but the issue is definitely my system - not the package. I've built a skeleton using package.skeleton() and the same phenomenon occurs. Same with checking CRAN packages from source. If it is a problem with my system - how do I go about trouble shooting?



> 
> Best,
> Uwe Ligges
> 
> 
> Andy Bunn wrote:
> > All,
> >
> >
> > I have a fresh build of R 2.8.0 from source on Windows XP using the
> latest Rtools binary (Rtools29.exe). All appears to be well with the
> install and make check-all exits cleanly. However, when running R CMD
> check mypkg the program jumps from checking for non-ASCII to checking
> the PDF version of the manual:
> >
> > * checking data for non-ASCII characters ... OK
> > * checking PDF version of manual ... OK
> >
> > It skips the making the R-ex subdir and checking the examples. Here
> is the complete log:
> >
> >
> > * using log directory 'C:/Data/research/dplR_dev/dplR.Rcheck'
> > * using R version 2.8.0 (2008-10-20)
> > * using session charset: ISO8859-1
> > * checking for file 'dplR/DESCRIPTION' ... OK
> > * checking extension type ... Package
> > * this is package 'dplR' version '1.1.5'
> > * checking package name space information ... OK
> > * checking package dependencies ... OK
> > * checking if this is a source package ... OK
> > * checking for .dll and .exe files ... OK
> > * checking whether package 'dplR' can be installed ... OK
> > * checking package directory ... OK
> > * checking for portable file names ... OK
> > * checking DESCRIPTION meta-information ... OK
> > * checking top-level files ... OK
> > * checking index information ... OK
> > * checking package subdirectories ... OK
> > * checking R files for non-ASCII characters ... OK
> > * checking R files for syntax errors ... OK
> > * checking whether the package can be loaded ... OK
> > * checking whether the package can be loaded with stated dependencies
> ... OK
> > * checking whether the name space can be loaded with stated
> dependencies ... OK
> > * checking for unstated dependencies in R code ... OK
> > * checking S3 generic/method consistency ... OK
> > * checking replacement functions ... OK
> > * checking foreign function calls ... OK
> > * checking R code for possible problems ... OK
> > * checking Rd files ... OK
> > * checking Rd cross-references ... OK
> > * checking for missing documentation entries ... OK
> > * checking for code/documentation mismatches ... OK
> > * checking Rd \usage sections ... OK
> > * checking data for non-ASCII characters ... OK
> > * checking PDF version of manual ... OK
> >
> > I am running this with no flags yet it seems like I'm outside this
> line in the check script:
> >   if($opt_examples && (-d &file_path($library, $pkgname, "R-ex"))) {
> >
> > Here is the version:
> >> version
> >                _
> > platform       i386-pc-mingw32
> > arch           i386
> > os             mingw32
> > system         i386, mingw32
> > status
> > major          2
> > minor          8.0
> > year           2008
> > month          10
> > day            20
> > svn rev        46754
> > language       R
> > version.string R version 2.8.0 (2008-10-20)
> >
> >
> > And the PATH:
> > C:\Data\research\dplR_dev>PATH
> > PATH=c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;C:\R\R-
> 2.8.0\bin\;C:\P
> > rogram Files\HTML Help Workshop\;C:\Program Files\MiKTeX
> 2.6\miktex\bin;C:\cygwi
> >
> n\bin;C:\FWTools2.2.6\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\Sys
> tem32\Wbe
> > m;C:\WINDOWS\system32\nls;C:\WINDOWS\system32\nls\ENGLISH;C:\Program
> Files\Novel
> > l\ZENworks\;C:\Program
> Files\QuickTime\QTSystem;C:\ArcGIS\arcexe9x\bin;C:\Progra
> > m Files\Common Files\GTK\2.0\bin;C:\Program Files\GPS Pathfinder
> Office 3.10;C:\
> > dpl;C:\Program Files\QuickTime\QTSystem\;C:\Program Files\SSH
> Communications Sec
> > urity\SSH Secure Shell;Z:.;
> >
> > I expect some cygwin or perl issue but I'm not sure how to proceed in
> tracking this down. Cygwin is a fresh install as well. Any suggestions
> on what to do next greatly appreciated.
> >
> > -A
> >
> > ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > Andy Bunn
> > Environmental Sciences, Huxley College
> > Western Washington University
> > Bellingham, WA 98225-9181
> > Skype: andy.bunn
> > Phone: 360-650-4252
> > Fax: 360-650-7284
> > http://myweb.facstaff.wwu.edu/bunna/
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel


From josh.m.ulrich at gmail.com  Tue Dec  9 18:50:00 2008
From: josh.m.ulrich at gmail.com (Josh Ulrich)
Date: Tue, 9 Dec 2008 11:50:00 -0600
Subject: [Rd] R CMD check not running examples under Windows
In-Reply-To: <366AA6C6662BAB4796FF54F8D8BFC74202B7A10AFA@ExchMailbox1.univ.dir.wwu.edu>
References: <366AA6C6662BAB4796FF54F8D8BFC74202B7973647@ExchMailbox1.univ.dir.wwu.edu>
	<493E4239.2090300@statistik.tu-dortmund.de>
	<366AA6C6662BAB4796FF54F8D8BFC74202B7A10AFA@ExchMailbox1.univ.dir.wwu.edu>
Message-ID: <8cca69990812090950w8e15434vb323405ad036b1a1@mail.gmail.com>

This is a shot in the dark, but I noticed your PATH contains spaces in
the paths to HTML Help and MiKTeX.  The R Install & Admin manual
explicitly says not to paths with spaces.  If anything, it won't hurt
to make this correction.

HTH,
Josh
--
http://quantemplation.blogspot.com



On Tue, Dec 9, 2008 at 11:32 AM, Andy Bunn <Andy.Bunn at wwu.edu> wrote:
>> -----Original Message-----
>> From: Uwe Ligges [mailto:ligges at statistik.tu-dortmund.de]
>> Sent: Tuesday, December 09, 2008 2:03 AM
>> To: Andy Bunn
>> Cc: r-devel at r-project.org
>> Subject: Re: [Rd] R CMD check not running examples under Windows
>>
>> My suggestion is to submit the package to the win-builder service and
>> look whether that one checks your example, then you know if it is the
>> package or your setup that causes the problem.
>
> Uwe, thanks for the tip but the issue is definitely my system - not the package. I've built a skeleton using package.skeleton() and the same phenomenon occurs. Same with checking CRAN packages from source. If it is a problem with my system - how do I go about trouble shooting?
>
>
>
>>
>> Best,
>> Uwe Ligges
>>
>>
>> Andy Bunn wrote:
>> > All,
>> >
>> >
>> > I have a fresh build of R 2.8.0 from source on Windows XP using the
>> latest Rtools binary (Rtools29.exe). All appears to be well with the
>> install and make check-all exits cleanly. However, when running R CMD
>> check mypkg the program jumps from checking for non-ASCII to checking
>> the PDF version of the manual:
>> >
>> > * checking data for non-ASCII characters ... OK
>> > * checking PDF version of manual ... OK
>> >
>> > It skips the making the R-ex subdir and checking the examples. Here
>> is the complete log:
>> >
>> >
>> > * using log directory 'C:/Data/research/dplR_dev/dplR.Rcheck'
>> > * using R version 2.8.0 (2008-10-20)
>> > * using session charset: ISO8859-1
>> > * checking for file 'dplR/DESCRIPTION' ... OK
>> > * checking extension type ... Package
>> > * this is package 'dplR' version '1.1.5'
>> > * checking package name space information ... OK
>> > * checking package dependencies ... OK
>> > * checking if this is a source package ... OK
>> > * checking for .dll and .exe files ... OK
>> > * checking whether package 'dplR' can be installed ... OK
>> > * checking package directory ... OK
>> > * checking for portable file names ... OK
>> > * checking DESCRIPTION meta-information ... OK
>> > * checking top-level files ... OK
>> > * checking index information ... OK
>> > * checking package subdirectories ... OK
>> > * checking R files for non-ASCII characters ... OK
>> > * checking R files for syntax errors ... OK
>> > * checking whether the package can be loaded ... OK
>> > * checking whether the package can be loaded with stated dependencies
>> ... OK
>> > * checking whether the name space can be loaded with stated
>> dependencies ... OK
>> > * checking for unstated dependencies in R code ... OK
>> > * checking S3 generic/method consistency ... OK
>> > * checking replacement functions ... OK
>> > * checking foreign function calls ... OK
>> > * checking R code for possible problems ... OK
>> > * checking Rd files ... OK
>> > * checking Rd cross-references ... OK
>> > * checking for missing documentation entries ... OK
>> > * checking for code/documentation mismatches ... OK
>> > * checking Rd \usage sections ... OK
>> > * checking data for non-ASCII characters ... OK
>> > * checking PDF version of manual ... OK
>> >
>> > I am running this with no flags yet it seems like I'm outside this
>> line in the check script:
>> >   if($opt_examples && (-d &file_path($library, $pkgname, "R-ex"))) {
>> >
>> > Here is the version:
>> >> version
>> >                _
>> > platform       i386-pc-mingw32
>> > arch           i386
>> > os             mingw32
>> > system         i386, mingw32
>> > status
>> > major          2
>> > minor          8.0
>> > year           2008
>> > month          10
>> > day            20
>> > svn rev        46754
>> > language       R
>> > version.string R version 2.8.0 (2008-10-20)
>> >
>> >
>> > And the PATH:
>> > C:\Data\research\dplR_dev>PATH
>> > PATH=c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;C:\R\R-
>> 2.8.0\bin\;C:\P
>> > rogram Files\HTML Help Workshop\;C:\Program Files\MiKTeX
>> 2.6\miktex\bin;C:\cygwi
>> >
>> n\bin;C:\FWTools2.2.6\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\Sys
>> tem32\Wbe
>> > m;C:\WINDOWS\system32\nls;C:\WINDOWS\system32\nls\ENGLISH;C:\Program
>> Files\Novel
>> > l\ZENworks\;C:\Program
>> Files\QuickTime\QTSystem;C:\ArcGIS\arcexe9x\bin;C:\Progra
>> > m Files\Common Files\GTK\2.0\bin;C:\Program Files\GPS Pathfinder
>> Office 3.10;C:\
>> > dpl;C:\Program Files\QuickTime\QTSystem\;C:\Program Files\SSH
>> Communications Sec
>> > urity\SSH Secure Shell;Z:.;
>> >
>> > I expect some cygwin or perl issue but I'm not sure how to proceed in
>> tracking this down. Cygwin is a fresh install as well. Any suggestions
>> on what to do next greatly appreciated.
>> >
>> > -A
>> >
>> > ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
>> > Andy Bunn
>> > Environmental Sciences, Huxley College
>> > Western Washington University
>> > Bellingham, WA 98225-9181
>> > Skype: andy.bunn
>> > Phone: 360-650-4252
>> > Fax: 360-650-7284
>> > http://myweb.facstaff.wwu.edu/bunna/
>> >
>> > ______________________________________________
>> > R-devel at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ligges at statistik.tu-dortmund.de  Tue Dec  9 18:54:01 2008
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Tue, 09 Dec 2008 18:54:01 +0100
Subject: [Rd] R CMD check not running examples under Windows
In-Reply-To: <366AA6C6662BAB4796FF54F8D8BFC74202B7A10AFA@ExchMailbox1.univ.dir.wwu.edu>
References: <366AA6C6662BAB4796FF54F8D8BFC74202B7973647@ExchMailbox1.univ.dir.wwu.edu>
	<493E4239.2090300@statistik.tu-dortmund.de>
	<366AA6C6662BAB4796FF54F8D8BFC74202B7A10AFA@ExchMailbox1.univ.dir.wwu.edu>
Message-ID: <493EB0B9.8020300@statistik.tu-dortmund.de>

No idea,

perhaps add some print statements in teh perl code that executes the 
checks and see why it does not jump in.

uwe




Andy Bunn wrote:
>> -----Original Message-----
>> From: Uwe Ligges [mailto:ligges at statistik.tu-dortmund.de]
>> Sent: Tuesday, December 09, 2008 2:03 AM
>> To: Andy Bunn
>> Cc: r-devel at r-project.org
>> Subject: Re: [Rd] R CMD check not running examples under Windows
>>
>> My suggestion is to submit the package to the win-builder service and
>> look whether that one checks your example, then you know if it is the
>> package or your setup that causes the problem.
> 
> Uwe, thanks for the tip but the issue is definitely my system - not the package. I've built a skeleton using package.skeleton() and the same phenomenon occurs. Same with checking CRAN packages from source. If it is a problem with my system - how do I go about trouble shooting?
> 
> 
> 
>> Best,
>> Uwe Ligges
>>
>>
>> Andy Bunn wrote:
>>> All,
>>>
>>>
>>> I have a fresh build of R 2.8.0 from source on Windows XP using the
>> latest Rtools binary (Rtools29.exe). All appears to be well with the
>> install and make check-all exits cleanly. However, when running R CMD
>> check mypkg the program jumps from checking for non-ASCII to checking
>> the PDF version of the manual:
>>> * checking data for non-ASCII characters ... OK
>>> * checking PDF version of manual ... OK
>>>
>>> It skips the making the R-ex subdir and checking the examples. Here
>> is the complete log:
>>>
>>> * using log directory 'C:/Data/research/dplR_dev/dplR.Rcheck'
>>> * using R version 2.8.0 (2008-10-20)
>>> * using session charset: ISO8859-1
>>> * checking for file 'dplR/DESCRIPTION' ... OK
>>> * checking extension type ... Package
>>> * this is package 'dplR' version '1.1.5'
>>> * checking package name space information ... OK
>>> * checking package dependencies ... OK
>>> * checking if this is a source package ... OK
>>> * checking for .dll and .exe files ... OK
>>> * checking whether package 'dplR' can be installed ... OK
>>> * checking package directory ... OK
>>> * checking for portable file names ... OK
>>> * checking DESCRIPTION meta-information ... OK
>>> * checking top-level files ... OK
>>> * checking index information ... OK
>>> * checking package subdirectories ... OK
>>> * checking R files for non-ASCII characters ... OK
>>> * checking R files for syntax errors ... OK
>>> * checking whether the package can be loaded ... OK
>>> * checking whether the package can be loaded with stated dependencies
>> ... OK
>>> * checking whether the name space can be loaded with stated
>> dependencies ... OK
>>> * checking for unstated dependencies in R code ... OK
>>> * checking S3 generic/method consistency ... OK
>>> * checking replacement functions ... OK
>>> * checking foreign function calls ... OK
>>> * checking R code for possible problems ... OK
>>> * checking Rd files ... OK
>>> * checking Rd cross-references ... OK
>>> * checking for missing documentation entries ... OK
>>> * checking for code/documentation mismatches ... OK
>>> * checking Rd \usage sections ... OK
>>> * checking data for non-ASCII characters ... OK
>>> * checking PDF version of manual ... OK
>>>
>>> I am running this with no flags yet it seems like I'm outside this
>> line in the check script:
>>>   if($opt_examples && (-d &file_path($library, $pkgname, "R-ex"))) {
>>>
>>> Here is the version:
>>>> version
>>>                _
>>> platform       i386-pc-mingw32
>>> arch           i386
>>> os             mingw32
>>> system         i386, mingw32
>>> status
>>> major          2
>>> minor          8.0
>>> year           2008
>>> month          10
>>> day            20
>>> svn rev        46754
>>> language       R
>>> version.string R version 2.8.0 (2008-10-20)
>>>
>>>
>>> And the PATH:
>>> C:\Data\research\dplR_dev>PATH
>>> PATH=c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;C:\R\R-
>> 2.8.0\bin\;C:\P
>>> rogram Files\HTML Help Workshop\;C:\Program Files\MiKTeX
>> 2.6\miktex\bin;C:\cygwi
>> n\bin;C:\FWTools2.2.6\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\Sys
>> tem32\Wbe
>>> m;C:\WINDOWS\system32\nls;C:\WINDOWS\system32\nls\ENGLISH;C:\Program
>> Files\Novel
>>> l\ZENworks\;C:\Program
>> Files\QuickTime\QTSystem;C:\ArcGIS\arcexe9x\bin;C:\Progra
>>> m Files\Common Files\GTK\2.0\bin;C:\Program Files\GPS Pathfinder
>> Office 3.10;C:\
>>> dpl;C:\Program Files\QuickTime\QTSystem\;C:\Program Files\SSH
>> Communications Sec
>>> urity\SSH Secure Shell;Z:.;
>>>
>>> I expect some cygwin or perl issue but I'm not sure how to proceed in
>> tracking this down. Cygwin is a fresh install as well. Any suggestions
>> on what to do next greatly appreciated.
>>> -A
>>>
>>> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
>>> Andy Bunn
>>> Environmental Sciences, Huxley College
>>> Western Washington University
>>> Bellingham, WA 98225-9181
>>> Skype: andy.bunn
>>> Phone: 360-650-4252
>>> Fax: 360-650-7284
>>> http://myweb.facstaff.wwu.edu/bunna/
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel


From armstrong.whit at gmail.com  Tue Dec  9 22:13:37 2008
From: armstrong.whit at gmail.com (Whit Armstrong)
Date: Tue, 9 Dec 2008 16:13:37 -0500
Subject: [Rd] any suggestions to deal with 'Argument list too long' for a R
	CMD check?
Message-ID: <8ec76080812091313q1b9cb41dyae03d46466170436@mail.gmail.com>

Since, gcc was using upwards of 2gb of ram to compile my package, I
just split all the functions into individual files.

I guess I'm too clever for myself, because now I get hit with the
"Argument list too long" error.

Is there a way to deal with this aside from writing my own configure
script (which could possibly feed the gcc commands one by one).

-Whit

RHEL 5
[whit at linuxsvr]$ uname -a
Linux linuxsvr.kls.corp 2.6.18-92.1.18.el5 #1 SMP Wed Nov 5 09:00:19
EST 2008 x86_64 x86_64 x86_64 GNU/Linux

from 00install.out:

* Installing *source* package 'RFincad' ...
** libs
g++ -I/usr/local/lib64/R/include  -I/usr/local/include
-I./RAbstraction -I./R.tslib.backend -I./tslib -fpic  -g -O2 -c
aaAccrual_days_act252.cpp -o aaAccrual_days_act2\
52.o
make: execvp: g++: Argument list too long
make: *** [aaAccrual_days_act252.o] Error 127
ERROR: compilation failed for package 'RFincad'
** Removing '/home/whit/dvl/fincad.utils/fincad.generate.R/RFincad.Rcheck/RFincad'


From jeff.a.ryan at gmail.com  Tue Dec  9 22:23:12 2008
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Tue, 9 Dec 2008 15:23:12 -0600
Subject: [Rd] any suggestions to deal with 'Argument list too long' for
	a R CMD check?
In-Reply-To: <8ec76080812091313q1b9cb41dyae03d46466170436@mail.gmail.com>
References: <8ec76080812091313q1b9cb41dyae03d46466170436@mail.gmail.com>
Message-ID: <e8e755250812091323p4729692ereab8569c693eb148@mail.gmail.com>

Never used, but I seem to recall that this was good for that:

http://en.wikipedia.org/wiki/Xargs

Jeff

On Tue, Dec 9, 2008 at 3:13 PM, Whit Armstrong <armstrong.whit at gmail.com> wrote:
> Since, gcc was using upwards of 2gb of ram to compile my package, I
> just split all the functions into individual files.
>
> I guess I'm too clever for myself, because now I get hit with the
> "Argument list too long" error.
>
> Is there a way to deal with this aside from writing my own configure
> script (which could possibly feed the gcc commands one by one).
>
> -Whit
>
> RHEL 5
> [whit at linuxsvr]$ uname -a
> Linux linuxsvr.kls.corp 2.6.18-92.1.18.el5 #1 SMP Wed Nov 5 09:00:19
> EST 2008 x86_64 x86_64 x86_64 GNU/Linux
>
> from 00install.out:
>
> * Installing *source* package 'RFincad' ...
> ** libs
> g++ -I/usr/local/lib64/R/include  -I/usr/local/include
> -I./RAbstraction -I./R.tslib.backend -I./tslib -fpic  -g -O2 -c
> aaAccrual_days_act252.cpp -o aaAccrual_days_act2\
> 52.o
> make: execvp: g++: Argument list too long
> make: *** [aaAccrual_days_act252.o] Error 127
> ERROR: compilation failed for package 'RFincad'
> ** Removing '/home/whit/dvl/fincad.utils/fincad.generate.R/RFincad.Rcheck/RFincad'
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Jeffrey Ryan
jeffrey.ryan at insightalgo.com

ia: insight algorithmics
www.insightalgo.com


From armstrong.whit at gmail.com  Tue Dec  9 22:26:54 2008
From: armstrong.whit at gmail.com (Whit Armstrong)
Date: Tue, 9 Dec 2008 16:26:54 -0500
Subject: [Rd] any suggestions to deal with 'Argument list too long' for
	a R CMD check?
In-Reply-To: <e8e755250812091323p4729692ereab8569c693eb148@mail.gmail.com>
References: <8ec76080812091313q1b9cb41dyae03d46466170436@mail.gmail.com>
	<e8e755250812091323p4729692ereab8569c693eb148@mail.gmail.com>
Message-ID: <8ec76080812091326qeb984a8k98882981a496a17@mail.gmail.com>

I love xargs for all kinds of stuff, but I really don't want to write
my own configure script.

looks like simple solution is to recombine into one big source file
rather than splitting each function out.  pita...

-Whit


On Tue, Dec 9, 2008 at 4:23 PM, Jeff Ryan <jeff.a.ryan at gmail.com> wrote:
> Never used, but I seem to recall that this was good for that:
>
> http://en.wikipedia.org/wiki/Xargs
>
> Jeff
>
> On Tue, Dec 9, 2008 at 3:13 PM, Whit Armstrong <armstrong.whit at gmail.com> wrote:
>> Since, gcc was using upwards of 2gb of ram to compile my package, I
>> just split all the functions into individual files.
>>
>> I guess I'm too clever for myself, because now I get hit with the
>> "Argument list too long" error.
>>
>> Is there a way to deal with this aside from writing my own configure
>> script (which could possibly feed the gcc commands one by one).
>>
>> -Whit
>>
>> RHEL 5
>> [whit at linuxsvr]$ uname -a
>> Linux linuxsvr.kls.corp 2.6.18-92.1.18.el5 #1 SMP Wed Nov 5 09:00:19
>> EST 2008 x86_64 x86_64 x86_64 GNU/Linux
>>
>> from 00install.out:
>>
>> * Installing *source* package 'RFincad' ...
>> ** libs
>> g++ -I/usr/local/lib64/R/include  -I/usr/local/include
>> -I./RAbstraction -I./R.tslib.backend -I./tslib -fpic  -g -O2 -c
>> aaAccrual_days_act252.cpp -o aaAccrual_days_act2\
>> 52.o
>> make: execvp: g++: Argument list too long
>> make: *** [aaAccrual_days_act252.o] Error 127
>> ERROR: compilation failed for package 'RFincad'
>> ** Removing '/home/whit/dvl/fincad.utils/fincad.generate.R/RFincad.Rcheck/RFincad'
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
>
> --
> Jeffrey Ryan
> jeffrey.ryan at insightalgo.com
>
> ia: insight algorithmics
> www.insightalgo.com
>


From leydold at statmath.wu-wien.ac.at  Tue Dec  9 15:04:07 2008
From: leydold at statmath.wu-wien.ac.at (Josef Leydold)
Date: Tue, 9 Dec 2008 15:04:07 +0100
Subject: [Rd] Warning from R CMD build
In-Reply-To: <mailman.17.1228647604.539.r-devel@r-project.org>
References: <mailman.17.1228647604.539.r-devel@r-project.org>
Message-ID: <20081209140406.GA8869@essek.stat-math.wu-wien.ac.at>

Hi,

I wonder about the reason for the following lines:

$ diff ~/local/lib64/R/bin/build /usr/lib64/R/bin/build 
40c40
< my $revision = ' $Rev: 46832 $ ';
---
> my $revision = ' $Rev: 45803 $ ';
576,579d570
<               if(-r "Makevars") {
<                   $makefiles .= " -f Makevars";
<                   R_system("${R::Vars::MAKE} $makefiles clean");
<               }

it produces a warning like

$ R-devel CMD build Runuran

[...]
* DONE (Runuran)
* creating vignettes ... OK
* cleaning src
make: *** No rule to make target `clean'.  Stop.
* running cleanup
* removing junk files
* checking for LF line-endings in source and make files
* checking for empty or unneeded directories
* building 'Runuran_0.8.900.tar.gz'


"Writing R Extensions" however says:

Note that @file{Makevars} should not normally contain targets, as it is
(except on Windows) included before the default makefile and
@command{make}
is called without an explicit target. 


Josef


From ripley at stats.ox.ac.uk  Tue Dec  9 22:48:01 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 9 Dec 2008 21:48:01 +0000 (GMT)
Subject: [Rd] Warning from R CMD build
In-Reply-To: <20081209140406.GA8869@essek.stat-math.wu-wien.ac.at>
References: <mailman.17.1228647604.539.r-devel@r-project.org>
	<20081209140406.GA8869@essek.stat-math.wu-wien.ac.at>
Message-ID: <alpine.LFD.2.00.0812092143150.20779@gannet.stats.ox.ac.uk>

The message (it is not even a warning) is harmless. The change is 
documented in the NEWS file, and is useful for some packages (Matrix as I 
recall).

On Tue, 9 Dec 2008, Josef Leydold wrote:

> Hi,
>
> I wonder about the reason for the following lines:
>
> $ diff ~/local/lib64/R/bin/build /usr/lib64/R/bin/build
> 40c40
> < my $revision = ' $Rev: 46832 $ ';
> ---
>> my $revision = ' $Rev: 45803 $ ';
> 576,579d570
> <               if(-r "Makevars") {
> <                   $makefiles .= " -f Makevars";
> <                   R_system("${R::Vars::MAKE} $makefiles clean");
> <               }
>
> it produces a warning like
>
> $ R-devel CMD build Runuran
>
> [...]
> * DONE (Runuran)
> * creating vignettes ... OK
> * cleaning src
> make: *** No rule to make target `clean'.  Stop.
> * running cleanup
> * removing junk files
> * checking for LF line-endings in source and make files
> * checking for empty or unneeded directories
> * building 'Runuran_0.8.900.tar.gz'
>
>
> "Writing R Extensions" however says:
>
> Note that @file{Makevars} should not normally contain targets, as it is
> (except on Windows) included before the default makefile and
> @command{make}
> is called without an explicit target.

Note 'normally'.

>
> Josef
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From mathieu.ribatet at epfl.ch  Tue Dec  9 23:07:58 2008
From: mathieu.ribatet at epfl.ch (Mathieu Ribatet)
Date: Tue, 09 Dec 2008 23:07:58 +0100
Subject: [Rd] any suggestions to deal with 'Argument list too long' for
 a R CMD check?
In-Reply-To: <8ec76080812091326qeb984a8k98882981a496a17@mail.gmail.com>
References: <8ec76080812091313q1b9cb41dyae03d46466170436@mail.gmail.com>	<e8e755250812091323p4729692ereab8569c693eb148@mail.gmail.com>
	<8ec76080812091326qeb984a8k98882981a496a17@mail.gmail.com>
Message-ID: <493EEC3E.2060202@epfl.ch>

Just a suggestion. I googled for your error message you got e.g. "make 
... error 127" and I got

Yeah, error 127 indicates that make can't find a program that it needs to
run a command.  My guess would be that she doesn't have g++ installed
(some distributions package it separately from gcc so it is possible to
have the c compiler installed but not the c++ compiler)



Maybe it will be worthwhile to check if you have installed every 
required header files or needed compilers/libraries.
But as I mentioned, this is just a suggestion.
Cheers,
Mathieu

Whit Armstrong a ?crit :
> I love xargs for all kinds of stuff, but I really don't want to write
> my own configure script.
>
> looks like simple solution is to recombine into one big source file
> rather than splitting each function out.  pita...
>
> -Whit
>
>
> On Tue, Dec 9, 2008 at 4:23 PM, Jeff Ryan <jeff.a.ryan at gmail.com> wrote:
>   
>> Never used, but I seem to recall that this was good for that:
>>
>> http://en.wikipedia.org/wiki/Xargs
>>
>> Jeff
>>
>> On Tue, Dec 9, 2008 at 3:13 PM, Whit Armstrong <armstrong.whit at gmail.com> wrote:
>>     
>>> Since, gcc was using upwards of 2gb of ram to compile my package, I
>>> just split all the functions into individual files.
>>>
>>> I guess I'm too clever for myself, because now I get hit with the
>>> "Argument list too long" error.
>>>
>>> Is there a way to deal with this aside from writing my own configure
>>> script (which could possibly feed the gcc commands one by one).
>>>
>>> -Whit
>>>
>>> RHEL 5
>>> [whit at linuxsvr]$ uname -a
>>> Linux linuxsvr.kls.corp 2.6.18-92.1.18.el5 #1 SMP Wed Nov 5 09:00:19
>>> EST 2008 x86_64 x86_64 x86_64 GNU/Linux
>>>
>>> from 00install.out:
>>>
>>> * Installing *source* package 'RFincad' ...
>>> ** libs
>>> g++ -I/usr/local/lib64/R/include  -I/usr/local/include
>>> -I./RAbstraction -I./R.tslib.backend -I./tslib -fpic  -g -O2 -c
>>> aaAccrual_days_act252.cpp -o aaAccrual_days_act2\
>>> 52.o
>>> make: execvp: g++: Argument list too long
>>> make: *** [aaAccrual_days_act252.o] Error 127
>>> ERROR: compilation failed for package 'RFincad'
>>> ** Removing '/home/whit/dvl/fincad.utils/fincad.generate.R/RFincad.Rcheck/RFincad'
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>>       
>>
>> --
>> Jeffrey Ryan
>> jeffrey.ryan at insightalgo.com
>>
>> ia: insight algorithmics
>> www.insightalgo.com
>>
>>     
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>   

-- 
Institute of Mathematics
Ecole Polytechnique F?d?rale de Lausanne
STAT-IMA-FSB-EPFL, Station 8
CH-1015 Lausanne   Switzerland
http://stat.epfl.ch/
Tel: + 41 (0)21 693 7907


From armstrong.whit at gmail.com  Tue Dec  9 23:19:01 2008
From: armstrong.whit at gmail.com (Whit Armstrong)
Date: Tue, 9 Dec 2008 17:19:01 -0500
Subject: [Rd] any suggestions to deal with 'Argument list too long' for
	a R CMD check?
In-Reply-To: <493EEC3E.2060202@epfl.ch>
References: <8ec76080812091313q1b9cb41dyae03d46466170436@mail.gmail.com>
	<e8e755250812091323p4729692ereab8569c693eb148@mail.gmail.com>
	<8ec76080812091326qeb984a8k98882981a496a17@mail.gmail.com>
	<493EEC3E.2060202@epfl.ch>
Message-ID: <8ec76080812091419s1cd838fdh32528b462c011a34@mail.gmail.com>

Thanks for the suggestion.  this package was building successfully
until I split it up into smaller files.

(there are 4489 files in the src directory)

I suspect it's a hard limit in the linux kernel.

http://www.linuxjournal.com/article/6060

since R CMD check is generating the actual commands that are passed to
bash, it's a little out of my control (unless I write my own config
script, which I do not want to do).

-Whit



On Tue, Dec 9, 2008 at 5:07 PM, Mathieu Ribatet <mathieu.ribatet at epfl.ch> wrote:
> Just a suggestion. I googled for your error message you got e.g. "make ...
> error 127" and I got
>
> Yeah, error 127 indicates that make can't find a program that it needs to
> run a command.  My guess would be that she doesn't have g++ installed
> (some distributions package it separately from gcc so it is possible to
> have the c compiler installed but not the c++ compiler)
>
>
>
> Maybe it will be worthwhile to check if you have installed every required
> header files or needed compilers/libraries.
> But as I mentioned, this is just a suggestion.
> Cheers,
> Mathieu
>
> Whit Armstrong a ?crit :
>>
>> I love xargs for all kinds of stuff, but I really don't want to write
>> my own configure script.
>>
>> looks like simple solution is to recombine into one big source file
>> rather than splitting each function out.  pita...
>>
>> -Whit
>>
>>
>> On Tue, Dec 9, 2008 at 4:23 PM, Jeff Ryan <jeff.a.ryan at gmail.com> wrote:
>>
>>>
>>> Never used, but I seem to recall that this was good for that:
>>>
>>> http://en.wikipedia.org/wiki/Xargs
>>>
>>> Jeff
>>>
>>> On Tue, Dec 9, 2008 at 3:13 PM, Whit Armstrong <armstrong.whit at gmail.com>
>>> wrote:
>>>
>>>>
>>>> Since, gcc was using upwards of 2gb of ram to compile my package, I
>>>> just split all the functions into individual files.
>>>>
>>>> I guess I'm too clever for myself, because now I get hit with the
>>>> "Argument list too long" error.
>>>>
>>>> Is there a way to deal with this aside from writing my own configure
>>>> script (which could possibly feed the gcc commands one by one).
>>>>
>>>> -Whit
>>>>
>>>> RHEL 5
>>>> [whit at linuxsvr]$ uname -a
>>>> Linux linuxsvr.kls.corp 2.6.18-92.1.18.el5 #1 SMP Wed Nov 5 09:00:19
>>>> EST 2008 x86_64 x86_64 x86_64 GNU/Linux
>>>>
>>>> from 00install.out:
>>>>
>>>> * Installing *source* package 'RFincad' ...
>>>> ** libs
>>>> g++ -I/usr/local/lib64/R/include  -I/usr/local/include
>>>> -I./RAbstraction -I./R.tslib.backend -I./tslib -fpic  -g -O2 -c
>>>> aaAccrual_days_act252.cpp -o aaAccrual_days_act2\
>>>> 52.o
>>>> make: execvp: g++: Argument list too long
>>>> make: *** [aaAccrual_days_act252.o] Error 127
>>>> ERROR: compilation failed for package 'RFincad'
>>>> ** Removing
>>>> '/home/whit/dvl/fincad.utils/fincad.generate.R/RFincad.Rcheck/RFincad'
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>>
>>>
>>> --
>>> Jeffrey Ryan
>>> jeffrey.ryan at insightalgo.com
>>>
>>> ia: insight algorithmics
>>> www.insightalgo.com
>>>
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
> --
> Institute of Mathematics
> Ecole Polytechnique F?d?rale de Lausanne
> STAT-IMA-FSB-EPFL, Station 8
> CH-1015 Lausanne   Switzerland
> http://stat.epfl.ch/
> Tel: + 41 (0)21 693 7907
>
>
>

From ripley at stats.ox.ac.uk  Tue Dec  9 23:41:59 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 9 Dec 2008 22:41:59 +0000 (GMT)
Subject: [Rd] any suggestions to deal with 'Argument list too long' for
 a R CMD check?
In-Reply-To: <8ec76080812091419s1cd838fdh32528b462c011a34@mail.gmail.com>
References: <8ec76080812091313q1b9cb41dyae03d46466170436@mail.gmail.com>
	<e8e755250812091323p4729692ereab8569c693eb148@mail.gmail.com>
	<8ec76080812091326qeb984a8k98882981a496a17@mail.gmail.com>
	<493EEC3E.2060202@epfl.ch>
	<8ec76080812091419s1cd838fdh32528b462c011a34@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.0812092228480.20100@gannet.stats.ox.ac.uk>

On Tue, 9 Dec 2008, Whit Armstrong wrote:

> Thanks for the suggestion.  this package was building successfully
> until I split it up into smaller files.
>
> (there are 4489 files in the src directory)
>
> I suspect it's a hard limit in the linux kernel.
>
> http://www.linuxjournal.com/article/6060
>
> since R CMD check is generating the actual commands that are passed to
> bash, it's a little out of my control (unless I write my own config
> script, which I do not want to do).

Well 'R CMD check' is not doing so: perhaps SHLIB called by INSTALL is.

What I suspect is happening is that there is a link command starting with 
'g++' that is too long.

POSIX requires at least 4096 arguments (which you will exceed), but Linux 
2.6 seems to have a limit of much more (unlimited in the current kernel, 
which yours is not, 32767 in 2.16.14).  It is more likely that you are 
hititng the length limit for the command line, and one way out is to use 
short file names.

One useful ref: http://www.in-ulm.de/~mascheck/various/argmax

Note that having all the functions in one file can help the optimizer, but 
there is another possibility, to have several files of closely related 
functions.


>
> -Whit
>
>
>
> On Tue, Dec 9, 2008 at 5:07 PM, Mathieu Ribatet <mathieu.ribatet at epfl.ch> wrote:
>> Just a suggestion. I googled for your error message you got e.g. "make ...
>> error 127" and I got
>>
>> Yeah, error 127 indicates that make can't find a program that it needs to
>> run a command.  My guess would be that she doesn't have g++ installed
>> (some distributions package it separately from gcc so it is possible to
>> have the c compiler installed but not the c++ compiler)
>>
>>
>>
>> Maybe it will be worthwhile to check if you have installed every required
>> header files or needed compilers/libraries.
>> But as I mentioned, this is just a suggestion.
>> Cheers,
>> Mathieu
>>
>> Whit Armstrong a ?crit :
>>>
>>> I love xargs for all kinds of stuff, but I really don't want to write
>>> my own configure script.
>>>
>>> looks like simple solution is to recombine into one big source file
>>> rather than splitting each function out.  pita...
>>>
>>> -Whit
>>>
>>>
>>> On Tue, Dec 9, 2008 at 4:23 PM, Jeff Ryan <jeff.a.ryan at gmail.com> wrote:
>>>
>>>>
>>>> Never used, but I seem to recall that this was good for that:
>>>>
>>>> http://en.wikipedia.org/wiki/Xargs
>>>>
>>>> Jeff
>>>>
>>>> On Tue, Dec 9, 2008 at 3:13 PM, Whit Armstrong <armstrong.whit at gmail.com>
>>>> wrote:
>>>>
>>>>>
>>>>> Since, gcc was using upwards of 2gb of ram to compile my package, I
>>>>> just split all the functions into individual files.
>>>>>
>>>>> I guess I'm too clever for myself, because now I get hit with the
>>>>> "Argument list too long" error.
>>>>>
>>>>> Is there a way to deal with this aside from writing my own configure
>>>>> script (which could possibly feed the gcc commands one by one).
>>>>>
>>>>> -Whit
>>>>>
>>>>> RHEL 5
>>>>> [whit at linuxsvr]$ uname -a
>>>>> Linux linuxsvr.kls.corp 2.6.18-92.1.18.el5 #1 SMP Wed Nov 5 09:00:19
>>>>> EST 2008 x86_64 x86_64 x86_64 GNU/Linux
>>>>>
>>>>> from 00install.out:
>>>>>
>>>>> * Installing *source* package 'RFincad' ...
>>>>> ** libs
>>>>> g++ -I/usr/local/lib64/R/include  -I/usr/local/include
>>>>> -I./RAbstraction -I./R.tslib.backend -I./tslib -fpic  -g -O2 -c
>>>>> aaAccrual_days_act252.cpp -o aaAccrual_days_act2\
>>>>> 52.o
>>>>> make: execvp: g++: Argument list too long
>>>>> make: *** [aaAccrual_days_act252.o] Error 127
>>>>> ERROR: compilation failed for package 'RFincad'
>>>>> ** Removing
>>>>> '/home/whit/dvl/fincad.utils/fincad.generate.R/RFincad.Rcheck/RFincad'
>>>>>
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>
>>>>>
>>>>
>>>> --
>>>> Jeffrey Ryan
>>>> jeffrey.ryan at insightalgo.com
>>>>
>>>> ia: insight algorithmics
>>>> www.insightalgo.com
>>>>
>>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>> --
>> Institute of Mathematics
>> Ecole Polytechnique F?d?rale de Lausanne
>> STAT-IMA-FSB-EPFL, Station 8
>> CH-1015 Lausanne   Switzerland
>> http://stat.epfl.ch/
>> Tel: + 41 (0)21 693 7907
>>
>>
>>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From armstrong.whit at gmail.com  Tue Dec  9 23:59:01 2008
From: armstrong.whit at gmail.com (Whit Armstrong)
Date: Tue, 9 Dec 2008 17:59:01 -0500
Subject: [Rd] any suggestions to deal with 'Argument list too long' for
	a R CMD check?
In-Reply-To: <alpine.LFD.2.00.0812092228480.20100@gannet.stats.ox.ac.uk>
References: <8ec76080812091313q1b9cb41dyae03d46466170436@mail.gmail.com>
	<e8e755250812091323p4729692ereab8569c693eb148@mail.gmail.com>
	<8ec76080812091326qeb984a8k98882981a496a17@mail.gmail.com>
	<493EEC3E.2060202@epfl.ch>
	<8ec76080812091419s1cd838fdh32528b462c011a34@mail.gmail.com>
	<alpine.LFD.2.00.0812092228480.20100@gannet.stats.ox.ac.uk>
Message-ID: <8ec76080812091459g15dda02se0f10d8e8a10cb48@mail.gmail.com>

Thanks for the link, Prof. Ripley.

> What I suspect is happening is that there is a link command starting with
> 'g++' that is too long.
> One useful ref: http://www.in-ulm.de/~mascheck/various/argmax

interesting...

on my system:

[whit at linuxsvr src]$ getconf ARG_MAX
131072
[whit at linuxsvr src]$

Let me try on another machine w/ a more recent kernel before I take up
more of everyone's time.

-Whit


From mauede at alice.it  Wed Dec 10 00:20:08 2008
From: mauede at alice.it (mauede at alice.it)
Date: Wed, 10 Dec 2008 00:20:08 +0100 (CET)
Subject: [Rd] package "wmtsa": wavCWTPeaks error (PR#13381)
Message-ID: <20081209232008.28544282EFC2@mail.pubhealth.ku.dk>

Full_Name: Maura Monville
Version: 2.8
OS: Mac OS/X 10.5
Submission from: (NULL) (87.4.122.234)


 Here is the code that causes wavCWTPeaks error
aats <- create.signalSeries(aa, pos=list(from=0.0, by=0.033))
aa.cwt <-  wavCWT(aats)              
x11 (width=10,height=12)
plot (aats,main=paste(insig," Cycle: ",j,sep=""))  
aa.maxtree <- wavCWTTree (aa.cwt, type="maxima")
aa.mintree <- wavCWTTree (aa.cwt, type="minima")
aa.maxpeak <- wavCWTPeaks (aa.maxtree)
aa.minpeak <- wavCWTPeaks (aa.mintree)
      Error in `row.names<-.data.frame`(`*tmp*`, value = c("1", "0")) :
      invalid 'row.names' length
bb <- -aa   #EXCHANGE MAXIMA WITH MINIMA
bbts <- create.signalSeries(bb, pos=list(from=0.0, by=0.033))
plot (bbts,main=paste(insig," Cycle: ",j,sep=""))
plot (bbts,main=paste(insig," Cycle: ",j,sep=""))
bb.cwt <-  wavCWT(bbts)
bb.maxtree <- wavCWTTree (bb.cwt, type="maxima")
bb.mintree <- wavCWTTree (bb.cwt, type="minima")
bb.maxpeak <- wavCWTPeaks (bb.maxtree)
      Error in `row.names<-.data.frame`(`*tmp*`, value = c("1", "0")) :
      invalid 'row.names' length
bb.minpeak <- wavCWTPeaks (bb.mintree)
      Error in `row.names<-.data.frame`(`*tmp*`, value = c("1", "0")) :
      invalid 'row.names' length
My data vector is as follows:
> aa
  [1] -0.852625404 -0.886941142 -0.920699269 -0.953858240 -0.986377090
  [6] -1.018215725 -1.049335086 -1.079697274 -1.109265628 -1.138004782
 [11] -1.165880733 -1.192860894 -1.218914146 -1.244010899 -1.268123116
 [16] -1.291224432 -1.313290096 -1.334297111 -1.354224193 -1.373051833
 [21] -1.390762317 -1.407339716 -1.422769965 -1.437040775 -1.450141701
 [26] -1.462064157 -1.472801336 -1.482348272 -1.490701780 -1.497860461
 [31] -1.503824640 -1.508596384 -1.512179425 -1.514579128 -1.515802478
 [36] -1.515858035 -1.514755845 -1.512507449 -1.509125815 -1.504625250
 [41] -1.499021421 -1.492331231 -1.484572809 -1.475765432 -1.465929450
 [46] -1.455086269 -1.443258266 -1.430468724 -1.416741774 -1.402102340
 [51] -1.386576077 -1.370189287 -1.352968891 -1.334942359 -1.316137624
 [56] -1.296583049 -1.276307350 -1.255339556 -1.233708931 -1.211444912
 [61] -1.188577082 -1.165135088 -1.141148591 -1.116647219 -1.091660532
 [66] -1.066217945 -1.040348675 -1.014081694 -0.987445689 -0.960469010
 [71] -0.933179631 -0.905605109 -0.877772541 -0.849708278 -0.821438088
 [76] -0.792987122 -0.764379898 -0.735640266 -0.706791393 -0.677855738
 [81] -0.648855033 -0.619810274 -0.590741693 -0.561668758 -0.532610156
 [86] -0.503583784 -0.474606745 -0.445695338 -0.416865062 -0.388130609
 [91] -0.359505865 -0.331003918 -0.302637056 -0.274416782 -0.246353810
 [96] -0.218458088 -0.190738802 -0.163204394 -0.135862573 -0.108720337
[101] -0.081783987 -0.055059152 -0.028550808 -0.002263304  0.023799613
[106]  0.049634774  0.075239551  0.100611836  0.125750005  0.150652886
[111]  0.175319722  0.199750141  0.223944116  0.247901927  0.271624125
[116]  0.295111492  0.318365000  0.341385774  0.364175049  0.386734130
[121]  0.409064353  0.431167045  0.453043480  0.474694850  0.496122212
[126]  0.517326465  0.538308303  0.559068185  0.579606300  0.599922532
[131]  0.620016432  0.639887183  0.659533578  0.678953988  0.698146340
[136]  0.716367156  0.734459833  0.752428741  0.770277372  0.788008310
[141]  0.805623188  0.823122667  0.840506396  0.857773019  0.874920094
[146]  0.891944162  0.908840641  0.925603903  0.942227205  0.958702728
[151]  0.975021541  0.991173645  1.007147946  1.022932278  1.038513449
[156]  1.053877190  1.069008243  1.083890313  1.098506181  1.112837647
[161]  1.126865608  1.140570088  1.153930270  1.166924526  1.179530477
[166]  1.191725035  1.203484451  1.214784382  1.225599912  1.235905642
[171]  1.245675755  1.254884072  1.263504095  1.271509107  1.278872248
[176]  1.285566555  1.291565077  1.296840902  1.301367293  1.305117743
[181]  1.308066011  1.310186290  1.311453212  1.311841963  1.311328350
[186]  1.309888930  1.307500999  1.304142758  1.299793348  1.294432925
[191]  1.288042752  1.280605267  1.272104143  1.262524364  1.251852272
[196]  1.240075658  1.227183764  1.213167403  1.198018950  1.181732402
[201]  1.164303440  1.145729407  1.126009401  1.105144212  1.083136426
[206]  1.059990384  1.035712188  1.010309729  0.983792617  0.956172242
[211]  0.927461713  0.897675875  0.866831225  0.834945955  0.802039881
[216]  0.768134393  0.733252445  0.697418506  0.660658502  0.622999781
[221]  0.584471057  0.545102363  0.504924994  0.463971453  0.422275398
[226]  0.379871580  0.336795792  0.293084805  0.248776314  0.203908880
[231]  0.158521870  0.112655403  0.066350293  0.019647991 -0.027409468
[236] -0.074779520 -0.122419124 -0.170284817 -0.218332766 -0.266518818
[241] -0.314798550


From ripley at stats.ox.ac.uk  Wed Dec 10 12:41:50 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Wed, 10 Dec 2008 11:41:50 +0000 (GMT)
Subject: [Rd] package "wmtsa": wavCWTPeaks error (PR#13381)
In-Reply-To: <20081209232008.28544282EFC2@mail.pubhealth.ku.dk>
References: <20081209232008.28544282EFC2@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0812101137400.15674@gannet.stats.ox.ac.uk>

Please do not abuse R-bugs for a report on a contributed package.
Only the maintainer (Cc:ed here) can do anything about it (and I 
don't think he reads this list).

On Wed, 10 Dec 2008, mauede at alice.it wrote:

> Full_Name: Maura Monville
> Version: 2.8
> OS: Mac OS/X 10.5
> Submission from: (NULL) (87.4.122.234)
>
>
> Here is the code that causes wavCWTPeaks error
> aats <- create.signalSeries(aa, pos=list(from=0.0, by=0.033))
> aa.cwt <-  wavCWT(aats)
> x11 (width=10,height=12)
> plot (aats,main=paste(insig," Cycle: ",j,sep=""))
> aa.maxtree <- wavCWTTree (aa.cwt, type="maxima")
> aa.mintree <- wavCWTTree (aa.cwt, type="minima")
> aa.maxpeak <- wavCWTPeaks (aa.maxtree)
> aa.minpeak <- wavCWTPeaks (aa.mintree)
>      Error in `row.names<-.data.frame`(`*tmp*`, value = c("1", "0")) :
>      invalid 'row.names' length
> bb <- -aa   #EXCHANGE MAXIMA WITH MINIMA
> bbts <- create.signalSeries(bb, pos=list(from=0.0, by=0.033))
> plot (bbts,main=paste(insig," Cycle: ",j,sep=""))
> plot (bbts,main=paste(insig," Cycle: ",j,sep=""))
> bb.cwt <-  wavCWT(bbts)
> bb.maxtree <- wavCWTTree (bb.cwt, type="maxima")
> bb.mintree <- wavCWTTree (bb.cwt, type="minima")
> bb.maxpeak <- wavCWTPeaks (bb.maxtree)
>      Error in `row.names<-.data.frame`(`*tmp*`, value = c("1", "0")) :
>      invalid 'row.names' length
> bb.minpeak <- wavCWTPeaks (bb.mintree)
>      Error in `row.names<-.data.frame`(`*tmp*`, value = c("1", "0")) :
>      invalid 'row.names' length
> My data vector is as follows:
>> aa
>  [1] -0.852625404 -0.886941142 -0.920699269 -0.953858240 -0.986377090
>  [6] -1.018215725 -1.049335086 -1.079697274 -1.109265628 -1.138004782
> [11] -1.165880733 -1.192860894 -1.218914146 -1.244010899 -1.268123116
> [16] -1.291224432 -1.313290096 -1.334297111 -1.354224193 -1.373051833
> [21] -1.390762317 -1.407339716 -1.422769965 -1.437040775 -1.450141701
> [26] -1.462064157 -1.472801336 -1.482348272 -1.490701780 -1.497860461
> [31] -1.503824640 -1.508596384 -1.512179425 -1.514579128 -1.515802478
> [36] -1.515858035 -1.514755845 -1.512507449 -1.509125815 -1.504625250
> [41] -1.499021421 -1.492331231 -1.484572809 -1.475765432 -1.465929450
> [46] -1.455086269 -1.443258266 -1.430468724 -1.416741774 -1.402102340
> [51] -1.386576077 -1.370189287 -1.352968891 -1.334942359 -1.316137624
> [56] -1.296583049 -1.276307350 -1.255339556 -1.233708931 -1.211444912
> [61] -1.188577082 -1.165135088 -1.141148591 -1.116647219 -1.091660532
> [66] -1.066217945 -1.040348675 -1.014081694 -0.987445689 -0.960469010
> [71] -0.933179631 -0.905605109 -0.877772541 -0.849708278 -0.821438088
> [76] -0.792987122 -0.764379898 -0.735640266 -0.706791393 -0.677855738
> [81] -0.648855033 -0.619810274 -0.590741693 -0.561668758 -0.532610156
> [86] -0.503583784 -0.474606745 -0.445695338 -0.416865062 -0.388130609
> [91] -0.359505865 -0.331003918 -0.302637056 -0.274416782 -0.246353810
> [96] -0.218458088 -0.190738802 -0.163204394 -0.135862573 -0.108720337
> [101] -0.081783987 -0.055059152 -0.028550808 -0.002263304  0.023799613
> [106]  0.049634774  0.075239551  0.100611836  0.125750005  0.150652886
> [111]  0.175319722  0.199750141  0.223944116  0.247901927  0.271624125
> [116]  0.295111492  0.318365000  0.341385774  0.364175049  0.386734130
> [121]  0.409064353  0.431167045  0.453043480  0.474694850  0.496122212
> [126]  0.517326465  0.538308303  0.559068185  0.579606300  0.599922532
> [131]  0.620016432  0.639887183  0.659533578  0.678953988  0.698146340
> [136]  0.716367156  0.734459833  0.752428741  0.770277372  0.788008310
> [141]  0.805623188  0.823122667  0.840506396  0.857773019  0.874920094
> [146]  0.891944162  0.908840641  0.925603903  0.942227205  0.958702728
> [151]  0.975021541  0.991173645  1.007147946  1.022932278  1.038513449
> [156]  1.053877190  1.069008243  1.083890313  1.098506181  1.112837647
> [161]  1.126865608  1.140570088  1.153930270  1.166924526  1.179530477
> [166]  1.191725035  1.203484451  1.214784382  1.225599912  1.235905642
> [171]  1.245675755  1.254884072  1.263504095  1.271509107  1.278872248
> [176]  1.285566555  1.291565077  1.296840902  1.301367293  1.305117743
> [181]  1.308066011  1.310186290  1.311453212  1.311841963  1.311328350
> [186]  1.309888930  1.307500999  1.304142758  1.299793348  1.294432925
> [191]  1.288042752  1.280605267  1.272104143  1.262524364  1.251852272
> [196]  1.240075658  1.227183764  1.213167403  1.198018950  1.181732402
> [201]  1.164303440  1.145729407  1.126009401  1.105144212  1.083136426
> [206]  1.059990384  1.035712188  1.010309729  0.983792617  0.956172242
> [211]  0.927461713  0.897675875  0.866831225  0.834945955  0.802039881
> [216]  0.768134393  0.733252445  0.697418506  0.660658502  0.622999781
> [221]  0.584471057  0.545102363  0.504924994  0.463971453  0.422275398
> [226]  0.379871580  0.336795792  0.293084805  0.248776314  0.203908880
> [231]  0.158521870  0.112655403  0.066350293  0.019647991 -0.027409468
> [236] -0.074779520 -0.122419124 -0.170284817 -0.218332766 -0.266518818
> [241] -0.314798550
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From armstrong.whit at gmail.com  Wed Dec 10 14:17:50 2008
From: armstrong.whit at gmail.com (Whit Armstrong)
Date: Wed, 10 Dec 2008 08:17:50 -0500
Subject: [Rd] any suggestions to deal with 'Argument list too long' for
	a R CMD check?
In-Reply-To: <8ec76080812091459g15dda02se0f10d8e8a10cb48@mail.gmail.com>
References: <8ec76080812091313q1b9cb41dyae03d46466170436@mail.gmail.com>
	<e8e755250812091323p4729692ereab8569c693eb148@mail.gmail.com>
	<8ec76080812091326qeb984a8k98882981a496a17@mail.gmail.com>
	<493EEC3E.2060202@epfl.ch>
	<8ec76080812091419s1cd838fdh32528b462c011a34@mail.gmail.com>
	<alpine.LFD.2.00.0812092228480.20100@gannet.stats.ox.ac.uk>
	<8ec76080812091459g15dda02se0f10d8e8a10cb48@mail.gmail.com>
Message-ID: <8ec76080812100517i1b9c1e99xb9490024f9223f1b@mail.gmail.com>

This package built successfully on ubuntu 8.10.

Thanks to everyone for the suggestions!

Since the new method (splitting the files) will fail for anyone not
using a very recent linux kernel, I think I should revert to the old
consolidated files.

I suspect there is little interest from R-core in changing the build
script to link the files incrementally (is that possible).  To my
knowledge no other packages out there have such an insane amount of
files.

-Whit


On Tue, Dec 9, 2008 at 5:59 PM, Whit Armstrong <armstrong.whit at gmail.com> wrote:
> Thanks for the link, Prof. Ripley.
>
>> What I suspect is happening is that there is a link command starting with
>> 'g++' that is too long.
>> One useful ref: http://www.in-ulm.de/~mascheck/various/argmax
>
> interesting...
>
> on my system:
>
> [whit at linuxsvr src]$ getconf ARG_MAX
> 131072
> [whit at linuxsvr src]$
>
> Let me try on another machine w/ a more recent kernel before I take up
> more of everyone's time.
>
> -Whit
>


From ifellows at ucsd.edu  Wed Dec 10 20:40:13 2008
From: ifellows at ucsd.edu (ifellows at ucsd.edu)
Date: Wed, 10 Dec 2008 20:40:13 +0100 (CET)
Subject: [Rd] make.rtest issue (PR#13388)
Message-ID: <20081210194013.A3A0F282C761@mail.pubhealth.ku.dk>

Hello all,

Thanks for all the hard work. I am building the rtest.c example, and I
encountered a linking error. Perhaps the error is mine, but the makefile did
not seem to be able to find graphapp.dll.

C:\R-2.8.0\R-2.8.0\src\gnuwin32\front-ends>make -f make.rtest
gcc  -std=gnu99   -Wall -O2 -pedantic -I.. -I../../include -I../../extra  -c
rtest.c -o rtest.o
gcc  -std=gnu99 -Wl,--stack=0xA00000 -s -o Rtest.exe rtest.o -L../../../bin
-lR -lgraphapp
c:/rtools/mingw/bin/../lib/gcc/mingw32/4.2.1-sjlj/../../../../mingw32/bin/ld
.exe: cannot find -lgraphapp
collect2: ld returned 1 exit status
make: *** [Rtest.exe] Error 1


Changing the relevant line of make.rtest to
	$(CC) $(LINKFLAGS) -o $@ rtest.o -L../../../bin -lR -lRgraphapp
resolved the issue. I searched and could not find any reference to this
problem on the lists.

Cheers,
Ian Fellows


From R.Legaie at warwick.ac.uk  Wed Dec 10 20:07:22 2008
From: R.Legaie at warwick.ac.uk (Legaie, Roxane)
Date: Wed, 10 Dec 2008 19:07:22 -0000
Subject: [Rd] FW: Kegg.db with GOstats
References: <FDEA4C92FBF2FE4197747DDD3548D6AFB9FBF6@LAUREL.ads.warwick.ac.uk>
	<49400EC7.2060301@fhcrc.org>
Message-ID: <FDEA4C92FBF2FE4197747DDD3548D6AFB9FBF7@LAUREL.ads.warwick.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081210/5f4220c0/attachment.pl>

From mflawren at fhcrc.org  Thu Dec 11 16:09:02 2008
From: mflawren at fhcrc.org (Michael Lawrence)
Date: Thu, 11 Dec 2008 07:09:02 -0800
Subject: [Rd] S4 coercion
In-Reply-To: <6ph1w0ao3z7.fsf@lamprey.fhcrc.org>
References: <48B55EB1.5020602@bank-banque-canada.ca>
	<6ph1w0ao3z7.fsf@lamprey.fhcrc.org>
Message-ID: <509e0620812110709p47b28dbana529b4efd6552606@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081211/3663730c/attachment.pl>

From ripley at stats.ox.ac.uk  Thu Dec 11 16:54:11 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 11 Dec 2008 15:54:11 +0000 (GMT)
Subject: [Rd] Checking your package's help files
In-Reply-To: <alpine.LFD.2.00.0812071023060.26715@gannet.stats.ox.ac.uk>
References: <alpine.LFD.2.00.0812071023060.26715@gannet.stats.ox.ac.uk>
Message-ID: <alpine.LFD.2.00.0812111552070.3218@gannet.stats.ox.ac.uk>

The check summaries now available at

http://cran.r-project.org/web/checks/check_summary.html

will indicate most of the problems being detected in CRAN packages: look 
at the log (click on the link) for your package in the first or second 
column.

On Sun, 7 Dec 2008, Prof Brian Ripley wrote:

> It seems that many package authors do not proofread the help installed with 
> their packages.  The Rd converter is not a parser, and it will silently 
> produce incorrect results on incorrect input (and some correct input).
>
> Here are a few hints about some common errors:
>
> 1) When you run R CMD check you get a PDF manual at 
> <pkg>.Rcheck/<pkg>-manual.pdf.  Read through it looking for missing/empty and 
> mis-formatted entries.
>
>
> 2) Try installing the package under a current R-devel (as of today). This 
> will report on errors of the form
>
> \item{foo} {item text}
>
> with, NB, invalid space between the two arguments.   Earlier versions of R 
> assume that the item had no text and so '{item text}' is never processed (not 
> even checked for validity).  This results in at best missing information and 
> at worse nonsense.
>
>
> 3) Grep the installed help for internal constructs, e.g.
>
> grep normal-bracket <installed-package>/help/*
>
> Three ways I have found such constructs to appear in the processed files:
>
> a) If you see 'eqnnormal-bracket' then you have a one-argument \eqn (or 
> possibly \deqn) command immediately followed by }.  This is correct Rd but 
> mis-processed in earlier versions of R.  In all the cases I have seen it 
> comes from grammatically incorrect help files of the form
>
> \item{foo}{... \eqn{x}}
>
> where the item should end in ',' or '.'.  But if you don't want to do that, 
> at least use a space before the brace.  I found this in packages
> distrMod, flexclust, geepack, geoR, psychometric, robustbase and uroot.
>
> b) Many packages have help files with 'normal-bracket' at the end of a 
> processed \value section.  In all the cases I looked at, this results from 
> using \itemize{} inside \value -- that does not work as \value is implicitly 
> an itemize environment.
>
> c) Using markup in verbatim-like environments will lead to nonsensical 
> output: it seems the most common error is to use \code inside \examples. What 
> markup is allowed where is not very well defined: Duncan Murdoch has started 
> to document this at http://developer.r-project.org/parseRd.pdf but that 
> currently is more a description of what should happen, not what has been 
> implemented.
>
> These issues are not rare (except 3a): about 10% of CRAN packages have them.
>
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From adrian_d at eskimo.com  Thu Dec 11 18:48:36 2008
From: adrian_d at eskimo.com (Adrian Dragulescu)
Date: Thu, 11 Dec 2008 09:48:36 -0800 (PST)
Subject: [Rd] enhancement proposals to R
Message-ID: <Pine.SUN.4.58.0812110932090.5914@eskimo.com>


Hello,

I am not aware of any facility for users to submit proposals for
R enhancements.  Something along the lines Phython has:
http://www.python.org/dev/peps/

It would also be interesting to have a way for people to vote on the
proposals in order to get a feeling for the importance of the additions
from the point of view of the user.  R-core could then gauge better the
useRs current needs.

For a major project that would require significant resources, maybe some
work can be outsourced to other developers if R-core is too busy or if the
supporters are willing to sponsor the project financially.  One such large
project would be to add multi-threading capabilities into R.

What do you think?

Adrian Dragulescu


From therneau at mayo.edu  Fri Dec 12 00:04:54 2008
From: therneau at mayo.edu (Terry Therneau)
Date: Thu, 11 Dec 2008 17:04:54 -0600 (CST)
Subject: [Rd] package development
Message-ID: <200812112304.mBBN4stJ008607@rocky.mayo.edu>

  I'm making the move of the survival package from my own environment to,
and have stumbled into a vacuum.   The R Extensions manual has really nice
instructions about how to lay out the directories, order the files, and
run tests for DISTRIBUTION of a product, but I can't find anything on how
to set up a reasonable DEVELOPMENT environment.
   In my local world, I had the .c and .s files in a common directory, with
a Makefile that I had created, and the test suite in a subdirectory.  Debugging
and development was quite nice.
	make
	cd test
	R
	attach("..")
		try something and perhaps it fails
	q()
	cd ..
Fix and repeat. The Makefile took some time to create, but paid for itself a
hundred times over. 

  So, I've now rearranged everything into standard R order.  Then I did the
only thing I could find
	R CMD INSTALL ~/myRlib  survival  
where "survival" is said directory.   This turns out to be not useful at all.
The survival package is large, and I rather suspected that I would goof 
something up, and I did, resulting in the following message

	Error in parse(n = -1, file = file) : unexpected end of input at
        14450: }
        14451: 

It is not exactly obvious which of the 132 files in my R/ directory is the 
culprit here.

   In general:
1. The library is large, and recompiling/reparsing everything is very far from
instantaneous.  It is not the edit/load cycle I desire.

2. I take testing seriously: the test suite takes on the order of 15 minutes to
run on a fast machine.  I most certainly don't want to run it in the mid cycle.

   Someone must have tackled this.  I'm hoping that there is some documentation
that I have managed to overlook which discussess a good setup for this middle
ground between concieving of a library and packaging it for delivery; the
"build, test, make sure it acually works" part of development.

	Terry Therneau


From mathieu.ribatet at epfl.ch  Fri Dec 12 00:43:11 2008
From: mathieu.ribatet at epfl.ch (Mathieu Ribatet)
Date: Fri, 12 Dec 2008 00:43:11 +0100
Subject: [Rd] package development
In-Reply-To: <200812112304.mBBN4stJ008607@rocky.mayo.edu>
References: <200812112304.mBBN4stJ008607@rocky.mayo.edu>
Message-ID: <4941A58F.60206@epfl.ch>

Dear Terry,

One way to locate which file is wrong - surely not the most brillant 
way! You could do an R script that sources each of your .R files within 
a "for (file in file.names)" loop.
When R will stop, it will indicate which file has a wrong syntax and 
more info.

Cheers,
Mathieu

Terry Therneau a ?crit :
>   I'm making the move of the survival package from my own environment to,
> and have stumbled into a vacuum.   The R Extensions manual has really nice
> instructions about how to lay out the directories, order the files, and
> run tests for DISTRIBUTION of a product, but I can't find anything on how
> to set up a reasonable DEVELOPMENT environment.
>    In my local world, I had the .c and .s files in a common directory, with
> a Makefile that I had created, and the test suite in a subdirectory.  Debugging
> and development was quite nice.
> 	make
> 	cd test
> 	R
> 	attach("..")
> 		try something and perhaps it fails
> 	q()
> 	cd ..
> Fix and repeat. The Makefile took some time to create, but paid for itself a
> hundred times over. 
>
>   So, I've now rearranged everything into standard R order.  Then I did the
> only thing I could find
> 	R CMD INSTALL ~/myRlib  survival  
> where "survival" is said directory.   This turns out to be not useful at all.
> The survival package is large, and I rather suspected that I would goof 
> something up, and I did, resulting in the following message
>
> 	Error in parse(n = -1, file = file) : unexpected end of input at
>         14450: }
>         14451: 
>
> It is not exactly obvious which of the 132 files in my R/ directory is the 
> culprit here.
>
>    In general:
> 1. The library is large, and recompiling/reparsing everything is very far from
> instantaneous.  It is not the edit/load cycle I desire.
>
> 2. I take testing seriously: the test suite takes on the order of 15 minutes to
> run on a fast machine.  I most certainly don't want to run it in the mid cycle.
>
>    Someone must have tackled this.  I'm hoping that there is some documentation
> that I have managed to overlook which discussess a good setup for this middle
> ground between concieving of a library and packaging it for delivery; the
> "build, test, make sure it acually works" part of development.
>
> 	Terry Therneau
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>   

-- 
Institute of Mathematics
Ecole Polytechnique F?d?rale de Lausanne
STAT-IMA-FSB-EPFL, Station 8
CH-1015 Lausanne   Switzerland
http://stat.epfl.ch/
Tel: + 41 (0)21 693 7907


From Mark.Bravington at csiro.au  Fri Dec 12 00:59:30 2008
From: Mark.Bravington at csiro.au (Mark.Bravington at csiro.au)
Date: Fri, 12 Dec 2008 10:59:30 +1100
Subject: [Rd] package development
In-Reply-To: <200812112304.mBBN4stJ008607@rocky.mayo.edu>
References: <200812112304.mBBN4stJ008607@rocky.mayo.edu>
Message-ID: <62C82B39B8A85E4B95A18F7F7B852F870FD7B1B5@exvic-mbx03.nexus.csiro.au>

Hi Terry

I suspect many people struggle with similar issues.

The new version of mvbutils contains a number of routines that facilitate creation & maintenance of a package, hopefully through its entire life-cycle: from "documenting your own stuff for personal use", through "giving out semi-documented code that your mates can use", through "getting it through all the CRAN hoops", through "maintaining & changing an already-installed-and-loaded package".

There is support for creating & editing functions (etc) in your own "development" package while it's already loaded, plus speedy on-the-fly updating of the installed version of the package. These in particular are things that R does not make easy by default (probably for good reasons). Plus: you don't have to learn Rd format if you don't want to-- the package-creator in mvbutils will generate Rd documentation for you based on plain-text documentation.

Use of these package-creation-maintenance routines does require some level of buy-in to 'mvbutils's view of how your working life in R should be organized... basically 'cd' and 'fixr'.  I don't reckon this should be much of a drama for most people, but there are so many different ways of working in R, so who knows?

I use these routines perpetually (maintaining about 6 packages), but as far as the rest of the universe goes, they are still alpha-releases. They are geared to the way I work, and so as yet might not do what others want; however, if there's demand and feasibility, I'm happy to try to incorporate other features. In particular, the documentation is incomplete at present, and I therefore haven't over-advertised the package-maintenance stuff until I get time to write a "how-to" article.

[I've had to release the package-maintenance stuff in a slightly undercooked state, because it is intimately bound to the guts of mvbutils, and it became necessary to roll out a maintenance release of mvbutils for other reasons.]

Let me know if this might be of further interest to you

Mark

-- 
Mark Bravington
CSIRO Mathematical & Information Sciences
Marine Laboratory
Castray Esplanade
Hobart 7001
TAS

ph (+61) 3 6232 5118
fax (+61) 3 6232 5012
mob (+61) 438 315 623

Terry Therneau wrote:
>   I'm making the move of the survival package from my own environment
> to, 
> and have stumbled into a vacuum.   The R Extensions manual has really
> nice instructions about how to lay out the directories, order the
> files, and 
> run tests for DISTRIBUTION of a product, but I can't find anything on
> how 
> to set up a reasonable DEVELOPMENT environment.
>    In my local world, I had the .c and .s files in a common
> directory, with 
> a Makefile that I had created, and the test suite in a subdirectory. 
> Debugging and development was quite nice.
> 	make
> 	cd test
> 	R
> 	attach("..")
> 		try something and perhaps it fails
> 	q()
> 	cd ..
> Fix and repeat. The Makefile took some time to create, but paid for
> itself a hundred times over.
> 
>   So, I've now rearranged everything into standard R order.  Then I
> did the only thing I could find
> 	R CMD INSTALL ~/myRlib  survival
> where "survival" is said directory.   This turns out to be not useful
> at all. The survival package is large, and I rather suspected that I
> would goof something up, and I did, resulting in the following message
> 
> 	Error in parse(n = -1, file = file) : unexpected end of input at
>         14450: }
>         14451:
> 
> It is not exactly obvious which of the 132 files in my R/ directory
> is the culprit here.
> 
>    In general:
> 1. The library is large, and recompiling/reparsing everything is very
> far from instantaneous.  It is not the edit/load cycle I desire.
> 
> 2. I take testing seriously: the test suite takes on the order of 15
> minutes to run on a fast machine.  I most certainly don't want to run
> it in the mid cycle. 
> 
>    Someone must have tackled this.  I'm hoping that there is some
> documentation that I have managed to overlook which discussess a good
> setup for this middle ground between concieving of a library and
> packaging it for delivery; the "build, test, make sure it acually
> works" part of development. 
> 
> 	Terry Therneau
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

From murdoch at stats.uwo.ca  Fri Dec 12 01:00:21 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 11 Dec 2008 19:00:21 -0500
Subject: [Rd] package development
In-Reply-To: <200812112304.mBBN4stJ008607@rocky.mayo.edu>
References: <200812112304.mBBN4stJ008607@rocky.mayo.edu>
Message-ID: <4941A995.1040409@stats.uwo.ca>

On 11/12/2008 6:04 PM, Terry Therneau wrote:
>   I'm making the move of the survival package from my own environment to,
> and have stumbled into a vacuum.   The R Extensions manual has really nice
> instructions about how to lay out the directories, order the files, and
> run tests for DISTRIBUTION of a product, but I can't find anything on how
> to set up a reasonable DEVELOPMENT environment.
>    In my local world, I had the .c and .s files in a common directory, with
> a Makefile that I had created, and the test suite in a subdirectory.  Debugging
> and development was quite nice.
> 	make
> 	cd test
> 	R
> 	attach("..")
> 		try something and perhaps it fails
> 	q()
> 	cd ..
> Fix and repeat. The Makefile took some time to create, but paid for itself a
> hundred times over. 
> 
>   So, I've now rearranged everything into standard R order.  Then I did the
> only thing I could find
> 	R CMD INSTALL ~/myRlib  survival  
> where "survival" is said directory.   This turns out to be not useful at all.
> The survival package is large, and I rather suspected that I would goof 
> something up, and I did, resulting in the following message
> 
> 	Error in parse(n = -1, file = file) : unexpected end of input at
>         14450: }
>         14451: 
> 
> It is not exactly obvious which of the 132 files in my R/ directory is the 
> culprit here.

That's something I would like to fix too.  There are (at least) two 
possible ways:  stop concatenating the files (which is not really needed 
nowadays, most packages install saved images), or add some markup to the 
concatenated file so that the parser can report on the original filename 
and line number (like the #LINE directives output by the C preprocessor).

> 
>    In general:
> 1. The library is large, and recompiling/reparsing everything is very far from
> instantaneous.  It is not the edit/load cycle I desire.

If you install from the directory, the compiling should only be done 
once (unless you change a file, of course).  (The alternative is 
installing from the tarball, which is recommended for later stages of 
testing before distribution, because it's possible something could go 
wrong in building the tarball.  But it won't include any object files, 
so you'll recompile every time.)

You can also use option "--docs=none" to skip building the help system; 
this will save a bit of time.


> 
> 2. I take testing seriously: the test suite takes on the order of 15 minutes to
> run on a fast machine.  I most certainly don't want to run it in the mid cycle.

I don't quite follow this.  If you want to run all your tests, you would 
use R CMD check.  If you only want to run some of them, then you can 
source things out of the tests directory while running interactively.

>    Someone must have tackled this.  I'm hoping that there is some documentation
> that I have managed to overlook which discussess a good setup for this middle
> ground between concieving of a library and packaging it for delivery; the
> "build, test, make sure it acually works" part of development.

I find the process I follow is to organize the files in the distribution 
structure from the beginning.   When adding new functions, I'll 
generally use source() a few times to get the syntax right, and perhaps 
run simple tests.  (But remember, if you use a NAMESPACE, the functions 
may not behave the same when they're sourced into the global 
environment.)  In the early stages, I'll do a lot of installs of the 
packages.

If I was porting a big package and wanted to find syntax errors, to work 
around the not-very-helpful error message you saw I'd do something like

for (f in list.files("pkg/R", full=TRUE)) source(f)

which will report the error more informatively.

Duncan Murdoch


From ripley at stats.ox.ac.uk  Fri Dec 12 10:08:11 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 12 Dec 2008 09:08:11 +0000 (GMT)
Subject: [Rd] repeat bug report: as.factor argument to row / col fails
 if NULL dimnames
In-Reply-To: <20081209004521.GA25854@stats.ox.ac.uk>
References: <20081209004521.GA25854@stats.ox.ac.uk>
Message-ID: <alpine.LFD.2.00.0812120858320.14869@gannet.stats.ox.ac.uk>

I have never seen the report in the repository.  There were problems with 
R-bugs at around that time (most email submission was stalled for a month 
or so).

However, I think the problems are far more serious: the help page says

      Returns a matrix of integers indicating their column number in a
      matrix-like object.
...

as.factor: a logical value indicating whether the value should be
           returned as a factor rather than as numeric.

Value:

      An integer matrix with the same dimensions as 'x' and whose
      'ij'-th element is equal to 'j'.

There is no mention of using the column labels as the values and the 
result was not even a matrix.  I certainly expected the factor levels to 
be numeric.

I presume that the intention is to use the column labels (default 
seq_len(nrow(x)) ) in place of the numbers, and to return a factor matrix, 
so I have implemented that for col() and row().

However, I do wonder that anyone was using as.factor=TRUE given that it 
did not do anything like what it was documented to.

On Mon, 8 Dec 2008, Dan Davison wrote:

> This bug was reported to r-devel by Martin Morgan on 13th May 2008
> (original email pasted below). However I couldn't locate it in the bug
> tracker (with searches for row, col, as\.factor) It is still present
> in today's svn version (rev 47115). I hope I'm doing something useful
> by bringing it up again. I have not sent this to r-bugs, as I'm
> concerned that not locating it in the bug tracker could be my failing.
>
> Dan
>
> original report:
> ------------------------------------------------------------------
> col(matrix(0, 5, 5), as.factor=TRUE) fails
>
>> col(matrix(0, 5, 5), as.factor=TRUE)
> Error in factor(.Internal(col(dim(x))), labels = colnames(x)) :
>  invalid labels; length 0 should be 1 or 5
>
> when the matrix has no dimnames. This is not as advertised. I would
> have expected the equivalent of
>
> factor(.Internal(col(dim(x))),
>       labels=colnames(x, do.NULL=FALSE, prefix=""))
>
>> sessionInfo()
> R version 2.8.0 Under development (unstable) (2008-05-13 r45682)
> x86_64-unknown-linux-gnu
>
> Martin
> -- 
> Martin Morgan
> Computational Biology / Fred Hutchinson Cancer Research Center
> 1100 Fairview Ave. N.
> PO Box 19024 Seattle, WA 98109
>
> Location: Arnold Building M2 B169
> Phone: (206) 667-2793
> ------------------------------------------------------------------
>
>
> -- 
> http://www.stats.ox.ac.uk/~davison
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From p.dalgaard at biostat.ku.dk  Fri Dec 12 10:51:26 2008
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri, 12 Dec 2008 10:51:26 +0100
Subject: [Rd] repeat bug report: as.factor argument to row / col fails
 if NULL dimnames
In-Reply-To: <alpine.LFD.2.00.0812120858320.14869@gannet.stats.ox.ac.uk>
References: <20081209004521.GA25854@stats.ox.ac.uk>
	<alpine.LFD.2.00.0812120858320.14869@gannet.stats.ox.ac.uk>
Message-ID: <4942341E.9030502@biostat.ku.dk>

Prof Brian Ripley wrote:
> I have never seen the report in the repository.  There were problems 
> with R-bugs at around that time (most email submission was stalled for a 
> month or so).

Maybe, but I don't see a PR# on _any_ of Martin Morgan's posts...

> However, I think the problems are far more serious: the help page says
> 
>      Returns a matrix of integers indicating their column number in a
>      matrix-like object.
> ...
> 
> as.factor: a logical value indicating whether the value should be
>           returned as a factor rather than as numeric.
> 
> Value:
> 
>      An integer matrix with the same dimensions as 'x' and whose
>      'ij'-th element is equal to 'j'.
> 
> There is no mention of using the column labels as the values and the 
> result was not even a matrix.  I certainly expected the factor levels to 
> be numeric.
> 
> I presume that the intention is to use the column labels (default 
> seq_len(nrow(x)) ) in place of the numbers, and to return a factor 
> matrix, so I have implemented that for col() and row().
> 
> However, I do wonder that anyone was using as.factor=TRUE given that it 
> did not do anything like what it was documented to.

There could, I suppose, be applications of the style

library(ISwR)
dd <- data.frame(count=c(caesar.shoe),
   caesar=row(caesar.shoe,as.factor=TRUE),
   size=col(caesar.shoe,as.factor=TRUE)) 
anova(glm(count~caesar*size,family=poisson,data=dd))

(as.data.frame.table is better in this case, I know). Notice that this 
will break if you change the value to a factor matrix.

It is not clear that a matrix is desired -- an alternative point of view 
is that when you request a factor, it is intended to be used along with 
long-format data.

> On Mon, 8 Dec 2008, Dan Davison wrote:
> 
>> This bug was reported to r-devel by Martin Morgan on 13th May 2008
>> (original email pasted below). However I couldn't locate it in the bug
>> tracker (with searches for row, col, as\.factor) It is still present
>> in today's svn version (rev 47115). I hope I'm doing something useful
>> by bringing it up again. I have not sent this to r-bugs, as I'm
>> concerned that not locating it in the bug tracker could be my failing.
>>
>> D

-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From ripley at stats.ox.ac.uk  Fri Dec 12 11:01:34 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 12 Dec 2008 10:01:34 +0000 (GMT)
Subject: [Rd] repeat bug report: as.factor argument to row / col fails
 if NULL dimnames
In-Reply-To: <4942341E.9030502@biostat.ku.dk>
References: <20081209004521.GA25854@stats.ox.ac.uk>
	<alpine.LFD.2.00.0812120858320.14869@gannet.stats.ox.ac.uk>
	<4942341E.9030502@biostat.ku.dk>
Message-ID: <alpine.LFD.2.00.0812120955270.24491@gannet.stats.ox.ac.uk>

On Fri, 12 Dec 2008, Peter Dalgaard wrote:

> Prof Brian Ripley wrote:
>> I have never seen the report in the repository.  There were problems with 
>> R-bugs at around that time (most email submission was stalled for a month 
>> or so).
>
> Maybe, but I don't see a PR# on _any_ of Martin Morgan's posts...
>
>> However, I think the problems are far more serious: the help page says
>>
>>      Returns a matrix of integers indicating their column number in a
>>      matrix-like object.
>> ...
>> 
>> as.factor: a logical value indicating whether the value should be
>>           returned as a factor rather than as numeric.
>> 
>> Value:
>>
>>      An integer matrix with the same dimensions as 'x' and whose
>>      'ij'-th element is equal to 'j'.
>> 
>> There is no mention of using the column labels as the values and the result 
>> was not even a matrix.  I certainly expected the factor levels to be 
>> numeric.
>> 
>> I presume that the intention is to use the column labels (default 
>> seq_len(nrow(x)) ) in place of the numbers, and to return a factor matrix, 
>> so I have implemented that for col() and row().
>> 
>> However, I do wonder that anyone was using as.factor=TRUE given that it did 
>> not do anything like what it was documented to.
>
> There could, I suppose, be applications of the style
>
> library(ISwR)
> dd <- data.frame(count=c(caesar.shoe),
>  caesar=row(caesar.shoe,as.factor=TRUE),
>  size=col(caesar.shoe,as.factor=TRUE)) 
> anova(glm(count~caesar*size,family=poisson,data=dd))
>
> (as.data.frame.table is better in this case, I know). Notice that this will 
> break if you change the value to a factor matrix.
>
> It is not clear that a matrix is desired -- an alternative point of view is 
> that when you request a factor, it is intended to be used along with 
> long-format data.

Yes, it is not clear (and I had given it some thought), but

a) a matrix result was documented and

b) it is easier to remove dims than add them (impossible without the 
original matrix to hand).

>> On Mon, 8 Dec 2008, Dan Davison wrote:
>> 
>>> This bug was reported to r-devel by Martin Morgan on 13th May 2008
>>> (original email pasted below). However I couldn't locate it in the bug
>>> tracker (with searches for row, col, as\.factor) It is still present
>>> in today's svn version (rev 47115). I hope I'm doing something useful
>>> by bringing it up again. I have not sent this to r-bugs, as I'm
>>> concerned that not locating it in the bug tracker could be my failing.
>>>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From hb at stat.berkeley.edu  Fri Dec 12 13:55:09 2008
From: hb at stat.berkeley.edu (Henrik Bengtsson)
Date: Fri, 12 Dec 2008 04:55:09 -0800
Subject: [Rd] package development
In-Reply-To: <4941A995.1040409@stats.uwo.ca>
References: <200812112304.mBBN4stJ008607@rocky.mayo.edu>
	<4941A995.1040409@stats.uwo.ca>
Message-ID: <59d7961d0812120455w3c946f56neb9cf7f482aa9a4b@mail.gmail.com>

Using parse() is better for syntax errors;

pathnames <- list.files(path="pkg/R", pattern="[.](r|R|s|S)$", full.names=TRUE);
for (pathname in pathnames) parse(pathname)

/Henrik

On Thu, Dec 11, 2008 at 4:00 PM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 11/12/2008 6:04 PM, Terry Therneau wrote:
>>
>>  I'm making the move of the survival package from my own environment to,
>> and have stumbled into a vacuum.   The R Extensions manual has really nice
>> instructions about how to lay out the directories, order the files, and
>> run tests for DISTRIBUTION of a product, but I can't find anything on how
>> to set up a reasonable DEVELOPMENT environment.
>>   In my local world, I had the .c and .s files in a common directory, with
>> a Makefile that I had created, and the test suite in a subdirectory.
>>  Debugging
>> and development was quite nice.
>>        make
>>        cd test
>>        R
>>        attach("..")
>>                try something and perhaps it fails
>>        q()
>>        cd ..
>> Fix and repeat. The Makefile took some time to create, but paid for itself
>> a
>> hundred times over.
>>  So, I've now rearranged everything into standard R order.  Then I did the
>> only thing I could find
>>        R CMD INSTALL ~/myRlib  survival  where "survival" is said
>> directory.   This turns out to be not useful at all.
>> The survival package is large, and I rather suspected that I would goof
>> something up, and I did, resulting in the following message
>>
>>        Error in parse(n = -1, file = file) : unexpected end of input at
>>        14450: }
>>        14451:
>> It is not exactly obvious which of the 132 files in my R/ directory is the
>> culprit here.
>
> That's something I would like to fix too.  There are (at least) two possible
> ways:  stop concatenating the files (which is not really needed nowadays,
> most packages install saved images), or add some markup to the concatenated
> file so that the parser can report on the original filename and line number
> (like the #LINE directives output by the C preprocessor).
>
>>
>>   In general:
>> 1. The library is large, and recompiling/reparsing everything is very far
>> from
>> instantaneous.  It is not the edit/load cycle I desire.
>
> If you install from the directory, the compiling should only be done once
> (unless you change a file, of course).  (The alternative is installing from
> the tarball, which is recommended for later stages of testing before
> distribution, because it's possible something could go wrong in building the
> tarball.  But it won't include any object files, so you'll recompile every
> time.)
>
> You can also use option "--docs=none" to skip building the help system; this
> will save a bit of time.
>
>
>>
>> 2. I take testing seriously: the test suite takes on the order of 15
>> minutes to
>> run on a fast machine.  I most certainly don't want to run it in the mid
>> cycle.
>
> I don't quite follow this.  If you want to run all your tests, you would use
> R CMD check.  If you only want to run some of them, then you can source
> things out of the tests directory while running interactively.
>
>>   Someone must have tackled this.  I'm hoping that there is some
>> documentation
>> that I have managed to overlook which discussess a good setup for this
>> middle
>> ground between concieving of a library and packaging it for delivery; the
>> "build, test, make sure it acually works" part of development.
>
> I find the process I follow is to organize the files in the distribution
> structure from the beginning.   When adding new functions, I'll generally
> use source() a few times to get the syntax right, and perhaps run simple
> tests.  (But remember, if you use a NAMESPACE, the functions may not behave
> the same when they're sourced into the global environment.)  In the early
> stages, I'll do a lot of installs of the packages.
>
> If I was porting a big package and wanted to find syntax errors, to work
> around the not-very-helpful error message you saw I'd do something like
>
> for (f in list.files("pkg/R", full=TRUE)) source(f)
>
> which will report the error more informatively.
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From therneau at mayo.edu  Fri Dec 12 14:23:27 2008
From: therneau at mayo.edu (Terry Therneau)
Date: Fri, 12 Dec 2008 07:23:27 -0600 (CST)
Subject: [Rd] package development
Message-ID: <200812121323.mBCDNRa00470@hsrnfs-101.mayo.edu>

Thanks to all for the replys.  I've learned several things

First -- I didn't miss anything obvious in the documentation.  This is good in 
one sense at least: I wasn't being blind.  I had one misunderstanding pointed 
out, which is that I need not worry about my test suite being run with each 
INSTALL; that happens with CHECK.

Second, I heard several good ideas for attacking the problem.


	Terry T.


From pgilbert at bank-banque-canada.ca  Fri Dec 12 15:12:23 2008
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 12 Dec 2008 09:12:23 -0500
Subject: [Rd] package development
In-Reply-To: <4941A995.1040409@stats.uwo.ca>
References: <200812112304.mBBN4stJ008607@rocky.mayo.edu>
	<4941A995.1040409@stats.uwo.ca>
Message-ID: <49427147.5070204@bank-banque-canada.ca>



Duncan Murdoch wrote:
> On 11/12/2008 6:04 PM, Terry Therneau wrote:
>>   I'm making the move of the survival package from my own environment to,
>> and have stumbled into a vacuum.   The R Extensions manual has really 
>> nice
>> instructions about how to lay out the directories, order the files, and
>> run tests for DISTRIBUTION of a product, but I can't find anything on how
>> to set up a reasonable DEVELOPMENT environment.
>>    In my local world, I had the .c and .s files in a common directory, 
>> with
>> a Makefile that I had created, and the test suite in a subdirectory.  
>> Debugging
>> and development was quite nice.
>>     make
>>     cd test
>>     R
>>     attach("..")
>>         try something and perhaps it fails
>>     q()
>>     cd ..
>> Fix and repeat. The Makefile took some time to create, but paid for 
>> itself a
>> hundred times over.
>>   So, I've now rearranged everything into standard R order.  Then I 
>> did the
>> only thing I could find
>>     R CMD INSTALL ~/myRlib  survival  where "survival" is said 
>> directory.   This turns out to be not useful at all.
>> The survival package is large, and I rather suspected that I would 
>> goof something up, and I did, resulting in the following message
>>
>>     Error in parse(n = -1, file = file) : unexpected end of input at
>>         14450: }
>>         14451:
>> It is not exactly obvious which of the 132 files in my R/ directory is 
>> the culprit here.
> 
> That's something I would like to fix too.  There are (at least) two 
> possible ways:  stop concatenating the files (which is not really needed 
> nowadays, most packages install saved images), or add some markup to the 
> concatenated file so that the parser can report on the original filename 
> and line number (like the #LINE directives output by the C preprocessor).

I would certainly appreciate a fix for this.  When this has happened to 
me, I usually end up just sourcing the individual files into an R 
session until I find the bad file, and get a report with the right line 
number. It always seems like a lot of work for something that should be 
trivial.

> 
>>
>>    In general:
>> 1. The library is large, and recompiling/reparsing everything is very 
>> far from
>> instantaneous.  It is not the edit/load cycle I desire.
> 
> If you install from the directory, the compiling should only be done 
> once (unless you change a file, of course).  (The alternative is 
> installing from the tarball, which is recommended for later stages of 
> testing before distribution, because it's possible something could go 
> wrong in building the tarball.  But it won't include any object files, 
> so you'll recompile every time.)
> 
> You can also use option "--docs=none" to skip building the help system; 
> this will save a bit of time.
> 
> 
>>
>> 2. I take testing seriously: the test suite takes on the order of 15 
>> minutes to
>> run on a fast machine.  I most certainly don't want to run it in the 
>> mid cycle.
> 
> I don't quite follow this.  If you want to run all your tests, you would 
> use R CMD check.  If you only want to run some of them, then you can 
> source things out of the tests directory while running interactively.
> 
>>    Someone must have tackled this.  I'm hoping that there is some 
>> documentation
>> that I have managed to overlook which discussess a good setup for this 
>> middle
>> ground between concieving of a library and packaging it for delivery; the
>> "build, test, make sure it acually works" part of development.

In my experience there are two differ sorts of problems that I think 
could benefit from some improvement. The first is that there should be a 
standard way to have extra tests, that do not get run in the normal CRAN 
testing cycle, or by developers when using a "quick" R CMD check, but 
can be run with a standard mechanism. I do this by putting the tests in 
a separate package, and I have seen reports of different mechanisms, but 
I think they are all somewhat ad hoc. Currently, if you put too much 
testing in your package then all the testing gets omitted on some CRAN 
testing platforms. Just a common directory like extraTests/ would be a 
good start.

The second problem is that a developer usually needs to run tests/ when 
code in R/ has been changed, but probably not run tests/ when the 
changes are only in man/, demos/, or inst/doc/.  The checking that needs 
to be done in those cases is reduced from the full R CMD check.  A 
common way to attack this is with a good Makefile. I wrote an article in 
R News a few years ago about my attempts to do this, and my Makefiles 
are available, but there is some customization necessary, and there is 
lots of room for improvement. It does (mostly) work with make -j, so 
days of testing on a single processor machine can be accomplished in a 
few hours on multicore machines (for me, mileage may vary). I have not 
addressed the idea of trying to specialize files in tests/ to specific 
code files in R/. (I think others have tried to do this with a "unit 
testing" approach.)

Paul Gilbert

> I find the process I follow is to organize the files in the distribution 
> structure from the beginning.   When adding new functions, I'll 
> generally use source() a few times to get the syntax right, and perhaps 
> run simple tests.  (But remember, if you use a NAMESPACE, the functions 
> may not behave the same when they're sourced into the global 
> environment.)  In the early stages, I'll do a lot of installs of the 
> packages.
> 
> If I was porting a big package and wanted to find syntax errors, to work 
> around the not-very-helpful error message you saw I'd do something like
> 
> for (f in list.files("pkg/R", full=TRUE)) source(f)
> 
> which will report the error more informatively.
> 
> Duncan Murdoch
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential in...{{dropped:26}}


From jeff.a.ryan at gmail.com  Fri Dec 12 16:47:16 2008
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Fri, 12 Dec 2008 09:47:16 -0600
Subject: [Rd] package development
In-Reply-To: <49427147.5070204@bank-banque-canada.ca>
References: <200812112304.mBBN4stJ008607@rocky.mayo.edu>
	<4941A995.1040409@stats.uwo.ca>
	<49427147.5070204@bank-banque-canada.ca>
Message-ID: <e8e755250812120747x241cde78y65e12b3a27ea518a@mail.gmail.com>

A quick comment on two subjects:

First to get the line # from the command line:

cat pkg/R/* > all.R
wc all.R
vim +LINE all.R  (or pick you favorite method here...)

>From there it should be easy enough to get context.  At least enough
to grep back into the R directory.

Also, the use of unit-tests is IMO the best answer  for managing a
separate test suite that you can selectively run (all of part of)
during the build phase.

Simply editing/adding an .Rbuildignore is all you need to turn it off
or on.  This makes it easy not to distribute the tests as well, if you
choose not too.

RUnit is a good tool to look into.

HTH
Jeff

On Fri, Dec 12, 2008 at 8:12 AM, Paul Gilbert
<pgilbert at bank-banque-canada.ca> wrote:
>
>
> Duncan Murdoch wrote:
>>
>> On 11/12/2008 6:04 PM, Terry Therneau wrote:
>>>
>>>  I'm making the move of the survival package from my own environment to,
>>> and have stumbled into a vacuum.   The R Extensions manual has really
>>> nice
>>> instructions about how to lay out the directories, order the files, and
>>> run tests for DISTRIBUTION of a product, but I can't find anything on how
>>> to set up a reasonable DEVELOPMENT environment.
>>>   In my local world, I had the .c and .s files in a common directory,
>>> with
>>> a Makefile that I had created, and the test suite in a subdirectory.
>>>  Debugging
>>> and development was quite nice.
>>>    make
>>>    cd test
>>>    R
>>>    attach("..")
>>>        try something and perhaps it fails
>>>    q()
>>>    cd ..
>>> Fix and repeat. The Makefile took some time to create, but paid for
>>> itself a
>>> hundred times over.
>>>  So, I've now rearranged everything into standard R order.  Then I did
>>> the
>>> only thing I could find
>>>    R CMD INSTALL ~/myRlib  survival  where "survival" is said directory.
>>>   This turns out to be not useful at all.
>>> The survival package is large, and I rather suspected that I would goof
>>> something up, and I did, resulting in the following message
>>>
>>>    Error in parse(n = -1, file = file) : unexpected end of input at
>>>        14450: }
>>>        14451:
>>> It is not exactly obvious which of the 132 files in my R/ directory is
>>> the culprit here.
>>
>> That's something I would like to fix too.  There are (at least) two
>> possible ways:  stop concatenating the files (which is not really needed
>> nowadays, most packages install saved images), or add some markup to the
>> concatenated file so that the parser can report on the original filename and
>> line number (like the #LINE directives output by the C preprocessor).
>
> I would certainly appreciate a fix for this.  When this has happened to me,
> I usually end up just sourcing the individual files into an R session until
> I find the bad file, and get a report with the right line number. It always
> seems like a lot of work for something that should be trivial.
>
>>
>>>
>>>   In general:
>>> 1. The library is large, and recompiling/reparsing everything is very far
>>> from
>>> instantaneous.  It is not the edit/load cycle I desire.
>>
>> If you install from the directory, the compiling should only be done once
>> (unless you change a file, of course).  (The alternative is installing from
>> the tarball, which is recommended for later stages of testing before
>> distribution, because it's possible something could go wrong in building the
>> tarball.  But it won't include any object files, so you'll recompile every
>> time.)
>>
>> You can also use option "--docs=none" to skip building the help system;
>> this will save a bit of time.
>>
>>
>>>
>>> 2. I take testing seriously: the test suite takes on the order of 15
>>> minutes to
>>> run on a fast machine.  I most certainly don't want to run it in the mid
>>> cycle.
>>
>> I don't quite follow this.  If you want to run all your tests, you would
>> use R CMD check.  If you only want to run some of them, then you can source
>> things out of the tests directory while running interactively.
>>
>>>   Someone must have tackled this.  I'm hoping that there is some
>>> documentation
>>> that I have managed to overlook which discussess a good setup for this
>>> middle
>>> ground between concieving of a library and packaging it for delivery; the
>>> "build, test, make sure it acually works" part of development.
>
> In my experience there are two differ sorts of problems that I think could
> benefit from some improvement. The first is that there should be a standard
> way to have extra tests, that do not get run in the normal CRAN testing
> cycle, or by developers when using a "quick" R CMD check, but can be run
> with a standard mechanism. I do this by putting the tests in a separate
> package, and I have seen reports of different mechanisms, but I think they
> are all somewhat ad hoc. Currently, if you put too much testing in your
> package then all the testing gets omitted on some CRAN testing platforms.
> Just a common directory like extraTests/ would be a good start.
>
> The second problem is that a developer usually needs to run tests/ when code
> in R/ has been changed, but probably not run tests/ when the changes are
> only in man/, demos/, or inst/doc/.  The checking that needs to be done in
> those cases is reduced from the full R CMD check.  A common way to attack
> this is with a good Makefile. I wrote an article in R News a few years ago
> about my attempts to do this, and my Makefiles are available, but there is
> some customization necessary, and there is lots of room for improvement. It
> does (mostly) work with make -j, so days of testing on a single processor
> machine can be accomplished in a few hours on multicore machines (for me,
> mileage may vary). I have not addressed the idea of trying to specialize
> files in tests/ to specific code files in R/. (I think others have tried to
> do this with a "unit testing" approach.)
>
> Paul Gilbert
>
>> I find the process I follow is to organize the files in the distribution
>> structure from the beginning.   When adding new functions, I'll generally
>> use source() a few times to get the syntax right, and perhaps run simple
>> tests.  (But remember, if you use a NAMESPACE, the functions may not behave
>> the same when they're sourced into the global environment.)  In the early
>> stages, I'll do a lot of installs of the packages.
>>
>> If I was porting a big package and wanted to find syntax errors, to work
>> around the not-very-helpful error message you saw I'd do something like
>>
>> for (f in list.files("pkg/R", full=TRUE)) source(f)
>>
>> which will report the error more informatively.
>>
>> Duncan Murdoch
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ====================================================================================
>
> La version fran?aise suit le texte anglais.
>
> ------------------------------------------------------------------------------------
>
> This email may contain privileged and/or confidential in...{{dropped:26}}
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Jeffrey Ryan
jeffrey.ryan at insightalgo.com

ia: insight algorithmics
www.insightalgo.com


From pgilbert at bank-banque-canada.ca  Fri Dec 12 17:05:11 2008
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 12 Dec 2008 11:05:11 -0500
Subject: [Rd] package development
In-Reply-To: <e8e755250812120747x241cde78y65e12b3a27ea518a@mail.gmail.com>
References: <200812112304.mBBN4stJ008607@rocky.mayo.edu>	
	<4941A995.1040409@stats.uwo.ca>	
	<49427147.5070204@bank-banque-canada.ca>
	<e8e755250812120747x241cde78y65e12b3a27ea518a@mail.gmail.com>
Message-ID: <49428BB7.6030406@bank-banque-canada.ca>



Jeff Ryan wrote:
> A quick comment on two subjects:
> 
> First to get the line # from the command line:
> 
> cat pkg/R/* > all.R
> wc all.R
> vim +LINE all.R  (or pick you favorite method here...)

The tmp file is also indicated in error message, so you can edit that, 
go to the line number, find context, grep the files in R/, and then go 
directly to the line that needs to be fixed in the source file. Couldn't 
be simpler?

> 
> From there it should be easy enough to get context.  At least enough
> to grep back into the R directory.
> 
> Also, the use of unit-tests is IMO the best answer  for managing a
> separate test suite that you can selectively run (all of part of)
> during the build phase.
> 
> Simply editing/adding an .Rbuildignore is all you need to turn it off
> or on.  This makes it easy not to distribute the tests as well, if you
> choose not too.

Yes, there are several options for not distributing tests.  I was 
thinking more about how to distribute them with a simple mechanism for 
anyone to run them, but in a way that they are not run by the usual R 
CMD check.

Paul
> 
> RUnit is a good tool to look into.
> 
> HTH
> Jeff
> 
> On Fri, Dec 12, 2008 at 8:12 AM, Paul Gilbert
> <pgilbert at bank-banque-canada.ca> wrote:
> 
>>
>>Duncan Murdoch wrote:
>>
>>>On 11/12/2008 6:04 PM, Terry Therneau wrote:
>>>
>>>> I'm making the move of the survival package from my own environment to,
>>>>and have stumbled into a vacuum.   The R Extensions manual has really
>>>>nice
>>>>instructions about how to lay out the directories, order the files, and
>>>>run tests for DISTRIBUTION of a product, but I can't find anything on how
>>>>to set up a reasonable DEVELOPMENT environment.
>>>>  In my local world, I had the .c and .s files in a common directory,
>>>>with
>>>>a Makefile that I had created, and the test suite in a subdirectory.
>>>> Debugging
>>>>and development was quite nice.
>>>>   make
>>>>   cd test
>>>>   R
>>>>   attach("..")
>>>>       try something and perhaps it fails
>>>>   q()
>>>>   cd ..
>>>>Fix and repeat. The Makefile took some time to create, but paid for
>>>>itself a
>>>>hundred times over.
>>>> So, I've now rearranged everything into standard R order.  Then I did
>>>>the
>>>>only thing I could find
>>>>   R CMD INSTALL ~/myRlib  survival  where "survival" is said directory.
>>>>  This turns out to be not useful at all.
>>>>The survival package is large, and I rather suspected that I would goof
>>>>something up, and I did, resulting in the following message
>>>>
>>>>   Error in parse(n = -1, file = file) : unexpected end of input at
>>>>       14450: }
>>>>       14451:
>>>>It is not exactly obvious which of the 132 files in my R/ directory is
>>>>the culprit here.
>>>
>>>That's something I would like to fix too.  There are (at least) two
>>>possible ways:  stop concatenating the files (which is not really needed
>>>nowadays, most packages install saved images), or add some markup to the
>>>concatenated file so that the parser can report on the original filename and
>>>line number (like the #LINE directives output by the C preprocessor).
>>
>>I would certainly appreciate a fix for this.  When this has happened to me,
>>I usually end up just sourcing the individual files into an R session until
>>I find the bad file, and get a report with the right line number. It always
>>seems like a lot of work for something that should be trivial.
>>
>>
>>>>  In general:
>>>>1. The library is large, and recompiling/reparsing everything is very far
>>>>from
>>>>instantaneous.  It is not the edit/load cycle I desire.
>>>
>>>If you install from the directory, the compiling should only be done once
>>>(unless you change a file, of course).  (The alternative is installing from
>>>the tarball, which is recommended for later stages of testing before
>>>distribution, because it's possible something could go wrong in building the
>>>tarball.  But it won't include any object files, so you'll recompile every
>>>time.)
>>>
>>>You can also use option "--docs=none" to skip building the help system;
>>>this will save a bit of time.
>>>
>>>
>>>
>>>>2. I take testing seriously: the test suite takes on the order of 15
>>>>minutes to
>>>>run on a fast machine.  I most certainly don't want to run it in the mid
>>>>cycle.
>>>
>>>I don't quite follow this.  If you want to run all your tests, you would
>>>use R CMD check.  If you only want to run some of them, then you can source
>>>things out of the tests directory while running interactively.
>>>
>>>
>>>>  Someone must have tackled this.  I'm hoping that there is some
>>>>documentation
>>>>that I have managed to overlook which discussess a good setup for this
>>>>middle
>>>>ground between concieving of a library and packaging it for delivery; the
>>>>"build, test, make sure it acually works" part of development.
>>
>>In my experience there are two differ sorts of problems that I think could
>>benefit from some improvement. The first is that there should be a standard
>>way to have extra tests, that do not get run in the normal CRAN testing
>>cycle, or by developers when using a "quick" R CMD check, but can be run
>>with a standard mechanism. I do this by putting the tests in a separate
>>package, and I have seen reports of different mechanisms, but I think they
>>are all somewhat ad hoc. Currently, if you put too much testing in your
>>package then all the testing gets omitted on some CRAN testing platforms.
>>Just a common directory like extraTests/ would be a good start.
>>
>>The second problem is that a developer usually needs to run tests/ when code
>>in R/ has been changed, but probably not run tests/ when the changes are
>>only in man/, demos/, or inst/doc/.  The checking that needs to be done in
>>those cases is reduced from the full R CMD check.  A common way to attack
>>this is with a good Makefile. I wrote an article in R News a few years ago
>>about my attempts to do this, and my Makefiles are available, but there is
>>some customization necessary, and there is lots of room for improvement. It
>>does (mostly) work with make -j, so days of testing on a single processor
>>machine can be accomplished in a few hours on multicore machines (for me,
>>mileage may vary). I have not addressed the idea of trying to specialize
>>files in tests/ to specific code files in R/. (I think others have tried to
>>do this with a "unit testing" approach.)
>>
>>Paul Gilbert
>>
>>
>>>I find the process I follow is to organize the files in the distribution
>>>structure from the beginning.   When adding new functions, I'll generally
>>>use source() a few times to get the syntax right, and perhaps run simple
>>>tests.  (But remember, if you use a NAMESPACE, the functions may not behave
>>>the same when they're sourced into the global environment.)  In the early
>>>stages, I'll do a lot of installs of the packages.
>>>
>>>If I was porting a big package and wanted to find syntax errors, to work
>>>around the not-very-helpful error message you saw I'd do something like
>>>
>>>for (f in list.files("pkg/R", full=TRUE)) source(f)
>>>
>>>which will report the error more informatively.
>>>
>>>Duncan Murdoch
>>>
>>>______________________________________________
>>>R-devel at r-project.org mailing list
>>>https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>====================================================================================
>>
>>La version fran?aise suit le texte anglais.
>>
>>------------------------------------------------------------------------------------
>>
>>This email may contain privileged and/or confidential in...{{dropped:26}}
>>
>>______________________________________________
>>R-devel at r-project.org mailing list
>>https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
> 
> 
> 
====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential in...{{dropped:26}}


From ripley at stats.ox.ac.uk  Fri Dec 12 17:12:53 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 12 Dec 2008 16:12:53 +0000 (GMT)
Subject: [Rd] function qt can fails if ndf < 1 (PR#13364)
In-Reply-To: <20081203181509.C42AD282C765@mail.pubhealth.ku.dk>
References: <20081203181509.C42AD282C765@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0812121542280.22761@auk.stats.ox.ac.uk>

You have missed the following item in NEWS for R-patched.

NEW FEATURES

     o   qt() now works for 0 < df < 1.


Please review what the FAQ has to say about checkiong your facts and not 
reporting things which are already fixed.

Fortunately this example had some use: it showed someone had replaced a 
working method in R-devel by one that infinite-looped, and I've reverted 
it.

On Wed, 3 Dec 2008, gerard at mail.generacio.com wrote:

> Full_Name: Gerard Torrent
> Version: R version 2.8.0 (2008-10-20)
> OS: Linux 2.6.27.5-41.fc9.x86_64 #1 SMP
> Submission from: (NULL) (85.52.227.233)
>
>
> In some cases qt complains about NaNs and don't gives the correct result:
>
>> qt(0.1,, 0.1)

That gives a syntax error ....

> [1] NaN
> Warning message:
> In qt(p, df, lower.tail, log.p) : NaNs produced
>
> But the result can be found:
>> pt(-1.60443e+06, 0.1)
> [1] 0.09999997

It actually was documented so in 2.8.0

       df: degrees of freedom (> 0, maybe non-integer).  'df = Inf' is
           allowed.  For 'qt' only values of at least one are currently
           supported unless 'ncp' is supplied.

!

> If I replace the current method by bisection method in file file src/nmath/qt.c
> the result is computed fine.
>
> int cont=0;
> do {
> 	cont++;
> 	nx = lx + (ux - lx)/2.0;
> 	if ((pp = pt(nx, ndf, TRUE, FALSE)) > p) {
> 		ux = nx; pu = pp;
> 	} else {
> 		lx = nx; pl = pp;
> 	}
> }
> while ((ux - lx) / fabs(nx) > accu && cont < 100);
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From jeff.a.ryan at gmail.com  Fri Dec 12 17:14:58 2008
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Fri, 12 Dec 2008 10:14:58 -0600
Subject: [Rd] package development
In-Reply-To: <49428BB7.6030406@bank-banque-canada.ca>
References: <200812112304.mBBN4stJ008607@rocky.mayo.edu>
	<4941A995.1040409@stats.uwo.ca>
	<49427147.5070204@bank-banque-canada.ca>
	<e8e755250812120747x241cde78y65e12b3a27ea518a@mail.gmail.com>
	<49428BB7.6030406@bank-banque-canada.ca>
Message-ID: <e8e755250812120814s4cdf78abj198d285347fbed31@mail.gmail.com>

I think the /tmp file gets removed:

ERROR: lazy loading failed for package 'xts'
** Removing '/private/tmp/Rinst625532301/xts'
 ERROR
Installation failed.
Removing '/tmp/Rinst625532301'

At least it seems to when I run R CMD from the shell.

>
> Yes, there are several options for not distributing tests.  I was thinking
> more about how to distribute them with a simple mechanism for anyone to run
> them, but in a way that they are not run by the usual R CMD check.
>

You can still distribute the tests in the inst/unitTests directory,
you would just have to make sure that the calling script in the /tests
directory is commented out.

Alternately you could have that /tests/doRUnit.R script (or whatever
you call it/them) check for some environment variable to be set before
running the full suite.

Jeff


From spencer.graves at pdf.com  Fri Dec 12 18:07:30 2008
From: spencer.graves at pdf.com (Spencer Graves)
Date: Fri, 12 Dec 2008 09:07:30 -0800
Subject: [Rd] Warning: missing text for item ... in \describe?
Message-ID: <49429A52.1010909@pdf.com>

Hello:

	  For the record, I found the source of this warning:  I had an 
extraneous space in "\item{fd} {text}":  When I changed to 
"\item{fd}{text}", this warning disappeared.

	  Best Wishes,
	  Spencer

#########################
      What might be the problem generating messages like "Warning:
missing text for item ... in \describe" with "R CMD check" and "R CMD
install"?

      With the current version of "fda" on R-Forge, I get the following:


Warning: missing text for item 'fd' in \describe
Warning: missing text for item 'fdPar' in \describe


      I found a where someone else asked about essentially this warning
message, but I didn't find a reply.  I also found that
"https://svn.r-project.org/R/trunk/share/perl/R/Rdconv.pm" is coded to
issue such messages.  However, I still don't know what I'm doing to
generate it.

      Thanks in advance for any suggestions.

      Best Wishes,
      Spencer


From ripley at stats.ox.ac.uk  Fri Dec 12 18:27:10 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 12 Dec 2008 17:27:10 +0000 (GMT)
Subject: [Rd] Warning: missing text for item ... in \describe?
In-Reply-To: <49429A52.1010909@pdf.com>
References: <49429A52.1010909@pdf.com>
Message-ID: <alpine.LFD.2.00.0812121723340.22545@gannet.stats.ox.ac.uk>

On Fri, 12 Dec 2008, Spencer Graves wrote:

> Hello:
>
> 	  For the record, I found the source of this warning:  I had an 
> extraneous space in "\item{fd} {text}":  When I changed to "\item{fd}{text}", 
> this warning disappeared.

And while you've been away you missed

https://stat.ethz.ch/pipermail/r-devel/2008-December/051559.html

and of course

http://www.r-project.org/nosvn/R.check/r-devel-linux-x86_64/fda-00check.html

>
> 	  Best Wishes,
> 	  Spencer
>
> #########################
>     What might be the problem generating messages like "Warning:
> missing text for item ... in \describe" with "R CMD check" and "R CMD
> install"?
>
>     With the current version of "fda" on R-Forge, I get the following:
>
>
> Warning: missing text for item 'fd' in \describe
> Warning: missing text for item 'fdPar' in \describe
>
>
>     I found a where someone else asked about essentially this warning
> message, but I didn't find a reply.  I also found that
> "https://svn.r-project.org/R/trunk/share/perl/R/Rdconv.pm" is coded to
> issue such messages.  However, I still don't know what I'm doing to
> generate it.
>
>     Thanks in advance for any suggestions.
>
>     Best Wishes,
>     Spencer
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From rthompso at aecom.yu.edu  Fri Dec 12 18:05:04 2008
From: rthompso at aecom.yu.edu (rthompso at aecom.yu.edu)
Date: Fri, 12 Dec 2008 18:05:04 +0100 (CET)
Subject: [Rd] gregexpr - match overlap mishandled (PR#13391)
Message-ID: <20081212170504.93484282EFC1@mail.pubhealth.ku.dk>

Full_Name: Reid Thompson
Version: 2.8.0 RC (2008-10-12 r46696)
OS: darwin9.5.0
Submission from: (NULL) (129.98.107.177)


the gregexpr() function does NOT return a complete list of global matches as it
should.  this occurs when a pattern matches two overlapping portions of a
string, only the first match is returned.

the following function call demonstrates this error (although this is not how I
initially discovered the problem):
gregexpr("11221122", paste(rep("1122", 10), collapse=""))

instead of returning 9 matches as one would expect, only 5 matches are returned
. . .

[[1]]
[1]  1  9 17 25 33
attr(,"match.length")
[1] 8 8 8 8 8

you will note, essentially, that the entire first match is then excluded from
subsequent matching


From ripley at stats.ox.ac.uk  Fri Dec 12 20:23:07 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 12 Dec 2008 19:23:07 +0000 (GMT)
Subject: [Rd] gregexpr - match overlap mishandled (PR#13391)
In-Reply-To: <20081212170504.93484282EFC1@mail.pubhealth.ku.dk>
References: <20081212170504.93484282EFC1@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0812121910370.23680@gannet.stats.ox.ac.uk>

Please do your own homework: the help page says

      For 'gregexpr' a list of the same length as 'text' each element of
      which is an integer vector as in 'regexpr', except that the
      starting positions of every (disjoint) match are given.
                                   ^^^^^^^^

If that is still not clear enough for you, please ask your supervisor for 
remedial help.

On Fri, 12 Dec 2008, rthompso at aecom.yu.edu wrote:

> Full_Name: Reid Thompson
> Version: 2.8.0 RC (2008-10-12 r46696)
> OS: darwin9.5.0
> Submission from: (NULL) (129.98.107.177)
>
>
> the gregexpr() function does NOT return a complete list of global matches as it
> should.  this occurs when a pattern matches two overlapping portions of a
> string, only the first match is returned.
>
> the following function call demonstrates this error (although this is not how I
> initially discovered the problem):
> gregexpr("11221122", paste(rep("1122", 10), collapse=""))
>
> instead of returning 9 matches as one would expect, only 5 matches are returned
> . . .
>
> [[1]]
> [1]  1  9 17 25 33
> attr(,"match.length")
> [1] 8 8 8 8 8
>
> you will note, essentially, that the entire first match is then excluded from
> subsequent matching
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From maechler at stat.math.ethz.ch  Fri Dec 12 18:13:02 2008
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 12 Dec 2008 17:13:02 +0000 (UTC)
Subject: [Rd] package development
References: <200812112304.mBBN4stJ008607@rocky.mayo.edu>
	<4941A58F.60206@epfl.ch>
Message-ID: <loom.20081212T170626-86@post.gmane.org>

Mathieu Ribatet <mathieu.ribatet <at> epfl.ch> writes:

> 
> Dear Terry,
> 
> One way to locate which file is wrong - surely not the most brillant 
> way! You could do an R script that sources each of your .R files within 
> a "for (file in file.names)" loop.
> When R will stop, it will indicate which file has a wrong syntax and 
> more info.

Yes, I also use this approach, however making use of the  
sourceDir() utility function that you get by
example(source).

I had contemplated on and off, it was worth of making sourceDir() an 
"official" function and had found that I could not reasonably see
the case for it..

Martin Maechler, ETH Zurich


From Greg.Snow at imail.org  Fri Dec 12 22:32:56 2008
From: Greg.Snow at imail.org (Greg Snow)
Date: Fri, 12 Dec 2008 14:32:56 -0700
Subject: [Rd] gregexpr - match overlap mishandled (PR#13391)
In-Reply-To: <20081212170504.93484282EFC1@mail.pubhealth.ku.dk>
References: <20081212170504.93484282EFC1@mail.pubhealth.ku.dk>
Message-ID: <B37C0A15B8FB3C468B5BC7EBC7DA14CC61C4B2A0C3@LP-EXMBVS10.CO.IHC.COM>

Where do you get "should" and "expect" from?  All the regular expression tools that I am familiar with only match non-overlapping patterns unless you do extra to specify otherwise.  One of the standard references for regular expressions if you really want to understand what is going on is "Mastering Regular Expressions" by Jeffrey Friedl.  You should really read through that book before passing judgment on the correctness of an implementation.

If you want the overlaps, you need to come up with a regular expression that will match without consuming all of the string.  Here is one way to do it with your example:

 > gregexpr("1122(?=1122)", paste(rep("1122", 10), collapse=""), perl=TRUE)
[[1]]
[1]  1  5  9 13 17 21 25 29 33
attr(,"match.length")
[1] 4 4 4 4 4 4 4 4 4



--
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-
> project.org] On Behalf Of rthompso at aecom.yu.edu
> Sent: Friday, December 12, 2008 10:05 AM
> To: r-devel at stat.math.ethz.ch
> Cc: R-bugs at r-project.org
> Subject: [Rd] gregexpr - match overlap mishandled (PR#13391)
>
> Full_Name: Reid Thompson
> Version: 2.8.0 RC (2008-10-12 r46696)
> OS: darwin9.5.0
> Submission from: (NULL) (129.98.107.177)
>
>
> the gregexpr() function does NOT return a complete list of global
> matches as it
> should.  this occurs when a pattern matches two overlapping portions of
> a
> string, only the first match is returned.
>
> the following function call demonstrates this error (although this is
> not how I
> initially discovered the problem):
> gregexpr("11221122", paste(rep("1122", 10), collapse=""))
>
> instead of returning 9 matches as one would expect, only 5 matches are
> returned
> . . .
>
> [[1]]
> [1]  1  9 17 25 33
> attr(,"match.length")
> [1] 8 8 8 8 8
>
> you will note, essentially, that the entire first match is then
> excluded from
> subsequent matching
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From Greg.Snow at imail.org  Fri Dec 12 22:35:26 2008
From: Greg.Snow at imail.org (Greg.Snow at imail.org)
Date: Fri, 12 Dec 2008 22:35:26 +0100 (CET)
Subject: [Rd] gregexpr - match overlap mishandled (PR#13391)
Message-ID: <20081212213526.927FE282EFC1@mail.pubhealth.ku.dk>

Where do you get "should" and "expect" from?  All the regular expression to=
ols that I am familiar with only match non-overlapping patterns unless you =
do extra to specify otherwise.  One of the standard references for regular =
expressions if you really want to understand what is going on is "Mastering=
 Regular Expressions" by Jeffrey Friedl.  You should really read through th=
at book before passing judgment on the correctness of an implementation.

If you want the overlaps, you need to come up with a regular expression tha=
t will match without consuming all of the string.  Here is one way to do it=
 with your example:

 > gregexpr("1122(?=3D1122)", paste(rep("1122", 10), collapse=3D""), perl=
=3DTRUE)
[[1]]
[1]  1  5  9 13 17 21 25 29 33
attr(,"match.length")
[1] 4 4 4 4 4 4 4 4 4



--
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


> -----Original Message-----
> From: r-devel-bounces at r-project.org [mailto:r-devel-bounces at r-
> project.org] On Behalf Of rthompso at aecom.yu.edu
> Sent: Friday, December 12, 2008 10:05 AM
> To: r-devel at stat.math.ethz.ch
> Cc: R-bugs at r-project.org
> Subject: [Rd] gregexpr - match overlap mishandled (PR#13391)
>
> Full_Name: Reid Thompson
> Version: 2.8.0 RC (2008-10-12 r46696)
> OS: darwin9.5.0
> Submission from: (NULL) (129.98.107.177)
>
>
> the gregexpr() function does NOT return a complete list of global
> matches as it
> should.  this occurs when a pattern matches two overlapping portions of
> a
> string, only the first match is returned.
>
> the following function call demonstrates this error (although this is
> not how I
> initially discovered the problem):
> gregexpr("11221122", paste(rep("1122", 10), collapse=3D""))
>
> instead of returning 9 matches as one would expect, only 5 matches are
> returned
> . . .
>
> [[1]]
> [1]  1  9 17 25 33
> attr(,"match.length")
> [1] 8 8 8 8 8
>
> you will note, essentially, that the entire first match is then
> excluded from
> subsequent matching
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From ggrothendieck at gmail.com  Fri Dec 12 23:58:35 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 12 Dec 2008 17:58:35 -0500
Subject: [Rd] gregexpr - match overlap mishandled (PR#13391)
In-Reply-To: <20081212213526.927FE282EFC1@mail.pubhealth.ku.dk>
References: <20081212213526.927FE282EFC1@mail.pubhealth.ku.dk>
Message-ID: <971536df0812121458o301e5545xbc2b9671c9fe6094@mail.gmail.com>

On Fri, Dec 12, 2008 at 4:35 PM,  <Greg.Snow at imail.org> wrote:
> do extra to specify otherwise.  One of the standard references for regular =
> expressions if you really want to understand what is going on is "Mastering=
>  Regular Expressions" by Jeffrey Friedl.  You should really read through th=

There are also regular expression links in the Links box of the gsubfn home
page:

http://gsubfn.googlecode.com


From alienalias at gmail.com  Sat Dec 13 02:24:45 2008
From: alienalias at gmail.com (Yulia Arzhaeva)
Date: Sat, 13 Dec 2008 12:24:45 +1100
Subject: [Rd] Using R graphics from external C functions
Message-ID: <976fc29a0812121724r1670c10eo66f252b72eddd31d@mail.gmail.com>

Dear all,

I haven't been working with R before, but has been asked by my
colleagues to investigate the possibility of using R plotting
capabilities from external (C) code. They have several plotting
functions, implemented in R, that are needed to be included in a
front-end Windows-based application. As far as I understood, R.dll is
a dll that serves external R calls.

1) My first question is if I need a complete R installation on a user
machine  to be able to perform such calls?  If R.dll only passes the
calls to R interpreter then the answer is, probably, "yes"..

2) If the answer on the first question is "yes". For us it is not an
option to have R installed on a user's side. How difficult, if
possible at all, would it be then to extract and compile all C code
related to R graphics into a stand-alone library to link our user
application to? So that in my own C code I call C-equivalents of R
internal graphical functions, such as "do_rect" or "do_plot_xy".  I
assume that would include at least compiling the C code of standard
packages "grDevices" and "graphics", but perhaps, it is much more than
just that? I am afraid these packages would depend on the other core
packages of R. Plus some other obstacles I cannot foresee.

I cannot myself estimate such an undertaking because of the lack of
acquittance with R. I would really appreciate your opinion and
reasoning. If this way is not relatively easy or doable, I will
convince my colleagues to write an alternative plotting functions
using other means.

Thanks you all very much,
Julia


From pburns at pburns.seanet.com  Sat Dec 13 11:48:23 2008
From: pburns at pburns.seanet.com (Patrick Burns)
Date: Sat, 13 Dec 2008 10:48:23 +0000
Subject: [Rd] [R] odd behavior when multiplying data frame by an element
In-Reply-To: <1102425641.17145511229133138174.JavaMail.javamailuser@localhost>
References: <1102425641.17145511229133138174.JavaMail.javamailuser@localhost>
Message-ID: <494392F7.9000808@pburns.seanet.com>

I think it might be up for discussion whether or not
there is a bug in here somewhere.

 > mat10 <- matrix(1:6, 3)
 > mat10 * 1:12
Error: dims [product 6] do not match the length of object [12]
 > data.frame(mat10) * 1:12
  X1 X2
1  1 16
2  4 25
3  9 36
 > version
               
_                                                              
platform       
i386-pc-mingw32                                                
arch           
i386                                                           
os             
mingw32                                                        
system         i386, 
mingw32                                                  
status         Under development 
(unstable)                                   
major          
2                                                              
minor          
9.0                                                            
year           
2008                                                           
month          
11                                                             
day            
22                                                             
svn rev        
47006                                                          
language       
R                                                              
version.string R version 2.9.0 Under development (unstable) (2008-11-22 
r47006)


It seems dangerous to me that there is not at least
a warning in the data frame case.  I think I'd prefer
an error like the matrix case.

Patrick Burns
patrick at burns-stat.com
+44 (0)20 8525 0696
http://www.burns-stat.com
(home of S Poetry and "A Guide for the Unwilling S User")

markleeds at verizon.net wrote:
> could someone explain what is happening below ? I was trying to solve 
> a related question on the list and then , as I was solving it,
> I was getting strange answers and then I noticed below. It's obviously 
> not a bug but I don't get it. Thanks.
>
> m <- data.frame(class = c("birds", "planes"), feather = c(1,3), jet = 
> c(2,4))
> d1 <- data.frame(jet = c(10), feather = c(20))
>
> print(m)
> m[,-1]*2       # THIS IS FINE
> m[,"jet"]*2     # THIS IS FINE
>
>
> print(d1["jet"]) # THIS IS FINE
> m[,"jet"]*d1["jet"] # THIS IS ODD
>
> ______________________________________________
> R-help at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide 
> http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.
>
>


From ripley at stats.ox.ac.uk  Sat Dec 13 12:14:38 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 13 Dec 2008 11:14:38 +0000 (GMT)
Subject: [Rd] (PR#13318) Wishlist: fix error in documentation for body<-
In-Reply-To: <49273A39.6020908@biostat.ku.dk>
References: <20081121160003.8DFAC2834154@mail.pubhealth.ku.dk>
	<49273A39.6020908@biostat.ku.dk>
Message-ID: <alpine.LFD.2.00.0812130900530.5347@gannet.stats.ox.ac.uk>

There are two issues here, what it does and what it should do..

One issue is what is meant by 'expression': is it an expressions vector of 
type "expression" or is it 'expression' as documented as an element of 
such a vector in ?expression?  For body<- it is the latter.

Then there are a couple of odd exceptions.

1) If 'value' is of type expression, the first element is taken, silently.

2) If 'value' is a length-one list, its first element is taken.
If 'value' is a named list of length greater than one. the last element is 
taken as the value and the remaining elements as additional arguments.

The first is by design, the second seems to be a bug (and in the case of 
formals<- it definitely is a bug which I have just corrected).  The issue 
is in

> base::`body<-`
function (fun, envir = environment(fun), value)
{
     if (is.expression(value))
         value <- value[[1]]
     as.function(c(formals(fun), value), envir)
}

formals(fun) is a normally a pairlist so c() is concatenating 'value' to a 
list, and will do an implicit as.list().  However, in the case of no 
arguments it fails (another bug I have just corrected).

I think we want this to be

     as.function(c(as.list(formals(fun)), list(value)), envir)

but that does change the behaviour for a length-one list 'value'.  It 
seems a fair guess that no one is intentionally relying on the latter, but 
you never know ....

On Fri, 21 Nov 2008, Peter Dalgaard wrote:

> fabian.scheipl at stat.uni-muenchen.de wrote:
>> Full_Name: Fabian Scheipl
>> Version: 2.8.0
>> OS: Windows, Linux
>> Submission from: (NULL) (138.246.7.150)
>> 
>> 
>> It seems to me that the documentation for body<- is wrong.
>> The help file for 
>> body(fun, envir = environment(fun)) <- value
>> 
>> says that:
>> 
>> value can be an expression or a list of R expressions.
>> 
>> This produces errors however:
>> 
>> ################################
>> 
>>> f <- function(x){}
>>> body(f) <- list(expression(res <- x^2),expression(return(x)))
>> Fehler in as.function.default(c(formals(fun), value), envir) :   ung?ltiges 
>> formales Argument f?r "function"
>> 
>> ################################
>> 
>> 
>> The only way to assign multiple statements to a function body
>> that I could get to work is to put all the statements into a single 
>> expression,
>> (separated by ';' and in curly brackets):
>> 
>> ################################
>> 
>> body(f) <- expression({res <- x^2; return(x)})
>> 
>> ################################
>> 
>> I think the words 'or a list of R expressions.' should be removed.
>
> It's slightly trickier than that. The value _can_ be a list, but only one of 
> length 1. The same actually goes for expressions, but in that case there is 
> explicit code to take only the first element. Also, the distinction between 
> objects of mode "expression" and unevaluated expressions is unclear (here and 
> elsewhere).
>
>> body(f) <- expression(x,y,z)
>> f
> function ()
> x
>> body(f) <- list(quote(2+2))
>> f
> function ()
> 2 + 2
>> body(f) <- list(expression(2+2))
>> f
> function ()
> expression(2 + 2)
>
>
> BTW: Don't use 'wishlist' on things that are real errors.
>
> --
>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
> (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From ripley at stats.ox.ac.uk  Sat Dec 13 12:20:05 2008
From: ripley at stats.ox.ac.uk (ripley at stats.ox.ac.uk)
Date: Sat, 13 Dec 2008 12:20:05 +0100 (CET)
Subject: [Rd] (PR#13318) Wishlist: fix error in documentation for
Message-ID: <20081213112006.00ACD282EFF0@mail.pubhealth.ku.dk>

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.

--27464147-1942928637-1229159653=:5347
Content-Type: TEXT/PLAIN; CHARSET=ISO-8859-15; format=flowed
Content-Transfer-Encoding: 8BIT
Content-ID: <alpine.LFD.2.00.0812130938061.6595 at gannet.stats.ox.ac.uk>

There are two issues here, what it does and what it should do..

One issue is what is meant by 'expression': is it an expressions vector of 
type "expression" or is it 'expression' as documented as an element of 
such a vector in ?expression?  For body<- it is the latter.

Then there are a couple of odd exceptions.

1) If 'value' is of type expression, the first element is taken, silently.

2) If 'value' is a length-one list, its first element is taken.
If 'value' is a named list of length greater than one. the last element is 
taken as the value and the remaining elements as additional arguments.

The first is by design, the second seems to be a bug (and in the case of 
formals<- it definitely is a bug which I have just corrected).  The issue 
is in

> base::`body<-`
function (fun, envir = environment(fun), value)
{
     if (is.expression(value))
         value <- value[[1]]
     as.function(c(formals(fun), value), envir)
}

formals(fun) is a normally a pairlist so c() is concatenating 'value' to a 
list, and will do an implicit as.list().  However, in the case of no 
arguments it fails (another bug I have just corrected).

I think we want this to be

     as.function(c(as.list(formals(fun)), list(value)), envir)

but that does change the behaviour for a length-one list 'value'.  It 
seems a fair guess that no one is intentionally relying on the latter, but 
you never know ....

On Fri, 21 Nov 2008, Peter Dalgaard wrote:

> fabian.scheipl at stat.uni-muenchen.de wrote:
>> Full_Name: Fabian Scheipl
>> Version: 2.8.0
>> OS: Windows, Linux
>> Submission from: (NULL) (138.246.7.150)
>> 
>> 
>> It seems to me that the documentation for body<- is wrong.
>> The help file for 
>> body(fun, envir = environment(fun)) <- value
>> 
>> says that:
>> 
>> value can be an expression or a list of R expressions.
>> 
>> This produces errors however:
>> 
>> ################################
>> 
>>> f <- function(x){}
>>> body(f) <- list(expression(res <- x^2),expression(return(x)))
>> Fehler in as.function.default(c(formals(fun), value), envir) :   ung?ltiges 
>> formales Argument f?r "function"
>> 
>> ################################
>> 
>> 
>> The only way to assign multiple statements to a function body
>> that I could get to work is to put all the statements into a single 
>> expression,
>> (separated by ';' and in curly brackets):
>> 
>> ################################
>> 
>> body(f) <- expression({res <- x^2; return(x)})
>> 
>> ################################
>> 
>> I think the words 'or a list of R expressions.' should be removed.
>
> It's slightly trickier than that. The value _can_ be a list, but only one of 
> length 1. The same actually goes for expressions, but in that case there is 
> explicit code to take only the first element. Also, the distinction between 
> objects of mode "expression" and unevaluated expressions is unclear (here and 
> elsewhere).
>
>> body(f) <- expression(x,y,z)
>> f
> function ()
> x
>> body(f) <- list(quote(2+2))
>> f
> function ()
> 2 + 2
>> body(f) <- list(expression(2+2))
>> f
> function ()
> expression(2 + 2)
>
>
> BTW: Don't use 'wishlist' on things that are real errors.
>
> --
>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
> (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595
--27464147-1942928637-1229159653=:5347--


From ripley at stats.ox.ac.uk  Sat Dec 13 14:09:02 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 13 Dec 2008 13:09:02 +0000 (GMT)
Subject: [Rd] Recent bug fixes to body<- need 'methods' re-installed
Message-ID: <alpine.LFD.2.00.0812131258260.30710@gannet.stats.ox.ac.uk>

If you update a build of R-devel or R-patched from an SVN checkout you 
will need to ensure that 'methods' is rebuilt (rm -r library/methods/R 
suffices) once you see today's updates to src/library/base/R/formals.R.

The reason is the long-standing infelicity that when you create an S4 
generic for a function, it _copies_ the existing function as the default 
method rather than create a call to the existing function.  This happens 
for body<- in the methods package itself, which in a vanilla session will 
mask the bug-fixed version in base.

'make check' will fail in R-devel but not in R-patched if 'methods' is not 
rebuilt.

A clean build, including one from a tarball, will not have the problem.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From jmacdon at med.umich.edu  Sun Dec 14 20:12:31 2008
From: jmacdon at med.umich.edu (James MacDonald)
Date: Sun, 14 Dec 2008 14:12:31 -0500
Subject: [Rd] NAMESPACE/DESCRIPTION and imports
Message-ID: <49451456020000EE00064357@gwia01x.med.umich.edu>

Hi,

Could someone point me to the relevant documentation that covers what should be in the DESCRIPTION file for packages that have functions imported via the NAMESPACE file? I have read the R Extensions manual, but I cannot find where it covers the DESCRIPTION file vis a vis importing from a namespace.

An example:

I have a package foo that uses two functions x and y from package bar. Both packages have namespaces, and I just want to import the functions from bar rather than attaching the package.

I put 

Imports: bar

in my DESCRIPTION file and

importFrom(bar, x, y)

in my NAMESPACE file.

I have a vignette that uses both x and y from bar, and when I run R CMD build foo, at the vignette building step it errors out because it cannot find function x. If I add

Depends: bar

to my DESCRIPTION file it all works, but bar is attached and it seems I have not accomplished what I wanted. I am obviously misunderstanding something but I don't know what.

Best,

Jim



James W. MacDonald, M.S.
Biostatistician
Hildebrandt Lab
8220D MSRB III
1150 W. Medical Center Drive
Ann Arbor MI 48109-0646
734-936-8662
**********************************************************
Electronic Mail is not secure, may not be read every day, and should not be used for urgent or sensitive issues


From edd at debian.org  Sun Dec 14 21:32:55 2008
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sun, 14 Dec 2008 14:32:55 -0600
Subject: [Rd] package development
In-Reply-To: <49428BB7.6030406@bank-banque-canada.ca>
References: <200812112304.mBBN4stJ008607@rocky.mayo.edu>
	<4941A995.1040409@stats.uwo.ca>
	<49427147.5070204@bank-banque-canada.ca>
	<e8e755250812120747x241cde78y65e12b3a27ea518a@mail.gmail.com>
	<49428BB7.6030406@bank-banque-canada.ca>
Message-ID: <18757.28023.55046.821105@ron.nulle.part>


On 12 December 2008 at 11:05, Paul Gilbert wrote:
| Yes, there are several options for not distributing tests.  I was 
| thinking more about how to distribute them with a simple mechanism for 
| anyone to run them, but in a way that they are not run by the usual R 
| CMD check.

One scheme I quite like (despite its "heavy" feel) is what Martin Maechler
had cooked up for the Rmetrics packages, based on earlier work by Gregor
Gorjanc in the gdata package:

 -- it uses RUnit, so you get the full support of a mature unit testing
    framework.

 -- the tests are installed in inst/unitTests and hence available for tests
    during package build as well as once installed which is nice as you can
    re-rerun tests on installed packages 

 -- tests/ has a 'hook' script that calls the tests from ../inst/unitTests
    during the 'R CMD check' run

Any Rmetrics package can serve as an example. I just checked with timeSeries.

It may be possible to detect whether these are called during R CMD check
or not. If not, it may be worth adding another variable, or value in
options() or whathaveyou to make it detectable.

Dirk

-- 
Three out of two people have difficulties with fractions.


From j.c.l.ooms at uu.nl  Sun Dec 14 23:49:21 2008
From: j.c.l.ooms at uu.nl (Jeroen Ooms)
Date: Sun, 14 Dec 2008 14:49:21 -0800 (PST)
Subject: [Rd] re ad.spss (foreign) conflict with SPSS 17 files.
Message-ID: <21005665.post@talk.nabble.com>


SPSS seems to have changed its default datafile format, resulting in issues
for read.spss(). In Windows this results in a warning, in Debian the import
completely fails:

Debian (R version 2.8.0 (2008-10-20) i486-pc-linux-gnu, foreign_0.8-29)

> read.spss("/home/jeroen/samples/Tomato.sav")
Error in iconv(names(rval), cp, "") :
  unsupported conversion from 'CP65001' to ''
In addition: Warning messages:
1: In read.spss("/home/jeroen/samples/Tomato.sav") :
  /home/jeroen/samples/Tomato.sav: File-indicated character representation
code (65001) looks like a Windows codepage
2: In read.spss("/home/jeroen/samples/Tomato.sav") :
  /home/jeroen/samples/Tomato.sav: Unrecognized record type 7, subtype 20
encountered in system file
>


windows (R version 2.8.0 (2008-10-20), foreign_0.8-29)

> read.spss("C:/Program
> Files/SPSSInc/Statistics17/Samples/English/Tomato.sav")

...
 
attr(,"codepage")
[1] 65001

Warning messages:
1: In read.spss("C:/Program
Files/SPSSInc/Statistics17/Samples/English/Tomato.sav") :
  C:/Program Files/SPSSInc/Statistics17/Samples/English/Tomato.sav:
File-indicated character representation code (65001) looks like a Windows
codepage
2: In read.spss("C:/Program
Files/SPSSInc/Statistics17/Samples/English/Tomato.sav") :
  C:/Program Files/SPSSInc/Statistics17/Samples/English/Tomato.sav:
Unrecognized record type 7, subtype 20 encountered in system file


I've share some sample datafiles that are included with SPSS, so you can
take a look: http://jeroen.xlshosting.net/samples/
I hope there is a fix, I think importing data from SPSS is a very popular
feature. 

Thank you!
-- 
View this message in context: http://www.nabble.com/read.spss-%28foreign%29-conflict-with-SPSS-17-files.-tp21005665p21005665.html
Sent from the R devel mailing list archive at Nabble.com.


From p.dalgaard at biostat.ku.dk  Mon Dec 15 02:06:39 2008
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Mon, 15 Dec 2008 02:06:39 +0100
Subject: [Rd] re ad.spss (foreign) conflict with SPSS 17 files.
In-Reply-To: <21005665.post@talk.nabble.com>
References: <21005665.post@talk.nabble.com>
Message-ID: <4945AD9F.5080603@biostat.ku.dk>

Jeroen Ooms wrote:
> SPSS seems to have changed its default datafile format, resulting in issues
> for read.spss(). In Windows this results in a warning, in Debian the import
> completely fails:
> 
> Debian (R version 2.8.0 (2008-10-20) i486-pc-linux-gnu, foreign_0.8-29)
> 
>> read.spss("/home/jeroen/samples/Tomato.sav")
> Error in iconv(names(rval), cp, "") :
>   unsupported conversion from 'CP65001' to ''
> In addition: Warning messages:
> 1: In read.spss("/home/jeroen/samples/Tomato.sav") :
>   /home/jeroen/samples/Tomato.sav: File-indicated character representation
> code (65001) looks like a Windows codepage
> 2: In read.spss("/home/jeroen/samples/Tomato.sav") :
>   /home/jeroen/samples/Tomato.sav: Unrecognized record type 7, subtype 20
> encountered in system file
> 
> 
> windows (R version 2.8.0 (2008-10-20), foreign_0.8-29)
> 
>> read.spss("C:/Program
>> Files/SPSSInc/Statistics17/Samples/English/Tomato.sav")
> 
> ...
>  
> attr(,"codepage")
> [1] 65001
> 
> Warning messages:
> 1: In read.spss("C:/Program
> Files/SPSSInc/Statistics17/Samples/English/Tomato.sav") :
>   C:/Program Files/SPSSInc/Statistics17/Samples/English/Tomato.sav:
> File-indicated character representation code (65001) looks like a Windows
> codepage
> 2: In read.spss("C:/Program
> Files/SPSSInc/Statistics17/Samples/English/Tomato.sav") :
>   C:/Program Files/SPSSInc/Statistics17/Samples/English/Tomato.sav:
> Unrecognized record type 7, subtype 20 encountered in system file
> 
> 
> I've share some sample datafiles that are included with SPSS, so you can
> take a look: http://jeroen.xlshosting.net/samples/
> I hope there is a fix, I think importing data from SPSS is a very popular
> feature. 
> 
> Thank you!


Thanks,

It looks like adding reencode="utf8" removes the iconv message. The 
warnings appear to be harmless.

In fact, reencode="ascii" works for me as well on the Tomato.sav file. 
However as far as I can google, Code Page 65001 _is_ UTF-8...

-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From bolker at ufl.edu  Mon Dec 15 03:14:59 2008
From: bolker at ufl.edu (Ben Bolker)
Date: Sun, 14 Dec 2008 21:14:59 -0500
Subject: [Rd] [R] Some clarificatins of anova() and summary ()
In-Reply-To: <49453C83.91DF.00CB.0@grecc.umaryland.edu>
References: <d2b12c090812140640g3813d51aub7cc6aaedbc65497@mail.gmail.com>
	<B6B7A40C-E75A-44A5-A981-B888D04F2B7A@comcast.net>
	<d2b12c090812140726y45f523b3yf3cf33ae0177e9ce@mail.gmail.com>
	<d2b12c090812140756n57768c5l7aca26c4c9b4a0f4@mail.gmail.com>
	<d2b12c090812140809k37a6e868hc01ed6d0dd6d5ba9@mail.gmail.com>
	<f8e6ff050812140818sbf65820i61449f4d48dd6625@mail.gmail.com>
	<d2b12c090812140839x52a3f575q6f36500f2cafb1e4@mail.gmail.com>
	<21002390.post@talk.nabble.com>
	<49453C83.91DF.00CB.0@grecc.umaryland.edu>
Message-ID: <4945BDA3.3070901@ufl.edu>

  It is quite likely to be an uphill battle getting
them accepted, but ...

  can you propose some changes (preferably in the form of
diffs to the current development version) that would improve
the current documentation?  That would at least be a start
for the inevitable discussions about what, specifically,
the docs should say about these issues ...

  (Moving to the r-devel list)

  cheers
    Ben Bolker

John Sorkin wrote:
> Ben,
> You were quite correct to indicate that Tanmoy should not use the listserver to get answers to his class assignments. Never the less, I do have some sympathy for him. The help pages for the R functions summary, anova, drop1, do not discuss the critically important issue addressed by Tanmoy's class assignment. I believe this is a serious limitation. If users do not understand the differences between the output of these three basic functions, they can easily be led astray. I am not sure who has access to the help pages, but I hope they see this Email and consider modifying the help pages so as to address the important issue highlighted by Tanmoy's class assignment.
> John
> 
> John David Sorkin M.D., Ph.D.
> Chief, Biostatistics and Informatics
> University of Maryland School of Medicine Division of Gerontology
> Baltimore VA Medical Center
> 10 North Greene Street
> GRECC (BT/18/GR)
> Baltimore, MD 21201-1524
> (Phone) 410-605-7119
> (Fax) 410-605-7913 (Please call phone number above prior to faxing)
> 
>>>> Ben Bolker <bolker at ufl.edu> 12/14/2008 12:25 PM >>>
> 
> 
> 
> Tanmoy Talukdar wrote:
>> I think now I have got some understanding of the things.
>>
>> y ~ x1+x2 first adds x1 to the model and then adds x2 .
>> But y~x2+x1 adds x2 first, so the value we get are different.
>>
>> please correct me if i am wrong.
>>
>>
> 
>  You are not wrong.  However, you're wearing out your welcome
> a bit by posting very frequent messages to the list. I'd strongly
> recommend that you find some more help locally, or find a
> copy of Peter Dalgaard's "Introductory Statistics with R",
> and try to work through some of these problems on your own
> a bit more.  If you can demonstrate that you've really gone
> away and read and thought about these things, and articulate
> what still doesn't make sense to you about the way R is doing
> things, and that we are not simply answering homework questions,
> you will probably get useful answers ...
> 
>   good luck,
>     Ben Bolker
> 
> 


-- 
Ben Bolker
Associate professor, Biology Dep't, Univ. of Florida
bolker at ufl.edu / www.zoology.ufl.edu/bolker
GPG key: www.zoology.ufl.edu/bolker/benbolker-publickey.asc


From ripley at stats.ox.ac.uk  Mon Dec 15 07:51:34 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 15 Dec 2008 06:51:34 +0000 (GMT)
Subject: [Rd] re ad.spss (foreign) conflict with SPSS 17 files.
In-Reply-To: <4945AD9F.5080603@biostat.ku.dk>
References: <21005665.post@talk.nabble.com> <4945AD9F.5080603@biostat.ku.dk>
Message-ID: <alpine.LFD.2.00.0812150645450.32167@gannet.stats.ox.ac.uk>

See the help page.   We haven't been told but it looks like the Debian 
system is in a UTF-8 locale: reencode=FALSE is likely appropriate there.
However, the posting guide does ask for the output of sessionInof() for a 
good reason.

Yes, it looks like 65001 is UTF-8, but we don't know for certain.  I am 
planning on assuming so for the next release of foreign, which will follow 
R 2.8.1 early in the next year.

I think the title is rather off: this is more what read.spss does about 
undocumented features of SPSS formats (and record type 7, subtype 20 is 
another such feature).

On Mon, 15 Dec 2008, Peter Dalgaard wrote:

> Jeroen Ooms wrote:
>> SPSS seems to have changed its default datafile format, resulting in issues
>> for read.spss(). In Windows this results in a warning, in Debian the import
>> completely fails:
>> 
>> Debian (R version 2.8.0 (2008-10-20) i486-pc-linux-gnu, foreign_0.8-29)
>> 
>>> read.spss("/home/jeroen/samples/Tomato.sav")
>> Error in iconv(names(rval), cp, "") :
>>   unsupported conversion from 'CP65001' to ''
>> In addition: Warning messages:
>> 1: In read.spss("/home/jeroen/samples/Tomato.sav") :
>>   /home/jeroen/samples/Tomato.sav: File-indicated character representation
>> code (65001) looks like a Windows codepage
>> 2: In read.spss("/home/jeroen/samples/Tomato.sav") :
>>   /home/jeroen/samples/Tomato.sav: Unrecognized record type 7, subtype 20
>> encountered in system file
>> 
>> 
>> windows (R version 2.8.0 (2008-10-20), foreign_0.8-29)
>> 
>>> read.spss("C:/Program
>>> Files/SPSSInc/Statistics17/Samples/English/Tomato.sav")
>> 
>> ...
>>  attr(,"codepage")
>> [1] 65001
>> 
>> Warning messages:
>> 1: In read.spss("C:/Program
>> Files/SPSSInc/Statistics17/Samples/English/Tomato.sav") :
>>   C:/Program Files/SPSSInc/Statistics17/Samples/English/Tomato.sav:
>> File-indicated character representation code (65001) looks like a Windows
>> codepage
>> 2: In read.spss("C:/Program
>> Files/SPSSInc/Statistics17/Samples/English/Tomato.sav") :
>>   C:/Program Files/SPSSInc/Statistics17/Samples/English/Tomato.sav:
>> Unrecognized record type 7, subtype 20 encountered in system file
>> 
>> 
>> I've share some sample datafiles that are included with SPSS, so you can
>> take a look: http://jeroen.xlshosting.net/samples/
>> I hope there is a fix, I think importing data from SPSS is a very popular
>> feature.

We do prefer people to export from SPSS in a documented format.

>> Thank you!
>
>
> Thanks,
>
> It looks like adding reencode="utf8" removes the iconv message. The warnings 
> appear to be harmless.
>
> In fact, reencode="ascii" works for me as well on the Tomato.sav file. 
> However as far as I can google, Code Page 65001 _is_ UTF-8...
>
> --
>   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
>  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
> (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
> ~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From j.c.l.ooms at uu.nl  Mon Dec 15 12:37:15 2008
From: j.c.l.ooms at uu.nl (Jeroen Ooms)
Date: Mon, 15 Dec 2008 03:37:15 -0800 (PST)
Subject: [Rd] re  ad.spss (foreign) conflict with SPSS 17 files.
In-Reply-To: <alpine.LFD.2.00.0812150645450.32167@gannet.stats.ox.ac.uk>
References: <21005665.post@talk.nabble.com> <4945AD9F.5080603@biostat.ku.dk>
	<alpine.LFD.2.00.0812150645450.32167@gannet.stats.ox.ac.uk>
Message-ID: <21012393.post@talk.nabble.com>



Prof Brian Ripley wrote:
> 
> See the help page.   We haven't been told but it looks like the Debian 
> system is in a UTF-8 locale: reencode=FALSE is likely appropriate there.
> However, the posting guide does ask for the output of sessionInof() for a 
> good reason.
> 

Thank you very much; the Debian machine is indeed in a UTF-8 locale. All
suggested values for the reencode parameter (utf8,ascii,FALSE) therefore do
the trick. 




-- 
View this message in context: http://www.nabble.com/read.spss-%28foreign%29-conflict-with-SPSS-17-files.-tp21005665p21012393.html
Sent from the R devel mailing list archive at Nabble.com.


From krcoombes at mdacc.tmc.edu  Mon Dec 15 16:31:14 2008
From: krcoombes at mdacc.tmc.edu (Kevin R. Coombes)
Date: Mon, 15 Dec 2008 09:31:14 -0600
Subject: [Rd] package development
In-Reply-To: <18757.28023.55046.821105@ron.nulle.part>
References: <200812112304.mBBN4stJ008607@rocky.mayo.edu>	<4941A995.1040409@stats.uwo.ca>	<49427147.5070204@bank-banque-canada.ca>	<e8e755250812120747x241cde78y65e12b3a27ea518a@mail.gmail.com>	<49428BB7.6030406@bank-banque-canada.ca>
	<18757.28023.55046.821105@ron.nulle.part>
Message-ID: <49467842.6090004@mdacc.tmc.edu>

Hi,

Terry Therneau's question about package development reminded me of a 
different issue. I maintain several packages along with a repository for 
them at "http://bioinformatics.mdanderson.org/OOMPA/". Several people 
are working on adding features or testing the packages. So, I often want 
to have both the latest official release and the currently testable 
build of the package available in the repository. I tried putting both 
versions in the same repository, but this leads to a problem for some of 
the testers, who are not familiar with the intricacies of building 
packages. (Thus, I cannot just tell them to get the source tarball and 
compile it; they will have no clue as to what I am talking about. And 
their Windows machines will not have the required tools installed in any 
event.)

The underlying problem is that when you run the command
 >  install.packages(repos="http://bioinformatics.mdanderson.org/OOMPA")
inside the R Windows GUI, the selection box that appears only lists the 
name of the package, _not_ the version number. Thus, the testers cannot 
tell which of two packages with the same name should be installed.

Is there any way around this problem other than to maintain two 
different repositories?

Thanks in advance,
	Kevin


From murdoch at stats.uwo.ca  Mon Dec 15 16:46:49 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 15 Dec 2008 10:46:49 -0500
Subject: [Rd] package development
In-Reply-To: <49467842.6090004@mdacc.tmc.edu>
References: <200812112304.mBBN4stJ008607@rocky.mayo.edu>	<4941A995.1040409@stats.uwo.ca>	<49427147.5070204@bank-banque-canada.ca>	<e8e755250812120747x241cde78y65e12b3a27ea518a@mail.gmail.com>	<49428BB7.6030406@bank-banque-canada.ca>	<18757.28023.55046.821105@ron.nulle.part>
	<49467842.6090004@mdacc.tmc.edu>
Message-ID: <49467BE9.2020109@stats.uwo.ca>

On 12/15/2008 10:31 AM, Kevin R. Coombes wrote:
> Hi,
> 
> Terry Therneau's question about package development reminded me of a 
> different issue. I maintain several packages along with a repository for 
> them at "http://bioinformatics.mdanderson.org/OOMPA/". Several people 
> are working on adding features or testing the packages. So, I often want 
> to have both the latest official release and the currently testable 
> build of the package available in the repository. I tried putting both 
> versions in the same repository, but this leads to a problem for some of 
> the testers, who are not familiar with the intricacies of building 
> packages. (Thus, I cannot just tell them to get the source tarball and 
> compile it; they will have no clue as to what I am talking about. And 
> their Windows machines will not have the required tools installed in any 
> event.)
> 
> The underlying problem is that when you run the command
>  >  install.packages(repos="http://bioinformatics.mdanderson.org/OOMPA")
> inside the R Windows GUI, the selection box that appears only lists the 
> name of the package, _not_ the version number. Thus, the testers cannot 
> tell which of two packages with the same name should be installed.
> 
> Is there any way around this problem other than to maintain two 
> different repositories?

available.packages() reports version numbers, e.g.

 
available.packages(contrib.url("http://bioinformatics.mdanderson.org/OOMPA"))

You'll need to write a user interface to make use of this.

Duncan Murdoch


From krcoombes at mdacc.tmc.edu  Mon Dec 15 16:58:50 2008
From: krcoombes at mdacc.tmc.edu (Kevin R. Coombes)
Date: Mon, 15 Dec 2008 09:58:50 -0600
Subject: [Rd] package development
In-Reply-To: <49467BE9.2020109@stats.uwo.ca>
References: <200812112304.mBBN4stJ008607@rocky.mayo.edu>	<4941A995.1040409@stats.uwo.ca>	<49427147.5070204@bank-banque-canada.ca>	<e8e755250812120747x241cde78y65e12b3a27ea518a@mail.gmail.com>	<49428BB7.6030406@bank-banque-canada.ca>	<18757.28023.55046.821105@ron.nulle.part>
	<49467842.6090004@mdacc.tmc.edu> <49467BE9.2020109@stats.uwo.ca>
Message-ID: <49467EBA.6070305@mdacc.tmc.edu>

I knew that (but forgot to include it in my statement of the question). 
  Thanks for pointing it out.

Is there any way to convince the selection box (or its developers) to 
include the version information that is already available?

	Kevin


Duncan Murdoch wrote:
> On 12/15/2008 10:31 AM, Kevin R. Coombes wrote:
>> Hi,
>>
>> Terry Therneau's question about package development reminded me of a 
>> different issue. I maintain several packages along with a repository 
>> for them at "http://bioinformatics.mdanderson.org/OOMPA/". Several 
>> people are working on adding features or testing the packages. So, I 
>> often want to have both the latest official release and the currently 
>> testable build of the package available in the repository. I tried 
>> putting both versions in the same repository, but this leads to a 
>> problem for some of the testers, who are not familiar with the 
>> intricacies of building packages. (Thus, I cannot just tell them to 
>> get the source tarball and compile it; they will have no clue as to 
>> what I am talking about. And their Windows machines will not have the 
>> required tools installed in any event.)
>>
>> The underlying problem is that when you run the command
>>  >  install.packages(repos="http://bioinformatics.mdanderson.org/OOMPA")
>> inside the R Windows GUI, the selection box that appears only lists 
>> the name of the package, _not_ the version number. Thus, the testers 
>> cannot tell which of two packages with the same name should be installed.
>>
>> Is there any way around this problem other than to maintain two 
>> different repositories?
> 
> available.packages() reports version numbers, e.g.
> 
> 
> available.packages(contrib.url("http://bioinformatics.mdanderson.org/OOMPA")) 
> 
> 
> You'll need to write a user interface to make use of this.
> 
> Duncan Murdoch


From cmr.pent at gmail.com  Sat Dec 13 11:25:05 2008
From: cmr.pent at gmail.com (cmr.pent at gmail.com)
Date: Sat, 13 Dec 2008 11:25:05 +0100 (CET)
Subject: [Rd] Comment on (PR#13373)
Message-ID: <20081213102505.561E3282EFF0@mail.pubhealth.ku.dk>

------=_Part_26951_7337931.1229163663746
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Dear R maintainer!

> User misread: it reduces the *base* cex.

It's not quite clear what the base cex is. Having read help(par), I
got the impression that it is the raw value of par(cex) as opposed to
the value multiplied by the value of cex argument which can be passed
to some functions. As you can see from my example, the value of
par(cex) is *reset*, not reduced.

> Setting a layout does reset cex.

Setting a layout using split.screen does not.

I still think it's a graphics bug, not a documentation bug. I've
attached a patch that modifies the behavior of par() and layout()
functions. Please review it and tell me in which cases the original
behavior was more appropriate.

I'm ready to provide any additional info,
Andrey

------=_Part_26951_7337931.1229163663746
Content-Type: text/x-diff; name=layout.patch
Content-Transfer-Encoding: base64
X-Attachment-Id: f_foo43ev90
Content-Disposition: attachment; filename=layout.patch

KioqIC9ob21lL3BlbnQvci1iYXNlLTIuOC4wL3NyYy9tYWluL3Bhci5jCTIwMDgtMDktMjIgMDI6
MDU6MjYuMDAwMDAwMDAwICswNDAwCi0tLSAvaG9tZS9wZW50L3ItYmFzZS0yLjguMC9zcmMvbWFp
bi9wYXIuYy5wYXRjaGVkCTIwMDgtMTItMTMgMTM6MTM6NDcuMDAwMDAwMDAwICswMzAwCioqKioq
KioqKioqKioqKgoqKiogNDIyLDQzNiAqKioqCiAgCVJfREVWXzIoZGVmYXVsdEZpZ3VyZSkgPSBU
UlVFOwogIAlSX0RFVl8yKGxheW91dCkgPSBGQUxTRTsKICAJaWYgKG5yb3cgPiAyIHx8IG5jb2wg
PiAyKSB7CiEgCSAgICBSX0RFVl8yKGNleGJhc2UpID0gMC42NjsKICAJICAgIFJfREVWXzIobWV4
KSA9IDEuMDsKICAJfQogIAllbHNlIGlmIChucm93ID09IDIgJiYgbmNvbCA9PSAyKSB7CiEgCSAg
ICBSX0RFVl8yKGNleGJhc2UpID0gMC44MzsKICAJICAgIFJfREVWXzIobWV4KSA9IDEuMDsKICAJ
fQogIAllbHNlIHsKISAJICAgIFJfREVWXzIoY2V4YmFzZSkgPSAxLjA7CiAgCSAgICBSX0RFVl8y
KG1leCkgPSAxLjA7CiAgCX0KICAJUl9ERVZfXyhtZmluZCkgPSAwOwotLS0gNDIyLDQzNiAtLS0t
CiAgCVJfREVWXzIoZGVmYXVsdEZpZ3VyZSkgPSBUUlVFOwogIAlSX0RFVl8yKGxheW91dCkgPSBG
QUxTRTsKICAJaWYgKG5yb3cgPiAyIHx8IG5jb2wgPiAyKSB7CiEgCSAgICBSX0RFVl8yKGNleGJh
c2UpID0gMC42NipSX0RFVl8yKGNleGJhc2UpOwogIAkgICAgUl9ERVZfMihtZXgpID0gMS4wOwog
IAl9CiAgCWVsc2UgaWYgKG5yb3cgPT0gMiAmJiBuY29sID09IDIpIHsKISAJICAgIFJfREVWXzIo
Y2V4YmFzZSkgPSAwLjgzKlJfREVWXzIoY2V4YmFzZSk7CiAgCSAgICBSX0RFVl8yKG1leCkgPSAx
LjA7CiAgCX0KICAJZWxzZSB7CiEgCSAgICBSX0RFVl8yKGNleGJhc2UpID0gMS4wKlJfREVWXzIo
Y2V4YmFzZSk7CiAgCSAgICBSX0RFVl8yKG1leCkgPSAxLjA7CiAgCX0KICAJUl9ERVZfXyhtZmlu
ZCkgPSAwOwoqKioqKioqKioqKioqKioKKioqIDQ1MSw0NjUgKioqKgogIAlSX0RFVl8yKGRlZmF1
bHRGaWd1cmUpID0gVFJVRTsKICAJUl9ERVZfMihsYXlvdXQpID0gRkFMU0U7CiAgCWlmIChucm93
ID4gMiB8fCBuY29sID4gMikgewohIAkgICAgUl9ERVZfMihjZXhiYXNlKSA9IDAuNjY7CiAgCSAg
ICBSX0RFVl8yKG1leCkgPSAxLjA7CiAgCX0KICAJZWxzZSBpZiAobnJvdyA9PSAyICYmIG5jb2wg
PT0gMikgewohIAkgICAgUl9ERVZfMihjZXhiYXNlKSA9IDAuODM7CiAgCSAgICBSX0RFVl8yKG1l
eCkgPSAxLjA7CiAgCX0KICAJZWxzZSB7CiEgCSAgICBSX0RFVl9fKGNleGJhc2UpID0gMS4wOwog
IAkgICAgUl9ERVZfXyhtZXgpID0gMS4wOwogIAl9CiAgCVJfREVWX18obWZpbmQpID0gMTsKLS0t
IDQ1MSw0NjUgLS0tLQogIAlSX0RFVl8yKGRlZmF1bHRGaWd1cmUpID0gVFJVRTsKICAJUl9ERVZf
MihsYXlvdXQpID0gRkFMU0U7CiAgCWlmIChucm93ID4gMiB8fCBuY29sID4gMikgewohIAkgICAg
Ul9ERVZfMihjZXhiYXNlKSA9IDAuNjYqUl9ERVZfMihjZXhiYXNlKTsKICAJICAgIFJfREVWXzIo
bWV4KSA9IDEuMDsKICAJfQogIAllbHNlIGlmIChucm93ID09IDIgJiYgbmNvbCA9PSAyKSB7CiEg
CSAgICBSX0RFVl8yKGNleGJhc2UpID0gMC44MypSX0RFVl8yKGNleGJhc2UpOwogIAkgICAgUl9E
RVZfMihtZXgpID0gMS4wOwogIAl9CiAgCWVsc2UgewohIAkgICAgUl9ERVZfXyhjZXhiYXNlKSA9
IDEuMCpSX0RFVl8yKGNleGJhc2UpOwogIAkgICAgUl9ERVZfXyhtZXgpID0gMS4wOwogIAl9CiAg
CVJfREVWX18obWZpbmQpID0gMTsKKioqKioqKioqKioqKioqCioqKiAxMjg0LDEyOTggKioqKgog
ICAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLSovCiAgCiAgICAgIGlmIChucm93ID4gMiB8fCBuY29sID4gMikgewohIAlncHB0cihkZCkt
PmNleGJhc2UgPSBkcHB0cihkZCktPmNleGJhc2UgPSAwLjY2OwogIAlncHB0cihkZCktPm1leCA9
IGRwcHRyKGRkKS0+bWV4ID0gMS4wOwogICAgICB9CiAgICAgIGVsc2UgaWYgKG5yb3cgPT0gMiAm
JiBuY29sID09IDIpIHsKISAJZ3BwdHIoZGQpLT5jZXhiYXNlID0gZHBwdHIoZGQpLT5jZXhiYXNl
ID0gMC44MzsKICAJZ3BwdHIoZGQpLT5tZXggPSBkcHB0cihkZCktPm1leCA9IDEuMDsKICAgICAg
fQogICAgICBlbHNlIHsKISAJZ3BwdHIoZGQpLT5jZXhiYXNlID0gZHBwdHIoZGQpLT5jZXhiYXNl
ID0gMS4wOwogIAlncHB0cihkZCktPm1leCA9IGRwcHRyKGRkKS0+bWV4ID0gMS4wOwogICAgICB9
CiAgCi0tLSAxMjg0LDEyOTggLS0tLQogICAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCiAgCiAgICAgIGlmIChucm93ID4gMiB8fCBu
Y29sID4gMikgewohIAlncHB0cihkZCktPmNleGJhc2UgPSBkcHB0cihkZCktPmNleGJhc2UgPSAw
LjY2KmRwcHRyKGRkKS0+Y2V4YmFzZTsKICAJZ3BwdHIoZGQpLT5tZXggPSBkcHB0cihkZCktPm1l
eCA9IDEuMDsKICAgICAgfQogICAgICBlbHNlIGlmIChucm93ID09IDIgJiYgbmNvbCA9PSAyKSB7
CiEgCWdwcHRyKGRkKS0+Y2V4YmFzZSA9IGRwcHRyKGRkKS0+Y2V4YmFzZSA9IDAuODMqZHBwdHIo
ZGQpLT5jZXhiYXNlOwogIAlncHB0cihkZCktPm1leCA9IGRwcHRyKGRkKS0+bWV4ID0gMS4wOwog
ICAgICB9CiAgICAgIGVsc2UgewohIAlncHB0cihkZCktPmNleGJhc2UgPSBkcHB0cihkZCktPmNl
eGJhc2UgPSAxLjAqZHBwdHIoZGQpLT5jZXhiYXNlOwogIAlncHB0cihkZCktPm1leCA9IGRwcHRy
KGRkKS0+bWV4ID0gMS4wOwogICAgICB9CiAgCg==
------=_Part_26951_7337931.1229163663746--


From rosselldavid at gmail.com  Mon Dec 15 11:04:56 2008
From: rosselldavid at gmail.com (David Rossell)
Date: Mon, 15 Dec 2008 11:04:56 +0100
Subject: [Rd] bug in R CMD INSTALL do_install under OS X
Message-ID: <376b783d0812150204h551df587t51ab032a4f980a72@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081215/8c53a49f/attachment.pl>

From murdoch at stats.uwo.ca  Mon Dec 15 17:43:33 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 15 Dec 2008 11:43:33 -0500
Subject: [Rd] package development
In-Reply-To: <49467EBA.6070305@mdacc.tmc.edu>
References: <200812112304.mBBN4stJ008607@rocky.mayo.edu>	<4941A995.1040409@stats.uwo.ca>	<49427147.5070204@bank-banque-canada.ca>	<e8e755250812120747x241cde78y65e12b3a27ea518a@mail.gmail.com>	<49428BB7.6030406@bank-banque-canada.ca>	<18757.28023.55046.821105@ron.nulle.part>
	<49467842.6090004@mdacc.tmc.edu> <49467BE9.2020109@stats.uwo.ca>
	<49467EBA.6070305@mdacc.tmc.edu>
Message-ID: <49468935.9090906@stats.uwo.ca>

On 12/15/2008 10:58 AM, Kevin R. Coombes wrote:
> I knew that (but forgot to include it in my statement of the question). 
>   Thanks for pointing it out.
> 
> Is there any way to convince the selection box (or its developers) to 
> include the version information that is already available?

The selection box is adamant that it will only display one thing.

The developers would like to have a grid display component, and then 
would be happy to display more information about each package, but are 
unlikely to write one, due to competing priorities.  If you wanted to 
contribute one...

Duncan Murdoch

> 
> 	Kevin
> 
> 
> Duncan Murdoch wrote:
>> On 12/15/2008 10:31 AM, Kevin R. Coombes wrote:
>>> Hi,
>>>
>>> Terry Therneau's question about package development reminded me of a 
>>> different issue. I maintain several packages along with a repository 
>>> for them at "http://bioinformatics.mdanderson.org/OOMPA/". Several 
>>> people are working on adding features or testing the packages. So, I 
>>> often want to have both the latest official release and the currently 
>>> testable build of the package available in the repository. I tried 
>>> putting both versions in the same repository, but this leads to a 
>>> problem for some of the testers, who are not familiar with the 
>>> intricacies of building packages. (Thus, I cannot just tell them to 
>>> get the source tarball and compile it; they will have no clue as to 
>>> what I am talking about. And their Windows machines will not have the 
>>> required tools installed in any event.)
>>>
>>> The underlying problem is that when you run the command
>>>  >  install.packages(repos="http://bioinformatics.mdanderson.org/OOMPA")
>>> inside the R Windows GUI, the selection box that appears only lists 
>>> the name of the package, _not_ the version number. Thus, the testers 
>>> cannot tell which of two packages with the same name should be installed.
>>>
>>> Is there any way around this problem other than to maintain two 
>>> different repositories?
>> 
>> available.packages() reports version numbers, e.g.
>> 
>> 
>> available.packages(contrib.url("http://bioinformatics.mdanderson.org/OOMPA")) 
>> 
>> 
>> You'll need to write a user interface to make use of this.
>> 
>> Duncan Murdoch


From ggrothendieck at gmail.com  Mon Dec 15 17:54:05 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 15 Dec 2008 11:54:05 -0500
Subject: [Rd] package development
In-Reply-To: <49468935.9090906@stats.uwo.ca>
References: <200812112304.mBBN4stJ008607@rocky.mayo.edu>
	<4941A995.1040409@stats.uwo.ca>
	<49427147.5070204@bank-banque-canada.ca>
	<e8e755250812120747x241cde78y65e12b3a27ea518a@mail.gmail.com>
	<49428BB7.6030406@bank-banque-canada.ca>
	<18757.28023.55046.821105@ron.nulle.part>
	<49467842.6090004@mdacc.tmc.edu> <49467BE9.2020109@stats.uwo.ca>
	<49467EBA.6070305@mdacc.tmc.edu> <49468935.9090906@stats.uwo.ca>
Message-ID: <971536df0812150854m2db766a0j2e1398311bca623b@mail.gmail.com>

Perhaps it would be sufficient as a first step to just display the version
that will be downloaded.  That would still only let you pick one but at
least you would know which one.

On Mon, Dec 15, 2008 at 11:43 AM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
> On 12/15/2008 10:58 AM, Kevin R. Coombes wrote:
>>
>> I knew that (but forgot to include it in my statement of the question).
>>  Thanks for pointing it out.
>>
>> Is there any way to convince the selection box (or its developers) to
>> include the version information that is already available?
>
> The selection box is adamant that it will only display one thing.
>
> The developers would like to have a grid display component, and then would
> be happy to display more information about each package, but are unlikely to
> write one, due to competing priorities.  If you wanted to contribute one...
>
> Duncan Murdoch
>
>>
>>        Kevin
>>
>>
>> Duncan Murdoch wrote:
>>>
>>> On 12/15/2008 10:31 AM, Kevin R. Coombes wrote:
>>>>
>>>> Hi,
>>>>
>>>> Terry Therneau's question about package development reminded me of a
>>>> different issue. I maintain several packages along with a repository for
>>>> them at "http://bioinformatics.mdanderson.org/OOMPA/". Several people are
>>>> working on adding features or testing the packages. So, I often want to have
>>>> both the latest official release and the currently testable build of the
>>>> package available in the repository. I tried putting both versions in the
>>>> same repository, but this leads to a problem for some of the testers, who
>>>> are not familiar with the intricacies of building packages. (Thus, I cannot
>>>> just tell them to get the source tarball and compile it; they will have no
>>>> clue as to what I am talking about. And their Windows machines will not have
>>>> the required tools installed in any event.)
>>>>
>>>> The underlying problem is that when you run the command
>>>>  >  install.packages(repos="http://bioinformatics.mdanderson.org/OOMPA")
>>>> inside the R Windows GUI, the selection box that appears only lists the
>>>> name of the package, _not_ the version number. Thus, the testers cannot tell
>>>> which of two packages with the same name should be installed.
>>>>
>>>> Is there any way around this problem other than to maintain two
>>>> different repositories?
>>>
>>> available.packages() reports version numbers, e.g.
>>>
>>>
>>>
>>> available.packages(contrib.url("http://bioinformatics.mdanderson.org/OOMPA"))
>>>
>>> You'll need to write a user interface to make use of this.
>>>
>>> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From mtmorgan at fhcrc.org  Mon Dec 15 18:16:04 2008
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Mon, 15 Dec 2008 09:16:04 -0800
Subject: [Rd] NAMESPACE/DESCRIPTION and imports
In-Reply-To: <49451456020000EE00064357@gwia01x.med.umich.edu> (James
	MacDonald's message of "Sun, 14 Dec 2008 14:12:31 -0500")
References: <49451456020000EE00064357@gwia01x.med.umich.edu>
Message-ID: <6phmyexuzor.fsf@gopher4.fhcrc.org>

Hi Jim --

"James MacDonald" <jmacdon at med.umich.edu> writes:

> Hi,
>
> Could someone point me to the relevant documentation that covers
> what should be in the DESCRIPTION file for packages that have
> functions imported via the NAMESPACE file? I have read the R
> Extensions manual, but I cannot find where it covers the DESCRIPTION
> file vis a vis importing from a namespace.
>
> An example:
>
> I have a package foo that uses two functions x and y from package
> bar. Both packages have namespaces, and I just want to import the
> functions from bar rather than attaching the package.
>
> I put 
>
> Imports: bar
>
> in my DESCRIPTION file and
>
> importFrom(bar, x, y)
>
> in my NAMESPACE file.
>

> I have a vignette that uses both x and y from bar, and when I run R
> CMD build foo, at the vignette building step it errors out because
> it cannot find function x. If I add
>
> Depends: bar
>
> to my DESCRIPTION file it all works, but bar is attached and it
> seems I have not accomplished what I wanted. I am obviously
> misunderstanding something but I don't know what.

If I'm reading correctly, you have a vignette chunk that does

<<>>=
x()
@

This corresponds to use of x _outside_ your package name space -- the
vignette is being processed like any R session.

You already have Imports: foo in your DESCRIPTION file (because you're
using x _within_ your package name space), so you know the user will
have foo installed. The vignette just needs to

library(foo)

before calling x -- i.e., attach foo to the search path, so that x can
be found in a normal R session.

A slightly different scenario is when your vignette uses a package
that it is not meaningful to Import: or Depend: on, in which case
you'll want to mention the package in the Suggests: field of
DESCRIPTION. In this case I think you also want to add a line

%\VignetteDepends{foo}

to the vignette. Suggests: is a little problematic because the default
for install.packages does NOT install packages mentioned in Suggests:
so users may be unable to build your vignette without first installing
additional packages.

Back to the case where the package Imports: foo. This is still
helpful, as it keeps from cluttering the user search path and allows
you to be confident that references to x within your package find the
appropriate x, regardless of what the user is doing to their search
path.

Hope that helps.

Martin

> Best,
>
> Jim
>
>
>
> James W. MacDonald, M.S.
> Biostatistician
> Hildebrandt Lab
> 8220D MSRB III
> 1150 W. Medical Center Drive
> Ann Arbor MI 48109-0646
> 734-936-8662
> **********************************************************
> Electronic Mail is not secure, may not be read every day, and should not be used for urgent or sensitive issues
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M2 B169
Phone: (206) 667-2793


From ripley at stats.ox.ac.uk  Mon Dec 15 18:35:14 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 15 Dec 2008 17:35:14 +0000 (GMT)
Subject: [Rd] install.packages and dependency version checking
Message-ID: <alpine.LFD.2.00.0812131539020.15227@gannet.stats.ox.ac.uk>

I've started to implement checks for package versions on dependencies in 
install.packages().  However, this is revealing a number of 
problems/misconceptions.


(A) We do not check versions when loading namespaces, ahd the namespace 
registry does not contain version information.  So that for example 
(rtracklayer)

Depends: R (>= 2.7.0), Biobase, methods, RCurl
Imports: XML (>= 1.98-0), IRanges, Biostrings

will never check the version of namespace XML that is loaded, either 
already loaded or resulting from loading this package's namespace.  For 
this to be operational we would need to extend the syntax of the imports() 
and importsFrom() directive in a NAMESPACE file to allow version 
restrictions. I am not sure this is worth doing, as an alternative is to 
put the imported package in Depends.

The version dependence will in a future release cause an update of XML 
when rtracklayer is installed, if needed (and available).


(B) Things like (package stam)

Depends: R (>= 2.7.0), GO.db (>= 2.1.3), Biobase (>= 1.99.5), pamr (>=
         1.37.0), cluster (>= 1.11.10), annaffy (>= 1.11.5), methods (>=
         2.7.0), utils (>= 2.7.0)

are redundant: the versions of method and utils are always the same as 
that of R.

And there is no point in having a package in both Depends: and Imports:, 
as Biostrings has.


(C) There is no check on the version of a package suggested by Suggests:, 
unless the package itself provides one (and I found no instances).


(D) We can really only handle >= dependencies on package versions (but 
then I can see no other ops in use).  install.packages() will find the 
latest version available on the repositories, and we possibly need to 
check version requirements on the same dependency many times.  Given that 
BioC has a penchant for having version dependencies on unavailable 
versions (e.g. last week on IRanges (>= 1.1.7) with 1.1.4 available), we 
may be able to satisfy the requirements of some packages and not others. 
(In that case the strategy used is to install the latest available version 
if the one installed does not suffice for those we can satisfy, and report 
the problem(s).)


(E) One of the arguments that has been used to do this version checking at 
install time is to avoid installing packages that cannot work. It would be 
possible to extend the approach to do so, but I am going to leave that to 
those who advocated it.


The net effect of the current changes will be that if there is a 
dependence that is already installed but a later version is available and 
will help satisfy a >= dependence, it will be added to the list of 
packages to be installed.  As we have seen with Matrix this last week, 
that can have downsides in stopping previously functional packages 
working.

This is work in progress: there is no way to write a test suite that will 
encapsulate all the possible scenarios so weneed to get experience 
until 2.9.0 is released.  Please report any quirks to R-devel if they are 
completely reproducible (and preferably with the code change needed to fix 
them, since the chance of anyone else being able to reproduce them are 
fairly slim).

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ggrothendieck at gmail.com  Mon Dec 15 18:52:26 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 15 Dec 2008 12:52:26 -0500
Subject: [Rd] install.packages and dependency version checking
In-Reply-To: <alpine.LFD.2.00.0812131539020.15227@gannet.stats.ox.ac.uk>
References: <alpine.LFD.2.00.0812131539020.15227@gannet.stats.ox.ac.uk>
Message-ID: <971536df0812150952y5de2e29eh934b17418b4c5832@mail.gmail.com>

On Mon, Dec 15, 2008 at 12:35 PM, Prof Brian Ripley
<ripley at stats.ox.ac.uk> wrote:
> (D) We can really only handle >= dependencies on package versions (but then
> I can see no other ops in use).  install.packages() will find the latest

Ryacas works with XML 1.96-0; however, after Ryacas was released newer
versions of XML break Ryacas so a new release of Ryacas would, at the moment,
need XML (= 1.96-0).


From mtmorgan at fhcrc.org  Mon Dec 15 19:05:54 2008
From: mtmorgan at fhcrc.org (Martin Morgan)
Date: Mon, 15 Dec 2008 10:05:54 -0800
Subject: [Rd] install.packages and dependency version checking
In-Reply-To: <alpine.LFD.2.00.0812131539020.15227@gannet.stats.ox.ac.uk> (Brian
	Ripley's message of "Mon, 15 Dec 2008 17:35:14 +0000 (GMT)")
References: <alpine.LFD.2.00.0812131539020.15227@gannet.stats.ox.ac.uk>
Message-ID: <6phej09uxdp.fsf@gopher4.fhcrc.org>

Prof Brian Ripley <ripley at stats.ox.ac.uk> writes:

> I've started to implement checks for package versions on dependencies
> in install.packages().  However, this is revealing a number of
> problems/misconceptions.
>
>
> (A) We do not check versions when loading namespaces, ahd the
> namespace registry does not contain version information.  So that for
> example (rtracklayer)
>
> Depends: R (>= 2.7.0), Biobase, methods, RCurl
> Imports: XML (>= 1.98-0), IRanges, Biostrings
>
> will never check the version of namespace XML that is loaded, either
> already loaded or resulting from loading this package's namespace.
> For this to be operational we would need to extend the syntax of the
> imports() and importsFrom() directive in a NAMESPACE file to allow
> version restrictions. I am not sure this is worth doing, as an
> alternative is to put the imported package in Depends.

Without XML in Imports: references in the package name space to
functions in XML rely on the user not adjusting their search
path. Often XML may well be 'infrastructure' that the end-user has no
use for, and should not be contributing to the possibility of
unexpected name collisions by cluttering their search path.

> The version dependence will in a future release cause an update of XML
> when rtracklayer is installed, if needed (and available).
>
>
> (B) Things like (package stam)
>
> Depends: R (>= 2.7.0), GO.db (>= 2.1.3), Biobase (>= 1.99.5), pamr (>=
>          1.37.0), cluster (>= 1.11.10), annaffy (>= 1.11.5), methods (>=
>          2.7.0), utils (>= 2.7.0)
>
> are redundant: the versions of method and utils are always the same as
> that of R.
>
> And there is no point in having a package in both Depends: and
> Imports:, as Biostrings has.

Imports: (and imports() in NAMESPACE) gives the name space reliable
access to specific functions / classes; Depends: gives the user access
to (possibly a greater diversity of) functions.

> (C) There is no check on the version of a package suggested by
> Suggests:, unless the package itself provides one (and I found no
> instances).
>
>
> (D) We can really only handle >= dependencies on package versions (but
> then I can see no other ops in use).  install.packages() will find the
> latest version available on the repositories, and we possibly need to
> check version requirements on the same dependency many times.  Given
> that BioC has a penchant for having version dependencies on
> unavailable versions (e.g. last week on IRanges (>= 1.1.7) with 1.1.4
> available), we may be able to satisfy the requirements of some
> packages and not others. (In that case the strategy used is to install
> the latest available version if the one installed does not suffice for
> those we can satisfy, and report the problem(s).)

To clarify, I guess you mean that IRanges 1.1.4 would be installed for
packages that specified, say, IRanges >= 1.1.0, but that the package
depending on 1.1.7 would not install. It would be a mistake to install
a package with unsatisfied dependencies.

> (E) One of the arguments that has been used to do this version
> checking at install time is to avoid installing packages that cannot
> work. It would be possible to extend the approach to do so, but I am
> going to leave that to those who advocated it.
>
>
> The net effect of the current changes will be that if there is a
> dependence that is already installed but a later version is available
> and will help satisfy a >= dependence, it will be added to the list of
> packages to be installed.  As we have seen with Matrix this last week,
> that can have downsides in stopping previously functional packages
> working.
>
> This is work in progress: there is no way to write a test suite that
> will encapsulate all the possible scenarios so weneed to get
> experience until 2.9.0 is released.  Please report any quirks to
> R-devel if they are completely reproducible (and preferably with the
> code change needed to fix them, since the chance of anyone else being
> able to reproduce them are fairly slim).
>
> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Martin Morgan
Computational Biology / Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N.
PO Box 19024 Seattle, WA 98109

Location: Arnold Building M2 B169
Phone: (206) 667-2793


From ripley at stats.ox.ac.uk  Mon Dec 15 19:28:54 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Mon, 15 Dec 2008 18:28:54 +0000 (GMT)
Subject: [Rd] install.packages and dependency version checking
In-Reply-To: <6phej09uxdp.fsf@gopher4.fhcrc.org>
References: <alpine.LFD.2.00.0812131539020.15227@gannet.stats.ox.ac.uk>
	<6phej09uxdp.fsf@gopher4.fhcrc.org>
Message-ID: <alpine.LFD.2.00.0812151823260.4545@gannet.stats.ox.ac.uk>

On Mon, 15 Dec 2008, Martin Morgan wrote:

> Prof Brian Ripley <ripley at stats.ox.ac.uk> writes:
>
>> I've started to implement checks for package versions on dependencies
>> in install.packages().  However, this is revealing a number of
>> problems/misconceptions.
>>
>>
>> (A) We do not check versions when loading namespaces, ahd the
>> namespace registry does not contain version information.  So that for
>> example (rtracklayer)
>>
>> Depends: R (>= 2.7.0), Biobase, methods, RCurl
>> Imports: XML (>= 1.98-0), IRanges, Biostrings
>>
>> will never check the version of namespace XML that is loaded, either
>> already loaded or resulting from loading this package's namespace.
>> For this to be operational we would need to extend the syntax of the
>> imports() and importsFrom() directive in a NAMESPACE file to allow
>> version restrictions. I am not sure this is worth doing, as an
>> alternative is to put the imported package in Depends.
>
> Without XML in Imports: references in the package name space to
> functions in XML rely on the user not adjusting their search
> path. Often XML may well be 'infrastructure' that the end-user has no
> use for, and should not be contributing to the possibility of
> unexpected name collisions by cluttering their search path.

But if they have a version requirement it is going unchecked.

>> The version dependence will in a future release cause an update of XML
>> when rtracklayer is installed, if needed (and available).
>>
>>
>> (B) Things like (package stam)
>>
>> Depends: R (>= 2.7.0), GO.db (>= 2.1.3), Biobase (>= 1.99.5), pamr (>=
>>          1.37.0), cluster (>= 1.11.10), annaffy (>= 1.11.5), methods (>=
>>          2.7.0), utils (>= 2.7.0)
>>
>> are redundant: the versions of method and utils are always the same as
>> that of R.
>>
>> And there is no point in having a package in both Depends: and
>> Imports:, as Biostrings has.
>
> Imports: (and imports() in NAMESPACE) gives the name space reliable
> access to specific functions / classes; Depends: gives the user access
> to (possibly a greater diversity of) functions.
>
>> (C) There is no check on the version of a package suggested by
>> Suggests:, unless the package itself provides one (and I found no
>> instances).
>>
>>
>> (D) We can really only handle >= dependencies on package versions (but
>> then I can see no other ops in use).  install.packages() will find the
>> latest version available on the repositories, and we possibly need to
>> check version requirements on the same dependency many times.  Given
>> that BioC has a penchant for having version dependencies on
>> unavailable versions (e.g. last week on IRanges (>= 1.1.7) with 1.1.4
>> available), we may be able to satisfy the requirements of some
>> packages and not others. (In that case the strategy used is to install
>> the latest available version if the one installed does not suffice for
>> those we can satisfy, and report the problem(s).)
>
> To clarify, I guess you mean that IRanges 1.1.4 would be installed for
> packages that specified, say, IRanges >= 1.1.0,

Yes, if a recent enough version is not already installed.

> but that the package depending on 1.1.7 would not install.

Only if it uses lazy loading.  It might install but not load otherwise.

> It would be a mistake to install a package with unsatisfied 
> dependencies.

That's a point of view: see (E).  Others would argue that the bug is in 
the BioC release procedures, in that packages with impossible dependencies 
should never be released.

>> (E) One of the arguments that has been used to do this version
>> checking at install time is to avoid installing packages that cannot
>> work. It would be possible to extend the approach to do so, but I am
>> going to leave that to those who advocated it.
>>
>>
>> The net effect of the current changes will be that if there is a
>> dependence that is already installed but a later version is available
>> and will help satisfy a >= dependence, it will be added to the list of
>> packages to be installed.  As we have seen with Matrix this last week,
>> that can have downsides in stopping previously functional packages
>> working.
>>
>> This is work in progress: there is no way to write a test suite that
>> will encapsulate all the possible scenarios so weneed to get
>> experience until 2.9.0 is released.  Please report any quirks to
>> R-devel if they are completely reproducible (and preferably with the
>> code change needed to fix them, since the chance of anyone else being
>> able to reproduce them are fairly slim).
>>
>> --
>> Brian D. Ripley,                  ripley at stats.ox.ac.uk
>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
>> University of Oxford,             Tel:  +44 1865 272861 (self)
>> 1 South Parks Road,                     +44 1865 272866 (PA)
>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From krcoombes at mdacc.tmc.edu  Mon Dec 15 20:20:51 2008
From: krcoombes at mdacc.tmc.edu (Kevin R. Coombes)
Date: Mon, 15 Dec 2008 13:20:51 -0600
Subject: [Rd] package development
In-Reply-To: <971536df0812150854m2db766a0j2e1398311bca623b@mail.gmail.com>
References: <200812112304.mBBN4stJ008607@rocky.mayo.edu>	
	<4941A995.1040409@stats.uwo.ca>	
	<49427147.5070204@bank-banque-canada.ca>	
	<e8e755250812120747x241cde78y65e12b3a27ea518a@mail.gmail.com>	
	<49428BB7.6030406@bank-banque-canada.ca>	
	<18757.28023.55046.821105@ron.nulle.part>	
	<49467842.6090004@mdacc.tmc.edu> <49467BE9.2020109@stats.uwo.ca>	
	<49467EBA.6070305@mdacc.tmc.edu> <49468935.9090906@stats.uwo.ca>
	<971536df0812150854m2db766a0j2e1398311bca623b@mail.gmail.com>
Message-ID: <4946AE13.6040802@mdacc.tmc.edu>

Hi,

I have now spent some time looking at whether this is possible with one 
repository. The _easy_ part is getting the selection list to display 
more information. Right now, the code that determines what is displayed 
is inside a function called "explode_bundles" that is defined internally 
to the "install.packages" function. In its entirety, here is that function:

     explode_bundles <- function(a) {
         contains <- .find_bundles(a, FALSE)
         extras <- unlist(lapply(names(contains), function(x)
             paste(contains[[x]], " (", x, ")", sep = "")))
         sort(as.vector(c(a[, 1], extras)))
     }

This is only called once, with the argument "a" begin the results of a 
call to "available.packages". If you simply change this function to 
something like

     explode_bundles <- function(a) {
         contains <- .find_bundles(a, FALSE)
         extras <- unlist(lapply(names(contains), function(x)
             paste(contains[[x]], " (", x, ")", sep = "")))
         sort(as.vector(c(paste(a[, 1], a[, 2], sep=", "), extras)))
     }

then packages will be listed in the selection list followed by their 
version numbers. (I don't know what this does to bundles, since my 
packages don't have any bundles for me to check the behavior.)

Making this change, however, will break the routine 
"utils:::.install.winbinary" (as well as the analogs on other platforms) 
which currently assumes that there is only one version of each package, 
and (even if there is more than one) always seems to install the newest 
one. But, in principle, the version number could be parsed back out of 
the pasted-together displayed names and used to tell these routines to 
install the actual version you want.

In the meantime, I'll bite the bullet and set up a second testing 
repository.

Thanks,
	Kevin

Gabor Grothendieck wrote:
> Perhaps it would be sufficient as a first step to just display the version
> that will be downloaded.  That would still only let you pick one but at
> least you would know which one.
> 
> On Mon, Dec 15, 2008 at 11:43 AM, Duncan Murdoch <murdoch at stats.uwo.ca> wrote:
>> On 12/15/2008 10:58 AM, Kevin R. Coombes wrote:
>>> I knew that (but forgot to include it in my statement of the question).
>>>  Thanks for pointing it out.
>>>
>>> Is there any way to convince the selection box (or its developers) to
>>> include the version information that is already available?
>> The selection box is adamant that it will only display one thing.
>>
>> The developers would like to have a grid display component, and then would
>> be happy to display more information about each package, but are unlikely to
>> write one, due to competing priorities.  If you wanted to contribute one...
>>
>> Duncan Murdoch
>>
>>>        Kevin
>>>
>>>
>>> Duncan Murdoch wrote:
>>>> On 12/15/2008 10:31 AM, Kevin R. Coombes wrote:
>>>>> Hi,
>>>>>
>>>>> Terry Therneau's question about package development reminded me of a
>>>>> different issue. I maintain several packages along with a repository for
>>>>> them at "http://bioinformatics.mdanderson.org/OOMPA/". Several people are
>>>>> working on adding features or testing the packages. So, I often want to have
>>>>> both the latest official release and the currently testable build of the
>>>>> package available in the repository. I tried putting both versions in the
>>>>> same repository, but this leads to a problem for some of the testers, who
>>>>> are not familiar with the intricacies of building packages. (Thus, I cannot
>>>>> just tell them to get the source tarball and compile it; they will have no
>>>>> clue as to what I am talking about. And their Windows machines will not have
>>>>> the required tools installed in any event.)
>>>>>
>>>>> The underlying problem is that when you run the command
>>>>>  >  install.packages(repos="http://bioinformatics.mdanderson.org/OOMPA")
>>>>> inside the R Windows GUI, the selection box that appears only lists the
>>>>> name of the package, _not_ the version number. Thus, the testers cannot tell
>>>>> which of two packages with the same name should be installed.
>>>>>
>>>>> Is there any way around this problem other than to maintain two
>>>>> different repositories?
>>>> available.packages() reports version numbers, e.g.
>>>>
>>>>
>>>>
>>>> available.packages(contrib.url("http://bioinformatics.mdanderson.org/OOMPA"))
>>>>
>>>> You'll need to write a user interface to make use of this.
>>>>
>>>> Duncan Murdoch
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>


From rgentlem at fhcrc.org  Mon Dec 15 20:35:38 2008
From: rgentlem at fhcrc.org (Robert Gentleman)
Date: Mon, 15 Dec 2008 11:35:38 -0800
Subject: [Rd] install.packages and dependency version checking
In-Reply-To: <alpine.LFD.2.00.0812131539020.15227@gannet.stats.ox.ac.uk>
References: <alpine.LFD.2.00.0812131539020.15227@gannet.stats.ox.ac.uk>
Message-ID: <4946B18A.1000303@fhcrc.org>

Hi,

Prof Brian Ripley wrote:
> I've started to implement checks for package versions on dependencies in
> install.packages().  However, this is revealing a number of
> problems/misconceptions.
> 
> 
> (A) We do not check versions when loading namespaces, ahd the namespace
> registry does not contain version information.  So that for example
> (rtracklayer)
> 
> Depends: R (>= 2.7.0), Biobase, methods, RCurl
> Imports: XML (>= 1.98-0), IRanges, Biostrings
> 
> will never check the version of namespace XML that is loaded, either
> already loaded or resulting from loading this package's namespace.  For
> this to be operational we would need to extend the syntax of the
> imports() and importsFrom() directive in a NAMESPACE file to allow
> version restrictions. I am not sure this is worth doing, as an
> alternative is to put the imported package in Depends.
> 
> The version dependence will in a future release cause an update of XML
> when rtracklayer is installed, if needed (and available).
> 
> 

      I think we need to have this functionality in both Imports and Depends,
  see my response to another point for why.

> (B) Things like (package stam)
> 
> Depends: R (>= 2.7.0), GO.db (>= 2.1.3), Biobase (>= 1.99.5), pamr (>=
>         1.37.0), cluster (>= 1.11.10), annaffy (>= 1.11.5), methods (>=
>         2.7.0), utils (>= 2.7.0)
> 
> are redundant: the versions of method and utils are always the same as
> that of R.
> 
> And there is no point in having a package in both Depends: and Imports:,
> as Biostrings has.

  I don't think that is true.  There are cases where both Imports and Depends
are reasonable.  The purpose of importing is to ensure correct resolution of
symbols in the internal functions of a package. I would do that in almost all
cases.  In some instances I want users to see functionality from another package
- and I can then either a) (re)export those functions, or if there are lots of
them, then b) just put the package also in Depends.  Now, a) is a bit less
useful than it could be since R CMD check gets annoyed about these re-exported
functions (I don't think it should care, the man page exists and is findable).

> 
> 
> (C) There is no check on the version of a package suggested by
> Suggests:, unless the package itself provides one (and I found no
> instances).

  It may be worthwhile, but this is a less frequent use case and I would
prioritize it lower than having that functionality in Imports.

> 
> 
> (D) We can really only handle >= dependencies on package versions (but
> then I can see no other ops in use).  install.packages() will find the
> latest version available on the repositories, and we possibly need to
> check version requirements on the same dependency many times.  Given
> that BioC has a penchant for having version dependencies on unavailable
> versions (e.g. last week on IRanges (>= 1.1.7) with 1.1.4 available), we
> may be able to satisfy the requirements of some packages and not others.
> (In that case the strategy used is to install the latest available
> version if the one installed does not suffice for those we can satisfy,
> and report the problem(s).)
> 

  I suspect one needs = (basically as Gabor pointed out, some packages have issues).

> 
> (E) One of the arguments that has been used to do this version checking
> at install time is to avoid installing packages that cannot work. It
> would be possible to extend the approach to do so, but I am going to
> leave that to those who advocated it.
> 
> 
> The net effect of the current changes will be that if there is a
> dependence that is already installed but a later version is available
> and will help satisfy a >= dependence, it will be added to the list of
> packages to be installed.  As we have seen with Matrix this last week,
> that can have downsides in stopping previously functional packages working.
> 
> This is work in progress: there is no way to write a test suite that
> will encapsulate all the possible scenarios so weneed to get experience
> until 2.9.0 is released.  Please report any quirks to R-devel if they
> are completely reproducible (and preferably with the code change needed
> to fix them, since the chance of anyone else being able to reproduce
> them are fairly slim).
> 
  thanks
    Robert

-- 
Robert Gentleman, PhD
Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M2-B876
PO Box 19024
Seattle, Washington 98109-1024
206-667-7700
rgentlem at fhcrc.org


From wdunlap at tibco.com  Mon Dec 15 21:29:33 2008
From: wdunlap at tibco.com (William Dunlap)
Date: Mon, 15 Dec 2008 12:29:33 -0800
Subject: [Rd] bug in R CMD INSTALL do_install under OS X
In-Reply-To: <376b783d0812150204h551df587t51ab032a4f980a72@mail.gmail.com>
References: <376b783d0812150204h551df587t51ab032a4f980a72@mail.gmail.com>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D70053609B@NA-PA-VBE03.na.tibco.com>

This problem could be caused by having CDPATH set.  E.g.,

   % env CDPATH=. ~/R-svn/r-devel/R/bin/R CMD INSTALL -l Rlib
testCMacros
   /homes/bill/packages/Rlib
   /homes/bill/R-svn/r-devel/R/bin/INSTALL: line 948: cd:
/homes/bill/packages/testCMacros
   /a/seafiler01.na.tibco.com/vol/vol2/users/bill/packages/testCMacros:
No such file or directory
   /bin/sed: can't read DESCRIPTION: No such file or directory
   ERROR: no 'Package' field in 'DESCRIPTION'
   /bin/sed: read error on /homes/bill/packages/testCMacros: Is a
directory
(It works fine if I set 'CDPATH='.)

The happens because, from 'man cd' in
http://www.linuxhowtos.org/manpages/1p/cd.htm:

   If a non-empty directory name from CDPATH is used, or if
   cd - is used, an absolute pathname of the new working
   directory shall be written to the standard output as follows:
    "%s\n", <new directory>
   Otherwise, there shall be no output.

and INSTALL uses the idiom
    `cd ${dir} && /bin/pwd`
to convert the directory name dir to a full path.   

libtools explicitly unsets CDPATH, presumably to avoid this
sort of problem.  All the R scripts should do so.

Bill Dunlap
TIBCO Software Inc - Spotfire Division
wdunlap tibco.com  

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of David Rossell
> Sent: Monday, December 15, 2008 2:05 AM
> To: r-devel at r-project.org
> Subject: [Rd] bug in R CMD INSTALL do_install under OS X
> 
> Hi, I believe I've encountered a bug in the do_install function in the
> script used by R CMD INSTALL. I'm using R 2.8.0 under OS X 
> 10.5.5. I was
> trying to install a package from source (the package gaga 
> which I maintain,
> which I checked and builds correctly for R 2.8.0) when I get the error
> message
> 
> * Installing to library '/Users/drossell/Desktop/R-2.8.0/library'
> /Users/drossell/Desktop/R-2.8.0/bin/INSTALL: line 950: cd:
> /Volumes/biostats/projects/routines/R/gaga
> /Volumes/biostats/projects/routines/R/gaga: No such file or directory
> sed: DESCRIPTION: No such file or directory
> ERROR: no 'Package' field in 'DESCRIPTION'
> 
> I get this same error for any other package that I try to install.
> 
> Upon debugging the script, I've found that the script is 
> trying to cd to
> "/Volumes/biostats/projects/routines/R/gaga\n/Volumes/biostats
/projects/routines/R/gaga".
> That is, the directory is repeated twice, which causes the 
> installation to
> fail. To temporarily fix the bug I commented out the 1st two 
> lines in the
> do_install function and manually specified the directory. 
> After doing this
> the package installs just fine.
> 
> #  cd "${1}"
> #  pkg_dir="${1}"
>   cd "/Volumes/biostats/projects/routines/R/gaga"   #line added
>   pkg_dir="/Volumes/biostats/projects/routines/R/gaga" #line added
> 
> Thanks,
> 
> David
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From wdunlap at tibco.com  Mon Dec 15 22:14:05 2008
From: wdunlap at tibco.com (William Dunlap)
Date: Mon, 15 Dec 2008 13:14:05 -0800
Subject: [Rd] bug in R CMD INSTALL do_install under OS X
In-Reply-To: <77EB52C6DD32BA4D87471DCD70C8D70053609B@NA-PA-VBE03.na.tibco.com>
References: <376b783d0812150204h551df587t51ab032a4f980a72@mail.gmail.com>
	<77EB52C6DD32BA4D87471DCD70C8D70053609B@NA-PA-VBE03.na.tibco.com>
Message-ID: <77EB52C6DD32BA4D87471DCD70C8D7005360B9@NA-PA-VBE03.na.tibco.com>


Note that this is identical to Problem #8363, marked as 'not-
reproducible'.
   Date: Fri, 02 Dec 2005 17:41:32 +0100
   From: Philip Lijnzaad <p.lijnzaad at med.uu.nl>
   Subject: R CMD INSTALL fails if cd prints stuff to stdout ...
   To: r-bugs at r-project.org

A possible patch would be
   Index: src/scripts/INSTALL.in
   ===================================================================
   --- src/scripts/INSTALL.in      (revision 47210)
   +++ src/scripts/INSTALL.in      (working copy)
   @@ -78,6 +78,7 @@
    warning () { echo "WARNING: $*" >&2 ; }
    error ()   { echo "ERROR: $*" >&2 ; }
   
   +unset CDPATH  
    startdir=`${GETWD}`
    : ${TMPDIR=/tmp}
    { tmpdir=`(mktemp -d -q "${TMPDIR}/R.INSTALL.XXXXXX") 2>/dev/null` \

although one might prefer to put that line into CMD so no script could
have CDPATH set.  I cannot imagine why a script would want to cd
to work in this nonstandard way.

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of William Dunlap
> Sent: Monday, December 15, 2008 12:30 PM
> To: David Rossell; r-devel at r-project.org
> Subject: Re: [Rd] bug in R CMD INSTALL do_install under OS X
> 
> This problem could be caused by having CDPATH set.  E.g.,
> 
>    % env CDPATH=. ~/R-svn/r-devel/R/bin/R CMD INSTALL -l Rlib
> testCMacros
>    /homes/bill/packages/Rlib
>    /homes/bill/R-svn/r-devel/R/bin/INSTALL: line 948: cd:
> /homes/bill/packages/testCMacros
>    
> /a/seafiler01.na.tibco.com/vol/vol2/users/bill/packages/testCMacros:
> No such file or directory
>    /bin/sed: can't read DESCRIPTION: No such file or directory
>    ERROR: no 'Package' field in 'DESCRIPTION'
>    /bin/sed: read error on /homes/bill/packages/testCMacros: Is a
> directory
> (It works fine if I set 'CDPATH='.)
> 
> The happens because, from 'man cd' in
> http://www.linuxhowtos.org/manpages/1p/cd.htm:
> 
>    If a non-empty directory name from CDPATH is used, or if
>    cd - is used, an absolute pathname of the new working
>    directory shall be written to the standard output as follows:
>     "%s\n", <new directory>
>    Otherwise, there shall be no output.
> 
> and INSTALL uses the idiom
>     `cd ${dir} && /bin/pwd`
> to convert the directory name dir to a full path.   
> 
> libtools explicitly unsets CDPATH, presumably to avoid this
> sort of problem.  All the R scripts should do so.
> 
> Bill Dunlap
> TIBCO Software Inc - Spotfire Division
> wdunlap tibco.com  
> 
> > -----Original Message-----
> > From: r-devel-bounces at r-project.org 
> > [mailto:r-devel-bounces at r-project.org] On Behalf Of David Rossell
> > Sent: Monday, December 15, 2008 2:05 AM
> > To: r-devel at r-project.org
> > Subject: [Rd] bug in R CMD INSTALL do_install under OS X
> > 
> > Hi, I believe I've encountered a bug in the do_install 
> function in the
> > script used by R CMD INSTALL. I'm using R 2.8.0 under OS X 
> > 10.5.5. I was
> > trying to install a package from source (the package gaga 
> > which I maintain,
> > which I checked and builds correctly for R 2.8.0) when I 
> get the error
> > message
> > 
> > * Installing to library '/Users/drossell/Desktop/R-2.8.0/library'
> > /Users/drossell/Desktop/R-2.8.0/bin/INSTALL: line 950: cd:
> > /Volumes/biostats/projects/routines/R/gaga
> > /Volumes/biostats/projects/routines/R/gaga: No such file or 
> directory
> > sed: DESCRIPTION: No such file or directory
> > ERROR: no 'Package' field in 'DESCRIPTION'
> > 
> > I get this same error for any other package that I try to install.
> > 
> > Upon debugging the script, I've found that the script is 
> > trying to cd to
> > "/Volumes/biostats/projects/routines/R/gaga\n/Volumes/biostats
> /projects/routines/R/gaga".
> > That is, the directory is repeated twice, which causes the 
> > installation to
> > fail. To temporarily fix the bug I commented out the 1st two 
> > lines in the
> > do_install function and manually specified the directory. 
> > After doing this
> > the package installs just fine.
> > 
> > #  cd "${1}"
> > #  pkg_dir="${1}"
> >   cd "/Volumes/biostats/projects/routines/R/gaga"   #line added
> >   pkg_dir="/Volumes/biostats/projects/routines/R/gaga" #line added
> > 
> > Thanks,
> > 
> > David
> > 
> > 	[[alternative HTML version deleted]]
> > 
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> > 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From david.rossell at irbbarcelona.org  Tue Dec 16 10:14:39 2008
From: david.rossell at irbbarcelona.org (David Rossell)
Date: Tue, 16 Dec 2008 10:14:39 +0100
Subject: [Rd] bug in R CMD INSTALL do_install under OS X
In-Reply-To: <77EB52C6DD32BA4D87471DCD70C8D70053609B@NA-PA-VBE03.na.tibco.com>
References: <376b783d0812150204h551df587t51ab032a4f980a72@mail.gmail.com>
	<77EB52C6DD32BA4D87471DCD70C8D70053609B@NA-PA-VBE03.na.tibco.com>
Message-ID: <a1ba17ba0812160114g700dc8f6n73c25e7ce86cb79f@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081216/4012cb65/attachment.pl>

From spencer.graves at pdf.com  Tue Dec 16 16:55:08 2008
From: spencer.graves at pdf.com (Spencer Graves)
Date: Tue, 16 Dec 2008 07:55:08 -0800
Subject: [Rd] "could not find function" error in "R CMD check"
Message-ID: <4947CF5C.7090702@pdf.com>

Hi, All: 

      What might cause "R CMD check" to report, "could not find 
function" for a function that has long been in the 'fda' package? 

      Both Jim Ramsay in Ottawa, Canada, and I in San Jose, CA, get this 
same error.  I replicated it with a fresh, anonymous checkout from 
R-Forge (svn checkout svn://svn.r-forge.r-project.org/svnroot/fda).  
With this, I did "R CMD build pkg", then "R CMD check fda_2.1.0.tar.gz", 
with the following result: 


D:\spencerg\statmtds\splines\fda\tmp\fda>R CMD check fda_2.1.0.tar.gz
* checking for working pdflatex ... OK
* using log directory 'D:/spencerg/statmtds/splines/fda/tmp/fda/fda.Rcheck'
* using R version 2.8.0 (2008-10-20)
* using session charset: ISO8859-1
* checking for file 'fda/DESCRIPTION' ... OK
* this is package 'fda' version '2.1.0'
* checking package name space information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking for .dll and .exe files ... OK
* checking whether package 'fda' can be installed ... ERROR
Installation failed.
See 'D:/spencerg/statmtds/splines/fda/tmp/fda/fda.Rcheck/00install.out' 
for deta
ils.

     
####################################
      "00install.out" is as follows: 

####################################

installing R.css in D:/spencerg/statmtds/splines/fda/tmp/fda/fda.Rcheck


---------- Making package fda ------------
  adding build stamp to DESCRIPTION
  installing NAMESPACE file and metadata
  installing R files
  installing demos
  installing inst files
  installing data files
  preparing package fda for lazy loading
Loading required package: splines
Loading required package: zoo

Attaching package: 'zoo'


    The following object(s) are masked from package:base :

     as.Date.numeric

Error in basisfd(type = type, rangeval = rangeval, nbasis = nbasis, 
params = params,  :
  could not find function "use.proper.basis"
Error: unable to load R code in package 'fda'
Execution halted
make[2]: *** [lazyload] Error 1
make[1]: *** [all] Error 2
make: *** [pkg-fda] Error 2
*** Installation of fda failed ***

Removing 'D:/spencerg/statmtds/splines/fda/tmp/fda/fda.Rcheck/fda'


####################################

      Both "basisfd" and "use.proper.basis" have been in the "fda" 
package for years and have passed "R CMD check" many times.  I'm running 
Windows XP Pro and Jim is running Vista. 

      Any suggestions? 
      Thanks,
      Spencer Graves
   

 sessionInfo()
R version 2.8.0 (2008-10-20)
i386-pc-mingw32

locale:
LC_COLLATE=English_United States.1252;LC_CTYPE=English_United 
States.1252;LC_MONETARY=English_United 
States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base    
 >


From murdoch at stats.uwo.ca  Tue Dec 16 17:09:39 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 16 Dec 2008 11:09:39 -0500
Subject: [Rd] "could not find function" error in "R CMD check"
In-Reply-To: <4947CF5C.7090702@pdf.com>
References: <4947CF5C.7090702@pdf.com>
Message-ID: <4947D2C3.7090305@stats.uwo.ca>

On 16/12/2008 10:55 AM, Spencer Graves wrote:
> Hi, All: 
> 
>       What might cause "R CMD check" to report, "could not find 
> function" for a function that has long been in the 'fda' package? 

I would guess that you are calling it from within your *.R files.  It's 
called from a lot of places, so I couldn't spot the one that's causing 
the trouble, but something like this could do it:

f <- function() { }  # Function is done, by mistake

   basisfd()          # This is a top level call, not within f

}                    # Not sure why the parser wouldn't see this
                      # so this guess may be wrong

In general, you can call functions from within the *.R files, but you 
have to be careful to make sure they are already defined (and you 
shouldn't count on any side effects from them.

Duncan Murdoch

> 
>       Both Jim Ramsay in Ottawa, Canada, and I in San Jose, CA, get this 
> same error.  I replicated it with a fresh, anonymous checkout from 
> R-Forge (svn checkout svn://svn.r-forge.r-project.org/svnroot/fda).  
> With this, I did "R CMD build pkg", then "R CMD check fda_2.1.0.tar.gz", 
> with the following result: 
> 
> 
> D:\spencerg\statmtds\splines\fda\tmp\fda>R CMD check fda_2.1.0.tar.gz
> * checking for working pdflatex ... OK
> * using log directory 'D:/spencerg/statmtds/splines/fda/tmp/fda/fda.Rcheck'
> * using R version 2.8.0 (2008-10-20)
> * using session charset: ISO8859-1
> * checking for file 'fda/DESCRIPTION' ... OK
> * this is package 'fda' version '2.1.0'
> * checking package name space information ... OK
> * checking package dependencies ... OK
> * checking if this is a source package ... OK
> * checking for .dll and .exe files ... OK
> * checking whether package 'fda' can be installed ... ERROR
> Installation failed.
> See 'D:/spencerg/statmtds/splines/fda/tmp/fda/fda.Rcheck/00install.out' 
> for deta
> ils.
> 
>      
> ####################################
>       "00install.out" is as follows: 
> 
> ####################################
> 
> installing R.css in D:/spencerg/statmtds/splines/fda/tmp/fda/fda.Rcheck
> 
> 
> ---------- Making package fda ------------
>   adding build stamp to DESCRIPTION
>   installing NAMESPACE file and metadata
>   installing R files
>   installing demos
>   installing inst files
>   installing data files
>   preparing package fda for lazy loading
> Loading required package: splines
> Loading required package: zoo
> 
> Attaching package: 'zoo'
> 
> 
>     The following object(s) are masked from package:base :
> 
>      as.Date.numeric
> 
> Error in basisfd(type = type, rangeval = rangeval, nbasis = nbasis, 
> params = params,  :
>   could not find function "use.proper.basis"
> Error: unable to load R code in package 'fda'
> Execution halted
> make[2]: *** [lazyload] Error 1
> make[1]: *** [all] Error 2
> make: *** [pkg-fda] Error 2
> *** Installation of fda failed ***
> 
> Removing 'D:/spencerg/statmtds/splines/fda/tmp/fda/fda.Rcheck/fda'
> 
> 
> ####################################
> 
>       Both "basisfd" and "use.proper.basis" have been in the "fda" 
> package for years and have passed "R CMD check" many times.  I'm running 
> Windows XP Pro and Jim is running Vista. 
> 
>       Any suggestions? 
>       Thanks,
>       Spencer Graves
>    
> 
>  sessionInfo()
> R version 2.8.0 (2008-10-20)
> i386-pc-mingw32
> 
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United 
> States.1252;LC_MONETARY=English_United 
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base    
>  >
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch at stats.uwo.ca  Tue Dec 16 17:15:27 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Tue, 16 Dec 2008 11:15:27 -0500
Subject: [Rd] "could not find function" error in "R CMD check"
In-Reply-To: <4947CF5C.7090702@pdf.com>
References: <4947CF5C.7090702@pdf.com>
Message-ID: <4947D41F.9040409@stats.uwo.ca>

Using Martin's sourceDir() function (from example(source)), I found your 
problem:  You have some test code in your R dir.

smooth.bibasis.test.R :Error in basisfd(type = type, rangeval = 
rangeval, nbasis = nbasis, params = params,  :
   could not find function "use.proper.basis"

That file smooth.bibasis.test.R probably belongs in the tests directory, 
where it will be run after all the files have been sourced.

Duncan Murdoch


From spencer.graves at pdf.com  Tue Dec 16 18:00:24 2008
From: spencer.graves at pdf.com (Spencer Graves)
Date: Tue, 16 Dec 2008 09:00:24 -0800
Subject: [Rd] "could not find function" error in "R CMD check"
In-Reply-To: <4947D41F.9040409@stats.uwo.ca>
References: <4947CF5C.7090702@pdf.com> <4947D41F.9040409@stats.uwo.ca>
Message-ID: <4947DEA8.9050101@pdf.com>

Hi, Duncan: 

      Thanks very much.  That fixed that problem. 

      I should have tried that myself;  I've heard essentially that 
suggestion before, but couldn't think of it in this case. 

      Best Wishes,
      Spencer Graves

Duncan Murdoch wrote:
> Using Martin's sourceDir() function (from example(source)), I found 
> your problem:  You have some test code in your R dir.
>
> smooth.bibasis.test.R :Error in basisfd(type = type, rangeval = 
> rangeval, nbasis = nbasis, params = params,  :
>   could not find function "use.proper.basis"
>
> That file smooth.bibasis.test.R probably belongs in the tests 
> directory, where it will be run after all the files have been sourced.
>
> Duncan Murdoch
>


From Kurt.Hornik at wu-wien.ac.at  Wed Dec 17 18:50:24 2008
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Wed, 17 Dec 2008 18:50:24 +0100
Subject: [Rd] install.packages and dependency version checking
In-Reply-To: <4946B18A.1000303@fhcrc.org>
References: <alpine.LFD.2.00.0812131539020.15227@gannet.stats.ox.ac.uk>
	<4946B18A.1000303@fhcrc.org>
Message-ID: <18761.15328.487940.480464@fangorn.hornik.net>

>>>>> Robert Gentleman writes:

> Hi,

Two quick (late) comments:

> Prof Brian Ripley wrote:
>> I've started to implement checks for package versions on dependencies in
>> install.packages().  However, this is revealing a number of
>> problems/misconceptions.
>> 
>> 
>> (A) We do not check versions when loading namespaces, ahd the namespace
>> registry does not contain version information.  So that for example
>> (rtracklayer)
>> 
>> Depends: R (>= 2.7.0), Biobase, methods, RCurl
>> Imports: XML (>= 1.98-0), IRanges, Biostrings
>> 
>> will never check the version of namespace XML that is loaded, either
>> already loaded or resulting from loading this package's namespace.  For
>> this to be operational we would need to extend the syntax of the
>> imports() and importsFrom() directive in a NAMESPACE file to allow
>> version restrictions. I am not sure this is worth doing, as an
>> alternative is to put the imported package in Depends.
>> 
>> The version dependence will in a future release cause an update of XML
>> when rtracklayer is installed, if needed (and available).
>> 
>> 

>       I think we need to have this functionality in both Imports and Depends,
>   see my response to another point for why.

>> (B) Things like (package stam)
>> 
>> Depends: R (>= 2.7.0), GO.db (>= 2.1.3), Biobase (>= 1.99.5), pamr (>=
>> 1.37.0), cluster (>= 1.11.10), annaffy (>= 1.11.5), methods (>=
>> 2.7.0), utils (>= 2.7.0)
>> 
>> are redundant: the versions of method and utils are always the same as
>> that of R.
>> 
>> And there is no point in having a package in both Depends: and Imports:,
>> as Biostrings has.

>   I don't think that is true.  There are cases where both Imports and Depends
> are reasonable.  The purpose of importing is to ensure correct resolution of
> symbols in the internal functions of a package. I would do that in almost all
> cases.  In some instances I want users to see functionality from another package
> - and I can then either a) (re)export those functions, or if there are lots of
> them, then b) just put the package also in Depends.  Now, a) is a bit less
> useful than it could be since R CMD check gets annoyed about these re-exported
> functions (I don't think it should care, the man page exists and is findable).

>> 
>> 
>> (C) There is no check on the version of a package suggested by
>> Suggests:, unless the package itself provides one (and I found no
>> instances).

>   It may be worthwhile, but this is a less frequent use case and I
> would prioritize it lower than having that functionality in Imports.

I think it would be good to have this too, because (see below) often
Suggests are used for "conditional Depends".

>> 
>> 
>> (D) We can really only handle >= dependencies on package versions (but
>> then I can see no other ops in use).  install.packages() will find the
>> latest version available on the repositories, and we possibly need to
>> check version requirements on the same dependency many times.  Given
>> that BioC has a penchant for having version dependencies on unavailable
>> versions (e.g. last week on IRanges (>= 1.1.7) with 1.1.4 available), we
>> may be able to satisfy the requirements of some packages and not others.
>> (In that case the strategy used is to install the latest available
>> version if the one installed does not suffice for those we can satisfy,
>> and report the problem(s).)
>> 

>   I suspect one needs = (basically as Gabor pointed out, some packages
>   have issues).

It would be good to support all comparison ops, I think (including !=).

Not something to be doable right away, but it would be very good to
allow for alternatives in dependency specs so that one can say things
like

    Depends: foo | bar

indicating that one needs foo or bar, and most likely that if neither is
there installing the first one should be attempted.

Best
-k


>> 
>> (E) One of the arguments that has been used to do this version checking
>> at install time is to avoid installing packages that cannot work. It
>> would be possible to extend the approach to do so, but I am going to
>> leave that to those who advocated it.
>> 
>> 
>> The net effect of the current changes will be that if there is a
>> dependence that is already installed but a later version is available
>> and will help satisfy a >= dependence, it will be added to the list of
>> packages to be installed.  As we have seen with Matrix this last week,
>> that can have downsides in stopping previously functional packages working.
>> 
>> This is work in progress: there is no way to write a test suite that
>> will encapsulate all the possible scenarios so weneed to get experience
>> until 2.9.0 is released.  Please report any quirks to R-devel if they
>> are completely reproducible (and preferably with the code change needed
>> to fix them, since the chance of anyone else being able to reproduce
>> them are fairly slim).
>> 
>   thanks
>     Robert

> -- 
> Robert Gentleman, PhD
> Program in Computational Biology
> Division of Public Health Sciences
> Fred Hutchinson Cancer Research Center
> 1100 Fairview Ave. N, M2-B876
> PO Box 19024
> Seattle, Washington 98109-1024
> 206-667-7700
> rgentlem at fhcrc.org

> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From p.dalgaard at biostat.ku.dk  Thu Dec 18 02:56:25 2008
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 18 Dec 2008 02:56:25 +0100
Subject: [Rd] [R] "Error: bad value" problem
In-Reply-To: <21065458.post@talk.nabble.com>
References: <20081217223408.F3D214CA07@egon.stats.ucl.ac.uk>	<D667981B-6F7E-4242-AC9D-50FD2AC3EAD8@auckland.ac.nz>	<4949949F.7080101@biostat.ku.dk>
	<49499C78.9020700@biostat.ku.dk> <21065458.post@talk.nabble.com>
Message-ID: <4949ADC9.40409@biostat.ku.dk>

Ben Bolker wrote:
> 
>   I can get the errors to happen on Ubuntu 8.10 with R --vanilla (*without*
> valgrind) -- but
> editing momfit.r line 742 so that plot.progress=FALSE seems to make the
> problem go away.  (This was a lucky guess, it looked like there was
> something
> odd going on with the plots.)
> 
>   Hope that helps someone ...

Probably not. The problem is to reproduce the error state in a way so 
that we can understand what is causing it.

I can debug this to
(gdb) bt
#0  Rf_error (format=0x8220c65 "bad value") at 
../../../R/src/main/errors.c:704
#1  0x0805a924 in SETCDR (x=0x8f89348, y=0x9b276e8)
     at ../../../R/src/main/memory.c:2728
#2  0x0819fa46 in GrowList (l=0x951e8f4, s=<value optimized out>) at 
gram.y:958
#3  0x081a2a7b in xxvalue (v=0x8f89348, k=4, lloc=<value optimized out>)
     at gram.y:440

and the problem in GrowList is that CAR(l) is R_NilValue (==0x8f89348), 
which supposedly "cannot happen", and the thing that calls GrowList is 
something with srcrefs (DuncanM?).

Digging deeper probably has to wait till the weekend for my part. (The 
natural next step is figuring out how the R_NilValue got into that 
location, but I should try to sleep off this cold....)

I'm CCing r-devel on this. Can we move the discussion there?



> 
>   Ben Bolker
> 
>> sessionInfo()
> R version 2.8.0 (2008-10-20) 
> i486-pc-linux-gnu 
> 
> locale:
> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base    


-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From murdoch at stats.uwo.ca  Thu Dec 18 03:47:39 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 17 Dec 2008 21:47:39 -0500
Subject: [Rd] [R] "Error: bad value" problem
In-Reply-To: <4949ADC9.40409@biostat.ku.dk>
References: <20081217223408.F3D214CA07@egon.stats.ucl.ac.uk>	<D667981B-6F7E-4242-AC9D-50FD2AC3EAD8@auckland.ac.nz>	<4949949F.7080101@biostat.ku.dk>	<49499C78.9020700@biostat.ku.dk>
	<21065458.post@talk.nabble.com> <4949ADC9.40409@biostat.ku.dk>
Message-ID: <4949B9CB.1000308@stats.uwo.ca>

On 17/12/2008 8:56 PM, Peter Dalgaard wrote:
> Ben Bolker wrote:
>>   I can get the errors to happen on Ubuntu 8.10 with R --vanilla (*without*
>> valgrind) -- but
>> editing momfit.r line 742 so that plot.progress=FALSE seems to make the
>> problem go away.  (This was a lucky guess, it looked like there was
>> something
>> odd going on with the plots.)
>>
>>   Hope that helps someone ...
> 
> Probably not. The problem is to reproduce the error state in a way so 
> that we can understand what is causing it.
> 
> I can debug this to
> (gdb) bt
> #0  Rf_error (format=0x8220c65 "bad value") at 
> ../../../R/src/main/errors.c:704
> #1  0x0805a924 in SETCDR (x=0x8f89348, y=0x9b276e8)
>      at ../../../R/src/main/memory.c:2728
> #2  0x0819fa46 in GrowList (l=0x951e8f4, s=<value optimized out>) at 
> gram.y:958
> #3  0x081a2a7b in xxvalue (v=0x8f89348, k=4, lloc=<value optimized out>)
>      at gram.y:440
> 
> and the problem in GrowList is that CAR(l) is R_NilValue (==0x8f89348), 
> which supposedly "cannot happen", and the thing that calls GrowList is 
> something with srcrefs (DuncanM?).
> 
> Digging deeper probably has to wait till the weekend for my part. (The 
> natural next step is figuring out how the R_NilValue got into that 
> location, but I should try to sleep off this cold....)
> 
> I'm CCing r-devel on this. Can we move the discussion there?

I can probably take a look tomorrow.  I wasn't getting an error, but 
maybe I'll see the same corruption if I watch it run.

Duncan Murdoch

> 
> 
> 
>>   Ben Bolker
>>
>>> sessionInfo()
>> R version 2.8.0 (2008-10-20) 
>> i486-pc-linux-gnu 
>>
>> locale:
>> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base    
> 
>


From murdoch at stats.uwo.ca  Thu Dec 18 04:07:04 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Wed, 17 Dec 2008 22:07:04 -0500
Subject: [Rd] [R] "Error: bad value" problem
In-Reply-To: <4949B9CB.1000308@stats.uwo.ca>
References: <20081217223408.F3D214CA07@egon.stats.ucl.ac.uk>	<D667981B-6F7E-4242-AC9D-50FD2AC3EAD8@auckland.ac.nz>	<4949949F.7080101@biostat.ku.dk>	<49499C78.9020700@biostat.ku.dk>	<21065458.post@talk.nabble.com>
	<4949ADC9.40409@biostat.ku.dk> <4949B9CB.1000308@stats.uwo.ca>
Message-ID: <4949BE58.2020805@stats.uwo.ca>

On 17/12/2008 9:47 PM, Duncan Murdoch wrote:
> On 17/12/2008 8:56 PM, Peter Dalgaard wrote:
>> Ben Bolker wrote:
>>>   I can get the errors to happen on Ubuntu 8.10 with R --vanilla (*without*
>>> valgrind) -- but
>>> editing momfit.r line 742 so that plot.progress=FALSE seems to make the
>>> problem go away.  (This was a lucky guess, it looked like there was
>>> something
>>> odd going on with the plots.)
>>>
>>>   Hope that helps someone ...
>> Probably not. The problem is to reproduce the error state in a way so 
>> that we can understand what is causing it.
>>
>> I can debug this to
>> (gdb) bt
>> #0  Rf_error (format=0x8220c65 "bad value") at 
>> ../../../R/src/main/errors.c:704
>> #1  0x0805a924 in SETCDR (x=0x8f89348, y=0x9b276e8)
>>      at ../../../R/src/main/memory.c:2728
>> #2  0x0819fa46 in GrowList (l=0x951e8f4, s=<value optimized out>) at 
>> gram.y:958
>> #3  0x081a2a7b in xxvalue (v=0x8f89348, k=4, lloc=<value optimized out>)
>>      at gram.y:440
>>
>> and the problem in GrowList is that CAR(l) is R_NilValue (==0x8f89348), 
>> which supposedly "cannot happen", and the thing that calls GrowList is 
>> something with srcrefs (DuncanM?).
>>
>> Digging deeper probably has to wait till the weekend for my part. (The 
>> natural next step is figuring out how the R_NilValue got into that 
>> location, but I should try to sleep off this cold....)
>>
>> I'm CCing r-devel on this. Can we move the discussion there?
> 
> I can probably take a look tomorrow.  I wasn't getting an error, but 
> maybe I'll see the same corruption if I watch it run.

I had time to see if I was getting a NilValue there tonight, and the 
answer was no, with the Windows RC.  I don't get the error in any 
version I've tried on Windows, though I can see it in 2.8.0 on MacOSX.

Duncan
> 
> Duncan Murdoch
> 
>>
>>
>>>   Ben Bolker
>>>
>>>> sessionInfo()
>>> R version 2.8.0 (2008-10-20) 
>>> i486-pc-linux-gnu 
>>>
>>> locale:
>>> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base    
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From seanpor at acm.org  Thu Dec 18 06:57:35 2008
From: seanpor at acm.org (Sean O'Riordain)
Date: Thu, 18 Dec 2008 05:57:35 +0000
Subject: [Rd] minor typo in duplicated.Rd (lemgth != length)
Message-ID: <8ed68eed0812172157h1e75b8d9r5c77bb48580bbcf3@mail.gmail.com>

sean at sean7:~/R/RSVN/R/trunk/src/library$ svn diff
Index: base/man/duplicated.Rd
===================================================================
--- base/man/duplicated.Rd	(revision 47231)
+++ base/man/duplicated.Rd	(working copy)
@@ -64,7 +64,7 @@
   not be efficient for a very large set.
 }
 \value{
-  For a vector input, a logical vector of the same lemgth as
+  For a vector input, a logical vector of the same length as
   \code{x}.  For a data frame, a logical vector with one element for
   each row.  For a matrix or array, a logical array with the same
   dimensions and dimnames.


From plummer at iarc.fr  Thu Dec 18 08:59:53 2008
From: plummer at iarc.fr (Martyn Plummer)
Date: Thu, 18 Dec 2008 08:59:53 +0100
Subject: [Rd] [R]   "Error: bad value" problem
In-Reply-To: <4949BE58.2020805@stats.uwo.ca>
References: <20081217223408.F3D214CA07@egon.stats.ucl.ac.uk>
	<D667981B-6F7E-4242-AC9D-50FD2AC3EAD8@auckland.ac.nz>
	<4949949F.7080101@biostat.ku.dk>	<49499C78.9020700@biostat.ku.dk>
	<21065458.post@talk.nabble.com> <4949ADC9.40409@biostat.ku.dk>
	<4949B9CB.1000308@stats.uwo.ca>  <4949BE58.2020805@stats.uwo.ca>
Message-ID: <1229587193.2948.11.camel@localhost.localdomain>

This has all the hallmarks of a bug I found and fixed in R-devel
(r46998).  I did not port the patch over to the R release branch because
I could not reproduce the bug.

In R-devel, I was seeing problems with "make test-Segfault". This would
occasionally segfault, but most of the time would create the "bad value"
error, and of course would also run perfectly fine a lot of the time.
The error came from exactly the same place that Ben found.  It was due
to an invalid SrcRefs being used because SrcFile is not set to zero when
it should be.

I'll have a look and see if it is the same problem, or a close cousin.

Martyn


On Wed, 2008-12-17 at 22:07 -0500, Duncan Murdoch wrote:
> On 17/12/2008 9:47 PM, Duncan Murdoch wrote:
> > On 17/12/2008 8:56 PM, Peter Dalgaard wrote:
> >> Ben Bolker wrote:
> >>>   I can get the errors to happen on Ubuntu 8.10 with R --vanilla (*without*
> >>> valgrind) -- but
> >>> editing momfit.r line 742 so that plot.progress=FALSE seems to make the
> >>> problem go away.  (This was a lucky guess, it looked like there was
> >>> something
> >>> odd going on with the plots.)
> >>>
> >>>   Hope that helps someone ...
> >> Probably not. The problem is to reproduce the error state in a way so 
> >> that we can understand what is causing it.
> >>
> >> I can debug this to
> >> (gdb) bt
> >> #0  Rf_error (format=0x8220c65 "bad value") at 
> >> ../../../R/src/main/errors.c:704
> >> #1  0x0805a924 in SETCDR (x=0x8f89348, y=0x9b276e8)
> >>      at ../../../R/src/main/memory.c:2728
> >> #2  0x0819fa46 in GrowList (l=0x951e8f4, s=<value optimized out>) at 
> >> gram.y:958
> >> #3  0x081a2a7b in xxvalue (v=0x8f89348, k=4, lloc=<value optimized out>)
> >>      at gram.y:440
> >>
> >> and the problem in GrowList is that CAR(l) is R_NilValue (==0x8f89348), 
> >> which supposedly "cannot happen", and the thing that calls GrowList is 
> >> something with srcrefs (DuncanM?).
> >>
> >> Digging deeper probably has to wait till the weekend for my part. (The 
> >> natural next step is figuring out how the R_NilValue got into that 
> >> location, but I should try to sleep off this cold....)
> >>
> >> I'm CCing r-devel on this. Can we move the discussion there?
> > 
> > I can probably take a look tomorrow.  I wasn't getting an error, but 
> > maybe I'll see the same corruption if I watch it run.
> 
> I had time to see if I was getting a NilValue there tonight, and the 
> answer was no, with the Windows RC.  I don't get the error in any 
> version I've tried on Windows, though I can see it in 2.8.0 on MacOSX.
> 
> Duncan
> > 
> > Duncan Murdoch
> > 
> >>
> >>
> >>>   Ben Bolker
> >>>
> >>>> sessionInfo()
> >>> R version 2.8.0 (2008-10-20) 
> >>> i486-pc-linux-gnu 
> >>>
> >>> locale:
> >>> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
> >>>
> >>> attached base packages:
> >>> [1] stats     graphics  grDevices utils     datasets  methods   base    
> >>
> > 
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-help at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-help
> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> and provide commented, minimal, self-contained, reproducible code.

-----------------------------------------------------------------------
This message and its attachments are strictly confidenti...{{dropped:8}}


From b.h.mevik at usit.uio.no  Thu Dec 18 10:14:15 2008
From: b.h.mevik at usit.uio.no (=?iso-8859-1?Q?Bj=F8rn-Helge?= Mevik)
Date: Thu, 18 Dec 2008 10:14:15 +0100
Subject: [Rd] Tip for removing -c99 when compiling with icc
Message-ID: <s3socz926c8.fsf@slagelg.uio.no>

Dear developeRs,

As of icc 10, the -c99 option is deprecated, and generates a lot of
warnings when compiling R or R packages.

If you use CC="icc -std=c99" instead of just CC="icc", R's configure
will not add the -c99 option, and the code seems to compile and run just
fine.

(Please don't hesitate to let me know if this is a bad idea. :-)

-- 
Regards,
Bj?rn-Helge Mevik


From ripley at stats.ox.ac.uk  Thu Dec 18 10:52:14 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Thu, 18 Dec 2008 09:52:14 +0000 (GMT)
Subject: [Rd] Tip for removing -c99 when compiling with icc
In-Reply-To: <s3socz926c8.fsf@slagelg.uio.no>
References: <s3socz926c8.fsf@slagelg.uio.no>
Message-ID: <alpine.LFD.2.00.0812180939560.1422@gannet.stats.ox.ac.uk>

On Thu, 18 Dec 2008, Bj?rn-Helge Mevik wrote:

> Dear developeRs,
>
> As of icc 10, the -c99 option is deprecated, and generates a lot of
> warnings when compiling R or R packages.
>
> If you use CC="icc -std=c99" instead of just CC="icc", R's configure
> will not add the -c99 option, and the code seems to compile and run just
> fine.

It's not really R, but autoconf's macro (I believe called from AC_PROG_CC) 
which does

for ac_arg in '' -std=gnu99 -c99 -qlanglvl=extc99

One day autoconf will catch up with icc and try -std=c99 as well.  (It may 
already have done so: we are using the 3-year-old 2.61 as PD has that on 
the release system, Mac OS X still does ....)

> (Please don't hesitate to let me know if this is a bad idea. :-)

It is fine: I'll add a note to the manual.

>
> -- 
> Regards,
> Bj?rn-Helge Mevik
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

From p.dalgaard at biostat.ku.dk  Thu Dec 18 10:57:47 2008
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 18 Dec 2008 10:57:47 +0100
Subject: [Rd] [R]   "Error: bad value" problem
In-Reply-To: <1229587193.2948.11.camel@localhost.localdomain>
References: <20081217223408.F3D214CA07@egon.stats.ucl.ac.uk>	
	<D667981B-6F7E-4242-AC9D-50FD2AC3EAD8@auckland.ac.nz>	
	<4949949F.7080101@biostat.ku.dk>	<49499C78.9020700@biostat.ku.dk>	
	<21065458.post@talk.nabble.com> <4949ADC9.40409@biostat.ku.dk>	
	<4949B9CB.1000308@stats.uwo.ca> <4949BE58.2020805@stats.uwo.ca>
	<1229587193.2948.11.camel@localhost.localdomain>
Message-ID: <494A1E9B.8050509@biostat.ku.dk>

Martyn Plummer wrote:
> This has all the hallmarks of a bug I found and fixed in R-devel
> (r46998).  I did not port the patch over to the R release branch because
> I could not reproduce the bug.
> 
> In R-devel, I was seeing problems with "make test-Segfault". This would
> occasionally segfault, but most of the time would create the "bad value"
> error, and of course would also run perfectly fine a lot of the time.
> The error came from exactly the same place that Ben found.  It was due
> to an invalid SrcRefs being used because SrcFile is not set to zero when
> it should be.
> 
> I'll have a look and see if it is the same problem, or a close cousin.

Yes, this does appear to fix the issue. (Did you forget a NEWS file 
entry, though?)

It's a two-line change fixing a live bug, so it could go in 2.8.1 even 
in code freeze. The problem is that it is inside gram.y which will 
trigger some maintainer-mode activity, and did trip up my Fedora laptop 
slightly. Hmmmm....

	-p

> Martyn
> 
> 
> On Wed, 2008-12-17 at 22:07 -0500, Duncan Murdoch wrote:
>> On 17/12/2008 9:47 PM, Duncan Murdoch wrote:
>>> On 17/12/2008 8:56 PM, Peter Dalgaard wrote:
>>>> Ben Bolker wrote:
>>>>>   I can get the errors to happen on Ubuntu 8.10 with R --vanilla (*without*
>>>>> valgrind) -- but
>>>>> editing momfit.r line 742 so that plot.progress=FALSE seems to make the
>>>>> problem go away.  (This was a lucky guess, it looked like there was
>>>>> something
>>>>> odd going on with the plots.)
>>>>>
>>>>>   Hope that helps someone ...
>>>> Probably not. The problem is to reproduce the error state in a way so 
>>>> that we can understand what is causing it.
>>>>
>>>> I can debug this to
>>>> (gdb) bt
>>>> #0  Rf_error (format=0x8220c65 "bad value") at 
>>>> ../../../R/src/main/errors.c:704
>>>> #1  0x0805a924 in SETCDR (x=0x8f89348, y=0x9b276e8)
>>>>      at ../../../R/src/main/memory.c:2728
>>>> #2  0x0819fa46 in GrowList (l=0x951e8f4, s=<value optimized out>) at 
>>>> gram.y:958
>>>> #3  0x081a2a7b in xxvalue (v=0x8f89348, k=4, lloc=<value optimized out>)
>>>>      at gram.y:440
>>>>
>>>> and the problem in GrowList is that CAR(l) is R_NilValue (==0x8f89348), 
>>>> which supposedly "cannot happen", and the thing that calls GrowList is 
>>>> something with srcrefs (DuncanM?).
>>>>
>>>> Digging deeper probably has to wait till the weekend for my part. (The 
>>>> natural next step is figuring out how the R_NilValue got into that 
>>>> location, but I should try to sleep off this cold....)
>>>>
>>>> I'm CCing r-devel on this. Can we move the discussion there?
>>> I can probably take a look tomorrow.  I wasn't getting an error, but 
>>> maybe I'll see the same corruption if I watch it run.
>> I had time to see if I was getting a NilValue there tonight, and the 
>> answer was no, with the Windows RC.  I don't get the error in any 
>> version I've tried on Windows, though I can see it in 2.8.0 on MacOSX.
>>
>> Duncan
>>> Duncan Murdoch
>>>
>>>>
>>>>>   Ben Bolker
>>>>>
>>>>>> sessionInfo()
>>>>> R version 2.8.0 (2008-10-20) 
>>>>> i486-pc-linux-gnu 
>>>>>
>>>>> locale:
>>>>> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
>>>>>
>>>>> attached base packages:
>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base    
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> ______________________________________________
>> R-help at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-help
>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
>> and provide commented, minimal, self-contained, reproducible code.
> 
> -----------------------------------------------------------------------
> This message and its attachments are strictly confiden...{{dropped:15}}


From plummer at iarc.fr  Thu Dec 18 11:04:50 2008
From: plummer at iarc.fr (Martyn Plummer)
Date: Thu, 18 Dec 2008 11:04:50 +0100
Subject: [Rd] [R]   "Error: bad value" problem
In-Reply-To: <494A1E9B.8050509@biostat.ku.dk>
References: <20081217223408.F3D214CA07@egon.stats.ucl.ac.uk>
	<D667981B-6F7E-4242-AC9D-50FD2AC3EAD8@auckland.ac.nz>
	<4949949F.7080101@biostat.ku.dk>	<49499C78.9020700@biostat.ku.dk>
	<21065458.post@talk.nabble.com> <4949ADC9.40409@biostat.ku.dk>
	<4949B9CB.1000308@stats.uwo.ca>  <4949BE58.2020805@stats.uwo.ca>
	<1229587193.2948.11.camel@localhost.localdomain>
	<494A1E9B.8050509@biostat.ku.dk>
Message-ID: <1229594690.2948.98.camel@localhost.localdomain>

On Thu, 2008-12-18 at 10:57 +0100, Peter Dalgaard wrote:
> Martyn Plummer wrote:
> > This has all the hallmarks of a bug I found and fixed in R-devel
> > (r46998).  I did not port the patch over to the R release branch because
> > I could not reproduce the bug.
> > 
> > In R-devel, I was seeing problems with "make test-Segfault". This would
> > occasionally segfault, but most of the time would create the "bad value"
> > error, and of course would also run perfectly fine a lot of the time.
> > The error came from exactly the same place that Ben found.  It was due
> > to an invalid SrcRefs being used because SrcFile is not set to zero when
> > it should be.
> > 
> > I'll have a look and see if it is the same problem, or a close cousin.
> 
> Yes, this does appear to fix the issue. (Did you forget a NEWS file 
> entry, though?)

You mean this?

* Fixed obscure, poorly reproducible bug that nobody else has reported.

Anyway, it's the same bug. There is a call to parse() in plot.mmfit()
which generates a parse error.  This has been wrapped in a silent call
to try, so you never see the error message:

Error in parse(text = colnames(z)[seq(1, 2 * np, 2)]) : 
  unexpected numeric constant in "Parameter 1"

This error leaves the parser in a bad state.

> It's a two-line change fixing a live bug, so it could go in 2.8.1 even 
> in code freeze. The problem is that it is inside gram.y which will 
> trigger some maintainer-mode activity, and did trip up my Fedora laptop 
> slightly. Hmmmm....
> 
> 	-p

Fedora 10 certainly won't let me do a maintainer mode build.  I leave it
in your hands.

M.

> > Martyn
> > 
> > 
> > On Wed, 2008-12-17 at 22:07 -0500, Duncan Murdoch wrote:
> >> On 17/12/2008 9:47 PM, Duncan Murdoch wrote:
> >>> On 17/12/2008 8:56 PM, Peter Dalgaard wrote:
> >>>> Ben Bolker wrote:
> >>>>>   I can get the errors to happen on Ubuntu 8.10 with R --vanilla (*without*
> >>>>> valgrind) -- but
> >>>>> editing momfit.r line 742 so that plot.progress=FALSE seems to make the
> >>>>> problem go away.  (This was a lucky guess, it looked like there was
> >>>>> something
> >>>>> odd going on with the plots.)
> >>>>>
> >>>>>   Hope that helps someone ...
> >>>> Probably not. The problem is to reproduce the error state in a way so 
> >>>> that we can understand what is causing it.
> >>>>
> >>>> I can debug this to
> >>>> (gdb) bt
> >>>> #0  Rf_error (format=0x8220c65 "bad value") at 
> >>>> ../../../R/src/main/errors.c:704
> >>>> #1  0x0805a924 in SETCDR (x=0x8f89348, y=0x9b276e8)
> >>>>      at ../../../R/src/main/memory.c:2728
> >>>> #2  0x0819fa46 in GrowList (l=0x951e8f4, s=<value optimized out>) at 
> >>>> gram.y:958
> >>>> #3  0x081a2a7b in xxvalue (v=0x8f89348, k=4, lloc=<value optimized out>)
> >>>>      at gram.y:440
> >>>>
> >>>> and the problem in GrowList is that CAR(l) is R_NilValue (==0x8f89348), 
> >>>> which supposedly "cannot happen", and the thing that calls GrowList is 
> >>>> something with srcrefs (DuncanM?).
> >>>>
> >>>> Digging deeper probably has to wait till the weekend for my part. (The 
> >>>> natural next step is figuring out how the R_NilValue got into that 
> >>>> location, but I should try to sleep off this cold....)
> >>>>
> >>>> I'm CCing r-devel on this. Can we move the discussion there?
> >>> I can probably take a look tomorrow.  I wasn't getting an error, but 
> >>> maybe I'll see the same corruption if I watch it run.
> >> I had time to see if I was getting a NilValue there tonight, and the 
> >> answer was no, with the Windows RC.  I don't get the error in any 
> >> version I've tried on Windows, though I can see it in 2.8.0 on MacOSX.
> >>
> >> Duncan
> >>> Duncan Murdoch
> >>>
> >>>>
> >>>>>   Ben Bolker
> >>>>>
> >>>>>> sessionInfo()
> >>>>> R version 2.8.0 (2008-10-20) 
> >>>>> i486-pc-linux-gnu 
> >>>>>
> >>>>> locale:
> >>>>> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
> >>>>>
> >>>>> attached base packages:
> >>>>> [1] stats     graphics  grDevices utils     datasets  methods   base    
> >>> ______________________________________________
> >>> R-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >> ______________________________________________
> >> R-help at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-help
> >> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
> >> and provide commented, minimal, self-contained, reproducible code.
> > 
> > -----------------------------------------------------------------------
> > This message and its attachments are strictly confidential. If you are
> > not the intended recipient of this message, please immediately notify 
> > the sender and delete it. Since its integrity cannot be guaranteed, 
> > its content cannot involve the sender's responsibility. Any misuse, 
> > any disclosure or publication of its content, either whole or partial, 
> > is prohibited, exception made of formally approved use
> > -----------------------------------------------------------------------
> 
> 

-----------------------------------------------------------------------
This message and its attachments are strictly confidenti...{{dropped:8}}


From Kurt.Hornik at wu-wien.ac.at  Thu Dec 18 11:22:32 2008
From: Kurt.Hornik at wu-wien.ac.at (Kurt Hornik)
Date: Thu, 18 Dec 2008 11:22:32 +0100
Subject: [Rd] Tip for removing -c99 when compiling with icc
In-Reply-To: <alpine.LFD.2.00.0812180939560.1422@gannet.stats.ox.ac.uk>
References: <s3socz926c8.fsf@slagelg.uio.no>
	<alpine.LFD.2.00.0812180939560.1422@gannet.stats.ox.ac.uk>
Message-ID: <18762.9320.207962.565397@fangorn.hornik.net>

>>>>> Prof Brian Ripley writes:

> On Thu, 18 Dec 2008, Bj?rn-Helge Mevik wrote:
>> Dear developeRs,
>> 
>> As of icc 10, the -c99 option is deprecated, and generates a lot of
>> warnings when compiling R or R packages.
>> 
>> If you use CC="icc -std=c99" instead of just CC="icc", R's configure
>> will not add the -c99 option, and the code seems to compile and run just
>> fine.

> It's not really R, but autoconf's macro (I believe called from AC_PROG_CC) 
> which does

> for ac_arg in '' -std=gnu99 -c99 -qlanglvl=extc99

> One day autoconf will catch up with icc and try -std=c99 as well.  (It
> may already have done so: we are using the 3-year-old 2.61 as PD has
> that on the release system, Mac OS X still does ....)

>From a quick look: I e.g. on Debian testing have 2.61 (released 2006)
which has

dnl Try
dnl GCC         -std=gnu99 (unused restrictive modes: -std=c99 -std=iso9899:1999)
dnl AIX         -qlanglvl=extc99 (unused restrictive mode: -qlanglvl=stdc99)
dnl Intel ICC   -c99
dnl IRIX        -c99
dnl Solaris     (unused because it causes the compiler to assume C99 semantics for
dnl             library functions, and this is invalid before Solaris 10: -xc99)
dnl Tru64       -c99

The Autoconf CVS otoh has

dnl Try
dnl GCC         -std=gnu99 (unused restrictive modes: -std=c99 -std=iso9899:1999)
dnl AIX         -qlanglvl=extc99 (unused restrictive mode: -qlanglvl=stdc99)
dnl HP cc       -AC99
dnl Intel ICC   -std=c99, -c99 (deprecated)
dnl IRIX        -c99
dnl Solaris     -xc99=all (Forte Developer 7 C mishandles -xc99 on Solaris 9,
dnl             as it incorrectly assumes C99 semantics for library functions)
dnl Tru64       -c99

so I assume would do better ...

We could try doing some compiler-specific fixing in our configure code.

Best
-k

>> (Please don't hesitate to let me know if this is a bad idea. :-)

> It is fine: I'll add a note to the manual.

>> 
>> -- 
>> Regards,
>> Bj?rn-Helge Mevik
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 

> -- 
> Brian D. Ripley,                  ripley at stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272866 (PA)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From murdoch at stats.uwo.ca  Thu Dec 18 13:36:00 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Thu, 18 Dec 2008 07:36:00 -0500
Subject: [Rd] minor typo in duplicated.Rd (lemgth != length)
In-Reply-To: <8ed68eed0812172157h1e75b8d9r5c77bb48580bbcf3@mail.gmail.com>
References: <8ed68eed0812172157h1e75b8d9r5c77bb48580bbcf3@mail.gmail.com>
Message-ID: <494A43B0.2000706@stats.uwo.ca>

Sean O'Riordain wrote:
> sean at sean7:~/R/RSVN/R/trunk/src/library$ svn diff
> Index: base/man/duplicated.Rd
> ===================================================================
> --- base/man/duplicated.Rd	(revision 47231)
> +++ base/man/duplicated.Rd	(working copy)
> @@ -64,7 +64,7 @@
>    not be efficient for a very large set.
>  }
>  \value{
> -  For a vector input, a logical vector of the same lemgth as
> +  For a vector input, a logical vector of the same length as
>    \code{x}.  For a data frame, a logical vector with one element for
>    each row.  For a matrix or array, a logical array with the same
>    dimensions and dimnames.
>   

Thanks, I'll fix it.

Duncan Murdoch


From P.Dalgaard at biostat.ku.dk  Thu Dec 18 15:47:51 2008
From: P.Dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Thu, 18 Dec 2008 15:47:51 +0100
Subject: [Rd] [R]   "Error: bad value" problem
In-Reply-To: <1229594690.2948.98.camel@localhost.localdomain>
References: <20081217223408.F3D214CA07@egon.stats.ucl.ac.uk>	
	<D667981B-6F7E-4242-AC9D-50FD2AC3EAD8@auckland.ac.nz>	
	<4949949F.7080101@biostat.ku.dk>	<49499C78.9020700@biostat.ku.dk>	
	<21065458.post@talk.nabble.com> <4949ADC9.40409@biostat.ku.dk>	
	<4949B9CB.1000308@stats.uwo.ca> <4949BE58.2020805@stats.uwo.ca>	
	<1229587193.2948.11.camel@localhost.localdomain>	
	<494A1E9B.8050509@biostat.ku.dk>
	<1229594690.2948.98.camel@localhost.localdomain>
Message-ID: <494A6297.8010201@biostat.ku.dk>

Martyn Plummer wrote:
> On Thu, 2008-12-18 at 10:57 +0100, Peter Dalgaard wrote:
>> Martyn Plummer wrote:
>>> This has all the hallmarks of a bug I found and fixed in R-devel
>>> (r46998).  I did not port the patch over to the R release branch because
>>> I could not reproduce the bug.
[....]
>> Yes, this does appear to fix the issue. (Did you forget a NEWS file 
>> entry, though?)
> 
> You mean this?
> 
> * Fixed obscure, poorly reproducible bug that nobody else has reported.
> 
> Anyway, it's the same bug. There is a call to parse() in plot.mmfit()
> which generates a parse error.  This has been wrapped in a silent call
> to try, so you never see the error message:
> 
> Error in parse(text = colnames(z)[seq(1, 2 * np, 2)]) : 
>   unexpected numeric constant in "Parameter 1"
> 
> This error leaves the parser in a bad state.
> 
>> It's a two-line change fixing a live bug, so it could go in 2.8.1 even 
>> in code freeze. The problem is that it is inside gram.y which will 
>> trigger some maintainer-mode activity, and did trip up my Fedora laptop 
>> slightly. Hmmmm....
>>
>> 	-p
> 
> Fedora 10 certainly won't let me do a maintainer mode build.  I leave it
> in your hands.
> 
> M.

Now committed for 2.8.1.

-- 
   O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
  c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
 (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From chalabi at phys.ethz.ch  Thu Dec 18 18:16:33 2008
From: chalabi at phys.ethz.ch (Yohan Chalabi)
Date: Thu, 18 Dec 2008 18:16:33 +0100
Subject: [Rd] typo in "R Installation and Administration"
Message-ID: <20081218181633.7cc36244@mimi>

Hi all,

There seems to be a typo in "R Installation and Administration" in "B.7 Compile and load flags"

"special flags for compiling Fortran 95 code to be turned into a shared library" should be FCPICFLAGS and not FPICFLAGS

regards,
Yohan


From olafm at kimberly.tako.de  Thu Dec 18 21:28:48 2008
From: olafm at kimberly.tako.de (Olaf Mersmann)
Date: Thu, 18 Dec 2008 21:28:48 +0100
Subject: [Rd] DTrace probes for R
Message-ID: <1229631474-sup-1057@bloxx.plex>

I've integrated some DTrace [1] probes into R. Namely a probe which
fires on fuction entry and return and one which fires before / after a
garbage collection.

Is there any interest in merging something like this into R-devel? If
yes, I'd like to discuss which probes and what data would be useful /
interesting from a developers standpoint.

Greetings from Dortmund,
Olaf Mersmann

[1] http://www.sun.com/bigadmin/content/dtrace/


From bradford.n.cross at gmail.com  Fri Dec 19 03:13:14 2008
From: bradford.n.cross at gmail.com (Bradford Cross)
Date: Thu, 18 Dec 2008 18:13:14 -0800
Subject: [Rd] the list might be interested in this new project
Message-ID: <ea7d6a710812181813y5244aa8bw50c473f9cf522b07@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081218/f34d46fa/attachment.pl>

From meerman at chem.leidenuniv.nl  Thu Dec 18 13:03:06 2008
From: meerman at chem.leidenuniv.nl (meerman)
Date: Thu, 18 Dec 2008 13:03:06 +0100
Subject: [Rd] rscproxy version conflict
Message-ID: <A343EAB77B324AF08F072FDD07E47D36@fwnc.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20081218/c1d8a6c0/attachment.pl>

From ripley at stats.ox.ac.uk  Fri Dec 19 09:00:11 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 19 Dec 2008 08:00:11 +0000 (GMT)
Subject: [Rd] rscproxy version conflict
In-Reply-To: <A343EAB77B324AF08F072FDD07E47D36@fwnc.net>
References: <A343EAB77B324AF08F072FDD07E47D36@fwnc.net>
Message-ID: <alpine.LFD.2.00.0812190757550.25926@gannet.stats.ox.ac.uk>

On Thu, 18 Dec 2008, meerman wrote:

> After installing the package 'rscproxy' downloaded from the CRAN server, I
> get the following error message from R 2.8.0 about a version conflict :

I see no 'error message' nor no 'confict'.

I see a *warning* which you could stop by using 2.8.1 RC or by updating to 
2.8.1 early next week, but should be harmless.


>
>
>
>
>
> package 'rscproxy' successfully unpacked and MD5 sums checked
>
>
>
> The downloaded packages are in
>
>         C:\Documents and Settings\John Meerman\Local
>
> Settings\Temp\RtmpbK9mxN\downloaded_packages
>
> updating HTML package descriptions
>
>> local({pkg <- select.list(sort(.packages(all.available = TRUE)))
>
> + if(nchar(pkg)) library(pkg, character.only=TRUE)})
>
> *Warning message:
>
> package 'rscproxy' was built under R version 2.8.1 *>
>
>
>
> This prevents me e.g. to use the R (D)COM 3.0 server.
>
>
>
>
>
>
>
>
>
> John Meerman
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Fri Dec 19 09:58:19 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 19 Dec 2008 08:58:19 +0000 (GMT)
Subject: [Rd] Misuse of $<matn expressions>$ in Rd files
Message-ID: <alpine.LFD.2.00.0812190831550.27469@gannet.stats.ox.ac.uk>

'Writing R Extensions' tells you that $ needs to be escaped in Rd files 
outside \code and similar.  So I was surprised to find that ca 80 CRAN 
packages have constructions like (from ISwR)

   \item{\code{folate}}{
     a numeric vector, folate concentration ($\mu$g/l).
   }

This does not render sensibly in non-latex conversions, and it is what we 
have \eqn{} for.

That $ needs to be escaped is an implementation restriction that we hope 
to remove so that things like (package fields)

 	greater than or equal to 2*m where m= length( grid$x).

do not generate an error (although \code{}) markup would be appropriate 
and avoid the problem).

It is not clear if we are going to be able to do this backwards compatibly 
or not, so plese check that you are using $ correctly.  The most plausible 
scenario now is that we will have versions of Rd files with the current 
version being implicitly '1.0', and in '1.1' $ will be treated literally.

Finally, \eqn{} is for mathematics, and arbitrary markup is not allowed. 
The following (SoPhy) is causing problems:

       \eqn{\code{zlim}=\command{\link[base]{range}}(\{0,
         \theta_{s,i}\}, max(\code{h$hQThFlC}))}{\code{zlim}=\command{range}({0,
           theta_{s,i}}, max(\code{h$hQThFlC}))},


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From Waclaw.Marcin.Kusnierczyk at idi.ntnu.no  Fri Dec 19 10:32:13 2008
From: Waclaw.Marcin.Kusnierczyk at idi.ntnu.no (Wacek Kusnierczyk)
Date: Fri, 19 Dec 2008 10:32:13 +0100
Subject: [Rd] gregexpr - match overlap mishandled (PR#13391)
In-Reply-To: <alpine.LFD.2.00.0812121910370.23680@gannet.stats.ox.ac.uk>
References: <20081212170504.93484282EFC1@mail.pubhealth.ku.dk>
	<alpine.LFD.2.00.0812121910370.23680@gannet.stats.ox.ac.uk>
Message-ID: <494B6A1D.80000@idi.ntnu.no>

Prof Brian Ripley wrote:
> Please do your own homework: the help page says
>
>      For 'gregexpr' a list of the same length as 'text' each element of
>      which is an integer vector as in 'regexpr', except that the
>      starting positions of every (disjoint) match are given.
>                                   ^^^^^^^^
>
> If that is still not clear enough for you, please ask your supervisor
> for remedial help.
>

i must say that even knowing what is meant i have trouble finding it
written in the docs.  someone who's looking for help because he does not
know the answer yet will most certainly get confused here.

the point is that gregexpr returns the starting positions of *mutually
non-overlapping*, or *pairwise disjoint* matches (which still does not
tell the whole story).  the expression 'every (disjoint) match' is
nonsense, as it suggests that only those matches which are individually
disjoint (and what would this mean?) are reported, as if of all possible
matches found only those that pass some disjointness test in a grep-like
filter were left.

i'd humbly suggest that once users are referred to specific man pages,
those pages are reassessed and improved where necessary -- this one
would be a good candidate.

vQ


From p.dalgaard at biostat.ku.dk  Fri Dec 19 11:31:01 2008
From: p.dalgaard at biostat.ku.dk (Peter Dalgaard)
Date: Fri, 19 Dec 2008 11:31:01 +0100
Subject: [Rd] Misuse of $<matn expressions>$ in Rd files
In-Reply-To: <alpine.LFD.2.00.0812190831550.27469@gannet.stats.ox.ac.uk>
References: <alpine.LFD.2.00.0812190831550.27469@gannet.stats.ox.ac.uk>
Message-ID: <494B77E5.4060201@biostat.ku.dk>

Prof Brian Ripley wrote:
> 'Writing R Extensions' tells you that $ needs to be escaped in Rd files 
> outside \code and similar.  So I was surprised to find that ca 80 CRAN 
> packages have constructions like (from ISwR)
> 
>   \item{\code{folate}}{
>     a numeric vector, folate concentration ($\mu$g/l).
>   }
> 
> This does not render sensibly in non-latex conversions, and it is what 
> we have \eqn{} for.

I suspect last I looked at this was in copy editing that getting the 
LaTeX to look right took priority.

It renders as "$\mu$g/l" (for now) which is semi-sensible to my eyes. I 
can see that I have \eqn{\mu}g/l in other places, but that comes out as 
"mug/l" which looks like an inverted measure for coffee cups. I probably 
gave up deciding a good incantation for "microgram per liter" in text 
mode. Possibly \eqn{\mu}{u} is the best on can do.

-- 
    O__  ---- Peter Dalgaard             ?ster Farimagsgade 5, Entr.B
   c/ /'_ --- Dept. of Biostatistics     PO Box 2099, 1014 Cph. K
  (*) \(*) -- University of Copenhagen   Denmark      Ph:  (+45) 35327918
~~~~~~~~~~ - (p.dalgaard at biostat.ku.dk)              FAX: (+45) 35327907


From ripley at stats.ox.ac.uk  Fri Dec 19 12:32:52 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 19 Dec 2008 11:32:52 +0000 (GMT)
Subject: [Rd] Misuse of $<matn expressions>$ in Rd files
In-Reply-To: <494B77E5.4060201@biostat.ku.dk>
References: <alpine.LFD.2.00.0812190831550.27469@gannet.stats.ox.ac.uk>
	<494B77E5.4060201@biostat.ku.dk>
Message-ID: <alpine.LFD.2.00.0812191125450.32165@gannet.stats.ox.ac.uk>

On Fri, 19 Dec 2008, Peter Dalgaard wrote:

> Prof Brian Ripley wrote:
>> 'Writing R Extensions' tells you that $ needs to be escaped in Rd files 
>> outside \code and similar.  So I was surprised to find that ca 80 CRAN 
>> packages have constructions like (from ISwR)
>>
>>   \item{\code{folate}}{
>>     a numeric vector, folate concentration ($\mu$g/l).
>>   }
>> 
>> This does not render sensibly in non-latex conversions, and it is what we 
>> have \eqn{} for.
>
> I suspect last I looked at this was in copy editing that getting the LaTeX to 
> look right took priority.
>
> It renders as "$\mu$g/l" (for now) which is semi-sensible to my eyes. I can

Actually, it renders (e.g. in 2.8.0) as '$mu$g/l', which is less sensible 
that what you read it as, but in my experience only people from the more 
mathematical sciences are likely to be aware of TeX notation.

> see that I have \eqn{\mu}g/l in other places, but that comes out as "mug/l" 
> which looks like an inverted measure for coffee cups. I probably gave up 
> deciding a good incantation for "microgram per liter" in text mode. Possibly 
> \eqn{\mu}{u} is the best on can do.

Well, why try an abbreviation that is unclear?  E.g. other examples are 
trying to get a degree sign as $^\circ$C, and why not just say 'degrees 
Celsius'?

You probably not had a copy-editor make you write out DNA ....

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From maechler at stat.math.ethz.ch  Mon Dec 22 11:19:31 2008
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 22 Dec 2008 11:19:31 +0100
Subject: [Rd] typo in "R Installation and Administration"
In-Reply-To: <20081218181633.7cc36244@mimi>
References: <20081218181633.7cc36244@mimi>
Message-ID: <18767.27059.127035.635098@stat.math.ethz.ch>

>>>>> "YC" == Yohan Chalabi <chalabi at phys.ethz.ch>
>>>>>     on Thu, 18 Dec 2008 18:16:33 +0100 writes:

    YC> Hi all, There seems to be a typo in "R Installation and
    YC> Administration" in "B.7 Compile and load flags"

    YC> "special flags for compiling Fortran 95 code to be
    YC> turned into a shared library" should be FCPICFLAGS and
    YC> not FPICFLAGS

Yes.  I've fixed, unfortunately a bit too late for today's
release of 2.8.1

Merci, Yohan!
Martin


From ggrothendieck at gmail.com  Mon Dec 22 14:06:33 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Mon, 22 Dec 2008 08:06:33 -0500
Subject: [Rd] read.table with fill = TRUE
Message-ID: <971536df0812220506q38d7478an1d6895b6d99e6469@mail.gmail.com>

There seems to be a problem with read.table
when fill = TRUE in this case.  In the example
below, note that:
- there should be 4 columns, not 3
- some rows like row 6 are cut off at the end
- others like row 7 seem completely wrong

> Lines <- "x 1 b
+ x 1 a
+ x 2 b
+ x 2 a
+ x 2
+ y 1 a 1
+ y 10 a 2
+ y 10 a 10
+ y 10 a 1
+ y 2
+ var 10 a 2
+ var 2
+ y 10"
>
> read.table(textConnection(Lines), fill = TRUE)
    V1 V2 V3
1    x  1  b
2    x  1  a
3    x  2  b
4    x  2  a
5    x  2
6    y  1  a
7    1 NA
8    y 10  a
9    2 NA
10   y 10  a
11  10 NA
12   y 10  a
13   1 NA
14   y  2
15 var 10  a
16   2 NA
17 var  2
18   y 10
> R.version.string
[1] "R version 2.8.1 RC (2008-12-17 r47235)"


From cbeleites at units.it  Mon Dec 22 15:26:50 2008
From: cbeleites at units.it (Claudia Beleites)
Date: Mon, 22 Dec 2008 15:26:50 +0100
Subject: [Rd] ... (dotMethods) and cbind/rbind: how to give the signature?
Message-ID: <200812221526.50379.cbeleites@units.it>

Dear List,

I'm struggling with the signature writing cbind/rbind functions for a S4 
class.

First of all, I'm very happy that it is now possible to dispatch on ...
I follow the example for "paste" in ?dotMethods, which works as far as this:

### start example
setClass ("cbtest",
          representation = representation (data = "data.frame"),
          prototype = prototype (data = data.frame (spc = I (matrix (rnorm 
(15) , 3, 5)))
            )
 )

a <- new ("cbtest")
a

setMethod("cbind2", signature (x = "cbtest", y  = "cbtest"),
          function (x, y){
            x at data$spc <- cbind (x at data$spc, y at data$spc) 
            x
          }
          )


setMethod("cbind2", signature (x = "cbtest", y = "missing"), function (x, y) 
x)

cb.cbind <- function (..., deparse.level){
  dots <- list (...) 
  for (i in seq_along (dots)[-1])
    dots[[1]] <- cbind2 (dots[[1]], dots[[i]])

  dots[[1]]
} 


cbind2 (a, a)
cb.cbind (a, a, a)


cbind (a, a, a)
setGeneric ("cbind", signature = signature("...")) 
setMethod ("cbind", "cbtest",
           function (..., deparse.level) cb.cbind (...))
cbind (a, a, a)
cbind (a, a, a, deparse.level = 1)

### end example


However, I get the following message:
with setGeneric 

Creating a generic for "cbind" in package  ".GlobalEnv"
    (the supplied definition differs from and overrides the implicit generic in 
package "base": Signatures differ:  (...), (deparse.level))

How do I specify the correct signature? 

Furthermore: as I do not want to do anything with "deparse.level", I'd rather 
specify it as "missing" in setMethod. But again, I don't get the signature 
correct.

I tried 
setGeneric ("cbind", signature = signature (...="...", deparse.level = 
"integer"))
and 
setGeneric ("cbind", signature = signature ("...", deparse.level = "integer"))

both give: 
Fehler in makeGeneric(name, fdef, fdeflt, group = group, valueClass = 
valueClass,  : 
  Nicht-Argumente in der Signatur: integer

What is my mistake?

Thanks a lot for your help!

Claudia


> version
               _                           
platform       i486-pc-linux-gnu           
arch           i486                        
os             linux-gnu                   
system         i486, linux-gnu             
status                                     
major          2                           
minor          8.0                         
year           2008                        
month          10                          
day            20                          
svn rev        46754                       
language       R                           
version.string R version 2.8.0 (2008-10-20)


-- 
Claudia Beleites
Dipartimento dei Materiali e delle Risorse Naturali
Universit? degli Studi di Trieste
Via Alfonso Valerio 6/a
I-34127 Trieste

phone: +39 (0 40) 5 58-34 47
email: cbeleites at units.it


From cbeleites at units.it  Mon Dec 22 15:40:12 2008
From: cbeleites at units.it (Claudia Beleites)
Date: Mon, 22 Dec 2008 15:40:12 +0100
Subject: [Rd] methods vs. functions
Message-ID: <200812221540.12303.cbeleites@units.it>

Dear List,

a second, more general, question concerning S4 classes.

I have a bunch of functions/methods for my class. 

At the moment I have them as methods, because they work on objects of my S4 
class and therefore "belong" to that class.

On the other hand, it is comparably unlikely that someone else wants the same 
kind of method. 
And package.skeleton () produces the xzy-methods.Rds. But for the 
documentation I rather need "normal" function definitions. I know that I can 
write the Rd files just as if it was a normal function, but this got me to ask 
myself whether it is a good idea to have methods or whether I should rather 
use "normal" functions?

If I understood the concept of namespace correctly, a package with a namespace 
avoids trouble with clashing function names - so I don't need to worry about 
that using functions (I anyways have some functions, that should not be 
methods of the class).

Any comments?

Thanks a lot!

Claudia

-- 
Claudia Beleites
Dipartimento dei Materiali e delle Risorse Naturali
Universit? degli Studi di Trieste
Via Alfonso Valerio 6/a
I-34127 Trieste

phone: +39 (0 40) 5 58-34 47
email: cbeleites at units.it


From Gregor.Gorjanc at bfro.uni-lj.si  Mon Dec 22 15:50:02 2008
From: Gregor.Gorjanc at bfro.uni-lj.si (Gorjanc Gregor)
Date: Mon, 22 Dec 2008 15:50:02 +0100
Subject: [Rd] Align legend title
Message-ID: <F189E18BBAA8B6479F618B9044CF4E9C68D7BCC5B8@REGULUS.bfro.uni-lj.si>

Dear R developers,

I needed to align the title of legend for some of my plots. If there is interest to include
this into base R, bellow are the examples and the relevent diffs.

Regards, Gregor

x <- 1:10
y1 <- 1.5 * x
y2 <- 2.0 * x
y <- cbind(y1, y2)

source(file=url("http://gregor.gorjanc.googlepages.com/legend.R"))

matplot(x, y, type="l", lty=c(1, 2))

## Center
legend("topleft", legend=c("a long text, a long text", "y = 2.0 * x"), lty=c(1, 2), title="Function")
legend("topright", legend=c("a shor text", ""), lty=c(1, 2), title="Function + some more text")

## Left
legend("left", legend=c("a long text, a long text, a long text", "y = 2.0 * x"), lty=c(1, 2), title="Function", title.adj=0)
legend("right", legend=c("a shor text", ""), lty=c(1, 2), title="Function + some more long text", title.adj=0)

## Right
legend("bottomleft", legend=c("a long text, a long text, a long text", "y = 2.0 * x"), lty=c(1, 2), title="Function", title.adj=1)
legend("bottomright", legend=c("a shor text", ""), lty=c(1, 2), title="Function + some more long text", title.adj=1)

http://gregor.gorjanc.googlepages.com/legend.R
http://gregor.gorjanc.googlepages.com/legend.Rd
http://gregor.gorjanc.googlepages.com/legend.R.diff
http://gregor.gorjanc.googlepages.com/legend.Rd.diff

Index: legend.R
===================================================================
--- legend.R    (revision 47286)
+++ legend.R    (working copy)
@@ -23,7 +23,7 @@
         text.width = NULL, text.col = par("col"),
         merge = do.lines && has.pch, trace = FALSE,
         plot = TRUE, ncol = 1, horiz = FALSE, title = NULL,
-        inset = 0, xpd, title.col = text.col)
+        inset = 0, xpd, title.col = text.col, title.adj = 0.5)
 {
     ## the 2nd arg may really be `legend'
     if(missing(legend) && !missing(y) &&
@@ -259,11 +259,11 @@

     xt <- xt + x.intersp * xchar
     if(plot) {
-       if (!is.null(title))
-            text2(left + w/2, top - ymax, labels = title,
-                  adj = c(0.5, 0), cex = cex, col = title.col)
+        if(!is.null(title))
+            text2(left + w/2 + ((w - tw) * (title.adj - 0.5)), top - ymax,
+                  labels = title, adj = c(0.5, 0), cex = cex, col = title.col)

-       text2(xt, yt, labels = legend, adj = adj, cex = cex, col = text.col)
+        text2(xt, yt, labels = legend, adj = adj, cex = cex, col = text.col)
     }
     invisible(list(rect = list(w = w, h = h, left = left, top = top),
                   text = list(x = xt, y = yt)))

Index: legend.Rd
===================================================================
--- legend.Rd   (revision 47286)
+++ legend.Rd   (working copy)
@@ -16,7 +16,7 @@
        adj = c(0, 0.5), text.width = NULL, text.col = par("col"),
        merge = do.lines && has.pch, trace = FALSE,
        plot = TRUE, ncol = 1, horiz = FALSE, title = NULL,
-       inset = 0, xpd, title.col = text.col)
+       inset = 0, xpd, title.col = text.col, title.adj = 0.5)
 }
 \description{
   This function can be used to add legends to plots.  Note that a call
@@ -89,6 +89,8 @@
   \item{xpd}{if supplied, a value of the graphical parameter \code{xpd}
     to be used while the legend is being drawn.}
   \item{title.col}{color for \code{title}.}
+  \item{title.adj}{justify the title, a value of 0 means left justified,
+    0.5 means centered and 1 means right justified.}
 }
 \details{
   Arguments \code{x, y, legend} are interpreted in a non-standard way to


From murdoch at stats.uwo.ca  Mon Dec 22 16:11:59 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 22 Dec 2008 10:11:59 -0500
Subject: [Rd] methods vs. functions
In-Reply-To: <200812221540.12303.cbeleites@units.it>
References: <200812221540.12303.cbeleites@units.it>
Message-ID: <494FAE3F.7090909@stats.uwo.ca>

On 12/22/2008 9:40 AM, Claudia Beleites wrote:
> Dear List,
> 
> a second, more general, question concerning S4 classes.
> 
> I have a bunch of functions/methods for my class. 
> 
> At the moment I have them as methods, because they work on objects of my S4 
> class and therefore "belong" to that class.
> 
> On the other hand, it is comparably unlikely that someone else wants the same 
> kind of method. 
> And package.skeleton () produces the xzy-methods.Rds. But for the 
> documentation I rather need "normal" function definitions. I know that I can 
> write the Rd files just as if it was a normal function, but this got me to ask 
> myself whether it is a good idea to have methods or whether I should rather 
> use "normal" functions?
> 
> If I understood the concept of namespace correctly, a package with a namespace 
> avoids trouble with clashing function names - so I don't need to worry about 
> that using functions (I anyways have some functions, that should not be 
> methods of the class).
> 
> Any comments?

In the S4 scheme, methods "belong" to the generic, not to the class.  If 
you only have one method for each generic and don't plan for more, it 
probably makes more sense to make it a regular function:  it will run a 
little bit faster, and be noticeably easier to debug.

Duncan Murdoch


From murdoch at stats.uwo.ca  Mon Dec 22 19:55:11 2008
From: murdoch at stats.uwo.ca (murdoch at stats.uwo.ca)
Date: Mon, 22 Dec 2008 19:55:11 +0100 (CET)
Subject: [Rd] Bug in list indexing (PR#13411)
Message-ID: <20081222185511.4E29C282EFF6@mail.pubhealth.ku.dk>

I was wondering if copies were made when a component of a complex nested 
list structure was extracted but not modified.  I was happy that the 
answer was no, but was surprised that copies weren't made even if the 
extracted bit was modified:

 > x <- list(a=list(b=numeric(1000000)))
 > y <- x[[c(1,1)]]
 > y[1] <- 3.14159
 > x[[c(1,1)]][1]
[1] 3.14159

Unfortunately, this exists in today's release of 2.8.1.  I should have 
done this test last week!

Duncan Murdoch

 > sessionInfo()
R version 2.8.1 (2008-12-22)
i386-pc-mingw32

locale:
LC_COLLATE=English_United States.1252;LC_CTYPE=English_United 
States.1252;LC_MONETARY=English_United 
States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] tools_2.8.1


From murdoch at stats.uwo.ca  Mon Dec 22 20:09:13 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Mon, 22 Dec 2008 14:09:13 -0500
Subject: [Rd] Bug in list indexing (PR#13411)
In-Reply-To: <20081222185511.4E29C282EFF6@mail.pubhealth.ku.dk>
References: <20081222185511.4E29C282EFF6@mail.pubhealth.ku.dk>
Message-ID: <494FE5D9.6080703@stats.uwo.ca>

On 12/22/2008 1:55 PM, murdoch at stats.uwo.ca wrote:
> I was wondering if copies were made when a component of a complex nested 
> list structure was extracted but not modified.  I was happy that the 
> answer was no, but was surprised that copies weren't made even if the 
> extracted bit was modified:
> 
>  > x <- list(a=list(b=numeric(1000000)))
>  > y <- x[[c(1,1)]]
>  > y[1] <- 3.14159
>  > x[[c(1,1)]][1]
> [1] 3.14159
> 
> Unfortunately, this exists in today's release of 2.8.1.  I should have 
> done this test last week!

The fix looks easy:  The problem is that the NAMED status of the 
component being extracted was miscalculated when using a vector index. 
I'll commit a change after testing...

Duncan Murdoch

> 
> Duncan Murdoch
> 
>  > sessionInfo()
> R version 2.8.1 (2008-12-22)
> i386-pc-mingw32
> 
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United 
> States.1252;LC_MONETARY=English_United 
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> loaded via a namespace (and not attached):
> [1] tools_2.8.1
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From cstrato at aon.at  Mon Dec 22 20:39:37 2008
From: cstrato at aon.at (cstrato)
Date: Mon, 22 Dec 2008 20:39:37 +0100
Subject: [Rd] How to add a slot to S4 class of an existing package?
Message-ID: <494FECF9.2020301@aon.at>

Dear all,

Since my package is based on S4 classes, I would like to know how to add 
a slot to an existing S4 class without breaking the code of users of my 
package.

Assume the following S4 class:
setClass("MyClass",
   representation(name = "character",
                  type = "character",
                  data = "data.frame"
   ),
   prototype(name = "",
             type = "Default",
             data = data.frame(matrix(nr=0,nc=0))
   )
)#MyClass

Assume that a user has created an object:
 > myclass <- new("MyClass", name="MyName", type="MyType", data=tmp)
 > str(myclass)


Now I would like to add another slot "info" to MyClass:
setClass("MyClass",
   representation(name = "character",
                  type = "character",
                  data = "data.frame",
                  info = "data.frame"
   ),
   prototype(name = "",
             type = "Default",
             data = data.frame(matrix(nr=0,nc=0)),
             info = data.frame(matrix(nr=0,nc=0))
   )
)#MyClass

Now when the user loads my package with S4 class MyClass containing a 
new slot and calls:
 > str(myclass)
Error in FUN(c("name", "type", "data", "info")[[4L]], ...) :
  no slot of name "info" for this object of class "MyClass"
 >

My question is:
Is there any possibility or special trick, which would avoid this error 
message?

Are there other possibilities to access an additional data.frame from an 
existing class?

Is there something like an "evolution" of S4 classes, which 
distinguishes the different implementations of an S4 class, and allows 
the user to keep the object of an old class?

Best regards
Christian
_._._._._._._._._._._._._._._._._._
C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
V.i.e.n.n.a           A.u.s.t.r.i.a
e.m.a.i.l:        cstrato at aon.at
_._._._._._._._._._._._._._._._._._


From erich.neuwirth at univie.ac.at  Mon Dec 22 21:30:42 2008
From: erich.neuwirth at univie.ac.at (Erich Neuwirth)
Date: Mon, 22 Dec 2008 21:30:42 +0100
Subject: [Rd] rscproxy version conflict
In-Reply-To: <A343EAB77B324AF08F072FDD07E47D36@fwnc.net>
References: <A343EAB77B324AF08F072FDD07E47D36@fwnc.net>
Message-ID: <494FF8F2.2080009@univie.ac.at>

We found out about this problem only a few days ago.
The reason is that the official binary packages were compiled with
2.8.1, but the distributed Windows binary of R was still 2.8.0.
rscproxy needs to be compiled for the correct version of R.
Now with R 2.8.1 being release officially the problem should disappear,
but we (which is mostly Thomas Baier, the mastermind behind rcom and
R(D)COM server) will try to find a way to avoid this problem with the
next R update.

Before R 2.8.0, rproxy.dll distributed with R itself was
supplying the underlying mechanism for the rcom package and R(D)COM
server. rproxy.dll was removed from R itself, and rscproxy is the
current substitute. rproxy.dll, being part of R itself, always matched
the R version to the very last digit. With rscproxy, it is more
difficult to stay in sync.




meerman wrote:
> After installing the package 'rscproxy' downloaded from the CRAN server, I
> get the following error message from R 2.8.0 about a version conflict :
> 
>  
> 
>  
> 
> package 'rscproxy' successfully unpacked and MD5 sums checked
> 
>   
> 
> The downloaded packages are in
> 
>          C:\Documents and Settings\John Meerman\Local 
> 
> Settings\Temp\RtmpbK9mxN\downloaded_packages
> 
> updating HTML package descriptions
> 
>> local({pkg <- select.list(sort(.packages(all.available = TRUE)))
> 
>  + if(nchar(pkg)) library(pkg, character.only=TRUE)})
> 
>  *Warning message:
> 
>  package 'rscproxy' was built under R version 2.8.1 *>
> 
>  
> 
> This prevents me e.g. to use the R (D)COM 3.0 server.
> 
>  
> 
>  
> 
>  
> 
>  
> 
> John Meerman
> 
>  
> 
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
> ------------------------------------------------------------------------
> 
> 
> No virus found in this incoming message.
> Checked by AVG - http://www.avg.com 
> Version: 8.0.176 / Virus Database: 270.9.19/1854 - Release Date: 12/17/2008 7:21 PM
> 

-- 
Erich Neuwirth, University of Vienna
Faculty of Computer Science
Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-39464 Fax: +43-1-4277-39459


From simon.urbanek at r-project.org  Mon Dec 22 21:40:20 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 22 Dec 2008 15:40:20 -0500
Subject: [Rd] rscproxy version conflict
In-Reply-To: <494FF8F2.2080009@univie.ac.at>
References: <A343EAB77B324AF08F072FDD07E47D36@fwnc.net>
	<494FF8F2.2080009@univie.ac.at>
Message-ID: <C24998E0-3900-4C63-A9BB-6E5A234DF199@r-project.org>


On Dec 22, 2008, at 15:30 , Erich Neuwirth wrote:

> We found out about this problem only a few days ago.
> The reason is that the official binary packages were compiled with
> 2.8.1, but the distributed Windows binary of R was still 2.8.0.
> rscproxy needs to be compiled for the correct version of R.
> Now with R 2.8.1 being release officially the problem should  
> disappear,
> but we (which is mostly Thomas Baier, the mastermind behind rcom and
> R(D)COM server) will try to find a way to avoid this problem with the
> next R update.
>
> Before R 2.8.0, rproxy.dll distributed with R itself was
> supplying the underlying mechanism for the rcom package and R(D)COM
> server. rproxy.dll was removed from R itself, and rscproxy is the
> current substitute. rproxy.dll, being part of R itself, always matched
> the R version to the very last digit. With rscproxy, it is more
> difficult to stay in sync.
>
>

FWIW: technically, you don't have to match the patch level version.  
Although default DLL checks usually require perfect match, it should  
be safe to require that R version lies in [x.y.z, x.y+1.0)  where  
x.y.z is the R version that the interfacing DLL was compiled against.  
(And hence it is safe to use R x.y.0 as the base for compilation until  
R x.y+1.0 is released).

Cheers,
Simon


>
>
> meerman wrote:
>> After installing the package 'rscproxy' downloaded from the CRAN  
>> server, I
>> get the following error message from R 2.8.0 about a version  
>> conflict :
>>
>>
>>
>>
>>
>> package 'rscproxy' successfully unpacked and MD5 sums checked
>>
>>
>>
>> The downloaded packages are in
>>
>>         C:\Documents and Settings\John Meerman\Local
>>
>> Settings\Temp\RtmpbK9mxN\downloaded_packages
>>
>> updating HTML package descriptions
>>
>>> local({pkg <- select.list(sort(.packages(all.available = TRUE)))
>>
>> + if(nchar(pkg)) library(pkg, character.only=TRUE)})
>>
>> *Warning message:
>>
>> package 'rscproxy' was built under R version 2.8.1 *>
>>
>>
>>
>> This prevents me e.g. to use the R (D)COM 3.0 server.
>>
>>
>>
>>
>>
>>
>>
>>
>>
>> John Meerman
>>
>>
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>> ------------------------------------------------------------------------
>>
>>
>> No virus found in this incoming message.
>> Checked by AVG - http://www.avg.com
>> Version: 8.0.176 / Virus Database: 270.9.19/1854 - Release Date:  
>> 12/17/2008 7:21 PM
>>
>
> -- 
> Erich Neuwirth, University of Vienna
> Faculty of Computer Science
> Computer Supported Didactics Working Group
> Visit our SunSITE at http://sunsite.univie.ac.at
> Phone: +43-1-4277-39464 Fax: +43-1-4277-39459
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From osklyar at maninvestments.com  Tue Dec 23 17:09:09 2008
From: osklyar at maninvestments.com (Sklyar, Oleg (London))
Date: Tue, 23 Dec 2008 16:09:09 -0000
Subject: [Rd] ... (dotMethods) and cbind/rbind: how to give the
	signature?
In-Reply-To: <200812221526.50379.cbeleites@units.it>
References: <200812221526.50379.cbeleites@units.it>
Message-ID: <1A68FCB28DE72F4BA3B967E6506CCE43047DF512@mildnpexmb01.maninvestments.ad.man.com>

I find it easier to use S3 methods for cbind and rbind even for S4 classes. The reason is that first you won't have different classes in the signature for cbind/rbind and second is that ... signatures are only allowed if ALL arguments are of the same class, whereas setGeneric("cbind") will force you to specify deparse.level of a different class -- it does not work for me. If you however try to redefine the cbind generic (as it is not generic initially) without deparse.level you first face a compatibility problem and cbind for matrices stops working.

If anybody has a working S4 solution I would be grateful for a hint:


setClass("ClassA", representation("matrix", comment="character"))

a = new("ClassA", matrix(runif(10),ncol=2), comment="aa")
b = new("ClassA", matrix(runif(15),ncol=3), comment="bb")

cbind.ClassA = mycbind = function(...) {
	dots = list(...)
	if (length(dots)<2) return(dots[[1]])
	data = lapply(dots, function(x) x at .Data)
	data = if (length(data)>1) do.call("cbind",data) else data[[1]]
	comment = sapply(dots, function(x) x at comment)
	comment = paste(comment, collapse="; ")
	new("ClassA", data, comment=comment)
}

cbind(a,b)
cbind(a at .Data, b at .Data)

With respect to your second question on S4 methods -- it gives room for extendability and type checking, otherwise there is no good reason to define functions as methods if you will only have one single implementation of functionality with the same name.


Dr Oleg Sklyar
Research Technologist
AHL / Man Investments Ltd
+44 (0)20 7144 3107
osklyar at maninvestments.com 

> -----Original Message-----
> From: r-devel-bounces at r-project.org 
> [mailto:r-devel-bounces at r-project.org] On Behalf Of Claudia Beleites
> Sent: 22 December 2008 14:27
> To: r-devel at r-project.org
> Subject: [Rd] ... (dotMethods) and cbind/rbind: how to give 
> the signature?
> 
> Dear List,
> 
> I'm struggling with the signature writing cbind/rbind 
> functions for a S4 
> class.
> 
> First of all, I'm very happy that it is now possible to 
> dispatch on ...
> I follow the example for "paste" in ?dotMethods, which works 
> as far as this:
> 
> ### start example
> setClass ("cbtest",
>           representation = representation (data = "data.frame"),
>           prototype = prototype (data = data.frame (spc = I 
> (matrix (rnorm 
> (15) , 3, 5)))
>             )
>  )
> 
> a <- new ("cbtest")
> a
> 
> setMethod("cbind2", signature (x = "cbtest", y  = "cbtest"),
>           function (x, y){
>             x at data$spc <- cbind (x at data$spc, y at data$spc) 
>             x
>           }
>           )
> 
> 
> setMethod("cbind2", signature (x = "cbtest", y = "missing"), 
> function (x, y) 
> x)
> 
> cb.cbind <- function (..., deparse.level){
>   dots <- list (...) 
>   for (i in seq_along (dots)[-1])
>     dots[[1]] <- cbind2 (dots[[1]], dots[[i]])
> 
>   dots[[1]]
> } 
> 
> 
> cbind2 (a, a)
> cb.cbind (a, a, a)
> 
> 
> cbind (a, a, a)
> setGeneric ("cbind", signature = signature("...")) 
> setMethod ("cbind", "cbtest",
>            function (..., deparse.level) cb.cbind (...))
> cbind (a, a, a)
> cbind (a, a, a, deparse.level = 1)
> 
> ### end example
> 
> 
> However, I get the following message:
> with setGeneric 
> 
> Creating a generic for "cbind" in package  ".GlobalEnv"
>     (the supplied definition differs from and overrides the 
> implicit generic in 
> package "base": Signatures differ:  (...), (deparse.level))
> 
> How do I specify the correct signature? 
> 
> Furthermore: as I do not want to do anything with 
> "deparse.level", I'd rather 
> specify it as "missing" in setMethod. But again, I don't get 
> the signature 
> correct.
> 
> I tried 
> setGeneric ("cbind", signature = signature (...="...", 
> deparse.level = 
> "integer"))
> and 
> setGeneric ("cbind", signature = signature ("...", 
> deparse.level = "integer"))
> 
> both give: 
> Fehler in makeGeneric(name, fdef, fdeflt, group = group, valueClass = 
> valueClass,  : 
>   Nicht-Argumente in der Signatur: integer
> 
> What is my mistake?
> 
> Thanks a lot for your help!
> 
> Claudia
> 
> 
> > version
>                _                           
> platform       i486-pc-linux-gnu           
> arch           i486                        
> os             linux-gnu                   
> system         i486, linux-gnu             
> status                                     
> major          2                           
> minor          8.0                         
> year           2008                        
> month          10                          
> day            20                          
> svn rev        46754                       
> language       R                           
> version.string R version 2.8.0 (2008-10-20)
> 
> 
> -- 
> Claudia Beleites
> Dipartimento dei Materiali e delle Risorse Naturali
> Universit? degli Studi di Trieste
> Via Alfonso Valerio 6/a
> I-34127 Trieste
> 
> phone: +39 (0 40) 5 58-34 47
> email: cbeleites at units.it
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> 

**********************************************************************
Please consider the environment before printing this email or its attachments.
The contents of this email are for the named addressees ...{{dropped:19}}


From thomas.baier at logicals.com  Tue Dec 23 17:29:59 2008
From: thomas.baier at logicals.com (Thomas Baier)
Date: Tue, 23 Dec 2008 17:29:59 +0100
Subject: [Rd] rscproxy version conflict
Message-ID: <405593F1A35DDD11B2B4000C29F5CF53034642@exchange-server.ow.ks>

Simon Urbanek wrote:
> FWIW: technically, you don't have to match the patch level version.
> Although default DLL checks usually require perfect match, it should
> be safe to require that R version lies in [x.y.z, x.y+1.0)  where
> x.y.z is the R version that the interfacing DLL was compiled against.
> (And hence it is safe to use R x.y.0 as the base for compilation until
> R x.y+1.0 is released).

The check that has been implemented works as:

  snprintf(Rversion, 25, "%s.%s", R_MAJOR, R_MINOR);
  if(strncmp(getDLLVersion(), Rversion, 25) != 0) {
    ... check failed
  }
  ... check ok

Quoting from http://cran.r-project.org/doc/manuals/R-exts.html

int main (int argc, char **argv)
     {
         structRstart rp;
         Rstart Rp = &rp;
         char Rversion[25], *RHome;
     
         sprintf(Rversion, "%s.%s", R_MAJOR, R_MINOR);
         if(strcmp(getDLLVersion(), Rversion) != 0) {
             fprintf(stderr, "Error: R.DLL version does not match\n");
             exit(1);
         }
  ...

this looks very similar. According to your message, full binary
compatibility is given for same R (major.minor) versions, e.g. 2.8.0 is
fully compatible with 2.8.1, but may not be fully compatible with 2.9.0.

Is there a "compatible DLL version" that can be queried or is using
getDLLVersion() the recommended approach and ignoring everything after the
second '.'?

And if 2.8.0 and 2.8.1 are fully compatible, why is a warning issued, if a
package built with R 2.8.1 is loaded in R 2.8.0?

Thomas


From ripley at stats.ox.ac.uk  Tue Dec 23 19:40:44 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Tue, 23 Dec 2008 18:40:44 +0000 (GMT)
Subject: [Rd] rscproxy version conflict
In-Reply-To: <405593F1A35DDD11B2B4000C29F5CF53034642@exchange-server.ow.ks>
References: <405593F1A35DDD11B2B4000C29F5CF53034642@exchange-server.ow.ks>
Message-ID: <alpine.LFD.2.00.0812231836350.24495@gannet.stats.ox.ac.uk>

On Tue, 23 Dec 2008, Thomas Baier wrote:

> Simon Urbanek wrote:
>> FWIW: technically, you don't have to match the patch level version.
>> Although default DLL checks usually require perfect match, it should
>> be safe to require that R version lies in [x.y.z, x.y+1.0)  where
>> x.y.z is the R version that the interfacing DLL was compiled against.
>> (And hence it is safe to use R x.y.0 as the base for compilation until
>> R x.y+1.0 is released).
>
> The check that has been implemented works as:
>
>  snprintf(Rversion, 25, "%s.%s", R_MAJOR, R_MINOR);
>  if(strncmp(getDLLVersion(), Rversion, 25) != 0) {
>    ... check failed
>  }
>  ... check ok
>
> Quoting from http://cran.r-project.org/doc/manuals/R-exts.html
>
> int main (int argc, char **argv)
>     {
>         structRstart rp;
>         Rstart Rp = &rp;
>         char Rversion[25], *RHome;
>
>         sprintf(Rversion, "%s.%s", R_MAJOR, R_MINOR);
>         if(strcmp(getDLLVersion(), Rversion) != 0) {
>             fprintf(stderr, "Error: R.DLL version does not match\n");
>             exit(1);
>         }
>  ...
>
> this looks very similar. According to your message, full binary
> compatibility is given for same R (major.minor) versions, e.g. 2.8.0 is
> fully compatible with 2.8.1, but may not be fully compatible with 2.9.0.
>
> Is there a "compatible DLL version" that can be queried or is using
> getDLLVersion() the recommended approach and ignoring everything after the
> second '.'?

The latter.  It is expected that the C-level API is compatible 
throughout 2.8.x, but people do use non-API entry points, hence the more 
rigid check in this example.

> And if 2.8.0 and 2.8.1 are fully compatible, why is a warning issued, if a
> package built with R 2.8.1 is loaded in R 2.8.0?

They may not be compatible at R function level: new features are allowed, 
as well as bug fixes which code may rely on.

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From gregor.gorjanc at bfro.uni-lj.si  Tue Dec 23 20:30:12 2008
From: gregor.gorjanc at bfro.uni-lj.si (gregor.gorjanc at bfro.uni-lj.si)
Date: Tue, 23 Dec 2008 20:30:12 +0100 (CET)
Subject: [Rd] Align legend title wish remainder (PR#13415)
Message-ID: <20081223193012.C563D282EFF6@mail.pubhealth.ku.dk>

Full_Name: Gregor Gorjanc
Version: 2.8.0 and above
OS: generic
Submission from: (NULL) (82.192.44.219)


This is just a remainder for a wish to align legend title as 
reported and "solved" at

https://stat.ethz.ch/pipermail/r-devel/2008-December/051642.html

Thanks!

Regards, Gregor


From simon.urbanek at r-project.org  Tue Dec 23 22:45:59 2008
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Tue, 23 Dec 2008 16:45:59 -0500
Subject: [Rd] rscproxy version conflict
In-Reply-To: <405593F1A35DDD11B2B4000C29F5CF53034642@exchange-server.ow.ks>
References: <405593F1A35DDD11B2B4000C29F5CF53034642@exchange-server.ow.ks>
Message-ID: <B291D293-23F7-4095-95EF-3C48525EB603@r-project.org>


On Dec 23, 2008, at 11:29 AM, Thomas Baier wrote:

> Simon Urbanek wrote:
>> FWIW: technically, you don't have to match the patch level version.
>> Although default DLL checks usually require perfect match, it should
>> be safe to require that R version lies in [x.y.z, x.y+1.0)  where
>> x.y.z is the R version that the interfacing DLL was compiled against.
>> (And hence it is safe to use R x.y.0 as the base for compilation  
>> until
>> R x.y+1.0 is released).
>
> The check that has been implemented works as:
>
>  snprintf(Rversion, 25, "%s.%s", R_MAJOR, R_MINOR);
>  if(strncmp(getDLLVersion(), Rversion, 25) != 0) {
>    ... check failed
>  }
>  ... check ok
>
> Quoting from http://cran.r-project.org/doc/manuals/R-exts.html
>
> int main (int argc, char **argv)
>     {
>         structRstart rp;
>         Rstart Rp = &rp;
>         char Rversion[25], *RHome;
>
>         sprintf(Rversion, "%s.%s", R_MAJOR, R_MINOR);
>         if(strcmp(getDLLVersion(), Rversion) != 0) {
>             fprintf(stderr, "Error: R.DLL version does not match\n");
>             exit(1);
>         }
>  ...
>
> this looks very similar. According to your message, full binary
> compatibility is given for same R (major.minor) versions, e.g. 2.8.0  
> is
> fully compatible with 2.8.1, but may not be fully compatible with  
> 2.9.0.
>
> Is there a "compatible DLL version" that can be queried or is using
> getDLLVersion() the recommended approach and ignoring everything  
> after the
> second '.'?
>
> And if 2.8.0 and 2.8.1 are fully compatible, why is a warning  
> issued, if a
> package built with R 2.8.1 is loaded in R 2.8.0?
>

It's ok to use a package built for 2.8.0 in 2.8.1 but not vice versa.  
It is rare, but it has happened before that a bugfix or visibility  
change adds a symbol in x.y.1 that was not there in x.y.0. Then if  
your package checks for that particular feature and uses it you cannot  
use that binary with x.y.0. Again, this is rather rare and you as the  
package author know about it, but to be on the safe side I was  
recommending against that. However, as Brian pointed out this happens  
far more often on the R function level than on the C API level.

(I know about this DLL version check because it was the first change I  
made to JRI since I wasn't willing to release Windows binary some five  
times a year ;)).

Cheers,
Simon


From nakama at ki.rim.or.jp  Thu Dec 25 08:54:37 2008
From: nakama at ki.rim.or.jp (Ei-ji Nakama)
Date: Thu, 25 Dec 2008 16:54:37 +0900
Subject: [Rd] A small miss of PostScript of CJK in current R-devel
Message-ID: <dc41e1260812242354l5e3cb79ayb0159a29d9541db6@mail.gmail.com>

Dear all.

I'm sorry.  I neglected test on CJK.

http://prs.ism.ac.jp/~nakama/working/CIDHexText.patch

now:
103.58 65.52 <302e36> .5 0 0 t

After an patch:
103.58 65.52 <302e36> .5 0 t

Best regards,
-- 
EI-JI Nakama  <nakama (a) ki.rim.or.jp>
"\u4e2d\u9593\u6804\u6cbb"  <nakama (a) ki.rim.or.jp>


From erich.neuwirth at univie.ac.at  Thu Dec 25 12:21:59 2008
From: erich.neuwirth at univie.ac.at (Erich Neuwirth)
Date: Thu, 25 Dec 2008 12:21:59 +0100
Subject: [Rd] rscproxy version conflict
In-Reply-To: <B291D293-23F7-4095-95EF-3C48525EB603@r-project.org>
References: <405593F1A35DDD11B2B4000C29F5CF53034642@exchange-server.ow.ks>
	<B291D293-23F7-4095-95EF-3C48525EB603@r-project.org>
Message-ID: <49536CD7.5030502@univie.ac.at>



Simon Urbanek wrote:
> 
> It's ok to use a package built for 2.8.0 in 2.8.1 but not vice versa. It
> is rare, but it has happened before that a bugfix or visibility change
> adds a symbol in x.y.1 that was not there in x.y.0. Then if your package
> checks for that particular feature and uses it you cannot use that
> binary with x.y.0. Again, this is rather rare and you as the package
> author know about it, but to be on the safe side I was recommending
> against that. However, as Brian pointed out this happens far more often
> on the R function level than on the C API level.
> 
> (I know about this DLL version check because it was the first change I
> made to JRI since I wasn't willing to release Windows binary some five
> times a year ;)).
> 

What happened recently was that R still officially was at 2.8.0,
but the binary Windows packages already were compiled with
RC1 of 2.8.1. So by downloading the official versions of R
and then some packages from CRAN one had a mixture of old R and new
packages which is what you describe as "this should not be done".







-- 
Erich Neuwirth, University of Vienna
Faculty of Computer Science
Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-39464 Fax: +43-1-4277-39459


From therneau at mayo.edu  Thu Dec 25 23:27:31 2008
From: therneau at mayo.edu (Terry Therneau)
Date: Thu, 25 Dec 2008 16:27:31 -0600 (CST)
Subject: [Rd] issue with [[<-Call
Message-ID: <200812252227.mBPMRV2a029495@rocky.mayo.edu>

  The following code works in Splus but not in R

coxph <- function(formula, data, weights, subset, na.action,
	init, control, method= c("efron", "breslow", "exact"),
	singular.ok =TRUE, robust=FALSE,
	model=FALSE, x=FALSE, y=TRUE, ...) {

    method <- match.arg(method)
    Call <- match.call()

    # create a call to model.frame() that contains the formula (required)
    #  and any other of the relevant optional arguments
    # then evaluate it in the proper frame
    temp <- call('model.frame', formula=formula)
    for (i in c("data", "weights", "subset", "na.action")) #add optional args
        if (!is.null(Call[[i]])) temp[[i]] <- Call[[i]]

    if (is.R()) m <- eval(temp, parent.frame())
    else        m <- eval(temp, sys.parent())

---------------------------------

 The problem is that the names ('data', 'weights', etc) do no propogate over
to temp, the new call object.  It looks like an oversight in the replacement 
method.

  Priority: low.  I have other code forms that work in both dialets.
 
  I created this when teaching an internal class on S programming; the goal
was to make what was happening as transparent as possible.  If anyone has
something that they think is even better from a teaching point of view I'd
be delighted to see it.

	Terry T.


From therneau at mayo.edu  Thu Dec 25 23:33:58 2008
From: therneau at mayo.edu (Terry Therneau)
Date: Thu, 25 Dec 2008 16:33:58 -0600 (CST)
Subject: [Rd] BATCH and testing
Message-ID: <200812252233.mBPMXwpb029968@rocky.mayo.edu>

  In a few of my test scripts for the survival code I expect warning messages
(I actually try to trigger a couple).  Using R BATCH infile outfile these
messages don't end up in outfile, where I can compare them to what was
expected.  I don't see an option to change this.
  R < infile >& outfile works.  But is there a way to get it to continue on
after errors?

	Terry T.


From cberry at tajo.ucsd.edu  Fri Dec 26 00:06:45 2008
From: cberry at tajo.ucsd.edu (Charles C. Berry)
Date: Thu, 25 Dec 2008 15:06:45 -0800
Subject: [Rd] issue with [[<-Call
In-Reply-To: <200812252227.mBPMRV2a029495@rocky.mayo.edu>
References: <200812252227.mBPMRV2a029495@rocky.mayo.edu>
Message-ID: <Pine.LNX.4.64.0812251503100.11661@tajo.ucsd.edu>

On Thu, 25 Dec 2008, Terry Therneau wrote:

>  The following code works in Splus but not in R
>
> coxph <- function(formula, data, weights, subset, na.action,
> 	init, control, method= c("efron", "breslow", "exact"),
> 	singular.ok =TRUE, robust=FALSE,
> 	model=FALSE, x=FALSE, y=TRUE, ...) {
>
>    method <- match.arg(method)
>    Call <- match.call()
>
>    # create a call to model.frame() that contains the formula (required)
>    #  and any other of the relevant optional arguments
>    # then evaluate it in the proper frame
>    temp <- call('model.frame', formula=formula)
>    for (i in c("data", "weights", "subset", "na.action")) #add optional args
>        if (!is.null(Call[[i]])) temp[[i]] <- Call[[i]]
>
>    if (is.R()) m <- eval(temp, parent.frame())
>    else        m <- eval(temp, sys.parent())
>
> ---------------------------------
>
> The problem is that the names ('data', 'weights', etc) do no propogate over
> to temp, the new call object.  It looks like an oversight in the replacement
> method.


        if (!is.null(Call[[i]])) temp[ i ] <- Call[[i]]

should do it in R at least.

HTH,

Chuck


>
>  Priority: low.  I have other code forms that work in both dialets.
>
>  I created this when teaching an internal class on S programming; the goal
> was to make what was happening as transparent as possible.  If anyone has
> something that they think is even better from a teaching point of view I'd
> be delighted to see it.
>
> 	Terry T.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

Charles C. Berry                            (858) 534-2098
                                             Dept of Family/Preventive Medicine
E mailto:cberry at tajo.ucsd.edu	            UC San Diego
http://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 92093-0901


From ripley at stats.ox.ac.uk  Fri Dec 26 09:09:24 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 26 Dec 2008 08:09:24 +0000 (GMT)
Subject: [Rd] BATCH and testing
In-Reply-To: <200812252233.mBPMXwpb029968@rocky.mayo.edu>
References: <200812252233.mBPMXwpb029968@rocky.mayo.edu>
Message-ID: <alpine.LFD.2.00.0812260802120.3353@gannet.stats.ox.ac.uk>

On Thu, 25 Dec 2008, Terry Therneau wrote:

>  In a few of my test scripts for the survival code I expect warning messages
> (I actually try to trigger a couple).  Using R BATCH infile outfile these
> messages don't end up in outfile, where I can compare them to what was
> expected.  I don't see an option to change this.

I don't see this:

tystie% cat infile
2+3
warning("test of warning")
4+5

tystie% cat outfile

R version 2.8.1 (2008-12-22)
Copyright (C) 2008 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

   Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 2+3
[1] 5
> warning("test of warning")
Warning message:
test of warning
> 4+5
[1] 9
>
>
> proc.time()
    user  system elapsed
   0.314   0.037   0.346

so the asked-for reproducible example, please.

>  R < infile >& outfile works.

In [t]csh, I presume.  BATCH uses 2>1%, the sh equivalent.

> But is there a way to get it to continue on after errors?

options(error=expression(NULL))

as given in the help for stop().


-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Fri Dec 26 09:30:50 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 26 Dec 2008 08:30:50 +0000 (GMT)
Subject: [Rd] issue with [[<-Call
In-Reply-To: <Pine.LNX.4.64.0812251503100.11661@tajo.ucsd.edu>
References: <200812252227.mBPMRV2a029495@rocky.mayo.edu>
	<Pine.LNX.4.64.0812251503100.11661@tajo.ucsd.edu>
Message-ID: <alpine.LFD.2.00.0812260810590.3353@gannet.stats.ox.ac.uk>

The issue is that you are using [["weights"]] to add an element.  It works 
for existing eleents as well as for [<- and $<-.

However, I would have done this without a loop

 	nm <- c("data", "weights", "subset", "na.action")
 	extras <- nm %in% names(Call)
 	temp[ nm[extras] ] <- Call[extras]

which will also handle adding NULL elements correctly.

And BTW, the (current) R idiom is to use eval.parent(), and lm() shows 
another way to do this that I would see as cleaner.


On Thu, 25 Dec 2008, Charles C. Berry wrote:

> On Thu, 25 Dec 2008, Terry Therneau wrote:
>
>>  The following code works in Splus but not in R
>> 
>> coxph <- function(formula, data, weights, subset, na.action,
>> 	init, control, method= c("efron", "breslow", "exact"),
>> 	singular.ok =TRUE, robust=FALSE,
>> 	model=FALSE, x=FALSE, y=TRUE, ...) {
>>
>>    method <- match.arg(method)
>>    Call <- match.call()
>>
>>    # create a call to model.frame() that contains the formula (required)
>>    #  and any other of the relevant optional arguments
>>    # then evaluate it in the proper frame
>>    temp <- call('model.frame', formula=formula)
>>    for (i in c("data", "weights", "subset", "na.action")) #add optional 
>> args
>>        if (!is.null(Call[[i]])) temp[[i]] <- Call[[i]]
>>
>>    if (is.R()) m <- eval(temp, parent.frame())
>>    else        m <- eval(temp, sys.parent())
>> 
>> ---------------------------------
>> 
>> The problem is that the names ('data', 'weights', etc) do no propogate over
>> to temp, the new call object.  It looks like an oversight in the 
>> replacement
>> method.
>
>
>       if (!is.null(Call[[i]])) temp[ i ] <- Call[[i]]
>
> should do it in R at least.
>
> HTH,
>
> Chuck
>
>
>>
>>  Priority: low.  I have other code forms that work in both dialets.
>>
>>  I created this when teaching an internal class on S programming; the goal
>> was to make what was happening as transparent as possible.  If anyone has
>> something that they think is even better from a teaching point of view I'd
>> be delighted to see it.
>>
>> 	Terry T.
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>
> Charles C. Berry                            (858) 534-2098
>                                            Dept of Family/Preventive 
> Medicine
> E mailto:cberry at tajo.ucsd.edu	            UC San Diego
> http://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 92093-0901
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From simone.giannerini at unibo.it  Fri Dec 26 11:30:19 2008
From: simone.giannerini at unibo.it (Simone Giannerini)
Date: Fri, 26 Dec 2008 11:30:19 +0100
Subject: [Rd] /bin/windows/base/rpatched.html page out of date
Message-ID: <3c12769c0812260230q7e7c8eduf351dc6dae76f371@mail.gmail.com>

Dear all,

it looks like that something is wrong with the
/bin/windows/base/rpatched.html page as it seems pointing to the
2.8.1rc version.
Also, I do not know if it is relevant but notice the dates of the
following files on

ftp://ftp.stat.math.ethz.ch/Software/CRAN/bin/windows/base/

R-2.8.1pat-win32.exe  31963 KB  22/12/2008 16.15.00
R-2.8.1rc-win32.exe    31991 KB  25/12/2008 9.30.00

thank you

Simone

--
______________________________________________________

Simone Giannerini
Dipartimento di Scienze Statistiche "Paolo Fortunati"
Universita' di Bologna
Via delle belle arti 41 - 40126  Bologna,  ITALY
Tel: +39 051 2098262  Fax: +39 051 232153
http://www2.stat.unibo.it/giannerini/


From ripley at stats.ox.ac.uk  Fri Dec 26 12:26:03 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 26 Dec 2008 11:26:03 +0000 (GMT)
Subject: [Rd] /bin/windows/base/rpatched.html page out of date
In-Reply-To: <3c12769c0812260230q7e7c8eduf351dc6dae76f371@mail.gmail.com>
References: <3c12769c0812260230q7e7c8eduf351dc6dae76f371@mail.gmail.com>
Message-ID: <alpine.LFD.2.00.0812261120270.24673@gannet.stats.ox.ac.uk>

We can do nothing about this: that area is managed by Duncan Murdoch (who 
is offline for about a week).

http://cran.r-project.org/bin/windows/  does tell you who to contact.
R-devel is never the right place for question about binary distributions 
(nor for CRAN pages, for which report to the CRAN webmaster).

On Fri, 26 Dec 2008, Simone Giannerini wrote:

> Dear all,
>
> it looks like that something is wrong with the
> /bin/windows/base/rpatched.html page as it seems pointing to the
> 2.8.1rc version.
> Also, I do not know if it is relevant but notice the dates of the
> following files on
>
> ftp://ftp.stat.math.ethz.ch/Software/CRAN/bin/windows/base/
>
> R-2.8.1pat-win32.exe  31963 KB  22/12/2008 16.15.00
> R-2.8.1rc-win32.exe    31991 KB  25/12/2008 9.30.00

That's a mirror of the CRAN master which itself mirrors Duncan Murdoch's 
builds.

> thank you
>
> Simone
>
> --
> ______________________________________________________
>
> Simone Giannerini
> Dipartimento di Scienze Statistiche "Paolo Fortunati"
> Universita' di Bologna
> Via delle belle arti 41 - 40126  Bologna,  ITALY
> Tel: +39 051 2098262  Fax: +39 051 232153
> http://www2.stat.unibo.it/giannerini/
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From therneau at mayo.edu  Fri Dec 26 14:31:11 2008
From: therneau at mayo.edu (Therneau, Terry M., Ph.D.)
Date: Fri, 26 Dec 2008 07:31:11 -0600
Subject: [Rd] issue with [[<-Call
In-Reply-To: <alpine.LFD.2.00.0812260810590.3353@gannet.stats.ox.ac.uk>
Message-ID: <EDFDBF4E8E9AE049A9BB81801F493041271E42@msgebe21.mfad.mfroot.org>

Brian,
 Thanks for the comments.

 -- I agree that the vector form is more compact.  I was using a loop
because I found it to be even more transparent to the class.  For a one
time task such as this efficiency is not an issue.
 -- I'll make use of eval.parent().  I hadn't yet stumbled on that
 -- The code in lm() is almost exactly my "other approach"!  (I doubt
convergent evolution - I must have noticed this example at some past
point).

  I was reasoning in parallel to lists
> temp <- list(a=1:3)
> temp[['b']] <- 5:6
> temp
$a
[1] 1 2 3
$b
[1] 5 6

 and assumed that this should work for call objects.  The informal
"underneath it all, all the language objects are lists" idea, which I
think I absorbed from one of the original Bell Labs books.  I leave it
to the core team to decide if this should be 'fixed'.

	Terry T.


From ripley at stats.ox.ac.uk  Fri Dec 26 15:32:11 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Fri, 26 Dec 2008 14:32:11 +0000 (GMT)
Subject: [Rd] issue with [[<-Call
In-Reply-To: <EDFDBF4E8E9AE049A9BB81801F493041271E42@msgebe21.mfad.mfroot.org>
References: <EDFDBF4E8E9AE049A9BB81801F493041271E42@msgebe21.mfad.mfroot.org>
Message-ID: <alpine.LFD.2.00.0812261427570.31671@gannet.stats.ox.ac.uk>

On Fri, 26 Dec 2008, Therneau, Terry M., Ph.D. wrote:

> Brian,
> Thanks for the comments.
>
> -- I agree that the vector form is more compact.  I was using a loop
> because I found it to be even more transparent to the class.  For a one
> time task such as this efficiency is not an issue.
> -- I'll make use of eval.parent().  I hadn't yet stumbled on that
> -- The code in lm() is almost exactly my "other approach"!  (I doubt
> convergent evolution - I must have noticed this example at some past
> point).
>
>  I was reasoning in parallel to lists
>> temp <- list(a=1:3)
>> temp[['b']] <- 5:6
>> temp
> $a
> [1] 1 2 3
> $b
> [1] 5 6
>
> and assumed that this should work for call objects.  The informal
> "underneath it all, all the language objects are lists" idea, which I
> think I absorbed from one of the original Bell Labs books.  I leave it
> to the core team to decide if this should be 'fixed'.

Yes, that is true in S, but in R they are pairlists. The reason [<- works 
is that it converts the pairlist to a list and back again.  Names 
(stricty, 'tags') on pairlists are something of a pain, but I have 
already fixed up this case: some more complex ones remain unfixed.

>
> 	Terry T.
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From agalecki at umich.edu  Wed Dec 24 19:30:14 2008
From: agalecki at umich.edu (agalecki at umich.edu)
Date: Wed, 24 Dec 2008 19:30:14 +0100 (CET)
Subject: [Rd] Variogram.gls (PR#13418)
Message-ID: <20081224183014.B98AC282EFF6@mail.pubhealth.ku.dk>

Hello,

1. Illustrating example:
    sessionInfo at the end of this email

library(nlme)
fm1 <- gls(weight ~ Time * Diet, BodyWeight)
Variogram(fm1, form = ~ Time | Rat)[1:10,]

Error in FUN(X[[1L]], ...) : unused argument(s) (method = "euclidean")

2. It appears that the error is caused by the statement:

distance <- lapply(covar, function(el, metric) dist(as.matrix(el),
                  metric), method = metric)

in Variogram.gls() method

3. After replacing the statement in question with:
 
distance <- lapply(covar, function(el) dist(as.matrix(el), metric)) 

Variogram.gls  appears to work properly as shown below.

library(nlme)
fm1 <- gls(weight ~ Time * Diet, BodyWeight)
Variogram(fm1, form = ~ Time | Rat)[1:10,]

        variog dist n.pairs
1  0.007239522    1      16
2  0.014584634    6      16
3  0.014207936    7     144
4  0.018442267    8      16
5  0.011128505   13      16
6  0.019910082   14     128
7  0.027072311   15      16
8  0.034140379   20      16
9  0.028320657   21     112
10 0.037525507   22      16

Happy Holiday Season and Happy New Year

Andrzej Galecki
University of Michigan



 > sessionInfo()
R version 2.7.2 (2008-08-25)
i386-pc-mingw32

locale:
LC_COLLATE=English_United States.1252;LC_CTYPE=English_United 
States.1252;LC_MONETARY=English_United 
States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] nlme_3.1-89

loaded via a namespace (and not attached):
[1] grid_2.7.2      lattice_0.17-13 tools_2.7.2


From marcthibault at tanda.on.ca  Thu Dec 25 02:50:06 2008
From: marcthibault at tanda.on.ca (marcthibault at tanda.on.ca)
Date: Thu, 25 Dec 2008 02:50:06 +0100 (CET)
Subject: [Rd] Acessing pdf help files (PR#13419)
Message-ID: <20081225015006.A459E282EFF6@mail.pubhealth.ku.dk>

Full_Name: Marc Thibault
Version: 2.8.1
OS: Windows XP Pro SP2
Submission from: (NULL) (216.104.125.106)


I had Adobe Acrobat 5 and Adobe Reader 9 installed. The .pdf "open" association
is to Reader. 

When I selected "Help | Manuals(in pdf) | An Introduction to R", it brought up
the file in Acrobat instead of Reader. After making sure the default
associations were correctly pointing to Reader, I took the extreme step of
uninstalling Acrobat. Now when I try the same thing, R responds with "Error:
access to 'doc\manual\R-intro.pdf' denied." Outside of R, double clicking the
file brings it up in Reader as it should. Asking for HTML help works fine, so
access to doc\ hasn't really been lost.

It seems that R picks up a reference to the pdf reader at installation time,
doesn't do it right, and refuses to let go. On the other hand, reinstalling R
didn't fix the problem.


From murdoch at stats.uwo.ca  Sat Dec 27 00:36:28 2008
From: murdoch at stats.uwo.ca (Duncan Murdoch)
Date: Fri, 26 Dec 2008 18:36:28 -0500
Subject: [Rd] Acessing pdf help files (PR#13419)
In-Reply-To: <20081225015006.A459E282EFF6@mail.pubhealth.ku.dk>
References: <20081225015006.A459E282EFF6@mail.pubhealth.ku.dk>
Message-ID: <49556A7C.4010107@stats.uwo.ca>

marcthibault at tanda.on.ca wrote:
> Full_Name: Marc Thibault
> Version: 2.8.1
> OS: Windows XP Pro SP2
> Submission from: (NULL) (216.104.125.106)
>
>
> I had Adobe Acrobat 5 and Adobe Reader 9 installed. The .pdf "open" association
> is to Reader. 
>
> When I selected "Help | Manuals(in pdf) | An Introduction to R", it brought up
> the file in Acrobat instead of Reader. After making sure the default
> associations were correctly pointing to Reader, I took the extreme step of
> uninstalling Acrobat. Now when I try the same thing, R responds with "Error:
> access to 'doc\manual\R-intro.pdf' denied." Outside of R, double clicking the
> file brings it up in Reader as it should. Asking for HTML help works fine, so
> access to doc\ hasn't really been lost.
>
> It seems that R picks up a reference to the pdf reader at installation time,
> doesn't do it right, and refuses to let go. On the other hand, reinstalling R
> didn't fix the problem.
>   

R uses the Windows ShellExecute function to "open" the file, so if 
that's not working, there's not much we can do about it.  You can see 
the association in the registry, probably under 
HKEY_CLASSES_ROOT\AcroExch.Document\shell\Open (though I don't have the 
same Acrobat versions as you, so I can't be sure). 

Duncan Murdoch


From ggrothendieck at gmail.com  Sat Dec 27 00:44:53 2008
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Fri, 26 Dec 2008 18:44:53 -0500
Subject: [Rd] Acessing pdf help files (PR#13419)
In-Reply-To: <20081225015006.A459E282EFF6@mail.pubhealth.ku.dk>
References: <20081225015006.A459E282EFF6@mail.pubhealth.ku.dk>
Message-ID: <971536df0812261544p180e696fp20926d9b7ae6313d@mail.gmail.com>

>From the Windows (not R) command line try this (the input you
type is after the > and the output is on the next line).  Modify
the ftype line appropriately if the output of assoc is different for you.

C:\tmp2>assoc .pdf
.pdf=AcroExch.Document

C:\tmp2>ftype AcroExch.Document
AcroExch.Document="C:\Program Files\Adobe\Reader 8.0\Reader\AcroRd32.exe" "%1"



On Wed, Dec 24, 2008 at 8:50 PM,  <marcthibault at tanda.on.ca> wrote:
> Full_Name: Marc Thibault
> Version: 2.8.1
> OS: Windows XP Pro SP2
> Submission from: (NULL) (216.104.125.106)
>
>
> I had Adobe Acrobat 5 and Adobe Reader 9 installed. The .pdf "open" association
> is to Reader.
>
> When I selected "Help | Manuals(in pdf) | An Introduction to R", it brought up
> the file in Acrobat instead of Reader. After making sure the default
> associations were correctly pointing to Reader, I took the extreme step of
> uninstalling Acrobat. Now when I try the same thing, R responds with "Error:
> access to 'doc\manual\R-intro.pdf' denied." Outside of R, double clicking the
> file brings it up in Reader as it should. Asking for HTML help works fine, so
> access to doc\ hasn't really been lost.
>
> It seems that R picks up a reference to the pdf reader at installation time,
> doesn't do it right, and refuses to let go. On the other hand, reinstalling R
> didn't fix the problem.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From olafm at kimberly.tako.de  Sat Dec 27 01:38:44 2008
From: olafm at kimberly.tako.de (Olaf Mersmann)
Date: Sat, 27 Dec 2008 01:38:44 +0100
Subject: [Rd] Patch to fix small bug in do_External and do_dotcall
Message-ID: <1230337825-sup-1196@bloxx.plex>

I've stumbled upon a small bug/inconsitency in do_External and do_dotcall:

Here's an example:

  % LC_ALL=C R  --vanilla < symname-bug.R    

  R version 2.8.0 (2008-10-20)
  *snip*
  > options(error=expression(0))
  > ## Call 'R_GD_nullDevice' with incorrect parameter count:
  > .Call("R_GD_nullDevice", 1)
  Error in .Call("R_GD_nullDevice", 1) : 
    Incorrect number of arguments (1), expecting 0 for R_GD_nullDevice
  > 
  > ## Same call made via a NativeSymbolInfo object:
  > sym <- getDLLRegisteredRoutines("grDevices")$.Call[["R_GD_nullDevice"]]
  > .Call(sym$address, 1)
  Error: 'getEncChar' must be called on a CHARSXP

The error stems from the fact, that both do_External and do_dotcall
expect CAR(args) to be a string, while it might be a NativeSymbolInfo
object. checkValidSymbolId() already handles this, so the fix is to
use the symbol name returned from resolveNativeRoutine().

After applying the attached patch (against R-trunk revision 47348) the
output looks like this:

  % LC_ALL=C bin/R  --vanilla < symname-bug.R
  
  R version 2.9.0 Under development (unstable) (2008-12-26 r47348)
  *snip*
  > options(error=expression(0))
  > ## Call 'R_GD_nullDevice' with incorrect parameter count:
  > .Call("R_GD_nullDevice", 1)
  Error in .Call("R_GD_nullDevice", 1) : 
    Incorrect number of arguments (1), expecting 0 for R_GD_nullDevice
  > 
  > ## Same call made via a NativeSymbolInfo object:
  > sym <- getDLLRegisteredRoutines("grDevices")$.Call[["R_GD_nullDevice"]]
  > .Call(sym$address, 1)
  Error in .Call(sym$address, 1) : 
    Incorrect number of arguments (1), expecting 0 for R_GD_nullDevice

Greetings from Dortmund
Olaf

From ripley at stats.ox.ac.uk  Sat Dec 27 06:59:24 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 27 Dec 2008 05:59:24 +0000 (GMT)
Subject: [Rd] Patch to fix small bug in do_External and do_dotcall
In-Reply-To: <1230337825-sup-1196@bloxx.plex>
References: <1230337825-sup-1196@bloxx.plex>
Message-ID: <alpine.LFD.2.00.0812270557360.20482@gannet.stats.ox.ac.uk>

Thank you, but can we see the patch please (no attachement arrived)?

On Sat, 27 Dec 2008, Olaf Mersmann wrote:

> I've stumbled upon a small bug/inconsitency in do_External and do_dotcall:
>
> Here's an example:
>
>  % LC_ALL=C R  --vanilla < symname-bug.R
>
>  R version 2.8.0 (2008-10-20)
>  *snip*
>  > options(error=expression(0))
>  > ## Call 'R_GD_nullDevice' with incorrect parameter count:
>  > .Call("R_GD_nullDevice", 1)
>  Error in .Call("R_GD_nullDevice", 1) :
>    Incorrect number of arguments (1), expecting 0 for R_GD_nullDevice
>  >
>  > ## Same call made via a NativeSymbolInfo object:
>  > sym <- getDLLRegisteredRoutines("grDevices")$.Call[["R_GD_nullDevice"]]
>  > .Call(sym$address, 1)
>  Error: 'getEncChar' must be called on a CHARSXP
>
> The error stems from the fact, that both do_External and do_dotcall
> expect CAR(args) to be a string, while it might be a NativeSymbolInfo
> object. checkValidSymbolId() already handles this, so the fix is to
> use the symbol name returned from resolveNativeRoutine().
>
> After applying the attached patch (against R-trunk revision 47348) the
> output looks like this:
>
>  % LC_ALL=C bin/R  --vanilla < symname-bug.R
>
>  R version 2.9.0 Under development (unstable) (2008-12-26 r47348)
>  *snip*
>  > options(error=expression(0))
>  > ## Call 'R_GD_nullDevice' with incorrect parameter count:
>  > .Call("R_GD_nullDevice", 1)
>  Error in .Call("R_GD_nullDevice", 1) :
>    Incorrect number of arguments (1), expecting 0 for R_GD_nullDevice
>  >
>  > ## Same call made via a NativeSymbolInfo object:
>  > sym <- getDLLRegisteredRoutines("grDevices")$.Call[["R_GD_nullDevice"]]
>  > .Call(sym$address, 1)
>  Error in .Call(sym$address, 1) :
>    Incorrect number of arguments (1), expecting 0 for R_GD_nullDevice
>
> Greetings from Dortmund
> Olaf
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From ripley at stats.ox.ac.uk  Sat Dec 27 07:11:56 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sat, 27 Dec 2008 06:11:56 +0000 (GMT)
Subject: [Rd] Variogram.gls (PR#13418)
In-Reply-To: <20081224183014.B98AC282EFF6@mail.pubhealth.ku.dk>
References: <20081224183014.B98AC282EFF6@mail.pubhealth.ku.dk>
Message-ID: <alpine.LFD.2.00.0812270559310.20482@gannet.stats.ox.ac.uk>

It seems this was intended to be

                 distance <- lapply(covar,
                                    function(el, metric) dist(as.matrix(el), method=metric),
                                    metric = metric)

similarly to Variogram.lme.

Thank you for the report: it will be fixed in the next release of nlme.


On Wed, 24 Dec 2008, agalecki at umich.edu wrote:

> Hello,
>
> 1. Illustrating example:
>    sessionInfo at the end of this email
>
> library(nlme)
> fm1 <- gls(weight ~ Time * Diet, BodyWeight)
> Variogram(fm1, form = ~ Time | Rat)[1:10,]
>
> Error in FUN(X[[1L]], ...) : unused argument(s) (method = "euclidean")
>
> 2. It appears that the error is caused by the statement:
>
> distance <- lapply(covar, function(el, metric) dist(as.matrix(el),
>                  metric), method = metric)
>
> in Variogram.gls() method
>
> 3. After replacing the statement in question with:
>
> distance <- lapply(covar, function(el) dist(as.matrix(el), metric))
>
> Variogram.gls  appears to work properly as shown below.
>
> library(nlme)
> fm1 <- gls(weight ~ Time * Diet, BodyWeight)
> Variogram(fm1, form = ~ Time | Rat)[1:10,]
>
>        variog dist n.pairs
> 1  0.007239522    1      16
> 2  0.014584634    6      16
> 3  0.014207936    7     144
> 4  0.018442267    8      16
> 5  0.011128505   13      16
> 6  0.019910082   14     128
> 7  0.027072311   15      16
> 8  0.034140379   20      16
> 9  0.028320657   21     112
> 10 0.037525507   22      16
>
> Happy Holiday Season and Happy New Year
>
> Andrzej Galecki
> University of Michigan
>
>
>
> > sessionInfo()
> R version 2.7.2 (2008-08-25)
> i386-pc-mingw32
>
> locale:
> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United
> States.1252;LC_MONETARY=English_United
> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] nlme_3.1-89
>
> loaded via a namespace (and not attached):
> [1] grid_2.7.2      lattice_0.17-13 tools_2.7.2
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From olafm at kimberly.tako.de  Sat Dec 27 08:58:08 2008
From: olafm at kimberly.tako.de (Olaf Mersmann)
Date: Sat, 27 Dec 2008 08:58:08 +0100
Subject: [Rd] Patch to fix small bug in do_External and do_dotcall
In-Reply-To: <alpine.LFD.2.00.0812270557360.20482@gannet.stats.ox.ac.uk>
References: <1230337825-sup-1196@bloxx.plex>
	<alpine.LFD.2.00.0812270557360.20482@gannet.stats.ox.ac.uk>
Message-ID: <1230364508-sup-6742@bloxx.plex>

Excerpts from Prof Brian Ripley's message of Sat Dec 27 06:59:24 +0100 2008:
> Thank you, but can we see the patch please (no attachement arrived)?

I've posted them online:

  http://www.statistik.tu-dortmund.de/~olafm/files/symname-bug.R
  http://www.statistik.tu-dortmund.de/~olafm/files/symname-bug.patch

Sorry for the inconvenience, not sure why the attachments got lost.

Greetings from Dortmund,
Olaf


From ripley at stats.ox.ac.uk  Sun Dec 28 15:03:28 2008
From: ripley at stats.ox.ac.uk (Prof Brian Ripley)
Date: Sun, 28 Dec 2008 14:03:28 +0000 (GMT)
Subject: [Rd] Patch to fix small bug in do_External and do_dotcall
In-Reply-To: <1230364508-sup-6742@bloxx.plex>
References: <1230337825-sup-1196@bloxx.plex>
	<alpine.LFD.2.00.0812270557360.20482@gannet.stats.ox.ac.uk>
	<1230364508-sup-6742@bloxx.plex>
Message-ID: <alpine.LFD.2.00.0812281359070.2543@gannet.stats.ox.ac.uk>

Thank you.  You do realize that your example is not passing a 
NativeSymbolInfo object, don't you?  I believe the intention is that you 
pass 'sym'.

I'll incoporate the patch once I have worked out an accuracy description 
of what it does ....

On Sat, 27 Dec 2008, Olaf Mersmann wrote:

> Excerpts from Prof Brian Ripley's message of Sat Dec 27 06:59:24 +0100 2008:
>> Thank you, but can we see the patch please (no attachement arrived)?
>
> I've posted them online:
>
>  http://www.statistik.tu-dortmund.de/~olafm/files/symname-bug.R
>  http://www.statistik.tu-dortmund.de/~olafm/files/symname-bug.patch
>
> Sorry for the inconvenience, not sure why the attachments got lost.

See the posting guide for what attachments will not be stripped.

> Greetings from Dortmund,
> Olaf
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Brian D. Ripley,                  ripley at stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272866 (PA)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


From olafm at kimberly.tako.de  Sun Dec 28 17:36:17 2008
From: olafm at kimberly.tako.de (Olaf Mersmann)
Date: Sun, 28 Dec 2008 17:36:17 +0100
Subject: [Rd] Patch to fix small bug in do_External and do_dotcall
In-Reply-To: <alpine.LFD.2.00.0812281359070.2543@gannet.stats.ox.ac.uk>
References: <1230337825-sup-1196@bloxx.plex>
	<alpine.LFD.2.00.0812270557360.20482@gannet.stats.ox.ac.uk>
	<1230364508-sup-6742@bloxx.plex>
	<alpine.LFD.2.00.0812281359070.2543@gannet.stats.ox.ac.uk>
Message-ID: <1230480451-sup-1700@bloxx.rothe>

Excerpts from Prof Brian Ripley's message of Sun Dec 28 15:03:28 +0100 2008:
> Thank you.  You do realize that your example is not passing a 
> NativeSymbolInfo object, don't you?  I believe the intention is that you 
> pass 'sym'.

Yes, I had originally used sym and later changed it to sym$address to
verify, that the fix also works for case b) described in the comment
above checkValidSymboldId(), namly passing in a pointer to a
function. I'm not sure if this is currently a 'supported' method of
calling a function, since it is only mentioned in the man page for
getNativeSymbolInfo() and not in the .Call() man page.

> I'll incoporate the patch once I have worked out an accuracy description 
> of what it does ....

The behavior before the patch is to assume that the head of args is a
string. When it is anything else, the call to translateChar() when
deriving the function name for the error message fails.

Instead of dealing with each possible type, the patch reuses the
function name that was returned by resolveNativeRoutine() which in
turn calls checkValidSymbolId() (all defined in dotcode.c). If
CAR(args) is a string, checkValidSymboldId simply returns and
resolveNativeRoutine() copies the name into buf. If CAR(args) is a
NativeSymbolInfo object, checkValidSymbolId() recalls itself with the
second element of the NativeSymbolInfo object (its address
member). Lastly if CAR(args) is a EXTRPTRSXP (the type of the address
member of a NativeSymbolInfo object) checkValidSymboldId() extracts
the symbol name from the EXTPTRSXP if it is a registered symbol. This
is the only loophole. If I where to pass an address to .Call() or
.External() which was a "native symbol" but not a "registered native
symbol", the buffer holding the function name would never be
filled. I'm not sure how to deal with this corner case. One option
would be to copy some (un)descriptive like '<Unknwon>' into the
buffer. If this is acceptable I can add it and post a revised patch.

Greetings from Dortmund
Olaf Mersmann


From huber at ebi.ac.uk  Mon Dec 29 23:53:50 2008
From: huber at ebi.ac.uk (Wolfgang Huber)
Date: Mon, 29 Dec 2008 22:53:50 +0000
Subject: [Rd] How to add a slot to S4 class of an existing package?
In-Reply-To: <494FECF9.2020301@aon.at>
References: <494FECF9.2020301@aon.at>
Message-ID: <495954FE.6070401@ebi.ac.uk>

Dear Christian

this post from Martin Morgan on class versioning in Bioconductor's 
Biobase package might be relevant:
https://stat.ethz.ch/pipermail/bioc-devel/2006-May/000545.html
and also section 6 of this:
http://www.bioconductor.org/packages/2.4/bioc/vignettes/Biobase/inst/doc/BiobaseDevelopment.pdf

	Best wishes
	Wolfgang

----------------------------------------------------
Wolfgang Huber  EMBL-EBI  http://www.ebi.ac.uk/huber

cstrato wrote:
> Dear all,
> 
> Since my package is based on S4 classes, I would like to know how to add 
> a slot to an existing S4 class without breaking the code of users of my 
> package.
> 
> Assume the following S4 class:
> setClass("MyClass",
>   representation(name = "character",
>                  type = "character",
>                  data = "data.frame"
>   ),
>   prototype(name = "",
>             type = "Default",
>             data = data.frame(matrix(nr=0,nc=0))
>   )
> )#MyClass
> 
> Assume that a user has created an object:
>  > myclass <- new("MyClass", name="MyName", type="MyType", data=tmp)
>  > str(myclass)
> 
> 
> Now I would like to add another slot "info" to MyClass:
> setClass("MyClass",
>   representation(name = "character",
>                  type = "character",
>                  data = "data.frame",
>                  info = "data.frame"
>   ),
>   prototype(name = "",
>             type = "Default",
>             data = data.frame(matrix(nr=0,nc=0)),
>             info = data.frame(matrix(nr=0,nc=0))
>   )
> )#MyClass
> 
> Now when the user loads my package with S4 class MyClass containing a 
> new slot and calls:
>  > str(myclass)
> Error in FUN(c("name", "type", "data", "info")[[4L]], ...) :
>  no slot of name "info" for this object of class "MyClass"
>  >
> 
> My question is:
> Is there any possibility or special trick, which would avoid this error 
> message?
> 
> Are there other possibilities to access an additional data.frame from an 
> existing class?
> 
> Is there something like an "evolution" of S4 classes, which 
> distinguishes the different implementations of an S4 class, and allows 
> the user to keep the object of an old class?
> 
> Best regards
> Christian
> _._._._._._._._._._._._._._._._._._
> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
> V.i.e.n.n.a           A.u.s.t.r.i.a
> e.m.a.i.l:        cstrato at aon.at
> _._._._._._._._._._._._._._._._._._
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From cstrato at aon.at  Tue Dec 30 00:33:06 2008
From: cstrato at aon.at (cstrato)
Date: Tue, 30 Dec 2008 00:33:06 +0100
Subject: [Rd] How to add a slot to S4 class of an existing package?
In-Reply-To: <495954FE.6070401@ebi.ac.uk>
References: <494FECF9.2020301@aon.at> <495954FE.6070401@ebi.ac.uk>
Message-ID: <49595E32.90805@aon.at>

Dear Wolfgang

Thank you very much for pointing me to this link, in principle this 
would answer my question: Method updateObject() of package Biobase would 
be exactly what I am looking for. However, I have hoped that maybe there 
is also a solution for S4 classes in general.

Somehow I feel that package Biobase has solved a couple of shortcomings 
of S4 classes. People may not agree with me but I think that method 
"updateObject()" should belong to package "methods" so that every S4 
class can profit from it.

Nevertheless, thank you once again, I will have a look at the code of 
package Biobase.

Best regards and Happy New Year
Christian

Wolfgang Huber wrote:
> Dear Christian
>
> this post from Martin Morgan on class versioning in Bioconductor's 
> Biobase package might be relevant:
> https://stat.ethz.ch/pipermail/bioc-devel/2006-May/000545.html
> and also section 6 of this:
> http://www.bioconductor.org/packages/2.4/bioc/vignettes/Biobase/inst/doc/BiobaseDevelopment.pdf 
>
>
>     Best wishes
>     Wolfgang
>
> ----------------------------------------------------
> Wolfgang Huber  EMBL-EBI  http://www.ebi.ac.uk/huber
>
> cstrato wrote:
>> Dear all,
>>
>> Since my package is based on S4 classes, I would like to know how to 
>> add a slot to an existing S4 class without breaking the code of users 
>> of my package.
>>
>> Assume the following S4 class:
>> setClass("MyClass",
>>   representation(name = "character",
>>                  type = "character",
>>                  data = "data.frame"
>>   ),
>>   prototype(name = "",
>>             type = "Default",
>>             data = data.frame(matrix(nr=0,nc=0))
>>   )
>> )#MyClass
>>
>> Assume that a user has created an object:
>>  > myclass <- new("MyClass", name="MyName", type="MyType", data=tmp)
>>  > str(myclass)
>>
>>
>> Now I would like to add another slot "info" to MyClass:
>> setClass("MyClass",
>>   representation(name = "character",
>>                  type = "character",
>>                  data = "data.frame",
>>                  info = "data.frame"
>>   ),
>>   prototype(name = "",
>>             type = "Default",
>>             data = data.frame(matrix(nr=0,nc=0)),
>>             info = data.frame(matrix(nr=0,nc=0))
>>   )
>> )#MyClass
>>
>> Now when the user loads my package with S4 class MyClass containing a 
>> new slot and calls:
>>  > str(myclass)
>> Error in FUN(c("name", "type", "data", "info")[[4L]], ...) :
>>  no slot of name "info" for this object of class "MyClass"
>>  >
>>
>> My question is:
>> Is there any possibility or special trick, which would avoid this 
>> error message?
>>
>> Are there other possibilities to access an additional data.frame from 
>> an existing class?
>>
>> Is there something like an "evolution" of S4 classes, which 
>> distinguishes the different implementations of an S4 class, and 
>> allows the user to keep the object of an old class?
>>
>> Best regards
>> Christian
>> _._._._._._._._._._._._._._._._._._
>> C.h.r.i.s.t.i.a.n   S.t.r.a.t.o.w.a
>> V.i.e.n.n.a           A.u.s.t.r.i.a
>> e.m.a.i.l:        cstrato at aon.at
>> _._._._._._._._._._._._._._._._._._
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


