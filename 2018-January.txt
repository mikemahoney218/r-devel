From tomas.kalibera at gmail.com  Tue Jan  2 12:17:44 2018
From: tomas.kalibera at gmail.com (Tomas Kalibera)
Date: Tue, 2 Jan 2018 12:17:44 +0100
Subject: [Rd] Wish List: base::source() + Add Execution Time Argument
In-Reply-To: <CAD6tx95qxS3+xc3M_j-yVLdOt5pQP-uK9JqVhU1iZYBg66Se3A@mail.gmail.com>
References: <CANNd7=mvnfnuYHDfxog-bSLkKnG_AiMcmTj7p7GOj_hh_D5VYw@mail.gmail.com>
 <CAF8bMca=5KcNt=2=ybsr+fP3L447xjCq2H2okKHU-zoibc2xFQ@mail.gmail.com>
 <CAD6tx95qxS3+xc3M_j-yVLdOt5pQP-uK9JqVhU1iZYBg66Se3A@mail.gmail.com>
Message-ID: <2ec86d19-891b-f5fe-3ba1-ad823534d455@gmail.com>

There is a simple way to achieve something similar: one can add a time 
stamp to each line of output, e.g. using "ts" command from "moreutils".

Tomas

On 12/21/2017 06:45 PM, Jim Hester wrote:
> R does provide the addTaskCallback / taskCallbackManager to run a
> callback function after every top level command. However there is not
> an equivalent interface that would be run _before_ each command, which
> would make it possible to time of top level calls and provide other
> execution measurements.
>
> On Thu, Dec 21, 2017 at 11:31 AM, William Dunlap via R-devel
> <r-devel at r-project.org> wrote:
>> Is source() the right place for this?  It may be, but we've had customers
>> who would like
>> this sort of thing done for commands entered by hand.  And there are those
>> who want
>> a description of any "non-triivial" objects created in .GlobalEnv by each
>> expression, ...
>> Do they need a way to wrap each expression evaluated in envir=.GlobalEnv
>> with a
>> function of their choice, one that would print times, datasets created,
>> etc.?
>>
>> Bill Dunlap
>> TIBCO Software
>> wdunlap tibco.com
>>
>> On Thu, Dec 21, 2017 at 3:46 AM, Juan Telleria <jtelleriar at gmail.com> wrote:
>>
>>> Dear R Developers,
>>>
>>> Adding to source() base function a Timer which indicates the execution time
>>> of the source code would be a very well welcome feature, and in my opinion
>>> not difficult to implement as an additional funtion argument.
>>>
>>> The source(timing = TRUE) function shall execute internally the following
>>> code for each statement:
>>>
>>> old <- Sys.time() # get start time at the beginning of source()
>>> # source code
>>> # print elapsed time
>>> new <- Sys.time() - old # calculate difference
>>> print(new) # print in nice format
>>>
>>> Thank you.
>>>
>>> Kind regards,
>>>
>>> Juan Telleria
>>>
>>>          [[alternative HTML version deleted]]
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>          [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From epatters at stanford.edu  Wed Jan  3 01:19:20 2018
From: epatters at stanford.edu (Evan James Patterson)
Date: Wed, 3 Jan 2018 00:19:20 +0000
Subject: [Rd] Coping with non-standard evaluation in R program analysis
Message-ID: <DM5PR02MB2860748944E8E439755AB2EAA7190@DM5PR02MB2860.namprd02.prod.outlook.com>

Hello R experts,


I plan to develop a tool for dynamic analysis of R programs. I would like to trace function calls at runtime, capturing argument and return values. Following a suggestion made some time ago on this list, my high-level implementation strategy is to rewrite the AST, augmenting call expressions with pre-call and post-call shims to capture the arguments and return value, respectively.


I can think of only one fundamental conceptual obstacle to this approach: R functions are not necessarily referentially transparent. The arguments received by a function are not values but promises. They can be evaluated directly ("standard evaluation"), after applying arbitrary syntactic transformations ("non-standard evaluation", aka NSE), or not at all. Therefore, if you peek at the values of function arguments before evaluating the function, you risk altering the semantics of the program, possibly fatally.


I'm looking for general advice about how to cope with NSE in this context. I also have some specific questions:


1) Is it possible to determine whether a given function (primitive, in R, or external) uses NSE on some or all of its arguments?


2) Is it possible to inspect the promise objects received by functions, say to determine whether they have been evaluated, without actually evaluating them? The R manual is not encouraging in this area:


https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Promise-objects


Thank you,


Evan


	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Thu Jan  4 00:11:26 2018
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Thu, 4 Jan 2018 00:11:26 +0100
Subject: [Rd] R CMD check warning about compiler warning flags
In-Reply-To: <CANNd7=khkFCXOE1o8vd_er_ZvdOePryW7AwvKk9VQSgDQTPEAA@mail.gmail.com>
References: <CAFOpNVGKQjffBAF0+yJL7jFh7z7zDj+VsQAqnjXDjM9ZWE02Gg@mail.gmail.com>
 <18c039b2-7b26-2792-565b-f305bae51938@stats.ox.ac.uk>
 <CAFOpNVE-sX3kwPTzcLVY6p6xkQAo8UJJN=bBa6f6_1+kKgV7-g@mail.gmail.com>
 <360d5f57-3512-9efd-de74-38db1c536c68@gmail.com>
 <23101.4830.979381.386647@stat.math.ethz.ch>
 <A9377D4E-29FE-4CFA-8624-3A4643440F3B@me.com>
 <7ca2313a-2143-3d8f-eade-cbb0e6cb6132@gmail.com>
 <CALEXWq2To4hZm9zWauxmg9dd=XGPJccnKKvHX5p67N5KMjBJNg@mail.gmail.com>
 <9b0f83e3-a2d9-7988-dc89-3b2e034b8763@gmail.com>
 <CANNd7=nywaFfrecRtOP2yS4BEg2im_tP2WMN2qig1FEHpZzNvw@mail.gmail.com>
 <CAPtbhHwR-vtjRqtRgSfz4jPHS2m2u02JBcJxwwuKoejawLOW3Q@mail.gmail.com>
 <CANNd7==xYZzmwLfC_FWpHJ+FVmSmDSzQA4vxv_17nocOFbAUxw@mail.gmail.com>
 <CANNd7=khkFCXOE1o8vd_er_ZvdOePryW7AwvKk9VQSgDQTPEAA@mail.gmail.com>
Message-ID: <c4d86c1b-9285-078a-9f4c-d9cc3e478798@statistik.tu-dortmund.de>



On 26.12.2017 00:45, Juan Telleria wrote:
> However, and hope not to be off-topic, a git repository (github, gitlab,
> codeplex, etc., not just solely github) could constitute a tidy approach,
> and make things easier to R Core :)
> 
> By putting the focus on version control, the line of changes made with each
> commit (With the possibility to reverse changes), and not verbose e-mails.

That works well with svn, and we have the sequential labels which are 
e.g. important for bisecting changes.
I do not see how I can find this out with git easily.

Best,
Uwe Ligges



> Juan
> 
> I strongly disagree. Are you aware that github is a commercial
>>> company, github inc. [1] ?
>>> What about gitlab? or Microsoft's codeplex? There are other services
>>> similar to github, why github?
>>> What happens if github goes out of business?
>>>
>>> R-project should be maintained in the academic network and under
>>> auspices of universities.
>>>
>>>
>>>   [*]  GitHub, Inc.
>>>         https://en.wikipedia.org/wiki/GitHub
>>>
>>
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From murdoch.duncan at gmail.com  Thu Jan  4 00:49:42 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 3 Jan 2018 18:49:42 -0500
Subject: [Rd] R CMD check warning about compiler warning flags
In-Reply-To: <c4d86c1b-9285-078a-9f4c-d9cc3e478798@statistik.tu-dortmund.de>
References: <CAFOpNVGKQjffBAF0+yJL7jFh7z7zDj+VsQAqnjXDjM9ZWE02Gg@mail.gmail.com>
 <18c039b2-7b26-2792-565b-f305bae51938@stats.ox.ac.uk>
 <CAFOpNVE-sX3kwPTzcLVY6p6xkQAo8UJJN=bBa6f6_1+kKgV7-g@mail.gmail.com>
 <360d5f57-3512-9efd-de74-38db1c536c68@gmail.com>
 <23101.4830.979381.386647@stat.math.ethz.ch>
 <A9377D4E-29FE-4CFA-8624-3A4643440F3B@me.com>
 <7ca2313a-2143-3d8f-eade-cbb0e6cb6132@gmail.com>
 <CALEXWq2To4hZm9zWauxmg9dd=XGPJccnKKvHX5p67N5KMjBJNg@mail.gmail.com>
 <9b0f83e3-a2d9-7988-dc89-3b2e034b8763@gmail.com>
 <CANNd7=nywaFfrecRtOP2yS4BEg2im_tP2WMN2qig1FEHpZzNvw@mail.gmail.com>
 <CAPtbhHwR-vtjRqtRgSfz4jPHS2m2u02JBcJxwwuKoejawLOW3Q@mail.gmail.com>
 <CANNd7==xYZzmwLfC_FWpHJ+FVmSmDSzQA4vxv_17nocOFbAUxw@mail.gmail.com>
 <CANNd7=khkFCXOE1o8vd_er_ZvdOePryW7AwvKk9VQSgDQTPEAA@mail.gmail.com>
 <c4d86c1b-9285-078a-9f4c-d9cc3e478798@statistik.tu-dortmund.de>
Message-ID: <99445d27-205c-b389-857a-906ba28f199a@gmail.com>

On 03/01/2018 6:11 PM, Uwe Ligges wrote:
> 
> 
> On 26.12.2017 00:45, Juan Telleria wrote:
>> However, and hope not to be off-topic, a git repository (github, gitlab,
>> codeplex, etc., not just solely github) could constitute a tidy approach,
>> and make things easier to R Core :)
>>
>> By putting the focus on version control, the line of changes made with each
>> commit (With the possibility to reverse changes), and not verbose e-mails.
> 
> That works well with svn, and we have the sequential labels which are
> e.g. important for bisecting changes.
> I do not see how I can find this out with git easily.

I think git supports bisection, but I don't see how switching to git 
would make anything easier for R Core.  Perhaps Juan can tell us which R 
Core tasks would be easier in git.

Duncan Murdoch


From jtelleriar at gmail.com  Thu Jan  4 00:02:10 2018
From: jtelleriar at gmail.com (Juan Telleria)
Date: Thu, 4 Jan 2018 00:02:10 +0100
Subject: [Rd] Community Feedback: Git Repository for R-Devel
In-Reply-To: <CANNd7=nge=B1HZEVq=JAn=4mwqHO0=AcPPwcc50-K1ZiCa=i8g@mail.gmail.com>
References: <CANNd7==5uV9Cx4gwNfmkC2vtFv++nr_OyeoO3EULJ6ad7qvu=A@mail.gmail.com>
 <CANNd7=kP7Ys+J+F64UKsU_HdhfgFzewi1THZfZEqiwe=_sKR8w@mail.gmail.com>
 <CANNd7=kzGqOdHC+PWXM9C34FJL3jejmjA3kYwbFqhxXWxxP8oA@mail.gmail.com>
 <CANNd7=n5BZ4eagb9E+Dh9hUB1jDhuZenFBpw=X3W33-T7x6fOw@mail.gmail.com>
 <CANNd7=kMGsgH+85_rvm0nhVyFHRT1gKF_ktumda-ki7KXNqb7A@mail.gmail.com>
 <CANNd7=kmzhNwRBVwHJ44HFfKWVZQvL3ut=O7jpSeHN3OkhruWA@mail.gmail.com>
 <CANNd7=nJjOEGnx7Oyoa6uR58gbvxq_PT4nBD638bfEVamg0oaA@mail.gmail.com>
 <CANNd7=kkH57M=ghLvhFAjOsUepBNobkDEqPoVTHteDRmQ0=BoQ@mail.gmail.com>
 <CANNd7=kMOiOg8Qevupcs3_6TLKWQnZcoyddoegYdFp_xmMSm8w@mail.gmail.com>
 <CANNd7=nowWsoZMs2kiusYJRbaUqdC8HGi7MN6HzVPbCJ_GwzEQ@mail.gmail.com>
 <CANNd7=nj+kn1fsgwLajVmTOc2KbCBXr6gXUbXV1zp3bNWpsjyQ@mail.gmail.com>
 <CANNd7=nXy1HqpukX+MmxYoBeVaPENhnkmv33CS6Fp8jgaracyg@mail.gmail.com>
 <CANNd7=nvRYt4DzgN-=e4z51swU8qa12_Ry6cyY-YDVuv+wEUWw@mail.gmail.com>
 <CANNd7=k9J2-DYC7OoU9DM9BCe3ghncAkVa_D99HJMaXvUmLfDw@mail.gmail.com>
 <CANNd7=kbt3E3dsE+h+XB9HH1GH2kDM03uZZCCmBJhuCkuMJL4A@mail.gmail.com>
 <CANNd7==bBNWTDh6cNp_6b1AWBWyBx0TuXK=ug08TOZtWk3FO9w@mail.gmail.com>
 <CANNd7=ktd7Hxh_vnys5SEjgzm_eZZNE8e3iOkVSV-0UqHU3jTg@mail.gmail.com>
 <CANNd7=kCWHU_50yMMGibGfnOfTzvWxz2dymEGnBmUerrO7kQRA@mail.gmail.com>
 <CANNd7=m=v0_8y3gwCNeq-dZNELtc6P+nSJiOq=0dCzq1eXiOwA@mail.gmail.com>
 <CANNd7=mbTRo42u+DBhpOzGoLYaeHYRRU3s4yGrHc=b5+z8o-kg@mail.gmail.com>
 <CANNd7=kJcn-uR5XMHGSS6cq2NWGv1U0gr4cYYqHqKYFHR+_vJw@mail.gmail.com>
 <CANNd7==M0fyFUcyYaw+-3P-mnH7JeXW-QHjBJEs8pC-AExPyJg@mail.gmail.com>
 <CANNd7==AMj3ZNScbbCRPHSM997XOxH21X4VRRG5n-jKzHtfpaQ@mail.gmail.com>
 <CANNd7=nk2_YtE0kWoE3ptHX22b+ddrB4_RKzLsq4AemQc3RNJA@mail.gmail.com>
 <CANNd7=mQVsOxMFHDi6jy_1vcohny08LxqugrhY9M7As208ER7w@mail.gmail.com>
 <CANNd7==sOybEMaDnf7nfmVMTUOp=jsbkPktrPd1asdJ11uAn7w@mail.gmail.com>
 <CANNd7=mZ+xCxu=V5h9684K9=cWZMXxF975CxST0tbrjZCNWG0Q@mail.gmail.com>
 <CANNd7==+Aw1GxbcObFShYRs30W08K6bdWrzKMv2BbSqjCGCEwA@mail.gmail.com>
 <CANNd7=mOgVBCxsDZO8aEFhjYrFabSmaLHmXqvryhszvY+SESew@mail.gmail.com>
 <CANNd7=n-tmYDcL_o3ts-Uosho-2+FLLzgy7++VdwCdXUKnBMVA@mail.gmail.com>
 <CANNd7=kF-xbDqan=pd3jQiDLv=FHvKAnPX-aZzCC5BXXbgjTUQ@mail.gmail.com>
 <CANNd7=ngurw1uUV1=M5vp9tUArUmfKY9KaWfzz0Jmat=A7XVKA@mail.gmail.com>
 <CANNd7==H7gVHY=75XVSsWtrrxatg85c-SJFexEvWBezx_eMZ3w@mail.gmail.com>
 <CANNd7=m0HNTdgdSqQ686ubudiK1u4Ca6wp3k7fFgNFVEyB7O2g@mail.gmail.com>
 <CANNd7=mg1A=yBSz4aq1M+rR2pDYa__33xD+VF=MM82+-qWbX4Q@mail.gmail.com>
 <CANNd7=mwfY4oM488UsDF0zYkeTFhY9x87CV4ANsUMgVtuXtTTw@mail.gmail.com>
 <CANNd7==_1u96TNLWmf3J7xMY1U0NhzSBkdtCQMwbciPOKKzPcA@mail.gmail.com>
 <CANNd7=kZc49PwY9HK+dYRz0Qg-mji-6HWGMSvGnotxKNNExT+Q@mail.gmail.com>
 <CANNd7==ugNBicV3XmW_7ZGT9mvsY+bk8NTdySPvRgySacGfJrw@mail.gmail.com>
 <CANNd7=kiWEteCsrLhJVJnNTG4kKbQWtPKpdLS2aY+5JoHvfy-Q@mail.gmail.com>
 <CANNd7=mZQ-=C4AZyjZVCPSQo+Vnbnquvg9cob8WsTRwzvQkiuQ@mail.gmail.com>
 <CANNd7=nDEi9HFNo50v-feLqKeZaxSc=Z8EVzijYOBe+G+LM2mg@mail.gmail.com>
 <CANNd7==Dn9LyXERRCP-Y_zX9e=sZ7W7=qEfP2Z56T-X8Ls13xw@mail.gmail.com>
 <CANNd7=noWDAPjK2Kifa=5x+Wyf97h8hC25dbkus02Oow_jZFcA@mail.gmail.com>
 <CANNd7==PkTfcimVjnxXtwJOoOEk0uyiU0zFBGMuEtsYmz6ihGg@mail.gmail.com>
 <CANNd7=mbqTFyo3G9MFsZRUnN-Ocv50OcCXO3GtmuL49OE75kqQ@mail.gmail.com>
 <CANNd7=k6H5PSE-XXpvZO9txon1K6cprOmwrxoyu0Th+-Pc2eQg@mail.gmail.com>
 <CANNd7=mvLJ7PKL4cB=SGMJ2J=8uD9cOjivfab1CNW2NPrHafEw@mail.gmail.com>
 <CANNd7=mBkFQyTjjRiJPO+5_c9TNkLKAEh8hjkW29yMNNk3odsw@mail.gmail.com>
 <CANNd7=kbRSmxFr4aaUEys71sk4ei3gtubmoh62a5SDMtLN-MRA@mail.gmail.com>
 <CANNd7=nakiAPh=smK6FOp9VOXdUwdq3OuERyrh5tuk7LUsgu3g@mail.gmail.com>
 <CANNd7=mLLfEf-B7QUvLGw8GVO1B05srWa57EPNmWAdrtBMiRBw@mail.gmail.com>
 <CANNd7=kTA+CLbn0rogt3zXCZhpFOaSY5Cai5M0XFz5MoA0v0qA@mail.gmail.com>
 <CANNd7=kTdwwcisP39mAxhpiteLyiFoojAvkMjcp-+QBORZruWA@mail.gmail.com>
 <CANNd7=nc5HV_UqqdtyD_KYOYV2KL11xraZJrhuUOFQh8J1Cpkw@mail.gmail.com>
 <CANNd7=ko=y7nzR=7MSQ0GjyJpaz7SDutJUDH196VPSXpy3KY_g@mail.gmail.com>
 <CANNd7=kmWaozw9EMLDdCo_gm8bqAw3rR0JjuoVe=Fmx+y14+iw@mail.gmail.com>
 <CANNd7=mGPfvSBb5eRVjLw8zwRJ38=iogPWRM_H-mVb13wrqfYQ@mail.gmail.com>
 <CANNd7=kXC9YS-GxBGXETDyvecksSocacNpz1fxxyW3rPepLrMw@mail.gmail.com>
 <CANNd7=n2POaXz38y0dD8ZpuLCRi4sBhnGN1m9JCk24ciMsqBmw@mail.gmail.com>
 <CANNd7=kvhy5u4xXRT4XYH4-VT4tGtCrLVYUJxhbN+iqa17W7vA@mail.gmail.com>
 <CANNd7=ny=PxQbxeb1wYpmunMaR1KQcsY8ykCOUzK_m16PB_EWg@mail.gmail.com>
 <CANNd7=kHcZW5oYUPDM5nz-2p6UqYeOnZTgcDAbd5GHGFAenrvQ@mail.gmail.com>
 <CANNd7=mS7kh8Y_QYLGE4_a-Bm2r34Sr9vOX9txnrisUwjot-2g@mail.gmail.com>
 <CANNd7=nwEwLU8Rdti8_LDgKGegO6SgyvDxGpLfHhTKyzNi0+Uw@mail.gmail.com>
 <CANNd7=nge=B1HZEVq=JAn=4mwqHO0=AcPPwcc50-K1ZiCa=i8g@mail.gmail.com>
Message-ID: <CANNd7=mPeU3Ww-nG6Nq75ZjF84GrCsVxmmWV05KTuQHL8cbx-A@mail.gmail.com>

UNBIASED FACTS:
? Bugzilla & R-devel Mailing Lists: Remain unchanged: Understood as
Ticketing platforms for bug pull requests on the R-devel Git Repository.

?  Git Repository Options:
A) Github (Cloud with Automated backups from GitHub to CRAN Server):
https://github.com
B) Gitlab (Selfhosted on CRAN): https://about.gitlab.com
C) Phabricator (Selfhosted on CRAN): https://www.phacility.com
D) Microsoft Codeplex: https://www.codeplex.com
E) Others: Unknown

GOOGLE TRENDS:
https://trends.google.com/trends/explore?date=all&q=Git,Svn,Github,Gitlab

EXAMPLE
Git Repository on Core Python: https://github.com/python

PERSONAL OPINION / MOTIVATION:
I think that moving efforts in this direction is important because it would
allow a true Open Source Innovation & Open Collaboration in R between:
* R Community.
* And R-Core.
For:
* R Bug Fixes.
* And Core Feature Wishlist.
As anyone would be able to:
* Check the unassigned bugs in Bugzilla (apart from R-Core).
* And propose bugs fixes by themselves as Pull requests (by mentioning the
Bug ID of Bugzilla or the Mailing Lists).

This would allow that _individuals_ either from Universities or Companies
interested in the Development of R:
* apart of donating economical resources to the R Foundation.
* could help to maintain core R Code by themselves.
Which aligns with the true spirit of R, which shall be done from
contributing individuals, for individuals themselves.

It would also allow to put the focus on the precise lines of code changed
with each Commit, and revert changes in an easy way, without verbose
E-mails: Tidy, Clean, Maintainable, and Fast.

At last, I noticed R-devel Archives do not have an E-mail Id (Unique
Unsigned Integer), so it would be a good idea to add one for pull requests
if Git was adopted.

Juan

	[[alternative HTML version deleted]]


From peter.meilstrup at gmail.com  Thu Jan  4 01:18:15 2018
From: peter.meilstrup at gmail.com (Peter Meilstrup)
Date: Wed, 3 Jan 2018 16:18:15 -0800
Subject: [Rd] Coping with non-standard evaluation in R program analysis
In-Reply-To: <DM5PR02MB2860748944E8E439755AB2EAA7190@DM5PR02MB2860.namprd02.prod.outlook.com>
References: <DM5PR02MB2860748944E8E439755AB2EAA7190@DM5PR02MB2860.namprd02.prod.outlook.com>
Message-ID: <CAJoaRhYbJjNU3EW+uCMeMObtosv+hgCf_BkrS+joLLXFShPVtw@mail.gmail.com>

For 2), it is not exposed in R's standard library but it is exposed in
the Rinternals API. A promise that is forced in normal evaluation will
have PRENV set to NULL.

Peter

On Tue, Jan 2, 2018 at 4:19 PM, Evan James Patterson
<epatters at stanford.edu> wrote:
> Hello R experts,
>
>
> I plan to develop a tool for dynamic analysis of R programs. I would like to trace function calls at runtime, capturing argument and return values. Following a suggestion made some time ago on this list, my high-level implementation strategy is to rewrite the AST, augmenting call expressions with pre-call and post-call shims to capture the arguments and return value, respectively.
>
>
> I can think of only one fundamental conceptual obstacle to this approach: R functions are not necessarily referentially transparent. The arguments received by a function are not values but promises. They can be evaluated directly ("standard evaluation"), after applying arbitrary syntactic transformations ("non-standard evaluation", aka NSE), or not at all. Therefore, if you peek at the values of function arguments before evaluating the function, you risk altering the semantics of the program, possibly fatally.
>
>
> I'm looking for general advice about how to cope with NSE in this context. I also have some specific questions:
>
>
> 1) Is it possible to determine whether a given function (primitive, in R, or external) uses NSE on some or all of its arguments?
>
>
> 2) Is it possible to inspect the promise objects received by functions, say to determine whether they have been evaluated, without actually evaluating them? The R manual is not encouraging in this area:
>
>
> https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Promise-objects
>
>
> Thank you,
>
>
> Evan
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From btyner at gmail.com  Thu Jan  4 05:09:24 2018
From: btyner at gmail.com (Benjamin Tyner)
Date: Wed, 3 Jan 2018 23:09:24 -0500
Subject: [Rd] Coping with non-standard evaluation in R program analysis
In-Reply-To: <mailman.5.1514977203.7011.r-devel@r-project.org>
References: <mailman.5.1514977203.7011.r-devel@r-project.org>
Message-ID: <d8dd49c6-517f-f372-bb4b-56a39e85f61c@gmail.com>

Evan,

The pryr package provides some utilities which may be handy here. In 
particular see the function: is_promise.

Also, next time please post in plaintext.

Regards
Ben
> Hello R experts,
>
>
> I plan to develop a tool for dynamic analysis of R programs. I would like to trace function calls at runtime, capturing argument and return values. Following a suggestion made some time ago on this list, my high-level implementation strategy is to rewrite the AST, augmenting call expressions with pre-call and post-call shims to capture the arguments and return value, respectively.
>
>
> I can think of only one fundamental conceptual obstacle to this approach: R functions are not necessarily referentially transparent. The arguments received by a function are not values but promises. They can be evaluated directly ("standard evaluation"), after applying arbitrary syntactic transformations ("non-standard evaluation", aka NSE), or not at all. Therefore, if you peek at the values of function arguments before evaluating the function, you risk altering the semantics of the program, possibly fatally.
>
>
> I'm looking for general advice about how to cope with NSE in this context. I also have some specific questions:
>
>
> 1) Is it possible to determine whether a given function (primitive, in R, or external) uses NSE on some or all of its arguments?
>
>
> 2) Is it possible to inspect the promise objects received by functions, say to determine whether they have been evaluated, without actually evaluating them? The R manual is not encouraging in this area:
>
>
> https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Promise-objects
>
>
> Thank you,
>
>
> Evan
>
>
> 	[[alternative HTML version deleted]]
>
>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> R-devel at r-project.org mailing list  DIGESTED
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ------------------------------
>
> End of R-devel Digest, Vol 179, Issue 1
> ***************************************


From mark.vanderloo at gmail.com  Thu Jan  4 11:06:34 2018
From: mark.vanderloo at gmail.com (Mark van der Loo)
Date: Thu, 04 Jan 2018 10:06:34 +0000
Subject: [Rd] Community Feedback: Git Repository for R-Devel
In-Reply-To: <CANNd7=mPeU3Ww-nG6Nq75ZjF84GrCsVxmmWV05KTuQHL8cbx-A@mail.gmail.com>
References: <CANNd7==5uV9Cx4gwNfmkC2vtFv++nr_OyeoO3EULJ6ad7qvu=A@mail.gmail.com>
 <CANNd7=kP7Ys+J+F64UKsU_HdhfgFzewi1THZfZEqiwe=_sKR8w@mail.gmail.com>
 <CANNd7=kzGqOdHC+PWXM9C34FJL3jejmjA3kYwbFqhxXWxxP8oA@mail.gmail.com>
 <CANNd7=n5BZ4eagb9E+Dh9hUB1jDhuZenFBpw=X3W33-T7x6fOw@mail.gmail.com>
 <CANNd7=kMGsgH+85_rvm0nhVyFHRT1gKF_ktumda-ki7KXNqb7A@mail.gmail.com>
 <CANNd7=kmzhNwRBVwHJ44HFfKWVZQvL3ut=O7jpSeHN3OkhruWA@mail.gmail.com>
 <CANNd7=nJjOEGnx7Oyoa6uR58gbvxq_PT4nBD638bfEVamg0oaA@mail.gmail.com>
 <CANNd7=kkH57M=ghLvhFAjOsUepBNobkDEqPoVTHteDRmQ0=BoQ@mail.gmail.com>
 <CANNd7=kMOiOg8Qevupcs3_6TLKWQnZcoyddoegYdFp_xmMSm8w@mail.gmail.com>
 <CANNd7=nowWsoZMs2kiusYJRbaUqdC8HGi7MN6HzVPbCJ_GwzEQ@mail.gmail.com>
 <CANNd7=nj+kn1fsgwLajVmTOc2KbCBXr6gXUbXV1zp3bNWpsjyQ@mail.gmail.com>
 <CANNd7=nXy1HqpukX+MmxYoBeVaPENhnkmv33CS6Fp8jgaracyg@mail.gmail.com>
 <CANNd7=nvRYt4DzgN-=e4z51swU8qa12_Ry6cyY-YDVuv+wEUWw@mail.gmail.com>
 <CANNd7=k9J2-DYC7OoU9DM9BCe3ghncAkVa_D99HJMaXvUmLfDw@mail.gmail.com>
 <CANNd7=kbt3E3dsE+h+XB9HH1GH2kDM03uZZCCmBJhuCkuMJL4A@mail.gmail.com>
 <CANNd7==bBNWTDh6cNp_6b1AWBWyBx0TuXK=ug08TOZtWk3FO9w@mail.gmail.com>
 <CANNd7=ktd7Hxh_vnys5SEjgzm_eZZNE8e3iOkVSV-0UqHU3jTg@mail.gmail.com>
 <CANNd7=kCWHU_50yMMGibGfnOfTzvWxz2dymEGnBmUerrO7kQRA@mail.gmail.com>
 <CANNd7=m=v0_8y3gwCNeq-dZNELtc6P+nSJiOq=0dCzq1eXiOwA@mail.gmail.com>
 <CANNd7=mbTRo42u+DBhpOzGoLYaeHYRRU3s4yGrHc=b5+z8o-kg@mail.gmail.com>
 <CANNd7=kJcn-uR5XMHGSS6cq2NWGv1U0gr4cYYqHqKYFHR+_vJw@mail.gmail.com>
 <CANNd7==M0fyFUcyYaw+-3P-mnH7JeXW-QHjBJEs8pC-AExPyJg@mail.gmail.com>
 <CANNd7==AMj3ZNScbbCRPHSM997XOxH21X4VRRG5n-jKzHtfpaQ@mail.gmail.com>
 <CANNd7=nk2_YtE0kWoE3ptHX22b+ddrB4_RKzLsq4AemQc3RNJA@mail.gmail.com>
 <CANNd7=mQVsOxMFHDi6jy_1vcohny08LxqugrhY9M7As208ER7w@mail.gmail.com>
 <CANNd7==sOybEMaDnf7nfmVMTUOp=jsbkPktrPd1asdJ11uAn7w@mail.gmail.com>
 <CANNd7=mZ+xCxu=V5h9684K9=cWZMXxF975CxST0tbrjZCNWG0Q@mail.gmail.com>
 <CANNd7==+Aw1GxbcObFShYRs30W08K6bdWrzKMv2BbSqjCGCEwA@mail.gmail.com>
 <CANNd7=mOgVBCxsDZO8aEFhjYrFabSmaLHmXqvryhszvY+SESew@mail.gmail.com>
 <CANNd7=n-tmYDcL_o3ts-Uosho-2+FLLzgy7++VdwCdXUKnBMVA@mail.gmail.com>
 <CANNd7=kF-xbDqan=pd3jQiDLv=FHvKAnPX-aZzCC5BXXbgjTUQ@mail.gmail.com>
 <CANNd7=ngurw1uUV1=M5vp9tUArUmfKY9KaWfzz0Jmat=A7XVKA@mail.gmail.com>
 <CANNd7==H7gVHY=75XVSsWtrrxatg85c-SJFexEvWBezx_eMZ3w@mail.gmail.com>
 <CANNd7=m0HNTdgdSqQ686ubudiK1u4Ca6wp3k7fFgNFVEyB7O2g@mail.gmail.com>
 <CANNd7=mg1A=yBSz4aq1M+rR2pDYa__33xD+VF=MM82+-qWbX4Q@mail.gmail.com>
 <CANNd7=mwfY4oM488UsDF0zYkeTFhY9x87CV4ANsUMgVtuXtTTw@mail.gmail.com>
 <CANNd7==_1u96TNLWmf3J7xMY1U0NhzSBkdtCQMwbciPOKKzPcA@mail.gmail.com>
 <CANNd7=kZc49PwY9HK+dYRz0Qg-mji-6HWGMSvGnotxKNNExT+Q@mail.gmail.com>
 <CANNd7==ugNBicV3XmW_7ZGT9mvsY+bk8NTdySPvRgySacGfJrw@mail.gmail.com>
 <CANNd7=kiWEteCsrLhJVJnNTG4kKbQWtPKpdLS2aY+5JoHvfy-Q@mail.gmail.com>
 <CANNd7=mZQ-=C4AZyjZVCPSQo+Vnbnquvg9cob8WsTRwzvQkiuQ@mail.gmail.com>
 <CANNd7=nDEi9HFNo50v-feLqKeZaxSc=Z8EVzijYOBe+G+LM2mg@mail.gmail.com>
 <CANNd7==Dn9LyXERRCP-Y_zX9e=sZ7W7=qEfP2Z56T-X8Ls13xw@mail.gmail.com>
 <CANNd7=noWDAPjK2Kifa=5x+Wyf97h8hC25dbkus02Oow_jZFcA@mail.gmail.com>
 <CANNd7==PkTfcimVjnxXtwJOoOEk0uyiU0zFBGMuEtsYmz6ihGg@mail.gmail.com>
 <CANNd7=mbqTFyo3G9MFsZRUnN-Ocv50OcCXO3GtmuL49OE75kqQ@mail.gmail.com>
 <CANNd7=k6H5PSE-XXpvZO9txon1K6cprOmwrxoyu0Th+-Pc2eQg@mail.gmail.com>
 <CANNd7=mvLJ7PKL4cB=SGMJ2J=8uD9cOjivfab1CNW2NPrHafEw@mail.gmail.com>
 <CANNd7=mBkFQyTjjRiJPO+5_c9TNkLKAEh8hjkW29yMNNk3odsw@mail.gmail.com>
 <CANNd7=kbRSmxFr4aaUEys71sk4ei3gtubmoh62a5SDMtLN-MRA@mail.gmail.com>
 <CANNd7=nakiAPh=smK6FOp9VOXdUwdq3OuERyrh5tuk7LUsgu3g@mail.gmail.com>
 <CANNd7=mLLfEf-B7QUvLGw8GVO1B05srWa57EPNmWAdrtBMiRBw@mail.gmail.com>
 <CANNd7=kTA+CLbn0rogt3zXCZhpFOaSY5Cai5M0XFz5MoA0v0qA@mail.gmail.com>
 <CANNd7=kTdwwcisP39mAxhpiteLyiFoojAvkMjcp-+QBORZruWA@mail.gmail.com>
 <CANNd7=nc5HV_UqqdtyD_KYOYV2KL11xraZJrhuUOFQh8J1Cpkw@mail.gmail.com>
 <CANNd7=ko=y7nzR=7MSQ0GjyJpaz7SDutJUDH196VPSXpy3KY_g@mail.gmail.com>
 <CANNd7=kmWaozw9EMLDdCo_gm8bqAw3rR0JjuoVe=Fmx+y14+iw@mail.gmail.com>
 <CANNd7=mGPfvSBb5eRVjLw8zwRJ38=iogPWRM_H-mVb13wrqfYQ@mail.gmail.com>
 <CANNd7=kXC9YS-GxBGXETDyvecksSocacNpz1fxxyW3rPepLrMw@mail.gmail.com>
 <CANNd7=n2POaXz38y0dD8ZpuLCRi4sBhnGN1m9JCk24ciMsqBmw@mail.gmail.com>
 <CANNd7=kvhy5u4xXRT4XYH4-VT4tGtCrLVYUJxhbN+iqa17W7vA@mail.gmail.com>
 <CANNd7=ny=PxQbxeb1wYpmunMaR1KQcsY8ykCOUzK_m16PB_EWg@mail.gmail.com>
 <CANNd7=kHcZW5oYUPDM5nz-2p6UqYeOnZTgcDAbd5GHGFAenrvQ@mail.gmail.com>
 <CANNd7=mS7kh8Y_QYLGE4_a-Bm2r34Sr9vOX9txnrisUwjot-2g@mail.gmail.com>
 <CANNd7=nwEwLU8Rdti8_LDgKGegO6SgyvDxGpLfHhTKyzNi0+Uw@mail.gmail.com>
 <CANNd7=nge=B1HZEVq=JAn=4mwqHO0=AcPPwcc50-K1ZiCa=i8g@mail.gmail.com>
 <CANNd7=mPeU3Ww-nG6Nq75ZjF84GrCsVxmmWV05KTuQHL8cbx-A@mail.gmail.com>
Message-ID: <CAOKDuOgHmT3FUEY=D6VPWwRk6O8G32BuetkQoL_ZTZCcZD1OGA@mail.gmail.com>

This question has been discussed before on this list:
http://r.789695.n4.nabble.com/Why-R-project-source-code-is-not-on-Github-td4695779.html

See especially Jeroen's answer.

Best,
Mark

Op do 4 jan. 2018 om 01:11 schreef Juan Telleria <jtelleriar at gmail.com>:

> UNBIASED FACTS:
> ? Bugzilla & R-devel Mailing Lists: Remain unchanged: Understood as
> Ticketing platforms for bug pull requests on the R-devel Git Repository.
>
> ?  Git Repository Options:
> A) Github (Cloud with Automated backups from GitHub to CRAN Server):
> https://github.com
> B) Gitlab (Selfhosted on CRAN): https://about.gitlab.com
> C) Phabricator (Selfhosted on CRAN): https://www.phacility.com
> D) Microsoft Codeplex: https://www.codeplex.com
> E) Others: Unknown
>
> GOOGLE TRENDS:
> https://trends.google.com/trends/explore?date=all&q=Git,Svn,Github,Gitlab
>
> EXAMPLE
> Git Repository on Core Python: https://github.com/python
>
> PERSONAL OPINION / MOTIVATION:
> I think that moving efforts in this direction is important because it would
> allow a true Open Source Innovation & Open Collaboration in R between:
> * R Community.
> * And R-Core.
> For:
> * R Bug Fixes.
> * And Core Feature Wishlist.
> As anyone would be able to:
> * Check the unassigned bugs in Bugzilla (apart from R-Core).
> * And propose bugs fixes by themselves as Pull requests (by mentioning the
> Bug ID of Bugzilla or the Mailing Lists).
>
> This would allow that _individuals_ either from Universities or Companies
> interested in the Development of R:
> * apart of donating economical resources to the R Foundation.
> * could help to maintain core R Code by themselves.
> Which aligns with the true spirit of R, which shall be done from
> contributing individuals, for individuals themselves.
>
> It would also allow to put the focus on the precise lines of code changed
> with each Commit, and revert changes in an easy way, without verbose
> E-mails: Tidy, Clean, Maintainable, and Fast.
>
> At last, I noticed R-devel Archives do not have an E-mail Id (Unique
> Unsigned Integer), so it would be a good idea to add one for pull requests
> if Git was adopted.
>
> Juan
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

	[[alternative HTML version deleted]]


From vitekj at icloud.com  Thu Jan  4 09:20:49 2018
From: vitekj at icloud.com (jan Vitek)
Date: Thu, 04 Jan 2018 03:20:49 -0500
Subject: [Rd] Coping with non-standard evaluation in R program analysis
In-Reply-To: <8B5818E3-9569-4AD5-A6B1-6BF6905A145F@icloud.com>
References: <DM5PR02MB2860748944E8E439755AB2EAA7190@DM5PR02MB2860.namprd02.prod.outlook.com>
 <CAJoaRhYbJjNU3EW+uCMeMObtosv+hgCf_BkrS+joLLXFShPVtw@mail.gmail.com>
 <8B5818E3-9569-4AD5-A6B1-6BF6905A145F@icloud.com>
Message-ID: <D3275CAA-9051-499D-92A8-69408D3D7263@icloud.com>

Hi Evan,

You may find some parts of what we are doing with genthat useful.  Genthat is a tool
for creating unit tests by recording argument and return values of calls. This is
done by instrumentation of the source code.

The git repo with the code is here https://github.com/PRL-PRG/genthat

We don?t really deal with NSE though. It could be something worth thinking about for us.
The contact for genthtat is Filip.


We are also writing a tool for analyzing promises and generating execution traces
within the R VM.  This is available in 
    https://github.com/PRL-PRG/R-dyntrace

Aviral and Konrad are the contacts there.


Best,

jan






Jan Vitek, Professor 
Computer Science, 
Northeastern University

> On Jan 3, 2018, at 7:18 PM, Peter Meilstrup <peter.meilstrup at gmail.com> wrote:
> 
> For 2), it is not exposed in R's standard library but it is exposed in
> the Rinternals API. A promise that is forced in normal evaluation will
> have PRENV set to NULL.
> 
> Peter
> 
> On Tue, Jan 2, 2018 at 4:19 PM, Evan James Patterson
> <epatters at stanford.edu> wrote:
>> Hello R experts,
>> 
>> 
>> I plan to develop a tool for dynamic analysis of R programs. I would like to trace function calls at runtime, capturing argument and return values. Following a suggestion made some time ago on this list, my high-level implementation strategy is to rewrite the AST, augmenting call expressions with pre-call and post-call shims to capture the arguments and return value, respectively.
>> 
>> 
>> I can think of only one fundamental conceptual obstacle to this approach: R functions are not necessarily referentially transparent. The arguments received by a function are not values but promises. They can be evaluated directly ("standard evaluation"), after applying arbitrary syntactic transformations ("non-standard evaluation", aka NSE), or not at all. Therefore, if you peek at the values of function arguments before evaluating the function, you risk altering the semantics of the program, possibly fatally.
>> 
>> 
>> I'm looking for general advice about how to cope with NSE in this context. I also have some specific questions:
>> 
>> 
>> 1) Is it possible to determine whether a given function (primitive, in R, or external) uses NSE on some or all of its arguments?
>> 
>> 
>> 2) Is it possible to inspect the promise objects received by functions, say to determine whether they have been evaluated, without actually evaluating them? The R manual is not encouraging in this area:
>> 
>> 
>> https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Promise-objects
>> 
>> 
>> Thank you,
>> 
>> 
>> Evan
>> 
>> 
>>       [[alternative HTML version deleted]]
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From bbolker at gmail.com  Thu Jan  4 20:56:54 2018
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 4 Jan 2018 14:56:54 -0500
Subject: [Rd] silent recycling in logical indexing
Message-ID: <6ba8e484-bc14-bcbb-1d8a-4871909e87f2@gmail.com>


  Sorry if this has been covered here somewhere in the past, but ...

  Does anyone know why logical vectors are *silently* recycled, even
when they are incommensurate lengths, when doing logical indexing?  This
is as documented:

  For ?[?-indexing only: ?i?, ?j?, ?...? can be logical
          vectors, indicating elements/slices to select.  Such vectors
          are recycled if necessary to match the corresponding extent.

but IMO weird:

> x <- c(TRUE,TRUE,FALSE)
> y <- c(TRUE,FALSE)
> x[y]
[1]  TRUE FALSE

## (TRUE, FALSE) gets recycled to (TRUE,FALSE,TRUE) and selects
##  the first and third elements

If we do logical operations instead we do get a warning:

> x | y
[1] TRUE TRUE TRUE
Warning message:
In x | y : longer object length is not a multiple of shorter object length

  Is it just too expensive to test for incomplete recycling when doing
subsetting, or is there a sensible use case for incomplete recycling?

  Ll. 546ff of main/src/subscript.c suggest that there is a place in the
code where we already know if incomplete recycling has happened ...

 Thoughts?

   cheers
     Ben Bolker


From sjg at cantab.net  Thu Jan  4 21:23:48 2018
From: sjg at cantab.net (Simon Guest)
Date: Fri, 5 Jan 2018 09:23:48 +1300
Subject: [Rd] Fixed BLAS tests for external BLAS library
In-Reply-To: <d8f5a2bf-48ab-c5cc-d170-83209a79cceb@gmail.com>
References: <CAFhGSbtyd0-=FTMsE8ty0vdGvhmbTGM+Ww5+KgQpv-xFsfAq0w@mail.gmail.com>
 <d8f5a2bf-48ab-c5cc-d170-83209a79cceb@gmail.com>
Message-ID: <CAFhGSbsqEaD9OZyKBfTrbh1i11razBcPB1282kCz9b9mcBHTpQ@mail.gmail.com>

Hi Tomas,

Thanks for your reply.

I find your response curious, however.  Surely the identical() test is
simply incorrect when catering for possibly different BLAS
implementations?  Or is it the case that conformant BLAS implementations
all produce bit-identical results, which seems unlikely?  (Sorry, I am
unfamiliar with the BLAS spec.)  Although whatever the answer to this
theoretical question, the CentOS 7 external BLAS library evidently doesn't
produce bit-identical results.

If you don't agree that replacing identical() with all.equal() is clearly
the right thing to do, as demonstrated by the CentOS 7 external BLAS
library failing the test, then I think I will give up now trying to help
improve the R sources.  I simply can't justify to my client more time spent
on making this work, when we already have a local solution (which I hoped
others would be able to benefit from).  Ah well.

cheers,
Simon

On 5 January 2018 at 00:07, Tomas Kalibera <tomas.kalibera at gmail.com> wrote:

> Hi Simon,
>
> we'd need more information to consider this - particularly which
> expression gives an imprecise result with ACML and what are the computed
> values, differences. It is not common for optimized BLAS implementations to
> fail reg-BLAS.R tests, but it is common for them to report numerical
> differences in tests of various recommended packages where more complicated
> computations are done (e.g. nlme), on various platforms.
>
> Best
> Tomas
>
>
> On 12/18/2017 08:56 PM, Simon Guest wrote:
>
>> We build R with dynamically linked BLAS and LAPACK libraries, in order
>> to use the AMD Core Math Library (ACML) multi-threaded implementation
>> of these routines on our 64 core servers.  This is great, and our
>> users really appreciate it.
>>
>> However, when building like this, make check fails on the reg-BLAS.R
>> test.  The reason for this is that the expected test output is checked
>> using identical.  By changing all uses of identical in this file to
>> all.equal, the tests pass.
>>
>> Specifically, I run this command before make check:
>>
>> $ sed -i -e 's/identical/all.equal/g' tests/reg-BLAS.R
>>
>> I suggest that the test is fixed like this in the R source code.
>>
>> Here is the configure command I use, on CentOS 7:
>> $ ./configure --with-system-zlib --with-system-bzlib --with-system-pcre \
>>      --with-blas \
>>      --with-lapack \
>>      --with-tcl-config=/usr/lib64/tclConfig.sh \
>>      --with-tk-config=/usr/lib64/tkConfig.sh \
>>      --enable-R-shlib \
>>      --enable-prebuilt-html
>>
>> cheers,
>> Simon
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>
>
>

	[[alternative HTML version deleted]]


From wdunlap at tibco.com  Thu Jan  4 21:50:04 2018
From: wdunlap at tibco.com (William Dunlap)
Date: Thu, 4 Jan 2018 12:50:04 -0800
Subject: [Rd] silent recycling in logical indexing
In-Reply-To: <6ba8e484-bc14-bcbb-1d8a-4871909e87f2@gmail.com>
References: <6ba8e484-bc14-bcbb-1d8a-4871909e87f2@gmail.com>
Message-ID: <CAF8bMcaxTpf6-5yN2dNZfzQfqwXK_ZEeSSn1JL2f8H78e_r7Zw@mail.gmail.com>

One use case is when you want to extract every third item, starting with
the second, of an arbitrary vector with
    x[c(FALSE, TRUE, FALSE)]
instead of
    x[seq_along(x) %% 3 == 2]

Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Thu, Jan 4, 2018 at 11:56 AM, Ben Bolker <bbolker at gmail.com> wrote:

>
>   Sorry if this has been covered here somewhere in the past, but ...
>
>   Does anyone know why logical vectors are *silently* recycled, even
> when they are incommensurate lengths, when doing logical indexing?  This
> is as documented:
>
>   For ?[?-indexing only: ?i?, ?j?, ?...? can be logical
>           vectors, indicating elements/slices to select.  Such vectors
>           are recycled if necessary to match the corresponding extent.
>
> but IMO weird:
>
> > x <- c(TRUE,TRUE,FALSE)
> > y <- c(TRUE,FALSE)
> > x[y]
> [1]  TRUE FALSE
>
> ## (TRUE, FALSE) gets recycled to (TRUE,FALSE,TRUE) and selects
> ##  the first and third elements
>
> If we do logical operations instead we do get a warning:
>
> > x | y
> [1] TRUE TRUE TRUE
> Warning message:
> In x | y : longer object length is not a multiple of shorter object length
>
>   Is it just too expensive to test for incomplete recycling when doing
> subsetting, or is there a sensible use case for incomplete recycling?
>
>   Ll. 546ff of main/src/subscript.c suggest that there is a place in the
> code where we already know if incomplete recycling has happened ...
>
>  Thoughts?
>
>    cheers
>      Ben Bolker
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

	[[alternative HTML version deleted]]


From ccberry at ucsd.edu  Thu Jan  4 22:09:11 2018
From: ccberry at ucsd.edu (Berry, Charles)
Date: Thu, 4 Jan 2018 21:09:11 +0000
Subject: [Rd] silent recycling in logical indexing
In-Reply-To: <6ba8e484-bc14-bcbb-1d8a-4871909e87f2@gmail.com>
References: <6ba8e484-bc14-bcbb-1d8a-4871909e87f2@gmail.com>
Message-ID: <25B0F325-FD8D-4A43-B711-2329E4847AE9@ucsd.edu>



> On Jan 4, 2018, at 11:56 AM, Ben Bolker <bbolker at gmail.com> wrote:
> 
> 
>  Sorry if this has been covered here somewhere in the past, but ...
> 
>  Does anyone know why logical vectors are *silently* recycled, even
> when they are incommensurate lengths, when doing logical indexing? 

It is convenient to use a single `TRUE' in programmatic manipulation of subscripts in the same manner as using an empty subscript interactively:

> mat<-diag(1:3)
> expr1 <- quote(mat[])
> expr1[[3]] <- TRUE
> expr1[[4]] <- 2
> eval(expr1)
[1] 0 2 0
> mat[,2]
[1] 0 2 0

HTH,

Chuck

From bbolker at gmail.com  Thu Jan  4 22:44:24 2018
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 4 Jan 2018 16:44:24 -0500
Subject: [Rd] silent recycling in logical indexing
In-Reply-To: <25B0F325-FD8D-4A43-B711-2329E4847AE9@ucsd.edu>
References: <6ba8e484-bc14-bcbb-1d8a-4871909e87f2@gmail.com>
 <25B0F325-FD8D-4A43-B711-2329E4847AE9@ucsd.edu>
Message-ID: <CABghstSnaTTfxs+f0ENUeFJF4UO998_A4xdN7wFhZcmsuHAfog@mail.gmail.com>

Hmm.

Chuck: I don't see how this example represents
incomplete/incommensurate recycling. Doesn't TRUE replicate from
length-1 to length-3 in this case (mat[c(TRUE,FALSE),2] would be an
example of incomplete recycling)?

William: clever, but maybe too clever unless you really need the
speed? (The clever way is 8 times faster in the following case ...)

x <- rep(1,1e6)
rbenchmark::benchmark(x[c(FALSE,TRUE,FALSE)],x[seq_along(x) %% 3 == 2])

On the other hand, it takes 0.025 vs 0.003 seconds per iteration ...
fortunes::fortune("7ms")


On Thu, Jan 4, 2018 at 4:09 PM, Berry, Charles <ccberry at ucsd.edu> wrote:
>
>
>> On Jan 4, 2018, at 11:56 AM, Ben Bolker <bbolker at gmail.com> wrote:
>>
>>
>>  Sorry if this has been covered here somewhere in the past, but ...
>>
>>  Does anyone know why logical vectors are *silently* recycled, even
>> when they are incommensurate lengths, when doing logical indexing?
>
> It is convenient to use a single `TRUE' in programmatic manipulation of subscripts in the same manner as using an empty subscript interactively:
>
>> mat<-diag(1:3)
>> expr1 <- quote(mat[])
>> expr1[[3]] <- TRUE
>> expr1[[4]] <- 2
>> eval(expr1)
> [1] 0 2 0
>> mat[,2]
> [1] 0 2 0
>
> HTH,
>
> Chuck


From bbolker at gmail.com  Thu Jan  4 22:46:03 2018
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 4 Jan 2018 16:46:03 -0500
Subject: [Rd] silent recycling in logical indexing
In-Reply-To: <CABghstSnaTTfxs+f0ENUeFJF4UO998_A4xdN7wFhZcmsuHAfog@mail.gmail.com>
References: <6ba8e484-bc14-bcbb-1d8a-4871909e87f2@gmail.com>
 <25B0F325-FD8D-4A43-B711-2329E4847AE9@ucsd.edu>
 <CABghstSnaTTfxs+f0ENUeFJF4UO998_A4xdN7wFhZcmsuHAfog@mail.gmail.com>
Message-ID: <CABghstSyZNNuFiMJG8shGzdJNDYY_X_Pr=29OPGONZjMQo+V1g@mail.gmail.com>

PS I'm tempted to insert a warning at this point and see how often it
actually gets triggered ...

On Thu, Jan 4, 2018 at 4:44 PM, Ben Bolker <bbolker at gmail.com> wrote:
> Hmm.
>
> Chuck: I don't see how this example represents
> incomplete/incommensurate recycling. Doesn't TRUE replicate from
> length-1 to length-3 in this case (mat[c(TRUE,FALSE),2] would be an
> example of incomplete recycling)?
>
> William: clever, but maybe too clever unless you really need the
> speed? (The clever way is 8 times faster in the following case ...)
>
> x <- rep(1,1e6)
> rbenchmark::benchmark(x[c(FALSE,TRUE,FALSE)],x[seq_along(x) %% 3 == 2])
>
> On the other hand, it takes 0.025 vs 0.003 seconds per iteration ...
> fortunes::fortune("7ms")
>
>
> On Thu, Jan 4, 2018 at 4:09 PM, Berry, Charles <ccberry at ucsd.edu> wrote:
>>
>>
>>> On Jan 4, 2018, at 11:56 AM, Ben Bolker <bbolker at gmail.com> wrote:
>>>
>>>
>>>  Sorry if this has been covered here somewhere in the past, but ...
>>>
>>>  Does anyone know why logical vectors are *silently* recycled, even
>>> when they are incommensurate lengths, when doing logical indexing?
>>
>> It is convenient to use a single `TRUE' in programmatic manipulation of subscripts in the same manner as using an empty subscript interactively:
>>
>>> mat<-diag(1:3)
>>> expr1 <- quote(mat[])
>>> expr1[[3]] <- TRUE
>>> expr1[[4]] <- 2
>>> eval(expr1)
>> [1] 0 2 0
>>> mat[,2]
>> [1] 0 2 0
>>
>> HTH,
>>
>> Chuck


From ccberry at ucsd.edu  Thu Jan  4 23:04:47 2018
From: ccberry at ucsd.edu (Berry, Charles)
Date: Thu, 4 Jan 2018 22:04:47 +0000
Subject: [Rd] silent recycling in logical indexing
In-Reply-To: <CABghstSnaTTfxs+f0ENUeFJF4UO998_A4xdN7wFhZcmsuHAfog@mail.gmail.com>
References: <6ba8e484-bc14-bcbb-1d8a-4871909e87f2@gmail.com>
 <25B0F325-FD8D-4A43-B711-2329E4847AE9@ucsd.edu>
 <CABghstSnaTTfxs+f0ENUeFJF4UO998_A4xdN7wFhZcmsuHAfog@mail.gmail.com>
Message-ID: <C75D580C-A172-4521-9A4F-BCF1C1515450@ucsd.edu>



> On Jan 4, 2018, at 1:44 PM, Ben Bolker <bbolker at gmail.com> wrote:
> 
> Chuck: I don't see how this example represents
> incomplete/incommensurate recycling. 


It doesn't. I took your subject line to be the theme of your posting and `incommensurate lengths' to be an instance used to emphasize how silent recycling might `bite' the user. 

Chuck

From wdunlap at tibco.com  Thu Jan  4 23:07:54 2018
From: wdunlap at tibco.com (William Dunlap)
Date: Thu, 4 Jan 2018 14:07:54 -0800
Subject: [Rd] silent recycling in logical indexing
In-Reply-To: <CABghstSnaTTfxs+f0ENUeFJF4UO998_A4xdN7wFhZcmsuHAfog@mail.gmail.com>
References: <6ba8e484-bc14-bcbb-1d8a-4871909e87f2@gmail.com>
 <25B0F325-FD8D-4A43-B711-2329E4847AE9@ucsd.edu>
 <CABghstSnaTTfxs+f0ENUeFJF4UO998_A4xdN7wFhZcmsuHAfog@mail.gmail.com>
Message-ID: <CAF8bMcY2yXcphdwu=mmyV4A0XufnWtrcaRcAdt9vvB6_EVJC3Q@mail.gmail.com>

I have never used this construct.  However, part of my job is seeing how
well CRAN packages work in our reimplementation of the R language
and I am continually surprised by the inventiveness of package writers.

Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Thu, Jan 4, 2018 at 1:44 PM, Ben Bolker <bbolker at gmail.com> wrote:

> Hmm.
>
> Chuck: I don't see how this example represents
> incomplete/incommensurate recycling. Doesn't TRUE replicate from
> length-1 to length-3 in this case (mat[c(TRUE,FALSE),2] would be an
> example of incomplete recycling)?
>
> William: clever, but maybe too clever unless you really need the
> speed? (The clever way is 8 times faster in the following case ...)
>
> x <- rep(1,1e6)
> rbenchmark::benchmark(x[c(FALSE,TRUE,FALSE)],x[seq_along(x) %% 3 == 2])
>
> On the other hand, it takes 0.025 vs 0.003 seconds per iteration ...
> fortunes::fortune("7ms")
>
>
> On Thu, Jan 4, 2018 at 4:09 PM, Berry, Charles <ccberry at ucsd.edu> wrote:
> >
> >
> >> On Jan 4, 2018, at 11:56 AM, Ben Bolker <bbolker at gmail.com> wrote:
> >>
> >>
> >>  Sorry if this has been covered here somewhere in the past, but ...
> >>
> >>  Does anyone know why logical vectors are *silently* recycled, even
> >> when they are incommensurate lengths, when doing logical indexing?
> >
> > It is convenient to use a single `TRUE' in programmatic manipulation of
> subscripts in the same manner as using an empty subscript interactively:
> >
> >> mat<-diag(1:3)
> >> expr1 <- quote(mat[])
> >> expr1[[3]] <- TRUE
> >> expr1[[4]] <- 2
> >> eval(expr1)
> > [1] 0 2 0
> >> mat[,2]
> > [1] 0 2 0
> >
> > HTH,
> >
> > Chuck
>

	[[alternative HTML version deleted]]


From jtelleriar at gmail.com  Thu Jan  4 23:32:07 2018
From: jtelleriar at gmail.com (Juan Telleria)
Date: Thu, 4 Jan 2018 23:32:07 +0100
Subject: [Rd] Community Feedback: Git Repository for R-Devel
In-Reply-To: <CAOKDuOgHmT3FUEY=D6VPWwRk6O8G32BuetkQoL_ZTZCcZD1OGA@mail.gmail.com>
References: <CANNd7==5uV9Cx4gwNfmkC2vtFv++nr_OyeoO3EULJ6ad7qvu=A@mail.gmail.com>
 <CANNd7=kP7Ys+J+F64UKsU_HdhfgFzewi1THZfZEqiwe=_sKR8w@mail.gmail.com>
 <CANNd7=kzGqOdHC+PWXM9C34FJL3jejmjA3kYwbFqhxXWxxP8oA@mail.gmail.com>
 <CANNd7=n5BZ4eagb9E+Dh9hUB1jDhuZenFBpw=X3W33-T7x6fOw@mail.gmail.com>
 <CANNd7=kMGsgH+85_rvm0nhVyFHRT1gKF_ktumda-ki7KXNqb7A@mail.gmail.com>
 <CANNd7=kmzhNwRBVwHJ44HFfKWVZQvL3ut=O7jpSeHN3OkhruWA@mail.gmail.com>
 <CANNd7=nJjOEGnx7Oyoa6uR58gbvxq_PT4nBD638bfEVamg0oaA@mail.gmail.com>
 <CANNd7=kkH57M=ghLvhFAjOsUepBNobkDEqPoVTHteDRmQ0=BoQ@mail.gmail.com>
 <CANNd7=kMOiOg8Qevupcs3_6TLKWQnZcoyddoegYdFp_xmMSm8w@mail.gmail.com>
 <CANNd7=nowWsoZMs2kiusYJRbaUqdC8HGi7MN6HzVPbCJ_GwzEQ@mail.gmail.com>
 <CANNd7=nj+kn1fsgwLajVmTOc2KbCBXr6gXUbXV1zp3bNWpsjyQ@mail.gmail.com>
 <CANNd7=nXy1HqpukX+MmxYoBeVaPENhnkmv33CS6Fp8jgaracyg@mail.gmail.com>
 <CANNd7=nvRYt4DzgN-=e4z51swU8qa12_Ry6cyY-YDVuv+wEUWw@mail.gmail.com>
 <CANNd7=k9J2-DYC7OoU9DM9BCe3ghncAkVa_D99HJMaXvUmLfDw@mail.gmail.com>
 <CANNd7=kbt3E3dsE+h+XB9HH1GH2kDM03uZZCCmBJhuCkuMJL4A@mail.gmail.com>
 <CANNd7==bBNWTDh6cNp_6b1AWBWyBx0TuXK=ug08TOZtWk3FO9w@mail.gmail.com>
 <CANNd7=ktd7Hxh_vnys5SEjgzm_eZZNE8e3iOkVSV-0UqHU3jTg@mail.gmail.com>
 <CANNd7=kCWHU_50yMMGibGfnOfTzvWxz2dymEGnBmUerrO7kQRA@mail.gmail.com>
 <CANNd7=m=v0_8y3gwCNeq-dZNELtc6P+nSJiOq=0dCzq1eXiOwA@mail.gmail.com>
 <CANNd7=mbTRo42u+DBhpOzGoLYaeHYRRU3s4yGrHc=b5+z8o-kg@mail.gmail.com>
 <CANNd7=kJcn-uR5XMHGSS6cq2NWGv1U0gr4cYYqHqKYFHR+_vJw@mail.gmail.com>
 <CANNd7==M0fyFUcyYaw+-3P-mnH7JeXW-QHjBJEs8pC-AExPyJg@mail.gmail.com>
 <CANNd7==AMj3ZNScbbCRPHSM997XOxH21X4VRRG5n-jKzHtfpaQ@mail.gmail.com>
 <CANNd7=nk2_YtE0kWoE3ptHX22b+ddrB4_RKzLsq4AemQc3RNJA@mail.gmail.com>
 <CANNd7=mQVsOxMFHDi6jy_1vcohny08LxqugrhY9M7As208ER7w@mail.gmail.com>
 <CANNd7==sOybEMaDnf7nfmVMTUOp=jsbkPktrPd1asdJ11uAn7w@mail.gmail.com>
 <CANNd7=mZ+xCxu=V5h9684K9=cWZMXxF975CxST0tbrjZCNWG0Q@mail.gmail.com>
 <CANNd7==+Aw1GxbcObFShYRs30W08K6bdWrzKMv2BbSqjCGCEwA@mail.gmail.com>
 <CANNd7=mOgVBCxsDZO8aEFhjYrFabSmaLHmXqvryhszvY+SESew@mail.gmail.com>
 <CANNd7=n-tmYDcL_o3ts-Uosho-2+FLLzgy7++VdwCdXUKnBMVA@mail.gmail.com>
 <CANNd7=kF-xbDqan=pd3jQiDLv=FHvKAnPX-aZzCC5BXXbgjTUQ@mail.gmail.com>
 <CANNd7=ngurw1uUV1=M5vp9tUArUmfKY9KaWfzz0Jmat=A7XVKA@mail.gmail.com>
 <CANNd7==H7gVHY=75XVSsWtrrxatg85c-SJFexEvWBezx_eMZ3w@mail.gmail.com>
 <CANNd7=m0HNTdgdSqQ686ubudiK1u4Ca6wp3k7fFgNFVEyB7O2g@mail.gmail.com>
 <CANNd7=mg1A=yBSz4aq1M+rR2pDYa__33xD+VF=MM82+-qWbX4Q@mail.gmail.com>
 <CANNd7=mwfY4oM488UsDF0zYkeTFhY9x87CV4ANsUMgVtuXtTTw@mail.gmail.com>
 <CANNd7==_1u96TNLWmf3J7xMY1U0NhzSBkdtCQMwbciPOKKzPcA@mail.gmail.com>
 <CANNd7=kZc49PwY9HK+dYRz0Qg-mji-6HWGMSvGnotxKNNExT+Q@mail.gmail.com>
 <CANNd7==ugNBicV3XmW_7ZGT9mvsY+bk8NTdySPvRgySacGfJrw@mail.gmail.com>
 <CANNd7=kiWEteCsrLhJVJnNTG4kKbQWtPKpdLS2aY+5JoHvfy-Q@mail.gmail.com>
 <CANNd7=mZQ-=C4AZyjZVCPSQo+Vnbnquvg9cob8WsTRwzvQkiuQ@mail.gmail.com>
 <CANNd7=nDEi9HFNo50v-feLqKeZaxSc=Z8EVzijYOBe+G+LM2mg@mail.gmail.com>
 <CANNd7==Dn9LyXERRCP-Y_zX9e=sZ7W7=qEfP2Z56T-X8Ls13xw@mail.gmail.com>
 <CANNd7=noWDAPjK2Kifa=5x+Wyf97h8hC25dbkus02Oow_jZFcA@mail.gmail.com>
 <CANNd7==PkTfcimVjnxXtwJOoOEk0uyiU0zFBGMuEtsYmz6ihGg@mail.gmail.com>
 <CANNd7=mbqTFyo3G9MFsZRUnN-Ocv50OcCXO3GtmuL49OE75kqQ@mail.gmail.com>
 <CANNd7=k6H5PSE-XXpvZO9txon1K6cprOmwrxoyu0Th+-Pc2eQg@mail.gmail.com>
 <CANNd7=mvLJ7PKL4cB=SGMJ2J=8uD9cOjivfab1CNW2NPrHafEw@mail.gmail.com>
 <CANNd7=mBkFQyTjjRiJPO+5_c9TNkLKAEh8hjkW29yMNNk3odsw@mail.gmail.com>
 <CANNd7=kbRSmxFr4aaUEys71sk4ei3gtubmoh62a5SDMtLN-MRA@mail.gmail.com>
 <CANNd7=nakiAPh=smK6FOp9VOXdUwdq3OuERyrh5tuk7LUsgu3g@mail.gmail.com>
 <CANNd7=mLLfEf-B7QUvLGw8GVO1B05srWa57EPNmWAdrtBMiRBw@mail.gmail.com>
 <CANNd7=kTA+CLbn0rogt3zXCZhpFOaSY5Cai5M0XFz5MoA0v0qA@mail.gmail.com>
 <CANNd7=kTdwwcisP39mAxhpiteLyiFoojAvkMjcp-+QBORZruWA@mail.gmail.com>
 <CANNd7=nc5HV_UqqdtyD_KYOYV2KL11xraZJrhuUOFQh8J1Cpkw@mail.gmail.com>
 <CANNd7=ko=y7nzR=7MSQ0GjyJpaz7SDutJUDH196VPSXpy3KY_g@mail.gmail.com>
 <CANNd7=kmWaozw9EMLDdCo_gm8bqAw3rR0JjuoVe=Fmx+y14+iw@mail.gmail.com>
 <CANNd7=mGPfvSBb5eRVjLw8zwRJ38=iogPWRM_H-mVb13wrqfYQ@mail.gmail.com>
 <CANNd7=kXC9YS-GxBGXETDyvecksSocacNpz1fxxyW3rPepLrMw@mail.gmail.com>
 <CANNd7=n2POaXz38y0dD8ZpuLCRi4sBhnGN1m9JCk24ciMsqBmw@mail.gmail.com>
 <CANNd7=kvhy5u4xXRT4XYH4-VT4tGtCrLVYUJxhbN+iqa17W7vA@mail.gmail.com>
 <CANNd7=ny=PxQbxeb1wYpmunMaR1KQcsY8ykCOUzK_m16PB_EWg@mail.gmail.com>
 <CANNd7=kHcZW5oYUPDM5nz-2p6UqYeOnZTgcDAbd5GHGFAenrvQ@mail.gmail.com>
 <CANNd7=mS7kh8Y_QYLGE4_a-Bm2r34Sr9vOX9txnrisUwjot-2g@mail.gmail.com>
 <CANNd7=nwEwLU8Rdti8_LDgKGegO6SgyvDxGpLfHhTKyzNi0+Uw@mail.gmail.com>
 <CANNd7=nge=B1HZEVq=JAn=4mwqHO0=AcPPwcc50-K1ZiCa=i8g@mail.gmail.com>
 <CANNd7=mPeU3Ww-nG6Nq75ZjF84GrCsVxmmWV05KTuQHL8cbx-A@mail.gmail.com>
 <CAOKDuOgHmT3FUEY=D6VPWwRk6O8G32BuetkQoL_ZTZCcZD1OGA@mail.gmail.com>
Message-ID: <CANNd7=k_dG5J9SkeSjSzB2JdSA3WoAF6vms948sWhaJKB1fAng@mail.gmail.com>

Thank you Mark, this is what I was looking for.

On Sunday I will read again in detail previous discussion's facts, and
attach the pros and cons here, so that they remain for the future, and the
topic can be closed.

Juan

El 4 ene. 2018 11:06 a. m., "Mark van der Loo" <mark.vanderloo at gmail.com>
escribi?:

> This question has been discussed before on this list:
> http://r.789695.n4.nabble.com/Why-R-project-source-code-is-
> not-on-Github-td4695779.html
>
> See especially Jeroen's answer.
>
> Best,
> Mark
>
> Op do 4 jan. 2018 om 01:11 schreef Juan Telleria <jtelleriar at gmail.com>:
>
>> UNBIASED FACTS:
>> ? Bugzilla & R-devel Mailing Lists: Remain unchanged: Understood as
>> Ticketing platforms for bug pull requests on the R-devel Git Repository.
>>
>> ?  Git Repository Options:
>> A) Github (Cloud with Automated backups from GitHub to CRAN Server):
>> https://github.com
>> B) Gitlab (Selfhosted on CRAN): https://about.gitlab.com
>> C) Phabricator (Selfhosted on CRAN): https://www.phacility.com
>> D) Microsoft Codeplex: https://www.codeplex.com
>> E) Others: Unknown
>>
>> GOOGLE TRENDS:
>> https://trends.google.com/trends/explore?date=all&q=Git,Svn,Github,Gitlab
>>
>> EXAMPLE
>> Git Repository on Core Python: https://github.com/python
>>
>> PERSONAL OPINION / MOTIVATION:
>> I think that moving efforts in this direction is important because it
>> would
>> allow a true Open Source Innovation & Open Collaboration in R between:
>> * R Community.
>> * And R-Core.
>> For:
>> * R Bug Fixes.
>> * And Core Feature Wishlist.
>> As anyone would be able to:
>> * Check the unassigned bugs in Bugzilla (apart from R-Core).
>> * And propose bugs fixes by themselves as Pull requests (by mentioning the
>> Bug ID of Bugzilla or the Mailing Lists).
>>
>> This would allow that _individuals_ either from Universities or Companies
>> interested in the Development of R:
>> * apart of donating economical resources to the R Foundation.
>> * could help to maintain core R Code by themselves.
>> Which aligns with the true spirit of R, which shall be done from
>> contributing individuals, for individuals themselves.
>>
>> It would also allow to put the focus on the precise lines of code changed
>> with each Commit, and revert changes in an easy way, without verbose
>> E-mails: Tidy, Clean, Maintainable, and Fast.
>>
>> At last, I noticed R-devel Archives do not have an E-mail Id (Unique
>> Unsigned Integer), so it would be a good idea to add one for pull requests
>> if Git was adopted.
>>
>> Juan
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

	[[alternative HTML version deleted]]


From jtelleriar at gmail.com  Thu Jan  4 23:43:16 2018
From: jtelleriar at gmail.com (Juan Telleria)
Date: Thu, 4 Jan 2018 23:43:16 +0100
Subject: [Rd] R CMD check warning about compiler warning flags
In-Reply-To: <99445d27-205c-b389-857a-906ba28f199a@gmail.com>
References: <CAFOpNVGKQjffBAF0+yJL7jFh7z7zDj+VsQAqnjXDjM9ZWE02Gg@mail.gmail.com>
 <18c039b2-7b26-2792-565b-f305bae51938@stats.ox.ac.uk>
 <CAFOpNVE-sX3kwPTzcLVY6p6xkQAo8UJJN=bBa6f6_1+kKgV7-g@mail.gmail.com>
 <360d5f57-3512-9efd-de74-38db1c536c68@gmail.com>
 <23101.4830.979381.386647@stat.math.ethz.ch>
 <A9377D4E-29FE-4CFA-8624-3A4643440F3B@me.com>
 <7ca2313a-2143-3d8f-eade-cbb0e6cb6132@gmail.com>
 <CALEXWq2To4hZm9zWauxmg9dd=XGPJccnKKvHX5p67N5KMjBJNg@mail.gmail.com>
 <9b0f83e3-a2d9-7988-dc89-3b2e034b8763@gmail.com>
 <CANNd7=nywaFfrecRtOP2yS4BEg2im_tP2WMN2qig1FEHpZzNvw@mail.gmail.com>
 <CAPtbhHwR-vtjRqtRgSfz4jPHS2m2u02JBcJxwwuKoejawLOW3Q@mail.gmail.com>
 <CANNd7==xYZzmwLfC_FWpHJ+FVmSmDSzQA4vxv_17nocOFbAUxw@mail.gmail.com>
 <CANNd7=khkFCXOE1o8vd_er_ZvdOePryW7AwvKk9VQSgDQTPEAA@mail.gmail.com>
 <c4d86c1b-9285-078a-9f4c-d9cc3e478798@statistik.tu-dortmund.de>
 <99445d27-205c-b389-857a-906ba28f199a@gmail.com>
Message-ID: <CANNd7==vx-yP4-PZCf=PePG+qFqpSzepMgfuxnPidDYjgsqC=w@mail.gmail.com>

I repeat it for all the reason I gave to Duncan on a personal E-mail, It is
a lot of text, and I might be wrong, but I attach it in case it is useful:

A) I feel Version Control (SVN) is great when there is a little group of
people maintaining the code (RCore ~ 20); but Git could allow a bigger
group of people (for example ~200) working simultaneously on perfect and
polish the code without overlapping each other, and RCore (~20) check that
code, and do commits.

This would allow an even more robust base language foundation, or
improvements such as writing some base code more efficiently in C++, etc.

I will put a SQL Transactions simile for further explain this issue:
* SVN is like a Table-Lock.
* And GIT is a Row-Lock in the Table.

Table-Lock works well with very few connections, and as there are only few
connections, users are happy with it.

But it prevents other client connections to query that table at the same
time, and does not allow high concurrency.

B) I feel that Version Control is a little bit obscure for people who are
not from R-Core Mailing List, as:
* We cannot see what gets updated with each R-devel specific version.
* And have communication tools flexible enough to suggest a little patch
(changes in a few lines of code all scattered over R Code) by ourselves
other than E-mails. ?What if our fixes are very sparse?

Communication and Patches for Collaboration are difficult and tedious for
Non-Core Contributors.

C) Reverting a whole version can cause that bugs that where already fixed,
to be reverted (I've seen it once in R).

D) Making a whole new version for a single change in 1 line of code is
inefficient, and time consuming. In GitHub it would take few seconds.

E) Google Trends indicates that GIT is getting more and more used than SVN
by other developments. If it works for others, why should not work for R?

F) It would also be important to know what the opinion of key R
contributors outside R-Core is, for example:

* Hadley Wickham.
* Other important R Package Authors.

If they would feel more willing to help on R Core Language Development with
GitHub, Gitlab, etc.

Juan

	[[alternative HTML version deleted]]


From tomas.kalibera at gmail.com  Fri Jan  5 00:41:47 2018
From: tomas.kalibera at gmail.com (Tomas Kalibera)
Date: Fri, 5 Jan 2018 00:41:47 +0100
Subject: [Rd] Fixed BLAS tests for external BLAS library
In-Reply-To: <CAFhGSbsqEaD9OZyKBfTrbh1i11razBcPB1282kCz9b9mcBHTpQ@mail.gmail.com>
References: <CAFhGSbtyd0-=FTMsE8ty0vdGvhmbTGM+Ww5+KgQpv-xFsfAq0w@mail.gmail.com>
 <d8f5a2bf-48ab-c5cc-d170-83209a79cceb@gmail.com>
 <CAFhGSbsqEaD9OZyKBfTrbh1i11razBcPB1282kCz9b9mcBHTpQ@mail.gmail.com>
Message-ID: <4ec8afc4-dfd2-3dfb-73aa-78c57291c903@gmail.com>


In practical terms, failing tests are not preventing anyone from using 
an optimized BLAS/LAPACK implementation they trust. Building R with 
dynamically linked BLAS on Unix is supported, documented and easy for 
anyone who builds R from source. It is also how Debian/Ubuntu R packages 
are built by default, so R uses whichever BLAS is installed in the 
system and the user does not have to build from source. There is no 
reason why not to do the same thing with another optimized BLAS on 
another OS/distribution.

You may be right that reg-BLAS is too strict (it is testing matrix 
products, expecting equivalence to naive three-loop algorithm, just part 
of it really uses BLAS). I just wanted a concrete example to think about 
as I can't repeat it (e.g. it passes with openblas), but maybe someone 
else will be able to repeat and possibly adjust.

Tomas

On 01/04/2018 09:23 PM, Simon Guest wrote:
> Hi Tomas,
>
> Thanks for your reply.
>
> I find your response curious, however.? Surely the identical() test is 
> simply incorrect when catering for possibly different BLAS 
> implementations?? Or is it the case that conformant BLAS 
> implementations all produce bit-identical results, which seems 
> unlikely?? (Sorry, I am unfamiliar with the BLAS spec.)? Although 
> whatever the answer to this theoretical question, the CentOS 7 
> external BLAS library evidently doesn't produce bit-identical results.
>
> If you don't agree that replacing identical() with all.equal() is 
> clearly the right thing to do, as demonstrated by the CentOS 7 
> external BLAS library failing the test, then I think I will give up 
> now trying to help improve the R sources.? I simply can't justify to 
> my client more time spent on making this work, when we already have a 
> local solution (which I hoped others would be able to benefit from).? 
> Ah well.
>
> cheers,
> Simon
>
> On 5 January 2018 at 00:07, Tomas Kalibera <tomas.kalibera at gmail.com 
> <mailto:tomas.kalibera at gmail.com>> wrote:
>
>     Hi Simon,
>
>     we'd need more information to consider this - particularly which
>     expression gives an imprecise result with ACML and what are the
>     computed values, differences. It is not common for optimized BLAS
>     implementations to fail reg-BLAS.R tests, but it is common for
>     them to report numerical differences in tests of various
>     recommended packages where more complicated computations are done
>     (e.g. nlme), on various platforms.
>
>     Best
>     Tomas
>
>
>     On 12/18/2017 08:56 PM, Simon Guest wrote:
>
>         We build R with dynamically linked BLAS and LAPACK libraries,
>         in order
>         to use the AMD Core Math Library (ACML) multi-threaded
>         implementation
>         of these routines on our 64 core servers.? This is great, and our
>         users really appreciate it.
>
>         However, when building like this, make check fails on the
>         reg-BLAS.R
>         test.? The reason for this is that the expected test output is
>         checked
>         using identical.? By changing all uses of identical in this
>         file to
>         all.equal, the tests pass.
>
>         Specifically, I run this command before make check:
>
>         $ sed -i -e 's/identical/all.equal/g' tests/reg-BLAS.R
>
>         I suggest that the test is fixed like this in the R source code.
>
>         Here is the configure command I use, on CentOS 7:
>         $ ./configure --with-system-zlib --with-system-bzlib
>         --with-system-pcre \
>         ? ? ?--with-blas \
>         ? ? ?--with-lapack \
>         ? ? ?--with-tcl-config=/usr/lib64/tclConfig.sh \
>         ? ? ?--with-tk-config=/usr/lib64/tkConfig.sh \
>         ? ? ?--enable-R-shlib \
>         ? ? ?--enable-prebuilt-html
>
>         cheers,
>         Simon
>
>         ______________________________________________
>         R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>         https://stat.ethz.ch/mailman/listinfo/r-devel
>         <https://stat.ethz.ch/mailman/listinfo/r-devel>
>
>
>
>


	[[alternative HTML version deleted]]


From maechler at stat.math.ethz.ch  Fri Jan  5 09:56:01 2018
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 5 Jan 2018 09:56:01 +0100
Subject: [Rd] Fixed BLAS tests for external BLAS library
In-Reply-To: <4ec8afc4-dfd2-3dfb-73aa-78c57291c903@gmail.com>
References: <CAFhGSbtyd0-=FTMsE8ty0vdGvhmbTGM+Ww5+KgQpv-xFsfAq0w@mail.gmail.com>
 <d8f5a2bf-48ab-c5cc-d170-83209a79cceb@gmail.com>
 <CAFhGSbsqEaD9OZyKBfTrbh1i11razBcPB1282kCz9b9mcBHTpQ@mail.gmail.com>
 <4ec8afc4-dfd2-3dfb-73aa-78c57291c903@gmail.com>
Message-ID: <23119.15777.999726.259747@stat.math.ethz.ch>

>>>>> Tomas Kalibera <tomas.kalibera at gmail.com>
>>>>>     on Fri, 5 Jan 2018 00:41:47 +0100 writes:

    > In practical terms, failing tests are not preventing anyone from using 
    > an optimized BLAS/LAPACK implementation they trust. Building R with 
    > dynamically linked BLAS on Unix is supported, documented and easy for 
    > anyone who builds R from source. It is also how Debian/Ubuntu R packages 
    > are built by default, so R uses whichever BLAS is installed in the 
    > system and the user does not have to build from source. There is no 
    > reason why not to do the same thing with another optimized BLAS on 
    > another OS/distribution.

    > You may be right that reg-BLAS is too strict (it is testing matrix 
    > products, expecting equivalence to naive three-loop algorithm, just part 
    > of it really uses BLAS). I just wanted a concrete example to think about 
    > as I can't repeat it (e.g. it passes with openblas), but maybe someone 
    > else will be able to repeat and possibly adjust.

    > Tomas

Yes, indeed!  I strongly agree with Thomas:  This is about
serious quality assurance of an important part of R,
and replacing all identical() checks there with all.equal()
-- which has a default tolerance of allowing __HALF__ of the
   precision being lost  !! -- in the way you, Simon, proposed,
is definitely basically destroying the QC/QA  we have in place there.

As Tomas said, *some* of the checks possibly should be done
all.equal, but with a very a small tolerance; however other
checks should not allow a tolerance, e.g., all the arithmetic involving
very small integer valued numbers should definitely be exact.

That's why Tomas' (private!) reply, asking for specific details
is 100% appropriate, indeed.

With R we have had a philosophy of trying hard to be correct
first, and fast second... and indeed the last 20 years have
shown many cases where R's use (and checks) actually have
reveiled not only inaccuracies but sometimes also bugs in
LAPACK/BLAS implementations where it sometimes seems, some are
only interested in speed, rather than correctness.

Martin Maechler
ETH Zurich

    > On 01/04/2018 09:23 PM, Simon Guest wrote:
    >> Hi Tomas,
    >> 
    >> Thanks for your reply.
    >> 
    >> I find your response curious, however.? Surely the identical() test is 
    >> simply incorrect when catering for possibly different BLAS 
    >> implementations?? Or is it the case that conformant BLAS 
    >> implementations all produce bit-identical results, which seems 
    >> unlikely?? (Sorry, I am unfamiliar with the BLAS spec.)? Although 
    >> whatever the answer to this theoretical question, the CentOS 7 
    >> external BLAS library evidently doesn't produce bit-identical results.
    >> 
    >> If you don't agree that replacing identical() with all.equal() is 
    >> clearly the right thing to do, as demonstrated by the CentOS 7 
    >> external BLAS library failing the test, then I think I will give up 
    >> now trying to help improve the R sources.? I simply can't justify to 
    >> my client more time spent on making this work, when we already have a 
    >> local solution (which I hoped others would be able to benefit from).? 
    >> Ah well.
    >> 
    >> cheers,
    >> Simon
    >> 
    >> On 5 January 2018 at 00:07, Tomas Kalibera <tomas.kalibera at gmail.com 
    >> <mailto:tomas.kalibera at gmail.com>> wrote:
    >> 
    >> Hi Simon,
    >> 
    >> we'd need more information to consider this - particularly which
    >> expression gives an imprecise result with ACML and what are the
    >> computed values, differences. It is not common for optimized BLAS
    >> implementations to fail reg-BLAS.R tests, but it is common for
    >> them to report numerical differences in tests of various
    >> recommended packages where more complicated computations are done
    >> (e.g. nlme), on various platforms.
    >> 
    >> Best
    >> Tomas
    >> 
    >> 
    >> On 12/18/2017 08:56 PM, Simon Guest wrote:
    >> 
    >> We build R with dynamically linked BLAS and LAPACK libraries,
    >> in order
    >> to use the AMD Core Math Library (ACML) multi-threaded
    >> implementation
    >> of these routines on our 64 core servers.? This is great, and our
    >> users really appreciate it.
    >> 
    >> However, when building like this, make check fails on the
    >> reg-BLAS.R
    >> test.? The reason for this is that the expected test output is
    >> checked
    >> using identical.? By changing all uses of identical in this
    >> file to
    >> all.equal, the tests pass.
    >> 
    >> Specifically, I run this command before make check:
    >> 
    >> $ sed -i -e 's/identical/all.equal/g' tests/reg-BLAS.R
    >> 
    >> I suggest that the test is fixed like this in the R source code.
    >> 
    >> Here is the configure command I use, on CentOS 7:
    >> $ ./configure --with-system-zlib --with-system-bzlib
    >> --with-system-pcre \
    >> ? ? ?--with-blas \
    >> ? ? ?--with-lapack \
    >> ? ? ?--with-tcl-config=/usr/lib64/tclConfig.sh \
    >> ? ? ?--with-tk-config=/usr/lib64/tkConfig.sh \
    >> ? ? ?--enable-R-shlib \
    >> ? ? ?--enable-prebuilt-html
    >> 
    >> cheers,
    >> Simon
    >> 
    >> ______________________________________________
    >> R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >> <https://stat.ethz.ch/mailman/listinfo/r-devel>
    >> 
    >> 
    >> 
    >> 


    > [[alternative HTML version deleted]]

    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel


From jtelleriar at gmail.com  Sat Jan  6 03:40:45 2018
From: jtelleriar at gmail.com (Juan Telleria)
Date: Sat, 6 Jan 2018 03:40:45 +0100
Subject: [Rd] Community Feedback: Git Repository for R-Devel
In-Reply-To: <CAOKDuOgHmT3FUEY=D6VPWwRk6O8G32BuetkQoL_ZTZCcZD1OGA@mail.gmail.com>
References: <CANNd7==5uV9Cx4gwNfmkC2vtFv++nr_OyeoO3EULJ6ad7qvu=A@mail.gmail.com>
 <CANNd7=kP7Ys+J+F64UKsU_HdhfgFzewi1THZfZEqiwe=_sKR8w@mail.gmail.com>
 <CANNd7=kzGqOdHC+PWXM9C34FJL3jejmjA3kYwbFqhxXWxxP8oA@mail.gmail.com>
 <CANNd7=n5BZ4eagb9E+Dh9hUB1jDhuZenFBpw=X3W33-T7x6fOw@mail.gmail.com>
 <CANNd7=kMGsgH+85_rvm0nhVyFHRT1gKF_ktumda-ki7KXNqb7A@mail.gmail.com>
 <CANNd7=kmzhNwRBVwHJ44HFfKWVZQvL3ut=O7jpSeHN3OkhruWA@mail.gmail.com>
 <CANNd7=nJjOEGnx7Oyoa6uR58gbvxq_PT4nBD638bfEVamg0oaA@mail.gmail.com>
 <CANNd7=kkH57M=ghLvhFAjOsUepBNobkDEqPoVTHteDRmQ0=BoQ@mail.gmail.com>
 <CANNd7=kMOiOg8Qevupcs3_6TLKWQnZcoyddoegYdFp_xmMSm8w@mail.gmail.com>
 <CANNd7=nowWsoZMs2kiusYJRbaUqdC8HGi7MN6HzVPbCJ_GwzEQ@mail.gmail.com>
 <CANNd7=nj+kn1fsgwLajVmTOc2KbCBXr6gXUbXV1zp3bNWpsjyQ@mail.gmail.com>
 <CANNd7=nXy1HqpukX+MmxYoBeVaPENhnkmv33CS6Fp8jgaracyg@mail.gmail.com>
 <CANNd7=nvRYt4DzgN-=e4z51swU8qa12_Ry6cyY-YDVuv+wEUWw@mail.gmail.com>
 <CANNd7=k9J2-DYC7OoU9DM9BCe3ghncAkVa_D99HJMaXvUmLfDw@mail.gmail.com>
 <CANNd7=kbt3E3dsE+h+XB9HH1GH2kDM03uZZCCmBJhuCkuMJL4A@mail.gmail.com>
 <CANNd7==bBNWTDh6cNp_6b1AWBWyBx0TuXK=ug08TOZtWk3FO9w@mail.gmail.com>
 <CANNd7=ktd7Hxh_vnys5SEjgzm_eZZNE8e3iOkVSV-0UqHU3jTg@mail.gmail.com>
 <CANNd7=kCWHU_50yMMGibGfnOfTzvWxz2dymEGnBmUerrO7kQRA@mail.gmail.com>
 <CANNd7=m=v0_8y3gwCNeq-dZNELtc6P+nSJiOq=0dCzq1eXiOwA@mail.gmail.com>
 <CANNd7=mbTRo42u+DBhpOzGoLYaeHYRRU3s4yGrHc=b5+z8o-kg@mail.gmail.com>
 <CANNd7=kJcn-uR5XMHGSS6cq2NWGv1U0gr4cYYqHqKYFHR+_vJw@mail.gmail.com>
 <CANNd7==M0fyFUcyYaw+-3P-mnH7JeXW-QHjBJEs8pC-AExPyJg@mail.gmail.com>
 <CANNd7==AMj3ZNScbbCRPHSM997XOxH21X4VRRG5n-jKzHtfpaQ@mail.gmail.com>
 <CANNd7=nk2_YtE0kWoE3ptHX22b+ddrB4_RKzLsq4AemQc3RNJA@mail.gmail.com>
 <CANNd7=mQVsOxMFHDi6jy_1vcohny08LxqugrhY9M7As208ER7w@mail.gmail.com>
 <CANNd7==sOybEMaDnf7nfmVMTUOp=jsbkPktrPd1asdJ11uAn7w@mail.gmail.com>
 <CANNd7=mZ+xCxu=V5h9684K9=cWZMXxF975CxST0tbrjZCNWG0Q@mail.gmail.com>
 <CANNd7==+Aw1GxbcObFShYRs30W08K6bdWrzKMv2BbSqjCGCEwA@mail.gmail.com>
 <CANNd7=mOgVBCxsDZO8aEFhjYrFabSmaLHmXqvryhszvY+SESew@mail.gmail.com>
 <CANNd7=n-tmYDcL_o3ts-Uosho-2+FLLzgy7++VdwCdXUKnBMVA@mail.gmail.com>
 <CANNd7=kF-xbDqan=pd3jQiDLv=FHvKAnPX-aZzCC5BXXbgjTUQ@mail.gmail.com>
 <CANNd7=ngurw1uUV1=M5vp9tUArUmfKY9KaWfzz0Jmat=A7XVKA@mail.gmail.com>
 <CANNd7==H7gVHY=75XVSsWtrrxatg85c-SJFexEvWBezx_eMZ3w@mail.gmail.com>
 <CANNd7=m0HNTdgdSqQ686ubudiK1u4Ca6wp3k7fFgNFVEyB7O2g@mail.gmail.com>
 <CANNd7=mg1A=yBSz4aq1M+rR2pDYa__33xD+VF=MM82+-qWbX4Q@mail.gmail.com>
 <CANNd7=mwfY4oM488UsDF0zYkeTFhY9x87CV4ANsUMgVtuXtTTw@mail.gmail.com>
 <CANNd7==_1u96TNLWmf3J7xMY1U0NhzSBkdtCQMwbciPOKKzPcA@mail.gmail.com>
 <CANNd7=kZc49PwY9HK+dYRz0Qg-mji-6HWGMSvGnotxKNNExT+Q@mail.gmail.com>
 <CANNd7==ugNBicV3XmW_7ZGT9mvsY+bk8NTdySPvRgySacGfJrw@mail.gmail.com>
 <CANNd7=kiWEteCsrLhJVJnNTG4kKbQWtPKpdLS2aY+5JoHvfy-Q@mail.gmail.com>
 <CANNd7=mZQ-=C4AZyjZVCPSQo+Vnbnquvg9cob8WsTRwzvQkiuQ@mail.gmail.com>
 <CANNd7=nDEi9HFNo50v-feLqKeZaxSc=Z8EVzijYOBe+G+LM2mg@mail.gmail.com>
 <CANNd7==Dn9LyXERRCP-Y_zX9e=sZ7W7=qEfP2Z56T-X8Ls13xw@mail.gmail.com>
 <CANNd7=noWDAPjK2Kifa=5x+Wyf97h8hC25dbkus02Oow_jZFcA@mail.gmail.com>
 <CANNd7==PkTfcimVjnxXtwJOoOEk0uyiU0zFBGMuEtsYmz6ihGg@mail.gmail.com>
 <CANNd7=mbqTFyo3G9MFsZRUnN-Ocv50OcCXO3GtmuL49OE75kqQ@mail.gmail.com>
 <CANNd7=k6H5PSE-XXpvZO9txon1K6cprOmwrxoyu0Th+-Pc2eQg@mail.gmail.com>
 <CANNd7=mvLJ7PKL4cB=SGMJ2J=8uD9cOjivfab1CNW2NPrHafEw@mail.gmail.com>
 <CANNd7=mBkFQyTjjRiJPO+5_c9TNkLKAEh8hjkW29yMNNk3odsw@mail.gmail.com>
 <CANNd7=kbRSmxFr4aaUEys71sk4ei3gtubmoh62a5SDMtLN-MRA@mail.gmail.com>
 <CANNd7=nakiAPh=smK6FOp9VOXdUwdq3OuERyrh5tuk7LUsgu3g@mail.gmail.com>
 <CANNd7=mLLfEf-B7QUvLGw8GVO1B05srWa57EPNmWAdrtBMiRBw@mail.gmail.com>
 <CANNd7=kTA+CLbn0rogt3zXCZhpFOaSY5Cai5M0XFz5MoA0v0qA@mail.gmail.com>
 <CANNd7=kTdwwcisP39mAxhpiteLyiFoojAvkMjcp-+QBORZruWA@mail.gmail.com>
 <CANNd7=nc5HV_UqqdtyD_KYOYV2KL11xraZJrhuUOFQh8J1Cpkw@mail.gmail.com>
 <CANNd7=ko=y7nzR=7MSQ0GjyJpaz7SDutJUDH196VPSXpy3KY_g@mail.gmail.com>
 <CANNd7=kmWaozw9EMLDdCo_gm8bqAw3rR0JjuoVe=Fmx+y14+iw@mail.gmail.com>
 <CANNd7=mGPfvSBb5eRVjLw8zwRJ38=iogPWRM_H-mVb13wrqfYQ@mail.gmail.com>
 <CANNd7=kXC9YS-GxBGXETDyvecksSocacNpz1fxxyW3rPepLrMw@mail.gmail.com>
 <CANNd7=n2POaXz38y0dD8ZpuLCRi4sBhnGN1m9JCk24ciMsqBmw@mail.gmail.com>
 <CANNd7=kvhy5u4xXRT4XYH4-VT4tGtCrLVYUJxhbN+iqa17W7vA@mail.gmail.com>
 <CANNd7=ny=PxQbxeb1wYpmunMaR1KQcsY8ykCOUzK_m16PB_EWg@mail.gmail.com>
 <CANNd7=kHcZW5oYUPDM5nz-2p6UqYeOnZTgcDAbd5GHGFAenrvQ@mail.gmail.com>
 <CANNd7=mS7kh8Y_QYLGE4_a-Bm2r34Sr9vOX9txnrisUwjot-2g@mail.gmail.com>
 <CANNd7=nwEwLU8Rdti8_LDgKGegO6SgyvDxGpLfHhTKyzNi0+Uw@mail.gmail.com>
 <CANNd7=nge=B1HZEVq=JAn=4mwqHO0=AcPPwcc50-K1ZiCa=i8g@mail.gmail.com>
 <CANNd7=mPeU3Ww-nG6Nq75ZjF84GrCsVxmmWV05KTuQHL8cbx-A@mail.gmail.com>
 <CAOKDuOgHmT3FUEY=D6VPWwRk6O8G32BuetkQoL_ZTZCcZD1OGA@mail.gmail.com>
Message-ID: <CANNd7==R9FgT0aw5r59Ez3bF5u0Haj43WUE--qJWBCTpoUWviQ@mail.gmail.com>

I attach a basic State of Art:

##########################################################################################################################################
# State of Art Analysis of Git vs SVN
##########################################################################################################################################

Scopus Keywords: GIT AND SVN

##########################################################################################################################################
# 1. How Do Centralized (SVN) and Distributed Version Control (GIT) Systems
Impact Software Changes? (22 Citations; Published: 2014)
##########################################################################################################################################

1.1 Paper Conclusions

We found that the use of CVCS and DVCS have observable effects on
developers, teams and processes. The most surprising findings are that (i)
the size of commits in DVCS was smaller than in CVCS, (ii) developers split
commits (group changes by intent) more often in DVCS, and (iii) DVCS
commits are more likely to reference issue tracking labels. These show that
DVCS contain higher quality commits compared to CVCS due to their smaller
size, cohesive changes and the presence of issue tracking labels. The
survey provided valuable information on why developers prefer one paradigm
versus the other. DVCS are preferred because of killer features, such as
the ability of committing locally. In contrast CVCS are preferred for their
ease of use and faster learning curve.

1.2 Full Paper

http://dig.cs.illinois.edu/papers/ICSE14_Caius.pdf

##########################################################################################################################################
# 2 Version Control with Git (Book: J Loeliger, M McCullough ? 2012)
##########################################################################################################################################

2.1 Book Introduction

***The Birth of Git***

Often, when there is discord between a tool and a project, the developers
simply create a new tool. Indeed, in the world of software, the temptation
to create new tools can be deceptively easy and inviting. In the face of
many existing version control systems, the decision to create another
shouldn?t be made casually. However, given a critical need, a bit of
insight, and a healthy dose of motivation, forging a new tool can be
exactly the right course.

Git, affectionately termed ?the information manager from hell? by its
creator is such a tool. Although the precise circumstances and timing of
its genesis are shrouded in political wrangling within the Linux Kernel
community, there is no doubt that what came from that fire is a
well-engineered version control system capable of supporting worldwide
development of software on a large scale.

Prior to Git, the Linux Kernel was developed using the commercial BitKeeper
VCS, which provided sophisticated operations not available in then-current,
free software version control systems such as RCS and CVS. However, when
the company that owned BitKeeper placed additional restrictions on its
?free as in beer? version in the spring of 2005, the Linux community
realized that BitKeeper was no longer a viable solution.

Linus looked for alternatives. Eschewing commercial solutions, he studied
the free software packages but found the same limitations and flaws that
led him to reject them previously. What was wrong with the existing VCS
systems? What were the elusive missing features or characteristics that
Linus wanted and couldn?t find?

***Facilitate distributed development***

There are many facets to ?distributed development,? and Linus wanted a new
VCS that would cover most of them. It had to allow parallel as well as
independent and simultaneous development in private repositories without
the need for constant synchronization with a central repository, which
could form a development bottleneck. It had to allow multiple developers in
multiple locations even if some of them were offline temporarily.

***Scale to handle thousands of developers***

It isn?t enough just to have a distributed development model. Linus knew
that thousands of developers contribute to each Linux release, so any new
VCS had to handle a very large number of developers, whether they were
working on the same or on different parts of a common project. And the new
VCS had to be able to integrate all of their work reliably.

***Perform quickly and efficiently***

 Linus was determined to ensure that a new VCS was fast and efficient. In
order to support the sheer volume of update operations that would be made
on the Linux Kernel alone, he knew that both individual update operations
and network transfer operations would have to be very fast. To save space
and thus transfer time, compression and ?delta? techniques would be needed.
Using a distributed model instead of a centralized model also ensured that
network latency would not hinder daily development.

***Maintain integrity and trust***

Because Git is a distributed revision control system, it is vital to obtain
absolute assurance that data integrity is maintained and is not somehow
being altered. How do you know the data hasn?t been altered in transition
from one developer to the next, or from one repository to the next? For
that matter, how do you know that the data in a Git repository is even what
it purports to be?

Git uses a common cryptographic hash function, called Secure Hash Function
(SHA1), to name and identify objects within its database. Although perhaps
not absolute, in practice it has proven to be solid enough to ensure
integrity and trust for all of Git?s distributed repositories.

***Enforce accountability***

One of the key aspects of a version control system is knowing who changed
files, and if at all possible, why. Git enforces a change log on every
commit that changes a file. The information stored in that change log is
left up to the developer, project requirements, management, convention,
etc. Git ensures that changes will not happen mysteriously to files under
version control because there is an accountability trail for all changes.

***Immutability***

Git?s repository database contains data objects that are immutable. That
is, once they have been created and placed in the database, they cannot be
modified. They can be recreated differently, of course, but the original
data cannot be altered without consequences. The design of the Git database
means that the entire history stored within the version control database is
also immutable. Using immutable objects has several advantages, including
very quick comparison for equality.

***Atomic transactions***

With atomic transactions, a number of different but related changes are
performed either all together or not at all. This property ensures that the
version control database is not left in a partially changed (and hence
possibly corrupted) state while an update or commit is happening. Git
implements atomic transactions by recording complete, discrete repository
states that cannot be broken down into individual or smaller state changes.

***Support and encourage branched development***

Almost all VCSs can name different genealogies of development within a
single project. For instance, one sequence of code changes could be called
?development? while another is referred to as ?test.? Each version control
system can also split a single line of development into multiple lines and
then unify, or merge, the disparate threads. As with most VCSs, Git calls a
line of development a branch and assigns each branch a name.

Along with branching comes merging. Just as Linus wanted easy branching to
foster alternate lines of development, he also wanted to facilitate easy
merging of those branches. Because branch merging has often been a painful
and difficult operation in version control systems, it would be essential
to support clean, fast, easy merging.

***Complete repositories***

So that individual developers needn?t query a centralized repository server
for historical revision information, it was essential that each repository
have a complete copy of all historical revisions of every file.

***A clean internal design***

Even though end users might not be concerned about a clean internal design,
it was important to Linus and ultimately to other Git developers as well.
Git?s object model has simple structures that capture fundamental concepts
for raw data, directory structure, recording changes, etc. Coupling the
object model with a globally unique identifier technique allowed a very
clean data model that could be managed in a distributed development
environment.

***Be free, as in freedom***

 ?Nuff said.

Given a clean slate to create a new VCS, many talented software engineers
collaborated and Git was born. Necessity was the mother of invention again!

1.2.2        Book Link

https://books.google.es/books?hl=en&lr=&id=aM7-Oxo3qdQC&oi=fnd&pg=PR3&dq=GIT+SVN&ots=39uhIKPlpc&sig=PmxABWMem-h4Fp1-JR-4C2HTwUY&redir_esc=y#v=onepage&q=GIT%20SVN&f=false

Chapter 18: ?Using Git with Subversion Repositories?, is of special
interest.

You can find the full book accessible with a basic search in Google:

?Version Control with Git? filetype:pdf

Juan

	[[alternative HTML version deleted]]


From jtelleriar at gmail.com  Sat Jan  6 04:31:27 2018
From: jtelleriar at gmail.com (Juan Telleria)
Date: Sat, 6 Jan 2018 04:31:27 +0100
Subject: [Rd] Community Feedback: Git Repository for R-Devel
In-Reply-To: <CANNd7==R9FgT0aw5r59Ez3bF5u0Haj43WUE--qJWBCTpoUWviQ@mail.gmail.com>
References: <CANNd7==5uV9Cx4gwNfmkC2vtFv++nr_OyeoO3EULJ6ad7qvu=A@mail.gmail.com>
 <CANNd7=kP7Ys+J+F64UKsU_HdhfgFzewi1THZfZEqiwe=_sKR8w@mail.gmail.com>
 <CANNd7=kzGqOdHC+PWXM9C34FJL3jejmjA3kYwbFqhxXWxxP8oA@mail.gmail.com>
 <CANNd7=n5BZ4eagb9E+Dh9hUB1jDhuZenFBpw=X3W33-T7x6fOw@mail.gmail.com>
 <CANNd7=kMGsgH+85_rvm0nhVyFHRT1gKF_ktumda-ki7KXNqb7A@mail.gmail.com>
 <CANNd7=kmzhNwRBVwHJ44HFfKWVZQvL3ut=O7jpSeHN3OkhruWA@mail.gmail.com>
 <CANNd7=nJjOEGnx7Oyoa6uR58gbvxq_PT4nBD638bfEVamg0oaA@mail.gmail.com>
 <CANNd7=kkH57M=ghLvhFAjOsUepBNobkDEqPoVTHteDRmQ0=BoQ@mail.gmail.com>
 <CANNd7=kMOiOg8Qevupcs3_6TLKWQnZcoyddoegYdFp_xmMSm8w@mail.gmail.com>
 <CANNd7=nowWsoZMs2kiusYJRbaUqdC8HGi7MN6HzVPbCJ_GwzEQ@mail.gmail.com>
 <CANNd7=nj+kn1fsgwLajVmTOc2KbCBXr6gXUbXV1zp3bNWpsjyQ@mail.gmail.com>
 <CANNd7=nXy1HqpukX+MmxYoBeVaPENhnkmv33CS6Fp8jgaracyg@mail.gmail.com>
 <CANNd7=nvRYt4DzgN-=e4z51swU8qa12_Ry6cyY-YDVuv+wEUWw@mail.gmail.com>
 <CANNd7=k9J2-DYC7OoU9DM9BCe3ghncAkVa_D99HJMaXvUmLfDw@mail.gmail.com>
 <CANNd7=kbt3E3dsE+h+XB9HH1GH2kDM03uZZCCmBJhuCkuMJL4A@mail.gmail.com>
 <CANNd7==bBNWTDh6cNp_6b1AWBWyBx0TuXK=ug08TOZtWk3FO9w@mail.gmail.com>
 <CANNd7=ktd7Hxh_vnys5SEjgzm_eZZNE8e3iOkVSV-0UqHU3jTg@mail.gmail.com>
 <CANNd7=kCWHU_50yMMGibGfnOfTzvWxz2dymEGnBmUerrO7kQRA@mail.gmail.com>
 <CANNd7=m=v0_8y3gwCNeq-dZNELtc6P+nSJiOq=0dCzq1eXiOwA@mail.gmail.com>
 <CANNd7=mbTRo42u+DBhpOzGoLYaeHYRRU3s4yGrHc=b5+z8o-kg@mail.gmail.com>
 <CANNd7=kJcn-uR5XMHGSS6cq2NWGv1U0gr4cYYqHqKYFHR+_vJw@mail.gmail.com>
 <CANNd7==M0fyFUcyYaw+-3P-mnH7JeXW-QHjBJEs8pC-AExPyJg@mail.gmail.com>
 <CANNd7==AMj3ZNScbbCRPHSM997XOxH21X4VRRG5n-jKzHtfpaQ@mail.gmail.com>
 <CANNd7=nk2_YtE0kWoE3ptHX22b+ddrB4_RKzLsq4AemQc3RNJA@mail.gmail.com>
 <CANNd7=mQVsOxMFHDi6jy_1vcohny08LxqugrhY9M7As208ER7w@mail.gmail.com>
 <CANNd7==sOybEMaDnf7nfmVMTUOp=jsbkPktrPd1asdJ11uAn7w@mail.gmail.com>
 <CANNd7=mZ+xCxu=V5h9684K9=cWZMXxF975CxST0tbrjZCNWG0Q@mail.gmail.com>
 <CANNd7==+Aw1GxbcObFShYRs30W08K6bdWrzKMv2BbSqjCGCEwA@mail.gmail.com>
 <CANNd7=mOgVBCxsDZO8aEFhjYrFabSmaLHmXqvryhszvY+SESew@mail.gmail.com>
 <CANNd7=n-tmYDcL_o3ts-Uosho-2+FLLzgy7++VdwCdXUKnBMVA@mail.gmail.com>
 <CANNd7=kF-xbDqan=pd3jQiDLv=FHvKAnPX-aZzCC5BXXbgjTUQ@mail.gmail.com>
 <CANNd7=ngurw1uUV1=M5vp9tUArUmfKY9KaWfzz0Jmat=A7XVKA@mail.gmail.com>
 <CANNd7==H7gVHY=75XVSsWtrrxatg85c-SJFexEvWBezx_eMZ3w@mail.gmail.com>
 <CANNd7=m0HNTdgdSqQ686ubudiK1u4Ca6wp3k7fFgNFVEyB7O2g@mail.gmail.com>
 <CANNd7=mg1A=yBSz4aq1M+rR2pDYa__33xD+VF=MM82+-qWbX4Q@mail.gmail.com>
 <CANNd7=mwfY4oM488UsDF0zYkeTFhY9x87CV4ANsUMgVtuXtTTw@mail.gmail.com>
 <CANNd7==_1u96TNLWmf3J7xMY1U0NhzSBkdtCQMwbciPOKKzPcA@mail.gmail.com>
 <CANNd7=kZc49PwY9HK+dYRz0Qg-mji-6HWGMSvGnotxKNNExT+Q@mail.gmail.com>
 <CANNd7==ugNBicV3XmW_7ZGT9mvsY+bk8NTdySPvRgySacGfJrw@mail.gmail.com>
 <CANNd7=kiWEteCsrLhJVJnNTG4kKbQWtPKpdLS2aY+5JoHvfy-Q@mail.gmail.com>
 <CANNd7=mZQ-=C4AZyjZVCPSQo+Vnbnquvg9cob8WsTRwzvQkiuQ@mail.gmail.com>
 <CANNd7=nDEi9HFNo50v-feLqKeZaxSc=Z8EVzijYOBe+G+LM2mg@mail.gmail.com>
 <CANNd7==Dn9LyXERRCP-Y_zX9e=sZ7W7=qEfP2Z56T-X8Ls13xw@mail.gmail.com>
 <CANNd7=noWDAPjK2Kifa=5x+Wyf97h8hC25dbkus02Oow_jZFcA@mail.gmail.com>
 <CANNd7==PkTfcimVjnxXtwJOoOEk0uyiU0zFBGMuEtsYmz6ihGg@mail.gmail.com>
 <CANNd7=mbqTFyo3G9MFsZRUnN-Ocv50OcCXO3GtmuL49OE75kqQ@mail.gmail.com>
 <CANNd7=k6H5PSE-XXpvZO9txon1K6cprOmwrxoyu0Th+-Pc2eQg@mail.gmail.com>
 <CANNd7=mvLJ7PKL4cB=SGMJ2J=8uD9cOjivfab1CNW2NPrHafEw@mail.gmail.com>
 <CANNd7=mBkFQyTjjRiJPO+5_c9TNkLKAEh8hjkW29yMNNk3odsw@mail.gmail.com>
 <CANNd7=kbRSmxFr4aaUEys71sk4ei3gtubmoh62a5SDMtLN-MRA@mail.gmail.com>
 <CANNd7=nakiAPh=smK6FOp9VOXdUwdq3OuERyrh5tuk7LUsgu3g@mail.gmail.com>
 <CANNd7=mLLfEf-B7QUvLGw8GVO1B05srWa57EPNmWAdrtBMiRBw@mail.gmail.com>
 <CANNd7=kTA+CLbn0rogt3zXCZhpFOaSY5Cai5M0XFz5MoA0v0qA@mail.gmail.com>
 <CANNd7=kTdwwcisP39mAxhpiteLyiFoojAvkMjcp-+QBORZruWA@mail.gmail.com>
 <CANNd7=nc5HV_UqqdtyD_KYOYV2KL11xraZJrhuUOFQh8J1Cpkw@mail.gmail.com>
 <CANNd7=ko=y7nzR=7MSQ0GjyJpaz7SDutJUDH196VPSXpy3KY_g@mail.gmail.com>
 <CANNd7=kmWaozw9EMLDdCo_gm8bqAw3rR0JjuoVe=Fmx+y14+iw@mail.gmail.com>
 <CANNd7=mGPfvSBb5eRVjLw8zwRJ38=iogPWRM_H-mVb13wrqfYQ@mail.gmail.com>
 <CANNd7=kXC9YS-GxBGXETDyvecksSocacNpz1fxxyW3rPepLrMw@mail.gmail.com>
 <CANNd7=n2POaXz38y0dD8ZpuLCRi4sBhnGN1m9JCk24ciMsqBmw@mail.gmail.com>
 <CANNd7=kvhy5u4xXRT4XYH4-VT4tGtCrLVYUJxhbN+iqa17W7vA@mail.gmail.com>
 <CANNd7=ny=PxQbxeb1wYpmunMaR1KQcsY8ykCOUzK_m16PB_EWg@mail.gmail.com>
 <CANNd7=kHcZW5oYUPDM5nz-2p6UqYeOnZTgcDAbd5GHGFAenrvQ@mail.gmail.com>
 <CANNd7=mS7kh8Y_QYLGE4_a-Bm2r34Sr9vOX9txnrisUwjot-2g@mail.gmail.com>
 <CANNd7=nwEwLU8Rdti8_LDgKGegO6SgyvDxGpLfHhTKyzNi0+Uw@mail.gmail.com>
 <CANNd7=nge=B1HZEVq=JAn=4mwqHO0=AcPPwcc50-K1ZiCa=i8g@mail.gmail.com>
 <CANNd7=mPeU3Ww-nG6Nq75ZjF84GrCsVxmmWV05KTuQHL8cbx-A@mail.gmail.com>
 <CAOKDuOgHmT3FUEY=D6VPWwRk6O8G32BuetkQoL_ZTZCcZD1OGA@mail.gmail.com>
 <CANNd7==R9FgT0aw5r59Ez3bF5u0Haj43WUE--qJWBCTpoUWviQ@mail.gmail.com>
Message-ID: <CANNd7==jdaHaL8svyWYTYeAsHthTHZJWdYyxTw3GsJoFwk0bgA@mail.gmail.com>

########################################################################################################################################
# R-devel Archives: ?Why R-project source code is not on Github"
[Summary: Aug 2014]
########################################################################################################################################

Key Citations (Pros and Cons) from R-devel Archives

########################################################################################################################################
# GIT PROS
########################################################################################################################################

1. [Simon Urbanek R-devel Aug 21, 2014] Github just makes it much
easier to create and post patches to the project - it has nothing to
do with write access - typically on Github the community has no write
access, either.

2. [Simon Urbanek R-devel Aug 21, 2014] Using pull requests is
certainly much less fragile than e-mails and patches are based on
forked branches, so you can directly build the patched version if you
want without manually applying the patch - and you see the whole
history so you can pick out things logically.

3. [Simon Urbanek R-devel Aug 21, 2014] You can comment on individual
patches to discuss them and even individual commits - often leading to
a quick round trip time of revising it.

4. [Yihui Xie-2 R-devel Aug 22, 2014] Sometimes the patches are not
worth emails back and forth, such as the correction of typos. I cannot
think of anything else that is more efficient than being able to
discuss the patch right in the lines of diff's.

5. [Gaurav Sehrawat R-devel Aug 24, 2014] Bridging gap between web2.0
and web1.0 development methodologies  & thus passing code to younger
generation .

6. [Jeroen Ooms. R-devel Aug 24, 2014] By now all activity of r-base
[1] cran [2] and r-forge [3] is
continuously mirrored on Github, which already gives unprecedented
insight in developments. At least several r-core members [4,5,6,7,8]
have been spotted on Github, and this years useR2014 website [9] was
developed and hosted completely on Github. It seems like a matter of
time until the benefits outweigh the cost of a migration, even to the
more conservative stakeholders.

7. [Spencer Graves-2 R-devel Aug 24, 2014] We could use Git without
Github (Gitlab, ?)

8. [Spencer Graves-2 R-devel Aug 24, 2014] It should be easy and cheap
for someone to program a server to make daily backup copies of
whatever we want from Github.  This could provide an insurance policy
in case events push the group to leave Github.

9. [Brian Rowe R-devel Aug 24, 2014] One thing to note about git vs
svn is that each git repository is a complete repository containing
the full history, so despite github acting as a central repository, it
is not the same as a central svn repository. In svn the central
repository is typically the only repository with a complete revision
history, but that is not the case with git.

10. [Simon Urbanek R-devel Aug 25, 2014] There is no point in using
git alone (Github actually supports direct SVN access as well).

11. [Simon Urbanek R-devel Aug 25, 2014] Github: The whole point are
the collaborative features.

########################################################################################################################################
# GIT CONS
########################################################################################################################################

1. [Marc Schwartz R-devel Aug 21, 2014] Since the current SVN based
system works well for them (R Core) and provides restricted write
access that they can control, there is no motivation to move to an
alternative version control system unless they would find it to be
superior for their own development processes.

2. [Jeroen Ooms. R-devel Aug 24, 2014] These things take time

3. [Jeroen Ooms. R-devel Aug 24, 2014] However moving development of a
medium sized, 20 year old open source project is not trivial. You are
dealing with a large commit history and many contributors that all
have to overhaul their familiar tools and development practices
overnight.

4. [Jeroen Ooms. R-devel Aug 24, 2014] There is also the
infrastructure of nightly builds and CRAN r-devel package checking
that relies on the svn.

5. [Jeroen Ooms. R-devel Aug 24, 2014] Moreover moving to Github means
changes in communications, for example replacing the current bug
tracking system to Github "issues".

6. [Jeroen Ooms. R-devel Aug 24, 2014] In addition, several members
are skeptical about putting source code in the hands of a for-profit
US company, and other legal issues.

7. [Jeroen Ooms. R-devel Aug 24, 2014] The most critical piece of
making such a transition is a detailed proposal outlining what the
migration would involve, the cost/benefits, a planning, and someone
that is willing to take the lead. Only on the basis of such a serious
proposal you can have a discussion in which everyone can voice
concerns, be assured that his/her interests are secure, and the idea
can eventually be put up for a vote.

8. [Kirill M?ller. Jan 05, 2018 (With Permission)] Migration Technical Problems:
- Keeping monotonous revision numbers seems to be a requirement for
migrating to GitHub.
- It may be more difficult to apply patches produced by "git
format-patch" or "git diff" (obtained from Winston's GitHub mirror) to
an SVN working copy, because patches created by Git are missing the
SVN base revision. (This is an obstacle to adopting GitHub gradually.)

* NOTE: Paper (Previous Transition Experience):
http://iopscience.iop.org/article/10.1088/1742-6596/898/7/072024/pdf


From Pete.Thompson at iqvia.com  Mon Jan  8 13:43:14 2018
From: Pete.Thompson at iqvia.com (Thompson, Pete)
Date: Mon, 8 Jan 2018 12:43:14 +0000
Subject: [Rd] Bug 17159 - recursive dir.create() fails on windows shares due
 to permissions
Message-ID: <44DC0D86-8E3B-42B8-99DA-71A588AD8616@quintiles.com>

Hi, I?d like to ask about bug 17159:

https://bugs.r-project.org/bugzilla/show_bug.cgi?id=17159

I can confirm that I see exactly this bug when using dir.create on paths of UNC form (\\server\share\xxx), with the recursive flag set. I?m seeing this when attempting to use install.packages with such a path (which I know isn?t supported, but would be great if it was!). I can see that a patch has been suggested for the problem and from looking at the source code I believe it?s a correct fix. Is there a possibility of getting this patch included?

The existing logic for Windows recursive dir.create (platform.c lines 2209-22203) appears to be:
- Skip over any \\share at the start of the directory name
- Loop while there are pieces of directory name left (i.e. we haven?t hit the last \ character)
  = Find the next portion of the directory name (up to the next \ character)
  = Attempt to create the directory (unless it is of the form x: - i.e. a drive name)
  = Ignore any ?already exists? errors, otherwise throw an error

This logic appears flawed in that it skips \\share which isn?t a valid path format (according to https://msdn.microsoft.com/en-us/library/windows/desktop/aa365247(v=vs.85).aspx ). Dredging my memory, it?s possible that \\share was a supported format in very old versions of Windows, but it?s been a long time since the UNC format came in. It?s also possible that \\share is a valid format in some odd environments, but the UNC format is far more widely used.

The patch suggested by Evan Cortens is simply to change the skip logic to skip over \\server\share instead of \\share. This will certainly fix the common use case of using UNC paths, but doesn?t attempt to deal with all the more complex options in Microsoft?s documentation. I doubt many users would ask for the complex cases, but the basic UNC format would be of wide applicability.

Thanks
Pete Thompson
Director, Information Technology
Head of Spotfire Centre of Excellence
IQVIA




________________________________________
IMPORTANT - PLEASE READ: This electronic message, including its attachments, is CONFIDENTIAL and may contain PROPRIETARY or LEGALLY PRIVILEGED or PROTECTED information and is intended for the authorized recipient of the sender. If you are not the intended recipient, you are hereby notified that any use, disclosure, copying, or distribution of this message or any of the information included in it is unauthorized and strictly prohibited. If you have received this message in error, please immediately notify the sender by reply e-mail and permanently delete this message and its attachments, along with any copies thereof, from all locations received (e.g., computer, mobile device, etc.). Thank you.

From gcollange at gmail.com  Mon Jan  8 14:41:11 2018
From: gcollange at gmail.com (Guillaume Collange)
Date: Mon, 8 Jan 2018 14:41:11 +0100
Subject: [Rd] Fwd: R/MKL Intel 2018 Compatibility
In-Reply-To: <CAJ48xmBo+R8ye36A2UnPXiaq4BCqvJ5d5y6Q8AqFaZC11CtriQ@mail.gmail.com>
References: <CAJ48xmAzJSZLdWmXBa7vMLAb8FZa1qT6ud0khaU+Oxf6ytCckw@mail.gmail.com>
 <CAJ48xmBo+R8ye36A2UnPXiaq4BCqvJ5d5y6Q8AqFaZC11CtriQ@mail.gmail.com>
Message-ID: <CAJ48xmAT9pPictc46Z_K+=EqCYzY-42J6UdhE=qO2sB-ShyQaA@mail.gmail.com>

Dear all,



I would like to submit an issue that we are facing.



Indeed, in our environment, we are optimizing the R code to speed up some
mathematical calculations as matrix products using the INTEL libraries (
MKL) ( https://software.intel.com/en-us/mkl )



With the last version of the MKL libraries Intel 2018, we are facing to an
issue with *all INTERNAL command* that are executing in R. The R console is
freezing executing a process at 100% and never stop!!! It?s really an issue
for us.



As example, we can reproduce the error with *crossprod. Crossprod *which is
a wrapper of BLAS GEMM (optimized with MKL libraries), in this function it
seems that variables are not protected ( PROTECT(); UNPROTECT() ), see the
screenshot below, which is a recommendation for external commands:



Picture1


*RECOMMANDATION*

*Picture2*

*Code of CROSSPROD*

 Picture 3



If we are recoding the CROSSPROD function with PROTECTT

No more issues?





Do you have any idea to solve this bug? Any recommendations?





Thank you by advance for your help.





Best regards,

Guillaume Collange



-- 
Guillaume Collange
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Picture1.png
Type: image/png
Size: 95784 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20180108/62b1680d/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Picture2.png
Type: image/png
Size: 100803 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20180108/62b1680d/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Picture3.png
Type: image/png
Size: 101400 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20180108/62b1680d/attachment-0002.png>

From tomas.kalibera at gmail.com  Mon Jan  8 15:57:35 2018
From: tomas.kalibera at gmail.com (Tomas Kalibera)
Date: Mon, 8 Jan 2018 15:57:35 +0100
Subject: [Rd] Fwd: R/MKL Intel 2018 Compatibility
In-Reply-To: <CAJ48xmAT9pPictc46Z_K+=EqCYzY-42J6UdhE=qO2sB-ShyQaA@mail.gmail.com>
References: <CAJ48xmAzJSZLdWmXBa7vMLAb8FZa1qT6ud0khaU+Oxf6ytCckw@mail.gmail.com>
 <CAJ48xmBo+R8ye36A2UnPXiaq4BCqvJ5d5y6Q8AqFaZC11CtriQ@mail.gmail.com>
 <CAJ48xmAT9pPictc46Z_K+=EqCYzY-42J6UdhE=qO2sB-ShyQaA@mail.gmail.com>
Message-ID: <b9a3530a-78e5-1db3-81ac-ac61e66bae39@gmail.com>

Hi Guillaume,

In principle, mycrossprod function does not need to PROTECT "ans", 
because it does not call any allocating function after allocating "ans" 
("dgemm" in particular should not allocate from the R heap). So it is 
surprising that PROTECTion makes a difference in your case. I agree 
there is no harm protecting defensively. R itself calls dgemm with the R 
object for the result protected when calculating matrix products, but 
there it is needed because there is further allocation when setting up 
attributes for the result.

Best
Tomas


On 01/08/2018 02:41 PM, Guillaume Collange wrote:
> Dear all,
>
>
>
> I would like to submit an issue that we are facing.
>
>
>
> Indeed, in our environment, we are optimizing the R code to speed up some
> mathematical calculations as matrix products using the INTEL libraries (
> MKL) ( https://software.intel.com/en-us/mkl )
>
>
>
> With the last version of the MKL libraries Intel 2018, we are facing to an
> issue with *all INTERNAL command* that are executing in R. The R console is
> freezing executing a process at 100% and never stop!!! It?s really an issue
> for us.
>
>
>
> As example, we can reproduce the error with *crossprod. Crossprod *which is
> a wrapper of BLAS GEMM (optimized with MKL libraries), in this function it
> seems that variables are not protected ( PROTECT(); UNPROTECT() ), see the
> screenshot below, which is a recommendation for external commands:
>
>
>
> Picture1
>
>
> *RECOMMANDATION*
>
> *Picture2*
>
> *Code of CROSSPROD*
>
>   Picture 3
>
>
>
> If we are recoding the CROSSPROD function with PROTECTT
>
> No more issues?
>
>
>
>
>
> Do you have any idea to solve this bug? Any recommendations?
>
>
>
>
>
> Thank you by advance for your help.
>
>
>
>
>
> Best regards,
>
> Guillaume Collange
>
>
>
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



	[[alternative HTML version deleted]]


From wdunlap at tibco.com  Mon Jan  8 16:54:15 2018
From: wdunlap at tibco.com (William Dunlap)
Date: Mon, 8 Jan 2018 07:54:15 -0800
Subject: [Rd] Fwd: R/MKL Intel 2018 Compatibility
In-Reply-To: <b9a3530a-78e5-1db3-81ac-ac61e66bae39@gmail.com>
References: <CAJ48xmAzJSZLdWmXBa7vMLAb8FZa1qT6ud0khaU+Oxf6ytCckw@mail.gmail.com>
 <CAJ48xmBo+R8ye36A2UnPXiaq4BCqvJ5d5y6Q8AqFaZC11CtriQ@mail.gmail.com>
 <CAJ48xmAT9pPictc46Z_K+=EqCYzY-42J6UdhE=qO2sB-ShyQaA@mail.gmail.com>
 <b9a3530a-78e5-1db3-81ac-ac61e66bae39@gmail.com>
Message-ID: <CAF8bMcaQEU+kgxiF-jWJneXfnkNOjiz6Ew3kSp_bnk0Z6pD8FQ@mail.gmail.com>

The x and y passed to dgemm in that code are pointers to the same memory,
thus breaking Fortran's no-aliasing rule.  Is it possible the MKL depends
on the
caller following that rule?

You might try dsyrk() instead of dgemm.

Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Mon, Jan 8, 2018 at 6:57 AM, Tomas Kalibera <tomas.kalibera at gmail.com>
wrote:

> Hi Guillaume,
>
> In principle, mycrossprod function does not need to PROTECT "ans",
> because it does not call any allocating function after allocating "ans"
> ("dgemm" in particular should not allocate from the R heap). So it is
> surprising that PROTECTion makes a difference in your case. I agree
> there is no harm protecting defensively. R itself calls dgemm with the R
> object for the result protected when calculating matrix products, but
> there it is needed because there is further allocation when setting up
> attributes for the result.
>
> Best
> Tomas
>
>
> On 01/08/2018 02:41 PM, Guillaume Collange wrote:
> > Dear all,
> >
> >
> >
> > I would like to submit an issue that we are facing.
> >
> >
> >
> > Indeed, in our environment, we are optimizing the R code to speed up some
> > mathematical calculations as matrix products using the INTEL libraries (
> > MKL) ( https://software.intel.com/en-us/mkl )
> >
> >
> >
> > With the last version of the MKL libraries Intel 2018, we are facing to
> an
> > issue with *all INTERNAL command* that are executing in R. The R console
> is
> > freezing executing a process at 100% and never stop!!! It?s really an
> issue
> > for us.
> >
> >
> >
> > As example, we can reproduce the error with *crossprod. Crossprod *which
> is
> > a wrapper of BLAS GEMM (optimized with MKL libraries), in this function
> it
> > seems that variables are not protected ( PROTECT(); UNPROTECT() ), see
> the
> > screenshot below, which is a recommendation for external commands:
> >
> >
> >
> > Picture1
> >
> >
> > *RECOMMANDATION*
> >
> > *Picture2*
> >
> > *Code of CROSSPROD*
> >
> >   Picture 3
> >
> >
> >
> > If we are recoding the CROSSPROD function with PROTECTT
> >
> > No more issues?
> >
> >
> >
> >
> >
> > Do you have any idea to solve this bug? Any recommendations?
> >
> >
> >
> >
> >
> > Thank you by advance for your help.
> >
> >
> >
> >
> >
> > Best regards,
> >
> > Guillaume Collange
> >
> >
> >
> >
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

	[[alternative HTML version deleted]]


From therneau at mayo.edu  Tue Jan  9 16:37:17 2018
From: therneau at mayo.edu (Therneau, Terry M., Ph.D.)
Date: Tue, 09 Jan 2018 09:37:17 -0600
Subject: [Rd] resolving a names conflict
Message-ID: <375144$8krhb9@ironport10.mayo.edu>

The survival package uses a generalized cholesky decompostition throughout.? If A is a 
symmetric matrix A= LDL' where L is lower triangular with 1s on the diagonal, D is 
diagonal, and D[i,i] =0 if column i of A is redundant.? Being able to read the rank and 
dependencies directly off of D is very handy.

The bdsmatrix package uses the same, but exposes it to the user as gchol and solve methods 
in the NAMESPACE file.

I'd like to expose it in survival as it would make some current development easier.

How do I do this without causing warning messages for anyone who loads both, e.g., anyone 
using the coxme package?? The S4 structures are identical, but bdsmatrix has a superset of 
methods.?? Adding importFrom(bdsmatrix, gchol) is one solution, of course, but it runs 
afoul of the current requirement that recommended packages import only from the core set.

Terry T.


From thierry.onkelinx at inbo.be  Tue Jan  9 16:45:00 2018
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Tue, 9 Jan 2018 16:45:00 +0100
Subject: [Rd] resolving a names conflict
In-Reply-To: <375144$8krhb9@ironport10.mayo.edu>
References: <375144$8krhb9@ironport10.mayo.edu>
Message-ID: <CAJuCY5xjqPSGQ1vOF6DTTQSkd5Nunj+qojMxzBgACo6oj_H6EA@mail.gmail.com>

Dear Terry,

Why not have the required code in survival and use
importFrom(survival, gchol) in bdsmatrix? Since you maintain both,
that shouldn't be too complicated.

Best regards,

ir. Thierry Onkelinx
Statisticus / Statistician

Vlaamse Overheid / Government of Flanders
INSTITUUT VOOR NATUUR- EN BOSONDERZOEK / RESEARCH INSTITUTE FOR NATURE
AND FOREST
Team Biometrie & Kwaliteitszorg / Team Biometrics & Quality Assurance
thierry.onkelinx at inbo.be
Havenlaan 88 bus 73, 1000 Brussel
www.inbo.be

///////////////////////////////////////////////////////////////////////////////////////////
To call in the statistician after the experiment is done may be no
more than asking him to perform a post-mortem examination: he may be
able to say what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does
not ensure that a reasonable answer can be extracted from a given body
of data. ~ John Tukey
///////////////////////////////////////////////////////////////////////////////////////////




2018-01-09 16:37 GMT+01:00 Therneau, Terry M., Ph.D. <therneau at mayo.edu>:
> The survival package uses a generalized cholesky decompostition throughout.
> If A is a symmetric matrix A= LDL' where L is lower triangular with 1s on
> the diagonal, D is diagonal, and D[i,i] =0 if column i of A is redundant.
> Being able to read the rank and dependencies directly off of D is very
> handy.
>
> The bdsmatrix package uses the same, but exposes it to the user as gchol and
> solve methods in the NAMESPACE file.
>
> I'd like to expose it in survival as it would make some current development
> easier.
>
> How do I do this without causing warning messages for anyone who loads both,
> e.g., anyone using the coxme package?  The S4 structures are identical, but
> bdsmatrix has a superset of methods.   Adding importFrom(bdsmatrix, gchol)
> is one solution, of course, but it runs afoul of the current requirement
> that recommended packages import only from the core set.
>
> Terry T.
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From sjg at cantab.net  Tue Jan  9 23:44:03 2018
From: sjg at cantab.net (Simon Guest)
Date: Wed, 10 Jan 2018 11:44:03 +1300
Subject: [Rd] Fixed BLAS tests for external BLAS library
In-Reply-To: <23119.15777.999726.259747@stat.math.ethz.ch>
References: <CAFhGSbtyd0-=FTMsE8ty0vdGvhmbTGM+Ww5+KgQpv-xFsfAq0w@mail.gmail.com>
 <d8f5a2bf-48ab-c5cc-d170-83209a79cceb@gmail.com>
 <CAFhGSbsqEaD9OZyKBfTrbh1i11razBcPB1282kCz9b9mcBHTpQ@mail.gmail.com>
 <4ec8afc4-dfd2-3dfb-73aa-78c57291c903@gmail.com>
 <23119.15777.999726.259747@stat.math.ethz.ch>
Message-ID: <CAFhGSbva90JHct8F=1rr=HfHtkCc_zuqXnwi=uZB+p1pw-0UUg@mail.gmail.com>

Hi Martin and Tomas,

Thanks for your reasoned replies.  It seems that improving this is going to
take more effort in pinning down exactly what is appropriate than I
anticipated.

Sorry if the intention was to keep the initial discussion of this off the
list, I didn't mean to cause offence by copying my reply to the list.

I think I have to acknowledge that I am insufficiently familiar with R to
be able to do what you require in a reasonable time, so I will have to
leave this to someone else to pursue if they are so inclined.  (I am an
infrastructure engineer rather than an R programmer.) For now, then, I will
continue as before, and locally patch that test to pass with the external
BLAS library on CentOS 7.

cheers,
Simon

On 5 January 2018 at 21:56, Martin Maechler <maechler at stat.math.ethz.ch>
wrote:

> >>>>> Tomas Kalibera <tomas.kalibera at gmail.com>
> >>>>>     on Fri, 5 Jan 2018 00:41:47 +0100 writes:
>
>     > In practical terms, failing tests are not preventing anyone from
> using
>     > an optimized BLAS/LAPACK implementation they trust. Building R with
>     > dynamically linked BLAS on Unix is supported, documented and easy for
>     > anyone who builds R from source. It is also how Debian/Ubuntu R
> packages
>     > are built by default, so R uses whichever BLAS is installed in the
>     > system and the user does not have to build from source. There is no
>     > reason why not to do the same thing with another optimized BLAS on
>     > another OS/distribution.
>
>     > You may be right that reg-BLAS is too strict (it is testing matrix
>     > products, expecting equivalence to naive three-loop algorithm, just
> part
>     > of it really uses BLAS). I just wanted a concrete example to think
> about
>     > as I can't repeat it (e.g. it passes with openblas), but maybe
> someone
>     > else will be able to repeat and possibly adjust.
>
>     > Tomas
>
> Yes, indeed!  I strongly agree with Thomas:  This is about
> serious quality assurance of an important part of R,
> and replacing all identical() checks there with all.equal()
> -- which has a default tolerance of allowing __HALF__ of the
>    precision being lost  !! -- in the way you, Simon, proposed,
> is definitely basically destroying the QC/QA  we have in place there.
>
> As Tomas said, *some* of the checks possibly should be done
> all.equal, but with a very a small tolerance; however other
> checks should not allow a tolerance, e.g., all the arithmetic involving
> very small integer valued numbers should definitely be exact.
>
> That's why Tomas' (private!) reply, asking for specific details
> is 100% appropriate, indeed.
>
> With R we have had a philosophy of trying hard to be correct
> first, and fast second... and indeed the last 20 years have
> shown many cases where R's use (and checks) actually have
> reveiled not only inaccuracies but sometimes also bugs in
> LAPACK/BLAS implementations where it sometimes seems, some are
> only interested in speed, rather than correctness.
>
> Martin Maechler
> ETH Zurich
>
>     > On 01/04/2018 09:23 PM, Simon Guest wrote:
>     >> Hi Tomas,
>     >>
>     >> Thanks for your reply.
>     >>
>     >> I find your response curious, however.  Surely the identical() test
> is
>     >> simply incorrect when catering for possibly different BLAS
>     >> implementations?  Or is it the case that conformant BLAS
>     >> implementations all produce bit-identical results, which seems
>     >> unlikely?  (Sorry, I am unfamiliar with the BLAS spec.)  Although
>     >> whatever the answer to this theoretical question, the CentOS 7
>     >> external BLAS library evidently doesn't produce bit-identical
> results.
>     >>
>     >> If you don't agree that replacing identical() with all.equal() is
>     >> clearly the right thing to do, as demonstrated by the CentOS 7
>     >> external BLAS library failing the test, then I think I will give up
>     >> now trying to help improve the R sources.  I simply can't justify to
>     >> my client more time spent on making this work, when we already have
> a
>     >> local solution (which I hoped others would be able to benefit
> from).
>     >> Ah well.
>     >>
>     >> cheers,
>     >> Simon
>     >>
>     >> On 5 January 2018 at 00:07, Tomas Kalibera <
> tomas.kalibera at gmail.com
>     >> <mailto:tomas.kalibera at gmail.com>> wrote:
>     >>
>     >> Hi Simon,
>     >>
>     >> we'd need more information to consider this - particularly which
>     >> expression gives an imprecise result with ACML and what are the
>     >> computed values, differences. It is not common for optimized BLAS
>     >> implementations to fail reg-BLAS.R tests, but it is common for
>     >> them to report numerical differences in tests of various
>     >> recommended packages where more complicated computations are done
>     >> (e.g. nlme), on various platforms.
>     >>
>     >> Best
>     >> Tomas
>     >>
>     >>
>     >> On 12/18/2017 08:56 PM, Simon Guest wrote:
>     >>
>     >> We build R with dynamically linked BLAS and LAPACK libraries,
>     >> in order
>     >> to use the AMD Core Math Library (ACML) multi-threaded
>     >> implementation
>     >> of these routines on our 64 core servers.  This is great, and our
>     >> users really appreciate it.
>     >>
>     >> However, when building like this, make check fails on the
>     >> reg-BLAS.R
>     >> test.  The reason for this is that the expected test output is
>     >> checked
>     >> using identical.  By changing all uses of identical in this
>     >> file to
>     >> all.equal, the tests pass.
>     >>
>     >> Specifically, I run this command before make check:
>     >>
>     >> $ sed -i -e 's/identical/all.equal/g' tests/reg-BLAS.R
>     >>
>     >> I suggest that the test is fixed like this in the R source code.
>     >>
>     >> Here is the configure command I use, on CentOS 7:
>     >> $ ./configure --with-system-zlib --with-system-bzlib
>     >> --with-system-pcre \
>     >>      --with-blas \
>     >>      --with-lapack \
>     >>      --with-tcl-config=/usr/lib64/tclConfig.sh \
>     >>      --with-tk-config=/usr/lib64/tkConfig.sh \
>     >>      --enable-R-shlib \
>     >>      --enable-prebuilt-html
>     >>
>     >> cheers,
>     >> Simon
>     >>
>     >> ______________________________________________
>     >> R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>     >> https://stat.ethz.ch/mailman/listinfo/r-devel
>     >> <https://stat.ethz.ch/mailman/listinfo/r-devel>
>     >>
>     >>
>     >>
>     >>
>
>
>     > [[alternative HTML version deleted]]
>
>     > ______________________________________________
>     > R-devel at r-project.org mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From btyner at gmail.com  Wed Jan 10 00:03:12 2018
From: btyner at gmail.com (Benjamin Tyner)
Date: Tue, 9 Jan 2018 18:03:12 -0500
Subject: [Rd] OpenBLAS in everyday R?
In-Reply-To: <mailman.7.1513508402.51277.r-devel@r-project.org>
References: <mailman.7.1513508402.51277.r-devel@r-project.org>
Message-ID: <d895e254-67f0-f609-0fde-b32c949f12cf@gmail.com>

Please pardon my ignorance, but doesn't OpenBLAS still not always play 
nicely with multi-threaded OpenMP? (for example, don't race conditions 
sometimes crop up)? If so, it might be nice to have the ability to 
temporarily disable multi-threaded OpenMP (effectively: 
omp_set_num_threads(1)) for the duration of operations using OpenBLAS.

Regards
Ben

> Julia using OpenBLAS is *very* reassuring.
>
> I agree that having it included as an options(...) feature should be OK.
>
> On Sun, Dec 17, 2017, 3:22 PM Juan Telleria <jtelleriar at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote:
>
> >/Julia Programming Language uses also OpenBlas, and it is actively />/maintained with bugs being fixed as I have checked it out: />//>/http://www.openblas.net/Changelog.txt />//>/So I still see it ok to be included as an options(...) feature (by 
> default />/off, just for safety), over other Blas libraries. />//>/R could not use Intel MKL for legal reasons (I think), because as long />/that R ships with GPL libraries, shipping R by default with Non-GPL is />/illegal. />//>/Cheers, />/Juan />//>/El 17/12/2017 2:50 a. m., "Avraham Adler" <avraham.adler at gmail.com 
> <https://stat.ethz.ch/mailman/listinfo/r-devel>> />/escribi?: />//>>/On Sat, Dec 16, 2017 at 7:41 PM, Kenny Bell <kmbell56 at gmail.com 
> <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote: />>/> It seems like many of the multi-threaded BLASes have some sort of />>/> fundamental problem preventing use in the way Juan suggests: />>/> />>/> - Dirk's vignette states that ATLAS "fixes the number of cores used at />>/> compile-time and cannot vary this setting at run-time", so any />>/> user-friendly implementation for R would have to compile ATLAS for 
> 1-16 />>/> threads to allow the user to switch at run-time. This might 
> dramatically />>/> affect install times. />>/> />>/> - MKL seems like it's been outright rejected in the past based on not />>/> being "free-enough". />>/> />>/> - OpenBLAS causes crashes. />>/> />>/> Has anyone tried ExBLAS for use with R? />>/> />>/> On Sun, Dec 17, 2017 at 1:03 PM, Peter Langfelder < />>/> peter.langfelder at gmail.com 
> <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote: />>/> />>/>> I would be very cautious about OpenBLAS in particular... from time to />>/>> time I get complains from users that compiled code calculations in my />>/>> WGCNA package crash or produce wrong answers with large data, and 
> they />>/>> all come from OpenBLAS users. I am yet to reproduce any of their />>/>> crashes when using MKL and ATLAS BLAS implementations. />>/>> />>/>> Just my 2 cents... />>/>> />>/>> Peter />>//>>/I've been building R on Windows 64 bit with OpenBLAS for years and my />>/builds pass check-devel. For a while in the past it failed one check />>/as the tolerance was 5e-5 and with my build of OpenBLAS the error was />>/5.4e-5 or 5.7e-5, but that was changed around R 3.3, if I recall />>/correctly. I provide descriptions here [1], but I haven't gone so far />>/as to post compiled Rblas.dlls just yet. My personal build sets 4 />>/threads when compiling OpenBLAS itself as I'm currently on a quad-core />>/SandyBridge. In tests I ran a few years ago, both single and multi />>/threaded BLAS compile and then can be compiled into R with no issues />>/(on my platforms, at least). Most matrix operations performed better />>/with multi-threaded except for R's eigenvalue decomposition, to the />>/nest of my recollection. />>//>>/Avi />>//>>/[1] https://www.avrahamadler.com/r-tips/build-openblas-for-windows-r64/ />>//>>/______________________________________________ />>/R-devel at r-project.org 
> <https://stat.ethz.ch/mailman/listinfo/r-devel> mailing list />>/https://stat.ethz.ch/mailman/listinfo/r-devel />>//>//
> 	[[alternative HTML version deleted]]


From keith.ohara at nyu.edu  Wed Jan 10 00:41:58 2018
From: keith.ohara at nyu.edu (Keith O'Hara)
Date: Tue, 9 Jan 2018 18:41:58 -0500
Subject: [Rd] OpenBLAS in everyday R?
In-Reply-To: <d895e254-67f0-f609-0fde-b32c949f12cf@gmail.com>
References: <mailman.7.1513508402.51277.r-devel@r-project.org>
 <d895e254-67f0-f609-0fde-b32c949f12cf@gmail.com>
Message-ID: <804CB69F-0628-4ACF-A3A5-CDEFA292B565@nyu.edu>

Do those issues still arise when OpenBLAS is compiled with USE_OPENMP=1 ?

Keith

> On Jan 9, 2018, at 6:03 PM, Benjamin Tyner <btyner at gmail.com> wrote:
> 
> Please pardon my ignorance, but doesn't OpenBLAS still not always play nicely with multi-threaded OpenMP? (for example, don't race conditions sometimes crop up)? If so, it might be nice to have the ability to temporarily disable multi-threaded OpenMP (effectively: omp_set_num_threads(1)) for the duration of operations using OpenBLAS.
> 
> Regards
> Ben
> 
>> Julia using OpenBLAS is *very* reassuring.
>> 
>> I agree that having it included as an options(...) feature should be OK.
>> 
>> On Sun, Dec 17, 2017, 3:22 PM Juan Telleria <jtelleriar at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote:
>> 
>> >/Julia Programming Language uses also OpenBlas, and it is actively />/maintained with bugs being fixed as I have checked it out: />//>/http://www.openblas.net/Changelog.txt />//>/So I still see it ok to be included as an options(...) feature (by default />/off, just for safety), over other Blas libraries. />//>/R could not use Intel MKL for legal reasons (I think), because as long />/that R ships with GPL libraries, shipping R by default with Non-GPL is />/illegal. />//>/Cheers, />/Juan />//>/El 17/12/2017 2:50 a. m., "Avraham Adler" <avraham.adler at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> />/escribi?: />//>>/On Sat, Dec 16, 2017 at 7:41 PM, Kenny Bell <kmbell56 at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote: />>/> It seems like many of the multi-threaded BLASes have some sort of />>/> fundamental problem preventing use in the way Juan suggests: />>/> />>/> - Dirk's vignette states that ATLAS "fixes the number of cores used at />>/> compile-time and cannot vary this setting at run-time", so any />>/> user-friendly implementation for R would have to compile ATLAS for 1-16 />>/> threads to allow the user to switch at run-time. This might dramatically />>/> affect install times. />>/> />>/> - MKL seems like it's been outright rejected in the past based on not />>/> being "free-enough". />>/> />>/> - OpenBLAS causes crashes. />>/> />>/> Has anyone tried ExBLAS for use with R? />>/> />>/> On Sun, Dec 17, 2017 at 1:03 PM, Peter Langfelder < />>/> peter.langfelder at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote: />>/> />>/>> I would be very cautious about OpenBLAS in particular... from time to />>/>> time I get complains from users that compiled code calculations in my />>/>> WGCNA package crash or produce wrong answers with large data, and they />>/>> all come from OpenBLAS users. I am yet to reproduce any of their />>/>> crashes when using MKL and ATLAS BLAS implementations. />>/>> />>/>> Just my 2 cents... />>/>> />>/>> Peter />>//>>/I've been building R on Windows 64 bit with OpenBLAS for years and my />>/builds pass check-devel. For a while in the past it failed one check />>/as the tolerance was 5e-5 and with my build of OpenBLAS the error was />>/5.4e-5 or 5.7e-5, but that was changed around R 3.3, if I recall />>/correctly. I provide descriptions here [1], but I haven't gone so far />>/as to post compiled Rblas.dlls just yet. My personal build sets 4 />>/threads when compiling OpenBLAS itself as I'm currently on a quad-core />>/SandyBridge. In tests I ran a few years ago, both single and multi />>/threaded BLAS compile and then can be compiled into R with no issues />>/(on my platforms, at least). Most matrix operations performed better />>/with multi-threaded except for R's eigenvalue decomposition, to the />>/nest of my recollection. />>//>>/Avi />>//>>/[1] https://www.avrahamadler.com/r-tips/build-openblas-for-windows-r64/ />>//>>/______________________________________________ />>/R-devel at r-project.org <https://stat.ethz.ch/mailman/listinfo/r-devel> mailing list />>/https://stat.ethz.ch/mailman/listinfo/r-devel />>//>//
>> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From btyner at gmail.com  Wed Jan 10 05:01:28 2018
From: btyner at gmail.com (Benjamin Tyner)
Date: Tue, 9 Jan 2018 23:01:28 -0500
Subject: [Rd] OpenBLAS in everyday R?
In-Reply-To: <804CB69F-0628-4ACF-A3A5-CDEFA292B565@nyu.edu>
References: <mailman.7.1513508402.51277.r-devel@r-project.org>
 <d895e254-67f0-f609-0fde-b32c949f12cf@gmail.com>
 <804CB69F-0628-4ACF-A3A5-CDEFA292B565@nyu.edu>
Message-ID: <6220ffde-1ba0-3e52-5a94-ada9be05f81d@gmail.com>

I didn't do the compile; is there a way to check whether that was used? 
If not, I'll inquire with our sysadmin and report back.

In any case, my suggestion was motivated by the fact that some parts of 
R use OpenMP while others do not, in the hope that the former could have 
their OpenBLAS omelet without breaking the OpenMP eggs, so to speak.


On 01/09/2018 06:41 PM, Keith O'Hara wrote:
> Do those issues still arise when OpenBLAS is compiled with USE_OPENMP=1 ?
>
> Keith
>
>> On Jan 9, 2018, at 6:03 PM, Benjamin Tyner <btyner at gmail.com> wrote:
>>
>> Please pardon my ignorance, but doesn't OpenBLAS still not always play nicely with multi-threaded OpenMP? (for example, don't race conditions sometimes crop up)? If so, it might be nice to have the ability to temporarily disable multi-threaded OpenMP (effectively: omp_set_num_threads(1)) for the duration of operations using OpenBLAS.
>>
>> Regards
>> Ben
>>
>>> Julia using OpenBLAS is *very* reassuring.
>>>
>>> I agree that having it included as an options(...) feature should be OK.
>>>
>>> On Sun, Dec 17, 2017, 3:22 PM Juan Telleria <jtelleriar at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote:
>>>
>>>> /Julia Programming Language uses also OpenBlas, and it is actively />/maintained with bugs being fixed as I have checked it out: />//>/http://www.openblas.net/Changelog.txt />//>/So I still see it ok to be included as an options(...) feature (by default />/off, just for safety), over other Blas libraries. />//>/R could not use Intel MKL for legal reasons (I think), because as long />/that R ships with GPL libraries, shipping R by default with Non-GPL is />/illegal. />//>/Cheers, />/Juan />//>/El 17/12/2017 2:50 a. m., "Avraham Adler" <avraham.adler at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> />/escribi?: />//>>/On Sat, Dec 16, 2017 at 7:41 PM, Kenny Bell <kmbell56 at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote: />>/> It seems like many of the multi-threaded BLASes have some sort of />>/> fundamental problem preventing use in the way Juan suggests: />>/> />>/> - Dirk's vignette states that ATLAS "fixes the number of cores used at />>/> compile-time and cannot vary this setting at run-time", so any />>/> user-friendly implementation for R would have to compile ATLAS for 1-16 />>/> threads to allow the user to switch at run-time. This might dramatically />>/> affect install times. />>/> />>/> - MKL seems like it's been outright rejected in the past based on not />>/> being "free-enough". />>/> />>/> - OpenBLAS causes crashes. />>/> />>/> Has anyone tried ExBLAS for use with R? />>/> />>/> On Sun, Dec 17, 2017 at 1:03 PM, Peter Langfelder < />>/> peter.langfelder at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote: />>/> />>/>> I would be very cautious about OpenBLAS in particular... from time to />>/>> time I get complains from users that compiled code calculations in my />>/>> WGCNA package crash or produce wrong answers with large data, and they />>/>> all come from OpenBLAS users. I am yet to reproduce any of their />>/>> crashes when using MKL and ATLAS BLAS implementations. />>/>> />>/>> Just my 2 cents... />>/>> />>/>> Peter />>//>>/I've been building R on Windows 64 bit with OpenBLAS for years and my />>/builds pass check-devel. For a while in the past it failed one check />>/as the tolerance was 5e-5 and with my build of OpenBLAS the error was />>/5.4e-5 or 5.7e-5, but that was changed around R 3.3, if I recall />>/correctly. I provide descriptions here [1], but I haven't gone so far />>/as to post compiled Rblas.dlls just yet. My personal build sets 4 />>/threads when compiling OpenBLAS itself as I'm currently on a quad-core />>/SandyBridge. In tests I ran a few years ago, both single and multi />>/threaded BLAS compile and then can be compiled into R with no issues />>/(on my platforms, at least). Most matrix operations performed better />>/with multi-threaded except for R's eigenvalue decomposition, to the />>/nest of my recollection. />>//>>/Avi />>//>>/[1] https://www.avrahamadler.com/r-tips/build-openblas-for-windows-r64/ />>//>>/______________________________________________ />>/R-devel at r-project.org <https://stat.ethz.ch/mailman/listinfo/r-devel> mailing list />>/https://stat.ethz.ch/mailman/listinfo/r-devel />>//>//
>>> 	[[alternative HTML version deleted]]
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel


From keith.ohara at nyu.edu  Wed Jan 10 06:04:47 2018
From: keith.ohara at nyu.edu (Keith O'Hara)
Date: Wed, 10 Jan 2018 00:04:47 -0500
Subject: [Rd] OpenBLAS in everyday R?
In-Reply-To: <6220ffde-1ba0-3e52-5a94-ada9be05f81d@gmail.com>
References: <mailman.7.1513508402.51277.r-devel@r-project.org>
 <d895e254-67f0-f609-0fde-b32c949f12cf@gmail.com>
 <804CB69F-0628-4ACF-A3A5-CDEFA292B565@nyu.edu>
 <6220ffde-1ba0-3e52-5a94-ada9be05f81d@gmail.com>
Message-ID: <866170A0-52CE-4984-84EF-DF75AB1F6056@nyu.edu>

Check if libopenblas is linked against libomp or libgomp. 

I?d be curious to see any errors that arise when an OpenMP version of OpenBLAS is linked with R.

Keith


> On Jan 9, 2018, at 11:01 PM, Benjamin Tyner <btyner at gmail.com> wrote:
> 
> I didn't do the compile; is there a way to check whether that was used? If not, I'll inquire with our sysadmin and report back.
> 
> In any case, my suggestion was motivated by the fact that some parts of R use OpenMP while others do not, in the hope that the former could have their OpenBLAS omelet without breaking the OpenMP eggs, so to speak.
> 
> 
> On 01/09/2018 06:41 PM, Keith O'Hara wrote:
>> Do those issues still arise when OpenBLAS is compiled with USE_OPENMP=1 ?
>> 
>> Keith
>> 
>>> On Jan 9, 2018, at 6:03 PM, Benjamin Tyner <btyner at gmail.com> wrote:
>>> 
>>> Please pardon my ignorance, but doesn't OpenBLAS still not always play nicely with multi-threaded OpenMP? (for example, don't race conditions sometimes crop up)? If so, it might be nice to have the ability to temporarily disable multi-threaded OpenMP (effectively: omp_set_num_threads(1)) for the duration of operations using OpenBLAS.
>>> 
>>> Regards
>>> Ben
>>> 
>>>> Julia using OpenBLAS is *very* reassuring.
>>>> 
>>>> I agree that having it included as an options(...) feature should be OK.
>>>> 
>>>> On Sun, Dec 17, 2017, 3:22 PM Juan Telleria <jtelleriar at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote:
>>>> 
>>>>> /Julia Programming Language uses also OpenBlas, and it is actively />/maintained with bugs being fixed as I have checked it out: />//>/http://www.openblas.net/Changelog.txt />//>/So I still see it ok to be included as an options(...) feature (by default />/off, just for safety), over other Blas libraries. />//>/R could not use Intel MKL for legal reasons (I think), because as long />/that R ships with GPL libraries, shipping R by default with Non-GPL is />/illegal. />//>/Cheers, />/Juan />//>/El 17/12/2017 2:50 a. m., "Avraham Adler" <avraham.adler at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> />/escribi?: />//>>/On Sat, Dec 16, 2017 at 7:41 PM, Kenny Bell <kmbell56 at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote: />>/> It seems like many of the multi-threaded BLASes have some sort of />>/> fundamental problem preventing use in the way Juan suggests: />>/> />>/> - Dirk's vignette states that ATLAS "fixes the number of cores used at />>/> compile-time and cannot vary this setting at run-time", so any />>/> user-friendly implementation for R would have to compile ATLAS for 1-16 />>/> threads to allow the user to switch at run-time. This might dramatically />>/> affect install times. />>/> />>/> - MKL seems like it's been outright rejected in the past based on not />>/> being "free-enough". />>/> />>/> - OpenBLAS causes crashes. />>/> />>/> Has anyone tried ExBLAS for use with R? />>/> />>/> On Sun, Dec 17, 2017 at 1:03 PM, Peter Langfelder < />>/> peter.langfelder at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote: />>/> />>/>> I would be very cautious about OpenBLAS in particular... from time to />>/>> time I get complains from users that compiled code calculations in my />>/>> WGCNA package crash or produce wrong answers with large data, and they />>/>> all come from OpenBLAS users. I am yet to reproduce any of their />>/>> crashes when using MKL and ATLAS BLAS implementations. />>/>> />>/>> Just my 2 cents... />>/>> />>/>> Peter />>//>>/I've been building R on Windows 64 bit with OpenBLAS for years and my />>/builds pass check-devel. For a while in the past it failed one check />>/as the tolerance was 5e-5 and with my build of OpenBLAS the error was />>/5.4e-5 or 5.7e-5, but that was changed around R 3.3, if I recall />>/correctly. I provide descriptions here [1], but I haven't gone so far />>/as to post compiled Rblas.dlls just yet. My personal build sets 4 />>/threads when compiling OpenBLAS itself as I'm currently on a quad-core />>/SandyBridge. In tests I ran a few years ago, both single and multi />>/threaded BLAS compile and then can be compiled into R with no issues />>/(on my platforms, at least). Most matrix operations performed better />>/with multi-threaded except for R's eigenvalue decomposition, to the />>/nest of my recollection. />>//>>/Avi />>//>>/[1] https://www.avrahamadler.com/r-tips/build-openblas-for-windows-r64/ />>//>>/______________________________________________ />>/R-devel at r-project.org <https://stat.ethz.ch/mailman/listinfo/r-devel> mailing list />>/https://stat.ethz.ch/mailman/listinfo/r-devel />>//>//
>>>> 	[[alternative HTML version deleted]]
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 


From avraham.adler at gmail.com  Wed Jan 10 07:28:54 2018
From: avraham.adler at gmail.com (Avraham Adler)
Date: Wed, 10 Jan 2018 01:28:54 -0500
Subject: [Rd] OpenBLAS in everyday R?
In-Reply-To: <866170A0-52CE-4984-84EF-DF75AB1F6056@nyu.edu>
References: <mailman.7.1513508402.51277.r-devel@r-project.org>
 <d895e254-67f0-f609-0fde-b32c949f12cf@gmail.com>
 <804CB69F-0628-4ACF-A3A5-CDEFA292B565@nyu.edu>
 <6220ffde-1ba0-3e52-5a94-ada9be05f81d@gmail.com>
 <866170A0-52CE-4984-84EF-DF75AB1F6056@nyu.edu>
Message-ID: <CAL6gwnKZ5vPHKHYwY+PEmq2+iW92QumwA3NM53Li3Lt-Fdm8zQ@mail.gmail.com>

On Wed, Jan 10, 2018 at 12:04 AM, Keith O'Hara <keith.ohara at nyu.edu> wrote:
>
> Check if libopenblas is linked against libomp or libgomp.
>
> I?d be curious to see any errors that arise when an OpenMP version of OpenBLAS is linked with R.
>
> Keith
>

The one time I tried compiling OpenBLAS for Windows 64 with USE OMP =
1, I got an error. I don't recall if it was in the compilation of R or
in use. Regardless, I compile OpenBLAS without setting that flag and
it still plays nicely with all R packages, including those that use
OpenMP.

Avi


From keith.ohara at nyu.edu  Wed Jan 10 16:22:50 2018
From: keith.ohara at nyu.edu (Keith O'Hara)
Date: Wed, 10 Jan 2018 10:22:50 -0500
Subject: [Rd] OpenBLAS in everyday R?
In-Reply-To: <CAL6gwnKZ5vPHKHYwY+PEmq2+iW92QumwA3NM53Li3Lt-Fdm8zQ@mail.gmail.com>
References: <mailman.7.1513508402.51277.r-devel@r-project.org>
 <d895e254-67f0-f609-0fde-b32c949f12cf@gmail.com>
 <804CB69F-0628-4ACF-A3A5-CDEFA292B565@nyu.edu>
 <6220ffde-1ba0-3e52-5a94-ada9be05f81d@gmail.com>
 <866170A0-52CE-4984-84EF-DF75AB1F6056@nyu.edu>
 <CAL6gwnKZ5vPHKHYwY+PEmq2+iW92QumwA3NM53Li3Lt-Fdm8zQ@mail.gmail.com>
Message-ID: <925553D4-F413-4FC9-9349-C608C824559A@nyu.edu>

I won?t play nicely with a package that combines omp pragmas with calls to BLAS routines, e.g. something you might get with source Armadillo/Eigen/Blaze code, for reasons that Benjamin mentioned in his initial email (pthreads vs omp).

Keith

> On Jan 10, 2018, at 1:28 AM, Avraham Adler <avraham.adler at gmail.com> wrote:
> 
> On Wed, Jan 10, 2018 at 12:04 AM, Keith O'Hara <keith.ohara at nyu.edu> wrote:
>> 
>> Check if libopenblas is linked against libomp or libgomp.
>> 
>> I?d be curious to see any errors that arise when an OpenMP version of OpenBLAS is linked with R.
>> 
>> Keith
>> 
> 
> The one time I tried compiling OpenBLAS for Windows 64 with USE OMP =
> 1, I got an error. I don't recall if it was in the compilation of R or
> in use. Regardless, I compile OpenBLAS without setting that flag and
> it still plays nicely with all R packages, including those that use
> OpenMP.
> 
> Avi


From neal.p.richardson at gmail.com  Wed Jan 10 19:26:24 2018
From: neal.p.richardson at gmail.com (Neal Richardson)
Date: Wed, 10 Jan 2018 10:26:24 -0800
Subject: [Rd] R CMD build then check fails on R-devel due to serialization
	version
Message-ID: <CAOCv4hjunyV2N87s5-kNyH9J7aOWr2wrK-A_zJ_jP657b3sHNA@mail.gmail.com>

Hi,
Since yesterday I'm seeing `R CMD check --as-cran` failures on the
R-devel daily build (specifically, R Under development (unstable)
(2018-01-09 r74100)) for multiple packages:

* checking serialized R objects in the sources ... WARNING
Found file(s) with version 3 serialization:
?build/vignette.rds?
Such files are only readable in R >= 3.5.0.
Recreate them with R < 3.5.0 or save(version = 2) or saveRDS(version =
2) as appropriate

As far as I can tell, revision 74099
(https://github.com/wch/r-source/commit/d9530001046a582ff6a43ca834d6c3586abd0a97),
which changes the default serialization format to 3, clashes with
revision 73973 (https://github.com/wch/r-source/commit/885764eb74f2211a547b13727f2ecc5470c3dd00),
which checks that serialized R objects are _not_ version 3. It seems
that with the current development version of R, if you `R CMD build`
and then run `R CMD check --as-cran` on the built package, it will
fail.

Neal


From murdoch.duncan at gmail.com  Wed Jan 10 21:52:57 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 10 Jan 2018 15:52:57 -0500
Subject: [Rd] R CMD build then check fails on R-devel due to
 serialization version
In-Reply-To: <CAOCv4hjunyV2N87s5-kNyH9J7aOWr2wrK-A_zJ_jP657b3sHNA@mail.gmail.com>
References: <CAOCv4hjunyV2N87s5-kNyH9J7aOWr2wrK-A_zJ_jP657b3sHNA@mail.gmail.com>
Message-ID: <f861af0d-376a-0be4-ecb7-f09e8165893b@gmail.com>

On 10/01/2018 1:26 PM, Neal Richardson wrote:
> Hi,
> Since yesterday I'm seeing `R CMD check --as-cran` failures on the
> R-devel daily build (specifically, R Under development (unstable)
> (2018-01-09 r74100)) for multiple packages:
> 
> * checking serialized R objects in the sources ... WARNING
> Found file(s) with version 3 serialization:
> ?build/vignette.rds?
> Such files are only readable in R >= 3.5.0.
> Recreate them with R < 3.5.0 or save(version = 2) or saveRDS(version =
> 2) as appropriate
> 
> As far as I can tell, revision 74099
> (https://github.com/wch/r-source/commit/d9530001046a582ff6a43ca834d6c3586abd0a97),
> which changes the default serialization format to 3, clashes with
> revision 73973 (https://github.com/wch/r-source/commit/885764eb74f2211a547b13727f2ecc5470c3dd00),
> which checks that serialized R objects are _not_ version 3. It seems
> that with the current development version of R, if you `R CMD build`
> and then run `R CMD check --as-cran` on the built package, it will
> fail.
> 

I think the message basically says:  don't do that.  You should build 
with R-release for now.  You always need to check with R-devel, so life 
is complicated.

If you build with R-devel without forcing the old format, nobody using 
R-release will be able to use your tarball.

Eventually I guess the new format will be accepted by CRAN, but it will 
likely be a while:  nobody expects everyone to instantly upgrade to a 
new R release, let alone to an unreleased development version.

Presumably that particular file (build/vignette.rds) could be 
automatically built in the old format for now, but the new format needs 
testing, so it makes sense to me to leave it as a default, even if it 
makes it more complicated to submit a package to CRAN.

Duncan Murdoch


From jtelleriar at gmail.com  Wed Jan 10 23:22:55 2018
From: jtelleriar at gmail.com (Juan Telleria)
Date: Wed, 10 Jan 2018 23:22:55 +0100
Subject: [Rd] OpenBLAS in everyday R?
In-Reply-To: <925553D4-F413-4FC9-9349-C608C824559A@nyu.edu>
References: <mailman.7.1513508402.51277.r-devel@r-project.org>
 <d895e254-67f0-f609-0fde-b32c949f12cf@gmail.com>
 <804CB69F-0628-4ACF-A3A5-CDEFA292B565@nyu.edu>
 <6220ffde-1ba0-3e52-5a94-ada9be05f81d@gmail.com>
 <866170A0-52CE-4984-84EF-DF75AB1F6056@nyu.edu>
 <CAL6gwnKZ5vPHKHYwY+PEmq2+iW92QumwA3NM53Li3Lt-Fdm8zQ@mail.gmail.com>
 <925553D4-F413-4FC9-9349-C608C824559A@nyu.edu>
Message-ID: <CANNd7==r1s2XQeYxySDgZuyJvV5i4+OOqF_96YsVGd_euyBKHA@mail.gmail.com>

In order to document the generated Know-How of Optional BLAS Libraries
Implementation and Tests (For example: OpenBLAS), I have created a
Mediawiki based wiki page in which anyone can document and discuss any
issues he/she encounters:

https://kbrproject.miraheze.org/wiki/Main_Page/BLAS

I will myself document all observations and attach the papers that
have been mentioned in R-devel related to such topic.

Hope its useful.

Best,
Juan Telleria


From jtelleriar at gmail.com  Wed Jan 10 23:54:42 2018
From: jtelleriar at gmail.com (Juan Telleria)
Date: Wed, 10 Jan 2018 23:54:42 +0100
Subject: [Rd] OpenBLAS in everyday R?
In-Reply-To: <CANNd7==r1s2XQeYxySDgZuyJvV5i4+OOqF_96YsVGd_euyBKHA@mail.gmail.com>
References: <mailman.7.1513508402.51277.r-devel@r-project.org>
 <d895e254-67f0-f609-0fde-b32c949f12cf@gmail.com>
 <804CB69F-0628-4ACF-A3A5-CDEFA292B565@nyu.edu>
 <6220ffde-1ba0-3e52-5a94-ada9be05f81d@gmail.com>
 <866170A0-52CE-4984-84EF-DF75AB1F6056@nyu.edu>
 <CAL6gwnKZ5vPHKHYwY+PEmq2+iW92QumwA3NM53Li3Lt-Fdm8zQ@mail.gmail.com>
 <925553D4-F413-4FC9-9349-C608C824559A@nyu.edu>
 <CANNd7==r1s2XQeYxySDgZuyJvV5i4+OOqF_96YsVGd_euyBKHA@mail.gmail.com>
Message-ID: <CANNd7=njO=7jWh0Vo4czCbP9Y+mPPwnnCXpNJ_RjMFVVXC8u2w@mail.gmail.com>

> In order to document the generated Know-How of Optional BLAS Libraries
> Implementation and Tests (For example: OpenBLAS), I have created a
> Mediawiki based wiki page in which anyone can document and discuss any
> issues he/she encounters:
>
> https://kbrproject.miraheze.org/wiki/Main_Page/BLAS
>
> I will myself document all observations and attach the papers that
> have been mentioned in R-devel related to such topic.

Will take me some time... Maybe I can finish it at the weekend, That
there is more info that expected.
Juan


From btyner at gmail.com  Thu Jan 11 02:24:35 2018
From: btyner at gmail.com (Benjamin Tyner)
Date: Wed, 10 Jan 2018 20:24:35 -0500
Subject: [Rd] OpenBLAS in everyday R?
In-Reply-To: <866170A0-52CE-4984-84EF-DF75AB1F6056@nyu.edu>
References: <mailman.7.1513508402.51277.r-devel@r-project.org>
 <d895e254-67f0-f609-0fde-b32c949f12cf@gmail.com>
 <804CB69F-0628-4ACF-A3A5-CDEFA292B565@nyu.edu>
 <6220ffde-1ba0-3e52-5a94-ada9be05f81d@gmail.com>
 <866170A0-52CE-4984-84EF-DF75AB1F6056@nyu.edu>
Message-ID: <fb7c236b-89ea-2818-6e0e-b726b6dca752@gmail.com>

Thanks Keith. We checked, and indeed libopenblas is not linked against 
libomp nor libgomp. We suspect this is because we used conda to install 
R and OpenBLAS. So I guess we should be barking up the conda tree instead?

By the way, I also noticed on my home machine (Ubuntu), 
/usr/lib/libopenblas.so.0 is also not linked against those, for what 
that's worth.

Regards,
Ben

On 01/10/2018 12:04 AM, Keith O'Hara wrote:
> Check if libopenblas is linked against libomp or libgomp.
>
> I?d be curious to see any errors that arise when an OpenMP version of OpenBLAS is linked with R.
>
> Keith
>
>
>> On Jan 9, 2018, at 11:01 PM, Benjamin Tyner <btyner at gmail.com> wrote:
>>
>> I didn't do the compile; is there a way to check whether that was used? If not, I'll inquire with our sysadmin and report back.
>>
>> In any case, my suggestion was motivated by the fact that some parts of R use OpenMP while others do not, in the hope that the former could have their OpenBLAS omelet without breaking the OpenMP eggs, so to speak.
>>
>>
>> On 01/09/2018 06:41 PM, Keith O'Hara wrote:
>>> Do those issues still arise when OpenBLAS is compiled with USE_OPENMP=1 ?
>>>
>>> Keith
>>>
>>>> On Jan 9, 2018, at 6:03 PM, Benjamin Tyner <btyner at gmail.com> wrote:
>>>>
>>>> Please pardon my ignorance, but doesn't OpenBLAS still not always play nicely with multi-threaded OpenMP? (for example, don't race conditions sometimes crop up)? If so, it might be nice to have the ability to temporarily disable multi-threaded OpenMP (effectively: omp_set_num_threads(1)) for the duration of operations using OpenBLAS.
>>>>
>>>> Regards
>>>> Ben
>>>>
>>>>> Julia using OpenBLAS is *very* reassuring.
>>>>>
>>>>> I agree that having it included as an options(...) feature should be OK.
>>>>>
>>>>> On Sun, Dec 17, 2017, 3:22 PM Juan Telleria <jtelleriar at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote:
>>>>>
>>>>>> /Julia Programming Language uses also OpenBlas, and it is actively />/maintained with bugs being fixed as I have checked it out: />//>/http://www.openblas.net/Changelog.txt />//>/So I still see it ok to be included as an options(...) feature (by default />/off, just for safety), over other Blas libraries. />//>/R could not use Intel MKL for legal reasons (I think), because as long />/that R ships with GPL libraries, shipping R by default with Non-GPL is />/illegal. />//>/Cheers, />/Juan />//>/El 17/12/2017 2:50 a. m., "Avraham Adler" <avraham.adler at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> />/escribi?: />//>>/On Sat, Dec 16, 2017 at 7:41 PM, Kenny Bell <kmbell56 at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote: />>/> It seems like many of the multi-threaded BLASes have some sort of />>/> fundamental problem preventing use in the way Juan suggests: />>/> />>/> - Dirk's vignette states that ATLAS "fixes the number of cores used at />>/> compile-time and cannot vary this setting at run-time", so any />>/> user-friendly implementation for R would have to compile ATLAS for 1-16 />>/> threads to allow the user to switch at run-time. This might dramatically />>/> affect install times. />>/> />>/> - MKL seems like it's been outright rejected in the past based on not />>/> being "free-enough". />>/> />>/> - OpenBLAS causes crashes. />>/> />>/> Has anyone tried ExBLAS for use with R? />>/> />>/> On Sun, Dec 17, 2017 at 1:03 PM, Peter Langfelder < />>/> peter.langfelder at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote: />>/> />>/>> I would be very cautious about OpenBLAS in particular... from time to />>/>> time I get complains from users that compiled code calculations in my />>/>> WGCNA package crash or produce wrong answers with large data, and they />>/>> all come from OpenBLAS users. I am yet to reproduce any of their />>/>> crashes when using MKL and ATLAS BLAS implementations. />>/>> />>/>> Just my 2 cents... />>/>> />>/>> Peter />>//>>/I've been building R on Windows 64 bit with OpenBLAS for years and my />>/builds pass check-devel. For a while in the past it failed one check />>/as the tolerance was 5e-5 and with my build of OpenBLAS the error was />>/5.4e-5 or 5.7e-5, but that was changed around R 3.3, if I recall />>/correctly. I provide descriptions here [1], but I haven't gone so far />>/as to post compiled Rblas.dlls just yet. My personal build sets 4 />>/threads when compiling OpenBLAS itself as I'm currently on a quad-core />>/SandyBridge. In tests I ran a few years ago, both single and multi />>/threaded BLAS compile and then can be compiled into R with no issues />>/(on my platforms, at least). Most matrix operations performed better />>/with multi-threaded except for R's eigenvalue decomposition, to the />>/nest of my recollection. />>//>>/Avi />>//>>/[1] https://www.avrahamadler.com/r-tips/build-openblas-for-windows-r64/ />>//>>/______________________________________________ />>/R-devel at r-project.org <https://stat.ethz.ch/mailman/listinfo/r-devel> mailing list />>/https://stat.ethz.ch/mailman/listinfo/r-devel />>//>//
>>>>> 	[[alternative HTML version deleted]]
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>


From istazahn at gmail.com  Thu Jan 11 13:56:06 2018
From: istazahn at gmail.com (Ista Zahn)
Date: Thu, 11 Jan 2018 07:56:06 -0500
Subject: [Rd] OpenBLAS in everyday R?
In-Reply-To: <CA+vqiLEmmihcAkVV0eKbsdPeAqX5vyBrS67nWX8fb66_Q2BeUg@mail.gmail.com>
References: <mailman.7.1513508402.51277.r-devel@r-project.org>
 <d895e254-67f0-f609-0fde-b32c949f12cf@gmail.com>
 <804CB69F-0628-4ACF-A3A5-CDEFA292B565@nyu.edu>
 <6220ffde-1ba0-3e52-5a94-ada9be05f81d@gmail.com>
 <866170A0-52CE-4984-84EF-DF75AB1F6056@nyu.edu>
 <fb7c236b-89ea-2818-6e0e-b726b6dca752@gmail.com>
 <CA+vqiLEmmihcAkVV0eKbsdPeAqX5vyBrS67nWX8fb66_Q2BeUg@mail.gmail.com>
Message-ID: <CA+vqiLEt9yQcV928rnbtgEKDVmsn+hpjm68PE6E95GRk2mr6+w@mail.gmail.com>

On Jan 10, 2018 8:24 PM, "Benjamin Tyner" <btyner at gmail.com> wrote:

Thanks Keith. We checked, and indeed libopenblas is not linked against
libomp nor libgomp. We suspect this is because we used conda to install R
and OpenBLAS. So I guess we should be barking up the conda tree instead?


What are you barking about? I don't understand what you are trying to
accomplish.

By the way, I also noticed on my home machine (Ubuntu),
/usr/lib/libopenblas.so.0 is also not linked against those, for what that's
worth.

Regards,
Ben


On 01/10/2018 12:04 AM, Keith O'Hara wrote:

> Check if libopenblas is linked against libomp or libgomp.
>
> I?d be curious to see any errors that arise when an OpenMP version of
> OpenBLAS is linked with R.
>
> Keith
>
>
> On Jan 9, 2018, at 11:01 PM, Benjamin Tyner <btyner at gmail.com> wrote:
>>
>> I didn't do the compile; is there a way to check whether that was used?
>> If not, I'll inquire with our sysadmin and report back.
>>
>> In any case, my suggestion was motivated by the fact that some parts of R
>> use OpenMP while others do not, in the hope that the former could have
>> their OpenBLAS omelet without breaking the OpenMP eggs, so to speak.
>>
>>
>> On 01/09/2018 06:41 PM, Keith O'Hara wrote:
>>
>>> Do those issues still arise when OpenBLAS is compiled with USE_OPENMP=1 ?
>>>
>>> Keith
>>>
>>> On Jan 9, 2018, at 6:03 PM, Benjamin Tyner <btyner at gmail.com> wrote:
>>>>
>>>> Please pardon my ignorance, but doesn't OpenBLAS still not always play
>>>> nicely with multi-threaded OpenMP? (for example, don't race conditions
>>>> sometimes crop up)? If so, it might be nice to have the ability to
>>>> temporarily disable multi-threaded OpenMP (effectively:
>>>> omp_set_num_threads(1)) for the duration of operations using OpenBLAS.
>>>>
>>>> Regards
>>>> Ben
>>>>
>>>> Julia using OpenBLAS is *very* reassuring.
>>>>>
>>>>> I agree that having it included as an options(...) feature should be
>>>>> OK.
>>>>>
>>>>> On Sun, Dec 17, 2017, 3:22 PM Juan Telleria <jtelleriar at gmail.com <
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote:
>>>>>
>>>>> /Julia Programming Language uses also OpenBlas, and it is actively
>>>>>> />/maintained with bugs being fixed as I have checked it out: />//>/
>>>>>> http://www.openblas.net/Changelog.txt />//>/So I still see it ok to
>>>>>> be included as an options(...) feature (by default />/off, just for
>>>>>> safety), over other Blas libraries. />//>/R could not use Intel MKL for
>>>>>> legal reasons (I think), because as long />/that R ships with GPL
>>>>>> libraries, shipping R by default with Non-GPL is />/illegal. />//>/Cheers,
>>>>>> />/Juan />//>/El 17/12/2017 2:50 a. m., "Avraham Adler" <avraham.adler at
>>>>>> gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>>
>>>>>> />/escribi?: />//>>/On Sat, Dec 16, 2017 at 7:41 PM, Kenny Bell <kmbell56
>>>>>> at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote:
>>>>>> />>/> It seems like many of the multi-threaded BLASes have some sort of
>>>>>> />>/> fundamental problem preventing use in the way Juan suggests: />>/>
>>>>>> />>/> - Dirk's vignette states that ATLAS "fixes the number of cores used
>>>>>> at />>/> compile-time and cannot vary this setting at run-time", so any
>>>>>> />>/> user-friendly implementation for R would have to compile ATLAS for
>>>>>> 1-16 />>/> threads to allow the user to switch at run-time. This might
>>>>>> dramatically />>/> affect install times. />>/> />>/> - MKL seems like it's
>>>>>> been outright rejected in the past based on not />>/> being "free-enough".
>>>>>> />>/> />>/> - OpenBLAS causes crashes. />>/> />>/> Has anyone tried ExBLAS
>>>>>> for use with R? />>/> />>/> On Sun, Dec 17, 2017 at 1:03 PM, Peter
>>>>>> Langfelder < />>/> peter.langfelder at gmail.com <
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote: />>/> />>/>>
>>>>>> I would be very cautious about OpenBLAS in particular... from time to
>>>>>> />>/>> time I get complains from users that compiled code calculations in
>>>>>> my />>/>> WGCNA package crash or produce wrong answers with large data, and
>>>>>> they />>/>> all come from OpenBLAS users. I am yet to reproduce any of
>>>>>> their />>/>> crashes when using MKL and ATLAS BLAS implementations. />>/>>
>>>>>> />>/>> Just my 2 cents... />>/>> />>/>> Peter />>//>>/I've been building R
>>>>>> on Windows 64 bit with OpenBLAS for years and my />>/builds pass
>>>>>> check-devel. For a while in the past it failed one check />>/as the
>>>>>> tolerance was 5e-5 and with my build of OpenBLAS the error was />>/5.4e-5
>>>>>> or 5.7e-5, but that was changed around R 3.3, if I recall />>/correctly. I
>>>>>> provide descriptions here [1], but I haven't gone so far />>/as to post
>>>>>> compiled Rblas.dlls just yet. My personal build sets 4 />>/threads when
>>>>>> compiling OpenBLAS itself as I'm currently on a quad-core />>/SandyBridge.
>>>>>> In tests I ran a few years ago, both single and multi />>/threaded BLAS
>>>>>> compile and then can be compiled into R with no issues />>/(on my
>>>>>> platforms, at least). Most matrix operations performed better />>/with
>>>>>> multi-threaded except for R's eigenvalue decomposition, to the />>/nest of
>>>>>> my recollection. />>//>>/Avi />>//>>/[1]
>>>>>> https://www.avrahamadler.com/r-tips/build-openblas-for-windows-r64/
>>>>>> />>//>>/______________________________________________ />>/R-devel
>>>>>> at r-project.org <https://stat.ethz.ch/mailman/listinfo/r-devel>
>>>>>> mailing list />>/https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>>> />>//>//
>>>>>>
>>>>>         [[alternative HTML version deleted]]
>>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>>
>>>
>>
______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel

	[[alternative HTML version deleted]]


From james.f.hester at gmail.com  Thu Jan 11 14:08:32 2018
From: james.f.hester at gmail.com (Jim Hester)
Date: Thu, 11 Jan 2018 08:08:32 -0500
Subject: [Rd] R CMD build then check fails on R-devel due to
	serialization version
In-Reply-To: <f861af0d-376a-0be4-ecb7-f09e8165893b@gmail.com>
References: <CAOCv4hjunyV2N87s5-kNyH9J7aOWr2wrK-A_zJ_jP657b3sHNA@mail.gmail.com>
 <f861af0d-376a-0be4-ecb7-f09e8165893b@gmail.com>
Message-ID: <CAD6tx97KwmaxnpXgZBYzc8ZXgAnYys=Aw9UF6JmK4RNXd-_2hQ@mail.gmail.com>

This change poses difficulties for automated build systems such as
travis-ci, which is widely used in the R community. In particular
because this is a WARNING and not a NOTE this causes all R-devel
builds with vignettes to fail, as the default settings fail the build
if R CMD check issues a WARNING.

The simplest change would be for R-core to change this message to be a
NOTE rather than a WARNING, the serialization could still be tested
and there would be a check against vignettes built with R-devel, but
it would not cause these builds to fail.

On Wed, Jan 10, 2018 at 3:52 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> On 10/01/2018 1:26 PM, Neal Richardson wrote:
>>
>> Hi,
>> Since yesterday I'm seeing `R CMD check --as-cran` failures on the
>> R-devel daily build (specifically, R Under development (unstable)
>> (2018-01-09 r74100)) for multiple packages:
>>
>> * checking serialized R objects in the sources ... WARNING
>> Found file(s) with version 3 serialization:
>> ?build/vignette.rds?
>> Such files are only readable in R >= 3.5.0.
>> Recreate them with R < 3.5.0 or save(version = 2) or saveRDS(version =
>> 2) as appropriate
>>
>> As far as I can tell, revision 74099
>>
>> (https://github.com/wch/r-source/commit/d9530001046a582ff6a43ca834d6c3586abd0a97),
>> which changes the default serialization format to 3, clashes with
>> revision 73973
>> (https://github.com/wch/r-source/commit/885764eb74f2211a547b13727f2ecc5470c3dd00),
>> which checks that serialized R objects are _not_ version 3. It seems
>> that with the current development version of R, if you `R CMD build`
>> and then run `R CMD check --as-cran` on the built package, it will
>> fail.
>>
>
> I think the message basically says:  don't do that.  You should build with
> R-release for now.  You always need to check with R-devel, so life is
> complicated.
>
> If you build with R-devel without forcing the old format, nobody using
> R-release will be able to use your tarball.
>
> Eventually I guess the new format will be accepted by CRAN, but it will
> likely be a while:  nobody expects everyone to instantly upgrade to a new R
> release, let alone to an unreleased development version.
>
> Presumably that particular file (build/vignette.rds) could be automatically
> built in the old format for now, but the new format needs testing, so it
> makes sense to me to leave it as a default, even if it makes it more
> complicated to submit a package to CRAN.
>
> Duncan Murdoch
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From luke-tierney at uiowa.edu  Thu Jan 11 14:47:49 2018
From: luke-tierney at uiowa.edu (luke-tierney at uiowa.edu)
Date: Thu, 11 Jan 2018 07:47:49 -0600 (CST)
Subject: [Rd] R CMD build then check fails on R-devel due
 to	serialization version
In-Reply-To: <CAD6tx97KwmaxnpXgZBYzc8ZXgAnYys=Aw9UF6JmK4RNXd-_2hQ@mail.gmail.com>
References: <CAOCv4hjunyV2N87s5-kNyH9J7aOWr2wrK-A_zJ_jP657b3sHNA@mail.gmail.com>
 <f861af0d-376a-0be4-ecb7-f09e8165893b@gmail.com>
 <CAD6tx97KwmaxnpXgZBYzc8ZXgAnYys=Aw9UF6JmK4RNXd-_2hQ@mail.gmail.com>
Message-ID: <alpine.OSX.2.20.1801110737220.7320@lukes-macbook-air.local>

As things stand now, package tarballs with vignettes that are built
with R-devel will not install in R 3.4.x, so CRAN can't accept them
and someone running R CMD check --as-cran should be told that. A
WARNING is appropriate.

Most likely what will change soon is that build/version.rds will be
saved with serialization version = 2 and this warning will not be
triggered just by having a vignette. It will still be triggered by
data files serialized with R-devel's default version = 3.

Please do remember that the 'devel' in R-devel means exactly that:
things will at times be unstable. There are currently a lot of balls
flying around with changes in R-devel and also Biocontuctor, and the
CRAN maintainers are working hard to keep things all up in the
air. Please be patient.

Best,

luke

On Thu, 11 Jan 2018, Jim Hester wrote:

> This change poses difficulties for automated build systems such as
> travis-ci, which is widely used in the R community. In particular
> because this is a WARNING and not a NOTE this causes all R-devel
> builds with vignettes to fail, as the default settings fail the build
> if R CMD check issues a WARNING.
>
> The simplest change would be for R-core to change this message to be a
> NOTE rather than a WARNING, the serialization could still be tested
> and there would be a check against vignettes built with R-devel, but
> it would not cause these builds to fail.
>
> On Wed, Jan 10, 2018 at 3:52 PM, Duncan Murdoch
> <murdoch.duncan at gmail.com> wrote:
>> On 10/01/2018 1:26 PM, Neal Richardson wrote:
>>>
>>> Hi,
>>> Since yesterday I'm seeing `R CMD check --as-cran` failures on the
>>> R-devel daily build (specifically, R Under development (unstable)
>>> (2018-01-09 r74100)) for multiple packages:
>>>
>>> * checking serialized R objects in the sources ... WARNING
>>> Found file(s) with version 3 serialization:
>>> ?build/vignette.rds?
>>> Such files are only readable in R >= 3.5.0.
>>> Recreate them with R < 3.5.0 or save(version = 2) or saveRDS(version =
>>> 2) as appropriate
>>>
>>> As far as I can tell, revision 74099
>>>
>>> (https://github.com/wch/r-source/commit/d9530001046a582ff6a43ca834d6c3586abd0a97),
>>> which changes the default serialization format to 3, clashes with
>>> revision 73973
>>> (https://github.com/wch/r-source/commit/885764eb74f2211a547b13727f2ecc5470c3dd00),
>>> which checks that serialized R objects are _not_ version 3. It seems
>>> that with the current development version of R, if you `R CMD build`
>>> and then run `R CMD check --as-cran` on the built package, it will
>>> fail.
>>>
>>
>> I think the message basically says:  don't do that.  You should build with
>> R-release for now.  You always need to check with R-devel, so life is
>> complicated.
>>
>> If you build with R-devel without forcing the old format, nobody using
>> R-release will be able to use your tarball.
>>
>> Eventually I guess the new format will be accepted by CRAN, but it will
>> likely be a while:  nobody expects everyone to instantly upgrade to a new R
>> release, let alone to an unreleased development version.
>>
>> Presumably that particular file (build/vignette.rds) could be automatically
>> built in the old format for now, but the new format needs testing, so it
>> makes sense to me to leave it as a default, even if it makes it more
>> complicated to submit a package to CRAN.
>>
>> Duncan Murdoch
>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Luke Tierney
Ralph E. Wareham Professor of Mathematical Sciences
University of Iowa                  Phone:             319-335-3386
Department of Statistics and        Fax:               319-335-3017
    Actuarial Science
241 Schaeffer Hall                  email:   luke-tierney at uiowa.edu
Iowa City, IA 52242                 WWW:  http://www.stat.uiowa.edu

From murdoch.duncan at gmail.com  Thu Jan 11 16:07:07 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 11 Jan 2018 10:07:07 -0500
Subject: [Rd] R-devel Digest, Vol 179, Issue 7
In-Reply-To: <375144$8l9mcs@ironport10.mayo.edu>
References: <mailman.9.1515668402.18846.r-devel@r-project.org>
 <375144$8l9mcs@ironport10.mayo.edu>
Message-ID: <c4a7eadf-4a70-b3f1-712b-c2178cc58c48@gmail.com>

On 11/01/2018 7:17 AM, Therneau, Terry M., Ph.D. wrote:
> This is not nice.? I have easy access to the "institutional" version of R on the
> department servers, which do not track R-release all that fast (3-12 month delay, affects
> 300+ users, and at the back end of a formalized IT process), and a personal machine on
> which I track R-devel, the latter at the behest of CRAN.? Now you are asking that I track
> yet another R version just for the sake of the R CMD BUILD script??? There are other ways
> to test the new serialization code than this single file in the tarball.

I'm not asking for anything.  I'm guessing at an explanation for what 
CRAN is asking.  I'm not part of CRAN or R Core.

But it seems like 2 versions should be sufficient:  build on the 
institutional version, test on your personal machine (or on one of the 
test services like WinBuilder, R-forge, R-hub, etc.).

Duncan Murdoch

> 
> Terry T.
> 
> 
> On 01/11/2018 05:00 AM, r-devel-request at r-project.org wrote:
>> I think the message basically says:  don't do that.  You should build
>> with R-release for now.  You always need to check with R-devel, so life
>> is complicated.
>>
>> If you build with R-devel without forcing the old format, nobody using
>> R-release will be able to use your tarball.
>>
>> Eventually I guess the new format will be accepted by CRAN, but it will
>> likely be a while:  nobody expects everyone to instantly upgrade to a
>> new R release, let alone to an unreleased development version.
>>
>> Presumably that particular file (build/vignette.rds) could be
>> automatically built in the old format for now, but the new format needs
>> testing, so it makes sense to me to leave it as a default, even if it
>> makes it more complicated to submit a package to CRAN.
>>
>> Duncan Murdoch
>>
>


From keith.ohara at nyu.edu  Thu Jan 11 16:38:14 2018
From: keith.ohara at nyu.edu (Keith O'Hara)
Date: Thu, 11 Jan 2018 10:38:14 -0500
Subject: [Rd] OpenBLAS in everyday R?
In-Reply-To: <fb7c236b-89ea-2818-6e0e-b726b6dca752@gmail.com>
References: <mailman.7.1513508402.51277.r-devel@r-project.org>
 <d895e254-67f0-f609-0fde-b32c949f12cf@gmail.com>
 <804CB69F-0628-4ACF-A3A5-CDEFA292B565@nyu.edu>
 <6220ffde-1ba0-3e52-5a94-ada9be05f81d@gmail.com>
 <866170A0-52CE-4984-84EF-DF75AB1F6056@nyu.edu>
 <fb7c236b-89ea-2818-6e0e-b726b6dca752@gmail.com>
Message-ID: <FD53F21E-0E46-423C-BDC5-F62E7C44A5B6@nyu.edu>

I?m not really familiar with conda, but if they?re being packaged together then an omp build might be more appropriate. 

Perhaps another point for Juan?s list: whether OpenBLAS is the right choice to pair with. The library itself hasn?t produced optimized kernels for any of the Intel *Lake chips yet; might be worth considering its near- and long-term future (vs something else).

Keith

> On Jan 10, 2018, at 8:24 PM, Benjamin Tyner <btyner at gmail.com> wrote:
> 
> Thanks Keith. We checked, and indeed libopenblas is not linked against libomp nor libgomp. We suspect this is because we used conda to install R and OpenBLAS. So I guess we should be barking up the conda tree instead?
> 
> By the way, I also noticed on my home machine (Ubuntu), /usr/lib/libopenblas.so.0 is also not linked against those, for what that's worth.
> 
> Regards,
> Ben
> 
> On 01/10/2018 12:04 AM, Keith O'Hara wrote:
>> Check if libopenblas is linked against libomp or libgomp.
>> 
>> I?d be curious to see any errors that arise when an OpenMP version of OpenBLAS is linked with R.
>> 
>> Keith
>> 
>> 
>>> On Jan 9, 2018, at 11:01 PM, Benjamin Tyner <btyner at gmail.com> wrote:
>>> 
>>> I didn't do the compile; is there a way to check whether that was used? If not, I'll inquire with our sysadmin and report back.
>>> 
>>> In any case, my suggestion was motivated by the fact that some parts of R use OpenMP while others do not, in the hope that the former could have their OpenBLAS omelet without breaking the OpenMP eggs, so to speak.
>>> 
>>> 
>>> On 01/09/2018 06:41 PM, Keith O'Hara wrote:
>>>> Do those issues still arise when OpenBLAS is compiled with USE_OPENMP=1 ?
>>>> 
>>>> Keith
>>>> 
>>>>> On Jan 9, 2018, at 6:03 PM, Benjamin Tyner <btyner at gmail.com> wrote:
>>>>> 
>>>>> Please pardon my ignorance, but doesn't OpenBLAS still not always play nicely with multi-threaded OpenMP? (for example, don't race conditions sometimes crop up)? If so, it might be nice to have the ability to temporarily disable multi-threaded OpenMP (effectively: omp_set_num_threads(1)) for the duration of operations using OpenBLAS.
>>>>> 
>>>>> Regards
>>>>> Ben
>>>>> 
>>>>>> Julia using OpenBLAS is *very* reassuring.
>>>>>> 
>>>>>> I agree that having it included as an options(...) feature should be OK.
>>>>>> 
>>>>>> On Sun, Dec 17, 2017, 3:22 PM Juan Telleria <jtelleriar at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote:
>>>>>> 
>>>>>>> /Julia Programming Language uses also OpenBlas, and it is actively />/maintained with bugs being fixed as I have checked it out: />//>/http://www.openblas.net/Changelog.txt />//>/So I still see it ok to be included as an options(...) feature (by default />/off, just for safety), over other Blas libraries. />//>/R could not use Intel MKL for legal reasons (I think), because as long />/that R ships with GPL libraries, shipping R by default with Non-GPL is />/illegal. />//>/Cheers, />/Juan />//>/El 17/12/2017 2:50 a. m., "Avraham Adler" <avraham.adler at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> />/escribi?: />//>>/On Sat, Dec 16, 2017 at 7:41 PM, Kenny Bell <kmbell56 at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote: />>/> It seems like many of the multi-threaded BLASes have some sort of />>/> fundamental problem preventing use in the way Juan suggests: />>/> />>/> - Dirk's vignette states that ATLAS "fixes the number of cores used at />>/> compile-time and cannot vary this setting at run-time", so any />>/> user-friendly implementation for R would have to compile ATLAS for 1-16 />>/> threads to allow the user to switch at run-time. This might dramatically />>/> affect install times. />>/> />>/> - MKL seems like it's been outright rejected in the past based on not />>/> being "free-enough". />>/> />>/> - OpenBLAS causes crashes. />>/> />>/> Has anyone tried ExBLAS for use with R? />>/> />>/> On Sun, Dec 17, 2017 at 1:03 PM, Peter Langfelder < />>/> peter.langfelder at gmail.com <https://stat.ethz.ch/mailman/listinfo/r-devel>> wrote: />>/> />>/>> I would be very cautious about OpenBLAS in particular... from time to />>/>> time I get complains from users that compiled code calculations in my />>/>> WGCNA package crash or produce wrong answers with large data, and they />>/>> all come from OpenBLAS users. I am yet to reproduce any of their />>/>> crashes when using MKL and ATLAS BLAS implementations. />>/>> />>/>> Just my 2 cents... />>/>> />>/>> Peter />>//>>/I've been building R on Windows 64 bit with OpenBLAS for years and my />>/builds pass check-devel. For a while in the past it failed one check />>/as the tolerance was 5e-5 and with my build of OpenBLAS the error was />>/5.4e-5 or 5.7e-5, but that was changed around R 3.3, if I recall />>/correctly. I provide descriptions here [1], but I haven't gone so far />>/as to post compiled Rblas.dlls just yet. My personal build sets 4 />>/threads when compiling OpenBLAS itself as I'm currently on a quad-core />>/SandyBridge. In tests I ran a few years ago, both single and multi />>/threaded BLAS compile and then can be compiled into R with no issues />>/(on my platforms, at least). Most matrix operations performed better />>/with multi-threaded except for R's eigenvalue decomposition, to the />>/nest of my recollection. />>//>>/Avi />>//>>/[1] https://www.avrahamadler.com/r-tips/build-openblas-for-windows-r64/ />>//>>/______________________________________________ />>/R-devel at r-project.org <https://stat.ethz.ch/mailman/listinfo/r-devel> mailing list />>/https://stat.ethz.ch/mailman/listinfo/r-devel />>//>//
>>>>>> 	[[alternative HTML version deleted]]
>>>>> ______________________________________________
>>>>> R-devel at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>> 
> 
> 


From avraham.adler at gmail.com  Thu Jan 11 17:57:58 2018
From: avraham.adler at gmail.com (Avraham Adler)
Date: Thu, 11 Jan 2018 11:57:58 -0500
Subject: [Rd] OpenBLAS in everyday R?
In-Reply-To: <FD53F21E-0E46-423C-BDC5-F62E7C44A5B6@nyu.edu>
References: <mailman.7.1513508402.51277.r-devel@r-project.org>
 <d895e254-67f0-f609-0fde-b32c949f12cf@gmail.com>
 <804CB69F-0628-4ACF-A3A5-CDEFA292B565@nyu.edu>
 <6220ffde-1ba0-3e52-5a94-ada9be05f81d@gmail.com>
 <866170A0-52CE-4984-84EF-DF75AB1F6056@nyu.edu>
 <fb7c236b-89ea-2818-6e0e-b726b6dca752@gmail.com>
 <FD53F21E-0E46-423C-BDC5-F62E7C44A5B6@nyu.edu>
Message-ID: <CAL6gwn+X3dkqyVQ7DFeW-5FZ0jgT6pf_-3Vxza1+JjmXnRFCUg@mail.gmail.com>

On Thu, Jan 11, 2018 at 10:38 AM, Keith O'Hara <keith.ohara at nyu.edu> wrote:

[snip]
>
> Perhaps another point for Juan?s list: whether OpenBLAS is the right choice to pair with. The library itself hasn?t produced optimized kernels for any of the Intel *Lake chips yet; might be worth considering its near- and long-term future (vs something else).
>

Regarding this point, please see this thread on OpenBLAS-users [1], in
specific the third post by Jeff Hammond who says he is an employee of
Intel, where he says:

 "Skylake Xeon processors with AVX-512 are definitely going to require
code changes to perform optimally. However, the Core i[357] processors
up to and including Kaby Lake do not support AVX-512 and thus can
suffice with the existing AVX2 implementation that targets Haswell.
See https://ark.intel.com/#@Processors and look for "Instruction Set
Extensions" for full details on on specific SKUs."

I presume this holds for CoffeeLake as well, as it's pretty much a
hexacore SkyLake.

Thank you,

Avi

[1] https://groups.google.com/d/msg/openblas-users/XU6-9h-geVE/mwz2ewKrCQAJ


From btyner at gmail.com  Fri Jan 12 00:07:50 2018
From: btyner at gmail.com (Benjamin Tyner)
Date: Thu, 11 Jan 2018 18:07:50 -0500
Subject: [Rd] OpenBLAS in everyday R?
In-Reply-To: <CA+vqiLEt9yQcV928rnbtgEKDVmsn+hpjm68PE6E95GRk2mr6+w@mail.gmail.com>
References: <mailman.7.1513508402.51277.r-devel@r-project.org>
 <d895e254-67f0-f609-0fde-b32c949f12cf@gmail.com>
 <804CB69F-0628-4ACF-A3A5-CDEFA292B565@nyu.edu>
 <6220ffde-1ba0-3e52-5a94-ada9be05f81d@gmail.com>
 <866170A0-52CE-4984-84EF-DF75AB1F6056@nyu.edu>
 <fb7c236b-89ea-2818-6e0e-b726b6dca752@gmail.com>
 <CA+vqiLEmmihcAkVV0eKbsdPeAqX5vyBrS67nWX8fb66_Q2BeUg@mail.gmail.com>
 <CA+vqiLEt9yQcV928rnbtgEKDVmsn+hpjm68PE6E95GRk2mr6+w@mail.gmail.com>
Message-ID: <794cdf8d-8a22-9a68-f487-f1c2a8356271@gmail.com>

True or False: when USE_OPENMP=1 is not used, then race conditions are 
not unexpected.

If True, and we wish to avoid race conditions, then sources such as the 
conda channel and ubuntu would need to add this enhancement.

If False, then what is the next step (i.e. forum) for debugging the race 
condition?


On 01/11/2018 07:56 AM, Ista Zahn wrote:
>
>
> On Jan 10, 2018 8:24 PM, "Benjamin Tyner" <btyner at gmail.com 
> <mailto:btyner at gmail.com>> wrote:
>
>     Thanks Keith. We checked, and indeed libopenblas is not linked
>     against libomp nor libgomp. We suspect this is because we used
>     conda to install R and OpenBLAS. So I guess we should be barking
>     up the conda tree instead?
>
>
> What are you barking about? I don't understand what you are trying to 
> accomplish.
>
>     By the way, I also noticed on my home machine (Ubuntu),
>     /usr/lib/libopenblas.so.0 is also not linked against those, for
>     what that's worth.
>
>     Regards,
>     Ben
>
>
>     On 01/10/2018 12:04 AM, Keith O'Hara wrote:
>
>         Check if libopenblas is linked against libomp or libgomp.
>
>         I?d be curious to see any errors that arise when an OpenMP
>         version of OpenBLAS is linked with R.
>
>         Keith
>
>
>             On Jan 9, 2018, at 11:01 PM, Benjamin Tyner
>             <btyner at gmail.com <mailto:btyner at gmail.com>> wrote:
>
>             I didn't do the compile; is there a way to check whether
>             that was used? If not, I'll inquire with our sysadmin and
>             report back.
>
>             In any case, my suggestion was motivated by the fact that
>             some parts of R use OpenMP while others do not, in the
>             hope that the former could have their OpenBLAS omelet
>             without breaking the OpenMP eggs, so to speak.
>
>
>             On 01/09/2018 06:41 PM, Keith O'Hara wrote:
>
>                 Do those issues still arise when OpenBLAS is compiled
>                 with USE_OPENMP=1 ?
>
>                 Keith
>
>                     On Jan 9, 2018, at 6:03 PM, Benjamin Tyner
>                     <btyner at gmail.com <mailto:btyner at gmail.com>> wrote:
>
>                     Please pardon my ignorance, but doesn't OpenBLAS
>                     still not always play nicely with multi-threaded
>                     OpenMP? (for example, don't race conditions
>                     sometimes crop up)? If so, it might be nice to
>                     have the ability to temporarily disable
>                     multi-threaded OpenMP (effectively:
>                     omp_set_num_threads(1)) for the duration of
>                     operations using OpenBLAS.
>
>                     Regards
>                     Ben
>
>                         Julia using OpenBLAS is *very* reassuring.
>
>                         I agree that having it included as an
>                         options(...) feature should be OK.
>
>                         On Sun, Dec 17, 2017, 3:22 PM Juan Telleria
>                         <jtelleriar at gmail.com <http://gmail.com>
>                         <https://stat.ethz.ch/mailman/listinfo/r-devel
>                         <https://stat.ethz.ch/mailman/listinfo/r-devel>>>
>                         wrote:
>
>                             /Julia Programming Language uses also
>                             OpenBlas, and it is actively />/maintained
>                             with bugs being fixed as I have checked it
>                             out:
>                             />//>/http://www.openblas.net/Changelog.txt
>                             <http://www.openblas.net/Changelog.txt>
>                             />//>/So I still see it ok to be included
>                             as an options(...) feature (by default
>                             />/off, just for safety), over other Blas
>                             libraries. />//>/R could not use Intel MKL
>                             for legal reasons (I think), because as
>                             long />/that R ships with GPL libraries,
>                             shipping R by default with Non-GPL is
>                             />/illegal. />//>/Cheers, />/Juan />//>/El
>                             17/12/2017 2:50 a. m., "Avraham Adler"
>                             <avraham.adler at gmail.com
>                             <http://gmail.com>
>                             <https://stat.ethz.ch/mailman/listinfo/r-devel
>                             <https://stat.ethz.ch/mailman/listinfo/r-devel>>>
>                             />/escribi?: />//>>/On Sat, Dec 16, 2017
>                             at 7:41 PM, Kenny Bell <kmbell56 at
>                             gmail.com <http://gmail.com>
>                             <https://stat.ethz.ch/mailman/listinfo/r-devel
>                             <https://stat.ethz.ch/mailman/listinfo/r-devel>>>
>                             wrote: />>/> It seems like many of the
>                             multi-threaded BLASes have some sort of
>                             />>/> fundamental problem preventing use
>                             in the way Juan suggests: />>/> />>/> -
>                             Dirk's vignette states that ATLAS "fixes
>                             the number of cores used at />>/>
>                             compile-time and cannot vary this setting
>                             at run-time", so any />>/> user-friendly
>                             implementation for R would have to compile
>                             ATLAS for 1-16 />>/> threads to allow the
>                             user to switch at run-time. This might
>                             dramatically />>/> affect install times.
>                             />>/> />>/> - MKL seems like it's been
>                             outright rejected in the past based on not
>                             />>/> being "free-enough". />>/> />>/> -
>                             OpenBLAS causes crashes. />>/> />>/> Has
>                             anyone tried ExBLAS for use with R? />>/>
>                             />>/> On Sun, Dec 17, 2017 at 1:03 PM,
>                             Peter Langfelder < />>/> peter.langfelder
>                             at gmail.com <http://gmail.com>
>                             <https://stat.ethz.ch/mailman/listinfo/r-devel
>                             <https://stat.ethz.ch/mailman/listinfo/r-devel>>>
>                             wrote: />>/> />>/>> I would be very
>                             cautious about OpenBLAS in particular...
>                             from time to />>/>> time I get complains
>                             from users that compiled code calculations
>                             in my />>/>> WGCNA package crash or
>                             produce wrong answers with large data, and
>                             they />>/>> all come from OpenBLAS users.
>                             I am yet to reproduce any of their />>/>>
>                             crashes when using MKL and ATLAS BLAS
>                             implementations. />>/>> />>/>> Just my 2
>                             cents... />>/>> />>/>> Peter />>//>>/I've
>                             been building R on Windows 64 bit with
>                             OpenBLAS for years and my />>/builds pass
>                             check-devel. For a while in the past it
>                             failed one check />>/as the tolerance was
>                             5e-5 and with my build of OpenBLAS the
>                             error was />>/5.4e-5 or 5.7e-5, but that
>                             was changed around R 3.3, if I recall
>                             />>/correctly. I provide descriptions here
>                             [1], but I haven't gone so far />>/as to
>                             post compiled Rblas.dlls just yet. My
>                             personal build sets 4 />>/threads when
>                             compiling OpenBLAS itself as I'm currently
>                             on a quad-core />>/SandyBridge. In tests I
>                             ran a few years ago, both single and multi
>                             />>/threaded BLAS compile and then can be
>                             compiled into R with no issues />>/(on my
>                             platforms, at least). Most matrix
>                             operations performed better />>/with
>                             multi-threaded except for R's eigenvalue
>                             decomposition, to the />>/nest of my
>                             recollection. />>//>>/Avi />>//>>/[1]
>                             https://www.avrahamadler.com/r-tips/build-openblas-for-windows-r64/
>                             <https://www.avrahamadler.com/r-tips/build-openblas-for-windows-r64/>
>                             />>//>>/______________________________________________
>                             />>/R-devel at r-project.org
>                             <http://r-project.org>
>                             <https://stat.ethz.ch/mailman/listinfo/r-devel
>                             <https://stat.ethz.ch/mailman/listinfo/r-devel>>
>                             mailing list
>                             />>/https://stat.ethz.ch/mailman/listinfo/r-devel
>                             <https://stat.ethz.ch/mailman/listinfo/r-devel>
>                             />>//>//
>
>                         ? ? ? ? [[alternative HTML version deleted]]
>
>                     ______________________________________________
>                     R-devel at r-project.org
>                     <mailto:R-devel at r-project.org> mailing list
>                     https://stat.ethz.ch/mailman/listinfo/r-devel
>                     <https://stat.ethz.ch/mailman/listinfo/r-devel>
>
>
>
>     ______________________________________________
>     R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-devel>
>
>


From tomas.kalibera at gmail.com  Sat Jan 13 01:35:24 2018
From: tomas.kalibera at gmail.com (Tomas Kalibera)
Date: Sat, 13 Jan 2018 01:35:24 +0100
Subject: [Rd] R CMD build then check fails on R-devel due to
 serialization version
In-Reply-To: <alpine.OSX.2.20.1801110737220.7320@lukes-macbook-air.local>
References: <CAOCv4hjunyV2N87s5-kNyH9J7aOWr2wrK-A_zJ_jP657b3sHNA@mail.gmail.com>
 <f861af0d-376a-0be4-ecb7-f09e8165893b@gmail.com>
 <CAD6tx97KwmaxnpXgZBYzc8ZXgAnYys=Aw9UF6JmK4RNXd-_2hQ@mail.gmail.com>
 <alpine.OSX.2.20.1801110737220.7320@lukes-macbook-air.local>
Message-ID: <f2d6aad6-a1ab-222c-8b2d-eaff3c2cb721@gmail.com>

To reduce difficulties for people relying on automated tests set up to 
build&"check --as-cran" using R-devel (e.g. travis-ci), the default 
serialization version has been temporarily switched back to 2. Thank you 
for your patience - according to svn history, the last change of the 
serialization format happened 16 years ago, and unsurprisingly some 
practices that developed since did not anticipate such change and have 
to be adapted.

CRAN is now protected against packages containing serialized files in 
format 3 (which not only is not readable by 3.4.x and older, but could 
still change - the 'devel' in 'R-devel'). These new checks have to stay 
but we are looking at improving package-maintainer-friendliness. It 
turned out more difficult than just 1-2 days, hence the temporary switch 
back to version 2.

Best
Tomas

On 01/11/2018 02:47 PM, luke-tierney at uiowa.edu wrote:
> As things stand now, package tarballs with vignettes that are built
> with R-devel will not install in R 3.4.x, so CRAN can't accept them
> and someone running R CMD check --as-cran should be told that. A
> WARNING is appropriate.
>
> Most likely what will change soon is that build/version.rds will be
> saved with serialization version = 2 and this warning will not be
> triggered just by having a vignette. It will still be triggered by
> data files serialized with R-devel's default version = 3.
>
> Please do remember that the 'devel' in R-devel means exactly that:
> things will at times be unstable. There are currently a lot of balls
> flying around with changes in R-devel and also Biocontuctor, and the
> CRAN maintainers are working hard to keep things all up in the
> air. Please be patient.
>
> Best,
>
> luke
>
> On Thu, 11 Jan 2018, Jim Hester wrote:
>
>> This change poses difficulties for automated build systems such as
>> travis-ci, which is widely used in the R community. In particular
>> because this is a WARNING and not a NOTE this causes all R-devel
>> builds with vignettes to fail, as the default settings fail the build
>> if R CMD check issues a WARNING.
>>
>> The simplest change would be for R-core to change this message to be a
>> NOTE rather than a WARNING, the serialization could still be tested
>> and there would be a check against vignettes built with R-devel, but
>> it would not cause these builds to fail.
>>
>> On Wed, Jan 10, 2018 at 3:52 PM, Duncan Murdoch
>> <murdoch.duncan at gmail.com> wrote:
>>> On 10/01/2018 1:26 PM, Neal Richardson wrote:
>>>>
>>>> Hi,
>>>> Since yesterday I'm seeing `R CMD check --as-cran` failures on the
>>>> R-devel daily build (specifically, R Under development (unstable)
>>>> (2018-01-09 r74100)) for multiple packages:
>>>>
>>>> * checking serialized R objects in the sources ... WARNING
>>>> Found file(s) with version 3 serialization:
>>>> ?build/vignette.rds?
>>>> Such files are only readable in R >= 3.5.0.
>>>> Recreate them with R < 3.5.0 or save(version = 2) or saveRDS(version =
>>>> 2) as appropriate
>>>>
>>>> As far as I can tell, revision 74099
>>>>
>>>> (https://github.com/wch/r-source/commit/d9530001046a582ff6a43ca834d6c3586abd0a97), 
>>>>
>>>> which changes the default serialization format to 3, clashes with
>>>> revision 73973
>>>> (https://github.com/wch/r-source/commit/885764eb74f2211a547b13727f2ecc5470c3dd00), 
>>>>
>>>> which checks that serialized R objects are _not_ version 3. It seems
>>>> that with the current development version of R, if you `R CMD build`
>>>> and then run `R CMD check --as-cran` on the built package, it will
>>>> fail.
>>>>
>>>
>>> I think the message basically says:? don't do that.? You should 
>>> build with
>>> R-release for now.? You always need to check with R-devel, so life is
>>> complicated.
>>>
>>> If you build with R-devel without forcing the old format, nobody using
>>> R-release will be able to use your tarball.
>>>
>>> Eventually I guess the new format will be accepted by CRAN, but it will
>>> likely be a while:? nobody expects everyone to instantly upgrade to 
>>> a new R
>>> release, let alone to an unreleased development version.
>>>
>>> Presumably that particular file (build/vignette.rds) could be 
>>> automatically
>>> built in the old format for now, but the new format needs testing, 
>>> so it
>>> makes sense to me to leave it as a default, even if it makes it more
>>> complicated to submit a package to CRAN.
>>>
>>> Duncan Murdoch
>>>
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From David.Kreil at boku.ac.at  Sat Jan 13 18:52:57 2018
From: David.Kreil at boku.ac.at (Dr. D. P. Kreil (Boku))
Date: Sat, 13 Jan 2018 18:52:57 +0100
Subject: [Rd] configure: PATH not honoured when locating kpsewhich
Message-ID: <CA+JN6ZV_cr3tW7z=2sWJOXH6e+t9vwrH-p3d2LjPGxcLvJ0vNQ@mail.gmail.com>

Dear R-Developers,

I have just noticed that R configure picks up an older system kpsewhich
(and consequently fails) despite the correct kpsewhich being in the PATH as
it should. So "which kpsewhich" gives the correct one. I could work around
this by setting KPSEWHICH=`which kpsewhich` on the configure command line.
Is there any reason the PATH is not being honoured? In many situations
users have no control over system installed packages (not being root) so I
would have thought that R configure should honour the build environment,
esp PATH.

With best regards,
David


observed behaviour (current R-3.4.3 release)

$ ./configure
...
leads to inconsolata.sty etc not being found because they're not in the
system TeX installation. According to the configure output, the
location /usr/bin/kpsewhich is being used.


$ ./configure KPSEWHICH=`which kpsewhich`
...
completes successfully.


expected behaviour:

$ ./configure
...
completes successfully.

	[[alternative HTML version deleted]]


From fisikop at gmail.com  Mon Jan 15 17:20:02 2018
From: fisikop at gmail.com (Vissarion Fisikopoulos)
Date: Mon, 15 Jan 2018 18:20:02 +0200
Subject: [Rd] searching co-mentor for gsoc18
Message-ID: <CAKa7CYP9+-L3EywLpxZzVX0Bfy9mwx12Vv4VHO8uX8r2cCpdXQ@mail.gmail.com>

Dear R community,

I am in a quest for a co-mentor, expert in R, for the following GSoC18
project proposal:

https://github.com/rstats-gsoc/gsoc2018/wiki/Sampling-and-volume-approximation

Thank you in advance for your feedback.

Best,
Vissarion Fisikopoulos


From brian at braverock.com  Mon Jan 15 18:34:20 2018
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 15 Jan 2018 11:34:20 -0600
Subject: [Rd] searching co-mentor for gsoc18
In-Reply-To: <CAKa7CYP9+-L3EywLpxZzVX0Bfy9mwx12Vv4VHO8uX8r2cCpdXQ@mail.gmail.com>
References: <CAKa7CYP9+-L3EywLpxZzVX0Bfy9mwx12Vv4VHO8uX8r2cCpdXQ@mail.gmail.com>
Message-ID: <8c18a0ff-89de-c10e-0070-889a7694f25a@braverock.com>

On 01/15/2018 10:20 AM, Vissarion Fisikopoulos wrote:
> Dear R community,
> 
> I am in a quest for a co-mentor, expert in R, for the following GSoC18
> project proposal:
> 
> https://github.com/rstats-gsoc/gsoc2018/wiki/Sampling-and-volume-approximation
> 
> Thank you in advance for your feedback.

Visarion,

You probably want to post your request to the GSoC-R Google Group:

https://groups.google.com/forum/#!forum/gsoc-r
(you must join the group to post there, and all prospective mentors 
should be members anyway)

 From reading your proposal, I would suggest approaching the author(s) 
of the 'geometry' package and exploring whether that team would be 
interested in participating, maybe extending the existing package rather 
than creating a new implementation.

Regards,

Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From jorismeys at gmail.com  Tue Jan 16 17:52:04 2018
From: jorismeys at gmail.com (Joris Meys)
Date: Tue, 16 Jan 2018 17:52:04 +0100
Subject: [Rd] Bug 17159 - recursive dir.create() fails on windows shares
 due to permissions
In-Reply-To: <44DC0D86-8E3B-42B8-99DA-71A588AD8616@quintiles.com>
References: <44DC0D86-8E3B-42B8-99DA-71A588AD8616@quintiles.com>
Message-ID: <CAO1zAVasTKupjQF8mJewAzdyqrJk=vvghMdJqc8uVdS_N5mCZw@mail.gmail.com>

Hi all,

I ran into this exact issue yesterday during the exam of statistical
computing. Users can install packages in a user library that R tries to
create automatically on the network drive of the student. But that doesn't
happen as the unc path is not read correctly, leading to R attempting to
create a local directory and being told it has no right to do so.

That is an older version of R though (3.3), but I'm wondering whether I
would ask our IT department to just update R on all these computers to the
latest version, or if we have to look for another solution.

Cheers
Joris

On Mon, Jan 8, 2018 at 1:43 PM, Thompson, Pete <Pete.Thompson at iqvia.com>
wrote:

> Hi, I?d like to ask about bug 17159:
>
> https://bugs.r-project.org/bugzilla/show_bug.cgi?id=17159
>
> I can confirm that I see exactly this bug when using dir.create on paths
> of UNC form (\\server\share\xxx), with the recursive flag set. I?m seeing
> this when attempting to use install.packages with such a path (which I know
> isn?t supported, but would be great if it was!). I can see that a patch has
> been suggested for the problem and from looking at the source code I
> believe it?s a correct fix. Is there a possibility of getting this patch
> included?
>
> The existing logic for Windows recursive dir.create (platform.c lines
> 2209-22203) appears to be:
> - Skip over any \\share at the start of the directory name
> - Loop while there are pieces of directory name left (i.e. we haven?t hit
> the last \ character)
>   = Find the next portion of the directory name (up to the next \
> character)
>   = Attempt to create the directory (unless it is of the form x: - i.e. a
> drive name)
>   = Ignore any ?already exists? errors, otherwise throw an error
>
> This logic appears flawed in that it skips \\share which isn?t a valid
> path format (according to https://msdn.microsoft.com/en-
> us/library/windows/desktop/aa365247(v=vs.85).aspx ). Dredging my memory,
> it?s possible that \\share was a supported format in very old versions of
> Windows, but it?s been a long time since the UNC format came in. It?s also
> possible that \\share is a valid format in some odd environments, but the
> UNC format is far more widely used.
>
> The patch suggested by Evan Cortens is simply to change the skip logic to
> skip over \\server\share instead of \\share. This will certainly fix the
> common use case of using UNC paths, but doesn?t attempt to deal with all
> the more complex options in Microsoft?s documentation. I doubt many users
> would ask for the complex cases, but the basic UNC format would be of wide
> applicability.
>
> Thanks
> Pete Thompson
> Director, Information Technology
> Head of Spotfire Centre of Excellence
> IQVIA
>
>
>
>
> ________________________________________
> IMPORTANT - PLEASE READ: This electronic message, including its
> attachments, is CONFIDENTIAL and may contain PROPRIETARY or LEGALLY
> PRIVILEGED or PROTECTED information and is intended for the authorized
> recipient of the sender. If you are not the intended recipient, you are
> hereby notified that any use, disclosure, copying, or distribution of this
> message or any of the information included in it is unauthorized and
> strictly prohibited. If you have received this message in error, please
> immediately notify the sender by reply e-mail and permanently delete this
> message and its attachments, along with any copies thereof, from all
> locations received (e.g., computer, mobile device, etc.). Thank you.
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel




-- 
Joris Meys
Statistical consultant

Department of Data Analysis and Mathematical Modelling
Ghent University
Coupure Links 653, B-9000 Gent (Belgium)
<https://maps.google.com/?q=Coupure+links+653,%C2%A0B-9000+Gent,%C2%A0Belgium&entry=gmail&source=g>

-----------
Biowiskundedagen 2017-2018
http://www.biowiskundedagen.ugent.be/

-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php

	[[alternative HTML version deleted]]


From jtelleriar at gmail.com  Tue Jan 16 20:52:05 2018
From: jtelleriar at gmail.com (Juan Telleria)
Date: Tue, 16 Jan 2018 20:52:05 +0100
Subject: [Rd] OpenBLAS in everyday R?
In-Reply-To: <794cdf8d-8a22-9a68-f487-f1c2a8356271@gmail.com>
References: <mailman.7.1513508402.51277.r-devel@r-project.org>
 <d895e254-67f0-f609-0fde-b32c949f12cf@gmail.com>
 <804CB69F-0628-4ACF-A3A5-CDEFA292B565@nyu.edu>
 <6220ffde-1ba0-3e52-5a94-ada9be05f81d@gmail.com>
 <866170A0-52CE-4984-84EF-DF75AB1F6056@nyu.edu>
 <fb7c236b-89ea-2818-6e0e-b726b6dca752@gmail.com>
 <CA+vqiLEmmihcAkVV0eKbsdPeAqX5vyBrS67nWX8fb66_Q2BeUg@mail.gmail.com>
 <CA+vqiLEt9yQcV928rnbtgEKDVmsn+hpjm68PE6E95GRk2mr6+w@mail.gmail.com>
 <794cdf8d-8a22-9a68-f487-f1c2a8356271@gmail.com>
Message-ID: <CANNd7==KLeF6-BTwPhcEjZy3-4XrAJn+-D5NS3Z_KDVaC6ae9g@mail.gmail.com>

Dear R Developers,

I attach a complete summary of all the Know-How that has been generated
during Dec 2017 & Jan 2018 in R-devel Mailing List related to the Dynamic
Change of:

   - Regular Single Threaded BLAS.
   - And a Multi-threaded BLAS Implementation (e.g.: OpenBLAS):

https://kbrproject.miraheze.org/wiki/BLAS_Libraries

Kind regards,
Juan Telleria

	[[alternative HTML version deleted]]


From pd.mes at cbs.dk  Wed Jan 17 11:52:11 2018
From: pd.mes at cbs.dk (Peter Dalgaard)
Date: Wed, 17 Jan 2018 10:52:11 +0000
Subject: [Rd] [R-win] Bug 17159 - recursive dir.create() fails on
 windows shares due to permissions (MMaechler: Resending to
 R-windows@R-pr..)
In-Reply-To: <CAO1zAVasTKupjQF8mJewAzdyqrJk=vvghMdJqc8uVdS_N5mCZw@mail.gmail.com>
References: <44DC0D86-8E3B-42B8-99DA-71A588AD8616@quintiles.com>
 <CAO1zAVasTKupjQF8mJewAzdyqrJk=vvghMdJqc8uVdS_N5mCZw@mail.gmail.com>
Message-ID: <DA11F272-BA91-4869-BEC3-D75772FCB312@cbs.dk>

I usually draw a complete blank if  I try to assist our IT department with such issues (we really need better documentation than the Admin manual for large-system installs by non-experts in R). 

However, it is my impression that there are also options involving environment variables and LFS naming. E.g., map the networked user directory to, say, a P: "drive" and make sure that the environment is set up to reflect this.

-pd

> On 16 Jan 2018, at 17:52 , Joris Meys <jorismeys at gmail.com> wrote:
> 
> Hi all,
> 
> I ran into this exact issue yesterday during the exam of statistical
> computing. Users can install packages in a user library that R tries to
> create automatically on the network drive of the student. But that doesn't
> happen as the unc path is not read correctly, leading to R attempting to
> create a local directory and being told it has no right to do so.
> 
> That is an older version of R though (3.3), but I'm wondering whether I
> would ask our IT department to just update R on all these computers to the
> latest version, or if we have to look for another solution.
> 
> Cheers
> Joris
> 
> On Mon, Jan 8, 2018 at 1:43 PM, Thompson, Pete <Pete.Thompson at iqvia.com>
> wrote:
> 
>> Hi, I?d like to ask about bug 17159:
>> 
>> https://bugs.r-project.org/bugzilla/show_bug.cgi?id=17159
>> 
>> I can confirm that I see exactly this bug when using dir.create on paths
>> of UNC form (\\server\share\xxx), with the recursive flag set. I?m seeing
>> this when attempting to use install.packages with such a path (which I know
>> isn?t supported, but would be great if it was!). I can see that a patch has
>> been suggested for the problem and from looking at the source code I
>> believe it?s a correct fix. Is there a possibility of getting this patch
>> included?
>> 
>> The existing logic for Windows recursive dir.create (platform.c lines
>> 2209-22203) appears to be:
>> - Skip over any \\share at the start of the directory name
>> - Loop while there are pieces of directory name left (i.e. we haven?t hit
>> the last \ character)
>>  = Find the next portion of the directory name (up to the next \
>> character)
>>  = Attempt to create the directory (unless it is of the form x: - i.e. a
>> drive name)
>>  = Ignore any ?already exists? errors, otherwise throw an error
>> 
>> This logic appears flawed in that it skips \\share which isn?t a valid
>> path format (according to https://msdn.microsoft.com/en-
>> us/library/windows/desktop/aa365247(v=vs.85).aspx ). Dredging my memory,
>> it?s possible that \\share was a supported format in very old versions of
>> Windows, but it?s been a long time since the UNC format came in. It?s also
>> possible that \\share is a valid format in some odd environments, but the
>> UNC format is far more widely used.
>> 
>> The patch suggested by Evan Cortens is simply to change the skip logic to
>> skip over \\server\share instead of \\share. This will certainly fix the
>> common use case of using UNC paths, but doesn?t attempt to deal with all
>> the more complex options in Microsoft?s documentation. I doubt many users
>> would ask for the complex cases, but the basic UNC format would be of wide
>> applicability.
>> 
>> Thanks
>> Pete Thompson
>> Director, Information Technology
>> Head of Spotfire Centre of Excellence
>> IQVIA
>> 
>> 
>> 
>> 
>> ________________________________________
>> IMPORTANT - PLEASE READ: This electronic message, including its
>> attachments, is CONFIDENTIAL and may contain PROPRIETARY or LEGALLY
>> PRIVILEGED or PROTECTED information and is intended for the authorized
>> recipient of the sender. If you are not the intended recipient, you are
>> hereby notified that any use, disclosure, copying, or distribution of this
>> message or any of the information included in it is unauthorized and
>> strictly prohibited. If you have received this message in error, please
>> immediately notify the sender by reply e-mail and permanently delete this
>> message and its attachments, along with any copies thereof, from all
>> locations received (e.g., computer, mobile device, etc.). Thank you.
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
> 
> 
> -- 
> Joris Meys
> Statistical consultant
> 
> Department of Data Analysis and Mathematical Modelling
> Ghent University
> Coupure Links 653, B-9000 Gent (Belgium)
> <https://maps.google.com/?q=Coupure+links+653,%C2%A0B-9000+Gent,%C2%A0Belgium&entry=gmail&source=g>
> 
> -----------
> Biowiskundedagen 2017-2018
> http://www.biowiskundedagen.ugent.be/
> 
> -------------------------------
> Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> _______________________________________________
> R-windows mailing list
> R-windows at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-windows

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com










From Pete.Thompson at iqvia.com  Wed Jan 17 11:55:28 2018
From: Pete.Thompson at iqvia.com (Thompson, Pete)
Date: Wed, 17 Jan 2018 10:55:28 +0000
Subject: [Rd] [R-win] Bug 17159 - recursive dir.create() fails on
 windows shares due to permissions (MMaechler: Resending to
 R-windows@R-pr..)
In-Reply-To: <DA11F272-BA91-4869-BEC3-D75772FCB312@cbs.dk>
References: <44DC0D86-8E3B-42B8-99DA-71A588AD8616@quintiles.com>
 <CAO1zAVasTKupjQF8mJewAzdyqrJk=vvghMdJqc8uVdS_N5mCZw@mail.gmail.com>
 <DA11F272-BA91-4869-BEC3-D75772FCB312@cbs.dk>
Message-ID: <C5C54C10-F8ED-4E6A-881A-B13E2E233BD6@quintiles.com>

That solution works fine for the use case where each user has a network based home directory and needs to run R from there, but doesn?t help with my situation. I need to be able to support arbitrary network based paths in arbitrary numbers ? so mapping drives isn?t an option. I have found a workaround using symbolic links to the network share created within the temporary folder, but would much prefer that R support UNC paths ? it seems a reasonably simple fix.

Cheers
Pete


On 17/01/2018, 10:52, "Peter Dalgaard" <pd.mes at cbs.dk> wrote:

    I usually draw a complete blank if  I try to assist our IT department with such issues (we really need better documentation than the Admin manual for large-system installs by non-experts in R).

    However, it is my impression that there are also options involving environment variables and LFS naming. E.g., map the networked user directory to, say, a P: "drive" and make sure that the environment is set up to reflect this.

    -pd

    > On 16 Jan 2018, at 17:52 , Joris Meys <jorismeys at gmail.com> wrote:
    >
    > Hi all,
    >
    > I ran into this exact issue yesterday during the exam of statistical
    > computing. Users can install packages in a user library that R tries to
    > create automatically on the network drive of the student. But that doesn't
    > happen as the unc path is not read correctly, leading to R attempting to
    > create a local directory and being told it has no right to do so.
    >
    > That is an older version of R though (3.3), but I'm wondering whether I
    > would ask our IT department to just update R on all these computers to the
    > latest version, or if we have to look for another solution.
    >
    > Cheers
    > Joris
    >
    > On Mon, Jan 8, 2018 at 1:43 PM, Thompson, Pete <Pete.Thompson at iqvia.com>
    > wrote:
    >
    >> Hi, I?d like to ask about bug 17159:
    >>
    >> https://bugs.r-project.org/bugzilla/show_bug.cgi?id=17159
    >>
    >> I can confirm that I see exactly this bug when using dir.create on paths
    >> of UNC form (\\server\share\xxx), with the recursive flag set. I?m seeing
    >> this when attempting to use install.packages with such a path (which I know
    >> isn?t supported, but would be great if it was!). I can see that a patch has
    >> been suggested for the problem and from looking at the source code I
    >> believe it?s a correct fix. Is there a possibility of getting this patch
    >> included?
    >>
    >> The existing logic for Windows recursive dir.create (platform.c lines
    >> 2209-22203) appears to be:
    >> - Skip over any \\share at the start of the directory name
    >> - Loop while there are pieces of directory name left (i.e. we haven?t hit
    >> the last \ character)
    >>  = Find the next portion of the directory name (up to the next \
    >> character)
    >>  = Attempt to create the directory (unless it is of the form x: - i.e. a
    >> drive name)
    >>  = Ignore any ?already exists? errors, otherwise throw an error
    >>
    >> This logic appears flawed in that it skips \\share which isn?t a valid
    >> path format (according to https://msdn.microsoft.com/en-
    >> us/library/windows/desktop/aa365247(v=vs.85).aspx ). Dredging my memory,
    >> it?s possible that \\share was a supported format in very old versions of
    >> Windows, but it?s been a long time since the UNC format came in. It?s also
    >> possible that \\share is a valid format in some odd environments, but the
    >> UNC format is far more widely used.
    >>
    >> The patch suggested by Evan Cortens is simply to change the skip logic to
    >> skip over \\server\share instead of \\share. This will certainly fix the
    >> common use case of using UNC paths, but doesn?t attempt to deal with all
    >> the more complex options in Microsoft?s documentation. I doubt many users
    >> would ask for the complex cases, but the basic UNC format would be of wide
    >> applicability.
    >>
    >> Thanks
    >> Pete Thompson
    >> Director, Information Technology
    >> Head of Spotfire Centre of Excellence
    >> IQVIA
    >>
    >>
    >>
    >>
    >> ________________________________________
    >> IMPORTANT - PLEASE READ: This electronic message, including its
    >> attachments, is CONFIDENTIAL and may contain PROPRIETARY or LEGALLY
    >> PRIVILEGED or PROTECTED information and is intended for the authorized
    >> recipient of the sender. If you are not the intended recipient, you are
    >> hereby notified that any use, disclosure, copying, or distribution of this
    >> message or any of the information included in it is unauthorized and
    >> strictly prohibited. If you have received this message in error, please
    >> immediately notify the sender by reply e-mail and permanently delete this
    >> message and its attachments, along with any copies thereof, from all
    >> locations received (e.g., computer, mobile device, etc.). Thank you.
    >> ______________________________________________
    >> R-devel at r-project.org mailing list
    >> https://stat.ethz.ch/mailman/listinfo/r-devel
    >
    >
    >
    >
    > --
    > Joris Meys
    > Statistical consultant
    >
    > Department of Data Analysis and Mathematical Modelling
    > Ghent University
    > Coupure Links 653, B-9000 Gent (Belgium)
    > <https://maps.google.com/?q=Coupure+links+653,%C2%A0B-9000+Gent,%C2%A0Belgium&entry=gmail&source=g>
    >
    > -----------
    > Biowiskundedagen 2017-2018
    > http://www.biowiskundedagen.ugent.be/
    >
    > -------------------------------
    > Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php
    >
    > [[alternative HTML version deleted]]
    >
    > ______________________________________________
    > R-devel at r-project.org mailing list
    > https://stat.ethz.ch/mailman/listinfo/r-devel
    > _______________________________________________
    > R-windows mailing list
    > R-windows at r-project.org
    > https://stat.ethz.ch/mailman/listinfo/r-windows

    --
    Peter Dalgaard, Professor,
    Center for Statistics, Copenhagen Business School
    Solbjerg Plads 3, 2000 Frederiksberg, Denmark
    Phone: (+45)38153501
    Office: A 4.23
    Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com













________________________________________
IMPORTANT - PLEASE READ: This electronic message, including its attachments, is CONFIDENTIAL and may contain PROPRIETARY or LEGALLY PRIVILEGED or PROTECTED information and is intended for the authorized recipient of the sender. If you are not the intended recipient, you are hereby notified that any use, disclosure, copying, or distribution of this message or any of the information included in it is unauthorized and strictly prohibited. If you have received this message in error, please immediately notify the sender by reply e-mail and permanently delete this message and its attachments, along with any copies thereof, from all locations received (e.g., computer, mobile device, etc.). Thank you.

From pd.mes at cbs.dk  Wed Jan 17 13:21:46 2018
From: pd.mes at cbs.dk (Peter Dalgaard)
Date: Wed, 17 Jan 2018 12:21:46 +0000
Subject: [Rd] [R-win] Bug 17159 - recursive dir.create() fails on
 windows shares due to permissions (MMaechler: Resending to
 R-windows@R-pr..)
In-Reply-To: <C5C54C10-F8ED-4E6A-881A-B13E2E233BD6@quintiles.com>
References: <44DC0D86-8E3B-42B8-99DA-71A588AD8616@quintiles.com>
 <CAO1zAVasTKupjQF8mJewAzdyqrJk=vvghMdJqc8uVdS_N5mCZw@mail.gmail.com>
 <DA11F272-BA91-4869-BEC3-D75772FCB312@cbs.dk>
 <C5C54C10-F8ED-4E6A-881A-B13E2E233BD6@quintiles.com>
Message-ID: <8E8BE323-108F-4791-970A-6512FAD9F117@cbs.dk>

I can easily believe that. It was maily for Joris, that it might not be necessary to reinstall. 

-pd

> On 17 Jan 2018, at 11:55 , Thompson, Pete <Pete.Thompson at iqvia.com> wrote:
> 
> That solution works fine for the use case where each user has a network based home directory and needs to run R from there, but doesn?t help with my situation. I need to be able to support arbitrary network based paths in arbitrary numbers ? so mapping drives isn?t an option. I have found a workaround using symbolic links to the network share created within the temporary folder, but would much prefer that R support UNC paths ? it seems a reasonably simple fix.
> 
> Cheers
> Pete
> 
> 
> On 17/01/2018, 10:52, "Peter Dalgaard" <pd.mes at cbs.dk> wrote:
> 
>    I usually draw a complete blank if  I try to assist our IT department with such issues (we really need better documentation than the Admin manual for large-system installs by non-experts in R).
> 
>    However, it is my impression that there are also options involving environment variables and LFS naming. E.g., map the networked user directory to, say, a P: "drive" and make sure that the environment is set up to reflect this.
> 
>    -pd
> 
>> On 16 Jan 2018, at 17:52 , Joris Meys <jorismeys at gmail.com> wrote:
>> 
>> Hi all,
>> 
>> I ran into this exact issue yesterday during the exam of statistical
>> computing. Users can install packages in a user library that R tries to
>> create automatically on the network drive of the student. But that doesn't
>> happen as the unc path is not read correctly, leading to R attempting to
>> create a local directory and being told it has no right to do so.
>> 
>> That is an older version of R though (3.3), but I'm wondering whether I
>> would ask our IT department to just update R on all these computers to the
>> latest version, or if we have to look for another solution.
>> 
>> Cheers
>> Joris
>> 
>> On Mon, Jan 8, 2018 at 1:43 PM, Thompson, Pete <Pete.Thompson at iqvia.com>
>> wrote:
>> 
>>> Hi, I?d like to ask about bug 17159:
>>> 
>>> https://bugs.r-project.org/bugzilla/show_bug.cgi?id=17159
>>> 
>>> I can confirm that I see exactly this bug when using dir.create on paths
>>> of UNC form (\\server\share\xxx), with the recursive flag set. I?m seeing
>>> this when attempting to use install.packages with such a path (which I know
>>> isn?t supported, but would be great if it was!). I can see that a patch has
>>> been suggested for the problem and from looking at the source code I
>>> believe it?s a correct fix. Is there a possibility of getting this patch
>>> included?
>>> 
>>> The existing logic for Windows recursive dir.create (platform.c lines
>>> 2209-22203) appears to be:
>>> - Skip over any \\share at the start of the directory name
>>> - Loop while there are pieces of directory name left (i.e. we haven?t hit
>>> the last \ character)
>>> = Find the next portion of the directory name (up to the next \
>>> character)
>>> = Attempt to create the directory (unless it is of the form x: - i.e. a
>>> drive name)
>>> = Ignore any ?already exists? errors, otherwise throw an error
>>> 
>>> This logic appears flawed in that it skips \\share which isn?t a valid
>>> path format (according to https://msdn.microsoft.com/en-
>>> us/library/windows/desktop/aa365247(v=vs.85).aspx ). Dredging my memory,
>>> it?s possible that \\share was a supported format in very old versions of
>>> Windows, but it?s been a long time since the UNC format came in. It?s also
>>> possible that \\share is a valid format in some odd environments, but the
>>> UNC format is far more widely used.
>>> 
>>> The patch suggested by Evan Cortens is simply to change the skip logic to
>>> skip over \\server\share instead of \\share. This will certainly fix the
>>> common use case of using UNC paths, but doesn?t attempt to deal with all
>>> the more complex options in Microsoft?s documentation. I doubt many users
>>> would ask for the complex cases, but the basic UNC format would be of wide
>>> applicability.
>>> 
>>> Thanks
>>> Pete Thompson
>>> Director, Information Technology
>>> Head of Spotfire Centre of Excellence
>>> IQVIA
>>> 
>>> 
>>> 
>>> 
>>> ________________________________________
>>> IMPORTANT - PLEASE READ: This electronic message, including its
>>> attachments, is CONFIDENTIAL and may contain PROPRIETARY or LEGALLY
>>> PRIVILEGED or PROTECTED information and is intended for the authorized
>>> recipient of the sender. If you are not the intended recipient, you are
>>> hereby notified that any use, disclosure, copying, or distribution of this
>>> message or any of the information included in it is unauthorized and
>>> strictly prohibited. If you have received this message in error, please
>>> immediately notify the sender by reply e-mail and permanently delete this
>>> message and its attachments, along with any copies thereof, from all
>>> locations received (e.g., computer, mobile device, etc.). Thank you.
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
>> 
>> 
>> 
>> --
>> Joris Meys
>> Statistical consultant
>> 
>> Department of Data Analysis and Mathematical Modelling
>> Ghent University
>> Coupure Links 653, B-9000 Gent (Belgium)
>> <https://maps.google.com/?q=Coupure+links+653,%C2%A0B-9000+Gent,%C2%A0Belgium&entry=gmail&source=g>
>> 
>> -----------
>> Biowiskundedagen 2017-2018
>> http://www.biowiskundedagen.ugent.be/
>> 
>> -------------------------------
>> Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php
>> 
>> [[alternative HTML version deleted]]
>> 
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> _______________________________________________
>> R-windows mailing list
>> R-windows at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-windows
> 
>    --
>    Peter Dalgaard, Professor,
>    Center for Statistics, Copenhagen Business School
>    Solbjerg Plads 3, 2000 Frederiksberg, Denmark
>    Phone: (+45)38153501
>    Office: A 4.23
>    Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> ________________________________________
> IMPORTANT - PLEASE READ: This electronic message, including its attachments, is CONFIDENTIAL and may contain PROPRIETARY or LEGALLY PRIVILEGED or PROTECTED information and is intended for the authorized recipient of the sender. If you are not the intended recipient, you are hereby notified that any use, disclosure, copying, or distribution of this message or any of the information included in it is unauthorized and strictly prohibited. If you have received this message in error, please immediately notify the sender by reply e-mail and permanently delete this message and its attachments, along with any copies thereof, from all locations received (e.g., computer, mobile device, etc.). Thank you.
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com










From jorismeys at gmail.com  Wed Jan 17 13:37:16 2018
From: jorismeys at gmail.com (Joris Meys)
Date: Wed, 17 Jan 2018 13:37:16 +0100
Subject: [Rd] [R-win] Bug 17159 - recursive dir.create() fails on
 windows shares due to permissions (MMaechler: Resending to
 R-windows@R-pr..)
In-Reply-To: <8E8BE323-108F-4791-970A-6512FAD9F117@cbs.dk>
References: <44DC0D86-8E3B-42B8-99DA-71A588AD8616@quintiles.com>
 <CAO1zAVasTKupjQF8mJewAzdyqrJk=vvghMdJqc8uVdS_N5mCZw@mail.gmail.com>
 <DA11F272-BA91-4869-BEC3-D75772FCB312@cbs.dk>
 <C5C54C10-F8ED-4E6A-881A-B13E2E233BD6@quintiles.com>
 <8E8BE323-108F-4791-970A-6512FAD9F117@cbs.dk>
Message-ID: <CAO1zAVbrWenNDRjAm+85BbRkad63sZFy3umPtfXb=bxiMHoY2A@mail.gmail.com>

Hi Peter,

I share your experience with trying to help IT departments setting things
up. The network directory of the students is mapped to a drive, but R still
uses the unc path instead of the drive when attempting to create that user
library. Unless I do it manually of course. The only solution I see right
now is to set the HOME or R_LIBS_USER environment variable in Renviron, but
that should be done each time a new student logs into the computer. Or is
there a way to ensure R uses the mapped drive instead of the network unc
path, either using an R setting or by messing with Windows itself?

Cheers
Joris



On Wed, Jan 17, 2018 at 1:21 PM, Peter Dalgaard <pd.mes at cbs.dk> wrote:

> I can easily believe that. It was maily for Joris, that it might not be
> necessary to reinstall.
>
> -pd
>
> > On 17 Jan 2018, at 11:55 , Thompson, Pete <Pete.Thompson at iqvia.com>
> wrote:
> >
> > That solution works fine for the use case where each user has a network
> based home directory and needs to run R from there, but doesn?t help with
> my situation. I need to be able to support arbitrary network based paths in
> arbitrary numbers ? so mapping drives isn?t an option. I have found a
> workaround using symbolic links to the network share created within the
> temporary folder, but would much prefer that R support UNC paths ? it seems
> a reasonably simple fix.
> >
> > Cheers
> > Pete
> >
> >
> > On 17/01/2018, 10:52, "Peter Dalgaard" <pd.mes at cbs.dk> wrote:
> >
> >    I usually draw a complete blank if  I try to assist our IT department
> with such issues (we really need better documentation than the Admin manual
> for large-system installs by non-experts in R).
> >
> >    However, it is my impression that there are also options involving
> environment variables and LFS naming. E.g., map the networked user
> directory to, say, a P: "drive" and make sure that the environment is set
> up to reflect this.
> >
> >    -pd
> >
> >> On 16 Jan 2018, at 17:52 , Joris Meys <jorismeys at gmail.com> wrote:
> >>
> >> Hi all,
> >>
> >> I ran into this exact issue yesterday during the exam of statistical
> >> computing. Users can install packages in a user library that R tries to
> >> create automatically on the network drive of the student. But that
> doesn't
> >> happen as the unc path is not read correctly, leading to R attempting to
> >> create a local directory and being told it has no right to do so.
> >>
> >> That is an older version of R though (3.3), but I'm wondering whether I
> >> would ask our IT department to just update R on all these computers to
> the
> >> latest version, or if we have to look for another solution.
> >>
> >> Cheers
> >> Joris
> >>
> >> On Mon, Jan 8, 2018 at 1:43 PM, Thompson, Pete <Pete.Thompson at iqvia.com
> >
> >> wrote:
> >>
> >>> Hi, I?d like to ask about bug 17159:
> >>>
> >>> https://bugs.r-project.org/bugzilla/show_bug.cgi?id=17159
> >>>
> >>> I can confirm that I see exactly this bug when using dir.create on
> paths
> >>> of UNC form (\\server\share\xxx), with the recursive flag set. I?m
> seeing
> >>> this when attempting to use install.packages with such a path (which I
> know
> >>> isn?t supported, but would be great if it was!). I can see that a
> patch has
> >>> been suggested for the problem and from looking at the source code I
> >>> believe it?s a correct fix. Is there a possibility of getting this
> patch
> >>> included?
> >>>
> >>> The existing logic for Windows recursive dir.create (platform.c lines
> >>> 2209-22203) appears to be:
> >>> - Skip over any \\share at the start of the directory name
> >>> - Loop while there are pieces of directory name left (i.e. we haven?t
> hit
> >>> the last \ character)
> >>> = Find the next portion of the directory name (up to the next \
> >>> character)
> >>> = Attempt to create the directory (unless it is of the form x: - i.e. a
> >>> drive name)
> >>> = Ignore any ?already exists? errors, otherwise throw an error
> >>>
> >>> This logic appears flawed in that it skips \\share which isn?t a valid
> >>> path format (according to https://msdn.microsoft.com/en-
> >>> us/library/windows/desktop/aa365247(v=vs.85).aspx ). Dredging my
> memory,
> >>> it?s possible that \\share was a supported format in very old versions
> of
> >>> Windows, but it?s been a long time since the UNC format came in. It?s
> also
> >>> possible that \\share is a valid format in some odd environments, but
> the
> >>> UNC format is far more widely used.
> >>>
> >>> The patch suggested by Evan Cortens is simply to change the skip logic
> to
> >>> skip over \\server\share instead of \\share. This will certainly fix
> the
> >>> common use case of using UNC paths, but doesn?t attempt to deal with
> all
> >>> the more complex options in Microsoft?s documentation. I doubt many
> users
> >>> would ask for the complex cases, but the basic UNC format would be of
> wide
> >>> applicability.
> >>>
> >>> Thanks
> >>> Pete Thompson
> >>> Director, Information Technology
> >>> Head of Spotfire Centre of Excellence
> >>> IQVIA
> >>>
> >>>
> >>>
> >>>
> >>> ________________________________________
> >>> IMPORTANT - PLEASE READ: This electronic message, including its
> >>> attachments, is CONFIDENTIAL and may contain PROPRIETARY or LEGALLY
> >>> PRIVILEGED or PROTECTED information and is intended for the authorized
> >>> recipient of the sender. If you are not the intended recipient, you are
> >>> hereby notified that any use, disclosure, copying, or distribution of
> this
> >>> message or any of the information included in it is unauthorized and
> >>> strictly prohibited. If you have received this message in error, please
> >>> immediately notify the sender by reply e-mail and permanently delete
> this
> >>> message and its attachments, along with any copies thereof, from all
> >>> locations received (e.g., computer, mobile device, etc.). Thank you.
> >>> ______________________________________________
> >>> R-devel at r-project.org mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-devel
> >>
> >>
> >>
> >>
> >> --
> >> Joris Meys
> >> Statistical consultant
> >>
> >> Department of Data Analysis and Mathematical Modelling
> >> Ghent University
> >> Coupure Links 653, B-9000 Gent (Belgium)
> >> <https://maps.google.com/?q=Coupure+links+653,%C2%A0B-
> 9000+Gent,%C2%A0Belgium&entry=gmail&source=g>
> >>
> >> -----------
> >> Biowiskundedagen 2017-2018
> >> http://www.biowiskundedagen.ugent.be/
> >>
> >> -------------------------------
> >> Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php
> >>
> >> [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >> _______________________________________________
> >> R-windows mailing list
> >> R-windows at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-windows
> >
> >    --
> >    Peter Dalgaard, Professor,
> >    Center for Statistics, Copenhagen Business School
> >    Solbjerg Plads 3, 2000 Frederiksberg, Denmark
> >    Phone: (+45)38153501
> >    Office: A 4.23
> >    Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
> >
> >
> >
> >
> >
> >
> >
> >
> >
> >
> >
> >
> >
> > ________________________________________
> > IMPORTANT - PLEASE READ: This electronic message, including its
> attachments, is CONFIDENTIAL and may contain PROPRIETARY or LEGALLY
> PRIVILEGED or PROTECTED information and is intended for the authorized
> recipient of the sender. If you are not the intended recipient, you are
> hereby notified that any use, disclosure, copying, or distribution of this
> message or any of the information included in it is unauthorized and
> strictly prohibited. If you have received this message in error, please
> immediately notify the sender by reply e-mail and permanently delete this
> message and its attachments, along with any copies thereof, from all
> locations received (e.g., computer, mobile device, etc.). Thank you.
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>
> --
> Peter Dalgaard, Professor,
> Center for Statistics, Copenhagen Business School
> Solbjerg Plads 3, 2000 Frederiksberg, Denmark
> Phone: (+45)38153501
> Office: A 4.23
> Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com
>
>
>
>
>
>
>
>
>
>


-- 
Joris Meys
Statistical consultant

Department of Data Analysis and Mathematical Modelling
Ghent University
Coupure Links 653, B-9000 Gent (Belgium)
<https://maps.google.com/?q=Coupure+links+653,%C2%A0B-9000+Gent,%C2%A0Belgium&entry=gmail&source=g>

-----------
Biowiskundedagen 2017-2018
http://www.biowiskundedagen.ugent.be/

-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php

	[[alternative HTML version deleted]]


From sokol at insa-toulouse.fr  Thu Jan 18 16:13:43 2018
From: sokol at insa-toulouse.fr (Serguei Sokol)
Date: Thu, 18 Jan 2018 16:13:43 +0100
Subject: [Rd] wrong matrix dimension in sparseQR
Message-ID: <55e71a12-c542-3488-7ed7-88a25b0e3b51@insa-toulouse.fr>

Hi,

I came across a case when the dimensions of matrices returned by qr()
operated on a sparse matrix does not coincide with the initial matrix.

Here is a spinet code that should produce an example (one of many that I could provide):

 ?m=205
 ?n=199
 ?set.seed(7);
 ?a=matrix(rnorm(m*n), m, n)
 ?a[sample(seq(m*n), m*(n-4))]=0
 ?a=as(a, "Matrix")
 ?qa=qr(a);
 ?stopifnot(nrow(qa at R) == m)
 ?# On my box I have nrow(qa at R):=207 while should be 205 as m is)

Note that for m=203 and n=197, the same code produce right (i.e. coinciding) dimensions.

Have I missed something?

Serguei.

 > R.version
platform?????? x86_64-pc-linux-gnu
arch?????????? x86_64
os???????????? linux-gnu
system???????? x86_64, linux-gnu
status
major????????? 3
minor????????? 4.3
year?????????? 2017
month????????? 11
day??????????? 30
svn rev??????? 73796
language?????? R
version.string R version 3.4.3 (2017-11-30)
nickname?????? Kite-Eating Tree


From gmbecker at ucdavis.edu  Thu Jan 18 20:03:58 2018
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Thu, 18 Jan 2018 11:03:58 -0800
Subject: [Rd] Coping with non-standard evaluation in R program analysis
In-Reply-To: <D3275CAA-9051-499D-92A8-69408D3D7263@icloud.com>
References: <DM5PR02MB2860748944E8E439755AB2EAA7190@DM5PR02MB2860.namprd02.prod.outlook.com>
 <CAJoaRhYbJjNU3EW+uCMeMObtosv+hgCf_BkrS+joLLXFShPVtw@mail.gmail.com>
 <8B5818E3-9569-4AD5-A6B1-6BF6905A145F@icloud.com>
 <D3275CAA-9051-499D-92A8-69408D3D7263@icloud.com>
Message-ID: <CADwqtCOfk9Lw_LQix4XRXF1FbQbK8f_zPQPZX6Wnt-ZXh2_ckw@mail.gmail.com>

Evan,

You can look at what CodeDepends (on cran/ github.com/duncantl/CodeDepends
) does for nonstandard evaluation. It is a static code analyzer which
allows for custom handler functions for calls to specific functions. The
default handlers provided are "NSE-aware" (many of) the common contexts
where that occurs. It then consumes arguments to those functions as NSE and
annotates them accordingly in the result. This is a heuristic, and we don't
currently do the harder bit of attempting to figure out where those
non-standard symbols will be resolved currently, but it's potentially a
start.

As for manipulating the AST, do be somewhat careful of this. You may run
afoul of other things that are doing this under the hood based on
particular assumptions, notably the rlang stuff that backs the tidyverse
these days.  You might be safe though, it depends on what you want.

Another approach is what I in the histry package, which handles top-level
expressions in both interactive session and dynamic document weaving
contexts. Happy to talk more about this off list as I have done a fair bit
of work in the space it sounds like you're in.

Best,
~G

On Thu, Jan 4, 2018 at 12:20 AM, jan Vitek <vitekj at icloud.com> wrote:

> Hi Evan,
>
> You may find some parts of what we are doing with genthat useful.  Genthat
> is a tool
> for creating unit tests by recording argument and return values of calls.
> This is
> done by instrumentation of the source code.
>
> The git repo with the code is here https://github.com/PRL-PRG/genthat
>
> We don?t really deal with NSE though. It could be something worth thinking
> about for us.
> The contact for genthtat is Filip.
>
>
> We are also writing a tool for analyzing promises and generating execution
> traces
> within the R VM.  This is available in
>     https://github.com/PRL-PRG/R-dyntrace
>
> Aviral and Konrad are the contacts there.
>
>
> Best,
>
> jan
>
>
>
>
>
>
> Jan Vitek, Professor
> Computer Science,
> Northeastern University
>
> > On Jan 3, 2018, at 7:18 PM, Peter Meilstrup <peter.meilstrup at gmail.com>
> wrote:
> >
> > For 2), it is not exposed in R's standard library but it is exposed in
> > the Rinternals API. A promise that is forced in normal evaluation will
> > have PRENV set to NULL.
> >
> > Peter
> >
> > On Tue, Jan 2, 2018 at 4:19 PM, Evan James Patterson
> > <epatters at stanford.edu> wrote:
> >> Hello R experts,
> >>
> >>
> >> I plan to develop a tool for dynamic analysis of R programs. I would
> like to trace function calls at runtime, capturing argument and return
> values. Following a suggestion made some time ago on this list, my
> high-level implementation strategy is to rewrite the AST, augmenting call
> expressions with pre-call and post-call shims to capture the arguments and
> return value, respectively.
> >>
> >>
> >> I can think of only one fundamental conceptual obstacle to this
> approach: R functions are not necessarily referentially transparent. The
> arguments received by a function are not values but promises. They can be
> evaluated directly ("standard evaluation"), after applying arbitrary
> syntactic transformations ("non-standard evaluation", aka NSE), or not at
> all. Therefore, if you peek at the values of function arguments before
> evaluating the function, you risk altering the semantics of the program,
> possibly fatally.
> >>
> >>
> >> I'm looking for general advice about how to cope with NSE in this
> context. I also have some specific questions:
> >>
> >>
> >> 1) Is it possible to determine whether a given function (primitive, in
> R, or external) uses NSE on some or all of its arguments?
> >>
> >>
> >> 2) Is it possible to inspect the promise objects received by functions,
> say to determine whether they have been evaluated, without actually
> evaluating them? The R manual is not encouraging in this area:
> >>
> >>
> >> https://cran.r-project.org/doc/manuals/r-release/R-lang.
> html#Promise-objects
> >>
> >>
> >> Thank you,
> >>
> >>
> >> Evan
> >>
> >>
> >>       [[alternative HTML version deleted]]
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-devel
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Gabriel Becker, PhD
Scientist (Bioinformatics)
Genentech Research

	[[alternative HTML version deleted]]


From sokol at insa-toulouse.fr  Fri Jan 19 10:12:21 2018
From: sokol at insa-toulouse.fr (Serguei Sokol)
Date: Fri, 19 Jan 2018 10:12:21 +0100
Subject: [Rd] wrong matrix dimension in sparseQR
In-Reply-To: <55e71a12-c542-3488-7ed7-88a25b0e3b51@insa-toulouse.fr>
References: <55e71a12-c542-3488-7ed7-88a25b0e3b51@insa-toulouse.fr>
Message-ID: <a6e38e5b-82f9-3af9-1a86-45851a5eec06@insa-toulouse.fr>

I have found explanation in the comments to original cs_qr() matlab function
http://users.encs.concordia.ca/~krzyzak/R%20Code-Communications%20in%20Statistics%20and%20Simulation%202014/Zubeh%F6r/SuiteSparse/CSparse3/MATLAB/CSparse/cs_qr.m

"If A is structurally rank deficient, additional empty
 ?rows may have been added to V and R."

To my mind, it could be useful to mention it in the manual of Matrix::qr
and/or sparseQR-class too. Because in case of augmented nrow
we cannot do anymore A[p+1,] as cited in example in ?"sparseQR-class".

My 2 cents.
Serguei.

Le 18/01/2018 ? 16:13, Serguei Sokol a ?crit?:
> Hi,
>
> I came across a case when the dimensions of matrices returned by qr()
> operated on a sparse matrix does not coincide with the initial matrix.
If A is structurally rank deficient, additional empty
%?? rows may have been added to V and R.
>
> Here is a spinet code that should produce an example (one of many that I could provide):
>
> ?m=205
> ?n=199
> ?set.seed(7);
> ?a=matrix(rnorm(m*n), m, n)
> ?a[sample(seq(m*n), m*(n-4))]=0
> ?a=as(a, "Matrix")
> ?qa=qr(a);
> ?stopifnot(nrow(qa at R) == m)
> ?# On my box I have nrow(qa at R):=207 while should be 205 as m is)
>
> Note that for m=203 and n=197, the same code produce right (i.e. coinciding) dimensions.
>
> Have I missed something?
>
> Serguei.
>
> > R.version
> platform?????? x86_64-pc-linux-gnu
> arch?????????? x86_64
> os???????????? linux-gnu
> system???????? x86_64, linux-gnu
> status
> major????????? 3
> minor????????? 4.3
> year?????????? 2017
> month????????? 11
> day??????????? 30
> svn rev??????? 73796
> language?????? R
> version.string R version 3.4.3 (2017-11-30)
> nickname?????? Kite-Eating Tree
>
>

-- 
Serguei Sokol
Ingenieur de recherche INRA

Cellule math?matique
LISBP, INSA/INRA UMR 792, INSA/CNRS UMR 5504
135 Avenue de Rangueil
31077 Toulouse Cedex 04

tel: +33 5 6155 9849
email: sokol at insa-toulouse.fr
http://www.lisbp.fr


From ludger.goeminne at vib-ugent.be  Fri Jan 19 15:33:25 2018
From: ludger.goeminne at vib-ugent.be (Ludger Goeminne)
Date: Fri, 19 Jan 2018 15:33:25 +0100 (CET)
Subject: [Rd] bug fix integer overflow in medpolish function
Message-ID: <2111235670.59687.1516372405230.JavaMail.zimbra@vib-ugent.be>

Dear R team 

I noticed a bug in the "medpolish" function in the "stats" package. 
When I run medpolish(x), with "x" the matrix in the attached .rda file, 
I get this rather cryptic error: 

"Error in if (converged) break : missing value where TRUE/FALSE needed 
In addition: Warning message: 
In sum(abs(z), na.rm = na.rm) : integer overflow - use sum(as.numeric(.))" 

I traced this down to the line: 

newsum <- sum(abs(z), na.rm = na.rm) 

I think this "overflow" could be easily fixed by changing this line to: 

newsum <- sum(as.numeric(abs(z)), na.rm = na.rm) 

With kind regards 

Ludger Goeminne 

? 
Ludger Goeminne - Ph.D. Student 

VIB-UGent Center for Medical Biotechnology 
Albert Baertsoenkaai 3 - 9000 Gent - Belgium 
Tel: +32 (0)9 264 9360 
mbc.vib-ugent.be 

-------------- next part --------------
A non-text attachment was scrubbed...
Name: matrix.rda
Type: application/x-gzip
Size: 2071 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20180119/3257a421/attachment.bin>

From murdoch.duncan at gmail.com  Fri Jan 19 15:59:29 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Fri, 19 Jan 2018 09:59:29 -0500
Subject: [Rd] bug fix integer overflow in medpolish function
In-Reply-To: <2111235670.59687.1516372405230.JavaMail.zimbra@vib-ugent.be>
References: <2111235670.59687.1516372405230.JavaMail.zimbra@vib-ugent.be>
Message-ID: <45e14c21-e85c-6f0e-6a22-f065c14bc21e@gmail.com>

On 19/01/2018 9:33 AM, Ludger Goeminne wrote:
> Dear R team
> 
> I noticed a bug in the "medpolish" function in the "stats" package.
> When I run medpolish(x), with "x" the matrix in the attached .rda file,
> I get this rather cryptic error:
> 
> "Error in if (converged) break : missing value where TRUE/FALSE needed
> In addition: Warning message:
> In sum(abs(z), na.rm = na.rm) : integer overflow - use sum(as.numeric(.))"
> 
> I traced this down to the line:
> 
> newsum <- sum(abs(z), na.rm = na.rm)
> 
> I think this "overflow" could be easily fixed by changing this line to:
> 
> newsum <- sum(as.numeric(abs(z)), na.rm = na.rm)

Alternatively, you could use medpolish(as.numeric(x)).

Duncan Murdoch


From oschwarz at resurety.com  Fri Jan 19 21:41:35 2018
From: oschwarz at resurety.com (Omri Schwarz)
Date: Fri, 19 Jan 2018 15:41:35 -0500
Subject: [Rd] Buffer overflow in cairoBM.c line 402
Message-ID: <CAAMjEmdum0AA6HJb-Zo3rKoENjFXUe9PSPhy30+JMJk4C6iLjg@mail.gmail.com>

Hi, all.

Testing a change to that line to
    strncpy(xd->filename, filename,PATH_MAX);
right now.

The bug itself I've yet to reproduce in anything that doesn't involve
my employer's proprietary code, but strcpy is strcpy, after all.

-- 
*Omri Schwarz*
Engineer
REsurety, Inc.

	[[alternative HTML version deleted]]


From tomas.kalibera at gmail.com  Fri Jan 19 22:47:43 2018
From: tomas.kalibera at gmail.com (Tomas Kalibera)
Date: Fri, 19 Jan 2018 22:47:43 +0100
Subject: [Rd] Buffer overflow in cairoBM.c line 402
In-Reply-To: <CAAMjEmdum0AA6HJb-Zo3rKoENjFXUe9PSPhy30+JMJk4C6iLjg@mail.gmail.com>
References: <CAAMjEmdum0AA6HJb-Zo3rKoENjFXUe9PSPhy30+JMJk4C6iLjg@mail.gmail.com>
Message-ID: <8020e9f1-35c0-ccb7-baff-d282a766c388@gmail.com>

Thanks for reporting - there is no need to reproduce this, it is an 
obvious error.
I'll probably fix by throwing an error - like it is done in devX11.c 
when the file names are too long.

Tomas

On 01/19/2018 09:41 PM, Omri Schwarz wrote:
> Hi, all.
>
> Testing a change to that line to
>      strncpy(xd->filename, filename,PATH_MAX);
> right now.
>
> The bug itself I've yet to reproduce in anything that doesn't involve
> my employer's proprietary code, but strcpy is strcpy, after all.
>


From pperry at stern.nyu.edu  Sat Jan 20 16:43:52 2018
From: pperry at stern.nyu.edu (Patrick Perry)
Date: Sat, 20 Jan 2018 10:43:52 -0500
Subject: [Rd] as.character(list(NA))
Message-ID: <5A6363B8.3030305@stern.nyu.edu>

As of R Under development (unstable) (2018-01-19 r74138):

 > as.character(list(NA))
[1] "NA"

 > is.na(as.character(list(NA)))
[1] FALSE


From edd at debian.org  Sat Jan 20 16:51:08 2018
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 20 Jan 2018 09:51:08 -0600
Subject: [Rd] as.character(list(NA))
In-Reply-To: <5A6363B8.3030305@stern.nyu.edu>
References: <5A6363B8.3030305@stern.nyu.edu>
Message-ID: <23139.25964.875751.226635@bud.eddelbuettel.com>


On 20 January 2018 at 10:43, Patrick Perry wrote:
| As of R Under development (unstable) (2018-01-19 r74138):
| 
|  > as.character(list(NA))
| [1] "NA"
| 
|  > is.na(as.character(list(NA)))
| [1] FALSE

Are you aware that this is the same in R-release, and might be "on purpose" ?

R> R.Version()$version.string
[1] "R version 3.4.3 (2017-11-30)"
R> as.character(list(NA))
[1] "NA"
R> is.na(as.character(list(NA)))
[1] FALSE
R> 

It is after all you who forces the as.character() and I don't think anybody
claims that to be a lossless operation from logical.  To wit:

R> is.na(list(NA))
[1] TRUE
R> 

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From wdunlap at tibco.com  Sat Jan 20 17:24:32 2018
From: wdunlap at tibco.com (William Dunlap)
Date: Sat, 20 Jan 2018 08:24:32 -0800
Subject: [Rd] as.character(list(NA))
In-Reply-To: <5A6363B8.3030305@stern.nyu.edu>
References: <5A6363B8.3030305@stern.nyu.edu>
Message-ID: <CAF8bMcb3ON02efFcQi0rgErRyNxWt==z2sJ5_wuXytsFE7emLA@mail.gmail.com>

I believe that for a list as.character() applies deparse()  to each element
of the list.  deparse() does not preserve NA-ness, as it is intended to
make text that the parser can read.

> str(as.character(list(Na=NA, LglVec=c(TRUE,NA),
Function=function(x){x+1})))
 chr [1:3] "NA" "c(TRUE, NA)" "function (x) \n{\n    x + 1\n}"


Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Sat, Jan 20, 2018 at 7:43 AM, Patrick Perry <pperry at stern.nyu.edu> wrote:

> As of R Under development (unstable) (2018-01-19 r74138):
>
> > as.character(list(NA))
> [1] "NA"
>
> > is.na(as.character(list(NA)))
> [1] FALSE
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From bodenhofer at bioinf.jku.at  Mon Jan 22 08:12:24 2018
From: bodenhofer at bioinf.jku.at (Ulrich Bodenhofer)
Date: Mon, 22 Jan 2018 08:12:24 +0100
Subject: [Rd] How to address the following: CRAN packages not using Suggests
 conditionally
In-Reply-To: <d4a372db-e2e1-9869-b281-107fd1d500cf@bioinf.jku.at>
References: <d4a372db-e2e1-9869-b281-107fd1d500cf@bioinf.jku.at>
Message-ID: <46ae6e78-6e55-77d7-6df9-d7fa6de470d3@bioinf.jku.at>

Dear colleagues, dear members of the R Core Team,

This was an issue raised by Prof. Brian Ripley and sent privately to all 
developers of CRAN packages that suggest Bioconductor packages (see 
original message below). As mentioned in my message enclosed below, it 
was easy for me to fix the error in examples (new version not submitted 
to CRAN yet), but it might turn into a major effort for the warnings 
raised by the package vignette. Since I have not gotten any advice yet, 
I take the liberty to post it here on this list - hoping that we reach a 
conclusion here how to deal with this matter.

Thanks in advance for your kind assistance,
Ulrich Bodenhofer



-------- Forwarded Message --------
Subject: 	Re: CRAN packages not using Suggests conditionally
Date: 	Mon, 15 Jan 2018 08:44:40 +0100
From: 	Ulrich Bodenhofer <bodenhofer at bioinf.jku.at>
To: 	Prof Brian Ripley <ripley at stats.ox.ac.uk>
CC: 	[...stripped for the sake of privacy ...]



Dear Prof. Ripley,

Thank you very much for bringing this important issue to my attention. I
am the maintainer of the 'apcluster' package. My package refers to
'Biostrings' in an example section of a help page (a quite insignificant
one, by the way), which creates errors on some platforms. It also refers
to 'kebabs' in the package vignette, which leads to warnings.

I could fix the first, more severe, problem quite easily, (1) since it
is relatively easy to wrap an entire examples section in a conditional,
and (2), as I have mentioned, it is not a particularly important help page.

Regarding the vignette, I want to ask for your advice now, since the
situation appears more complicated to me. While it is, of course, only
one code chunk that loads the 'kebabs' package, five more code chunks
depend on the package (more specifically, the data objects created by a
method implemented in the package) - with quite some text in between. So
the handling of the conditional loading of the package would propagate
to multiple code chunks and also affect the validity of the explanations
in between. I would see the following options:

1. Remove the entire section of the vignette. That would be a pity,
since I can no longer point the users to an otherwise interesting
application of my package.
2. Replace the code chunks by static LaTeX code such that it appears in
the PDF as if there were code chunks that had been run. This sort of
undermines the philosophy of vignettes and also creates extra effort for
me to maintain the vignette.
3. Use the functionality of 'kernlab' instead of 'kebabs' if the latter
is not available. This would be technically possible, but (1) the code
in the vignette will look much more complicated to the user and (2)
'kernlab' does not implement the necessary functionality fully correctly
and also has much longer run times. Needless to say, the issue with
conditional loading will then simply propagate to 'kernlab'.

Which of the three solutions would you prefer? Do you see any fourth
alternative? Or would you tolerate the warnings on some platforms
arising from the non-availability of packages suggested by the package
vignette?

Thanks for your time and best regards,
Ulrich Bodenhofer

P.S.: @all: I hope it is acceptable that I replied to all. I thought the
discussion would be interesting for some of you having similar issues.



On 01/14/2018 09:20 AM, Prof Brian Ripley wrote:
> as required by ?1.1.3.1 of the manual.
>
> The Bioconductor branch used by R-devel has been very unstable 
> recently, and it has been decided not to use it for the Fedora checks 
> on R-devel. As you can see from the CRAN results pages (at least at 
> the time of writing), packages
>
> ACMEeqtl BoSSA CNVassoc CorShrink GRANBase GenCAT GiANT NMF 
> PlackettLuce ProFit ProFound RNAseqNet SIBERG antaresRead apcluster 
> cherry clValid coloc colorhcplot entropart filematrix fuzzyforest 
> fuzzyjoin glycanr hexbin loon nscancor ordinalgmifs penalized phangorn 
> propr shiftR switchr tcgsaseq tileHMM tmod
>
> then give ERRORs or (new) WARNINGs on their checks.? Please correct 
> ASAP, and by Feb 20 to safely retain the package on CRAN.
>


From i.ucar86 at gmail.com  Mon Jan 22 10:16:17 2018
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Mon, 22 Jan 2018 10:16:17 +0100
Subject: [Rd] How to address the following: CRAN packages not using
 Suggests conditionally
In-Reply-To: <CALEXWq2CK-aoLuo41z2UtyJKtfGu=DC7-=A91Mc83QwXRjAMXw@mail.gmail.com>
References: <d4a372db-e2e1-9869-b281-107fd1d500cf@bioinf.jku.at>
 <46ae6e78-6e55-77d7-6df9-d7fa6de470d3@bioinf.jku.at>
 <CALEXWq2CK-aoLuo41z2UtyJKtfGu=DC7-=A91Mc83QwXRjAMXw@mail.gmail.com>
Message-ID: <CALEXWq1Sab3azEnER9baV1Y3f44U_PhQc9v0x2wt3xqz1uDE5A@mail.gmail.com>

Re-sending, since I forgot to include the list, sorry. I'm including
r-package-devel too this time, as it seems more appropriate for this list.


El 22 ene. 2018 10:11, "I?aki ?car" <i.ucar86 at gmail.com> escribi?:

>
>
> El 22 ene. 2018 8:12, "Ulrich Bodenhofer" <bodenhofer at bioinf.jku.at>
> escribi?:
>
> Dear colleagues, dear members of the R Core Team,
>
> This was an issue raised by Prof. Brian Ripley and sent privately to all
> developers of CRAN packages that suggest Bioconductor packages (see
> original message below). As mentioned in my message enclosed below, it was
> easy for me to fix the error in examples (new version not submitted to CRAN
> yet), but it might turn into a major effort for the warnings raised by the
> package vignette. Since I have not gotten any advice yet, I take the
> liberty to post it here on this list - hoping that we reach a conclusion
> here how to deal with this matter.
>
>
> Just disable code chunk evaluation if suggested packages are missing (see
> [1]). As explained by Prof. Ripley, it will only affect Fedora checks on
> r-devel, i.e., your users will still see fully evaluated vignettes on CRAN.
>
> [1] https://www.enchufa2.es/archives/suggests-and-vignettes.html
>
> I?aki
>
>
> Thanks in advance for your kind assistance,
> Ulrich Bodenhofer
>
>
>
> -------- Forwarded Message --------
> Subject:        Re: CRAN packages not using Suggests conditionally
> Date:   Mon, 15 Jan 2018 08:44:40 +0100
> From:   Ulrich Bodenhofer <bodenhofer at bioinf.jku.at>
> To:     Prof Brian Ripley <ripley at stats.ox.ac.uk>
> CC:     [...stripped for the sake of privacy ...]
>
>
>
> Dear Prof. Ripley,
>
> Thank you very much for bringing this important issue to my attention. I
> am the maintainer of the 'apcluster' package. My package refers to
> 'Biostrings' in an example section of a help page (a quite insignificant
> one, by the way), which creates errors on some platforms. It also refers
> to 'kebabs' in the package vignette, which leads to warnings.
>
> I could fix the first, more severe, problem quite easily, (1) since it
> is relatively easy to wrap an entire examples section in a conditional,
> and (2), as I have mentioned, it is not a particularly important help page.
>
> Regarding the vignette, I want to ask for your advice now, since the
> situation appears more complicated to me. While it is, of course, only
> one code chunk that loads the 'kebabs' package, five more code chunks
> depend on the package (more specifically, the data objects created by a
> method implemented in the package) - with quite some text in between. So
> the handling of the conditional loading of the package would propagate
> to multiple code chunks and also affect the validity of the explanations
> in between. I would see the following options:
>
> 1. Remove the entire section of the vignette. That would be a pity,
> since I can no longer point the users to an otherwise interesting
> application of my package.
> 2. Replace the code chunks by static LaTeX code such that it appears in
> the PDF as if there were code chunks that had been run. This sort of
> undermines the philosophy of vignettes and also creates extra effort for
> me to maintain the vignette.
> 3. Use the functionality of 'kernlab' instead of 'kebabs' if the latter
> is not available. This would be technically possible, but (1) the code
> in the vignette will look much more complicated to the user and (2)
> 'kernlab' does not implement the necessary functionality fully correctly
> and also has much longer run times. Needless to say, the issue with
> conditional loading will then simply propagate to 'kernlab'.
>
> Which of the three solutions would you prefer? Do you see any fourth
> alternative? Or would you tolerate the warnings on some platforms
> arising from the non-availability of packages suggested by the package
> vignette?
>
> Thanks for your time and best regards,
> Ulrich Bodenhofer
>
> P.S.: @all: I hope it is acceptable that I replied to all. I thought the
> discussion would be interesting for some of you having similar issues.
>
>
>
> On 01/14/2018 09:20 AM, Prof Brian Ripley wrote:
>
>> as required by ?1.1.3.1 of the manual.
>>
>> The Bioconductor branch used by R-devel has been very unstable recently,
>> and it has been decided not to use it for the Fedora checks on R-devel. As
>> you can see from the CRAN results pages (at least at the time of writing),
>> packages
>>
>> ACMEeqtl BoSSA CNVassoc CorShrink GRANBase GenCAT GiANT NMF PlackettLuce
>> ProFit ProFound RNAseqNet SIBERG antaresRead apcluster cherry clValid coloc
>> colorhcplot entropart filematrix fuzzyforest fuzzyjoin glycanr hexbin loon
>> nscancor ordinalgmifs penalized phangorn propr shiftR switchr tcgsaseq
>> tileHMM tmod
>>
>> then give ERRORs or (new) WARNINGs on their checks.  Please correct ASAP,
>> and by Feb 20 to safely retain the package on CRAN.
>>
>>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>
>

	[[alternative HTML version deleted]]


From bodenhofer at bioinf.jku.at  Mon Jan 22 14:40:39 2018
From: bodenhofer at bioinf.jku.at (Ulrich Bodenhofer)
Date: Mon, 22 Jan 2018 14:40:39 +0100
Subject: [Rd] How to address the following: CRAN packages not using
 Suggests conditionally
In-Reply-To: <CALEXWq1Sab3azEnER9baV1Y3f44U_PhQc9v0x2wt3xqz1uDE5A@mail.gmail.com>
References: <d4a372db-e2e1-9869-b281-107fd1d500cf@bioinf.jku.at>
 <46ae6e78-6e55-77d7-6df9-d7fa6de470d3@bioinf.jku.at>
 <CALEXWq2CK-aoLuo41z2UtyJKtfGu=DC7-=A91Mc83QwXRjAMXw@mail.gmail.com>
 <CALEXWq1Sab3azEnER9baV1Y3f44U_PhQc9v0x2wt3xqz1uDE5A@mail.gmail.com>
Message-ID: <3b2856da-63c6-6706-214e-84518960eb4a@bioinf.jku.at>

Thanks a lot, I?aki, this is a perfect solution! I already implemented 
it and it works great. I'll wait for 2 more days before I submit the 
revised package to CRAN - in order to give others to comment on it.

Best regards,
Ulrich


On 01/22/2018 10:16 AM, I?aki ?car wrote:
> Re-sending, since I forgot to include the list, sorry. I'm including 
> r-package-devel too this time, as it seems more appropriate for this 
> list.
>
>
> El 22 ene. 2018 10:11, "I?aki ?car" <i.ucar86 at gmail.com 
> <mailto:i.ucar86 at gmail.com>> escribi?:
>
>
>
>     El 22 ene. 2018 8:12, "Ulrich Bodenhofer"
>     <bodenhofer at bioinf.jku.at <mailto:bodenhofer at bioinf.jku.at>> escribi?:
>
>         Dear colleagues, dear members of the R Core Team,
>
>         This was an issue raised by Prof. Brian Ripley and sent
>         privately to all developers of CRAN packages that suggest
>         Bioconductor packages (see original message below). As
>         mentioned in my message enclosed below, it was easy for me to
>         fix the error in examples (new version not submitted to CRAN
>         yet), but it might turn into a major effort for the warnings
>         raised by the package vignette. Since I have not gotten any
>         advice yet, I take the liberty to post it here on this list -
>         hoping that we reach a conclusion here how to deal with this
>         matter.
>
>
>     Just disable code chunk evaluation if suggested packages are
>     missing (see [1]). As explained by Prof. Ripley, it will only
>     affect Fedora checks on r-devel, i.e., your users will still see
>     fully evaluated vignettes on CRAN.
>
>     [1] https://www.enchufa2.es/archives/suggests-and-vignettes.html
>     <https://www.enchufa2.es/archives/suggests-and-vignettes.html>
>
>     I?aki
>
>
>         Thanks in advance for your kind assistance,
>         Ulrich Bodenhofer
>
>
>
>         -------- Forwarded Message --------
>         Subject:? ? ? ? Re: CRAN packages not using Suggests conditionally
>         Date:? ?Mon, 15 Jan 2018 08:44:40 +0100
>         From:? ?Ulrich Bodenhofer <bodenhofer at bioinf.jku.at
>         <mailto:bodenhofer at bioinf.jku.at>>
>         To:? ? ?Prof Brian Ripley <ripley at stats.ox.ac.uk
>         <mailto:ripley at stats.ox.ac.uk>>
>         CC:? ? ?[...stripped for the sake of privacy ...]
>
>
>
>         Dear Prof. Ripley,
>
>         Thank you very much for bringing this important issue to my
>         attention. I
>         am the maintainer of the 'apcluster' package. My package refers to
>         'Biostrings' in an example section of a help page (a quite
>         insignificant
>         one, by the way), which creates errors on some platforms. It
>         also refers
>         to 'kebabs' in the package vignette, which leads to warnings.
>
>         I could fix the first, more severe, problem quite easily, (1)
>         since it
>         is relatively easy to wrap an entire examples section in a
>         conditional,
>         and (2), as I have mentioned, it is not a particularly
>         important help page.
>
>         Regarding the vignette, I want to ask for your advice now,
>         since the
>         situation appears more complicated to me. While it is, of
>         course, only
>         one code chunk that loads the 'kebabs' package, five more code
>         chunks
>         depend on the package (more specifically, the data objects
>         created by a
>         method implemented in the package) - with quite some text in
>         between. So
>         the handling of the conditional loading of the package would
>         propagate
>         to multiple code chunks and also affect the validity of the
>         explanations
>         in between. I would see the following options:
>
>         1. Remove the entire section of the vignette. That would be a
>         pity,
>         since I can no longer point the users to an otherwise interesting
>         application of my package.
>         2. Replace the code chunks by static LaTeX code such that it
>         appears in
>         the PDF as if there were code chunks that had been run. This
>         sort of
>         undermines the philosophy of vignettes and also creates extra
>         effort for
>         me to maintain the vignette.
>         3. Use the functionality of 'kernlab' instead of 'kebabs' if
>         the latter
>         is not available. This would be technically possible, but (1)
>         the code
>         in the vignette will look much more complicated to the user
>         and (2)
>         'kernlab' does not implement the necessary functionality fully
>         correctly
>         and also has much longer run times. Needless to say, the issue
>         with
>         conditional loading will then simply propagate to 'kernlab'.
>
>         Which of the three solutions would you prefer? Do you see any
>         fourth
>         alternative? Or would you tolerate the warnings on some platforms
>         arising from the non-availability of packages suggested by the
>         package
>         vignette?
>
>         Thanks for your time and best regards,
>         Ulrich Bodenhofer
>
>         P.S.: @all: I hope it is acceptable that I replied to all. I
>         thought the
>         discussion would be interesting for some of you having similar
>         issues.
>
>
>
>         On 01/14/2018 09:20 AM, Prof Brian Ripley wrote:
>
>             as required by ?1.1.3.1 of the manual.
>
>             The Bioconductor branch used by R-devel has been very
>             unstable recently, and it has been decided not to use it
>             for the Fedora checks on R-devel. As you can see from the
>             CRAN results pages (at least at the time of writing), packages
>
>             ACMEeqtl BoSSA CNVassoc CorShrink GRANBase GenCAT GiANT
>             NMF PlackettLuce ProFit ProFound RNAseqNet SIBERG
>             antaresRead apcluster cherry clValid coloc colorhcplot
>             entropart filematrix fuzzyforest fuzzyjoin glycanr hexbin
>             loon nscancor ordinalgmifs penalized phangorn propr shiftR
>             switchr tcgsaseq tileHMM tmod
>
>             then give ERRORs or (new) WARNINGs on their checks.?
>             Please correct ASAP, and by Feb 20 to safely retain the
>             package on CRAN.
>
>
>         ______________________________________________
>         R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>         https://stat.ethz.ch/mailman/listinfo/r-devel
>         <https://stat.ethz.ch/mailman/listinfo/r-devel>
>
>


From thomasp85 at gmail.com  Mon Jan 22 14:32:27 2018
From: thomasp85 at gmail.com (Thomas Lin Pedersen)
Date: Mon, 22 Jan 2018 14:32:27 +0100
Subject: [Rd] Better error message in loadNamespace
Message-ID: <A8C1E0B5-960D-4397-BCFD-288AF32F4A6B@gmail.com>

Hi

I?ve just spend a bit of time debugging an error arising in `loadNamespace`. The bottom line is that the `vI` object is assigned within an `if` block but expected to exist for all of the remaining code. In some cases where the package library has been corrupted or when it resides on a network drive with bad connection this can lead to error messages complaining about `vI` object not existing. Debugging through the error is difficult, both because `loadNamespace` is called recursively through the dependency graph and the error can arise at any depth. And because the recursive calls are wrapped in `try` so the code breaks some distance from the point where the error occurred.

I will suggest mitigating this by adding an `else` clause to the `if` block where `vI` gets assigned that warns about potential corruption of the library and names the package that caused the error.

I can open a bug report if you wish, but I would require a bugzilla account for that. Otherwise you?re also welcome to take it from here.

With best wishes
Thomas Lin Pedersen

From martin.morgan at roswellpark.org  Mon Jan 22 16:01:44 2018
From: martin.morgan at roswellpark.org (Martin Morgan)
Date: Mon, 22 Jan 2018 10:01:44 -0500
Subject: [Rd] How to address the following: CRAN packages not using
 Suggests conditionally
In-Reply-To: <3b2856da-63c6-6706-214e-84518960eb4a@bioinf.jku.at>
References: <d4a372db-e2e1-9869-b281-107fd1d500cf@bioinf.jku.at>
 <46ae6e78-6e55-77d7-6df9-d7fa6de470d3@bioinf.jku.at>
 <CALEXWq2CK-aoLuo41z2UtyJKtfGu=DC7-=A91Mc83QwXRjAMXw@mail.gmail.com>
 <CALEXWq1Sab3azEnER9baV1Y3f44U_PhQc9v0x2wt3xqz1uDE5A@mail.gmail.com>
 <3b2856da-63c6-6706-214e-84518960eb4a@bioinf.jku.at>
Message-ID: <745be8e2-5dec-b739-768d-ac26a7876b64@roswellpark.org>

On 01/22/2018 08:40 AM, Ulrich Bodenhofer wrote:
> Thanks a lot, I?aki, this is a perfect solution! I already implemented 
> it and it works great. I'll wait for 2 more days before I submit the 
> revised package to CRAN - in order to give others to comment on it.

It's very easy for 'pictures of code' (unevaluated code chunks in 
vignettes) to drift from the actual implementation. So I'd really 
encourage your conditional evaluation to be as narrow as possible -- 
during CRAN or even CRAN fedora checks. Certainly trying to use 
uninstalled Suggest'ed packages in vignettes should provide an error 
message that is informative to users. Presumably the developer or user 
intends actually to execute the code, and needs to struggle through 
whatever issues come up. I'm not sure whether my comments are consistent 
with Writing R Extensions or not.

There is a fundamental tension between the CRAN and Bioconductor release 
models. The Bioconductor 'devel' package repositories and nightly builds 
are meant to be a place where new features and breaking changes can be 
introduced and problems resolved before being exposed to general users 
as a stable 'release' branch, once every six months. This means that the 
Bioconductor devel branch periodically (as recently and I suspect over 
the next several days) contains considerable carnage that propagates to 
CRAN devel builds, creating additional work for CRAN maintainers.

Martin Morgan
Bioconductor

> 
> Best regards,
> Ulrich
> 
> 
> On 01/22/2018 10:16 AM, I?aki ?car wrote:
>> Re-sending, since I forgot to include the list, sorry. I'm including 
>> r-package-devel too this time, as it seems more appropriate for this 
>> list.
>>
>>
>> El 22 ene. 2018 10:11, "I?aki ?car" <i.ucar86 at gmail.com 
>> <mailto:i.ucar86 at gmail.com>> escribi?:
>>
>>
>>
>> ??? El 22 ene. 2018 8:12, "Ulrich Bodenhofer"
>> ??? <bodenhofer at bioinf.jku.at <mailto:bodenhofer at bioinf.jku.at>> 
>> escribi?:
>>
>> ??????? Dear colleagues, dear members of the R Core Team,
>>
>> ??????? This was an issue raised by Prof. Brian Ripley and sent
>> ??????? privately to all developers of CRAN packages that suggest
>> ??????? Bioconductor packages (see original message below). As
>> ??????? mentioned in my message enclosed below, it was easy for me to
>> ??????? fix the error in examples (new version not submitted to CRAN
>> ??????? yet), but it might turn into a major effort for the warnings
>> ??????? raised by the package vignette. Since I have not gotten any
>> ??????? advice yet, I take the liberty to post it here on this list -
>> ??????? hoping that we reach a conclusion here how to deal with this
>> ??????? matter.
>>
>>
>> ??? Just disable code chunk evaluation if suggested packages are
>> ??? missing (see [1]). As explained by Prof. Ripley, it will only
>> ??? affect Fedora checks on r-devel, i.e., your users will still see
>> ??? fully evaluated vignettes on CRAN.
>>
>> ??? [1] https://www.enchufa2.es/archives/suggests-and-vignettes.html
>> ??? <https://www.enchufa2.es/archives/suggests-and-vignettes.html>
>>
>> ??? I?aki
>>
>>
>> ??????? Thanks in advance for your kind assistance,
>> ??????? Ulrich Bodenhofer
>>
>>
>>
>> ??????? -------- Forwarded Message --------
>> ??????? Subject:? ? ? ? Re: CRAN packages not using Suggests 
>> conditionally
>> ??????? Date:? ?Mon, 15 Jan 2018 08:44:40 +0100
>> ??????? From:? ?Ulrich Bodenhofer <bodenhofer at bioinf.jku.at
>> ??????? <mailto:bodenhofer at bioinf.jku.at>>
>> ??????? To:? ? ?Prof Brian Ripley <ripley at stats.ox.ac.uk
>> ??????? <mailto:ripley at stats.ox.ac.uk>>
>> ??????? CC:? ? ?[...stripped for the sake of privacy ...]
>>
>>
>>
>> ??????? Dear Prof. Ripley,
>>
>> ??????? Thank you very much for bringing this important issue to my
>> ??????? attention. I
>> ??????? am the maintainer of the 'apcluster' package. My package 
>> refers to
>> ??????? 'Biostrings' in an example section of a help page (a quite
>> ??????? insignificant
>> ??????? one, by the way), which creates errors on some platforms. It
>> ??????? also refers
>> ??????? to 'kebabs' in the package vignette, which leads to warnings.
>>
>> ??????? I could fix the first, more severe, problem quite easily, (1)
>> ??????? since it
>> ??????? is relatively easy to wrap an entire examples section in a
>> ??????? conditional,
>> ??????? and (2), as I have mentioned, it is not a particularly
>> ??????? important help page.
>>
>> ??????? Regarding the vignette, I want to ask for your advice now,
>> ??????? since the
>> ??????? situation appears more complicated to me. While it is, of
>> ??????? course, only
>> ??????? one code chunk that loads the 'kebabs' package, five more code
>> ??????? chunks
>> ??????? depend on the package (more specifically, the data objects
>> ??????? created by a
>> ??????? method implemented in the package) - with quite some text in
>> ??????? between. So
>> ??????? the handling of the conditional loading of the package would
>> ??????? propagate
>> ??????? to multiple code chunks and also affect the validity of the
>> ??????? explanations
>> ??????? in between. I would see the following options:
>>
>> ??????? 1. Remove the entire section of the vignette. That would be a
>> ??????? pity,
>> ??????? since I can no longer point the users to an otherwise interesting
>> ??????? application of my package.
>> ??????? 2. Replace the code chunks by static LaTeX code such that it
>> ??????? appears in
>> ??????? the PDF as if there were code chunks that had been run. This
>> ??????? sort of
>> ??????? undermines the philosophy of vignettes and also creates extra
>> ??????? effort for
>> ??????? me to maintain the vignette.
>> ??????? 3. Use the functionality of 'kernlab' instead of 'kebabs' if
>> ??????? the latter
>> ??????? is not available. This would be technically possible, but (1)
>> ??????? the code
>> ??????? in the vignette will look much more complicated to the user
>> ??????? and (2)
>> ??????? 'kernlab' does not implement the necessary functionality fully
>> ??????? correctly
>> ??????? and also has much longer run times. Needless to say, the issue
>> ??????? with
>> ??????? conditional loading will then simply propagate to 'kernlab'.
>>
>> ??????? Which of the three solutions would you prefer? Do you see any
>> ??????? fourth
>> ??????? alternative? Or would you tolerate the warnings on some platforms
>> ??????? arising from the non-availability of packages suggested by the
>> ??????? package
>> ??????? vignette?
>>
>> ??????? Thanks for your time and best regards,
>> ??????? Ulrich Bodenhofer
>>
>> ??????? P.S.: @all: I hope it is acceptable that I replied to all. I
>> ??????? thought the
>> ??????? discussion would be interesting for some of you having similar
>> ??????? issues.
>>
>>
>>
>> ??????? On 01/14/2018 09:20 AM, Prof Brian Ripley wrote:
>>
>> ??????????? as required by ?1.1.3.1 of the manual.
>>
>> ??????????? The Bioconductor branch used by R-devel has been very
>> ??????????? unstable recently, and it has been decided not to use it
>> ??????????? for the Fedora checks on R-devel. As you can see from the
>> ??????????? CRAN results pages (at least at the time of writing), 
>> packages
>>
>> ??????????? ACMEeqtl BoSSA CNVassoc CorShrink GRANBase GenCAT GiANT
>> ??????????? NMF PlackettLuce ProFit ProFound RNAseqNet SIBERG
>> ??????????? antaresRead apcluster cherry clValid coloc colorhcplot
>> ??????????? entropart filematrix fuzzyforest fuzzyjoin glycanr hexbin
>> ??????????? loon nscancor ordinalgmifs penalized phangorn propr shiftR
>> ??????????? switchr tcgsaseq tileHMM tmod
>>
>> ??????????? then give ERRORs or (new) WARNINGs on their checks.
>> ??????????? Please correct ASAP, and by Feb 20 to safely retain the
>> ??????????? package on CRAN.
>>
>>
>> ??????? ______________________________________________
>> ??????? R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>> ??????? https://stat.ethz.ch/mailman/listinfo/r-devel
>> ??????? <https://stat.ethz.ch/mailman/listinfo/r-devel>
>>
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


This email message may contain legally privileged and/or...{{dropped:2}}


From maechler at stat.math.ethz.ch  Mon Jan 22 16:21:14 2018
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Mon, 22 Jan 2018 16:21:14 +0100
Subject: [Rd] Better error message in loadNamespace
In-Reply-To: <A8C1E0B5-960D-4397-BCFD-288AF32F4A6B@gmail.com>
References: <A8C1E0B5-960D-4397-BCFD-288AF32F4A6B@gmail.com>
Message-ID: <23142.362.108421.286033@stat.math.ethz.ch>

>>>>> Thomas Lin Pedersen <thomasp85 at gmail.com>
>>>>>     on Mon, 22 Jan 2018 14:32:27 +0100 writes:

    > Hi I?ve just spend a bit of time debugging an error
    > arising in `loadNamespace`. The bottom line is that the
    > `vI` object is assigned within an `if` block but expected
    > to exist for all of the remaining code. In some cases
    > where the package library has been corrupted or when it
    > resides on a network drive with bad connection this can
    > lead to error messages complaining about `vI` object not
    > existing. Debugging through the error is difficult, both
    > because `loadNamespace` is called recursively through the
    > dependency graph and the error can arise at any depth. And
    > because the recursive calls are wrapped in `try` so the
    > code breaks some distance from the point where the error
    > occurred.

    > I will suggest mitigating this by adding an `else` clause
    > to the `if` block where `vI` gets assigned that warns
    > about potential corruption of the library and names the
    > package that caused the error.

Not sure this is desirable... in general even though it may well
be desirable in your use case...

You will be aware that this an important function that maybe
called many times, e.g., notably even at R startup time and so
must be very robust [hence the many try* settings] and must use
messages/warnings that are suppressable etc etc.

On reading the source, I tend to agree with you that it looks
odd there is no  else  clause to that if(), but then there may
be subtle good reasons for that we don't see now.

    > I can open a bug report if you wish, but I would require a
    > bugzilla account for that. Otherwise you?re also welcome
    > to take it from here.

I'll do that for you in any case.

Martin Maechler
ETH Zurich


    > With best wishes Thomas Lin Pedersen


From thomasp85 at gmail.com  Mon Jan 22 16:37:26 2018
From: thomasp85 at gmail.com (Thomas Lin Pedersen)
Date: Mon, 22 Jan 2018 16:37:26 +0100
Subject: [Rd] Better error message in loadNamespace
In-Reply-To: <23142.362.108421.286033@stat.math.ethz.ch>
References: <A8C1E0B5-960D-4397-BCFD-288AF32F4A6B@gmail.com>
 <23142.362.108421.286033@stat.math.ethz.ch>
Message-ID: <36687B5E-8D2E-4A59-898D-6BC540EAB0A5@gmail.com>



> On 22 Jan 2018, at 16.21, Martin Maechler <maechler at stat.math.ethz.ch> wrote:
> 
>>>>>> Thomas Lin Pedersen <thomasp85 at gmail.com <mailto:thomasp85 at gmail.com>>
>>>>>>    on Mon, 22 Jan 2018 14:32:27 +0100 writes:
> 
>> Hi I?ve just spend a bit of time debugging an error
>> arising in `loadNamespace`. The bottom line is that the
>> `vI` object is assigned within an `if` block but expected
>> to exist for all of the remaining code. In some cases
>> where the package library has been corrupted or when it
>> resides on a network drive with bad connection this can
>> lead to error messages complaining about `vI` object not
>> existing. Debugging through the error is difficult, both
>> because `loadNamespace` is called recursively through the
>> dependency graph and the error can arise at any depth. And
>> because the recursive calls are wrapped in `try` so the
>> code breaks some distance from the point where the error
>> occurred.
> 
>> I will suggest mitigating this by adding an `else` clause
>> to the `if` block where `vI` gets assigned that warns
>> about potential corruption of the library and names the
>> package that caused the error.
> 
> Not sure this is desirable... in general even though it may well
> be desirable in your use case...
> 
> You will be aware that this an important function that maybe
> called many times, e.g., notably even at R startup time and so
> must be very robust [hence the many try* settings] and must use
> messages/warnings that are suppressable etc etc.

I absolutely agree that even small changes in execution speed 
would be bad in such a low-level function. Still, the else clause 
would only get called in the event an error should be thrown so I
can?t envision any performance regression.

> 
> On reading the source, I tend to agree with you that it looks
> odd there is no  else  clause to that if(), but then there may
> be subtle good reasons for that we don't see now.

If there are reasons for the current construct, then that should of
course be taken into account. As far as I can parse every code
branch that follows the if statement ends up referencing vI, but
lazy evaluation might result in those expression to never be 
evaluated so it might be valid calls in some circumstances..?

Anyway, I can accept the argument that changing it might break
things in unexpected ways :-)

> 
>> I can open a bug report if you wish, but I would require a
>> bugzilla account for that. Otherwise you?re also welcome
>> to take it from here.
> 
> I'll do that for you in any case.

thanks

best
Thomas

> 
> Martin Maechler
> ETH Zurich
> 
> 
>> With best wishes Thomas Lin Pedersen


	[[alternative HTML version deleted]]


From sokol at insa-toulouse.fr  Mon Jan 22 17:21:40 2018
From: sokol at insa-toulouse.fr (Serguei Sokol)
Date: Mon, 22 Jan 2018 17:21:40 +0100
Subject: [Rd] Inconsistent rank in qr()
Message-ID: <25bfaeec-31e8-c2db-812e-cb0759342a15@insa-toulouse.fr>

Hi,

I have noticed different rank values calculated by qr() depending on
LAPACK parameter. When it is FALSE (default) a true rank is estimated and returned.
Unfortunately, when LAPACK is set to TRUE, the min(nrow(A), ncol(A)) is returned
which is only occasionally a true rank.

Would not it be more consistent to replace the rank in the latter case by something
based on the following pseudo code ?

d=abs(diag(qr))
rank=sum(d >= d[1]*tol)

Here, we rely on the fact column pivoting is activated in the called lapack routine (dgeqp3)
and diagonal term in qr matrix are put in decreasing order (according to their absolute values).

Serguei.

How to reproduce:

a=diag(2)
a[2,2]=0
qaf=qr(a, LAPACK=FALSE)
qaf$rank # shows 1. OK it's the true rank value
qat=qr(a, LAPACK=TRUE)
qat$rank #shows 2. Bad, it's not the expected value.


From keith.ohara at nyu.edu  Mon Jan 22 17:40:03 2018
From: keith.ohara at nyu.edu (Keith O'Hara)
Date: Mon, 22 Jan 2018 11:40:03 -0500
Subject: [Rd] Inconsistent rank in qr()
In-Reply-To: <25bfaeec-31e8-c2db-812e-cb0759342a15@insa-toulouse.fr>
References: <25bfaeec-31e8-c2db-812e-cb0759342a15@insa-toulouse.fr>
Message-ID: <DCF48AFB-EE93-4048-99E1-56613BB43872@nyu.edu>

This behavior is noted in the qr documentation, no?

rank - the rank of x as computed by the decomposition(*): always full rank in the LAPACK case.



> On Jan 22, 2018, at 11:21 AM, Serguei Sokol <sokol at insa-toulouse.fr> wrote:
> 
> Hi,
> 
> I have noticed different rank values calculated by qr() depending on
> LAPACK parameter. When it is FALSE (default) a true rank is estimated and returned.
> Unfortunately, when LAPACK is set to TRUE, the min(nrow(A), ncol(A)) is returned
> which is only occasionally a true rank.
> 
> Would not it be more consistent to replace the rank in the latter case by something
> based on the following pseudo code ?
> 
> d=abs(diag(qr))
> rank=sum(d >= d[1]*tol)
> 
> Here, we rely on the fact column pivoting is activated in the called lapack routine (dgeqp3)
> and diagonal term in qr matrix are put in decreasing order (according to their absolute values).
> 
> Serguei.
> 
> How to reproduce:
> 
> a=diag(2)
> a[2,2]=0
> qaf=qr(a, LAPACK=FALSE)
> qaf$rank # shows 1. OK it's the true rank value
> qat=qr(a, LAPACK=TRUE)
> qat$rank #shows 2. Bad, it's not the expected value.
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From sokol at insa-toulouse.fr  Mon Jan 22 17:57:47 2018
From: sokol at insa-toulouse.fr (Serguei Sokol)
Date: Mon, 22 Jan 2018 17:57:47 +0100
Subject: [Rd] Inconsistent rank in qr()
In-Reply-To: <DCF48AFB-EE93-4048-99E1-56613BB43872@nyu.edu>
References: <25bfaeec-31e8-c2db-812e-cb0759342a15@insa-toulouse.fr>
 <DCF48AFB-EE93-4048-99E1-56613BB43872@nyu.edu>
Message-ID: <dce19c1c-d8e7-c315-7db2-15f3a279373d@insa-toulouse.fr>

Le 22/01/2018 ? 17:40, Keith O'Hara a ?crit?:
> This behavior is noted in the qr documentation, no?
>
> rank - the rank of x as computed by the decomposition(*): always full rank in the LAPACK case.
For a me a "full rank matrix" is a matrix the rank of which is indeed min(nrow(A), ncol(A))
but here the meaning of "always is full rank" is somewhat confusing. Does it mean
that only full rank matrices must be submitted to qr() when LAPACK=TRUE?
May be there is a jargon where "full rank" is a synonym of min(nrow(A), ncol(A)) for any matrix
but the fix to stick with commonly admitted rank definition (i.e. the number of linearly independent
columns in A) is so easy. Why to discard lapack case from it (even properly documented)?

>
>
>
>> On Jan 22, 2018, at 11:21 AM, Serguei Sokol <sokol at insa-toulouse.fr> wrote:
>>
>> Hi,
>>
>> I have noticed different rank values calculated by qr() depending on
>> LAPACK parameter. When it is FALSE (default) a true rank is estimated and returned.
>> Unfortunately, when LAPACK is set to TRUE, the min(nrow(A), ncol(A)) is returned
>> which is only occasionally a true rank.
>>
>> Would not it be more consistent to replace the rank in the latter case by something
>> based on the following pseudo code ?
>>
>> d=abs(diag(qr))
>> rank=sum(d >= d[1]*tol)
>>
>> Here, we rely on the fact column pivoting is activated in the called lapack routine (dgeqp3)
>> and diagonal term in qr matrix are put in decreasing order (according to their absolute values).
>>
>> Serguei.
>>
>> How to reproduce:
>>
>> a=diag(2)
>> a[2,2]=0
>> qaf=qr(a, LAPACK=FALSE)
>> qaf$rank # shows 1. OK it's the true rank value
>> qat=qr(a, LAPACK=TRUE)
>> qat$rank #shows 2. Bad, it's not the expected value.
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>

-- 
Serguei Sokol
Ingenieur de recherche INRA

Cellule math?matique
LISBP, INSA/INRA UMR 792, INSA/CNRS UMR 5504
135 Avenue de Rangueil
31077 Toulouse Cedex 04

tel: +33 5 6155 9849
email: sokol at insa-toulouse.fr
http://www.lisbp.fr


From hpages at fredhutch.org  Mon Jan 22 20:01:02 2018
From: hpages at fredhutch.org (=?UTF-8?B?SGVydsOpIFBhZ8Oocw==?=)
Date: Mon, 22 Jan 2018 11:01:02 -0800
Subject: [Rd] as.character(list(NA))
In-Reply-To: <CAF8bMcb3ON02efFcQi0rgErRyNxWt==z2sJ5_wuXytsFE7emLA@mail.gmail.com>
References: <5A6363B8.3030305@stern.nyu.edu>
 <CAF8bMcb3ON02efFcQi0rgErRyNxWt==z2sJ5_wuXytsFE7emLA@mail.gmail.com>
Message-ID: <b2edc1e5-a672-6070-4cf2-a572c030f961@fredhutch.org>

On 01/20/2018 08:24 AM, William Dunlap via R-devel wrote:
> I believe that for a list as.character() applies deparse()  to each element
> of the list.  deparse() does not preserve NA-ness, as it is intended to
> make text that the parser can read.
> 
>> str(as.character(list(Na=NA, LglVec=c(TRUE,NA),
> Function=function(x){x+1})))
>   chr [1:3] "NA" "c(TRUE, NA)" "function (x) \n{\n    x + 1\n}"
> 

This really comes as a surprise though since coercion to all the
other atomic types (except raw) preserve the NAs.

And also as.character(unlist(list(NA))) preserves them.

H.

> 
> Bill Dunlap
> TIBCO Software
> wdunlap tibco.com
> 
> On Sat, Jan 20, 2018 at 7:43 AM, Patrick Perry <pperry at stern.nyu.edu> wrote:
> 
>> As of R Under development (unstable) (2018-01-19 r74138):
>>
>>> as.character(list(NA))
>> [1] "NA"
>>
>>> is.na(as.character(list(NA)))
>> [1] FALSE
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=VbamM9XRQOlfBakrmlrmQZ7DLgXZ-hhhFeLD-fKpoCo&s=Luhqwpr2bTltIA9Cy7kA4gwcQh16bla0S6OVe3Z09Xo&e=
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=VbamM9XRQOlfBakrmlrmQZ7DLgXZ-hhhFeLD-fKpoCo&s=Luhqwpr2bTltIA9Cy7kA4gwcQh16bla0S6OVe3Z09Xo&e=
> 

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fredhutch.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From rmcgehee at walleyetrading.net  Mon Jan 22 20:14:55 2018
From: rmcgehee at walleyetrading.net (Robert McGehee)
Date: Mon, 22 Jan 2018 19:14:55 +0000
Subject: [Rd] as.character(list(NA))
In-Reply-To: <b2edc1e5-a672-6070-4cf2-a572c030f961@fredhutch.org>
References: <5A6363B8.3030305@stern.nyu.edu>
 <CAF8bMcb3ON02efFcQi0rgErRyNxWt==z2sJ5_wuXytsFE7emLA@mail.gmail.com>
 <b2edc1e5-a672-6070-4cf2-a572c030f961@fredhutch.org>
Message-ID: <30D28A63376088428E8318DD67FD407F8C5C2D@ny-mailstore1.walleyetrading.net>

Also perhaps a surprise that the behavior depends on the mode of the NA. 

> is.na(as.character(list(NA_real_)))
[1] FALSE
> is.na(as.character(list(NA_character_)))
[1] TRUE

Does this mean deparse() preserves NA-ness for NA_character_ but not NA_real_?


-----Original Message-----
From: R-devel [mailto:r-devel-bounces at r-project.org] On Behalf Of Herv? Pag?s
Sent: Monday, January 22, 2018 2:01 PM
To: William Dunlap <wdunlap at tibco.com>; Patrick Perry <pperry at stern.nyu.edu>
Cc: r-devel at r-project.org
Subject: Re: [Rd] as.character(list(NA))

On 01/20/2018 08:24 AM, William Dunlap via R-devel wrote:
> I believe that for a list as.character() applies deparse()  to each element
> of the list.  deparse() does not preserve NA-ness, as it is intended to
> make text that the parser can read.
> 
>> str(as.character(list(Na=NA, LglVec=c(TRUE,NA),
> Function=function(x){x+1})))
>   chr [1:3] "NA" "c(TRUE, NA)" "function (x) \n{\n    x + 1\n}"
> 

This really comes as a surprise though since coercion to all the
other atomic types (except raw) preserve the NAs.

And also as.character(unlist(list(NA))) preserves them.

H.

> 
> Bill Dunlap
> TIBCO Software
> wdunlap tibco.com
> 
> On Sat, Jan 20, 2018 at 7:43 AM, Patrick Perry <pperry at stern.nyu.edu> wrote:
> 
>> As of R Under development (unstable) (2018-01-19 r74138):
>>
>>> as.character(list(NA))
>> [1] "NA"
>>
>>> is.na(as.character(list(NA)))
>> [1] FALSE
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=VbamM9XRQOlfBakrmlrmQZ7DLgXZ-hhhFeLD-fKpoCo&s=Luhqwpr2bTltIA9Cy7kA4gwcQh16bla0S6OVe3Z09Xo&e=
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=VbamM9XRQOlfBakrmlrmQZ7DLgXZ-hhhFeLD-fKpoCo&s=Luhqwpr2bTltIA9Cy7kA4gwcQh16bla0S6OVe3Z09Xo&e=
> 

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fredhutch.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel

From wdunlap at tibco.com  Mon Jan 22 22:02:56 2018
From: wdunlap at tibco.com (William Dunlap)
Date: Mon, 22 Jan 2018 13:02:56 -0800
Subject: [Rd] as.character(list(NA))
In-Reply-To: <30D28A63376088428E8318DD67FD407F8C5C2D@ny-mailstore1.walleyetrading.net>
References: <5A6363B8.3030305@stern.nyu.edu>
 <CAF8bMcb3ON02efFcQi0rgErRyNxWt==z2sJ5_wuXytsFE7emLA@mail.gmail.com>
 <b2edc1e5-a672-6070-4cf2-a572c030f961@fredhutch.org>
 <30D28A63376088428E8318DD67FD407F8C5C2D@ny-mailstore1.walleyetrading.net>
Message-ID: <CAF8bMcbXUcb_k2q6tixJgCrzuDRP7Tib0GSKcTZoRapZGgAugQ@mail.gmail.com>

I tend to avoid using as.<type> functions on lists, since they act oddly in
several ways.
E.g, if the list "L" consists entirely of scalar elements then
as.numeric(L) acts like
as.numeric(unlist(L)) but if any element is not a scalar there is an
error.  as.character()
does not seem to make a distinction between the all-scalar and
not-all-scalar cases
but does various things with NA's of various types.

Bill Dunlap
TIBCO Software
wdunlap tibco.com

On Mon, Jan 22, 2018 at 11:14 AM, Robert McGehee <
rmcgehee at walleyetrading.net> wrote:

> Also perhaps a surprise that the behavior depends on the mode of the NA.
>
> > is.na(as.character(list(NA_real_)))
> [1] FALSE
> > is.na(as.character(list(NA_character_)))
> [1] TRUE
>
> Does this mean deparse() preserves NA-ness for NA_character_ but not
> NA_real_?
>
>
> -----Original Message-----
> From: R-devel [mailto:r-devel-bounces at r-project.org] On Behalf Of Herv?
> Pag?s
> Sent: Monday, January 22, 2018 2:01 PM
> To: William Dunlap <wdunlap at tibco.com>; Patrick Perry <
> pperry at stern.nyu.edu>
> Cc: r-devel at r-project.org
> Subject: Re: [Rd] as.character(list(NA))
>
> On 01/20/2018 08:24 AM, William Dunlap via R-devel wrote:
> > I believe that for a list as.character() applies deparse()  to each
> element
> > of the list.  deparse() does not preserve NA-ness, as it is intended to
> > make text that the parser can read.
> >
> >> str(as.character(list(Na=NA, LglVec=c(TRUE,NA),
> > Function=function(x){x+1})))
> >   chr [1:3] "NA" "c(TRUE, NA)" "function (x) \n{\n    x + 1\n}"
> >
>
> This really comes as a surprise though since coercion to all the
> other atomic types (except raw) preserve the NAs.
>
> And also as.character(unlist(list(NA))) preserves them.
>
> H.
>
> >
> > Bill Dunlap
> > TIBCO Software
> > wdunlap tibco.com
> >
> > On Sat, Jan 20, 2018 at 7:43 AM, Patrick Perry <pperry at stern.nyu.edu>
> wrote:
> >
> >> As of R Under development (unstable) (2018-01-19 r74138):
> >>
> >>> as.character(list(NA))
> >> [1] "NA"
> >>
> >>> is.na(as.character(list(NA)))
> >> [1] FALSE
> >>
> >> ______________________________________________
> >> R-devel at r-project.org mailing list
> >> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.
> ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=
> BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=
> VbamM9XRQOlfBakrmlrmQZ7DLgXZ-hhhFeLD-fKpoCo&s=
> Luhqwpr2bTltIA9Cy7kA4gwcQh16bla0S6OVe3Z09Xo&e=
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.
> ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=
> BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=
> VbamM9XRQOlfBakrmlrmQZ7DLgXZ-hhhFeLD-fKpoCo&s=
> Luhqwpr2bTltIA9Cy7kA4gwcQh16bla0S6OVe3Z09Xo&e=
> >
>
> --
> Herv? Pag?s
>
> Program in Computational Biology
> Division of Public Health Sciences
> Fred Hutchinson Cancer Research Center
> 1100 Fairview Ave. N, M1-B514
> P.O. Box 19024
> Seattle, WA 98109-1024
>
> E-mail: hpages at fredhutch.org
> Phone:  (206) 667-5791
> Fax:    (206) 667-1319
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From hpages at fredhutch.org  Mon Jan 22 22:51:50 2018
From: hpages at fredhutch.org (=?UTF-8?B?SGVydsOpIFBhZ8Oocw==?=)
Date: Mon, 22 Jan 2018 13:51:50 -0800
Subject: [Rd] as.character(list(NA))
In-Reply-To: <CAF8bMcbXUcb_k2q6tixJgCrzuDRP7Tib0GSKcTZoRapZGgAugQ@mail.gmail.com>
References: <5A6363B8.3030305@stern.nyu.edu>
 <CAF8bMcb3ON02efFcQi0rgErRyNxWt==z2sJ5_wuXytsFE7emLA@mail.gmail.com>
 <b2edc1e5-a672-6070-4cf2-a572c030f961@fredhutch.org>
 <30D28A63376088428E8318DD67FD407F8C5C2D@ny-mailstore1.walleyetrading.net>
 <CAF8bMcbXUcb_k2q6tixJgCrzuDRP7Tib0GSKcTZoRapZGgAugQ@mail.gmail.com>
Message-ID: <ac841d7c-c610-2192-e307-64e630e0a3e5@fredhutch.org>

On 01/22/2018 01:02 PM, William Dunlap wrote:
> I tend to avoid using as.<type> functions on lists, since they act oddly 
> in several ways.
> E.g, if the list "L" consists entirely of scalar elements then 
> as.numeric(L) acts like
> as.numeric(unlist(L)) but if any element is not a scalar there is an 
> error.

FWIW personally I see this as a nice feature and use as.numeric(L)
instead of as.numeric(unlist(L) in places where I'd rather fail than
getting something that is not parallel to the input.

H.

>? as.character()
> does not seem to make a distinction between the all-scalar and 
> not-all-scalar cases
> but does various things with NA's of various types.
> 
> Bill Dunlap
> TIBCO Software
> wdunlap tibco.com 
> <https://urldefense.proofpoint.com/v2/url?u=http-3A__tibco.com&d=DwMFaQ&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=TBOnlxYy_MjXJqxLqI8WB2WWHNMtc8qw5gxsqUoyoH4&s=XiTysBsoZb4M91NAS4DK6nK982wAf7JGpRSDrXioQ3A&e=>
> 
> On Mon, Jan 22, 2018 at 11:14 AM, Robert McGehee 
> <rmcgehee at walleyetrading.net <mailto:rmcgehee at walleyetrading.net>> wrote:
> 
>     Also perhaps a surprise that the behavior depends on the mode of the NA.
> 
>      > is.na
>     <https://urldefense.proofpoint.com/v2/url?u=http-3A__is.na&d=DwMFaQ&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=TBOnlxYy_MjXJqxLqI8WB2WWHNMtc8qw5gxsqUoyoH4&s=z8HTNapemGDhhH0ICUN2hgJrtUcxsgM96mcUwD8QzQk&e=>(as.character(list(NA_real_)))
>     [1] FALSE
>      > is.na
>     <https://urldefense.proofpoint.com/v2/url?u=http-3A__is.na&d=DwMFaQ&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=TBOnlxYy_MjXJqxLqI8WB2WWHNMtc8qw5gxsqUoyoH4&s=z8HTNapemGDhhH0ICUN2hgJrtUcxsgM96mcUwD8QzQk&e=>(as.character(list(NA_character_)))
>     [1] TRUE
> 
>     Does this mean deparse() preserves NA-ness for NA_character_ but not
>     NA_real_?
> 
> 
>     -----Original Message-----
>     From: R-devel [mailto:r-devel-bounces at r-project.org
>     <mailto:r-devel-bounces at r-project.org>] On Behalf Of Herv? Pag?s
>     Sent: Monday, January 22, 2018 2:01 PM
>     To: William Dunlap <wdunlap at tibco.com <mailto:wdunlap at tibco.com>>;
>     Patrick Perry <pperry at stern.nyu.edu <mailto:pperry at stern.nyu.edu>>
>     Cc: r-devel at r-project.org <mailto:r-devel at r-project.org>
>     Subject: Re: [Rd] as.character(list(NA))
> 
>     On 01/20/2018 08:24 AM, William Dunlap via R-devel wrote:
>      > I believe that for a list as.character() applies deparse()? to
>     each element
>      > of the list.? deparse() does not preserve NA-ness, as it is
>     intended to
>      > make text that the parser can read.
>      >
>      >> str(as.character(list(Na=NA, LglVec=c(TRUE,NA),
>      > Function=function(x){x+1})))
>      >? ?chr [1:3] "NA" "c(TRUE, NA)" "function (x) \n{\n? ? x + 1\n}"
>      >
> 
>     This really comes as a surprise though since coercion to all the
>     other atomic types (except raw) preserve the NAs.
> 
>     And also as.character(unlist(list(NA))) preserves them.
> 
>     H.
> 
>      >
>      > Bill Dunlap
>      > TIBCO Software
>      > wdunlap tibco.com
>     <https://urldefense.proofpoint.com/v2/url?u=http-3A__tibco.com&d=DwMFaQ&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=TBOnlxYy_MjXJqxLqI8WB2WWHNMtc8qw5gxsqUoyoH4&s=XiTysBsoZb4M91NAS4DK6nK982wAf7JGpRSDrXioQ3A&e=>
>      >
>      > On Sat, Jan 20, 2018 at 7:43 AM, Patrick Perry
>     <pperry at stern.nyu.edu <mailto:pperry at stern.nyu.edu>> wrote:
>      >
>      >> As of R Under development (unstable) (2018-01-19 r74138):
>      >>
>      >>> as.character(list(NA))
>      >> [1] "NA"
>      >>
>      >>> is.na
>     <https://urldefense.proofpoint.com/v2/url?u=http-3A__is.na&d=DwMFaQ&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=TBOnlxYy_MjXJqxLqI8WB2WWHNMtc8qw5gxsqUoyoH4&s=z8HTNapemGDhhH0ICUN2hgJrtUcxsgM96mcUwD8QzQk&e=>(as.character(list(NA)))
>      >> [1] FALSE
>      >>
>      >> ______________________________________________
>      >> R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>      >>
>     https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=VbamM9XRQOlfBakrmlrmQZ7DLgXZ-hhhFeLD-fKpoCo&s=Luhqwpr2bTltIA9Cy7kA4gwcQh16bla0S6OVe3Z09Xo&e=
>     <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=VbamM9XRQOlfBakrmlrmQZ7DLgXZ-hhhFeLD-fKpoCo&s=Luhqwpr2bTltIA9Cy7kA4gwcQh16bla0S6OVe3Z09Xo&e=>
>      >>
>      >
>      >? ? ? ?[[alternative HTML version deleted]]
>      >
>      > ______________________________________________
>      > R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>      >
>     https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=VbamM9XRQOlfBakrmlrmQZ7DLgXZ-hhhFeLD-fKpoCo&s=Luhqwpr2bTltIA9Cy7kA4gwcQh16bla0S6OVe3Z09Xo&e=
>     <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=VbamM9XRQOlfBakrmlrmQZ7DLgXZ-hhhFeLD-fKpoCo&s=Luhqwpr2bTltIA9Cy7kA4gwcQh16bla0S6OVe3Z09Xo&e=>
>      >
> 
>     --
>     Herv? Pag?s
> 
>     Program in Computational Biology
>     Division of Public Health Sciences
>     Fred Hutchinson Cancer Research Center
>     1100 Fairview Ave. N, M1-B514
>     P.O. Box 19024
>     Seattle, WA 98109-1024
> 
>     E-mail: hpages at fredhutch.org <mailto:hpages at fredhutch.org>
>     Phone: (206) 667-5791 <tel:%28206%29%20667-5791>
>     Fax: (206) 667-1319 <tel:%28206%29%20667-1319>
> 
>     ______________________________________________
>     R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-devel
>     <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwMFaQ&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=TBOnlxYy_MjXJqxLqI8WB2WWHNMtc8qw5gxsqUoyoH4&s=Tl76BG1PB4_MNRObhik4eJ3UG8DsFBcgCq_k4f7RBSE&e=>
> 
> 

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fredhutch.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From keith.ohara at nyu.edu  Mon Jan 22 23:32:26 2018
From: keith.ohara at nyu.edu (Keith O'Hara)
Date: Mon, 22 Jan 2018 17:32:26 -0500
Subject: [Rd] Inconsistent rank in qr()
In-Reply-To: <dce19c1c-d8e7-c315-7db2-15f3a279373d@insa-toulouse.fr>
References: <25bfaeec-31e8-c2db-812e-cb0759342a15@insa-toulouse.fr>
 <DCF48AFB-EE93-4048-99E1-56613BB43872@nyu.edu>
 <dce19c1c-d8e7-c315-7db2-15f3a279373d@insa-toulouse.fr>
Message-ID: <6AAEB2A4-D0D8-41F6-AD9E-A53A8E11E569@nyu.edu>

I agree the result is a little confusing, but the behavior is in line with the documentation and so not ?unexpected? as such...

I don?t think this is a matter of semantics, more of a ?return the rank when we have it for free? situation?when A is real-valued, qr(A,LAPACK=false) calls a modified version of Linpack?s dqrdc which computes the rank internally; see dqrdc2.f, output ?k?. Lapack?s dqeqp3 doesn?t return the rank as is.

Just my 2 cents on a potential fix: Matrix::rankMatrix follows the logic of your code, and I think this would be simpler to implement than modifying Lapack.c in two places (around lines 657 and 1175).

Keith


> On Jan 22, 2018, at 11:57 AM, Serguei Sokol <sokol at insa-toulouse.fr> wrote:
> 
> Le 22/01/2018 ? 17:40, Keith O'Hara a ?crit :
>> This behavior is noted in the qr documentation, no?
>> 
>> rank - the rank of x as computed by the decomposition(*): always full rank in the LAPACK case.
> For a me a "full rank matrix" is a matrix the rank of which is indeed min(nrow(A), ncol(A))
> but here the meaning of "always is full rank" is somewhat confusing. Does it mean
> that only full rank matrices must be submitted to qr() when LAPACK=TRUE?
> May be there is a jargon where "full rank" is a synonym of min(nrow(A), ncol(A)) for any matrix
> but the fix to stick with commonly admitted rank definition (i.e. the number of linearly independent
> columns in A) is so easy. Why to discard lapack case from it (even properly documented)?
> 
>> 
>> 
>> 
>>> On Jan 22, 2018, at 11:21 AM, Serguei Sokol <sokol at insa-toulouse.fr> wrote:
>>> 
>>> Hi,
>>> 
>>> I have noticed different rank values calculated by qr() depending on
>>> LAPACK parameter. When it is FALSE (default) a true rank is estimated and returned.
>>> Unfortunately, when LAPACK is set to TRUE, the min(nrow(A), ncol(A)) is returned
>>> which is only occasionally a true rank.
>>> 
>>> Would not it be more consistent to replace the rank in the latter case by something
>>> based on the following pseudo code ?
>>> 
>>> d=abs(diag(qr))
>>> rank=sum(d >= d[1]*tol)
>>> 
>>> Here, we rely on the fact column pivoting is activated in the called lapack routine (dgeqp3)
>>> and diagonal term in qr matrix are put in decreasing order (according to their absolute values).
>>> 
>>> Serguei.
>>> 
>>> How to reproduce:
>>> 
>>> a=diag(2)
>>> a[2,2]=0
>>> qaf=qr(a, LAPACK=FALSE)
>>> qaf$rank # shows 1. OK it's the true rank value
>>> qat=qr(a, LAPACK=TRUE)
>>> qat$rank #shows 2. Bad, it's not the expected value.
>>> 
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
> 
> -- 
> Serguei Sokol
> Ingenieur de recherche INRA
> 
> Cellule math?matique
> LISBP, INSA/INRA UMR 792, INSA/CNRS UMR 5504
> 135 Avenue de Rangueil
> 31077 Toulouse Cedex 04
> 
> tel: +33 5 6155 9849
> email: sokol at insa-toulouse.fr <mailto:sokol at insa-toulouse.fr>
> http://www.lisbp.fr <http://www.lisbp.fr/>

	[[alternative HTML version deleted]]


From maechler at stat.math.ethz.ch  Tue Jan 23 08:47:01 2018
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 23 Jan 2018 08:47:01 +0100
Subject: [Rd] Inconsistent rank in qr()
In-Reply-To: <dce19c1c-d8e7-c315-7db2-15f3a279373d@insa-toulouse.fr>
References: <25bfaeec-31e8-c2db-812e-cb0759342a15@insa-toulouse.fr>
 <DCF48AFB-EE93-4048-99E1-56613BB43872@nyu.edu>
 <dce19c1c-d8e7-c315-7db2-15f3a279373d@insa-toulouse.fr>
Message-ID: <23142.59509.311063.933392@stat.math.ethz.ch>

>>>>> Serguei Sokol <sokol at insa-toulouse.fr>
>>>>>     on Mon, 22 Jan 2018 17:57:47 +0100 writes:

    > Le 22/01/2018 ? 17:40, Keith O'Hara a ?crit?:
    >> This behavior is noted in the qr documentation, no?
    >> 
    >> rank - the rank of x as computed by the decomposition(*): always full rank in the LAPACK case.
    > For a me a "full rank matrix" is a matrix the rank of which is indeed min(nrow(A), ncol(A))
    > but here the meaning of "always is full rank" is somewhat confusing. Does it mean
    > that only full rank matrices must be submitted to qr() when LAPACK=TRUE?
    > May be there is a jargon where "full rank" is a synonym of min(nrow(A), ncol(A)) for any matrix
    > but the fix to stick with commonly admitted rank definition (i.e. the number of linearly independent
    > columns in A) is so easy. Why to discard lapack case from it (even properly documented)?

Because 99.5% of caller to qr()  never look at '$rank', 
so why should we compute it every time qr() is called?

==> Matrix :: rankMatrix() does use "qr" as one of its several methods.

--------------

As wiser people than me have said (I'm paraphrasing, don't find a nice citation):

  While the rank of a matrix is a very well defined concept in
  mathematics (theory), its practical computation on a finite
  precision computer is much more challenging.

The ?rankMatrix  help page (package Matrix, part of your R)
   https://stat.ethz.ch/R-manual/R-devel/library/Matrix/html/rankMatrix.html
starts with the following 'Description' 

__ Compute ?the? matrix rank, a well-defined functional in theory(*), somewhat ambigous in practice. We provide several methods, the default corresponding to Matlab's definition.

__ (*) The rank of a n x m matrix A, rk(A) is the maximal number of linearly independent columns (or rows); hence rk(A) <= min(n,m).


    >>> On Jan 22, 2018, at 11:21 AM, Serguei Sokol <sokol at insa-toulouse.fr> wrote:
    >>> 
    >>> Hi,
    >>> 
    >>> I have noticed different rank values calculated by qr() depending on
    >>> LAPACK parameter. When it is FALSE (default) a true rank is estimated and returned.
    >>> Unfortunately, when LAPACK is set to TRUE, the min(nrow(A), ncol(A)) is returned
    >>> which is only occasionally a true rank.
    >>> 
    >>> Would not it be more consistent to replace the rank in the latter case by something
    >>> based on the following pseudo code ?
    >>> 
    >>> d=abs(diag(qr))
    >>> rank=sum(d >= d[1]*tol)
    >>> 
    >>> Here, we rely on the fact column pivoting is activated in the called lapack routine (dgeqp3)
    >>> and diagonal term in qr matrix are put in decreasing order (according to their absolute values).
    >>> 
    >>> Serguei.
    >>> 
    >>> How to reproduce:
    >>> 
    >>> a=diag(2)
    >>> a[2,2]=0
    >>> qaf=qr(a, LAPACK=FALSE)
    >>> qaf$rank # shows 1. OK it's the true rank value
    >>> qat=qr(a, LAPACK=TRUE)
    >>> qat$rank #shows 2. Bad, it's not the expected value.
    >>> 

    > -- 
    > Serguei Sokol
    > Ingenieur de recherche INRA

    > Cellule math?matique
    > LISBP, INSA/INRA UMR 792, INSA/CNRS UMR 5504
    > 135 Avenue de Rangueil
    > 31077 Toulouse Cedex 04

    > tel: +33 5 6155 9849
    > email: sokol at insa-toulouse.fr
    > http://www.lisbp.fr


From bodenhofer at bioinf.jku.at  Tue Jan 23 10:56:12 2018
From: bodenhofer at bioinf.jku.at (Ulrich Bodenhofer)
Date: Tue, 23 Jan 2018 10:56:12 +0100
Subject: [Rd] How to address the following: CRAN packages not using
 Suggests conditionally
In-Reply-To: <745be8e2-5dec-b739-768d-ac26a7876b64@roswellpark.org>
References: <d4a372db-e2e1-9869-b281-107fd1d500cf@bioinf.jku.at>
 <46ae6e78-6e55-77d7-6df9-d7fa6de470d3@bioinf.jku.at>
 <CALEXWq2CK-aoLuo41z2UtyJKtfGu=DC7-=A91Mc83QwXRjAMXw@mail.gmail.com>
 <CALEXWq1Sab3azEnER9baV1Y3f44U_PhQc9v0x2wt3xqz1uDE5A@mail.gmail.com>
 <3b2856da-63c6-6706-214e-84518960eb4a@bioinf.jku.at>
 <745be8e2-5dec-b739-768d-ac26a7876b64@roswellpark.org>
Message-ID: <f34d2ac9-7c6c-6163-2e7a-6d815664ffac@bioinf.jku.at>

Thanks for your thoughts, Martin!
> It's very easy for 'pictures of code' (unevaluated code chunks in 
> vignettes) to drift from the actual implementation. So I'd really 
> encourage your conditional evaluation to be as narrow as possible -- 
> during CRAN or even CRAN fedora checks. Certainly trying to use 
> uninstalled Suggest'ed packages in vignettes should provide an error 
> message that is informative to users. Presumably the developer or user 
> intends actually to execute the code, and needs to struggle through 
> whatever issues come up.
I understand your point and I agree.
> I'm not sure whether my comments are consistent with Writing R 
> Extensions or not.
I doubt that. My understanding of the section "1.1.3.1 Suggested 
packages" is that conditional usage of suggested non-CRAN packages is 
more or less required.
> There is a fundamental tension between the CRAN and Bioconductor 
> release models. The Bioconductor 'devel' package repositories and 
> nightly builds are meant to be a place where new features and breaking 
> changes can be introduced and problems resolved before being exposed 
> to general users as a stable 'release' branch, once every six months. 
> This means that the Bioconductor devel branch periodically (as 
> recently and I suspect over the next several days) contains 
> considerable carnage that propagates to CRAN devel builds, creating 
> additional work for CRAN maintainers.
I am aware of these different philosophies. Though I have an opinion 
about this matter, it is pointless which model I like better. As a 
developer, I have to respect the rules, period. It seems that I can 
avoid trouble by avoiding any dependency to Bioconductor in my CRAN 
packages. In the case of the 'apcluster' package, I deliberately chose 
trouble ;-) ? because I think that exemplar-based clustering of 
biological sequences by means of sequence kernels is a very cool thing 
that users should be made aware of.

If I could make a wish to a fairy, I'd ask her to initiate a 
constructive discussion between the R Core Team and the Bioconductor 
Core Team to sort these things out, such that the "tensions" (as you 
have put it) are no longer left as a burden to the package developers.

Thanks and best regards,
Ulrich

>
>>
>> On 01/22/2018 10:16 AM, I?aki ?car wrote:
>>> Re-sending, since I forgot to include the list, sorry. I'm including 
>>> r-package-devel too this time, as it seems more appropriate for this 
>>> list.
>>>
>>>
>>> El 22 ene. 2018 10:11, "I?aki ?car" <i.ucar86 at gmail.com 
>>> <mailto:i.ucar86 at gmail.com>> escribi?:
>>>
>>>
>>>
>>> ??? El 22 ene. 2018 8:12, "Ulrich Bodenhofer"
>>> ??? <bodenhofer at bioinf.jku.at <mailto:bodenhofer at bioinf.jku.at>> 
>>> escribi?:
>>>
>>> ??????? Dear colleagues, dear members of the R Core Team,
>>>
>>> ??????? This was an issue raised by Prof. Brian Ripley and sent
>>> ??????? privately to all developers of CRAN packages that suggest
>>> ??????? Bioconductor packages (see original message below). As
>>> ??????? mentioned in my message enclosed below, it was easy for me to
>>> ??????? fix the error in examples (new version not submitted to CRAN
>>> ??????? yet), but it might turn into a major effort for the warnings
>>> ??????? raised by the package vignette. Since I have not gotten any
>>> ??????? advice yet, I take the liberty to post it here on this list -
>>> ??????? hoping that we reach a conclusion here how to deal with this
>>> ??????? matter.
>>>
>>>
>>> ??? Just disable code chunk evaluation if suggested packages are
>>> ??? missing (see [1]). As explained by Prof. Ripley, it will only
>>> ??? affect Fedora checks on r-devel, i.e., your users will still see
>>> ??? fully evaluated vignettes on CRAN.
>>>
>>> ??? [1] https://www.enchufa2.es/archives/suggests-and-vignettes.html
>>> <https://www.enchufa2.es/archives/suggests-and-vignettes.html>
>>>
>>> ??? I?aki
>>>
>>>
>>> ??????? Thanks in advance for your kind assistance,
>>> ??????? Ulrich Bodenhofer
>>>
>>>
>>>
>>> ??????? -------- Forwarded Message --------
>>> ??????? Subject:? ? ? ? Re: CRAN packages not using Suggests 
>>> conditionally
>>> ??????? Date:? ?Mon, 15 Jan 2018 08:44:40 +0100
>>> ??????? From:? ?Ulrich Bodenhofer <bodenhofer at bioinf.jku.at
>>> ??????? <mailto:bodenhofer at bioinf.jku.at>>
>>> ??????? To:? ? ?Prof Brian Ripley <ripley at stats.ox.ac.uk
>>> ??????? <mailto:ripley at stats.ox.ac.uk>>
>>> ??????? CC:? ? ?[...stripped for the sake of privacy ...]
>>>
>>>
>>>
>>> ??????? Dear Prof. Ripley,
>>>
>>> ??????? Thank you very much for bringing this important issue to my
>>> ??????? attention. I
>>> ??????? am the maintainer of the 'apcluster' package. My package 
>>> refers to
>>> ??????? 'Biostrings' in an example section of a help page (a quite
>>> ??????? insignificant
>>> ??????? one, by the way), which creates errors on some platforms. It
>>> ??????? also refers
>>> ??????? to 'kebabs' in the package vignette, which leads to warnings.
>>>
>>> ??????? I could fix the first, more severe, problem quite easily, (1)
>>> ??????? since it
>>> ??????? is relatively easy to wrap an entire examples section in a
>>> ??????? conditional,
>>> ??????? and (2), as I have mentioned, it is not a particularly
>>> ??????? important help page.
>>>
>>> ??????? Regarding the vignette, I want to ask for your advice now,
>>> ??????? since the
>>> ??????? situation appears more complicated to me. While it is, of
>>> ??????? course, only
>>> ??????? one code chunk that loads the 'kebabs' package, five more code
>>> ??????? chunks
>>> ??????? depend on the package (more specifically, the data objects
>>> ??????? created by a
>>> ??????? method implemented in the package) - with quite some text in
>>> ??????? between. So
>>> ??????? the handling of the conditional loading of the package would
>>> ??????? propagate
>>> ??????? to multiple code chunks and also affect the validity of the
>>> ??????? explanations
>>> ??????? in between. I would see the following options:
>>>
>>> ??????? 1. Remove the entire section of the vignette. That would be a
>>> ??????? pity,
>>> ??????? since I can no longer point the users to an otherwise 
>>> interesting
>>> ??????? application of my package.
>>> ??????? 2. Replace the code chunks by static LaTeX code such that it
>>> ??????? appears in
>>> ??????? the PDF as if there were code chunks that had been run. This
>>> ??????? sort of
>>> ??????? undermines the philosophy of vignettes and also creates extra
>>> ??????? effort for
>>> ??????? me to maintain the vignette.
>>> ??????? 3. Use the functionality of 'kernlab' instead of 'kebabs' if
>>> ??????? the latter
>>> ??????? is not available. This would be technically possible, but (1)
>>> ??????? the code
>>> ??????? in the vignette will look much more complicated to the user
>>> ??????? and (2)
>>> ??????? 'kernlab' does not implement the necessary functionality fully
>>> ??????? correctly
>>> ??????? and also has much longer run times. Needless to say, the issue
>>> ??????? with
>>> ??????? conditional loading will then simply propagate to 'kernlab'.
>>>
>>> ??????? Which of the three solutions would you prefer? Do you see any
>>> ??????? fourth
>>> ??????? alternative? Or would you tolerate the warnings on some 
>>> platforms
>>> ??????? arising from the non-availability of packages suggested by the
>>> ??????? package
>>> ??????? vignette?
>>>
>>> ??????? Thanks for your time and best regards,
>>> ??????? Ulrich Bodenhofer
>>>
>>> ??????? P.S.: @all: I hope it is acceptable that I replied to all. I
>>> ??????? thought the
>>> ??????? discussion would be interesting for some of you having similar
>>> ??????? issues.
>>>
>>>
>>>
>>> ??????? On 01/14/2018 09:20 AM, Prof Brian Ripley wrote:
>>>
>>> ??????????? as required by ?1.1.3.1 of the manual.
>>>
>>> ??????????? The Bioconductor branch used by R-devel has been very
>>> ??????????? unstable recently, and it has been decided not to use it
>>> ??????????? for the Fedora checks on R-devel. As you can see from the
>>> ??????????? CRAN results pages (at least at the time of writing), 
>>> packages
>>>
>>> ??????????? ACMEeqtl BoSSA CNVassoc CorShrink GRANBase GenCAT GiANT
>>> ??????????? NMF PlackettLuce ProFit ProFound RNAseqNet SIBERG
>>> ??????????? antaresRead apcluster cherry clValid coloc colorhcplot
>>> ??????????? entropart filematrix fuzzyforest fuzzyjoin glycanr hexbin
>>> ??????????? loon nscancor ordinalgmifs penalized phangorn propr shiftR
>>> ??????????? switchr tcgsaseq tileHMM tmod
>>>
>>> ??????????? then give ERRORs or (new) WARNINGs on their checks.
>>> ??????????? Please correct ASAP, and by Feb 20 to safely retain the
>>> ??????????? package on CRAN.


From sokol at insa-toulouse.fr  Tue Jan 23 11:36:41 2018
From: sokol at insa-toulouse.fr (Serguei Sokol)
Date: Tue, 23 Jan 2018 11:36:41 +0100
Subject: [Rd] Inconsistent rank in qr()
In-Reply-To: <23142.59509.311063.933392@stat.math.ethz.ch>
References: <25bfaeec-31e8-c2db-812e-cb0759342a15@insa-toulouse.fr>
 <DCF48AFB-EE93-4048-99E1-56613BB43872@nyu.edu>
 <dce19c1c-d8e7-c315-7db2-15f3a279373d@insa-toulouse.fr>
 <23142.59509.311063.933392@stat.math.ethz.ch>
Message-ID: <0559af65-11d9-a824-7ac1-05b5b0a91798@insa-toulouse.fr>

Le 23/01/2018 ? 08:47, Martin Maechler a ?crit?:
>>>>>> Serguei Sokol <sokol at insa-toulouse.fr>
>>>>>>      on Mon, 22 Jan 2018 17:57:47 +0100 writes:
>      > Le 22/01/2018 ? 17:40, Keith O'Hara a ?crit?:
>      >> This behavior is noted in the qr documentation, no?
>      >>
>      >> rank - the rank of x as computed by the decomposition(*): always full rank in the LAPACK case.
>      > For a me a "full rank matrix" is a matrix the rank of which is indeed min(nrow(A), ncol(A))
>      > but here the meaning of "always is full rank" is somewhat confusing. Does it mean
>      > that only full rank matrices must be submitted to qr() when LAPACK=TRUE?
>      > May be there is a jargon where "full rank" is a synonym of min(nrow(A), ncol(A)) for any matrix
>      > but the fix to stick with commonly admitted rank definition (i.e. the number of linearly independent
>      > columns in A) is so easy. Why to discard lapack case from it (even properly documented)?
>
> Because 99.5% of caller to qr()  never look at '$rank',
> so why should we compute it every time qr() is called?
1. Because R already does it for linpack so it would be consistent to do so for lapack too.
2. Because R pretends that it is a part of a returned qr class.
3. Because its calculation is a negligible fraction of QR itself.

>
> ==> Matrix :: rankMatrix() does use "qr" as one of its several methods.
>
> --------------
>
> As wiser people than me have said (I'm paraphrasing, don't find a nice citation):
>
>    While the rank of a matrix is a very well defined concept in
>    mathematics (theory), its practical computation on a finite
>    precision computer is much more challenging.
True. It is indeed depending of round-off errors during QR calculations and tolerance
setting but putting it just as min(nrow(A), ncol(A)) and still calling it rank of "full rank"
is by far the most misleading choice to my mind.

Once again, if we are already calculating it for linpack let do it in most consistent
way for lapack too. I can propose a patch if you will.

Serguei.

>
> The ?rankMatrix  help page (package Matrix, part of your R)
>     https://stat.ethz.ch/R-manual/R-devel/library/Matrix/html/rankMatrix.html
> starts with the following 'Description'
>
> __ Compute ?the? matrix rank, a well-defined functional in theory(*), somewhat ambigous in practice. We provide several methods, the default corresponding to Matlab's definition.
>
> __ (*) The rank of a n x m matrix A, rk(A) is the maximal number of linearly independent columns (or rows); hence rk(A) <= min(n,m).
>
>
>      >>> On Jan 22, 2018, at 11:21 AM, Serguei Sokol <sokol at insa-toulouse.fr> wrote:
>      >>>
>      >>> Hi,
>      >>>
>      >>> I have noticed different rank values calculated by qr() depending on
>      >>> LAPACK parameter. When it is FALSE (default) a true rank is estimated and returned.
>      >>> Unfortunately, when LAPACK is set to TRUE, the min(nrow(A), ncol(A)) is returned
>      >>> which is only occasionally a true rank.
>      >>>
>      >>> Would not it be more consistent to replace the rank in the latter case by something
>      >>> based on the following pseudo code ?
>      >>>
>      >>> d=abs(diag(qr))
>      >>> rank=sum(d >= d[1]*tol)
>      >>>
>      >>> Here, we rely on the fact column pivoting is activated in the called lapack routine (dgeqp3)
>      >>> and diagonal term in qr matrix are put in decreasing order (according to their absolute values).
>      >>>
>      >>> Serguei.
>      >>>
>      >>> How to reproduce:
>      >>>
>      >>> a=diag(2)
>      >>> a[2,2]=0
>      >>> qaf=qr(a, LAPACK=FALSE)
>      >>> qaf$rank # shows 1. OK it's the true rank value
>      >>> qat=qr(a, LAPACK=TRUE)
>      >>> qat$rank #shows 2. Bad, it's not the expected value.
>      >>>
>
>      > --
>      > Serguei Sokol
>      > Ingenieur de recherche INRA
>
>      > Cellule math?matique
>      > LISBP, INSA/INRA UMR 792, INSA/CNRS UMR 5504
>      > 135 Avenue de Rangueil
>      > 31077 Toulouse Cedex 04
>
>      > tel: +33 5 6155 9849
>      > email: sokol at insa-toulouse.fr
>      > http://www.lisbp.fr
>


From keith.ohara at nyu.edu  Wed Jan 24 05:23:01 2018
From: keith.ohara at nyu.edu (Keith O'Hara)
Date: Tue, 23 Jan 2018 23:23:01 -0500
Subject: [Rd] Inconsistent rank in qr()
In-Reply-To: <0559af65-11d9-a824-7ac1-05b5b0a91798@insa-toulouse.fr>
References: <25bfaeec-31e8-c2db-812e-cb0759342a15@insa-toulouse.fr>
 <DCF48AFB-EE93-4048-99E1-56613BB43872@nyu.edu>
 <dce19c1c-d8e7-c315-7db2-15f3a279373d@insa-toulouse.fr>
 <23142.59509.311063.933392@stat.math.ethz.ch>
 <0559af65-11d9-a824-7ac1-05b5b0a91798@insa-toulouse.fr>
Message-ID: <D7D05369-0A2E-4351-AF95-695314CC3CB7@nyu.edu>

A simpler fix: return rank=NA when Lapack is used.

Keith

> On Jan 23, 2018, at 5:36 AM, Serguei Sokol <sokol at insa-toulouse.fr> wrote:
> 
> Le 23/01/2018 ? 08:47, Martin Maechler a ?crit :
>>>>>>> Serguei Sokol <sokol at insa-toulouse.fr>
>>>>>>>     on Mon, 22 Jan 2018 17:57:47 +0100 writes:
>>     > Le 22/01/2018 ? 17:40, Keith O'Hara a ?crit :
>>     >> This behavior is noted in the qr documentation, no?
>>     >>
>>     >> rank - the rank of x as computed by the decomposition(*): always full rank in the LAPACK case.
>>     > For a me a "full rank matrix" is a matrix the rank of which is indeed min(nrow(A), ncol(A))
>>     > but here the meaning of "always is full rank" is somewhat confusing. Does it mean
>>     > that only full rank matrices must be submitted to qr() when LAPACK=TRUE?
>>     > May be there is a jargon where "full rank" is a synonym of min(nrow(A), ncol(A)) for any matrix
>>     > but the fix to stick with commonly admitted rank definition (i.e. the number of linearly independent
>>     > columns in A) is so easy. Why to discard lapack case from it (even properly documented)?
>> 
>> Because 99.5% of caller to qr()  never look at '$rank',
>> so why should we compute it every time qr() is called?
> 1. Because R already does it for linpack so it would be consistent to do so for lapack too.
> 2. Because R pretends that it is a part of a returned qr class.
> 3. Because its calculation is a negligible fraction of QR itself.
> 
>> 
>> ==> Matrix :: rankMatrix() does use "qr" as one of its several methods.
>> 
>> --------------
>> 
>> As wiser people than me have said (I'm paraphrasing, don't find a nice citation):
>> 
>>   While the rank of a matrix is a very well defined concept in
>>   mathematics (theory), its practical computation on a finite
>>   precision computer is much more challenging.
> True. It is indeed depending of round-off errors during QR calculations and tolerance
> setting but putting it just as min(nrow(A), ncol(A)) and still calling it rank of "full rank"
> is by far the most misleading choice to my mind.
> 
> Once again, if we are already calculating it for linpack let do it in most consistent
> way for lapack too. I can propose a patch if you will.
> 
> Serguei.
> 
>> 
>> The ?rankMatrix  help page (package Matrix, part of your R)
>>    https://stat.ethz.ch/R-manual/R-devel/library/Matrix/html/rankMatrix.html
>> starts with the following 'Description'
>> 
>> __ Compute ?the? matrix rank, a well-defined functional in theory(*), somewhat ambigous in practice. We provide several methods, the default corresponding to Matlab's definition.
>> 
>> __ (*) The rank of a n x m matrix A, rk(A) is the maximal number of linearly independent columns (or rows); hence rk(A) <= min(n,m).
>> 
>> 
>>     >>> On Jan 22, 2018, at 11:21 AM, Serguei Sokol <sokol at insa-toulouse.fr> wrote:
>>     >>>
>>     >>> Hi,
>>     >>>
>>     >>> I have noticed different rank values calculated by qr() depending on
>>     >>> LAPACK parameter. When it is FALSE (default) a true rank is estimated and returned.
>>     >>> Unfortunately, when LAPACK is set to TRUE, the min(nrow(A), ncol(A)) is returned
>>     >>> which is only occasionally a true rank.
>>     >>>
>>     >>> Would not it be more consistent to replace the rank in the latter case by something
>>     >>> based on the following pseudo code ?
>>     >>>
>>     >>> d=abs(diag(qr))
>>     >>> rank=sum(d >= d[1]*tol)
>>     >>>
>>     >>> Here, we rely on the fact column pivoting is activated in the called lapack routine (dgeqp3)
>>     >>> and diagonal term in qr matrix are put in decreasing order (according to their absolute values).
>>     >>>
>>     >>> Serguei.
>>     >>>
>>     >>> How to reproduce:
>>     >>>
>>     >>> a=diag(2)
>>     >>> a[2,2]=0
>>     >>> qaf=qr(a, LAPACK=FALSE)
>>     >>> qaf$rank # shows 1. OK it's the true rank value
>>     >>> qat=qr(a, LAPACK=TRUE)
>>     >>> qat$rank #shows 2. Bad, it's not the expected value.
>>     >>>
>> 
>>     > --
>>     > Serguei Sokol
>>     > Ingenieur de recherche INRA
>> 
>>     > Cellule math?matique
>>     > LISBP, INSA/INRA UMR 792, INSA/CNRS UMR 5504
>>     > 135 Avenue de Rangueil
>>     > 31077 Toulouse Cedex 04
>> 
>>     > tel: +33 5 6155 9849
>>     > email: sokol at insa-toulouse.fr
>>     > http://www.lisbp.fr


	[[alternative HTML version deleted]]


From bbolker at gmail.com  Wed Jan 24 18:45:17 2018
From: bbolker at gmail.com (Ben Bolker)
Date: Wed, 24 Jan 2018 12:45:17 -0500
Subject: [Rd] fix potential integer overflow in mantelhaen.test ?
Message-ID: <d19b9de8-017a-5d0b-a223-97cad56f4645@mcmaster.ca>

  Someone who was running into an integer overflow warning (and
downstream error) with mantelhaen.test() on a large data set asked about
it on StackOverflow:

https://stackoverflow.com/questions/48422398/na-nan-inf-in-foreign-function-error-with-mantelhaen-test/48428596#48428596

  Coercing ntot to double (i.e. ntot -> as.numeric(ntot)) on lines 283
and 285 here:

https://github.com/wch/r-source/blob/af7f52f70101960861e5d995d3a4bec010bc89e6/src/library/stats/R/mantelhaen.test.R#L283

  seems to fix the problem, fairly harmlessly (*maybe* there are some
edge cases where the integer and floating-point computations give
different answers??? these values are going to get sent to qr.solve() a
few lines later in any case ...)

   If people think this is worthwhile I could submit a bug report.

 cheers
   Ben Bolker


From xio at ungrund.org  Wed Jan 24 18:38:08 2018
From: xio at ungrund.org (Dmitry Zotikov)
Date: Wed, 24 Jan 2018 20:38:08 +0300
Subject: [Rd] R-3.4.3 frequently segfaults on HP-UX 11.31
Message-ID: <189721516815488@web31g.yandex.ru>

I've built R-3.4.3 on HP-UX 11.31 with GCC-4.9.2.? However, it segfaults
frequently, and I can't clearly understand why.

Some things work, like

> 1+2
[1] 3
> sum(c(1,2))
[1] 3
> var(c(1,2,3))
[1] 1

Some don't:

> pgamma(1,Inf,Inf)
*** caught segfault ***
address d0650000, cause 'invalid permissions'

Traceback:
1: pgamma(1, Inf, Inf)

Possible actions:
1: abort (with core dump, if enabled)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection: 1
R is aborting now ...
Segmentation fault (core dumped)

The 'cause' may be very different.

GCC's C and C++ compilers were already installed in the system, but I built
gfortran myself.? It didn't work from first time, so I had to experiment with
optimization flags and some other configure keys.? Although compiled through
the proper 3-stage boostrap procedure, I have no certainty that gfortran is
absolutely flawless, and if possible, I'd like to rule it out first.

Here's output from file and ldd (some libs are installed locally to, say,
$LOCAL):

$ file bin/exec/R
bin/exec/R:???? ELF-32 executable object file - IA64

$ ldd bin/exec/R

bin/exec/R:
??????? /usr/lib/hpux32/libpthread.so =>??????? /usr/lib/hpux32/libpthread.so
??????? libRblas.sl =>? $LOCAL/var/build/R-3.4.3/lib/libRblas.sl
??????? libgfortran.so.3 =>???? $LOCAL/lib/libgfortran.so.3
??????? libm.so.1 =>??? /usr/lib/hpux32/libm.so.1
??????? libunwind.so.1 =>?????? /usr/lib/hpux32/libunwind.so.1
??????? libdl.so.1 =>?? /usr/lib/hpux32/libdl.so.1
??????? /usr/local/lib/hpux32/libintl.so =>???? /usr/local/lib/hpux32/libintl.so
??????? /usr/local/lib/hpux32/libiconv.so =>??? /usr/local/lib/hpux32/libiconv.so
??????? libpcre.so.3 => $LOCAL/lib/libpcre.so.3
??????? liblzma.so =>?? /usr/local/lib/hpux32/liblzma.so
??????? libbz2.so =>??? /usr/local/lib/hpux32/libbz2.so
??????? libz.so =>????? /usr/local/lib/hpux32/libz.so
??????? libnsl.so.1 =>? /usr/lib/hpux32/libnsl.so.1
??????? librt.so.1 =>?? /usr/lib/hpux32/librt.so.1
??????? libc.so.1 =>??? /usr/lib/hpux32/libc.so.1
??????? libgfortran.so.3 =>???? $LOCAL/lib/libgfortran.so.3
??????? libm.so.1 =>??? /usr/lib/hpux32/libm.so.1
??????? libunwind.so.1 =>?????? /usr/lib/hpux32/libunwind.so.1
??????? libgcc_s.so.0 =>??????? $LOCAL/lib/libgcc_s.so.0
??????? libm.so.1 =>??? /usr/lib/hpux32/libm.so.1
??????? libc.so.1 =>??? /usr/lib/hpux32/libc.so.1
??????? libgcc_s.so.0 =>??????? $LOCAL/lib/libgcc_s.so.0
??????? libunwind.so.1 =>?????? /usr/lib/hpux32/libunwind.so.1
??????? libuca.so.1 =>? /usr/lib/hpux32/libuca.so.1
??????? libiconv.so =>? /usr/local/lib/hpux32/libiconv.so
??????? libc.so.1 =>??? /usr/lib/hpux32/libc.so.1
??????? libc.so.1 =>??? /usr/lib/hpux32/libc.so.1
??????? libpthread.so.1 =>????? /usr/lib/hpux32/libpthread.so.1
??????? libc.so.1 =>??? /usr/lib/hpux32/libc.so.1
??????? libc.so.1 =>??? /usr/lib/hpux32/libc.so.1
??????? libxti.so.1 =>? /usr/lib/hpux32/libxti.so.1
??????? libdl.so.1 =>?? /usr/lib/hpux32/libdl.so.1
??????? libc.so.1 =>??? /usr/lib/hpux32/libc.so.1
??????? libunwind.so.1 =>?????? /usr/lib/hpux32/libunwind.so.1

Where should I go looking first?


From murdoch.duncan at gmail.com  Thu Jan 25 00:17:32 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 24 Jan 2018 18:17:32 -0500
Subject: [Rd] Why R should never move to git
Message-ID: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>

Lately I've been doing some work with the manipulateWidget package, 
which lives on Github at 
https://github.com/rte-antares-rpackage/manipulateWidget/.  Last week I 
found a bug, so being a good community member, I put together a patch.

Since the package lives on Github, I followed instructions to put 
together a "pull request":

- I forked the main branch to my own Github account as 
<https://github.com/dmurdoch/manipulateWidget>.

- I checked out my fork into RStudio.

- I fixed the bug, and submitted the pull request 
<https://github.com/rte-antares-rpackage/manipulateWidget/pull/47>.

Then I felt good about myself, and continued on with my work.  Today I 
tracked down another bug, unrelated to the previous one.  I know enough 
about git to know that I shouldn't commit this fix to my fork, because 
it would then become part of the previous pull request.

So I created a branch within my fork, and committed the change there. 
But Github provides no way to create a pull request that only includes 
the new stuff!  Every attempt I made would have included everything from 
both bug fixes.

I've read online about creating a new branch based on the master copy, 
and "cherry picking" just the final change:  but all the instructions 
I've tried so far have failed.

Okay, I know the solution:  I need to burn the whole thing down (to 
quote Jenny Bryan).  I'll just create a new fork, and put the new bug 
fix in a branch there.

I can't!  I don't know if this is a Git restriction or a Github 
restriction, but it won't let me create a new fork without deleting the 
old one.  I don't know if deleting the previous fork would also delete 
the previous PR, so I'm not going to do this.

This is ridiculous!  It is such an easy concept:  I want to take the 
diff between my most recent commit and the one before, and send that 
diff to the owners of the master copy.  This should be a trivial (and it 
is in svn).

Git and Github allow the most baroque arrangements, but can't do this 
simple task.  That's an example of really bad UI design.

Duncan Murdoch


From csardi.gabor at gmail.com  Thu Jan 25 00:35:07 2018
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Wed, 24 Jan 2018 23:35:07 +0000
Subject: [Rd] Why R should never move to git
In-Reply-To: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
Message-ID: <CABtg=K=apVWjEaE6pcv0FBkOMDJHFeBLPi9VU3n_+xmuYs4gVg@mail.gmail.com>

When you create a branch for your bug fix, don't create it off the
previous fix. Create it off the original, forked state of the repo.

Are the two commits here your fixes?
https://github.com/dmurdoch/manipulateWidget/commits/master

Gabor

On Wed, Jan 24, 2018 at 11:17 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> Lately I've been doing some work with the manipulateWidget package, which
> lives on Github at
> https://github.com/rte-antares-rpackage/manipulateWidget/.  Last week I
> found a bug, so being a good community member, I put together a patch.
>
> Since the package lives on Github, I followed instructions to put together a
> "pull request":
>
> - I forked the main branch to my own Github account as
> <https://github.com/dmurdoch/manipulateWidget>.
>
> - I checked out my fork into RStudio.
>
> - I fixed the bug, and submitted the pull request
> <https://github.com/rte-antares-rpackage/manipulateWidget/pull/47>.
>
> Then I felt good about myself, and continued on with my work.  Today I
> tracked down another bug, unrelated to the previous one.  I know enough
> about git to know that I shouldn't commit this fix to my fork, because it
> would then become part of the previous pull request.
>
> So I created a branch within my fork, and committed the change there. But
> Github provides no way to create a pull request that only includes the new
> stuff!  Every attempt I made would have included everything from both bug
> fixes.
>
> I've read online about creating a new branch based on the master copy, and
> "cherry picking" just the final change:  but all the instructions I've tried
> so far have failed.
>
> Okay, I know the solution:  I need to burn the whole thing down (to quote
> Jenny Bryan).  I'll just create a new fork, and put the new bug fix in a
> branch there.
>
> I can't!  I don't know if this is a Git restriction or a Github restriction,
> but it won't let me create a new fork without deleting the old one.  I don't
> know if deleting the previous fork would also delete the previous PR, so I'm
> not going to do this.
>
> This is ridiculous!  It is such an easy concept:  I want to take the diff
> between my most recent commit and the one before, and send that diff to the
> owners of the master copy.  This should be a trivial (and it is in svn).
>
> Git and Github allow the most baroque arrangements, but can't do this simple
> task.  That's an example of really bad UI design.
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From hugh.parsonage at gmail.com  Thu Jan 25 00:36:56 2018
From: hugh.parsonage at gmail.com (Hugh Parsonage)
Date: Thu, 25 Jan 2018 10:36:56 +1100
Subject: [Rd] Why R should never move to git
In-Reply-To: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
Message-ID: <CAJmOi+Nm4NSTNYcEdhvg5sTepa3-j+xkpwu0aJTrV4ctVMLLpw@mail.gmail.com>

I think the problem you're experiencing is not uncommon but has a solution.

FWIW, I prefer git, but I think the best version control system for R
is whatever R-core prefers. If they were 2% more productive working in
an MS Word documents with Track Changes than git, so much worse for
git.

On 25 January 2018 at 10:17, Duncan Murdoch <murdoch.duncan at gmail.com> wrote:
> Lately I've been doing some work with the manipulateWidget package, which
> lives on Github at
> https://github.com/rte-antares-rpackage/manipulateWidget/.  Last week I
> found a bug, so being a good community member, I put together a patch.
>
> Since the package lives on Github, I followed instructions to put together a
> "pull request":
>
> - I forked the main branch to my own Github account as
> <https://github.com/dmurdoch/manipulateWidget>.
>
> - I checked out my fork into RStudio.
>
> - I fixed the bug, and submitted the pull request
> <https://github.com/rte-antares-rpackage/manipulateWidget/pull/47>.
>
> Then I felt good about myself, and continued on with my work.  Today I
> tracked down another bug, unrelated to the previous one.  I know enough
> about git to know that I shouldn't commit this fix to my fork, because it
> would then become part of the previous pull request.
>
> So I created a branch within my fork, and committed the change there. But
> Github provides no way to create a pull request that only includes the new
> stuff!  Every attempt I made would have included everything from both bug
> fixes.
>
> I've read online about creating a new branch based on the master copy, and
> "cherry picking" just the final change:  but all the instructions I've tried
> so far have failed.
>
> Okay, I know the solution:  I need to burn the whole thing down (to quote
> Jenny Bryan).  I'll just create a new fork, and put the new bug fix in a
> branch there.
>
> I can't!  I don't know if this is a Git restriction or a Github restriction,
> but it won't let me create a new fork without deleting the old one.  I don't
> know if deleting the previous fork would also delete the previous PR, so I'm
> not going to do this.
>
> This is ridiculous!  It is such an easy concept:  I want to take the diff
> between my most recent commit and the one before, and send that diff to the
> owners of the master copy.  This should be a trivial (and it is in svn).
>
> Git and Github allow the most baroque arrangements, but can't do this simple
> task.  That's an example of really bad UI design.
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From murdoch.duncan at gmail.com  Thu Jan 25 00:56:41 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 24 Jan 2018 18:56:41 -0500
Subject: [Rd] Why R should never move to git
In-Reply-To: <CABtg=K=apVWjEaE6pcv0FBkOMDJHFeBLPi9VU3n_+xmuYs4gVg@mail.gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CABtg=K=apVWjEaE6pcv0FBkOMDJHFeBLPi9VU3n_+xmuYs4gVg@mail.gmail.com>
Message-ID: <ba18a519-73c0-5b00-ae47-5b7e411e1600@gmail.com>

On 24/01/2018 6:35 PM, G?bor Cs?rdi wrote:
> When you create a branch for your bug fix, don't create it off the
> previous fix. Create it off the original, forked state of the repo.

Branches keepclass2 through to keepclass5 are my attempts to do that. 
As far as I can see they are all the same as keepclass, which was 
branched from the head of the master branch of my fork.
> 
> Are the two commits here your fixes?
> https://github.com/dmurdoch/manipulateWidget/commits/master

Those are both part of the first PR.  There's a third commit in 
keepclass (and the other branches too...)

If you or someone else tells me the magic commands I need to do what I 
want, I'll appreciate it.  But the main point of my post is that this is 
something that should be easy.  It shouldn't require expert help.  The 
fact that it does is a flaw in the design of Git or Github or both.

Duncan Murdoch

> 
> Gabor
> 
> On Wed, Jan 24, 2018 at 11:17 PM, Duncan Murdoch
> <murdoch.duncan at gmail.com> wrote:
>> Lately I've been doing some work with the manipulateWidget package, which
>> lives on Github at
>> https://github.com/rte-antares-rpackage/manipulateWidget/.  Last week I
>> found a bug, so being a good community member, I put together a patch.
>>
>> Since the package lives on Github, I followed instructions to put together a
>> "pull request":
>>
>> - I forked the main branch to my own Github account as
>> <https://github.com/dmurdoch/manipulateWidget>.
>>
>> - I checked out my fork into RStudio.
>>
>> - I fixed the bug, and submitted the pull request
>> <https://github.com/rte-antares-rpackage/manipulateWidget/pull/47>.
>>
>> Then I felt good about myself, and continued on with my work.  Today I
>> tracked down another bug, unrelated to the previous one.  I know enough
>> about git to know that I shouldn't commit this fix to my fork, because it
>> would then become part of the previous pull request.
>>
>> So I created a branch within my fork, and committed the change there. But
>> Github provides no way to create a pull request that only includes the new
>> stuff!  Every attempt I made would have included everything from both bug
>> fixes.
>>
>> I've read online about creating a new branch based on the master copy, and
>> "cherry picking" just the final change:  but all the instructions I've tried
>> so far have failed.
>>
>> Okay, I know the solution:  I need to burn the whole thing down (to quote
>> Jenny Bryan).  I'll just create a new fork, and put the new bug fix in a
>> branch there.
>>
>> I can't!  I don't know if this is a Git restriction or a Github restriction,
>> but it won't let me create a new fork without deleting the old one.  I don't
>> know if deleting the previous fork would also delete the previous PR, so I'm
>> not going to do this.
>>
>> This is ridiculous!  It is such an easy concept:  I want to take the diff
>> between my most recent commit and the one before, and send that diff to the
>> owners of the master copy.  This should be a trivial (and it is in svn).
>>
>> Git and Github allow the most baroque arrangements, but can't do this simple
>> task.  That's an example of really bad UI design.
>>
>> Duncan Murdoch
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel


From csardi.gabor at gmail.com  Thu Jan 25 01:04:22 2018
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Thu, 25 Jan 2018 00:04:22 +0000
Subject: [Rd] Why R should never move to git
In-Reply-To: <ba18a519-73c0-5b00-ae47-5b7e411e1600@gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CABtg=K=apVWjEaE6pcv0FBkOMDJHFeBLPi9VU3n_+xmuYs4gVg@mail.gmail.com>
 <ba18a519-73c0-5b00-ae47-5b7e411e1600@gmail.com>
Message-ID: <CABtg=KkzmuqeGmi2JUa5fOJXrY_9=J2Z7Uh3s68Y99GQACgUBw@mail.gmail.com>

You need to create a branch from the original master, if you do
git log master
then you'll see which commit that is: f735449d679686867e7d3ab70810b09e8cea6366

So create that branch off that and switch to the new branch:
git branch keepclassx f735449d679686867e7d3ab70810b09e8cea6366
git checkout keepclassx

Then do
git log keepclass
to see the id of the new commit that you want to put on top of the new
branch: 0307ccfaa799c5257258eda89f2526347099f0d0
and cherry-pick that:
git cherry-pick 0307ccfaa799c5257258eda89f2526347099f0d0

Now you have a branch that only has the single desired commit, on top
of the original master.

You can now push you new branch to GitHub:
git push --set-upstream origin keepclassx
and then create a new pull request from this branch.

G.

On Wed, Jan 24, 2018 at 11:56 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> On 24/01/2018 6:35 PM, G?bor Cs?rdi wrote:
>>
>> When you create a branch for your bug fix, don't create it off the
>> previous fix. Create it off the original, forked state of the repo.
>
>
> Branches keepclass2 through to keepclass5 are my attempts to do that. As far
> as I can see they are all the same as keepclass, which was branched from the
> head of the master branch of my fork.
>>
>>
>> Are the two commits here your fixes?
>> https://github.com/dmurdoch/manipulateWidget/commits/master
>
>
> Those are both part of the first PR.  There's a third commit in keepclass
> (and the other branches too...)
>
> If you or someone else tells me the magic commands I need to do what I want,
> I'll appreciate it.  But the main point of my post is that this is something
> that should be easy.  It shouldn't require expert help.  The fact that it
> does is a flaw in the design of Git or Github or both.
>
> Duncan Murdoch
>
>
>>
>> Gabor
>>
>> On Wed, Jan 24, 2018 at 11:17 PM, Duncan Murdoch
>> <murdoch.duncan at gmail.com> wrote:
>>>
>>> Lately I've been doing some work with the manipulateWidget package, which
>>> lives on Github at
>>> https://github.com/rte-antares-rpackage/manipulateWidget/.  Last week I
>>> found a bug, so being a good community member, I put together a patch.
>>>
>>> Since the package lives on Github, I followed instructions to put
>>> together a
>>> "pull request":
>>>
>>> - I forked the main branch to my own Github account as
>>> <https://github.com/dmurdoch/manipulateWidget>.
>>>
>>> - I checked out my fork into RStudio.
>>>
>>> - I fixed the bug, and submitted the pull request
>>> <https://github.com/rte-antares-rpackage/manipulateWidget/pull/47>.
>>>
>>> Then I felt good about myself, and continued on with my work.  Today I
>>> tracked down another bug, unrelated to the previous one.  I know enough
>>> about git to know that I shouldn't commit this fix to my fork, because it
>>> would then become part of the previous pull request.
>>>
>>> So I created a branch within my fork, and committed the change there. But
>>> Github provides no way to create a pull request that only includes the
>>> new
>>> stuff!  Every attempt I made would have included everything from both bug
>>> fixes.
>>>
>>> I've read online about creating a new branch based on the master copy,
>>> and
>>> "cherry picking" just the final change:  but all the instructions I've
>>> tried
>>> so far have failed.
>>>
>>> Okay, I know the solution:  I need to burn the whole thing down (to quote
>>> Jenny Bryan).  I'll just create a new fork, and put the new bug fix in a
>>> branch there.
>>>
>>> I can't!  I don't know if this is a Git restriction or a Github
>>> restriction,
>>> but it won't let me create a new fork without deleting the old one.  I
>>> don't
>>> know if deleting the previous fork would also delete the previous PR, so
>>> I'm
>>> not going to do this.
>>>
>>> This is ridiculous!  It is such an easy concept:  I want to take the diff
>>> between my most recent commit and the one before, and send that diff to
>>> the
>>> owners of the master copy.  This should be a trivial (and it is in svn).
>>>
>>> Git and Github allow the most baroque arrangements, but can't do this
>>> simple
>>> task.  That's an example of really bad UI design.
>>>
>>> Duncan Murdoch
>>>
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>


From murdoch.duncan at gmail.com  Thu Jan 25 01:24:38 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 24 Jan 2018 19:24:38 -0500
Subject: [Rd] Why R should never move to git
In-Reply-To: <CABtg=KkzmuqeGmi2JUa5fOJXrY_9=J2Z7Uh3s68Y99GQACgUBw@mail.gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CABtg=K=apVWjEaE6pcv0FBkOMDJHFeBLPi9VU3n_+xmuYs4gVg@mail.gmail.com>
 <ba18a519-73c0-5b00-ae47-5b7e411e1600@gmail.com>
 <CABtg=KkzmuqeGmi2JUa5fOJXrY_9=J2Z7Uh3s68Y99GQACgUBw@mail.gmail.com>
Message-ID: <e2b65210-ef35-9975-0aef-648ab81f289b@gmail.com>

On 24/01/2018 7:04 PM, G?bor Cs?rdi wrote:
> You need to create a branch from the original master, if you do
> git log master
> then you'll see which commit that is: f735449d679686867e7d3ab70810b09e8cea6366
> 
> So create that branch off that and switch to the new branch:
> git branch keepclassx f735449d679686867e7d3ab70810b09e8cea6366
> git checkout keepclassx
> 
> Then do
> git log keepclass
> to see the id of the new commit that you want to put on top of the new
> branch: 0307ccfaa799c5257258eda89f2526347099f0d0
> and cherry-pick that:
> git cherry-pick 0307ccfaa799c5257258eda89f2526347099f0d0
> 
> Now you have a branch that only has the single desired commit, on top
> of the original master.
> 
> You can now push you new branch to GitHub:
> git push --set-upstream origin keepclassx
> and then create a new pull request from this branch.

Thanks, those instructions appear to have worked.

For comparison purposes, the equivalent steps in svn would be

svn diff -r PREV:HEAD --internal-diff > patchfile

and then the patchfile could be sent to the maintainer.

Duncan Murdoch

> 
> G.
> 
> On Wed, Jan 24, 2018 at 11:56 PM, Duncan Murdoch
> <murdoch.duncan at gmail.com> wrote:
>> On 24/01/2018 6:35 PM, G?bor Cs?rdi wrote:
>>>
>>> When you create a branch for your bug fix, don't create it off the
>>> previous fix. Create it off the original, forked state of the repo.
>>
>>
>> Branches keepclass2 through to keepclass5 are my attempts to do that. As far
>> as I can see they are all the same as keepclass, which was branched from the
>> head of the master branch of my fork.
>>>
>>>
>>> Are the two commits here your fixes?
>>> https://github.com/dmurdoch/manipulateWidget/commits/master
>>
>>
>> Those are both part of the first PR.  There's a third commit in keepclass
>> (and the other branches too...)
>>
>> If you or someone else tells me the magic commands I need to do what I want,
>> I'll appreciate it.  But the main point of my post is that this is something
>> that should be easy.  It shouldn't require expert help.  The fact that it
>> does is a flaw in the design of Git or Github or both.
>>
>> Duncan Murdoch
>>
>>
>>>
>>> Gabor
>>>
>>> On Wed, Jan 24, 2018 at 11:17 PM, Duncan Murdoch
>>> <murdoch.duncan at gmail.com> wrote:
>>>>
>>>> Lately I've been doing some work with the manipulateWidget package, which
>>>> lives on Github at
>>>> https://github.com/rte-antares-rpackage/manipulateWidget/.  Last week I
>>>> found a bug, so being a good community member, I put together a patch.
>>>>
>>>> Since the package lives on Github, I followed instructions to put
>>>> together a
>>>> "pull request":
>>>>
>>>> - I forked the main branch to my own Github account as
>>>> <https://github.com/dmurdoch/manipulateWidget>.
>>>>
>>>> - I checked out my fork into RStudio.
>>>>
>>>> - I fixed the bug, and submitted the pull request
>>>> <https://github.com/rte-antares-rpackage/manipulateWidget/pull/47>.
>>>>
>>>> Then I felt good about myself, and continued on with my work.  Today I
>>>> tracked down another bug, unrelated to the previous one.  I know enough
>>>> about git to know that I shouldn't commit this fix to my fork, because it
>>>> would then become part of the previous pull request.
>>>>
>>>> So I created a branch within my fork, and committed the change there. But
>>>> Github provides no way to create a pull request that only includes the
>>>> new
>>>> stuff!  Every attempt I made would have included everything from both bug
>>>> fixes.
>>>>
>>>> I've read online about creating a new branch based on the master copy,
>>>> and
>>>> "cherry picking" just the final change:  but all the instructions I've
>>>> tried
>>>> so far have failed.
>>>>
>>>> Okay, I know the solution:  I need to burn the whole thing down (to quote
>>>> Jenny Bryan).  I'll just create a new fork, and put the new bug fix in a
>>>> branch there.
>>>>
>>>> I can't!  I don't know if this is a Git restriction or a Github
>>>> restriction,
>>>> but it won't let me create a new fork without deleting the old one.  I
>>>> don't
>>>> know if deleting the previous fork would also delete the previous PR, so
>>>> I'm
>>>> not going to do this.
>>>>
>>>> This is ridiculous!  It is such an easy concept:  I want to take the diff
>>>> between my most recent commit and the one before, and send that diff to
>>>> the
>>>> owners of the master copy.  This should be a trivial (and it is in svn).
>>>>
>>>> Git and Github allow the most baroque arrangements, but can't do this
>>>> simple
>>>> task.  That's an example of really bad UI design.
>>>>
>>>> Duncan Murdoch
>>>>
>>>> ______________________________________________
>>>> R-devel at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>


From csardi.gabor at gmail.com  Thu Jan 25 01:29:15 2018
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Thu, 25 Jan 2018 00:29:15 +0000
Subject: [Rd] Why R should never move to git
In-Reply-To: <e2b65210-ef35-9975-0aef-648ab81f289b@gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CABtg=K=apVWjEaE6pcv0FBkOMDJHFeBLPi9VU3n_+xmuYs4gVg@mail.gmail.com>
 <ba18a519-73c0-5b00-ae47-5b7e411e1600@gmail.com>
 <CABtg=KkzmuqeGmi2JUa5fOJXrY_9=J2Z7Uh3s68Y99GQACgUBw@mail.gmail.com>
 <e2b65210-ef35-9975-0aef-648ab81f289b@gmail.com>
Message-ID: <CABtg=Km0O67Xo_vEoqiS0ny27qzo4mJTtWSJOjO8OUatLFUk+A@mail.gmail.com>

On Thu, Jan 25, 2018 at 12:24 AM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
[...]
> Thanks, those instructions appear to have worked.
>
> For comparison purposes, the equivalent steps in svn would be
>
> svn diff -r PREV:HEAD --internal-diff > patchfile
>
> and then the patchfile could be sent to the maintainer.

If you just want the diff corresponding to the last commit,

git show

will print it for you. Or

git show keepclass

for a specific branch.

G.

[...]


From murdoch.duncan at gmail.com  Thu Jan 25 01:43:41 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 24 Jan 2018 19:43:41 -0500
Subject: [Rd] Why R should never move to git
In-Reply-To: <CABtg=Km0O67Xo_vEoqiS0ny27qzo4mJTtWSJOjO8OUatLFUk+A@mail.gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CABtg=K=apVWjEaE6pcv0FBkOMDJHFeBLPi9VU3n_+xmuYs4gVg@mail.gmail.com>
 <ba18a519-73c0-5b00-ae47-5b7e411e1600@gmail.com>
 <CABtg=KkzmuqeGmi2JUa5fOJXrY_9=J2Z7Uh3s68Y99GQACgUBw@mail.gmail.com>
 <e2b65210-ef35-9975-0aef-648ab81f289b@gmail.com>
 <CABtg=Km0O67Xo_vEoqiS0ny27qzo4mJTtWSJOjO8OUatLFUk+A@mail.gmail.com>
Message-ID: <f47a64d9-f7cc-b2e6-c153-38c6ee71a252@gmail.com>

On 24/01/2018 7:29 PM, G?bor Cs?rdi wrote:
> On Thu, Jan 25, 2018 at 12:24 AM, Duncan Murdoch
> <murdoch.duncan at gmail.com> wrote:
> [...]
>> Thanks, those instructions appear to have worked.
>>
>> For comparison purposes, the equivalent steps in svn would be
>>
>> svn diff -r PREV:HEAD --internal-diff > patchfile
>>
>> and then the patchfile could be sent to the maintainer.
> 
> If you just want the diff corresponding to the last commit,
> 
> git show
> 
> will print it for you. Or
> 
> git show keepclass
> 
> for a specific branch.

But that's only half the battle.  If I did that and emailed the diff to 
a maintainer, I'm guessing I'd be told I should put together a PR 
instead.  And as I found out, that's not easy, if I already have a fork 
of the repository that contains changes and I don't want to blow it away.

Duncan Murdoch


From csardi.gabor at gmail.com  Thu Jan 25 01:52:54 2018
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Thu, 25 Jan 2018 00:52:54 +0000
Subject: [Rd] Why R should never move to git
In-Reply-To: <f47a64d9-f7cc-b2e6-c153-38c6ee71a252@gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CABtg=K=apVWjEaE6pcv0FBkOMDJHFeBLPi9VU3n_+xmuYs4gVg@mail.gmail.com>
 <ba18a519-73c0-5b00-ae47-5b7e411e1600@gmail.com>
 <CABtg=KkzmuqeGmi2JUa5fOJXrY_9=J2Z7Uh3s68Y99GQACgUBw@mail.gmail.com>
 <e2b65210-ef35-9975-0aef-648ab81f289b@gmail.com>
 <CABtg=Km0O67Xo_vEoqiS0ny27qzo4mJTtWSJOjO8OUatLFUk+A@mail.gmail.com>
 <f47a64d9-f7cc-b2e6-c153-38c6ee71a252@gmail.com>
Message-ID: <CABtg=Kn8eD8QO_0qDJpjMiKNiYZeAu3k_b4c=kbnY30n3tYVwA@mail.gmail.com>

On Thu, Jan 25, 2018 at 12:43 AM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
[...]
> But that's only half the battle.  If I did that and emailed the diff to a
> maintainer, I'm guessing I'd be told I should put together a PR instead.
> And as I found out, that's not easy, if I already have a fork of the
> repository that contains changes and I don't want to blow it away.

You can always create a branch, off any commit in the DAG, as in the
previous emails,
and then replay the changes there.

But there are alternatives as well, e.g. you can also create a branch
from the tip of master,
and then remove the two old commits, and keep the last one. I usually
do this via sg like

git rebase HEAD^^^^ --interactive

which will start an editor with the 4 latest commits. Then you just
remove the ones
you don't want, save, exit, and then git will perform the rebase, as desired.

G.

> Duncan Murdoch


From i.ucar86 at gmail.com  Thu Jan 25 08:57:48 2018
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Thu, 25 Jan 2018 08:57:48 +0100
Subject: [Rd] Why R should never move to git
In-Reply-To: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
Message-ID: <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>

For what it's worth, this is my workflow:

1. Get a fork.
2. From the master branch, create a new branch called fix-[something].
3. Put together the stuff there, commit, push and open a PR.
4. Checkout master and repeat from 2 to submit another patch.

Sometimes, I forget the step of creating the new branch and I put my
fix on top of the master branch, which complicates things a bit. But
you can always rename your fork's master and pull it again from
upstream.

I?aki



2018-01-25 0:17 GMT+01:00 Duncan Murdoch <murdoch.duncan at gmail.com>:
> Lately I've been doing some work with the manipulateWidget package, which
> lives on Github at
> https://github.com/rte-antares-rpackage/manipulateWidget/.  Last week I
> found a bug, so being a good community member, I put together a patch.
>
> Since the package lives on Github, I followed instructions to put together a
> "pull request":
>
> - I forked the main branch to my own Github account as
> <https://github.com/dmurdoch/manipulateWidget>.
>
> - I checked out my fork into RStudio.
>
> - I fixed the bug, and submitted the pull request
> <https://github.com/rte-antares-rpackage/manipulateWidget/pull/47>.
>
> Then I felt good about myself, and continued on with my work.  Today I
> tracked down another bug, unrelated to the previous one.  I know enough
> about git to know that I shouldn't commit this fix to my fork, because it
> would then become part of the previous pull request.
>
> So I created a branch within my fork, and committed the change there. But
> Github provides no way to create a pull request that only includes the new
> stuff!  Every attempt I made would have included everything from both bug
> fixes.
>
> I've read online about creating a new branch based on the master copy, and
> "cherry picking" just the final change:  but all the instructions I've tried
> so far have failed.
>
> Okay, I know the solution:  I need to burn the whole thing down (to quote
> Jenny Bryan).  I'll just create a new fork, and put the new bug fix in a
> branch there.
>
> I can't!  I don't know if this is a Git restriction or a Github restriction,
> but it won't let me create a new fork without deleting the old one.  I don't
> know if deleting the previous fork would also delete the previous PR, so I'm
> not going to do this.
>
> This is ridiculous!  It is such an easy concept:  I want to take the diff
> between my most recent commit and the one before, and send that diff to the
> owners of the master copy.  This should be a trivial (and it is in svn).
>
> Git and Github allow the most baroque arrangements, but can't do this simple
> task.  That's an example of really bad UI design.
>
> Duncan Murdoch
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



-- 
I?aki ?car
http://www.enchufa2.es
@Enchufa2


From murdoch.duncan at gmail.com  Thu Jan 25 12:20:09 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 25 Jan 2018 06:20:09 -0500
Subject: [Rd] Why R should never move to git
In-Reply-To: <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
Message-ID: <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>

On 25/01/2018 2:57 AM, I?aki ?car wrote:
> For what it's worth, this is my workflow:
> 
> 1. Get a fork.
> 2. From the master branch, create a new branch called fix-[something].
> 3. Put together the stuff there, commit, push and open a PR.
> 4. Checkout master and repeat from 2 to submit another patch.
> 
> Sometimes, I forget the step of creating the new branch and I put my
> fix on top of the master branch, which complicates things a bit. But
> you can always rename your fork's master and pull it again from
> upstream.
> 

I saw no way to follow your renaming suggestion.  Can you tell me the 
steps it would take?  Remember, there's already a PR from the master 
branch on my fork.  (This is for future reference; I already followed 
Gabor's more complicated instructions and have solved the immediate 
problem.)

Duncan Murdoch

> I?aki
> 
> 
> 
> 2018-01-25 0:17 GMT+01:00 Duncan Murdoch <murdoch.duncan at gmail.com>:
>> Lately I've been doing some work with the manipulateWidget package, which
>> lives on Github at
>> https://github.com/rte-antares-rpackage/manipulateWidget/.  Last week I
>> found a bug, so being a good community member, I put together a patch.
>>
>> Since the package lives on Github, I followed instructions to put together a
>> "pull request":
>>
>> - I forked the main branch to my own Github account as
>> <https://github.com/dmurdoch/manipulateWidget>.
>>
>> - I checked out my fork into RStudio.
>>
>> - I fixed the bug, and submitted the pull request
>> <https://github.com/rte-antares-rpackage/manipulateWidget/pull/47>.
>>
>> Then I felt good about myself, and continued on with my work.  Today I
>> tracked down another bug, unrelated to the previous one.  I know enough
>> about git to know that I shouldn't commit this fix to my fork, because it
>> would then become part of the previous pull request.
>>
>> So I created a branch within my fork, and committed the change there. But
>> Github provides no way to create a pull request that only includes the new
>> stuff!  Every attempt I made would have included everything from both bug
>> fixes.
>>
>> I've read online about creating a new branch based on the master copy, and
>> "cherry picking" just the final change:  but all the instructions I've tried
>> so far have failed.
>>
>> Okay, I know the solution:  I need to burn the whole thing down (to quote
>> Jenny Bryan).  I'll just create a new fork, and put the new bug fix in a
>> branch there.
>>
>> I can't!  I don't know if this is a Git restriction or a Github restriction,
>> but it won't let me create a new fork without deleting the old one.  I don't
>> know if deleting the previous fork would also delete the previous PR, so I'm
>> not going to do this.
>>
>> This is ridiculous!  It is such an easy concept:  I want to take the diff
>> between my most recent commit and the one before, and send that diff to the
>> owners of the master copy.  This should be a trivial (and it is in svn).
>>
>> Git and Github allow the most baroque arrangements, but can't do this simple
>> task.  That's an example of really bad UI design.
>>
>> Duncan Murdoch
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> 
>


From edd at debian.org  Thu Jan 25 12:49:09 2018
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 25 Jan 2018 05:49:09 -0600
Subject: [Rd] Why R should never move to git
In-Reply-To: <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
 <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
Message-ID: <23145.50229.740754.555607@bud.eddelbuettel.com>


On 25 January 2018 at 06:20, Duncan Murdoch wrote:
| On 25/01/2018 2:57 AM, I?aki ?car wrote:
| > For what it's worth, this is my workflow:
| > 
| > 1. Get a fork.
| > 2. From the master branch, create a new branch called fix-[something].
| > 3. Put together the stuff there, commit, push and open a PR.
| > 4. Checkout master and repeat from 2 to submit another patch.
| > 
| > Sometimes, I forget the step of creating the new branch and I put my
| > fix on top of the master branch, which complicates things a bit. But
| > you can always rename your fork's master and pull it again from
| > upstream.
| 
| I saw no way to follow your renaming suggestion.  Can you tell me the 
| steps it would take?  Remember, there's already a PR from the master 
| branch on my fork.  (This is for future reference; I already followed 
| Gabor's more complicated instructions and have solved the immediate 
| problem.)

1)  Via GUI: fork or clone at github so that you have URL to use in 2)

2)  Run
      git clone giturl....
    to fetch local instance
    
3)  Run
      git checkout -b feature/new_thing_a
    (this is 2. above by Inaki)
    
4)  Edit, save, compile, test, revise, ... leading to 1 or more commits

5)  Run
      git push origin
    standard configuration should have remote branch follow local branch, I
    think the "long form" is
      git push --set-upstream origin feature/new_thing_a

6)  Run
      git checkout -
    or
      git checkout master
    and you are back in master. Now you can restart at my 3) above for
    branches b, c, d and create independent pull requests

I find it really to have a bash prompt that shows the branch:

    edd at rob:~$ cd git/rcpp
    edd at rob:~/git/rcpp(master)$ git checkout -b feature/new_branch_to_show
    Switched to a new branch 'feature/new_branch_to_show'
    edd at rob:~/git/rcpp(feature/new_branch_to_show)$ git checkout -
    Switched to branch 'master'
    Your branch is up-to-date with 'origin/master'.
    edd at rob:~/git/rcpp(master)$ git branch -d feature/new_branch_to_show 
    Deleted branch feature/new_branch_to_show (was 5b25fe62).
    edd at rob:~/git/rcpp(master)$ 

There are few tutorials out there about how to do it, I once got mine from
Karthik when we did a Software Carpentry workshop.  Happy to detail off-list,
it adds less than 10 lines to ~/.bashrc.

Dirk

| 
| Duncan Murdoch
| 
| > I?aki
| > 
| > 
| > 
| > 2018-01-25 0:17 GMT+01:00 Duncan Murdoch <murdoch.duncan at gmail.com>:
| >> Lately I've been doing some work with the manipulateWidget package, which
| >> lives on Github at
| >> https://github.com/rte-antares-rpackage/manipulateWidget/.  Last week I
| >> found a bug, so being a good community member, I put together a patch.
| >>
| >> Since the package lives on Github, I followed instructions to put together a
| >> "pull request":
| >>
| >> - I forked the main branch to my own Github account as
| >> <https://github.com/dmurdoch/manipulateWidget>.
| >>
| >> - I checked out my fork into RStudio.
| >>
| >> - I fixed the bug, and submitted the pull request
| >> <https://github.com/rte-antares-rpackage/manipulateWidget/pull/47>.
| >>
| >> Then I felt good about myself, and continued on with my work.  Today I
| >> tracked down another bug, unrelated to the previous one.  I know enough
| >> about git to know that I shouldn't commit this fix to my fork, because it
| >> would then become part of the previous pull request.
| >>
| >> So I created a branch within my fork, and committed the change there. But
| >> Github provides no way to create a pull request that only includes the new
| >> stuff!  Every attempt I made would have included everything from both bug
| >> fixes.
| >>
| >> I've read online about creating a new branch based on the master copy, and
| >> "cherry picking" just the final change:  but all the instructions I've tried
| >> so far have failed.
| >>
| >> Okay, I know the solution:  I need to burn the whole thing down (to quote
| >> Jenny Bryan).  I'll just create a new fork, and put the new bug fix in a
| >> branch there.
| >>
| >> I can't!  I don't know if this is a Git restriction or a Github restriction,
| >> but it won't let me create a new fork without deleting the old one.  I don't
| >> know if deleting the previous fork would also delete the previous PR, so I'm
| >> not going to do this.
| >>
| >> This is ridiculous!  It is such an easy concept:  I want to take the diff
| >> between my most recent commit and the one before, and send that diff to the
| >> owners of the master copy.  This should be a trivial (and it is in svn).
| >>
| >> Git and Github allow the most baroque arrangements, but can't do this simple
| >> task.  That's an example of really bad UI design.
| >>
| >> Duncan Murdoch
| >>
| >> ______________________________________________
| >> R-devel at r-project.org mailing list
| >> https://stat.ethz.ch/mailman/listinfo/r-devel
| > 
| > 
| >
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel
-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From i.ucar86 at gmail.com  Thu Jan 25 13:03:44 2018
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Thu, 25 Jan 2018 13:03:44 +0100
Subject: [Rd] Why R should never move to git
In-Reply-To: <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
 <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
Message-ID: <CALEXWq0ye7Y2Fw2F-bVKYw-ERkQjK-ia7bAryE9hy7y+qT-A9Q@mail.gmail.com>

2018-01-25 12:20 GMT+01:00 Duncan Murdoch <murdoch.duncan at gmail.com>:
> On 25/01/2018 2:57 AM, I?aki ?car wrote:
>>
>> For what it's worth, this is my workflow:
>>
>> 1. Get a fork.
>> 2. From the master branch, create a new branch called fix-[something].
>> 3. Put together the stuff there, commit, push and open a PR.
>> 4. Checkout master and repeat from 2 to submit another patch.
>>
>> Sometimes, I forget the step of creating the new branch and I put my
>> fix on top of the master branch, which complicates things a bit. But
>> you can always rename your fork's master and pull it again from
>> upstream.
>>
>
> I saw no way to follow your renaming suggestion.  Can you tell me the steps
> it would take?  Remember, there's already a PR from the master branch on my
> fork.  (This is for future reference; I already followed Gabor's more
> complicated instructions and have solved the immediate problem.)

Sorry for the confusion: the step of renaming your master branch isn't
really needed, because you can pull the original master branch and
call it whatever you want in one command. The process is as follows:

1) Add the upstream repo as another remote:

git remote add upstream https://github.com/the/original/repo

2) Pull the upstream master with a different name:

git pull upstream master:patch2

3) Edit, add, commit and push patch2 to your fork:

git checkout patch2
...
git push origin patch2

4) open a fresh new PR from "patch2" (the first one is intact).

I?aki

>
> Duncan Murdoch
>


From murdoch.duncan at gmail.com  Thu Jan 25 13:09:28 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 25 Jan 2018 07:09:28 -0500
Subject: [Rd] Why R should never move to git
In-Reply-To: <23145.50229.740754.555607@bud.eddelbuettel.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
 <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
 <23145.50229.740754.555607@bud.eddelbuettel.com>
Message-ID: <040ac460-dd22-ad73-0a3b-ed49deb8cbf7@gmail.com>

On 25/01/2018 6:49 AM, Dirk Eddelbuettel wrote:
> 
> On 25 January 2018 at 06:20, Duncan Murdoch wrote:
> | On 25/01/2018 2:57 AM, I?aki ?car wrote:
> | > For what it's worth, this is my workflow:
> | >
> | > 1. Get a fork.
> | > 2. From the master branch, create a new branch called fix-[something].
> | > 3. Put together the stuff there, commit, push and open a PR.
> | > 4. Checkout master and repeat from 2 to submit another patch.
> | >
> | > Sometimes, I forget the step of creating the new branch and I put my
> | > fix on top of the master branch, which complicates things a bit. But
> | > you can always rename your fork's master and pull it again from
> | > upstream.
> |
> | I saw no way to follow your renaming suggestion.  Can you tell me the
> | steps it would take?  Remember, there's already a PR from the master
> | branch on my fork.  (This is for future reference; I already followed
> | Gabor's more complicated instructions and have solved the immediate
> | problem.)
> 
> 1)  Via GUI: fork or clone at github so that you have URL to use in 2)

Github would not allow me to fork, because I already had a fork of the 
same repository.  I suppose I could have set up a new user and done it.

I don't know if cloning the original would have made a difference. I 
don't have permission to commit to the original, and the 
manipulateWidget maintainers wouldn't be able to see my private clone, 
so I don't see how I could create a PR that they could use.

Once again, let me repeat:  this should be an easy thing to do.  So far 
I'm pretty convinced that it's actually impossible to do it on the 
Github website without hacks like creating a new user.  It's not trivial 
but not that difficult for a git expert using command line git.

If R Core chose to switch the R sources to use git and used Github to 
host a copy, problems like mine would come up fairly regularly.  I don't 
think R Core would gain enough from the switch to compensate for the 
burden of dealing with these problems.

Maybe Gitlab or some other front end would be better.

Duncan Murdoch

> 
> 2)  Run
>        git clone giturl....
>      to fetch local instance
>      
> 3)  Run
>        git checkout -b feature/new_thing_a
>      (this is 2. above by Inaki)
>      
> 4)  Edit, save, compile, test, revise, ... leading to 1 or more commits
> 
> 5)  Run
>        git push origin
>      standard configuration should have remote branch follow local branch, I
>      think the "long form" is
>        git push --set-upstream origin feature/new_thing_a
> 
> 6)  Run
>        git checkout -
>      or
>        git checkout master
>      and you are back in master. Now you can restart at my 3) above for
>      branches b, c, d and create independent pull requests
> 
> I find it really to have a bash prompt that shows the branch:
> 
>      edd at rob:~$ cd git/rcpp
>      edd at rob:~/git/rcpp(master)$ git checkout -b feature/new_branch_to_show
>      Switched to a new branch 'feature/new_branch_to_show'
>      edd at rob:~/git/rcpp(feature/new_branch_to_show)$ git checkout -
>      Switched to branch 'master'
>      Your branch is up-to-date with 'origin/master'.
>      edd at rob:~/git/rcpp(master)$ git branch -d feature/new_branch_to_show
>      Deleted branch feature/new_branch_to_show (was 5b25fe62).
>      edd at rob:~/git/rcpp(master)$
> 
> There are few tutorials out there about how to do it, I once got mine from
> Karthik when we did a Software Carpentry workshop.  Happy to detail off-list,
> it adds less than 10 lines to ~/.bashrc.
> 
> Dirk
> 
> |
> | Duncan Murdoch
> |
> | > I?aki
> | >
> | >
> | >
> | > 2018-01-25 0:17 GMT+01:00 Duncan Murdoch <murdoch.duncan at gmail.com>:
> | >> Lately I've been doing some work with the manipulateWidget package, which
> | >> lives on Github at
> | >> https://github.com/rte-antares-rpackage/manipulateWidget/.  Last week I
> | >> found a bug, so being a good community member, I put together a patch.
> | >>
> | >> Since the package lives on Github, I followed instructions to put together a
> | >> "pull request":
> | >>
> | >> - I forked the main branch to my own Github account as
> | >> <https://github.com/dmurdoch/manipulateWidget>.
> | >>
> | >> - I checked out my fork into RStudio.
> | >>
> | >> - I fixed the bug, and submitted the pull request
> | >> <https://github.com/rte-antares-rpackage/manipulateWidget/pull/47>.
> | >>
> | >> Then I felt good about myself, and continued on with my work.  Today I
> | >> tracked down another bug, unrelated to the previous one.  I know enough
> | >> about git to know that I shouldn't commit this fix to my fork, because it
> | >> would then become part of the previous pull request.
> | >>
> | >> So I created a branch within my fork, and committed the change there. But
> | >> Github provides no way to create a pull request that only includes the new
> | >> stuff!  Every attempt I made would have included everything from both bug
> | >> fixes.
> | >>
> | >> I've read online about creating a new branch based on the master copy, and
> | >> "cherry picking" just the final change:  but all the instructions I've tried
> | >> so far have failed.
> | >>
> | >> Okay, I know the solution:  I need to burn the whole thing down (to quote
> | >> Jenny Bryan).  I'll just create a new fork, and put the new bug fix in a
> | >> branch there.
> | >>
> | >> I can't!  I don't know if this is a Git restriction or a Github restriction,
> | >> but it won't let me create a new fork without deleting the old one.  I don't
> | >> know if deleting the previous fork would also delete the previous PR, so I'm
> | >> not going to do this.
> | >>
> | >> This is ridiculous!  It is such an easy concept:  I want to take the diff
> | >> between my most recent commit and the one before, and send that diff to the
> | >> owners of the master copy.  This should be a trivial (and it is in svn).
> | >>
> | >> Git and Github allow the most baroque arrangements, but can't do this simple
> | >> task.  That's an example of really bad UI design.
> | >>
> | >> Duncan Murdoch
> | >>
> | >> ______________________________________________
> | >> R-devel at r-project.org mailing list
> | >> https://stat.ethz.ch/mailman/listinfo/r-devel
> | >
> | >
> | >
> |
> | ______________________________________________
> | R-devel at r-project.org mailing list
> | https://stat.ethz.ch/mailman/listinfo/r-devel
>


From murdoch.duncan at gmail.com  Thu Jan 25 13:34:56 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 25 Jan 2018 07:34:56 -0500
Subject: [Rd] Why R should never move to git
In-Reply-To: <CALEXWq0ye7Y2Fw2F-bVKYw-ERkQjK-ia7bAryE9hy7y+qT-A9Q@mail.gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
 <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
 <CALEXWq0ye7Y2Fw2F-bVKYw-ERkQjK-ia7bAryE9hy7y+qT-A9Q@mail.gmail.com>
Message-ID: <d8ead98b-fe87-2cf1-4efc-ad900fe395bc@gmail.com>

On 25/01/2018 7:03 AM, I?aki ?car wrote:
> 2018-01-25 12:20 GMT+01:00 Duncan Murdoch <murdoch.duncan at gmail.com>:
>> On 25/01/2018 2:57 AM, I?aki ?car wrote:
>>>
>>> For what it's worth, this is my workflow:
>>>
>>> 1. Get a fork.
>>> 2. From the master branch, create a new branch called fix-[something].
>>> 3. Put together the stuff there, commit, push and open a PR.
>>> 4. Checkout master and repeat from 2 to submit another patch.
>>>
>>> Sometimes, I forget the step of creating the new branch and I put my
>>> fix on top of the master branch, which complicates things a bit. But
>>> you can always rename your fork's master and pull it again from
>>> upstream.
>>>
>>
>> I saw no way to follow your renaming suggestion.  Can you tell me the steps
>> it would take?  Remember, there's already a PR from the master branch on my
>> fork.  (This is for future reference; I already followed Gabor's more
>> complicated instructions and have solved the immediate problem.)
> 
> Sorry for the confusion: the step of renaming your master branch isn't
> really needed, because you can pull the original master branch and
> call it whatever you want in one command. The process is as follows:

Thanks. I've tried some of this, and am a little confused.

> 
> 1) Add the upstream repo as another remote:
> 
> git remote add upstream https://github.com/the/original/repo
> 
> 2) Pull the upstream master with a different name:
> 
> git pull upstream master:patch2

I've done all that, and now on my local copy I have a branch.  I called 
it "upstreamMaster", because at this point it matches the upstream 
master, and I intend to maintain it that way.

> 
> 3) Edit, add, commit and push patch2 to your fork:
> 
> git checkout patch2
> ...
> git push origin patch2

I did this, except that the "..." contains nothing, because I want this 
branch to continue.

But now my problem is that I can't see any way to tell Github about this 
new branch.  I ran

git push origin upstreamMaster

and got

Total 0 (delta 0), reused 0 (delta 0)
To https://github.com/dmurdoch/manipulateWidget
  * [new branch]      upstreamMaster -> upstreamMaster

but that branch doesn't show up in the Github web site.

Any suggestions?

Duncan Murdoch

> 
> 4) open a fresh new PR from "patch2" (the first one is intact).


From csardi.gabor at gmail.com  Thu Jan 25 13:44:15 2018
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Thu, 25 Jan 2018 12:44:15 +0000
Subject: [Rd] Why R should never move to git
In-Reply-To: <d8ead98b-fe87-2cf1-4efc-ad900fe395bc@gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
 <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
 <CALEXWq0ye7Y2Fw2F-bVKYw-ERkQjK-ia7bAryE9hy7y+qT-A9Q@mail.gmail.com>
 <d8ead98b-fe87-2cf1-4efc-ad900fe395bc@gmail.com>
Message-ID: <CABtg=K=aQHFcKc20+7frnjFxy1ZKhsNWz1y4ADfHK_sJ2-6LXw@mail.gmail.com>

On Thu, Jan 25, 2018 at 12:34 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
[...]
> but that branch doesn't show up in the Github web site.

It is right there:
https://github.com/dmurdoch/manipulateWidget/branches

> Any suggestions?

Personally I would suggest to call it master, because it is just
easier. Your master should correspond to the upstream master, and you
can do your own stuff in other branches.

G.

[...]


From jorismeys at gmail.com  Thu Jan 25 13:44:46 2018
From: jorismeys at gmail.com (Joris Meys)
Date: Thu, 25 Jan 2018 13:44:46 +0100
Subject: [Rd] Why R should never move to git
In-Reply-To: <d8ead98b-fe87-2cf1-4efc-ad900fe395bc@gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
 <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
 <CALEXWq0ye7Y2Fw2F-bVKYw-ERkQjK-ia7bAryE9hy7y+qT-A9Q@mail.gmail.com>
 <d8ead98b-fe87-2cf1-4efc-ad900fe395bc@gmail.com>
Message-ID: <CAO1zAVa1ysR=GLZ5Dsp06UmFYivV=BNO6inDQspbrWR1n3o4Ug@mail.gmail.com>

Hi Duncan,

I can see that branch on your github. Remember that you have to reload the
github page to see the latest additions to your repo. It doesn't do that
automatically.

Cheers
Joris

On Thu, Jan 25, 2018 at 1:34 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 25/01/2018 7:03 AM, I?aki ?car wrote:
>
>> 2018-01-25 12:20 GMT+01:00 Duncan Murdoch <murdoch.duncan at gmail.com>:
>>
>>> On 25/01/2018 2:57 AM, I?aki ?car wrote:
>>>
>>>>
>>>> For what it's worth, this is my workflow:
>>>>
>>>> 1. Get a fork.
>>>> 2. From the master branch, create a new branch called fix-[something].
>>>> 3. Put together the stuff there, commit, push and open a PR.
>>>> 4. Checkout master and repeat from 2 to submit another patch.
>>>>
>>>> Sometimes, I forget the step of creating the new branch and I put my
>>>> fix on top of the master branch, which complicates things a bit. But
>>>> you can always rename your fork's master and pull it again from
>>>> upstream.
>>>>
>>>>
>>> I saw no way to follow your renaming suggestion.  Can you tell me the
>>> steps
>>> it would take?  Remember, there's already a PR from the master branch on
>>> my
>>> fork.  (This is for future reference; I already followed Gabor's more
>>> complicated instructions and have solved the immediate problem.)
>>>
>>
>> Sorry for the confusion: the step of renaming your master branch isn't
>> really needed, because you can pull the original master branch and
>> call it whatever you want in one command. The process is as follows:
>>
>
> Thanks. I've tried some of this, and am a little confused.
>
>
>> 1) Add the upstream repo as another remote:
>>
>> git remote add upstream https://github.com/the/original/repo
>>
>> 2) Pull the upstream master with a different name:
>>
>> git pull upstream master:patch2
>>
>
> I've done all that, and now on my local copy I have a branch.  I called it
> "upstreamMaster", because at this point it matches the upstream master, and
> I intend to maintain it that way.
>
>
>> 3) Edit, add, commit and push patch2 to your fork:
>>
>> git checkout patch2
>> ...
>> git push origin patch2
>>
>
> I did this, except that the "..." contains nothing, because I want this
> branch to continue.
>
> But now my problem is that I can't see any way to tell Github about this
> new branch.  I ran
>
> git push origin upstreamMaster
>
> and got
>
> Total 0 (delta 0), reused 0 (delta 0)
> To https://github.com/dmurdoch/manipulateWidget
>  * [new branch]      upstreamMaster -> upstreamMaster
>
> but that branch doesn't show up in the Github web site.
>
> Any suggestions?
>
> Duncan Murdoch
>
>
>> 4) open a fresh new PR from "patch2" (the first one is intact).
>>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel




-- 
Joris Meys
Statistical consultant

Department of Data Analysis and Mathematical Modelling
Ghent University
Coupure Links 653, B-9000 Gent (Belgium)
<https://maps.google.com/?q=Coupure+links+653,%C2%A0B-9000+Gent,%C2%A0Belgium&entry=gmail&source=g>

-----------
Biowiskundedagen 2017-2018
http://www.biowiskundedagen.ugent.be/

-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php

	[[alternative HTML version deleted]]


From mario at emmenlauer.de  Thu Jan 25 13:48:02 2018
From: mario at emmenlauer.de (Mario Emmenlauer)
Date: Thu, 25 Jan 2018 13:48:02 +0100
Subject: [Rd] Why R should never move to git
In-Reply-To: <040ac460-dd22-ad73-0a3b-ed49deb8cbf7@gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
 <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
 <23145.50229.740754.555607@bud.eddelbuettel.com>
 <040ac460-dd22-ad73-0a3b-ed49deb8cbf7@gmail.com>
Message-ID: <e528a2e8-2b8c-28fe-14f5-4e49bc40e355@emmenlauer.de>


Hi Duncan!

I think there are many users whose first experiences with git where frustrating,
and trust me, many people here can relate to your pain. I can certainly say that
I can. At first, git makes significant effort to become fluent in seemingly
"simple" tasks. I can literally feel your pain right now.


But this is the main downside of git: that it can be hard to learn. I overcame
this problem by collecting copy-paste-instructions for the most common tasks.
I think Dirk provided a very nice starting point for a typical pull request, and
next time you need to use git, maybe try his instructions. They are *exactly* what
I use at least once a week. However they are not 1:1 for your current situation,
where you already started a fork.

If you want to solve your current "mess", I personally find the easiest thing to
move all local changes away (to /tmp/ or wherever), trash the github fork, and
start over with Dirks instructions. At point (4) you can copy your changed files
back from /tmp/ and use them for new commits, in this new, clean branch.

Everything else should just work.

Cheers,

    Mario




On 25.01.2018 13:09, Duncan Murdoch wrote:
> On 25/01/2018 6:49 AM, Dirk Eddelbuettel wrote:
>>
>> On 25 January 2018 at 06:20, Duncan Murdoch wrote:
>> | On 25/01/2018 2:57 AM, I?aki ?car wrote:
>> | > For what it's worth, this is my workflow:
>> | >
>> | > 1. Get a fork.
>> | > 2. From the master branch, create a new branch called fix-[something].
>> | > 3. Put together the stuff there, commit, push and open a PR.
>> | > 4. Checkout master and repeat from 2 to submit another patch.
>> | >
>> | > Sometimes, I forget the step of creating the new branch and I put my
>> | > fix on top of the master branch, which complicates things a bit. But
>> | > you can always rename your fork's master and pull it again from
>> | > upstream.
>> |
>> | I saw no way to follow your renaming suggestion.? Can you tell me the
>> | steps it would take?? Remember, there's already a PR from the master
>> | branch on my fork.? (This is for future reference; I already followed
>> | Gabor's more complicated instructions and have solved the immediate
>> | problem.)
>>
>> 1)? Via GUI: fork or clone at github so that you have URL to use in 2)
> 
> Github would not allow me to fork, because I already had a fork of the same repository.? I suppose I could have set up a new user and done it.
> 
> I don't know if cloning the original would have made a difference. I don't have permission to commit to the original, and the manipulateWidget maintainers
> wouldn't be able to see my private clone, so I don't see how I could create a PR that they could use.
> 
> Once again, let me repeat:? this should be an easy thing to do.? So far I'm pretty convinced that it's actually impossible to do it on the Github website
> without hacks like creating a new user.? It's not trivial but not that difficult for a git expert using command line git.
> 
> If R Core chose to switch the R sources to use git and used Github to host a copy, problems like mine would come up fairly regularly.? I don't think R Core
> would gain enough from the switch to compensate for the burden of dealing with these problems.
> 
> Maybe Gitlab or some other front end would be better.
> 
> Duncan Murdoch
> 
>>
>> 2)? Run
>> ?????? git clone giturl....
>> ???? to fetch local instance
>> ???? 3)? Run
>> ?????? git checkout -b feature/new_thing_a
>> ???? (this is 2. above by Inaki)
>> ???? 4)? Edit, save, compile, test, revise, ... leading to 1 or more commits
>>
>> 5)? Run
>> ?????? git push origin
>> ???? standard configuration should have remote branch follow local branch, I
>> ???? think the "long form" is
>> ?????? git push --set-upstream origin feature/new_thing_a
>>
>> 6)? Run
>> ?????? git checkout -
>> ???? or
>> ?????? git checkout master
>> ???? and you are back in master. Now you can restart at my 3) above for
>> ???? branches b, c, d and create independent pull requests
>>
>> I find it really to have a bash prompt that shows the branch:
>>
>> ???? edd at rob:~$ cd git/rcpp
>> ???? edd at rob:~/git/rcpp(master)$ git checkout -b feature/new_branch_to_show
>> ???? Switched to a new branch 'feature/new_branch_to_show'
>> ???? edd at rob:~/git/rcpp(feature/new_branch_to_show)$ git checkout -
>> ???? Switched to branch 'master'
>> ???? Your branch is up-to-date with 'origin/master'.
>> ???? edd at rob:~/git/rcpp(master)$ git branch -d feature/new_branch_to_show
>> ???? Deleted branch feature/new_branch_to_show (was 5b25fe62).
>> ???? edd at rob:~/git/rcpp(master)$
>>
>> There are few tutorials out there about how to do it, I once got mine from
>> Karthik when we did a Software Carpentry workshop.? Happy to detail off-list,
>> it adds less than 10 lines to ~/.bashrc.
>>
>> Dirk
>>
>> |
>> | Duncan Murdoch
>> |
>> | > I?aki
>> | >
>> | >
>> | >
>> | > 2018-01-25 0:17 GMT+01:00 Duncan Murdoch <murdoch.duncan at gmail.com>:
>> | >> Lately I've been doing some work with the manipulateWidget package, which
>> | >> lives on Github at
>> | >> https://github.com/rte-antares-rpackage/manipulateWidget/.? Last week I
>> | >> found a bug, so being a good community member, I put together a patch.
>> | >>
>> | >> Since the package lives on Github, I followed instructions to put together a
>> | >> "pull request":
>> | >>
>> | >> - I forked the main branch to my own Github account as
>> | >> <https://github.com/dmurdoch/manipulateWidget>.
>> | >>
>> | >> - I checked out my fork into RStudio.
>> | >>
>> | >> - I fixed the bug, and submitted the pull request
>> | >> <https://github.com/rte-antares-rpackage/manipulateWidget/pull/47>.
>> | >>
>> | >> Then I felt good about myself, and continued on with my work.? Today I
>> | >> tracked down another bug, unrelated to the previous one.? I know enough
>> | >> about git to know that I shouldn't commit this fix to my fork, because it
>> | >> would then become part of the previous pull request.
>> | >>
>> | >> So I created a branch within my fork, and committed the change there. But
>> | >> Github provides no way to create a pull request that only includes the new
>> | >> stuff!? Every attempt I made would have included everything from both bug
>> | >> fixes.
>> | >>
>> | >> I've read online about creating a new branch based on the master copy, and
>> | >> "cherry picking" just the final change:? but all the instructions I've tried
>> | >> so far have failed.
>> | >>
>> | >> Okay, I know the solution:? I need to burn the whole thing down (to quote
>> | >> Jenny Bryan).? I'll just create a new fork, and put the new bug fix in a
>> | >> branch there.
>> | >>
>> | >> I can't!? I don't know if this is a Git restriction or a Github restriction,
>> | >> but it won't let me create a new fork without deleting the old one.? I don't
>> | >> know if deleting the previous fork would also delete the previous PR, so I'm
>> | >> not going to do this.
>> | >>
>> | >> This is ridiculous!? It is such an easy concept:? I want to take the diff
>> | >> between my most recent commit and the one before, and send that diff to the
>> | >> owners of the master copy.? This should be a trivial (and it is in svn).
>> | >>
>> | >> Git and Github allow the most baroque arrangements, but can't do this simple
>> | >> task.? That's an example of really bad UI design.
>> | >>
>> | >> Duncan Murdoch
>> | >>
>> | >> ______________________________________________
>> | >> R-devel at r-project.org mailing list
>> | >> https://stat.ethz.ch/mailman/listinfo/r-devel
>> | >
>> | >
>> | >
>> |
>> | ______________________________________________
>> | R-devel at r-project.org mailing list
>> | https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel



Viele Gruesse,

    Mario Emmenlauer


--
BioDataAnalysis GmbH, Mario Emmenlauer      Tel. Buero: +49-89-74677203
Balanstr. 43                   mailto: memmenlauer * biodataanalysis.de
D-81669 M?nchen                          http://www.biodataanalysis.de/


From jari.oksanen at oulu.fi  Thu Jan 25 13:57:18 2018
From: jari.oksanen at oulu.fi (Jari Oksanen)
Date: Thu, 25 Jan 2018 14:57:18 +0200
Subject: [Rd] Why R should never move to git
In-Reply-To: <e528a2e8-2b8c-28fe-14f5-4e49bc40e355@emmenlauer.de>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
 <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
 <23145.50229.740754.555607@bud.eddelbuettel.com>
 <040ac460-dd22-ad73-0a3b-ed49deb8cbf7@gmail.com>
 <e528a2e8-2b8c-28fe-14f5-4e49bc40e355@emmenlauer.de>
Message-ID: <3cb41104-e1b0-b636-5c2f-99e84a1ff977@oulu.fi>

This is exactly the instruction given in? https://xkcd.com/1597/

cheers, J.O.

On 25/01/18 14:48, Mario Emmenlauer wrote:
> Hi Duncan!
>
> I think there are many users whose first experiences with git where frustrating,
> and trust me, many people here can relate to your pain. I can certainly say that
> I can. At first, git makes significant effort to become fluent in seemingly
> "simple" tasks. I can literally feel your pain right now.
>
>
> But this is the main downside of git: that it can be hard to learn. I overcame
> this problem by collecting copy-paste-instructions for the most common tasks.
> I think Dirk provided a very nice starting point for a typical pull request, and
> next time you need to use git, maybe try his instructions. They are *exactly* what
> I use at least once a week. However they are not 1:1 for your current situation,
> where you already started a fork.
>
> If you want to solve your current "mess", I personally find the easiest thing to
> move all local changes away (to /tmp/ or wherever), trash the github fork, and
> start over with Dirks instructions. At point (4) you can copy your changed files
> back from /tmp/ and use them for new commits, in this new, clean branch.
>
> Everything else should just work.
>
> Cheers,
>
>      Mario
>
>
>
>
> On 25.01.2018 13:09, Duncan Murdoch wrote:
>> On 25/01/2018 6:49 AM, Dirk Eddelbuettel wrote:
>>> On 25 January 2018 at 06:20, Duncan Murdoch wrote:
>>> | On 25/01/2018 2:57 AM, I?aki ?car wrote:
>>> | > For what it's worth, this is my workflow:
>>> | >
>>> | > 1. Get a fork.
>>> | > 2. From the master branch, create a new branch called fix-[something].
>>> | > 3. Put together the stuff there, commit, push and open a PR.
>>> | > 4. Checkout master and repeat from 2 to submit another patch.
>>> | >
>>> | > Sometimes, I forget the step of creating the new branch and I put my
>>> | > fix on top of the master branch, which complicates things a bit. But
>>> | > you can always rename your fork's master and pull it again from
>>> | > upstream.
>>> |
>>> | I saw no way to follow your renaming suggestion.? Can you tell me the
>>> | steps it would take?? Remember, there's already a PR from the master
>>> | branch on my fork.? (This is for future reference; I already followed
>>> | Gabor's more complicated instructions and have solved the immediate
>>> | problem.)
>>>
>>> 1)? Via GUI: fork or clone at github so that you have URL to use in 2)
>> Github would not allow me to fork, because I already had a fork of the same repository.? I suppose I could have set up a new user and done it.
>>
>> I don't know if cloning the original would have made a difference. I don't have permission to commit to the original, and the manipulateWidget maintainers
>> wouldn't be able to see my private clone, so I don't see how I could create a PR that they could use.
>>
>> Once again, let me repeat:? this should be an easy thing to do.? So far I'm pretty convinced that it's actually impossible to do it on the Github website
>> without hacks like creating a new user.? It's not trivial but not that difficult for a git expert using command line git.
>>
>> If R Core chose to switch the R sources to use git and used Github to host a copy, problems like mine would come up fairly regularly.? I don't think R Core
>> would gain enough from the switch to compensate for the burden of dealing with these problems.
>>
>> Maybe Gitlab or some other front end would be better.
>>
>> Duncan Murdoch
>>
>>> 2)? Run
>>>  ?????? git clone giturl....
>>>  ???? to fetch local instance
>>>  ???? 3)? Run
>>>  ?????? git checkout -b feature/new_thing_a
>>>  ???? (this is 2. above by Inaki)
>>>  ???? 4)? Edit, save, compile, test, revise, ... leading to 1 or more commits
>>>
>>> 5)? Run
>>>  ?????? git push origin
>>>  ???? standard configuration should have remote branch follow local branch, I
>>>  ???? think the "long form" is
>>>  ?????? git push --set-upstream origin feature/new_thing_a
>>>
>>> 6)? Run
>>>  ?????? git checkout -
>>>  ???? or
>>>  ?????? git checkout master
>>>  ???? and you are back in master. Now you can restart at my 3) above for
>>>  ???? branches b, c, d and create independent pull requests
>>>
>>> I find it really to have a bash prompt that shows the branch:
>>>
>>>  ???? edd at rob:~$ cd git/rcpp
>>>  ???? edd at rob:~/git/rcpp(master)$ git checkout -b feature/new_branch_to_show
>>>  ???? Switched to a new branch 'feature/new_branch_to_show'
>>>  ???? edd at rob:~/git/rcpp(feature/new_branch_to_show)$ git checkout -
>>>  ???? Switched to branch 'master'
>>>  ???? Your branch is up-to-date with 'origin/master'.
>>>  ???? edd at rob:~/git/rcpp(master)$ git branch -d feature/new_branch_to_show
>>>  ???? Deleted branch feature/new_branch_to_show (was 5b25fe62).
>>>  ???? edd at rob:~/git/rcpp(master)$
>>>
>>> There are few tutorials out there about how to do it, I once got mine from
>>> Karthik when we did a Software Carpentry workshop.? Happy to detail off-list,
>>> it adds less than 10 lines to ~/.bashrc.
>>>
>>> Dirk
>>>
>>> |
>>> | Duncan Murdoch
>>> |
>>> | > I?aki
>>> | >
>>> | >
>>> | >
>>> | > 2018-01-25 0:17 GMT+01:00 Duncan Murdoch <murdoch.duncan at gmail.com>:
>>> | >> Lately I've been doing some work with the manipulateWidget package, which
>>> | >> lives on Github at
>>> | >> https://emea01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Frte-antares-rpackage%2FmanipulateWidget%2F&data=02%7C01%7C%7Cd46f88a5d3664fd3163f08d563f1ebab%7C9f9ce49a51014aa38c750d5935ad6525%7C0%7C1%7C636524813075970616&sdata=uJhNCEY4egYlpDCkoGy6mI3WRb5PbkgZiBeCDsurxdg%3D&reserved=0.? Last week I
>>> | >> found a bug, so being a good community member, I put together a patch.
>>> | >>
>>> | >> Since the package lives on Github, I followed instructions to put together a
>>> | >> "pull request":
>>> | >>
>>> | >> - I forked the main branch to my own Github account as
>>> | >> <https://emea01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fdmurdoch%2FmanipulateWidget&data=02%7C01%7C%7Cd46f88a5d3664fd3163f08d563f1ebab%7C9f9ce49a51014aa38c750d5935ad6525%7C0%7C1%7C636524813075970616&sdata=44irdj5wUdiaOR86LBckjNkHq1QosEZaqIapyXLJw0Q%3D&reserved=0>.
>>> | >>
>>> | >> - I checked out my fork into RStudio.
>>> | >>
>>> | >> - I fixed the bug, and submitted the pull request
>>> | >> <https://emea01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Frte-antares-rpackage%2FmanipulateWidget%2Fpull%2F47&data=02%7C01%7C%7Cd46f88a5d3664fd3163f08d563f1ebab%7C9f9ce49a51014aa38c750d5935ad6525%7C0%7C1%7C636524813075970616&sdata=v2iC1pRbfMGg5lWNYiKbbJ6qILU%2FOwn6V9U4pEJx2cs%3D&reserved=0>.
>>> | >>
>>> | >> Then I felt good about myself, and continued on with my work.? Today I
>>> | >> tracked down another bug, unrelated to the previous one.? I know enough
>>> | >> about git to know that I shouldn't commit this fix to my fork, because it
>>> | >> would then become part of the previous pull request.
>>> | >>
>>> | >> So I created a branch within my fork, and committed the change there. But
>>> | >> Github provides no way to create a pull request that only includes the new
>>> | >> stuff!? Every attempt I made would have included everything from both bug
>>> | >> fixes.
>>> | >>
>>> | >> I've read online about creating a new branch based on the master copy, and
>>> | >> "cherry picking" just the final change:? but all the instructions I've tried
>>> | >> so far have failed.
>>> | >>
>>> | >> Okay, I know the solution:? I need to burn the whole thing down (to quote
>>> | >> Jenny Bryan).? I'll just create a new fork, and put the new bug fix in a
>>> | >> branch there.
>>> | >>
>>> | >> I can't!? I don't know if this is a Git restriction or a Github restriction,
>>> | >> but it won't let me create a new fork without deleting the old one.? I don't
>>> | >> know if deleting the previous fork would also delete the previous PR, so I'm
>>> | >> not going to do this.
>>> | >>
>>> | >> This is ridiculous!? It is such an easy concept:? I want to take the diff
>>> | >> between my most recent commit and the one before, and send that diff to the
>>> | >> owners of the master copy.? This should be a trivial (and it is in svn).
>>> | >>
>>> | >> Git and Github allow the most baroque arrangements, but can't do this simple
>>> | >> task.? That's an example of really bad UI design.
>>> | >>
>>> | >> Duncan Murdoch
>>> | >>
>>> | >> ______________________________________________
>>> | >> R-devel at r-project.org mailing list
>>> | >> https://emea01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-devel&data=02%7C01%7C%7Cd46f88a5d3664fd3163f08d563f1ebab%7C9f9ce49a51014aa38c750d5935ad6525%7C0%7C1%7C636524813075970616&sdata=4SGKvj20hKYiBbbUjsV8tgItxsjAMYmTtJQX0yr8V%2Bs%3D&reserved=0
>>> | >
>>> | >
>>> | >
>>> |
>>> | ______________________________________________
>>> | R-devel at r-project.org mailing list
>>> | https://emea01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-devel&data=02%7C01%7C%7Cd46f88a5d3664fd3163f08d563f1ebab%7C9f9ce49a51014aa38c750d5935ad6525%7C0%7C1%7C636524813075970616&sdata=4SGKvj20hKYiBbbUjsV8tgItxsjAMYmTtJQX0yr8V%2Bs%3D&reserved=0
>>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://emea01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-devel&data=02%7C01%7C%7Cd46f88a5d3664fd3163f08d563f1ebab%7C9f9ce49a51014aa38c750d5935ad6525%7C0%7C1%7C636524813075970616&sdata=4SGKvj20hKYiBbbUjsV8tgItxsjAMYmTtJQX0yr8V%2Bs%3D&reserved=0
>
>
> Viele Gruesse,
>
>      Mario Emmenlauer
>
>
> --
> BioDataAnalysis GmbH, Mario Emmenlauer      Tel. Buero: +49-89-74677203
> Balanstr. 43                   mailto: memmenlauer * biodataanalysis.de
> D-81669 M?nchen                          https://emea01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.biodataanalysis.de%2F&data=02%7C01%7C%7Cd46f88a5d3664fd3163f08d563f1ebab%7C9f9ce49a51014aa38c750d5935ad6525%7C0%7C1%7C636524813075970616&sdata=YcW8DMm%2F%2FSSzWVIiZHwwVZClxz9bl911vECahW2Ynt0%3D&reserved=0
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://emea01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-devel&data=02%7C01%7C%7Cd46f88a5d3664fd3163f08d563f1ebab%7C9f9ce49a51014aa38c750d5935ad6525%7C0%7C1%7C636524813075970616&sdata=4SGKvj20hKYiBbbUjsV8tgItxsjAMYmTtJQX0yr8V%2Bs%3D&reserved=0


From martin.morgan at roswellpark.org  Thu Jan 25 15:19:47 2018
From: martin.morgan at roswellpark.org (Martin Morgan)
Date: Thu, 25 Jan 2018 09:19:47 -0500
Subject: [Rd] Why R should never move to git
In-Reply-To: <040ac460-dd22-ad73-0a3b-ed49deb8cbf7@gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
 <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
 <23145.50229.740754.555607@bud.eddelbuettel.com>
 <040ac460-dd22-ad73-0a3b-ed49deb8cbf7@gmail.com>
Message-ID: <92c729da-3175-678d-9214-7c6cf00171ed@roswellpark.org>

On 01/25/2018 07:09 AM, Duncan Murdoch wrote:
> On 25/01/2018 6:49 AM, Dirk Eddelbuettel wrote:
>>
>> On 25 January 2018 at 06:20, Duncan Murdoch wrote:
>> | On 25/01/2018 2:57 AM, I?aki ?car wrote:
>> | > For what it's worth, this is my workflow:
>> | >
>> | > 1. Get a fork.
>> | > 2. From the master branch, create a new branch called 
>> fix-[something].
>> | > 3. Put together the stuff there, commit, push and open a PR.
>> | > 4. Checkout master and repeat from 2 to submit another patch.
>> | >
>> | > Sometimes, I forget the step of creating the new branch and I put my
>> | > fix on top of the master branch, which complicates things a bit. But
>> | > you can always rename your fork's master and pull it again from
>> | > upstream.
>> |
>> | I saw no way to follow your renaming suggestion.? Can you tell me the
>> | steps it would take?? Remember, there's already a PR from the master
>> | branch on my fork.? (This is for future reference; I already followed
>> | Gabor's more complicated instructions and have solved the immediate
>> | problem.)
>>
>> 1)? Via GUI: fork or clone at github so that you have URL to use in 2)
> 
> Github would not allow me to fork, because I already had a fork of the 
> same repository.? I suppose I could have set up a new user and done it.
> 
> I don't know if cloning the original would have made a difference. I 
> don't have permission to commit to the original, and the 
> manipulateWidget maintainers wouldn't be able to see my private clone, 
> so I don't see how I could create a PR that they could use.
> 
> Once again, let me repeat:? this should be an easy thing to do.? So far 
> I'm pretty convinced that it's actually impossible to do it on the 
> Github website without hacks like creating a new user.? It's not trivial 
> but not that difficult for a git expert using command line git.
> 
> If R Core chose to switch the R sources to use git and used Github to 
> host a copy, problems like mine would come up fairly regularly.? I don't 
> think R Core would gain enough from the switch to compensate for the 
> burden of dealing with these problems.

A different starting point gives R-core members write access to the 
R-core git, which is analogous to the current svn setup. A restricted 
set of commands are needed, mimicking svn

   git clone ...   # svn co
   git pull        # svn up
   [...; git commit ...]
   git push ...    # svn ci

Probably this would mature quickly into a better practice where new 
features / bug fixes are developed on a local branch.

A subset of R-core might participate in managing pull requests on a 
'read only' Github mirror. Incorporating mature patches would involve 
git, rather than the Github GUI. In one's local repository, create a new 
branch and pull from the repository making the request

   git checkout -b a-pull-request master
   git pull https://github.com/a-user/their.git their-branch

Check and modify, then merge locally and push to the R-core git

   ## identify standard / best practice for merging branches
   git checkout master
   git merge ... a-pull-request
   git push ...

Creating pull requests is a problem for the developer wanting to 
contribute to R, not for the R-core developer. As we've seen in this 
thread, R-core would not need to feel responsible for helping developers 
create pull requests.

Martin Morgan

> 
> Maybe Gitlab or some other front end would be better.
> 
> Duncan Murdoch
> 
>>
>> 2)? Run
>> ?????? git clone giturl....
>> ???? to fetch local instance
>> 3)? Run
>> ?????? git checkout -b feature/new_thing_a
>> ???? (this is 2. above by Inaki)
>> 4)? Edit, save, compile, test, revise, ... leading to 1 or more commits
>>
>> 5)? Run
>> ?????? git push origin
>> ???? standard configuration should have remote branch follow local 
>> branch, I
>> ???? think the "long form" is
>> ?????? git push --set-upstream origin feature/new_thing_a
>>
>> 6)? Run
>> ?????? git checkout -
>> ???? or
>> ?????? git checkout master
>> ???? and you are back in master. Now you can restart at my 3) above for
>> ???? branches b, c, d and create independent pull requests
>>
>> I find it really to have a bash prompt that shows the branch:
>>
>> ???? edd at rob:~$ cd git/rcpp
>> ???? edd at rob:~/git/rcpp(master)$ git checkout -b 
>> feature/new_branch_to_show
>> ???? Switched to a new branch 'feature/new_branch_to_show'
>> ???? edd at rob:~/git/rcpp(feature/new_branch_to_show)$ git checkout -
>> ???? Switched to branch 'master'
>> ???? Your branch is up-to-date with 'origin/master'.
>> ???? edd at rob:~/git/rcpp(master)$ git branch -d feature/new_branch_to_show
>> ???? Deleted branch feature/new_branch_to_show (was 5b25fe62).
>> ???? edd at rob:~/git/rcpp(master)$
>>
>> There are few tutorials out there about how to do it, I once got mine 
>> from
>> Karthik when we did a Software Carpentry workshop.? Happy to detail 
>> off-list,
>> it adds less than 10 lines to ~/.bashrc.
>>
>> Dirk
>>
>> |
>> | Duncan Murdoch
>> |
>> | > I?aki
>> | >
>> | >
>> | >
>> | > 2018-01-25 0:17 GMT+01:00 Duncan Murdoch <murdoch.duncan at gmail.com>:
>> | >> Lately I've been doing some work with the manipulateWidget 
>> package, which
>> | >> lives on Github at
>> | >> https://github.com/rte-antares-rpackage/manipulateWidget/.? Last 
>> week I
>> | >> found a bug, so being a good community member, I put together a 
>> patch.
>> | >>
>> | >> Since the package lives on Github, I followed instructions to put 
>> together a
>> | >> "pull request":
>> | >>
>> | >> - I forked the main branch to my own Github account as
>> | >> <https://github.com/dmurdoch/manipulateWidget>.
>> | >>
>> | >> - I checked out my fork into RStudio.
>> | >>
>> | >> - I fixed the bug, and submitted the pull request
>> | >> <https://github.com/rte-antares-rpackage/manipulateWidget/pull/47>.
>> | >>
>> | >> Then I felt good about myself, and continued on with my work.  
>> Today I
>> | >> tracked down another bug, unrelated to the previous one.? I know 
>> enough
>> | >> about git to know that I shouldn't commit this fix to my fork, 
>> because it
>> | >> would then become part of the previous pull request.
>> | >>
>> | >> So I created a branch within my fork, and committed the change 
>> there. But
>> | >> Github provides no way to create a pull request that only 
>> includes the new
>> | >> stuff!? Every attempt I made would have included everything from 
>> both bug
>> | >> fixes.
>> | >>
>> | >> I've read online about creating a new branch based on the master 
>> copy, and
>> | >> "cherry picking" just the final change:? but all the instructions 
>> I've tried
>> | >> so far have failed.
>> | >>
>> | >> Okay, I know the solution:? I need to burn the whole thing down 
>> (to quote
>> | >> Jenny Bryan).? I'll just create a new fork, and put the new bug 
>> fix in a
>> | >> branch there.
>> | >>
>> | >> I can't!? I don't know if this is a Git restriction or a Github 
>> restriction,
>> | >> but it won't let me create a new fork without deleting the old 
>> one.? I don't
>> | >> know if deleting the previous fork would also delete the previous 
>> PR, so I'm
>> | >> not going to do this.
>> | >>
>> | >> This is ridiculous!? It is such an easy concept:? I want to take 
>> the diff
>> | >> between my most recent commit and the one before, and send that 
>> diff to the
>> | >> owners of the master copy.? This should be a trivial (and it is 
>> in svn).
>> | >>
>> | >> Git and Github allow the most baroque arrangements, but can't do 
>> this simple
>> | >> task.? That's an example of really bad UI design.
>> | >>
>> | >> Duncan Murdoch
>> | >>
>> | >> ______________________________________________
>> | >> R-devel at r-project.org mailing list
>> | >> https://stat.ethz.ch/mailman/listinfo/r-devel
>> | >
>> | >
>> | >
>> |
>> | ______________________________________________
>> | R-devel at r-project.org mailing list
>> | https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


This email message may contain legally privileged and/or...{{dropped:2}}


From murdoch.duncan at gmail.com  Thu Jan 25 15:59:46 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 25 Jan 2018 09:59:46 -0500
Subject: [Rd] Why R should never move to git
In-Reply-To: <CAO1zAVa1ysR=GLZ5Dsp06UmFYivV=BNO6inDQspbrWR1n3o4Ug@mail.gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
 <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
 <CALEXWq0ye7Y2Fw2F-bVKYw-ERkQjK-ia7bAryE9hy7y+qT-A9Q@mail.gmail.com>
 <d8ead98b-fe87-2cf1-4efc-ad900fe395bc@gmail.com>
 <CAO1zAVa1ysR=GLZ5Dsp06UmFYivV=BNO6inDQspbrWR1n3o4Ug@mail.gmail.com>
Message-ID: <c5569ddd-890b-60ea-4226-c0c19039c2c2@gmail.com>

On 25/01/2018 7:44 AM, Joris Meys wrote:
> Hi Duncan,
> 
> I can see that branch on your github. Remember that you have to reload 
> the github page to see the latest additions to your repo. It doesn't do 
> that automatically.

Thanks, that was the issue.

Duncan Murdoch


From murdoch.duncan at gmail.com  Thu Jan 25 16:07:20 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Thu, 25 Jan 2018 10:07:20 -0500
Subject: [Rd] Why R should never move to git
In-Reply-To: <CABtg=K=aQHFcKc20+7frnjFxy1ZKhsNWz1y4ADfHK_sJ2-6LXw@mail.gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
 <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
 <CALEXWq0ye7Y2Fw2F-bVKYw-ERkQjK-ia7bAryE9hy7y+qT-A9Q@mail.gmail.com>
 <d8ead98b-fe87-2cf1-4efc-ad900fe395bc@gmail.com>
 <CABtg=K=aQHFcKc20+7frnjFxy1ZKhsNWz1y4ADfHK_sJ2-6LXw@mail.gmail.com>
Message-ID: <84899329-f439-7210-6444-e129cb2ebc91@gmail.com>

On 25/01/2018 7:44 AM, G?bor Cs?rdi wrote:
> On Thu, Jan 25, 2018 at 12:34 PM, Duncan Murdoch
> <murdoch.duncan at gmail.com> wrote:
> [...]
>> but that branch doesn't show up in the Github web site.
> 
> It is right there:
> https://github.com/dmurdoch/manipulateWidget/branches
> 
>> Any suggestions?
> 
> Personally I would suggest to call it master, because it is just
> easier. Your master should correspond to the upstream master, and you
> can do your own stuff in other branches.

That makes sense, but I don't see a way to rename branches on Github.  I 
did see a way to make it my default branch, but there's a scary warning:

"Are you sure?

Changing your default branch can have unintended consequences that can 
affect new pull requests and clones."

To answer yes to this I would have to say "I understand, update the 
default branch", and since I don't understand the consequences, I didn't 
click it.

Duncan Murdoch


From i.ucar86 at gmail.com  Thu Jan 25 17:35:23 2018
From: i.ucar86 at gmail.com (=?UTF-8?B?ScOxYWtpIMOaY2Fy?=)
Date: Thu, 25 Jan 2018 17:35:23 +0100
Subject: [Rd] Why R should never move to git
In-Reply-To: <84899329-f439-7210-6444-e129cb2ebc91@gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
 <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
 <CALEXWq0ye7Y2Fw2F-bVKYw-ERkQjK-ia7bAryE9hy7y+qT-A9Q@mail.gmail.com>
 <d8ead98b-fe87-2cf1-4efc-ad900fe395bc@gmail.com>
 <CABtg=K=aQHFcKc20+7frnjFxy1ZKhsNWz1y4ADfHK_sJ2-6LXw@mail.gmail.com>
 <84899329-f439-7210-6444-e129cb2ebc91@gmail.com>
Message-ID: <CALEXWq2SXYXE=3fh2kPmObrtD9JP1GO59fo9PUPPJvM+ty43jg@mail.gmail.com>

2018-01-25 16:07 GMT+01:00 Duncan Murdoch <murdoch.duncan at gmail.com>:
> On 25/01/2018 7:44 AM, G?bor Cs?rdi wrote:
>>
>> On Thu, Jan 25, 2018 at 12:34 PM, Duncan Murdoch
>> <murdoch.duncan at gmail.com> wrote:
>> [...]
>>>
>>> but that branch doesn't show up in the Github web site.
>>
>>
>> It is right there:
>> https://github.com/dmurdoch/manipulateWidget/branches
>>
>>> Any suggestions?
>>
>>
>> Personally I would suggest to call it master, because it is just
>> easier. Your master should correspond to the upstream master, and you
>> can do your own stuff in other branches.
>
>
> That makes sense, but I don't see a way to rename branches on Github.  I did
> see a way to make it my default branch, but there's a scary warning:
>
> "Are you sure?
>
> Changing your default branch can have unintended consequences that can
> affect new pull requests and clones."
>
> To answer yes to this I would have to say "I understand, update the default
> branch", and since I don't understand the consequences, I didn't click it.

Changing the default branch just moves the HEAD pointer (on GitHub) to
another branch. It would be equivalent to ssh into GitHub's server, cd
into the repo, and enter "git checkout anotherbranch". So not a big
deal in principle, but anyway this doesn't make any difference in this
case.

Also note that the name is not important: "master" has no special
meaning as "trunk" does in svn. It's just a convention, no more.

The executive summary of this thread would be:

1. Keep the default branch synced with upstream (this is usually
"master", but it could be another), and use other branches to fix
things and submit PRs.
2. If you mistakenly committed and pushed something to it, no problem:
just fetch a fresh copy of that branch from upstream and call it by a
different name, and we're back in 1.
3. GitHub can't be blamed about how git works. ;-)

I?aki

>
> Duncan Murdoch


From henrik.bengtsson at gmail.com  Thu Jan 25 18:30:42 2018
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Thu, 25 Jan 2018 09:30:42 -0800
Subject: [Rd] sum() returns NA on a long *logical* vector when nb of
 TRUE values exceeds 2^31
In-Reply-To: <CAFDcVCRt1=-1t8=-x5TLhe3y0T_tpZUkTAH1W-hyMKqFH-eJYg@mail.gmail.com>
References: <5931466B.1060407@fredhutch.org>
 <CAFDcVCRt1=-1t8=-x5TLhe3y0T_tpZUkTAH1W-hyMKqFH-eJYg@mail.gmail.com>
Message-ID: <CAFDcVCQv19O2zBybkRHh6G58AMa0GjQRZcHnD3WEnQACnuM7Uw@mail.gmail.com>

Just following up on this old thread since matrixStats 0.53.0 is now
out, which supports this use case:

> x <- rep(TRUE, times = 2^31)

> y <- sum(x)
> y
[1] NA
Warning message:
In sum(x) : integer overflow - use sum(as.numeric(.))

> y <- matrixStats::sum2(x, mode = "double")
> y
[1] 2147483648
> str(y)
 num 2.15e+09

No coercion is taking place, so the memory overhead is zero:

> profmem::profmem(y <- matrixStats::sum2(x, mode = "double"))
Rprofmem memory profiling of:
y <- matrixStats::sum2(x, mode = "double")

Memory allocations:
      bytes calls
total     0

/Henrik

On Fri, Jun 2, 2017 at 1:58 PM, Henrik Bengtsson
<henrik.bengtsson at gmail.com> wrote:
> I second this feature request (it's understandable that this and
> possibly other parts of the code was left behind / forgotten after the
> introduction of long vector).
>
> I think mean() avoids full copies, so in the meanwhile, you can work
> around this limitation using:
>
> countTRUE <- function(x, na.rm = FALSE) {
>   nx <- length(x)
>   if (nx < .Machine$integer.max) return(sum(x, na.rm = na.rm))
>   nx * mean(x, na.rm = na.rm)
> }
>
> (not sure if one needs to worry about rounding errors, i.e. where n %% 0 != 0)
>
> x <- rep(TRUE, times = .Machine$integer.max+1)
> object.size(x)
> ## 8589934632 bytes
>
> p <- profmem::profmem( n <- countTRUE(x) )
> str(n)
> ## num 2.15e+09
> print(n == .Machine$integer.max + 1)
> ## [1] TRUE
>
> print(p)
> ## Rprofmem memory profiling of:
> ## n <- countTRUE(x)
> ##
> ## Memory allocations:
> ##      bytes calls
> ## total     0
>
>
> FYI / related: I've just updated matrixStats::sum2() to support
> logicals (develop branch) and I'll also try to update
> matrixStats::count() to count beyond .Machine$integer.max.
>
> /Henrik
>
> On Fri, Jun 2, 2017 at 4:05 AM, Herv? Pag?s <hpages at fredhutch.org> wrote:
>> Hi,
>>
>> I have a long numeric vector 'xx' and I want to use sum() to count
>> the number of elements that satisfy some criteria like non-zero
>> values or values lower than a certain threshold etc...
>>
>> The problem is: sum() returns an NA (with a warning) if the count
>> is greater than 2^31. For example:
>>
>>   > xx <- runif(3e9)
>>   > sum(xx < 0.9)
>>   [1] NA
>>   Warning message:
>>   In sum(xx < 0.9) : integer overflow - use sum(as.numeric(.))
>>
>> This already takes a long time and doing sum(as.numeric(.)) would
>> take even longer and require allocation of 24Gb of memory just to
>> store an intermediate numeric vector made of 0s and 1s. Plus, having
>> to do sum(as.numeric(.)) every time I need to count things is not
>> convenient and is easy to forget.
>>
>> It seems that sum() on a logical vector could be modified to return
>> the count as a double when it cannot be represented as an integer.
>> Note that length() already does this so that wouldn't create a
>> precedent. Also and FWIW prod() avoids the problem by always returning
>> a double, whatever the type of the input is (except on a complex
>> vector).
>>
>> I can provide a patch if this change sounds reasonable.
>>
>> Cheers,
>> H.
>>
>> --
>> Herv? Pag?s
>>
>> Program in Computational Biology
>> Division of Public Health Sciences
>> Fred Hutchinson Cancer Research Center
>> 1100 Fairview Ave. N, M1-B514
>> P.O. Box 19024
>> Seattle, WA 98109-1024
>>
>> E-mail: hpages at fredhutch.org
>> Phone:  (206) 667-5791
>> Fax:    (206) 667-1319
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel


From jtelleria.rproject at gmail.com  Thu Jan 25 22:40:54 2018
From: jtelleria.rproject at gmail.com (Juan Telleria Ruiz de Aguirre)
Date: Thu, 25 Jan 2018 22:40:54 +0100
Subject: [Rd] Why R should never move to git
In-Reply-To: <CALEXWq2SXYXE=3fh2kPmObrtD9JP1GO59fo9PUPPJvM+ty43jg@mail.gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
 <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
 <CALEXWq0ye7Y2Fw2F-bVKYw-ERkQjK-ia7bAryE9hy7y+qT-A9Q@mail.gmail.com>
 <d8ead98b-fe87-2cf1-4efc-ad900fe395bc@gmail.com>
 <CABtg=K=aQHFcKc20+7frnjFxy1ZKhsNWz1y4ADfHK_sJ2-6LXw@mail.gmail.com>
 <84899329-f439-7210-6444-e129cb2ebc91@gmail.com>
 <CALEXWq2SXYXE=3fh2kPmObrtD9JP1GO59fo9PUPPJvM+ty43jg@mail.gmail.com>
Message-ID: <CAJXDcw2igXYZh9LfrpdUtb72ssz3hJz7FtwOX19XO04SG1Pc3w@mail.gmail.com>

If you ever need to document issues / coding recipes related to GIT / SVN:

* I could pick the commands from e-mails.
* Any documentation you send me.
* Or books (http://shop.oreilly.com/product/0636920022862.do), web pages,
etc..

And create a wiki / documentation page in any platform, in order to help.

Best,
Juan

	[[alternative HTML version deleted]]


From jtelleria.rproject at gmail.com  Thu Jan 25 22:42:15 2018
From: jtelleria.rproject at gmail.com (Juan Telleria Ruiz de Aguirre)
Date: Thu, 25 Jan 2018 22:42:15 +0100
Subject: [Rd] Why R should never move to git
In-Reply-To: <CAJXDcw2igXYZh9LfrpdUtb72ssz3hJz7FtwOX19XO04SG1Pc3w@mail.gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
 <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
 <CALEXWq0ye7Y2Fw2F-bVKYw-ERkQjK-ia7bAryE9hy7y+qT-A9Q@mail.gmail.com>
 <d8ead98b-fe87-2cf1-4efc-ad900fe395bc@gmail.com>
 <CABtg=K=aQHFcKc20+7frnjFxy1ZKhsNWz1y4ADfHK_sJ2-6LXw@mail.gmail.com>
 <84899329-f439-7210-6444-e129cb2ebc91@gmail.com>
 <CALEXWq2SXYXE=3fh2kPmObrtD9JP1GO59fo9PUPPJvM+ty43jg@mail.gmail.com>
 <CAJXDcw2igXYZh9LfrpdUtb72ssz3hJz7FtwOX19XO04SG1Pc3w@mail.gmail.com>
Message-ID: <CAJXDcw07Ckm41eMpvTzaCUBJbMjmeKRF-jcuoViFAoyDsQRbqA@mail.gmail.com>

I do not mind investing as much time as necessary :-)

> If you ever need to document issues / coding recipes related to GIT / SVN:
>
> * I could pick the commands from e-mails.
> * Any documentation you send me.
> * Or books (http://shop.oreilly.com/product/0636920022862.do), web pages,
etc..
>
> And create a wiki / documentation page in any platform, in order to help.
>
> Best,
> Juan

	[[alternative HTML version deleted]]


From bbolker at gmail.com  Fri Jan 26 01:41:40 2018
From: bbolker at gmail.com (Ben Bolker)
Date: Thu, 25 Jan 2018 19:41:40 -0500
Subject: [Rd] bugzilla issues
Message-ID: <d9f6af23-b9b0-506a-51ae-8c97077ba3ad@gmail.com>


 tl;dr is the R bug tracker down or am I being an idiot? Help please ...

----
 I decided I would follow up on

https://stat.ethz.ch/pipermail/r-devel/2018-January/075410.html

(reporting/suggesting a patch for an issue in stats::mantelhaen.test()
with large data sets)

  Reading the instructions at https://www.r-project.org/bugs.html
suggests that if I'm sure I have found something worthy of posting to
the R bug tracker, I should go to https://bugs.r-project.org/bugzilla3

This results in

====
Software error:

Can't locate Email/Sender/Simple.pm in @INC (you may need to install the
Email::Sender::Simple module) (@INC contains: .
lib/x86_64-linux-gnu-thread-multi lib /etc/perl
/usr/local/lib/x86_64-linux-gnu/perl/5.24.1 /usr/local/share/perl/5.24.1
/usr/lib/x86_64-linux-gnu/perl5/5.24 /usr/share/perl5
/usr/lib/x86_64-linux-gnu/perl/5.24 /usr/share/perl/5.24
/usr/local/lib/site_perl /usr/lib/x86_64-linux-gnu/perl-base) at
Bugzilla/Mailer.pm line 26.
BEGIN failed--compilation aborted at Bugzilla/Mailer.pm line 26.
Compilation failed in require at Bugzilla/Auth.pm line 22.
BEGIN failed--compilation aborted at Bugzilla/Auth.pm line 22.
Compilation failed in require at Bugzilla.pm line 23.
BEGIN failed--compilation aborted at Bugzilla.pm line 23.
Compilation failed in require at /var/lib/bugzilla4/index.cgi line 15.
BEGIN failed--compilation aborted at /var/lib/bugzilla4/index.cgi line 15.

For help, please send mail to the webmaster (admin at rforge.net), giving
this error message and the time and date of the error.
===

e-mailing admin at rforge.net bounces with

This is the mail system at host hagal.urbanek.info.

I'm sorry to have to inform you that your message could not
be delivered to one or more recipients. It's attached below.

For further assistance, please send mail to postmaster.

If you do so, please include this problem report. You can
delete your own text from the attached returned message.

                   The mail system

<catchall at hagal.urbanek.info>: User unknown in virtual alias table
=====


From r-devel at akersting.de  Fri Jan 26 08:56:22 2018
From: r-devel at akersting.de (Andreas Kersting)
Date: Fri, 26 Jan 2018 08:56:22 +0100
Subject: [Rd] utils::install.packages with quiet=TRUE fails for source
 packages on Windows
Message-ID: <12f4f428-a424-404b-eee4-e01af07758c3@akersting.de>

Hi,

Installing a source package on Windows using utils::install.packages() 
with quiet=TRUE fails, while it works with the default quiet = FALSE. 
The problem seems to be caused by the fact that when quiet = TRUE, 
stdout and stderr are set to FALSE when calling "R CMD INSTALL" with 
base::system2() here: 
https://github.com/wch/r-source/blob/tags/R-3-4-3/src/library/utils/R/packages2.R#L660-L661.

> trace(base::system2, quote(print(ls.str())))
Tracing function "system2" in package "base"
[1] "system2"


> utils::install.packages("partDF_1.0.0.9001.tar.gz", repos = NULL, lib 
= tempdir(), quiet = TRUE)
Tracing system2(cmd0, args, env = env, stdout = output, stderr = output) 
on entry
args :  chr [1:5] "CMD" "INSTALL" "-l" 
"\"C:\\Users\\askers\\AppData\\Local\\Temp\\RtmpoRb97l\"" ...
command :  chr "C:/PROGRA~1/R/R-34~1.3/bin/x64/R"
env :  chr(0)
input :  NULL
invisible :  logi TRUE
minimized :  logi FALSE
stderr :  logi FALSE
stdin :  chr ""
stdout :  logi FALSE
wait :  logi TRUE
Warning messages:
1: running command '"C:/PROGRA~1/R/R-34~1.3/bin/x64/R" CMD INSTALL -l 
"C:\Users\askers\AppData\Local\Temp\RtmpoRb97l" 
"partDF_1.0.0.9001.tar.gz"' had status 1
2: In utils::install.packages("partDF_1.0.0.9001.tar.gz", repos = NULL,  :
   installation of package 'partDF_1.0.0.9001.tar.gz' had non-zero exit 
status


> utils::install.packages("partDF_1.0.0.9001.tar.gz", repos = NULL, lib 
= tempdir(), quiet = FALSE)
Tracing system2(cmd0, args, env = env, stdout = output, stderr = output) 
on entry
args :  chr [1:5] "CMD" "INSTALL" "-l" 
"\"C:\\Users\\askers\\AppData\\Local\\Temp\\RtmpoRb97l\"" ...
command :  chr "C:/PROGRA~1/R/R-34~1.3/bin/x64/R"
env :  chr(0)
input :  NULL
invisible :  logi TRUE
minimized :  logi FALSE
stderr :  chr ""
stdin :  chr ""
stdout :  chr ""
wait :  logi TRUE
* installing *source* package 'partDF' ...
** libs
c:/Rtools/mingw_64/bin/gcc  -I"C:/PROGRA~1/R/R-34~1.3/include" -DNDEBUG 
        -O2 -Wall  -std=gnu99 -mtune=generic -c partDF.c -o partDF.o
c:/Rtools/mingw_64/bin/gcc -shared -s -static-libgcc -o partDF.dll 
tmp.def partDF.o -LC:/PROGRA~1/R/R-34~1.3/bin/x64 -lR
installing to C:/Users/askers/AppData/Local/Temp/RtmpoRb97l/partDF/libs/x64
** R
** inst
** byte-compile and prepare package for lazy loading
** help
*** installing help indices
   converting help for package 'partDF'
     finding HTML links ... done
     anti_glob                               html
     partDF                                  html
     read_partDF                             html
     write_partDF                            html
** building package indices
** testing if installed package can be loaded
* DONE (partDF)
In R CMD INSTALL


> sessionInfo()
R version 3.4.3 (2017-11-30)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows >= 8 x64 (build 9200)

Matrix products: default

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252 
LC_MONETARY=German_Germany.1252
[4] LC_NUMERIC=C                    LC_TIME=German_Germany.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] compiler_3.4.3 tools_3.4.3    yaml_2.1.16


This problem is also there when installing source packages from CRAN:

> utils::install.packages("mvtnorm", lib = tempdir(), quiet = TRUE)

   There is a binary version available but the source version is later:
         binary source needs_compilation
mvtnorm  1.0-6  1.0-7              TRUE

Do you want to install from sources the package which needs compilation?
y/n: y
installing the source package 'mvtnorm'

Tracing system2(cmd0, args, env = env, stdout = outfile, stderr = 
outfile) on entry
args :  Named chr [1:5] "CMD" "INSTALL" "-l" 
"\"C:\\Users\\askers\\AppData\\Local\\Temp\\RtmpoRb97l\"" ...
command :  chr "C:/PROGRA~1/R/R-34~1.3/bin/x64/R"
env :  chr(0)
input :  NULL
invisible :  logi TRUE
minimized :  logi FALSE
stderr :  logi FALSE
stdin :  chr ""
stdout :  logi FALSE
wait :  logi TRUE
Warning messages:
1: running command '"C:/PROGRA~1/R/R-34~1.3/bin/x64/R" CMD INSTALL -l 
"C:\Users\askers\AppData\Local\Temp\RtmpoRb97l" 
C:\Users\askers\AppData\Local\Temp\RtmpoRb97l/downloaded_packages/mvtnorm_1.0-7.tar.gz' 
had status 1
2: In utils::install.packages("mvtnorm", lib = tempdir(), quiet = TRUE) :
   installation of package 'mvtnorm' had non-zero exit status



I do not encounter this problem on my Linux machine.

Andreas


From r-devel at akersting.de  Fri Jan 26 09:17:26 2018
From: r-devel at akersting.de (Andreas Kersting)
Date: Fri, 26 Jan 2018 09:17:26 +0100
Subject: [Rd] utils::install.packages with quiet=TRUE fails for source
 packages on Windows
In-Reply-To: <12f4f428-a424-404b-eee4-e01af07758c3@akersting.de>
References: <12f4f428-a424-404b-eee4-e01af07758c3@akersting.de>
Message-ID: <bd80b1f7-2f97-1640-3550-8dd14be2bf7b@akersting.de>

Just noticed that this problem only occurs from within RStudio 
(v1.1.414). Any ideas why?

Am 26.01.2018 um 08:56 schrieb Andreas Kersting:
> Hi,
> 
> Installing a source package on Windows using utils::install.packages() 
> with quiet=TRUE fails, while it works with the default quiet = FALSE. 
> The problem seems to be caused by the fact that when quiet = TRUE, 
> stdout and stderr are set to FALSE when calling "R CMD INSTALL" with 
> base::system2() here: 
> https://github.com/wch/r-source/blob/tags/R-3-4-3/src/library/utils/R/packages2.R#L660-L661. 
> 
> 
>> trace(base::system2, quote(print(ls.str())))
> Tracing function "system2" in package "base"
> [1] "system2"
> 
> 
>> utils::install.packages("partDF_1.0.0.9001.tar.gz", repos = NULL, lib 
> = tempdir(), quiet = TRUE)
> Tracing system2(cmd0, args, env = env, stdout = output, stderr = output) 
> on entry
> args :? chr [1:5] "CMD" "INSTALL" "-l" 
> "\"C:\\Users\\askers\\AppData\\Local\\Temp\\RtmpoRb97l\"" ...
> command :? chr "C:/PROGRA~1/R/R-34~1.3/bin/x64/R"
> env :? chr(0)
> input :? NULL
> invisible :? logi TRUE
> minimized :? logi FALSE
> stderr :? logi FALSE
> stdin :? chr ""
> stdout :? logi FALSE
> wait :? logi TRUE
> Warning messages:
> 1: running command '"C:/PROGRA~1/R/R-34~1.3/bin/x64/R" CMD INSTALL -l 
> "C:\Users\askers\AppData\Local\Temp\RtmpoRb97l" 
> "partDF_1.0.0.9001.tar.gz"' had status 1
> 2: In utils::install.packages("partDF_1.0.0.9001.tar.gz", repos = NULL,? :
>  ? installation of package 'partDF_1.0.0.9001.tar.gz' had non-zero exit 
> status
> 
> 
>> utils::install.packages("partDF_1.0.0.9001.tar.gz", repos = NULL, lib 
> = tempdir(), quiet = FALSE)
> Tracing system2(cmd0, args, env = env, stdout = output, stderr = output) 
> on entry
> args :? chr [1:5] "CMD" "INSTALL" "-l" 
> "\"C:\\Users\\askers\\AppData\\Local\\Temp\\RtmpoRb97l\"" ...
> command :? chr "C:/PROGRA~1/R/R-34~1.3/bin/x64/R"
> env :? chr(0)
> input :? NULL
> invisible :? logi TRUE
> minimized :? logi FALSE
> stderr :? chr ""
> stdin :? chr ""
> stdout :? chr ""
> wait :? logi TRUE
> * installing *source* package 'partDF' ...
> ** libs
> c:/Rtools/mingw_64/bin/gcc? -I"C:/PROGRA~1/R/R-34~1.3/include" -DNDEBUG 
>  ?????? -O2 -Wall? -std=gnu99 -mtune=generic -c partDF.c -o partDF.o
> c:/Rtools/mingw_64/bin/gcc -shared -s -static-libgcc -o partDF.dll 
> tmp.def partDF.o -LC:/PROGRA~1/R/R-34~1.3/bin/x64 -lR
> installing to C:/Users/askers/AppData/Local/Temp/RtmpoRb97l/partDF/libs/x64
> ** R
> ** inst
> ** byte-compile and prepare package for lazy loading
> ** help
> *** installing help indices
>  ? converting help for package 'partDF'
>  ??? finding HTML links ... done
>  ??? anti_glob?????????????????????????????? html
>  ??? partDF????????????????????????????????? html
>  ??? read_partDF???????????????????????????? html
>  ??? write_partDF??????????????????????????? html
> ** building package indices
> ** testing if installed package can be loaded
> * DONE (partDF)
> In R CMD INSTALL
> 
> 
>> sessionInfo()
> R version 3.4.3 (2017-11-30)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows >= 8 x64 (build 9200)
> 
> Matrix products: default
> 
> locale:
> [1] LC_COLLATE=German_Germany.1252? LC_CTYPE=German_Germany.1252 
> LC_MONETARY=German_Germany.1252
> [4] LC_NUMERIC=C??????????????????? LC_TIME=German_Germany.1252
> 
> attached base packages:
> [1] stats???? graphics? grDevices utils???? datasets? methods?? base
> 
> loaded via a namespace (and not attached):
> [1] compiler_3.4.3 tools_3.4.3??? yaml_2.1.16
> 
> 
> This problem is also there when installing source packages from CRAN:
> 
>> utils::install.packages("mvtnorm", lib = tempdir(), quiet = TRUE)
> 
>  ? There is a binary version available but the source version is later:
>  ??????? binary source needs_compilation
> mvtnorm? 1.0-6? 1.0-7????????????? TRUE
> 
> Do you want to install from sources the package which needs compilation?
> y/n: y
> installing the source package 'mvtnorm'
> 
> Tracing system2(cmd0, args, env = env, stdout = outfile, stderr = 
> outfile) on entry
> args :? Named chr [1:5] "CMD" "INSTALL" "-l" 
> "\"C:\\Users\\askers\\AppData\\Local\\Temp\\RtmpoRb97l\"" ...
> command :? chr "C:/PROGRA~1/R/R-34~1.3/bin/x64/R"
> env :? chr(0)
> input :? NULL
> invisible :? logi TRUE
> minimized :? logi FALSE
> stderr :? logi FALSE
> stdin :? chr ""
> stdout :? logi FALSE
> wait :? logi TRUE
> Warning messages:
> 1: running command '"C:/PROGRA~1/R/R-34~1.3/bin/x64/R" CMD INSTALL -l 
> "C:\Users\askers\AppData\Local\Temp\RtmpoRb97l" 
> C:\Users\askers\AppData\Local\Temp\RtmpoRb97l/downloaded_packages/mvtnorm_1.0-7.tar.gz' 
> had status 1
> 2: In utils::install.packages("mvtnorm", lib = tempdir(), quiet = TRUE) :
>  ? installation of package 'mvtnorm' had non-zero exit status
> 
> 
> 
> I do not encounter this problem on my Linux machine.
> 
> Andreas
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From ligges at statistik.tu-dortmund.de  Fri Jan 26 09:40:59 2018
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Fri, 26 Jan 2018 09:40:59 +0100
Subject: [Rd] bugzilla issues
In-Reply-To: <d9f6af23-b9b0-506a-51ae-8c97077ba3ad@gmail.com>
References: <d9f6af23-b9b0-506a-51ae-8c97077ba3ad@gmail.com>
Message-ID: <394b8581-4189-fcc9-27ae-86501db05838@statistik.tu-dortmund.de>

Simon,

can you take a look, please?

Best,
Uwe



On 26.01.2018 01:41, Ben Bolker wrote:
> 
>   tl;dr is the R bug tracker down or am I being an idiot? Help please ...
> 
> ----
>   I decided I would follow up on
> 
> https://stat.ethz.ch/pipermail/r-devel/2018-January/075410.html
> 
> (reporting/suggesting a patch for an issue in stats::mantelhaen.test()
> with large data sets)
> 
>    Reading the instructions at https://www.r-project.org/bugs.html
> suggests that if I'm sure I have found something worthy of posting to
> the R bug tracker, I should go to https://bugs.r-project.org/bugzilla3
> 
> This results in
> 
> ====
> Software error:
> 
> Can't locate Email/Sender/Simple.pm in @INC (you may need to install the
> Email::Sender::Simple module) (@INC contains: .
> lib/x86_64-linux-gnu-thread-multi lib /etc/perl
> /usr/local/lib/x86_64-linux-gnu/perl/5.24.1 /usr/local/share/perl/5.24.1
> /usr/lib/x86_64-linux-gnu/perl5/5.24 /usr/share/perl5
> /usr/lib/x86_64-linux-gnu/perl/5.24 /usr/share/perl/5.24
> /usr/local/lib/site_perl /usr/lib/x86_64-linux-gnu/perl-base) at
> Bugzilla/Mailer.pm line 26.
> BEGIN failed--compilation aborted at Bugzilla/Mailer.pm line 26.
> Compilation failed in require at Bugzilla/Auth.pm line 22.
> BEGIN failed--compilation aborted at Bugzilla/Auth.pm line 22.
> Compilation failed in require at Bugzilla.pm line 23.
> BEGIN failed--compilation aborted at Bugzilla.pm line 23.
> Compilation failed in require at /var/lib/bugzilla4/index.cgi line 15.
> BEGIN failed--compilation aborted at /var/lib/bugzilla4/index.cgi line 15.
> 
> For help, please send mail to the webmaster (admin at rforge.net), giving
> this error message and the time and date of the error.
> ===
> 
> e-mailing admin at rforge.net bounces with
> 
> This is the mail system at host hagal.urbanek.info.
> 
> I'm sorry to have to inform you that your message could not
> be delivered to one or more recipients. It's attached below.
> 
> For further assistance, please send mail to postmaster.
> 
> If you do so, please include this problem report. You can
> delete your own text from the attached returned message.
> 
>                     The mail system
> 
> <catchall at hagal.urbanek.info>: User unknown in virtual alias table
> =====
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From pdalgd at gmail.com  Fri Jan 26 11:15:35 2018
From: pdalgd at gmail.com (peter dalgaard)
Date: Fri, 26 Jan 2018 11:15:35 +0100
Subject: [Rd] utils::install.packages with quiet=TRUE fails for source
 packages on Windows
In-Reply-To: <bd80b1f7-2f97-1640-3550-8dd14be2bf7b@akersting.de>
References: <12f4f428-a424-404b-eee4-e01af07758c3@akersting.de>
 <bd80b1f7-2f97-1640-3550-8dd14be2bf7b@akersting.de>
Message-ID: <26EDE174-CE20-4570-A2A5-F147A8E696EF@gmail.com>

The obvious guess would be that Rstudio is attempting something like redirecting output and getting itself confused. However, it is pretty clearly Their Problem, no? Rstudio has their own support infrastructure.

-pd


> On 26 Jan 2018, at 09:17 , Andreas Kersting <r-devel at akersting.de> wrote:
> 
> Just noticed that this problem only occurs from within RStudio (v1.1.414). Any ideas why?
> 
> Am 26.01.2018 um 08:56 schrieb Andreas Kersting:
>> Hi,
>> Installing a source package on Windows using utils::install.packages() with quiet=TRUE fails, while it works with the default quiet = FALSE. The problem seems to be caused by the fact that when quiet = TRUE, stdout and stderr are set to FALSE when calling "R CMD INSTALL" with base::system2() here: https://github.com/wch/r-source/blob/tags/R-3-4-3/src/library/utils/R/packages2.R#L660-L661. 
>>> trace(base::system2, quote(print(ls.str())))
>> Tracing function "system2" in package "base"
>> [1] "system2"
>>> utils::install.packages("partDF_1.0.0.9001.tar.gz", repos = NULL, lib 
>> = tempdir(), quiet = TRUE)
>> Tracing system2(cmd0, args, env = env, stdout = output, stderr = output) on entry
>> args :  chr [1:5] "CMD" "INSTALL" "-l" "\"C:\\Users\\askers\\AppData\\Local\\Temp\\RtmpoRb97l\"" ...
>> command :  chr "C:/PROGRA~1/R/R-34~1.3/bin/x64/R"
>> env :  chr(0)
>> input :  NULL
>> invisible :  logi TRUE
>> minimized :  logi FALSE
>> stderr :  logi FALSE
>> stdin :  chr ""
>> stdout :  logi FALSE
>> wait :  logi TRUE
>> Warning messages:
>> 1: running command '"C:/PROGRA~1/R/R-34~1.3/bin/x64/R" CMD INSTALL -l "C:\Users\askers\AppData\Local\Temp\RtmpoRb97l" "partDF_1.0.0.9001.tar.gz"' had status 1
>> 2: In utils::install.packages("partDF_1.0.0.9001.tar.gz", repos = NULL,  :
>>   installation of package 'partDF_1.0.0.9001.tar.gz' had non-zero exit status
>>> utils::install.packages("partDF_1.0.0.9001.tar.gz", repos = NULL, lib 
>> = tempdir(), quiet = FALSE)
>> Tracing system2(cmd0, args, env = env, stdout = output, stderr = output) on entry
>> args :  chr [1:5] "CMD" "INSTALL" "-l" "\"C:\\Users\\askers\\AppData\\Local\\Temp\\RtmpoRb97l\"" ...
>> command :  chr "C:/PROGRA~1/R/R-34~1.3/bin/x64/R"
>> env :  chr(0)
>> input :  NULL
>> invisible :  logi TRUE
>> minimized :  logi FALSE
>> stderr :  chr ""
>> stdin :  chr ""
>> stdout :  chr ""
>> wait :  logi TRUE
>> * installing *source* package 'partDF' ...
>> ** libs
>> c:/Rtools/mingw_64/bin/gcc  -I"C:/PROGRA~1/R/R-34~1.3/include" -DNDEBUG         -O2 -Wall  -std=gnu99 -mtune=generic -c partDF.c -o partDF.o
>> c:/Rtools/mingw_64/bin/gcc -shared -s -static-libgcc -o partDF.dll tmp.def partDF.o -LC:/PROGRA~1/R/R-34~1.3/bin/x64 -lR
>> installing to C:/Users/askers/AppData/Local/Temp/RtmpoRb97l/partDF/libs/x64
>> ** R
>> ** inst
>> ** byte-compile and prepare package for lazy loading
>> ** help
>> *** installing help indices
>>   converting help for package 'partDF'
>>     finding HTML links ... done
>>     anti_glob                               html
>>     partDF                                  html
>>     read_partDF                             html
>>     write_partDF                            html
>> ** building package indices
>> ** testing if installed package can be loaded
>> * DONE (partDF)
>> In R CMD INSTALL
>>> sessionInfo()
>> R version 3.4.3 (2017-11-30)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> Running under: Windows >= 8 x64 (build 9200)
>> Matrix products: default
>> locale:
>> [1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252 LC_MONETARY=German_Germany.1252
>> [4] LC_NUMERIC=C                    LC_TIME=German_Germany.1252
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> loaded via a namespace (and not attached):
>> [1] compiler_3.4.3 tools_3.4.3    yaml_2.1.16
>> This problem is also there when installing source packages from CRAN:
>>> utils::install.packages("mvtnorm", lib = tempdir(), quiet = TRUE)
>>   There is a binary version available but the source version is later:
>>         binary source needs_compilation
>> mvtnorm  1.0-6  1.0-7              TRUE
>> Do you want to install from sources the package which needs compilation?
>> y/n: y
>> installing the source package 'mvtnorm'
>> Tracing system2(cmd0, args, env = env, stdout = outfile, stderr = outfile) on entry
>> args :  Named chr [1:5] "CMD" "INSTALL" "-l" "\"C:\\Users\\askers\\AppData\\Local\\Temp\\RtmpoRb97l\"" ...
>> command :  chr "C:/PROGRA~1/R/R-34~1.3/bin/x64/R"
>> env :  chr(0)
>> input :  NULL
>> invisible :  logi TRUE
>> minimized :  logi FALSE
>> stderr :  logi FALSE
>> stdin :  chr ""
>> stdout :  logi FALSE
>> wait :  logi TRUE
>> Warning messages:
>> 1: running command '"C:/PROGRA~1/R/R-34~1.3/bin/x64/R" CMD INSTALL -l "C:\Users\askers\AppData\Local\Temp\RtmpoRb97l" C:\Users\askers\AppData\Local\Temp\RtmpoRb97l/downloaded_packages/mvtnorm_1.0-7.tar.gz' had status 1
>> 2: In utils::install.packages("mvtnorm", lib = tempdir(), quiet = TRUE) :
>>   installation of package 'mvtnorm' had non-zero exit status
>> I do not encounter this problem on my Linux machine.
>> Andreas
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>> 
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
Peter Dalgaard, Professor,
Center for Statistics, Copenhagen Business School
Solbjerg Plads 3, 2000 Frederiksberg, Denmark
Phone: (+45)38153501
Office: A 4.23
Email: pd.mes at cbs.dk  Priv: PDalgd at gmail.com


From tomas.kalibera at gmail.com  Fri Jan 26 16:34:44 2018
From: tomas.kalibera at gmail.com (Tomas Kalibera)
Date: Fri, 26 Jan 2018 16:34:44 +0100
Subject: [Rd] Fortran programs not writing stdout on windows
In-Reply-To: <CABFfbXs5L6pLGcGaRs6S=UYRZkheep3aQvYUvpy-M=xgODRCxg@mail.gmail.com>
References: <CABFfbXs5L6pLGcGaRs6S=UYRZkheep3aQvYUvpy-M=xgODRCxg@mail.gmail.com>
Message-ID: <37518764-ace2-1432-ac48-84796fc4f9bd@gmail.com>

For reference, this has been fixed in R-devel, 74168. The problem only 
exists on Windows with RGui.

As a workaround for older versions of R, one can unset environment 
variables "GFORTRAN_STDOUT_UNIT" and "GFORTRAN_STDERR_UNIT" for the 
duration of system/system2 calls that invoke external Fortran programs.

Please note that while external code, which is run via system/system2, 
can be implemented in Fortran and use Fortran I/O to write to standard 
error and standard output, code that is linked against R is not allowed 
to do that. Mixing C and Fortran I/O is dangerous due to potentially 
incompatible runtimes. On Windows, with RGui, there is an additional 
problem that the output needs to go to the RGui console. So all output, 
at the lowest level, has to go through C functions Rprintf/REprintf. 
More details are in Writing R Extensions (Printing, Printing from FORTRAN).

Tomas

On 06/20/2017 12:52 PM, Jeroen Ooms wrote:
> A user has reported an issue that appears when a fortran executable is
> called via R on Windows. I am unsure if this expected behavior or a
> bug in Fortran or in how R calls Windows executables.
>
> The problem is that when the fortran program is called from R, stdout
> gets written to a file "fort.6" instead of stdout. When the same
> executable is called from the terminal it works fine and prints to
> stdout. This unexpected behavior is unfortunate for R wrappers that
> rely on captured output.
>
> A minimal example is available from github [1] and can be installed with
>
>     devtools::install_github("jeroen/ftest")
>     ftest::hello()
>
> When running ftest::hello() on linux, R will properly capture output.
> However on Windows it will return an empty string, and a file 'fort.6'
> gets created in the working directory instead.
>
> The executables can be found in: system.file("bin", package = "ftest")
>
> Interestingly if we open a command line terminal and run the same
> executable it prints output to stdout. So perhaps it has to do with
> the way R invokes CreateProcess() on Windows?
>
> [1] https://github.com/jeroen/ftest
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From r-devel at akersting.de  Fri Jan 26 20:39:27 2018
From: r-devel at akersting.de (Andreas Kersting)
Date: Fri, 26 Jan 2018 20:39:27 +0100
Subject: [Rd] utils::install.packages with quiet=TRUE fails for source
 packages on Windows
In-Reply-To: <26EDE174-CE20-4570-A2A5-F147A8E696EF@gmail.com>
References: <12f4f428-a424-404b-eee4-e01af07758c3@akersting.de>
 <bd80b1f7-2f97-1640-3550-8dd14be2bf7b@akersting.de>
 <26EDE174-CE20-4570-A2A5-F147A8E696EF@gmail.com>
Message-ID: <d3c64a9d-34e4-1a12-4a8a-593826a5b430@akersting.de>

I have filed a bug report here: 
https://github.com/rstudio/rstudio/issues/2070

-------- Original Message --------
From: peter dalgaard [mailto:pdalgd at gmail.com]
Sent: Friday, Jan 26, 2018 10:15 AM GMT
To: Andreas Kersting
Cc: r-devel at r-project.org
Subject: [Rd] utils::install.packages with quiet=TRUE fails for source 
packages on Windows

> The obvious guess would be that Rstudio is attempting something like redirecting output and getting itself confused. However, it is pretty clearly Their Problem, no? Rstudio has their own support infrastructure.
> 
> -pd
> 
> 
>> On 26 Jan 2018, at 09:17 , Andreas Kersting <r-devel at akersting.de> wrote:
>>
>> Just noticed that this problem only occurs from within RStudio (v1.1.414). Any ideas why?
>>
>> Am 26.01.2018 um 08:56 schrieb Andreas Kersting:
>>> Hi,
>>> Installing a source package on Windows using utils::install.packages() with quiet=TRUE fails, while it works with the default quiet = FALSE. The problem seems to be caused by the fact that when quiet = TRUE, stdout and stderr are set to FALSE when calling "R CMD INSTALL" with base::system2() here: https://github.com/wch/r-source/blob/tags/R-3-4-3/src/library/utils/R/packages2.R#L660-L661.
>>>> trace(base::system2, quote(print(ls.str())))
>>> Tracing function "system2" in package "base"
>>> [1] "system2"
>>>> utils::install.packages("partDF_1.0.0.9001.tar.gz", repos = NULL, lib
>>> = tempdir(), quiet = TRUE)
>>> Tracing system2(cmd0, args, env = env, stdout = output, stderr = output) on entry
>>> args :  chr [1:5] "CMD" "INSTALL" "-l" "\"C:\\Users\\askers\\AppData\\Local\\Temp\\RtmpoRb97l\"" ...
>>> command :  chr "C:/PROGRA~1/R/R-34~1.3/bin/x64/R"
>>> env :  chr(0)
>>> input :  NULL
>>> invisible :  logi TRUE
>>> minimized :  logi FALSE
>>> stderr :  logi FALSE
>>> stdin :  chr ""
>>> stdout :  logi FALSE
>>> wait :  logi TRUE
>>> Warning messages:
>>> 1: running command '"C:/PROGRA~1/R/R-34~1.3/bin/x64/R" CMD INSTALL -l "C:\Users\askers\AppData\Local\Temp\RtmpoRb97l" "partDF_1.0.0.9001.tar.gz"' had status 1
>>> 2: In utils::install.packages("partDF_1.0.0.9001.tar.gz", repos = NULL,  :
>>>    installation of package 'partDF_1.0.0.9001.tar.gz' had non-zero exit status
>>>> utils::install.packages("partDF_1.0.0.9001.tar.gz", repos = NULL, lib
>>> = tempdir(), quiet = FALSE)
>>> Tracing system2(cmd0, args, env = env, stdout = output, stderr = output) on entry
>>> args :  chr [1:5] "CMD" "INSTALL" "-l" "\"C:\\Users\\askers\\AppData\\Local\\Temp\\RtmpoRb97l\"" ...
>>> command :  chr "C:/PROGRA~1/R/R-34~1.3/bin/x64/R"
>>> env :  chr(0)
>>> input :  NULL
>>> invisible :  logi TRUE
>>> minimized :  logi FALSE
>>> stderr :  chr ""
>>> stdin :  chr ""
>>> stdout :  chr ""
>>> wait :  logi TRUE
>>> * installing *source* package 'partDF' ...
>>> ** libs
>>> c:/Rtools/mingw_64/bin/gcc  -I"C:/PROGRA~1/R/R-34~1.3/include" -DNDEBUG         -O2 -Wall  -std=gnu99 -mtune=generic -c partDF.c -o partDF.o
>>> c:/Rtools/mingw_64/bin/gcc -shared -s -static-libgcc -o partDF.dll tmp.def partDF.o -LC:/PROGRA~1/R/R-34~1.3/bin/x64 -lR
>>> installing to C:/Users/askers/AppData/Local/Temp/RtmpoRb97l/partDF/libs/x64
>>> ** R
>>> ** inst
>>> ** byte-compile and prepare package for lazy loading
>>> ** help
>>> *** installing help indices
>>>    converting help for package 'partDF'
>>>      finding HTML links ... done
>>>      anti_glob                               html
>>>      partDF                                  html
>>>      read_partDF                             html
>>>      write_partDF                            html
>>> ** building package indices
>>> ** testing if installed package can be loaded
>>> * DONE (partDF)
>>> In R CMD INSTALL
>>>> sessionInfo()
>>> R version 3.4.3 (2017-11-30)
>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>> Running under: Windows >= 8 x64 (build 9200)
>>> Matrix products: default
>>> locale:
>>> [1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252 LC_MONETARY=German_Germany.1252
>>> [4] LC_NUMERIC=C                    LC_TIME=German_Germany.1252
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>> loaded via a namespace (and not attached):
>>> [1] compiler_3.4.3 tools_3.4.3    yaml_2.1.16
>>> This problem is also there when installing source packages from CRAN:
>>>> utils::install.packages("mvtnorm", lib = tempdir(), quiet = TRUE)
>>>    There is a binary version available but the source version is later:
>>>          binary source needs_compilation
>>> mvtnorm  1.0-6  1.0-7              TRUE
>>> Do you want to install from sources the package which needs compilation?
>>> y/n: y
>>> installing the source package 'mvtnorm'
>>> Tracing system2(cmd0, args, env = env, stdout = outfile, stderr = outfile) on entry
>>> args :  Named chr [1:5] "CMD" "INSTALL" "-l" "\"C:\\Users\\askers\\AppData\\Local\\Temp\\RtmpoRb97l\"" ...
>>> command :  chr "C:/PROGRA~1/R/R-34~1.3/bin/x64/R"
>>> env :  chr(0)
>>> input :  NULL
>>> invisible :  logi TRUE
>>> minimized :  logi FALSE
>>> stderr :  logi FALSE
>>> stdin :  chr ""
>>> stdout :  logi FALSE
>>> wait :  logi TRUE
>>> Warning messages:
>>> 1: running command '"C:/PROGRA~1/R/R-34~1.3/bin/x64/R" CMD INSTALL -l "C:\Users\askers\AppData\Local\Temp\RtmpoRb97l" C:\Users\askers\AppData\Local\Temp\RtmpoRb97l/downloaded_packages/mvtnorm_1.0-7.tar.gz' had status 1
>>> 2: In utils::install.packages("mvtnorm", lib = tempdir(), quiet = TRUE) :
>>>    installation of package 'mvtnorm' had non-zero exit status
>>> I do not encounter this problem on my Linux machine.
>>> Andreas
>>> ______________________________________________
>>> R-devel at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>>
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From jtelleria.rproject at gmail.com  Fri Jan 26 21:19:37 2018
From: jtelleria.rproject at gmail.com (Juan Telleria Ruiz de Aguirre)
Date: Fri, 26 Jan 2018 21:19:37 +0100
Subject: [Rd] Why R should never move to git
In-Reply-To: <CALEXWq2SXYXE=3fh2kPmObrtD9JP1GO59fo9PUPPJvM+ty43jg@mail.gmail.com>
References: <10a2b81e-4d5d-e387-5e0d-bfe58fbf16ca@gmail.com>
 <CALEXWq0cwhKzuPhPu+ZRChBA0dQLT=s6HobPPDSFb7T9uEhD0w@mail.gmail.com>
 <cd23e17b-776f-ffb9-010b-e8b649e3d834@gmail.com>
 <CALEXWq0ye7Y2Fw2F-bVKYw-ERkQjK-ia7bAryE9hy7y+qT-A9Q@mail.gmail.com>
 <d8ead98b-fe87-2cf1-4efc-ad900fe395bc@gmail.com>
 <CABtg=K=aQHFcKc20+7frnjFxy1ZKhsNWz1y4ADfHK_sJ2-6LXw@mail.gmail.com>
 <84899329-f439-7210-6444-e129cb2ebc91@gmail.com>
 <CALEXWq2SXYXE=3fh2kPmObrtD9JP1GO59fo9PUPPJvM+ty43jg@mail.gmail.com>
Message-ID: <CAJXDcw2QOD0ZRYVmv6y-5f4ZjiU+-wef4d40m5xQf-cOfdr7FQ@mail.gmail.com>

In case it's useful:

A) Git Cheatsheet: ADVANCED (GitHub)

https://www.google.es/url?sa=t&source=web&rct=j&url=https://services.github.com/on-demand/downloads/github-git-cheat-sheet.pdf&ved=2ahUKEwjkhYmdt_bYAhXIwBQKHXWdBfoQFjAAegQIERAB&usg=AOvVaw3RoN21aynhcDHqKncV31el

B) Git Cheatsheet: BASICS (GitHub)

https://www.google.es/url?sa=t&source=web&rct=j&url=https://education.github.com/git-cheat-sheet-education.pdf&ved=2ahUKEwjkhYmdt_bYAhXIwBQKHXWdBfoQFjABegQIEhAB&usg=AOvVaw2D3W2R0fwoOBi8YrhZYLFJ

C) Git Cheatsheet (Atlassian)

https://www.google.es/url?sa=t&source=web&rct=j&url=https://www.atlassian.com/dam/jcr:8132028b-024f-4b6b-953e-e68fcce0c5fa/atlassian-git-cheatsheet.pdf&ved=2ahUKEwjkhYmdt_bYAhXIwBQKHXWdBfoQFjACegQIExAB&usg=AOvVaw2TdLUeHteS2YU_G9u_-6nP

	[[alternative HTML version deleted]]


From simon.urbanek at R-project.org  Fri Jan 26 23:02:09 2018
From: simon.urbanek at R-project.org (Simon Urbanek)
Date: Fri, 26 Jan 2018 17:02:09 -0500
Subject: [Rd] bugzilla issues
In-Reply-To: <394b8581-4189-fcc9-27ae-86501db05838@statistik.tu-dortmund.de>
References: <d9f6af23-b9b0-506a-51ae-8c97077ba3ad@gmail.com>
 <394b8581-4189-fcc9-27ae-86501db05838@statistik.tu-dortmund.de>
Message-ID: <11540014-C7E1-4C7B-B816-4F9DC14F4C6B@R-project.org>

Thanks, fixed.
Simon


> On Jan 26, 2018, at 3:40 AM, Uwe Ligges <ligges at statistik.tu-dortmund.de> wrote:
> 
> Simon,
> 
> can you take a look, please?
> 
> Best,
> Uwe
> 
> 
> 
> On 26.01.2018 01:41, Ben Bolker wrote:
>>  tl;dr is the R bug tracker down or am I being an idiot? Help please ...
>> ----
>>  I decided I would follow up on
>> https://stat.ethz.ch/pipermail/r-devel/2018-January/075410.html
>> (reporting/suggesting a patch for an issue in stats::mantelhaen.test()
>> with large data sets)
>>   Reading the instructions at https://www.r-project.org/bugs.html
>> suggests that if I'm sure I have found something worthy of posting to
>> the R bug tracker, I should go to https://bugs.r-project.org/bugzilla3
>> This results in
>> ====
>> Software error:
>> Can't locate Email/Sender/Simple.pm in @INC (you may need to install the
>> Email::Sender::Simple module) (@INC contains: .
>> lib/x86_64-linux-gnu-thread-multi lib /etc/perl
>> /usr/local/lib/x86_64-linux-gnu/perl/5.24.1 /usr/local/share/perl/5.24.1
>> /usr/lib/x86_64-linux-gnu/perl5/5.24 /usr/share/perl5
>> /usr/lib/x86_64-linux-gnu/perl/5.24 /usr/share/perl/5.24
>> /usr/local/lib/site_perl /usr/lib/x86_64-linux-gnu/perl-base) at
>> Bugzilla/Mailer.pm line 26.
>> BEGIN failed--compilation aborted at Bugzilla/Mailer.pm line 26.
>> Compilation failed in require at Bugzilla/Auth.pm line 22.
>> BEGIN failed--compilation aborted at Bugzilla/Auth.pm line 22.
>> Compilation failed in require at Bugzilla.pm line 23.
>> BEGIN failed--compilation aborted at Bugzilla.pm line 23.
>> Compilation failed in require at /var/lib/bugzilla4/index.cgi line 15.
>> BEGIN failed--compilation aborted at /var/lib/bugzilla4/index.cgi line 15.
>> For help, please send mail to the webmaster (admin at rforge.net), giving
>> this error message and the time and date of the error.
>> ===
>> e-mailing admin at rforge.net bounces with
>> This is the mail system at host hagal.urbanek.info.
>> I'm sorry to have to inform you that your message could not
>> be delivered to one or more recipients. It's attached below.
>> For further assistance, please send mail to postmaster.
>> If you do so, please include this problem report. You can
>> delete your own text from the attached returned message.
>>                    The mail system
>> <catchall at hagal.urbanek.info>: User unknown in virtual alias table
>> =====
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
> 


From maechler at stat.math.ethz.ch  Sat Jan 27 12:06:25 2018
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Sat, 27 Jan 2018 12:06:25 +0100
Subject: [Rd] sum() returns NA on a long *logical* vector when nb of
 TRUE values exceeds 2^31
In-Reply-To: <CAFDcVCQv19O2zBybkRHh6G58AMa0GjQRZcHnD3WEnQACnuM7Uw@mail.gmail.com>
References: <5931466B.1060407@fredhutch.org>
 <CAFDcVCRt1=-1t8=-x5TLhe3y0T_tpZUkTAH1W-hyMKqFH-eJYg@mail.gmail.com>
 <CAFDcVCQv19O2zBybkRHh6G58AMa0GjQRZcHnD3WEnQACnuM7Uw@mail.gmail.com>
Message-ID: <23148.23857.970768.727765@stat.math.ethz.ch>

>>>>> Henrik Bengtsson <henrik.bengtsson at gmail.com>
>>>>>     on Thu, 25 Jan 2018 09:30:42 -0800 writes:

    > Just following up on this old thread since matrixStats 0.53.0 is now
    > out, which supports this use case:

    >> x <- rep(TRUE, times = 2^31)

    >> y <- sum(x)
    >> y
    > [1] NA
    > Warning message:
    > In sum(x) : integer overflow - use sum(as.numeric(.))

    >> y <- matrixStats::sum2(x, mode = "double")
    >> y
    > [1] 2147483648
    >> str(y)
    > num 2.15e+09

    > No coercion is taking place, so the memory overhead is zero:

    >> profmem::profmem(y <- matrixStats::sum2(x, mode = "double"))
    > Rprofmem memory profiling of:
    > y <- matrixStats::sum2(x, mode = "double")

    > Memory allocations:
    > bytes calls
    > total     0

    > /Henrik

Thank you, Henrik, for the reminder.

Back in June, I had mentioned to Herv? and R-devel that
'logical' should remain to be treated as 'integer' as in all
arithmetic in (S and) R.     Herv? did mention the isum()
function in the C code which is relevant here .. which does have
a LONG INT counter already -- *but* if we consider that sum()
has '...' i.e. a conceptually arbitrary number of long vector
integer arguments that counter won't suffice even there.

Before talking about implementation / patch, I think we should
consider 2 possible goals of a change --- I agree the status quo
is not a real option

1) sum(x) for logical and integer x  would return a double
      in any case and overflow should not happen (unless for
      the case where the result would be larger the
      .Machine$double.max which I think will not be possible
      even with "arbitrary" nargs() of sum.

2) sum(x) for logical and integer x  should return an integer in
       all cases there is no overflow, including returning
       NA_integer_ in case of NAs.
   If there would be an overflow it must be detected "in time"
   and the result should be double.

The big advantage of 2) is that it is back compatible in 99.x %
of use cases, and another advantage that it may be a very small
bit more efficient.  Also, in the case of "counting" (logical),
it is nice to get an integer instead of double when we can --
entirely analogously to the behavior of length() which returns
integer whenever possible.

The advantage of 1) is uniformity.

We should (at least provisionally) decide between 1) and 2) and then go for that.
It could be that going for 1) may have bad
compatibility-consequences in package space, because indeed we
had documented sum() would be integer for logical and integer arguments.

I currently don't really have time to
{work on implementing + dealing with the consequences}
for either ..

Martin

    > On Fri, Jun 2, 2017 at 1:58 PM, Henrik Bengtsson
    > <henrik.bengtsson at gmail.com> wrote:
    >> I second this feature request (it's understandable that this and
    >> possibly other parts of the code was left behind / forgotten after the
    >> introduction of long vector).
    >> 
    >> I think mean() avoids full copies, so in the meanwhile, you can work
    >> around this limitation using:
    >> 
    >> countTRUE <- function(x, na.rm = FALSE) {
    >> nx <- length(x)
    >> if (nx < .Machine$integer.max) return(sum(x, na.rm = na.rm))
    >> nx * mean(x, na.rm = na.rm)
    >> }
    >> 
    >> (not sure if one needs to worry about rounding errors, i.e. where n %% 0 != 0)
    >> 
    >> x <- rep(TRUE, times = .Machine$integer.max+1)
    >> object.size(x)
    >> ## 8589934632 bytes
    >> 
    >> p <- profmem::profmem( n <- countTRUE(x) )
    >> str(n)
    >> ## num 2.15e+09
    >> print(n == .Machine$integer.max + 1)
    >> ## [1] TRUE
    >> 
    >> print(p)
    >> ## Rprofmem memory profiling of:
    >> ## n <- countTRUE(x)
    >> ##
    >> ## Memory allocations:
    >> ##      bytes calls
    >> ## total     0
    >> 
    >> 
    >> FYI / related: I've just updated matrixStats::sum2() to support
    >> logicals (develop branch) and I'll also try to update
    >> matrixStats::count() to count beyond .Machine$integer.max.
    >> 
    >> /Henrik
    >> 
    >> On Fri, Jun 2, 2017 at 4:05 AM, Herv? Pag?s <hpages at fredhutch.org> wrote:
    >>> Hi,
    >>> 
    >>> I have a long numeric vector 'xx' and I want to use sum() to count
    >>> the number of elements that satisfy some criteria like non-zero
    >>> values or values lower than a certain threshold etc...
    >>> 
    >>> The problem is: sum() returns an NA (with a warning) if the count
    >>> is greater than 2^31. For example:
    >>> 
    >>> > xx <- runif(3e9)
    >>> > sum(xx < 0.9)
    >>> [1] NA
    >>> Warning message:
    >>> In sum(xx < 0.9) : integer overflow - use sum(as.numeric(.))
    >>> 
    >>> This already takes a long time and doing sum(as.numeric(.)) would
    >>> take even longer and require allocation of 24Gb of memory just to
    >>> store an intermediate numeric vector made of 0s and 1s. Plus, having
    >>> to do sum(as.numeric(.)) every time I need to count things is not
    >>> convenient and is easy to forget.
    >>> 
    >>> It seems that sum() on a logical vector could be modified to return
    >>> the count as a double when it cannot be represented as an integer.
    >>> Note that length() already does this so that wouldn't create a
    >>> precedent. Also and FWIW prod() avoids the problem by always returning
    >>> a double, whatever the type of the input is (except on a complex
    >>> vector).
    >>> 
    >>> I can provide a patch if this change sounds reasonable.
    >>> 
    >>> Cheers,
    >>> H.
    >>> 
    >>> --
    >>> Herv? Pag?s


From spencer.graves at prodsyse.com  Sat Jan 27 17:17:11 2018
From: spencer.graves at prodsyse.com (Spencer Graves)
Date: Sat, 27 Jan 2018 10:17:11 -0600
Subject: [Rd] Searching R Packages
Message-ID: <2fc02637-8a2a-4d6d-bf14-b06ce86e42a8@prodsyse.com>

Hello, All:


	  Might you have time to review the article I recently posted to 
Wikiversity on "Searching R Packages" 
(https://en.wikiversity.org/wiki/Searching_R_Packages)?


	  Please edit this yourself or propose changes in the associated 
"Discuss" page or in an email to this list or to me.


	  My goal in this is to invite readers to turn that article into a 
proposal for improving the search capabilities in R that would 
ultimately be funded by, e.g., The R Foundation.


	  What do you think?


	  Please forward this to anyone you think might be interested.


	  Thanks for your contributions to improving the lot of humanity 
through better statistical software.


 ????? Best Wishes,
 ????? Spencer Graves, PhD
 ????? Founder
 ????? EffectiveDefense.org
 ????? 7300 W. 107th St. # 506
 ????? Overland Park, KS 66212


From henrik.bengtsson at gmail.com  Sun Jan 28 00:01:14 2018
From: henrik.bengtsson at gmail.com (Henrik Bengtsson)
Date: Sat, 27 Jan 2018 15:01:14 -0800
Subject: [Rd] R (>= 3.4.0): integer-to-double coercion in comparisons no
 longer done (a good thing)
Message-ID: <CAFDcVCR0nfUT+0d3-ipPBeavcYe=KuQTTZ5=wzQvo5nmbZtLLA@mail.gmail.com>

Hi,

there was a memory improvement done in R going from R 3.3.3 to R 3.4.0
when it comes to comparing an integer 'x' an double 'y' (either may be
scalar or vector).

For example, in R 3.3.3, I get:

> getRversion()
[1] '3.3.3'
> x <- integer(1000)
> y <- double(1000)
> profmem::profmem(z <- (x < y))
Rprofmem memory profiling of:
z <- (x < y)

Memory allocations:
      bytes      calls
1      8040 <internal>
2      4040 <internal>
total 12080
>

and in R 3.4.0, I get:

> getRversion()
[1] '3.4.0'
> x <- integer(1000)
> y <- double(1000)
> profmem::profmem(z <- (x < y))
Rprofmem memory profiling of:
z <- (x < y)

Memory allocations:
      bytes      calls
1      4040 <internal>
total  4040

Note how in R (<= 3.3.3), the (x < y) comparison will cause an
internal coercion of integer vector 'x' into a double, which then can
be compared to double 'y'.  In R (>= 3.4.0), it appears that this
coercion is done per element and will therefore avoid introducing a
new, temporary copy internally.  The same is observed with when
comparing with (x == y).

This is a great improvement that I think deserves more credit.  I
couldn't find any mentioning of it in the R 3.4.0 NEWS
(https://cran.r-project.org/doc/manuals/r-release/NEWS.html).  Does
anyone know whether this was a specific improvement for such
comparison, or a side effect of something else, e.g. an improved byte
compiler?

Thanks,

Henrik


From lawrence.michael at gene.com  Sun Jan 28 00:06:30 2018
From: lawrence.michael at gene.com (Michael Lawrence)
Date: Sat, 27 Jan 2018 15:06:30 -0800
Subject: [Rd] R (>= 3.4.0): integer-to-double coercion in comparisons no
 longer done (a good thing)
In-Reply-To: <CAFDcVCR0nfUT+0d3-ipPBeavcYe=KuQTTZ5=wzQvo5nmbZtLLA@mail.gmail.com>
References: <CAFDcVCR0nfUT+0d3-ipPBeavcYe=KuQTTZ5=wzQvo5nmbZtLLA@mail.gmail.com>
Message-ID: <CAOQ5NyeUXfm4zrHOiAbM0ESGv7_VLWaRVWwXDza1+ZqSa49x5A@mail.gmail.com>

Thanks for highlighting this. I just made the change one day. Guess I
should have mentioned it in the NEWS.

Michael

On Sat, Jan 27, 2018 at 3:01 PM, Henrik Bengtsson <
henrik.bengtsson at gmail.com> wrote:

> Hi,
>
> there was a memory improvement done in R going from R 3.3.3 to R 3.4.0
> when it comes to comparing an integer 'x' an double 'y' (either may be
> scalar or vector).
>
> For example, in R 3.3.3, I get:
>
> > getRversion()
> [1] '3.3.3'
> > x <- integer(1000)
> > y <- double(1000)
> > profmem::profmem(z <- (x < y))
> Rprofmem memory profiling of:
> z <- (x < y)
>
> Memory allocations:
>       bytes      calls
> 1      8040 <internal>
> 2      4040 <internal>
> total 12080
> >
>
> and in R 3.4.0, I get:
>
> > getRversion()
> [1] '3.4.0'
> > x <- integer(1000)
> > y <- double(1000)
> > profmem::profmem(z <- (x < y))
> Rprofmem memory profiling of:
> z <- (x < y)
>
> Memory allocations:
>       bytes      calls
> 1      4040 <internal>
> total  4040
>
> Note how in R (<= 3.3.3), the (x < y) comparison will cause an
> internal coercion of integer vector 'x' into a double, which then can
> be compared to double 'y'.  In R (>= 3.4.0), it appears that this
> coercion is done per element and will therefore avoid introducing a
> new, temporary copy internally.  The same is observed with when
> comparing with (x == y).
>
> This is a great improvement that I think deserves more credit.  I
> couldn't find any mentioning of it in the R 3.4.0 NEWS
> (https://cran.r-project.org/doc/manuals/r-release/NEWS.html).  Does
> anyone know whether this was a specific improvement for such
> comparison, or a side effect of something else, e.g. an improved byte
> compiler?
>
> Thanks,
>
> Henrik
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From ravi.varadhan at jhu.edu  Mon Jan 29 00:24:59 2018
From: ravi.varadhan at jhu.edu (Ravi Varadhan)
Date: Sun, 28 Jan 2018 23:24:59 +0000
Subject: [Rd] Searching R Packages
In-Reply-To: <2fc02637-8a2a-4d6d-bf14-b06ce86e42a8@prodsyse.com>
References: <2fc02637-8a2a-4d6d-bf14-b06ce86e42a8@prodsyse.com>
Message-ID: <1517181863567.45070@jhu.edu>

Hi Spencer,
Thank you for this wonderful service to the R community.

A suggestion:  it would be great to discuss how to search github and Bioconductor repositories.

Thanks,
Ravi 

________________________________________
From: R-devel <r-devel-bounces at r-project.org> on behalf of Spencer Graves <spencer.graves at prodsyse.com>
Sent: Saturday, January 27, 2018 11:17 AM
To: R-Devel
Subject: [Rd] Searching R Packages

Hello, All:


          Might you have time to review the article I recently posted to
Wikiversity on "Searching R Packages"
(https://en.wikiversity.org/wiki/Searching_R_Packages)?


          Please edit this yourself or propose changes in the associated
"Discuss" page or in an email to this list or to me.


          My goal in this is to invite readers to turn that article into a
proposal for improving the search capabilities in R that would
ultimately be funded by, e.g., The R Foundation.


          What do you think?


          Please forward this to anyone you think might be interested.


          Thanks for your contributions to improving the lot of humanity
through better statistical software.


       Best Wishes,
       Spencer Graves, PhD
       Founder
       EffectiveDefense.org
       7300 W. 107th St. # 506
       Overland Park, KS 66212

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel


From mark.vanderloo at gmail.com  Mon Jan 29 12:02:17 2018
From: mark.vanderloo at gmail.com (Mark van der Loo)
Date: Mon, 29 Jan 2018 11:02:17 +0000
Subject: [Rd] Searching R Packages
In-Reply-To: <1517181863567.45070@jhu.edu>
References: <2fc02637-8a2a-4d6d-bf14-b06ce86e42a8@prodsyse.com>
 <1517181863567.45070@jhu.edu>
Message-ID: <CAOKDuOj0YZw=1GaCfHBmmLZ2a59-hm+FTaNfc1f2M61A8RHyag@mail.gmail.com>

Dear Spencer,

Nice initiative!

I discover a lot of packages not by explicit search, but by running into
them. I find cranberries really helpful there, especially the twitter feed
(@CRANberries) and also r-bloggers, especially through Joseph Rickert's
monthly roundup of new packages. And then of course there is the R journal
and JSS, but those speak for themselves.

So maybe a 'keeping up to date' section would be nice in the article?

Best,
Mark





Op ma 29 jan. 2018 om 00:25 schreef Ravi Varadhan <ravi.varadhan at jhu.edu>:

> Hi Spencer,
> Thank you for this wonderful service to the R community.
>
> A suggestion:  it would be great to discuss how to search github and
> Bioconductor repositories.
>
> Thanks,
> Ravi
>
> ________________________________________
> From: R-devel <r-devel-bounces at r-project.org> on behalf of Spencer Graves
> <spencer.graves at prodsyse.com>
> Sent: Saturday, January 27, 2018 11:17 AM
> To: R-Devel
> Subject: [Rd] Searching R Packages
>
> Hello, All:
>
>
>           Might you have time to review the article I recently posted to
> Wikiversity on "Searching R Packages"
> (https://en.wikiversity.org/wiki/Searching_R_Packages)?
>
>
>           Please edit this yourself or propose changes in the associated
> "Discuss" page or in an email to this list or to me.
>
>
>           My goal in this is to invite readers to turn that article into a
> proposal for improving the search capabilities in R that would
> ultimately be funded by, e.g., The R Foundation.
>
>
>           What do you think?
>
>
>           Please forward this to anyone you think might be interested.
>
>
>           Thanks for your contributions to improving the lot of humanity
> through better statistical software.
>
>
>        Best Wishes,
>        Spencer Graves, PhD
>        Founder
>        EffectiveDefense.org
>        7300 W. 107th St. # 506
>        Overland Park, KS 66212
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From edd at debian.org  Mon Jan 29 13:20:25 2018
From: edd at debian.org (Dirk Eddelbuettel)
Date: Mon, 29 Jan 2018 06:20:25 -0600
Subject: [Rd] Searching R Packages
In-Reply-To: <CAOKDuOj0YZw=1GaCfHBmmLZ2a59-hm+FTaNfc1f2M61A8RHyag@mail.gmail.com>
References: <2fc02637-8a2a-4d6d-bf14-b06ce86e42a8@prodsyse.com>
 <1517181863567.45070@jhu.edu>
 <CAOKDuOj0YZw=1GaCfHBmmLZ2a59-hm+FTaNfc1f2M61A8RHyag@mail.gmail.com>
Message-ID: <23151.4489.326297.338251@rob.eddelbuettel.com>


On 29 January 2018 at 11:02, Mark van der Loo wrote:
| I discover a lot of packages not by explicit search, but by running into
| them. I find cranberries really helpful there, especially the twitter feed
| (@CRANberries) and also r-bloggers, especially through Joseph Rickert's
| monthly roundup of new packages. And then of course there is the R journal
| and JSS, but those speak for themselves.
| 
| So maybe a 'keeping up to date' section would be nice in the article?

Yes.  But it is @CRANberriesFeed --- the handle for @cranberries was already
taken by either fans of the Irish band, or the fruit ...

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From demetrio.rodriguez.t at gmail.com  Mon Jan 29 17:06:16 2018
From: demetrio.rodriguez.t at gmail.com (Demetrio Rodriguez T.)
Date: Mon, 29 Jan 2018 17:06:16 +0100
Subject: [Rd] bug [methods]: double execution of `insertSource` within the
 same session does not work
Message-ID: <CA+ZF6Z+z_tFLSq9KFy_6sX35gXRTr4qknSLELBX6GRLAck8SGw@mail.gmail.com>

Hello everyone,


I hope this reaches someone at all. It's my first bug report to the R-core,
and, apparently, bugzilla is locked from new reports for now.

I was using `methods::insertSource` to debug and successfully fix another
package, until it suddenly stopped working. I figured out, that it is
because I am using it on the same function multiple times within one
session. It also produces warnings even during the first call, but somehow
still works. Below I provide a reproducible example:

SETUP:
```bash
demetrio at laptop:[folder_structure]/Bugreports/methods_insertSource$ ls -a
.  ..  gmapsdistance_fix.R  methods_insertSource.R
```

file `gmapsdistance_fix.R`
```R
gmapsdistance = function(param) {
    print('I am a bug report, my params are:')
    print(param)
}
```


file `methods_insertSource.R`
```R
library(gmapsdistance)  # works with any package

methods::insertSource('gmapsdistance_fix.R',
    package = 'gmapsdistance',
    functions = 'gmapsdistance',
    force = T
)
buggy = gmapsdistance('Works?')
```


TO REPRODUCE:
in that directory `R --vanilla` then
```R
> source('methods_insertSource.R')
Modified functions inserted through trace(): gmapsdistance
[1] "I am a bug report, my params are:"
[1] "Works?"
Warning message:
In methods::insertSource("gmapsdistance_fix.R", package = "gmapsdistance",
:
  cannot insert these (not found in source): "gmapsdistance"
# Works, but gives the warning that it does not

# repeat:
> source('methods_insertSource.R')
Error in assign(this, thisObj, envir = envwhere) :
  cannot change value of locked binding for 'gmapsdistance'
In addition: Warning message:
In methods::insertSource("gmapsdistance_fix.R", package = "gmapsdistance",
:
  cannot insert these (not found in source): "gmapsdistance"

# does not work, and gets even more confusing: so is it that the object is
not find, or is it about a locked object?
```

I think it's a bug.

--------------------- BUG REPORT END ------------------------


I looked into it a bit myself, in case you are interested:

```R
# lines 20-22
    if (is(source, "environment"))
        env <- source
    else env <- evalSource(source, package, FALSE)
    # We're in the second case I guess

# Browse[2]> env
# Object of class "sourceEnvironment"
# Source environment created  2017-12-01 05:19:51
# For package "gmapsdistance"
# From source file "gmapsdistancefix.R"


# later, before line 52:
x = env
Browse[2]> package
[1] "gmapsdistance"

# evaluate 52
packageSlot(env) <- package

# objects x and env are still identical
# Browse[2]> class(env)
# [1] "sourceEnvironment"
# attr(,"package")
# [1] "methods"
# Browse[2]> class(x)
# [1] "sourceEnvironment"
# attr(,"package")
# [1] "methods"

# Browse[2]> env
# Object of class "sourceEnvironment"
# Source environment created  2017-12-01 05:19:51
# For package "gmapsdistance"
# From source file "gmapsdistancefix.R"
# Browse[2]> x
# Object of class "sourceEnvironment"
# Source environment created  2017-12-01 05:19:51
# For package "gmapsdistance"
# From source file "gmapsdistancefix.R"

# so:
Browse[2]>  names(env)
NULL

# which is why 53-60 do not work:
allObjects <- names(env)
if (!missing(functions)) {
    notThere <- is.na(match(functions, allObjects))
    if (any(notThere)) {
        warning(gettextf("cannot insert these (not found in source): %s",
            paste("\"", functions[notThere], "\"", sep = "",
                collapse = ", ")), domain = NA)
    }
}
```

Looking forward to your feedback!

Cheers,
Demetrio

	[[alternative HTML version deleted]]


From lawrence.michael at gene.com  Mon Jan 29 20:02:08 2018
From: lawrence.michael at gene.com (Michael Lawrence)
Date: Mon, 29 Jan 2018 11:02:08 -0800
Subject: [Rd] bug [methods]: double execution of `insertSource` within
 the same session does not work
In-Reply-To: <CA+ZF6Z+z_tFLSq9KFy_6sX35gXRTr4qknSLELBX6GRLAck8SGw@mail.gmail.com>
References: <CA+ZF6Z+z_tFLSq9KFy_6sX35gXRTr4qknSLELBX6GRLAck8SGw@mail.gmail.com>
Message-ID: <CAOQ5Nyf5MrBLfq2T-dRDDpfGxthqyv=wGthu7TxZy_f7JWTy4g@mail.gmail.com>

Thanks, I will fix this.

On Mon, Jan 29, 2018 at 8:06 AM, Demetrio Rodriguez T. <
demetrio.rodriguez.t at gmail.com> wrote:

> Hello everyone,
>
>
> I hope this reaches someone at all. It's my first bug report to the R-core,
> and, apparently, bugzilla is locked from new reports for now.
>
> I was using `methods::insertSource` to debug and successfully fix another
> package, until it suddenly stopped working. I figured out, that it is
> because I am using it on the same function multiple times within one
> session. It also produces warnings even during the first call, but somehow
> still works. Below I provide a reproducible example:
>
> SETUP:
> ```bash
> demetrio at laptop:[folder_structure]/Bugreports/methods_insertSource$ ls -a
> .  ..  gmapsdistance_fix.R  methods_insertSource.R
> ```
>
> file `gmapsdistance_fix.R`
> ```R
> gmapsdistance = function(param) {
>     print('I am a bug report, my params are:')
>     print(param)
> }
> ```
>
>
> file `methods_insertSource.R`
> ```R
> library(gmapsdistance)  # works with any package
>
> methods::insertSource('gmapsdistance_fix.R',
>     package = 'gmapsdistance',
>     functions = 'gmapsdistance',
>     force = T
> )
> buggy = gmapsdistance('Works?')
> ```
>
>
> TO REPRODUCE:
> in that directory `R --vanilla` then
> ```R
> > source('methods_insertSource.R')
> Modified functions inserted through trace(): gmapsdistance
> [1] "I am a bug report, my params are:"
> [1] "Works?"
> Warning message:
> In methods::insertSource("gmapsdistance_fix.R", package = "gmapsdistance",
> :
>   cannot insert these (not found in source): "gmapsdistance"
> # Works, but gives the warning that it does not
>
> # repeat:
> > source('methods_insertSource.R')
> Error in assign(this, thisObj, envir = envwhere) :
>   cannot change value of locked binding for 'gmapsdistance'
> In addition: Warning message:
> In methods::insertSource("gmapsdistance_fix.R", package = "gmapsdistance",
> :
>   cannot insert these (not found in source): "gmapsdistance"
>
> # does not work, and gets even more confusing: so is it that the object is
> not find, or is it about a locked object?
> ```
>
> I think it's a bug.
>
> --------------------- BUG REPORT END ------------------------
>
>
> I looked into it a bit myself, in case you are interested:
>
> ```R
> # lines 20-22
>     if (is(source, "environment"))
>         env <- source
>     else env <- evalSource(source, package, FALSE)
>     # We're in the second case I guess
>
> # Browse[2]> env
> # Object of class "sourceEnvironment"
> # Source environment created  2017-12-01 05:19:51
> # For package "gmapsdistance"
> # From source file "gmapsdistancefix.R"
>
>
> # later, before line 52:
> x = env
> Browse[2]> package
> [1] "gmapsdistance"
>
> # evaluate 52
> packageSlot(env) <- package
>
> # objects x and env are still identical
> # Browse[2]> class(env)
> # [1] "sourceEnvironment"
> # attr(,"package")
> # [1] "methods"
> # Browse[2]> class(x)
> # [1] "sourceEnvironment"
> # attr(,"package")
> # [1] "methods"
>
> # Browse[2]> env
> # Object of class "sourceEnvironment"
> # Source environment created  2017-12-01 05:19:51
> # For package "gmapsdistance"
> # From source file "gmapsdistancefix.R"
> # Browse[2]> x
> # Object of class "sourceEnvironment"
> # Source environment created  2017-12-01 05:19:51
> # For package "gmapsdistance"
> # From source file "gmapsdistancefix.R"
>
> # so:
> Browse[2]>  names(env)
> NULL
>
> # which is why 53-60 do not work:
> allObjects <- names(env)
> if (!missing(functions)) {
>     notThere <- is.na(match(functions, allObjects))
>     if (any(notThere)) {
>         warning(gettextf("cannot insert these (not found in source): %s",
>             paste("\"", functions[notThere], "\"", sep = "",
>                 collapse = ", ")), domain = NA)
>     }
> }
> ```
>
> Looking forward to your feedback!
>
> Cheers,
> Demetrio
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

	[[alternative HTML version deleted]]


From spencer.graves at prodsyse.com  Mon Jan 29 21:58:20 2018
From: spencer.graves at prodsyse.com (Spencer Graves)
Date: Mon, 29 Jan 2018 14:58:20 -0600
Subject: [Rd] help(pac=xxx) get data from CRAN?
Message-ID: <f4840fc6-13f2-10a6-7c38-f8f5f2521711@prodsyse.com>

Hello, All:


 ????? A feature request:


 ????? What about modifying the code for "help(pac=xxx)" so it looks for 
"xxx" on CRAN as well as locally:? If it finds it locally, it uses that 
version but with an annotation reporting what it found on CRAN:

* If it doesn't find CRAN, it doesn't report anything on this.
* If it finds CRAN, and the version numbers match, it reports that.
* If it finds CRAN, and the local version is behind CRAN, it says, 
"newer version on CRAN".
* If it finds CRAN, and the local version is ahead of CRAN, it says 
something like, "Local newer than CRAN."


 ????? This occurred to me, because someone suggested I update the "sos" 
package to use CRAN to get package information for packages not already 
installed.? It's a great idea, but I'm not ready to do that just yet.


 ????? Best Wishes,
 ????? Spencer Graves


From dstr7320 at uni.sydney.edu.au  Tue Jan 30 02:00:04 2018
From: dstr7320 at uni.sydney.edu.au (Dario Strbenac)
Date: Tue, 30 Jan 2018 01:00:04 +0000
Subject: [Rd] as.list method for by Objects
Message-ID: <SY3PR01MB07474F9CEBBC61FD2A152E58CDE40@SY3PR01MB0747.ausprd01.prod.outlook.com>

Good day,

I'd like to suggest the addition of an as.list method for a by object that actually returns a list of class "list". This would make it safer to do type-checking, because is.list also returns TRUE for a data.frame variable and using class(result) == "list" is an alternative that only returns TRUE for lists. It's also confusing initially that

> class(x)
[1] "by"
> is.list(x)
[1] TRUE

since there's no explicit class definition for "by" and no mention if it has any superclasses.

--------------------------------------
Dario Strbenac
University of Sydney
Camperdown NSW 2050
Australia


From jeroenooms at gmail.com  Tue Jan 30 12:32:26 2018
From: jeroenooms at gmail.com (Jeroen Ooms)
Date: Tue, 30 Jan 2018 12:32:26 +0100
Subject: [Rd] LCONS undefined for R_NO_REMAP
Message-ID: <CABFfbXuhaJ69cmS831gLi1XSKzMsMoeNnpR_FPvk+7xdt0AVnA@mail.gmail.com>

Rinternals.h has:

#define CONS(a, b) cons((a), (b))
#define LCONS(a, b) lcons((a), (b))

However these are undefined when we compile with -DR_NO_REMAP. Maybe
it's safer to define these using Rf_cons() and Rf_lcons() instead?


From maechler at stat.math.ethz.ch  Tue Jan 30 15:17:50 2018
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Tue, 30 Jan 2018 15:17:50 +0100
Subject: [Rd] withTimeout bug,
	it does not work properly with nlme anymore
In-Reply-To: <C7338A7EFF31BB4D831BB06C00887789B9C4AA4D@MBX023-W1-CA-2.exch023.domain.local>
References: <C7338A7EFF31BB4D831BB06C00887789B9C4AA4D@MBX023-W1-CA-2.exch023.domain.local>
Message-ID: <23152.32398.680101.584166@stat.math.ethz.ch>

>>>>> Ramiro Barrantes <ramiro at precisionbioassay.com>
>>>>>     on Mon, 27 Nov 2017 21:02:52 +0000 writes:

    > Hello, I was relying on withTimeout (from R.utils) to help
    > me stop nlme when it ?hangs?.  However, recently this
    > stopped working.  I am pasting a reproducible example
    > below: withTimeout should stop nlme after 10 seconds but
    > the code will generate data for which nlme does not
    > converge (or takes too long) and withTimeout does not stop
    > it.  I tried this both on a linux (64 bit, CentOS 7, R
    > 3.4.1, nlme 3.1-131 R.util 2.6, and also with R 3.2.5) and
    > mac (Sierra 10.13.1, R 3.4.2, same versions or nlme and
    > R.utils).  It takes over R and I need to use brute-force
    > to stop it.  As mentioned, this used to work and it is
    > very helpful for the purposes of having a loop where nlme
    > goes through many models.

    > Thank you in advance for any help, Ramiro

Dear Ramiro,

as I thought you are reporting a bug  about  R.utils  withTimeout(),
I and maybe others have not reacted.

You've addressed this again in a non-public e-mail,
and indeed the underlying bug is really in nlme  which you do
mention implicitly.

I'm appending a version of your example that is not using R.utils
at all and reproducible hangs for me with R 3.4.3, R 3.4.3
patched and R-devel (and almost surely earlier versions of R
which I did not check.

Indeed, the call to nlme() "stalls" // "hangs" / "freezes" /
... R indeed, and cannot be terminated in a regular way, and, as
you, I do need "brute force" to stop it, killing the R process
too.

As the maintainer of the 'nlme'  *is* R-core,
we are asked to fix this, at least making it interruptable.

Still I should not take time for that for the next couple of
weeks as I should fulfill several other day jobs duties,
instead, and so will not promise anything here.

Tested (minimal) patches are welcome!

Here's a version of your script slightly simplified which
exhibits the problem and shows the problem indeed does not
happen in nlminb() -- which I wrongly assumed for a while --
but indeed in nlme's call to own .C() code.

I am looking into fixing this (making it interruptable // detect
the infinite loop).
My guess is that it only happens in degenerate cases like here.

Martin Maechler
ETH Zurich


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: nlme-stall_Barrantes.R
URL: <https://stat.ethz.ch/pipermail/r-devel/attachments/20180130/9ab3a760/attachment.ksh>

From mehmet.suzen at gmail.com  Tue Jan 30 17:00:16 2018
From: mehmet.suzen at gmail.com (Suzen, Mehmet)
Date: Tue, 30 Jan 2018 17:00:16 +0100
Subject: [Rd] Best practices in developing package: From a single file
Message-ID: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>

Dear R developers,

I am wondering what are the best practices for developing an R
package. I am aware of Hadley Wickham's best practice
documentation/book (http://r-pkgs.had.co.nz/).  I recall a couple of
years ago there were some tools for generating a package out of a
single file, such as using package.skeleton, but no auto-generated
documentation. Do you know a way to generate documentation and a
package out of single R source file, or from an environment?

Many thanks,
Mehmet


From brian at braverock.com  Tue Jan 30 17:29:02 2018
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 30 Jan 2018 10:29:02 -0600
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
Message-ID: <1517329742.15543.15.camel@braverock.com>

On Tue, 2018-01-30 at 17:00 +0100, Suzen, Mehmet wrote:
> Dear R developers,
> 
> I am wondering what are the best practices for developing an R
> package. I am aware of Hadley Wickham's best practice
> documentation/book (http://r-pkgs.had.co.nz/).??I recall a couple of
> years ago there were some tools for generating a package out of a
> single file, such as using package.skeleton, but no auto-generated
> documentation. Do you know a way to generate documentation and a
> package out of single R source file, or from an environment?

Mehmet,

This list is for development of the R language itself and closely
related tools.  There is a separate list, R-pkg-devel, for development
of packages.  

Since you're here, I'll try to answer your question.

package.skeleton can create a package from all the R functions in a
specified environment.  So if you load all the functions that you want
in your new package into your R environment, then call
package.skeleton, you'll have a starting point.

At that point, I would probably recommend moving to RStudio, and using
RStudio to generate markdown comments for roxygen for all your newly
created function files.  Then you could finish off the documentation by
writing it in these roxygen skeletons or copying and pasting from
comments in your original code files.

Please address further discussion to the R-pkg-devel list.

Regards,

Brian


From lawrence.michael at gene.com  Tue Jan 30 19:37:38 2018
From: lawrence.michael at gene.com (Michael Lawrence)
Date: Tue, 30 Jan 2018 10:37:38 -0800
Subject: [Rd] as.list method for by Objects
In-Reply-To: <SY3PR01MB07474F9CEBBC61FD2A152E58CDE40@SY3PR01MB0747.ausprd01.prod.outlook.com>
References: <SY3PR01MB07474F9CEBBC61FD2A152E58CDE40@SY3PR01MB0747.ausprd01.prod.outlook.com>
Message-ID: <CAOQ5NyeqQCKRKEb6BC8PCV=EojhmjRvqyvkona0hx6mZP8uq0g@mail.gmail.com>

I agree that it would make sense for the object to have c("by", "list") as
its class attribute, since the object is known to behave as a list.
However, it would may be too disruptive to make this change at this point.
Hard to predict.

Michael

On Mon, Jan 29, 2018 at 5:00 PM, Dario Strbenac <dstr7320 at uni.sydney.edu.au>
wrote:

> Good day,
>
> I'd like to suggest the addition of an as.list method for a by object that
> actually returns a list of class "list". This would make it safer to do
> type-checking, because is.list also returns TRUE for a data.frame variable
> and using class(result) == "list" is an alternative that only returns TRUE
> for lists. It's also confusing initially that
>
> > class(x)
> [1] "by"
> > is.list(x)
> [1] TRUE
>
> since there's no explicit class definition for "by" and no mention if it
> has any superclasses.
>
> --------------------------------------
> Dario Strbenac
> University of Sydney
> Camperdown NSW 2050
> Australia
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>
>

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Tue Jan 30 20:53:31 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 30 Jan 2018 14:53:31 -0500
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <1517329742.15543.15.camel@braverock.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
Message-ID: <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>

On 30/01/2018 11:29 AM, Brian G. Peterson wrote:
> On Tue, 2018-01-30 at 17:00 +0100, Suzen, Mehmet wrote:
>> Dear R developers,
>>
>> I am wondering what are the best practices for developing an R
>> package. I am aware of Hadley Wickham's best practice
>> documentation/book (http://r-pkgs.had.co.nz/).??I recall a couple of
>> years ago there were some tools for generating a package out of a
>> single file, such as using package.skeleton, but no auto-generated
>> documentation. Do you know a way to generate documentation and a
>> package out of single R source file, or from an environment?
> 
> Mehmet,
> 
> This list is for development of the R language itself and closely
> related tools.  There is a separate list, R-pkg-devel, for development
> of packages.
> 
> Since you're here, I'll try to answer your question.
> 
> package.skeleton can create a package from all the R functions in a
> specified environment.  So if you load all the functions that you want
> in your new package into your R environment, then call
> package.skeleton, you'll have a starting point.
> 
> At that point, I would probably recommend moving to RStudio, and using
> RStudio to generate markdown comments for roxygen for all your newly
> created function files.  Then you could finish off the documentation by
> writing it in these roxygen skeletons or copying and pasting from
> comments in your original code files.

I'd agree about moving to RStudio, but I think Roxygen is the wrong 
approach for documentation.  package.skeleton() will have done the 
boring mechanical part of setting up your .Rd files; all you have to do 
is edit some content into them.  (Use prompt() to add a new file if you 
add a new function later, don't run package.skeleton() again.)

This isn't the fashionable point of view, but I think it is easier to 
get good documentation that way than using Roxygen.  (It's easier to get 
bad documentation using Roxygen, but who wants that?)

The reason I think this is that good documentation requires work and 
thought.  You need to think about the markup that will get your point 
across, you need to think about putting together good examples, etc.
This is *harder* in Roxygen than if you are writing Rd files, because 
Roxygen is a thin front end to produce Rd files from comments in your .R 
files.  To get good stuff in the help page, you need just as much work 
as in writing the .Rd file directly, but then you need to add another 
layer on top to put in in a comment.  Most people don't bother.

I don't know any packages with what I'd consider to be good 
documentation that use Roxygen.  It's just too easy to write minimal 
documentation that passes checks, so Roxygen users don't keep refining it.

(There are plenty of examples of packages that write bad documentation 
directly to .Rd as well.  I just don't know of examples of packages with 
good documentation that use Roxygen.)

Based on my criticism last week of git and Github, I expect to be called 
a grumpy old man for holding this point of view.  I'd actually like to 
be proven wrong.  So to anyone who disagrees with me:  rather than just 
calling me names, how about some examples of Roxygen-using packages that 
have good help pages with good explanations, and good examples in them?

Back to Mehmet's question:  I think Hadley's book is pretty good, and 
I'd recommend most of it, just not the Roxygen part.

Duncan Murdoch


From MEC at stowers.org  Tue Jan 30 21:31:46 2018
From: MEC at stowers.org (Cook, Malcolm)
Date: Tue, 30 Jan 2018 20:31:46 +0000
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
Message-ID: <CY4PR2001MB10641A6B87B06111469FDBD0BEE40@CY4PR2001MB1064.namprd20.prod.outlook.com>

> >> I am wondering what are the best practices for developing an R
 > >> package. I am aware of Hadley Wickham's best practice
 > >> documentation/book (http://r-pkgs.had.co.nz/).??I recall a couple of
 > >> years ago there were some tools for generating a package out of a
 > >> single file, such as using package.skeleton, but no auto-generated
 > >> documentation. Do you know a way to generate documentation and a
 > >> package out of single R source file, or from an environment?

I think you want to see the approach to generating a skeleton from a single .R file presented in:

	Simple and sustainable R packaging using inlinedocs http://inlinedocs.r-forge.r-project.org/

I have not used it in some time but found it invaluable when I did.

I would be VERY INTERESTED to hear how others feel it has held up.

Joining conversation late,

~malcolm_cook at stowers.org

 > >
 > > Mehmet,
 > >
 > > This list is for development of the R language itself and closely
 > > related tools.  There is a separate list, R-pkg-devel, for development
 > > of packages.
 > >
 > > Since you're here, I'll try to answer your question.
 > >
 > > package.skeleton can create a package from all the R functions in a
 > > specified environment.  So if you load all the functions that you want
 > > in your new package into your R environment, then call
 > > package.skeleton, you'll have a starting point.
 > >
 > > At that point, I would probably recommend moving to RStudio, and using
 > > RStudio to generate markdown comments for roxygen for all your newly
 > > created function files.  Then you could finish off the documentation by
 > > writing it in these roxygen skeletons or copying and pasting from
 > > comments in your original code files.
 > 
 > I'd agree about moving to RStudio, but I think Roxygen is the wrong
 > approach for documentation.  package.skeleton() will have done the
 > boring mechanical part of setting up your .Rd files; all you have to do
 > is edit some content into them.  (Use prompt() to add a new file if you
 > add a new function later, don't run package.skeleton() again.)
 > 
 > This isn't the fashionable point of view, but I think it is easier to
 > get good documentation that way than using Roxygen.  (It's easier to get
 > bad documentation using Roxygen, but who wants that?)
 > 
 > The reason I think this is that good documentation requires work and
 > thought.  You need to think about the markup that will get your point
 > across, you need to think about putting together good examples, etc.
 > This is *harder* in Roxygen than if you are writing Rd files, because
 > Roxygen is a thin front end to produce Rd files from comments in your .R
 > files.  To get good stuff in the help page, you need just as much work
 > as in writing the .Rd file directly, but then you need to add another
 > layer on top to put in in a comment.  Most people don't bother.
 > 
 > I don't know any packages with what I'd consider to be good
 > documentation that use Roxygen.  It's just too easy to write minimal
 > documentation that passes checks, so Roxygen users don't keep refining it.
 > 
 > (There are plenty of examples of packages that write bad documentation
 > directly to .Rd as well.  I just don't know of examples of packages with
 > good documentation that use Roxygen.)
 > 
 > Based on my criticism last week of git and Github, I expect to be called
 > a grumpy old man for holding this point of view.  I'd actually like to
 > be proven wrong.  So to anyone who disagrees with me:  rather than just
 > calling me names, how about some examples of Roxygen-using packages
 > that
 > have good help pages with good explanations, and good examples in them?
 > 
 > Back to Mehmet's question:  I think Hadley's book is pretty good, and
 > I'd recommend most of it, just not the Roxygen part.
 > 
 > Duncan Murdoch
 > 
 > ______________________________________________
 > R-devel at r-project.org mailing list
 > https://stat.ethz.ch/mailman/listinfo/r-devel

From edd at debian.org  Tue Jan 30 22:12:39 2018
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 30 Jan 2018 15:12:39 -0600
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <CY4PR2001MB10641A6B87B06111469FDBD0BEE40@CY4PR2001MB1064.namprd20.prod.outlook.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CY4PR2001MB10641A6B87B06111469FDBD0BEE40@CY4PR2001MB1064.namprd20.prod.outlook.com>
Message-ID: <23152.57287.697853.990831@rob.eddelbuettel.com>


Mehmet,

That is a loaded topic, not unlikely other topics preoccupying us these days.

There is package.skeleton() in base R as you already mentioned. It drove me
bonkers that it creates packages which then fail R CMD check, so I wrote a
wrapper package (pkgKitten) with another helper function (kitten()) which
calls the base R helper and then cleans up it---but otherwise remains
faithful to it.

These days pkgKitten defaults to creating per-package top-level help page
that just references content from DESCRIPTION via a set of newer Rd macros as
I find that helps keeping them aligned. The most recent example of mine is
  https://github.com/eddelbuettel/prrd/blob/master/man/prrd-package.Rd 
I use either this function or the RStudio template helper all the time.

And similarly, other people written similar helpers. You may get other pointers.

And every couple of months someone writes a new tutorial about how to write a
first package. Then social media goes gaga and we get half a dozen blog posts
where someone celebrates finding said tutorial, reading it and following
through with a new package. 

And many of us taught workshops on creating packages. There is a lot of
material out here, though lots of this material seems to be entirely ignorant
of what came before it.

And there has been lots, including Fritz's tutorial from a decade ago:

    https://epub.ub.uni-muenchen.de/6175/  as well as on CRAN as
    https://cran.r-project.org/doc/contrib/Leisch-CreatingPackages.pdf

So I'd recommend you just experiment and set up your own helpers. After all
the rule still holds: Anything you do more than three times should be a
function, and every function should be in a package. So customize _your_
function to create your package.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From edd at debian.org  Tue Jan 30 22:19:59 2018
From: edd at debian.org (Dirk Eddelbuettel)
Date: Tue, 30 Jan 2018 15:19:59 -0600
Subject: [Rd] CRAN indices out of whack (for at least macOS)
Message-ID: <23152.57727.522184.800529@rob.eddelbuettel.com>


I have received three distinct (non-)bug reports where someone claimed a
recent package of mine was broken ... simply because the macOS binary was not
there.

Is there something wrong with the cronjob providing the indices? Why is it
pointing people to binaries that do not exist?

Concretely, file

  https://cloud.r-project.org/bin/macosx/el-capitan/contrib/3.4/PACKAGES

contains

  Package: digest
  Version: 0.6.15
  Title: Create Compact Hash Digests of R Objects
  Depends: R (>= 2.4.1)
  Suggests: knitr, rmarkdown
  Built: R 3.4.3; x86_64-apple-darwin15.6.0; 2018-01-29 05:21:06 UTC; unix
  Archs: digest.so.dSYM

yet the _same directory_ only has:

  digest_0.6.14.tgz	15-Jan-2018 21:36	157K

I presume this is a temporary accident.

We are all spoiled by you all providing such a wonderfully robust and
well-oiled service---so again big THANKS for that--but today something is out
of order.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From hpages at fredhutch.org  Tue Jan 30 22:30:18 2018
From: hpages at fredhutch.org (=?UTF-8?B?SGVydsOpIFBhZ8Oocw==?=)
Date: Tue, 30 Jan 2018 13:30:18 -0800
Subject: [Rd] sum() returns NA on a long *logical* vector when nb of
 TRUE values exceeds 2^31
In-Reply-To: <23148.23857.970768.727765@stat.math.ethz.ch>
References: <5931466B.1060407@fredhutch.org>
 <CAFDcVCRt1=-1t8=-x5TLhe3y0T_tpZUkTAH1W-hyMKqFH-eJYg@mail.gmail.com>
 <CAFDcVCQv19O2zBybkRHh6G58AMa0GjQRZcHnD3WEnQACnuM7Uw@mail.gmail.com>
 <23148.23857.970768.727765@stat.math.ethz.ch>
Message-ID: <3d97d7d0-ef1b-90a7-ed1e-16af5461abc0@fredhutch.org>

Hi Martin, Henrik,

Thanks for the follow up.

@Martin: I vote for 2) without *any* hesitation :-)

(and uniformity could be restored at some point in the
future by having prod(), rowSums(), colSums(), and others
align with the behavior of length() and sum())

Cheers,
H.


On 01/27/2018 03:06 AM, Martin Maechler wrote:
>>>>>> Henrik Bengtsson <henrik.bengtsson at gmail.com>
>>>>>>      on Thu, 25 Jan 2018 09:30:42 -0800 writes:
> 
>      > Just following up on this old thread since matrixStats 0.53.0 is now
>      > out, which supports this use case:
> 
>      >> x <- rep(TRUE, times = 2^31)
> 
>      >> y <- sum(x)
>      >> y
>      > [1] NA
>      > Warning message:
>      > In sum(x) : integer overflow - use sum(as.numeric(.))
> 
>      >> y <- matrixStats::sum2(x, mode = "double")
>      >> y
>      > [1] 2147483648
>      >> str(y)
>      > num 2.15e+09
> 
>      > No coercion is taking place, so the memory overhead is zero:
> 
>      >> profmem::profmem(y <- matrixStats::sum2(x, mode = "double"))
>      > Rprofmem memory profiling of:
>      > y <- matrixStats::sum2(x, mode = "double")
> 
>      > Memory allocations:
>      > bytes calls
>      > total     0
> 
>      > /Henrik
> 
> Thank you, Henrik, for the reminder.
> 
> Back in June, I had mentioned to Herv? and R-devel that
> 'logical' should remain to be treated as 'integer' as in all
> arithmetic in (S and) R.     Herv? did mention the isum()
> function in the C code which is relevant here .. which does have
> a LONG INT counter already -- *but* if we consider that sum()
> has '...' i.e. a conceptually arbitrary number of long vector
> integer arguments that counter won't suffice even there.
> 
> Before talking about implementation / patch, I think we should
> consider 2 possible goals of a change --- I agree the status quo
> is not a real option
> 
> 1) sum(x) for logical and integer x  would return a double
>        in any case and overflow should not happen (unless for
>        the case where the result would be larger the
>        .Machine$double.max which I think will not be possible
>        even with "arbitrary" nargs() of sum.
> 
> 2) sum(x) for logical and integer x  should return an integer in
>         all cases there is no overflow, including returning
>         NA_integer_ in case of NAs.
>     If there would be an overflow it must be detected "in time"
>     and the result should be double.
> 
> The big advantage of 2) is that it is back compatible in 99.x %
> of use cases, and another advantage that it may be a very small
> bit more efficient.  Also, in the case of "counting" (logical),
> it is nice to get an integer instead of double when we can --
> entirely analogously to the behavior of length() which returns
> integer whenever possible.
> 
> The advantage of 1) is uniformity.
> 
> We should (at least provisionally) decide between 1) and 2) and then go for that.
> It could be that going for 1) may have bad
> compatibility-consequences in package space, because indeed we
> had documented sum() would be integer for logical and integer arguments.
> 
> I currently don't really have time to
> {work on implementing + dealing with the consequences}
> for either ..
> 
> Martin
> 
>      > On Fri, Jun 2, 2017 at 1:58 PM, Henrik Bengtsson
>      > <henrik.bengtsson at gmail.com> wrote:
>      >> I second this feature request (it's understandable that this and
>      >> possibly other parts of the code was left behind / forgotten after the
>      >> introduction of long vector).
>      >>
>      >> I think mean() avoids full copies, so in the meanwhile, you can work
>      >> around this limitation using:
>      >>
>      >> countTRUE <- function(x, na.rm = FALSE) {
>      >> nx <- length(x)
>      >> if (nx < .Machine$integer.max) return(sum(x, na.rm = na.rm))
>      >> nx * mean(x, na.rm = na.rm)
>      >> }
>      >>
>      >> (not sure if one needs to worry about rounding errors, i.e. where n %% 0 != 0)
>      >>
>      >> x <- rep(TRUE, times = .Machine$integer.max+1)
>      >> object.size(x)
>      >> ## 8589934632 bytes
>      >>
>      >> p <- profmem::profmem( n <- countTRUE(x) )
>      >> str(n)
>      >> ## num 2.15e+09
>      >> print(n == .Machine$integer.max + 1)
>      >> ## [1] TRUE
>      >>
>      >> print(p)
>      >> ## Rprofmem memory profiling of:
>      >> ## n <- countTRUE(x)
>      >> ##
>      >> ## Memory allocations:
>      >> ##      bytes calls
>      >> ## total     0
>      >>
>      >>
>      >> FYI / related: I've just updated matrixStats::sum2() to support
>      >> logicals (develop branch) and I'll also try to update
>      >> matrixStats::count() to count beyond .Machine$integer.max.
>      >>
>      >> /Henrik
>      >>
>      >> On Fri, Jun 2, 2017 at 4:05 AM, Herv? Pag?s <hpages at fredhutch.org> wrote:
>      >>> Hi,
>      >>>
>      >>> I have a long numeric vector 'xx' and I want to use sum() to count
>      >>> the number of elements that satisfy some criteria like non-zero
>      >>> values or values lower than a certain threshold etc...
>      >>>
>      >>> The problem is: sum() returns an NA (with a warning) if the count
>      >>> is greater than 2^31. For example:
>      >>>
>      >>> > xx <- runif(3e9)
>      >>> > sum(xx < 0.9)
>      >>> [1] NA
>      >>> Warning message:
>      >>> In sum(xx < 0.9) : integer overflow - use sum(as.numeric(.))
>      >>>
>      >>> This already takes a long time and doing sum(as.numeric(.)) would
>      >>> take even longer and require allocation of 24Gb of memory just to
>      >>> store an intermediate numeric vector made of 0s and 1s. Plus, having
>      >>> to do sum(as.numeric(.)) every time I need to count things is not
>      >>> convenient and is easy to forget.
>      >>>
>      >>> It seems that sum() on a logical vector could be modified to return
>      >>> the count as a double when it cannot be represented as an integer.
>      >>> Note that length() already does this so that wouldn't create a
>      >>> precedent. Also and FWIW prod() avoids the problem by always returning
>      >>> a double, whatever the type of the input is (except on a complex
>      >>> vector).
>      >>>
>      >>> I can provide a patch if this change sounds reasonable.
>      >>>
>      >>> Cheers,
>      >>> H.
>      >>>
>      >>> --
>      >>> Herv? Pag?s
>      
> 

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fredhutch.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From kmbell56 at gmail.com  Tue Jan 30 22:30:58 2018
From: kmbell56 at gmail.com (Kenny Bell)
Date: Tue, 30 Jan 2018 21:30:58 +0000
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <23152.57287.697853.990831@rob.eddelbuettel.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CY4PR2001MB10641A6B87B06111469FDBD0BEE40@CY4PR2001MB1064.namprd20.prod.outlook.com>
 <23152.57287.697853.990831@rob.eddelbuettel.com>
Message-ID: <CAPekMCkWYvdGJ=wXA3bGFs655xsV6RUFCCjFpcpZ4rjmB8u-VQ@mail.gmail.com>

In response to Duncan regarding the use of roxygen2 from the point of view
of a current user, I believe the issue he brings up is one of correlation
rather than causation.

Writing my first piece of R documentation was made much easier by using
roxygen2, and it shallowed the learning curve substantially.

What Duncan may be observing is a general tendency of roxygen2 users to
write overly concise documentation. However, I believe this to be caused by
an omitted variable - likely the tendency of roxygen2 users to want outputs
quickly. I can't see anything in roxygen2 that might suggest a causal link
but I'd be interested in hearing specific examples.

FWIW, I've also heard the same documentation criticism leveled at R in
general (mostly from Stata and MATLAB users).

Kenny

On Wed, Jan 31, 2018, 10:12 AM Dirk Eddelbuettel <edd at debian.org> wrote:

>
> Mehmet,
>
> That is a loaded topic, not unlikely other topics preoccupying us these
> days.
>
> There is package.skeleton() in base R as you already mentioned. It drove me
> bonkers that it creates packages which then fail R CMD check, so I wrote a
> wrapper package (pkgKitten) with another helper function (kitten()) which
> calls the base R helper and then cleans up it---but otherwise remains
> faithful to it.
>
> These days pkgKitten defaults to creating per-package top-level help page
> that just references content from DESCRIPTION via a set of newer Rd macros
> as
> I find that helps keeping them aligned. The most recent example of mine is
>   https://github.com/eddelbuettel/prrd/blob/master/man/prrd-package.Rd
> I use either this function or the RStudio template helper all the time.
>
> And similarly, other people written similar helpers. You may get other
> pointers.
>
> And every couple of months someone writes a new tutorial about how to
> write a
> first package. Then social media goes gaga and we get half a dozen blog
> posts
> where someone celebrates finding said tutorial, reading it and following
> through with a new package.
>
> And many of us taught workshops on creating packages. There is a lot of
> material out here, though lots of this material seems to be entirely
> ignorant
> of what came before it.
>
> And there has been lots, including Fritz's tutorial from a decade ago:
>
>     https://epub.ub.uni-muenchen.de/6175/  as well as on CRAN as
>     https://cran.r-project.org/doc/contrib/Leisch-CreatingPackages.pdf
>
> So I'd recommend you just experiment and set up your own helpers. After all
> the rule still holds: Anything you do more than three times should be a
> function, and every function should be in a package. So customize _your_
> function to create your package.
>
> Dirk
>
> --
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From hpages at fredhutch.org  Tue Jan 30 23:24:17 2018
From: hpages at fredhutch.org (=?UTF-8?B?SGVydsOpIFBhZ8Oocw==?=)
Date: Tue, 30 Jan 2018 14:24:17 -0800
Subject: [Rd] as.list method for by Objects
In-Reply-To: <SY3PR01MB07474F9CEBBC61FD2A152E58CDE40@SY3PR01MB0747.ausprd01.prod.outlook.com>
References: <SY3PR01MB07474F9CEBBC61FD2A152E58CDE40@SY3PR01MB0747.ausprd01.prod.outlook.com>
Message-ID: <02275be4-b015-0860-8733-efb2b6b17996@fredhutch.org>

I agree that it makes sense to expect as.list() to perform
a "strict coercion" i.e. to return an object of class "list",
*even* on a list derivative. That's what as( , "list") does
by default:

   # on a data.frame object
   as(data.frame(), "list")  # object of class "list"
                             # (but strangely it drops the names)

   # on a by object
   x <- by(warpbreaks[, 1:2], warpbreaks[,"tension"], summary)
   as(x, "list")  # object of class "list"

More generally speaking as() is expected to perform "strict
coercion" by default, unless called with 'strict=FALSE'.

That's also what as.list() does on a data.frame:

   as.list(data.frame())  # object of class "list"

FWIW as.numeric() also performs "strict coercion" on an integer
vector:

   as.numeric(1:3)  # object of class "numeric"

So an as.list.env method that does the same as as(x, "list")
would bring a small touch of consistency in an otherwise
quite inconsistent world of coercion methods(*).

H.

(*) as(data.frame(), "list", strict=FALSE) doesn't do what you'd
     expect (just one of many examples)


On 01/29/2018 05:00 PM, Dario Strbenac wrote:
> Good day,
> 
> I'd like to suggest the addition of an as.list method for a by object that actually returns a list of class "list". This would make it safer to do type-checking, because is.list also returns TRUE for a data.frame variable and using class(result) == "list" is an alternative that only returns TRUE for lists. It's also confusing initially that
> 
>> class(x)
> [1] "by"
>> is.list(x)
> [1] TRUE
> 
> since there's no explicit class definition for "by" and no mention if it has any superclasses.
> 
> --------------------------------------
> Dario Strbenac
> University of Sydney
> Camperdown NSW 2050
> Australia
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=8nXbMrKus1XsG7MluCRy3sluJKKhMVwOPHtudDpYJ4o&s=qDnEZOWalov3E9h1dajp8RLURfRz0-nbwH721jFAcEo&e=
> 

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fredhutch.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From hpages at fredhutch.org  Tue Jan 30 23:32:16 2018
From: hpages at fredhutch.org (=?UTF-8?B?SGVydsOpIFBhZ8Oocw==?=)
Date: Tue, 30 Jan 2018 14:32:16 -0800
Subject: [Rd] as.list method for by Objects
In-Reply-To: <02275be4-b015-0860-8733-efb2b6b17996@fredhutch.org>
References: <SY3PR01MB07474F9CEBBC61FD2A152E58CDE40@SY3PR01MB0747.ausprd01.prod.outlook.com>
 <02275be4-b015-0860-8733-efb2b6b17996@fredhutch.org>
Message-ID: <83a450e6-61a7-3e19-a42d-7e496bb82140@fredhutch.org>

On 01/30/2018 02:24 PM, Herv? Pag?s wrote:
> I agree that it makes sense to expect as.list() to perform
> a "strict coercion" i.e. to return an object of class "list",
> *even* on a list derivative. That's what as( , "list") does
> by default:
> 
>  ? # on a data.frame object
>  ? as(data.frame(), "list")? # object of class "list"
>  ??????????????????????????? # (but strangely it drops the names)
> 
>  ? # on a by object
>  ? x <- by(warpbreaks[, 1:2], warpbreaks[,"tension"], summary)
>  ? as(x, "list")? # object of class "list"
> 
> More generally speaking as() is expected to perform "strict
> coercion" by default, unless called with 'strict=FALSE'.
> 
> That's also what as.list() does on a data.frame:
> 
>  ? as.list(data.frame())? # object of class "list"
> 
> FWIW as.numeric() also performs "strict coercion" on an integer
> vector:
> 
>  ? as.numeric(1:3)? # object of class "numeric"
> 
> So an as.list.env method that does the same as as(x, "list")
         ^^^^^^^^^^^
oops, I meant as.list.by, sorry...

H.

> would bring a small touch of consistency in an otherwise
> quite inconsistent world of coercion methods(*).
> 
> H.
> 
> (*) as(data.frame(), "list", strict=FALSE) doesn't do what you'd
>  ??? expect (just one of many examples)
> 
> 
> On 01/29/2018 05:00 PM, Dario Strbenac wrote:
>> Good day,
>>
>> I'd like to suggest the addition of an as.list method for a by object 
>> that actually returns a list of class "list". This would make it safer 
>> to do type-checking, because is.list also returns TRUE for a 
>> data.frame variable and using class(result) == "list" is an 
>> alternative that only returns TRUE for lists. It's also confusing 
>> initially that
>>
>>> class(x)
>> [1] "by"
>>> is.list(x)
>> [1] TRUE
>>
>> since there's no explicit class definition for "by" and no mention if 
>> it has any superclasses.
>>
>> --------------------------------------
>> Dario Strbenac
>> University of Sydney
>> Camperdown NSW 2050
>> Australia
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=8nXbMrKus1XsG7MluCRy3sluJKKhMVwOPHtudDpYJ4o&s=qDnEZOWalov3E9h1dajp8RLURfRz0-nbwH721jFAcEo&e= 
>>
>>
> 

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fredhutch.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From mehmet.suzen at gmail.com  Tue Jan 30 23:32:38 2018
From: mehmet.suzen at gmail.com (Suzen, Mehmet)
Date: Tue, 30 Jan 2018 23:32:38 +0100
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
Message-ID: <CAPtbhHwBmbBU_KD95S3e7CDbCiq_-r+zU_f_W-H-riM=m-RQ+w@mail.gmail.com>

Dear All,

Thank you for all valuable input and sorry for the off-topic for the
list. I will try R-pkg-devel for further related questions.   I was
actually after "one-go" auto-documentation in-line or out of comments
from a single file/environment in a similar spirit to
'package.skeleton or an extension of it. My take-home message or
summary from all responses do far.

* Regarding documentation;Duncan Murdoch's  wisdom "...to get good
stuff in the help page, you need just as much work as in writing the
.Rd file directly..". So there is no silver bullet in terms of
auto-documentation, I gather, especially for considering if one uses
more complex constructs, S4/S6 classes or Rcpp code behind.On the
other hand, roxgen2 being the most comprehensive solution.

* Lightweight solution to try out before moving to RStudio fully. I
will give a try Dirk's 'pkgKitten' and 'inlinedocs' Malcolm mentioned.

Interestingly, responses have reminded me Larry Wall's quote
(https://en.wikipedia.org/wiki/There%27s_more_than_one_way_to_do_it),
which I think really applies to R more than any language I encounter
so far, from different class systems to different time-series
representations, so richly democratised.

Many regards,
Mehmet


On 30 January 2018 at 17:00, Suzen, Mehmet <mehmet.suzen at gmail.com> wrote:
> Dear R developers,
>
> I am wondering what are the best practices for developing an R
> package. I am aware of Hadley Wickham's best practice
> documentation/book (http://r-pkgs.had.co.nz/).  I recall a couple of
> years ago there were some tools for generating a package out of a
> single file, such as using package.skeleton, but no auto-generated
> documentation. Do you know a way to generate documentation and a
> package out of single R source file, or from an environment?
>
> Many thanks,
> Mehmet


From gmbecker at ucdavis.edu  Tue Jan 30 23:33:24 2018
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Tue, 30 Jan 2018 14:33:24 -0800
Subject: [Rd] as.list method for by Objects
In-Reply-To: <02275be4-b015-0860-8733-efb2b6b17996@fredhutch.org>
References: <SY3PR01MB07474F9CEBBC61FD2A152E58CDE40@SY3PR01MB0747.ausprd01.prod.outlook.com>
 <02275be4-b015-0860-8733-efb2b6b17996@fredhutch.org>
Message-ID: <CADwqtCO98pTE6G4xOva3pVEEA0jSMND9zepcR19B-8rZ6mhYRg@mail.gmail.com>

Dario,

What version of R are you using. In my mildly old 3.4.0 installation and in
the version of Revel I have lying around (also mildly old...)  I don't see
the behavior I think you are describing

> b = by(1:2, 1:2, identity)

> class(as.list(b))

[1] "list"

> sessionInfo()

R Under development (unstable) (2017-12-19 r73926)

Platform: x86_64-apple-darwin15.6.0 (64-bit)

Running under: OS X El Capitan 10.11.6


Matrix products: default

BLAS:
/Users/beckerg4/local/Rdevel/R.framework/Versions/3.5/Resources/lib/libRblas.dylib

LAPACK:
/Users/beckerg4/local/Rdevel/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib


locale:

[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8


attached base packages:

[1] stats     graphics  grDevices utils     datasets  methods   base


loaded via a namespace (and not attached):

[1] compiler_3.5.0

>


As for by not having a class definition, no S3 class has an explicit
definition, so this is somewhat par for the course here...

did I misunderstand something?


~G

On Tue, Jan 30, 2018 at 2:24 PM, Herv? Pag?s <hpages at fredhutch.org> wrote:

> I agree that it makes sense to expect as.list() to perform
> a "strict coercion" i.e. to return an object of class "list",
> *even* on a list derivative. That's what as( , "list") does
> by default:
>
>   # on a data.frame object
>   as(data.frame(), "list")  # object of class "list"
>                             # (but strangely it drops the names)
>
>   # on a by object
>   x <- by(warpbreaks[, 1:2], warpbreaks[,"tension"], summary)
>   as(x, "list")  # object of class "list"
>
> More generally speaking as() is expected to perform "strict
> coercion" by default, unless called with 'strict=FALSE'.
>
> That's also what as.list() does on a data.frame:
>
>   as.list(data.frame())  # object of class "list"
>
> FWIW as.numeric() also performs "strict coercion" on an integer
> vector:
>
>   as.numeric(1:3)  # object of class "numeric"
>
> So an as.list.env method that does the same as as(x, "list")
> would bring a small touch of consistency in an otherwise
> quite inconsistent world of coercion methods(*).
>
> H.
>
> (*) as(data.frame(), "list", strict=FALSE) doesn't do what you'd
>     expect (just one of many examples)
>
>
> On 01/29/2018 05:00 PM, Dario Strbenac wrote:
>
>> Good day,
>>
>> I'd like to suggest the addition of an as.list method for a by object
>> that actually returns a list of class "list". This would make it safer to
>> do type-checking, because is.list also returns TRUE for a data.frame
>> variable and using class(result) == "list" is an alternative that only
>> returns TRUE for lists. It's also confusing initially that
>>
>> class(x)
>>>
>> [1] "by"
>>
>>> is.list(x)
>>>
>> [1] TRUE
>>
>> since there's no explicit class definition for "by" and no mention if it
>> has any superclasses.
>>
>> --------------------------------------
>> Dario Strbenac
>> University of Sydney
>> Camperdown NSW 2050
>> Australia
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.et
>> hz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84V
>> tBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=8nXbM
>> rKus1XsG7MluCRy3sluJKKhMVwOPHtudDpYJ4o&s=qDnEZOWalov3E9h1daj
>> p8RLURfRz0-nbwH721jFAcEo&e=
>>
>>
> --
> Herv? Pag?s
>
> Program in Computational Biology
> Division of Public Health Sciences
> Fred Hutchinson Cancer Research Center
> 1100 Fairview Ave. N, M1-B514
> P.O. Box 19024
> Seattle, WA 98109-1024
>
> E-mail: hpages at fredhutch.org
> Phone:  (206) 667-5791
> Fax:    (206) 667-1319
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Gabriel Becker, PhD
Scientist (Bioinformatics)
Genentech Research

	[[alternative HTML version deleted]]


From hpages at fredhutch.org  Tue Jan 30 23:41:03 2018
From: hpages at fredhutch.org (=?UTF-8?B?SGVydsOpIFBhZ8Oocw==?=)
Date: Tue, 30 Jan 2018 14:41:03 -0800
Subject: [Rd] as.list method for by Objects
In-Reply-To: <CADwqtCO98pTE6G4xOva3pVEEA0jSMND9zepcR19B-8rZ6mhYRg@mail.gmail.com>
References: <SY3PR01MB07474F9CEBBC61FD2A152E58CDE40@SY3PR01MB0747.ausprd01.prod.outlook.com>
 <02275be4-b015-0860-8733-efb2b6b17996@fredhutch.org>
 <CADwqtCO98pTE6G4xOva3pVEEA0jSMND9zepcR19B-8rZ6mhYRg@mail.gmail.com>
Message-ID: <f2080a27-71e0-4f52-61cd-2c2a8bb8e8cd@fredhutch.org>

Hi Gabe,

Interestingly the behavior of as.list() on by objects seem to
depend on the object itself:

 > b1 <- by(1:2, 1:2, identity)
 > class(as.list(b1))
[1] "list"

 > b2 <- by(warpbreaks[, 1:2], warpbreaks[,"tension"], summary)
 > class(as.list(b2))
[1] "by"

This is with R 3.4.3 and R devel (2017-12-11 r73889).

H.

On 01/30/2018 02:33 PM, Gabriel Becker wrote:
> Dario,
> 
> What version of R are you using. In my mildly old 3.4.0 installation and 
> in the version of Revel I have lying around (also mildly old...) ?I 
> don't see the behavior I think you are describing
> 
>     > b = by(1:2, 1:2, identity)
> 
>     > class(as.list(b))
> 
>     [1] "list"
> 
>     > sessionInfo()
> 
>     R Under development (unstable) (2017-12-19 r73926)
> 
>     Platform: x86_64-apple-darwin15.6.0 (64-bit)
> 
>     Running under: OS X El Capitan 10.11.6
> 
> 
>     Matrix products: default
> 
>     BLAS:
>     /Users/beckerg4/local/Rdevel/R.framework/Versions/3.5/Resources/lib/libRblas.dylib
> 
>     LAPACK:
>     /Users/beckerg4/local/Rdevel/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib
> 
> 
>     locale:
> 
>     [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> 
> 
>     attached base packages:
> 
>     [1] stats ? ? graphics? grDevices utils ? ? datasets? methods ? base
> 
> 
>     loaded via a namespace (and not attached):
> 
>     [1] compiler_3.5.0
> 
>     > 
> 
> 
> 
> As for by not having a class definition, no S3 class has an explicit 
> definition, so this is somewhat par for the course here...
> 
> did I misunderstand something?
> 
> 
> ~G
> 
> On Tue, Jan 30, 2018 at 2:24 PM, Herv? Pag?s <hpages at fredhutch.org 
> <mailto:hpages at fredhutch.org>> wrote:
> 
>     I agree that it makes sense to expect as.list() to perform
>     a "strict coercion" i.e. to return an object of class "list",
>     *even* on a list derivative. That's what as( , "list") does
>     by default:
> 
>      ? # on a data.frame object
>      ? as(data.frame(), "list")? # object of class "list"
>      ? ? ? ? ? ? ? ? ? ? ? ? ? ? # (but strangely it drops the names)
> 
>      ? # on a by object
>      ? x <- by(warpbreaks[, 1:2], warpbreaks[,"tension"], summary)
>      ? as(x, "list")? # object of class "list"
> 
>     More generally speaking as() is expected to perform "strict
>     coercion" by default, unless called with 'strict=FALSE'.
> 
>     That's also what as.list() does on a data.frame:
> 
>      ? as.list(data.frame())? # object of class "list"
> 
>     FWIW as.numeric() also performs "strict coercion" on an integer
>     vector:
> 
>      ? as.numeric(1:3)? # object of class "numeric"
> 
>     So an as.list.env method that does the same as as(x, "list")
>     would bring a small touch of consistency in an otherwise
>     quite inconsistent world of coercion methods(*).
> 
>     H.
> 
>     (*) as(data.frame(), "list", strict=FALSE) doesn't do what you'd
>      ? ? expect (just one of many examples)
> 
> 
>     On 01/29/2018 05:00 PM, Dario Strbenac wrote:
> 
>         Good day,
> 
>         I'd like to suggest the addition of an as.list method for a by
>         object that actually returns a list of class "list". This would
>         make it safer to do type-checking, because is.list also returns
>         TRUE for a data.frame variable and using class(result) == "list"
>         is an alternative that only returns TRUE for lists. It's also
>         confusing initially that
> 
>             class(x)
> 
>         [1] "by"
> 
>             is.list(x)
> 
>         [1] TRUE
> 
>         since there's no explicit class definition for "by" and no
>         mention if it has any superclasses.
> 
>         --------------------------------------
>         Dario Strbenac
>         University of Sydney
>         Camperdown NSW 2050
>         Australia
> 
>         ______________________________________________
>         R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>         https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=8nXbMrKus1XsG7MluCRy3sluJKKhMVwOPHtudDpYJ4o&s=qDnEZOWalov3E9h1dajp8RLURfRz0-nbwH721jFAcEo&e=
>         <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=8nXbMrKus1XsG7MluCRy3sluJKKhMVwOPHtudDpYJ4o&s=qDnEZOWalov3E9h1dajp8RLURfRz0-nbwH721jFAcEo&e=>
> 
> 
>     -- 
>     Herv? Pag?s
> 
>     Program in Computational Biology
>     Division of Public Health Sciences
>     Fred Hutchinson Cancer Research Center
>     1100 Fairview Ave. N, M1-B514
>     P.O. Box 19024
>     Seattle, WA 98109-1024
> 
>     E-mail: hpages at fredhutch.org <mailto:hpages at fredhutch.org>
>     Phone: (206) 667-5791 <tel:%28206%29%20667-5791>
>     Fax: (206) 667-1319 <tel:%28206%29%20667-1319>
> 
> 
>     ______________________________________________
>     R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-devel
>     <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwMFaQ&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=JIjTy48pWmEOxpHYM6DUHbRRSVwvOXOkgEFuoMhNkm0&s=x29ogWxfEnr2uKDcVEtKDWtB0USw8Xwm4f18WKBO-Dg&e=>
> 
> 
> 
> 
> -- 
> Gabriel Becker, PhD
> Scientist (Bioinformatics)
> Genentech Research

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fredhutch.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From lawrence.michael at gene.com  Tue Jan 30 23:50:10 2018
From: lawrence.michael at gene.com (Michael Lawrence)
Date: Tue, 30 Jan 2018 14:50:10 -0800
Subject: [Rd] as.list method for by Objects
In-Reply-To: <f2080a27-71e0-4f52-61cd-2c2a8bb8e8cd@fredhutch.org>
References: <SY3PR01MB07474F9CEBBC61FD2A152E58CDE40@SY3PR01MB0747.ausprd01.prod.outlook.com>
 <02275be4-b015-0860-8733-efb2b6b17996@fredhutch.org>
 <CADwqtCO98pTE6G4xOva3pVEEA0jSMND9zepcR19B-8rZ6mhYRg@mail.gmail.com>
 <f2080a27-71e0-4f52-61cd-2c2a8bb8e8cd@fredhutch.org>
Message-ID: <CAOQ5Nye8vFGjheY+QW1H5-Am6BN+V_jKGuCe8=_YbeMQyQFGkA@mail.gmail.com>

by() does not always return a list. In Gabe's example, it returns an
integer, thus it is coerced to a list. as.list() means that it should be a
VECSXP, not necessarily with "list" in the class attribute.

Michael

On Tue, Jan 30, 2018 at 2:41 PM, Herv? Pag?s <hpages at fredhutch.org> wrote:

> Hi Gabe,
>
> Interestingly the behavior of as.list() on by objects seem to
> depend on the object itself:
>
> > b1 <- by(1:2, 1:2, identity)
> > class(as.list(b1))
> [1] "list"
>
> > b2 <- by(warpbreaks[, 1:2], warpbreaks[,"tension"], summary)
> > class(as.list(b2))
> [1] "by"
>
> This is with R 3.4.3 and R devel (2017-12-11 r73889).
>
> H.
>
> On 01/30/2018 02:33 PM, Gabriel Becker wrote:
>
>> Dario,
>>
>> What version of R are you using. In my mildly old 3.4.0 installation and
>> in the version of Revel I have lying around (also mildly old...)  I don't
>> see the behavior I think you are describing
>>
>>     > b = by(1:2, 1:2, identity)
>>
>>     > class(as.list(b))
>>
>>     [1] "list"
>>
>>     > sessionInfo()
>>
>>     R Under development (unstable) (2017-12-19 r73926)
>>
>>     Platform: x86_64-apple-darwin15.6.0 (64-bit)
>>
>>     Running under: OS X El Capitan 10.11.6
>>
>>
>>     Matrix products: default
>>
>>     BLAS:
>>     /Users/beckerg4/local/Rdevel/R.framework/Versions/3.5/Resour
>> ces/lib/libRblas.dylib
>>
>>     LAPACK:
>>     /Users/beckerg4/local/Rdevel/R.framework/Versions/3.5/Resour
>> ces/lib/libRlapack.dylib
>>
>>
>>     locale:
>>
>>     [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>
>>
>>     attached base packages:
>>
>>     [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>>
>>     loaded via a namespace (and not attached):
>>
>>     [1] compiler_3.5.0
>>
>>     >
>>
>>
>> As for by not having a class definition, no S3 class has an explicit
>> definition, so this is somewhat par for the course here...
>>
>> did I misunderstand something?
>>
>>
>> ~G
>>
>> On Tue, Jan 30, 2018 at 2:24 PM, Herv? Pag?s <hpages at fredhutch.org
>> <mailto:hpages at fredhutch.org>> wrote:
>>
>>     I agree that it makes sense to expect as.list() to perform
>>     a "strict coercion" i.e. to return an object of class "list",
>>     *even* on a list derivative. That's what as( , "list") does
>>     by default:
>>
>>        # on a data.frame object
>>        as(data.frame(), "list")  # object of class "list"
>>                                  # (but strangely it drops the names)
>>
>>        # on a by object
>>        x <- by(warpbreaks[, 1:2], warpbreaks[,"tension"], summary)
>>        as(x, "list")  # object of class "list"
>>
>>     More generally speaking as() is expected to perform "strict
>>     coercion" by default, unless called with 'strict=FALSE'.
>>
>>     That's also what as.list() does on a data.frame:
>>
>>        as.list(data.frame())  # object of class "list"
>>
>>     FWIW as.numeric() also performs "strict coercion" on an integer
>>     vector:
>>
>>        as.numeric(1:3)  # object of class "numeric"
>>
>>     So an as.list.env method that does the same as as(x, "list")
>>     would bring a small touch of consistency in an otherwise
>>     quite inconsistent world of coercion methods(*).
>>
>>     H.
>>
>>     (*) as(data.frame(), "list", strict=FALSE) doesn't do what you'd
>>          expect (just one of many examples)
>>
>>
>>     On 01/29/2018 05:00 PM, Dario Strbenac wrote:
>>
>>         Good day,
>>
>>         I'd like to suggest the addition of an as.list method for a by
>>         object that actually returns a list of class "list". This would
>>         make it safer to do type-checking, because is.list also returns
>>         TRUE for a data.frame variable and using class(result) == "list"
>>         is an alternative that only returns TRUE for lists. It's also
>>         confusing initially that
>>
>>             class(x)
>>
>>         [1] "by"
>>
>>             is.list(x)
>>
>>         [1] TRUE
>>
>>         since there's no explicit class definition for "by" and no
>>         mention if it has any superclasses.
>>
>>         --------------------------------------
>>         Dario Strbenac
>>         University of Sydney
>>         Camperdown NSW 2050
>>         Australia
>>
>>         ______________________________________________
>>         R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>>         https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.et
>> hz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84V
>> tBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=8nXbM
>> rKus1XsG7MluCRy3sluJKKhMVwOPHtudDpYJ4o&s=qDnEZOWalov3E9h1daj
>> p8RLURfRz0-nbwH721jFAcEo&e=
>>         <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.
>> ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAf
>> qt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=
>> 8nXbMrKus1XsG7MluCRy3sluJKKhMVwOPHtudDpYJ4o&s=qDnEZOWalov3E9
>> h1dajp8RLURfRz0-nbwH721jFAcEo&e=>
>>
>>
>>     --     Herv? Pag?s
>>
>>     Program in Computational Biology
>>     Division of Public Health Sciences
>>     Fred Hutchinson Cancer Research Center
>>     1100 Fairview Ave. N, M1-B514
>>     P.O. Box 19024
>>     Seattle, WA 98109-1024
>>
>>     E-mail: hpages at fredhutch.org <mailto:hpages at fredhutch.org>
>>     Phone: (206) 667-5791 <tel:%28206%29%20667-5791>
>>     Fax: (206) 667-1319 <tel:%28206%29%20667-1319>
>>
>>
>>     ______________________________________________
>>     R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>>     https://stat.ethz.ch/mailman/listinfo/r-devel
>>     <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.
>> ethz.ch_mailman_listinfo_r-2Ddevel&d=DwMFaQ&c=eRAMFD45gAf
>> qt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=
>> JIjTy48pWmEOxpHYM6DUHbRRSVwvOXOkgEFuoMhNkm0&s=x29ogWxfEnr2uK
>> DcVEtKDWtB0USw8Xwm4f18WKBO-Dg&e=>
>>
>>
>>
>>
>> --
>> Gabriel Becker, PhD
>> Scientist (Bioinformatics)
>> Genentech Research
>>
>
> --
> Herv? Pag?s
>
> Program in Computational Biology
> Division of Public Health Sciences
> Fred Hutchinson Cancer Research Center
> 1100 Fairview Ave. N, M1-B514
> P.O. Box 19024
> Seattle, WA 98109-1024
>
> E-mail: hpages at fredhutch.org
> Phone:  (206) 667-5791
> Fax:    (206) 667-1319
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From mehmet.suzen at gmail.com  Tue Jan 30 23:58:23 2018
From: mehmet.suzen at gmail.com (Suzen, Mehmet)
Date: Tue, 30 Jan 2018 23:58:23 +0100
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <CY4PR2001MB10641A6B87B06111469FDBD0BEE40@CY4PR2001MB1064.namprd20.prod.outlook.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CY4PR2001MB10641A6B87B06111469FDBD0BEE40@CY4PR2001MB1064.namprd20.prod.outlook.com>
Message-ID: <CAPtbhHw4it+OU1rO=jhvCkCMBwCa0sGD7ykZXyCJwtWnAwze0A@mail.gmail.com>

On 30 January 2018 at 21:31, Cook, Malcolm <MEC at stowers.org> wrote:
>
> I think you want to see the approach to generating a skeleton from a single .R file presented in:
>
>         Simple and sustainable R packaging using inlinedocs http://inlinedocs.r-forge.r-project.org/
>
> I have not used it in some time but found it invaluable when I did.

For the record, the package has a JSS article as well:

https://www.jstatsoft.org/article/view/v054i06


Best,
-m


From mehmet.suzen at gmail.com  Wed Jan 31 00:07:14 2018
From: mehmet.suzen at gmail.com (Suzen, Mehmet)
Date: Wed, 31 Jan 2018 00:07:14 +0100
Subject: [Rd] Why R should never move to git
Message-ID: <CAPtbhHyAFQq8Yh-BOtmuotTUAejzUiGmBjJm0wzH5TgVYNwkaA@mail.gmail.com>

This might be off topic, but if R-core development ever moves to git,
I think it would make sense to have its own git service hosted by a
university, rather than using
github or gitlab. It is possible via https://gogs.io/ project.

Just for the record.

Best,
-m


From csardi.gabor at gmail.com  Wed Jan 31 00:26:07 2018
From: csardi.gabor at gmail.com (=?UTF-8?B?R8OhYm9yIENzw6FyZGk=?=)
Date: Tue, 30 Jan 2018 23:26:07 +0000
Subject: [Rd] Why R should never move to git
In-Reply-To: <CAPtbhHyAFQq8Yh-BOtmuotTUAejzUiGmBjJm0wzH5TgVYNwkaA@mail.gmail.com>
References: <CAPtbhHyAFQq8Yh-BOtmuotTUAejzUiGmBjJm0wzH5TgVYNwkaA@mail.gmail.com>
Message-ID: <CABtg=KkUwQf8HNE9Ke2gv29gVjNp+Rg-AVWO8a2F-ca+G1tjFA@mail.gmail.com>

While this is a very hypothetical argument, you could at least explain
_why_ you would think so.

If you were thinking about the unlikely event of GitHub / GitLab
closing business, that is _not_ such a big to any active project that
is hosted there.

Gabor

On Tue, Jan 30, 2018 at 11:07 PM, Suzen, Mehmet <mehmet.suzen at gmail.com> wrote:
> This might be off topic, but if R-core development ever moves to git,
> I think it would make sense to have its own git service hosted by a
> university, rather than using
> github or gitlab. It is possible via https://gogs.io/ project.
>
> Just for the record.
>
> Best,
> -m
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From mehmet.suzen at gmail.com  Wed Jan 31 00:38:43 2018
From: mehmet.suzen at gmail.com (Suzen, Mehmet)
Date: Wed, 31 Jan 2018 00:38:43 +0100
Subject: [Rd] Why R should never move to git
In-Reply-To: <CABtg=KkUwQf8HNE9Ke2gv29gVjNp+Rg-AVWO8a2F-ca+G1tjFA@mail.gmail.com>
References: <CAPtbhHyAFQq8Yh-BOtmuotTUAejzUiGmBjJm0wzH5TgVYNwkaA@mail.gmail.com>
 <CABtg=KkUwQf8HNE9Ke2gv29gVjNp+Rg-AVWO8a2F-ca+G1tjFA@mail.gmail.com>
Message-ID: <CAPtbhHyYnR76A9nabMqSJzxkLCSFuKy+60XbYUC1xDNpfjdkPA@mail.gmail.com>

Gabor, I was just pointing out options. I think it is more of a policy
decision than a technical one. For example, the very mailing list we
are using is run by ETH Zurich with Martin Maechler. But it can well
be run on google groups. Maybe this list should also move to google
groups, it is unlikely that Google would shut down google groups soon.

Best,
-m

On 31 January 2018 at 00:26, G?bor Cs?rdi <csardi.gabor at gmail.com> wrote:
> While this is a very hypothetical argument, you could at least explain
> _why_ you would think so.
>
> If you were thinking about the unlikely event of GitHub / GitLab
> closing business, that is _not_ such a big to any active project that
> is hosted there.
>
> Gabor
>
> On Tue, Jan 30, 2018 at 11:07 PM, Suzen, Mehmet <mehmet.suzen at gmail.com> wrote:
>> This might be off topic, but if R-core development ever moves to git,
>> I think it would make sense to have its own git service hosted by a
>> university, rather than using
>> github or gitlab. It is possible via https://gogs.io/ project.
>>
>> Just for the record.
>>
>> Best,
>> -m
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel


From hpages at fredhutch.org  Wed Jan 31 00:47:33 2018
From: hpages at fredhutch.org (=?UTF-8?B?SGVydsOpIFBhZ8Oocw==?=)
Date: Tue, 30 Jan 2018 15:47:33 -0800
Subject: [Rd] as.list method for by Objects
In-Reply-To: <CAOQ5Nye8vFGjheY+QW1H5-Am6BN+V_jKGuCe8=_YbeMQyQFGkA@mail.gmail.com>
References: <SY3PR01MB07474F9CEBBC61FD2A152E58CDE40@SY3PR01MB0747.ausprd01.prod.outlook.com>
 <02275be4-b015-0860-8733-efb2b6b17996@fredhutch.org>
 <CADwqtCO98pTE6G4xOva3pVEEA0jSMND9zepcR19B-8rZ6mhYRg@mail.gmail.com>
 <f2080a27-71e0-4f52-61cd-2c2a8bb8e8cd@fredhutch.org>
 <CAOQ5Nye8vFGjheY+QW1H5-Am6BN+V_jKGuCe8=_YbeMQyQFGkA@mail.gmail.com>
Message-ID: <74406925-3fbb-67d6-5afa-2d18f0b00513@fredhutch.org>

On 01/30/2018 02:50 PM, Michael Lawrence wrote:
> by() does not always return a list. In Gabe's example, it returns an 
> integer, thus it is coerced to a list. as.list() means that it should be 
> a VECSXP, not necessarily with "list" in the class attribute.

The documentation is not particularly clear about what as.list()
means for list derivatives. IMO clarifications should stick to
simple concepts and formulations like "is.list(x) is TRUE" or
"x is a list or a list derivative" rather than "x is a VECSXP".
Coercion is useful beyond the use case of implementing a .C entry
point and calling as.numeric/as.list/etc... on its arguments.

This is why I was hoping that we could maybe discuss the possibility
of making the as.list() contract less vague than just "as.list()
must return a list or a list derivative".

Again, I think that 2 things weight quite a lot in that discussion:
   1) as.list() returns an object of class "data.frame" on a
      data.frame (strict coercion). If all what as.list() needed to
      do was to return a VECSXP, then as.list.default() already does
      this on a data.frame so why did someone bother adding an
      as.list.data.frame method that does strict coercion?
   2) The S4 coercion system based on as() does strict coercion by
      default.

H.

> 
> Michael
> 
> On Tue, Jan 30, 2018 at 2:41 PM, Herv? Pag?s <hpages at fredhutch.org 
> <mailto:hpages at fredhutch.org>> wrote:
> 
>     Hi Gabe,
> 
>     Interestingly the behavior of as.list() on by objects seem to
>     depend on the object itself:
> 
>      > b1 <- by(1:2, 1:2, identity)
>      > class(as.list(b1))
>     [1] "list"
> 
>      > b2 <- by(warpbreaks[, 1:2], warpbreaks[,"tension"], summary)
>      > class(as.list(b2))
>     [1] "by"
> 
>     This is with R 3.4.3 and R devel (2017-12-11 r73889).
> 
>     H.
> 
>     On 01/30/2018 02:33 PM, Gabriel Becker wrote:
> 
>         Dario,
> 
>         What version of R are you using. In my mildly old 3.4.0
>         installation and in the version of Revel I have lying around
>         (also mildly old...) ?I don't see the behavior I think you are
>         describing
> 
>          ? ? > b = by(1:2, 1:2, identity)
> 
>          ? ? > class(as.list(b))
> 
>          ? ? [1] "list"
> 
>          ? ? > sessionInfo()
> 
>          ? ? R Under development (unstable) (2017-12-19 r73926)
> 
>          ? ? Platform: x86_64-apple-darwin15.6.0 (64-bit)
> 
>          ? ? Running under: OS X El Capitan 10.11.6
> 
> 
>          ? ? Matrix products: default
> 
>          ? ? BLAS:
>             
>         /Users/beckerg4/local/Rdevel/R.framework/Versions/3.5/Resources/lib/libRblas.dylib
> 
>          ? ? LAPACK:
>             
>         /Users/beckerg4/local/Rdevel/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib
> 
> 
>          ? ? locale:
> 
>          ? ? [1]
>         en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
> 
> 
>          ? ? attached base packages:
> 
>          ? ? [1] stats ? ? graphics? grDevices utils ? ? datasets 
>         methods ? base
> 
> 
>          ? ? loaded via a namespace (and not attached):
> 
>          ? ? [1] compiler_3.5.0
> 
>          ? ? >
> 
> 
>         As for by not having a class definition, no S3 class has an
>         explicit definition, so this is somewhat par for the course here...
> 
>         did I misunderstand something?
> 
> 
>         ~G
> 
>         On Tue, Jan 30, 2018 at 2:24 PM, Herv? Pag?s
>         <hpages at fredhutch.org <mailto:hpages at fredhutch.org>
>         <mailto:hpages at fredhutch.org <mailto:hpages at fredhutch.org>>> wrote:
> 
>          ? ? I agree that it makes sense to expect as.list() to perform
>          ? ? a "strict coercion" i.e. to return an object of class "list",
>          ? ? *even* on a list derivative. That's what as( , "list") does
>          ? ? by default:
> 
>          ? ? ?? # on a data.frame object
>          ? ? ?? as(data.frame(), "list")? # object of class "list"
>          ? ? ?? ? ? ? ? ? ? ? ? ? ? ? ? ? # (but strangely it drops the
>         names)
> 
>          ? ? ?? # on a by object
>          ? ? ?? x <- by(warpbreaks[, 1:2], warpbreaks[,"tension"], summary)
>          ? ? ?? as(x, "list")? # object of class "list"
> 
>          ? ? More generally speaking as() is expected to perform "strict
>          ? ? coercion" by default, unless called with 'strict=FALSE'.
> 
>          ? ? That's also what as.list() does on a data.frame:
> 
>          ? ? ?? as.list(data.frame())? # object of class "list"
> 
>          ? ? FWIW as.numeric() also performs "strict coercion" on an integer
>          ? ? vector:
> 
>          ? ? ?? as.numeric(1:3)? # object of class "numeric"
> 
>          ? ? So an as.list.env method that does the same as as(x, "list")
>          ? ? would bring a small touch of consistency in an otherwise
>          ? ? quite inconsistent world of coercion methods(*).
> 
>          ? ? H.
> 
>          ? ? (*) as(data.frame(), "list", strict=FALSE) doesn't do what
>         you'd
>          ? ? ?? ? expect (just one of many examples)
> 
> 
>          ? ? On 01/29/2018 05:00 PM, Dario Strbenac wrote:
> 
>          ? ? ? ? Good day,
> 
>          ? ? ? ? I'd like to suggest the addition of an as.list method
>         for a by
>          ? ? ? ? object that actually returns a list of class "list".
>         This would
>          ? ? ? ? make it safer to do type-checking, because is.list also
>         returns
>          ? ? ? ? TRUE for a data.frame variable and using class(result)
>         == "list"
>          ? ? ? ? is an alternative that only returns TRUE for lists.
>         It's also
>          ? ? ? ? confusing initially that
> 
>          ? ? ? ? ? ? class(x)
> 
>          ? ? ? ? [1] "by"
> 
>          ? ? ? ? ? ? is.list(x)
> 
>          ? ? ? ? [1] TRUE
> 
>          ? ? ? ? since there's no explicit class definition for "by" and no
>          ? ? ? ? mention if it has any superclasses.
> 
>          ? ? ? ? --------------------------------------
>          ? ? ? ? Dario Strbenac
>          ? ? ? ? University of Sydney
>          ? ? ? ? Camperdown NSW 2050
>          ? ? ? ? Australia
> 
>          ? ? ? ? ______________________________________________
>         R-devel at r-project.org <mailto:R-devel at r-project.org>
>         <mailto:R-devel at r-project.org <mailto:R-devel at r-project.org>>
>         mailing list
>         https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=8nXbMrKus1XsG7MluCRy3sluJKKhMVwOPHtudDpYJ4o&s=qDnEZOWalov3E9h1dajp8RLURfRz0-nbwH721jFAcEo&e=
>         <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=8nXbMrKus1XsG7MluCRy3sluJKKhMVwOPHtudDpYJ4o&s=qDnEZOWalov3E9h1dajp8RLURfRz0-nbwH721jFAcEo&e=>
>                 
>         <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=8nXbMrKus1XsG7MluCRy3sluJKKhMVwOPHtudDpYJ4o&s=qDnEZOWalov3E9h1dajp8RLURfRz0-nbwH721jFAcEo&e=
>         <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=8nXbMrKus1XsG7MluCRy3sluJKKhMVwOPHtudDpYJ4o&s=qDnEZOWalov3E9h1dajp8RLURfRz0-nbwH721jFAcEo&e=>>
> 
> 
>          ? ? --? ? ?Herv? Pag?s
> 
>          ? ? Program in Computational Biology
>          ? ? Division of Public Health Sciences
>          ? ? Fred Hutchinson Cancer Research Center
>          ? ? 1100 Fairview Ave. N, M1-B514
>          ? ? P.O. Box 19024
>          ? ? Seattle, WA 98109-1024
> 
>          ? ? E-mail: hpages at fredhutch.org <mailto:hpages at fredhutch.org>
>         <mailto:hpages at fredhutch.org <mailto:hpages at fredhutch.org>>
>          ? ? Phone: (206) 667-5791 <tel:%28206%29%20667-5791>
>         <tel:%28206%29%20667-5791>
>          ? ? Fax: (206) 667-1319 <tel:%28206%29%20667-1319>
>         <tel:%28206%29%20667-1319>
> 
> 
>          ? ? ______________________________________________
>         R-devel at r-project.org <mailto:R-devel at r-project.org>
>         <mailto:R-devel at r-project.org <mailto:R-devel at r-project.org>>
>         mailing list
>         https://stat.ethz.ch/mailman/listinfo/r-devel
>         <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwMFaQ&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=V3BNiysTgyDXd28NM1GGUpZd9lWARN6uc3NIFowctfw&s=bjhWI85o-aZcT2fpOQtgjEy5gacOtmMDpIp2pLfaNmM&e=>
>             
>         <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwMFaQ&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=JIjTy48pWmEOxpHYM6DUHbRRSVwvOXOkgEFuoMhNkm0&s=x29ogWxfEnr2uKDcVEtKDWtB0USw8Xwm4f18WKBO-Dg&e=
>         <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwMFaQ&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=JIjTy48pWmEOxpHYM6DUHbRRSVwvOXOkgEFuoMhNkm0&s=x29ogWxfEnr2uKDcVEtKDWtB0USw8Xwm4f18WKBO-Dg&e=>>
> 
> 
> 
> 
>         -- 
>         Gabriel Becker, PhD
>         Scientist (Bioinformatics)
>         Genentech Research
> 
> 
>     -- 
>     Herv? Pag?s
> 
>     Program in Computational Biology
>     Division of Public Health Sciences
>     Fred Hutchinson Cancer Research Center
>     1100 Fairview Ave. N, M1-B514
>     P.O. Box 19024
>     Seattle, WA 98109-1024
> 
>     E-mail: hpages at fredhutch.org <mailto:hpages at fredhutch.org>
>     Phone: (206) 667-5791 <tel:%28206%29%20667-5791>
>     Fax: (206) 667-1319 <tel:%28206%29%20667-1319>
> 
>     ______________________________________________
>     R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-devel
>     <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Ddevel&d=DwMFaQ&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=V3BNiysTgyDXd28NM1GGUpZd9lWARN6uc3NIFowctfw&s=bjhWI85o-aZcT2fpOQtgjEy5gacOtmMDpIp2pLfaNmM&e=>
> 
> 

-- 
Herv? Pag?s

Program in Computational Biology
Division of Public Health Sciences
Fred Hutchinson Cancer Research Center
1100 Fairview Ave. N, M1-B514
P.O. Box 19024
Seattle, WA 98109-1024

E-mail: hpages at fredhutch.org
Phone:  (206) 667-5791
Fax:    (206) 667-1319


From lawrence.michael at gene.com  Wed Jan 31 00:57:42 2018
From: lawrence.michael at gene.com (Michael Lawrence)
Date: Tue, 30 Jan 2018 15:57:42 -0800
Subject: [Rd] as.list method for by Objects
In-Reply-To: <74406925-3fbb-67d6-5afa-2d18f0b00513@fredhutch.org>
References: <SY3PR01MB07474F9CEBBC61FD2A152E58CDE40@SY3PR01MB0747.ausprd01.prod.outlook.com>
 <02275be4-b015-0860-8733-efb2b6b17996@fredhutch.org>
 <CADwqtCO98pTE6G4xOva3pVEEA0jSMND9zepcR19B-8rZ6mhYRg@mail.gmail.com>
 <f2080a27-71e0-4f52-61cd-2c2a8bb8e8cd@fredhutch.org>
 <CAOQ5Nye8vFGjheY+QW1H5-Am6BN+V_jKGuCe8=_YbeMQyQFGkA@mail.gmail.com>
 <74406925-3fbb-67d6-5afa-2d18f0b00513@fredhutch.org>
Message-ID: <CAOQ5NyegUu+9sGCuT4HZpP8vqJncPB5TckLXteS2zNSdtE9zTQ@mail.gmail.com>

I just meant that the minimal contract for as.list() appears to be that it
returns a VECSXP. To the user, we might say that is.list() will always
return TRUE. I'm not sure we can expect consistency across methods beyond
that, nor is it feasible at this point to match the semantics of the
methods package. It deals in "class space" while as.list() deals in
"typeof() space".

Michael

On Tue, Jan 30, 2018 at 3:47 PM, Herv? Pag?s <hpages at fredhutch.org> wrote:

> On 01/30/2018 02:50 PM, Michael Lawrence wrote:
>
>> by() does not always return a list. In Gabe's example, it returns an
>> integer, thus it is coerced to a list. as.list() means that it should be a
>> VECSXP, not necessarily with "list" in the class attribute.
>>
>
> The documentation is not particularly clear about what as.list()
> means for list derivatives. IMO clarifications should stick to
> simple concepts and formulations like "is.list(x) is TRUE" or
> "x is a list or a list derivative" rather than "x is a VECSXP".
> Coercion is useful beyond the use case of implementing a .C entry
> point and calling as.numeric/as.list/etc... on its arguments.
>
> This is why I was hoping that we could maybe discuss the possibility
> of making the as.list() contract less vague than just "as.list()
> must return a list or a list derivative".
>
> Again, I think that 2 things weight quite a lot in that discussion:
>   1) as.list() returns an object of class "data.frame" on a
>      data.frame (strict coercion). If all what as.list() needed to
>      do was to return a VECSXP, then as.list.default() already does
>      this on a data.frame so why did someone bother adding an
>      as.list.data.frame method that does strict coercion?
>   2) The S4 coercion system based on as() does strict coercion by
>      default.
>
> H.
>
>
>> Michael
>>
>>
>> On Tue, Jan 30, 2018 at 2:41 PM, Herv? Pag?s <hpages at fredhutch.org
>> <mailto:hpages at fredhutch.org>> wrote:
>>
>>     Hi Gabe,
>>
>>     Interestingly the behavior of as.list() on by objects seem to
>>     depend on the object itself:
>>
>>      > b1 <- by(1:2, 1:2, identity)
>>      > class(as.list(b1))
>>     [1] "list"
>>
>>      > b2 <- by(warpbreaks[, 1:2], warpbreaks[,"tension"], summary)
>>      > class(as.list(b2))
>>     [1] "by"
>>
>>     This is with R 3.4.3 and R devel (2017-12-11 r73889).
>>
>>     H.
>>
>>     On 01/30/2018 02:33 PM, Gabriel Becker wrote:
>>
>>         Dario,
>>
>>         What version of R are you using. In my mildly old 3.4.0
>>         installation and in the version of Revel I have lying around
>>         (also mildly old...)  I don't see the behavior I think you are
>>         describing
>>
>>              > b = by(1:2, 1:2, identity)
>>
>>              > class(as.list(b))
>>
>>              [1] "list"
>>
>>              > sessionInfo()
>>
>>              R Under development (unstable) (2017-12-19 r73926)
>>
>>              Platform: x86_64-apple-darwin15.6.0 (64-bit)
>>
>>              Running under: OS X El Capitan 10.11.6
>>
>>
>>              Matrix products: default
>>
>>              BLAS:
>>                     /Users/beckerg4/local/Rdevel/R
>> .framework/Versions/3.5/Resources/lib/libRblas.dylib
>>
>>              LAPACK:
>>                     /Users/beckerg4/local/Rdevel/R
>> .framework/Versions/3.5/Resources/lib/libRlapack.dylib
>>
>>
>>              locale:
>>
>>              [1]
>>         en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>
>>
>>              attached base packages:
>>
>>              [1] stats     graphics  grDevices utils     datasets
>>  methods   base
>>
>>
>>              loaded via a namespace (and not attached):
>>
>>              [1] compiler_3.5.0
>>
>>              >
>>
>>
>>         As for by not having a class definition, no S3 class has an
>>         explicit definition, so this is somewhat par for the course
>> here...
>>
>>         did I misunderstand something?
>>
>>
>>         ~G
>>
>>         On Tue, Jan 30, 2018 at 2:24 PM, Herv? Pag?s
>>         <hpages at fredhutch.org <mailto:hpages at fredhutch.org>
>>         <mailto:hpages at fredhutch.org <mailto:hpages at fredhutch.org>>>
>> wrote:
>>
>>              I agree that it makes sense to expect as.list() to perform
>>              a "strict coercion" i.e. to return an object of class "list",
>>              *even* on a list derivative. That's what as( , "list") does
>>              by default:
>>
>>                 # on a data.frame object
>>                 as(data.frame(), "list")  # object of class "list"
>>                                           # (but strangely it drops the
>>         names)
>>
>>                 # on a by object
>>                 x <- by(warpbreaks[, 1:2], warpbreaks[,"tension"],
>> summary)
>>                 as(x, "list")  # object of class "list"
>>
>>              More generally speaking as() is expected to perform "strict
>>              coercion" by default, unless called with 'strict=FALSE'.
>>
>>              That's also what as.list() does on a data.frame:
>>
>>                 as.list(data.frame())  # object of class "list"
>>
>>              FWIW as.numeric() also performs "strict coercion" on an
>> integer
>>              vector:
>>
>>                 as.numeric(1:3)  # object of class "numeric"
>>
>>              So an as.list.env method that does the same as as(x, "list")
>>              would bring a small touch of consistency in an otherwise
>>              quite inconsistent world of coercion methods(*).
>>
>>              H.
>>
>>              (*) as(data.frame(), "list", strict=FALSE) doesn't do what
>>         you'd
>>                   expect (just one of many examples)
>>
>>
>>              On 01/29/2018 05:00 PM, Dario Strbenac wrote:
>>
>>                  Good day,
>>
>>                  I'd like to suggest the addition of an as.list method
>>         for a by
>>                  object that actually returns a list of class "list".
>>         This would
>>                  make it safer to do type-checking, because is.list also
>>         returns
>>                  TRUE for a data.frame variable and using class(result)
>>         == "list"
>>                  is an alternative that only returns TRUE for lists.
>>         It's also
>>                  confusing initially that
>>
>>                      class(x)
>>
>>                  [1] "by"
>>
>>                      is.list(x)
>>
>>                  [1] TRUE
>>
>>                  since there's no explicit class definition for "by" and
>> no
>>                  mention if it has any superclasses.
>>
>>                  --------------------------------------
>>                  Dario Strbenac
>>                  University of Sydney
>>                  Camperdown NSW 2050
>>                  Australia
>>
>>                  ______________________________________________
>>         R-devel at r-project.org <mailto:R-devel at r-project.org>
>>         <mailto:R-devel at r-project.org <mailto:R-devel at r-project.org>>
>>         mailing list
>>         https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.et
>> hz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84V
>> tBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=8nXbM
>> rKus1XsG7MluCRy3sluJKKhMVwOPHtudDpYJ4o&s=qDnEZOWalov3E9h1daj
>> p8RLURfRz0-nbwH721jFAcEo&e=
>>         <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.
>> ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAf
>> qt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=
>> 8nXbMrKus1XsG7MluCRy3sluJKKhMVwOPHtudDpYJ4o&s=qDnEZOWalov3E9
>> h1dajp8RLURfRz0-nbwH721jFAcEo&e=>
>>                         <https://urldefense.proofpoint
>> .com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-
>> 2Ddevel&d=DwICAg&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGb
>> WY_wJYbW0WYiZvSXAJJKaaPhzWA&m=8nXbMrKus1XsG7MluCRy3sluJKKhMV
>> wOPHtudDpYJ4o&s=qDnEZOWalov3E9h1dajp8RLURfRz0-nbwH721jFAcEo&e=
>>         <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.
>> ethz.ch_mailman_listinfo_r-2Ddevel&d=DwICAg&c=eRAMFD45gAf
>> qt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=
>> 8nXbMrKus1XsG7MluCRy3sluJKKhMVwOPHtudDpYJ4o&s=qDnEZOWalov3E9
>> h1dajp8RLURfRz0-nbwH721jFAcEo&e=>>
>>
>>
>>              --     Herv? Pag?s
>>
>>              Program in Computational Biology
>>              Division of Public Health Sciences
>>              Fred Hutchinson Cancer Research Center
>>              1100 Fairview Ave. N, M1-B514
>>              P.O. Box 19024
>>              Seattle, WA 98109-1024
>>
>>              E-mail: hpages at fredhutch.org <mailto:hpages at fredhutch.org>
>>         <mailto:hpages at fredhutch.org <mailto:hpages at fredhutch.org>>
>>              Phone: (206) 667-5791 <tel:%28206%29%20667-5791>
>>         <tel:%28206%29%20667-5791>
>>              Fax: (206) 667-1319 <tel:%28206%29%20667-1319>
>>         <tel:%28206%29%20667-1319>
>>
>>
>>              ______________________________________________
>>         R-devel at r-project.org <mailto:R-devel at r-project.org>
>>         <mailto:R-devel at r-project.org <mailto:R-devel at r-project.org>>
>>         mailing list
>>         https://stat.ethz.ch/mailman/listinfo/r-devel
>>         <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.
>> ethz.ch_mailman_listinfo_r-2Ddevel&d=DwMFaQ&c=eRAMFD45gAf
>> qt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=
>> V3BNiysTgyDXd28NM1GGUpZd9lWARN6uc3NIFowctfw&s=bjhWI85o-aZcT2
>> fpOQtgjEy5gacOtmMDpIp2pLfaNmM&e=>
>>                     <https://urldefense.proofpoint
>> .com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-
>> 2Ddevel&d=DwMFaQ&c=eRAMFD45gAfqt84VtBcfhQ&r=BK7q3XeAvimeWdGb
>> WY_wJYbW0WYiZvSXAJJKaaPhzWA&m=JIjTy48pWmEOxpHYM6DUHbRRSVwvOX
>> OkgEFuoMhNkm0&s=x29ogWxfEnr2uKDcVEtKDWtB0USw8Xwm4f18WKBO-Dg&e=
>>         <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.
>> ethz.ch_mailman_listinfo_r-2Ddevel&d=DwMFaQ&c=eRAMFD45gAf
>> qt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=
>> JIjTy48pWmEOxpHYM6DUHbRRSVwvOXOkgEFuoMhNkm0&s=x29ogWxfEnr2uK
>> DcVEtKDWtB0USw8Xwm4f18WKBO-Dg&e=>>
>>
>>
>>
>>
>>         --         Gabriel Becker, PhD
>>         Scientist (Bioinformatics)
>>         Genentech Research
>>
>>
>>     --     Herv? Pag?s
>>
>>     Program in Computational Biology
>>     Division of Public Health Sciences
>>     Fred Hutchinson Cancer Research Center
>>     1100 Fairview Ave. N, M1-B514
>>     P.O. Box 19024
>>     Seattle, WA 98109-1024
>>
>>     E-mail: hpages at fredhutch.org <mailto:hpages at fredhutch.org>
>>     Phone: (206) 667-5791 <tel:%28206%29%20667-5791>
>>     Fax: (206) 667-1319 <tel:%28206%29%20667-1319>
>>
>>     ______________________________________________
>>     R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>>     https://stat.ethz.ch/mailman/listinfo/r-devel
>>     <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.
>> ethz.ch_mailman_listinfo_r-2Ddevel&d=DwMFaQ&c=eRAMFD45gAf
>> qt84VtBcfhQ&r=BK7q3XeAvimeWdGbWY_wJYbW0WYiZvSXAJJKaaPhzWA&m=
>> V3BNiysTgyDXd28NM1GGUpZd9lWARN6uc3NIFowctfw&s=bjhWI85o-aZcT2
>> fpOQtgjEy5gacOtmMDpIp2pLfaNmM&e=>
>>
>>
>>
> --
> Herv? Pag?s
>
> Program in Computational Biology
> Division of Public Health Sciences
> Fred Hutchinson Cancer Research Center
> 1100 Fairview Ave. N, M1-B514
> P.O. Box 19024
> Seattle, WA 98109-1024
>
> E-mail: hpages at fredhutch.org
> Phone:  (206) 667-5791
> Fax:    (206) 667-1319
>

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Wed Jan 31 01:55:07 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 30 Jan 2018 19:55:07 -0500
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <CAPekMCkWYvdGJ=wXA3bGFs655xsV6RUFCCjFpcpZ4rjmB8u-VQ@mail.gmail.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CY4PR2001MB10641A6B87B06111469FDBD0BEE40@CY4PR2001MB1064.namprd20.prod.outlook.com>
 <23152.57287.697853.990831@rob.eddelbuettel.com>
 <CAPekMCkWYvdGJ=wXA3bGFs655xsV6RUFCCjFpcpZ4rjmB8u-VQ@mail.gmail.com>
Message-ID: <a8fbf26f-5a4c-3526-68a5-e062a596313c@gmail.com>

On 30/01/2018 4:30 PM, Kenny Bell wrote:
> In response to Duncan regarding the use of roxygen2 from the point of view
> of a current user, I believe the issue he brings up is one of correlation
> rather than causation.

Could be.  However, I think editing comments in a .R file is a bit 
harder than editing text in a .Rd file, so I think the format 
discourages editing.  I think it does make it easier to pass R CMD check 
the first time, but I don't think you should be satisfied with that.

What would probably change my mind would be a two-way (or multi-way) 
tool:  it takes input in Roxygen comments or Rd files (or something 
else), and produces another format.  Then I'd probably choose to write 
the first pass in Roxygen, and convert to Rd for editing.  Other people 
might go in the opposite direction.  Or someone might write a fancy 
WYSIWYG editor for people who like that style of editing.

A couple of years ago I was hoping someone would figure out a way to 
create help page input in R Markdown, but I think that's tricky because 
of the lack of semantic markup there.  There *was* a project last year 
to work on other input methods; I dropped out before it got very far, 
and I don't know its current status.

> 
> Writing my first piece of R documentation was made much easier by using
> roxygen2, and it shallowed the learning curve substantially.

I'm not completely up to date on Roxygen2 these days:  can you do some 
pages in Rd, others in Roxygen?  That's not quite as good as being able 
to switch back and forth, but it would allow you to start in Roxygen, 
then gradually move to Rd when editing there was easier.

> 
> What Duncan may be observing is a general tendency of roxygen2 users to
> write overly concise documentation. However, I believe this to be caused by
> an omitted variable - likely the tendency of roxygen2 users to want outputs
> quickly. I can't see anything in roxygen2 that might suggest a causal link
> but I'd be interested in hearing specific examples.

I don't know about that.  *Everyone* wants output quickly.

Duncan Murdoch


> FWIW, I've also heard the same documentation criticism leveled at R in
> general (mostly from Stata and MATLAB users).
> 
> Kenny
> 
> On Wed, Jan 31, 2018, 10:12 AM Dirk Eddelbuettel <edd at debian.org> wrote:
> 
>>
>> Mehmet,
>>
>> That is a loaded topic, not unlikely other topics preoccupying us these
>> days.
>>
>> There is package.skeleton() in base R as you already mentioned. It drove me
>> bonkers that it creates packages which then fail R CMD check, so I wrote a
>> wrapper package (pkgKitten) with another helper function (kitten()) which
>> calls the base R helper and then cleans up it---but otherwise remains
>> faithful to it.
>>
>> These days pkgKitten defaults to creating per-package top-level help page
>> that just references content from DESCRIPTION via a set of newer Rd macros
>> as
>> I find that helps keeping them aligned. The most recent example of mine is
>>    https://github.com/eddelbuettel/prrd/blob/master/man/prrd-package.Rd
>> I use either this function or the RStudio template helper all the time.
>>
>> And similarly, other people written similar helpers. You may get other
>> pointers.
>>
>> And every couple of months someone writes a new tutorial about how to
>> write a
>> first package. Then social media goes gaga and we get half a dozen blog
>> posts
>> where someone celebrates finding said tutorial, reading it and following
>> through with a new package.
>>
>> And many of us taught workshops on creating packages. There is a lot of
>> material out here, though lots of this material seems to be entirely
>> ignorant
>> of what came before it.
>>
>> And there has been lots, including Fritz's tutorial from a decade ago:
>>
>>      https://epub.ub.uni-muenchen.de/6175/  as well as on CRAN as
>>      https://cran.r-project.org/doc/contrib/Leisch-CreatingPackages.pdf
>>
>> So I'd recommend you just experiment and set up your own helpers. After all
>> the rule still holds: Anything you do more than three times should be a
>> function, and every function should be in a package. So customize _your_
>> function to create your package.
>>
>> Dirk
>>
>> --
>> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
> 
> 	[[alternative HTML version deleted]]
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


From murdoch.duncan at gmail.com  Wed Jan 31 02:09:52 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Tue, 30 Jan 2018 20:09:52 -0500
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <23152.57287.697853.990831@rob.eddelbuettel.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CY4PR2001MB10641A6B87B06111469FDBD0BEE40@CY4PR2001MB1064.namprd20.prod.outlook.com>
 <23152.57287.697853.990831@rob.eddelbuettel.com>
Message-ID: <ac51f4f1-c71e-9555-9668-10e2c880c04a@gmail.com>

On 30/01/2018 4:12 PM, Dirk Eddelbuettel wrote:
> 
> Mehmet,
> 
> That is a loaded topic, not unlikely other topics preoccupying us these days.
> 
> There is package.skeleton() in base R as you already mentioned. It drove me
> bonkers that it creates packages which then fail R CMD check, so I wrote a
> wrapper package (pkgKitten) with another helper function (kitten()) which
> calls the base R helper and then cleans up it---but otherwise remains
> faithful to it.

Failing R CMD check isn't a big deal:  you want to be reminded to edit 
those incomplete help files.  But I think I recall that you couldn't 
even build the package that package.skeleton() created, and that indeed 
would be irritating, especially if you had a lot of functions so you had 
a lot of cleanup to do.  I don't know if that's still true because I 
generally use RStudio to create the initial package structure rather 
than calling package.skeleton myself.

Duncan Murdoch

> 
> These days pkgKitten defaults to creating per-package top-level help page
> that just references content from DESCRIPTION via a set of newer Rd macros as
> I find that helps keeping them aligned. The most recent example of mine is
>    https://github.com/eddelbuettel/prrd/blob/master/man/prrd-package.Rd
> I use either this function or the RStudio template helper all the time.
> 
> And similarly, other people written similar helpers. You may get other pointers.
> 
> And every couple of months someone writes a new tutorial about how to write a
> first package. Then social media goes gaga and we get half a dozen blog posts
> where someone celebrates finding said tutorial, reading it and following
> through with a new package.
> 
> And many of us taught workshops on creating packages. There is a lot of
> material out here, though lots of this material seems to be entirely ignorant
> of what came before it.
> 
> And there has been lots, including Fritz's tutorial from a decade ago:
> 
>      https://epub.ub.uni-muenchen.de/6175/  as well as on CRAN as
>      https://cran.r-project.org/doc/contrib/Leisch-CreatingPackages.pdf
> 
> So I'd recommend you just experiment and set up your own helpers. After all
> the rule still holds: Anything you do more than three times should be a
> function, and every function should be in a package. So customize _your_
> function to create your package.
> 
> Dirk
>


From h.wickham at gmail.com  Wed Jan 31 05:39:14 2018
From: h.wickham at gmail.com (Hadley Wickham)
Date: Tue, 30 Jan 2018 20:39:14 -0800
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <a8fbf26f-5a4c-3526-68a5-e062a596313c@gmail.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CY4PR2001MB10641A6B87B06111469FDBD0BEE40@CY4PR2001MB1064.namprd20.prod.outlook.com>
 <23152.57287.697853.990831@rob.eddelbuettel.com>
 <CAPekMCkWYvdGJ=wXA3bGFs655xsV6RUFCCjFpcpZ4rjmB8u-VQ@mail.gmail.com>
 <a8fbf26f-5a4c-3526-68a5-e062a596313c@gmail.com>
Message-ID: <CABdHhvGGCpjFa-dPiK6fHLfVzCzZ3PboGSH9c8Jy+daW14vSNg@mail.gmail.com>

On Tue, Jan 30, 2018 at 4:55 PM, Duncan Murdoch
<murdoch.duncan at gmail.com> wrote:
> On 30/01/2018 4:30 PM, Kenny Bell wrote:
>>
>> In response to Duncan regarding the use of roxygen2 from the point of view
>> of a current user, I believe the issue he brings up is one of correlation
>> rather than causation.
>
>
> Could be.  However, I think editing comments in a .R file is a bit harder
> than editing text in a .Rd file, so I think the format discourages editing.
> I think it does make it easier to pass R CMD check the first time, but I
> don't think you should be satisfied with that.

One counter-point: I find it much easier to remember to update the
documentation when you update the code, if the code and the
documentation are very close together. I think mingling code and
documentation in the same file does add a subtle pressure to write
shorter docs, but I'm not entirely sure that's a bad thing - for long
form writing, vignettes are a much better solution anyway (since you
often want to mingle code and explanation).

Personally, I don't find writing in comments any harder than writing
in .Rd files, especially now that you can write in markdown and have
it automatically translated to Rd formatting commands.  And on the
negative side of Rd, I find it frustrating to have to copy and paste
the function definition to the usage section every time I modify an
argument. It just feels like unnecessary busywork that the computer
should be able to do for me (although I do understand why it is not
possible).

>> Writing my first piece of R documentation was made much easier by using
>> roxygen2, and it shallowed the learning curve substantially.
>
> I'm not completely up to date on Roxygen2 these days:  can you do some pages
> in Rd, others in Roxygen?  That's not quite as good as being able to switch
> back and forth, but it would allow you to start in Roxygen, then gradually
> move to Rd when editing there was easier.

Yes, that's possible, and to protect you in mixed environment,
roxygen2 will never overwrite a file that it did not itself create.

Hadley

-- 
http://hadley.nz


From h.wickham at gmail.com  Wed Jan 31 05:44:31 2018
From: h.wickham at gmail.com (Hadley Wickham)
Date: Tue, 30 Jan 2018 20:44:31 -0800
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <ac51f4f1-c71e-9555-9668-10e2c880c04a@gmail.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CY4PR2001MB10641A6B87B06111469FDBD0BEE40@CY4PR2001MB1064.namprd20.prod.outlook.com>
 <23152.57287.697853.990831@rob.eddelbuettel.com>
 <ac51f4f1-c71e-9555-9668-10e2c880c04a@gmail.com>
Message-ID: <CABdHhvHaZCDnetJL+QW+-1moka-wy4+DtihM2M9nD8u_Yay6Og@mail.gmail.com>

>> There is package.skeleton() in base R as you already mentioned. It drove
>> me
>> bonkers that it creates packages which then fail R CMD check, so I wrote a
>> wrapper package (pkgKitten) with another helper function (kitten()) which
>> calls the base R helper and then cleans up it---but otherwise remains
>> faithful to it.
>
>
> Failing R CMD check isn't a big deal:  you want to be reminded to edit those
> incomplete help files.  But I think I recall that you couldn't even build
> the package that package.skeleton() created, and that indeed would be
> irritating, especially if you had a lot of functions so you had a lot of
> cleanup to do.  I don't know if that's still true because I generally use
> RStudio to create the initial package structure rather than calling
> package.skeleton myself.

Personally, I think the biggest problem with package.skeleton() is
that it assumes that the source of truth is objects in an environment.
This seems the wrong way around to me.

Hadley

-- 
http://hadley.nz


From jorismeys at gmail.com  Wed Jan 31 12:33:50 2018
From: jorismeys at gmail.com (Joris Meys)
Date: Wed, 31 Jan 2018 12:33:50 +0100
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
Message-ID: <CAO1zAVaHnOthsFc9DGbC2+otAhHJ7qRi4hUZrqk67NFwpr6osA@mail.gmail.com>

Dear Duncan,

With all respect, but I strongly disagree on your stance regarding roxygen2
for multiple reasons:

1. It is in my humble opinion not correct to evaluate a tool based on the
abuse of some users. It's not because people write packages with bad
documentation, that roxygen2 is to blame. I use roxygen2, and I care a
great deal about documentation. So I actually took a bit offense there.

2. Writing .Rd files directly means that you have to write out the usage
yourself, know the different tags needed for documenting different types of
generics and methods, and so forth. It means a lot more iterations to get
every tag right so that R CMD check does not complain any more. It requires
a more detailed knowledge of the entire Rd tag system compared to letting
roxygen2 do the standard work for you. So one could argue that the extra
knowledge required would actually hinder starting developers to write good
documentation as opposed to help them.

3. given your criticism, I'd like your opinion on where I can improve the
documentation of https://github.com/CenterForStatistics-UGent/pim. I'm
currently busy updating the help files for a next release on CRAN, so your
input is more than welcome.

I'm not going to force anyone to use roxygen2. But I personally find it
easier to have the function right below the documentation, so that any
change to the function can immediately be documented as well. You prefer to
do this by keeping that strictly separated, which is absolutely fine. It's
just not my prefered workflow. Different animal, different habits I guess.

On a sidenote: I had a lot of complaints about earlier iterations of
roxygen2 and the many changes to tags and their meanings, but the roxygen2
package matured in the meantime and has been a stable and reliable tool for
me the past years.

Kind regards
Joris



On Tue, Jan 30, 2018 at 8:53 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 30/01/2018 11:29 AM, Brian G. Peterson wrote:
>
>> On Tue, 2018-01-30 at 17:00 +0100, Suzen, Mehmet wrote:
>>
>>> Dear R developers,
>>>
>>> I am wondering what are the best practices for developing an R
>>> package. I am aware of Hadley Wickham's best practice
>>> documentation/book (http://r-pkgs.had.co.nz/).  I recall a couple of
>>> years ago there were some tools for generating a package out of a
>>> single file, such as using package.skeleton, but no auto-generated
>>> documentation. Do you know a way to generate documentation and a
>>> package out of single R source file, or from an environment?
>>>
>>
>> Mehmet,
>>
>> This list is for development of the R language itself and closely
>> related tools.  There is a separate list, R-pkg-devel, for development
>> of packages.
>>
>> Since you're here, I'll try to answer your question.
>>
>> package.skeleton can create a package from all the R functions in a
>> specified environment.  So if you load all the functions that you want
>> in your new package into your R environment, then call
>> package.skeleton, you'll have a starting point.
>>
>> At that point, I would probably recommend moving to RStudio, and using
>> RStudio to generate markdown comments for roxygen for all your newly
>> created function files.  Then you could finish off the documentation by
>> writing it in these roxygen skeletons or copying and pasting from
>> comments in your original code files.
>>
>
> I'd agree about moving to RStudio, but I think Roxygen is the wrong
> approach for documentation.  package.skeleton() will have done the boring
> mechanical part of setting up your .Rd files; all you have to do is edit
> some content into them.  (Use prompt() to add a new file if you add a new
> function later, don't run package.skeleton() again.)
>
> This isn't the fashionable point of view, but I think it is easier to get
> good documentation that way than using Roxygen.  (It's easier to get bad
> documentation using Roxygen, but who wants that?)
>
> The reason I think this is that good documentation requires work and
> thought.  You need to think about the markup that will get your point
> across, you need to think about putting together good examples, etc.
> This is *harder* in Roxygen than if you are writing Rd files, because
> Roxygen is a thin front end to produce Rd files from comments in your .R
> files.  To get good stuff in the help page, you need just as much work as
> in writing the .Rd file directly, but then you need to add another layer on
> top to put in in a comment.  Most people don't bother.
>
> I don't know any packages with what I'd consider to be good documentation
> that use Roxygen.  It's just too easy to write minimal documentation that
> passes checks, so Roxygen users don't keep refining it.
>
> (There are plenty of examples of packages that write bad documentation
> directly to .Rd as well.  I just don't know of examples of packages with
> good documentation that use Roxygen.)
>
> Based on my criticism last week of git and Github, I expect to be called a
> grumpy old man for holding this point of view.  I'd actually like to be
> proven wrong.  So to anyone who disagrees with me:  rather than just
> calling me names, how about some examples of Roxygen-using packages that
> have good help pages with good explanations, and good examples in them?
>
> Back to Mehmet's question:  I think Hadley's book is pretty good, and I'd
> recommend most of it, just not the Roxygen part.
>
> Duncan Murdoch
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Joris Meys
Statistical consultant

Department of Data Analysis and Mathematical Modelling
Ghent University
Coupure Links 653, B-9000 Gent (Belgium)
<https://maps.google.com/?q=Coupure+links+653,%C2%A0B-9000+Gent,%C2%A0Belgium&entry=gmail&source=g>

-----------
Biowiskundedagen 2017-2018
http://www.biowiskundedagen.ugent.be/

-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php

	[[alternative HTML version deleted]]


From murdoch.duncan at gmail.com  Wed Jan 31 12:59:18 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 31 Jan 2018 06:59:18 -0500
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <CABdHhvGGCpjFa-dPiK6fHLfVzCzZ3PboGSH9c8Jy+daW14vSNg@mail.gmail.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CY4PR2001MB10641A6B87B06111469FDBD0BEE40@CY4PR2001MB1064.namprd20.prod.outlook.com>
 <23152.57287.697853.990831@rob.eddelbuettel.com>
 <CAPekMCkWYvdGJ=wXA3bGFs655xsV6RUFCCjFpcpZ4rjmB8u-VQ@mail.gmail.com>
 <a8fbf26f-5a4c-3526-68a5-e062a596313c@gmail.com>
 <CABdHhvGGCpjFa-dPiK6fHLfVzCzZ3PboGSH9c8Jy+daW14vSNg@mail.gmail.com>
Message-ID: <89bbc3b2-b173-961d-5cd2-fc83c05600dc@gmail.com>

On 30/01/2018 11:39 PM, Hadley Wickham wrote:
> On Tue, Jan 30, 2018 at 4:55 PM, Duncan Murdoch
> <murdoch.duncan at gmail.com> wrote:
>> On 30/01/2018 4:30 PM, Kenny Bell wrote:
>>>
>>> In response to Duncan regarding the use of roxygen2 from the point of view
>>> of a current user, I believe the issue he brings up is one of correlation
>>> rather than causation.
>>
>>
>> Could be.  However, I think editing comments in a .R file is a bit harder
>> than editing text in a .Rd file, so I think the format discourages editing.
>> I think it does make it easier to pass R CMD check the first time, but I
>> don't think you should be satisfied with that.
> 
> One counter-point: I find it much easier to remember to update the
> documentation when you update the code, if the code and the
> documentation are very close together. I think mingling code and
> documentation in the same file does add a subtle pressure to write
> shorter docs, but I'm not entirely sure that's a bad thing - for long
> form writing, vignettes are a much better solution anyway (since you
> often want to mingle code and explanation).

I agree about your first point to some extent, but it works best when 
the documentation is short.  Once you get a long help page, you still 
have the long distance.  Some functions need long help pages because 
they do a lot.

RStudio provides pretty good support for both forms of documentation. 
If I've just modified a function, I can type the name of the function in 
the "Go to file/function" box at the top, and go directly to the right 
.Rd file.  That reduces the "distance".  I imagine ESS and other editors 
have (or could have) something similar.

Regarding vignettes versus help pages:  I think they have different 
purposes.  You want the technical documentation in the help page to be 
really complete, to explain what each parameter does, what the value is, 
with simple examples.  I won't try to embarrass anyone with specific 
examples (unless someone volunteers ;-), but I would say the general 
trend in Roxygen-using packages is to be quite incomplete, with one-line 
parameter descriptions being all you get.  Sometimes this is sufficient, 
but often it isn't.  The goal appears to be to pass checks, not to write 
good documentation.  Some wild speculation:  maybe the proximity to the 
source makes authors think the source is visible to the user looking for 
help.

Vignettes get to leave out rarely used parameters, but get to show how 
things are used in longer examples, combining multiple functions.  I've 
tried to write the rgl documentation this way, with links from the 
vignette to the help pages.

I haven't added links from the help page to the location in the vignette 
where the function is put in context, but that's probably possible 
(provided HTML help is used, and the vignette is in HTML).

> Personally, I don't find writing in comments any harder than writing
> in .Rd files, especially now that you can write in markdown and have
> it automatically translated to Rd formatting commands.  

I didn't know about the possibility of Markdown.  That's a good thing. 
You didn't say what editor you use, but RStudio is a good guess, and it 
also makes it easier to write in comments.

And on the
> negative side of Rd, I find it frustrating to have to copy and paste
> the function definition to the usage section every time I modify an
> argument. It just feels like unnecessary busywork that the computer
> should be able to do for me (although I do understand why it is not
> possible).

The computer (via R CMD check) does tell you what is missing.  I'd guess 
that the transfer could be done automatically, but it would be in a very 
editor-specific way, e.g. an RStudio add-in, or Emacs macro, or 
whatever.  Someone should write it :-).

> 
>>> Writing my first piece of R documentation was made much easier by using
>>> roxygen2, and it shallowed the learning curve substantially.
>>
>> I'm not completely up to date on Roxygen2 these days:  can you do some pages
>> in Rd, others in Roxygen?  That's not quite as good as being able to switch
>> back and forth, but it would allow you to start in Roxygen, then gradually
>> move to Rd when editing there was easier.
> 
> Yes, that's possible, and to protect you in mixed environment,
> roxygen2 will never overwrite a file that it did not itself create.

Good!  Perhaps I should give it another look.

Duncan


From murdoch.duncan at gmail.com  Wed Jan 31 13:10:07 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 31 Jan 2018 07:10:07 -0500
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <CAO1zAVaHnOthsFc9DGbC2+otAhHJ7qRi4hUZrqk67NFwpr6osA@mail.gmail.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CAO1zAVaHnOthsFc9DGbC2+otAhHJ7qRi4hUZrqk67NFwpr6osA@mail.gmail.com>
Message-ID: <45009bb8-d493-562c-48d5-ebd08871b113@gmail.com>

On 31/01/2018 6:33 AM, Joris Meys wrote:
> Dear Duncan,
> 
> With all respect, but I strongly disagree on your stance regarding 
> roxygen2 for multiple reasons:
> 
> 1. It is in my humble opinion not correct to evaluate a tool based on 
> the abuse of some users. It's not because people write packages with bad 
> documentation, that roxygen2 is to blame. I use roxygen2, and I care a 
> great deal about documentation. So I actually took a bit offense there.

Sorry about that.  I did say I wanted to be proven wrong.

> 2. Writing .Rd files directly means that you have to write out the usage 
> yourself, know the different tags needed for documenting different types 
> of generics and methods, and so forth. 

Not at all --- that's what the prompt() function does.

> It means a lot more iterations to 
> get every tag right so that R CMD check does not complain any more. It 
> requires a more detailed knowledge of the entire Rd tag system compared 
> to letting roxygen2 do the standard work for you. So one could argue 
> that the extra knowledge required would actually hinder starting 
> developers to write good documentation as opposed to help them.

New users (and old users) should use prompt() to set up the basic help page.

There are situations where prompt() doesn't help, namely edits to 
existing pages:

  - adding a second function.
  - adding new parameters.

I think the infrastructure is there to allow functions to be written to
do these things, but as far as I know nobody has done it.

> 
> 3. given your criticism, I'd like your opinion on where I can improve 
> the documentation of https://github.com/CenterForStatistics-UGent/pim. 
> I'm currently busy updating the help files for a next release on CRAN, 
> so your input is more than welcome.

Sure, I'll take a look.

> I'm not going to force anyone to use roxygen2. But I personally find it 
> easier to have the function right below the documentation, so that any 
> change to the function can immediately be documented as well. You prefer 
> to do this by keeping that strictly separated, which is absolutely fine. 
> It's just not my prefered workflow. Different animal, different habits I 
> guess.
> 
> On a sidenote: I had a lot of complaints about earlier iterations of 
> roxygen2 and the many changes to tags and their meanings, but the 
> roxygen2 package matured in the meantime and has been a stable and 
> reliable tool for me the past years.

I formed my opinion several years ago, so perhaps I should take another 
look.  One problem is lock-in:  once you write an Rd file, you can't (as 
far as I know) easily import it as Roxygen markup.  So I'd have to start 
a new package to get experience with Roxygen.  Maybe it should be the 
package that adds the Rd tools mentioned above :-).

Duncan Murdoch

> 
> Kind regards
> Joris
> 
> 
> 
> On Tue, Jan 30, 2018 at 8:53 PM, Duncan Murdoch 
> <murdoch.duncan at gmail.com <mailto:murdoch.duncan at gmail.com>> wrote:
> 
>     On 30/01/2018 11:29 AM, Brian G. Peterson wrote:
> 
>         On Tue, 2018-01-30 at 17:00 +0100, Suzen, Mehmet wrote:
> 
>             Dear R developers,
> 
>             I am wondering what are the best practices for developing an R
>             package. I am aware of Hadley Wickham's best practice
>             documentation/book (http://r-pkgs.had.co.nz/).??I recall a
>             couple of
>             years ago there were some tools for generating a package out
>             of a
>             single file, such as using package.skeleton, but no
>             auto-generated
>             documentation. Do you know a way to generate documentation and a
>             package out of single R source file, or from an environment?
> 
> 
>         Mehmet,
> 
>         This list is for development of the R language itself and closely
>         related tools.? There is a separate list, R-pkg-devel, for
>         development
>         of packages.
> 
>         Since you're here, I'll try to answer your question.
> 
>         package.skeleton can create a package from all the R functions in a
>         specified environment.? So if you load all the functions that
>         you want
>         in your new package into your R environment, then call
>         package.skeleton, you'll have a starting point.
> 
>         At that point, I would probably recommend moving to RStudio, and
>         using
>         RStudio to generate markdown comments for roxygen for all your newly
>         created function files.? Then you could finish off the
>         documentation by
>         writing it in these roxygen skeletons or copying and pasting from
>         comments in your original code files.
> 
> 
>     I'd agree about moving to RStudio, but I think Roxygen is the wrong
>     approach for documentation.? package.skeleton() will have done the
>     boring mechanical part of setting up your .Rd files; all you have to
>     do is edit some content into them.? (Use prompt() to add a new file
>     if you add a new function later, don't run package.skeleton() again.)
> 
>     This isn't the fashionable point of view, but I think it is easier
>     to get good documentation that way than using Roxygen.? (It's easier
>     to get bad documentation using Roxygen, but who wants that?)
> 
>     The reason I think this is that good documentation requires work and
>     thought.? You need to think about the markup that will get your
>     point across, you need to think about putting together good
>     examples, etc.
>     This is *harder* in Roxygen than if you are writing Rd files,
>     because Roxygen is a thin front end to produce Rd files from
>     comments in your .R files.? To get good stuff in the help page, you
>     need just as much work as in writing the .Rd file directly, but then
>     you need to add another layer on top to put in in a comment.? Most
>     people don't bother.
> 
>     I don't know any packages with what I'd consider to be good
>     documentation that use Roxygen.? It's just too easy to write minimal
>     documentation that passes checks, so Roxygen users don't keep
>     refining it.
> 
>     (There are plenty of examples of packages that write bad
>     documentation directly to .Rd as well.? I just don't know of
>     examples of packages with good documentation that use Roxygen.)
> 
>     Based on my criticism last week of git and Github, I expect to be
>     called a grumpy old man for holding this point of view.? I'd
>     actually like to be proven wrong.? So to anyone who disagrees with
>     me:? rather than just calling me names, how about some examples of
>     Roxygen-using packages that have good help pages with good
>     explanations, and good examples in them?
> 
>     Back to Mehmet's question:? I think Hadley's book is pretty good,
>     and I'd recommend most of it, just not the Roxygen part.
> 
>     Duncan Murdoch
> 
> 
>     ______________________________________________
>     R-devel at r-project.org <mailto:R-devel at r-project.org> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-devel
>     <https://stat.ethz.ch/mailman/listinfo/r-devel>
> 
> 
> 
> 
> -- 
> Joris Meys
> Statistical consultant
> 
> Department of Data Analysis and Mathematical Modelling
> Ghent University
> Coupure Links 653, B-9000 Gent (Belgium)
> <https://maps.google.com/?q=Coupure+links+653,%C2%A0B-9000+Gent,%C2%A0Belgium&entry=gmail&source=g>
> 
> -----------
> Biowiskundedagen 2017-2018
> http://www.biowiskundedagen.ugent.be/
> 
> -------------------------------
> Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php


From murdoch.duncan at gmail.com  Wed Jan 31 13:41:37 2018
From: murdoch.duncan at gmail.com (Duncan Murdoch)
Date: Wed, 31 Jan 2018 07:41:37 -0500
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <CAO1zAVaHnOthsFc9DGbC2+otAhHJ7qRi4hUZrqk67NFwpr6osA@mail.gmail.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CAO1zAVaHnOthsFc9DGbC2+otAhHJ7qRi4hUZrqk67NFwpr6osA@mail.gmail.com>
Message-ID: <2d6d82a8-0dc3-0fbe-5b25-8c86c74a1aad@gmail.com>

On 31/01/2018 6:33 AM, Joris Meys wrote:

> 3. given your criticism, I'd like your opinion on where I can improve 
> the documentation of https://github.com/CenterForStatistics-UGent/pim. 
> I'm currently busy updating the help files for a next release on CRAN, 
> so your input is more than welcome.

After this invitation I sent some private comments to Joris.  I would 
say his package does a pretty good job of documentation; it isn't the 
kind of Roxygen-using package that I was complaining about.  So I will 
say I have received an example of a Roxygen-using package that
has good help pages.

Duncan Murdoch


From edd at debian.org  Wed Jan 31 13:53:34 2018
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 31 Jan 2018 06:53:34 -0600
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <CABdHhvHaZCDnetJL+QW+-1moka-wy4+DtihM2M9nD8u_Yay6Og@mail.gmail.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CY4PR2001MB10641A6B87B06111469FDBD0BEE40@CY4PR2001MB1064.namprd20.prod.outlook.com>
 <23152.57287.697853.990831@rob.eddelbuettel.com>
 <ac51f4f1-c71e-9555-9668-10e2c880c04a@gmail.com>
 <CABdHhvHaZCDnetJL+QW+-1moka-wy4+DtihM2M9nD8u_Yay6Og@mail.gmail.com>
Message-ID: <23153.48206.980440.490874@rob.eddelbuettel.com>


(Please do not quote without attribution)

On 30 January 2018 at 20:44, Hadley Wickham wrote:
| Personally, I think the biggest problem with package.skeleton() is
| that it assumes that the source of truth is objects in an environment.
| This seems the wrong way around to me.

Basically irrelevant as it is optional behaviour.  With various packages at
work I may by now have created several dozen packages via package.skeleton(),
and I essentially never submitted an existing function.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From jorismeys at gmail.com  Wed Jan 31 14:01:52 2018
From: jorismeys at gmail.com (Joris Meys)
Date: Wed, 31 Jan 2018 14:01:52 +0100
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <2d6d82a8-0dc3-0fbe-5b25-8c86c74a1aad@gmail.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CAO1zAVaHnOthsFc9DGbC2+otAhHJ7qRi4hUZrqk67NFwpr6osA@mail.gmail.com>
 <2d6d82a8-0dc3-0fbe-5b25-8c86c74a1aad@gmail.com>
Message-ID: <CAO1zAVZGG33AUWUQ0Sbjaaqf2FSZ3JNsxzvdNHn9sBcYYDL7LQ@mail.gmail.com>

On Wed, Jan 31, 2018 at 1:41 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 31/01/2018 6:33 AM, Joris Meys wrote:
>
> 3. given your criticism, I'd like your opinion on where I can improve the
>> documentation of https://github.com/CenterForStatistics-UGent/pim. I'm
>> currently busy updating the help files for a next release on CRAN, so your
>> input is more than welcome.
>>
>
> After this invitation I sent some private comments to Joris.  I would say
> his package does a pretty good job of documentation; it isn't the kind of
> Roxygen-using package that I was complaining about.  So I will say I have
> received an example of a Roxygen-using package that
> has good help pages.
>

Thank you for the nice compliment and the valuable tips.

-- 
Joris Meys
Statistical consultant

Department of Data Analysis and Mathematical Modelling
Ghent University
Coupure Links 653, B-9000 Gent (Belgium)
<https://maps.google.com/?q=Coupure+links+653,%C2%A0B-9000+Gent,%C2%A0Belgium&entry=gmail&source=g>

-----------
Biowiskundedagen 2017-2018
http://www.biowiskundedagen.ugent.be/

-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php

	[[alternative HTML version deleted]]


From mark.vanderloo at gmail.com  Wed Jan 31 14:59:56 2018
From: mark.vanderloo at gmail.com (Mark van der Loo)
Date: Wed, 31 Jan 2018 13:59:56 +0000
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <CAO1zAVZGG33AUWUQ0Sbjaaqf2FSZ3JNsxzvdNHn9sBcYYDL7LQ@mail.gmail.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CAO1zAVaHnOthsFc9DGbC2+otAhHJ7qRi4hUZrqk67NFwpr6osA@mail.gmail.com>
 <2d6d82a8-0dc3-0fbe-5b25-8c86c74a1aad@gmail.com>
 <CAO1zAVZGG33AUWUQ0Sbjaaqf2FSZ3JNsxzvdNHn9sBcYYDL7LQ@mail.gmail.com>
Message-ID: <CAOKDuOj01EUf1Phru7CP6k-Cfdh6qjFqDmfcv9i0BGbDfBKzog@mail.gmail.com>

I fully agree with Joris and Hadley on roxygen2.


Additionally:

I wrote and published my first package before roxygen (or roxygen2) was
available. I found editing .Rd extremely terse (especially when code is
updated). For example, the fact that there are no spaces allowed between }
and { in \param{}{} has hurt my brain quite a few times, especially since R
CMD check did not give any useful error messages about it. For me it is a
signal that the Rd parser is rather primitive. On the other hand Roxygen2
now usually gives pretty good error messages when I syntax error something.

Also, the 'parent' of roxygen is Doxygen, which was already widely used
(also by me) in the C/C++ community before roxygen was published. I cannot
remember anyone ever complaining about C/C++ documentation deteriorating
because of Doxygen.


-Mark


Op wo 31 jan. 2018 om 14:02 schreef Joris Meys <jorismeys at gmail.com>:

> On Wed, Jan 31, 2018 at 1:41 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
> wrote:
>
> > On 31/01/2018 6:33 AM, Joris Meys wrote:
> >
> > 3. given your criticism, I'd like your opinion on where I can improve the
> >> documentation of https://github.com/CenterForStatistics-UGent/pim. I'm
> >> currently busy updating the help files for a next release on CRAN, so
> your
> >> input is more than welcome.
> >>
> >
> > After this invitation I sent some private comments to Joris.  I would say
> > his package does a pretty good job of documentation; it isn't the kind of
> > Roxygen-using package that I was complaining about.  So I will say I have
> > received an example of a Roxygen-using package that
> > has good help pages.
> >
>
> Thank you for the nice compliment and the valuable tips.
>
> --
> Joris Meys
> Statistical consultant
>
> Department of Data Analysis and Mathematical Modelling
> Ghent University
> Coupure Links 653, B-9000 Gent (Belgium)
> <
> https://maps.google.com/?q=Coupure+links+653,%C2%A0B-9000+Gent,%C2%A0Belgium&entry=gmail&source=g
> >
>
> -----------
> Biowiskundedagen 2017-2018
> http://www.biowiskundedagen.ugent.be/
>
> -------------------------------
> Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From Bernhard_Pfaff at fra.invesco.com  Wed Jan 31 15:51:00 2018
From: Bernhard_Pfaff at fra.invesco.com (Pfaff, Bernhard Dr.)
Date: Wed, 31 Jan 2018 14:51:00 +0000
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <CAO1zAVZGG33AUWUQ0Sbjaaqf2FSZ3JNsxzvdNHn9sBcYYDL7LQ@mail.gmail.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CAO1zAVaHnOthsFc9DGbC2+otAhHJ7qRi4hUZrqk67NFwpr6osA@mail.gmail.com>
 <2d6d82a8-0dc3-0fbe-5b25-8c86c74a1aad@gmail.com>
 <CAO1zAVZGG33AUWUQ0Sbjaaqf2FSZ3JNsxzvdNHn9sBcYYDL7LQ@mail.gmail.com>
Message-ID: <FCD9A33C859ACC469587CB09DD5C6C7132024B84@GBLONXMB13.corp.amvescap.net>

Dear All:

stepping in late, but @Joris, if you would like to take 'from a single file' literally,
have a look at:

	https://github.com/bpfaff/lp4rp

(lp4rp: literate programming for R packages); 

Cheers,
Bernhard

ps:  incidentally, within the noweb-file roxygen is employed.

-----Urspr?ngliche Nachricht-----
Von: R-devel [mailto:r-devel-bounces at r-project.org] Im Auftrag von Joris Meys
Gesendet: Mittwoch, 31. Januar 2018 14:02
An: Duncan Murdoch
Cc: r-devel
Betreff: [EXT] Re: [Rd] Best practices in developing package: From a single file

On Wed, Jan 31, 2018 at 1:41 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 31/01/2018 6:33 AM, Joris Meys wrote:
>
> 3. given your criticism, I'd like your opinion on where I can improve 
> the
>> documentation of https://github.com/CenterForStatistics-UGent/pim. 
>> I'm currently busy updating the help files for a next release on 
>> CRAN, so your input is more than welcome.
>>
>
> After this invitation I sent some private comments to Joris.  I would 
> say his package does a pretty good job of documentation; it isn't the 
> kind of Roxygen-using package that I was complaining about.  So I will 
> say I have received an example of a Roxygen-using package that has 
> good help pages.
>

Thank you for the nice compliment and the valuable tips.

--
Joris Meys
Statistical consultant

Department of Data Analysis and Mathematical Modelling Ghent University Coupure Links 653, B-9000 Gent (Belgium) <https://maps.google.com/?q=Coupure+links+653,%C2%A0B-9000+Gent,%C2%A0Belgium&entry=gmail&source=g>

-----------
Biowiskundedagen 2017-2018
http://www.biowiskundedagen.ugent.be/

-------------------------------
Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php

	[[alternative HTML version deleted]]

______________________________________________
R-devel at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-devel
*****************************************************************
Confidentiality Note: The information contained in this ...{{dropped:10}}


From b.rowlingson at lancaster.ac.uk  Wed Jan 31 16:18:14 2018
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 31 Jan 2018 15:18:14 +0000
Subject: [Rd] Why R should never move to git
In-Reply-To: <786e446c35374edc8d633f1f65619460@AM4PR0401MB1729.eurprd04.prod.outlook.com>
References: <786e446c35374edc8d633f1f65619460@AM4PR0401MB1729.eurprd04.prod.outlook.com>
Message-ID: <CANVKczOTWqKEqud_yDcO0ybPJwDK=2ydY6SDN5zPF+8_7C9qmg@mail.gmail.com>

On Tue, Jan 30, 2018 at 11:07 PM, Suzen, Mehmet <mehmet.suzen at gmail.com>
wrote:

> This might be off topic, but if R-core development ever moves to git,
> I think it would make sense to have its own git service hosted by a
> university, rather than using
> github or gitlab. It is possible via https://gogs.io/ project.
>
> Just for the record.
>
>
Let the record also state that *gitlab* is an open source project and can
be downloaded and self-hosted, like gogs, but unlike github.

Barry

PS I've been running a gitlab instance for my group for a couple of years
on a private server.

	[[alternative HTML version deleted]]


From xie at yihui.name  Wed Jan 31 16:43:53 2018
From: xie at yihui.name (Yihui Xie)
Date: Wed, 31 Jan 2018 09:43:53 -0600
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <FCD9A33C859ACC469587CB09DD5C6C7132024B84@GBLONXMB13.corp.amvescap.net>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CAO1zAVaHnOthsFc9DGbC2+otAhHJ7qRi4hUZrqk67NFwpr6osA@mail.gmail.com>
 <2d6d82a8-0dc3-0fbe-5b25-8c86c74a1aad@gmail.com>
 <CAO1zAVZGG33AUWUQ0Sbjaaqf2FSZ3JNsxzvdNHn9sBcYYDL7LQ@mail.gmail.com>
 <FCD9A33C859ACC469587CB09DD5C6C7132024B84@GBLONXMB13.corp.amvescap.net>
Message-ID: <CANROs4e4yHzjW4oDXFimYomSSchcCfLZjHFiUvMXTLakj-JQrQ@mail.gmail.com>

Similarly, I created this example a couple of years ago:
https://github.com/yihui/rlp which shows that you can create a package
from R Markdown documents (or any documents that knitr supports).
Basically you can start with an R Markdown document, and after
clicking a button in RStudio, you will get a full R package, with R
code, vignettes, and Rd (killing three birds with one stone). The
reason that you can get Rd is because of roxygen2.

I'm not interested in convincing Duncan of using roxygen (or
GIT/Github). It is fine that one loves or hates a tool. Just use tools
that make yourself comfortable. To me as a package developer, roxygen2
is indispensable (so are GIT/Github), and I use it in all my packages.
I had almost lost interest in developing R packages about 8 years ago
just because I found writing raw Rd extremely frustrating. Then
fortunately, roxygen was born, just in time.

Personally, it doesn't bother me if Duncan thinks roxygen-based
package documentations are typically of poor quality. I care a lot of
about documentation, and sometimes spend months after months on
documentation (Rd, vignettes, websites, and books). I'd very much like
to volunteer to have Duncan use any of my packages as examples of
"poor-quality roxygen-based documentation", and let's figure out why
they are poor (i.e., do we blame it on roxygen2 or myself?).

Regards,
Yihui
--
https://yihui.name


On Wed, Jan 31, 2018 at 8:51 AM, Pfaff, Bernhard Dr.
<Bernhard_Pfaff at fra.invesco.com> wrote:
> Dear All:
>
> stepping in late, but @Joris, if you would like to take 'from a single file' literally,
> have a look at:
>
>         https://github.com/bpfaff/lp4rp
>
> (lp4rp: literate programming for R packages);
>
> Cheers,
> Bernhard
>
> ps:  incidentally, within the noweb-file roxygen is employed.
>
> -----Urspr?ngliche Nachricht-----
> Von: R-devel [mailto:r-devel-bounces at r-project.org] Im Auftrag von Joris Meys
> Gesendet: Mittwoch, 31. Januar 2018 14:02
> An: Duncan Murdoch
> Cc: r-devel
> Betreff: [EXT] Re: [Rd] Best practices in developing package: From a single file
>
> On Wed, Jan 31, 2018 at 1:41 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
> wrote:
>
>> On 31/01/2018 6:33 AM, Joris Meys wrote:
>>
>> 3. given your criticism, I'd like your opinion on where I can improve
>> the
>>> documentation of https://github.com/CenterForStatistics-UGent/pim.
>>> I'm currently busy updating the help files for a next release on
>>> CRAN, so your input is more than welcome.
>>>
>>
>> After this invitation I sent some private comments to Joris.  I would
>> say his package does a pretty good job of documentation; it isn't the
>> kind of Roxygen-using package that I was complaining about.  So I will
>> say I have received an example of a Roxygen-using package that has
>> good help pages.
>>
>
> Thank you for the nice compliment and the valuable tips.
>
> --
> Joris Meys
> Statistical consultant
>
> Department of Data Analysis and Mathematical Modelling Ghent University Coupure Links 653, B-9000 Gent (Belgium) <https://maps.google.com/?q=Coupure+links+653,%C2%A0B-9000+Gent,%C2%A0Belgium&entry=gmail&source=g>
>
> -----------
> Biowiskundedagen 2017-2018
> http://www.biowiskundedagen.ugent.be/
>
> -------------------------------
> Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> *****************************************************************
> Confidentiality Note: The information contained in this ...{{dropped:10}}
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From lawrence.michael at gene.com  Wed Jan 31 16:53:18 2018
From: lawrence.michael at gene.com (Michael Lawrence)
Date: Wed, 31 Jan 2018 07:53:18 -0800
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
Message-ID: <CAOQ5NyequDcsBczAqOg6XqDeUNx2hXg+4ggHc0Ews0NxgszHSA@mail.gmail.com>

I pretty much agree. I tried using roxygen when it was first released but
couldn't stand putting documentation in comments, especially for complex,
S4-based software. Rd is easy to read and write and lets me focus on the
task of writing documentation (focus is the hardest part of any task for
me). Probably the best feature of roxygen is that it automatically
generates \usage{}, which is otherwise completely redundant with the code.

I think the preceeding systems like doxygen, javadoc, gtk-doc, qtdoc, etc,
found a nice compromise through templating, where the bulk of the details
are written into the template, and just the essentials (usage, arguments,
return value) were embedded in the source file. I think this is even more
important for R, since we're often describing complex algorithms, while
most C/C++/Java software is oriented complex classes containing many
relatively simple methods.

Michael


On Tue, Jan 30, 2018 at 11:53 AM, Duncan Murdoch <murdoch.duncan at gmail.com>
wrote:

> On 30/01/2018 11:29 AM, Brian G. Peterson wrote:
>
>> On Tue, 2018-01-30 at 17:00 +0100, Suzen, Mehmet wrote:
>>
>>> Dear R developers,
>>>
>>> I am wondering what are the best practices for developing an R
>>> package. I am aware of Hadley Wickham's best practice
>>> documentation/book (http://r-pkgs.had.co.nz/).  I recall a couple of
>>> years ago there were some tools for generating a package out of a
>>> single file, such as using package.skeleton, but no auto-generated
>>> documentation. Do you know a way to generate documentation and a
>>> package out of single R source file, or from an environment?
>>>
>>
>> Mehmet,
>>
>> This list is for development of the R language itself and closely
>> related tools.  There is a separate list, R-pkg-devel, for development
>> of packages.
>>
>> Since you're here, I'll try to answer your question.
>>
>> package.skeleton can create a package from all the R functions in a
>> specified environment.  So if you load all the functions that you want
>> in your new package into your R environment, then call
>> package.skeleton, you'll have a starting point.
>>
>> At that point, I would probably recommend moving to RStudio, and using
>> RStudio to generate markdown comments for roxygen for all your newly
>> created function files.  Then you could finish off the documentation by
>> writing it in these roxygen skeletons or copying and pasting from
>> comments in your original code files.
>>
>
> I'd agree about moving to RStudio, but I think Roxygen is the wrong
> approach for documentation.  package.skeleton() will have done the boring
> mechanical part of setting up your .Rd files; all you have to do is edit
> some content into them.  (Use prompt() to add a new file if you add a new
> function later, don't run package.skeleton() again.)
>
> This isn't the fashionable point of view, but I think it is easier to get
> good documentation that way than using Roxygen.  (It's easier to get bad
> documentation using Roxygen, but who wants that?)
>
> The reason I think this is that good documentation requires work and
> thought.  You need to think about the markup that will get your point
> across, you need to think about putting together good examples, etc.
> This is *harder* in Roxygen than if you are writing Rd files, because
> Roxygen is a thin front end to produce Rd files from comments in your .R
> files.  To get good stuff in the help page, you need just as much work as
> in writing the .Rd file directly, but then you need to add another layer on
> top to put in in a comment.  Most people don't bother.
>
> I don't know any packages with what I'd consider to be good documentation
> that use Roxygen.  It's just too easy to write minimal documentation that
> passes checks, so Roxygen users don't keep refining it.
>
> (There are plenty of examples of packages that write bad documentation
> directly to .Rd as well.  I just don't know of examples of packages with
> good documentation that use Roxygen.)
>
> Based on my criticism last week of git and Github, I expect to be called a
> grumpy old man for holding this point of view.  I'd actually like to be
> proven wrong.  So to anyone who disagrees with me:  rather than just
> calling me names, how about some examples of Roxygen-using packages that
> have good help pages with good explanations, and good examples in them?
>
> Back to Mehmet's question:  I think Hadley's book is pretty good, and I'd
> recommend most of it, just not the Roxygen part.
>
> Duncan Murdoch
>
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>

	[[alternative HTML version deleted]]


From suzen at acm.org  Wed Jan 31 17:35:56 2018
From: suzen at acm.org (Suzen, Mehmet)
Date: Wed, 31 Jan 2018 17:35:56 +0100
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <FCD9A33C859ACC469587CB09DD5C6C7132024B84@GBLONXMB13.corp.amvescap.net>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CAO1zAVaHnOthsFc9DGbC2+otAhHJ7qRi4hUZrqk67NFwpr6osA@mail.gmail.com>
 <2d6d82a8-0dc3-0fbe-5b25-8c86c74a1aad@gmail.com>
 <CAO1zAVZGG33AUWUQ0Sbjaaqf2FSZ3JNsxzvdNHn9sBcYYDL7LQ@mail.gmail.com>
 <FCD9A33C859ACC469587CB09DD5C6C7132024B84@GBLONXMB13.corp.amvescap.net>
Message-ID: <CAPtbhHzGAT9LKC-kkwWQQBdBsMdsirq=0UeZRGb5Ack5rPPX9w@mail.gmail.com>

Dear Dr. Pfaff,

Thank you for this, creating a package out of single file was my
oriingal question, but not only creating and also maintaining it that
way so R package is an artifact of the development process rather than
"manually maintained" structure. I will have look at your sources.

Best,

Mehmet S?zen
<suzen at acm.org>


On 31 January 2018 at 15:51, Pfaff, Bernhard Dr.
<Bernhard_Pfaff at fra.invesco.com> wrote:
> Dear All:
>
> stepping in late, but @Joris, if you would like to take 'from a single file' literally,
> have a look at:
>
>         https://github.com/bpfaff/lp4rp
>
> (lp4rp: literate programming for R packages);
>
> Cheers,
> Bernhard
>
> ps:  incidentally, within the noweb-file roxygen is employed.
>
> -----Urspr?ngliche Nachricht-----
> Von: R-devel [mailto:r-devel-bounces at r-project.org] Im Auftrag von Joris Meys
> Gesendet: Mittwoch, 31. Januar 2018 14:02
> An: Duncan Murdoch
> Cc: r-devel
> Betreff: [EXT] Re: [Rd] Best practices in developing package: From a single file
>
> On Wed, Jan 31, 2018 at 1:41 PM, Duncan Murdoch <murdoch.duncan at gmail.com>
> wrote:
>
>> On 31/01/2018 6:33 AM, Joris Meys wrote:
>>
>> 3. given your criticism, I'd like your opinion on where I can improve
>> the
>>> documentation of https://github.com/CenterForStatistics-UGent/pim.
>>> I'm currently busy updating the help files for a next release on
>>> CRAN, so your input is more than welcome.
>>>
>>
>> After this invitation I sent some private comments to Joris.  I would
>> say his package does a pretty good job of documentation; it isn't the
>> kind of Roxygen-using package that I was complaining about.  So I will
>> say I have received an example of a Roxygen-using package that has
>> good help pages.
>>
>
> Thank you for the nice compliment and the valuable tips.
>
> --
> Joris Meys
> Statistical consultant
>
> Department of Data Analysis and Mathematical Modelling Ghent University Coupure Links 653, B-9000 Gent (Belgium) <https://maps.google.com/?q=Coupure+links+653,%C2%A0B-9000+Gent,%C2%A0Belgium&entry=gmail&source=g>
>
> -----------
> Biowiskundedagen 2017-2018
> http://www.biowiskundedagen.ugent.be/
>
> -------------------------------
> Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php
>
>         [[alternative HTML version deleted]]
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
> *****************************************************************
> Confidentiality Note: The information contained in this ...{{dropped:10}}
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel


From mehmet.suzen at gmail.com  Wed Jan 31 17:47:29 2018
From: mehmet.suzen at gmail.com (Suzen, Mehmet)
Date: Wed, 31 Jan 2018 17:47:29 +0100
Subject: [Rd] Why R should never move to git
In-Reply-To: <CANVKczOTWqKEqud_yDcO0ybPJwDK=2ydY6SDN5zPF+8_7C9qmg@mail.gmail.com>
References: <786e446c35374edc8d633f1f65619460@AM4PR0401MB1729.eurprd04.prod.outlook.com>
 <CANVKczOTWqKEqud_yDcO0ybPJwDK=2ydY6SDN5zPF+8_7C9qmg@mail.gmail.com>
Message-ID: <CAPtbhHxZ64faxmbeNpWy1U_Ra_72RhsnhbrSCt=jRnZyL47p8g@mail.gmail.com>

On 31 January 2018 at 16:18, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
>>
>
> Let the record also state that *gitlab* is an open source project and can be
> downloaded and self-hosted, like gogs, but unlike github.


Good to know. Nice one: https://github.com/gitlabhq/gitlabhq

Best,
-m


> PS I've been running a gitlab instance for my group for a couple of years on
> a private server.

Is it a smooth ride so far?


From gmbecker at ucdavis.edu  Wed Jan 31 18:08:23 2018
From: gmbecker at ucdavis.edu (Gabriel Becker)
Date: Wed, 31 Jan 2018 09:08:23 -0800
Subject: [Rd] Best practices in developing package: From a single file
In-Reply-To: <CAPtbhHzGAT9LKC-kkwWQQBdBsMdsirq=0UeZRGb5Ack5rPPX9w@mail.gmail.com>
References: <CAPtbhHwLXvdCX+1PJvEAyjWtcaVf=k4kL2fgXNhxLqfBhoJg-Q@mail.gmail.com>
 <1517329742.15543.15.camel@braverock.com>
 <aef83954-b118-6f8f-6d4f-d2a9758121cc@gmail.com>
 <CAO1zAVaHnOthsFc9DGbC2+otAhHJ7qRi4hUZrqk67NFwpr6osA@mail.gmail.com>
 <2d6d82a8-0dc3-0fbe-5b25-8c86c74a1aad@gmail.com>
 <CAO1zAVZGG33AUWUQ0Sbjaaqf2FSZ3JNsxzvdNHn9sBcYYDL7LQ@mail.gmail.com>
 <FCD9A33C859ACC469587CB09DD5C6C7132024B84@GBLONXMB13.corp.amvescap.net>
 <CAPtbhHzGAT9LKC-kkwWQQBdBsMdsirq=0UeZRGb5Ack5rPPX9w@mail.gmail.com>
Message-ID: <CADwqtCO3Z7vp2TNJLBXpdwnqYyzH4vEzSeXieOSSjsyebojnhA@mail.gmail.com>

Joris,

With the large caveat that I am not Duncan, and thus am not speaking for
him, I can see an argument for his claim that I think is, more or less,
true.

roxygen2 (as far as I know as someone who uses it at least some of the
time) maps to only a subset of Rd. It is the most commonly used subset, and
so you can do most common things with it, but I think a pretty good case
can be made for the fact that it *actively discourages* the bits it doesn't
directly support. Ie doing things that would require you to put Rd syntax
into the roxygen comments. In as much as those aspects of Rd are required
for good documentation *in some cases*, in those cases, good documentation
is discouraged. Not disallowed, mind you - you CAN put the Rd syntax into
your roxygen comments and have it work - but discouraged.

There is also the case that I think Michael was alluding to, that in some
types of R software things that belong in the same help file are not
co-localized in R code. This is , again, supported by oxygen, of course,
but it removes one of the primary benefits of the system, i.e.
documentation-proximity-to-code.

Also, as I understood Duncan's comments, he was not saying good
documentation CANNOT be written in oxygen, just like good R code CAN be
written in notepad, rather than an IDE like RStudio or Emacs+ESS, but doing
so doesn't encourage the process.

All that said, at the end of the day, I generally agree with what Yehui
said as well. If you use roxygen2 and feel that it helps you to write good
documentation, great! Use it.  Thats ultimately not a statement about what
kind of documentation it encourages.

As a final thought, my personal view is that roxygen2 does not encourage
good or bad documentation, but rather middling documentation. It encourages
new users and those with major time or focus constraints to document things
more than they would without it, which is good, but doesn't encourage
really top notch documentation either and as with all things, hand-crafted
"artisanal" documentation will often be of higher quality.

Best,
~G

On Wed, Jan 31, 2018 at 8:35 AM, Suzen, Mehmet <suzen at acm.org> wrote:

> Dear Dr. Pfaff,
>
> Thank you for this, creating a package out of single file was my
> oriingal question, but not only creating and also maintaining it that
> way so R package is an artifact of the development process rather than
> "manually maintained" structure. I will have look at your sources.
>
> Best,
>
> Mehmet S?zen
> <suzen at acm.org>
>
>
> On 31 January 2018 at 15:51, Pfaff, Bernhard Dr.
> <Bernhard_Pfaff at fra.invesco.com> wrote:
> > Dear All:
> >
> > stepping in late, but @Joris, if you would like to take 'from a single
> file' literally,
> > have a look at:
> >
> >         https://github.com/bpfaff/lp4rp
> >
> > (lp4rp: literate programming for R packages);
> >
> > Cheers,
> > Bernhard
> >
> > ps:  incidentally, within the noweb-file roxygen is employed.
> >
> > -----Urspr?ngliche Nachricht-----
> > Von: R-devel [mailto:r-devel-bounces at r-project.org] Im Auftrag von
> Joris Meys
> > Gesendet: Mittwoch, 31. Januar 2018 14:02
> > An: Duncan Murdoch
> > Cc: r-devel
> > Betreff: [EXT] Re: [Rd] Best practices in developing package: From a
> single file
> >
> > On Wed, Jan 31, 2018 at 1:41 PM, Duncan Murdoch <
> murdoch.duncan at gmail.com>
> > wrote:
> >
> >> On 31/01/2018 6:33 AM, Joris Meys wrote:
> >>
> >> 3. given your criticism, I'd like your opinion on where I can improve
> >> the
> >>> documentation of https://github.com/CenterForStatistics-UGent/pim.
> >>> I'm currently busy updating the help files for a next release on
> >>> CRAN, so your input is more than welcome.
> >>>
> >>
> >> After this invitation I sent some private comments to Joris.  I would
> >> say his package does a pretty good job of documentation; it isn't the
> >> kind of Roxygen-using package that I was complaining about.  So I will
> >> say I have received an example of a Roxygen-using package that has
> >> good help pages.
> >>
> >
> > Thank you for the nice compliment and the valuable tips.
> >
> > --
> > Joris Meys
> > Statistical consultant
> >
> > Department of Data Analysis and Mathematical Modelling Ghent University
> Coupure Links 653, B-9000 Gent (Belgium) <https://maps.google.com/?q=
> Coupure+links+653,%C2%A0B-9000+Gent,%C2%A0Belgium&entry=gmail&source=g>
> >
> > -----------
> > Biowiskundedagen 2017-2018
> > http://www.biowiskundedagen.ugent.be/
> >
> > -------------------------------
> > Disclaimer : http://helpdesk.ugent.be/e-maildisclaimer.php
> >
> >         [[alternative HTML version deleted]]
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
> > *****************************************************************
> > Confidentiality Note: The information contained in this ...{{dropped:10}}
> >
> > ______________________________________________
> > R-devel at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-devel
>
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>



-- 
Gabriel Becker, PhD
Scientist (Bioinformatics)
Genentech Research

	[[alternative HTML version deleted]]


From edd at debian.org  Wed Jan 31 19:34:07 2018
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 31 Jan 2018 12:34:07 -0600
Subject: [Rd] CRAN indices out of whack (for at least macOS)
In-Reply-To: <23152.57727.522184.800529@rob.eddelbuettel.com>
References: <23152.57727.522184.800529@rob.eddelbuettel.com>
Message-ID: <23154.3103.436577.662406@rob.eddelbuettel.com>


Bumping this as we now have two more issue tickets filed and a fresh SO
question.

Is anybody looking at this? Simon?

Dirk

On 30 January 2018 at 15:19, Dirk Eddelbuettel wrote:
| 
| I have received three distinct (non-)bug reports where someone claimed a
| recent package of mine was broken ... simply because the macOS binary was not
| there.
| 
| Is there something wrong with the cronjob providing the indices? Why is it
| pointing people to binaries that do not exist?
| 
| Concretely, file
| 
|   https://cloud.r-project.org/bin/macosx/el-capitan/contrib/3.4/PACKAGES
| 
| contains
| 
|   Package: digest
|   Version: 0.6.15
|   Title: Create Compact Hash Digests of R Objects
|   Depends: R (>= 2.4.1)
|   Suggests: knitr, rmarkdown
|   Built: R 3.4.3; x86_64-apple-darwin15.6.0; 2018-01-29 05:21:06 UTC; unix
|   Archs: digest.so.dSYM
| 
| yet the _same directory_ only has:
| 
|   digest_0.6.14.tgz	15-Jan-2018 21:36	157K
| 
| I presume this is a temporary accident.
| 
| We are all spoiled by you all providing such a wonderfully robust and
| well-oiled service---so again big THANKS for that--but today something is out
| of order.
| 
| Dirk
| 
| -- 
| http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
| 
| ______________________________________________
| R-devel at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-devel

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From simon.urbanek at R-project.org  Wed Jan 31 20:08:33 2018
From: simon.urbanek at R-project.org (Simon Urbanek)
Date: Wed, 31 Jan 2018 14:08:33 -0500
Subject: [Rd] CRAN indices out of whack (for at least macOS)
In-Reply-To: <23154.3103.436577.662406@rob.eddelbuettel.com>
References: <23152.57727.522184.800529@rob.eddelbuettel.com>
 <23154.3103.436577.662406@rob.eddelbuettel.com>
Message-ID: <8367F081-BE52-4B05-BC6E-A108C1857BF2@R-project.org>

Dirk,

yes, thanks, the edge server that serves the Mac binaries to CRAN has run out of disk space (due to size of CRAN itself) so the sync was incomplete.
It is fixed now -- you can try by using the macos master server as mirror: https://r.research.att.com/ and it will propagate through other mirrors as usual.

Thanks,
Simon




> On Jan 31, 2018, at 1:34 PM, Dirk Eddelbuettel <edd at debian.org> wrote:
> 
> 
> Bumping this as we now have two more issue tickets filed and a fresh SO
> question.
> 
> Is anybody looking at this? Simon?
> 
> Dirk
> 
> On 30 January 2018 at 15:19, Dirk Eddelbuettel wrote:
> | 
> | I have received three distinct (non-)bug reports where someone claimed a
> | recent package of mine was broken ... simply because the macOS binary was not
> | there.
> | 
> | Is there something wrong with the cronjob providing the indices? Why is it
> | pointing people to binaries that do not exist?
> | 
> | Concretely, file
> | 
> |   https://cloud.r-project.org/bin/macosx/el-capitan/contrib/3.4/PACKAGES
> | 
> | contains
> | 
> |   Package: digest
> |   Version: 0.6.15
> |   Title: Create Compact Hash Digests of R Objects
> |   Depends: R (>= 2.4.1)
> |   Suggests: knitr, rmarkdown
> |   Built: R 3.4.3; x86_64-apple-darwin15.6.0; 2018-01-29 05:21:06 UTC; unix
> |   Archs: digest.so.dSYM
> | 
> | yet the _same directory_ only has:
> | 
> |   digest_0.6.14.tgz	15-Jan-2018 21:36	157K
> | 
> | I presume this is a temporary accident.
> | 
> | We are all spoiled by you all providing such a wonderfully robust and
> | well-oiled service---so again big THANKS for that--but today something is out
> | of order.
> | 
> | Dirk
> | 
> | -- 
> | http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
> | 
> | ______________________________________________
> | R-devel at r-project.org mailing list
> | https://stat.ethz.ch/mailman/listinfo/r-devel
> 
> -- 
> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
> 


From lawrence.michael at gene.com  Wed Jan 31 21:41:47 2018
From: lawrence.michael at gene.com (Michael Lawrence)
Date: Wed, 31 Jan 2018 12:41:47 -0800
Subject: [Rd] bug [methods]: double execution of `insertSource` within
 the same session does not work
In-Reply-To: <CAOQ5Nyf5MrBLfq2T-dRDDpfGxthqyv=wGthu7TxZy_f7JWTy4g@mail.gmail.com>
References: <CA+ZF6Z+z_tFLSq9KFy_6sX35gXRTr4qknSLELBX6GRLAck8SGw@mail.gmail.com>
 <CAOQ5Nyf5MrBLfq2T-dRDDpfGxthqyv=wGthu7TxZy_f7JWTy4g@mail.gmail.com>
Message-ID: <CAOQ5NydS_5D5pb28pco_dPd5y+BciWYcADJnF2h=XrgAU4_VNQ@mail.gmail.com>

The issue should be resolved in R-devel. It was actually deeper and more
important than this obscure insertSource() function. names() was not doing
the right thing on S4 objects derived from "environment".

On Mon, Jan 29, 2018 at 11:02 AM, Michael Lawrence <michafla at gene.com>
wrote:

> Thanks, I will fix this.
>
> On Mon, Jan 29, 2018 at 8:06 AM, Demetrio Rodriguez T. <
> demetrio.rodriguez.t at gmail.com> wrote:
>
>> Hello everyone,
>>
>>
>> I hope this reaches someone at all. It's my first bug report to the
>> R-core,
>> and, apparently, bugzilla is locked from new reports for now.
>>
>> I was using `methods::insertSource` to debug and successfully fix another
>> package, until it suddenly stopped working. I figured out, that it is
>> because I am using it on the same function multiple times within one
>> session. It also produces warnings even during the first call, but somehow
>> still works. Below I provide a reproducible example:
>>
>> SETUP:
>> ```bash
>> demetrio at laptop:[folder_structure]/Bugreports/methods_insertSource$ ls -a
>> .  ..  gmapsdistance_fix.R  methods_insertSource.R
>> ```
>>
>> file `gmapsdistance_fix.R`
>> ```R
>> gmapsdistance = function(param) {
>>     print('I am a bug report, my params are:')
>>     print(param)
>> }
>> ```
>>
>>
>> file `methods_insertSource.R`
>> ```R
>> library(gmapsdistance)  # works with any package
>>
>> methods::insertSource('gmapsdistance_fix.R',
>>     package = 'gmapsdistance',
>>     functions = 'gmapsdistance',
>>     force = T
>> )
>> buggy = gmapsdistance('Works?')
>> ```
>>
>>
>> TO REPRODUCE:
>> in that directory `R --vanilla` then
>> ```R
>> > source('methods_insertSource.R')
>> Modified functions inserted through trace(): gmapsdistance
>> [1] "I am a bug report, my params are:"
>> [1] "Works?"
>> Warning message:
>> In methods::insertSource("gmapsdistance_fix.R", package =
>> "gmapsdistance",
>> :
>>   cannot insert these (not found in source): "gmapsdistance"
>> # Works, but gives the warning that it does not
>>
>> # repeat:
>> > source('methods_insertSource.R')
>> Error in assign(this, thisObj, envir = envwhere) :
>>   cannot change value of locked binding for 'gmapsdistance'
>> In addition: Warning message:
>> In methods::insertSource("gmapsdistance_fix.R", package =
>> "gmapsdistance",
>> :
>>   cannot insert these (not found in source): "gmapsdistance"
>>
>> # does not work, and gets even more confusing: so is it that the object is
>> not find, or is it about a locked object?
>> ```
>>
>> I think it's a bug.
>>
>> --------------------- BUG REPORT END ------------------------
>>
>>
>> I looked into it a bit myself, in case you are interested:
>>
>> ```R
>> # lines 20-22
>>     if (is(source, "environment"))
>>         env <- source
>>     else env <- evalSource(source, package, FALSE)
>>     # We're in the second case I guess
>>
>> # Browse[2]> env
>> # Object of class "sourceEnvironment"
>> # Source environment created  2017-12-01 05:19:51
>> # For package "gmapsdistance"
>> # From source file "gmapsdistancefix.R"
>>
>>
>> # later, before line 52:
>> x = env
>> Browse[2]> package
>> [1] "gmapsdistance"
>>
>> # evaluate 52
>> packageSlot(env) <- package
>>
>> # objects x and env are still identical
>> # Browse[2]> class(env)
>> # [1] "sourceEnvironment"
>> # attr(,"package")
>> # [1] "methods"
>> # Browse[2]> class(x)
>> # [1] "sourceEnvironment"
>> # attr(,"package")
>> # [1] "methods"
>>
>> # Browse[2]> env
>> # Object of class "sourceEnvironment"
>> # Source environment created  2017-12-01 05:19:51
>> # For package "gmapsdistance"
>> # From source file "gmapsdistancefix.R"
>> # Browse[2]> x
>> # Object of class "sourceEnvironment"
>> # Source environment created  2017-12-01 05:19:51
>> # For package "gmapsdistance"
>> # From source file "gmapsdistancefix.R"
>>
>> # so:
>> Browse[2]>  names(env)
>> NULL
>>
>> # which is why 53-60 do not work:
>> allObjects <- names(env)
>> if (!missing(functions)) {
>>     notThere <- is.na(match(functions, allObjects))
>>     if (any(notThere)) {
>>         warning(gettextf("cannot insert these (not found in source): %s",
>>             paste("\"", functions[notThere], "\"", sep = "",
>>                 collapse = ", ")), domain = NA)
>>     }
>> }
>> ```
>>
>> Looking forward to your feedback!
>>
>> Cheers,
>> Demetrio
>>
>>         [[alternative HTML version deleted]]
>>
>> ______________________________________________
>> R-devel at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>>
>

	[[alternative HTML version deleted]]


From ligges at statistik.tu-dortmund.de  Wed Jan 31 21:43:08 2018
From: ligges at statistik.tu-dortmund.de (Uwe Ligges)
Date: Wed, 31 Jan 2018 21:43:08 +0100
Subject: [Rd] CRAN indices out of whack (for at least macOS)
In-Reply-To: <8367F081-BE52-4B05-BC6E-A108C1857BF2@R-project.org>
References: <23152.57727.522184.800529@rob.eddelbuettel.com>
 <23154.3103.436577.662406@rob.eddelbuettel.com>
 <8367F081-BE52-4B05-BC6E-A108C1857BF2@R-project.org>
Message-ID: <c17760cc-af91-107c-60d3-7d8661727b28@statistik.tu-dortmund.de>

Thanks,
Uwe


On 31.01.2018 20:08, Simon Urbanek wrote:
> Dirk,
> 
> yes, thanks, the edge server that serves the Mac binaries to CRAN has run out of disk space (due to size of CRAN itself) so the sync was incomplete.
> It is fixed now -- you can try by using the macos master server as mirror: https://r.research.att.com/ and it will propagate through other mirrors as usual.
> 
> Thanks,
> Simon
> 
> 
> 
> 
>> On Jan 31, 2018, at 1:34 PM, Dirk Eddelbuettel <edd at debian.org> wrote:
>>
>>
>> Bumping this as we now have two more issue tickets filed and a fresh SO
>> question.
>>
>> Is anybody looking at this? Simon?
>>
>> Dirk
>>
>> On 30 January 2018 at 15:19, Dirk Eddelbuettel wrote:
>> |
>> | I have received three distinct (non-)bug reports where someone claimed a
>> | recent package of mine was broken ... simply because the macOS binary was not
>> | there.
>> |
>> | Is there something wrong with the cronjob providing the indices? Why is it
>> | pointing people to binaries that do not exist?
>> |
>> | Concretely, file
>> |
>> |   https://cloud.r-project.org/bin/macosx/el-capitan/contrib/3.4/PACKAGES
>> |
>> | contains
>> |
>> |   Package: digest
>> |   Version: 0.6.15
>> |   Title: Create Compact Hash Digests of R Objects
>> |   Depends: R (>= 2.4.1)
>> |   Suggests: knitr, rmarkdown
>> |   Built: R 3.4.3; x86_64-apple-darwin15.6.0; 2018-01-29 05:21:06 UTC; unix
>> |   Archs: digest.so.dSYM
>> |
>> | yet the _same directory_ only has:
>> |
>> |   digest_0.6.14.tgz	15-Jan-2018 21:36	157K
>> |
>> | I presume this is a temporary accident.
>> |
>> | We are all spoiled by you all providing such a wonderfully robust and
>> | well-oiled service---so again big THANKS for that--but today something is out
>> | of order.
>> |
>> | Dirk
>> |
>> | --
>> | http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>> |
>> | ______________________________________________
>> | R-devel at r-project.org mailing list
>> | https://stat.ethz.ch/mailman/listinfo/r-devel
>>
>> -- 
>> http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org
>>
> 
> ______________________________________________
> R-devel at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-devel
>


