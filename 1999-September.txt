From lyndon@stat.auckland.ac.nz  Wed Sep  1 08:51:34 1999
From: lyndon@stat.auckland.ac.nz (Lyndon Drake)
Date: Wed, 1 Sep 1999 19:51:34 +1200
Subject: [R] R --gnome segfaults on RH 6.0 with R-0.65.0
In-Reply-To: <x2yaes7zh8.fsf@blueberry.kubism.ku.dk>; from Peter Dalgaard BSA on Tue, Aug 31, 1999 at 05:15:47PM +0200
References: <XFMail.990831164030.awol@xs4all.nl> <x2yaes7zh8.fsf@blueberry.kubism.ku.dk>
Message-ID: <19990901195134.A12088@stat1.stat.auckland.ac.nz>

On Tue, Aug 31, 1999 at 05:15:47PM +0200, Peter Dalgaard BSA wrote:
> Alexander Volovics <awol@xs4all.nl> writes:
> 
> What would interest me is what the content of R_gnome_userprefs.font
> if you go up to #40 (in R_gtk_terminal_new () at terminal.c:112). Just
> type 
> 
> p R_gnome_userprefs.font
> 
> if it's NULL, then we might have a lead on the problem. But Lyndon
> Drake is the guy who knows his way around the Gnome stuff, not me.
> 

Sorry for being so slow to get onto this, but Uni has been a bit busy
lately.  This is probably a problem with the preferences (which are
totally broken right now, but the replacement preferences system should
get committed to CVS next week).  I'll check it out soon...

-- 
Lyndon Drake                       | Desktop:      http://www.gnome.org
isenguard                          | Mail client:  http://www.mutt.org
ICQ#: 12558803                     | Editor:       http://www.vim.org
http://stat.auckland.ac.nz/~lyndon | OS:           http://www.linux.com
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plindsey@alpha.luc.ac.be  Wed Sep  1 10:33:57 1999
From: plindsey@alpha.luc.ac.be (Patrick Lindsey)
Date: Wed, 1 Sep 1999 11:33:57 +0200 (MET DST)
Subject: Problems compiling R65.0.
Message-ID: <199909010933.LAA27167@alpha.luc.ac.be>

Hi,
I appear to have a slight problem compiling R0.65.0 under Linux
(slackware) using g77. By simply typing configure then make, I obtain
a binary which when "ldd" does not contain the f2c library. I
therefore cannot load any libraries containing fortran code (I obtain
unresolved symbol messages from R.X11 and an unable to load shared
library from dyn.load(file)).
If I change the "-lf2c" flag on the FLIBS line of the Makeconf to
"-L/usr/lib/libf2c", I then obtain the following error when R.X11 is
being created:

gcc -export-dynamic  -o ../../bin/R.X11 arithmetic.o array.o attrib.o bind.o builtin.o character.o coerce.o colors.o complex.o context.o cov.o cum.o debug.o devPS.o devPicTeX.o deparse.o deriv.o devices.o dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o main.o match.o memory.o model.o names.o objects.o optimize.o options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o printvector.o printutils.o random.o relop.o saveload.o scan.o seq.o sort.o source.o split.o subassign.o subscript.o subset.o summary.o unique.o util.o version.o ../unix/libunix.a ../appl/libappl.a ../nmath/libmath.a -lSM -lICE -L/usr/X11R6/lib -lX11  -L/usr/lib/libf2c -lm -L/usr/lib/gcc-lib/i486-unknown-linux-gnulibc1/2.7.2.3 -L/usr/i486-unknown-linux-gnulibc1/lib -lm  -lreadline -lz -ldl -lncurses -lm 
../appl/libappl.a(uncmin.o): In function `optchk_':
/usr/local/src/R/src/appl/uncmin.f:1848: undefined reference to `d_lg10'
make[3]: *** [../../bin/R.X11] Error 1

Does anyone have an idea how I could get my libraries working?
Thank you,
Patrick.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plindsey@alpha.luc.ac.be  Wed Sep  1 10:49:37 1999
From: plindsey@alpha.luc.ac.be (plindsey@alpha.luc.ac.be)
Date: Wed, 1 Sep 1999 11:49:37 +0200 (MET DST)
Subject: Problems compiling R65.0 (PR#262)
Message-ID: <199909010949.LAA03540@pubhealth.ku.dk>

Hi,
I appear to have a slight problem compiling R0.65.0 under Linux
(slackware) using g77. By simply typing configure then make, I obtain
a binary which when "ldd" does not contain the f2c library. I
therefore cannot load any libraries containing fortran code (I obtain
unresolved symbol messages from R.X11 and an unable to load shared
library from dyn.load(file)).
If I change the "-lf2c" flag on the FLIBS line of the Makeconf to
"-L/usr/lib/libf2c", I then obtain the following error when R.X11 is
being created:

gcc -export-dynamic  -o ../../bin/R.X11 arithmetic.o array.o attrib.o bind.o builtin.o character.o coerce.o colors.o complex.o context.o cov.o cum.o debug.o devPS.o devPicTeX.o deparse.o deriv.o devices.o dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o main.o match.o memory.o model.o names.o objects.o optimize.o options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o printvector.o printutils.o random.o relop.o saveload.o scan.o seq.o sort.o source.o split.o subassign.o subscript.o subset.o summary.o unique.o util.o version.o ../unix/libunix.a ../appl/libappl.a ../nmath/libmath.a -lSM -lICE -L/usr/X11R6/lib -lX11  -L/usr/lib/libf2c -lm -L/usr/lib/gcc-lib/i486-unknown-linux-gnulibc1/2.7.2.3 -L/usr/i486-unknown-linux-gnulibc1/lib -lm  -lreadline -lz -ldl -lncurses -lm 
../appl/libappl.a(uncmin.o): In function `optchk_':
/usr/local/src/R/src/appl/uncmin.f:1848: undefined reference to `d_lg10'
make[3]: *** [../../bin/R.X11] Error 1

Does anyone have an idea how I could get my libraries working?
Thank you,
Patrick.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plindsey@alpha.luc.ac.be  Wed Sep  1 10:55:56 1999
From: plindsey@alpha.luc.ac.be (plindsey@alpha.luc.ac.be)
Date: Wed, 1 Sep 1999 11:55:56 +0200 (MET DST)
Subject: Problems sourcing functions with R65.0 (PR#263)
Message-ID: <199909010955.LAA03720@pubhealth.ku.dk>

Hi,
Sorry for cross-posting the last error message.
I have encountered some more strange problems when loading another of my
libraries. I get a parsing error ("syntax error on line 1707"). I have
carefully looked at my code and there are no syntax errors. In fact, on
R64.1 this function was parsed in properly when the library was loaded
(I just copied the library from one version to another without making any
changes).
I saved my function which is 1734 lines long (all one function) and it appears
that source will not parse a function with more than 1707 lines. Even more
puzzling, if I copy the function and paste it right at the R prompt, the
function does not yield any parsing problem... Would there therefore be a
buffer limit problems of some kind for sourcing files??? If so how can I
modify it??
Thank you,
Patrick.


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Sep  1 11:18:15 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 01 Sep 1999 12:18:15 +0200
Subject: Problems compiling R65.0 (PR#262)
In-Reply-To: plindsey@alpha.luc.ac.be's message of "Wed, 1 Sep 1999 11:49:37 +0200 (MET DST)"
References: <199909010949.LAA03540@pubhealth.ku.dk>
Message-ID: <x21zcjdjfc.fsf@blueberry.kubism.ku.dk>

plindsey@alpha.luc.ac.be writes:

> Hi,
> I appear to have a slight problem compiling R0.65.0 under Linux
> (slackware) using g77. By simply typing configure then make, I obtain
> a binary which when "ldd" does not contain the f2c library. I
> therefore cannot load any libraries containing fortran code (I obtain
> unresolved symbol messages from R.X11 and an unable to load shared
> library from dyn.load(file)).

Yes, this is a bit of a pain. The issue is that libf2c is not a
dynamic library on all systems, and hence does not show on ldd, and
only the routines that are actually used by R get loaded into the
binary. 

What should happen in that case is that R SHLIB/INSTALL would generate
so files with the relevant Fortran linked in, e.g. if that doesn't
happen for you, there's a bug in the configure script. With egsc/g77 I
get the following:

# R INSTALL multiv
Installing package `multiv' ...
 libs
g77  -fPIC -g -O2 -c bea.f -o bea.o
g77  -fPIC -g -O2 -c ca.f -o ca.o
g77  -fPIC -g -O2 -c hc.f -o hc.o
g77  -fPIC -g -O2 -c hcmovie.f -o hcmovie.o
g77  -fPIC -g -O2 -c members.f -o members.o
g77  -fPIC -g -O2 -c partition.f -o partition.o
g77  -fPIC -g -O2 -c pca.f -o pca.o
g77  -fPIC -g -O2 -c sammon.f -o sammon.o
gcc -shared  -o /usr/local/lib/R/library/multiv/libs/multiv.so bea.o ca.o hc.o hcmovie.o members.o partition.o pca.o sammon.o -L/usr/lib/gcc-lib/i386-redhat-linux/egcs-2.91.66 -L/usr/i386-redhat-linux/lib -lg2c -lm

# R SHLIB ca.f 
gcc -shared  -o ca.so ca.o -L/usr/lib/gcc-lib/i386-redhat-linux/egcs-2.91.66 -L/usr/i386-redhat-linux/lib -lg2c -lm



> If I change the "-lf2c" flag on the FLIBS line of the Makeconf to
> "-L/usr/lib/libf2c", I then obtain the following error when R.X11 is
> being created:

That couldn't possibly work. '-L' specifies a directory to search, so
you get the same effect as if you had just removed -lf2c.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Jonathan Rougier <J.C.Rougier@durham.ac.uk>  Wed Sep  1 14:14:18 1999
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk> (Jonathan Rougier)
Date: Wed, 1 Sep 1999 14:14:18 +0100 (BST)
Subject: diag()
Message-ID: <Pine.GSO.3.96.990901140456.19209D-100000@laplace>

Hi Martin,

Just to follow my previous suggestion to modify diag(), the code I
suggested is vulnerable to matrices with dimnames(x) <- list(NULL, NULL),
which does occasionally happen (it has just happened to me!), so the
following would be better ...

"diag" <-
function (x = 1, nrow, ncol = n) 
{
    if (is.matrix(x) && nargs() == 1) {
        md <- min(dim(x))
        y <- c(x)[1 + 0:(md - 1) * (dim(x)[1] + 1)]
        nms <- dimnames(x)
        if (is.list(nms) && !any(sapply(nms, is.null)) &&
          all(nms[[1]][1:md] == nms[[2]][1:md])) 
            names(y) <- nms[[1]][1:md]
        return(y)
    }

... the rest as in the original function.  Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Sep  1 21:13:09 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 1 Sep 1999 22:13:09 +0200
Subject: diag()
In-Reply-To: <Pine.GSO.3.96.990901140456.19209D-100000@laplace> (message from
 Jonathan Rougier on Wed, 1 Sep 1999 14:14:18 +0100 (BST))
References: <Pine.GSO.3.96.990901140456.19209D-100000@laplace>
Message-ID: <199909012013.WAA14572@sophie.ethz.ch>

>>>>> On Wed, 1 Sep 1999 14:14:18 +0100 (BST), Jonathan Rougier <J.C.Rougier@durham.ac.uk> said:

    JonR> Just to follow my previous suggestion to modify diag(), the code
    JonR> I suggested is vulnerable to matrices with dimnames(x) <-
    JonR> list(NULL, NULL), which does occasionally happen (it has just
    JonR> happened to me!), so the following would be better ...

    JonR> "diag" <-
    JonR> function (x = 1, nrow, ncol = n) 
    JonR> {
    JonR>   if (is.matrix(x) && nargs() == 1) {
    JonR>     md <- min(dim(x))
    JonR>     y <- c(x)[1 + 0:(md - 1) * (dim(x)[1] + 1)]
    JonR>     nms <- dimnames(x)
    JonR>     if (is.list(nms) && !any(sapply(nms, is.null)) &&
    JonR>         all(nms[[1]][1:md] == nms[[2]][1:md])) 
    JonR>         names(y) <- nms[[1]][1:md]
    JonR>     return(y)
    JonR>   }

    JonR> ... the rest as in the original function.  Cheers, Jonathan.

    JonR> Jonathan Rougier                       Science Laboratories
    JonR> Department of Mathematical Sciences    South Road
    JonR> University of Durham                   Durham DH1 3LE

Your proposal has been (slightly improved) and commited for 0.64.1 
(or tomorrow's snapshot of R-release).

NEWS has
     
    o	diag(x) now keeps names when appropriate and barfs when x is an array.


Thank you very much.	Martin



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Sep  1 22:09:33 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 01 Sep 1999 23:09:33 +0200
Subject: diag()
In-Reply-To: Martin Maechler's message of "Wed, 1 Sep 1999 22:13:09 +0200"
References: <Pine.GSO.3.96.990901140456.19209D-100000@laplace> <199909012013.WAA14572@sophie.ethz.ch>
Message-ID: <x2n1v67302.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> Your proposal has been (slightly improved) and commited for 0.64.1 
                                                                 ^
Um...

> NEWS has
>      
>     o	diag(x) now keeps names when appropriate and barfs when x is an array.

- unless it's of dimension 2, you mean. But is this really desirable
for the 1d case? diag(array(1:9)) used to work like diag(1:9), but is
now an error. E.g. the output of table() can be a 1d array.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Thu Sep  2 11:23:53 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Thu, 2 Sep 1999 12:23:53 +0200 (MET DST)
Subject: R 0.65.x bug :  attach()/eval() {was "lib.source() within library()"} (PR#264)
Message-ID: <199909021023.MAA15071@pubhealth.ku.dk>

In 0.65.0  lib.source() within library()  works differently
and fails to correctly "load" a library when it wants to change an object
that it has defined previously:

Below is a very short shar file that produces a "minimal" example [no
attachment, just appended].
To reproduce  {read on, before doing it!}  do

   sh < libBug.shar <<<<< the file name you gave
   R INSTALL libBug

   echo 'library(libBug)' | R --vanilla --quiet

which gives

    Error: attempt to set an attribute on NULL
    Execution halted

----

The only R code in the whole library is in  libBug/R/only.R

    bla <- pi
    names(bla) <- "N"

However, with help of debug(library) 
and *inside* library  debug(lib.source)

I can now reproduce the problem  without needing library() directly:

    env   <- attach(NULL, name = "libBug")
    exprs <- expression(bla <- pi, names(bla) <- "N")
    for (i in exprs) yy <- eval(i, env)

    ##-> Error: attempt to set an attribute on NULL

and replacing the last line by

    for (i in exprs){ yy <- eval(i,env);print(ls(env=env))
		      cat("bla:",get("bla",env=env),"\n") }
gives

    [1] "*tmp*" "bla"  
    bla: 3.14159265358979 
    Error: attempt to set an attribute on NULL

-----

#!/bin/sh
# This is a shell archive (produced by GNU sharutils 4.2).
# To extract the files from this archive, save it to some FILE, remove
# everything before the `!/bin/sh' line above, then type `sh FILE'.
#
# Made on 1999-09-02 12:00 MET DST by <maechler@sophie>.
# Source directory was `/users/u1/staff/maechler/R'.
#
# Existing files will *not* be overwritten unless `-c' is specified.
# This format requires very little intelligence at unshar time.
# "if test", "echo", "mkdir", and "sed" may be needed.
#
# This shar contains:
# length mode       name
# ------ ---------- ------------------------------------------
#     28 -rw-r--r-- libBug/R/only.R
#     47 -rw-r--r-- libBug/TITLE
#
echo=echo
if mkdir _sh21127; then
  $echo 'x -' 'creating lock directory'
else
  $echo 'failed to create lock directory'
  exit 1
fi
# ============= libBug/R/only.R ==============
if test ! -d 'libBug'; then
  $echo 'x -' 'creating directory' 'libBug'
  mkdir 'libBug'
fi
if test ! -d 'libBug/R'; then
  $echo 'x -' 'creating directory' 'libBug/R'
  mkdir 'libBug/R'
fi
if test -f 'libBug/R/only.R' && test "$first_param" != -c; then
  $echo 'x -' SKIPPING 'libBug/R/only.R' '(file already exists)'
else
  $echo 'x -' extracting 'libBug/R/only.R' '(text)'
  sed 's/^X//' << 'SHAR_EOF' > 'libBug/R/only.R' &&
Xbla <- pi
Xnames(bla) <- "N"
SHAR_EOF
  : || $echo 'restore of' 'libBug/R/only.R' 'failed'
fi
# ============= libBug/TITLE ==============
if test -f 'libBug/TITLE' && test "$first_param" != -c; then
  $echo 'x -' SKIPPING 'libBug/TITLE' '(file already exists)'
else
  $echo 'x -' extracting 'libBug/TITLE' '(text)'
  sed 's/^X//' << 'SHAR_EOF' > 'libBug/TITLE' &&
XlibBug	Simple Package to show lib.source() bug
SHAR_EOF
  : || $echo 'restore of' 'libBug/TITLE' 'failed'
fi
rm -fr _sh21127
exit 0

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From gautier@lion-ag.de  Thu Sep  2 16:40:48 1999
From: gautier@lion-ag.de (gautier@lion-ag.de)
Date: Thu, 2 Sep 1999 17:40:48 +0200 (MET DST)
Subject: trouble with the 'exclude' parameter of factor() (PR#265)
Message-ID: <199909021540.RAA19224@pubhealth.ku.dk>

Full_Name: Laurent Gautier
Version: 0.65.0
OS: Irix 6.5
Submission from: (NULL) (195.110.4.98)


the following doesn't give what I expect

> test _ factor(ORGMORE[[1]],exclude=c(NA,"NOM"))
Warning message: 
NAs introduced by coercion 
> levels(test)
[1] "CYT" "EXC" "MEM" "NOM" "NUC" "SEC"


while this works...

> test _ factor(ORGMORE[[1]],levels=c("CYT","EXEC","MEM","NUC","SEC"),exclude=NA)
> levels(test)
[1] "CYT"  "EXEC" "MEM"  "NUC"  "SEC" 


All apologies if I misunderstood the help page for the factor() function and
this is not strange...
(I mean the results obtained, not my understanding of the help pages  =)    ).



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Sep  2 18:55:14 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 2 Sep 1999 19:55:14 +0200 (MET DST)
Subject: trouble with the 'exclude' parameter of factor() (PR#265)
Message-ID: <199909021755.TAA19894@pubhealth.ku.dk>

On Thu, 2 Sep 1999 gautier@lion-ag.de wrote:

> Full_Name: Laurent Gautier
> Version: 0.65.0
> OS: Irix 6.5
> Submission from: (NULL) (195.110.4.98)
> 
> 
> the following doesn't give what I expect
> 
> > test _ factor(ORGMORE[[1]],exclude=c(NA,"NOM"))
> Warning message: 
> NAs introduced by coercion 
> > levels(test)
> [1] "CYT" "EXC" "MEM" "NOM" "NUC" "SEC"

For another posting of yours, I assume the x argument is a factor.
Now ?factor is missing an arguments section, but if x is a factor,
exclude has to be a factor too (with the same set of levels plus perhaps
NA), or coercible to factor codes.  So please try

factor(as.character(ORGMORE[[1]]), exclude=c(NA,"NOM"))

> while this works...
> 
> > test _ factor(ORGMORE[[1]],levels=c("CYT","EXEC","MEM","NUC","SEC"),exclude=NA)
> > levels(test)
> [1] "CYT"  "EXEC" "MEM"  "NUC"  "SEC" 
> 
> 
> All apologies if I misunderstood the help page for the factor() function and
> this is not strange...
> (I mean the results obtained, not my understanding of the help pages  =)    ).

We definitely need to document the arguments, probably make this 
friendlier.

PS: as Irix 6.5 is not in the PLATFORMS list, please do us a favour and
submit a PLATFORMS report.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Richard.Beare@cmis.csiro.au  Fri Sep  3 04:29:11 1999
From: Richard.Beare@cmis.csiro.au (Richard Beare)
Date: Fri, 03 Sep 1999 13:29:11 +1000
Subject: recent R versions on alpha-osf-4
Message-ID: <37CF4087.1032CE97@cmis.csiro.au>

Hello,
I'm keen to get R working on the alpha, but haven't managed to build
anything that gets past the "make test" stage. There used to be some
documentation about -mieee_ type changes, but I never had any luck with
these. I'd like to build my own version because I don't have root access
to install the binary version.

Has anyone else had any luck with this? I can't see anything suggesting
ways to go in the documents with R-0.65.

Thanks

-- 
Richard Beare
Richard.Beare@cmis.csiro.au
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Sep  3 23:43:55 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Sat, 4 Sep 1999 00:43:55 +0200
Subject: diag()
In-Reply-To: <x2n1v67302.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 01 Sep 1999 23:09:33 +0200)
References: <Pine.GSO.3.96.990901140456.19209D-100000@laplace> <199909012013.WAA14572@sophie.ethz.ch> <x2n1v67302.fsf@blueberry.kubism.ku.dk>
Message-ID: <199909032243.AAA03262@sophie.ethz.ch>


    PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:
    >> Your proposal has been (slightly improved) and commited for 0.64.1
    PD>                                                                  ^
    PD> Um...

    >> NEWS has
    >> 
    >> o diag(x) now keeps names when appropriate and barfs when x is an
    >> array.

    PD> - unless it's of dimension 2, you mean.
yes..
    PD> But is this really
    PD> desirable for the 1d case? diag(array(1:9)) used to work like
    PD> diag(1:9), but is now an error. E.g. the output of table() can be a
    PD> 1d array.

I know.  
But I think that people may expect something else from diag(<array>).
I don't mind letting the 1D case still go by, but certainly not d >= 3 !

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Sep  5 23:00:49 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Mon, 6 Sep 1999 00:00:49 +0200 (MET DST)
Subject: [R] data frame component replacement: feature or bug? (PR#266)
Message-ID: <199909052200.AAA08081@pubhealth.ku.dk>

Matthew Wiener <mcw@ln.nimh.nih.gov> writes:

> t1 <- data.frame(matrix(rnorm(16), nc=4))
> t1$X1 <- 1  
> t1$X2 <- 2
> print(t1)
> Error: dim<- length of dims do not match the length of object

Well, it is prototype-compatible. Splus 5.3 does likewise. A way out
is

t1<-data.frame(unclass(t1))

However, we do seem to have a bug in the area:

>  t1 <- data.frame(matrix(rnorm(16), nc=4))
>  transform(t1,X1=1)
Error: dim<- length of dims do not match the length of object
>  transform(t1,X1=1,X2=2)
  X1 X2         X3         X4
1  1  2  0.6020524  1.1595935
2  1  2 -1.8212204 -0.2118746
3  1  2  1.5506706  0.0680275
4  1  2 -0.8872958  0.4709870

This boils down to the construction

dfr[1]<-list(X1=1)

which doesn't extend dfr$X1, whereas

dfr[c(1,2)]<-list(X1=3,X2=4)

does. Splus handles both cases. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Sep  5 23:29:57 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Mon, 6 Sep 1999 00:29:57 +0200 (MET DST)
Subject: [R] data frame component replacement: feature or bug? (PR#266)
Message-ID: <199909052229.AAA08170@pubhealth.ku.dk>

p.dalgaard@biostat.ku.dk writes:

> dfr[1]<-list(X1=1)
> 
> which doesn't extend dfr$X1, whereas
> 
> dfr[c(1,2)]<-list(X1=3,X2=4)
> 
> does. Splus handles both cases. 

Found, fixed, and committed for 0.65.1 (a drop=FALSE was missing where
the replication was done)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mavip5@inet.polyu.edu.hk  Mon Sep  6 02:40:34 1999
From: mavip5@inet.polyu.edu.hk (Li Dongfeng)
Date: Mon, 06 Sep 1999 09:40:34 +0800
Subject: suggestion: postscript paper=user
Message-ID: <37D31B92.7D4C11DA@inet.polyu.edu.hk>

Dear R developers and users,

  I have a suggestion for the postscript device driver.
Now the paer= option only support "a4", "letter",
"legal", "executive". I suggest we add a "user" option
and letter user provide paper size, even like "595x421",
width>height.

For printing purpose, the provided paper size are
nearly enought. But I need to use R to produce
a lot of graphics, and transform these graphics to
PNG format for web publication.  I use ghostscript
to do the transformation, but the default paper size of the
R postscript device is too big, and the orietation
is not correct(we need landscape). I don't know
how to make the image size smaller and
rotating 90 degrees with ghostscript.  I had to
patch the R source(src/unix/devPS.c)  myself
to add a paper size. If R provide a paper="user "
option for the postscript device, things would be
much easier.

Li Dongfeng


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep  6 09:47:10 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 6 Sep 1999 10:47:10 +0200
Subject: Proposal for improved grid()  [non-backward compatible]
Message-ID: <199909060847.KAA01186@sophie.ethz.ch>

Not many of you will use grid() widely, probably.
Also, two months ago, Paul Murrell said on R-help (topic "grid command")

  PM>> i think the abline() solution is the best for doing what grid() won't.  
  PM>> like you say, grid() is just a simple front-end to abline().

grid() *is* too simple to be of practical use.

I propose the following which is of some practical use, 
since it uses much more useful defaults:

    grid <- function (nx=NULL, ny=NULL, col="lightgray", lty="dotted")
    {
	if (is.null(nx)|| nx >= 1) {
	    axp <- par("xaxp")
	    if(is.null(nx)) nx <- axp[3]
	    abline(v = seq(axp[1],axp[2],len=1+nx), col = col, lty = lty)
	}
	if (is.null(ny)|| ny >= 1) {
	    axp <- par("yaxp")
	    if(is.null(ny)) ny <- axp[3]
	    abline(h = seq(axp[1],axp[2],len=1+ny), col = col, lty = lty)
	}
    }

Try e.g.

plot(1:10, panel.first = grid(col="red"))
qqnorm(rnorm(100), panel.first=grid())
plot(1:10, panel.first=grid(ny=4))
plot(1:10, panel.first=grid(ny=0))

-----------

The only "problem":  It's not backwards compatible.
Does anyone have a problem with that?

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Mon Sep  6 10:04:18 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon, 6 Sep 1999 11:04:18 +0200 (MET DST)
Subject: matplot(... panel.first=..) fails  <==> dealing with "..." (PR#267)
Message-ID: <199909060904.LAA12129@pubhealth.ku.dk>

Maybe, the following is not a bug in the strict sense,....

The following code shows what the effect :

  p1 <- function(...) plot.default(...)
  p2 <- function(...) { n <- names(list(...)); plot.default(...) }

  par(mfrow=c(2,2))
  p1(1:10, panel.first = grid(10,10)) # works okay (grid drawn)
  p2(1:10, panel.first = grid(10,10)) # doesn't draw the grid

A consequence of this is that the panel.first argument (of plot.default)
doesn't work with matplot()
	[well, matplot()'s doc doesn't claim it should, but still

-------
The real questions behind are:

1a) Why is "..." changed at the moment that I do  list(...)
1b) is this basic behavior desirable / changeable ....

2) How can one work around? 
   {save "..." to something else, first? 
    or explicitly save panel.first?}

-----------------------------

R versions,  both 0.64.2 and 0.65.0  (probably all R versions)

Version:
 platform = sparc-sun-solaris2.5
 arch = sparc
 os = solaris2.5
 system = sparc, solaris2.5
 status =
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

--
Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Sep  6 13:25:30 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 Sep 1999 14:25:30 +0200
Subject: matplot(... panel.first=..) fails  <==> dealing with "..." (PR#267)
In-Reply-To: maechler@stat.math.ethz.ch's message of "Mon, 6 Sep 1999 11:04:18 +0200 (MET DST)"
References: <199909060904.LAA12129@pubhealth.ku.dk>
Message-ID: <x2puzwb51h.fsf@blueberry.kubism.ku.dk>

maechler@stat.math.ethz.ch writes:

> Maybe, the following is not a bug in the strict sense,....
> 
> The following code shows what the effect :
> 
>   p1 <- function(...) plot.default(...)
>   p2 <- function(...) { n <- names(list(...)); plot.default(...) }
> 
>   par(mfrow=c(2,2))
>   p1(1:10, panel.first = grid(10,10)) # works okay (grid drawn)
>   p2(1:10, panel.first = grid(10,10)) # doesn't draw the grid
...
> The real questions behind are:
> 
> 1a) Why is "..." changed at the moment that I do  list(...)
> 1b) is this basic behavior desirable / changeable ....

That's a result of lazy evaluation. plot.default is really playing
with fire, the way it is currently written. list(...) will force
evaluation of the promises which in turn causes grid() to be called
too early. I don't think it is desirable to change this behavior
(well, Robert wants us to consider eager evaluation, but that would
cause the construction to stop working in all cases!)

> 2) How can one work around? 
>    {save "..." to something else, first? 
>     or explicitly save panel.first?}
> 

Neither of the above, because the object is to access "..." without forcing
evaluation of its contents. One can do things like

> p2
function (...) 
{
    n <- names(match.call(expand.dots = F)[["..."]])
    plot.default(...)
}

Or, one can modify plot.default to take panel.first as an
*unevaluated* expression (mode "call" or "expression"), and do an
explicit eval(panel.first). But then you'd have to do 

p2(1:10, panel.first = quote(grid(10,10))) # or expression( )

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Sep  6 13:54:37 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 6 Sep 1999 13:54:37 +0100 (BST)
Subject: Fortran character strings
Message-ID: <199909061254.NAA00597@toucan.stats.ox.ac.uk>

Has anyone ever successfully used Fortran character strings with R?

?Foreign says

         R              C                  Fortran
      integer       int *              integer
  ....
      character     char **            [compiler dependent]

     Character strings are passed as C arrays of character
     strings to Fortran: the first string may be usable if
     its length is passed separately.

and I have been taking a look. The linkage sends char ** to Fortran.
On the other hand, INTPR and  DBLEPR assume Fortran character strings
are char *.  On all my systems DBLEPR works and .Fortran does not,
but I do know of one compiler (Watcom Fortran for Windows NT) where the 
linkage really is equivalent to char **.

Fortran in S takes the first string in a character vector and passes that as
char * (except on the Watcom-compiled Windows version), as far as I
can deduce without the source code.

I think we should either ban character strings in .Fortran or follow
the S prototype unless someone has a way around this.  With different
compilers on the same platform having different conventions whatever we
do (except a ban) will be compiler-dependent.

Any suggestions?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jnf@pcisys.net  Mon Sep  6 21:03:53 1999
From: jnf@pcisys.net (jnf@pcisys.net)
Date: Mon, 6 Sep 1999 22:03:53 +0200 (MET DST)
Subject: Compiling R under Caldera Open Linux 2.2 (PR#268)
Message-ID: <199909062003.WAA19950@pubhealth.ku.dk>


Thanks for your help.  I loaded XFree86-devel-3.3.3.1-3.i386.rpm from my
OpenLinux CD and as you indicate this solved by X11 include file
problem.

I then encountered the linking same problem as you describe below.  The
error message is saying that the compiler can't find the libg2c library,
which is its runtime library.  Apparently the g77 supplied by Caldera is
missing this important piece.  I downloaded egcs-1.1.2-12.i386.rpm from
the Red Hat web site, then did the following to extract and install
libg2c:

1) rpm2cpio < egcs-1.1.2-12.i386.rpm > egcs-1.1.2-12.cpio

2) cpio -irv \*libg2c.a < egcs-1.1.2-12.cpio
- when prompted to rename it, I entered libg2c.a.  This created the
libg2c archive in my current directory.

3) mv libg2c.a /usr/lib/gcc-lib/i386-linux/egcs-2.91.66

That got past the link error you describe.  I then encountered a whole
series of undefined references to X routines.  I was able to determine
that all the routines exist in the X11 library
/usr/X11R6/lib/libX11.so.6.1 but configure was not setting things up
properly to link that library.  After spending a while trying to figure
out configure (it's pretty confusing besides not handling X well; for
instance --with-x doesn't do anything, and --x-libraries doesn't seem to
do much) I gave up and editted the R-0.64.2/src/main/Makefile directly. 
I added on line 44 "-L /usr/X11R6/lib" before $(DLLFLAGS) and also -lX11
at the end of the line.  After doing that, "make" and "make install"
both completed successfully.

So now I've got R installed successfully.  Its interface is fairly
intimidating.  Are there some examples online that would walk me through
some simple calculations/graphs?

- Jack Fenner


John Maindonald wrote:
> 
> To: jnf@pcisys.net
> Subject: Compilation of R under Caldera OpenLinux 2.2
> 
> > On Sat, 28 Aug 1999 jnf@pcisys.net wrote:
> > >
> > > I am attempting to compile R-0.64.2 under Caldera OpenLinux 2.2.  I have
> > > KDE installed but not gnome.  When I ran configure, it correctly
> > > indicated that gnome is not installed.  However when I then ran make, I
> > > received errors complaining that  the include file X11/X.h and similar
> > > are not found.
> ....
> > However, you do have X11 on your machine if you have KDE, and you
> > definitely do want to use X11 in R to get graphics.
> >
> >  You may not have the X11 header files installed -- they should be
> > somewhere under /usr/X11 or /usr/include/X11.  If the header files aren't
> > installed then you will need to install them. They will be on your
> > distribution CD, perhaps in a package called something like x-devel.
> 
> They are in the file Packages/RPMS/XFree86-devel-3.3.3.1-4.i386.rpm
> 
> (On the RedHat 6.0 distribution, there is
> XFree86-devel-3.3.3.1-49.i386.rpm
> which seems to be a later version.)
> 
> ----------------------------------------------------------------
> I have been wrestling with this also.  I had to install g77 from
> the distribution CD, then the above rpm.
> Having got this in order, I then received extensive output,
> terminated by the following (which I have formatted on to
> multiple lines):
> 
> gcc -export-dynamic -o ../../bin/R.X11 arithmetic.o array.o attrib.o
>  bind.o builtin.o character.o coerce.o colors.o complex.o context.o
>  cov.o cum.o debug.o devPS.o devPicTeX.o deparse.o deriv.o devices.o
>  dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o
>  fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o
>  main.o match.o memory.o model.o names.o objects.o optimize.o
>  options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o
>  print.o printarray.o printvector.o printutils.o random.o relop.o
>  saveload.o scan.o seq.o sort.o source.o split.o subassign.o
>  subscript.o subset.o summary.o unique.o util.o version.o
>  ../unix/libunix.a ../appl/libappl.a ../nmath/libmath.a -lSM -lICE
>  -L/usr/X11R6/lib -lX11 -L/usr/lib/gcc-lib/i386-linux/egcs-2.91.66
>  -L/usr/i386-linux/lib -lg2c -lm -lg2c: -ldl -lm
>  /usr/i386-linux/bin/ld: cannot open -lg2c: No such file or directory
> make[3]: *** [../../bin/R.X11] Error 1 make[3]: Leaving directory
> `/home/john/BUILD/src/main' make[2]: *** [R] Error 2 make[2]:
> Leaving directory `/home/john/BUILD/src/main' make[1]: *** [R] Error
> 1 make[1]: Leaving directory `/home/john/BUILD/src' make: *** [R]
> Error 1
> 
> I have been unable to find anything on the distribution CD that
> might answer to the lg2c.  Any clues would be welcome.
> 
> These difficulties aside, the Caldera OpenLinux 2.2 distribution
> is much more novice-friendly than RedHat 6.0.  Configuration is
> much quicker and more straightforward.
> 
> John Maindonald               email : john.maindonald@anu.edu.au
> Statistical Consulting Unit,  phone : (6249)3998
> c/o CMA, SMS,                 fax   : (6249)5549
> John Dedman Mathematical Sciences Building
> Australian National University
> Canberra ACT 0200
> Australia

-- 

Jack Fenner


  I am life that wills to live in the midst of life that wills to live.
             - Albert Schweitzer, "Out of my Life and Thought"

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jnf@pcisys.net  Mon Sep  6 15:03:02 1999
From: jnf@pcisys.net (Jack N.)
Date: Mon, 06 Sep 1999 08:03:02 -0600
Subject: Compiling R under Caldera Open Linux 2.2
References: <199908290938.TAA07841@leonard.anu.edu.au>
Message-ID: <37D3C996.CACE6A14@pcisys.net>


Thanks for your help.  I loaded XFree86-devel-3.3.3.1-3.i386.rpm from my
OpenLinux CD and as you indicate this solved by X11 include file
problem.

I then encountered the linking same problem as you describe below.  The
error message is saying that the compiler can't find the libg2c library,
which is its runtime library.  Apparently the g77 supplied by Caldera is
missing this important piece.  I downloaded egcs-1.1.2-12.i386.rpm from
the Red Hat web site, then did the following to extract and install
libg2c:

1) rpm2cpio < egcs-1.1.2-12.i386.rpm > egcs-1.1.2-12.cpio

2) cpio -irv \*libg2c.a < egcs-1.1.2-12.cpio
- when prompted to rename it, I entered libg2c.a.  This created the
libg2c archive in my current directory.

3) mv libg2c.a /usr/lib/gcc-lib/i386-linux/egcs-2.91.66

That got past the link error you describe.  I then encountered a whole
series of undefined references to X routines.  I was able to determine
that all the routines exist in the X11 library
/usr/X11R6/lib/libX11.so.6.1 but configure was not setting things up
properly to link that library.  After spending a while trying to figure
out configure (it's pretty confusing besides not handling X well; for
instance --with-x doesn't do anything, and --x-libraries doesn't seem to
do much) I gave up and editted the R-0.64.2/src/main/Makefile directly. 
I added on line 44 "-L /usr/X11R6/lib" before $(DLLFLAGS) and also -lX11
at the end of the line.  After doing that, "make" and "make install"
both completed successfully.

So now I've got R installed successfully.  Its interface is fairly
intimidating.  Are there some examples online that would walk me through
some simple calculations/graphs?

- Jack Fenner


John Maindonald wrote:
> 
> To: jnf@pcisys.net
> Subject: Compilation of R under Caldera OpenLinux 2.2
> 
> > On Sat, 28 Aug 1999 jnf@pcisys.net wrote:
> > >
> > > I am attempting to compile R-0.64.2 under Caldera OpenLinux 2.2.  I have
> > > KDE installed but not gnome.  When I ran configure, it correctly
> > > indicated that gnome is not installed.  However when I then ran make, I
> > > received errors complaining that  the include file X11/X.h and similar
> > > are not found.
> ....
> > However, you do have X11 on your machine if you have KDE, and you
> > definitely do want to use X11 in R to get graphics.
> >
> >  You may not have the X11 header files installed -- they should be
> > somewhere under /usr/X11 or /usr/include/X11.  If the header files aren't
> > installed then you will need to install them. They will be on your
> > distribution CD, perhaps in a package called something like x-devel.
> 
> They are in the file Packages/RPMS/XFree86-devel-3.3.3.1-4.i386.rpm
> 
> (On the RedHat 6.0 distribution, there is
> XFree86-devel-3.3.3.1-49.i386.rpm
> which seems to be a later version.)
> 
> ----------------------------------------------------------------
> I have been wrestling with this also.  I had to install g77 from
> the distribution CD, then the above rpm.
> Having got this in order, I then received extensive output,
> terminated by the following (which I have formatted on to
> multiple lines):
> 
> gcc -export-dynamic -o ../../bin/R.X11 arithmetic.o array.o attrib.o
>  bind.o builtin.o character.o coerce.o colors.o complex.o context.o
>  cov.o cum.o debug.o devPS.o devPicTeX.o deparse.o deriv.o devices.o
>  dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o
>  fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o
>  main.o match.o memory.o model.o names.o objects.o optimize.o
>  options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o
>  print.o printarray.o printvector.o printutils.o random.o relop.o
>  saveload.o scan.o seq.o sort.o source.o split.o subassign.o
>  subscript.o subset.o summary.o unique.o util.o version.o
>  ../unix/libunix.a ../appl/libappl.a ../nmath/libmath.a -lSM -lICE
>  -L/usr/X11R6/lib -lX11 -L/usr/lib/gcc-lib/i386-linux/egcs-2.91.66
>  -L/usr/i386-linux/lib -lg2c -lm -lg2c: -ldl -lm
>  /usr/i386-linux/bin/ld: cannot open -lg2c: No such file or directory
> make[3]: *** [../../bin/R.X11] Error 1 make[3]: Leaving directory
> `/home/john/BUILD/src/main' make[2]: *** [R] Error 2 make[2]:
> Leaving directory `/home/john/BUILD/src/main' make[1]: *** [R] Error
> 1 make[1]: Leaving directory `/home/john/BUILD/src' make: *** [R]
> Error 1
> 
> I have been unable to find anything on the distribution CD that
> might answer to the lg2c.  Any clues would be welcome.
> 
> These difficulties aside, the Caldera OpenLinux 2.2 distribution
> is much more novice-friendly than RedHat 6.0.  Configuration is
> much quicker and more straightforward.
> 
> John Maindonald               email : john.maindonald@anu.edu.au
> Statistical Consulting Unit,  phone : (6249)3998
> c/o CMA, SMS,                 fax   : (6249)5549
> John Dedman Mathematical Sciences Building
> Australian National University
> Canberra ACT 0200
> Australia

-- 

Jack Fenner


  I am life that wills to live in the midst of life that wills to live.
             - Albert Schweitzer, "Out of my Life and Thought"
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@biostat.ku.dk  Tue Sep  7 06:15:04 1999
From: pd@biostat.ku.dk (Peter Dalgaard BSA)
Date: Tue, 7 Sep 1999 07:15:04 +0200
Subject: Bug list summary (automatic post)
Message-ID: <199909070515.HAA03031@biostat.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.biostat.ku.dk or via email to
r-bugs@biostat.ku.dk. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

* PR# 138 *
Subject: Re: [R] bug? and New bug.
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Wed, 10 Mar 1999 17:21:16 +0100
--pt() for large df. Solved, but problem remains for pf et al.

Directory:  Add-ons

* PR# 137 *
Subject: funfits
From: "Alvaro A. Novo" <novo@uiuc.edu>
Date: Tue, 9 Mar 1999 22:24:54 -0600
--Not our problem. Dubious whether a bug at all.

Directory:  Analyses

* PR# 144 *
Subject: glm throws erroneous(?)'names attribute must be the same length as the vector' 
From: wagman@enteract.com
Date: Thu, 18 Mar 1999 08:58:47 +0100
--Can anyone reproduce this ??
--Same error as when doing regression on empty subset. All fitted
--values might be 0 or 1

Directory:  Documentation

none

Directory:  Graphics

* PR# 61 *
Subject: points(...,  cex = ..)  is pretty wrong...
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 2 Nov 1998 19:15:06 +0100
--Symbols getting decentered when too large cex for X. Still there 22feb99  
* PR# 69 *
Subject: Some graphics bugs
From: Martyn Plummer <plummer@iarc.fr>
Date: Fri, 04 Dec 1998 11:42:50 -0000 ()
Date: 04-Dec-98
--Various anomalies with text size and alignment. 2B appears to be solved. The 
--rest is still there (22feb99)
* PR# 120 *
Subject: graphics bug: type="l"
From: Matthew Wiener <mcw@ln.nimh.nih.gov>
Date: Tue, 16 Feb 1999 15:30:25 -0500 (EST)
--X server problem drawing > 64K lines at once. Workaround?
* PR# 123 *
Subject: Text in plot
From: Ennapadam Venkatraman <venkat@biosta.mskcc.org>
Date: Thu, 18 Feb 1999 13:05:37 -0500
--Multiline text not working
* PR# 130 *
Subject: lty=0 -- shouldn't it give an invisible line?
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 28 Feb 1999 21:45:43 +0100
--Strange effect on barplot
* PR# 149 *
Subject: plot.formula and pch=
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 25 Mar 1999 21:22:44 +0100
--plot(y~x,pch=z) may subset x and y but leave z.
--E.g. with missing values you can get incorrect plot symbols.
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--Don't think I (pd) got the point there...
* PR# 225 *
Subject: pch and mkh bug
From: Stephen Harker <sjh@ph.adfa.edu.au>
Date: Wed, 14 Jul 1999 13:10:31 +1000 (EST)
--(1) is an S incompatibility, but the S rules may not be a good model
--(2) is a bug, fixed for 0.65.0
--(3) has gone away in 0.65.0
* PR# 229 *
Subject: dev.print scaling bug?
From: John.Peters@tip.csiro.au (John Peters)
Date: Fri, 16 Jul 1999 12:10:48 +1000 (EST)
* PR# 230 *
Subject: Use of lwd = 0, lty = 2 in segments.
From: Douglas Bates <bates@stat.wisc.edu>
Date: Sat, 17 Jul 1999 17:18:44 -0500 (CDT)
* PR# 238 *
Subject: EPS compliance of postscript device: initclip operator
From: David Middleton <dajm@deeq.demon.co.uk>
Date: Tue, 03 Aug 1999 17:51:47 -0300
--initclip is removed. Still need new argument onefile/onepage to ensure one page
--and use %!PS-Adobe-3.0 EPSF-3.0 header

Directory:  In-Out

* PR# 125 *
Subject: scan rejects complex
From: John.Peters@tip.csiro.au (John Peters)
Date: Mon, 22 Feb 1999 10:08:14 +1100 (EST)
* PR# 129 *
Subject: Formatting in formatC and format
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 28 Feb 1999 08:53:34 +0000 (GMT)
--Documentation and ``merge'' of format() and formatC() would be desired - MM
* PR# 207 *
Subject: Lines longer than ~1000 chars truncated at parsing
From: msa@biostat.mgh.harvard.edu
Date: Mon, 7 Jun 1999 22:27:10 +0200 (MET DST)
--Fixed buffer used during input.
--Not fixable without major changes to readline lib.

Directory:  Installation

none

Directory:  Language

* PR# 105 *
Subject: an old bug resurfaces
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Fri, 29 Jan 1999 08:28:32 +0100 (MET)
--Model formulas. Proper fix probably requires extensive rewrite of model formula
--parser, which would make in non-S-compatible.
* PR# 239 *
Subject: cbind is not generic as claimed, omits labels where S has them 
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 5 Aug 1999 12:29:58 +0100 (BST)
--Cbind is now generic, still labelling issues. See also PR#240 and PR#241.
* PR# 240 *
Subject: Re: cbind is not generic as claimed, omits labels where S has them
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 5 Aug 1999 17:19:08 +0100 (BST)
--See PR#239
* PR# 241 *
Subject: Re: cbind is not generic as claimed, omits labels where S has them
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Fri, 6 Aug 1999 06:52:35 +0100 (BST)
--See PR#239

Directory:  Low-level

* PR# 37 *
Subject: S.h compatibility issues
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 6 Sep 1998 19:58:47 +0100 (BST)
--1 is fixed
--2 R's own RNG entry points are still not public
--3 is the perennial issue of what is the `public' API -- specific points are
--fixed
* PR# 101 *
Subject: Re: [R] Re: R-0.63.2 for Windows - some comments
From: Guido Masarotto <guido@hal.stat.unipd.it>
Date: Fri, 22 Jan 1999 12:40:26 +0100
--This is really about fixed buffer sizes in printutils.c
* PR# 135 *
Subject: summary() of lm() problem
From: Simon Fear <fears@roycastle.liv.ac.uk>
Date: Tue, 9 Mar 1999 13:18:37 -0000 
--lm (?) AND Windows problem;  Win solved (fudged) for 0.63.3
--
--Another low-level buffer-size problem
* PR# 185 *
Subject: Re: [R] R_problem_buf in the S.h files & lists in .C
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 05 May 1999 00:32:49 +0200
--S objects in .C calls (not just lists) are now documented in the help file
* PR# 197 *
Subject: glm crash
From: Cor en Aylin <Cor.Berrevoets@gironet.nl>
Date: Fri, 21 May 1999 19:44:23 +0200
--Obscure report. Cannot reproduce from given info.
* PR# 210 *
Subject: definition of R_problem_buf in S.h
From: vogels@ieee.org
Date: Mon, 14 Jun 1999 17:56:04 +0200 (MET DST)
--Same as #185
* PR# 235 *
Subject:  round(numeric(0)) 
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 29 Jul 1999 15:20:21 +0100 (BST)
--Some followup of this on R-devel not sent here.

Directory:  Misc

* PR# 91 *
Subject: possible bug
From: Rashid Nassar <rnassar@duke.edu>
Date: Sat, 9 Jan 1999 14:50:58 -0500 (EST)
--Remaining issue is whether we can do something more friendly than dumping 
--users into vi?

Directory:  Models

* PR# 121 *
Subject:  model.frame mangles time series 
From: Peter Dalgaard BSA <pd@biostat.ku.dk>
Date: Thu, 18 Feb 1999 15:47:24 +0100
--Subset in C code + attributes = mess
--Switch to interpreted ("[")

Directory:  Startup

none

Directory:  System-specific

* PR# 214 *
From: Charles Taylor <charles@amsta.leeds.ac.uk>
Date: Thu, 24 Jun 1999 11:20:06 +0100 (BST)
* PR# 222 *
Subject: Use of R-Coda
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Fri, 9 Jul 1999 10:54:16 +0200 
--In Danish (?)  Looks as if PR#246 is the same in English
* PR# 234 *
Subject: R-bugs
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Tue, 27 Jul 1999 13:49:31 +0200
--Looks like PR#222 again, in Danish. See PR#246 for English version
* PR# 246 *
Subject: R-Coda on rs6000-ibm-aix4.2.1.0
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Wed, 11 Aug 1999 08:49:47 +0200
--Problem with ps on AIX in 0.64.2. Try again with 0.65.0?

Directory:  TooMuchAtOnce

* PR# 53 *
Subject: 0.62.3 bugs, incompatibilities and problems
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Mon, 12 Oct 1998 09:43:51 +0200 (MET DST)
--Of Jims points: (checked in 0.65 April 26 compared to Splus 3.4)
-- 4. works the same as S
-- 5. Splus gives NA and the if(class(z)=="repeated") doesn't work in either
-- 10. seems to work
-- 7.  seems to do what Jim wants now
--  
* PR# 76 *
Subject: R-0.63.0
From: Rashid Nassar <rnassar@acpub.duke.edu>
Date: Fri, 11 Dec 1998 23:20:08 -0500 (EST)

Directory:  Windows

none

Directory:  incoming

* PR# 248 *
Subject: scan() + error interferes with count.fields() in some cases
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 13 Aug 1999 17:44:48 +0200
* PR# 249 *
Subject: axis ignores srt/crt
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Mon, 16 Aug 1999 15:51:49 -0700 (PDT)
* PR# 250 *
From: Peter Malewski <peter@tu-bs.de>
Date: Tue, 17 Aug 1999 12:21:38 +0200 (CEST)
* PR# 251 *
From: Peter Malewski <peter@tu-bs.de>
Date: Tue, 17 Aug 1999 12:21:45 +0200 (CEST)
* PR# 252 *
Subject: bug: R says "Floating exception" on DEC-Alpha w/OSF1
From: "Michael Thompson" <mlthomps@yayoi.mt.m-kagaku.co.jp>
Date: Thu, 19 Aug 1999 06:03:06 +0900
* PR# 253 *
Subject: seg.fault for some illegal .Random.seed (new since 0.64)
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 20 Aug 1999 14:17:31 +0200
* PR# 254 *
Subject: Strange 'Unimplemented feature in rep' error
From: Lutz Prechelt <prechelt@ira.uka.de>
Date: Mon, 23 Aug 1999 19:43:24 +0200
* PR# 255 *
Subject: broken link in R FAQ page?
From: Tian-Xiong Lu <tian@chico.ma.adfa.edu.au>
Date: Tue, 24 Aug 1999 13:41:21 +1000 (EST)
* PR# 256 *
Subject: Error in ?text
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
Date: Wed, 25 Aug 1999 10:00:19 +0100 (BST)
* PR# 257 *
Subject:  dimnames names lost when subscripting 
From: Andreas Weingessel <weingessel@ci.tuwien.ac.at>
Date: Wed, 25 Aug 1999 12:45:28 +0200
* PR# 258 *
Subject: Greek letters in outer margins.
From: "BXC (Bendix Carstensen)" <BXC@NOVO.dk>
Date: Thu, 26 Aug 1999 12:09:17 +0200
* PR# 259 *
Subject: R without X11?
From: "Jack N." <jnf@pcisys.net>
Date: Sat, 28 Aug 1999 09:22:57 -0600
* PR# 260 *
Subject: Re: Compiling R under Caldera Open Linux 2.2
Subject: Compilation of R under Caldera OpenLinux 2.2
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sun, 29 Aug 1999 19:38:13 +1000 (EST)
* PR# 261 *
Subject: interface w/ emacs
From: gautier@lion-ag.de
Date: Mon, 30 Aug 1999 13:28:52 +0200 (MET DST)
* PR# 262 *
Subject: Problems compiling R65.0
From: Patrick Lindsey <plindsey@alpha.luc.ac.be>
Date: Wed, 1 Sep 1999 11:52:29 +0200 (MET DST)
* PR# 263 *
Subject: Problems sourcing functions with R65.0
From: Patrick Lindsey <plindsey@alpha.luc.ac.be>
Date: Wed, 1 Sep 1999 11:58:51 +0200 (MET DST)
* PR# 264 *
Subject: R 0.65.x bug :  attach()/eval() {was "lib.source() within library()"}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Thu, 2 Sep 1999 12:23:43 +0200
* PR# 265 *
Subject: trouble with the 'exclude' parameter of factor()
From: gautier@lion-ag.de
Date: Thu, 2 Sep 1999 17:40:47 +0200 (MET DST)
* PR# 266 *
Subject: Re: [R] data frame component replacement: feature or bug?
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Sep 1999 00:03:29 +0200
* PR# 267 *
Subject: matplot(... panel.first=..) fails  <==> dealing with "..."
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 6 Sep 1999 11:04:03 +0200
* PR# 268 *
Subject: Re: Compiling R under Caldera Open Linux 2.2
From: "Jack N." <jnf@pcisys.net>
Date: Mon, 06 Sep 1999 08:03:02 -0600
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Sep  7 17:42:01 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue, 7 Sep 1999 18:42:01 +0200 (MET DST)
Subject: sys.on.exit appears non-functional (PR#269)
Message-ID: <199909071642.SAA03414@pubhealth.ku.dk>

As far as I can see sys.on.exit() does not work. The following
will give a non-null result in S, and seems about the simplest possible
usage.

test <- function() {
  on.exit(print(1))
  ex <- sys.on.exit()
  str(ex)
  cat("exiting...\n")
}
> test()
 NULL
exiting...
[1] 1

Looking at the code suggests that on.exit is installing the code in
a different context from the one sys.on.exit is looking in, but this is
daunting for non-experts.

The help page does not say what this is supposed to do, of course, but
I assume it is intended to retrieve the on.exit expression, as in S.

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = 
 status.rev = 0
 major = 0
 minor = 65.0
 year = 1999
 month = August
 day = 27
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Sep  8 00:03:45 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 08 Sep 1999 01:03:45 +0200
Subject: sys.on.exit appears non-functional (PR#269)
In-Reply-To: ripley@stats.ox.ac.uk's message of "Tue, 7 Sep 1999 18:42:01 +0200 (MET DST)"
References: <199909071642.SAA03414@pubhealth.ku.dk>
Message-ID: <x2ogfe729a.fsf@blueberry.kubism.ku.dk>

ripley@stats.ox.ac.uk writes:

> As far as I can see sys.on.exit() does not work. The following
> will give a non-null result in S, and seems about the simplest possible
> usage.
> 
> test <- function() {
>   on.exit(print(1))
>   ex <- sys.on.exit()
>   str(ex)
>   cat("exiting...\n")
> }
> > test()
>  NULL
> exiting...
> [1] 1
> 
> Looking at the code suggests that on.exit is installing the code in
> a different context from the one sys.on.exit is looking in, but this is
> daunting for non-experts.

Not really that hard, once I realised that R_GlobalContext is not a
global constant and that R_ToplevelContext is the bottom of the
context stack... sys.on.exit is a function that calls a .Internal.
This inserts an extra context layer - calling the .Internal directly
works - and one just had to look one level further up.

Will commit for 0.65.1 in a moment.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pascal.grandeau@wanadoo.fr  Wed Sep  8 16:56:13 1999
From: pascal.grandeau@wanadoo.fr (pascal.grandeau@wanadoo.fr)
Date: Wed, 8 Sep 1999 17:56:13 +0200 (MET DST)
Subject: R with Windows 95 (PR#271)
Message-ID: <199909081556.RAA15313@pubhealth.ku.dk>

Full_Name: Pascal GRANDEAU
Version: 0.65.0
OS: Windows 95
Submission from: (NULL) (164.138.103.253)


I downloaded the new version of R and I see a little bug with Windows 95. If I
plot anything and then I call the menu Windows/Tile, this works but when I
continue to work after a certain number of input (near 10) the cursor disapear
and I cannot continue. This happens also if I change the dimensions of the
windows.

I don't see the same bug with version 0.64.1.

Thank you very much and felicitations for R which is a very useful program.

Excuse my english.

P. GRANDEAU

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Sep  8 17:24:11 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 8 Sep 1999 18:24:11 +0200 (MET DST)
Subject: R with Windows 95 (PR#271)
Message-ID: <199909081624.SAA15492@pubhealth.ku.dk>

> From: pascal.grandeau@wanadoo.fr
> Date: Wed, 8 Sep 1999 17:56:13 +0200 (MET DST)
> To: r-devel@stat.math.ethz.ch
> Subject: R with Windows 95 (PR#271)
> CC: R-bugs@biostat.ku.dk
> X-Loop: R-bugs@biostat.ku.dk
> 
> Full_Name: Pascal GRANDEAU
> Version: 0.65.0
> OS: Windows 95
> Submission from: (NULL) (164.138.103.253)
> 
> 
> I downloaded the new version of R and I see a little bug with Windows 95. If I
> plot anything and then I call the menu Windows/Tile, this works but when I
> continue to work after a certain number of input (near 10) the cursor disapear
> and I cannot continue. This happens also if I change the dimensions of the
> windows.

Let me be clear, since there are lot of possibilities. You are using
Rgui.exe in mdi mode? Have you changed any options in Rconsole?  At
some point the cursor disppears: do the menus still work? Can you still
move the windows?

> I don't see the same bug with version 0.64.1.

You are commenting on a preliminary release, which as the announcement
says, has not been tested extensively; in particular I have no access
to Windows 95, and very little to Windows 98 (but Guido Masarotto has
to both).  I cannot reproduce this under NT, but I may not be guessing
right what you did. Unfortunately, I suspect a problem with Windows
event handling, and that is very version-dependent.

Please try the official release (when it comes) and report again if the
problem persists. Guido does use a different compile environment from mine.

I have managed to track down two problems (DEL did not work, no printer
chooser appears) both of which are due to errors in header files in the
compiler I used and have been fixed in the current version (you only
need the new rw0650b.zip dated Sept 7).  Given that history, I am quite
ready to believe that there are more of the same.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Sep  9 09:14:54 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 9 Sep 1999 10:14:54 +0200 (CEST)
Subject: Fortran character strings
In-Reply-To: <199909061254.NAA00597@toucan.stats.ox.ac.uk>
References: <199909061254.NAA00597@toucan.stats.ox.ac.uk>
Message-ID: <14295.27774.194390.155680@fangorn.ci.tuwien.ac.at>

>>>>> Prof Brian Ripley writes:

> Has anyone ever successfully used Fortran character strings with R?
> ?Foreign says

>          R              C                  Fortran
>       integer       int *              integer
>   ....
>       character     char **            [compiler dependent]

>      Character strings are passed as C arrays of character
>      strings to Fortran: the first string may be usable if
>      its length is passed separately.

> and I have been taking a look. The linkage sends char ** to Fortran.
> On the other hand, INTPR and DBLEPR assume Fortran character strings
> are char *.  On all my systems DBLEPR works and .Fortran does not, but
> I do know of one compiler (Watcom Fortran for Windows NT) where the
> linkage really is equivalent to char **.

> Fortran in S takes the first string in a character vector and passes
> that as char * (except on the Watcom-compiled Windows version), as far
> as I can deduce without the source code.

> I think we should either ban character strings in .Fortran or follow
> the S prototype unless someone has a way around this.  With different
> compilers on the same platform having different conventions whatever
> we do (except a ban) will be compiler-dependent.

> Any suggestions?

Hmm ... this is someone not knowing what is going (i.e., me) commenting
on this.

I touched this once when porting Rousseeuw's cluster routines to R,
maybe the thread is in the r-core archives.  I seem to recall that
someone told me that this was really a compiler-specific issue and hence
could/should not be part of the API.  (In the specific case, it was a
0/1 string so I found a different solution.)

(Btw, why do we map integer to int * and not long *?)

-k

PS.  A comment on ?.External:  We have

         list          void * (SEXP *)
         other         void * (SEXP)

I think this (showing the alternative in parenteses) may be confusing.
Shouldn't we show the preferred method in the table and mention the
alternative somewhere in the text following?

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Sep  9 09:28:24 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 9 Sep 1999 09:28:24 +0100 (BST)
Subject: Fortran character strings
In-Reply-To: <14295.27774.194390.155680@fangorn.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.05.9909090916450.4120-100000@auk.stats>

On Thu, 9 Sep 1999, Kurt Hornik wrote:

> >>>>> Prof Brian Ripley writes:
> 
> > Has anyone ever successfully used Fortran character strings with R?
> > ?Foreign says
> 
> >          R              C                  Fortran
> >       integer       int *              integer
> >   ....
> >       character     char **            [compiler dependent]
> 
> >      Character strings are passed as C arrays of character
> >      strings to Fortran: the first string may be usable if
> >      its length is passed separately.
> 
> > and I have been taking a look. The linkage sends char ** to Fortran.
> > On the other hand, INTPR and DBLEPR assume Fortran character strings
> > are char *.  On all my systems DBLEPR works and .Fortran does not, but
> > I do know of one compiler (Watcom Fortran for Windows NT) where the
> > linkage really is equivalent to char **.
> 
> > Fortran in S takes the first string in a character vector and passes
> > that as char * (except on the Watcom-compiled Windows version), as far
> > as I can deduce without the source code.
> 
> > I think we should either ban character strings in .Fortran or follow
> > the S prototype unless someone has a way around this.  With different
> > compilers on the same platform having different conventions whatever
> > we do (except a ban) will be compiler-dependent.
> 
> > Any suggestions?
> 
> Hmm ... this is someone not knowing what is going (i.e., me) commenting
> on this.
> 
> I touched this once when porting Rousseeuw's cluster routines to R,
> maybe the thread is in the r-core archives.  I seem to recall that
> someone told me that this was really a compiler-specific issue and hence
> could/should not be part of the API.  (In the specific case, it was a
> 0/1 string so I found a different solution.)

It is compiler-specific, but there is a solution that works in 99% of the
cases that I have put in R-devel, with warnings.

> (Btw, why do we map integer to int * and not long *?)

How would I know?  (Actually, because it lets us use the C linakge, I
guess.)  We do assume that in building R, for things like eigen. I noted
that f2c does have a configure check for this, and I think we probably
ought to find out at configure time what integer does map to and make
.Fortran cover this.

> 
> -k
> 
> PS.  A comment on ?.External:  We have
> 
>          list          void * (SEXP *)
>          other         void * (SEXP)
> 
> I think this (showing the alternative in parenteses) may be confusing.
> Shouldn't we show the preferred method in the table and mention the
> alternative somewhere in the text following?

It is confusing. Actually all of them are mapped to void *, so I think we
should be giving SEXP * and SEXP. Thomas?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Sep  9 15:35:05 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 9 Sep 1999 16:35:05 +0200 (CEST)
Subject: [R] read.table bug
In-Reply-To: <x2aeqwxkyj.fsf@blueberry.kubism.ku.dk>
References: <37D7B372.CDA3589D@inet.polyu.edu.hk>
 <x2aeqwxkyj.fsf@blueberry.kubism.ku.dk>
Message-ID: <14295.50585.281674.771207@fangorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Li Dongfeng <mavip5@inet.polyu.edu.hk> writes:
>> Suppose we have a data file containing:
>> 
>> "Smith, John", 120, 90
>> "Thomson, Peter", 110, 85
>> 
>> there are 3 variables in it. If we use 
>> 
>> x <- read.table("tmp.txt", sep=",")
>> 
>> to read the data to a data.frame,
>> the result will be 4 columns.
>> Splus 4.0 have no problem with this kind
>> of data.

> Splus 3.4 has:

>> read.table("data", sep=",")
>                V2  V3 V4 
>   "Smith   John\" 120 90
> "Thomson  Peter\" 110 85

> i.e. 3 variables but with row.names '"Smith' and '"Thomson'

> Or, closer to what R does:

>> read.table("data", sep=",",row.names=NULL)
>          V1       V2  V3 V4 
> 1   \"Smith   John\" 120 90
> 2 \"Thomson  Peter\" 110 85

> By its definition, this is what sep=',' must do, but it obviously will
> not handle all CSV files properly. Anyone want to write a read.csv()
> function or something of the sorts? It would be very useful.

So
	read.table(sep = ",")

would be different from

	read.csv()

?

PS.  Btw, a typical problem when dumping from certain commercial
spreadsheets to csv and trying to read that in using read.table() is
that the dump does not always produce trailing commas.  I use a trivial
Perl script for adding these, but maybe read.table() should be smarter
about that (new option doing if_not_enough_then_add_as_NA?)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Sep  9 16:00:19 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 09 Sep 1999 17:00:19 +0200
Subject: [R] read.table bug
In-Reply-To: Kurt Hornik's message of "Thu, 9 Sep 1999 16:35:05 +0200 (CEST)"
References: <37D7B372.CDA3589D@inet.polyu.edu.hk> 	<x2aeqwxkyj.fsf@blueberry.kubism.ku.dk> <14295.50585.281674.771207@fangorn.ci.tuwien.ac.at>
Message-ID: <x27lm0xh8c.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> So
> 	read.table(sep = ",")
> 
> would be different from
> 
> 	read.csv()

Yes. Or - there are many ways to do it - extend read.table with an
option, e.g. quote='"', which for all I care could be the default. The
point is that you may want the other behaviour (quote=NULL) in some
cases. 

(How does CSV handle embedded quotes? Wotsit.org says that it is
system dependent, but a common convention is doubling the quote, i.e.
"abc""dfg". Others might do "abc"dfg", which is likely a bug. And some
systems use ';' or '|' as the separator.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Sep  9 16:46:02 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 9 Sep 1999 08:46:02 -0700 (PDT)
Subject: Fortran character strings
In-Reply-To: <Pine.GSO.4.05.9909090916450.4120-100000@auk.stats>
Message-ID: <Pine.GSO.4.10.9909090823390.21909-100000@wompom.biostat.washington.edu>

On Thu, 9 Sep 1999, Prof Brian D Ripley wrote:

> On Thu, 9 Sep 1999, Kurt Hornik wrote:
> > PS.  A comment on ?.External:  We have
> > 
> >          list          void * (SEXP *)
> >          other         void * (SEXP)
> > 
> > I think this (showing the alternative in parenteses) may be confusing.
> > Shouldn't we show the preferred method in the table and mention the
> > alternative somewhere in the text following?
> 
> It is confusing. Actually all of them are mapped to void *, so I think we
> should be giving SEXP * and SEXP. Thomas?


The reason for having void * listed is that you can then declare the
arguments without including the Rinternals header, but that could
just be explained in the text. Done.

	-thomas



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From oka@debian.or.jp  Fri Sep 10 07:53:40 1999
From: oka@debian.or.jp (oka@debian.or.jp)
Date: Fri, 10 Sep 1999 08:53:40 +0200 (MET DST)
Subject: problem in R.sh.in script (PR#272)
Message-ID: <199909100653.IAA02811@pubhealth.ku.dk>


I found problem in R-0.65.0/src/scripts/R.sh.in script.
When I run R program with `R -d gdb', R script say,

  /usr/local/bin/R[104]: shift: bad number

I fixed this problem by applying following patch to the script:

*** R.sh.in.orig    Fri Sep 10 13:01:10 1999
--- R.sh.in Fri Sep 10 13:01:23 1999
***************
*** 48,54 ****
      -g|--gnome)
        R_BINARY="R.gnome" ;;
      -d|--debugger)
!       DBG="${2}"; shift 2 ;;
      --no-environ)
        USE_R_ENVIRON=false ;;
      --vanilla)
--- 48,54 ----
      -g|--gnome)
        R_BINARY="R.gnome" ;;
      -d|--debugger)
!       DBG="${2}"; shift ;;
      --no-environ)
        USE_R_ENVIRON=false ;;
      --vanilla)

--please do not edit the information below--

Version:
 platform = i586-unknown-linux
 arch = i586
 os = linux
 system = i586, linux
 status = 
 status.rev = 0
 major = 0
 minor = 65.0
 year = 1999
 month = August
 day = 27
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From oka@debian.or.jp  Fri Sep 10 08:08:45 1999
From: oka@debian.or.jp (oka@debian.or.jp)
Date: Fri, 10 Sep 1999 09:08:45 +0200 (MET DST)
Subject: problem in R.sh.in script (PR#273)
Message-ID: <199909100708.JAA02996@pubhealth.ku.dk>


At 10 Sep 1999 06:53:01 -0000,
Mitsuru Oka <oka@debian.or.jp> wrote:
> 
> 
> I found problem in R-0.65.0/src/scripts/R.sh.in script.
> When I run R program with `R -d gdb', R script say,
> 
>   /usr/local/bin/R[104]: shift: bad number
> 
> I fixed this problem by applying following patch to the script:
...
> 
> Version:
>  platform = i586-unknown-linux
>  arch = i586
>  os = linux

I'm Sorry. I made a mistake. In above environment, R script
has no problem. The problem is in following environment.
May be, /bin/sh is incompatible.

--please do not edit the information below--

Version:
 platform = mips-sgi-irix6.4
 arch = mips
 os = irix6.4
 system = mips, irix6.4
 status = 
 status.rev = 0
 major = 0
 minor = 65.0
 year = 1999
 month = August
 day = 27
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Sep 10 08:45:20 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 10 Sep 1999 09:45:20 +0200
Subject: problem in R.sh.in script (PR#273)
In-Reply-To: oka@debian.or.jp's message of "Fri, 10 Sep 1999 09:08:45 +0200 (MET DST)"
References: <199909100708.JAA02996@pubhealth.ku.dk>
Message-ID: <x2vh9jnran.fsf@blueberry.kubism.ku.dk>

oka@debian.or.jp writes:

> I'm Sorry. I made a mistake. In above environment, R script
> has no problem. The problem is in following environment.
> May be, /bin/sh is incompatible.

It *does* have a problem on Linux too, it just doesn't protest quite
as badly:

$ R -d gdb
shift: shift count must be <= $#
GNU gdb 4.17.0.11 with Linux support

I fixed this for 0.65.1 a couple of days ago.

PS to everyone: When you follow up on a Problem Report, please make
sure that you include the original PR# in the subject field so that yo
don't open a new PR#. This is easily done by 'reply' in most mailers.
And please also avoid sending reports both to r-bugs and the
mailinglists (where they will appear with no PR# and subsequent
discussion will not get filed.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Mon Sep 13 02:02:22 1999
From: albrecht.gebhardt@uni-klu.ac.at (albrecht.gebhardt@uni-klu.ac.at)
Date: Mon, 13 Sep 1999 03:02:22 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909130102.DAA16878@pubhealth.ku.dk>

Full_Name: Albrecht Gebhardt
Version: 0.65.0
OS: Digital Unix 4.0E
Submission from: (NULL) (212.17.104.62)


Plottimg on the Alpha stopped working with 0.65.0.

The tickmarks have a length of -Inf and go across the whole 
plot.

A first solution is the following patch:

--- src/main/plot.c.alpha-patch Mon Sep 13 01:37:11 1999
+++ src/main/plot.c     Mon Sep 13 01:58:16 1999
@@ -832,7 +832,7 @@
        }
        dd->gp.col = fg;
        GLine(REAL(at)[0], y, REAL(at)[n - 1], y, USER, dd);
-       if (R_FINITE(dd->gp.tck)) {
+       if (R_FINITE(dd->gp.tck) && !(ISNAN(dd->gp.tck))) {
            /* The S way of doing ticks */
            double y0, y1;
            if (dd->gp.tck > 0.5) {
@@ -922,7 +922,7 @@
        }
        dd->gp.col = fg;
        GLine(x, REAL(at)[0], x, REAL(at)[n - 1], USER, dd);
-       if (R_FINITE(dd->gp.tck)) {
+       if (R_FINITE(dd->gp.tck) && !(ISNAN(dd->gp.tck))) {
            /* The S way of doing ticks */
            double x0, x1;
            if (dd->gp.tck > 0.5) {


Albrecht Gebhardt


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Sep 13 07:34:45 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon, 13 Sep 1999 08:34:45 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909130634.IAA17647@pubhealth.ku.dk>

On Mon, 13 Sep 1999 albrecht.gebhardt@uni-klu.ac.at wrote:

> Full_Name: Albrecht Gebhardt
> Version: 0.65.0
> OS: Digital Unix 4.0E
> Submission from: (NULL) (212.17.104.62)
> 
> 
> Plottimg on the Alpha stopped working with 0.65.0.
> 
> The tickmarks have a length of -Inf and go across the whole 
> plot.

I've seen the problem on Solaris when make decided to re-configure
and so parts of R got compiled with different compiler options (as under
re-configuration different environmental variables were set). But for me
the problem seems to be getting NaN.

> A first solution is the following patch:
> 
> --- src/main/plot.c.alpha-patch Mon Sep 13 01:37:11 1999
> +++ src/main/plot.c     Mon Sep 13 01:58:16 1999
> @@ -832,7 +832,7 @@
>         }
>         dd->gp.col = fg;
>         GLine(REAL(at)[0], y, REAL(at)[n - 1], y, USER, dd);
> -       if (R_FINITE(dd->gp.tck)) {
> +       if (R_FINITE(dd->gp.tck) && !(ISNAN(dd->gp.tck))) {
>             /* The S way of doing ticks */
>             double y0, y1;
>             if (dd->gp.tck > 0.5) {

....

I'm puzzled.  Are you saying -Inf passes R_FINITE and passes ISNAN? (Wow!,
if so,) In any case, let us try and fix the macros (which crop up in many
places) not two instances.

There are too many options in Arith.h to guess: can you please tell us
what path is being taken (HAVE_FINITE, IEEE_754, FINITE_BROKEN, ...).

I believe this can all be tested from interpreted R code. I believe you
should get  (is.na(c(2.0, Inf, -Inf, NaN, NA)) etc)
           2.0 Inf -Inf NaN NA
is.na       F   F    F   T   T
is.finite   T   F    F   F   F
is.infinite F   T    T   F   F
is.nan      F   F    F   T   F

(Martin: I can't see this is checked in the tests explicitly. Should we add
it?)  Note though that is.na tests ISNAN and is.nan tests R_IsNaN, but
is.finite does test R_FINITE.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Mon Sep 13 09:57:22 1999
From: albrecht.gebhardt@uni-klu.ac.at (albrecht.gebhardt@uni-klu.ac.at)
Date: Mon, 13 Sep 1999 10:57:22 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909130857.KAA20105@pubhealth.ku.dk>

On Mon, 13 Sep 1999, Prof Brian D Ripley wrote:

> On Mon, 13 Sep 1999 albrecht.gebhardt@uni-klu.ac.at wrote:
> 
> > Full_Name: Albrecht Gebhardt
> > Version: 0.65.0
> > OS: Digital Unix 4.0E
> > Submission from: (NULL) (212.17.104.62)
> > 
> > 
> > Plottimg on the Alpha stopped working with 0.65.0.
> > 
> > The tickmarks have a length of -Inf and go across the whole 
> > plot.
> 
> I've seen the problem on Solaris when make decided to re-configure
> and so parts of R got compiled with different compiler options (as under
> re-configuration different environmental variables were set). But for me
> the problem seems to be getting NaN.

Yes it was NaN and not -Inf! Sorry

> 
> > A first solution is the following patch:
> > 
> > --- src/main/plot.c.alpha-patch Mon Sep 13 01:37:11 1999
> > +++ src/main/plot.c     Mon Sep 13 01:58:16 1999
> > @@ -832,7 +832,7 @@
> >         }
> >         dd->gp.col = fg;
> >         GLine(REAL(at)[0], y, REAL(at)[n - 1], y, USER, dd);
> > -       if (R_FINITE(dd->gp.tck)) {
> > +       if (R_FINITE(dd->gp.tck) && !(ISNAN(dd->gp.tck))) {
> >             /* The S way of doing ticks */
> >             double y0, y1;
> >             if (dd->gp.tck > 0.5) {
> 
> ....
> 
> I'm puzzled.  Are you saying -Inf passes R_FINITE and passes ISNAN? (Wow!,
> if so,) In any case, let us try and fix the macros (which crop up in many
> places) not two instances.

NaN passed R_FINITE (see above). Then it gets multiplied by some values
and serves as tickmark length.

> 
> There are too many options in Arith.h to guess: can you please tell us
> what path is being taken (HAVE_FINITE, IEEE_754, FINITE_BROKEN, ...).
in src/include/Rconfig.h:
/* Floating Point Arithmetic */
/* #undef HAVE_MATHERR */               /* System V */
#define HAVE_ISNAN 1            /* IEEE Arith indicator */
#define HAVE_FINITE 1                                                           
                                                                                
/* #undef HAVE_FLOATINGPOINT_H */                                               
/* #undef HAVE_FPU_CONTROL_H */                                                 
/* #undef HAVE_IEEEFP_H */              /* "-Wall" */                           
/* #undef HAVE_IEEE754_H */             /* Linux */                             
                                                                                
#ifdef HAVE_ISNAN                                                               
#ifdef HAVE_FINITE                                                              
#define IEEE_754                                                                
#endif                                                                          
#endif                                                                        

and some lines below:
/* Bug Workarounds */
/* #undef HAVE_OSF_SPRINTF_BUG */
#define CALLOC_BROKEN 1
#define FINITE_BROKEN 1                                                         
#define LOG_BROKEN 1                                                            


> 
> I believe this can all be tested from interpreted R code. I believe you
> should get  (is.na(c(2.0, Inf, -Inf, NaN, NA)) etc)
>            2.0 Inf -Inf NaN NA
> is.na       F   F    F   T   T
> is.finite   T   F    F   F   F
> is.infinite F   T    T   F   F
> is.nan      F   F    F   T   F


> is.na(c(2.0, Inf, -Inf, NaN, NA))                                             
[1] FALSE FALSE FALSE  TRUE  TRUE                                               
> is.finite(c(2.0, Inf, -Inf, NaN, NA))                                         
[1] TRUE TRUE TRUE TRUE TRUE                                                    
> is.infinite(c(2.0, Inf, -Inf, NaN, NA))                                       
[1] FALSE FALSE FALSE FALSE FALSE                                               
> is.nan(c(2.0, Inf, -Inf, NaN, NA))                                            
[1] FALSE FALSE FALSE  TRUE FALSE          

Seems that everything is R_FINITE!

> (Martin: I can't see this is checked in the tests explicitly. Should we add
> it?)  Note though that is.na tests ISNAN and is.nan tests R_IsNaN, but
> is.finite does test R_FINITE.
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 

-------------------------------------------------------------------------------
Albrecht Gebhardt                   email   : albrecht.gebhardt@uni-klu.ac.at
Institut fuer Mathematik            Tel.    : (++43 463) 2700/837
Universitaet Klagenfurt             Fax     : (++43 463) 2700/834
Villacher Str. 161
A-9020 Klagenfurt, Austria
-------------------------------------------------------------------------------



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Sep 13 16:41:07 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon, 13 Sep 1999 17:41:07 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909131541.RAA27086@pubhealth.ku.dk>


> Date: Mon, 13 Sep 1999 10:57:23 +0200 (MET DST)
> From: Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at>
> 
> On Mon, 13 Sep 1999, Prof Brian D Ripley wrote:

[...]

> > I'm puzzled.  Are you saying -Inf passes R_FINITE and passes ISNAN? (Wow!,
> > if so.) In any case, let us try and fix the macros (which crop up in many
> > places) not two instances.
> 
> NaN passed R_FINITE (see above). Then it gets multiplied by some values
> and serves as tickmark length.
> 
> > 
> > There are too many options in Arith.h to guess: can you please tell us
> > what path is being taken (HAVE_FINITE, IEEE_754, FINITE_BROKEN, ...).

> in src/include/Rconfig.h:
> /* Floating Point Arithmetic */
> /* #undef HAVE_MATHERR */               /* System V */
> #define HAVE_ISNAN 1            /* IEEE Arith indicator */
> #define HAVE_FINITE 1                                                           
>                                                                                 
> /* #undef HAVE_FLOATINGPOINT_H */                                               
> /* #undef HAVE_FPU_CONTROL_H */                                                 
> /* #undef HAVE_IEEEFP_H */              /* "-Wall" */                           
> /* #undef HAVE_IEEE754_H */             /* Linux */                             
>                                                                                 
> #ifdef HAVE_ISNAN                                                               
> #ifdef HAVE_FINITE                                                              
> #define IEEE_754                                                                
> #endif                                                                          
> #endif                                                                        
> 
> and some lines below:
> /* Bug Workarounds */
> /* #undef HAVE_OSF_SPRINTF_BUG */
> #define CALLOC_BROKEN 1
> #define FINITE_BROKEN 1                                                         
> #define LOG_BROKEN 1                                                            
> 
> 
> > 
> > I believe this can all be tested from interpreted R code. I believe you
> > should get  (is.na(c(2.0, Inf, -Inf, NaN, NA)) etc)
> >            2.0 Inf -Inf NaN NA
> > is.na       F   F    F   T   T
> > is.finite   T   F    F   F   F
> > is.infinite F   T    T   F   F
> > is.nan      F   F    F   T   F
> 
> 
> > is.na(c(2.0, Inf, -Inf, NaN, NA))                                             
> [1] FALSE FALSE FALSE  TRUE  TRUE                                               
> > is.finite(c(2.0, Inf, -Inf, NaN, NA))                                         
> [1] TRUE TRUE TRUE TRUE TRUE                                                    
> > is.infinite(c(2.0, Inf, -Inf, NaN, NA))                                       
> [1] FALSE FALSE FALSE FALSE FALSE                                               
> > is.nan(c(2.0, Inf, -Inf, NaN, NA))                                            
> [1] FALSE FALSE FALSE  TRUE FALSE          
> 
> Seems that everything is R_FINITE!

[...]

OK, so I think you are at the line

#   define R_FINITE(x)          ((x) != R_NaReal)

in Arith.h, and that is clearly inadequate (although it should have
caught the NA, I think). Can you please try replacing that line by

    static int R_FINITE(double x) {
        return !isnan(x) & (x != R_PosInf) & (x != R_NegInf); 
    }

and try those tests again.

(Kurt: looks like finite can be broken in more ways than one. I suggest
return(finite(1./0.) & finite(0./0.) & finite(-1./0.)) in aclocal.m4,
and if FINITE_BROKEN going directly to some function like the above, and not
trying to be efficient, just right!)


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Mon Sep 13 17:08:40 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon, 13 Sep 1999 18:08:40 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909131608.SAA27354@pubhealth.ku.dk>

>>>>> On Mon, 13 Sep 1999 17:41:07 +0200 (MET DST), ripley@stats.ox.ac.uk (Brian D. Ripley) said:

    >> Date: Mon, 13 Sep 1999 10:57:23 +0200 (MET DST)
    >> From: Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at>
    >>
    >> On Mon, 13 Sep 1999, Prof Brian D Ripley wrote:

    BDR> [...]

    BDR> I'm puzzled.  Are you saying -Inf passes R_FINITE and passes
    BDR> ISNAN? (Wow!, if so.) In any case, let us try and fix the macros
    BDR> (which crop up in many places) not two instances.
    BDR>
    >> NaN passed R_FINITE (see above). Then it gets multiplied by some
    >> values and serves as tickmark length.
    >>
    >> >
    >> > There are too many options in Arith.h to guess: can you please tell us
    >> > what path is being taken (HAVE_FINITE, IEEE_754, FINITE_BROKEN, ...).

    >> in src/include/Rconfig.h:
    >> /* Floating Point Arithmetic */
    >> /* #undef HAVE_MATHERR */               /* System V */
    >> #define HAVE_ISNAN 1            /* IEEE Arith indicator */
    >> #define HAVE_FINITE 1
    >>
    >> /* #undef HAVE_FLOATINGPOINT_H */
    >> /* #undef HAVE_FPU_CONTROL_H */
    >> /* #undef HAVE_IEEEFP_H */              /* "-Wall" */
    >> /* #undef HAVE_IEEE754_H */             /* Linux */
    >>
    >> #ifdef HAVE_ISNAN
    >> #ifdef HAVE_FINITE
    >> #define IEEE_754
    >> #endif
    >> #endif
    >>
    >> and some lines below:
    >> /* Bug Workarounds */
    >> /* #undef HAVE_OSF_SPRINTF_BUG */
    >> #define CALLOC_BROKEN 1
    >> #define FINITE_BROKEN 1
    >> #define LOG_BROKEN 1
    >>
    >>
    >> >
    >> > I believe this can all be tested from interpreted R code. I believe you
    >> > should get  (is.na(c(2.0, Inf, -Inf, NaN, NA)) etc)
    >> >            2.0 Inf -Inf NaN NA
    >> > is.na       F   F    F   T   T
    >> > is.finite   T   F    F   F   F
    >> > is.infinite F   T    T   F   F
    >> > is.nan      F   F    F   T   F
    >>
    >>
    >> > is.na(c(2.0, Inf, -Inf, NaN, NA))
    >> [1] FALSE FALSE FALSE  TRUE  TRUE
    >> > is.finite(c(2.0, Inf, -Inf, NaN, NA))
    >> [1] TRUE TRUE TRUE TRUE TRUE
    >> > is.infinite(c(2.0, Inf, -Inf, NaN, NA))
    >> [1] FALSE FALSE FALSE FALSE FALSE
    >> > is.nan(c(2.0, Inf, -Inf, NaN, NA))
    >> [1] FALSE FALSE FALSE  TRUE FALSE
    >>
    >> Seems that everything is R_FINITE!

    BDR> [...]

    BDR> OK, so I think you are at the line

    BDR> #   define R_FINITE(x)          ((x) != R_NaReal)

    BDR> in Arith.h, and that is clearly inadequate (although it should have
    BDR> caught the NA, I think). Can you please try replacing that line by

    BDR> static int R_FINITE(double x) {
    BDR> return !isnan(x) & (x != R_PosInf) & (x != R_NegInf);
    BDR> }

    BDR> and try those tests again.

    BDR> (Kurt: looks like finite can be broken in more ways than one. I suggest
    BDR> return(finite(1./0.) & finite(0./0.) & finite(-1./0.)) in aclocal.m4,

shouldn't this be "|" instead of "&"   [broken if either is finite] ?

    BDR> and if FINITE_BROKEN going directly to some function like the
    BDR> above, and not trying to be efficient, just right!)
{weak voice in the background:
 it may be worth tyring to be both right and efficient ..
 but I agree that "right" is much more important!
}

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Sep 13 18:08:06 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon, 13 Sep 1999 19:08:06 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909131708.TAA27650@pubhealth.ku.dk>

On Mon, 13 Sep 1999, Martin Maechler wrote:

> >>>>> On Mon, 13 Sep 1999 17:41:07 +0200 (MET DST), ripley@stats.ox.ac.uk (Brian D. Ripley) said:
> 
>     >> Date: Mon, 13 Sep 1999 10:57:23 +0200 (MET DST)
>     >> From: Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at>
>     >>
>     >> On Mon, 13 Sep 1999, Prof Brian D Ripley wrote:
> 
>     BDR> [...]
> 
>     BDR> I'm puzzled.  Are you saying -Inf passes R_FINITE and passes
>     BDR> ISNAN? (Wow!, if so.) In any case, let us try and fix the macros
>     BDR> (which crop up in many places) not two instances.
>     BDR>
>     >> NaN passed R_FINITE (see above). Then it gets multiplied by some
>     >> values and serves as tickmark length.
>     >>
>     >> >
>     >> > There are too many options in Arith.h to guess: can you please tell us
>     >> > what path is being taken (HAVE_FINITE, IEEE_754, FINITE_BROKEN, ...).
> 
>     >> in src/include/Rconfig.h:
>     >> /* Floating Point Arithmetic */
>     >> /* #undef HAVE_MATHERR */               /* System V */
>     >> #define HAVE_ISNAN 1            /* IEEE Arith indicator */
>     >> #define HAVE_FINITE 1
>     >>
>     >> /* #undef HAVE_FLOATINGPOINT_H */
>     >> /* #undef HAVE_FPU_CONTROL_H */
>     >> /* #undef HAVE_IEEEFP_H */              /* "-Wall" */
>     >> /* #undef HAVE_IEEE754_H */             /* Linux */
>     >>
>     >> #ifdef HAVE_ISNAN
>     >> #ifdef HAVE_FINITE
>     >> #define IEEE_754
>     >> #endif
>     >> #endif
>     >>
>     >> and some lines below:
>     >> /* Bug Workarounds */
>     >> /* #undef HAVE_OSF_SPRINTF_BUG */
>     >> #define CALLOC_BROKEN 1
>     >> #define FINITE_BROKEN 1
>     >> #define LOG_BROKEN 1
>     >>
>     >>
>     >> >
>     >> > I believe this can all be tested from interpreted R code. I believe you
>     >> > should get  (is.na(c(2.0, Inf, -Inf, NaN, NA)) etc)
>     >> >            2.0 Inf -Inf NaN NA
>     >> > is.na       F   F    F   T   T
>     >> > is.finite   T   F    F   F   F
>     >> > is.infinite F   T    T   F   F
>     >> > is.nan      F   F    F   T   F
>     >>
>     >>
>     >> > is.na(c(2.0, Inf, -Inf, NaN, NA))
>     >> [1] FALSE FALSE FALSE  TRUE  TRUE
>     >> > is.finite(c(2.0, Inf, -Inf, NaN, NA))
>     >> [1] TRUE TRUE TRUE TRUE TRUE
>     >> > is.infinite(c(2.0, Inf, -Inf, NaN, NA))
>     >> [1] FALSE FALSE FALSE FALSE FALSE
>     >> > is.nan(c(2.0, Inf, -Inf, NaN, NA))
>     >> [1] FALSE FALSE FALSE  TRUE FALSE
>     >>
>     >> Seems that everything is R_FINITE!
> 
>     BDR> [...]
> 
>     BDR> OK, so I think you are at the line
> 
>     BDR> #   define R_FINITE(x)          ((x) != R_NaReal)
> 
>     BDR> in Arith.h, and that is clearly inadequate (although it should have
>     BDR> caught the NA, I think). Can you please try replacing that line by
> 
>     BDR> static int R_FINITE(double x) {
>     BDR> return !isnan(x) & (x != R_PosInf) & (x != R_NegInf);
>     BDR> }
> 
>     BDR> and try those tests again.
> 
>     BDR> (Kurt: looks like finite can be broken in more ways than one. I suggest
>     BDR> return(finite(1./0.) & finite(0./0.) & finite(-1./0.)) in aclocal.m4,
> 
> shouldn't this be "|" instead of "&"   [broken if either is finite] ?

Um. Yes, I think so: the man page is almost impossible to decipher, and
I had read it reversed.

> {weak voice in the background:
>  it may be worth tyring to be both right and efficient ..
>  but I agree that "right" is much more important!

Not, I think, on platforms where the inbuilt ways are broken.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Sep 14 10:12:11 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 14 Sep 1999 11:12:11 +0200
Subject: cin et al
In-Reply-To: <199909140850.KAA14277@fangorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 14 Sep 1999 10:50:50 +0200)
References: <199909140850.KAA14277@fangorn.ci.tuwien.ac.at>
Message-ID: <199909140912.LAA09141@sophie.ethz.ch>

In a more private mail,
>>>>> "KH" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    KH> Currently,
    KH>		opar <- par()
    KH>		par(opar)
    KH> gives

    KH> Warning messages: 
    KH> 1: parameter "cin" can't be set in: par(args) 
    KH> 2: parameter "cra" can't be set in: par(args) 
    KH> 3: parameter "csi" can't be set in: par(args) 
    KH> 4: parameter "din" can't be set in: par(args) 

That's why we have

      opar <- par(no.readonly = TRUE)
      par(opar)

Only last weekend, when trying to polish "p.sunflowers(),
I read a (latex) printout of ?par

and found several things that I want to add/improve.
The above example is one of them.

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Sep 14 15:18:08 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue, 14 Sep 1999 16:18:08 +0200 (MET DST)
Subject: R with a broken finite() (was [R] Problems with R-0.65.0) (PR#275)
Message-ID: <199909141418.QAA06974@pubhealth.ku.dk>

[Copied to R-bugs so it goes into the database.]

On Mon, 13 Sep 1999, Ralf Herbrich wrote:

> 
> Hello,
> 
> I installed the new release 0.65.0 of R on our local Solaris system. As I
> already (and sucessfully) installed the 0.64.0 and 0.64.1 version of R, I
> hadn't had any trouble during the installation. But as I've started R in
> order to see the demo I've got horizontal and vertical lines goint to the
> left and top of the X11 window at each tick (demo ("graphics")). This
> seems not to be a grid but is now standard in any 2D plot (I also tried
> several of my own R programs). Furthermore, the exported postscripts
> (dev.print (file="blabla.ps")) can't be displayed by ghostscript.
> 
> What did I wrong during the installation?

To follow up on this, Ralf was using Solaris 2.6 and 

gcc version egcs-2.91.63 19990224 (egcs-1.1.2 pre-release-3)

which is probably not a good idea, being an old pre-release (gcc 2.8.1,
real egcs-1.1.2 and gcc-2.95.1 have all been tried).  This reported that
calloc and finite are broken on Solaris 2.6, and they are not on other
systems, so it seems more likely that the compiler is broken.

If you find a system with HAVE_FINITE and FINITE_BROKEN defined, then R
will not work correctly (unless it uses the AIX workaround). The fix I
suggested to Ralf worked, and will probably be incorporated in 0.65.1
(unless we find a better one).

Try replacing the line

#   define R_FINITE(x)          ((x) != R_NaReal)

in Arith.h by

static int R_FINITE(double x) {
    return !isnan(x) & (x != R_PosInf) & (x != R_NegInf); }


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Tue Sep 14 17:02:10 1999
From: albrecht.gebhardt@uni-klu.ac.at (Albrecht Gebhardt)
Date: Tue, 14 Sep 1999 18:02:10 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
In-Reply-To: <199909131541.RAA27086@pubhealth.ku.dk>
Message-ID: <Pine.OSF.4.10.9909141736540.2679-100000@zidsrv.sci.uni-klu.ac.at>

On Mon, 13 Sep 1999 ripley@stats.ox.ac.uk wrote:

> 
> > Date: Mon, 13 Sep 1999 10:57:23 +0200 (MET DST)
> > From: Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at>
> > 
> > On Mon, 13 Sep 1999, Prof Brian D Ripley wrote:
> 
> [...]
> ....
> [...]
> 
> OK, so I think you are at the line
> 
> #   define R_FINITE(x)          ((x) != R_NaReal)
> 
> in Arith.h, and that is clearly inadequate (although it should have
> caught the NA, I think). Can you please try replacing that line by
> 
>     static int R_FINITE(double x) {
>         return !isnan(x) & (x != R_PosInf) & (x != R_NegInf); 
>     }
> 
> and try those tests again.
ok, this works. Now I get even further with "make test". This stopped 
somewhere with a "GPretty[Inf, ...]" error, which was obvoiusly also
caused be R_FINITE. 

The patch is now:
--- ./src/include/Arith.h.finite-patch  Tue Sep 14 16:31:16 1999
+++ ./src/include/Arith.h       Tue Sep 14 16:32:12 1999
@@ -81,7 +81,13 @@
         return FINITE(x);      /* NOTE: macro does not work.  */
     }
 #  else
-#   define R_FINITE(x)         ((x) != R_NaReal)
+#   ifdef __osf__
+    static int R_FINITE(double x) {
+        return !isnan(x) & (x != R_PosInf) & (x != R_NegInf); 
+    }
+#   else
+#    define R_FINITE(x)                ((x) != R_NaReal)
+#   endif
 #  endif
 # endif

Albrecht

PS:
"make test" still fails, the last lines of tests/Examples/base-Ex.Rout
are
#### snip ################
> chisq.test(InsectSprays$count > 7, InsectSprays$spray)$obs
       y
x        A  B  C  D  E  F
  FALSE  1  1 12 11 12  0
  TRUE  11 11  0  1  0 12
>                                 # Counts expected under the null
>
> ## Effect of simulating p-values
> x <- matrix(c(12, 5, 7, 7), nc = 2)
> chisq.test(x)$p.value           # 0.4233
[1] 0.4233054
###################### snip
I can't see an error here. Or could the error be hidden somewhere before
this point? base-Ex.Rout is quite large, 4154 lines.
.... stop, now I got it, its a memory problem:
Running all help() examples ...
../../bin/R --vanilla < base-Ex.R > base-Ex.Rout
/bin/sh: 303 Memory fault
make[3]: *** [base-Ex.Rout] Error 139
make[3]: Leaving directory
`/usr/local/src/redhat/BUILD/R-0.65.0/tests/Examples'
make[2]: *** [test-Examples] Error 2
make[2]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
make[1]: *** [test-All] Error 2
make[1]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
make: *** [test-All] Error 2
I have to go to another machine, my alpha at home as only 256MB, and swap
space is also very small.
Or should I run the tests with memory specifications from command line? 

Wouldn't it be a good idea to have "make test" running each example in a
several R process? I think I could avoid this memory fault this way. I
guess the reasons for the memory fault is a bad kernel configuration
(wrong ulimit values) and/or wrong swap space configuration and not within
R.
But on the other hand the error is reproduceable with R stopping at
exactly the same line.  

-------------------------------------------------------------------------------
Albrecht Gebhardt                   email   : albrecht.gebhardt@uni-klu.ac.at
Institut fuer Mathematik            Tel.    : (++43 463) 2700/837
Universitaet Klagenfurt             Fax     : (++43 463) 2700/834
Villacher Str. 161
A-9020 Klagenfurt, Austria
-------------------------------------------------------------------------------


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Sep 14 17:23:16 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 14 Sep 1999 18:23:16 +0200
Subject: axis() produces junk on DEC alpha (PR#274)
In-Reply-To: Albrecht Gebhardt's message of "Tue, 14 Sep 1999 18:02:10 +0200 (MET DST)"
References: <Pine.OSF.4.10.9909141736540.2679-100000@zidsrv.sci.uni-klu.ac.at>
Message-ID: <x27lltbgy3.fsf@blueberry.kubism.ku.dk>

Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at> writes:

> this point? base-Ex.Rout is quite large, 4154 lines.
> .... stop, now I got it, its a memory problem:
> Running all help() examples ...
> ../../bin/R --vanilla < base-Ex.R > base-Ex.Rout
> /bin/sh: 303 Memory fault
> make[3]: *** [base-Ex.Rout] Error 139
> make[3]: Leaving directory
> `/usr/local/src/redhat/BUILD/R-0.65.0/tests/Examples'
> make[2]: *** [test-Examples] Error 2
> make[2]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
> make[1]: *** [test-All] Error 2
> make[1]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
> make: *** [test-All] Error 2
> I have to go to another machine, my alpha at home as only 256MB, and swap
> space is also very small.
> Or should I run the tests with memory specifications from command line? 

Shouldn't be necessary with the current defaults 256MB should be
plenty. 

Sometimes output buffers don't flush, so what is the last line of

 ../../bin/R --vanilla < base-Ex.R

> Wouldn't it be a good idea to have "make test" running each example in a
> several R process? I think I could avoid this memory fault this way. I
> guess the reasons for the memory fault is a bad kernel configuration
> (wrong ulimit values) and/or wrong swap space configuration and not within
> R.

But would it complete in finite time? There are a *lot* of examples,
you know....



-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Tue Sep 14 20:24:15 1999
From: albrecht.gebhardt@uni-klu.ac.at (Albrecht Gebhardt)
Date: Tue, 14 Sep 1999 20:24:15 +0100 (GMT+0100)
Subject: chisqsim broken on alpha (was Re: axis() produces junk on DEC alpha
 (PR#274))
In-Reply-To: <x27lltbgy3.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.OSF.4.05.9909142017460.13670-100000@delta.fuzzy.at>

On 14 Sep 1999, Peter Dalgaard BSA wrote:

> Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at> writes:
> 
> > this point? base-Ex.Rout is quite large, 4154 lines.
> > .... stop, now I got it, its a memory problem:
> > Running all help() examples ...
> > ../../bin/R --vanilla < base-Ex.R > base-Ex.Rout
> > /bin/sh: 303 Memory fault
> > make[3]: *** [base-Ex.Rout] Error 139
> > make[3]: Leaving directory
> > `/usr/local/src/redhat/BUILD/R-0.65.0/tests/Examples'
> > make[2]: *** [test-Examples] Error 2
> > make[2]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
> > make[1]: *** [test-All] Error 2
> > make[1]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
> > make: *** [test-All] Error 2
> > I have to go to another machine, my alpha at home as only 256MB, and swap
> > space is also very small.
> > Or should I run the tests with memory specifications from command line? 
> 
> Shouldn't be necessary with the current defaults 256MB should be
> plenty. 
> 
> Sometimes output buffers don't flush, so what is the last line of
> 
>  ../../bin/R --vanilla < base-Ex.R
> 

You were right, I found a next bug for R on alpha:

chisqsim (called from chisq.test() crashes. First I found that the crash
is at 
chisqsim.c:167
167             fact[i] = x;

but after placing a breakpoint here I could go some lines further and
reach
chisqsim.c:72
72                  x = exp(fact[iap - 1] + fact[ib] + fact[ic] +

The following is a log of my gdb-session: 

root@delta[Examples]# ../../bin/R --vanilla < base-Ex.R   
...
> x <- matrix(c(12, 5, 7, 7), nc = 2)
> chisq.test(x)$p.value           # 0.4233
[1] 0.4233054
> chisq.test(x, simulate.p.value = TRUE, B = 10000)$p.value
Segmentation fault (core dumped)
root@delta[Examples]# gdb -c core ../../bin/R.X11 -d ../../src/nmath/ -d ../../src/main/ -d ../../src/appl/
GNU gdb 4.17
Copyright 1998 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "alphaev56-dec-osf4.0d"...
Core was generated by `R.X11'.
Program terminated with signal 11, Segmentation fault.
Reading symbols from /usr/shlib/libSM.so...done.
Reading symbols from /usr/shlib/libICE.so...done.
Reading symbols from /usr/shlib/libX11.so...done.
Reading symbols from /usr/shlib/libdnet_stub.so...done.
Reading symbols from /usr/shlib/libUfor.so...done.
Reading symbols from /usr/shlib/libfor.so...done.
Reading symbols from /usr/shlib/libFutil.so...done.
Reading symbols from /usr/shlib/libm.so...done.
Reading symbols from /usr/shlib/libots.so...done.
Reading symbols from /usr/local/lib/libreadline.so.3...done.
Reading symbols from /usr/local/lib/libncurses.so.4...done.
Reading symbols from /usr/shlib/libc.so...done.
Reading symbols from /usr/local/src/redhat/BUILD/R-0.65.0/library/eda/libs/eda.s
o...done.
---Type <return> to continue, or q <return> to quit---
#0  0x12010a280 in chisqsim (nrow=0x140ff92d0, ncol=0x140ff92c8,
    nrowt=0x140ff92c0, ncolt=0x140ff92b8, n=0x140ff92b0, b=0x140ff92a8,
    expected=0x140ff9288, observed=0x140ff9278, fact=0x140ff9178,
    jwork=0x140ff9170, results=0x140fe58f0) at chisqsim.c:167
167             fact[i] = x;
(gdb) set env R_HOME /usr/local/src/redhat/BUILD/R-0.65.0
(gdb) break chisqsim.c:167
(gdb) run
Starting program: /usr/local/src/redhat/BUILD/R-0.65.0/tests/Examples/../../bin/R.X11

R : Copyright 1999, The R Development Core Team
Version 0.65.0  (August 27, 1999)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type    "?license" or "?licence" for distribution details.

R is a collaborative project with many contributors.
Type    "?contributors" for a list.

Type    "demo()" for some demos, "help()" for on-line help, or
        "help.start()" for a HTML browser interface to help.
Type    "q()" to quit R.

>  x <- matrix(c(12, 5, 7, 7), nc = 2)
> chisq.test(x)$p.valu
[1] 0.4233054
> chisq.test(x, simulate.p.value = TRUE, B = 10000)$p.value 

Breakpoint 1, chisqsim (nrow=0x140ff9ed8, ncol=0x140ff9ed0, nrowt=0x140ff9ec8,
    ncolt=0x140ff9ec0, n=0x140ff9eb8, b=0x140ff9eb0, expected=0x140ff9e90,
    observed=0x140ff9e80, fact=0x140ff9d80, jwork=0x140ff9d78,
    results=0x140fe64f8) at chisqsim.c:167
167             fact[i] = x;
(gdb) print x
$1 = 0
(gdb) print fact
$2 = (double *) 0x140ff9d80
(gdb) print *fact
$3 = 0
(gdb) step
165         for (i = 1; i <= *n; ++i) {
(gdb)
168         }
.....
(gdb) cont
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x120109e24 in rcont2 (nrow=0x140ff9ed8, ncol=0x140ff9ed0, nrowt=0x140ff9ec0,
    ncolt=0x140ff9eb8, ntotal=0x140ff9eb8, fact=0x140ff9d80,
    jwork=0x140ff9d70, matrix=0x140ff9e68) at chisqsim.c:72
72                  x = exp(fact[iap - 1] + fact[ib] + fact[ic] +
(gdb) print x
$7 = 0
(gdb) print iap
$8 = 51539607572
(gdb) print ib
$9 = -51539607540
(gdb) print ic
$10 = -60129542130
(gdb) list
67                  idp = id + 1;
68                  igp = idp - nlm;
69                  ihp = iap - nlm;
70                  nlmp = nlm + 1;
71                  iip = ii + nlmp;
72                  x = exp(fact[iap - 1] + fact[ib] + fact[ic] +
73                          fact[idp - 1] - fact[ie] - fact[nlmp - 1] -
74                          fact[igp - 1] - fact[ihp - 1] - fact[iip - 1]);
75                  if (x >= dummy) {
76                      goto L160;
(gdb) print nlmp
$11 = 65117246112
(gdb) print iip
$12 = -46551903589
(gdb) print igp
$13 = -4987703949
(gdb) print ihp
$14 = -13577638539
(gdb) print id
$15 = 60129542161
(gdb) print nlm
$16 = 65117246111
(gdb) q
The program is running.  Exit anyway? (y or n) y


Albrecht

......................................................................
| Albrecht Gebhardt          Tel.: (++43 463) 2700/837               |
| Institut fuer Mathematik   Fax : (++43 463) 2700/834               |
| Universitaet Klagenfurt    mailto:albrecht.gebhardt@uni-klu.ac.at  |
| Villacher Str. 161         http://www-stat.uni-klu.ac.at/~agebhard |
| A-9020 Klagenfurt, Austria                                         |
`--------------------------------------------------------------------'

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Sep 15 08:19:28 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 15 Sep 1999 09:19:28 +0200 (MET DST)
Subject: chisqsim broken on alpha (was Re: axis() produces junk on DEC (PR#276)
Message-ID: <199909150719.JAA10993@pubhealth.ku.dk>

On Tue, 14 Sep 1999, Albrecht Gebhardt wrote:

[...]

> chisqsim (called from chisq.test() crashes. First I found that the crash
> is at 
> chisqsim.c:167
> 167             fact[i] = x;

[...]

chisqsum.c has its interface in terms of long *, called by .C that supplies
int *. I think those are different on an Alpha.  Could you please
edit long to int in that file and try again.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Wed Sep 15 14:33:09 1999
From: albrecht.gebhardt@uni-klu.ac.at (albrecht.gebhardt@uni-klu.ac.at)
Date: Wed, 15 Sep 1999 15:33:09 +0200 (MET DST)
Subject: chisqsim broken on alpha - solved + next bug in fft found (PR#277)
Message-ID: <199909151333.PAA17503@pubhealth.ku.dk>

On Wed, 15 Sep 1999 ripley@stats.ox.ac.uk wrote:

> On Tue, 14 Sep 1999, Albrecht Gebhardt wrote:
> 
> [...]
> 
> > chisqsim (called from chisq.test() crashes. First I found that the crash
> > is at 
> > chisqsim.c:167
> > 167             fact[i] = x;
> 
> [...]
> 
> chisqsum.c has its interface in terms of long *, called by .C that supplies
> int *. I think those are different on an Alpha.  Could you please
> edit long to int in that file and try again.
> 
> Brian
> 

Yes this helps.
The patch is:
--- ./src/appl/chisqsim.c.chisqsim-patch        Wed Sep 15 09:17:56 1999
+++ ./src/appl/chisqsim.c       Wed Sep 15 14:30:56 1999
@@ -11,10 +11,15 @@
 #include "S.h"
 
 static void
+#ifdef __osf__
+rcont2(int *nrow, int *ncol, int *nrowt, int *ncolt, int *ntotal,
+       double *fact, int *jwork, int *matrix)
+#else
 rcont2(long *nrow, long *ncol, long *nrowt, long *ncolt, long *ntotal,
        double *fact, long *jwork, long *matrix) 
+#endif
 {
-    long nlmp, j, l, m, ia, ib, ic, jc, id, ie, ii, nrowtl, iap, idp,
+    int nlmp, j, l, m, ia, ib, ic, jc, id, ie, ii, nrowtl, iap, idp,
        igp, ihp, iip, nll, nlm, nrowm, ncolm, lsm, lsp;
     double x, y, dummy, sumprb;
 
@@ -151,12 +156,18 @@
    */
 
 void
+#ifdef __osf__
+chisqsim(int *nrow, int *ncol, int *nrowt, int *ncolt, int *n,
+        int *b, double *expected, int *observed, double *fact,
+        int *jwork, double *results)
+#else
 chisqsim(long *nrow, long *ncol, long *nrowt, long *ncolt, long *n,
         long *b, double *expected, long *observed, double *fact,
         long *jwork, double *results)
+#endif
 {
     /* Local variables */
-    long i, j, iter;
+    int i, j, iter;
     double chi, e, o, x;
 
     /* Calculate log-factorials */


And I get to the next bug:

> data(faithful)
> x <- xx <- faithful$eruptions
> x[i.out <- sample(length(x), 10)] <- NA
  I modifed this to 
  x[i.out <- c(1,10,20,50,100,200)] <- NA
> doR <- density(x, bw=0.15, na.rm = TRUE) # works
> doN <- density(x, bw=0.15, na.rm = FALSE)
segfault at approx.c: 

    for(i=0 ; i<*nxy ; i++)
	if(ISNA(x[i]) || ISNA(y[i]))
	    error("approx(): attempted to interpolate NA values\n");

Both x and y are NULL pointers. 
The error is somewhere before, comparing with R on SuSE 5.3:
somewhere in density():

debug: kords[(n + 2):(2 * n)] <- -kords[n:2]
linux and osf both get:
kords
[1]  0.00000000  0.01094819  0.02189638  0.03284457  0.04379277 ...
[1021] -0.04379277 -0.03284457 -0.02189638 -0.01094819

then in the following if-statement we go to
debug: kords <- convolve(y, kords)[1:n]
with linux result
kords
  [1] 2.523589e-13 4.199167e-13 6.950994e-13 1.144613e-12 ...
[511] 5.032797e-13 3.017881e-13
and alpha:
kords
  [1] NA NA NA NA NA NA NA NA ...
[501] NA NA NA NA NA NA NA NA NA NA NA NA
... now on the alpha x and y are set to numeric(0) and approx is called
with this arguments, bang.

Now in convolve(x,y) on entry x=y and y=kords on linux and osf are
identical.
x:
   [1] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00  ...
 [151] 4.866728e-03 6.204044e-03 3.258272e-03 3.552390e-03 4.218750e-03
[1021] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00  ...
y:
   [1]  2.659615e+00  2.652540e+00  2.631429e+00  2.596616e+00 ...
[1021]  2.548649e+00  2.596616e+00  2.631429e+00  2.652540e+00 

now the error is in line
debug: x <- fft(fft(x) * (if (conj) Conj(fft(y)) else fft(y)), inv = TRUE)
of convolve() which returns only NAs on the alpha.

... so tomorrow I will have a look into fft.c



Albrecht

-------------------------------------------------------------------------------
Albrecht Gebhardt                   email   : albrecht.gebhardt@uni-klu.ac.at
Institut fuer Mathematik            Tel.    : (++43 463) 2700/837
Universitaet Klagenfurt             Fax     : (++43 463) 2700/834
Villacher Str. 161
A-9020 Klagenfurt, Austria
-------------------------------------------------------------------------------



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Wed Sep 15 14:33:09 1999
From: albrecht.gebhardt@uni-klu.ac.at (Albrecht Gebhardt)
Date: Wed, 15 Sep 1999 15:33:09 +0200 (MET DST)
Subject: chisqsim broken on alpha - solved + next bug in fft found
In-Reply-To: <199909150719.JAA10993@pubhealth.ku.dk>
Message-ID: <Pine.OSF.4.10.9909151410340.11553-100000@zidsrv.sci.uni-klu.ac.at>

On Wed, 15 Sep 1999 ripley@stats.ox.ac.uk wrote:

> On Tue, 14 Sep 1999, Albrecht Gebhardt wrote:
> 
> [...]
> 
> > chisqsim (called from chisq.test() crashes. First I found that the crash
> > is at 
> > chisqsim.c:167
> > 167             fact[i] = x;
> 
> [...]
> 
> chisqsum.c has its interface in terms of long *, called by .C that supplies
> int *. I think those are different on an Alpha.  Could you please
> edit long to int in that file and try again.
> 
> Brian
> 

Yes this helps.
The patch is:
--- ./src/appl/chisqsim.c.chisqsim-patch        Wed Sep 15 09:17:56 1999
+++ ./src/appl/chisqsim.c       Wed Sep 15 14:30:56 1999
@@ -11,10 +11,15 @@
 #include "S.h"
 
 static void
+#ifdef __osf__
+rcont2(int *nrow, int *ncol, int *nrowt, int *ncolt, int *ntotal,
+       double *fact, int *jwork, int *matrix)
+#else
 rcont2(long *nrow, long *ncol, long *nrowt, long *ncolt, long *ntotal,
        double *fact, long *jwork, long *matrix) 
+#endif
 {
-    long nlmp, j, l, m, ia, ib, ic, jc, id, ie, ii, nrowtl, iap, idp,
+    int nlmp, j, l, m, ia, ib, ic, jc, id, ie, ii, nrowtl, iap, idp,
        igp, ihp, iip, nll, nlm, nrowm, ncolm, lsm, lsp;
     double x, y, dummy, sumprb;
 
@@ -151,12 +156,18 @@
    */
 
 void
+#ifdef __osf__
+chisqsim(int *nrow, int *ncol, int *nrowt, int *ncolt, int *n,
+        int *b, double *expected, int *observed, double *fact,
+        int *jwork, double *results)
+#else
 chisqsim(long *nrow, long *ncol, long *nrowt, long *ncolt, long *n,
         long *b, double *expected, long *observed, double *fact,
         long *jwork, double *results)
+#endif
 {
     /* Local variables */
-    long i, j, iter;
+    int i, j, iter;
     double chi, e, o, x;
 
     /* Calculate log-factorials */


And I get to the next bug:

> data(faithful)
> x <- xx <- faithful$eruptions
> x[i.out <- sample(length(x), 10)] <- NA
  I modifed this to 
  x[i.out <- c(1,10,20,50,100,200)] <- NA
> doR <- density(x, bw=0.15, na.rm = TRUE) # works
> doN <- density(x, bw=0.15, na.rm = FALSE)
segfault at approx.c: 

    for(i=0 ; i<*nxy ; i++)
	if(ISNA(x[i]) || ISNA(y[i]))
	    error("approx(): attempted to interpolate NA values\n");

Both x and y are NULL pointers. 
The error is somewhere before, comparing with R on SuSE 5.3:
somewhere in density():

debug: kords[(n + 2):(2 * n)] <- -kords[n:2]
linux and osf both get:
kords
[1]  0.00000000  0.01094819  0.02189638  0.03284457  0.04379277 ...
[1021] -0.04379277 -0.03284457 -0.02189638 -0.01094819

then in the following if-statement we go to
debug: kords <- convolve(y, kords)[1:n]
with linux result
kords
  [1] 2.523589e-13 4.199167e-13 6.950994e-13 1.144613e-12 ...
[511] 5.032797e-13 3.017881e-13
and alpha:
kords
  [1] NA NA NA NA NA NA NA NA ...
[501] NA NA NA NA NA NA NA NA NA NA NA NA
... now on the alpha x and y are set to numeric(0) and approx is called
with this arguments, bang.

Now in convolve(x,y) on entry x=y and y=kords on linux and osf are
identical.
x:
   [1] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00  ...
 [151] 4.866728e-03 6.204044e-03 3.258272e-03 3.552390e-03 4.218750e-03
[1021] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00  ...
y:
   [1]  2.659615e+00  2.652540e+00  2.631429e+00  2.596616e+00 ...
[1021]  2.548649e+00  2.596616e+00  2.631429e+00  2.652540e+00 

now the error is in line
debug: x <- fft(fft(x) * (if (conj) Conj(fft(y)) else fft(y)), inv = TRUE)
of convolve() which returns only NAs on the alpha.

... so tomorrow I will have a look into fft.c



Albrecht

-------------------------------------------------------------------------------
Albrecht Gebhardt                   email   : albrecht.gebhardt@uni-klu.ac.at
Institut fuer Mathematik            Tel.    : (++43 463) 2700/837
Universitaet Klagenfurt             Fax     : (++43 463) 2700/834
Villacher Str. 161
A-9020 Klagenfurt, Austria
-------------------------------------------------------------------------------


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Wed Sep 15 16:36:55 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed, 15 Sep 1999 17:36:55 +0200 (MET DST)
Subject: buglet in lm.influence() -- easy fix but... (PR#278)
Message-ID: <199909151536.RAA18972@pubhealth.ku.dk>

(R 0.65.0 and earlier):

       example(aov)
       lm.influence(npk.aov)
gives
	Error: NA/NaN/Inf in foreign function call (arg 6)

which comes from the  lm.obj$coefficients  
(the last 3-way interaction coefficient is indetermined and accordingly NA)
argument passed to .Fortran("lminfl",...)  inside lm.influence.

The following is a simple correct patch

--- lm.influence.R	1999/08/13 06:44:12	1.5
+++ lm.influence.R	1999/09/15 15:32:11
@@ -38,6 +38,7 @@
 	     hat = double(n),
 	     coefficients = matrix(0, nr = n, nc = k),
 	     sigma = double(n),
+             NAOK = TRUE,# lm.obj$coef can have "structural" NAs
 	     DUP = FALSE)[c("hat", "coefficients", "sigma")]
 }

However, closer inspection shows that this 6th argument 
(called `b' inside  src/appl/lminfl.f) is not used at all in the code.

Ross, can I eliminate it from the subroutine lminfl() altogether ?


Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Sep 15 16:54:00 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 15 Sep 1999 17:54:00 +0200 (MET DST)
Subject: chisqsim broken on alpha - solved + next bug in fft found (PR#277)
Message-ID: <199909151554.RAA19181@pubhealth.ku.dk>

On Wed, 15 Sep 1999 albrecht.gebhardt@uni-klu.ac.at wrote:

> On Wed, 15 Sep 1999 ripley@stats.ox.ac.uk wrote:
> 
> > On Tue, 14 Sep 1999, Albrecht Gebhardt wrote:
> > 
> > [...]
> > 
> > > chisqsim (called from chisq.test() crashes. First I found that the crash
> > > is at 
> > > chisqsim.c:167
> > > 167             fact[i] = x;
> > 
> > [...]
> > 
> > chisqsum.c has its interface in terms of long *, called by .C that supplies
> > int *. I think those are different on an Alpha.  Could you please
> > edit long to int in that file and try again.

> Yes this helps.

OK, that has gone in R-release today, for 0.65.0 (patched).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Wed Sep 15 17:43:01 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed, 15 Sep 1999 18:43:01 +0200 (MET DST)
Subject: plot ( <aov.obj> ) failed -- easy fix (PR#279)
Message-ID: <199909151643.SAA19576@pubhealth.ku.dk>

It is already commited for "tomorrow"s snapshot of R-release
(why on earth has nobody noticed ??)

--- plot.lm.R	1999/08/13 09:36:22	1.4
+++ plot.lm.R	1999/09/15 16:39:45
@@ -17,7 +17,7 @@
     hii <- lm.influence(x)$hat
     s <- sqrt(deviance(x)/df.residual(x))
     if (any(show[2:3])) {
-	ylab23 <- switch(class(x)[1], lm = "Standardized residuals",
+	ylab23 <- switch(class(x)[1], aov = , lm = "Standardized residuals",
 			 glm = "Std. dev. residuals")
 	rs <- r/sqrt(1 - hii)/s
     }

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Thu Sep 16 07:22:15 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Thu, 16 Sep 1999 08:22:15 +0200 (MET DST)
Subject: plot ( <aov.obj> ) failed -- easy fix (PR#279)
Message-ID: <199909160622.IAA22004@pubhealth.ku.dk>

>>>>> On Wed, 15 Sep 1999 18:43:01 +0200 (MET DST), maechler@stat.math.ethz.ch (Martin Maechler) said:

    MM> It is already commited for "tomorrow"s snapshot of R-release
    MM> (why on earth has nobody noticed ??)


  >> --- plot.lm.R	1999/08/13 09:36:22	1.4
  >> +++ plot.lm.R	1999/09/15 16:39:45
  >> @@ -17,7 +17,7 @@
  >>      hii <- lm.influence(x)$hat
  >>      s <- sqrt(deviance(x)/df.residual(x))
  >>      if (any(show[2:3])) {
  >> -	ylab23 <- switch(class(x)[1], lm = "Standardized residuals",
  >> +	ylab23 <- switch(class(x)[1], aov = , lm = "Standardized residuals",
  >>  			 glm = "Std. dev. residuals")
  >>  	rs <- r/sqrt(1 - hii)/s
  >>      }

but a much better patch is

--- plot.lm.R	1999/08/13 09:36:22	1.4
+++ plot.lm.R	1999/09/16 06:17:13	1.4.2.2
@@ -17,8 +17,8 @@
     hii <- lm.influence(x)$hat
     s <- sqrt(deviance(x)/df.residual(x))
     if (any(show[2:3])) {
-	ylab23 <- switch(class(x)[1], lm = "Standardized residuals",
-			 glm = "Std. dev. residuals")
+	ylab23 <- if(inherits(x, "glm"))
+	    "Std. dev. residuals" else "Standardized residuals"
 	rs <- r/sqrt(1 - hii)/s
     }
     one.fig <- prod(par("mfcol")) == 1

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ulrich.poetter@ruhr-uni-bochum.de  Thu Sep 16 21:43:35 1999
From: ulrich.poetter@ruhr-uni-bochum.de (ulrich.poetter@ruhr-uni-bochum.de)
Date: Thu, 16 Sep 1999 22:43:35 +0200 (MET DST)
Subject: install/libraries on solaris2.6 (PR#280)
Message-ID: <199909162043.WAA01534@pubhealth.ku.dk>

Full_Name: ulrich poetter
Version: 0.65.0
OS: sparc-sun-solaris 2.6
Submission from: (NULL) (134.147.95.163)


Building R-0.65.0 on sparc-sun-solaris2.6 using sun make + gcc 2.95.1+ binutils
2.8.1
and ./configure --with-g77 fails when building the eda etc. libraries. The
configure 
script produces SHLIBLDFLAGS= -G. Replacing this in config.site by 
SHLIBLDFLAGS = -shared gives no errors during make, but "make check" fails when

trying to load library "eda" with the message "Symbol rsort not found". Trying
the 
other libraries by hand results in similar errors, except for "base" and "mva",

while "make test-Specific" gives no errors. 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Sep 16 22:42:51 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 16 Sep 1999 22:42:51 +0100 (BST)
Subject: install/libraries on solaris2.6 (PR#280)
In-Reply-To: <199909162043.WAA01534@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.9909162239390.4826-100000@auk.stats>

On Thu, 16 Sep 1999 ulrich.poetter@ruhr-uni-bochum.de wrote:

> Full_Name: ulrich poetter
> Version: 0.65.0
> OS: sparc-sun-solaris 2.6
> Submission from: (NULL) (134.147.95.163)
> 
> 
> Building R-0.65.0 on sparc-sun-solaris2.6 using sun make + gcc 2.95.1+ binutils
> 2.8.1
> and ./configure --with-g77 fails when building the eda etc. libraries. The
> configure 
> script produces SHLIBLDFLAGS= -G. Replacing this in config.site by 
> SHLIBLDFLAGS = -shared gives no errors during make, but "make check" fails when
> 
> trying to load library "eda" with the message "Symbol rsort not found". Trying
> the 
> other libraries by hand results in similar errors, except for "base" and "mva",
> 
> while "make test-Specific" gives no errors. 

Fuller details, please. Exactly that configuration works for me (except I
don't know where binutils are in your path). Looks like you haven't got
linking against R.X11 correct.  Try using the sun ld if you are not already
doing so (it is recommended for Solaris).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Sep 17 14:10:49 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 17 Sep 1999 15:10:49 +0200 (MET DST)
Subject: mtext(. col = ...) stopped working in 0.65.0 (PR#281)
Message-ID: <199909171310.PAA09366@pubhealth.ku.dk>

Ouch, ouch..

  plot(1) ;mtext("Default",side=1)
  mtext("Red Herring",col="red",font=2,cex=3)
  mtext("adj = 1",adj=1,font=3,cex=2)

works alright in 0.64.2, but not anymore in 0.65.0.
This is true for x11() and postscript() at least,
but probably device independent.

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ulrich.poetter@ruhr-uni-bochum.de  Fri Sep 17 20:59:34 1999
From: ulrich.poetter@ruhr-uni-bochum.de (ulrich.poetter@ruhr-uni-bochum.de)
Date: Fri, 17 Sep 1999 21:59:34 +0200 (MET DST)
Subject: install/libraries on solaris2.6 (PR#280)
In-Reply-To: <Pine.GSO.4.05.9909162239390.4826-100000@auk.stats>
References: <199909162043.WAA01534@pubhealth.ku.dk>
 <Pine.GSO.4.05.9909162239390.4826-100000@auk.stats>
Message-ID: <14306.39861.332780.698609@abel.stat.ruhr-uni-bochum.de>

Prof Brian D Ripley writes:
 > On Thu, 16 Sep 1999 ulrich.poetter@ruhr-uni-bochum.de wrote:
 > 
 > > Full_Name: ulrich poetter
 > > Version: 0.65.0
 > > OS: sparc-sun-solaris 2.6
 > > Submission from: (NULL) (134.147.95.163)
 > > 
 > > 
 > > Building R-0.65.0 on sparc-sun-solaris2.6 using sun make + gcc 2.95.1+ binutils
 > > 2.8.1
 > > and ./configure --with-g77 fails when building the eda etc. libraries. The
 > > configure 
 > > script produces SHLIBLDFLAGS= -G. Replacing this in config.site by 
 > > SHLIBLDFLAGS = -shared gives no errors during make, but "make check" fails when
 > > trying to load library "eda" with the message "Symbol rsort not found". Trying
 > > the 
 > > other libraries by hand results in similar errors, except for "base" and "mva",
 > > 
 > > while "make test-Specific" gives no errors. 
 > 
 > Fuller details, please. Exactly that configuration works for me (except I
 > don't know where binutils are in your path). Looks like you haven't got
 > linking against R.X11 correct.  Try using the sun ld if you are not already
 > doing so (it is recommended for Solaris).

Thanks. Using the sun ld (with everything else the same) works. 

The Readme of gnu ld mentions a difference to sun ld and says it would 
emulate its behavior if given the "-E" flag. I didn't try this, but if 
this was the case, could one not try to figure it out in the configure 
script?

Thanks again,
Uli Poetter


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mcw@ln.nimh.nih.gov  Fri Sep 17 21:13:57 1999
From: mcw@ln.nimh.nih.gov (Matthew Wiener)
Date: Fri, 17 Sep 1999 16:13:57 -0400 (EDT)
Subject: "Error:  incorrect number of arguments to lambda"
Message-ID: <Pine.SGI.3.96.990917155315.909F-100000@ln.nimh.nih.gov>

Hello, all.

I have a somewhat embarrassing error, in that I cannot reliably reproduce
it.  I have sporadically experienced the error both on an SGI machine
running Irix 6.5 and on a LinuxPPC machine.  I have only seen this error
using version 0.65.0.  (I've been using versions since 0.61 or so.)

The error message is in the subject line.  Here's the traceback from the
most recent occurrence:

Error: incorrect number of arguments to "lambda"  
> traceback()  
[1] "bxp(groups, width, varwidth = varwidth, notch = notch, border =
border, " 
[2] "  col = col, log = log, pars = pars, lwd = lwd, pch = pch, "  
[3] " lty = lty, p.size = p.size, ...)"  
[4] "boxplot(split(mf[[response]], mf[[-response]]), ...)" 
[5] "boxplot.formula(c.est ~ frac.vec, col = \"blue\", notch = T)" [6]
"f.calc.var.g()" 



You'll notice that here I'm using a slightly modified version of bxp (I
wasn't able to figure out another way to change the line width of the
whiskers or the point size of outliers), but the same error occurred with
the original version.  Except then, when I reloaded my modified version,
the error vanished.  I haven't been able to make it happen again this
time.

The error has occurred in several other functions as well -- the first
time I thought I'd just misinstalled, so I did it again.  Then I didn't
see the error for a while, and became complacent.  But now it's back.


Here's what I remember from the earlier occurrences:

I had a function calling several subroutines.  I got this error, and
traceback pointed at one of the subroutines.  I inserted a few print
statements to try to follow what was going on, after which the program got
through that subroutine with no problems, and gave me the "lambda" error
in the next subroutine.  Putting print statements in the next subroutine
bumped the error to the one after that.  That's when I reinstalled.  That
took care of it for a while, but it's now resurfaced on a couple of
occasions.

The R online help has no function called lambda, nor does one come up in a
search through my environment.  I don't have any contributed packages
loaded, although I do have a collection of functions I use regularly, and
which I've used without incident until now.  Lambda sounds lispish, but I
can't figure out where to find it and look for it.

Needless to say, I will keep better notes next time this happens.  If
anyone has any ideas what it might be and how to fix it, that's great.
Otherwise, I'd like to know what sort of information I ought to collect so
that my report can be as useful as possible.

Thanks,

Matt

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Sep 17 21:40:58 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Fri, 17 Sep 1999 22:40:58 +0200 (MET DST)
Subject: install/libraries on solaris2.6 (PR#280)
Message-ID: <199909172040.WAA11161@pubhealth.ku.dk>

On Fri, 17 Sep 1999 ulrich.poetter@ruhr-uni-bochum.de wrote:

> Prof Brian D Ripley writes:
>  > On Thu, 16 Sep 1999 ulrich.poetter@ruhr-uni-bochum.de wrote:
>  > 
>  > > Full_Name: ulrich poetter
>  > > Version: 0.65.0
>  > > OS: sparc-sun-solaris 2.6
>  > > Submission from: (NULL) (134.147.95.163)
>  > > 
>  > > 
>  > > Building R-0.65.0 on sparc-sun-solaris2.6 using sun make + gcc 2.95.1+ binutils
>  > > 2.8.1
>  > > and ./configure --with-g77 fails when building the eda etc. libraries. The
>  > > configure 
>  > > script produces SHLIBLDFLAGS= -G. Replacing this in config.site by 
>  > > SHLIBLDFLAGS = -shared gives no errors during make, but "make check" fails when
>  > > trying to load library "eda" with the message "Symbol rsort not found". Trying
>  > > the 
>  > > other libraries by hand results in similar errors, except for "base" and "mva",
>  > > 
>  > > while "make test-Specific" gives no errors. 
>  > 
>  > Fuller details, please. Exactly that configuration works for me (except I
>  > don't know where binutils are in your path). Looks like you haven't got
>  > linking against R.X11 correct.  Try using the sun ld if you are not already
>  > doing so (it is recommended for Solaris).
> 
> Thanks. Using the sun ld (with everything else the same) works. 
> 
> The Readme of gnu ld mentions a difference to sun ld and says it would 
> emulate its behavior if given the "-E" flag. I didn't try this, but if 
> this was the case, could one not try to figure it out in the configure 
> script?

_I_ am not sure it is at all easy to find out which ld you are using, but
thanks for the info: another thing to watch out for.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mcw@ln.nimh.nih.gov  Fri Sep 17 21:44:17 1999
From: mcw@ln.nimh.nih.gov (Matthew Wiener)
Date: Fri, 17 Sep 1999 16:44:17 -0400 (EDT)
Subject: lambda error update
Message-ID: <Pine.SGI.3.96.990917164220.909I-100000@ln.nimh.nih.gov>

Two more details:

Someone else who works here, and hasn't used 0.65.0, thinks he's seen the
error before.  He restarted R, and it went away.

Second, I think the relevant code is in 
SEXP do_function, in eval.c in the main directory.

line 695:  WrongArgCount("lambda")

Beyond that I'm afraid I'm getting in over my head.

Matt


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Sep 18 00:53:55 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Sep 1999 01:53:55 +0200
Subject: lambda error update
In-Reply-To: Matthew Wiener's message of "Fri, 17 Sep 1999 16:44:17 -0400 (EDT)"
References: <Pine.SGI.3.96.990917164220.909I-100000@ln.nimh.nih.gov>
Message-ID: <x2aeqlt7qk.fsf@blueberry.kubism.ku.dk>

Matthew Wiener <mcw@ln.nimh.nih.gov> writes:

> Two more details:
> 
> Someone else who works here, and hasn't used 0.65.0, thinks he's seen the
> error before.  He restarted R, and it went away.
> 
> Second, I think the relevant code is in 
> SEXP do_function, in eval.c in the main directory.
> 
> line 695:  WrongArgCount("lambda")
> 
> Beyond that I'm afraid I'm getting in over my head.
> 
> Matt

"lambda" is essentially "function" (revealing the fact that R's engine
is really a Lisp/Scheme dialect). It's a very strange error you're
getting because the calls to "function" are almost impossible to
create, except by having the parser parse a

function (<args>) <body> 

construction and that would set up a call with the right number of
parameters (xxdefun in gram.y calls lang4). The arg count got changed
from 0.64.2 to 0.65.0 (from 3 to 4) to accommodate the stored source
attribute. I suppose that a function stored in a saved workspace might
cause some kind of mess when restored.

You can provoke the error by messing with the parse tree of function()
constructs, e.g.

> e<-quote(function()1)
> e[[4]]<-NULL
> eval(e)
Error: incorrect number of arguments to "lambda"
> e
function() 1
> e<-quote(function()1)
> e[[3]]<-NULL
> eval(e)
Error: incorrect number of arguments to "lambda"
> e
function() "function()1"
> e[[2]]<-NULL
> eval(e)
Error: incorrect number of arguments to "lambda"
> e
Segmentation fault (core dumped)

(That last one seems to indicate yet another spot where the deparser
needs to take better care).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mcw@ln.nimh.nih.gov  Sat Sep 18 06:55:51 1999
From: mcw@ln.nimh.nih.gov (Matthew Wiener)
Date: Sat, 18 Sep 1999 01:55:51 -0400 (EDT)
Subject: lambda error update
In-Reply-To: <x2aeqlt7qk.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.SGI.3.96.990918015308.10757B-100000@ln.nimh.nih.gov>



On 18 Sep 1999, Peter Dalgaard BSA wrote:

> "lambda" is essentially "function" (revealing the fact that R's engine
> is really a Lisp/Scheme dialect). It's a very strange error you're
> getting because the calls to "function" are almost impossible to
> create, except by having the parser parse a
> 
> function (<args>) <body> 
> 
> construction and that would set up a call with the right number of
> parameters (xxdefun in gram.y calls lang4). The arg count got changed
> from 0.64.2 to 0.65.0 (from 3 to 4) to accommodate the stored source
> attribute. I suppose that a function stored in a saved workspace might
> cause some kind of mess when restored.
> 

If I understand this correctly, it would seem to mean that I'm unlikely to
get this error more than once from any given function, since when I
re-store (rather than restore) it under 0.65.0 things will get fixed.
Does that seem right?  If not, is there anything I can do?

Thanks (for this help and for R generally).

Matt

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Sep 18 10:40:00 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Sat, 18 Sep 1999 11:40:00 +0200 (MET DST)
Subject: lambda error update (PR#282)
Message-ID: <199909180940.LAA12533@pubhealth.ku.dk>

Matthew Wiener <mcw@ln.nimh.nih.gov> writes:

> > parameters (xxdefun in gram.y calls lang4). The arg count got changed
> > from 0.64.2 to 0.65.0 (from 3 to 4) to accommodate the stored source
> > attribute. I suppose that a function stored in a saved workspace might
> > cause some kind of mess when restored.
> > 
> 
> If I understand this correctly, it would seem to mean that I'm unlikely to
> get this error more than once from any given function, since when I
> re-store (rather than restore) it under 0.65.0 things will get fixed.
> Does that seem right?  If not, is there anything I can do?

No, that doesn't work, because you'll just store the old call again.
However if you just edit the function, e.g. with fix(), the problem
goes away. You don't have to change it, just make sure that the code
gets reparsed.

Here's the essence of the problem:

R : Copyright 1999, The R Development Core Team
Version 0.64.1 Patched (unreleased snapshot) (May 14, 1999)
> f<-function(){g<-function()2}  
> save(f,file="xxx")

R : Copyright 1999, The R Development Core Team
Version 0.65.0 Patched (unreleased) (September 16, 1999)
> load("xxx")
> f
function () 
{
    g <- function() 2
}
> f()
Error: incorrect number of arguments to "lambda"
> fix(f)
...
> f()
>

D*mn! I should have thought of that. I'll see if I can cook up a fix
for 0.65.1. Filed as a bug report.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Sep 18 11:21:42 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Sep 1999 12:21:42 +0200
Subject: lambda error update (PR#282)
In-Reply-To: p.dalgaard@biostat.ku.dk's message of "Sat, 18 Sep 1999 11:40:00 +0200 (MET DST)"
References: <199909180940.LAA12533@pubhealth.ku.dk>
Message-ID: <x2yae4zfih.fsf@blueberry.kubism.ku.dk>

p.dalgaard@biostat.ku.dk writes:

> Error: incorrect number of arguments to "lambda"
> > fix(f)
> ...
> > f()
> >
> 
> D*mn! I should have thought of that. I'll see if I can cook up a fix
> for 0.65.1. Filed as a bug report.

Heh. Turned out to be absolutely trivial:

diff -u -r1.62.2.1 eval.c
--- eval.c	1999/09/02 15:11:59	1.62.2.1
+++ eval.c	1999/09/18 10:06:30
@@ -691,7 +691,7 @@
 {
     SEXP rval;
 
-    if (length(args) < 3)
+    if (length(args) < 2)
	WrongArgCount("lambda");
     CheckFormals(CAR(args));
     rval = mkCLOSXP(CAR(args), CADR(args), rho);

If the 3rd argument is absent, R_NilValue gets passed for the CADDR in

   setAttrib(rval, R_SourceSymbol, CADDR(args));

and that is exactly what should happen!

This has to be the smallest bugfix possible, AFAICS a single bit gets
flipped, both in the source and in the binaries....

Will commit in a moment.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Sep 18 20:03:13 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Sat, 18 Sep 1999 21:03:13 +0200 (MET DST)
Subject: hsv strangeness (PR#283)
Message-ID: <199909181903.VAA13542@pubhealth.ku.dk>

This doesn't look right:

 piechart(rep(1,48),col=hsv((1:48)/48,1,1))

Hues 8,16,32 are completely out of whack. 

(Linux RedHat6.0, X11 driver, but probably not driver dependant.)

This also sends topo.colors, terrain.colors, and heat.colors way off.
Look at example(heat.colors) for instance.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Mon Sep 20 17:08:25 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Mon, 20 Sep 1999 16:08:25 +0000
Subject: Updated tseries package
Message-ID: <37E65BF9.B37B63C0@wu-wien.ac.at>

Fritz just put the updated tseries package to CRAN. I mainly removed
(and corrected) code such that tseries fits together with package ts.
New code is White's and Teraesvirta's tests for neglected non-linearity
(also for the regression case). From the INDEX file:

NelPlo                   Nelson-Plosser Macroeconomic Time Series
adf.test                 Augmented Dickey-Fuller Test
amif                     Auto Mutual Information Function
bds.test                 BDS Test
portfolio.optim          Portfolio Optimization
quadmap                  Quadratic Map (Logistic Equation)
read.matrix              Read Matrix Data
read.ts                  Read Time Series Data
runs.test                Runs Test
surrogate                Generate Surrogate Data
tcm                      Yields on Treasury Securities
terasvirta.test          Teraesvirta Neural Network Test for
Nonlinearity
white.test               White Neural Network Test for Nonlinearity

Comments and suggestions are welcome!

Adrian


--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@biostat.ku.dk  Tue Sep 21 06:15:04 1999
From: pd@biostat.ku.dk (Peter Dalgaard BSA)
Date: Tue, 21 Sep 1999 07:15:04 +0200
Subject: Bug list summary (automatic post)
Message-ID: <199909210515.HAA12539@biostat.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.biostat.ku.dk or via email to
r-bugs@biostat.ku.dk. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

* PR# 138 *
Subject: Re: [R] bug? and New bug.
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Wed, 10 Mar 1999 17:21:16 +0100
--pt() for large df. Solved, but problem remains for pf et al.

Directory:  Add-ons

* PR# 137 *
Subject: funfits
From: "Alvaro A. Novo" <novo@uiuc.edu>
Date: Tue, 9 Mar 1999 22:24:54 -0600
--Not our problem. Dubious whether a bug at all.

Directory:  Analyses

* PR# 144 *
Subject: glm throws erroneous(?)'names attribute must be the same length as the vector' 
From: wagman@enteract.com
Date: Thu, 18 Mar 1999 08:58:47 +0100
--Can anyone reproduce this ??
--Same error as when doing regression on empty subset. All fitted
--values might be 0 or 1

Directory:  Documentation

none

Directory:  Graphics

* PR# 61 *
Subject: points(...,  cex = ..)  is pretty wrong...
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 2 Nov 1998 19:15:06 +0100
--Symbols getting decentered when too large cex for X. Still there 22feb99  
* PR# 69 *
Subject: Some graphics bugs
From: Martyn Plummer <plummer@iarc.fr>
Date: Fri, 04 Dec 1998 11:42:50 -0000 ()
Date: 04-Dec-98
--Various anomalies with text size and alignment. 2B appears to be solved. The 
--rest is still there (22feb99)
* PR# 120 *
Subject: graphics bug: type="l"
From: Matthew Wiener <mcw@ln.nimh.nih.gov>
Date: Tue, 16 Feb 1999 15:30:25 -0500 (EST)
--X server problem drawing > 64K lines at once. Workaround?
* PR# 123 *
Subject: Text in plot
From: Ennapadam Venkatraman <venkat@biosta.mskcc.org>
Date: Thu, 18 Feb 1999 13:05:37 -0500
--Multiline text not working
* PR# 130 *
Subject: lty=0 -- shouldn't it give an invisible line?
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 28 Feb 1999 21:45:43 +0100
--Strange effect on barplot
* PR# 149 *
Subject: plot.formula and pch=
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 25 Mar 1999 21:22:44 +0100
--plot(y~x,pch=z) may subset x and y but leave z.
--E.g. with missing values you can get incorrect plot symbols.
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--Don't think I (pd) got the point there...
* PR# 225 *
Subject: pch and mkh bug
From: Stephen Harker <sjh@ph.adfa.edu.au>
Date: Wed, 14 Jul 1999 13:10:31 +1000 (EST)
--(1) is an S incompatibility, but the S rules may not be a good model
--(2) is a bug, fixed for 0.65.0
--(3) has gone away in 0.65.0
* PR# 229 *
Subject: dev.print scaling bug?
From: John.Peters@tip.csiro.au (John Peters)
Date: Fri, 16 Jul 1999 12:10:48 +1000 (EST)
* PR# 230 *
Subject: Use of lwd = 0, lty = 2 in segments.
From: Douglas Bates <bates@stat.wisc.edu>
Date: Sat, 17 Jul 1999 17:18:44 -0500 (CDT)
* PR# 238 *
Subject: EPS compliance of postscript device: initclip operator
From: David Middleton <dajm@deeq.demon.co.uk>
Date: Tue, 03 Aug 1999 17:51:47 -0300
--initclip is removed. Still need new argument onefile/onepage to ensure one page
--and use %!PS-Adobe-3.0 EPSF-3.0 header

Directory:  In-Out

* PR# 125 *
Subject: scan rejects complex
From: John.Peters@tip.csiro.au (John Peters)
Date: Mon, 22 Feb 1999 10:08:14 +1100 (EST)
* PR# 129 *
Subject: Formatting in formatC and format
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 28 Feb 1999 08:53:34 +0000 (GMT)
--Documentation and ``merge'' of format() and formatC() would be desired - MM
* PR# 207 *
Subject: Lines longer than ~1000 chars truncated at parsing
From: msa@biostat.mgh.harvard.edu
Date: Mon, 7 Jun 1999 22:27:10 +0200 (MET DST)
--Fixed buffer used during input.
--Not fixable without major changes to readline lib.

Directory:  Installation

none

Directory:  Language

* PR# 105 *
Subject: an old bug resurfaces
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Fri, 29 Jan 1999 08:28:32 +0100 (MET)
--Model formulas. Proper fix probably requires extensive rewrite of model formula
--parser, which would make in non-S-compatible.
* PR# 239 *
Subject: cbind is not generic as claimed, omits labels where S has them 
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 5 Aug 1999 12:29:58 +0100 (BST)
--Cbind is now generic, still labelling issues. See also PR#240 and PR#241.
* PR# 240 *
Subject: Re: cbind is not generic as claimed, omits labels where S has them
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 5 Aug 1999 17:19:08 +0100 (BST)
--See PR#239
* PR# 241 *
Subject: Re: cbind is not generic as claimed, omits labels where S has them
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Fri, 6 Aug 1999 06:52:35 +0100 (BST)
--See PR#239

Directory:  Low-level

* PR# 37 *
Subject: S.h compatibility issues
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 6 Sep 1998 19:58:47 +0100 (BST)
--1 is fixed
--2 R's own RNG entry points are still not public
--3 is the perennial issue of what is the `public' API -- specific points are
--fixed
* PR# 101 *
Subject: Re: [R] Re: R-0.63.2 for Windows - some comments
From: Guido Masarotto <guido@hal.stat.unipd.it>
Date: Fri, 22 Jan 1999 12:40:26 +0100
--This is really about fixed buffer sizes in printutils.c
* PR# 135 *
Subject: summary() of lm() problem
From: Simon Fear <fears@roycastle.liv.ac.uk>
Date: Tue, 9 Mar 1999 13:18:37 -0000 
--lm (?) AND Windows problem;  Win solved (fudged) for 0.63.3
--
--Another low-level buffer-size problem
* PR# 185 *
Subject: Re: [R] R_problem_buf in the S.h files & lists in .C
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 05 May 1999 00:32:49 +0200
--S objects in .C calls (not just lists) are now documented in the help file
* PR# 197 *
Subject: glm crash
From: Cor en Aylin <Cor.Berrevoets@gironet.nl>
Date: Fri, 21 May 1999 19:44:23 +0200
--Obscure report. Cannot reproduce from given info.
* PR# 210 *
Subject: definition of R_problem_buf in S.h
From: vogels@ieee.org
Date: Mon, 14 Jun 1999 17:56:04 +0200 (MET DST)
--Same as #185
* PR# 235 *
Subject:  round(numeric(0)) 
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 29 Jul 1999 15:20:21 +0100 (BST)
--Some followup of this on R-devel not sent here.

Directory:  Misc

* PR# 91 *
Subject: possible bug
From: Rashid Nassar <rnassar@duke.edu>
Date: Sat, 9 Jan 1999 14:50:58 -0500 (EST)
--Remaining issue is whether we can do something more friendly than dumping 
--users into vi?

Directory:  Models

* PR# 121 *
Subject:  model.frame mangles time series 
From: Peter Dalgaard BSA <pd@biostat.ku.dk>
Date: Thu, 18 Feb 1999 15:47:24 +0100
--Subset in C code + attributes = mess
--Switch to interpreted ("[")

Directory:  Startup

none

Directory:  System-specific

* PR# 214 *
From: Charles Taylor <charles@amsta.leeds.ac.uk>
Date: Thu, 24 Jun 1999 11:20:06 +0100 (BST)
* PR# 222 *
Subject: Use of R-Coda
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Fri, 9 Jul 1999 10:54:16 +0200 
--In Danish (?)  Looks as if PR#246 is the same in English
* PR# 234 *
Subject: R-bugs
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Tue, 27 Jul 1999 13:49:31 +0200
--Looks like PR#222 again, in Danish. See PR#246 for English version
* PR# 246 *
Subject: R-Coda on rs6000-ibm-aix4.2.1.0
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Wed, 11 Aug 1999 08:49:47 +0200
--Problem with ps on AIX in 0.64.2. Try again with 0.65.0?

Directory:  TooMuchAtOnce

* PR# 53 *
Subject: 0.62.3 bugs, incompatibilities and problems
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Mon, 12 Oct 1998 09:43:51 +0200 (MET DST)
--Of Jims points: (checked in 0.65 April 26 compared to Splus 3.4)
-- 4. works the same as S
-- 5. Splus gives NA and the if(class(z)=="repeated") doesn't work in either
-- 10. seems to work
-- 7.  seems to do what Jim wants now
--  
* PR# 76 *
Subject: R-0.63.0
From: Rashid Nassar <rnassar@acpub.duke.edu>
Date: Fri, 11 Dec 1998 23:20:08 -0500 (EST)

Directory:  Windows

none

Directory:  incoming

* PR# 248 *
Subject: scan() + error interferes with count.fields() in some cases
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 13 Aug 1999 17:44:48 +0200
* PR# 249 *
Subject: axis ignores srt/crt
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Mon, 16 Aug 1999 15:51:49 -0700 (PDT)
* PR# 250 *
From: Peter Malewski <peter@tu-bs.de>
Date: Tue, 17 Aug 1999 12:21:38 +0200 (CEST)
* PR# 251 *
From: Peter Malewski <peter@tu-bs.de>
Date: Tue, 17 Aug 1999 12:21:45 +0200 (CEST)
* PR# 252 *
Subject: bug: R says "Floating exception" on DEC-Alpha w/OSF1
From: "Michael Thompson" <mlthomps@yayoi.mt.m-kagaku.co.jp>
Date: Thu, 19 Aug 1999 06:03:06 +0900
* PR# 253 *
Subject: seg.fault for some illegal .Random.seed (new since 0.64)
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 20 Aug 1999 14:17:31 +0200
* PR# 254 *
Subject: Strange 'Unimplemented feature in rep' error
From: Lutz Prechelt <prechelt@ira.uka.de>
Date: Mon, 23 Aug 1999 19:43:24 +0200
* PR# 255 *
Subject: broken link in R FAQ page?
From: Tian-Xiong Lu <tian@chico.ma.adfa.edu.au>
Date: Tue, 24 Aug 1999 13:41:21 +1000 (EST)
* PR# 256 *
Subject: Error in ?text
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
Date: Wed, 25 Aug 1999 10:00:19 +0100 (BST)
* PR# 257 *
Subject:  dimnames names lost when subscripting 
From: Andreas Weingessel <weingessel@ci.tuwien.ac.at>
Date: Wed, 25 Aug 1999 12:45:28 +0200
* PR# 258 *
Subject: Greek letters in outer margins.
From: "BXC (Bendix Carstensen)" <BXC@NOVO.dk>
Date: Thu, 26 Aug 1999 12:09:17 +0200
* PR# 259 *
Subject: R without X11?
From: "Jack N." <jnf@pcisys.net>
Date: Sat, 28 Aug 1999 09:22:57 -0600
* PR# 260 *
Subject: Re: Compiling R under Caldera Open Linux 2.2
Subject: Compilation of R under Caldera OpenLinux 2.2
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sun, 29 Aug 1999 19:38:13 +1000 (EST)
* PR# 261 *
Subject: interface w/ emacs
From: gautier@lion-ag.de
Date: Mon, 30 Aug 1999 13:28:52 +0200 (MET DST)
* PR# 262 *
Subject: Problems compiling R65.0
From: Patrick Lindsey <plindsey@alpha.luc.ac.be>
Date: Wed, 1 Sep 1999 11:52:29 +0200 (MET DST)
* PR# 263 *
Subject: Problems sourcing functions with R65.0
From: Patrick Lindsey <plindsey@alpha.luc.ac.be>
Date: Wed, 1 Sep 1999 11:58:51 +0200 (MET DST)
* PR# 264 *
Subject: R 0.65.x bug :  attach()/eval() {was "lib.source() within library()"}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Thu, 2 Sep 1999 12:23:43 +0200
* PR# 265 *
Subject: trouble with the 'exclude' parameter of factor()
From: gautier@lion-ag.de
Date: Thu, 2 Sep 1999 17:40:47 +0200 (MET DST)
* PR# 266 *
Subject: Re: [R] data frame component replacement: feature or bug?
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Sep 1999 00:03:29 +0200
* PR# 267 *
Subject: matplot(... panel.first=..) fails  <==> dealing with "..."
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 6 Sep 1999 11:04:03 +0200
* PR# 268 *
Subject: Re: Compiling R under Caldera Open Linux 2.2
From: "Jack N." <jnf@pcisys.net>
Date: Mon, 06 Sep 1999 08:03:02 -0600
* PR# 269 *
Subject: sys.on.exit appears non-functional
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Tue, 7 Sep 1999 17:41:28 +0100 (BST)
* PR# 270 *
Subject: Y2K Cereal bowl News Release
From: crispy1@newmail.net
Date: Tue, 7 Sep 1999 20:59:05 -0700
* PR# 271 *
Subject: R with Windows 95
From: pascal.grandeau@wanadoo.fr
Date: Wed, 8 Sep 1999 17:56:12 +0200 (MET DST)
* PR# 272 *
Subject:  problem in R.sh.in script 
From: "Mitsuru Oka" <oka@debian.or.jp>
Date: 10 Sep 1999 06:53:01 -0000
* PR# 273 *
Subject: Re: problem in R.sh.in script 
From: Mitsuru Oka <oka@debian.or.jp>
Date: Fri, 10 Sep 1999 16:08:39 +0900
* PR# 274 *
Subject: axis() produces junk on DEC alpha
From: albrecht.gebhardt@uni-klu.ac.at
Date: Mon, 13 Sep 1999 03:02:20 +0200 (MET DST)
* PR# 275 *
Subject: Re: R with a broken finite() (was [R] Problems with R-0.65.0)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Tue, 14 Sep 1999 15:17:17 +0100 (BST)
* PR# 276 *
Subject: Re: chisqsim broken on alpha (was Re: axis() produces junk on DEC
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Wed, 15 Sep 1999 08:18:42 +0100 (BST)
* PR# 277 *
Subject: Re: chisqsim broken on alpha - solved + next bug in fft found
From: Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at>
Date: Wed, 15 Sep 1999 15:33:09 +0200 (MET DST)
* PR# 278 *
Subject: buglet in lm.influence() -- easy fix but...
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Wed, 15 Sep 1999 17:36:46 +0200
* PR# 279 *
Subject: plot ( <aov.obj> ) failed -- easy fix
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Wed, 15 Sep 1999 18:42:56 +0200
* PR# 280 *
Subject: install/libraries on solaris2.6
From: ulrich.poetter@ruhr-uni-bochum.de
Date: Thu, 16 Sep 1999 22:43:34 +0200 (MET DST)
* PR# 281 *
Subject: mtext(. col = ...) stopped working in 0.65.0
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 17 Sep 1999 15:10:40 +0200
* PR# 282 *
Subject: Re: lambda error update
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 18 Sep 1999 11:44:26 +0200
* PR# 283 *
Subject: hsv strangeness
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 18 Sep 1999 21:07:50 +0200
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Wed Sep 22 10:42:18 1999
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Wed, 22 Sep 1999 11:42:18 +0200 (MET DST)
Subject: quasi-likelihood in glm (PR#284)
Message-ID: <199909220942.LAA16986@pubhealth.ku.dk>

I have been using quasi-likelihood to analyze some overdispersed lesion
count data which requires the variance function "mu^2" (specifically,
I am using glm with the family quasi(var="mu^2", link="log")). Some of
the counts are zero which led to problems fitting the model in R.

1) glm was unable to find starting values
2) after I supplied initial values from the fit of a Poisson
   model, glm could not proceed because the deviance was infinite.

Splus 5.0 had no problems fitting the model.  I was able to
reproduce the Splus results by editing the quasi() family
generator and using the unnormalized quasi-likelihood

- log(mu) - y/mu                  (*)

in place of the normalized version

log(y/mu) - (y - mu)/mu            (**)

Further investigation of Splus shows how it overcomes these
two problems
1) A fudge factor (in this case 0.167) is added to zero observations 
   so that they can be used as starting values. 
2) The contribution to the deviance is (*) for zero observations
   and (**) for the rest.

I suggest that R also uses this approach for quasi-likelihood
models.
Martyn

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Wed Sep 22 11:32:12 1999
From: J.C.Rougier@durham.ac.uk (J.C.Rougier@durham.ac.uk)
Date: Wed, 22 Sep 1999 12:32:12 +0200 (MET DST)
Subject: model.matrix() (PR#285)
Message-ID: <199909221032.MAA17796@pubhealth.ku.dk>

I was alarmed to discover that model.matrix.default() can permute columns
with respect to the formula.  This seems to happen with user-defined
components of the formula.  Thus

X <- matrix(1:4, 1, 4, dimnames = list(NULL, LETTERS[1:4]))
Q <- function(x) x^2 # because model.matrix() does not like, eg, A:A

model.matrix(~ -1 + A + A:B + Q(C), data.frame(X))

has columns ordered A, Q(C), and A.B, not A, A.B, Q(C), as you might
expect (and I certainly expected!). This appears to happen .Internal-ly. 

While on the subject, would it be reasonable to standardise the names of
interaction terms to be A:B not A.B, to match the terms in the formula.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Sep 22 11:38:29 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 22 Sep 1999 12:38:29 +0200 (MET DST)
Subject: quasi-likelihood in glm (PR#284)
Message-ID: <199909221038.MAA17899@pubhealth.ku.dk>

On Wed, 22 Sep 1999 plummer@iarc.fr wrote:

> I have been using quasi-likelihood to analyze some overdispersed lesion
> count data which requires the variance function "mu^2" (specifically,
> I am using glm with the family quasi(var="mu^2", link="log")). Some of
> the counts are zero which led to problems fitting the model in R.
> 
> 1) glm was unable to find starting values
> 2) after I supplied initial values from the fit of a Poisson
>    model, glm could not proceed because the deviance was infinite.
> 
> Splus 5.0 had no problems fitting the model.  I was able to
> reproduce the Splus results by editing the quasi() family
> generator and using the unnormalized quasi-likelihood
> 
> - log(mu) - y/mu                  (*)
> 
> in place of the normalized version
> 
> log(y/mu) - (y - mu)/mu            (**)
> 
> Further investigation of Splus shows how it overcomes these
> two problems
> 1) A fudge factor (in this case 0.167) is added to zero observations 
>    so that they can be used as starting values. 
> 2) The contribution to the deviance is (*) for zero observations
>    and (**) for the rest.
> 
> I suggest that R also uses this approach for quasi-likelihood
> models.

That is not quite what S-PLUS 5.1 and 2000 have: replace
(*) by

-log(mu) - (y - mu)/mu 

That is, the formula is

-log(mu) - (y - mu)/mu + log(y)I(y > 0)

Note that earlier versions of S-PLUS (e.g. 3.4) are plain wrong (and as
I found the bug I know what the replacment is).

Unless there are any objections I will put these fixes in.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Sep 22 12:47:55 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 22 Sep 1999 13:47:55 +0200
Subject: Private data libraries (idea & trick)
Message-ID: <x2iu5388wk.fsf@blueberry.kubism.ku.dk>

It has been annoying me for a while that data in user areas are more
difficult to handle than those in the packages. 

Especially for beginners, it would be very handy to be able just to
say "data(mydata)", rather than
"mydata<-read.table('mydata.txt',header=T)"

What just occurred to me was that the following hack actually works:

Type

library('.',lib.loc='.')

and everything in ./data behaves as if it were in a package. 

Another interesting hack is that one can do this:

[pd@blueberry data]$ cat > file.txt
a b
1 2
3 4
[pd@blueberry data]$ cat > file.R
file<-transform(read.table('file.txt',header=T),
    b=factor(b,levels=1:4,labels=letters[1:4]))

and then from inside R, get the dataframe with factor recoding and
everything as

> data(file)
> file
  a b
1 1 b
2 3 d

Question: Should we perhaps clean this up a little and formalize it?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From William.Venables@cmis.CSIRO.AU  Wed Sep 22 13:17:38 1999
From: William.Venables@cmis.CSIRO.AU (Bill Venables)
Date: Wed, 22 Sep 1999 22:17:38 +1000
Subject: model.matrix() (PR#285)
In-Reply-To: Your message of "Wed, 22 Sep 1999 12:32:12 +0200."
 <199909221032.MAA17796@pubhealth.ku.dk>
Message-ID: <199909221219.WAA14736@snowy.nsw.cmis.CSIRO.AU>

> I was alarmed to discover that model.matrix.default() can permute columns
> with respect to the formula.						

You are very easily alarmed, then.  The order of the terms is
relevant to a sequential anova and in such an anova it is a
normal and very reasonable strategy for main effects to be
included in the model before interactions (and it is only
interaction terms that are displaced, arranging them in
increasing order by degree).

> This seems to happen with user-defined components of the
> formula.  Thus
> 
> X <- matrix(1:4, 1, 4, dimnames = list(NULL, LETTERS[1:4]))
> Q <- function(x) x^2 # because model.matrix() does not like, eg, A:A
> 
> model.matrix(~ -1 + A + A:B + Q(C), data.frame(X))
> 
> has columns ordered A, Q(C), and A.B, not A, A.B, Q(C), as you might
> expect (and I certainly expected!). This appears to happen .Internal-ly. 

There is a standard method common to R and S of holding terms
together in the strict order they are generated that I suggest is
adequate.  Your model matrix, order intact, could be generated
using

> model.matrix(terms(~ -1 + A + A:B + I(C^2), keep.order = T), data.frame(X))

This is now a very standard idiom but not often needed.  Your
function Q() is not needed, by the way.  The I() function
(`identity') allows you to include arbitrary terms of this form.
This is also a standard and well known idiom.  (I won't ask in
what context you need a quadratic term in C but no linear term...)

There is, though, a clear improvement possible and I do suggest R
core consider it sympathetically.  For quantitative terms A:A
should be an allowable form for the quadratic term, but more
generally ~(x1 + x2 + x3 + x4)^3 should be an allowable form for
a complete 3rd order model, including powers.  I know this is
diffucult since it requires parsing and simplification to be
suspended until the classes of the terms are known, but it is
well worth the effort.

> While on the subject, would it be reasonable to standardise the names of
> interaction terms to be A:B not A.B, to match the terms in the formula.

I agree it would indeed.  The `dot' form is potentially ambiguous
but more seriously I get the horrible feeling I am back using
glim once more and it's plain creepy...

Bill Venables.

-- 
-----------------------------------------------------------------
Bill Venables, Statistician, CMIS Environmetrics Project.

Physical address:                            Postal address:
CSIRO Marine Laboratories,                   PO Box 120,       
233 Middle St, Cleveland, Queensland         Cleveland, Qld, 4163
AUSTRALIA                                    AUSTRALIA

Telephone: +61 7 3826 7251     Email: Bill.Venables@cmis.csiro.au     
      Fax: +61 7 3826 7304
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From novo@uiuc.edu  Fri Sep 24 02:49:17 1999
From: novo@uiuc.edu (Alvaro A. Novo)
Date: Thu, 23 Sep 1999 20:49:17 -0500
Subject: analysis of multivariate normal (missing values)
Message-ID: <99092320592900.04464@friedman>

Hi,

I could not find an R package for the analysis of multivariate normal
datasets with missing values. Prof. Joseph Schafer has created an S+ library
(norm) that does such type of analysis, which I now ported to R. 

I guess that I should have asked here if there are other people working on
such project, before I actually ported it, but... If such package has not been
ported, I will upload the package (norm, original name) anytime soon.
Please let me know if you are working on such project.

Thank you,

Alvaro A. Novo


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Sep 24 09:58:46 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 24 Sep 1999 10:58:46 +0200
Subject: R's startup : .Rprofile & .Renviron  -- info and RFC
Message-ID: <199909240858.KAA04862@sophie.ethz.ch>

		[RFC = Request for Comments]

{ Yes, the documentation for .Renviron is really not there (but the FAQ...);
  the rest is in ?Startup }

In R's Startup (on Unix only??) {unless --no-environ is specified}
 ~/.Renviron (if there) is read as an 'sh' script before R is called,

then R looks ((for the site-wide Rprofile and then))
for .Rprofile in the current directory and then for ~/.Rprofile
(in the user's home directory).

I'd like to set R_NSIZE and R_VSIZE ``project dependent'' automatically,
and therefore would like  .Renviron also searched in the currenct directory
before the $HOME directory.
(setting --nsize or --vsize explicitly would always override as they
should).

Is this desired?  

Is is portable (at least) to Windows?
In the windows FAQ I've learnt that you must set the command line
arguments --nsize ..  when defining a shortcut to the R executable
in the corresponding directory (correct?).
Is this *the* windows way or does is make sense to have .Renviron files
($HOME would only be used on NT, I presume ?
	-- yes, I am a complete ``Wingnorant'' !)

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Sep 24 11:07:40 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 24 Sep 1999 11:07:40 +0100 (BST)
Subject: R's startup : .Rprofile & .Renviron  -- info and RFC
In-Reply-To: <199909240858.KAA04862@sophie.ethz.ch>
Message-ID: <Pine.GSO.4.05.9909241053250.13755-100000@auk.stats>

On Fri, 24 Sep 1999, Martin Maechler wrote:

> 		[RFC = Request for Comments]
> 
> { Yes, the documentation for .Renviron is really not there (but the FAQ...);
>   the rest is in ?Startup }
> 
> In R's Startup (on Unix only??) {unless --no-environ is specified}
>  ~/.Renviron (if there) is read as an 'sh' script before R is called,

On Windows it is read as a set of NAME=VALUE statements.

> then R looks ((for the site-wide Rprofile and then))
> for .Rprofile in the current directory and then for ~/.Rprofile
> (in the user's home directory).
> 
> I'd like to set R_NSIZE and R_VSIZE ``project dependent'' automatically,
> and therefore would like  .Renviron also searched in the currenct directory
> before the $HOME directory.
> (setting --nsize or --vsize explicitly would always override as they
> should).
> 
> Is this desired?  
> 
> Is is portable (at least) to Windows?

Yes, no problem. 

> In the windows FAQ I've learnt that you must set the command line
> arguments --nsize ..  when defining a shortcut to the R executable
> in the corresponding directory (correct?).
> Is this *the* windows way or does is make sense to have .Renviron files
> ($HOME would only be used on NT, I presume ?

Sorry, I don't see that as the only way in the rw-FAQ, but I do see how to
use .Renviron under Q2.2.

The current position is:

R figures out a value for R_USER.
It (effectively) reads its environment
It then reads R_USER/.Renviron as NAME=VALUE pairs
It then reads NAME=VALUE pairs off the command line.
It then processes --nsize etc.

The algorithm for R_USER is

If set, use it.
Else if HOME is set, use that (it normally is not).
Else if HOMEDRIVE and HOMEPATH are set (they usually are on NT) use
 HOMEDRIVE\HOMEPATH (the docs have this wrong, I see).
Else use the startup directory.

All we would need is to look for ./.Renviron then R_USER/.Renviron.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rossini@biostat.washington.edu  Fri Sep 24 14:54:25 1999
From: rossini@biostat.washington.edu (A.J. Rossini)
Date: 24 Sep 1999 06:54:25 -0700
Subject: analysis of multivariate normal (missing values)
In-Reply-To: "Alvaro A. Novo"'s message of "Thu, 23 Sep 1999 20:49:17 -0500"
References: <99092320592900.04464@friedman>
Message-ID: <871zbojtym.fsf@alpha.cfas.washington.edu>



I've ported it as well, (and Shafer's other two) but havn't managed to
finish the job (and package it) -- if you cleaned up the Fortran
problems, up load it!  (provided no one else has...).

best,
-tony

>>>>> "AAN" == Alvaro A Novo <novo@uiuc.edu> writes:

    AAN> Hi, I could not find an R package for the analysis of
    AAN> multivariate normal datasets with missing
    AAN> values. Prof. Joseph Schafer has created an S+ library (norm)
    AAN> that does such type of analysis, which I now ported to R.

    AAN> I guess that I should have asked here if there are other
    AAN> people working on such project, before I actually ported it,
    AAN> but... If such package has not been ported, I will upload the
    AAN> package (norm, original name) anytime soon.  Please let me
    AAN> know if you are working on such project.

    AAN> Thank you,

    AAN> Alvaro A. Novo


    AAN> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    AAN> r-devel mailing list -- Read
    AAN> http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html Send "info",
    AAN> "help", or "[un]subscribe" (in the "body", not the subject !)
    AAN> To: r-devel-request@stat.math.ethz.ch
    AAN> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Sep 24 15:13:51 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 24 Sep 1999 16:13:51 +0200 (CEST)
Subject: Private data libraries (idea & trick)
In-Reply-To: <x2iu5388wk.fsf@blueberry.kubism.ku.dk>
References: <x2iu5388wk.fsf@blueberry.kubism.ku.dk>
Message-ID: <14315.34591.572539.50534@fangorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> It has been annoying me for a while that data in user areas are more
> difficult to handle than those in the packages. 

> Especially for beginners, it would be very handy to be able just to
> say "data(mydata)", rather than
> "mydata<-read.table('mydata.txt',header=T)"

> What just occurred to me was that the following hack actually works:

> Type

> library('.',lib.loc='.')

> and everything in ./data behaves as if it were in a package. 

> Another interesting hack is that one can do this:

> [pd@blueberry data]$ cat > file.txt
> a b
> 1 2
> 3 4
> [pd@blueberry data]$ cat > file.R
> file<-transform(read.table('file.txt',header=T),
>     b=factor(b,levels=1:4,labels=letters[1:4]))

> and then from inside R, get the dataframe with factor recoding and
> everything as

>> data(file)
>> file
>   a b
> 1 1 b
> 2 3 d

> Question: Should we perhaps clean this up a little and formalize it?

Actually, this works in directories different from the current one as
well, as the working directory is changed temporarily.  However, someone
pointed out that this is not thread-safe, so we should be careful about
announcing this feature.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Sep 24 15:29:44 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 24 Sep 1999 16:29:44 +0200
Subject: Private data libraries (idea & trick)
In-Reply-To: Kurt Hornik's message of "Fri, 24 Sep 1999 16:13:51 +0200 (CEST)"
References: <x2iu5388wk.fsf@blueberry.kubism.ku.dk> <14315.34591.572539.50534@fangorn.ci.tuwien.ac.at>
Message-ID: <x2iu508js7.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> >>>>> Peter Dalgaard BSA writes:
...
> >> data(file)
> >> file
> >   a b
> > 1 1 b
> > 2 3 d
> 
> > Question: Should we perhaps clean this up a little and formalize it?
> 
> Actually, this works in directories different from the current one as
> well, as the working directory is changed temporarily. 

Yes. Actually it relies on it because file.{R,txt} would be in ./data

> However, someone
> pointed out that this is not thread-safe, so we should be careful about
> announcing this feature.

Er, didn't that just mean that the CWD would have to be yet another
per-thread item, or source() would have to block other threads for the
duration? Would seem a bit silly to have a chdir option and not be
allowed to use it...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Sep 24 15:50:07 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 24 Sep 1999 15:50:07 +0100 (BST)
Subject: argument PACKAGE in .C/.Fortran
Message-ID: <Pine.GSO.4.05.9909241537230.27548-100000@auk.stats>

One problem with linking compiled code is getting the symbol from the right
shared library/DLL (hereafter DLL). This actually happened to Guido
Masarotto recently: both leaps and ts had "ss", and leaps got ts's
version (and thereby crashed R).

We have added an argument PACKAGE to .C, .Fortran, .Call and .External,
which confines the symbol search to the named DLL (name without extension).
This in today's R-release, but it is backwards compatible if used as the
last argument (one surplus argument does no harm).  We would like to
encourage package writers to make use of it: R's own code now does.

For future reference, especially for porting projects, tomorrow's version
of R-release also allows passing float/REAL arguments to and from
.C/.Fortran, and has handling of Fortran character strings that
actually works on all the systems I have access to.

Brian Ripley

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Sep 24 18:02:00 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 24 Sep 1999 19:02:00 +0200
Subject: RFC: enhancement for sapply() : do.names
Message-ID: <199909241702.TAA12166@sophie.ethz.ch>

Among other uses of  sapply(), I use to use it for 
"analyzing" / "summarizing" components of a list or to `summarize' objects
in my search path,
typically such as

sapply(obj.names, function(n){ r <- get(n); unlist(r[c("x","y","par")]) })

which gives a list or a 3-col matrix (depending if "x", "y","par" have always
same length..) that has no (row)names unfortunately, even though it's clear
that I would want my initial names...

  for(n in 1:3) 
	  assign(paste("o",n,sep=""), list(x=n,y=n^2,par=n/4))
  (obj.n <- paste("o",1:3,sep=""))
  sapply(obj.n, function(n){ unlist(get(n)[c("x","y","par")]) })

which gives

	[,1] [,2] [,3]
    x   1.00  2.0 3.00
    y   1.00  4.0 9.00
    par 0.25  0.5 0.75

but I would want

	  o1  o2   o3
    x   1.00 2.0 3.00
    y   1.00 4.0 9.00
    par 0.25 0.5 0.75

----
I can get this with the following patch :

--- sapply.R	1999/01/29 17:39:28	1.3
+++ sapply.R	1999/09/24 16:12:53
@@ -1,8 +1,10 @@
-sapply <- function(X, FUN, ..., simplify = TRUE)
+sapply <- function(X, FUN, ..., simplify = TRUE, do.names = TRUE)
 {
     FUN <- match.fun(FUN)
-
     answer <- lapply(as.list(X), FUN, ...)
+    if(do.names && is.null(names(answer))) { # create names if sensible
+        if(is.character(X)) names(answer) <- X
+    }
     if(simplify && length(answer) &&
        length(common.len <- unique(unlist(lapply(answer, length)))) == 1) {
 	if(common.len == 1)

---------------

Now, before implementing this:

1) is "do.names" proper naming or should we rather use
	"DO.NAMES", "USE.NAMES", ...
   (at the moment, I'd prefer  USE.NAMES)


2) Inside the new  if(do.names ....) { .... }  clause, 
   we can try harder, e.g.,

  if(do.names && is.null(names(answer))) { # create names if sensible
	names(answer) <- 
	    if(is.character(X)) X  else  abbreviate(deparse(substitute(X)))
  }

   - actually this wouldn't always work as desired;  
     `substitute(X)' would have to be saved
     before the first use of X ( evaluation of expressions...)
   - In that case, do.names (or USE.NAMES) should probably have
     the default  is.character(X)  -- for efficiency & back-compatibility

Opinions?

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Sep 24 19:53:07 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 24 Sep 1999 19:53:07 +0100 (BST)
Subject: R's startup : .Rprofile & .Renviron  -- info and RFC
In-Reply-To: <199909240858.KAA04862@sophie.ethz.ch>
Message-ID: <Pine.GSO.4.05.9909241949210.27899-100000@auk.stats>

On Fri, 24 Sep 1999, Martin Maechler wrote:

> 		[RFC = Request for Comments]
> 
> { Yes, the documentation for .Renviron is really not there (but the FAQ...);
>   the rest is in ?Startup }
> 
> In R's Startup (on Unix only??) {unless --no-environ is specified}
>  ~/.Renviron (if there) is read as an 'sh' script before R is called,
> 
> then R looks ((for the site-wide Rprofile and then))
> for .Rprofile in the current directory and then for ~/.Rprofile
> (in the user's home directory).
> 
> I'd like to set R_NSIZE and R_VSIZE ``project dependent'' automatically,
> and therefore would like  .Renviron also searched in the currenct directory
> before the $HOME directory.
> (setting --nsize or --vsize explicitly would always override as they
> should).
> 
> Is this desired?  

It seems done on Unix, so now on Windows too, if not committed yet.

You had been worried, but all the info is in the Windows README. However,
I had got HOMEDRIVE as HOMEDIR, so thank you getting me to re-read it!

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From oka@debian.or.jp  Sat Sep 25 18:16:05 1999
From: oka@debian.or.jp (oka@debian.or.jp)
Date: Sat, 25 Sep 1999 19:16:05 +0200 (MET DST)
Subject: segmentation fault in R (PR#286)
Message-ID: <199909251716.TAA20918@pubhealth.ku.dk>


Hi,

  c(1,2,3) %*% c(1,2,3)[drop=TRUE]

or

  c(1,2,3) %*% c(1,2,3)[drop=FALSE]

caused segmentation fault.

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status = 
 status.rev = 0
 major = 0
 minor = 65.0
 year = 1999
 month = August
 day = 27
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Sep 25 19:01:47 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sat, 25 Sep 1999 20:01:47 +0200 (MET DST)
Subject: segmentation fault in R (PR#286)
Message-ID: <199909251801.UAA20977@pubhealth.ku.dk>

On Sat, 25 Sep 1999 oka@debian.or.jp wrote:

>   c(1,2,3) %*% c(1,2,3)[drop=TRUE]
> 
> or
> 
>   c(1,2,3) %*% c(1,2,3)[drop=FALSE]
> 
> caused segmentation fault. < 0.65.0, Linux >

We are very grateful to Martin Maechler for working hard on tracking down
many such things. In the current R-release it reports (as it should)

> c(1,2,3) %*% c(1,2,3)[drop=TRUE]
Error in c(1, 2, 3)[drop = TRUE] : no index specified

Thank you for your report.

[... system details]

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep 27 08:52:15 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 27 Sep 1999 09:52:15 +0200
Subject: boxplot()'s return value names
Message-ID: <199909270752.JAA01756@sophie.ethz.ch>

Something worth discussing,

I think these output names  NEED  a change :

    > boxplot(rt(250,df=3), plot=F)
    $"1"
    $"1"$stats
    [1] -2.7995357 -0.7170382  0.1109581  0.8426811  3.0483316

    $"1"$n
    [1] 250

    $"1"$conf
    [1] -0.04490152  0.26681765

    $"1"$out
     [1]  5.784389  4.766206 -3.932449 -3.460407 -3.695599  5.486126 -3.141079
     [8]  4.484507 12.731848  3.867611  4.040786  4.137455  3.772149  7.693779
    [15] -3.431560  3.860079 -4.087880  3.766799  4.497379 -3.543726 -6.196635
    [22] -6.322201

- "1" should rather be 1

and

 str(boxplot(data.frame(x=1:10,y=rt(10,df=4)),plot=F))

List of 2
 $ x:List of 4
  ..$ stats: num [1:5] 1 3 5.5 8 10
  ..$ n    : int 10
  ..$ conf : num [1:2] 3 8
  ..$ out  : int(0) 
 $ y:List of 4
  ..$ stats: num [1:5] -1.4097  0.0251  0.4533  1.0871  1.4427
  ..$ n    : int 10
  ..$ conf : num [1:2] -0.0774  0.9840
  ..$ out  : num(0) 
 - attr(*, "row.names")= chr [1:10] "1" "2" "3" "4" "5" "6" "7" "8" "9" "10"

where the `trailing'  "row.names" attribute seems *very* unnecessary.

{I'm in a hurry..}


-- 
Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Mon Sep 27 10:12:21 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon, 27 Sep 1999 11:12:21 +0200 (MET DST)
Subject: text( col=, cex=, font=) : doesn't allow more than length-1 arg (PR#287)
Message-ID: <199909270912.LAA27339@pubhealth.ku.dk>


text(..., col = <..>)   doesn't work if col has length more than one;

and the same for 'cex' and 'font'

A toy example, showing what is desired

plot(1);text(1.2, .8+(0:5)/16, LETTERS[6:1])
## works alright

plot(1);text(1.2, .8+(0:5)/16, LETTERS[6:1],col=1:6)
##>>> Error in par(args) : parameter "col" has the wrong length

---
Explanation:
The source code is in  src/main/plot.c  in do_text(),
and from reading it, "col" (& "cex" & "font") are extracted via GetPar()
(and later would nicely be recycled).
HOWEVER, the ProcessInlinePars() called after the three GetPar() gives the
error message, because "col" (cex, or font) are still part of the `args'
list.

All boils down to the FIXME part of the following description of
GetPar() [around line 120 in plot.c] :

/* GetPar is intended for looking through a list  -- typically that bound
 *	to ... --  for a particular parameter value.  This is easier than
 *	trying to match every graphics parameter in argument lists explicitly.
 * FIXME: This needs to be destructive, so that "ProcessInlinePars"
 *	can be safely called afterwards.
 */

PLEASE, can we fix this!

Idea: don't shorten the `parlist' argument of GetPar(), 
      for efficiency.
Just set the TAG to "", such that it will be disregarded subsequently,
i.e., do something like

SEXP GetPar(char *which, SEXP parlist)
{
    SEXP w, p;
    w = install(which);
    for (p = parlist; p != R_NilValue; p = CDR(p)) {
	if (TAG(p) == w) {
 NEW>>>	    TAG(p) == mkString("");
	    return CAR(p);
	}
    }
    return R_NilValue;
}

	  

-- 
Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Mon Sep 27 11:18:52 1999
From: J.C.Rougier@durham.ac.uk (Jonathan Rougier)
Date: Mon, 27 Sep 1999 11:18:52 +0100 (BST)
Subject: chol() dimnames
Message-ID: <Pine.GSO.3.96.990927110820.382H-100000@laplace>

Hi Everyone,

Just a minor point, but could chol() be changed to include the dimnames of
the original matrix?  This will ensure that x and t(R) %*% R have the same
dimnames, where R <- chol(x).  So we just need to insert

    if (!is.null(dx <- dimnames(x))) 
        dimnames(z$v) <- dx

ahead of the return.  Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Sep 27 12:25:05 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 27 Sep 1999 12:25:05 +0100 (BST)
Subject: chol() dimnames
Message-ID: <199909271125.MAA07858@toucan.stats.ox.ac.uk>


> Date: Mon, 27 Sep 1999 11:18:52 +0100 (BST)
> From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
> To: r-devel@stat.math.ethz.ch
> Subject: chol() dimnames
> 
> Hi Everyone,
> 
> Just a minor point, but could chol() be changed to include the dimnames of
> the original matrix?  This will ensure that x and t(R) %*% R have the same
> dimnames, where R <- chol(x).  So we just need to insert
> 
>     if (!is.null(dx <- dimnames(x))) 
>         dimnames(z$v) <- dx
> 
> ahead of the return.  Cheers, Jonathan.

This is a picky comment, but maybe we should try to get this spot on.

(i) Suppose that the row and column names of x are different? Which should
one use?

(ii) I don't think that R has any obvious row names: effectively this is
a linear transformation to a different and unamed basis for the space.

I believe all one actually knows is that the colnames of R should be the
colnames of x, if the row and column names of x match. However, the 
prototype does preserve the names.  Should we just preserve the colnames?


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Sep 27 13:03:52 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Sep 1999 14:03:52 +0200
Subject: chol() dimnames
In-Reply-To: Prof Brian Ripley's message of "Mon, 27 Sep 1999 12:25:05 +0100 (BST)"
References: <199909271125.MAA07858@toucan.stats.ox.ac.uk>
Message-ID: <x2905s8st3.fsf@blueberry.kubism.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> I believe all one actually knows is that the colnames of R should be the
> colnames of x, if the row and column names of x match. However, the 
> prototype does preserve the names.  Should we just preserve the colnames?

That would make OK sense to me. By assumption X == t(X) so if it doesn't
have the same row and column names, something is wrong anyway and we
can do whatever we please to fix things up.

However: Somewhere in the back of my mind lies a note to the effect
that chol() should really handle the rank-deficient cases better, via
some sort of pivoting. Will this muck things up (possibly not if it
only removes singularities and plugs in rows/cols of zeroes)? I seem to
recall that the current chol() got lme() in trouble. I got as far as
locating the candidate replacement for chol.f on Netlib and then got
away from it.

Currently, we get

> z<-matrix(rnorm(15),3,5)
> x<-t(z)*z
> chol(x)
Error: singular matrix in chol

The prototype (Splus 3.4) handles this a bit better:
> chol(x)
         [,1]      [,2]        [,3]          [,4]          [,5] 
[1,] 1.703739 1.9199843 -0.94401977 -1.129732e+00 -8.387157e-01
[2,] 0.000000 0.7605888  0.08437014  8.385107e-01 -2.259906e-01
[3,] 0.000000 0.0000000  0.86549993  7.381480e-01  5.811783e-01
[4,] 0.000000 0.0000000  0.00000000 -7.771561e-16  1.110223e-16
[5,] 0.000000 0.0000000  0.00000000  0.000000e+00  0.000000e+00
attr(, "rank"):
[1] 3
Warning messages:
  Choleski decomposition not of full rank in: chol(x)

It also allows pivoting, but I don't think we want their algorithm:

> chol(x,piv=T)
         [,1]       [,2]       [,3]          [,4]          [,5] 
[1,] 2.065148 -0.7414994 -0.8465894  1.583980e+00 -8.629924e-01
[2,] 0.000000  1.4051462  0.8172503 -5.339291e-01  3.893657e-01
[3,] 0.000000  0.0000000  0.5126111  3.296278e-01  4.426312e-01
[4,] 0.000000  0.0000000  0.0000000  2.107342e-08  5.268356e-09
[5,] 0.000000  0.0000000  0.0000000  0.000000e+00  7.850462e-17
attr(, "pivot"):
[1] 2 4 3 1 5
attr(, "rank"):
[1] 5
    ^
    !
oops....


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Jonathan Rougier <J.C.Rougier@durham.ac.uk>  Mon Sep 27 13:02:39 1999
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk> (Jonathan Rougier)
Date: Mon, 27 Sep 1999 13:02:39 +0100 (BST)
Subject: chol() dimnames
In-Reply-To: <199909271125.MAA07858@toucan.stats.ox.ac.uk>
Message-ID: <Pine.GSO.3.96.990927122553.382I-100000@laplace>

Hi Brian,

On Mon, 27 Sep 1999, Prof Brian Ripley wrote:

> This is a picky comment, but maybe we should try to get this spot on.

> (i) Suppose that the row and column names of x are different? Which should
> one use?
>
> (ii) I don't think that R has any obvious row names: effectively this is
> a linear transformation to a different and unamed basis for the space.
> 
> I believe all one actually knows is that the colnames of R should be the
> colnames of x, if the row and column names of x match. However, the 
> prototype does preserve the names.  Should we just preserve the colnames?

I think your qualms would be answered if the attribution of dimnames was
only made in the event that x has matching row and column names.  Whether
just the column names should be preserved in this case is a moot point.
But you might imagine a cautious programmer wanting to be sure that the
row names of Q correspond with the row names of some other matrix A in the
calculation t(Q) %*% A.  Preserving the row names doesn't do any harm, and
it might just be helpful.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Mon Sep 27 13:10:26 1999
From: J.C.Rougier@durham.ac.uk (Jonathan Rougier)
Date: Mon, 27 Sep 1999 13:10:26 +0100 (BST)
Subject: chol() dimnames
In-Reply-To: <x2905s8st3.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.3.96.990927130308.382J-100000@laplace>

Hi Peter,

> However: Somewhere in the back of my mind lies a note to the effect
> that chol() should really handle the rank-deficient cases better, via
> some sort of pivoting.

I agree completely.  I have an ugly patch to catch the case where zeros
appear on the diagonal but a pivoting flag to handle the semi-definite
case and more generally to improve the performance of the algorithm would
be a big help.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Mon Sep 27 13:44:15 1999
From: bates@stat.wisc.edu (Douglas Bates)
Date: 27 Sep 1999 07:44:15 -0500
Subject: chol() dimnames
In-Reply-To: Peter Dalgaard BSA's message of "27 Sep 1999 14:03:52 +0200"
References: <199909271125.MAA07858@toucan.stats.ox.ac.uk> <x2905s8st3.fsf@blueberry.kubism.ku.dk>
Message-ID: <6rbtao34o0.fsf@franz.stat.wisc.edu>

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> However: Somewhere in the back of my mind lies a note to the effect
> that chol() should really handle the rank-deficient cases better, via
> some sort of pivoting. Will this muck things up (possibly not if it
> only removes singularities and plugs in rows/cols of zeroes)? I seem to
> recall that the current chol() got lme() in trouble. 

I believe the trouble there was not due to R's chol not handling the
semi-definite case.  (Sorry about the double negative.)  I think it is
because internally chol is called differently than in S.  We have code
like

#ifdef R_S_H
	  F77_CALL(chol)(auxRes, &ncol, &ncol, auxRes, &l);
#else
	  F77_CALL(chol)(auxRes, &ncol, res, &zero, &zero, &l);
#endif /* R_S_H */

in the C code that implements lme.

I believe there is a pivoting option available for the Linpack dchdc
routine but not for the dpodc routine.  (My copy of the manual is at
the office so I can't check this.)  That pivoting is similar to the
pivoting in dqrdc - you specify which columns (and the corresponding
rows in the case of dchdc) are available to be re-ordered and it
re-orders everything in the optimal ordering.  This doesn't work well
for model matrices or quantities derived from model matrices where you
want to keep the columns associated with the same terms adjacent if
possible.

Notice that in your example the diagonal elements of the decomposition
are strictly decreasing after pivoting.  That is what I mean by the
optimal ordering.

> > chol(x,piv=T)
>          [,1]       [,2]       [,3]          [,4]          [,5] 
> [1,] 2.065148 -0.7414994 -0.8465894  1.583980e+00 -8.629924e-01
> [2,] 0.000000  1.4051462  0.8172503 -5.339291e-01  3.893657e-01
> [3,] 0.000000  0.0000000  0.5126111  3.296278e-01  4.426312e-01
> [4,] 0.000000  0.0000000  0.0000000  2.107342e-08  5.268356e-09
> [5,] 0.000000  0.0000000  0.0000000  0.000000e+00  7.850462e-17
> attr(, "pivot"):
> [1] 2 4 3 1 5
> attr(, "rank"):
> [1] 5
>     ^
>     !
> oops....
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Sep 27 14:58:46 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Sep 1999 15:58:46 +0200
Subject: chol() dimnames
In-Reply-To: Douglas Bates's message of "27 Sep 1999 07:44:15 -0500"
References: <199909271125.MAA07858@toucan.stats.ox.ac.uk> <x2905s8st3.fsf@blueberry.kubism.ku.dk> <6rbtao34o0.fsf@franz.stat.wisc.edu>
Message-ID: <x2670w8nhl.fsf@blueberry.kubism.ku.dk>

Douglas Bates <bates@stat.wisc.edu> writes:

> I believe there is a pivoting option available for the Linpack dchdc
> routine but not for the dpodc routine.  (My copy of the manual is at
> the office so I can't check this.)  That pivoting is similar to the
> pivoting in dqrdc - you specify which columns (and the corresponding
> rows in the case of dchdc) are available to be re-ordered and it
> re-orders everything in the optimal ordering.  This doesn't work well
> for model matrices or quantities derived from model matrices where you
> want to keep the columns associated with the same terms adjacent if
> possible.

Exactly, dchdc was the one I had been thinking of too. I don't really
see the problem in the reordering, though. Just put things back in
order afterwards? However, the column locking feature doesn't seem too
useful to me.

> 
> Notice that in your example the diagonal elements of the decomposition
> are strictly decreasing after pivoting.  That is what I mean by the
> optimal ordering. 

Yup. Although there are some obvious scaling issues that makes the
optimality a bit dubious (such as when you change the units on a
regressor from uM to M).

There's a variation of Cholesky where you essentially just put a zero
in the diagonal in case of singularity and proceed with the remainder
of the matrix, but noone seems to implement that.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Sep 27 16:37:57 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 27 Sep 1999 16:37:57 +0100 (BST)
Subject: chol() dimnames
Message-ID: <199909271537.QAA15954@toucan.stats.ox.ac.uk>

> From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> Date: 27 Sep 1999 15:58:46 +0200
> 
> There's a variation of Cholesky where you essentially just put a zero
> in the diagonal in case of singularity and proceed with the remainder
> of the matrix, but noone seems to implement that.

src/appl/uncmin has a choldc that is some variation of that sort.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From caves@yorvic.york.ac.uk  Tue Sep 28 09:30:55 1999
From: caves@yorvic.york.ac.uk (caves@yorvic.york.ac.uk)
Date: Tue, 28 Sep 1999 10:30:55 +0200 (MET DST)
Subject: configure bug with IRIX 6.5 (Makedep) (PR#288)
Message-ID: <199909280830.KAA07916@pubhealth.ku.dk>

Full_Name: Leo Caves
Version: 0.65.0
OS: SGI/IRIX 6.5
Submission from: (NULL) (144.32.72.76)


using default configure under SGI/IRIX 6.5.
(I switched to gnumake, after initial problems, this might not be necesssary).

the make rule for creating dependencies is wrong for the SGI C compiler.
The rule assumes that cc -M file.c -o file.d works (it doesn't).
One needs to explicitly capture stdout to grab the dependencies:
i.e. cc -M file.c > file.d

simple as that.

when I run tests, there are 2 errors reported

1/ in print-tests.R
(printing *very* small numbers with the statement:)
> cat("dig|  formatC(signif(txn, d=dig)\n")
dig|  formatC(signif(txn, d=dig)
> for(dig in 1:14)#15: Linux 2.1.120, libc-2.0.7 differs from Debian 2.0
+     cat(formatC(dig,w=2), formatC(signif(txn, d=dig), dig=dig+2,
wid=-20),"\n")

Where the blessed version has 0 (zero), the SGI version shows 2.e-308

This looks pretty benign and is flagged in the test script as dependent on
specific libraries etc under linux.

2/ in simple-tests.R
(comparing numbers at limit of word precision)
abs(1- .Machine$double.xmax * 10^(-.Machine$double.max.exp*log10(2)))/Meps <
1e3

This statement returns F instead of T.

This may have effects in pathological cases, but doesn't seem to be a
show-stopper.

So, it looks like a kosher build under SGI/IRIX 6.5.

*Many thanks* for a great system.
Leo
(vanilla AT&T S user since 1991)



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Sep 28 15:44:52 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue, 28 Sep 1999 16:44:52 +0200 (MET DST)
Subject: Collating sequences are used inconsistently. (PR#289)
Message-ID: <199909281444.QAA14157@pubhealth.ku.dk>

R 0.65.0 (and all others I have seen), Solaris 2.6.

> sort(c("a", "A", "b", "B"))
[1] "A" "a" "B" "b"
> "a" < "B"
[1] FALSE

in the en_UK locale. I don't think it is good idea that sort and <
have a different idea of ordering, so I rate this as a bug. As far as I can
see sort uses strcoll and hence the locale, and < uses ASCII.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Sep 28 16:13:17 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Sep 1999 17:13:17 +0200
Subject: Collating sequences are used inconsistently. (PR#289)
In-Reply-To: ripley@stats.ox.ac.uk's message of "Tue, 28 Sep 1999 16:44:52 +0200 (MET DST)"
References: <199909281444.QAA14157@pubhealth.ku.dk>
Message-ID: <x2905rt6gi.fsf@blueberry.kubism.ku.dk>

ripley@stats.ox.ac.uk writes:

> R 0.65.0 (and all others I have seen), Solaris 2.6.
> 
> > sort(c("a", "A", "b", "B"))
> [1] "A" "a" "B" "b"
> > "a" < "B"
> [1] FALSE
> 
> in the en_UK locale. I don't think it is good idea that sort and <
> have a different idea of ordering, so I rate this as a bug. As far as I can
> see sort uses strcoll and hence the locale, and < uses ASCII.

Agreed. I did a i quick runover of all uses of strcmp in the code, and it
seems that the sign only gets used in two files, relop.c (4 times)
and in gnuwin32/dynload.c. The latter one is in a binary search of the
symbol table, which I'll assume is in ASCII order...

I'll make the changes to relop.c if you haven't done so already.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Tue Sep 28 17:23:24 1999
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Tue, 28 Sep 1999 18:23:24 +0200
Subject: read.fwf, perl on win
Message-ID: <37F0EB7C.560D18AC@univie.ac.at>

i just used read.fwf
(which calls perl)
and i noticed something.

i also have mat;lab installed on this machine,
and matlab also installs a version of perl,
but a different one.
additionally, matlab puts its bin directory in the system
path. so, if one does not canerully set the path,
r will call the matlab verion of perl,
and things won't work.

if anybody is collection a list of pitfalls,
this probably should go there.


--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Sep 28 18:19:54 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 28 Sep 1999 18:19:54 +0100 (BST)
Subject: read.fwf, perl on win
In-Reply-To: <37F0EB7C.560D18AC@univie.ac.at>
Message-ID: <Pine.GSO.4.05.9909281813250.28124-100000@auk.stats>

On Tue, 28 Sep 1999, Erich Neuwirth wrote:

> i just used read.fwf
> (which calls perl)
> and i noticed something.
> 
> i also have mat;lab installed on this machine,
> and matlab also installs a version of perl,
> but a different one.
> additionally, matlab puts its bin directory in the system
> path. so, if one does not canerully set the path,
> r will call the matlab verion of perl,
> and things won't work.

That's horrible! There is an official current Perl, and that
works for R, so I presume that Matlab has an outdated one (Perl 4 ?)
Do you know what version Matlab uses?

One thing we can do is to put a require 5.001; or whatever in the
script.

This will apply on binary Unix distributions too, I assume.

> if anybody is collection a list of pitfalls,
> this probably should go there.

With n packages there seem to be n^2 interactions.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Tue Sep 28 21:14:09 1999
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Tue, 28 Sep 1999 22:14:09 +0200
Subject: read.fwf, perl on win
References: <Pine.GSO.4.05.9909281813250.28124-100000@auk.stats>
Message-ID: <37F12191.187930C5@univie.ac.at>

here is the version information.
one of the problems i noticed is that
libraries seem to be different.
i had an error because
perl called 
getopt.pl,
and the library module was called
getopts.pl

since i changed my path so the official perl
from www.perl.org is found first,
things work.



-=-=-=-=-=-=-=-
This is perl, version 5.003_07

Copyright 1987-1996, Larry Wall

        + suidperl security patch
        Win32 port Copyright (c) 1995-1996 Microsoft Corporation.
                All rights reserved.
        Developed by ActiveWare Internet Corp.,
http://www.ActiveWare.com

Perl for Win32 Build 307 - Built 10:11:54 Jul 15 1997

Perl may be copied only under the terms of either the Artistic License
or the
GNU General Public License, which may be found in the Perl 5.0 source
kit.


Prof Brian D Ripley wrote:
> 
> On Tue, 28 Sep 1999, Erich Neuwirth wrote:
> 
> > i just used read.fwf
> > (which calls perl)
> > and i noticed something.
> >
> > i also have mat;lab installed on this machine,
> > and matlab also installs a version of perl,
> > but a different one.
> > additionally, matlab puts its bin directory in the system
> > path. so, if one does not canerully set the path,
> > r will call the matlab verion of perl,
> > and things won't work.
> 
> That's horrible! There is an official current Perl, and that
> works for R, so I presume that Matlab has an outdated one (Perl 4 ?)
> Do you know what version Matlab uses?
> 
> One thing we can do is to put a require 5.001; or whatever in the
> script.
> 
> This will apply on binary Unix distributions too, I assume.
> 
> > if anybody is collection a list of pitfalls,
> > this probably should go there.
> 
> With n packages there seem to be n^2 interactions.
> 
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Wed Sep 29 08:13:58 1999
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Wed, 29 Sep 1999 09:13:58 +0200
Subject: date() in win version
Message-ID: <37F1BC36.37505F29@univie.ac.at>

when i do 
print(date())

the output is
[1] "Wed Sep 29 09:13:04 1999\n"

ios it on purpose the the linfeed is
shown as abbreviation and not done?


--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Sep 29 08:33:57 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 29 Sep 1999 09:33:57 +0200
Subject: date() in win version
In-Reply-To: <37F1BC36.37505F29@univie.ac.at> (message from Erich Neuwirth on
 Wed, 29 Sep 1999 09:13:58 +0200)
References: <37F1BC36.37505F29@univie.ac.at>
Message-ID: <199909290733.JAA04955@sophie.ethz.ch>

>>>>> Erich Neuwirth <erich.neuwirth@univie.ac.at> said:

    Erich> when i do print(date())

    Erich> the output is [1] "Wed Sep 29 09:13:04 1999\n"

    Erich> is it on purpose that the linefeed is shown as abbreviation and
    Erich> not done?

it's not on purpose;  it is a bug that has been fixed even in 0.65.0

Btw, print(.) itself adds a new line;
 but then, why use print() at all?  it is *the default function* 
 { as long as the object hasn't been  invisible()ized },
i.e.
	date()

should be what you want (once you use 0.65.0 or newer..)

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Sep 29 14:57:09 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 29 Sep 1999 15:57:09 +0200
Subject: getenv() can't differentiate  "defined but empty" and "undefined"
Message-ID: <199909291357.PAA15567@sophie.ethz.ch>

getenv(<varname>)  currently returns  ""
if the <varname> is undefined.

However, if <varname> is defined but empty,
getenv(<varname>) still only returns "".

I think this is quite unfortunate  
but consistent with the prototype.

---
I'd propose to change the current behavior.
Something which should be pretty back compatible would 
for the first case (undefined environment variable)
to return "" with an attribute "defined" set to FALSE
i.e.  return(structure("", defined = FALSE))

Does anyone see a problem with this approach ?

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Sep 29 15:52:35 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 29 Sep 1999 15:52:35 +0100 (BST)
Subject: getenv() can't differentiate  "defined but empty" and "undefined"
In-Reply-To: <199909291357.PAA15567@sophie.ethz.ch>
Message-ID: <Pine.GSO.4.05.9909291546210.13114-100000@auk.stats>

On Wed, 29 Sep 1999, Martin Maechler wrote:

> getenv(<varname>)  currently returns  ""
> if the <varname> is undefined.
> 
> However, if <varname> is defined but empty,
> getenv(<varname>) still only returns "".
> 
> I think this is quite unfortunate  
> but consistent with the prototype.
> 
> ---
> I'd propose to change the current behavior.
> Something which should be pretty back compatible would 
> for the first case (undefined environment variable)
> to return "" with an attribute "defined" set to FALSE
> i.e.  return(structure("", defined = FALSE))
> 
> Does anyone see a problem with this approach ?

I think it should really be NULL if undefined: attributes which may or may
not be there are a nuisance.  The only problem I can see is in
system.gnw.r, whihc doe use nchar on getenv.

Small point: when do you want to change this? It is platform-specific code.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Sep 29 16:52:17 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 29 Sep 1999 17:52:17 +0200
Subject: getenv() can't differentiate  "defined but empty" and "undefined"
In-Reply-To: <Pine.GSO.4.05.9909291546210.13114-100000@auk.stats> (message
 from Prof Brian D Ripley on Wed, 29 Sep 1999 15:52:35 +0100 (BST))
References: <Pine.GSO.4.05.9909291546210.13114-100000@auk.stats>
Message-ID: <199909291552.RAA15706@sophie.ethz.ch>

>>>>> On Wed, 29 Sep 1999 Prof Brian D Ripley <ripley@stats.ox.ac.uk> said:

    BDR> On Wed, 29 Sep 1999, Martin Maechler wrote:
    >> getenv(<varname>) currently returns "" if the <varname> is
    >> undefined.
    >> 
    >> However, if <varname> is defined but empty, getenv(<varname>) still
    >> only returns "".
    >> 
    >> I think this is quite unfortunate but consistent with the prototype.
    >> 
    >> ---
    >> I'd propose to change the current behavior.  Something which should
    >> be pretty back compatible would for the first case (undefined
    >> environment variable) to return "" with an attribute "defined" set
    >> to FALSE i.e.  return(structure("", defined = FALSE))
    >> 
    >> Does anyone see a problem with this approach ?

    BDR> I think it should really be NULL if undefined: attributes which
    BDR> may or may not be there are a nuisance. 

that was my first thought, as well, however ...

    BDR> The only problem I can
    BDR> see is in system.gnw.r, whihc doe use nchar on getenv.

and all the user code from S and R which assumes that getenv() returns 
a character() as it is documented !

    BDR> Small point: when do you want to change this? It is
    BDR> platform-specific code.

 (why does this need to be specific? 
   -- yes I was too lazy to study the code ..)

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Thu Sep 30 02:36:11 1999
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Thu, 30 Sep 1999 03:36:11 +0200
Subject: perl on win32, again
Message-ID: <37F2BE8B.790ADD8C@univie.ac.at>

i downloaded the latest release of perl for win (just a few days old)
and it now has a smarter installation routine.
it puts itself in front of all other dirs (in path),
and it als tells that it tries to remove any other path leading
to another perl.
well,
the offending matlab perl lives in
\matlabr11\bin
and this path also contains the whole matlab stuff,
so it cannot be removed.
but with official perl before matylab in the path,
things now work without fiddling
with the path.


--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgutwin@us.ibm.com  Thu Sep 30 20:18:51 1999
From: pgutwin@us.ibm.com (pgutwin@us.ibm.com)
Date: Thu, 30 Sep 1999 21:18:51 +0200 (MET DST)
Subject: Error compiling R on RS6000 (PR#290)
Message-ID: <199909301918.VAA06212@pubhealth.ku.dk>

Full_Name: Paul Gutwin
Version: 65.0
OS: AIX
Submission from: (NULL) (198.133.22.69)


I get an error when I try to compile R on an RS6000. I ran configure, then make,
and received the following:


.....(stuff deleted)....
	ld -bdynamic -bE:../../etc/R.exp -bM:SRE -lc -lm
/usr/prod/contrib/lib/gcc-lib/rs6000-ibm-aix4.1.4/2.8.1/libgcc.a  -o
../../bin/R.X11 arithmetic.o array.o attrib.o bind.o builtin.o character.o
coerce.o colors.o complex.o context.o cov.o cum.o debug.o devPS.o devPicTeX.o
deparse.o deriv.o devices.o dotcode.o dstruct.o duplicate.o envir.o errors.o
eval.o format.o fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o
main.o match.o memory.o model.o names.o objects.o optimize.o options.o par.o
paste.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o printvector.o
printutils.o random.o relop.o saveload.o scan.o seq.o sort.o source.o split.o
subassign.o subscript.o subset.o summary.o unique.o util.o version.o
./unix/libunix.a ../appl/libappl.a ../nmath/libmath.a  -lX11  -lblas  -lxlf90
-lxlf -lm /lib/crt0.o -lz -ldl -lncurses -lm 
ld: 0706-006 Cannot find or open library file: -l z
	ld:open(): A file or directory in the path name does not exist.
ld: 0706-006 Cannot find or open library file: -l ncurses
	ld:open(): A file or directory in the path name does not exist.
make: 1254-004 The error code from the last command is 255.


Stop.
make: 1254-004 The error code from the last command is 2.


Stop.
make: 1254-004 The error code from the last command is 1.


Stop.
make: 1254-004 The error code from the last command is 1.


Stop.

Compilation exited abnormally with code 2 at Thu Sep 30 15:09:00


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Thu Sep 30 22:21:13 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Thu, 30 Sep 1999 17:21:13 -0400
Subject: Error compiling R on RS6000 (PR#290)
In-Reply-To: Your message of "Thu, 30 Sep 1999 21:18:51 EDT."
 <199909301918.VAA06212@pubhealth.ku.dk>
Message-ID: <199909302121.RAA22750@infiniti.ece.cmu.edu>


Paul,

  do you have the output from configure?  What probably happens is
that the libs libz.a and libncurses.a get picked up erroneously in the
configure stage.  For a quick fix, could you check whether R compiles
cleanly after adding in config.site:

LIBS="-L/usr/local/lib -lreadline -lcurses"

(Replacing /usr/prod/contrib/lib with the path to the directory where
you find libreadline.a on your system.  Other candidates are /usr/lib or
/usr/prod/contrib/lib.)

  -tom

P.S. which version of AIX are using?

"PG" == pgutwin  <pgutwin@us.ibm.com> writes:

PG> Full_Name: Paul Gutwin
PG> Version: 65.0
PG> OS: AIX
PG> Submission from: (NULL) (198.133.22.69)
PG> 
PG> 
PG> I get an error when I try to compile R on an RS6000. I ran configure, then make,
PG> and received the following:
PG> 
[snip]

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lyndon@stat.auckland.ac.nz  Wed Sep  1 08:51:34 1999
From: lyndon@stat.auckland.ac.nz (Lyndon Drake)
Date: Wed, 1 Sep 1999 19:51:34 +1200
Subject: [R] R --gnome segfaults on RH 6.0 with R-0.65.0
In-Reply-To: <x2yaes7zh8.fsf@blueberry.kubism.ku.dk>; from Peter Dalgaard BSA on Tue, Aug 31, 1999 at 05:15:47PM +0200
References: <XFMail.990831164030.awol@xs4all.nl> <x2yaes7zh8.fsf@blueberry.kubism.ku.dk>
Message-ID: <19990901195134.A12088@stat1.stat.auckland.ac.nz>

On Tue, Aug 31, 1999 at 05:15:47PM +0200, Peter Dalgaard BSA wrote:
> Alexander Volovics <awol@xs4all.nl> writes:
> 
> What would interest me is what the content of R_gnome_userprefs.font
> if you go up to #40 (in R_gtk_terminal_new () at terminal.c:112). Just
> type 
> 
> p R_gnome_userprefs.font
> 
> if it's NULL, then we might have a lead on the problem. But Lyndon
> Drake is the guy who knows his way around the Gnome stuff, not me.
> 

Sorry for being so slow to get onto this, but Uni has been a bit busy
lately.  This is probably a problem with the preferences (which are
totally broken right now, but the replacement preferences system should
get committed to CVS next week).  I'll check it out soon...

-- 
Lyndon Drake                       | Desktop:      http://www.gnome.org
isenguard                          | Mail client:  http://www.mutt.org
ICQ#: 12558803                     | Editor:       http://www.vim.org
http://stat.auckland.ac.nz/~lyndon | OS:           http://www.linux.com
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plindsey@alpha.luc.ac.be  Wed Sep  1 10:33:57 1999
From: plindsey@alpha.luc.ac.be (Patrick Lindsey)
Date: Wed, 1 Sep 1999 11:33:57 +0200 (MET DST)
Subject: Problems compiling R65.0.
Message-ID: <199909010933.LAA27167@alpha.luc.ac.be>

Hi,
I appear to have a slight problem compiling R0.65.0 under Linux
(slackware) using g77. By simply typing configure then make, I obtain
a binary which when "ldd" does not contain the f2c library. I
therefore cannot load any libraries containing fortran code (I obtain
unresolved symbol messages from R.X11 and an unable to load shared
library from dyn.load(file)).
If I change the "-lf2c" flag on the FLIBS line of the Makeconf to
"-L/usr/lib/libf2c", I then obtain the following error when R.X11 is
being created:

gcc -export-dynamic  -o ../../bin/R.X11 arithmetic.o array.o attrib.o bind.o builtin.o character.o coerce.o colors.o complex.o context.o cov.o cum.o debug.o devPS.o devPicTeX.o deparse.o deriv.o devices.o dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o main.o match.o memory.o model.o names.o objects.o optimize.o options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o printvector.o printutils.o random.o relop.o saveload.o scan.o seq.o sort.o source.o split.o subassign.o subscript.o subset.o summary.o unique.o util.o version.o ../unix/libunix.a ../appl/libappl.a ../nmath/libmath.a -lSM -lICE -L/usr/X11R6/lib -lX11  -L/usr/lib/libf2c -lm -L/usr/lib/gcc-lib/i486-unknown-linux-gnulibc1/2.7.2.3 -L/usr/i486-unknown-linux-gnulibc1/lib -lm  -lreadline -lz -ldl -lncurses -lm 
../appl/libappl.a(uncmin.o): In function `optchk_':
/usr/local/src/R/src/appl/uncmin.f:1848: undefined reference to `d_lg10'
make[3]: *** [../../bin/R.X11] Error 1

Does anyone have an idea how I could get my libraries working?
Thank you,
Patrick.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plindsey@alpha.luc.ac.be  Wed Sep  1 10:49:37 1999
From: plindsey@alpha.luc.ac.be (plindsey@alpha.luc.ac.be)
Date: Wed, 1 Sep 1999 11:49:37 +0200 (MET DST)
Subject: Problems compiling R65.0 (PR#262)
Message-ID: <199909010949.LAA03540@pubhealth.ku.dk>

Hi,
I appear to have a slight problem compiling R0.65.0 under Linux
(slackware) using g77. By simply typing configure then make, I obtain
a binary which when "ldd" does not contain the f2c library. I
therefore cannot load any libraries containing fortran code (I obtain
unresolved symbol messages from R.X11 and an unable to load shared
library from dyn.load(file)).
If I change the "-lf2c" flag on the FLIBS line of the Makeconf to
"-L/usr/lib/libf2c", I then obtain the following error when R.X11 is
being created:

gcc -export-dynamic  -o ../../bin/R.X11 arithmetic.o array.o attrib.o bind.o builtin.o character.o coerce.o colors.o complex.o context.o cov.o cum.o debug.o devPS.o devPicTeX.o deparse.o deriv.o devices.o dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o main.o match.o memory.o model.o names.o objects.o optimize.o options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o printvector.o printutils.o random.o relop.o saveload.o scan.o seq.o sort.o source.o split.o subassign.o subscript.o subset.o summary.o unique.o util.o version.o ../unix/libunix.a ../appl/libappl.a ../nmath/libmath.a -lSM -lICE -L/usr/X11R6/lib -lX11  -L/usr/lib/libf2c -lm -L/usr/lib/gcc-lib/i486-unknown-linux-gnulibc1/2.7.2.3 -L/usr/i486-unknown-linux-gnulibc1/lib -lm  -lreadline -lz -ldl -lncurses -lm 
../appl/libappl.a(uncmin.o): In function `optchk_':
/usr/local/src/R/src/appl/uncmin.f:1848: undefined reference to `d_lg10'
make[3]: *** [../../bin/R.X11] Error 1

Does anyone have an idea how I could get my libraries working?
Thank you,
Patrick.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plindsey@alpha.luc.ac.be  Wed Sep  1 10:55:56 1999
From: plindsey@alpha.luc.ac.be (plindsey@alpha.luc.ac.be)
Date: Wed, 1 Sep 1999 11:55:56 +0200 (MET DST)
Subject: Problems sourcing functions with R65.0 (PR#263)
Message-ID: <199909010955.LAA03720@pubhealth.ku.dk>

Hi,
Sorry for cross-posting the last error message.
I have encountered some more strange problems when loading another of my
libraries. I get a parsing error ("syntax error on line 1707"). I have
carefully looked at my code and there are no syntax errors. In fact, on
R64.1 this function was parsed in properly when the library was loaded
(I just copied the library from one version to another without making any
changes).
I saved my function which is 1734 lines long (all one function) and it appears
that source will not parse a function with more than 1707 lines. Even more
puzzling, if I copy the function and paste it right at the R prompt, the
function does not yield any parsing problem... Would there therefore be a
buffer limit problems of some kind for sourcing files??? If so how can I
modify it??
Thank you,
Patrick.


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Sep  1 11:18:15 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 01 Sep 1999 12:18:15 +0200
Subject: Problems compiling R65.0 (PR#262)
In-Reply-To: plindsey@alpha.luc.ac.be's message of "Wed, 1 Sep 1999 11:49:37 +0200 (MET DST)"
References: <199909010949.LAA03540@pubhealth.ku.dk>
Message-ID: <x21zcjdjfc.fsf@blueberry.kubism.ku.dk>

plindsey@alpha.luc.ac.be writes:

> Hi,
> I appear to have a slight problem compiling R0.65.0 under Linux
> (slackware) using g77. By simply typing configure then make, I obtain
> a binary which when "ldd" does not contain the f2c library. I
> therefore cannot load any libraries containing fortran code (I obtain
> unresolved symbol messages from R.X11 and an unable to load shared
> library from dyn.load(file)).

Yes, this is a bit of a pain. The issue is that libf2c is not a
dynamic library on all systems, and hence does not show on ldd, and
only the routines that are actually used by R get loaded into the
binary. 

What should happen in that case is that R SHLIB/INSTALL would generate
so files with the relevant Fortran linked in, e.g. if that doesn't
happen for you, there's a bug in the configure script. With egsc/g77 I
get the following:

# R INSTALL multiv
Installing package `multiv' ...
 libs
g77  -fPIC -g -O2 -c bea.f -o bea.o
g77  -fPIC -g -O2 -c ca.f -o ca.o
g77  -fPIC -g -O2 -c hc.f -o hc.o
g77  -fPIC -g -O2 -c hcmovie.f -o hcmovie.o
g77  -fPIC -g -O2 -c members.f -o members.o
g77  -fPIC -g -O2 -c partition.f -o partition.o
g77  -fPIC -g -O2 -c pca.f -o pca.o
g77  -fPIC -g -O2 -c sammon.f -o sammon.o
gcc -shared  -o /usr/local/lib/R/library/multiv/libs/multiv.so bea.o ca.o hc.o hcmovie.o members.o partition.o pca.o sammon.o -L/usr/lib/gcc-lib/i386-redhat-linux/egcs-2.91.66 -L/usr/i386-redhat-linux/lib -lg2c -lm

# R SHLIB ca.f 
gcc -shared  -o ca.so ca.o -L/usr/lib/gcc-lib/i386-redhat-linux/egcs-2.91.66 -L/usr/i386-redhat-linux/lib -lg2c -lm



> If I change the "-lf2c" flag on the FLIBS line of the Makeconf to
> "-L/usr/lib/libf2c", I then obtain the following error when R.X11 is
> being created:

That couldn't possibly work. '-L' specifies a directory to search, so
you get the same effect as if you had just removed -lf2c.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Jonathan Rougier <J.C.Rougier@durham.ac.uk>  Wed Sep  1 14:14:18 1999
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk> (Jonathan Rougier)
Date: Wed, 1 Sep 1999 14:14:18 +0100 (BST)
Subject: diag()
Message-ID: <Pine.GSO.3.96.990901140456.19209D-100000@laplace>

Hi Martin,

Just to follow my previous suggestion to modify diag(), the code I
suggested is vulnerable to matrices with dimnames(x) <- list(NULL, NULL),
which does occasionally happen (it has just happened to me!), so the
following would be better ...

"diag" <-
function (x = 1, nrow, ncol = n) 
{
    if (is.matrix(x) && nargs() == 1) {
        md <- min(dim(x))
        y <- c(x)[1 + 0:(md - 1) * (dim(x)[1] + 1)]
        nms <- dimnames(x)
        if (is.list(nms) && !any(sapply(nms, is.null)) &&
          all(nms[[1]][1:md] == nms[[2]][1:md])) 
            names(y) <- nms[[1]][1:md]
        return(y)
    }

... the rest as in the original function.  Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Sep  1 21:13:09 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 1 Sep 1999 22:13:09 +0200
Subject: diag()
In-Reply-To: <Pine.GSO.3.96.990901140456.19209D-100000@laplace> (message from
 Jonathan Rougier on Wed, 1 Sep 1999 14:14:18 +0100 (BST))
References: <Pine.GSO.3.96.990901140456.19209D-100000@laplace>
Message-ID: <199909012013.WAA14572@sophie.ethz.ch>

>>>>> On Wed, 1 Sep 1999 14:14:18 +0100 (BST), Jonathan Rougier <J.C.Rougier@durham.ac.uk> said:

    JonR> Just to follow my previous suggestion to modify diag(), the code
    JonR> I suggested is vulnerable to matrices with dimnames(x) <-
    JonR> list(NULL, NULL), which does occasionally happen (it has just
    JonR> happened to me!), so the following would be better ...

    JonR> "diag" <-
    JonR> function (x = 1, nrow, ncol = n) 
    JonR> {
    JonR>   if (is.matrix(x) && nargs() == 1) {
    JonR>     md <- min(dim(x))
    JonR>     y <- c(x)[1 + 0:(md - 1) * (dim(x)[1] + 1)]
    JonR>     nms <- dimnames(x)
    JonR>     if (is.list(nms) && !any(sapply(nms, is.null)) &&
    JonR>         all(nms[[1]][1:md] == nms[[2]][1:md])) 
    JonR>         names(y) <- nms[[1]][1:md]
    JonR>     return(y)
    JonR>   }

    JonR> ... the rest as in the original function.  Cheers, Jonathan.

    JonR> Jonathan Rougier                       Science Laboratories
    JonR> Department of Mathematical Sciences    South Road
    JonR> University of Durham                   Durham DH1 3LE

Your proposal has been (slightly improved) and commited for 0.64.1 
(or tomorrow's snapshot of R-release).

NEWS has
     
    o	diag(x) now keeps names when appropriate and barfs when x is an array.


Thank you very much.	Martin



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Sep  1 22:09:33 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 01 Sep 1999 23:09:33 +0200
Subject: diag()
In-Reply-To: Martin Maechler's message of "Wed, 1 Sep 1999 22:13:09 +0200"
References: <Pine.GSO.3.96.990901140456.19209D-100000@laplace> <199909012013.WAA14572@sophie.ethz.ch>
Message-ID: <x2n1v67302.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> Your proposal has been (slightly improved) and commited for 0.64.1 
                                                                 ^
Um...

> NEWS has
>      
>     o	diag(x) now keeps names when appropriate and barfs when x is an array.

- unless it's of dimension 2, you mean. But is this really desirable
for the 1d case? diag(array(1:9)) used to work like diag(1:9), but is
now an error. E.g. the output of table() can be a 1d array.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Thu Sep  2 11:23:53 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Thu, 2 Sep 1999 12:23:53 +0200 (MET DST)
Subject: R 0.65.x bug :  attach()/eval() {was "lib.source() within library()"} (PR#264)
Message-ID: <199909021023.MAA15071@pubhealth.ku.dk>

In 0.65.0  lib.source() within library()  works differently
and fails to correctly "load" a library when it wants to change an object
that it has defined previously:

Below is a very short shar file that produces a "minimal" example [no
attachment, just appended].
To reproduce  {read on, before doing it!}  do

   sh < libBug.shar <<<<< the file name you gave
   R INSTALL libBug

   echo 'library(libBug)' | R --vanilla --quiet

which gives

    Error: attempt to set an attribute on NULL
    Execution halted

----

The only R code in the whole library is in  libBug/R/only.R

    bla <- pi
    names(bla) <- "N"

However, with help of debug(library) 
and *inside* library  debug(lib.source)

I can now reproduce the problem  without needing library() directly:

    env   <- attach(NULL, name = "libBug")
    exprs <- expression(bla <- pi, names(bla) <- "N")
    for (i in exprs) yy <- eval(i, env)

    ##-> Error: attempt to set an attribute on NULL

and replacing the last line by

    for (i in exprs){ yy <- eval(i,env);print(ls(env=env))
		      cat("bla:",get("bla",env=env),"\n") }
gives

    [1] "*tmp*" "bla"  
    bla: 3.14159265358979 
    Error: attempt to set an attribute on NULL

-----

#!/bin/sh
# This is a shell archive (produced by GNU sharutils 4.2).
# To extract the files from this archive, save it to some FILE, remove
# everything before the `!/bin/sh' line above, then type `sh FILE'.
#
# Made on 1999-09-02 12:00 MET DST by <maechler@sophie>.
# Source directory was `/users/u1/staff/maechler/R'.
#
# Existing files will *not* be overwritten unless `-c' is specified.
# This format requires very little intelligence at unshar time.
# "if test", "echo", "mkdir", and "sed" may be needed.
#
# This shar contains:
# length mode       name
# ------ ---------- ------------------------------------------
#     28 -rw-r--r-- libBug/R/only.R
#     47 -rw-r--r-- libBug/TITLE
#
echo=echo
if mkdir _sh21127; then
  $echo 'x -' 'creating lock directory'
else
  $echo 'failed to create lock directory'
  exit 1
fi
# ============= libBug/R/only.R ==============
if test ! -d 'libBug'; then
  $echo 'x -' 'creating directory' 'libBug'
  mkdir 'libBug'
fi
if test ! -d 'libBug/R'; then
  $echo 'x -' 'creating directory' 'libBug/R'
  mkdir 'libBug/R'
fi
if test -f 'libBug/R/only.R' && test "$first_param" != -c; then
  $echo 'x -' SKIPPING 'libBug/R/only.R' '(file already exists)'
else
  $echo 'x -' extracting 'libBug/R/only.R' '(text)'
  sed 's/^X//' << 'SHAR_EOF' > 'libBug/R/only.R' &&
Xbla <- pi
Xnames(bla) <- "N"
SHAR_EOF
  : || $echo 'restore of' 'libBug/R/only.R' 'failed'
fi
# ============= libBug/TITLE ==============
if test -f 'libBug/TITLE' && test "$first_param" != -c; then
  $echo 'x -' SKIPPING 'libBug/TITLE' '(file already exists)'
else
  $echo 'x -' extracting 'libBug/TITLE' '(text)'
  sed 's/^X//' << 'SHAR_EOF' > 'libBug/TITLE' &&
XlibBug	Simple Package to show lib.source() bug
SHAR_EOF
  : || $echo 'restore of' 'libBug/TITLE' 'failed'
fi
rm -fr _sh21127
exit 0

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From gautier@lion-ag.de  Thu Sep  2 16:40:48 1999
From: gautier@lion-ag.de (gautier@lion-ag.de)
Date: Thu, 2 Sep 1999 17:40:48 +0200 (MET DST)
Subject: trouble with the 'exclude' parameter of factor() (PR#265)
Message-ID: <199909021540.RAA19224@pubhealth.ku.dk>

Full_Name: Laurent Gautier
Version: 0.65.0
OS: Irix 6.5
Submission from: (NULL) (195.110.4.98)


the following doesn't give what I expect

> test _ factor(ORGMORE[[1]],exclude=c(NA,"NOM"))
Warning message: 
NAs introduced by coercion 
> levels(test)
[1] "CYT" "EXC" "MEM" "NOM" "NUC" "SEC"


while this works...

> test _ factor(ORGMORE[[1]],levels=c("CYT","EXEC","MEM","NUC","SEC"),exclude=NA)
> levels(test)
[1] "CYT"  "EXEC" "MEM"  "NUC"  "SEC" 


All apologies if I misunderstood the help page for the factor() function and
this is not strange...
(I mean the results obtained, not my understanding of the help pages  =)    ).



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Sep  2 18:55:14 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 2 Sep 1999 19:55:14 +0200 (MET DST)
Subject: trouble with the 'exclude' parameter of factor() (PR#265)
Message-ID: <199909021755.TAA19894@pubhealth.ku.dk>

On Thu, 2 Sep 1999 gautier@lion-ag.de wrote:

> Full_Name: Laurent Gautier
> Version: 0.65.0
> OS: Irix 6.5
> Submission from: (NULL) (195.110.4.98)
> 
> 
> the following doesn't give what I expect
> 
> > test _ factor(ORGMORE[[1]],exclude=c(NA,"NOM"))
> Warning message: 
> NAs introduced by coercion 
> > levels(test)
> [1] "CYT" "EXC" "MEM" "NOM" "NUC" "SEC"

For another posting of yours, I assume the x argument is a factor.
Now ?factor is missing an arguments section, but if x is a factor,
exclude has to be a factor too (with the same set of levels plus perhaps
NA), or coercible to factor codes.  So please try

factor(as.character(ORGMORE[[1]]), exclude=c(NA,"NOM"))

> while this works...
> 
> > test _ factor(ORGMORE[[1]],levels=c("CYT","EXEC","MEM","NUC","SEC"),exclude=NA)
> > levels(test)
> [1] "CYT"  "EXEC" "MEM"  "NUC"  "SEC" 
> 
> 
> All apologies if I misunderstood the help page for the factor() function and
> this is not strange...
> (I mean the results obtained, not my understanding of the help pages  =)    ).

We definitely need to document the arguments, probably make this 
friendlier.

PS: as Irix 6.5 is not in the PLATFORMS list, please do us a favour and
submit a PLATFORMS report.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Richard.Beare@cmis.csiro.au  Fri Sep  3 04:29:11 1999
From: Richard.Beare@cmis.csiro.au (Richard Beare)
Date: Fri, 03 Sep 1999 13:29:11 +1000
Subject: recent R versions on alpha-osf-4
Message-ID: <37CF4087.1032CE97@cmis.csiro.au>

Hello,
I'm keen to get R working on the alpha, but haven't managed to build
anything that gets past the "make test" stage. There used to be some
documentation about -mieee_ type changes, but I never had any luck with
these. I'd like to build my own version because I don't have root access
to install the binary version.

Has anyone else had any luck with this? I can't see anything suggesting
ways to go in the documents with R-0.65.

Thanks

-- 
Richard Beare
Richard.Beare@cmis.csiro.au
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Sep  3 23:43:55 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Sat, 4 Sep 1999 00:43:55 +0200
Subject: diag()
In-Reply-To: <x2n1v67302.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 01 Sep 1999 23:09:33 +0200)
References: <Pine.GSO.3.96.990901140456.19209D-100000@laplace> <199909012013.WAA14572@sophie.ethz.ch> <x2n1v67302.fsf@blueberry.kubism.ku.dk>
Message-ID: <199909032243.AAA03262@sophie.ethz.ch>


    PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:
    >> Your proposal has been (slightly improved) and commited for 0.64.1
    PD>                                                                  ^
    PD> Um...

    >> NEWS has
    >> 
    >> o diag(x) now keeps names when appropriate and barfs when x is an
    >> array.

    PD> - unless it's of dimension 2, you mean.
yes..
    PD> But is this really
    PD> desirable for the 1d case? diag(array(1:9)) used to work like
    PD> diag(1:9), but is now an error. E.g. the output of table() can be a
    PD> 1d array.

I know.  
But I think that people may expect something else from diag(<array>).
I don't mind letting the 1D case still go by, but certainly not d >= 3 !

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Sep  5 23:00:49 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Mon, 6 Sep 1999 00:00:49 +0200 (MET DST)
Subject: [R] data frame component replacement: feature or bug? (PR#266)
Message-ID: <199909052200.AAA08081@pubhealth.ku.dk>

Matthew Wiener <mcw@ln.nimh.nih.gov> writes:

> t1 <- data.frame(matrix(rnorm(16), nc=4))
> t1$X1 <- 1  
> t1$X2 <- 2
> print(t1)
> Error: dim<- length of dims do not match the length of object

Well, it is prototype-compatible. Splus 5.3 does likewise. A way out
is

t1<-data.frame(unclass(t1))

However, we do seem to have a bug in the area:

>  t1 <- data.frame(matrix(rnorm(16), nc=4))
>  transform(t1,X1=1)
Error: dim<- length of dims do not match the length of object
>  transform(t1,X1=1,X2=2)
  X1 X2         X3         X4
1  1  2  0.6020524  1.1595935
2  1  2 -1.8212204 -0.2118746
3  1  2  1.5506706  0.0680275
4  1  2 -0.8872958  0.4709870

This boils down to the construction

dfr[1]<-list(X1=1)

which doesn't extend dfr$X1, whereas

dfr[c(1,2)]<-list(X1=3,X2=4)

does. Splus handles both cases. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Sep  5 23:29:57 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Mon, 6 Sep 1999 00:29:57 +0200 (MET DST)
Subject: [R] data frame component replacement: feature or bug? (PR#266)
Message-ID: <199909052229.AAA08170@pubhealth.ku.dk>

p.dalgaard@biostat.ku.dk writes:

> dfr[1]<-list(X1=1)
> 
> which doesn't extend dfr$X1, whereas
> 
> dfr[c(1,2)]<-list(X1=3,X2=4)
> 
> does. Splus handles both cases. 

Found, fixed, and committed for 0.65.1 (a drop=FALSE was missing where
the replication was done)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mavip5@inet.polyu.edu.hk  Mon Sep  6 02:40:34 1999
From: mavip5@inet.polyu.edu.hk (Li Dongfeng)
Date: Mon, 06 Sep 1999 09:40:34 +0800
Subject: suggestion: postscript paper=user
Message-ID: <37D31B92.7D4C11DA@inet.polyu.edu.hk>

Dear R developers and users,

  I have a suggestion for the postscript device driver.
Now the paer= option only support "a4", "letter",
"legal", "executive". I suggest we add a "user" option
and letter user provide paper size, even like "595x421",
width>height.

For printing purpose, the provided paper size are
nearly enought. But I need to use R to produce
a lot of graphics, and transform these graphics to
PNG format for web publication.  I use ghostscript
to do the transformation, but the default paper size of the
R postscript device is too big, and the orietation
is not correct(we need landscape). I don't know
how to make the image size smaller and
rotating 90 degrees with ghostscript.  I had to
patch the R source(src/unix/devPS.c)  myself
to add a paper size. If R provide a paper="user "
option for the postscript device, things would be
much easier.

Li Dongfeng


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep  6 09:47:10 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 6 Sep 1999 10:47:10 +0200
Subject: Proposal for improved grid()  [non-backward compatible]
Message-ID: <199909060847.KAA01186@sophie.ethz.ch>

Not many of you will use grid() widely, probably.
Also, two months ago, Paul Murrell said on R-help (topic "grid command")

  PM>> i think the abline() solution is the best for doing what grid() won't.  
  PM>> like you say, grid() is just a simple front-end to abline().

grid() *is* too simple to be of practical use.

I propose the following which is of some practical use, 
since it uses much more useful defaults:

    grid <- function (nx=NULL, ny=NULL, col="lightgray", lty="dotted")
    {
	if (is.null(nx)|| nx >= 1) {
	    axp <- par("xaxp")
	    if(is.null(nx)) nx <- axp[3]
	    abline(v = seq(axp[1],axp[2],len=1+nx), col = col, lty = lty)
	}
	if (is.null(ny)|| ny >= 1) {
	    axp <- par("yaxp")
	    if(is.null(ny)) ny <- axp[3]
	    abline(h = seq(axp[1],axp[2],len=1+ny), col = col, lty = lty)
	}
    }

Try e.g.

plot(1:10, panel.first = grid(col="red"))
qqnorm(rnorm(100), panel.first=grid())
plot(1:10, panel.first=grid(ny=4))
plot(1:10, panel.first=grid(ny=0))

-----------

The only "problem":  It's not backwards compatible.
Does anyone have a problem with that?

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Mon Sep  6 10:04:18 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon, 6 Sep 1999 11:04:18 +0200 (MET DST)
Subject: matplot(... panel.first=..) fails  <==> dealing with "..." (PR#267)
Message-ID: <199909060904.LAA12129@pubhealth.ku.dk>

Maybe, the following is not a bug in the strict sense,....

The following code shows what the effect :

  p1 <- function(...) plot.default(...)
  p2 <- function(...) { n <- names(list(...)); plot.default(...) }

  par(mfrow=c(2,2))
  p1(1:10, panel.first = grid(10,10)) # works okay (grid drawn)
  p2(1:10, panel.first = grid(10,10)) # doesn't draw the grid

A consequence of this is that the panel.first argument (of plot.default)
doesn't work with matplot()
	[well, matplot()'s doc doesn't claim it should, but still

-------
The real questions behind are:

1a) Why is "..." changed at the moment that I do  list(...)
1b) is this basic behavior desirable / changeable ....

2) How can one work around? 
   {save "..." to something else, first? 
    or explicitly save panel.first?}

-----------------------------

R versions,  both 0.64.2 and 0.65.0  (probably all R versions)

Version:
 platform = sparc-sun-solaris2.5
 arch = sparc
 os = solaris2.5
 system = sparc, solaris2.5
 status =
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

--
Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Sep  6 13:25:30 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 Sep 1999 14:25:30 +0200
Subject: matplot(... panel.first=..) fails  <==> dealing with "..." (PR#267)
In-Reply-To: maechler@stat.math.ethz.ch's message of "Mon, 6 Sep 1999 11:04:18 +0200 (MET DST)"
References: <199909060904.LAA12129@pubhealth.ku.dk>
Message-ID: <x2puzwb51h.fsf@blueberry.kubism.ku.dk>

maechler@stat.math.ethz.ch writes:

> Maybe, the following is not a bug in the strict sense,....
> 
> The following code shows what the effect :
> 
>   p1 <- function(...) plot.default(...)
>   p2 <- function(...) { n <- names(list(...)); plot.default(...) }
> 
>   par(mfrow=c(2,2))
>   p1(1:10, panel.first = grid(10,10)) # works okay (grid drawn)
>   p2(1:10, panel.first = grid(10,10)) # doesn't draw the grid
...
> The real questions behind are:
> 
> 1a) Why is "..." changed at the moment that I do  list(...)
> 1b) is this basic behavior desirable / changeable ....

That's a result of lazy evaluation. plot.default is really playing
with fire, the way it is currently written. list(...) will force
evaluation of the promises which in turn causes grid() to be called
too early. I don't think it is desirable to change this behavior
(well, Robert wants us to consider eager evaluation, but that would
cause the construction to stop working in all cases!)

> 2) How can one work around? 
>    {save "..." to something else, first? 
>     or explicitly save panel.first?}
> 

Neither of the above, because the object is to access "..." without forcing
evaluation of its contents. One can do things like

> p2
function (...) 
{
    n <- names(match.call(expand.dots = F)[["..."]])
    plot.default(...)
}

Or, one can modify plot.default to take panel.first as an
*unevaluated* expression (mode "call" or "expression"), and do an
explicit eval(panel.first). But then you'd have to do 

p2(1:10, panel.first = quote(grid(10,10))) # or expression( )

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Sep  6 13:54:37 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 6 Sep 1999 13:54:37 +0100 (BST)
Subject: Fortran character strings
Message-ID: <199909061254.NAA00597@toucan.stats.ox.ac.uk>

Has anyone ever successfully used Fortran character strings with R?

?Foreign says

         R              C                  Fortran
      integer       int *              integer
  ....
      character     char **            [compiler dependent]

     Character strings are passed as C arrays of character
     strings to Fortran: the first string may be usable if
     its length is passed separately.

and I have been taking a look. The linkage sends char ** to Fortran.
On the other hand, INTPR and  DBLEPR assume Fortran character strings
are char *.  On all my systems DBLEPR works and .Fortran does not,
but I do know of one compiler (Watcom Fortran for Windows NT) where the 
linkage really is equivalent to char **.

Fortran in S takes the first string in a character vector and passes that as
char * (except on the Watcom-compiled Windows version), as far as I
can deduce without the source code.

I think we should either ban character strings in .Fortran or follow
the S prototype unless someone has a way around this.  With different
compilers on the same platform having different conventions whatever we
do (except a ban) will be compiler-dependent.

Any suggestions?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jnf@pcisys.net  Mon Sep  6 21:03:53 1999
From: jnf@pcisys.net (jnf@pcisys.net)
Date: Mon, 6 Sep 1999 22:03:53 +0200 (MET DST)
Subject: Compiling R under Caldera Open Linux 2.2 (PR#268)
Message-ID: <199909062003.WAA19950@pubhealth.ku.dk>


Thanks for your help.  I loaded XFree86-devel-3.3.3.1-3.i386.rpm from my
OpenLinux CD and as you indicate this solved by X11 include file
problem.

I then encountered the linking same problem as you describe below.  The
error message is saying that the compiler can't find the libg2c library,
which is its runtime library.  Apparently the g77 supplied by Caldera is
missing this important piece.  I downloaded egcs-1.1.2-12.i386.rpm from
the Red Hat web site, then did the following to extract and install
libg2c:

1) rpm2cpio < egcs-1.1.2-12.i386.rpm > egcs-1.1.2-12.cpio

2) cpio -irv \*libg2c.a < egcs-1.1.2-12.cpio
- when prompted to rename it, I entered libg2c.a.  This created the
libg2c archive in my current directory.

3) mv libg2c.a /usr/lib/gcc-lib/i386-linux/egcs-2.91.66

That got past the link error you describe.  I then encountered a whole
series of undefined references to X routines.  I was able to determine
that all the routines exist in the X11 library
/usr/X11R6/lib/libX11.so.6.1 but configure was not setting things up
properly to link that library.  After spending a while trying to figure
out configure (it's pretty confusing besides not handling X well; for
instance --with-x doesn't do anything, and --x-libraries doesn't seem to
do much) I gave up and editted the R-0.64.2/src/main/Makefile directly. 
I added on line 44 "-L /usr/X11R6/lib" before $(DLLFLAGS) and also -lX11
at the end of the line.  After doing that, "make" and "make install"
both completed successfully.

So now I've got R installed successfully.  Its interface is fairly
intimidating.  Are there some examples online that would walk me through
some simple calculations/graphs?

- Jack Fenner


John Maindonald wrote:
> 
> To: jnf@pcisys.net
> Subject: Compilation of R under Caldera OpenLinux 2.2
> 
> > On Sat, 28 Aug 1999 jnf@pcisys.net wrote:
> > >
> > > I am attempting to compile R-0.64.2 under Caldera OpenLinux 2.2.  I have
> > > KDE installed but not gnome.  When I ran configure, it correctly
> > > indicated that gnome is not installed.  However when I then ran make, I
> > > received errors complaining that  the include file X11/X.h and similar
> > > are not found.
> ....
> > However, you do have X11 on your machine if you have KDE, and you
> > definitely do want to use X11 in R to get graphics.
> >
> >  You may not have the X11 header files installed -- they should be
> > somewhere under /usr/X11 or /usr/include/X11.  If the header files aren't
> > installed then you will need to install them. They will be on your
> > distribution CD, perhaps in a package called something like x-devel.
> 
> They are in the file Packages/RPMS/XFree86-devel-3.3.3.1-4.i386.rpm
> 
> (On the RedHat 6.0 distribution, there is
> XFree86-devel-3.3.3.1-49.i386.rpm
> which seems to be a later version.)
> 
> ----------------------------------------------------------------
> I have been wrestling with this also.  I had to install g77 from
> the distribution CD, then the above rpm.
> Having got this in order, I then received extensive output,
> terminated by the following (which I have formatted on to
> multiple lines):
> 
> gcc -export-dynamic -o ../../bin/R.X11 arithmetic.o array.o attrib.o
>  bind.o builtin.o character.o coerce.o colors.o complex.o context.o
>  cov.o cum.o debug.o devPS.o devPicTeX.o deparse.o deriv.o devices.o
>  dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o
>  fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o
>  main.o match.o memory.o model.o names.o objects.o optimize.o
>  options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o
>  print.o printarray.o printvector.o printutils.o random.o relop.o
>  saveload.o scan.o seq.o sort.o source.o split.o subassign.o
>  subscript.o subset.o summary.o unique.o util.o version.o
>  ../unix/libunix.a ../appl/libappl.a ../nmath/libmath.a -lSM -lICE
>  -L/usr/X11R6/lib -lX11 -L/usr/lib/gcc-lib/i386-linux/egcs-2.91.66
>  -L/usr/i386-linux/lib -lg2c -lm -lg2c: -ldl -lm
>  /usr/i386-linux/bin/ld: cannot open -lg2c: No such file or directory
> make[3]: *** [../../bin/R.X11] Error 1 make[3]: Leaving directory
> `/home/john/BUILD/src/main' make[2]: *** [R] Error 2 make[2]:
> Leaving directory `/home/john/BUILD/src/main' make[1]: *** [R] Error
> 1 make[1]: Leaving directory `/home/john/BUILD/src' make: *** [R]
> Error 1
> 
> I have been unable to find anything on the distribution CD that
> might answer to the lg2c.  Any clues would be welcome.
> 
> These difficulties aside, the Caldera OpenLinux 2.2 distribution
> is much more novice-friendly than RedHat 6.0.  Configuration is
> much quicker and more straightforward.
> 
> John Maindonald               email : john.maindonald@anu.edu.au
> Statistical Consulting Unit,  phone : (6249)3998
> c/o CMA, SMS,                 fax   : (6249)5549
> John Dedman Mathematical Sciences Building
> Australian National University
> Canberra ACT 0200
> Australia

-- 

Jack Fenner


  I am life that wills to live in the midst of life that wills to live.
             - Albert Schweitzer, "Out of my Life and Thought"

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jnf@pcisys.net  Mon Sep  6 15:03:02 1999
From: jnf@pcisys.net (Jack N.)
Date: Mon, 06 Sep 1999 08:03:02 -0600
Subject: Compiling R under Caldera Open Linux 2.2
References: <199908290938.TAA07841@leonard.anu.edu.au>
Message-ID: <37D3C996.CACE6A14@pcisys.net>


Thanks for your help.  I loaded XFree86-devel-3.3.3.1-3.i386.rpm from my
OpenLinux CD and as you indicate this solved by X11 include file
problem.

I then encountered the linking same problem as you describe below.  The
error message is saying that the compiler can't find the libg2c library,
which is its runtime library.  Apparently the g77 supplied by Caldera is
missing this important piece.  I downloaded egcs-1.1.2-12.i386.rpm from
the Red Hat web site, then did the following to extract and install
libg2c:

1) rpm2cpio < egcs-1.1.2-12.i386.rpm > egcs-1.1.2-12.cpio

2) cpio -irv \*libg2c.a < egcs-1.1.2-12.cpio
- when prompted to rename it, I entered libg2c.a.  This created the
libg2c archive in my current directory.

3) mv libg2c.a /usr/lib/gcc-lib/i386-linux/egcs-2.91.66

That got past the link error you describe.  I then encountered a whole
series of undefined references to X routines.  I was able to determine
that all the routines exist in the X11 library
/usr/X11R6/lib/libX11.so.6.1 but configure was not setting things up
properly to link that library.  After spending a while trying to figure
out configure (it's pretty confusing besides not handling X well; for
instance --with-x doesn't do anything, and --x-libraries doesn't seem to
do much) I gave up and editted the R-0.64.2/src/main/Makefile directly. 
I added on line 44 "-L /usr/X11R6/lib" before $(DLLFLAGS) and also -lX11
at the end of the line.  After doing that, "make" and "make install"
both completed successfully.

So now I've got R installed successfully.  Its interface is fairly
intimidating.  Are there some examples online that would walk me through
some simple calculations/graphs?

- Jack Fenner


John Maindonald wrote:
> 
> To: jnf@pcisys.net
> Subject: Compilation of R under Caldera OpenLinux 2.2
> 
> > On Sat, 28 Aug 1999 jnf@pcisys.net wrote:
> > >
> > > I am attempting to compile R-0.64.2 under Caldera OpenLinux 2.2.  I have
> > > KDE installed but not gnome.  When I ran configure, it correctly
> > > indicated that gnome is not installed.  However when I then ran make, I
> > > received errors complaining that  the include file X11/X.h and similar
> > > are not found.
> ....
> > However, you do have X11 on your machine if you have KDE, and you
> > definitely do want to use X11 in R to get graphics.
> >
> >  You may not have the X11 header files installed -- they should be
> > somewhere under /usr/X11 or /usr/include/X11.  If the header files aren't
> > installed then you will need to install them. They will be on your
> > distribution CD, perhaps in a package called something like x-devel.
> 
> They are in the file Packages/RPMS/XFree86-devel-3.3.3.1-4.i386.rpm
> 
> (On the RedHat 6.0 distribution, there is
> XFree86-devel-3.3.3.1-49.i386.rpm
> which seems to be a later version.)
> 
> ----------------------------------------------------------------
> I have been wrestling with this also.  I had to install g77 from
> the distribution CD, then the above rpm.
> Having got this in order, I then received extensive output,
> terminated by the following (which I have formatted on to
> multiple lines):
> 
> gcc -export-dynamic -o ../../bin/R.X11 arithmetic.o array.o attrib.o
>  bind.o builtin.o character.o coerce.o colors.o complex.o context.o
>  cov.o cum.o debug.o devPS.o devPicTeX.o deparse.o deriv.o devices.o
>  dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o
>  fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o
>  main.o match.o memory.o model.o names.o objects.o optimize.o
>  options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o
>  print.o printarray.o printvector.o printutils.o random.o relop.o
>  saveload.o scan.o seq.o sort.o source.o split.o subassign.o
>  subscript.o subset.o summary.o unique.o util.o version.o
>  ../unix/libunix.a ../appl/libappl.a ../nmath/libmath.a -lSM -lICE
>  -L/usr/X11R6/lib -lX11 -L/usr/lib/gcc-lib/i386-linux/egcs-2.91.66
>  -L/usr/i386-linux/lib -lg2c -lm -lg2c: -ldl -lm
>  /usr/i386-linux/bin/ld: cannot open -lg2c: No such file or directory
> make[3]: *** [../../bin/R.X11] Error 1 make[3]: Leaving directory
> `/home/john/BUILD/src/main' make[2]: *** [R] Error 2 make[2]:
> Leaving directory `/home/john/BUILD/src/main' make[1]: *** [R] Error
> 1 make[1]: Leaving directory `/home/john/BUILD/src' make: *** [R]
> Error 1
> 
> I have been unable to find anything on the distribution CD that
> might answer to the lg2c.  Any clues would be welcome.
> 
> These difficulties aside, the Caldera OpenLinux 2.2 distribution
> is much more novice-friendly than RedHat 6.0.  Configuration is
> much quicker and more straightforward.
> 
> John Maindonald               email : john.maindonald@anu.edu.au
> Statistical Consulting Unit,  phone : (6249)3998
> c/o CMA, SMS,                 fax   : (6249)5549
> John Dedman Mathematical Sciences Building
> Australian National University
> Canberra ACT 0200
> Australia

-- 

Jack Fenner


  I am life that wills to live in the midst of life that wills to live.
             - Albert Schweitzer, "Out of my Life and Thought"
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@biostat.ku.dk  Tue Sep  7 06:15:04 1999
From: pd@biostat.ku.dk (Peter Dalgaard BSA)
Date: Tue, 7 Sep 1999 07:15:04 +0200
Subject: Bug list summary (automatic post)
Message-ID: <199909070515.HAA03031@biostat.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.biostat.ku.dk or via email to
r-bugs@biostat.ku.dk. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

* PR# 138 *
Subject: Re: [R] bug? and New bug.
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Wed, 10 Mar 1999 17:21:16 +0100
--pt() for large df. Solved, but problem remains for pf et al.

Directory:  Add-ons

* PR# 137 *
Subject: funfits
From: "Alvaro A. Novo" <novo@uiuc.edu>
Date: Tue, 9 Mar 1999 22:24:54 -0600
--Not our problem. Dubious whether a bug at all.

Directory:  Analyses

* PR# 144 *
Subject: glm throws erroneous(?)'names attribute must be the same length as the vector' 
From: wagman@enteract.com
Date: Thu, 18 Mar 1999 08:58:47 +0100
--Can anyone reproduce this ??
--Same error as when doing regression on empty subset. All fitted
--values might be 0 or 1

Directory:  Documentation

none

Directory:  Graphics

* PR# 61 *
Subject: points(...,  cex = ..)  is pretty wrong...
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 2 Nov 1998 19:15:06 +0100
--Symbols getting decentered when too large cex for X. Still there 22feb99  
* PR# 69 *
Subject: Some graphics bugs
From: Martyn Plummer <plummer@iarc.fr>
Date: Fri, 04 Dec 1998 11:42:50 -0000 ()
Date: 04-Dec-98
--Various anomalies with text size and alignment. 2B appears to be solved. The 
--rest is still there (22feb99)
* PR# 120 *
Subject: graphics bug: type="l"
From: Matthew Wiener <mcw@ln.nimh.nih.gov>
Date: Tue, 16 Feb 1999 15:30:25 -0500 (EST)
--X server problem drawing > 64K lines at once. Workaround?
* PR# 123 *
Subject: Text in plot
From: Ennapadam Venkatraman <venkat@biosta.mskcc.org>
Date: Thu, 18 Feb 1999 13:05:37 -0500
--Multiline text not working
* PR# 130 *
Subject: lty=0 -- shouldn't it give an invisible line?
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 28 Feb 1999 21:45:43 +0100
--Strange effect on barplot
* PR# 149 *
Subject: plot.formula and pch=
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 25 Mar 1999 21:22:44 +0100
--plot(y~x,pch=z) may subset x and y but leave z.
--E.g. with missing values you can get incorrect plot symbols.
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--Don't think I (pd) got the point there...
* PR# 225 *
Subject: pch and mkh bug
From: Stephen Harker <sjh@ph.adfa.edu.au>
Date: Wed, 14 Jul 1999 13:10:31 +1000 (EST)
--(1) is an S incompatibility, but the S rules may not be a good model
--(2) is a bug, fixed for 0.65.0
--(3) has gone away in 0.65.0
* PR# 229 *
Subject: dev.print scaling bug?
From: John.Peters@tip.csiro.au (John Peters)
Date: Fri, 16 Jul 1999 12:10:48 +1000 (EST)
* PR# 230 *
Subject: Use of lwd = 0, lty = 2 in segments.
From: Douglas Bates <bates@stat.wisc.edu>
Date: Sat, 17 Jul 1999 17:18:44 -0500 (CDT)
* PR# 238 *
Subject: EPS compliance of postscript device: initclip operator
From: David Middleton <dajm@deeq.demon.co.uk>
Date: Tue, 03 Aug 1999 17:51:47 -0300
--initclip is removed. Still need new argument onefile/onepage to ensure one page
--and use %!PS-Adobe-3.0 EPSF-3.0 header

Directory:  In-Out

* PR# 125 *
Subject: scan rejects complex
From: John.Peters@tip.csiro.au (John Peters)
Date: Mon, 22 Feb 1999 10:08:14 +1100 (EST)
* PR# 129 *
Subject: Formatting in formatC and format
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 28 Feb 1999 08:53:34 +0000 (GMT)
--Documentation and ``merge'' of format() and formatC() would be desired - MM
* PR# 207 *
Subject: Lines longer than ~1000 chars truncated at parsing
From: msa@biostat.mgh.harvard.edu
Date: Mon, 7 Jun 1999 22:27:10 +0200 (MET DST)
--Fixed buffer used during input.
--Not fixable without major changes to readline lib.

Directory:  Installation

none

Directory:  Language

* PR# 105 *
Subject: an old bug resurfaces
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Fri, 29 Jan 1999 08:28:32 +0100 (MET)
--Model formulas. Proper fix probably requires extensive rewrite of model formula
--parser, which would make in non-S-compatible.
* PR# 239 *
Subject: cbind is not generic as claimed, omits labels where S has them 
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 5 Aug 1999 12:29:58 +0100 (BST)
--Cbind is now generic, still labelling issues. See also PR#240 and PR#241.
* PR# 240 *
Subject: Re: cbind is not generic as claimed, omits labels where S has them
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 5 Aug 1999 17:19:08 +0100 (BST)
--See PR#239
* PR# 241 *
Subject: Re: cbind is not generic as claimed, omits labels where S has them
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Fri, 6 Aug 1999 06:52:35 +0100 (BST)
--See PR#239

Directory:  Low-level

* PR# 37 *
Subject: S.h compatibility issues
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 6 Sep 1998 19:58:47 +0100 (BST)
--1 is fixed
--2 R's own RNG entry points are still not public
--3 is the perennial issue of what is the `public' API -- specific points are
--fixed
* PR# 101 *
Subject: Re: [R] Re: R-0.63.2 for Windows - some comments
From: Guido Masarotto <guido@hal.stat.unipd.it>
Date: Fri, 22 Jan 1999 12:40:26 +0100
--This is really about fixed buffer sizes in printutils.c
* PR# 135 *
Subject: summary() of lm() problem
From: Simon Fear <fears@roycastle.liv.ac.uk>
Date: Tue, 9 Mar 1999 13:18:37 -0000 
--lm (?) AND Windows problem;  Win solved (fudged) for 0.63.3
--
--Another low-level buffer-size problem
* PR# 185 *
Subject: Re: [R] R_problem_buf in the S.h files & lists in .C
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 05 May 1999 00:32:49 +0200
--S objects in .C calls (not just lists) are now documented in the help file
* PR# 197 *
Subject: glm crash
From: Cor en Aylin <Cor.Berrevoets@gironet.nl>
Date: Fri, 21 May 1999 19:44:23 +0200
--Obscure report. Cannot reproduce from given info.
* PR# 210 *
Subject: definition of R_problem_buf in S.h
From: vogels@ieee.org
Date: Mon, 14 Jun 1999 17:56:04 +0200 (MET DST)
--Same as #185
* PR# 235 *
Subject:  round(numeric(0)) 
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 29 Jul 1999 15:20:21 +0100 (BST)
--Some followup of this on R-devel not sent here.

Directory:  Misc

* PR# 91 *
Subject: possible bug
From: Rashid Nassar <rnassar@duke.edu>
Date: Sat, 9 Jan 1999 14:50:58 -0500 (EST)
--Remaining issue is whether we can do something more friendly than dumping 
--users into vi?

Directory:  Models

* PR# 121 *
Subject:  model.frame mangles time series 
From: Peter Dalgaard BSA <pd@biostat.ku.dk>
Date: Thu, 18 Feb 1999 15:47:24 +0100
--Subset in C code + attributes = mess
--Switch to interpreted ("[")

Directory:  Startup

none

Directory:  System-specific

* PR# 214 *
From: Charles Taylor <charles@amsta.leeds.ac.uk>
Date: Thu, 24 Jun 1999 11:20:06 +0100 (BST)
* PR# 222 *
Subject: Use of R-Coda
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Fri, 9 Jul 1999 10:54:16 +0200 
--In Danish (?)  Looks as if PR#246 is the same in English
* PR# 234 *
Subject: R-bugs
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Tue, 27 Jul 1999 13:49:31 +0200
--Looks like PR#222 again, in Danish. See PR#246 for English version
* PR# 246 *
Subject: R-Coda on rs6000-ibm-aix4.2.1.0
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Wed, 11 Aug 1999 08:49:47 +0200
--Problem with ps on AIX in 0.64.2. Try again with 0.65.0?

Directory:  TooMuchAtOnce

* PR# 53 *
Subject: 0.62.3 bugs, incompatibilities and problems
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Mon, 12 Oct 1998 09:43:51 +0200 (MET DST)
--Of Jims points: (checked in 0.65 April 26 compared to Splus 3.4)
-- 4. works the same as S
-- 5. Splus gives NA and the if(class(z)=="repeated") doesn't work in either
-- 10. seems to work
-- 7.  seems to do what Jim wants now
--  
* PR# 76 *
Subject: R-0.63.0
From: Rashid Nassar <rnassar@acpub.duke.edu>
Date: Fri, 11 Dec 1998 23:20:08 -0500 (EST)

Directory:  Windows

none

Directory:  incoming

* PR# 248 *
Subject: scan() + error interferes with count.fields() in some cases
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 13 Aug 1999 17:44:48 +0200
* PR# 249 *
Subject: axis ignores srt/crt
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Mon, 16 Aug 1999 15:51:49 -0700 (PDT)
* PR# 250 *
From: Peter Malewski <peter@tu-bs.de>
Date: Tue, 17 Aug 1999 12:21:38 +0200 (CEST)
* PR# 251 *
From: Peter Malewski <peter@tu-bs.de>
Date: Tue, 17 Aug 1999 12:21:45 +0200 (CEST)
* PR# 252 *
Subject: bug: R says "Floating exception" on DEC-Alpha w/OSF1
From: "Michael Thompson" <mlthomps@yayoi.mt.m-kagaku.co.jp>
Date: Thu, 19 Aug 1999 06:03:06 +0900
* PR# 253 *
Subject: seg.fault for some illegal .Random.seed (new since 0.64)
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 20 Aug 1999 14:17:31 +0200
* PR# 254 *
Subject: Strange 'Unimplemented feature in rep' error
From: Lutz Prechelt <prechelt@ira.uka.de>
Date: Mon, 23 Aug 1999 19:43:24 +0200
* PR# 255 *
Subject: broken link in R FAQ page?
From: Tian-Xiong Lu <tian@chico.ma.adfa.edu.au>
Date: Tue, 24 Aug 1999 13:41:21 +1000 (EST)
* PR# 256 *
Subject: Error in ?text
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
Date: Wed, 25 Aug 1999 10:00:19 +0100 (BST)
* PR# 257 *
Subject:  dimnames names lost when subscripting 
From: Andreas Weingessel <weingessel@ci.tuwien.ac.at>
Date: Wed, 25 Aug 1999 12:45:28 +0200
* PR# 258 *
Subject: Greek letters in outer margins.
From: "BXC (Bendix Carstensen)" <BXC@NOVO.dk>
Date: Thu, 26 Aug 1999 12:09:17 +0200
* PR# 259 *
Subject: R without X11?
From: "Jack N." <jnf@pcisys.net>
Date: Sat, 28 Aug 1999 09:22:57 -0600
* PR# 260 *
Subject: Re: Compiling R under Caldera Open Linux 2.2
Subject: Compilation of R under Caldera OpenLinux 2.2
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sun, 29 Aug 1999 19:38:13 +1000 (EST)
* PR# 261 *
Subject: interface w/ emacs
From: gautier@lion-ag.de
Date: Mon, 30 Aug 1999 13:28:52 +0200 (MET DST)
* PR# 262 *
Subject: Problems compiling R65.0
From: Patrick Lindsey <plindsey@alpha.luc.ac.be>
Date: Wed, 1 Sep 1999 11:52:29 +0200 (MET DST)
* PR# 263 *
Subject: Problems sourcing functions with R65.0
From: Patrick Lindsey <plindsey@alpha.luc.ac.be>
Date: Wed, 1 Sep 1999 11:58:51 +0200 (MET DST)
* PR# 264 *
Subject: R 0.65.x bug :  attach()/eval() {was "lib.source() within library()"}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Thu, 2 Sep 1999 12:23:43 +0200
* PR# 265 *
Subject: trouble with the 'exclude' parameter of factor()
From: gautier@lion-ag.de
Date: Thu, 2 Sep 1999 17:40:47 +0200 (MET DST)
* PR# 266 *
Subject: Re: [R] data frame component replacement: feature or bug?
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Sep 1999 00:03:29 +0200
* PR# 267 *
Subject: matplot(... panel.first=..) fails  <==> dealing with "..."
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 6 Sep 1999 11:04:03 +0200
* PR# 268 *
Subject: Re: Compiling R under Caldera Open Linux 2.2
From: "Jack N." <jnf@pcisys.net>
Date: Mon, 06 Sep 1999 08:03:02 -0600
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Sep  7 17:42:01 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue, 7 Sep 1999 18:42:01 +0200 (MET DST)
Subject: sys.on.exit appears non-functional (PR#269)
Message-ID: <199909071642.SAA03414@pubhealth.ku.dk>

As far as I can see sys.on.exit() does not work. The following
will give a non-null result in S, and seems about the simplest possible
usage.

test <- function() {
  on.exit(print(1))
  ex <- sys.on.exit()
  str(ex)
  cat("exiting...\n")
}
> test()
 NULL
exiting...
[1] 1

Looking at the code suggests that on.exit is installing the code in
a different context from the one sys.on.exit is looking in, but this is
daunting for non-experts.

The help page does not say what this is supposed to do, of course, but
I assume it is intended to retrieve the on.exit expression, as in S.

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = 
 status.rev = 0
 major = 0
 minor = 65.0
 year = 1999
 month = August
 day = 27
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Sep  8 00:03:45 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 08 Sep 1999 01:03:45 +0200
Subject: sys.on.exit appears non-functional (PR#269)
In-Reply-To: ripley@stats.ox.ac.uk's message of "Tue, 7 Sep 1999 18:42:01 +0200 (MET DST)"
References: <199909071642.SAA03414@pubhealth.ku.dk>
Message-ID: <x2ogfe729a.fsf@blueberry.kubism.ku.dk>

ripley@stats.ox.ac.uk writes:

> As far as I can see sys.on.exit() does not work. The following
> will give a non-null result in S, and seems about the simplest possible
> usage.
> 
> test <- function() {
>   on.exit(print(1))
>   ex <- sys.on.exit()
>   str(ex)
>   cat("exiting...\n")
> }
> > test()
>  NULL
> exiting...
> [1] 1
> 
> Looking at the code suggests that on.exit is installing the code in
> a different context from the one sys.on.exit is looking in, but this is
> daunting for non-experts.

Not really that hard, once I realised that R_GlobalContext is not a
global constant and that R_ToplevelContext is the bottom of the
context stack... sys.on.exit is a function that calls a .Internal.
This inserts an extra context layer - calling the .Internal directly
works - and one just had to look one level further up.

Will commit for 0.65.1 in a moment.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pascal.grandeau@wanadoo.fr  Wed Sep  8 16:56:13 1999
From: pascal.grandeau@wanadoo.fr (pascal.grandeau@wanadoo.fr)
Date: Wed, 8 Sep 1999 17:56:13 +0200 (MET DST)
Subject: R with Windows 95 (PR#271)
Message-ID: <199909081556.RAA15313@pubhealth.ku.dk>

Full_Name: Pascal GRANDEAU
Version: 0.65.0
OS: Windows 95
Submission from: (NULL) (164.138.103.253)


I downloaded the new version of R and I see a little bug with Windows 95. If I
plot anything and then I call the menu Windows/Tile, this works but when I
continue to work after a certain number of input (near 10) the cursor disapear
and I cannot continue. This happens also if I change the dimensions of the
windows.

I don't see the same bug with version 0.64.1.

Thank you very much and felicitations for R which is a very useful program.

Excuse my english.

P. GRANDEAU

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Sep  8 17:24:11 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 8 Sep 1999 18:24:11 +0200 (MET DST)
Subject: R with Windows 95 (PR#271)
Message-ID: <199909081624.SAA15492@pubhealth.ku.dk>

> From: pascal.grandeau@wanadoo.fr
> Date: Wed, 8 Sep 1999 17:56:13 +0200 (MET DST)
> To: r-devel@stat.math.ethz.ch
> Subject: R with Windows 95 (PR#271)
> CC: R-bugs@biostat.ku.dk
> X-Loop: R-bugs@biostat.ku.dk
> 
> Full_Name: Pascal GRANDEAU
> Version: 0.65.0
> OS: Windows 95
> Submission from: (NULL) (164.138.103.253)
> 
> 
> I downloaded the new version of R and I see a little bug with Windows 95. If I
> plot anything and then I call the menu Windows/Tile, this works but when I
> continue to work after a certain number of input (near 10) the cursor disapear
> and I cannot continue. This happens also if I change the dimensions of the
> windows.

Let me be clear, since there are lot of possibilities. You are using
Rgui.exe in mdi mode? Have you changed any options in Rconsole?  At
some point the cursor disppears: do the menus still work? Can you still
move the windows?

> I don't see the same bug with version 0.64.1.

You are commenting on a preliminary release, which as the announcement
says, has not been tested extensively; in particular I have no access
to Windows 95, and very little to Windows 98 (but Guido Masarotto has
to both).  I cannot reproduce this under NT, but I may not be guessing
right what you did. Unfortunately, I suspect a problem with Windows
event handling, and that is very version-dependent.

Please try the official release (when it comes) and report again if the
problem persists. Guido does use a different compile environment from mine.

I have managed to track down two problems (DEL did not work, no printer
chooser appears) both of which are due to errors in header files in the
compiler I used and have been fixed in the current version (you only
need the new rw0650b.zip dated Sept 7).  Given that history, I am quite
ready to believe that there are more of the same.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Sep  9 09:14:54 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 9 Sep 1999 10:14:54 +0200 (CEST)
Subject: Fortran character strings
In-Reply-To: <199909061254.NAA00597@toucan.stats.ox.ac.uk>
References: <199909061254.NAA00597@toucan.stats.ox.ac.uk>
Message-ID: <14295.27774.194390.155680@fangorn.ci.tuwien.ac.at>

>>>>> Prof Brian Ripley writes:

> Has anyone ever successfully used Fortran character strings with R?
> ?Foreign says

>          R              C                  Fortran
>       integer       int *              integer
>   ....
>       character     char **            [compiler dependent]

>      Character strings are passed as C arrays of character
>      strings to Fortran: the first string may be usable if
>      its length is passed separately.

> and I have been taking a look. The linkage sends char ** to Fortran.
> On the other hand, INTPR and DBLEPR assume Fortran character strings
> are char *.  On all my systems DBLEPR works and .Fortran does not, but
> I do know of one compiler (Watcom Fortran for Windows NT) where the
> linkage really is equivalent to char **.

> Fortran in S takes the first string in a character vector and passes
> that as char * (except on the Watcom-compiled Windows version), as far
> as I can deduce without the source code.

> I think we should either ban character strings in .Fortran or follow
> the S prototype unless someone has a way around this.  With different
> compilers on the same platform having different conventions whatever
> we do (except a ban) will be compiler-dependent.

> Any suggestions?

Hmm ... this is someone not knowing what is going (i.e., me) commenting
on this.

I touched this once when porting Rousseeuw's cluster routines to R,
maybe the thread is in the r-core archives.  I seem to recall that
someone told me that this was really a compiler-specific issue and hence
could/should not be part of the API.  (In the specific case, it was a
0/1 string so I found a different solution.)

(Btw, why do we map integer to int * and not long *?)

-k

PS.  A comment on ?.External:  We have

         list          void * (SEXP *)
         other         void * (SEXP)

I think this (showing the alternative in parenteses) may be confusing.
Shouldn't we show the preferred method in the table and mention the
alternative somewhere in the text following?

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Sep  9 09:28:24 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 9 Sep 1999 09:28:24 +0100 (BST)
Subject: Fortran character strings
In-Reply-To: <14295.27774.194390.155680@fangorn.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.05.9909090916450.4120-100000@auk.stats>

On Thu, 9 Sep 1999, Kurt Hornik wrote:

> >>>>> Prof Brian Ripley writes:
> 
> > Has anyone ever successfully used Fortran character strings with R?
> > ?Foreign says
> 
> >          R              C                  Fortran
> >       integer       int *              integer
> >   ....
> >       character     char **            [compiler dependent]
> 
> >      Character strings are passed as C arrays of character
> >      strings to Fortran: the first string may be usable if
> >      its length is passed separately.
> 
> > and I have been taking a look. The linkage sends char ** to Fortran.
> > On the other hand, INTPR and DBLEPR assume Fortran character strings
> > are char *.  On all my systems DBLEPR works and .Fortran does not, but
> > I do know of one compiler (Watcom Fortran for Windows NT) where the
> > linkage really is equivalent to char **.
> 
> > Fortran in S takes the first string in a character vector and passes
> > that as char * (except on the Watcom-compiled Windows version), as far
> > as I can deduce without the source code.
> 
> > I think we should either ban character strings in .Fortran or follow
> > the S prototype unless someone has a way around this.  With different
> > compilers on the same platform having different conventions whatever
> > we do (except a ban) will be compiler-dependent.
> 
> > Any suggestions?
> 
> Hmm ... this is someone not knowing what is going (i.e., me) commenting
> on this.
> 
> I touched this once when porting Rousseeuw's cluster routines to R,
> maybe the thread is in the r-core archives.  I seem to recall that
> someone told me that this was really a compiler-specific issue and hence
> could/should not be part of the API.  (In the specific case, it was a
> 0/1 string so I found a different solution.)

It is compiler-specific, but there is a solution that works in 99% of the
cases that I have put in R-devel, with warnings.

> (Btw, why do we map integer to int * and not long *?)

How would I know?  (Actually, because it lets us use the C linakge, I
guess.)  We do assume that in building R, for things like eigen. I noted
that f2c does have a configure check for this, and I think we probably
ought to find out at configure time what integer does map to and make
.Fortran cover this.

> 
> -k
> 
> PS.  A comment on ?.External:  We have
> 
>          list          void * (SEXP *)
>          other         void * (SEXP)
> 
> I think this (showing the alternative in parenteses) may be confusing.
> Shouldn't we show the preferred method in the table and mention the
> alternative somewhere in the text following?

It is confusing. Actually all of them are mapped to void *, so I think we
should be giving SEXP * and SEXP. Thomas?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Sep  9 15:35:05 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 9 Sep 1999 16:35:05 +0200 (CEST)
Subject: [R] read.table bug
In-Reply-To: <x2aeqwxkyj.fsf@blueberry.kubism.ku.dk>
References: <37D7B372.CDA3589D@inet.polyu.edu.hk>
 <x2aeqwxkyj.fsf@blueberry.kubism.ku.dk>
Message-ID: <14295.50585.281674.771207@fangorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Li Dongfeng <mavip5@inet.polyu.edu.hk> writes:
>> Suppose we have a data file containing:
>> 
>> "Smith, John", 120, 90
>> "Thomson, Peter", 110, 85
>> 
>> there are 3 variables in it. If we use 
>> 
>> x <- read.table("tmp.txt", sep=",")
>> 
>> to read the data to a data.frame,
>> the result will be 4 columns.
>> Splus 4.0 have no problem with this kind
>> of data.

> Splus 3.4 has:

>> read.table("data", sep=",")
>                V2  V3 V4 
>   "Smith   John\" 120 90
> "Thomson  Peter\" 110 85

> i.e. 3 variables but with row.names '"Smith' and '"Thomson'

> Or, closer to what R does:

>> read.table("data", sep=",",row.names=NULL)
>          V1       V2  V3 V4 
> 1   \"Smith   John\" 120 90
> 2 \"Thomson  Peter\" 110 85

> By its definition, this is what sep=',' must do, but it obviously will
> not handle all CSV files properly. Anyone want to write a read.csv()
> function or something of the sorts? It would be very useful.

So
	read.table(sep = ",")

would be different from

	read.csv()

?

PS.  Btw, a typical problem when dumping from certain commercial
spreadsheets to csv and trying to read that in using read.table() is
that the dump does not always produce trailing commas.  I use a trivial
Perl script for adding these, but maybe read.table() should be smarter
about that (new option doing if_not_enough_then_add_as_NA?)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Sep  9 16:00:19 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 09 Sep 1999 17:00:19 +0200
Subject: [R] read.table bug
In-Reply-To: Kurt Hornik's message of "Thu, 9 Sep 1999 16:35:05 +0200 (CEST)"
References: <37D7B372.CDA3589D@inet.polyu.edu.hk> 	<x2aeqwxkyj.fsf@blueberry.kubism.ku.dk> <14295.50585.281674.771207@fangorn.ci.tuwien.ac.at>
Message-ID: <x27lm0xh8c.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> So
> 	read.table(sep = ",")
> 
> would be different from
> 
> 	read.csv()

Yes. Or - there are many ways to do it - extend read.table with an
option, e.g. quote='"', which for all I care could be the default. The
point is that you may want the other behaviour (quote=NULL) in some
cases. 

(How does CSV handle embedded quotes? Wotsit.org says that it is
system dependent, but a common convention is doubling the quote, i.e.
"abc""dfg". Others might do "abc"dfg", which is likely a bug. And some
systems use ';' or '|' as the separator.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Sep  9 16:46:02 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 9 Sep 1999 08:46:02 -0700 (PDT)
Subject: Fortran character strings
In-Reply-To: <Pine.GSO.4.05.9909090916450.4120-100000@auk.stats>
Message-ID: <Pine.GSO.4.10.9909090823390.21909-100000@wompom.biostat.washington.edu>

On Thu, 9 Sep 1999, Prof Brian D Ripley wrote:

> On Thu, 9 Sep 1999, Kurt Hornik wrote:
> > PS.  A comment on ?.External:  We have
> > 
> >          list          void * (SEXP *)
> >          other         void * (SEXP)
> > 
> > I think this (showing the alternative in parenteses) may be confusing.
> > Shouldn't we show the preferred method in the table and mention the
> > alternative somewhere in the text following?
> 
> It is confusing. Actually all of them are mapped to void *, so I think we
> should be giving SEXP * and SEXP. Thomas?


The reason for having void * listed is that you can then declare the
arguments without including the Rinternals header, but that could
just be explained in the text. Done.

	-thomas



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From oka@debian.or.jp  Fri Sep 10 07:53:40 1999
From: oka@debian.or.jp (oka@debian.or.jp)
Date: Fri, 10 Sep 1999 08:53:40 +0200 (MET DST)
Subject: problem in R.sh.in script (PR#272)
Message-ID: <199909100653.IAA02811@pubhealth.ku.dk>


I found problem in R-0.65.0/src/scripts/R.sh.in script.
When I run R program with `R -d gdb', R script say,

  /usr/local/bin/R[104]: shift: bad number

I fixed this problem by applying following patch to the script:

*** R.sh.in.orig    Fri Sep 10 13:01:10 1999
--- R.sh.in Fri Sep 10 13:01:23 1999
***************
*** 48,54 ****
      -g|--gnome)
        R_BINARY="R.gnome" ;;
      -d|--debugger)
!       DBG="${2}"; shift 2 ;;
      --no-environ)
        USE_R_ENVIRON=false ;;
      --vanilla)
--- 48,54 ----
      -g|--gnome)
        R_BINARY="R.gnome" ;;
      -d|--debugger)
!       DBG="${2}"; shift ;;
      --no-environ)
        USE_R_ENVIRON=false ;;
      --vanilla)

--please do not edit the information below--

Version:
 platform = i586-unknown-linux
 arch = i586
 os = linux
 system = i586, linux
 status = 
 status.rev = 0
 major = 0
 minor = 65.0
 year = 1999
 month = August
 day = 27
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From oka@debian.or.jp  Fri Sep 10 08:08:45 1999
From: oka@debian.or.jp (oka@debian.or.jp)
Date: Fri, 10 Sep 1999 09:08:45 +0200 (MET DST)
Subject: problem in R.sh.in script (PR#273)
Message-ID: <199909100708.JAA02996@pubhealth.ku.dk>


At 10 Sep 1999 06:53:01 -0000,
Mitsuru Oka <oka@debian.or.jp> wrote:
> 
> 
> I found problem in R-0.65.0/src/scripts/R.sh.in script.
> When I run R program with `R -d gdb', R script say,
> 
>   /usr/local/bin/R[104]: shift: bad number
> 
> I fixed this problem by applying following patch to the script:
...
> 
> Version:
>  platform = i586-unknown-linux
>  arch = i586
>  os = linux

I'm Sorry. I made a mistake. In above environment, R script
has no problem. The problem is in following environment.
May be, /bin/sh is incompatible.

--please do not edit the information below--

Version:
 platform = mips-sgi-irix6.4
 arch = mips
 os = irix6.4
 system = mips, irix6.4
 status = 
 status.rev = 0
 major = 0
 minor = 65.0
 year = 1999
 month = August
 day = 27
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Sep 10 08:45:20 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 10 Sep 1999 09:45:20 +0200
Subject: problem in R.sh.in script (PR#273)
In-Reply-To: oka@debian.or.jp's message of "Fri, 10 Sep 1999 09:08:45 +0200 (MET DST)"
References: <199909100708.JAA02996@pubhealth.ku.dk>
Message-ID: <x2vh9jnran.fsf@blueberry.kubism.ku.dk>

oka@debian.or.jp writes:

> I'm Sorry. I made a mistake. In above environment, R script
> has no problem. The problem is in following environment.
> May be, /bin/sh is incompatible.

It *does* have a problem on Linux too, it just doesn't protest quite
as badly:

$ R -d gdb
shift: shift count must be <= $#
GNU gdb 4.17.0.11 with Linux support

I fixed this for 0.65.1 a couple of days ago.

PS to everyone: When you follow up on a Problem Report, please make
sure that you include the original PR# in the subject field so that yo
don't open a new PR#. This is easily done by 'reply' in most mailers.
And please also avoid sending reports both to r-bugs and the
mailinglists (where they will appear with no PR# and subsequent
discussion will not get filed.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Mon Sep 13 02:02:22 1999
From: albrecht.gebhardt@uni-klu.ac.at (albrecht.gebhardt@uni-klu.ac.at)
Date: Mon, 13 Sep 1999 03:02:22 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909130102.DAA16878@pubhealth.ku.dk>

Full_Name: Albrecht Gebhardt
Version: 0.65.0
OS: Digital Unix 4.0E
Submission from: (NULL) (212.17.104.62)


Plottimg on the Alpha stopped working with 0.65.0.

The tickmarks have a length of -Inf and go across the whole 
plot.

A first solution is the following patch:

--- src/main/plot.c.alpha-patch Mon Sep 13 01:37:11 1999
+++ src/main/plot.c     Mon Sep 13 01:58:16 1999
@@ -832,7 +832,7 @@
        }
        dd->gp.col = fg;
        GLine(REAL(at)[0], y, REAL(at)[n - 1], y, USER, dd);
-       if (R_FINITE(dd->gp.tck)) {
+       if (R_FINITE(dd->gp.tck) && !(ISNAN(dd->gp.tck))) {
            /* The S way of doing ticks */
            double y0, y1;
            if (dd->gp.tck > 0.5) {
@@ -922,7 +922,7 @@
        }
        dd->gp.col = fg;
        GLine(x, REAL(at)[0], x, REAL(at)[n - 1], USER, dd);
-       if (R_FINITE(dd->gp.tck)) {
+       if (R_FINITE(dd->gp.tck) && !(ISNAN(dd->gp.tck))) {
            /* The S way of doing ticks */
            double x0, x1;
            if (dd->gp.tck > 0.5) {


Albrecht Gebhardt


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Sep 13 07:34:45 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon, 13 Sep 1999 08:34:45 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909130634.IAA17647@pubhealth.ku.dk>

On Mon, 13 Sep 1999 albrecht.gebhardt@uni-klu.ac.at wrote:

> Full_Name: Albrecht Gebhardt
> Version: 0.65.0
> OS: Digital Unix 4.0E
> Submission from: (NULL) (212.17.104.62)
> 
> 
> Plottimg on the Alpha stopped working with 0.65.0.
> 
> The tickmarks have a length of -Inf and go across the whole 
> plot.

I've seen the problem on Solaris when make decided to re-configure
and so parts of R got compiled with different compiler options (as under
re-configuration different environmental variables were set). But for me
the problem seems to be getting NaN.

> A first solution is the following patch:
> 
> --- src/main/plot.c.alpha-patch Mon Sep 13 01:37:11 1999
> +++ src/main/plot.c     Mon Sep 13 01:58:16 1999
> @@ -832,7 +832,7 @@
>         }
>         dd->gp.col = fg;
>         GLine(REAL(at)[0], y, REAL(at)[n - 1], y, USER, dd);
> -       if (R_FINITE(dd->gp.tck)) {
> +       if (R_FINITE(dd->gp.tck) && !(ISNAN(dd->gp.tck))) {
>             /* The S way of doing ticks */
>             double y0, y1;
>             if (dd->gp.tck > 0.5) {

....

I'm puzzled.  Are you saying -Inf passes R_FINITE and passes ISNAN? (Wow!,
if so,) In any case, let us try and fix the macros (which crop up in many
places) not two instances.

There are too many options in Arith.h to guess: can you please tell us
what path is being taken (HAVE_FINITE, IEEE_754, FINITE_BROKEN, ...).

I believe this can all be tested from interpreted R code. I believe you
should get  (is.na(c(2.0, Inf, -Inf, NaN, NA)) etc)
           2.0 Inf -Inf NaN NA
is.na       F   F    F   T   T
is.finite   T   F    F   F   F
is.infinite F   T    T   F   F
is.nan      F   F    F   T   F

(Martin: I can't see this is checked in the tests explicitly. Should we add
it?)  Note though that is.na tests ISNAN and is.nan tests R_IsNaN, but
is.finite does test R_FINITE.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Mon Sep 13 09:57:22 1999
From: albrecht.gebhardt@uni-klu.ac.at (albrecht.gebhardt@uni-klu.ac.at)
Date: Mon, 13 Sep 1999 10:57:22 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909130857.KAA20105@pubhealth.ku.dk>

On Mon, 13 Sep 1999, Prof Brian D Ripley wrote:

> On Mon, 13 Sep 1999 albrecht.gebhardt@uni-klu.ac.at wrote:
> 
> > Full_Name: Albrecht Gebhardt
> > Version: 0.65.0
> > OS: Digital Unix 4.0E
> > Submission from: (NULL) (212.17.104.62)
> > 
> > 
> > Plottimg on the Alpha stopped working with 0.65.0.
> > 
> > The tickmarks have a length of -Inf and go across the whole 
> > plot.
> 
> I've seen the problem on Solaris when make decided to re-configure
> and so parts of R got compiled with different compiler options (as under
> re-configuration different environmental variables were set). But for me
> the problem seems to be getting NaN.

Yes it was NaN and not -Inf! Sorry

> 
> > A first solution is the following patch:
> > 
> > --- src/main/plot.c.alpha-patch Mon Sep 13 01:37:11 1999
> > +++ src/main/plot.c     Mon Sep 13 01:58:16 1999
> > @@ -832,7 +832,7 @@
> >         }
> >         dd->gp.col = fg;
> >         GLine(REAL(at)[0], y, REAL(at)[n - 1], y, USER, dd);
> > -       if (R_FINITE(dd->gp.tck)) {
> > +       if (R_FINITE(dd->gp.tck) && !(ISNAN(dd->gp.tck))) {
> >             /* The S way of doing ticks */
> >             double y0, y1;
> >             if (dd->gp.tck > 0.5) {
> 
> ....
> 
> I'm puzzled.  Are you saying -Inf passes R_FINITE and passes ISNAN? (Wow!,
> if so,) In any case, let us try and fix the macros (which crop up in many
> places) not two instances.

NaN passed R_FINITE (see above). Then it gets multiplied by some values
and serves as tickmark length.

> 
> There are too many options in Arith.h to guess: can you please tell us
> what path is being taken (HAVE_FINITE, IEEE_754, FINITE_BROKEN, ...).
in src/include/Rconfig.h:
/* Floating Point Arithmetic */
/* #undef HAVE_MATHERR */               /* System V */
#define HAVE_ISNAN 1            /* IEEE Arith indicator */
#define HAVE_FINITE 1                                                           
                                                                                
/* #undef HAVE_FLOATINGPOINT_H */                                               
/* #undef HAVE_FPU_CONTROL_H */                                                 
/* #undef HAVE_IEEEFP_H */              /* "-Wall" */                           
/* #undef HAVE_IEEE754_H */             /* Linux */                             
                                                                                
#ifdef HAVE_ISNAN                                                               
#ifdef HAVE_FINITE                                                              
#define IEEE_754                                                                
#endif                                                                          
#endif                                                                        

and some lines below:
/* Bug Workarounds */
/* #undef HAVE_OSF_SPRINTF_BUG */
#define CALLOC_BROKEN 1
#define FINITE_BROKEN 1                                                         
#define LOG_BROKEN 1                                                            


> 
> I believe this can all be tested from interpreted R code. I believe you
> should get  (is.na(c(2.0, Inf, -Inf, NaN, NA)) etc)
>            2.0 Inf -Inf NaN NA
> is.na       F   F    F   T   T
> is.finite   T   F    F   F   F
> is.infinite F   T    T   F   F
> is.nan      F   F    F   T   F


> is.na(c(2.0, Inf, -Inf, NaN, NA))                                             
[1] FALSE FALSE FALSE  TRUE  TRUE                                               
> is.finite(c(2.0, Inf, -Inf, NaN, NA))                                         
[1] TRUE TRUE TRUE TRUE TRUE                                                    
> is.infinite(c(2.0, Inf, -Inf, NaN, NA))                                       
[1] FALSE FALSE FALSE FALSE FALSE                                               
> is.nan(c(2.0, Inf, -Inf, NaN, NA))                                            
[1] FALSE FALSE FALSE  TRUE FALSE          

Seems that everything is R_FINITE!

> (Martin: I can't see this is checked in the tests explicitly. Should we add
> it?)  Note though that is.na tests ISNAN and is.nan tests R_IsNaN, but
> is.finite does test R_FINITE.
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 

-------------------------------------------------------------------------------
Albrecht Gebhardt                   email   : albrecht.gebhardt@uni-klu.ac.at
Institut fuer Mathematik            Tel.    : (++43 463) 2700/837
Universitaet Klagenfurt             Fax     : (++43 463) 2700/834
Villacher Str. 161
A-9020 Klagenfurt, Austria
-------------------------------------------------------------------------------



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Sep 13 16:41:07 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon, 13 Sep 1999 17:41:07 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909131541.RAA27086@pubhealth.ku.dk>


> Date: Mon, 13 Sep 1999 10:57:23 +0200 (MET DST)
> From: Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at>
> 
> On Mon, 13 Sep 1999, Prof Brian D Ripley wrote:

[...]

> > I'm puzzled.  Are you saying -Inf passes R_FINITE and passes ISNAN? (Wow!,
> > if so.) In any case, let us try and fix the macros (which crop up in many
> > places) not two instances.
> 
> NaN passed R_FINITE (see above). Then it gets multiplied by some values
> and serves as tickmark length.
> 
> > 
> > There are too many options in Arith.h to guess: can you please tell us
> > what path is being taken (HAVE_FINITE, IEEE_754, FINITE_BROKEN, ...).

> in src/include/Rconfig.h:
> /* Floating Point Arithmetic */
> /* #undef HAVE_MATHERR */               /* System V */
> #define HAVE_ISNAN 1            /* IEEE Arith indicator */
> #define HAVE_FINITE 1                                                           
>                                                                                 
> /* #undef HAVE_FLOATINGPOINT_H */                                               
> /* #undef HAVE_FPU_CONTROL_H */                                                 
> /* #undef HAVE_IEEEFP_H */              /* "-Wall" */                           
> /* #undef HAVE_IEEE754_H */             /* Linux */                             
>                                                                                 
> #ifdef HAVE_ISNAN                                                               
> #ifdef HAVE_FINITE                                                              
> #define IEEE_754                                                                
> #endif                                                                          
> #endif                                                                        
> 
> and some lines below:
> /* Bug Workarounds */
> /* #undef HAVE_OSF_SPRINTF_BUG */
> #define CALLOC_BROKEN 1
> #define FINITE_BROKEN 1                                                         
> #define LOG_BROKEN 1                                                            
> 
> 
> > 
> > I believe this can all be tested from interpreted R code. I believe you
> > should get  (is.na(c(2.0, Inf, -Inf, NaN, NA)) etc)
> >            2.0 Inf -Inf NaN NA
> > is.na       F   F    F   T   T
> > is.finite   T   F    F   F   F
> > is.infinite F   T    T   F   F
> > is.nan      F   F    F   T   F
> 
> 
> > is.na(c(2.0, Inf, -Inf, NaN, NA))                                             
> [1] FALSE FALSE FALSE  TRUE  TRUE                                               
> > is.finite(c(2.0, Inf, -Inf, NaN, NA))                                         
> [1] TRUE TRUE TRUE TRUE TRUE                                                    
> > is.infinite(c(2.0, Inf, -Inf, NaN, NA))                                       
> [1] FALSE FALSE FALSE FALSE FALSE                                               
> > is.nan(c(2.0, Inf, -Inf, NaN, NA))                                            
> [1] FALSE FALSE FALSE  TRUE FALSE          
> 
> Seems that everything is R_FINITE!

[...]

OK, so I think you are at the line

#   define R_FINITE(x)          ((x) != R_NaReal)

in Arith.h, and that is clearly inadequate (although it should have
caught the NA, I think). Can you please try replacing that line by

    static int R_FINITE(double x) {
        return !isnan(x) & (x != R_PosInf) & (x != R_NegInf); 
    }

and try those tests again.

(Kurt: looks like finite can be broken in more ways than one. I suggest
return(finite(1./0.) & finite(0./0.) & finite(-1./0.)) in aclocal.m4,
and if FINITE_BROKEN going directly to some function like the above, and not
trying to be efficient, just right!)


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Mon Sep 13 17:08:40 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon, 13 Sep 1999 18:08:40 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909131608.SAA27354@pubhealth.ku.dk>

>>>>> On Mon, 13 Sep 1999 17:41:07 +0200 (MET DST), ripley@stats.ox.ac.uk (Brian D. Ripley) said:

    >> Date: Mon, 13 Sep 1999 10:57:23 +0200 (MET DST)
    >> From: Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at>
    >>
    >> On Mon, 13 Sep 1999, Prof Brian D Ripley wrote:

    BDR> [...]

    BDR> I'm puzzled.  Are you saying -Inf passes R_FINITE and passes
    BDR> ISNAN? (Wow!, if so.) In any case, let us try and fix the macros
    BDR> (which crop up in many places) not two instances.
    BDR>
    >> NaN passed R_FINITE (see above). Then it gets multiplied by some
    >> values and serves as tickmark length.
    >>
    >> >
    >> > There are too many options in Arith.h to guess: can you please tell us
    >> > what path is being taken (HAVE_FINITE, IEEE_754, FINITE_BROKEN, ...).

    >> in src/include/Rconfig.h:
    >> /* Floating Point Arithmetic */
    >> /* #undef HAVE_MATHERR */               /* System V */
    >> #define HAVE_ISNAN 1            /* IEEE Arith indicator */
    >> #define HAVE_FINITE 1
    >>
    >> /* #undef HAVE_FLOATINGPOINT_H */
    >> /* #undef HAVE_FPU_CONTROL_H */
    >> /* #undef HAVE_IEEEFP_H */              /* "-Wall" */
    >> /* #undef HAVE_IEEE754_H */             /* Linux */
    >>
    >> #ifdef HAVE_ISNAN
    >> #ifdef HAVE_FINITE
    >> #define IEEE_754
    >> #endif
    >> #endif
    >>
    >> and some lines below:
    >> /* Bug Workarounds */
    >> /* #undef HAVE_OSF_SPRINTF_BUG */
    >> #define CALLOC_BROKEN 1
    >> #define FINITE_BROKEN 1
    >> #define LOG_BROKEN 1
    >>
    >>
    >> >
    >> > I believe this can all be tested from interpreted R code. I believe you
    >> > should get  (is.na(c(2.0, Inf, -Inf, NaN, NA)) etc)
    >> >            2.0 Inf -Inf NaN NA
    >> > is.na       F   F    F   T   T
    >> > is.finite   T   F    F   F   F
    >> > is.infinite F   T    T   F   F
    >> > is.nan      F   F    F   T   F
    >>
    >>
    >> > is.na(c(2.0, Inf, -Inf, NaN, NA))
    >> [1] FALSE FALSE FALSE  TRUE  TRUE
    >> > is.finite(c(2.0, Inf, -Inf, NaN, NA))
    >> [1] TRUE TRUE TRUE TRUE TRUE
    >> > is.infinite(c(2.0, Inf, -Inf, NaN, NA))
    >> [1] FALSE FALSE FALSE FALSE FALSE
    >> > is.nan(c(2.0, Inf, -Inf, NaN, NA))
    >> [1] FALSE FALSE FALSE  TRUE FALSE
    >>
    >> Seems that everything is R_FINITE!

    BDR> [...]

    BDR> OK, so I think you are at the line

    BDR> #   define R_FINITE(x)          ((x) != R_NaReal)

    BDR> in Arith.h, and that is clearly inadequate (although it should have
    BDR> caught the NA, I think). Can you please try replacing that line by

    BDR> static int R_FINITE(double x) {
    BDR> return !isnan(x) & (x != R_PosInf) & (x != R_NegInf);
    BDR> }

    BDR> and try those tests again.

    BDR> (Kurt: looks like finite can be broken in more ways than one. I suggest
    BDR> return(finite(1./0.) & finite(0./0.) & finite(-1./0.)) in aclocal.m4,

shouldn't this be "|" instead of "&"   [broken if either is finite] ?

    BDR> and if FINITE_BROKEN going directly to some function like the
    BDR> above, and not trying to be efficient, just right!)
{weak voice in the background:
 it may be worth tyring to be both right and efficient ..
 but I agree that "right" is much more important!
}

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Sep 13 18:08:06 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon, 13 Sep 1999 19:08:06 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909131708.TAA27650@pubhealth.ku.dk>

On Mon, 13 Sep 1999, Martin Maechler wrote:

> >>>>> On Mon, 13 Sep 1999 17:41:07 +0200 (MET DST), ripley@stats.ox.ac.uk (Brian D. Ripley) said:
> 
>     >> Date: Mon, 13 Sep 1999 10:57:23 +0200 (MET DST)
>     >> From: Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at>
>     >>
>     >> On Mon, 13 Sep 1999, Prof Brian D Ripley wrote:
> 
>     BDR> [...]
> 
>     BDR> I'm puzzled.  Are you saying -Inf passes R_FINITE and passes
>     BDR> ISNAN? (Wow!, if so.) In any case, let us try and fix the macros
>     BDR> (which crop up in many places) not two instances.
>     BDR>
>     >> NaN passed R_FINITE (see above). Then it gets multiplied by some
>     >> values and serves as tickmark length.
>     >>
>     >> >
>     >> > There are too many options in Arith.h to guess: can you please tell us
>     >> > what path is being taken (HAVE_FINITE, IEEE_754, FINITE_BROKEN, ...).
> 
>     >> in src/include/Rconfig.h:
>     >> /* Floating Point Arithmetic */
>     >> /* #undef HAVE_MATHERR */               /* System V */
>     >> #define HAVE_ISNAN 1            /* IEEE Arith indicator */
>     >> #define HAVE_FINITE 1
>     >>
>     >> /* #undef HAVE_FLOATINGPOINT_H */
>     >> /* #undef HAVE_FPU_CONTROL_H */
>     >> /* #undef HAVE_IEEEFP_H */              /* "-Wall" */
>     >> /* #undef HAVE_IEEE754_H */             /* Linux */
>     >>
>     >> #ifdef HAVE_ISNAN
>     >> #ifdef HAVE_FINITE
>     >> #define IEEE_754
>     >> #endif
>     >> #endif
>     >>
>     >> and some lines below:
>     >> /* Bug Workarounds */
>     >> /* #undef HAVE_OSF_SPRINTF_BUG */
>     >> #define CALLOC_BROKEN 1
>     >> #define FINITE_BROKEN 1
>     >> #define LOG_BROKEN 1
>     >>
>     >>
>     >> >
>     >> > I believe this can all be tested from interpreted R code. I believe you
>     >> > should get  (is.na(c(2.0, Inf, -Inf, NaN, NA)) etc)
>     >> >            2.0 Inf -Inf NaN NA
>     >> > is.na       F   F    F   T   T
>     >> > is.finite   T   F    F   F   F
>     >> > is.infinite F   T    T   F   F
>     >> > is.nan      F   F    F   T   F
>     >>
>     >>
>     >> > is.na(c(2.0, Inf, -Inf, NaN, NA))
>     >> [1] FALSE FALSE FALSE  TRUE  TRUE
>     >> > is.finite(c(2.0, Inf, -Inf, NaN, NA))
>     >> [1] TRUE TRUE TRUE TRUE TRUE
>     >> > is.infinite(c(2.0, Inf, -Inf, NaN, NA))
>     >> [1] FALSE FALSE FALSE FALSE FALSE
>     >> > is.nan(c(2.0, Inf, -Inf, NaN, NA))
>     >> [1] FALSE FALSE FALSE  TRUE FALSE
>     >>
>     >> Seems that everything is R_FINITE!
> 
>     BDR> [...]
> 
>     BDR> OK, so I think you are at the line
> 
>     BDR> #   define R_FINITE(x)          ((x) != R_NaReal)
> 
>     BDR> in Arith.h, and that is clearly inadequate (although it should have
>     BDR> caught the NA, I think). Can you please try replacing that line by
> 
>     BDR> static int R_FINITE(double x) {
>     BDR> return !isnan(x) & (x != R_PosInf) & (x != R_NegInf);
>     BDR> }
> 
>     BDR> and try those tests again.
> 
>     BDR> (Kurt: looks like finite can be broken in more ways than one. I suggest
>     BDR> return(finite(1./0.) & finite(0./0.) & finite(-1./0.)) in aclocal.m4,
> 
> shouldn't this be "|" instead of "&"   [broken if either is finite] ?

Um. Yes, I think so: the man page is almost impossible to decipher, and
I had read it reversed.

> {weak voice in the background:
>  it may be worth tyring to be both right and efficient ..
>  but I agree that "right" is much more important!

Not, I think, on platforms where the inbuilt ways are broken.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Sep 14 10:12:11 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 14 Sep 1999 11:12:11 +0200
Subject: cin et al
In-Reply-To: <199909140850.KAA14277@fangorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 14 Sep 1999 10:50:50 +0200)
References: <199909140850.KAA14277@fangorn.ci.tuwien.ac.at>
Message-ID: <199909140912.LAA09141@sophie.ethz.ch>

In a more private mail,
>>>>> "KH" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    KH> Currently,
    KH>		opar <- par()
    KH>		par(opar)
    KH> gives

    KH> Warning messages: 
    KH> 1: parameter "cin" can't be set in: par(args) 
    KH> 2: parameter "cra" can't be set in: par(args) 
    KH> 3: parameter "csi" can't be set in: par(args) 
    KH> 4: parameter "din" can't be set in: par(args) 

That's why we have

      opar <- par(no.readonly = TRUE)
      par(opar)

Only last weekend, when trying to polish "p.sunflowers(),
I read a (latex) printout of ?par

and found several things that I want to add/improve.
The above example is one of them.

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Sep 14 15:18:08 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue, 14 Sep 1999 16:18:08 +0200 (MET DST)
Subject: R with a broken finite() (was [R] Problems with R-0.65.0) (PR#275)
Message-ID: <199909141418.QAA06974@pubhealth.ku.dk>

[Copied to R-bugs so it goes into the database.]

On Mon, 13 Sep 1999, Ralf Herbrich wrote:

> 
> Hello,
> 
> I installed the new release 0.65.0 of R on our local Solaris system. As I
> already (and sucessfully) installed the 0.64.0 and 0.64.1 version of R, I
> hadn't had any trouble during the installation. But as I've started R in
> order to see the demo I've got horizontal and vertical lines goint to the
> left and top of the X11 window at each tick (demo ("graphics")). This
> seems not to be a grid but is now standard in any 2D plot (I also tried
> several of my own R programs). Furthermore, the exported postscripts
> (dev.print (file="blabla.ps")) can't be displayed by ghostscript.
> 
> What did I wrong during the installation?

To follow up on this, Ralf was using Solaris 2.6 and 

gcc version egcs-2.91.63 19990224 (egcs-1.1.2 pre-release-3)

which is probably not a good idea, being an old pre-release (gcc 2.8.1,
real egcs-1.1.2 and gcc-2.95.1 have all been tried).  This reported that
calloc and finite are broken on Solaris 2.6, and they are not on other
systems, so it seems more likely that the compiler is broken.

If you find a system with HAVE_FINITE and FINITE_BROKEN defined, then R
will not work correctly (unless it uses the AIX workaround). The fix I
suggested to Ralf worked, and will probably be incorporated in 0.65.1
(unless we find a better one).

Try replacing the line

#   define R_FINITE(x)          ((x) != R_NaReal)

in Arith.h by

static int R_FINITE(double x) {
    return !isnan(x) & (x != R_PosInf) & (x != R_NegInf); }


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Tue Sep 14 17:02:10 1999
From: albrecht.gebhardt@uni-klu.ac.at (Albrecht Gebhardt)
Date: Tue, 14 Sep 1999 18:02:10 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
In-Reply-To: <199909131541.RAA27086@pubhealth.ku.dk>
Message-ID: <Pine.OSF.4.10.9909141736540.2679-100000@zidsrv.sci.uni-klu.ac.at>

On Mon, 13 Sep 1999 ripley@stats.ox.ac.uk wrote:

> 
> > Date: Mon, 13 Sep 1999 10:57:23 +0200 (MET DST)
> > From: Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at>
> > 
> > On Mon, 13 Sep 1999, Prof Brian D Ripley wrote:
> 
> [...]
> ....
> [...]
> 
> OK, so I think you are at the line
> 
> #   define R_FINITE(x)          ((x) != R_NaReal)
> 
> in Arith.h, and that is clearly inadequate (although it should have
> caught the NA, I think). Can you please try replacing that line by
> 
>     static int R_FINITE(double x) {
>         return !isnan(x) & (x != R_PosInf) & (x != R_NegInf); 
>     }
> 
> and try those tests again.
ok, this works. Now I get even further with "make test". This stopped 
somewhere with a "GPretty[Inf, ...]" error, which was obvoiusly also
caused be R_FINITE. 

The patch is now:
--- ./src/include/Arith.h.finite-patch  Tue Sep 14 16:31:16 1999
+++ ./src/include/Arith.h       Tue Sep 14 16:32:12 1999
@@ -81,7 +81,13 @@
         return FINITE(x);      /* NOTE: macro does not work.  */
     }
 #  else
-#   define R_FINITE(x)         ((x) != R_NaReal)
+#   ifdef __osf__
+    static int R_FINITE(double x) {
+        return !isnan(x) & (x != R_PosInf) & (x != R_NegInf); 
+    }
+#   else
+#    define R_FINITE(x)                ((x) != R_NaReal)
+#   endif
 #  endif
 # endif

Albrecht

PS:
"make test" still fails, the last lines of tests/Examples/base-Ex.Rout
are
#### snip ################
> chisq.test(InsectSprays$count > 7, InsectSprays$spray)$obs
       y
x        A  B  C  D  E  F
  FALSE  1  1 12 11 12  0
  TRUE  11 11  0  1  0 12
>                                 # Counts expected under the null
>
> ## Effect of simulating p-values
> x <- matrix(c(12, 5, 7, 7), nc = 2)
> chisq.test(x)$p.value           # 0.4233
[1] 0.4233054
###################### snip
I can't see an error here. Or could the error be hidden somewhere before
this point? base-Ex.Rout is quite large, 4154 lines.
.... stop, now I got it, its a memory problem:
Running all help() examples ...
../../bin/R --vanilla < base-Ex.R > base-Ex.Rout
/bin/sh: 303 Memory fault
make[3]: *** [base-Ex.Rout] Error 139
make[3]: Leaving directory
`/usr/local/src/redhat/BUILD/R-0.65.0/tests/Examples'
make[2]: *** [test-Examples] Error 2
make[2]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
make[1]: *** [test-All] Error 2
make[1]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
make: *** [test-All] Error 2
I have to go to another machine, my alpha at home as only 256MB, and swap
space is also very small.
Or should I run the tests with memory specifications from command line? 

Wouldn't it be a good idea to have "make test" running each example in a
several R process? I think I could avoid this memory fault this way. I
guess the reasons for the memory fault is a bad kernel configuration
(wrong ulimit values) and/or wrong swap space configuration and not within
R.
But on the other hand the error is reproduceable with R stopping at
exactly the same line.  

-------------------------------------------------------------------------------
Albrecht Gebhardt                   email   : albrecht.gebhardt@uni-klu.ac.at
Institut fuer Mathematik            Tel.    : (++43 463) 2700/837
Universitaet Klagenfurt             Fax     : (++43 463) 2700/834
Villacher Str. 161
A-9020 Klagenfurt, Austria
-------------------------------------------------------------------------------


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Sep 14 17:23:16 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 14 Sep 1999 18:23:16 +0200
Subject: axis() produces junk on DEC alpha (PR#274)
In-Reply-To: Albrecht Gebhardt's message of "Tue, 14 Sep 1999 18:02:10 +0200 (MET DST)"
References: <Pine.OSF.4.10.9909141736540.2679-100000@zidsrv.sci.uni-klu.ac.at>
Message-ID: <x27lltbgy3.fsf@blueberry.kubism.ku.dk>

Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at> writes:

> this point? base-Ex.Rout is quite large, 4154 lines.
> .... stop, now I got it, its a memory problem:
> Running all help() examples ...
> ../../bin/R --vanilla < base-Ex.R > base-Ex.Rout
> /bin/sh: 303 Memory fault
> make[3]: *** [base-Ex.Rout] Error 139
> make[3]: Leaving directory
> `/usr/local/src/redhat/BUILD/R-0.65.0/tests/Examples'
> make[2]: *** [test-Examples] Error 2
> make[2]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
> make[1]: *** [test-All] Error 2
> make[1]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
> make: *** [test-All] Error 2
> I have to go to another machine, my alpha at home as only 256MB, and swap
> space is also very small.
> Or should I run the tests with memory specifications from command line? 

Shouldn't be necessary with the current defaults 256MB should be
plenty. 

Sometimes output buffers don't flush, so what is the last line of

 ../../bin/R --vanilla < base-Ex.R

> Wouldn't it be a good idea to have "make test" running each example in a
> several R process? I think I could avoid this memory fault this way. I
> guess the reasons for the memory fault is a bad kernel configuration
> (wrong ulimit values) and/or wrong swap space configuration and not within
> R.

But would it complete in finite time? There are a *lot* of examples,
you know....



-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Tue Sep 14 20:24:15 1999
From: albrecht.gebhardt@uni-klu.ac.at (Albrecht Gebhardt)
Date: Tue, 14 Sep 1999 20:24:15 +0100 (GMT+0100)
Subject: chisqsim broken on alpha (was Re: axis() produces junk on DEC alpha
 (PR#274))
In-Reply-To: <x27lltbgy3.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.OSF.4.05.9909142017460.13670-100000@delta.fuzzy.at>

On 14 Sep 1999, Peter Dalgaard BSA wrote:

> Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at> writes:
> 
> > this point? base-Ex.Rout is quite large, 4154 lines.
> > .... stop, now I got it, its a memory problem:
> > Running all help() examples ...
> > ../../bin/R --vanilla < base-Ex.R > base-Ex.Rout
> > /bin/sh: 303 Memory fault
> > make[3]: *** [base-Ex.Rout] Error 139
> > make[3]: Leaving directory
> > `/usr/local/src/redhat/BUILD/R-0.65.0/tests/Examples'
> > make[2]: *** [test-Examples] Error 2
> > make[2]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
> > make[1]: *** [test-All] Error 2
> > make[1]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
> > make: *** [test-All] Error 2
> > I have to go to another machine, my alpha at home as only 256MB, and swap
> > space is also very small.
> > Or should I run the tests with memory specifications from command line? 
> 
> Shouldn't be necessary with the current defaults 256MB should be
> plenty. 
> 
> Sometimes output buffers don't flush, so what is the last line of
> 
>  ../../bin/R --vanilla < base-Ex.R
> 

You were right, I found a next bug for R on alpha:

chisqsim (called from chisq.test() crashes. First I found that the crash
is at 
chisqsim.c:167
167             fact[i] = x;

but after placing a breakpoint here I could go some lines further and
reach
chisqsim.c:72
72                  x = exp(fact[iap - 1] + fact[ib] + fact[ic] +

The following is a log of my gdb-session: 

root@delta[Examples]# ../../bin/R --vanilla < base-Ex.R   
...
> x <- matrix(c(12, 5, 7, 7), nc = 2)
> chisq.test(x)$p.value           # 0.4233
[1] 0.4233054
> chisq.test(x, simulate.p.value = TRUE, B = 10000)$p.value
Segmentation fault (core dumped)
root@delta[Examples]# gdb -c core ../../bin/R.X11 -d ../../src/nmath/ -d ../../src/main/ -d ../../src/appl/
GNU gdb 4.17
Copyright 1998 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "alphaev56-dec-osf4.0d"...
Core was generated by `R.X11'.
Program terminated with signal 11, Segmentation fault.
Reading symbols from /usr/shlib/libSM.so...done.
Reading symbols from /usr/shlib/libICE.so...done.
Reading symbols from /usr/shlib/libX11.so...done.
Reading symbols from /usr/shlib/libdnet_stub.so...done.
Reading symbols from /usr/shlib/libUfor.so...done.
Reading symbols from /usr/shlib/libfor.so...done.
Reading symbols from /usr/shlib/libFutil.so...done.
Reading symbols from /usr/shlib/libm.so...done.
Reading symbols from /usr/shlib/libots.so...done.
Reading symbols from /usr/local/lib/libreadline.so.3...done.
Reading symbols from /usr/local/lib/libncurses.so.4...done.
Reading symbols from /usr/shlib/libc.so...done.
Reading symbols from /usr/local/src/redhat/BUILD/R-0.65.0/library/eda/libs/eda.s
o...done.
---Type <return> to continue, or q <return> to quit---
#0  0x12010a280 in chisqsim (nrow=0x140ff92d0, ncol=0x140ff92c8,
    nrowt=0x140ff92c0, ncolt=0x140ff92b8, n=0x140ff92b0, b=0x140ff92a8,
    expected=0x140ff9288, observed=0x140ff9278, fact=0x140ff9178,
    jwork=0x140ff9170, results=0x140fe58f0) at chisqsim.c:167
167             fact[i] = x;
(gdb) set env R_HOME /usr/local/src/redhat/BUILD/R-0.65.0
(gdb) break chisqsim.c:167
(gdb) run
Starting program: /usr/local/src/redhat/BUILD/R-0.65.0/tests/Examples/../../bin/R.X11

R : Copyright 1999, The R Development Core Team
Version 0.65.0  (August 27, 1999)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type    "?license" or "?licence" for distribution details.

R is a collaborative project with many contributors.
Type    "?contributors" for a list.

Type    "demo()" for some demos, "help()" for on-line help, or
        "help.start()" for a HTML browser interface to help.
Type    "q()" to quit R.

>  x <- matrix(c(12, 5, 7, 7), nc = 2)
> chisq.test(x)$p.valu
[1] 0.4233054
> chisq.test(x, simulate.p.value = TRUE, B = 10000)$p.value 

Breakpoint 1, chisqsim (nrow=0x140ff9ed8, ncol=0x140ff9ed0, nrowt=0x140ff9ec8,
    ncolt=0x140ff9ec0, n=0x140ff9eb8, b=0x140ff9eb0, expected=0x140ff9e90,
    observed=0x140ff9e80, fact=0x140ff9d80, jwork=0x140ff9d78,
    results=0x140fe64f8) at chisqsim.c:167
167             fact[i] = x;
(gdb) print x
$1 = 0
(gdb) print fact
$2 = (double *) 0x140ff9d80
(gdb) print *fact
$3 = 0
(gdb) step
165         for (i = 1; i <= *n; ++i) {
(gdb)
168         }
.....
(gdb) cont
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x120109e24 in rcont2 (nrow=0x140ff9ed8, ncol=0x140ff9ed0, nrowt=0x140ff9ec0,
    ncolt=0x140ff9eb8, ntotal=0x140ff9eb8, fact=0x140ff9d80,
    jwork=0x140ff9d70, matrix=0x140ff9e68) at chisqsim.c:72
72                  x = exp(fact[iap - 1] + fact[ib] + fact[ic] +
(gdb) print x
$7 = 0
(gdb) print iap
$8 = 51539607572
(gdb) print ib
$9 = -51539607540
(gdb) print ic
$10 = -60129542130
(gdb) list
67                  idp = id + 1;
68                  igp = idp - nlm;
69                  ihp = iap - nlm;
70                  nlmp = nlm + 1;
71                  iip = ii + nlmp;
72                  x = exp(fact[iap - 1] + fact[ib] + fact[ic] +
73                          fact[idp - 1] - fact[ie] - fact[nlmp - 1] -
74                          fact[igp - 1] - fact[ihp - 1] - fact[iip - 1]);
75                  if (x >= dummy) {
76                      goto L160;
(gdb) print nlmp
$11 = 65117246112
(gdb) print iip
$12 = -46551903589
(gdb) print igp
$13 = -4987703949
(gdb) print ihp
$14 = -13577638539
(gdb) print id
$15 = 60129542161
(gdb) print nlm
$16 = 65117246111
(gdb) q
The program is running.  Exit anyway? (y or n) y


Albrecht

......................................................................
| Albrecht Gebhardt          Tel.: (++43 463) 2700/837               |
| Institut fuer Mathematik   Fax : (++43 463) 2700/834               |
| Universitaet Klagenfurt    mailto:albrecht.gebhardt@uni-klu.ac.at  |
| Villacher Str. 161         http://www-stat.uni-klu.ac.at/~agebhard |
| A-9020 Klagenfurt, Austria                                         |
`--------------------------------------------------------------------'

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Sep 15 08:19:28 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 15 Sep 1999 09:19:28 +0200 (MET DST)
Subject: chisqsim broken on alpha (was Re: axis() produces junk on DEC (PR#276)
Message-ID: <199909150719.JAA10993@pubhealth.ku.dk>

On Tue, 14 Sep 1999, Albrecht Gebhardt wrote:

[...]

> chisqsim (called from chisq.test() crashes. First I found that the crash
> is at 
> chisqsim.c:167
> 167             fact[i] = x;

[...]

chisqsum.c has its interface in terms of long *, called by .C that supplies
int *. I think those are different on an Alpha.  Could you please
edit long to int in that file and try again.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Wed Sep 15 14:33:09 1999
From: albrecht.gebhardt@uni-klu.ac.at (albrecht.gebhardt@uni-klu.ac.at)
Date: Wed, 15 Sep 1999 15:33:09 +0200 (MET DST)
Subject: chisqsim broken on alpha - solved + next bug in fft found (PR#277)
Message-ID: <199909151333.PAA17503@pubhealth.ku.dk>

On Wed, 15 Sep 1999 ripley@stats.ox.ac.uk wrote:

> On Tue, 14 Sep 1999, Albrecht Gebhardt wrote:
> 
> [...]
> 
> > chisqsim (called from chisq.test() crashes. First I found that the crash
> > is at 
> > chisqsim.c:167
> > 167             fact[i] = x;
> 
> [...]
> 
> chisqsum.c has its interface in terms of long *, called by .C that supplies
> int *. I think those are different on an Alpha.  Could you please
> edit long to int in that file and try again.
> 
> Brian
> 

Yes this helps.
The patch is:
--- ./src/appl/chisqsim.c.chisqsim-patch        Wed Sep 15 09:17:56 1999
+++ ./src/appl/chisqsim.c       Wed Sep 15 14:30:56 1999
@@ -11,10 +11,15 @@
 #include "S.h"
 
 static void
+#ifdef __osf__
+rcont2(int *nrow, int *ncol, int *nrowt, int *ncolt, int *ntotal,
+       double *fact, int *jwork, int *matrix)
+#else
 rcont2(long *nrow, long *ncol, long *nrowt, long *ncolt, long *ntotal,
        double *fact, long *jwork, long *matrix) 
+#endif
 {
-    long nlmp, j, l, m, ia, ib, ic, jc, id, ie, ii, nrowtl, iap, idp,
+    int nlmp, j, l, m, ia, ib, ic, jc, id, ie, ii, nrowtl, iap, idp,
        igp, ihp, iip, nll, nlm, nrowm, ncolm, lsm, lsp;
     double x, y, dummy, sumprb;
 
@@ -151,12 +156,18 @@
    */
 
 void
+#ifdef __osf__
+chisqsim(int *nrow, int *ncol, int *nrowt, int *ncolt, int *n,
+        int *b, double *expected, int *observed, double *fact,
+        int *jwork, double *results)
+#else
 chisqsim(long *nrow, long *ncol, long *nrowt, long *ncolt, long *n,
         long *b, double *expected, long *observed, double *fact,
         long *jwork, double *results)
+#endif
 {
     /* Local variables */
-    long i, j, iter;
+    int i, j, iter;
     double chi, e, o, x;
 
     /* Calculate log-factorials */


And I get to the next bug:

> data(faithful)
> x <- xx <- faithful$eruptions
> x[i.out <- sample(length(x), 10)] <- NA
  I modifed this to 
  x[i.out <- c(1,10,20,50,100,200)] <- NA
> doR <- density(x, bw=0.15, na.rm = TRUE) # works
> doN <- density(x, bw=0.15, na.rm = FALSE)
segfault at approx.c: 

    for(i=0 ; i<*nxy ; i++)
	if(ISNA(x[i]) || ISNA(y[i]))
	    error("approx(): attempted to interpolate NA values\n");

Both x and y are NULL pointers. 
The error is somewhere before, comparing with R on SuSE 5.3:
somewhere in density():

debug: kords[(n + 2):(2 * n)] <- -kords[n:2]
linux and osf both get:
kords
[1]  0.00000000  0.01094819  0.02189638  0.03284457  0.04379277 ...
[1021] -0.04379277 -0.03284457 -0.02189638 -0.01094819

then in the following if-statement we go to
debug: kords <- convolve(y, kords)[1:n]
with linux result
kords
  [1] 2.523589e-13 4.199167e-13 6.950994e-13 1.144613e-12 ...
[511] 5.032797e-13 3.017881e-13
and alpha:
kords
  [1] NA NA NA NA NA NA NA NA ...
[501] NA NA NA NA NA NA NA NA NA NA NA NA
... now on the alpha x and y are set to numeric(0) and approx is called
with this arguments, bang.

Now in convolve(x,y) on entry x=y and y=kords on linux and osf are
identical.
x:
   [1] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00  ...
 [151] 4.866728e-03 6.204044e-03 3.258272e-03 3.552390e-03 4.218750e-03
[1021] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00  ...
y:
   [1]  2.659615e+00  2.652540e+00  2.631429e+00  2.596616e+00 ...
[1021]  2.548649e+00  2.596616e+00  2.631429e+00  2.652540e+00 

now the error is in line
debug: x <- fft(fft(x) * (if (conj) Conj(fft(y)) else fft(y)), inv = TRUE)
of convolve() which returns only NAs on the alpha.

... so tomorrow I will have a look into fft.c



Albrecht

-------------------------------------------------------------------------------
Albrecht Gebhardt                   email   : albrecht.gebhardt@uni-klu.ac.at
Institut fuer Mathematik            Tel.    : (++43 463) 2700/837
Universitaet Klagenfurt             Fax     : (++43 463) 2700/834
Villacher Str. 161
A-9020 Klagenfurt, Austria
-------------------------------------------------------------------------------



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Wed Sep 15 14:33:09 1999
From: albrecht.gebhardt@uni-klu.ac.at (Albrecht Gebhardt)
Date: Wed, 15 Sep 1999 15:33:09 +0200 (MET DST)
Subject: chisqsim broken on alpha - solved + next bug in fft found
In-Reply-To: <199909150719.JAA10993@pubhealth.ku.dk>
Message-ID: <Pine.OSF.4.10.9909151410340.11553-100000@zidsrv.sci.uni-klu.ac.at>

On Wed, 15 Sep 1999 ripley@stats.ox.ac.uk wrote:

> On Tue, 14 Sep 1999, Albrecht Gebhardt wrote:
> 
> [...]
> 
> > chisqsim (called from chisq.test() crashes. First I found that the crash
> > is at 
> > chisqsim.c:167
> > 167             fact[i] = x;
> 
> [...]
> 
> chisqsum.c has its interface in terms of long *, called by .C that supplies
> int *. I think those are different on an Alpha.  Could you please
> edit long to int in that file and try again.
> 
> Brian
> 

Yes this helps.
The patch is:
--- ./src/appl/chisqsim.c.chisqsim-patch        Wed Sep 15 09:17:56 1999
+++ ./src/appl/chisqsim.c       Wed Sep 15 14:30:56 1999
@@ -11,10 +11,15 @@
 #include "S.h"
 
 static void
+#ifdef __osf__
+rcont2(int *nrow, int *ncol, int *nrowt, int *ncolt, int *ntotal,
+       double *fact, int *jwork, int *matrix)
+#else
 rcont2(long *nrow, long *ncol, long *nrowt, long *ncolt, long *ntotal,
        double *fact, long *jwork, long *matrix) 
+#endif
 {
-    long nlmp, j, l, m, ia, ib, ic, jc, id, ie, ii, nrowtl, iap, idp,
+    int nlmp, j, l, m, ia, ib, ic, jc, id, ie, ii, nrowtl, iap, idp,
        igp, ihp, iip, nll, nlm, nrowm, ncolm, lsm, lsp;
     double x, y, dummy, sumprb;
 
@@ -151,12 +156,18 @@
    */
 
 void
+#ifdef __osf__
+chisqsim(int *nrow, int *ncol, int *nrowt, int *ncolt, int *n,
+        int *b, double *expected, int *observed, double *fact,
+        int *jwork, double *results)
+#else
 chisqsim(long *nrow, long *ncol, long *nrowt, long *ncolt, long *n,
         long *b, double *expected, long *observed, double *fact,
         long *jwork, double *results)
+#endif
 {
     /* Local variables */
-    long i, j, iter;
+    int i, j, iter;
     double chi, e, o, x;
 
     /* Calculate log-factorials */


And I get to the next bug:

> data(faithful)
> x <- xx <- faithful$eruptions
> x[i.out <- sample(length(x), 10)] <- NA
  I modifed this to 
  x[i.out <- c(1,10,20,50,100,200)] <- NA
> doR <- density(x, bw=0.15, na.rm = TRUE) # works
> doN <- density(x, bw=0.15, na.rm = FALSE)
segfault at approx.c: 

    for(i=0 ; i<*nxy ; i++)
	if(ISNA(x[i]) || ISNA(y[i]))
	    error("approx(): attempted to interpolate NA values\n");

Both x and y are NULL pointers. 
The error is somewhere before, comparing with R on SuSE 5.3:
somewhere in density():

debug: kords[(n + 2):(2 * n)] <- -kords[n:2]
linux and osf both get:
kords
[1]  0.00000000  0.01094819  0.02189638  0.03284457  0.04379277 ...
[1021] -0.04379277 -0.03284457 -0.02189638 -0.01094819

then in the following if-statement we go to
debug: kords <- convolve(y, kords)[1:n]
with linux result
kords
  [1] 2.523589e-13 4.199167e-13 6.950994e-13 1.144613e-12 ...
[511] 5.032797e-13 3.017881e-13
and alpha:
kords
  [1] NA NA NA NA NA NA NA NA ...
[501] NA NA NA NA NA NA NA NA NA NA NA NA
... now on the alpha x and y are set to numeric(0) and approx is called
with this arguments, bang.

Now in convolve(x,y) on entry x=y and y=kords on linux and osf are
identical.
x:
   [1] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00  ...
 [151] 4.866728e-03 6.204044e-03 3.258272e-03 3.552390e-03 4.218750e-03
[1021] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00  ...
y:
   [1]  2.659615e+00  2.652540e+00  2.631429e+00  2.596616e+00 ...
[1021]  2.548649e+00  2.596616e+00  2.631429e+00  2.652540e+00 

now the error is in line
debug: x <- fft(fft(x) * (if (conj) Conj(fft(y)) else fft(y)), inv = TRUE)
of convolve() which returns only NAs on the alpha.

... so tomorrow I will have a look into fft.c



Albrecht

-------------------------------------------------------------------------------
Albrecht Gebhardt                   email   : albrecht.gebhardt@uni-klu.ac.at
Institut fuer Mathematik            Tel.    : (++43 463) 2700/837
Universitaet Klagenfurt             Fax     : (++43 463) 2700/834
Villacher Str. 161
A-9020 Klagenfurt, Austria
-------------------------------------------------------------------------------


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Wed Sep 15 16:36:55 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed, 15 Sep 1999 17:36:55 +0200 (MET DST)
Subject: buglet in lm.influence() -- easy fix but... (PR#278)
Message-ID: <199909151536.RAA18972@pubhealth.ku.dk>

(R 0.65.0 and earlier):

       example(aov)
       lm.influence(npk.aov)
gives
	Error: NA/NaN/Inf in foreign function call (arg 6)

which comes from the  lm.obj$coefficients  
(the last 3-way interaction coefficient is indetermined and accordingly NA)
argument passed to .Fortran("lminfl",...)  inside lm.influence.

The following is a simple correct patch

--- lm.influence.R	1999/08/13 06:44:12	1.5
+++ lm.influence.R	1999/09/15 15:32:11
@@ -38,6 +38,7 @@
 	     hat = double(n),
 	     coefficients = matrix(0, nr = n, nc = k),
 	     sigma = double(n),
+             NAOK = TRUE,# lm.obj$coef can have "structural" NAs
 	     DUP = FALSE)[c("hat", "coefficients", "sigma")]
 }

However, closer inspection shows that this 6th argument 
(called `b' inside  src/appl/lminfl.f) is not used at all in the code.

Ross, can I eliminate it from the subroutine lminfl() altogether ?


Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Sep 15 16:54:00 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 15 Sep 1999 17:54:00 +0200 (MET DST)
Subject: chisqsim broken on alpha - solved + next bug in fft found (PR#277)
Message-ID: <199909151554.RAA19181@pubhealth.ku.dk>

On Wed, 15 Sep 1999 albrecht.gebhardt@uni-klu.ac.at wrote:

> On Wed, 15 Sep 1999 ripley@stats.ox.ac.uk wrote:
> 
> > On Tue, 14 Sep 1999, Albrecht Gebhardt wrote:
> > 
> > [...]
> > 
> > > chisqsim (called from chisq.test() crashes. First I found that the crash
> > > is at 
> > > chisqsim.c:167
> > > 167             fact[i] = x;
> > 
> > [...]
> > 
> > chisqsum.c has its interface in terms of long *, called by .C that supplies
> > int *. I think those are different on an Alpha.  Could you please
> > edit long to int in that file and try again.

> Yes this helps.

OK, that has gone in R-release today, for 0.65.0 (patched).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Wed Sep 15 17:43:01 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed, 15 Sep 1999 18:43:01 +0200 (MET DST)
Subject: plot ( <aov.obj> ) failed -- easy fix (PR#279)
Message-ID: <199909151643.SAA19576@pubhealth.ku.dk>

It is already commited for "tomorrow"s snapshot of R-release
(why on earth has nobody noticed ??)

--- plot.lm.R	1999/08/13 09:36:22	1.4
+++ plot.lm.R	1999/09/15 16:39:45
@@ -17,7 +17,7 @@
     hii <- lm.influence(x)$hat
     s <- sqrt(deviance(x)/df.residual(x))
     if (any(show[2:3])) {
-	ylab23 <- switch(class(x)[1], lm = "Standardized residuals",
+	ylab23 <- switch(class(x)[1], aov = , lm = "Standardized residuals",
 			 glm = "Std. dev. residuals")
 	rs <- r/sqrt(1 - hii)/s
     }

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Thu Sep 16 07:22:15 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Thu, 16 Sep 1999 08:22:15 +0200 (MET DST)
Subject: plot ( <aov.obj> ) failed -- easy fix (PR#279)
Message-ID: <199909160622.IAA22004@pubhealth.ku.dk>

>>>>> On Wed, 15 Sep 1999 18:43:01 +0200 (MET DST), maechler@stat.math.ethz.ch (Martin Maechler) said:

    MM> It is already commited for "tomorrow"s snapshot of R-release
    MM> (why on earth has nobody noticed ??)


  >> --- plot.lm.R	1999/08/13 09:36:22	1.4
  >> +++ plot.lm.R	1999/09/15 16:39:45
  >> @@ -17,7 +17,7 @@
  >>      hii <- lm.influence(x)$hat
  >>      s <- sqrt(deviance(x)/df.residual(x))
  >>      if (any(show[2:3])) {
  >> -	ylab23 <- switch(class(x)[1], lm = "Standardized residuals",
  >> +	ylab23 <- switch(class(x)[1], aov = , lm = "Standardized residuals",
  >>  			 glm = "Std. dev. residuals")
  >>  	rs <- r/sqrt(1 - hii)/s
  >>      }

but a much better patch is

--- plot.lm.R	1999/08/13 09:36:22	1.4
+++ plot.lm.R	1999/09/16 06:17:13	1.4.2.2
@@ -17,8 +17,8 @@
     hii <- lm.influence(x)$hat
     s <- sqrt(deviance(x)/df.residual(x))
     if (any(show[2:3])) {
-	ylab23 <- switch(class(x)[1], lm = "Standardized residuals",
-			 glm = "Std. dev. residuals")
+	ylab23 <- if(inherits(x, "glm"))
+	    "Std. dev. residuals" else "Standardized residuals"
 	rs <- r/sqrt(1 - hii)/s
     }
     one.fig <- prod(par("mfcol")) == 1

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ulrich.poetter@ruhr-uni-bochum.de  Thu Sep 16 21:43:35 1999
From: ulrich.poetter@ruhr-uni-bochum.de (ulrich.poetter@ruhr-uni-bochum.de)
Date: Thu, 16 Sep 1999 22:43:35 +0200 (MET DST)
Subject: install/libraries on solaris2.6 (PR#280)
Message-ID: <199909162043.WAA01534@pubhealth.ku.dk>

Full_Name: ulrich poetter
Version: 0.65.0
OS: sparc-sun-solaris 2.6
Submission from: (NULL) (134.147.95.163)


Building R-0.65.0 on sparc-sun-solaris2.6 using sun make + gcc 2.95.1+ binutils
2.8.1
and ./configure --with-g77 fails when building the eda etc. libraries. The
configure 
script produces SHLIBLDFLAGS= -G. Replacing this in config.site by 
SHLIBLDFLAGS = -shared gives no errors during make, but "make check" fails when

trying to load library "eda" with the message "Symbol rsort not found". Trying
the 
other libraries by hand results in similar errors, except for "base" and "mva",

while "make test-Specific" gives no errors. 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Sep 16 22:42:51 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 16 Sep 1999 22:42:51 +0100 (BST)
Subject: install/libraries on solaris2.6 (PR#280)
In-Reply-To: <199909162043.WAA01534@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.9909162239390.4826-100000@auk.stats>

On Thu, 16 Sep 1999 ulrich.poetter@ruhr-uni-bochum.de wrote:

> Full_Name: ulrich poetter
> Version: 0.65.0
> OS: sparc-sun-solaris 2.6
> Submission from: (NULL) (134.147.95.163)
> 
> 
> Building R-0.65.0 on sparc-sun-solaris2.6 using sun make + gcc 2.95.1+ binutils
> 2.8.1
> and ./configure --with-g77 fails when building the eda etc. libraries. The
> configure 
> script produces SHLIBLDFLAGS= -G. Replacing this in config.site by 
> SHLIBLDFLAGS = -shared gives no errors during make, but "make check" fails when
> 
> trying to load library "eda" with the message "Symbol rsort not found". Trying
> the 
> other libraries by hand results in similar errors, except for "base" and "mva",
> 
> while "make test-Specific" gives no errors. 

Fuller details, please. Exactly that configuration works for me (except I
don't know where binutils are in your path). Looks like you haven't got
linking against R.X11 correct.  Try using the sun ld if you are not already
doing so (it is recommended for Solaris).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Sep 17 14:10:49 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 17 Sep 1999 15:10:49 +0200 (MET DST)
Subject: mtext(. col = ...) stopped working in 0.65.0 (PR#281)
Message-ID: <199909171310.PAA09366@pubhealth.ku.dk>

Ouch, ouch..

  plot(1) ;mtext("Default",side=1)
  mtext("Red Herring",col="red",font=2,cex=3)
  mtext("adj = 1",adj=1,font=3,cex=2)

works alright in 0.64.2, but not anymore in 0.65.0.
This is true for x11() and postscript() at least,
but probably device independent.

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ulrich.poetter@ruhr-uni-bochum.de  Fri Sep 17 20:59:34 1999
From: ulrich.poetter@ruhr-uni-bochum.de (ulrich.poetter@ruhr-uni-bochum.de)
Date: Fri, 17 Sep 1999 21:59:34 +0200 (MET DST)
Subject: install/libraries on solaris2.6 (PR#280)
In-Reply-To: <Pine.GSO.4.05.9909162239390.4826-100000@auk.stats>
References: <199909162043.WAA01534@pubhealth.ku.dk>
 <Pine.GSO.4.05.9909162239390.4826-100000@auk.stats>
Message-ID: <14306.39861.332780.698609@abel.stat.ruhr-uni-bochum.de>

Prof Brian D Ripley writes:
 > On Thu, 16 Sep 1999 ulrich.poetter@ruhr-uni-bochum.de wrote:
 > 
 > > Full_Name: ulrich poetter
 > > Version: 0.65.0
 > > OS: sparc-sun-solaris 2.6
 > > Submission from: (NULL) (134.147.95.163)
 > > 
 > > 
 > > Building R-0.65.0 on sparc-sun-solaris2.6 using sun make + gcc 2.95.1+ binutils
 > > 2.8.1
 > > and ./configure --with-g77 fails when building the eda etc. libraries. The
 > > configure 
 > > script produces SHLIBLDFLAGS= -G. Replacing this in config.site by 
 > > SHLIBLDFLAGS = -shared gives no errors during make, but "make check" fails when
 > > trying to load library "eda" with the message "Symbol rsort not found". Trying
 > > the 
 > > other libraries by hand results in similar errors, except for "base" and "mva",
 > > 
 > > while "make test-Specific" gives no errors. 
 > 
 > Fuller details, please. Exactly that configuration works for me (except I
 > don't know where binutils are in your path). Looks like you haven't got
 > linking against R.X11 correct.  Try using the sun ld if you are not already
 > doing so (it is recommended for Solaris).

Thanks. Using the sun ld (with everything else the same) works. 

The Readme of gnu ld mentions a difference to sun ld and says it would 
emulate its behavior if given the "-E" flag. I didn't try this, but if 
this was the case, could one not try to figure it out in the configure 
script?

Thanks again,
Uli Poetter


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mcw@ln.nimh.nih.gov  Fri Sep 17 21:13:57 1999
From: mcw@ln.nimh.nih.gov (Matthew Wiener)
Date: Fri, 17 Sep 1999 16:13:57 -0400 (EDT)
Subject: "Error:  incorrect number of arguments to lambda"
Message-ID: <Pine.SGI.3.96.990917155315.909F-100000@ln.nimh.nih.gov>

Hello, all.

I have a somewhat embarrassing error, in that I cannot reliably reproduce
it.  I have sporadically experienced the error both on an SGI machine
running Irix 6.5 and on a LinuxPPC machine.  I have only seen this error
using version 0.65.0.  (I've been using versions since 0.61 or so.)

The error message is in the subject line.  Here's the traceback from the
most recent occurrence:

Error: incorrect number of arguments to "lambda"  
> traceback()  
[1] "bxp(groups, width, varwidth = varwidth, notch = notch, border =
border, " 
[2] "  col = col, log = log, pars = pars, lwd = lwd, pch = pch, "  
[3] " lty = lty, p.size = p.size, ...)"  
[4] "boxplot(split(mf[[response]], mf[[-response]]), ...)" 
[5] "boxplot.formula(c.est ~ frac.vec, col = \"blue\", notch = T)" [6]
"f.calc.var.g()" 



You'll notice that here I'm using a slightly modified version of bxp (I
wasn't able to figure out another way to change the line width of the
whiskers or the point size of outliers), but the same error occurred with
the original version.  Except then, when I reloaded my modified version,
the error vanished.  I haven't been able to make it happen again this
time.

The error has occurred in several other functions as well -- the first
time I thought I'd just misinstalled, so I did it again.  Then I didn't
see the error for a while, and became complacent.  But now it's back.


Here's what I remember from the earlier occurrences:

I had a function calling several subroutines.  I got this error, and
traceback pointed at one of the subroutines.  I inserted a few print
statements to try to follow what was going on, after which the program got
through that subroutine with no problems, and gave me the "lambda" error
in the next subroutine.  Putting print statements in the next subroutine
bumped the error to the one after that.  That's when I reinstalled.  That
took care of it for a while, but it's now resurfaced on a couple of
occasions.

The R online help has no function called lambda, nor does one come up in a
search through my environment.  I don't have any contributed packages
loaded, although I do have a collection of functions I use regularly, and
which I've used without incident until now.  Lambda sounds lispish, but I
can't figure out where to find it and look for it.

Needless to say, I will keep better notes next time this happens.  If
anyone has any ideas what it might be and how to fix it, that's great.
Otherwise, I'd like to know what sort of information I ought to collect so
that my report can be as useful as possible.

Thanks,

Matt

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Sep 17 21:40:58 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Fri, 17 Sep 1999 22:40:58 +0200 (MET DST)
Subject: install/libraries on solaris2.6 (PR#280)
Message-ID: <199909172040.WAA11161@pubhealth.ku.dk>

On Fri, 17 Sep 1999 ulrich.poetter@ruhr-uni-bochum.de wrote:

> Prof Brian D Ripley writes:
>  > On Thu, 16 Sep 1999 ulrich.poetter@ruhr-uni-bochum.de wrote:
>  > 
>  > > Full_Name: ulrich poetter
>  > > Version: 0.65.0
>  > > OS: sparc-sun-solaris 2.6
>  > > Submission from: (NULL) (134.147.95.163)
>  > > 
>  > > 
>  > > Building R-0.65.0 on sparc-sun-solaris2.6 using sun make + gcc 2.95.1+ binutils
>  > > 2.8.1
>  > > and ./configure --with-g77 fails when building the eda etc. libraries. The
>  > > configure 
>  > > script produces SHLIBLDFLAGS= -G. Replacing this in config.site by 
>  > > SHLIBLDFLAGS = -shared gives no errors during make, but "make check" fails when
>  > > trying to load library "eda" with the message "Symbol rsort not found". Trying
>  > > the 
>  > > other libraries by hand results in similar errors, except for "base" and "mva",
>  > > 
>  > > while "make test-Specific" gives no errors. 
>  > 
>  > Fuller details, please. Exactly that configuration works for me (except I
>  > don't know where binutils are in your path). Looks like you haven't got
>  > linking against R.X11 correct.  Try using the sun ld if you are not already
>  > doing so (it is recommended for Solaris).
> 
> Thanks. Using the sun ld (with everything else the same) works. 
> 
> The Readme of gnu ld mentions a difference to sun ld and says it would 
> emulate its behavior if given the "-E" flag. I didn't try this, but if 
> this was the case, could one not try to figure it out in the configure 
> script?

_I_ am not sure it is at all easy to find out which ld you are using, but
thanks for the info: another thing to watch out for.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mcw@ln.nimh.nih.gov  Fri Sep 17 21:44:17 1999
From: mcw@ln.nimh.nih.gov (Matthew Wiener)
Date: Fri, 17 Sep 1999 16:44:17 -0400 (EDT)
Subject: lambda error update
Message-ID: <Pine.SGI.3.96.990917164220.909I-100000@ln.nimh.nih.gov>

Two more details:

Someone else who works here, and hasn't used 0.65.0, thinks he's seen the
error before.  He restarted R, and it went away.

Second, I think the relevant code is in 
SEXP do_function, in eval.c in the main directory.

line 695:  WrongArgCount("lambda")

Beyond that I'm afraid I'm getting in over my head.

Matt


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Sep 18 00:53:55 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Sep 1999 01:53:55 +0200
Subject: lambda error update
In-Reply-To: Matthew Wiener's message of "Fri, 17 Sep 1999 16:44:17 -0400 (EDT)"
References: <Pine.SGI.3.96.990917164220.909I-100000@ln.nimh.nih.gov>
Message-ID: <x2aeqlt7qk.fsf@blueberry.kubism.ku.dk>

Matthew Wiener <mcw@ln.nimh.nih.gov> writes:

> Two more details:
> 
> Someone else who works here, and hasn't used 0.65.0, thinks he's seen the
> error before.  He restarted R, and it went away.
> 
> Second, I think the relevant code is in 
> SEXP do_function, in eval.c in the main directory.
> 
> line 695:  WrongArgCount("lambda")
> 
> Beyond that I'm afraid I'm getting in over my head.
> 
> Matt

"lambda" is essentially "function" (revealing the fact that R's engine
is really a Lisp/Scheme dialect). It's a very strange error you're
getting because the calls to "function" are almost impossible to
create, except by having the parser parse a

function (<args>) <body> 

construction and that would set up a call with the right number of
parameters (xxdefun in gram.y calls lang4). The arg count got changed
from 0.64.2 to 0.65.0 (from 3 to 4) to accommodate the stored source
attribute. I suppose that a function stored in a saved workspace might
cause some kind of mess when restored.

You can provoke the error by messing with the parse tree of function()
constructs, e.g.

> e<-quote(function()1)
> e[[4]]<-NULL
> eval(e)
Error: incorrect number of arguments to "lambda"
> e
function() 1
> e<-quote(function()1)
> e[[3]]<-NULL
> eval(e)
Error: incorrect number of arguments to "lambda"
> e
function() "function()1"
> e[[2]]<-NULL
> eval(e)
Error: incorrect number of arguments to "lambda"
> e
Segmentation fault (core dumped)

(That last one seems to indicate yet another spot where the deparser
needs to take better care).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mcw@ln.nimh.nih.gov  Sat Sep 18 06:55:51 1999
From: mcw@ln.nimh.nih.gov (Matthew Wiener)
Date: Sat, 18 Sep 1999 01:55:51 -0400 (EDT)
Subject: lambda error update
In-Reply-To: <x2aeqlt7qk.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.SGI.3.96.990918015308.10757B-100000@ln.nimh.nih.gov>



On 18 Sep 1999, Peter Dalgaard BSA wrote:

> "lambda" is essentially "function" (revealing the fact that R's engine
> is really a Lisp/Scheme dialect). It's a very strange error you're
> getting because the calls to "function" are almost impossible to
> create, except by having the parser parse a
> 
> function (<args>) <body> 
> 
> construction and that would set up a call with the right number of
> parameters (xxdefun in gram.y calls lang4). The arg count got changed
> from 0.64.2 to 0.65.0 (from 3 to 4) to accommodate the stored source
> attribute. I suppose that a function stored in a saved workspace might
> cause some kind of mess when restored.
> 

If I understand this correctly, it would seem to mean that I'm unlikely to
get this error more than once from any given function, since when I
re-store (rather than restore) it under 0.65.0 things will get fixed.
Does that seem right?  If not, is there anything I can do?

Thanks (for this help and for R generally).

Matt

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Sep 18 10:40:00 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Sat, 18 Sep 1999 11:40:00 +0200 (MET DST)
Subject: lambda error update (PR#282)
Message-ID: <199909180940.LAA12533@pubhealth.ku.dk>

Matthew Wiener <mcw@ln.nimh.nih.gov> writes:

> > parameters (xxdefun in gram.y calls lang4). The arg count got changed
> > from 0.64.2 to 0.65.0 (from 3 to 4) to accommodate the stored source
> > attribute. I suppose that a function stored in a saved workspace might
> > cause some kind of mess when restored.
> > 
> 
> If I understand this correctly, it would seem to mean that I'm unlikely to
> get this error more than once from any given function, since when I
> re-store (rather than restore) it under 0.65.0 things will get fixed.
> Does that seem right?  If not, is there anything I can do?

No, that doesn't work, because you'll just store the old call again.
However if you just edit the function, e.g. with fix(), the problem
goes away. You don't have to change it, just make sure that the code
gets reparsed.

Here's the essence of the problem:

R : Copyright 1999, The R Development Core Team
Version 0.64.1 Patched (unreleased snapshot) (May 14, 1999)
> f<-function(){g<-function()2}  
> save(f,file="xxx")

R : Copyright 1999, The R Development Core Team
Version 0.65.0 Patched (unreleased) (September 16, 1999)
> load("xxx")
> f
function () 
{
    g <- function() 2
}
> f()
Error: incorrect number of arguments to "lambda"
> fix(f)
...
> f()
>

D*mn! I should have thought of that. I'll see if I can cook up a fix
for 0.65.1. Filed as a bug report.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Sep 18 11:21:42 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Sep 1999 12:21:42 +0200
Subject: lambda error update (PR#282)
In-Reply-To: p.dalgaard@biostat.ku.dk's message of "Sat, 18 Sep 1999 11:40:00 +0200 (MET DST)"
References: <199909180940.LAA12533@pubhealth.ku.dk>
Message-ID: <x2yae4zfih.fsf@blueberry.kubism.ku.dk>

p.dalgaard@biostat.ku.dk writes:

> Error: incorrect number of arguments to "lambda"
> > fix(f)
> ...
> > f()
> >
> 
> D*mn! I should have thought of that. I'll see if I can cook up a fix
> for 0.65.1. Filed as a bug report.

Heh. Turned out to be absolutely trivial:

diff -u -r1.62.2.1 eval.c
--- eval.c	1999/09/02 15:11:59	1.62.2.1
+++ eval.c	1999/09/18 10:06:30
@@ -691,7 +691,7 @@
 {
     SEXP rval;
 
-    if (length(args) < 3)
+    if (length(args) < 2)
	WrongArgCount("lambda");
     CheckFormals(CAR(args));
     rval = mkCLOSXP(CAR(args), CADR(args), rho);

If the 3rd argument is absent, R_NilValue gets passed for the CADDR in

   setAttrib(rval, R_SourceSymbol, CADDR(args));

and that is exactly what should happen!

This has to be the smallest bugfix possible, AFAICS a single bit gets
flipped, both in the source and in the binaries....

Will commit in a moment.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Sep 18 20:03:13 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Sat, 18 Sep 1999 21:03:13 +0200 (MET DST)
Subject: hsv strangeness (PR#283)
Message-ID: <199909181903.VAA13542@pubhealth.ku.dk>

This doesn't look right:

 piechart(rep(1,48),col=hsv((1:48)/48,1,1))

Hues 8,16,32 are completely out of whack. 

(Linux RedHat6.0, X11 driver, but probably not driver dependant.)

This also sends topo.colors, terrain.colors, and heat.colors way off.
Look at example(heat.colors) for instance.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Mon Sep 20 17:08:25 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Mon, 20 Sep 1999 16:08:25 +0000
Subject: Updated tseries package
Message-ID: <37E65BF9.B37B63C0@wu-wien.ac.at>

Fritz just put the updated tseries package to CRAN. I mainly removed
(and corrected) code such that tseries fits together with package ts.
New code is White's and Teraesvirta's tests for neglected non-linearity
(also for the regression case). From the INDEX file:

NelPlo                   Nelson-Plosser Macroeconomic Time Series
adf.test                 Augmented Dickey-Fuller Test
amif                     Auto Mutual Information Function
bds.test                 BDS Test
portfolio.optim          Portfolio Optimization
quadmap                  Quadratic Map (Logistic Equation)
read.matrix              Read Matrix Data
read.ts                  Read Time Series Data
runs.test                Runs Test
surrogate                Generate Surrogate Data
tcm                      Yields on Treasury Securities
terasvirta.test          Teraesvirta Neural Network Test for
Nonlinearity
white.test               White Neural Network Test for Nonlinearity

Comments and suggestions are welcome!

Adrian


--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@biostat.ku.dk  Tue Sep 21 06:15:04 1999
From: pd@biostat.ku.dk (Peter Dalgaard BSA)
Date: Tue, 21 Sep 1999 07:15:04 +0200
Subject: Bug list summary (automatic post)
Message-ID: <199909210515.HAA12539@biostat.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.biostat.ku.dk or via email to
r-bugs@biostat.ku.dk. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

* PR# 138 *
Subject: Re: [R] bug? and New bug.
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Wed, 10 Mar 1999 17:21:16 +0100
--pt() for large df. Solved, but problem remains for pf et al.

Directory:  Add-ons

* PR# 137 *
Subject: funfits
From: "Alvaro A. Novo" <novo@uiuc.edu>
Date: Tue, 9 Mar 1999 22:24:54 -0600
--Not our problem. Dubious whether a bug at all.

Directory:  Analyses

* PR# 144 *
Subject: glm throws erroneous(?)'names attribute must be the same length as the vector' 
From: wagman@enteract.com
Date: Thu, 18 Mar 1999 08:58:47 +0100
--Can anyone reproduce this ??
--Same error as when doing regression on empty subset. All fitted
--values might be 0 or 1

Directory:  Documentation

none

Directory:  Graphics

* PR# 61 *
Subject: points(...,  cex = ..)  is pretty wrong...
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 2 Nov 1998 19:15:06 +0100
--Symbols getting decentered when too large cex for X. Still there 22feb99  
* PR# 69 *
Subject: Some graphics bugs
From: Martyn Plummer <plummer@iarc.fr>
Date: Fri, 04 Dec 1998 11:42:50 -0000 ()
Date: 04-Dec-98
--Various anomalies with text size and alignment. 2B appears to be solved. The 
--rest is still there (22feb99)
* PR# 120 *
Subject: graphics bug: type="l"
From: Matthew Wiener <mcw@ln.nimh.nih.gov>
Date: Tue, 16 Feb 1999 15:30:25 -0500 (EST)
--X server problem drawing > 64K lines at once. Workaround?
* PR# 123 *
Subject: Text in plot
From: Ennapadam Venkatraman <venkat@biosta.mskcc.org>
Date: Thu, 18 Feb 1999 13:05:37 -0500
--Multiline text not working
* PR# 130 *
Subject: lty=0 -- shouldn't it give an invisible line?
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 28 Feb 1999 21:45:43 +0100
--Strange effect on barplot
* PR# 149 *
Subject: plot.formula and pch=
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 25 Mar 1999 21:22:44 +0100
--plot(y~x,pch=z) may subset x and y but leave z.
--E.g. with missing values you can get incorrect plot symbols.
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--Don't think I (pd) got the point there...
* PR# 225 *
Subject: pch and mkh bug
From: Stephen Harker <sjh@ph.adfa.edu.au>
Date: Wed, 14 Jul 1999 13:10:31 +1000 (EST)
--(1) is an S incompatibility, but the S rules may not be a good model
--(2) is a bug, fixed for 0.65.0
--(3) has gone away in 0.65.0
* PR# 229 *
Subject: dev.print scaling bug?
From: John.Peters@tip.csiro.au (John Peters)
Date: Fri, 16 Jul 1999 12:10:48 +1000 (EST)
* PR# 230 *
Subject: Use of lwd = 0, lty = 2 in segments.
From: Douglas Bates <bates@stat.wisc.edu>
Date: Sat, 17 Jul 1999 17:18:44 -0500 (CDT)
* PR# 238 *
Subject: EPS compliance of postscript device: initclip operator
From: David Middleton <dajm@deeq.demon.co.uk>
Date: Tue, 03 Aug 1999 17:51:47 -0300
--initclip is removed. Still need new argument onefile/onepage to ensure one page
--and use %!PS-Adobe-3.0 EPSF-3.0 header

Directory:  In-Out

* PR# 125 *
Subject: scan rejects complex
From: John.Peters@tip.csiro.au (John Peters)
Date: Mon, 22 Feb 1999 10:08:14 +1100 (EST)
* PR# 129 *
Subject: Formatting in formatC and format
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 28 Feb 1999 08:53:34 +0000 (GMT)
--Documentation and ``merge'' of format() and formatC() would be desired - MM
* PR# 207 *
Subject: Lines longer than ~1000 chars truncated at parsing
From: msa@biostat.mgh.harvard.edu
Date: Mon, 7 Jun 1999 22:27:10 +0200 (MET DST)
--Fixed buffer used during input.
--Not fixable without major changes to readline lib.

Directory:  Installation

none

Directory:  Language

* PR# 105 *
Subject: an old bug resurfaces
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Fri, 29 Jan 1999 08:28:32 +0100 (MET)
--Model formulas. Proper fix probably requires extensive rewrite of model formula
--parser, which would make in non-S-compatible.
* PR# 239 *
Subject: cbind is not generic as claimed, omits labels where S has them 
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 5 Aug 1999 12:29:58 +0100 (BST)
--Cbind is now generic, still labelling issues. See also PR#240 and PR#241.
* PR# 240 *
Subject: Re: cbind is not generic as claimed, omits labels where S has them
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 5 Aug 1999 17:19:08 +0100 (BST)
--See PR#239
* PR# 241 *
Subject: Re: cbind is not generic as claimed, omits labels where S has them
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Fri, 6 Aug 1999 06:52:35 +0100 (BST)
--See PR#239

Directory:  Low-level

* PR# 37 *
Subject: S.h compatibility issues
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 6 Sep 1998 19:58:47 +0100 (BST)
--1 is fixed
--2 R's own RNG entry points are still not public
--3 is the perennial issue of what is the `public' API -- specific points are
--fixed
* PR# 101 *
Subject: Re: [R] Re: R-0.63.2 for Windows - some comments
From: Guido Masarotto <guido@hal.stat.unipd.it>
Date: Fri, 22 Jan 1999 12:40:26 +0100
--This is really about fixed buffer sizes in printutils.c
* PR# 135 *
Subject: summary() of lm() problem
From: Simon Fear <fears@roycastle.liv.ac.uk>
Date: Tue, 9 Mar 1999 13:18:37 -0000 
--lm (?) AND Windows problem;  Win solved (fudged) for 0.63.3
--
--Another low-level buffer-size problem
* PR# 185 *
Subject: Re: [R] R_problem_buf in the S.h files & lists in .C
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 05 May 1999 00:32:49 +0200
--S objects in .C calls (not just lists) are now documented in the help file
* PR# 197 *
Subject: glm crash
From: Cor en Aylin <Cor.Berrevoets@gironet.nl>
Date: Fri, 21 May 1999 19:44:23 +0200
--Obscure report. Cannot reproduce from given info.
* PR# 210 *
Subject: definition of R_problem_buf in S.h
From: vogels@ieee.org
Date: Mon, 14 Jun 1999 17:56:04 +0200 (MET DST)
--Same as #185
* PR# 235 *
Subject:  round(numeric(0)) 
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 29 Jul 1999 15:20:21 +0100 (BST)
--Some followup of this on R-devel not sent here.

Directory:  Misc

* PR# 91 *
Subject: possible bug
From: Rashid Nassar <rnassar@duke.edu>
Date: Sat, 9 Jan 1999 14:50:58 -0500 (EST)
--Remaining issue is whether we can do something more friendly than dumping 
--users into vi?

Directory:  Models

* PR# 121 *
Subject:  model.frame mangles time series 
From: Peter Dalgaard BSA <pd@biostat.ku.dk>
Date: Thu, 18 Feb 1999 15:47:24 +0100
--Subset in C code + attributes = mess
--Switch to interpreted ("[")

Directory:  Startup

none

Directory:  System-specific

* PR# 214 *
From: Charles Taylor <charles@amsta.leeds.ac.uk>
Date: Thu, 24 Jun 1999 11:20:06 +0100 (BST)
* PR# 222 *
Subject: Use of R-Coda
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Fri, 9 Jul 1999 10:54:16 +0200 
--In Danish (?)  Looks as if PR#246 is the same in English
* PR# 234 *
Subject: R-bugs
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Tue, 27 Jul 1999 13:49:31 +0200
--Looks like PR#222 again, in Danish. See PR#246 for English version
* PR# 246 *
Subject: R-Coda on rs6000-ibm-aix4.2.1.0
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Wed, 11 Aug 1999 08:49:47 +0200
--Problem with ps on AIX in 0.64.2. Try again with 0.65.0?

Directory:  TooMuchAtOnce

* PR# 53 *
Subject: 0.62.3 bugs, incompatibilities and problems
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Mon, 12 Oct 1998 09:43:51 +0200 (MET DST)
--Of Jims points: (checked in 0.65 April 26 compared to Splus 3.4)
-- 4. works the same as S
-- 5. Splus gives NA and the if(class(z)=="repeated") doesn't work in either
-- 10. seems to work
-- 7.  seems to do what Jim wants now
--  
* PR# 76 *
Subject: R-0.63.0
From: Rashid Nassar <rnassar@acpub.duke.edu>
Date: Fri, 11 Dec 1998 23:20:08 -0500 (EST)

Directory:  Windows

none

Directory:  incoming

* PR# 248 *
Subject: scan() + error interferes with count.fields() in some cases
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 13 Aug 1999 17:44:48 +0200
* PR# 249 *
Subject: axis ignores srt/crt
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Mon, 16 Aug 1999 15:51:49 -0700 (PDT)
* PR# 250 *
From: Peter Malewski <peter@tu-bs.de>
Date: Tue, 17 Aug 1999 12:21:38 +0200 (CEST)
* PR# 251 *
From: Peter Malewski <peter@tu-bs.de>
Date: Tue, 17 Aug 1999 12:21:45 +0200 (CEST)
* PR# 252 *
Subject: bug: R says "Floating exception" on DEC-Alpha w/OSF1
From: "Michael Thompson" <mlthomps@yayoi.mt.m-kagaku.co.jp>
Date: Thu, 19 Aug 1999 06:03:06 +0900
* PR# 253 *
Subject: seg.fault for some illegal .Random.seed (new since 0.64)
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 20 Aug 1999 14:17:31 +0200
* PR# 254 *
Subject: Strange 'Unimplemented feature in rep' error
From: Lutz Prechelt <prechelt@ira.uka.de>
Date: Mon, 23 Aug 1999 19:43:24 +0200
* PR# 255 *
Subject: broken link in R FAQ page?
From: Tian-Xiong Lu <tian@chico.ma.adfa.edu.au>
Date: Tue, 24 Aug 1999 13:41:21 +1000 (EST)
* PR# 256 *
Subject: Error in ?text
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
Date: Wed, 25 Aug 1999 10:00:19 +0100 (BST)
* PR# 257 *
Subject:  dimnames names lost when subscripting 
From: Andreas Weingessel <weingessel@ci.tuwien.ac.at>
Date: Wed, 25 Aug 1999 12:45:28 +0200
* PR# 258 *
Subject: Greek letters in outer margins.
From: "BXC (Bendix Carstensen)" <BXC@NOVO.dk>
Date: Thu, 26 Aug 1999 12:09:17 +0200
* PR# 259 *
Subject: R without X11?
From: "Jack N." <jnf@pcisys.net>
Date: Sat, 28 Aug 1999 09:22:57 -0600
* PR# 260 *
Subject: Re: Compiling R under Caldera Open Linux 2.2
Subject: Compilation of R under Caldera OpenLinux 2.2
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sun, 29 Aug 1999 19:38:13 +1000 (EST)
* PR# 261 *
Subject: interface w/ emacs
From: gautier@lion-ag.de
Date: Mon, 30 Aug 1999 13:28:52 +0200 (MET DST)
* PR# 262 *
Subject: Problems compiling R65.0
From: Patrick Lindsey <plindsey@alpha.luc.ac.be>
Date: Wed, 1 Sep 1999 11:52:29 +0200 (MET DST)
* PR# 263 *
Subject: Problems sourcing functions with R65.0
From: Patrick Lindsey <plindsey@alpha.luc.ac.be>
Date: Wed, 1 Sep 1999 11:58:51 +0200 (MET DST)
* PR# 264 *
Subject: R 0.65.x bug :  attach()/eval() {was "lib.source() within library()"}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Thu, 2 Sep 1999 12:23:43 +0200
* PR# 265 *
Subject: trouble with the 'exclude' parameter of factor()
From: gautier@lion-ag.de
Date: Thu, 2 Sep 1999 17:40:47 +0200 (MET DST)
* PR# 266 *
Subject: Re: [R] data frame component replacement: feature or bug?
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Sep 1999 00:03:29 +0200
* PR# 267 *
Subject: matplot(... panel.first=..) fails  <==> dealing with "..."
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 6 Sep 1999 11:04:03 +0200
* PR# 268 *
Subject: Re: Compiling R under Caldera Open Linux 2.2
From: "Jack N." <jnf@pcisys.net>
Date: Mon, 06 Sep 1999 08:03:02 -0600
* PR# 269 *
Subject: sys.on.exit appears non-functional
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Tue, 7 Sep 1999 17:41:28 +0100 (BST)
* PR# 270 *
Subject: Y2K Cereal bowl News Release
From: crispy1@newmail.net
Date: Tue, 7 Sep 1999 20:59:05 -0700
* PR# 271 *
Subject: R with Windows 95
From: pascal.grandeau@wanadoo.fr
Date: Wed, 8 Sep 1999 17:56:12 +0200 (MET DST)
* PR# 272 *
Subject:  problem in R.sh.in script 
From: "Mitsuru Oka" <oka@debian.or.jp>
Date: 10 Sep 1999 06:53:01 -0000
* PR# 273 *
Subject: Re: problem in R.sh.in script 
From: Mitsuru Oka <oka@debian.or.jp>
Date: Fri, 10 Sep 1999 16:08:39 +0900
* PR# 274 *
Subject: axis() produces junk on DEC alpha
From: albrecht.gebhardt@uni-klu.ac.at
Date: Mon, 13 Sep 1999 03:02:20 +0200 (MET DST)
* PR# 275 *
Subject: Re: R with a broken finite() (was [R] Problems with R-0.65.0)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Tue, 14 Sep 1999 15:17:17 +0100 (BST)
* PR# 276 *
Subject: Re: chisqsim broken on alpha (was Re: axis() produces junk on DEC
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Wed, 15 Sep 1999 08:18:42 +0100 (BST)
* PR# 277 *
Subject: Re: chisqsim broken on alpha - solved + next bug in fft found
From: Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at>
Date: Wed, 15 Sep 1999 15:33:09 +0200 (MET DST)
* PR# 278 *
Subject: buglet in lm.influence() -- easy fix but...
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Wed, 15 Sep 1999 17:36:46 +0200
* PR# 279 *
Subject: plot ( <aov.obj> ) failed -- easy fix
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Wed, 15 Sep 1999 18:42:56 +0200
* PR# 280 *
Subject: install/libraries on solaris2.6
From: ulrich.poetter@ruhr-uni-bochum.de
Date: Thu, 16 Sep 1999 22:43:34 +0200 (MET DST)
* PR# 281 *
Subject: mtext(. col = ...) stopped working in 0.65.0
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 17 Sep 1999 15:10:40 +0200
* PR# 282 *
Subject: Re: lambda error update
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 18 Sep 1999 11:44:26 +0200
* PR# 283 *
Subject: hsv strangeness
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 18 Sep 1999 21:07:50 +0200
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Wed Sep 22 10:42:18 1999
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Wed, 22 Sep 1999 11:42:18 +0200 (MET DST)
Subject: quasi-likelihood in glm (PR#284)
Message-ID: <199909220942.LAA16986@pubhealth.ku.dk>

I have been using quasi-likelihood to analyze some overdispersed lesion
count data which requires the variance function "mu^2" (specifically,
I am using glm with the family quasi(var="mu^2", link="log")). Some of
the counts are zero which led to problems fitting the model in R.

1) glm was unable to find starting values
2) after I supplied initial values from the fit of a Poisson
   model, glm could not proceed because the deviance was infinite.

Splus 5.0 had no problems fitting the model.  I was able to
reproduce the Splus results by editing the quasi() family
generator and using the unnormalized quasi-likelihood

- log(mu) - y/mu                  (*)

in place of the normalized version

log(y/mu) - (y - mu)/mu            (**)

Further investigation of Splus shows how it overcomes these
two problems
1) A fudge factor (in this case 0.167) is added to zero observations 
   so that they can be used as starting values. 
2) The contribution to the deviance is (*) for zero observations
   and (**) for the rest.

I suggest that R also uses this approach for quasi-likelihood
models.
Martyn

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Wed Sep 22 11:32:12 1999
From: J.C.Rougier@durham.ac.uk (J.C.Rougier@durham.ac.uk)
Date: Wed, 22 Sep 1999 12:32:12 +0200 (MET DST)
Subject: model.matrix() (PR#285)
Message-ID: <199909221032.MAA17796@pubhealth.ku.dk>

I was alarmed to discover that model.matrix.default() can permute columns
with respect to the formula.  This seems to happen with user-defined
components of the formula.  Thus

X <- matrix(1:4, 1, 4, dimnames = list(NULL, LETTERS[1:4]))
Q <- function(x) x^2 # because model.matrix() does not like, eg, A:A

model.matrix(~ -1 + A + A:B + Q(C), data.frame(X))

has columns ordered A, Q(C), and A.B, not A, A.B, Q(C), as you might
expect (and I certainly expected!). This appears to happen .Internal-ly. 

While on the subject, would it be reasonable to standardise the names of
interaction terms to be A:B not A.B, to match the terms in the formula.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Sep 22 11:38:29 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 22 Sep 1999 12:38:29 +0200 (MET DST)
Subject: quasi-likelihood in glm (PR#284)
Message-ID: <199909221038.MAA17899@pubhealth.ku.dk>

On Wed, 22 Sep 1999 plummer@iarc.fr wrote:

> I have been using quasi-likelihood to analyze some overdispersed lesion
> count data which requires the variance function "mu^2" (specifically,
> I am using glm with the family quasi(var="mu^2", link="log")). Some of
> the counts are zero which led to problems fitting the model in R.
> 
> 1) glm was unable to find starting values
> 2) after I supplied initial values from the fit of a Poisson
>    model, glm could not proceed because the deviance was infinite.
> 
> Splus 5.0 had no problems fitting the model.  I was able to
> reproduce the Splus results by editing the quasi() family
> generator and using the unnormalized quasi-likelihood
> 
> - log(mu) - y/mu                  (*)
> 
> in place of the normalized version
> 
> log(y/mu) - (y - mu)/mu            (**)
> 
> Further investigation of Splus shows how it overcomes these
> two problems
> 1) A fudge factor (in this case 0.167) is added to zero observations 
>    so that they can be used as starting values. 
> 2) The contribution to the deviance is (*) for zero observations
>    and (**) for the rest.
> 
> I suggest that R also uses this approach for quasi-likelihood
> models.

That is not quite what S-PLUS 5.1 and 2000 have: replace
(*) by

-log(mu) - (y - mu)/mu 

That is, the formula is

-log(mu) - (y - mu)/mu + log(y)I(y > 0)

Note that earlier versions of S-PLUS (e.g. 3.4) are plain wrong (and as
I found the bug I know what the replacment is).

Unless there are any objections I will put these fixes in.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Sep 22 12:47:55 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 22 Sep 1999 13:47:55 +0200
Subject: Private data libraries (idea & trick)
Message-ID: <x2iu5388wk.fsf@blueberry.kubism.ku.dk>

It has been annoying me for a while that data in user areas are more
difficult to handle than those in the packages. 

Especially for beginners, it would be very handy to be able just to
say "data(mydata)", rather than
"mydata<-read.table('mydata.txt',header=T)"

What just occurred to me was that the following hack actually works:

Type

library('.',lib.loc='.')

and everything in ./data behaves as if it were in a package. 

Another interesting hack is that one can do this:

[pd@blueberry data]$ cat > file.txt
a b
1 2
3 4
[pd@blueberry data]$ cat > file.R
file<-transform(read.table('file.txt',header=T),
    b=factor(b,levels=1:4,labels=letters[1:4]))

and then from inside R, get the dataframe with factor recoding and
everything as

> data(file)
> file
  a b
1 1 b
2 3 d

Question: Should we perhaps clean this up a little and formalize it?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From William.Venables@cmis.CSIRO.AU  Wed Sep 22 13:17:38 1999
From: William.Venables@cmis.CSIRO.AU (Bill Venables)
Date: Wed, 22 Sep 1999 22:17:38 +1000
Subject: model.matrix() (PR#285)
In-Reply-To: Your message of "Wed, 22 Sep 1999 12:32:12 +0200."
 <199909221032.MAA17796@pubhealth.ku.dk>
Message-ID: <199909221219.WAA14736@snowy.nsw.cmis.CSIRO.AU>

> I was alarmed to discover that model.matrix.default() can permute columns
> with respect to the formula.						

You are very easily alarmed, then.  The order of the terms is
relevant to a sequential anova and in such an anova it is a
normal and very reasonable strategy for main effects to be
included in the model before interactions (and it is only
interaction terms that are displaced, arranging them in
increasing order by degree).

> This seems to happen with user-defined components of the
> formula.  Thus
> 
> X <- matrix(1:4, 1, 4, dimnames = list(NULL, LETTERS[1:4]))
> Q <- function(x) x^2 # because model.matrix() does not like, eg, A:A
> 
> model.matrix(~ -1 + A + A:B + Q(C), data.frame(X))
> 
> has columns ordered A, Q(C), and A.B, not A, A.B, Q(C), as you might
> expect (and I certainly expected!). This appears to happen .Internal-ly. 

There is a standard method common to R and S of holding terms
together in the strict order they are generated that I suggest is
adequate.  Your model matrix, order intact, could be generated
using

> model.matrix(terms(~ -1 + A + A:B + I(C^2), keep.order = T), data.frame(X))

This is now a very standard idiom but not often needed.  Your
function Q() is not needed, by the way.  The I() function
(`identity') allows you to include arbitrary terms of this form.
This is also a standard and well known idiom.  (I won't ask in
what context you need a quadratic term in C but no linear term...)

There is, though, a clear improvement possible and I do suggest R
core consider it sympathetically.  For quantitative terms A:A
should be an allowable form for the quadratic term, but more
generally ~(x1 + x2 + x3 + x4)^3 should be an allowable form for
a complete 3rd order model, including powers.  I know this is
diffucult since it requires parsing and simplification to be
suspended until the classes of the terms are known, but it is
well worth the effort.

> While on the subject, would it be reasonable to standardise the names of
> interaction terms to be A:B not A.B, to match the terms in the formula.

I agree it would indeed.  The `dot' form is potentially ambiguous
but more seriously I get the horrible feeling I am back using
glim once more and it's plain creepy...

Bill Venables.

-- 
-----------------------------------------------------------------
Bill Venables, Statistician, CMIS Environmetrics Project.

Physical address:                            Postal address:
CSIRO Marine Laboratories,                   PO Box 120,       
233 Middle St, Cleveland, Queensland         Cleveland, Qld, 4163
AUSTRALIA                                    AUSTRALIA

Telephone: +61 7 3826 7251     Email: Bill.Venables@cmis.csiro.au     
      Fax: +61 7 3826 7304
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From novo@uiuc.edu  Fri Sep 24 02:49:17 1999
From: novo@uiuc.edu (Alvaro A. Novo)
Date: Thu, 23 Sep 1999 20:49:17 -0500
Subject: analysis of multivariate normal (missing values)
Message-ID: <99092320592900.04464@friedman>

Hi,

I could not find an R package for the analysis of multivariate normal
datasets with missing values. Prof. Joseph Schafer has created an S+ library
(norm) that does such type of analysis, which I now ported to R. 

I guess that I should have asked here if there are other people working on
such project, before I actually ported it, but... If such package has not been
ported, I will upload the package (norm, original name) anytime soon.
Please let me know if you are working on such project.

Thank you,

Alvaro A. Novo


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Sep 24 09:58:46 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 24 Sep 1999 10:58:46 +0200
Subject: R's startup : .Rprofile & .Renviron  -- info and RFC
Message-ID: <199909240858.KAA04862@sophie.ethz.ch>

		[RFC = Request for Comments]

{ Yes, the documentation for .Renviron is really not there (but the FAQ...);
  the rest is in ?Startup }

In R's Startup (on Unix only??) {unless --no-environ is specified}
 ~/.Renviron (if there) is read as an 'sh' script before R is called,

then R looks ((for the site-wide Rprofile and then))
for .Rprofile in the current directory and then for ~/.Rprofile
(in the user's home directory).

I'd like to set R_NSIZE and R_VSIZE ``project dependent'' automatically,
and therefore would like  .Renviron also searched in the currenct directory
before the $HOME directory.
(setting --nsize or --vsize explicitly would always override as they
should).

Is this desired?  

Is is portable (at least) to Windows?
In the windows FAQ I've learnt that you must set the command line
arguments --nsize ..  when defining a shortcut to the R executable
in the corresponding directory (correct?).
Is this *the* windows way or does is make sense to have .Renviron files
($HOME would only be used on NT, I presume ?
	-- yes, I am a complete ``Wingnorant'' !)

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Sep 24 11:07:40 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 24 Sep 1999 11:07:40 +0100 (BST)
Subject: R's startup : .Rprofile & .Renviron  -- info and RFC
In-Reply-To: <199909240858.KAA04862@sophie.ethz.ch>
Message-ID: <Pine.GSO.4.05.9909241053250.13755-100000@auk.stats>

On Fri, 24 Sep 1999, Martin Maechler wrote:

> 		[RFC = Request for Comments]
> 
> { Yes, the documentation for .Renviron is really not there (but the FAQ...);
>   the rest is in ?Startup }
> 
> In R's Startup (on Unix only??) {unless --no-environ is specified}
>  ~/.Renviron (if there) is read as an 'sh' script before R is called,

On Windows it is read as a set of NAME=VALUE statements.

> then R looks ((for the site-wide Rprofile and then))
> for .Rprofile in the current directory and then for ~/.Rprofile
> (in the user's home directory).
> 
> I'd like to set R_NSIZE and R_VSIZE ``project dependent'' automatically,
> and therefore would like  .Renviron also searched in the currenct directory
> before the $HOME directory.
> (setting --nsize or --vsize explicitly would always override as they
> should).
> 
> Is this desired?  
> 
> Is is portable (at least) to Windows?

Yes, no problem. 

> In the windows FAQ I've learnt that you must set the command line
> arguments --nsize ..  when defining a shortcut to the R executable
> in the corresponding directory (correct?).
> Is this *the* windows way or does is make sense to have .Renviron files
> ($HOME would only be used on NT, I presume ?

Sorry, I don't see that as the only way in the rw-FAQ, but I do see how to
use .Renviron under Q2.2.

The current position is:

R figures out a value for R_USER.
It (effectively) reads its environment
It then reads R_USER/.Renviron as NAME=VALUE pairs
It then reads NAME=VALUE pairs off the command line.
It then processes --nsize etc.

The algorithm for R_USER is

If set, use it.
Else if HOME is set, use that (it normally is not).
Else if HOMEDRIVE and HOMEPATH are set (they usually are on NT) use
 HOMEDRIVE\HOMEPATH (the docs have this wrong, I see).
Else use the startup directory.

All we would need is to look for ./.Renviron then R_USER/.Renviron.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rossini@biostat.washington.edu  Fri Sep 24 14:54:25 1999
From: rossini@biostat.washington.edu (A.J. Rossini)
Date: 24 Sep 1999 06:54:25 -0700
Subject: analysis of multivariate normal (missing values)
In-Reply-To: "Alvaro A. Novo"'s message of "Thu, 23 Sep 1999 20:49:17 -0500"
References: <99092320592900.04464@friedman>
Message-ID: <871zbojtym.fsf@alpha.cfas.washington.edu>



I've ported it as well, (and Shafer's other two) but havn't managed to
finish the job (and package it) -- if you cleaned up the Fortran
problems, up load it!  (provided no one else has...).

best,
-tony

>>>>> "AAN" == Alvaro A Novo <novo@uiuc.edu> writes:

    AAN> Hi, I could not find an R package for the analysis of
    AAN> multivariate normal datasets with missing
    AAN> values. Prof. Joseph Schafer has created an S+ library (norm)
    AAN> that does such type of analysis, which I now ported to R.

    AAN> I guess that I should have asked here if there are other
    AAN> people working on such project, before I actually ported it,
    AAN> but... If such package has not been ported, I will upload the
    AAN> package (norm, original name) anytime soon.  Please let me
    AAN> know if you are working on such project.

    AAN> Thank you,

    AAN> Alvaro A. Novo


    AAN> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    AAN> r-devel mailing list -- Read
    AAN> http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html Send "info",
    AAN> "help", or "[un]subscribe" (in the "body", not the subject !)
    AAN> To: r-devel-request@stat.math.ethz.ch
    AAN> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Sep 24 15:13:51 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 24 Sep 1999 16:13:51 +0200 (CEST)
Subject: Private data libraries (idea & trick)
In-Reply-To: <x2iu5388wk.fsf@blueberry.kubism.ku.dk>
References: <x2iu5388wk.fsf@blueberry.kubism.ku.dk>
Message-ID: <14315.34591.572539.50534@fangorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> It has been annoying me for a while that data in user areas are more
> difficult to handle than those in the packages. 

> Especially for beginners, it would be very handy to be able just to
> say "data(mydata)", rather than
> "mydata<-read.table('mydata.txt',header=T)"

> What just occurred to me was that the following hack actually works:

> Type

> library('.',lib.loc='.')

> and everything in ./data behaves as if it were in a package. 

> Another interesting hack is that one can do this:

> [pd@blueberry data]$ cat > file.txt
> a b
> 1 2
> 3 4
> [pd@blueberry data]$ cat > file.R
> file<-transform(read.table('file.txt',header=T),
>     b=factor(b,levels=1:4,labels=letters[1:4]))

> and then from inside R, get the dataframe with factor recoding and
> everything as

>> data(file)
>> file
>   a b
> 1 1 b
> 2 3 d

> Question: Should we perhaps clean this up a little and formalize it?

Actually, this works in directories different from the current one as
well, as the working directory is changed temporarily.  However, someone
pointed out that this is not thread-safe, so we should be careful about
announcing this feature.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Sep 24 15:29:44 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 24 Sep 1999 16:29:44 +0200
Subject: Private data libraries (idea & trick)
In-Reply-To: Kurt Hornik's message of "Fri, 24 Sep 1999 16:13:51 +0200 (CEST)"
References: <x2iu5388wk.fsf@blueberry.kubism.ku.dk> <14315.34591.572539.50534@fangorn.ci.tuwien.ac.at>
Message-ID: <x2iu508js7.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> >>>>> Peter Dalgaard BSA writes:
...
> >> data(file)
> >> file
> >   a b
> > 1 1 b
> > 2 3 d
> 
> > Question: Should we perhaps clean this up a little and formalize it?
> 
> Actually, this works in directories different from the current one as
> well, as the working directory is changed temporarily. 

Yes. Actually it relies on it because file.{R,txt} would be in ./data

> However, someone
> pointed out that this is not thread-safe, so we should be careful about
> announcing this feature.

Er, didn't that just mean that the CWD would have to be yet another
per-thread item, or source() would have to block other threads for the
duration? Would seem a bit silly to have a chdir option and not be
allowed to use it...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Sep 24 15:50:07 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 24 Sep 1999 15:50:07 +0100 (BST)
Subject: argument PACKAGE in .C/.Fortran
Message-ID: <Pine.GSO.4.05.9909241537230.27548-100000@auk.stats>

One problem with linking compiled code is getting the symbol from the right
shared library/DLL (hereafter DLL). This actually happened to Guido
Masarotto recently: both leaps and ts had "ss", and leaps got ts's
version (and thereby crashed R).

We have added an argument PACKAGE to .C, .Fortran, .Call and .External,
which confines the symbol search to the named DLL (name without extension).
This in today's R-release, but it is backwards compatible if used as the
last argument (one surplus argument does no harm).  We would like to
encourage package writers to make use of it: R's own code now does.

For future reference, especially for porting projects, tomorrow's version
of R-release also allows passing float/REAL arguments to and from
.C/.Fortran, and has handling of Fortran character strings that
actually works on all the systems I have access to.

Brian Ripley

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Sep 24 18:02:00 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 24 Sep 1999 19:02:00 +0200
Subject: RFC: enhancement for sapply() : do.names
Message-ID: <199909241702.TAA12166@sophie.ethz.ch>

Among other uses of  sapply(), I use to use it for 
"analyzing" / "summarizing" components of a list or to `summarize' objects
in my search path,
typically such as

sapply(obj.names, function(n){ r <- get(n); unlist(r[c("x","y","par")]) })

which gives a list or a 3-col matrix (depending if "x", "y","par" have always
same length..) that has no (row)names unfortunately, even though it's clear
that I would want my initial names...

  for(n in 1:3) 
	  assign(paste("o",n,sep=""), list(x=n,y=n^2,par=n/4))
  (obj.n <- paste("o",1:3,sep=""))
  sapply(obj.n, function(n){ unlist(get(n)[c("x","y","par")]) })

which gives

	[,1] [,2] [,3]
    x   1.00  2.0 3.00
    y   1.00  4.0 9.00
    par 0.25  0.5 0.75

but I would want

	  o1  o2   o3
    x   1.00 2.0 3.00
    y   1.00 4.0 9.00
    par 0.25 0.5 0.75

----
I can get this with the following patch :

--- sapply.R	1999/01/29 17:39:28	1.3
+++ sapply.R	1999/09/24 16:12:53
@@ -1,8 +1,10 @@
-sapply <- function(X, FUN, ..., simplify = TRUE)
+sapply <- function(X, FUN, ..., simplify = TRUE, do.names = TRUE)
 {
     FUN <- match.fun(FUN)
-
     answer <- lapply(as.list(X), FUN, ...)
+    if(do.names && is.null(names(answer))) { # create names if sensible
+        if(is.character(X)) names(answer) <- X
+    }
     if(simplify && length(answer) &&
        length(common.len <- unique(unlist(lapply(answer, length)))) == 1) {
 	if(common.len == 1)

---------------

Now, before implementing this:

1) is "do.names" proper naming or should we rather use
	"DO.NAMES", "USE.NAMES", ...
   (at the moment, I'd prefer  USE.NAMES)


2) Inside the new  if(do.names ....) { .... }  clause, 
   we can try harder, e.g.,

  if(do.names && is.null(names(answer))) { # create names if sensible
	names(answer) <- 
	    if(is.character(X)) X  else  abbreviate(deparse(substitute(X)))
  }

   - actually this wouldn't always work as desired;  
     `substitute(X)' would have to be saved
     before the first use of X ( evaluation of expressions...)
   - In that case, do.names (or USE.NAMES) should probably have
     the default  is.character(X)  -- for efficiency & back-compatibility

Opinions?

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Sep 24 19:53:07 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 24 Sep 1999 19:53:07 +0100 (BST)
Subject: R's startup : .Rprofile & .Renviron  -- info and RFC
In-Reply-To: <199909240858.KAA04862@sophie.ethz.ch>
Message-ID: <Pine.GSO.4.05.9909241949210.27899-100000@auk.stats>

On Fri, 24 Sep 1999, Martin Maechler wrote:

> 		[RFC = Request for Comments]
> 
> { Yes, the documentation for .Renviron is really not there (but the FAQ...);
>   the rest is in ?Startup }
> 
> In R's Startup (on Unix only??) {unless --no-environ is specified}
>  ~/.Renviron (if there) is read as an 'sh' script before R is called,
> 
> then R looks ((for the site-wide Rprofile and then))
> for .Rprofile in the current directory and then for ~/.Rprofile
> (in the user's home directory).
> 
> I'd like to set R_NSIZE and R_VSIZE ``project dependent'' automatically,
> and therefore would like  .Renviron also searched in the currenct directory
> before the $HOME directory.
> (setting --nsize or --vsize explicitly would always override as they
> should).
> 
> Is this desired?  

It seems done on Unix, so now on Windows too, if not committed yet.

You had been worried, but all the info is in the Windows README. However,
I had got HOMEDRIVE as HOMEDIR, so thank you getting me to re-read it!

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From oka@debian.or.jp  Sat Sep 25 18:16:05 1999
From: oka@debian.or.jp (oka@debian.or.jp)
Date: Sat, 25 Sep 1999 19:16:05 +0200 (MET DST)
Subject: segmentation fault in R (PR#286)
Message-ID: <199909251716.TAA20918@pubhealth.ku.dk>


Hi,

  c(1,2,3) %*% c(1,2,3)[drop=TRUE]

or

  c(1,2,3) %*% c(1,2,3)[drop=FALSE]

caused segmentation fault.

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status = 
 status.rev = 0
 major = 0
 minor = 65.0
 year = 1999
 month = August
 day = 27
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Sep 25 19:01:47 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sat, 25 Sep 1999 20:01:47 +0200 (MET DST)
Subject: segmentation fault in R (PR#286)
Message-ID: <199909251801.UAA20977@pubhealth.ku.dk>

On Sat, 25 Sep 1999 oka@debian.or.jp wrote:

>   c(1,2,3) %*% c(1,2,3)[drop=TRUE]
> 
> or
> 
>   c(1,2,3) %*% c(1,2,3)[drop=FALSE]
> 
> caused segmentation fault. < 0.65.0, Linux >

We are very grateful to Martin Maechler for working hard on tracking down
many such things. In the current R-release it reports (as it should)

> c(1,2,3) %*% c(1,2,3)[drop=TRUE]
Error in c(1, 2, 3)[drop = TRUE] : no index specified

Thank you for your report.

[... system details]

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep 27 08:52:15 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 27 Sep 1999 09:52:15 +0200
Subject: boxplot()'s return value names
Message-ID: <199909270752.JAA01756@sophie.ethz.ch>

Something worth discussing,

I think these output names  NEED  a change :

    > boxplot(rt(250,df=3), plot=F)
    $"1"
    $"1"$stats
    [1] -2.7995357 -0.7170382  0.1109581  0.8426811  3.0483316

    $"1"$n
    [1] 250

    $"1"$conf
    [1] -0.04490152  0.26681765

    $"1"$out
     [1]  5.784389  4.766206 -3.932449 -3.460407 -3.695599  5.486126 -3.141079
     [8]  4.484507 12.731848  3.867611  4.040786  4.137455  3.772149  7.693779
    [15] -3.431560  3.860079 -4.087880  3.766799  4.497379 -3.543726 -6.196635
    [22] -6.322201

- "1" should rather be 1

and

 str(boxplot(data.frame(x=1:10,y=rt(10,df=4)),plot=F))

List of 2
 $ x:List of 4
  ..$ stats: num [1:5] 1 3 5.5 8 10
  ..$ n    : int 10
  ..$ conf : num [1:2] 3 8
  ..$ out  : int(0) 
 $ y:List of 4
  ..$ stats: num [1:5] -1.4097  0.0251  0.4533  1.0871  1.4427
  ..$ n    : int 10
  ..$ conf : num [1:2] -0.0774  0.9840
  ..$ out  : num(0) 
 - attr(*, "row.names")= chr [1:10] "1" "2" "3" "4" "5" "6" "7" "8" "9" "10"

where the `trailing'  "row.names" attribute seems *very* unnecessary.

{I'm in a hurry..}


-- 
Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Mon Sep 27 10:12:21 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon, 27 Sep 1999 11:12:21 +0200 (MET DST)
Subject: text( col=, cex=, font=) : doesn't allow more than length-1 arg (PR#287)
Message-ID: <199909270912.LAA27339@pubhealth.ku.dk>


text(..., col = <..>)   doesn't work if col has length more than one;

and the same for 'cex' and 'font'

A toy example, showing what is desired

plot(1);text(1.2, .8+(0:5)/16, LETTERS[6:1])
## works alright

plot(1);text(1.2, .8+(0:5)/16, LETTERS[6:1],col=1:6)
##>>> Error in par(args) : parameter "col" has the wrong length

---
Explanation:
The source code is in  src/main/plot.c  in do_text(),
and from reading it, "col" (& "cex" & "font") are extracted via GetPar()
(and later would nicely be recycled).
HOWEVER, the ProcessInlinePars() called after the three GetPar() gives the
error message, because "col" (cex, or font) are still part of the `args'
list.

All boils down to the FIXME part of the following description of
GetPar() [around line 120 in plot.c] :

/* GetPar is intended for looking through a list  -- typically that bound
 *	to ... --  for a particular parameter value.  This is easier than
 *	trying to match every graphics parameter in argument lists explicitly.
 * FIXME: This needs to be destructive, so that "ProcessInlinePars"
 *	can be safely called afterwards.
 */

PLEASE, can we fix this!

Idea: don't shorten the `parlist' argument of GetPar(), 
      for efficiency.
Just set the TAG to "", such that it will be disregarded subsequently,
i.e., do something like

SEXP GetPar(char *which, SEXP parlist)
{
    SEXP w, p;
    w = install(which);
    for (p = parlist; p != R_NilValue; p = CDR(p)) {
	if (TAG(p) == w) {
 NEW>>>	    TAG(p) == mkString("");
	    return CAR(p);
	}
    }
    return R_NilValue;
}

	  

-- 
Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Mon Sep 27 11:18:52 1999
From: J.C.Rougier@durham.ac.uk (Jonathan Rougier)
Date: Mon, 27 Sep 1999 11:18:52 +0100 (BST)
Subject: chol() dimnames
Message-ID: <Pine.GSO.3.96.990927110820.382H-100000@laplace>

Hi Everyone,

Just a minor point, but could chol() be changed to include the dimnames of
the original matrix?  This will ensure that x and t(R) %*% R have the same
dimnames, where R <- chol(x).  So we just need to insert

    if (!is.null(dx <- dimnames(x))) 
        dimnames(z$v) <- dx

ahead of the return.  Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Sep 27 12:25:05 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 27 Sep 1999 12:25:05 +0100 (BST)
Subject: chol() dimnames
Message-ID: <199909271125.MAA07858@toucan.stats.ox.ac.uk>


> Date: Mon, 27 Sep 1999 11:18:52 +0100 (BST)
> From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
> To: r-devel@stat.math.ethz.ch
> Subject: chol() dimnames
> 
> Hi Everyone,
> 
> Just a minor point, but could chol() be changed to include the dimnames of
> the original matrix?  This will ensure that x and t(R) %*% R have the same
> dimnames, where R <- chol(x).  So we just need to insert
> 
>     if (!is.null(dx <- dimnames(x))) 
>         dimnames(z$v) <- dx
> 
> ahead of the return.  Cheers, Jonathan.

This is a picky comment, but maybe we should try to get this spot on.

(i) Suppose that the row and column names of x are different? Which should
one use?

(ii) I don't think that R has any obvious row names: effectively this is
a linear transformation to a different and unamed basis for the space.

I believe all one actually knows is that the colnames of R should be the
colnames of x, if the row and column names of x match. However, the 
prototype does preserve the names.  Should we just preserve the colnames?


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Sep 27 13:03:52 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Sep 1999 14:03:52 +0200
Subject: chol() dimnames
In-Reply-To: Prof Brian Ripley's message of "Mon, 27 Sep 1999 12:25:05 +0100 (BST)"
References: <199909271125.MAA07858@toucan.stats.ox.ac.uk>
Message-ID: <x2905s8st3.fsf@blueberry.kubism.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> I believe all one actually knows is that the colnames of R should be the
> colnames of x, if the row and column names of x match. However, the 
> prototype does preserve the names.  Should we just preserve the colnames?

That would make OK sense to me. By assumption X == t(X) so if it doesn't
have the same row and column names, something is wrong anyway and we
can do whatever we please to fix things up.

However: Somewhere in the back of my mind lies a note to the effect
that chol() should really handle the rank-deficient cases better, via
some sort of pivoting. Will this muck things up (possibly not if it
only removes singularities and plugs in rows/cols of zeroes)? I seem to
recall that the current chol() got lme() in trouble. I got as far as
locating the candidate replacement for chol.f on Netlib and then got
away from it.

Currently, we get

> z<-matrix(rnorm(15),3,5)
> x<-t(z)*z
> chol(x)
Error: singular matrix in chol

The prototype (Splus 3.4) handles this a bit better:
> chol(x)
         [,1]      [,2]        [,3]          [,4]          [,5] 
[1,] 1.703739 1.9199843 -0.94401977 -1.129732e+00 -8.387157e-01
[2,] 0.000000 0.7605888  0.08437014  8.385107e-01 -2.259906e-01
[3,] 0.000000 0.0000000  0.86549993  7.381480e-01  5.811783e-01
[4,] 0.000000 0.0000000  0.00000000 -7.771561e-16  1.110223e-16
[5,] 0.000000 0.0000000  0.00000000  0.000000e+00  0.000000e+00
attr(, "rank"):
[1] 3
Warning messages:
  Choleski decomposition not of full rank in: chol(x)

It also allows pivoting, but I don't think we want their algorithm:

> chol(x,piv=T)
         [,1]       [,2]       [,3]          [,4]          [,5] 
[1,] 2.065148 -0.7414994 -0.8465894  1.583980e+00 -8.629924e-01
[2,] 0.000000  1.4051462  0.8172503 -5.339291e-01  3.893657e-01
[3,] 0.000000  0.0000000  0.5126111  3.296278e-01  4.426312e-01
[4,] 0.000000  0.0000000  0.0000000  2.107342e-08  5.268356e-09
[5,] 0.000000  0.0000000  0.0000000  0.000000e+00  7.850462e-17
attr(, "pivot"):
[1] 2 4 3 1 5
attr(, "rank"):
[1] 5
    ^
    !
oops....


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Jonathan Rougier <J.C.Rougier@durham.ac.uk>  Mon Sep 27 13:02:39 1999
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk> (Jonathan Rougier)
Date: Mon, 27 Sep 1999 13:02:39 +0100 (BST)
Subject: chol() dimnames
In-Reply-To: <199909271125.MAA07858@toucan.stats.ox.ac.uk>
Message-ID: <Pine.GSO.3.96.990927122553.382I-100000@laplace>

Hi Brian,

On Mon, 27 Sep 1999, Prof Brian Ripley wrote:

> This is a picky comment, but maybe we should try to get this spot on.

> (i) Suppose that the row and column names of x are different? Which should
> one use?
>
> (ii) I don't think that R has any obvious row names: effectively this is
> a linear transformation to a different and unamed basis for the space.
> 
> I believe all one actually knows is that the colnames of R should be the
> colnames of x, if the row and column names of x match. However, the 
> prototype does preserve the names.  Should we just preserve the colnames?

I think your qualms would be answered if the attribution of dimnames was
only made in the event that x has matching row and column names.  Whether
just the column names should be preserved in this case is a moot point.
But you might imagine a cautious programmer wanting to be sure that the
row names of Q correspond with the row names of some other matrix A in the
calculation t(Q) %*% A.  Preserving the row names doesn't do any harm, and
it might just be helpful.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Mon Sep 27 13:10:26 1999
From: J.C.Rougier@durham.ac.uk (Jonathan Rougier)
Date: Mon, 27 Sep 1999 13:10:26 +0100 (BST)
Subject: chol() dimnames
In-Reply-To: <x2905s8st3.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.3.96.990927130308.382J-100000@laplace>

Hi Peter,

> However: Somewhere in the back of my mind lies a note to the effect
> that chol() should really handle the rank-deficient cases better, via
> some sort of pivoting.

I agree completely.  I have an ugly patch to catch the case where zeros
appear on the diagonal but a pivoting flag to handle the semi-definite
case and more generally to improve the performance of the algorithm would
be a big help.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Mon Sep 27 13:44:15 1999
From: bates@stat.wisc.edu (Douglas Bates)
Date: 27 Sep 1999 07:44:15 -0500
Subject: chol() dimnames
In-Reply-To: Peter Dalgaard BSA's message of "27 Sep 1999 14:03:52 +0200"
References: <199909271125.MAA07858@toucan.stats.ox.ac.uk> <x2905s8st3.fsf@blueberry.kubism.ku.dk>
Message-ID: <6rbtao34o0.fsf@franz.stat.wisc.edu>

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> However: Somewhere in the back of my mind lies a note to the effect
> that chol() should really handle the rank-deficient cases better, via
> some sort of pivoting. Will this muck things up (possibly not if it
> only removes singularities and plugs in rows/cols of zeroes)? I seem to
> recall that the current chol() got lme() in trouble. 

I believe the trouble there was not due to R's chol not handling the
semi-definite case.  (Sorry about the double negative.)  I think it is
because internally chol is called differently than in S.  We have code
like

#ifdef R_S_H
	  F77_CALL(chol)(auxRes, &ncol, &ncol, auxRes, &l);
#else
	  F77_CALL(chol)(auxRes, &ncol, res, &zero, &zero, &l);
#endif /* R_S_H */

in the C code that implements lme.

I believe there is a pivoting option available for the Linpack dchdc
routine but not for the dpodc routine.  (My copy of the manual is at
the office so I can't check this.)  That pivoting is similar to the
pivoting in dqrdc - you specify which columns (and the corresponding
rows in the case of dchdc) are available to be re-ordered and it
re-orders everything in the optimal ordering.  This doesn't work well
for model matrices or quantities derived from model matrices where you
want to keep the columns associated with the same terms adjacent if
possible.

Notice that in your example the diagonal elements of the decomposition
are strictly decreasing after pivoting.  That is what I mean by the
optimal ordering.

> > chol(x,piv=T)
>          [,1]       [,2]       [,3]          [,4]          [,5] 
> [1,] 2.065148 -0.7414994 -0.8465894  1.583980e+00 -8.629924e-01
> [2,] 0.000000  1.4051462  0.8172503 -5.339291e-01  3.893657e-01
> [3,] 0.000000  0.0000000  0.5126111  3.296278e-01  4.426312e-01
> [4,] 0.000000  0.0000000  0.0000000  2.107342e-08  5.268356e-09
> [5,] 0.000000  0.0000000  0.0000000  0.000000e+00  7.850462e-17
> attr(, "pivot"):
> [1] 2 4 3 1 5
> attr(, "rank"):
> [1] 5
>     ^
>     !
> oops....
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Sep 27 14:58:46 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Sep 1999 15:58:46 +0200
Subject: chol() dimnames
In-Reply-To: Douglas Bates's message of "27 Sep 1999 07:44:15 -0500"
References: <199909271125.MAA07858@toucan.stats.ox.ac.uk> <x2905s8st3.fsf@blueberry.kubism.ku.dk> <6rbtao34o0.fsf@franz.stat.wisc.edu>
Message-ID: <x2670w8nhl.fsf@blueberry.kubism.ku.dk>

Douglas Bates <bates@stat.wisc.edu> writes:

> I believe there is a pivoting option available for the Linpack dchdc
> routine but not for the dpodc routine.  (My copy of the manual is at
> the office so I can't check this.)  That pivoting is similar to the
> pivoting in dqrdc - you specify which columns (and the corresponding
> rows in the case of dchdc) are available to be re-ordered and it
> re-orders everything in the optimal ordering.  This doesn't work well
> for model matrices or quantities derived from model matrices where you
> want to keep the columns associated with the same terms adjacent if
> possible.

Exactly, dchdc was the one I had been thinking of too. I don't really
see the problem in the reordering, though. Just put things back in
order afterwards? However, the column locking feature doesn't seem too
useful to me.

> 
> Notice that in your example the diagonal elements of the decomposition
> are strictly decreasing after pivoting.  That is what I mean by the
> optimal ordering. 

Yup. Although there are some obvious scaling issues that makes the
optimality a bit dubious (such as when you change the units on a
regressor from uM to M).

There's a variation of Cholesky where you essentially just put a zero
in the diagonal in case of singularity and proceed with the remainder
of the matrix, but noone seems to implement that.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Sep 27 16:37:57 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 27 Sep 1999 16:37:57 +0100 (BST)
Subject: chol() dimnames
Message-ID: <199909271537.QAA15954@toucan.stats.ox.ac.uk>

> From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> Date: 27 Sep 1999 15:58:46 +0200
> 
> There's a variation of Cholesky where you essentially just put a zero
> in the diagonal in case of singularity and proceed with the remainder
> of the matrix, but noone seems to implement that.

src/appl/uncmin has a choldc that is some variation of that sort.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From caves@yorvic.york.ac.uk  Tue Sep 28 09:30:55 1999
From: caves@yorvic.york.ac.uk (caves@yorvic.york.ac.uk)
Date: Tue, 28 Sep 1999 10:30:55 +0200 (MET DST)
Subject: configure bug with IRIX 6.5 (Makedep) (PR#288)
Message-ID: <199909280830.KAA07916@pubhealth.ku.dk>

Full_Name: Leo Caves
Version: 0.65.0
OS: SGI/IRIX 6.5
Submission from: (NULL) (144.32.72.76)


using default configure under SGI/IRIX 6.5.
(I switched to gnumake, after initial problems, this might not be necesssary).

the make rule for creating dependencies is wrong for the SGI C compiler.
The rule assumes that cc -M file.c -o file.d works (it doesn't).
One needs to explicitly capture stdout to grab the dependencies:
i.e. cc -M file.c > file.d

simple as that.

when I run tests, there are 2 errors reported

1/ in print-tests.R
(printing *very* small numbers with the statement:)
> cat("dig|  formatC(signif(txn, d=dig)\n")
dig|  formatC(signif(txn, d=dig)
> for(dig in 1:14)#15: Linux 2.1.120, libc-2.0.7 differs from Debian 2.0
+     cat(formatC(dig,w=2), formatC(signif(txn, d=dig), dig=dig+2,
wid=-20),"\n")

Where the blessed version has 0 (zero), the SGI version shows 2.e-308

This looks pretty benign and is flagged in the test script as dependent on
specific libraries etc under linux.

2/ in simple-tests.R
(comparing numbers at limit of word precision)
abs(1- .Machine$double.xmax * 10^(-.Machine$double.max.exp*log10(2)))/Meps <
1e3

This statement returns F instead of T.

This may have effects in pathological cases, but doesn't seem to be a
show-stopper.

So, it looks like a kosher build under SGI/IRIX 6.5.

*Many thanks* for a great system.
Leo
(vanilla AT&T S user since 1991)



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Sep 28 15:44:52 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue, 28 Sep 1999 16:44:52 +0200 (MET DST)
Subject: Collating sequences are used inconsistently. (PR#289)
Message-ID: <199909281444.QAA14157@pubhealth.ku.dk>

R 0.65.0 (and all others I have seen), Solaris 2.6.

> sort(c("a", "A", "b", "B"))
[1] "A" "a" "B" "b"
> "a" < "B"
[1] FALSE

in the en_UK locale. I don't think it is good idea that sort and <
have a different idea of ordering, so I rate this as a bug. As far as I can
see sort uses strcoll and hence the locale, and < uses ASCII.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Sep 28 16:13:17 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Sep 1999 17:13:17 +0200
Subject: Collating sequences are used inconsistently. (PR#289)
In-Reply-To: ripley@stats.ox.ac.uk's message of "Tue, 28 Sep 1999 16:44:52 +0200 (MET DST)"
References: <199909281444.QAA14157@pubhealth.ku.dk>
Message-ID: <x2905rt6gi.fsf@blueberry.kubism.ku.dk>

ripley@stats.ox.ac.uk writes:

> R 0.65.0 (and all others I have seen), Solaris 2.6.
> 
> > sort(c("a", "A", "b", "B"))
> [1] "A" "a" "B" "b"
> > "a" < "B"
> [1] FALSE
> 
> in the en_UK locale. I don't think it is good idea that sort and <
> have a different idea of ordering, so I rate this as a bug. As far as I can
> see sort uses strcoll and hence the locale, and < uses ASCII.

Agreed. I did a i quick runover of all uses of strcmp in the code, and it
seems that the sign only gets used in two files, relop.c (4 times)
and in gnuwin32/dynload.c. The latter one is in a binary search of the
symbol table, which I'll assume is in ASCII order...

I'll make the changes to relop.c if you haven't done so already.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Tue Sep 28 17:23:24 1999
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Tue, 28 Sep 1999 18:23:24 +0200
Subject: read.fwf, perl on win
Message-ID: <37F0EB7C.560D18AC@univie.ac.at>

i just used read.fwf
(which calls perl)
and i noticed something.

i also have mat;lab installed on this machine,
and matlab also installs a version of perl,
but a different one.
additionally, matlab puts its bin directory in the system
path. so, if one does not canerully set the path,
r will call the matlab verion of perl,
and things won't work.

if anybody is collection a list of pitfalls,
this probably should go there.


--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Sep 28 18:19:54 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 28 Sep 1999 18:19:54 +0100 (BST)
Subject: read.fwf, perl on win
In-Reply-To: <37F0EB7C.560D18AC@univie.ac.at>
Message-ID: <Pine.GSO.4.05.9909281813250.28124-100000@auk.stats>

On Tue, 28 Sep 1999, Erich Neuwirth wrote:

> i just used read.fwf
> (which calls perl)
> and i noticed something.
> 
> i also have mat;lab installed on this machine,
> and matlab also installs a version of perl,
> but a different one.
> additionally, matlab puts its bin directory in the system
> path. so, if one does not canerully set the path,
> r will call the matlab verion of perl,
> and things won't work.

That's horrible! There is an official current Perl, and that
works for R, so I presume that Matlab has an outdated one (Perl 4 ?)
Do you know what version Matlab uses?

One thing we can do is to put a require 5.001; or whatever in the
script.

This will apply on binary Unix distributions too, I assume.

> if anybody is collection a list of pitfalls,
> this probably should go there.

With n packages there seem to be n^2 interactions.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Tue Sep 28 21:14:09 1999
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Tue, 28 Sep 1999 22:14:09 +0200
Subject: read.fwf, perl on win
References: <Pine.GSO.4.05.9909281813250.28124-100000@auk.stats>
Message-ID: <37F12191.187930C5@univie.ac.at>

here is the version information.
one of the problems i noticed is that
libraries seem to be different.
i had an error because
perl called 
getopt.pl,
and the library module was called
getopts.pl

since i changed my path so the official perl
from www.perl.org is found first,
things work.



-=-=-=-=-=-=-=-
This is perl, version 5.003_07

Copyright 1987-1996, Larry Wall

        + suidperl security patch
        Win32 port Copyright (c) 1995-1996 Microsoft Corporation.
                All rights reserved.
        Developed by ActiveWare Internet Corp.,
http://www.ActiveWare.com

Perl for Win32 Build 307 - Built 10:11:54 Jul 15 1997

Perl may be copied only under the terms of either the Artistic License
or the
GNU General Public License, which may be found in the Perl 5.0 source
kit.


Prof Brian D Ripley wrote:
> 
> On Tue, 28 Sep 1999, Erich Neuwirth wrote:
> 
> > i just used read.fwf
> > (which calls perl)
> > and i noticed something.
> >
> > i also have mat;lab installed on this machine,
> > and matlab also installs a version of perl,
> > but a different one.
> > additionally, matlab puts its bin directory in the system
> > path. so, if one does not canerully set the path,
> > r will call the matlab verion of perl,
> > and things won't work.
> 
> That's horrible! There is an official current Perl, and that
> works for R, so I presume that Matlab has an outdated one (Perl 4 ?)
> Do you know what version Matlab uses?
> 
> One thing we can do is to put a require 5.001; or whatever in the
> script.
> 
> This will apply on binary Unix distributions too, I assume.
> 
> > if anybody is collection a list of pitfalls,
> > this probably should go there.
> 
> With n packages there seem to be n^2 interactions.
> 
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Wed Sep 29 08:13:58 1999
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Wed, 29 Sep 1999 09:13:58 +0200
Subject: date() in win version
Message-ID: <37F1BC36.37505F29@univie.ac.at>

when i do 
print(date())

the output is
[1] "Wed Sep 29 09:13:04 1999\n"

ios it on purpose the the linfeed is
shown as abbreviation and not done?


--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Sep 29 08:33:57 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 29 Sep 1999 09:33:57 +0200
Subject: date() in win version
In-Reply-To: <37F1BC36.37505F29@univie.ac.at> (message from Erich Neuwirth on
 Wed, 29 Sep 1999 09:13:58 +0200)
References: <37F1BC36.37505F29@univie.ac.at>
Message-ID: <199909290733.JAA04955@sophie.ethz.ch>

>>>>> Erich Neuwirth <erich.neuwirth@univie.ac.at> said:

    Erich> when i do print(date())

    Erich> the output is [1] "Wed Sep 29 09:13:04 1999\n"

    Erich> is it on purpose that the linefeed is shown as abbreviation and
    Erich> not done?

it's not on purpose;  it is a bug that has been fixed even in 0.65.0

Btw, print(.) itself adds a new line;
 but then, why use print() at all?  it is *the default function* 
 { as long as the object hasn't been  invisible()ized },
i.e.
	date()

should be what you want (once you use 0.65.0 or newer..)

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Sep 29 14:57:09 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 29 Sep 1999 15:57:09 +0200
Subject: getenv() can't differentiate  "defined but empty" and "undefined"
Message-ID: <199909291357.PAA15567@sophie.ethz.ch>

getenv(<varname>)  currently returns  ""
if the <varname> is undefined.

However, if <varname> is defined but empty,
getenv(<varname>) still only returns "".

I think this is quite unfortunate  
but consistent with the prototype.

---
I'd propose to change the current behavior.
Something which should be pretty back compatible would 
for the first case (undefined environment variable)
to return "" with an attribute "defined" set to FALSE
i.e.  return(structure("", defined = FALSE))

Does anyone see a problem with this approach ?

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Sep 29 15:52:35 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 29 Sep 1999 15:52:35 +0100 (BST)
Subject: getenv() can't differentiate  "defined but empty" and "undefined"
In-Reply-To: <199909291357.PAA15567@sophie.ethz.ch>
Message-ID: <Pine.GSO.4.05.9909291546210.13114-100000@auk.stats>

On Wed, 29 Sep 1999, Martin Maechler wrote:

> getenv(<varname>)  currently returns  ""
> if the <varname> is undefined.
> 
> However, if <varname> is defined but empty,
> getenv(<varname>) still only returns "".
> 
> I think this is quite unfortunate  
> but consistent with the prototype.
> 
> ---
> I'd propose to change the current behavior.
> Something which should be pretty back compatible would 
> for the first case (undefined environment variable)
> to return "" with an attribute "defined" set to FALSE
> i.e.  return(structure("", defined = FALSE))
> 
> Does anyone see a problem with this approach ?

I think it should really be NULL if undefined: attributes which may or may
not be there are a nuisance.  The only problem I can see is in
system.gnw.r, whihc doe use nchar on getenv.

Small point: when do you want to change this? It is platform-specific code.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Sep 29 16:52:17 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 29 Sep 1999 17:52:17 +0200
Subject: getenv() can't differentiate  "defined but empty" and "undefined"
In-Reply-To: <Pine.GSO.4.05.9909291546210.13114-100000@auk.stats> (message
 from Prof Brian D Ripley on Wed, 29 Sep 1999 15:52:35 +0100 (BST))
References: <Pine.GSO.4.05.9909291546210.13114-100000@auk.stats>
Message-ID: <199909291552.RAA15706@sophie.ethz.ch>

>>>>> On Wed, 29 Sep 1999 Prof Brian D Ripley <ripley@stats.ox.ac.uk> said:

    BDR> On Wed, 29 Sep 1999, Martin Maechler wrote:
    >> getenv(<varname>) currently returns "" if the <varname> is
    >> undefined.
    >> 
    >> However, if <varname> is defined but empty, getenv(<varname>) still
    >> only returns "".
    >> 
    >> I think this is quite unfortunate but consistent with the prototype.
    >> 
    >> ---
    >> I'd propose to change the current behavior.  Something which should
    >> be pretty back compatible would for the first case (undefined
    >> environment variable) to return "" with an attribute "defined" set
    >> to FALSE i.e.  return(structure("", defined = FALSE))
    >> 
    >> Does anyone see a problem with this approach ?

    BDR> I think it should really be NULL if undefined: attributes which
    BDR> may or may not be there are a nuisance. 

that was my first thought, as well, however ...

    BDR> The only problem I can
    BDR> see is in system.gnw.r, whihc doe use nchar on getenv.

and all the user code from S and R which assumes that getenv() returns 
a character() as it is documented !

    BDR> Small point: when do you want to change this? It is
    BDR> platform-specific code.

 (why does this need to be specific? 
   -- yes I was too lazy to study the code ..)

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Thu Sep 30 02:36:11 1999
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Thu, 30 Sep 1999 03:36:11 +0200
Subject: perl on win32, again
Message-ID: <37F2BE8B.790ADD8C@univie.ac.at>

i downloaded the latest release of perl for win (just a few days old)
and it now has a smarter installation routine.
it puts itself in front of all other dirs (in path),
and it als tells that it tries to remove any other path leading
to another perl.
well,
the offending matlab perl lives in
\matlabr11\bin
and this path also contains the whole matlab stuff,
so it cannot be removed.
but with official perl before matylab in the path,
things now work without fiddling
with the path.


--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgutwin@us.ibm.com  Thu Sep 30 20:18:51 1999
From: pgutwin@us.ibm.com (pgutwin@us.ibm.com)
Date: Thu, 30 Sep 1999 21:18:51 +0200 (MET DST)
Subject: Error compiling R on RS6000 (PR#290)
Message-ID: <199909301918.VAA06212@pubhealth.ku.dk>

Full_Name: Paul Gutwin
Version: 65.0
OS: AIX
Submission from: (NULL) (198.133.22.69)


I get an error when I try to compile R on an RS6000. I ran configure, then make,
and received the following:


.....(stuff deleted)....
	ld -bdynamic -bE:../../etc/R.exp -bM:SRE -lc -lm
/usr/prod/contrib/lib/gcc-lib/rs6000-ibm-aix4.1.4/2.8.1/libgcc.a  -o
../../bin/R.X11 arithmetic.o array.o attrib.o bind.o builtin.o character.o
coerce.o colors.o complex.o context.o cov.o cum.o debug.o devPS.o devPicTeX.o
deparse.o deriv.o devices.o dotcode.o dstruct.o duplicate.o envir.o errors.o
eval.o format.o fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o
main.o match.o memory.o model.o names.o objects.o optimize.o options.o par.o
paste.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o printvector.o
printutils.o random.o relop.o saveload.o scan.o seq.o sort.o source.o split.o
subassign.o subscript.o subset.o summary.o unique.o util.o version.o
./unix/libunix.a ../appl/libappl.a ../nmath/libmath.a  -lX11  -lblas  -lxlf90
-lxlf -lm /lib/crt0.o -lz -ldl -lncurses -lm 
ld: 0706-006 Cannot find or open library file: -l z
	ld:open(): A file or directory in the path name does not exist.
ld: 0706-006 Cannot find or open library file: -l ncurses
	ld:open(): A file or directory in the path name does not exist.
make: 1254-004 The error code from the last command is 255.


Stop.
make: 1254-004 The error code from the last command is 2.


Stop.
make: 1254-004 The error code from the last command is 1.


Stop.
make: 1254-004 The error code from the last command is 1.


Stop.

Compilation exited abnormally with code 2 at Thu Sep 30 15:09:00


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Thu Sep 30 22:21:13 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Thu, 30 Sep 1999 17:21:13 -0400
Subject: Error compiling R on RS6000 (PR#290)
In-Reply-To: Your message of "Thu, 30 Sep 1999 21:18:51 EDT."
 <199909301918.VAA06212@pubhealth.ku.dk>
Message-ID: <199909302121.RAA22750@infiniti.ece.cmu.edu>


Paul,

  do you have the output from configure?  What probably happens is
that the libs libz.a and libncurses.a get picked up erroneously in the
configure stage.  For a quick fix, could you check whether R compiles
cleanly after adding in config.site:

LIBS="-L/usr/local/lib -lreadline -lcurses"

(Replacing /usr/prod/contrib/lib with the path to the directory where
you find libreadline.a on your system.  Other candidates are /usr/lib or
/usr/prod/contrib/lib.)

  -tom

P.S. which version of AIX are using?

"PG" == pgutwin  <pgutwin@us.ibm.com> writes:

PG> Full_Name: Paul Gutwin
PG> Version: 65.0
PG> OS: AIX
PG> Submission from: (NULL) (198.133.22.69)
PG> 
PG> 
PG> I get an error when I try to compile R on an RS6000. I ran configure, then make,
PG> and received the following:
PG> 
[snip]

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From lyndon@stat.auckland.ac.nz  Wed Sep  1 08:51:34 1999
From: lyndon@stat.auckland.ac.nz (Lyndon Drake)
Date: Wed, 1 Sep 1999 19:51:34 +1200
Subject: [R] R --gnome segfaults on RH 6.0 with R-0.65.0
In-Reply-To: <x2yaes7zh8.fsf@blueberry.kubism.ku.dk>; from Peter Dalgaard BSA on Tue, Aug 31, 1999 at 05:15:47PM +0200
References: <XFMail.990831164030.awol@xs4all.nl> <x2yaes7zh8.fsf@blueberry.kubism.ku.dk>
Message-ID: <19990901195134.A12088@stat1.stat.auckland.ac.nz>

On Tue, Aug 31, 1999 at 05:15:47PM +0200, Peter Dalgaard BSA wrote:
> Alexander Volovics <awol@xs4all.nl> writes:
> 
> What would interest me is what the content of R_gnome_userprefs.font
> if you go up to #40 (in R_gtk_terminal_new () at terminal.c:112). Just
> type 
> 
> p R_gnome_userprefs.font
> 
> if it's NULL, then we might have a lead on the problem. But Lyndon
> Drake is the guy who knows his way around the Gnome stuff, not me.
> 

Sorry for being so slow to get onto this, but Uni has been a bit busy
lately.  This is probably a problem with the preferences (which are
totally broken right now, but the replacement preferences system should
get committed to CVS next week).  I'll check it out soon...

-- 
Lyndon Drake                       | Desktop:      http://www.gnome.org
isenguard                          | Mail client:  http://www.mutt.org
ICQ#: 12558803                     | Editor:       http://www.vim.org
http://stat.auckland.ac.nz/~lyndon | OS:           http://www.linux.com
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plindsey@alpha.luc.ac.be  Wed Sep  1 10:33:57 1999
From: plindsey@alpha.luc.ac.be (Patrick Lindsey)
Date: Wed, 1 Sep 1999 11:33:57 +0200 (MET DST)
Subject: Problems compiling R65.0.
Message-ID: <199909010933.LAA27167@alpha.luc.ac.be>

Hi,
I appear to have a slight problem compiling R0.65.0 under Linux
(slackware) using g77. By simply typing configure then make, I obtain
a binary which when "ldd" does not contain the f2c library. I
therefore cannot load any libraries containing fortran code (I obtain
unresolved symbol messages from R.X11 and an unable to load shared
library from dyn.load(file)).
If I change the "-lf2c" flag on the FLIBS line of the Makeconf to
"-L/usr/lib/libf2c", I then obtain the following error when R.X11 is
being created:

gcc -export-dynamic  -o ../../bin/R.X11 arithmetic.o array.o attrib.o bind.o builtin.o character.o coerce.o colors.o complex.o context.o cov.o cum.o debug.o devPS.o devPicTeX.o deparse.o deriv.o devices.o dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o main.o match.o memory.o model.o names.o objects.o optimize.o options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o printvector.o printutils.o random.o relop.o saveload.o scan.o seq.o sort.o source.o split.o subassign.o subscript.o subset.o summary.o unique.o util.o version.o ../unix/libunix.a ../appl/libappl.a ../nmath/libmath.a -lSM -lICE -L/usr/X11R6/lib -lX11  -L/usr/lib/libf2c -lm -L/usr/lib/gcc-lib/i486-unknown-linux-gnulibc1/2.7.2.3 -L/usr/i486-unknown-linux-gnulibc1/lib -lm  -lreadline -lz -ldl -lncurses -lm 
../appl/libappl.a(uncmin.o): In function `optchk_':
/usr/local/src/R/src/appl/uncmin.f:1848: undefined reference to `d_lg10'
make[3]: *** [../../bin/R.X11] Error 1

Does anyone have an idea how I could get my libraries working?
Thank you,
Patrick.
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plindsey@alpha.luc.ac.be  Wed Sep  1 10:49:37 1999
From: plindsey@alpha.luc.ac.be (plindsey@alpha.luc.ac.be)
Date: Wed, 1 Sep 1999 11:49:37 +0200 (MET DST)
Subject: Problems compiling R65.0 (PR#262)
Message-ID: <199909010949.LAA03540@pubhealth.ku.dk>

Hi,
I appear to have a slight problem compiling R0.65.0 under Linux
(slackware) using g77. By simply typing configure then make, I obtain
a binary which when "ldd" does not contain the f2c library. I
therefore cannot load any libraries containing fortran code (I obtain
unresolved symbol messages from R.X11 and an unable to load shared
library from dyn.load(file)).
If I change the "-lf2c" flag on the FLIBS line of the Makeconf to
"-L/usr/lib/libf2c", I then obtain the following error when R.X11 is
being created:

gcc -export-dynamic  -o ../../bin/R.X11 arithmetic.o array.o attrib.o bind.o builtin.o character.o coerce.o colors.o complex.o context.o cov.o cum.o debug.o devPS.o devPicTeX.o deparse.o deriv.o devices.o dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o main.o match.o memory.o model.o names.o objects.o optimize.o options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o printvector.o printutils.o random.o relop.o saveload.o scan.o seq.o sort.o source.o split.o subassign.o subscript.o subset.o summary.o unique.o util.o version.o ../unix/libunix.a ../appl/libappl.a ../nmath/libmath.a -lSM -lICE -L/usr/X11R6/lib -lX11  -L/usr/lib/libf2c -lm -L/usr/lib/gcc-lib/i486-unknown-linux-gnulibc1/2.7.2.3 -L/usr/i486-unknown-linux-gnulibc1/lib -lm  -lreadline -lz -ldl -lncurses -lm 
../appl/libappl.a(uncmin.o): In function `optchk_':
/usr/local/src/R/src/appl/uncmin.f:1848: undefined reference to `d_lg10'
make[3]: *** [../../bin/R.X11] Error 1

Does anyone have an idea how I could get my libraries working?
Thank you,
Patrick.

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plindsey@alpha.luc.ac.be  Wed Sep  1 10:55:56 1999
From: plindsey@alpha.luc.ac.be (plindsey@alpha.luc.ac.be)
Date: Wed, 1 Sep 1999 11:55:56 +0200 (MET DST)
Subject: Problems sourcing functions with R65.0 (PR#263)
Message-ID: <199909010955.LAA03720@pubhealth.ku.dk>

Hi,
Sorry for cross-posting the last error message.
I have encountered some more strange problems when loading another of my
libraries. I get a parsing error ("syntax error on line 1707"). I have
carefully looked at my code and there are no syntax errors. In fact, on
R64.1 this function was parsed in properly when the library was loaded
(I just copied the library from one version to another without making any
changes).
I saved my function which is 1734 lines long (all one function) and it appears
that source will not parse a function with more than 1707 lines. Even more
puzzling, if I copy the function and paste it right at the R prompt, the
function does not yield any parsing problem... Would there therefore be a
buffer limit problems of some kind for sourcing files??? If so how can I
modify it??
Thank you,
Patrick.


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Sep  1 11:18:15 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 01 Sep 1999 12:18:15 +0200
Subject: Problems compiling R65.0 (PR#262)
In-Reply-To: plindsey@alpha.luc.ac.be's message of "Wed, 1 Sep 1999 11:49:37 +0200 (MET DST)"
References: <199909010949.LAA03540@pubhealth.ku.dk>
Message-ID: <x21zcjdjfc.fsf@blueberry.kubism.ku.dk>

plindsey@alpha.luc.ac.be writes:

> Hi,
> I appear to have a slight problem compiling R0.65.0 under Linux
> (slackware) using g77. By simply typing configure then make, I obtain
> a binary which when "ldd" does not contain the f2c library. I
> therefore cannot load any libraries containing fortran code (I obtain
> unresolved symbol messages from R.X11 and an unable to load shared
> library from dyn.load(file)).

Yes, this is a bit of a pain. The issue is that libf2c is not a
dynamic library on all systems, and hence does not show on ldd, and
only the routines that are actually used by R get loaded into the
binary. 

What should happen in that case is that R SHLIB/INSTALL would generate
so files with the relevant Fortran linked in, e.g. if that doesn't
happen for you, there's a bug in the configure script. With egsc/g77 I
get the following:

# R INSTALL multiv
Installing package `multiv' ...
 libs
g77  -fPIC -g -O2 -c bea.f -o bea.o
g77  -fPIC -g -O2 -c ca.f -o ca.o
g77  -fPIC -g -O2 -c hc.f -o hc.o
g77  -fPIC -g -O2 -c hcmovie.f -o hcmovie.o
g77  -fPIC -g -O2 -c members.f -o members.o
g77  -fPIC -g -O2 -c partition.f -o partition.o
g77  -fPIC -g -O2 -c pca.f -o pca.o
g77  -fPIC -g -O2 -c sammon.f -o sammon.o
gcc -shared  -o /usr/local/lib/R/library/multiv/libs/multiv.so bea.o ca.o hc.o hcmovie.o members.o partition.o pca.o sammon.o -L/usr/lib/gcc-lib/i386-redhat-linux/egcs-2.91.66 -L/usr/i386-redhat-linux/lib -lg2c -lm

# R SHLIB ca.f 
gcc -shared  -o ca.so ca.o -L/usr/lib/gcc-lib/i386-redhat-linux/egcs-2.91.66 -L/usr/i386-redhat-linux/lib -lg2c -lm



> If I change the "-lf2c" flag on the FLIBS line of the Makeconf to
> "-L/usr/lib/libf2c", I then obtain the following error when R.X11 is
> being created:

That couldn't possibly work. '-L' specifies a directory to search, so
you get the same effect as if you had just removed -lf2c.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Jonathan Rougier <J.C.Rougier@durham.ac.uk>  Wed Sep  1 14:14:18 1999
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk> (Jonathan Rougier)
Date: Wed, 1 Sep 1999 14:14:18 +0100 (BST)
Subject: diag()
Message-ID: <Pine.GSO.3.96.990901140456.19209D-100000@laplace>

Hi Martin,

Just to follow my previous suggestion to modify diag(), the code I
suggested is vulnerable to matrices with dimnames(x) <- list(NULL, NULL),
which does occasionally happen (it has just happened to me!), so the
following would be better ...

"diag" <-
function (x = 1, nrow, ncol = n) 
{
    if (is.matrix(x) && nargs() == 1) {
        md <- min(dim(x))
        y <- c(x)[1 + 0:(md - 1) * (dim(x)[1] + 1)]
        nms <- dimnames(x)
        if (is.list(nms) && !any(sapply(nms, is.null)) &&
          all(nms[[1]][1:md] == nms[[2]][1:md])) 
            names(y) <- nms[[1]][1:md]
        return(y)
    }

... the rest as in the original function.  Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Sep  1 21:13:09 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 1 Sep 1999 22:13:09 +0200
Subject: diag()
In-Reply-To: <Pine.GSO.3.96.990901140456.19209D-100000@laplace> (message from
 Jonathan Rougier on Wed, 1 Sep 1999 14:14:18 +0100 (BST))
References: <Pine.GSO.3.96.990901140456.19209D-100000@laplace>
Message-ID: <199909012013.WAA14572@sophie.ethz.ch>

>>>>> On Wed, 1 Sep 1999 14:14:18 +0100 (BST), Jonathan Rougier <J.C.Rougier@durham.ac.uk> said:

    JonR> Just to follow my previous suggestion to modify diag(), the code
    JonR> I suggested is vulnerable to matrices with dimnames(x) <-
    JonR> list(NULL, NULL), which does occasionally happen (it has just
    JonR> happened to me!), so the following would be better ...

    JonR> "diag" <-
    JonR> function (x = 1, nrow, ncol = n) 
    JonR> {
    JonR>   if (is.matrix(x) && nargs() == 1) {
    JonR>     md <- min(dim(x))
    JonR>     y <- c(x)[1 + 0:(md - 1) * (dim(x)[1] + 1)]
    JonR>     nms <- dimnames(x)
    JonR>     if (is.list(nms) && !any(sapply(nms, is.null)) &&
    JonR>         all(nms[[1]][1:md] == nms[[2]][1:md])) 
    JonR>         names(y) <- nms[[1]][1:md]
    JonR>     return(y)
    JonR>   }

    JonR> ... the rest as in the original function.  Cheers, Jonathan.

    JonR> Jonathan Rougier                       Science Laboratories
    JonR> Department of Mathematical Sciences    South Road
    JonR> University of Durham                   Durham DH1 3LE

Your proposal has been (slightly improved) and commited for 0.64.1 
(or tomorrow's snapshot of R-release).

NEWS has
     
    o	diag(x) now keeps names when appropriate and barfs when x is an array.


Thank you very much.	Martin



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Sep  1 22:09:33 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 01 Sep 1999 23:09:33 +0200
Subject: diag()
In-Reply-To: Martin Maechler's message of "Wed, 1 Sep 1999 22:13:09 +0200"
References: <Pine.GSO.3.96.990901140456.19209D-100000@laplace> <199909012013.WAA14572@sophie.ethz.ch>
Message-ID: <x2n1v67302.fsf@blueberry.kubism.ku.dk>

Martin Maechler <maechler@stat.math.ethz.ch> writes:

> Your proposal has been (slightly improved) and commited for 0.64.1 
                                                                 ^
Um...

> NEWS has
>      
>     o	diag(x) now keeps names when appropriate and barfs when x is an array.

- unless it's of dimension 2, you mean. But is this really desirable
for the 1d case? diag(array(1:9)) used to work like diag(1:9), but is
now an error. E.g. the output of table() can be a 1d array.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Thu Sep  2 11:23:53 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Thu, 2 Sep 1999 12:23:53 +0200 (MET DST)
Subject: R 0.65.x bug :  attach()/eval() {was "lib.source() within library()"} (PR#264)
Message-ID: <199909021023.MAA15071@pubhealth.ku.dk>

In 0.65.0  lib.source() within library()  works differently
and fails to correctly "load" a library when it wants to change an object
that it has defined previously:

Below is a very short shar file that produces a "minimal" example [no
attachment, just appended].
To reproduce  {read on, before doing it!}  do

   sh < libBug.shar <<<<< the file name you gave
   R INSTALL libBug

   echo 'library(libBug)' | R --vanilla --quiet

which gives

    Error: attempt to set an attribute on NULL
    Execution halted

----

The only R code in the whole library is in  libBug/R/only.R

    bla <- pi
    names(bla) <- "N"

However, with help of debug(library) 
and *inside* library  debug(lib.source)

I can now reproduce the problem  without needing library() directly:

    env   <- attach(NULL, name = "libBug")
    exprs <- expression(bla <- pi, names(bla) <- "N")
    for (i in exprs) yy <- eval(i, env)

    ##-> Error: attempt to set an attribute on NULL

and replacing the last line by

    for (i in exprs){ yy <- eval(i,env);print(ls(env=env))
		      cat("bla:",get("bla",env=env),"\n") }
gives

    [1] "*tmp*" "bla"  
    bla: 3.14159265358979 
    Error: attempt to set an attribute on NULL

-----

#!/bin/sh
# This is a shell archive (produced by GNU sharutils 4.2).
# To extract the files from this archive, save it to some FILE, remove
# everything before the `!/bin/sh' line above, then type `sh FILE'.
#
# Made on 1999-09-02 12:00 MET DST by <maechler@sophie>.
# Source directory was `/users/u1/staff/maechler/R'.
#
# Existing files will *not* be overwritten unless `-c' is specified.
# This format requires very little intelligence at unshar time.
# "if test", "echo", "mkdir", and "sed" may be needed.
#
# This shar contains:
# length mode       name
# ------ ---------- ------------------------------------------
#     28 -rw-r--r-- libBug/R/only.R
#     47 -rw-r--r-- libBug/TITLE
#
echo=echo
if mkdir _sh21127; then
  $echo 'x -' 'creating lock directory'
else
  $echo 'failed to create lock directory'
  exit 1
fi
# ============= libBug/R/only.R ==============
if test ! -d 'libBug'; then
  $echo 'x -' 'creating directory' 'libBug'
  mkdir 'libBug'
fi
if test ! -d 'libBug/R'; then
  $echo 'x -' 'creating directory' 'libBug/R'
  mkdir 'libBug/R'
fi
if test -f 'libBug/R/only.R' && test "$first_param" != -c; then
  $echo 'x -' SKIPPING 'libBug/R/only.R' '(file already exists)'
else
  $echo 'x -' extracting 'libBug/R/only.R' '(text)'
  sed 's/^X//' << 'SHAR_EOF' > 'libBug/R/only.R' &&
Xbla <- pi
Xnames(bla) <- "N"
SHAR_EOF
  : || $echo 'restore of' 'libBug/R/only.R' 'failed'
fi
# ============= libBug/TITLE ==============
if test -f 'libBug/TITLE' && test "$first_param" != -c; then
  $echo 'x -' SKIPPING 'libBug/TITLE' '(file already exists)'
else
  $echo 'x -' extracting 'libBug/TITLE' '(text)'
  sed 's/^X//' << 'SHAR_EOF' > 'libBug/TITLE' &&
XlibBug	Simple Package to show lib.source() bug
SHAR_EOF
  : || $echo 'restore of' 'libBug/TITLE' 'failed'
fi
rm -fr _sh21127
exit 0

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From gautier@lion-ag.de  Thu Sep  2 16:40:48 1999
From: gautier@lion-ag.de (gautier@lion-ag.de)
Date: Thu, 2 Sep 1999 17:40:48 +0200 (MET DST)
Subject: trouble with the 'exclude' parameter of factor() (PR#265)
Message-ID: <199909021540.RAA19224@pubhealth.ku.dk>

Full_Name: Laurent Gautier
Version: 0.65.0
OS: Irix 6.5
Submission from: (NULL) (195.110.4.98)


the following doesn't give what I expect

> test _ factor(ORGMORE[[1]],exclude=c(NA,"NOM"))
Warning message: 
NAs introduced by coercion 
> levels(test)
[1] "CYT" "EXC" "MEM" "NOM" "NUC" "SEC"


while this works...

> test _ factor(ORGMORE[[1]],levels=c("CYT","EXEC","MEM","NUC","SEC"),exclude=NA)
> levels(test)
[1] "CYT"  "EXEC" "MEM"  "NUC"  "SEC" 


All apologies if I misunderstood the help page for the factor() function and
this is not strange...
(I mean the results obtained, not my understanding of the help pages  =)    ).



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Sep  2 18:55:14 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Thu, 2 Sep 1999 19:55:14 +0200 (MET DST)
Subject: trouble with the 'exclude' parameter of factor() (PR#265)
Message-ID: <199909021755.TAA19894@pubhealth.ku.dk>

On Thu, 2 Sep 1999 gautier@lion-ag.de wrote:

> Full_Name: Laurent Gautier
> Version: 0.65.0
> OS: Irix 6.5
> Submission from: (NULL) (195.110.4.98)
> 
> 
> the following doesn't give what I expect
> 
> > test _ factor(ORGMORE[[1]],exclude=c(NA,"NOM"))
> Warning message: 
> NAs introduced by coercion 
> > levels(test)
> [1] "CYT" "EXC" "MEM" "NOM" "NUC" "SEC"

For another posting of yours, I assume the x argument is a factor.
Now ?factor is missing an arguments section, but if x is a factor,
exclude has to be a factor too (with the same set of levels plus perhaps
NA), or coercible to factor codes.  So please try

factor(as.character(ORGMORE[[1]]), exclude=c(NA,"NOM"))

> while this works...
> 
> > test _ factor(ORGMORE[[1]],levels=c("CYT","EXEC","MEM","NUC","SEC"),exclude=NA)
> > levels(test)
> [1] "CYT"  "EXEC" "MEM"  "NUC"  "SEC" 
> 
> 
> All apologies if I misunderstood the help page for the factor() function and
> this is not strange...
> (I mean the results obtained, not my understanding of the help pages  =)    ).

We definitely need to document the arguments, probably make this 
friendlier.

PS: as Irix 6.5 is not in the PLATFORMS list, please do us a favour and
submit a PLATFORMS report.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Richard.Beare@cmis.csiro.au  Fri Sep  3 04:29:11 1999
From: Richard.Beare@cmis.csiro.au (Richard Beare)
Date: Fri, 03 Sep 1999 13:29:11 +1000
Subject: recent R versions on alpha-osf-4
Message-ID: <37CF4087.1032CE97@cmis.csiro.au>

Hello,
I'm keen to get R working on the alpha, but haven't managed to build
anything that gets past the "make test" stage. There used to be some
documentation about -mieee_ type changes, but I never had any luck with
these. I'd like to build my own version because I don't have root access
to install the binary version.

Has anyone else had any luck with this? I can't see anything suggesting
ways to go in the documents with R-0.65.

Thanks

-- 
Richard Beare
Richard.Beare@cmis.csiro.au
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Sep  3 23:43:55 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Sat, 4 Sep 1999 00:43:55 +0200
Subject: diag()
In-Reply-To: <x2n1v67302.fsf@blueberry.kubism.ku.dk> (message from Peter
 Dalgaard BSA on 01 Sep 1999 23:09:33 +0200)
References: <Pine.GSO.3.96.990901140456.19209D-100000@laplace> <199909012013.WAA14572@sophie.ethz.ch> <x2n1v67302.fsf@blueberry.kubism.ku.dk>
Message-ID: <199909032243.AAA03262@sophie.ethz.ch>


    PD> Martin Maechler <maechler@stat.math.ethz.ch> writes:
    >> Your proposal has been (slightly improved) and commited for 0.64.1
    PD>                                                                  ^
    PD> Um...

    >> NEWS has
    >> 
    >> o diag(x) now keeps names when appropriate and barfs when x is an
    >> array.

    PD> - unless it's of dimension 2, you mean.
yes..
    PD> But is this really
    PD> desirable for the 1d case? diag(array(1:9)) used to work like
    PD> diag(1:9), but is now an error. E.g. the output of table() can be a
    PD> 1d array.

I know.  
But I think that people may expect something else from diag(<array>).
I don't mind letting the 1D case still go by, but certainly not d >= 3 !

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Sep  5 23:00:49 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Mon, 6 Sep 1999 00:00:49 +0200 (MET DST)
Subject: [R] data frame component replacement: feature or bug? (PR#266)
Message-ID: <199909052200.AAA08081@pubhealth.ku.dk>

Matthew Wiener <mcw@ln.nimh.nih.gov> writes:

> t1 <- data.frame(matrix(rnorm(16), nc=4))
> t1$X1 <- 1  
> t1$X2 <- 2
> print(t1)
> Error: dim<- length of dims do not match the length of object

Well, it is prototype-compatible. Splus 5.3 does likewise. A way out
is

t1<-data.frame(unclass(t1))

However, we do seem to have a bug in the area:

>  t1 <- data.frame(matrix(rnorm(16), nc=4))
>  transform(t1,X1=1)
Error: dim<- length of dims do not match the length of object
>  transform(t1,X1=1,X2=2)
  X1 X2         X3         X4
1  1  2  0.6020524  1.1595935
2  1  2 -1.8212204 -0.2118746
3  1  2  1.5506706  0.0680275
4  1  2 -0.8872958  0.4709870

This boils down to the construction

dfr[1]<-list(X1=1)

which doesn't extend dfr$X1, whereas

dfr[c(1,2)]<-list(X1=3,X2=4)

does. Splus handles both cases. 

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sun Sep  5 23:29:57 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Mon, 6 Sep 1999 00:29:57 +0200 (MET DST)
Subject: [R] data frame component replacement: feature or bug? (PR#266)
Message-ID: <199909052229.AAA08170@pubhealth.ku.dk>

p.dalgaard@biostat.ku.dk writes:

> dfr[1]<-list(X1=1)
> 
> which doesn't extend dfr$X1, whereas
> 
> dfr[c(1,2)]<-list(X1=3,X2=4)
> 
> does. Splus handles both cases. 

Found, fixed, and committed for 0.65.1 (a drop=FALSE was missing where
the replication was done)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mavip5@inet.polyu.edu.hk  Mon Sep  6 02:40:34 1999
From: mavip5@inet.polyu.edu.hk (Li Dongfeng)
Date: Mon, 06 Sep 1999 09:40:34 +0800
Subject: suggestion: postscript paper=user
Message-ID: <37D31B92.7D4C11DA@inet.polyu.edu.hk>

Dear R developers and users,

  I have a suggestion for the postscript device driver.
Now the paer= option only support "a4", "letter",
"legal", "executive". I suggest we add a "user" option
and letter user provide paper size, even like "595x421",
width>height.

For printing purpose, the provided paper size are
nearly enought. But I need to use R to produce
a lot of graphics, and transform these graphics to
PNG format for web publication.  I use ghostscript
to do the transformation, but the default paper size of the
R postscript device is too big, and the orietation
is not correct(we need landscape). I don't know
how to make the image size smaller and
rotating 90 degrees with ghostscript.  I had to
patch the R source(src/unix/devPS.c)  myself
to add a paper size. If R provide a paper="user "
option for the postscript device, things would be
much easier.

Li Dongfeng


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep  6 09:47:10 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 6 Sep 1999 10:47:10 +0200
Subject: Proposal for improved grid()  [non-backward compatible]
Message-ID: <199909060847.KAA01186@sophie.ethz.ch>

Not many of you will use grid() widely, probably.
Also, two months ago, Paul Murrell said on R-help (topic "grid command")

  PM>> i think the abline() solution is the best for doing what grid() won't.  
  PM>> like you say, grid() is just a simple front-end to abline().

grid() *is* too simple to be of practical use.

I propose the following which is of some practical use, 
since it uses much more useful defaults:

    grid <- function (nx=NULL, ny=NULL, col="lightgray", lty="dotted")
    {
	if (is.null(nx)|| nx >= 1) {
	    axp <- par("xaxp")
	    if(is.null(nx)) nx <- axp[3]
	    abline(v = seq(axp[1],axp[2],len=1+nx), col = col, lty = lty)
	}
	if (is.null(ny)|| ny >= 1) {
	    axp <- par("yaxp")
	    if(is.null(ny)) ny <- axp[3]
	    abline(h = seq(axp[1],axp[2],len=1+ny), col = col, lty = lty)
	}
    }

Try e.g.

plot(1:10, panel.first = grid(col="red"))
qqnorm(rnorm(100), panel.first=grid())
plot(1:10, panel.first=grid(ny=4))
plot(1:10, panel.first=grid(ny=0))

-----------

The only "problem":  It's not backwards compatible.
Does anyone have a problem with that?

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Mon Sep  6 10:04:18 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon, 6 Sep 1999 11:04:18 +0200 (MET DST)
Subject: matplot(... panel.first=..) fails  <==> dealing with "..." (PR#267)
Message-ID: <199909060904.LAA12129@pubhealth.ku.dk>

Maybe, the following is not a bug in the strict sense,....

The following code shows what the effect :

  p1 <- function(...) plot.default(...)
  p2 <- function(...) { n <- names(list(...)); plot.default(...) }

  par(mfrow=c(2,2))
  p1(1:10, panel.first = grid(10,10)) # works okay (grid drawn)
  p2(1:10, panel.first = grid(10,10)) # doesn't draw the grid

A consequence of this is that the panel.first argument (of plot.default)
doesn't work with matplot()
	[well, matplot()'s doc doesn't claim it should, but still

-------
The real questions behind are:

1a) Why is "..." changed at the moment that I do  list(...)
1b) is this basic behavior desirable / changeable ....

2) How can one work around? 
   {save "..." to something else, first? 
    or explicitly save panel.first?}

-----------------------------

R versions,  both 0.64.2 and 0.65.0  (probably all R versions)

Version:
 platform = sparc-sun-solaris2.5
 arch = sparc
 os = solaris2.5
 system = sparc, solaris2.5
 status =
 status.rev = 0
 major = 0
 minor = 64.2
 year = 1999
 month = July
 day = 3
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

--
Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Sep  6 13:25:30 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 06 Sep 1999 14:25:30 +0200
Subject: matplot(... panel.first=..) fails  <==> dealing with "..." (PR#267)
In-Reply-To: maechler@stat.math.ethz.ch's message of "Mon, 6 Sep 1999 11:04:18 +0200 (MET DST)"
References: <199909060904.LAA12129@pubhealth.ku.dk>
Message-ID: <x2puzwb51h.fsf@blueberry.kubism.ku.dk>

maechler@stat.math.ethz.ch writes:

> Maybe, the following is not a bug in the strict sense,....
> 
> The following code shows what the effect :
> 
>   p1 <- function(...) plot.default(...)
>   p2 <- function(...) { n <- names(list(...)); plot.default(...) }
> 
>   par(mfrow=c(2,2))
>   p1(1:10, panel.first = grid(10,10)) # works okay (grid drawn)
>   p2(1:10, panel.first = grid(10,10)) # doesn't draw the grid
...
> The real questions behind are:
> 
> 1a) Why is "..." changed at the moment that I do  list(...)
> 1b) is this basic behavior desirable / changeable ....

That's a result of lazy evaluation. plot.default is really playing
with fire, the way it is currently written. list(...) will force
evaluation of the promises which in turn causes grid() to be called
too early. I don't think it is desirable to change this behavior
(well, Robert wants us to consider eager evaluation, but that would
cause the construction to stop working in all cases!)

> 2) How can one work around? 
>    {save "..." to something else, first? 
>     or explicitly save panel.first?}
> 

Neither of the above, because the object is to access "..." without forcing
evaluation of its contents. One can do things like

> p2
function (...) 
{
    n <- names(match.call(expand.dots = F)[["..."]])
    plot.default(...)
}

Or, one can modify plot.default to take panel.first as an
*unevaluated* expression (mode "call" or "expression"), and do an
explicit eval(panel.first). But then you'd have to do 

p2(1:10, panel.first = quote(grid(10,10))) # or expression( )

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Sep  6 13:54:37 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 6 Sep 1999 13:54:37 +0100 (BST)
Subject: Fortran character strings
Message-ID: <199909061254.NAA00597@toucan.stats.ox.ac.uk>

Has anyone ever successfully used Fortran character strings with R?

?Foreign says

         R              C                  Fortran
      integer       int *              integer
  ....
      character     char **            [compiler dependent]

     Character strings are passed as C arrays of character
     strings to Fortran: the first string may be usable if
     its length is passed separately.

and I have been taking a look. The linkage sends char ** to Fortran.
On the other hand, INTPR and  DBLEPR assume Fortran character strings
are char *.  On all my systems DBLEPR works and .Fortran does not,
but I do know of one compiler (Watcom Fortran for Windows NT) where the 
linkage really is equivalent to char **.

Fortran in S takes the first string in a character vector and passes that as
char * (except on the Watcom-compiled Windows version), as far as I
can deduce without the source code.

I think we should either ban character strings in .Fortran or follow
the S prototype unless someone has a way around this.  With different
compilers on the same platform having different conventions whatever we
do (except a ban) will be compiler-dependent.

Any suggestions?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jnf@pcisys.net  Mon Sep  6 21:03:53 1999
From: jnf@pcisys.net (jnf@pcisys.net)
Date: Mon, 6 Sep 1999 22:03:53 +0200 (MET DST)
Subject: Compiling R under Caldera Open Linux 2.2 (PR#268)
Message-ID: <199909062003.WAA19950@pubhealth.ku.dk>


Thanks for your help.  I loaded XFree86-devel-3.3.3.1-3.i386.rpm from my
OpenLinux CD and as you indicate this solved by X11 include file
problem.

I then encountered the linking same problem as you describe below.  The
error message is saying that the compiler can't find the libg2c library,
which is its runtime library.  Apparently the g77 supplied by Caldera is
missing this important piece.  I downloaded egcs-1.1.2-12.i386.rpm from
the Red Hat web site, then did the following to extract and install
libg2c:

1) rpm2cpio < egcs-1.1.2-12.i386.rpm > egcs-1.1.2-12.cpio

2) cpio -irv \*libg2c.a < egcs-1.1.2-12.cpio
- when prompted to rename it, I entered libg2c.a.  This created the
libg2c archive in my current directory.

3) mv libg2c.a /usr/lib/gcc-lib/i386-linux/egcs-2.91.66

That got past the link error you describe.  I then encountered a whole
series of undefined references to X routines.  I was able to determine
that all the routines exist in the X11 library
/usr/X11R6/lib/libX11.so.6.1 but configure was not setting things up
properly to link that library.  After spending a while trying to figure
out configure (it's pretty confusing besides not handling X well; for
instance --with-x doesn't do anything, and --x-libraries doesn't seem to
do much) I gave up and editted the R-0.64.2/src/main/Makefile directly. 
I added on line 44 "-L /usr/X11R6/lib" before $(DLLFLAGS) and also -lX11
at the end of the line.  After doing that, "make" and "make install"
both completed successfully.

So now I've got R installed successfully.  Its interface is fairly
intimidating.  Are there some examples online that would walk me through
some simple calculations/graphs?

- Jack Fenner


John Maindonald wrote:
> 
> To: jnf@pcisys.net
> Subject: Compilation of R under Caldera OpenLinux 2.2
> 
> > On Sat, 28 Aug 1999 jnf@pcisys.net wrote:
> > >
> > > I am attempting to compile R-0.64.2 under Caldera OpenLinux 2.2.  I have
> > > KDE installed but not gnome.  When I ran configure, it correctly
> > > indicated that gnome is not installed.  However when I then ran make, I
> > > received errors complaining that  the include file X11/X.h and similar
> > > are not found.
> ....
> > However, you do have X11 on your machine if you have KDE, and you
> > definitely do want to use X11 in R to get graphics.
> >
> >  You may not have the X11 header files installed -- they should be
> > somewhere under /usr/X11 or /usr/include/X11.  If the header files aren't
> > installed then you will need to install them. They will be on your
> > distribution CD, perhaps in a package called something like x-devel.
> 
> They are in the file Packages/RPMS/XFree86-devel-3.3.3.1-4.i386.rpm
> 
> (On the RedHat 6.0 distribution, there is
> XFree86-devel-3.3.3.1-49.i386.rpm
> which seems to be a later version.)
> 
> ----------------------------------------------------------------
> I have been wrestling with this also.  I had to install g77 from
> the distribution CD, then the above rpm.
> Having got this in order, I then received extensive output,
> terminated by the following (which I have formatted on to
> multiple lines):
> 
> gcc -export-dynamic -o ../../bin/R.X11 arithmetic.o array.o attrib.o
>  bind.o builtin.o character.o coerce.o colors.o complex.o context.o
>  cov.o cum.o debug.o devPS.o devPicTeX.o deparse.o deriv.o devices.o
>  dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o
>  fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o
>  main.o match.o memory.o model.o names.o objects.o optimize.o
>  options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o
>  print.o printarray.o printvector.o printutils.o random.o relop.o
>  saveload.o scan.o seq.o sort.o source.o split.o subassign.o
>  subscript.o subset.o summary.o unique.o util.o version.o
>  ../unix/libunix.a ../appl/libappl.a ../nmath/libmath.a -lSM -lICE
>  -L/usr/X11R6/lib -lX11 -L/usr/lib/gcc-lib/i386-linux/egcs-2.91.66
>  -L/usr/i386-linux/lib -lg2c -lm -lg2c: -ldl -lm
>  /usr/i386-linux/bin/ld: cannot open -lg2c: No such file or directory
> make[3]: *** [../../bin/R.X11] Error 1 make[3]: Leaving directory
> `/home/john/BUILD/src/main' make[2]: *** [R] Error 2 make[2]:
> Leaving directory `/home/john/BUILD/src/main' make[1]: *** [R] Error
> 1 make[1]: Leaving directory `/home/john/BUILD/src' make: *** [R]
> Error 1
> 
> I have been unable to find anything on the distribution CD that
> might answer to the lg2c.  Any clues would be welcome.
> 
> These difficulties aside, the Caldera OpenLinux 2.2 distribution
> is much more novice-friendly than RedHat 6.0.  Configuration is
> much quicker and more straightforward.
> 
> John Maindonald               email : john.maindonald@anu.edu.au
> Statistical Consulting Unit,  phone : (6249)3998
> c/o CMA, SMS,                 fax   : (6249)5549
> John Dedman Mathematical Sciences Building
> Australian National University
> Canberra ACT 0200
> Australia

-- 

Jack Fenner


  I am life that wills to live in the midst of life that wills to live.
             - Albert Schweitzer, "Out of my Life and Thought"

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From jnf@pcisys.net  Mon Sep  6 15:03:02 1999
From: jnf@pcisys.net (Jack N.)
Date: Mon, 06 Sep 1999 08:03:02 -0600
Subject: Compiling R under Caldera Open Linux 2.2
References: <199908290938.TAA07841@leonard.anu.edu.au>
Message-ID: <37D3C996.CACE6A14@pcisys.net>


Thanks for your help.  I loaded XFree86-devel-3.3.3.1-3.i386.rpm from my
OpenLinux CD and as you indicate this solved by X11 include file
problem.

I then encountered the linking same problem as you describe below.  The
error message is saying that the compiler can't find the libg2c library,
which is its runtime library.  Apparently the g77 supplied by Caldera is
missing this important piece.  I downloaded egcs-1.1.2-12.i386.rpm from
the Red Hat web site, then did the following to extract and install
libg2c:

1) rpm2cpio < egcs-1.1.2-12.i386.rpm > egcs-1.1.2-12.cpio

2) cpio -irv \*libg2c.a < egcs-1.1.2-12.cpio
- when prompted to rename it, I entered libg2c.a.  This created the
libg2c archive in my current directory.

3) mv libg2c.a /usr/lib/gcc-lib/i386-linux/egcs-2.91.66

That got past the link error you describe.  I then encountered a whole
series of undefined references to X routines.  I was able to determine
that all the routines exist in the X11 library
/usr/X11R6/lib/libX11.so.6.1 but configure was not setting things up
properly to link that library.  After spending a while trying to figure
out configure (it's pretty confusing besides not handling X well; for
instance --with-x doesn't do anything, and --x-libraries doesn't seem to
do much) I gave up and editted the R-0.64.2/src/main/Makefile directly. 
I added on line 44 "-L /usr/X11R6/lib" before $(DLLFLAGS) and also -lX11
at the end of the line.  After doing that, "make" and "make install"
both completed successfully.

So now I've got R installed successfully.  Its interface is fairly
intimidating.  Are there some examples online that would walk me through
some simple calculations/graphs?

- Jack Fenner


John Maindonald wrote:
> 
> To: jnf@pcisys.net
> Subject: Compilation of R under Caldera OpenLinux 2.2
> 
> > On Sat, 28 Aug 1999 jnf@pcisys.net wrote:
> > >
> > > I am attempting to compile R-0.64.2 under Caldera OpenLinux 2.2.  I have
> > > KDE installed but not gnome.  When I ran configure, it correctly
> > > indicated that gnome is not installed.  However when I then ran make, I
> > > received errors complaining that  the include file X11/X.h and similar
> > > are not found.
> ....
> > However, you do have X11 on your machine if you have KDE, and you
> > definitely do want to use X11 in R to get graphics.
> >
> >  You may not have the X11 header files installed -- they should be
> > somewhere under /usr/X11 or /usr/include/X11.  If the header files aren't
> > installed then you will need to install them. They will be on your
> > distribution CD, perhaps in a package called something like x-devel.
> 
> They are in the file Packages/RPMS/XFree86-devel-3.3.3.1-4.i386.rpm
> 
> (On the RedHat 6.0 distribution, there is
> XFree86-devel-3.3.3.1-49.i386.rpm
> which seems to be a later version.)
> 
> ----------------------------------------------------------------
> I have been wrestling with this also.  I had to install g77 from
> the distribution CD, then the above rpm.
> Having got this in order, I then received extensive output,
> terminated by the following (which I have formatted on to
> multiple lines):
> 
> gcc -export-dynamic -o ../../bin/R.X11 arithmetic.o array.o attrib.o
>  bind.o builtin.o character.o coerce.o colors.o complex.o context.o
>  cov.o cum.o debug.o devPS.o devPicTeX.o deparse.o deriv.o devices.o
>  dotcode.o dstruct.o duplicate.o envir.o errors.o eval.o format.o
>  fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o
>  main.o match.o memory.o model.o names.o objects.o optimize.o
>  options.o par.o paste.o platform.o plot.o plot3d.o plotmath.o
>  print.o printarray.o printvector.o printutils.o random.o relop.o
>  saveload.o scan.o seq.o sort.o source.o split.o subassign.o
>  subscript.o subset.o summary.o unique.o util.o version.o
>  ../unix/libunix.a ../appl/libappl.a ../nmath/libmath.a -lSM -lICE
>  -L/usr/X11R6/lib -lX11 -L/usr/lib/gcc-lib/i386-linux/egcs-2.91.66
>  -L/usr/i386-linux/lib -lg2c -lm -lg2c: -ldl -lm
>  /usr/i386-linux/bin/ld: cannot open -lg2c: No such file or directory
> make[3]: *** [../../bin/R.X11] Error 1 make[3]: Leaving directory
> `/home/john/BUILD/src/main' make[2]: *** [R] Error 2 make[2]:
> Leaving directory `/home/john/BUILD/src/main' make[1]: *** [R] Error
> 1 make[1]: Leaving directory `/home/john/BUILD/src' make: *** [R]
> Error 1
> 
> I have been unable to find anything on the distribution CD that
> might answer to the lg2c.  Any clues would be welcome.
> 
> These difficulties aside, the Caldera OpenLinux 2.2 distribution
> is much more novice-friendly than RedHat 6.0.  Configuration is
> much quicker and more straightforward.
> 
> John Maindonald               email : john.maindonald@anu.edu.au
> Statistical Consulting Unit,  phone : (6249)3998
> c/o CMA, SMS,                 fax   : (6249)5549
> John Dedman Mathematical Sciences Building
> Australian National University
> Canberra ACT 0200
> Australia

-- 

Jack Fenner


  I am life that wills to live in the midst of life that wills to live.
             - Albert Schweitzer, "Out of my Life and Thought"
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@biostat.ku.dk  Tue Sep  7 06:15:04 1999
From: pd@biostat.ku.dk (Peter Dalgaard BSA)
Date: Tue, 7 Sep 1999 07:15:04 +0200
Subject: Bug list summary (automatic post)
Message-ID: <199909070515.HAA03031@biostat.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.biostat.ku.dk or via email to
r-bugs@biostat.ku.dk. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

* PR# 138 *
Subject: Re: [R] bug? and New bug.
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Wed, 10 Mar 1999 17:21:16 +0100
--pt() for large df. Solved, but problem remains for pf et al.

Directory:  Add-ons

* PR# 137 *
Subject: funfits
From: "Alvaro A. Novo" <novo@uiuc.edu>
Date: Tue, 9 Mar 1999 22:24:54 -0600
--Not our problem. Dubious whether a bug at all.

Directory:  Analyses

* PR# 144 *
Subject: glm throws erroneous(?)'names attribute must be the same length as the vector' 
From: wagman@enteract.com
Date: Thu, 18 Mar 1999 08:58:47 +0100
--Can anyone reproduce this ??
--Same error as when doing regression on empty subset. All fitted
--values might be 0 or 1

Directory:  Documentation

none

Directory:  Graphics

* PR# 61 *
Subject: points(...,  cex = ..)  is pretty wrong...
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 2 Nov 1998 19:15:06 +0100
--Symbols getting decentered when too large cex for X. Still there 22feb99  
* PR# 69 *
Subject: Some graphics bugs
From: Martyn Plummer <plummer@iarc.fr>
Date: Fri, 04 Dec 1998 11:42:50 -0000 ()
Date: 04-Dec-98
--Various anomalies with text size and alignment. 2B appears to be solved. The 
--rest is still there (22feb99)
* PR# 120 *
Subject: graphics bug: type="l"
From: Matthew Wiener <mcw@ln.nimh.nih.gov>
Date: Tue, 16 Feb 1999 15:30:25 -0500 (EST)
--X server problem drawing > 64K lines at once. Workaround?
* PR# 123 *
Subject: Text in plot
From: Ennapadam Venkatraman <venkat@biosta.mskcc.org>
Date: Thu, 18 Feb 1999 13:05:37 -0500
--Multiline text not working
* PR# 130 *
Subject: lty=0 -- shouldn't it give an invisible line?
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 28 Feb 1999 21:45:43 +0100
--Strange effect on barplot
* PR# 149 *
Subject: plot.formula and pch=
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 25 Mar 1999 21:22:44 +0100
--plot(y~x,pch=z) may subset x and y but leave z.
--E.g. with missing values you can get incorrect plot symbols.
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--Don't think I (pd) got the point there...
* PR# 225 *
Subject: pch and mkh bug
From: Stephen Harker <sjh@ph.adfa.edu.au>
Date: Wed, 14 Jul 1999 13:10:31 +1000 (EST)
--(1) is an S incompatibility, but the S rules may not be a good model
--(2) is a bug, fixed for 0.65.0
--(3) has gone away in 0.65.0
* PR# 229 *
Subject: dev.print scaling bug?
From: John.Peters@tip.csiro.au (John Peters)
Date: Fri, 16 Jul 1999 12:10:48 +1000 (EST)
* PR# 230 *
Subject: Use of lwd = 0, lty = 2 in segments.
From: Douglas Bates <bates@stat.wisc.edu>
Date: Sat, 17 Jul 1999 17:18:44 -0500 (CDT)
* PR# 238 *
Subject: EPS compliance of postscript device: initclip operator
From: David Middleton <dajm@deeq.demon.co.uk>
Date: Tue, 03 Aug 1999 17:51:47 -0300
--initclip is removed. Still need new argument onefile/onepage to ensure one page
--and use %!PS-Adobe-3.0 EPSF-3.0 header

Directory:  In-Out

* PR# 125 *
Subject: scan rejects complex
From: John.Peters@tip.csiro.au (John Peters)
Date: Mon, 22 Feb 1999 10:08:14 +1100 (EST)
* PR# 129 *
Subject: Formatting in formatC and format
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 28 Feb 1999 08:53:34 +0000 (GMT)
--Documentation and ``merge'' of format() and formatC() would be desired - MM
* PR# 207 *
Subject: Lines longer than ~1000 chars truncated at parsing
From: msa@biostat.mgh.harvard.edu
Date: Mon, 7 Jun 1999 22:27:10 +0200 (MET DST)
--Fixed buffer used during input.
--Not fixable without major changes to readline lib.

Directory:  Installation

none

Directory:  Language

* PR# 105 *
Subject: an old bug resurfaces
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Fri, 29 Jan 1999 08:28:32 +0100 (MET)
--Model formulas. Proper fix probably requires extensive rewrite of model formula
--parser, which would make in non-S-compatible.
* PR# 239 *
Subject: cbind is not generic as claimed, omits labels where S has them 
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 5 Aug 1999 12:29:58 +0100 (BST)
--Cbind is now generic, still labelling issues. See also PR#240 and PR#241.
* PR# 240 *
Subject: Re: cbind is not generic as claimed, omits labels where S has them
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 5 Aug 1999 17:19:08 +0100 (BST)
--See PR#239
* PR# 241 *
Subject: Re: cbind is not generic as claimed, omits labels where S has them
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Fri, 6 Aug 1999 06:52:35 +0100 (BST)
--See PR#239

Directory:  Low-level

* PR# 37 *
Subject: S.h compatibility issues
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 6 Sep 1998 19:58:47 +0100 (BST)
--1 is fixed
--2 R's own RNG entry points are still not public
--3 is the perennial issue of what is the `public' API -- specific points are
--fixed
* PR# 101 *
Subject: Re: [R] Re: R-0.63.2 for Windows - some comments
From: Guido Masarotto <guido@hal.stat.unipd.it>
Date: Fri, 22 Jan 1999 12:40:26 +0100
--This is really about fixed buffer sizes in printutils.c
* PR# 135 *
Subject: summary() of lm() problem
From: Simon Fear <fears@roycastle.liv.ac.uk>
Date: Tue, 9 Mar 1999 13:18:37 -0000 
--lm (?) AND Windows problem;  Win solved (fudged) for 0.63.3
--
--Another low-level buffer-size problem
* PR# 185 *
Subject: Re: [R] R_problem_buf in the S.h files & lists in .C
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 05 May 1999 00:32:49 +0200
--S objects in .C calls (not just lists) are now documented in the help file
* PR# 197 *
Subject: glm crash
From: Cor en Aylin <Cor.Berrevoets@gironet.nl>
Date: Fri, 21 May 1999 19:44:23 +0200
--Obscure report. Cannot reproduce from given info.
* PR# 210 *
Subject: definition of R_problem_buf in S.h
From: vogels@ieee.org
Date: Mon, 14 Jun 1999 17:56:04 +0200 (MET DST)
--Same as #185
* PR# 235 *
Subject:  round(numeric(0)) 
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 29 Jul 1999 15:20:21 +0100 (BST)
--Some followup of this on R-devel not sent here.

Directory:  Misc

* PR# 91 *
Subject: possible bug
From: Rashid Nassar <rnassar@duke.edu>
Date: Sat, 9 Jan 1999 14:50:58 -0500 (EST)
--Remaining issue is whether we can do something more friendly than dumping 
--users into vi?

Directory:  Models

* PR# 121 *
Subject:  model.frame mangles time series 
From: Peter Dalgaard BSA <pd@biostat.ku.dk>
Date: Thu, 18 Feb 1999 15:47:24 +0100
--Subset in C code + attributes = mess
--Switch to interpreted ("[")

Directory:  Startup

none

Directory:  System-specific

* PR# 214 *
From: Charles Taylor <charles@amsta.leeds.ac.uk>
Date: Thu, 24 Jun 1999 11:20:06 +0100 (BST)
* PR# 222 *
Subject: Use of R-Coda
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Fri, 9 Jul 1999 10:54:16 +0200 
--In Danish (?)  Looks as if PR#246 is the same in English
* PR# 234 *
Subject: R-bugs
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Tue, 27 Jul 1999 13:49:31 +0200
--Looks like PR#222 again, in Danish. See PR#246 for English version
* PR# 246 *
Subject: R-Coda on rs6000-ibm-aix4.2.1.0
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Wed, 11 Aug 1999 08:49:47 +0200
--Problem with ps on AIX in 0.64.2. Try again with 0.65.0?

Directory:  TooMuchAtOnce

* PR# 53 *
Subject: 0.62.3 bugs, incompatibilities and problems
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Mon, 12 Oct 1998 09:43:51 +0200 (MET DST)
--Of Jims points: (checked in 0.65 April 26 compared to Splus 3.4)
-- 4. works the same as S
-- 5. Splus gives NA and the if(class(z)=="repeated") doesn't work in either
-- 10. seems to work
-- 7.  seems to do what Jim wants now
--  
* PR# 76 *
Subject: R-0.63.0
From: Rashid Nassar <rnassar@acpub.duke.edu>
Date: Fri, 11 Dec 1998 23:20:08 -0500 (EST)

Directory:  Windows

none

Directory:  incoming

* PR# 248 *
Subject: scan() + error interferes with count.fields() in some cases
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 13 Aug 1999 17:44:48 +0200
* PR# 249 *
Subject: axis ignores srt/crt
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Mon, 16 Aug 1999 15:51:49 -0700 (PDT)
* PR# 250 *
From: Peter Malewski <peter@tu-bs.de>
Date: Tue, 17 Aug 1999 12:21:38 +0200 (CEST)
* PR# 251 *
From: Peter Malewski <peter@tu-bs.de>
Date: Tue, 17 Aug 1999 12:21:45 +0200 (CEST)
* PR# 252 *
Subject: bug: R says "Floating exception" on DEC-Alpha w/OSF1
From: "Michael Thompson" <mlthomps@yayoi.mt.m-kagaku.co.jp>
Date: Thu, 19 Aug 1999 06:03:06 +0900
* PR# 253 *
Subject: seg.fault for some illegal .Random.seed (new since 0.64)
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 20 Aug 1999 14:17:31 +0200
* PR# 254 *
Subject: Strange 'Unimplemented feature in rep' error
From: Lutz Prechelt <prechelt@ira.uka.de>
Date: Mon, 23 Aug 1999 19:43:24 +0200
* PR# 255 *
Subject: broken link in R FAQ page?
From: Tian-Xiong Lu <tian@chico.ma.adfa.edu.au>
Date: Tue, 24 Aug 1999 13:41:21 +1000 (EST)
* PR# 256 *
Subject: Error in ?text
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
Date: Wed, 25 Aug 1999 10:00:19 +0100 (BST)
* PR# 257 *
Subject:  dimnames names lost when subscripting 
From: Andreas Weingessel <weingessel@ci.tuwien.ac.at>
Date: Wed, 25 Aug 1999 12:45:28 +0200
* PR# 258 *
Subject: Greek letters in outer margins.
From: "BXC (Bendix Carstensen)" <BXC@NOVO.dk>
Date: Thu, 26 Aug 1999 12:09:17 +0200
* PR# 259 *
Subject: R without X11?
From: "Jack N." <jnf@pcisys.net>
Date: Sat, 28 Aug 1999 09:22:57 -0600
* PR# 260 *
Subject: Re: Compiling R under Caldera Open Linux 2.2
Subject: Compilation of R under Caldera OpenLinux 2.2
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sun, 29 Aug 1999 19:38:13 +1000 (EST)
* PR# 261 *
Subject: interface w/ emacs
From: gautier@lion-ag.de
Date: Mon, 30 Aug 1999 13:28:52 +0200 (MET DST)
* PR# 262 *
Subject: Problems compiling R65.0
From: Patrick Lindsey <plindsey@alpha.luc.ac.be>
Date: Wed, 1 Sep 1999 11:52:29 +0200 (MET DST)
* PR# 263 *
Subject: Problems sourcing functions with R65.0
From: Patrick Lindsey <plindsey@alpha.luc.ac.be>
Date: Wed, 1 Sep 1999 11:58:51 +0200 (MET DST)
* PR# 264 *
Subject: R 0.65.x bug :  attach()/eval() {was "lib.source() within library()"}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Thu, 2 Sep 1999 12:23:43 +0200
* PR# 265 *
Subject: trouble with the 'exclude' parameter of factor()
From: gautier@lion-ag.de
Date: Thu, 2 Sep 1999 17:40:47 +0200 (MET DST)
* PR# 266 *
Subject: Re: [R] data frame component replacement: feature or bug?
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Sep 1999 00:03:29 +0200
* PR# 267 *
Subject: matplot(... panel.first=..) fails  <==> dealing with "..."
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 6 Sep 1999 11:04:03 +0200
* PR# 268 *
Subject: Re: Compiling R under Caldera Open Linux 2.2
From: "Jack N." <jnf@pcisys.net>
Date: Mon, 06 Sep 1999 08:03:02 -0600
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Sep  7 17:42:01 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue, 7 Sep 1999 18:42:01 +0200 (MET DST)
Subject: sys.on.exit appears non-functional (PR#269)
Message-ID: <199909071642.SAA03414@pubhealth.ku.dk>

As far as I can see sys.on.exit() does not work. The following
will give a non-null result in S, and seems about the simplest possible
usage.

test <- function() {
  on.exit(print(1))
  ex <- sys.on.exit()
  str(ex)
  cat("exiting...\n")
}
> test()
 NULL
exiting...
[1] 1

Looking at the code suggests that on.exit is installing the code in
a different context from the one sys.on.exit is looking in, but this is
daunting for non-experts.

The help page does not say what this is supposed to do, of course, but
I assume it is intended to retrieve the on.exit expression, as in S.

--please do not edit the information below--

Version:
 platform = sparc-sun-solaris2.6
 arch = sparc
 os = solaris2.6
 system = sparc, solaris2.6
 status = 
 status.rev = 0
 major = 0
 minor = 65.0
 year = 1999
 month = August
 day = 27
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Sep  8 00:03:45 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 08 Sep 1999 01:03:45 +0200
Subject: sys.on.exit appears non-functional (PR#269)
In-Reply-To: ripley@stats.ox.ac.uk's message of "Tue, 7 Sep 1999 18:42:01 +0200 (MET DST)"
References: <199909071642.SAA03414@pubhealth.ku.dk>
Message-ID: <x2ogfe729a.fsf@blueberry.kubism.ku.dk>

ripley@stats.ox.ac.uk writes:

> As far as I can see sys.on.exit() does not work. The following
> will give a non-null result in S, and seems about the simplest possible
> usage.
> 
> test <- function() {
>   on.exit(print(1))
>   ex <- sys.on.exit()
>   str(ex)
>   cat("exiting...\n")
> }
> > test()
>  NULL
> exiting...
> [1] 1
> 
> Looking at the code suggests that on.exit is installing the code in
> a different context from the one sys.on.exit is looking in, but this is
> daunting for non-experts.

Not really that hard, once I realised that R_GlobalContext is not a
global constant and that R_ToplevelContext is the bottom of the
context stack... sys.on.exit is a function that calls a .Internal.
This inserts an extra context layer - calling the .Internal directly
works - and one just had to look one level further up.

Will commit for 0.65.1 in a moment.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pascal.grandeau@wanadoo.fr  Wed Sep  8 16:56:13 1999
From: pascal.grandeau@wanadoo.fr (pascal.grandeau@wanadoo.fr)
Date: Wed, 8 Sep 1999 17:56:13 +0200 (MET DST)
Subject: R with Windows 95 (PR#271)
Message-ID: <199909081556.RAA15313@pubhealth.ku.dk>

Full_Name: Pascal GRANDEAU
Version: 0.65.0
OS: Windows 95
Submission from: (NULL) (164.138.103.253)


I downloaded the new version of R and I see a little bug with Windows 95. If I
plot anything and then I call the menu Windows/Tile, this works but when I
continue to work after a certain number of input (near 10) the cursor disapear
and I cannot continue. This happens also if I change the dimensions of the
windows.

I don't see the same bug with version 0.64.1.

Thank you very much and felicitations for R which is a very useful program.

Excuse my english.

P. GRANDEAU

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Sep  8 17:24:11 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 8 Sep 1999 18:24:11 +0200 (MET DST)
Subject: R with Windows 95 (PR#271)
Message-ID: <199909081624.SAA15492@pubhealth.ku.dk>

> From: pascal.grandeau@wanadoo.fr
> Date: Wed, 8 Sep 1999 17:56:13 +0200 (MET DST)
> To: r-devel@stat.math.ethz.ch
> Subject: R with Windows 95 (PR#271)
> CC: R-bugs@biostat.ku.dk
> X-Loop: R-bugs@biostat.ku.dk
> 
> Full_Name: Pascal GRANDEAU
> Version: 0.65.0
> OS: Windows 95
> Submission from: (NULL) (164.138.103.253)
> 
> 
> I downloaded the new version of R and I see a little bug with Windows 95. If I
> plot anything and then I call the menu Windows/Tile, this works but when I
> continue to work after a certain number of input (near 10) the cursor disapear
> and I cannot continue. This happens also if I change the dimensions of the
> windows.

Let me be clear, since there are lot of possibilities. You are using
Rgui.exe in mdi mode? Have you changed any options in Rconsole?  At
some point the cursor disppears: do the menus still work? Can you still
move the windows?

> I don't see the same bug with version 0.64.1.

You are commenting on a preliminary release, which as the announcement
says, has not been tested extensively; in particular I have no access
to Windows 95, and very little to Windows 98 (but Guido Masarotto has
to both).  I cannot reproduce this under NT, but I may not be guessing
right what you did. Unfortunately, I suspect a problem with Windows
event handling, and that is very version-dependent.

Please try the official release (when it comes) and report again if the
problem persists. Guido does use a different compile environment from mine.

I have managed to track down two problems (DEL did not work, no printer
chooser appears) both of which are due to errors in header files in the
compiler I used and have been fixed in the current version (you only
need the new rw0650b.zip dated Sept 7).  Given that history, I am quite
ready to believe that there are more of the same.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Sep  9 09:14:54 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 9 Sep 1999 10:14:54 +0200 (CEST)
Subject: Fortran character strings
In-Reply-To: <199909061254.NAA00597@toucan.stats.ox.ac.uk>
References: <199909061254.NAA00597@toucan.stats.ox.ac.uk>
Message-ID: <14295.27774.194390.155680@fangorn.ci.tuwien.ac.at>

>>>>> Prof Brian Ripley writes:

> Has anyone ever successfully used Fortran character strings with R?
> ?Foreign says

>          R              C                  Fortran
>       integer       int *              integer
>   ....
>       character     char **            [compiler dependent]

>      Character strings are passed as C arrays of character
>      strings to Fortran: the first string may be usable if
>      its length is passed separately.

> and I have been taking a look. The linkage sends char ** to Fortran.
> On the other hand, INTPR and DBLEPR assume Fortran character strings
> are char *.  On all my systems DBLEPR works and .Fortran does not, but
> I do know of one compiler (Watcom Fortran for Windows NT) where the
> linkage really is equivalent to char **.

> Fortran in S takes the first string in a character vector and passes
> that as char * (except on the Watcom-compiled Windows version), as far
> as I can deduce without the source code.

> I think we should either ban character strings in .Fortran or follow
> the S prototype unless someone has a way around this.  With different
> compilers on the same platform having different conventions whatever
> we do (except a ban) will be compiler-dependent.

> Any suggestions?

Hmm ... this is someone not knowing what is going (i.e., me) commenting
on this.

I touched this once when porting Rousseeuw's cluster routines to R,
maybe the thread is in the r-core archives.  I seem to recall that
someone told me that this was really a compiler-specific issue and hence
could/should not be part of the API.  (In the specific case, it was a
0/1 string so I found a different solution.)

(Btw, why do we map integer to int * and not long *?)

-k

PS.  A comment on ?.External:  We have

         list          void * (SEXP *)
         other         void * (SEXP)

I think this (showing the alternative in parenteses) may be confusing.
Shouldn't we show the preferred method in the table and mention the
alternative somewhere in the text following?

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Sep  9 09:28:24 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 9 Sep 1999 09:28:24 +0100 (BST)
Subject: Fortran character strings
In-Reply-To: <14295.27774.194390.155680@fangorn.ci.tuwien.ac.at>
Message-ID: <Pine.GSO.4.05.9909090916450.4120-100000@auk.stats>

On Thu, 9 Sep 1999, Kurt Hornik wrote:

> >>>>> Prof Brian Ripley writes:
> 
> > Has anyone ever successfully used Fortran character strings with R?
> > ?Foreign says
> 
> >          R              C                  Fortran
> >       integer       int *              integer
> >   ....
> >       character     char **            [compiler dependent]
> 
> >      Character strings are passed as C arrays of character
> >      strings to Fortran: the first string may be usable if
> >      its length is passed separately.
> 
> > and I have been taking a look. The linkage sends char ** to Fortran.
> > On the other hand, INTPR and DBLEPR assume Fortran character strings
> > are char *.  On all my systems DBLEPR works and .Fortran does not, but
> > I do know of one compiler (Watcom Fortran for Windows NT) where the
> > linkage really is equivalent to char **.
> 
> > Fortran in S takes the first string in a character vector and passes
> > that as char * (except on the Watcom-compiled Windows version), as far
> > as I can deduce without the source code.
> 
> > I think we should either ban character strings in .Fortran or follow
> > the S prototype unless someone has a way around this.  With different
> > compilers on the same platform having different conventions whatever
> > we do (except a ban) will be compiler-dependent.
> 
> > Any suggestions?
> 
> Hmm ... this is someone not knowing what is going (i.e., me) commenting
> on this.
> 
> I touched this once when porting Rousseeuw's cluster routines to R,
> maybe the thread is in the r-core archives.  I seem to recall that
> someone told me that this was really a compiler-specific issue and hence
> could/should not be part of the API.  (In the specific case, it was a
> 0/1 string so I found a different solution.)

It is compiler-specific, but there is a solution that works in 99% of the
cases that I have put in R-devel, with warnings.

> (Btw, why do we map integer to int * and not long *?)

How would I know?  (Actually, because it lets us use the C linakge, I
guess.)  We do assume that in building R, for things like eigen. I noted
that f2c does have a configure check for this, and I think we probably
ought to find out at configure time what integer does map to and make
.Fortran cover this.

> 
> -k
> 
> PS.  A comment on ?.External:  We have
> 
>          list          void * (SEXP *)
>          other         void * (SEXP)
> 
> I think this (showing the alternative in parenteses) may be confusing.
> Shouldn't we show the preferred method in the table and mention the
> alternative somewhere in the text following?

It is confusing. Actually all of them are mapped to void *, so I think we
should be giving SEXP * and SEXP. Thomas?

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Thu Sep  9 15:35:05 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Thu, 9 Sep 1999 16:35:05 +0200 (CEST)
Subject: [R] read.table bug
In-Reply-To: <x2aeqwxkyj.fsf@blueberry.kubism.ku.dk>
References: <37D7B372.CDA3589D@inet.polyu.edu.hk>
 <x2aeqwxkyj.fsf@blueberry.kubism.ku.dk>
Message-ID: <14295.50585.281674.771207@fangorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> Li Dongfeng <mavip5@inet.polyu.edu.hk> writes:
>> Suppose we have a data file containing:
>> 
>> "Smith, John", 120, 90
>> "Thomson, Peter", 110, 85
>> 
>> there are 3 variables in it. If we use 
>> 
>> x <- read.table("tmp.txt", sep=",")
>> 
>> to read the data to a data.frame,
>> the result will be 4 columns.
>> Splus 4.0 have no problem with this kind
>> of data.

> Splus 3.4 has:

>> read.table("data", sep=",")
>                V2  V3 V4 
>   "Smith   John\" 120 90
> "Thomson  Peter\" 110 85

> i.e. 3 variables but with row.names '"Smith' and '"Thomson'

> Or, closer to what R does:

>> read.table("data", sep=",",row.names=NULL)
>          V1       V2  V3 V4 
> 1   \"Smith   John\" 120 90
> 2 \"Thomson  Peter\" 110 85

> By its definition, this is what sep=',' must do, but it obviously will
> not handle all CSV files properly. Anyone want to write a read.csv()
> function or something of the sorts? It would be very useful.

So
	read.table(sep = ",")

would be different from

	read.csv()

?

PS.  Btw, a typical problem when dumping from certain commercial
spreadsheets to csv and trying to read that in using read.table() is
that the dump does not always produce trailing commas.  I use a trivial
Perl script for adding these, but maybe read.table() should be smarter
about that (new option doing if_not_enough_then_add_as_NA?)

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Thu Sep  9 16:00:19 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 09 Sep 1999 17:00:19 +0200
Subject: [R] read.table bug
In-Reply-To: Kurt Hornik's message of "Thu, 9 Sep 1999 16:35:05 +0200 (CEST)"
References: <37D7B372.CDA3589D@inet.polyu.edu.hk> 	<x2aeqwxkyj.fsf@blueberry.kubism.ku.dk> <14295.50585.281674.771207@fangorn.ci.tuwien.ac.at>
Message-ID: <x27lm0xh8c.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> So
> 	read.table(sep = ",")
> 
> would be different from
> 
> 	read.csv()

Yes. Or - there are many ways to do it - extend read.table with an
option, e.g. quote='"', which for all I care could be the default. The
point is that you may want the other behaviour (quote=NULL) in some
cases. 

(How does CSV handle embedded quotes? Wotsit.org says that it is
system dependent, but a common convention is doubling the quote, i.e.
"abc""dfg". Others might do "abc"dfg", which is likely a bug. And some
systems use ';' or '|' as the separator.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From thomas@biostat.washington.edu  Thu Sep  9 16:46:02 1999
From: thomas@biostat.washington.edu (Thomas Lumley)
Date: Thu, 9 Sep 1999 08:46:02 -0700 (PDT)
Subject: Fortran character strings
In-Reply-To: <Pine.GSO.4.05.9909090916450.4120-100000@auk.stats>
Message-ID: <Pine.GSO.4.10.9909090823390.21909-100000@wompom.biostat.washington.edu>

On Thu, 9 Sep 1999, Prof Brian D Ripley wrote:

> On Thu, 9 Sep 1999, Kurt Hornik wrote:
> > PS.  A comment on ?.External:  We have
> > 
> >          list          void * (SEXP *)
> >          other         void * (SEXP)
> > 
> > I think this (showing the alternative in parenteses) may be confusing.
> > Shouldn't we show the preferred method in the table and mention the
> > alternative somewhere in the text following?
> 
> It is confusing. Actually all of them are mapped to void *, so I think we
> should be giving SEXP * and SEXP. Thomas?


The reason for having void * listed is that you can then declare the
arguments without including the Rinternals header, but that could
just be explained in the text. Done.

	-thomas



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From oka@debian.or.jp  Fri Sep 10 07:53:40 1999
From: oka@debian.or.jp (oka@debian.or.jp)
Date: Fri, 10 Sep 1999 08:53:40 +0200 (MET DST)
Subject: problem in R.sh.in script (PR#272)
Message-ID: <199909100653.IAA02811@pubhealth.ku.dk>


I found problem in R-0.65.0/src/scripts/R.sh.in script.
When I run R program with `R -d gdb', R script say,

  /usr/local/bin/R[104]: shift: bad number

I fixed this problem by applying following patch to the script:

*** R.sh.in.orig    Fri Sep 10 13:01:10 1999
--- R.sh.in Fri Sep 10 13:01:23 1999
***************
*** 48,54 ****
      -g|--gnome)
        R_BINARY="R.gnome" ;;
      -d|--debugger)
!       DBG="${2}"; shift 2 ;;
      --no-environ)
        USE_R_ENVIRON=false ;;
      --vanilla)
--- 48,54 ----
      -g|--gnome)
        R_BINARY="R.gnome" ;;
      -d|--debugger)
!       DBG="${2}"; shift ;;
      --no-environ)
        USE_R_ENVIRON=false ;;
      --vanilla)

--please do not edit the information below--

Version:
 platform = i586-unknown-linux
 arch = i586
 os = linux
 system = i586, linux
 status = 
 status.rev = 0
 major = 0
 minor = 65.0
 year = 1999
 month = August
 day = 27
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From oka@debian.or.jp  Fri Sep 10 08:08:45 1999
From: oka@debian.or.jp (oka@debian.or.jp)
Date: Fri, 10 Sep 1999 09:08:45 +0200 (MET DST)
Subject: problem in R.sh.in script (PR#273)
Message-ID: <199909100708.JAA02996@pubhealth.ku.dk>


At 10 Sep 1999 06:53:01 -0000,
Mitsuru Oka <oka@debian.or.jp> wrote:
> 
> 
> I found problem in R-0.65.0/src/scripts/R.sh.in script.
> When I run R program with `R -d gdb', R script say,
> 
>   /usr/local/bin/R[104]: shift: bad number
> 
> I fixed this problem by applying following patch to the script:
...
> 
> Version:
>  platform = i586-unknown-linux
>  arch = i586
>  os = linux

I'm Sorry. I made a mistake. In above environment, R script
has no problem. The problem is in following environment.
May be, /bin/sh is incompatible.

--please do not edit the information below--

Version:
 platform = mips-sgi-irix6.4
 arch = mips
 os = irix6.4
 system = mips, irix6.4
 status = 
 status.rev = 0
 major = 0
 minor = 65.0
 year = 1999
 month = August
 day = 27
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Sep 10 08:45:20 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 10 Sep 1999 09:45:20 +0200
Subject: problem in R.sh.in script (PR#273)
In-Reply-To: oka@debian.or.jp's message of "Fri, 10 Sep 1999 09:08:45 +0200 (MET DST)"
References: <199909100708.JAA02996@pubhealth.ku.dk>
Message-ID: <x2vh9jnran.fsf@blueberry.kubism.ku.dk>

oka@debian.or.jp writes:

> I'm Sorry. I made a mistake. In above environment, R script
> has no problem. The problem is in following environment.
> May be, /bin/sh is incompatible.

It *does* have a problem on Linux too, it just doesn't protest quite
as badly:

$ R -d gdb
shift: shift count must be <= $#
GNU gdb 4.17.0.11 with Linux support

I fixed this for 0.65.1 a couple of days ago.

PS to everyone: When you follow up on a Problem Report, please make
sure that you include the original PR# in the subject field so that yo
don't open a new PR#. This is easily done by 'reply' in most mailers.
And please also avoid sending reports both to r-bugs and the
mailinglists (where they will appear with no PR# and subsequent
discussion will not get filed.)

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Mon Sep 13 02:02:22 1999
From: albrecht.gebhardt@uni-klu.ac.at (albrecht.gebhardt@uni-klu.ac.at)
Date: Mon, 13 Sep 1999 03:02:22 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909130102.DAA16878@pubhealth.ku.dk>

Full_Name: Albrecht Gebhardt
Version: 0.65.0
OS: Digital Unix 4.0E
Submission from: (NULL) (212.17.104.62)


Plottimg on the Alpha stopped working with 0.65.0.

The tickmarks have a length of -Inf and go across the whole 
plot.

A first solution is the following patch:

--- src/main/plot.c.alpha-patch Mon Sep 13 01:37:11 1999
+++ src/main/plot.c     Mon Sep 13 01:58:16 1999
@@ -832,7 +832,7 @@
        }
        dd->gp.col = fg;
        GLine(REAL(at)[0], y, REAL(at)[n - 1], y, USER, dd);
-       if (R_FINITE(dd->gp.tck)) {
+       if (R_FINITE(dd->gp.tck) && !(ISNAN(dd->gp.tck))) {
            /* The S way of doing ticks */
            double y0, y1;
            if (dd->gp.tck > 0.5) {
@@ -922,7 +922,7 @@
        }
        dd->gp.col = fg;
        GLine(x, REAL(at)[0], x, REAL(at)[n - 1], USER, dd);
-       if (R_FINITE(dd->gp.tck)) {
+       if (R_FINITE(dd->gp.tck) && !(ISNAN(dd->gp.tck))) {
            /* The S way of doing ticks */
            double x0, x1;
            if (dd->gp.tck > 0.5) {


Albrecht Gebhardt


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Sep 13 07:34:45 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon, 13 Sep 1999 08:34:45 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909130634.IAA17647@pubhealth.ku.dk>

On Mon, 13 Sep 1999 albrecht.gebhardt@uni-klu.ac.at wrote:

> Full_Name: Albrecht Gebhardt
> Version: 0.65.0
> OS: Digital Unix 4.0E
> Submission from: (NULL) (212.17.104.62)
> 
> 
> Plottimg on the Alpha stopped working with 0.65.0.
> 
> The tickmarks have a length of -Inf and go across the whole 
> plot.

I've seen the problem on Solaris when make decided to re-configure
and so parts of R got compiled with different compiler options (as under
re-configuration different environmental variables were set). But for me
the problem seems to be getting NaN.

> A first solution is the following patch:
> 
> --- src/main/plot.c.alpha-patch Mon Sep 13 01:37:11 1999
> +++ src/main/plot.c     Mon Sep 13 01:58:16 1999
> @@ -832,7 +832,7 @@
>         }
>         dd->gp.col = fg;
>         GLine(REAL(at)[0], y, REAL(at)[n - 1], y, USER, dd);
> -       if (R_FINITE(dd->gp.tck)) {
> +       if (R_FINITE(dd->gp.tck) && !(ISNAN(dd->gp.tck))) {
>             /* The S way of doing ticks */
>             double y0, y1;
>             if (dd->gp.tck > 0.5) {

....

I'm puzzled.  Are you saying -Inf passes R_FINITE and passes ISNAN? (Wow!,
if so,) In any case, let us try and fix the macros (which crop up in many
places) not two instances.

There are too many options in Arith.h to guess: can you please tell us
what path is being taken (HAVE_FINITE, IEEE_754, FINITE_BROKEN, ...).

I believe this can all be tested from interpreted R code. I believe you
should get  (is.na(c(2.0, Inf, -Inf, NaN, NA)) etc)
           2.0 Inf -Inf NaN NA
is.na       F   F    F   T   T
is.finite   T   F    F   F   F
is.infinite F   T    T   F   F
is.nan      F   F    F   T   F

(Martin: I can't see this is checked in the tests explicitly. Should we add
it?)  Note though that is.na tests ISNAN and is.nan tests R_IsNaN, but
is.finite does test R_FINITE.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Mon Sep 13 09:57:22 1999
From: albrecht.gebhardt@uni-klu.ac.at (albrecht.gebhardt@uni-klu.ac.at)
Date: Mon, 13 Sep 1999 10:57:22 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909130857.KAA20105@pubhealth.ku.dk>

On Mon, 13 Sep 1999, Prof Brian D Ripley wrote:

> On Mon, 13 Sep 1999 albrecht.gebhardt@uni-klu.ac.at wrote:
> 
> > Full_Name: Albrecht Gebhardt
> > Version: 0.65.0
> > OS: Digital Unix 4.0E
> > Submission from: (NULL) (212.17.104.62)
> > 
> > 
> > Plottimg on the Alpha stopped working with 0.65.0.
> > 
> > The tickmarks have a length of -Inf and go across the whole 
> > plot.
> 
> I've seen the problem on Solaris when make decided to re-configure
> and so parts of R got compiled with different compiler options (as under
> re-configuration different environmental variables were set). But for me
> the problem seems to be getting NaN.

Yes it was NaN and not -Inf! Sorry

> 
> > A first solution is the following patch:
> > 
> > --- src/main/plot.c.alpha-patch Mon Sep 13 01:37:11 1999
> > +++ src/main/plot.c     Mon Sep 13 01:58:16 1999
> > @@ -832,7 +832,7 @@
> >         }
> >         dd->gp.col = fg;
> >         GLine(REAL(at)[0], y, REAL(at)[n - 1], y, USER, dd);
> > -       if (R_FINITE(dd->gp.tck)) {
> > +       if (R_FINITE(dd->gp.tck) && !(ISNAN(dd->gp.tck))) {
> >             /* The S way of doing ticks */
> >             double y0, y1;
> >             if (dd->gp.tck > 0.5) {
> 
> ....
> 
> I'm puzzled.  Are you saying -Inf passes R_FINITE and passes ISNAN? (Wow!,
> if so,) In any case, let us try and fix the macros (which crop up in many
> places) not two instances.

NaN passed R_FINITE (see above). Then it gets multiplied by some values
and serves as tickmark length.

> 
> There are too many options in Arith.h to guess: can you please tell us
> what path is being taken (HAVE_FINITE, IEEE_754, FINITE_BROKEN, ...).
in src/include/Rconfig.h:
/* Floating Point Arithmetic */
/* #undef HAVE_MATHERR */               /* System V */
#define HAVE_ISNAN 1            /* IEEE Arith indicator */
#define HAVE_FINITE 1                                                           
                                                                                
/* #undef HAVE_FLOATINGPOINT_H */                                               
/* #undef HAVE_FPU_CONTROL_H */                                                 
/* #undef HAVE_IEEEFP_H */              /* "-Wall" */                           
/* #undef HAVE_IEEE754_H */             /* Linux */                             
                                                                                
#ifdef HAVE_ISNAN                                                               
#ifdef HAVE_FINITE                                                              
#define IEEE_754                                                                
#endif                                                                          
#endif                                                                        

and some lines below:
/* Bug Workarounds */
/* #undef HAVE_OSF_SPRINTF_BUG */
#define CALLOC_BROKEN 1
#define FINITE_BROKEN 1                                                         
#define LOG_BROKEN 1                                                            


> 
> I believe this can all be tested from interpreted R code. I believe you
> should get  (is.na(c(2.0, Inf, -Inf, NaN, NA)) etc)
>            2.0 Inf -Inf NaN NA
> is.na       F   F    F   T   T
> is.finite   T   F    F   F   F
> is.infinite F   T    T   F   F
> is.nan      F   F    F   T   F


> is.na(c(2.0, Inf, -Inf, NaN, NA))                                             
[1] FALSE FALSE FALSE  TRUE  TRUE                                               
> is.finite(c(2.0, Inf, -Inf, NaN, NA))                                         
[1] TRUE TRUE TRUE TRUE TRUE                                                    
> is.infinite(c(2.0, Inf, -Inf, NaN, NA))                                       
[1] FALSE FALSE FALSE FALSE FALSE                                               
> is.nan(c(2.0, Inf, -Inf, NaN, NA))                                            
[1] FALSE FALSE FALSE  TRUE FALSE          

Seems that everything is R_FINITE!

> (Martin: I can't see this is checked in the tests explicitly. Should we add
> it?)  Note though that is.na tests ISNAN and is.nan tests R_IsNaN, but
> is.finite does test R_FINITE.
> 
> -- 
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595
> 

-------------------------------------------------------------------------------
Albrecht Gebhardt                   email   : albrecht.gebhardt@uni-klu.ac.at
Institut fuer Mathematik            Tel.    : (++43 463) 2700/837
Universitaet Klagenfurt             Fax     : (++43 463) 2700/834
Villacher Str. 161
A-9020 Klagenfurt, Austria
-------------------------------------------------------------------------------



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Sep 13 16:41:07 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon, 13 Sep 1999 17:41:07 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909131541.RAA27086@pubhealth.ku.dk>


> Date: Mon, 13 Sep 1999 10:57:23 +0200 (MET DST)
> From: Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at>
> 
> On Mon, 13 Sep 1999, Prof Brian D Ripley wrote:

[...]

> > I'm puzzled.  Are you saying -Inf passes R_FINITE and passes ISNAN? (Wow!,
> > if so.) In any case, let us try and fix the macros (which crop up in many
> > places) not two instances.
> 
> NaN passed R_FINITE (see above). Then it gets multiplied by some values
> and serves as tickmark length.
> 
> > 
> > There are too many options in Arith.h to guess: can you please tell us
> > what path is being taken (HAVE_FINITE, IEEE_754, FINITE_BROKEN, ...).

> in src/include/Rconfig.h:
> /* Floating Point Arithmetic */
> /* #undef HAVE_MATHERR */               /* System V */
> #define HAVE_ISNAN 1            /* IEEE Arith indicator */
> #define HAVE_FINITE 1                                                           
>                                                                                 
> /* #undef HAVE_FLOATINGPOINT_H */                                               
> /* #undef HAVE_FPU_CONTROL_H */                                                 
> /* #undef HAVE_IEEEFP_H */              /* "-Wall" */                           
> /* #undef HAVE_IEEE754_H */             /* Linux */                             
>                                                                                 
> #ifdef HAVE_ISNAN                                                               
> #ifdef HAVE_FINITE                                                              
> #define IEEE_754                                                                
> #endif                                                                          
> #endif                                                                        
> 
> and some lines below:
> /* Bug Workarounds */
> /* #undef HAVE_OSF_SPRINTF_BUG */
> #define CALLOC_BROKEN 1
> #define FINITE_BROKEN 1                                                         
> #define LOG_BROKEN 1                                                            
> 
> 
> > 
> > I believe this can all be tested from interpreted R code. I believe you
> > should get  (is.na(c(2.0, Inf, -Inf, NaN, NA)) etc)
> >            2.0 Inf -Inf NaN NA
> > is.na       F   F    F   T   T
> > is.finite   T   F    F   F   F
> > is.infinite F   T    T   F   F
> > is.nan      F   F    F   T   F
> 
> 
> > is.na(c(2.0, Inf, -Inf, NaN, NA))                                             
> [1] FALSE FALSE FALSE  TRUE  TRUE                                               
> > is.finite(c(2.0, Inf, -Inf, NaN, NA))                                         
> [1] TRUE TRUE TRUE TRUE TRUE                                                    
> > is.infinite(c(2.0, Inf, -Inf, NaN, NA))                                       
> [1] FALSE FALSE FALSE FALSE FALSE                                               
> > is.nan(c(2.0, Inf, -Inf, NaN, NA))                                            
> [1] FALSE FALSE FALSE  TRUE FALSE          
> 
> Seems that everything is R_FINITE!

[...]

OK, so I think you are at the line

#   define R_FINITE(x)          ((x) != R_NaReal)

in Arith.h, and that is clearly inadequate (although it should have
caught the NA, I think). Can you please try replacing that line by

    static int R_FINITE(double x) {
        return !isnan(x) & (x != R_PosInf) & (x != R_NegInf); 
    }

and try those tests again.

(Kurt: looks like finite can be broken in more ways than one. I suggest
return(finite(1./0.) & finite(0./0.) & finite(-1./0.)) in aclocal.m4,
and if FINITE_BROKEN going directly to some function like the above, and not
trying to be efficient, just right!)


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Mon Sep 13 17:08:40 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon, 13 Sep 1999 18:08:40 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909131608.SAA27354@pubhealth.ku.dk>

>>>>> On Mon, 13 Sep 1999 17:41:07 +0200 (MET DST), ripley@stats.ox.ac.uk (Brian D. Ripley) said:

    >> Date: Mon, 13 Sep 1999 10:57:23 +0200 (MET DST)
    >> From: Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at>
    >>
    >> On Mon, 13 Sep 1999, Prof Brian D Ripley wrote:

    BDR> [...]

    BDR> I'm puzzled.  Are you saying -Inf passes R_FINITE and passes
    BDR> ISNAN? (Wow!, if so.) In any case, let us try and fix the macros
    BDR> (which crop up in many places) not two instances.
    BDR>
    >> NaN passed R_FINITE (see above). Then it gets multiplied by some
    >> values and serves as tickmark length.
    >>
    >> >
    >> > There are too many options in Arith.h to guess: can you please tell us
    >> > what path is being taken (HAVE_FINITE, IEEE_754, FINITE_BROKEN, ...).

    >> in src/include/Rconfig.h:
    >> /* Floating Point Arithmetic */
    >> /* #undef HAVE_MATHERR */               /* System V */
    >> #define HAVE_ISNAN 1            /* IEEE Arith indicator */
    >> #define HAVE_FINITE 1
    >>
    >> /* #undef HAVE_FLOATINGPOINT_H */
    >> /* #undef HAVE_FPU_CONTROL_H */
    >> /* #undef HAVE_IEEEFP_H */              /* "-Wall" */
    >> /* #undef HAVE_IEEE754_H */             /* Linux */
    >>
    >> #ifdef HAVE_ISNAN
    >> #ifdef HAVE_FINITE
    >> #define IEEE_754
    >> #endif
    >> #endif
    >>
    >> and some lines below:
    >> /* Bug Workarounds */
    >> /* #undef HAVE_OSF_SPRINTF_BUG */
    >> #define CALLOC_BROKEN 1
    >> #define FINITE_BROKEN 1
    >> #define LOG_BROKEN 1
    >>
    >>
    >> >
    >> > I believe this can all be tested from interpreted R code. I believe you
    >> > should get  (is.na(c(2.0, Inf, -Inf, NaN, NA)) etc)
    >> >            2.0 Inf -Inf NaN NA
    >> > is.na       F   F    F   T   T
    >> > is.finite   T   F    F   F   F
    >> > is.infinite F   T    T   F   F
    >> > is.nan      F   F    F   T   F
    >>
    >>
    >> > is.na(c(2.0, Inf, -Inf, NaN, NA))
    >> [1] FALSE FALSE FALSE  TRUE  TRUE
    >> > is.finite(c(2.0, Inf, -Inf, NaN, NA))
    >> [1] TRUE TRUE TRUE TRUE TRUE
    >> > is.infinite(c(2.0, Inf, -Inf, NaN, NA))
    >> [1] FALSE FALSE FALSE FALSE FALSE
    >> > is.nan(c(2.0, Inf, -Inf, NaN, NA))
    >> [1] FALSE FALSE FALSE  TRUE FALSE
    >>
    >> Seems that everything is R_FINITE!

    BDR> [...]

    BDR> OK, so I think you are at the line

    BDR> #   define R_FINITE(x)          ((x) != R_NaReal)

    BDR> in Arith.h, and that is clearly inadequate (although it should have
    BDR> caught the NA, I think). Can you please try replacing that line by

    BDR> static int R_FINITE(double x) {
    BDR> return !isnan(x) & (x != R_PosInf) & (x != R_NegInf);
    BDR> }

    BDR> and try those tests again.

    BDR> (Kurt: looks like finite can be broken in more ways than one. I suggest
    BDR> return(finite(1./0.) & finite(0./0.) & finite(-1./0.)) in aclocal.m4,

shouldn't this be "|" instead of "&"   [broken if either is finite] ?

    BDR> and if FINITE_BROKEN going directly to some function like the
    BDR> above, and not trying to be efficient, just right!)
{weak voice in the background:
 it may be worth tyring to be both right and efficient ..
 but I agree that "right" is much more important!
}

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Mon Sep 13 18:08:06 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Mon, 13 Sep 1999 19:08:06 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
Message-ID: <199909131708.TAA27650@pubhealth.ku.dk>

On Mon, 13 Sep 1999, Martin Maechler wrote:

> >>>>> On Mon, 13 Sep 1999 17:41:07 +0200 (MET DST), ripley@stats.ox.ac.uk (Brian D. Ripley) said:
> 
>     >> Date: Mon, 13 Sep 1999 10:57:23 +0200 (MET DST)
>     >> From: Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at>
>     >>
>     >> On Mon, 13 Sep 1999, Prof Brian D Ripley wrote:
> 
>     BDR> [...]
> 
>     BDR> I'm puzzled.  Are you saying -Inf passes R_FINITE and passes
>     BDR> ISNAN? (Wow!, if so.) In any case, let us try and fix the macros
>     BDR> (which crop up in many places) not two instances.
>     BDR>
>     >> NaN passed R_FINITE (see above). Then it gets multiplied by some
>     >> values and serves as tickmark length.
>     >>
>     >> >
>     >> > There are too many options in Arith.h to guess: can you please tell us
>     >> > what path is being taken (HAVE_FINITE, IEEE_754, FINITE_BROKEN, ...).
> 
>     >> in src/include/Rconfig.h:
>     >> /* Floating Point Arithmetic */
>     >> /* #undef HAVE_MATHERR */               /* System V */
>     >> #define HAVE_ISNAN 1            /* IEEE Arith indicator */
>     >> #define HAVE_FINITE 1
>     >>
>     >> /* #undef HAVE_FLOATINGPOINT_H */
>     >> /* #undef HAVE_FPU_CONTROL_H */
>     >> /* #undef HAVE_IEEEFP_H */              /* "-Wall" */
>     >> /* #undef HAVE_IEEE754_H */             /* Linux */
>     >>
>     >> #ifdef HAVE_ISNAN
>     >> #ifdef HAVE_FINITE
>     >> #define IEEE_754
>     >> #endif
>     >> #endif
>     >>
>     >> and some lines below:
>     >> /* Bug Workarounds */
>     >> /* #undef HAVE_OSF_SPRINTF_BUG */
>     >> #define CALLOC_BROKEN 1
>     >> #define FINITE_BROKEN 1
>     >> #define LOG_BROKEN 1
>     >>
>     >>
>     >> >
>     >> > I believe this can all be tested from interpreted R code. I believe you
>     >> > should get  (is.na(c(2.0, Inf, -Inf, NaN, NA)) etc)
>     >> >            2.0 Inf -Inf NaN NA
>     >> > is.na       F   F    F   T   T
>     >> > is.finite   T   F    F   F   F
>     >> > is.infinite F   T    T   F   F
>     >> > is.nan      F   F    F   T   F
>     >>
>     >>
>     >> > is.na(c(2.0, Inf, -Inf, NaN, NA))
>     >> [1] FALSE FALSE FALSE  TRUE  TRUE
>     >> > is.finite(c(2.0, Inf, -Inf, NaN, NA))
>     >> [1] TRUE TRUE TRUE TRUE TRUE
>     >> > is.infinite(c(2.0, Inf, -Inf, NaN, NA))
>     >> [1] FALSE FALSE FALSE FALSE FALSE
>     >> > is.nan(c(2.0, Inf, -Inf, NaN, NA))
>     >> [1] FALSE FALSE FALSE  TRUE FALSE
>     >>
>     >> Seems that everything is R_FINITE!
> 
>     BDR> [...]
> 
>     BDR> OK, so I think you are at the line
> 
>     BDR> #   define R_FINITE(x)          ((x) != R_NaReal)
> 
>     BDR> in Arith.h, and that is clearly inadequate (although it should have
>     BDR> caught the NA, I think). Can you please try replacing that line by
> 
>     BDR> static int R_FINITE(double x) {
>     BDR> return !isnan(x) & (x != R_PosInf) & (x != R_NegInf);
>     BDR> }
> 
>     BDR> and try those tests again.
> 
>     BDR> (Kurt: looks like finite can be broken in more ways than one. I suggest
>     BDR> return(finite(1./0.) & finite(0./0.) & finite(-1./0.)) in aclocal.m4,
> 
> shouldn't this be "|" instead of "&"   [broken if either is finite] ?

Um. Yes, I think so: the man page is almost impossible to decipher, and
I had read it reversed.

> {weak voice in the background:
>  it may be worth tyring to be both right and efficient ..
>  but I agree that "right" is much more important!

Not, I think, on platforms where the inbuilt ways are broken.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Tue Sep 14 10:12:11 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Tue, 14 Sep 1999 11:12:11 +0200
Subject: cin et al
In-Reply-To: <199909140850.KAA14277@fangorn.ci.tuwien.ac.at> (message from
 Kurt Hornik on Tue, 14 Sep 1999 10:50:50 +0200)
References: <199909140850.KAA14277@fangorn.ci.tuwien.ac.at>
Message-ID: <199909140912.LAA09141@sophie.ethz.ch>

In a more private mail,
>>>>> "KH" == Kurt Hornik <hornik@ci.tuwien.ac.at> writes:

    KH> Currently,
    KH>		opar <- par()
    KH>		par(opar)
    KH> gives

    KH> Warning messages: 
    KH> 1: parameter "cin" can't be set in: par(args) 
    KH> 2: parameter "cra" can't be set in: par(args) 
    KH> 3: parameter "csi" can't be set in: par(args) 
    KH> 4: parameter "din" can't be set in: par(args) 

That's why we have

      opar <- par(no.readonly = TRUE)
      par(opar)

Only last weekend, when trying to polish "p.sunflowers(),
I read a (latex) printout of ?par

and found several things that I want to add/improve.
The above example is one of them.

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Sep 14 15:18:08 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue, 14 Sep 1999 16:18:08 +0200 (MET DST)
Subject: R with a broken finite() (was [R] Problems with R-0.65.0) (PR#275)
Message-ID: <199909141418.QAA06974@pubhealth.ku.dk>

[Copied to R-bugs so it goes into the database.]

On Mon, 13 Sep 1999, Ralf Herbrich wrote:

> 
> Hello,
> 
> I installed the new release 0.65.0 of R on our local Solaris system. As I
> already (and sucessfully) installed the 0.64.0 and 0.64.1 version of R, I
> hadn't had any trouble during the installation. But as I've started R in
> order to see the demo I've got horizontal and vertical lines goint to the
> left and top of the X11 window at each tick (demo ("graphics")). This
> seems not to be a grid but is now standard in any 2D plot (I also tried
> several of my own R programs). Furthermore, the exported postscripts
> (dev.print (file="blabla.ps")) can't be displayed by ghostscript.
> 
> What did I wrong during the installation?

To follow up on this, Ralf was using Solaris 2.6 and 

gcc version egcs-2.91.63 19990224 (egcs-1.1.2 pre-release-3)

which is probably not a good idea, being an old pre-release (gcc 2.8.1,
real egcs-1.1.2 and gcc-2.95.1 have all been tried).  This reported that
calloc and finite are broken on Solaris 2.6, and they are not on other
systems, so it seems more likely that the compiler is broken.

If you find a system with HAVE_FINITE and FINITE_BROKEN defined, then R
will not work correctly (unless it uses the AIX workaround). The fix I
suggested to Ralf worked, and will probably be incorporated in 0.65.1
(unless we find a better one).

Try replacing the line

#   define R_FINITE(x)          ((x) != R_NaReal)

in Arith.h by

static int R_FINITE(double x) {
    return !isnan(x) & (x != R_PosInf) & (x != R_NegInf); }


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Tue Sep 14 17:02:10 1999
From: albrecht.gebhardt@uni-klu.ac.at (Albrecht Gebhardt)
Date: Tue, 14 Sep 1999 18:02:10 +0200 (MET DST)
Subject: axis() produces junk on DEC alpha (PR#274)
In-Reply-To: <199909131541.RAA27086@pubhealth.ku.dk>
Message-ID: <Pine.OSF.4.10.9909141736540.2679-100000@zidsrv.sci.uni-klu.ac.at>

On Mon, 13 Sep 1999 ripley@stats.ox.ac.uk wrote:

> 
> > Date: Mon, 13 Sep 1999 10:57:23 +0200 (MET DST)
> > From: Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at>
> > 
> > On Mon, 13 Sep 1999, Prof Brian D Ripley wrote:
> 
> [...]
> ....
> [...]
> 
> OK, so I think you are at the line
> 
> #   define R_FINITE(x)          ((x) != R_NaReal)
> 
> in Arith.h, and that is clearly inadequate (although it should have
> caught the NA, I think). Can you please try replacing that line by
> 
>     static int R_FINITE(double x) {
>         return !isnan(x) & (x != R_PosInf) & (x != R_NegInf); 
>     }
> 
> and try those tests again.
ok, this works. Now I get even further with "make test". This stopped 
somewhere with a "GPretty[Inf, ...]" error, which was obvoiusly also
caused be R_FINITE. 

The patch is now:
--- ./src/include/Arith.h.finite-patch  Tue Sep 14 16:31:16 1999
+++ ./src/include/Arith.h       Tue Sep 14 16:32:12 1999
@@ -81,7 +81,13 @@
         return FINITE(x);      /* NOTE: macro does not work.  */
     }
 #  else
-#   define R_FINITE(x)         ((x) != R_NaReal)
+#   ifdef __osf__
+    static int R_FINITE(double x) {
+        return !isnan(x) & (x != R_PosInf) & (x != R_NegInf); 
+    }
+#   else
+#    define R_FINITE(x)                ((x) != R_NaReal)
+#   endif
 #  endif
 # endif

Albrecht

PS:
"make test" still fails, the last lines of tests/Examples/base-Ex.Rout
are
#### snip ################
> chisq.test(InsectSprays$count > 7, InsectSprays$spray)$obs
       y
x        A  B  C  D  E  F
  FALSE  1  1 12 11 12  0
  TRUE  11 11  0  1  0 12
>                                 # Counts expected under the null
>
> ## Effect of simulating p-values
> x <- matrix(c(12, 5, 7, 7), nc = 2)
> chisq.test(x)$p.value           # 0.4233
[1] 0.4233054
###################### snip
I can't see an error here. Or could the error be hidden somewhere before
this point? base-Ex.Rout is quite large, 4154 lines.
.... stop, now I got it, its a memory problem:
Running all help() examples ...
../../bin/R --vanilla < base-Ex.R > base-Ex.Rout
/bin/sh: 303 Memory fault
make[3]: *** [base-Ex.Rout] Error 139
make[3]: Leaving directory
`/usr/local/src/redhat/BUILD/R-0.65.0/tests/Examples'
make[2]: *** [test-Examples] Error 2
make[2]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
make[1]: *** [test-All] Error 2
make[1]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
make: *** [test-All] Error 2
I have to go to another machine, my alpha at home as only 256MB, and swap
space is also very small.
Or should I run the tests with memory specifications from command line? 

Wouldn't it be a good idea to have "make test" running each example in a
several R process? I think I could avoid this memory fault this way. I
guess the reasons for the memory fault is a bad kernel configuration
(wrong ulimit values) and/or wrong swap space configuration and not within
R.
But on the other hand the error is reproduceable with R stopping at
exactly the same line.  

-------------------------------------------------------------------------------
Albrecht Gebhardt                   email   : albrecht.gebhardt@uni-klu.ac.at
Institut fuer Mathematik            Tel.    : (++43 463) 2700/837
Universitaet Klagenfurt             Fax     : (++43 463) 2700/834
Villacher Str. 161
A-9020 Klagenfurt, Austria
-------------------------------------------------------------------------------


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Sep 14 17:23:16 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 14 Sep 1999 18:23:16 +0200
Subject: axis() produces junk on DEC alpha (PR#274)
In-Reply-To: Albrecht Gebhardt's message of "Tue, 14 Sep 1999 18:02:10 +0200 (MET DST)"
References: <Pine.OSF.4.10.9909141736540.2679-100000@zidsrv.sci.uni-klu.ac.at>
Message-ID: <x27lltbgy3.fsf@blueberry.kubism.ku.dk>

Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at> writes:

> this point? base-Ex.Rout is quite large, 4154 lines.
> .... stop, now I got it, its a memory problem:
> Running all help() examples ...
> ../../bin/R --vanilla < base-Ex.R > base-Ex.Rout
> /bin/sh: 303 Memory fault
> make[3]: *** [base-Ex.Rout] Error 139
> make[3]: Leaving directory
> `/usr/local/src/redhat/BUILD/R-0.65.0/tests/Examples'
> make[2]: *** [test-Examples] Error 2
> make[2]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
> make[1]: *** [test-All] Error 2
> make[1]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
> make: *** [test-All] Error 2
> I have to go to another machine, my alpha at home as only 256MB, and swap
> space is also very small.
> Or should I run the tests with memory specifications from command line? 

Shouldn't be necessary with the current defaults 256MB should be
plenty. 

Sometimes output buffers don't flush, so what is the last line of

 ../../bin/R --vanilla < base-Ex.R

> Wouldn't it be a good idea to have "make test" running each example in a
> several R process? I think I could avoid this memory fault this way. I
> guess the reasons for the memory fault is a bad kernel configuration
> (wrong ulimit values) and/or wrong swap space configuration and not within
> R.

But would it complete in finite time? There are a *lot* of examples,
you know....



-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Tue Sep 14 20:24:15 1999
From: albrecht.gebhardt@uni-klu.ac.at (Albrecht Gebhardt)
Date: Tue, 14 Sep 1999 20:24:15 +0100 (GMT+0100)
Subject: chisqsim broken on alpha (was Re: axis() produces junk on DEC alpha
 (PR#274))
In-Reply-To: <x27lltbgy3.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.OSF.4.05.9909142017460.13670-100000@delta.fuzzy.at>

On 14 Sep 1999, Peter Dalgaard BSA wrote:

> Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at> writes:
> 
> > this point? base-Ex.Rout is quite large, 4154 lines.
> > .... stop, now I got it, its a memory problem:
> > Running all help() examples ...
> > ../../bin/R --vanilla < base-Ex.R > base-Ex.Rout
> > /bin/sh: 303 Memory fault
> > make[3]: *** [base-Ex.Rout] Error 139
> > make[3]: Leaving directory
> > `/usr/local/src/redhat/BUILD/R-0.65.0/tests/Examples'
> > make[2]: *** [test-Examples] Error 2
> > make[2]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
> > make[1]: *** [test-All] Error 2
> > make[1]: Leaving directory `/usr/local/src/redhat/BUILD/R-0.65.0/tests'
> > make: *** [test-All] Error 2
> > I have to go to another machine, my alpha at home as only 256MB, and swap
> > space is also very small.
> > Or should I run the tests with memory specifications from command line? 
> 
> Shouldn't be necessary with the current defaults 256MB should be
> plenty. 
> 
> Sometimes output buffers don't flush, so what is the last line of
> 
>  ../../bin/R --vanilla < base-Ex.R
> 

You were right, I found a next bug for R on alpha:

chisqsim (called from chisq.test() crashes. First I found that the crash
is at 
chisqsim.c:167
167             fact[i] = x;

but after placing a breakpoint here I could go some lines further and
reach
chisqsim.c:72
72                  x = exp(fact[iap - 1] + fact[ib] + fact[ic] +

The following is a log of my gdb-session: 

root@delta[Examples]# ../../bin/R --vanilla < base-Ex.R   
...
> x <- matrix(c(12, 5, 7, 7), nc = 2)
> chisq.test(x)$p.value           # 0.4233
[1] 0.4233054
> chisq.test(x, simulate.p.value = TRUE, B = 10000)$p.value
Segmentation fault (core dumped)
root@delta[Examples]# gdb -c core ../../bin/R.X11 -d ../../src/nmath/ -d ../../src/main/ -d ../../src/appl/
GNU gdb 4.17
Copyright 1998 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "alphaev56-dec-osf4.0d"...
Core was generated by `R.X11'.
Program terminated with signal 11, Segmentation fault.
Reading symbols from /usr/shlib/libSM.so...done.
Reading symbols from /usr/shlib/libICE.so...done.
Reading symbols from /usr/shlib/libX11.so...done.
Reading symbols from /usr/shlib/libdnet_stub.so...done.
Reading symbols from /usr/shlib/libUfor.so...done.
Reading symbols from /usr/shlib/libfor.so...done.
Reading symbols from /usr/shlib/libFutil.so...done.
Reading symbols from /usr/shlib/libm.so...done.
Reading symbols from /usr/shlib/libots.so...done.
Reading symbols from /usr/local/lib/libreadline.so.3...done.
Reading symbols from /usr/local/lib/libncurses.so.4...done.
Reading symbols from /usr/shlib/libc.so...done.
Reading symbols from /usr/local/src/redhat/BUILD/R-0.65.0/library/eda/libs/eda.s
o...done.
---Type <return> to continue, or q <return> to quit---
#0  0x12010a280 in chisqsim (nrow=0x140ff92d0, ncol=0x140ff92c8,
    nrowt=0x140ff92c0, ncolt=0x140ff92b8, n=0x140ff92b0, b=0x140ff92a8,
    expected=0x140ff9288, observed=0x140ff9278, fact=0x140ff9178,
    jwork=0x140ff9170, results=0x140fe58f0) at chisqsim.c:167
167             fact[i] = x;
(gdb) set env R_HOME /usr/local/src/redhat/BUILD/R-0.65.0
(gdb) break chisqsim.c:167
(gdb) run
Starting program: /usr/local/src/redhat/BUILD/R-0.65.0/tests/Examples/../../bin/R.X11

R : Copyright 1999, The R Development Core Team
Version 0.65.0  (August 27, 1999)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type    "?license" or "?licence" for distribution details.

R is a collaborative project with many contributors.
Type    "?contributors" for a list.

Type    "demo()" for some demos, "help()" for on-line help, or
        "help.start()" for a HTML browser interface to help.
Type    "q()" to quit R.

>  x <- matrix(c(12, 5, 7, 7), nc = 2)
> chisq.test(x)$p.valu
[1] 0.4233054
> chisq.test(x, simulate.p.value = TRUE, B = 10000)$p.value 

Breakpoint 1, chisqsim (nrow=0x140ff9ed8, ncol=0x140ff9ed0, nrowt=0x140ff9ec8,
    ncolt=0x140ff9ec0, n=0x140ff9eb8, b=0x140ff9eb0, expected=0x140ff9e90,
    observed=0x140ff9e80, fact=0x140ff9d80, jwork=0x140ff9d78,
    results=0x140fe64f8) at chisqsim.c:167
167             fact[i] = x;
(gdb) print x
$1 = 0
(gdb) print fact
$2 = (double *) 0x140ff9d80
(gdb) print *fact
$3 = 0
(gdb) step
165         for (i = 1; i <= *n; ++i) {
(gdb)
168         }
.....
(gdb) cont
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x120109e24 in rcont2 (nrow=0x140ff9ed8, ncol=0x140ff9ed0, nrowt=0x140ff9ec0,
    ncolt=0x140ff9eb8, ntotal=0x140ff9eb8, fact=0x140ff9d80,
    jwork=0x140ff9d70, matrix=0x140ff9e68) at chisqsim.c:72
72                  x = exp(fact[iap - 1] + fact[ib] + fact[ic] +
(gdb) print x
$7 = 0
(gdb) print iap
$8 = 51539607572
(gdb) print ib
$9 = -51539607540
(gdb) print ic
$10 = -60129542130
(gdb) list
67                  idp = id + 1;
68                  igp = idp - nlm;
69                  ihp = iap - nlm;
70                  nlmp = nlm + 1;
71                  iip = ii + nlmp;
72                  x = exp(fact[iap - 1] + fact[ib] + fact[ic] +
73                          fact[idp - 1] - fact[ie] - fact[nlmp - 1] -
74                          fact[igp - 1] - fact[ihp - 1] - fact[iip - 1]);
75                  if (x >= dummy) {
76                      goto L160;
(gdb) print nlmp
$11 = 65117246112
(gdb) print iip
$12 = -46551903589
(gdb) print igp
$13 = -4987703949
(gdb) print ihp
$14 = -13577638539
(gdb) print id
$15 = 60129542161
(gdb) print nlm
$16 = 65117246111
(gdb) q
The program is running.  Exit anyway? (y or n) y


Albrecht

......................................................................
| Albrecht Gebhardt          Tel.: (++43 463) 2700/837               |
| Institut fuer Mathematik   Fax : (++43 463) 2700/834               |
| Universitaet Klagenfurt    mailto:albrecht.gebhardt@uni-klu.ac.at  |
| Villacher Str. 161         http://www-stat.uni-klu.ac.at/~agebhard |
| A-9020 Klagenfurt, Austria                                         |
`--------------------------------------------------------------------'

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Sep 15 08:19:28 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 15 Sep 1999 09:19:28 +0200 (MET DST)
Subject: chisqsim broken on alpha (was Re: axis() produces junk on DEC (PR#276)
Message-ID: <199909150719.JAA10993@pubhealth.ku.dk>

On Tue, 14 Sep 1999, Albrecht Gebhardt wrote:

[...]

> chisqsim (called from chisq.test() crashes. First I found that the crash
> is at 
> chisqsim.c:167
> 167             fact[i] = x;

[...]

chisqsum.c has its interface in terms of long *, called by .C that supplies
int *. I think those are different on an Alpha.  Could you please
edit long to int in that file and try again.

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Wed Sep 15 14:33:09 1999
From: albrecht.gebhardt@uni-klu.ac.at (albrecht.gebhardt@uni-klu.ac.at)
Date: Wed, 15 Sep 1999 15:33:09 +0200 (MET DST)
Subject: chisqsim broken on alpha - solved + next bug in fft found (PR#277)
Message-ID: <199909151333.PAA17503@pubhealth.ku.dk>

On Wed, 15 Sep 1999 ripley@stats.ox.ac.uk wrote:

> On Tue, 14 Sep 1999, Albrecht Gebhardt wrote:
> 
> [...]
> 
> > chisqsim (called from chisq.test() crashes. First I found that the crash
> > is at 
> > chisqsim.c:167
> > 167             fact[i] = x;
> 
> [...]
> 
> chisqsum.c has its interface in terms of long *, called by .C that supplies
> int *. I think those are different on an Alpha.  Could you please
> edit long to int in that file and try again.
> 
> Brian
> 

Yes this helps.
The patch is:
--- ./src/appl/chisqsim.c.chisqsim-patch        Wed Sep 15 09:17:56 1999
+++ ./src/appl/chisqsim.c       Wed Sep 15 14:30:56 1999
@@ -11,10 +11,15 @@
 #include "S.h"
 
 static void
+#ifdef __osf__
+rcont2(int *nrow, int *ncol, int *nrowt, int *ncolt, int *ntotal,
+       double *fact, int *jwork, int *matrix)
+#else
 rcont2(long *nrow, long *ncol, long *nrowt, long *ncolt, long *ntotal,
        double *fact, long *jwork, long *matrix) 
+#endif
 {
-    long nlmp, j, l, m, ia, ib, ic, jc, id, ie, ii, nrowtl, iap, idp,
+    int nlmp, j, l, m, ia, ib, ic, jc, id, ie, ii, nrowtl, iap, idp,
        igp, ihp, iip, nll, nlm, nrowm, ncolm, lsm, lsp;
     double x, y, dummy, sumprb;
 
@@ -151,12 +156,18 @@
    */
 
 void
+#ifdef __osf__
+chisqsim(int *nrow, int *ncol, int *nrowt, int *ncolt, int *n,
+        int *b, double *expected, int *observed, double *fact,
+        int *jwork, double *results)
+#else
 chisqsim(long *nrow, long *ncol, long *nrowt, long *ncolt, long *n,
         long *b, double *expected, long *observed, double *fact,
         long *jwork, double *results)
+#endif
 {
     /* Local variables */
-    long i, j, iter;
+    int i, j, iter;
     double chi, e, o, x;
 
     /* Calculate log-factorials */


And I get to the next bug:

> data(faithful)
> x <- xx <- faithful$eruptions
> x[i.out <- sample(length(x), 10)] <- NA
  I modifed this to 
  x[i.out <- c(1,10,20,50,100,200)] <- NA
> doR <- density(x, bw=0.15, na.rm = TRUE) # works
> doN <- density(x, bw=0.15, na.rm = FALSE)
segfault at approx.c: 

    for(i=0 ; i<*nxy ; i++)
	if(ISNA(x[i]) || ISNA(y[i]))
	    error("approx(): attempted to interpolate NA values\n");

Both x and y are NULL pointers. 
The error is somewhere before, comparing with R on SuSE 5.3:
somewhere in density():

debug: kords[(n + 2):(2 * n)] <- -kords[n:2]
linux and osf both get:
kords
[1]  0.00000000  0.01094819  0.02189638  0.03284457  0.04379277 ...
[1021] -0.04379277 -0.03284457 -0.02189638 -0.01094819

then in the following if-statement we go to
debug: kords <- convolve(y, kords)[1:n]
with linux result
kords
  [1] 2.523589e-13 4.199167e-13 6.950994e-13 1.144613e-12 ...
[511] 5.032797e-13 3.017881e-13
and alpha:
kords
  [1] NA NA NA NA NA NA NA NA ...
[501] NA NA NA NA NA NA NA NA NA NA NA NA
... now on the alpha x and y are set to numeric(0) and approx is called
with this arguments, bang.

Now in convolve(x,y) on entry x=y and y=kords on linux and osf are
identical.
x:
   [1] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00  ...
 [151] 4.866728e-03 6.204044e-03 3.258272e-03 3.552390e-03 4.218750e-03
[1021] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00  ...
y:
   [1]  2.659615e+00  2.652540e+00  2.631429e+00  2.596616e+00 ...
[1021]  2.548649e+00  2.596616e+00  2.631429e+00  2.652540e+00 

now the error is in line
debug: x <- fft(fft(x) * (if (conj) Conj(fft(y)) else fft(y)), inv = TRUE)
of convolve() which returns only NAs on the alpha.

... so tomorrow I will have a look into fft.c



Albrecht

-------------------------------------------------------------------------------
Albrecht Gebhardt                   email   : albrecht.gebhardt@uni-klu.ac.at
Institut fuer Mathematik            Tel.    : (++43 463) 2700/837
Universitaet Klagenfurt             Fax     : (++43 463) 2700/834
Villacher Str. 161
A-9020 Klagenfurt, Austria
-------------------------------------------------------------------------------



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From albrecht.gebhardt@uni-klu.ac.at  Wed Sep 15 14:33:09 1999
From: albrecht.gebhardt@uni-klu.ac.at (Albrecht Gebhardt)
Date: Wed, 15 Sep 1999 15:33:09 +0200 (MET DST)
Subject: chisqsim broken on alpha - solved + next bug in fft found
In-Reply-To: <199909150719.JAA10993@pubhealth.ku.dk>
Message-ID: <Pine.OSF.4.10.9909151410340.11553-100000@zidsrv.sci.uni-klu.ac.at>

On Wed, 15 Sep 1999 ripley@stats.ox.ac.uk wrote:

> On Tue, 14 Sep 1999, Albrecht Gebhardt wrote:
> 
> [...]
> 
> > chisqsim (called from chisq.test() crashes. First I found that the crash
> > is at 
> > chisqsim.c:167
> > 167             fact[i] = x;
> 
> [...]
> 
> chisqsum.c has its interface in terms of long *, called by .C that supplies
> int *. I think those are different on an Alpha.  Could you please
> edit long to int in that file and try again.
> 
> Brian
> 

Yes this helps.
The patch is:
--- ./src/appl/chisqsim.c.chisqsim-patch        Wed Sep 15 09:17:56 1999
+++ ./src/appl/chisqsim.c       Wed Sep 15 14:30:56 1999
@@ -11,10 +11,15 @@
 #include "S.h"
 
 static void
+#ifdef __osf__
+rcont2(int *nrow, int *ncol, int *nrowt, int *ncolt, int *ntotal,
+       double *fact, int *jwork, int *matrix)
+#else
 rcont2(long *nrow, long *ncol, long *nrowt, long *ncolt, long *ntotal,
        double *fact, long *jwork, long *matrix) 
+#endif
 {
-    long nlmp, j, l, m, ia, ib, ic, jc, id, ie, ii, nrowtl, iap, idp,
+    int nlmp, j, l, m, ia, ib, ic, jc, id, ie, ii, nrowtl, iap, idp,
        igp, ihp, iip, nll, nlm, nrowm, ncolm, lsm, lsp;
     double x, y, dummy, sumprb;
 
@@ -151,12 +156,18 @@
    */
 
 void
+#ifdef __osf__
+chisqsim(int *nrow, int *ncol, int *nrowt, int *ncolt, int *n,
+        int *b, double *expected, int *observed, double *fact,
+        int *jwork, double *results)
+#else
 chisqsim(long *nrow, long *ncol, long *nrowt, long *ncolt, long *n,
         long *b, double *expected, long *observed, double *fact,
         long *jwork, double *results)
+#endif
 {
     /* Local variables */
-    long i, j, iter;
+    int i, j, iter;
     double chi, e, o, x;
 
     /* Calculate log-factorials */


And I get to the next bug:

> data(faithful)
> x <- xx <- faithful$eruptions
> x[i.out <- sample(length(x), 10)] <- NA
  I modifed this to 
  x[i.out <- c(1,10,20,50,100,200)] <- NA
> doR <- density(x, bw=0.15, na.rm = TRUE) # works
> doN <- density(x, bw=0.15, na.rm = FALSE)
segfault at approx.c: 

    for(i=0 ; i<*nxy ; i++)
	if(ISNA(x[i]) || ISNA(y[i]))
	    error("approx(): attempted to interpolate NA values\n");

Both x and y are NULL pointers. 
The error is somewhere before, comparing with R on SuSE 5.3:
somewhere in density():

debug: kords[(n + 2):(2 * n)] <- -kords[n:2]
linux and osf both get:
kords
[1]  0.00000000  0.01094819  0.02189638  0.03284457  0.04379277 ...
[1021] -0.04379277 -0.03284457 -0.02189638 -0.01094819

then in the following if-statement we go to
debug: kords <- convolve(y, kords)[1:n]
with linux result
kords
  [1] 2.523589e-13 4.199167e-13 6.950994e-13 1.144613e-12 ...
[511] 5.032797e-13 3.017881e-13
and alpha:
kords
  [1] NA NA NA NA NA NA NA NA ...
[501] NA NA NA NA NA NA NA NA NA NA NA NA
... now on the alpha x and y are set to numeric(0) and approx is called
with this arguments, bang.

Now in convolve(x,y) on entry x=y and y=kords on linux and osf are
identical.
x:
   [1] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00  ...
 [151] 4.866728e-03 6.204044e-03 3.258272e-03 3.552390e-03 4.218750e-03
[1021] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00  ...
y:
   [1]  2.659615e+00  2.652540e+00  2.631429e+00  2.596616e+00 ...
[1021]  2.548649e+00  2.596616e+00  2.631429e+00  2.652540e+00 

now the error is in line
debug: x <- fft(fft(x) * (if (conj) Conj(fft(y)) else fft(y)), inv = TRUE)
of convolve() which returns only NAs on the alpha.

... so tomorrow I will have a look into fft.c



Albrecht

-------------------------------------------------------------------------------
Albrecht Gebhardt                   email   : albrecht.gebhardt@uni-klu.ac.at
Institut fuer Mathematik            Tel.    : (++43 463) 2700/837
Universitaet Klagenfurt             Fax     : (++43 463) 2700/834
Villacher Str. 161
A-9020 Klagenfurt, Austria
-------------------------------------------------------------------------------


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Wed Sep 15 16:36:55 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed, 15 Sep 1999 17:36:55 +0200 (MET DST)
Subject: buglet in lm.influence() -- easy fix but... (PR#278)
Message-ID: <199909151536.RAA18972@pubhealth.ku.dk>

(R 0.65.0 and earlier):

       example(aov)
       lm.influence(npk.aov)
gives
	Error: NA/NaN/Inf in foreign function call (arg 6)

which comes from the  lm.obj$coefficients  
(the last 3-way interaction coefficient is indetermined and accordingly NA)
argument passed to .Fortran("lminfl",...)  inside lm.influence.

The following is a simple correct patch

--- lm.influence.R	1999/08/13 06:44:12	1.5
+++ lm.influence.R	1999/09/15 15:32:11
@@ -38,6 +38,7 @@
 	     hat = double(n),
 	     coefficients = matrix(0, nr = n, nc = k),
 	     sigma = double(n),
+             NAOK = TRUE,# lm.obj$coef can have "structural" NAs
 	     DUP = FALSE)[c("hat", "coefficients", "sigma")]
 }

However, closer inspection shows that this 6th argument 
(called `b' inside  src/appl/lminfl.f) is not used at all in the code.

Ross, can I eliminate it from the subroutine lminfl() altogether ?


Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Sep 15 16:54:00 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 15 Sep 1999 17:54:00 +0200 (MET DST)
Subject: chisqsim broken on alpha - solved + next bug in fft found (PR#277)
Message-ID: <199909151554.RAA19181@pubhealth.ku.dk>

On Wed, 15 Sep 1999 albrecht.gebhardt@uni-klu.ac.at wrote:

> On Wed, 15 Sep 1999 ripley@stats.ox.ac.uk wrote:
> 
> > On Tue, 14 Sep 1999, Albrecht Gebhardt wrote:
> > 
> > [...]
> > 
> > > chisqsim (called from chisq.test() crashes. First I found that the crash
> > > is at 
> > > chisqsim.c:167
> > > 167             fact[i] = x;
> > 
> > [...]
> > 
> > chisqsum.c has its interface in terms of long *, called by .C that supplies
> > int *. I think those are different on an Alpha.  Could you please
> > edit long to int in that file and try again.

> Yes this helps.

OK, that has gone in R-release today, for 0.65.0 (patched).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Wed Sep 15 17:43:01 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Wed, 15 Sep 1999 18:43:01 +0200 (MET DST)
Subject: plot ( <aov.obj> ) failed -- easy fix (PR#279)
Message-ID: <199909151643.SAA19576@pubhealth.ku.dk>

It is already commited for "tomorrow"s snapshot of R-release
(why on earth has nobody noticed ??)

--- plot.lm.R	1999/08/13 09:36:22	1.4
+++ plot.lm.R	1999/09/15 16:39:45
@@ -17,7 +17,7 @@
     hii <- lm.influence(x)$hat
     s <- sqrt(deviance(x)/df.residual(x))
     if (any(show[2:3])) {
-	ylab23 <- switch(class(x)[1], lm = "Standardized residuals",
+	ylab23 <- switch(class(x)[1], aov = , lm = "Standardized residuals",
 			 glm = "Std. dev. residuals")
 	rs <- r/sqrt(1 - hii)/s
     }

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Thu Sep 16 07:22:15 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Thu, 16 Sep 1999 08:22:15 +0200 (MET DST)
Subject: plot ( <aov.obj> ) failed -- easy fix (PR#279)
Message-ID: <199909160622.IAA22004@pubhealth.ku.dk>

>>>>> On Wed, 15 Sep 1999 18:43:01 +0200 (MET DST), maechler@stat.math.ethz.ch (Martin Maechler) said:

    MM> It is already commited for "tomorrow"s snapshot of R-release
    MM> (why on earth has nobody noticed ??)


  >> --- plot.lm.R	1999/08/13 09:36:22	1.4
  >> +++ plot.lm.R	1999/09/15 16:39:45
  >> @@ -17,7 +17,7 @@
  >>      hii <- lm.influence(x)$hat
  >>      s <- sqrt(deviance(x)/df.residual(x))
  >>      if (any(show[2:3])) {
  >> -	ylab23 <- switch(class(x)[1], lm = "Standardized residuals",
  >> +	ylab23 <- switch(class(x)[1], aov = , lm = "Standardized residuals",
  >>  			 glm = "Std. dev. residuals")
  >>  	rs <- r/sqrt(1 - hii)/s
  >>      }

but a much better patch is

--- plot.lm.R	1999/08/13 09:36:22	1.4
+++ plot.lm.R	1999/09/16 06:17:13	1.4.2.2
@@ -17,8 +17,8 @@
     hii <- lm.influence(x)$hat
     s <- sqrt(deviance(x)/df.residual(x))
     if (any(show[2:3])) {
-	ylab23 <- switch(class(x)[1], lm = "Standardized residuals",
-			 glm = "Std. dev. residuals")
+	ylab23 <- if(inherits(x, "glm"))
+	    "Std. dev. residuals" else "Standardized residuals"
 	rs <- r/sqrt(1 - hii)/s
     }
     one.fig <- prod(par("mfcol")) == 1

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ulrich.poetter@ruhr-uni-bochum.de  Thu Sep 16 21:43:35 1999
From: ulrich.poetter@ruhr-uni-bochum.de (ulrich.poetter@ruhr-uni-bochum.de)
Date: Thu, 16 Sep 1999 22:43:35 +0200 (MET DST)
Subject: install/libraries on solaris2.6 (PR#280)
Message-ID: <199909162043.WAA01534@pubhealth.ku.dk>

Full_Name: ulrich poetter
Version: 0.65.0
OS: sparc-sun-solaris 2.6
Submission from: (NULL) (134.147.95.163)


Building R-0.65.0 on sparc-sun-solaris2.6 using sun make + gcc 2.95.1+ binutils
2.8.1
and ./configure --with-g77 fails when building the eda etc. libraries. The
configure 
script produces SHLIBLDFLAGS= -G. Replacing this in config.site by 
SHLIBLDFLAGS = -shared gives no errors during make, but "make check" fails when

trying to load library "eda" with the message "Symbol rsort not found". Trying
the 
other libraries by hand results in similar errors, except for "base" and "mva",

while "make test-Specific" gives no errors. 

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Thu Sep 16 22:42:51 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Thu, 16 Sep 1999 22:42:51 +0100 (BST)
Subject: install/libraries on solaris2.6 (PR#280)
In-Reply-To: <199909162043.WAA01534@pubhealth.ku.dk>
Message-ID: <Pine.GSO.4.05.9909162239390.4826-100000@auk.stats>

On Thu, 16 Sep 1999 ulrich.poetter@ruhr-uni-bochum.de wrote:

> Full_Name: ulrich poetter
> Version: 0.65.0
> OS: sparc-sun-solaris 2.6
> Submission from: (NULL) (134.147.95.163)
> 
> 
> Building R-0.65.0 on sparc-sun-solaris2.6 using sun make + gcc 2.95.1+ binutils
> 2.8.1
> and ./configure --with-g77 fails when building the eda etc. libraries. The
> configure 
> script produces SHLIBLDFLAGS= -G. Replacing this in config.site by 
> SHLIBLDFLAGS = -shared gives no errors during make, but "make check" fails when
> 
> trying to load library "eda" with the message "Symbol rsort not found". Trying
> the 
> other libraries by hand results in similar errors, except for "base" and "mva",
> 
> while "make test-Specific" gives no errors. 

Fuller details, please. Exactly that configuration works for me (except I
don't know where binutils are in your path). Looks like you haven't got
linking against R.X11 correct.  Try using the sun ld if you are not already
doing so (it is recommended for Solaris).


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Fri Sep 17 14:10:49 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Fri, 17 Sep 1999 15:10:49 +0200 (MET DST)
Subject: mtext(. col = ...) stopped working in 0.65.0 (PR#281)
Message-ID: <199909171310.PAA09366@pubhealth.ku.dk>

Ouch, ouch..

  plot(1) ;mtext("Default",side=1)
  mtext("Red Herring",col="red",font=2,cex=3)
  mtext("adj = 1",adj=1,font=3,cex=2)

works alright in 0.64.2, but not anymore in 0.65.0.
This is true for x11() and postscript() at least,
but probably device independent.

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ulrich.poetter@ruhr-uni-bochum.de  Fri Sep 17 20:59:34 1999
From: ulrich.poetter@ruhr-uni-bochum.de (ulrich.poetter@ruhr-uni-bochum.de)
Date: Fri, 17 Sep 1999 21:59:34 +0200 (MET DST)
Subject: install/libraries on solaris2.6 (PR#280)
In-Reply-To: <Pine.GSO.4.05.9909162239390.4826-100000@auk.stats>
References: <199909162043.WAA01534@pubhealth.ku.dk>
 <Pine.GSO.4.05.9909162239390.4826-100000@auk.stats>
Message-ID: <14306.39861.332780.698609@abel.stat.ruhr-uni-bochum.de>

Prof Brian D Ripley writes:
 > On Thu, 16 Sep 1999 ulrich.poetter@ruhr-uni-bochum.de wrote:
 > 
 > > Full_Name: ulrich poetter
 > > Version: 0.65.0
 > > OS: sparc-sun-solaris 2.6
 > > Submission from: (NULL) (134.147.95.163)
 > > 
 > > 
 > > Building R-0.65.0 on sparc-sun-solaris2.6 using sun make + gcc 2.95.1+ binutils
 > > 2.8.1
 > > and ./configure --with-g77 fails when building the eda etc. libraries. The
 > > configure 
 > > script produces SHLIBLDFLAGS= -G. Replacing this in config.site by 
 > > SHLIBLDFLAGS = -shared gives no errors during make, but "make check" fails when
 > > trying to load library "eda" with the message "Symbol rsort not found". Trying
 > > the 
 > > other libraries by hand results in similar errors, except for "base" and "mva",
 > > 
 > > while "make test-Specific" gives no errors. 
 > 
 > Fuller details, please. Exactly that configuration works for me (except I
 > don't know where binutils are in your path). Looks like you haven't got
 > linking against R.X11 correct.  Try using the sun ld if you are not already
 > doing so (it is recommended for Solaris).

Thanks. Using the sun ld (with everything else the same) works. 

The Readme of gnu ld mentions a difference to sun ld and says it would 
emulate its behavior if given the "-E" flag. I didn't try this, but if 
this was the case, could one not try to figure it out in the configure 
script?

Thanks again,
Uli Poetter


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mcw@ln.nimh.nih.gov  Fri Sep 17 21:13:57 1999
From: mcw@ln.nimh.nih.gov (Matthew Wiener)
Date: Fri, 17 Sep 1999 16:13:57 -0400 (EDT)
Subject: "Error:  incorrect number of arguments to lambda"
Message-ID: <Pine.SGI.3.96.990917155315.909F-100000@ln.nimh.nih.gov>

Hello, all.

I have a somewhat embarrassing error, in that I cannot reliably reproduce
it.  I have sporadically experienced the error both on an SGI machine
running Irix 6.5 and on a LinuxPPC machine.  I have only seen this error
using version 0.65.0.  (I've been using versions since 0.61 or so.)

The error message is in the subject line.  Here's the traceback from the
most recent occurrence:

Error: incorrect number of arguments to "lambda"  
> traceback()  
[1] "bxp(groups, width, varwidth = varwidth, notch = notch, border =
border, " 
[2] "  col = col, log = log, pars = pars, lwd = lwd, pch = pch, "  
[3] " lty = lty, p.size = p.size, ...)"  
[4] "boxplot(split(mf[[response]], mf[[-response]]), ...)" 
[5] "boxplot.formula(c.est ~ frac.vec, col = \"blue\", notch = T)" [6]
"f.calc.var.g()" 



You'll notice that here I'm using a slightly modified version of bxp (I
wasn't able to figure out another way to change the line width of the
whiskers or the point size of outliers), but the same error occurred with
the original version.  Except then, when I reloaded my modified version,
the error vanished.  I haven't been able to make it happen again this
time.

The error has occurred in several other functions as well -- the first
time I thought I'd just misinstalled, so I did it again.  Then I didn't
see the error for a while, and became complacent.  But now it's back.


Here's what I remember from the earlier occurrences:

I had a function calling several subroutines.  I got this error, and
traceback pointed at one of the subroutines.  I inserted a few print
statements to try to follow what was going on, after which the program got
through that subroutine with no problems, and gave me the "lambda" error
in the next subroutine.  Putting print statements in the next subroutine
bumped the error to the one after that.  That's when I reinstalled.  That
took care of it for a while, but it's now resurfaced on a couple of
occasions.

The R online help has no function called lambda, nor does one come up in a
search through my environment.  I don't have any contributed packages
loaded, although I do have a collection of functions I use regularly, and
which I've used without incident until now.  Lambda sounds lispish, but I
can't figure out where to find it and look for it.

Needless to say, I will keep better notes next time this happens.  If
anyone has any ideas what it might be and how to fix it, that's great.
Otherwise, I'd like to know what sort of information I ought to collect so
that my report can be as useful as possible.

Thanks,

Matt

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Sep 17 21:40:58 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Fri, 17 Sep 1999 22:40:58 +0200 (MET DST)
Subject: install/libraries on solaris2.6 (PR#280)
Message-ID: <199909172040.WAA11161@pubhealth.ku.dk>

On Fri, 17 Sep 1999 ulrich.poetter@ruhr-uni-bochum.de wrote:

> Prof Brian D Ripley writes:
>  > On Thu, 16 Sep 1999 ulrich.poetter@ruhr-uni-bochum.de wrote:
>  > 
>  > > Full_Name: ulrich poetter
>  > > Version: 0.65.0
>  > > OS: sparc-sun-solaris 2.6
>  > > Submission from: (NULL) (134.147.95.163)
>  > > 
>  > > 
>  > > Building R-0.65.0 on sparc-sun-solaris2.6 using sun make + gcc 2.95.1+ binutils
>  > > 2.8.1
>  > > and ./configure --with-g77 fails when building the eda etc. libraries. The
>  > > configure 
>  > > script produces SHLIBLDFLAGS= -G. Replacing this in config.site by 
>  > > SHLIBLDFLAGS = -shared gives no errors during make, but "make check" fails when
>  > > trying to load library "eda" with the message "Symbol rsort not found". Trying
>  > > the 
>  > > other libraries by hand results in similar errors, except for "base" and "mva",
>  > > 
>  > > while "make test-Specific" gives no errors. 
>  > 
>  > Fuller details, please. Exactly that configuration works for me (except I
>  > don't know where binutils are in your path). Looks like you haven't got
>  > linking against R.X11 correct.  Try using the sun ld if you are not already
>  > doing so (it is recommended for Solaris).
> 
> Thanks. Using the sun ld (with everything else the same) works. 
> 
> The Readme of gnu ld mentions a difference to sun ld and says it would 
> emulate its behavior if given the "-E" flag. I didn't try this, but if 
> this was the case, could one not try to figure it out in the configure 
> script?

_I_ am not sure it is at all easy to find out which ld you are using, but
thanks for the info: another thing to watch out for.


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mcw@ln.nimh.nih.gov  Fri Sep 17 21:44:17 1999
From: mcw@ln.nimh.nih.gov (Matthew Wiener)
Date: Fri, 17 Sep 1999 16:44:17 -0400 (EDT)
Subject: lambda error update
Message-ID: <Pine.SGI.3.96.990917164220.909I-100000@ln.nimh.nih.gov>

Two more details:

Someone else who works here, and hasn't used 0.65.0, thinks he's seen the
error before.  He restarted R, and it went away.

Second, I think the relevant code is in 
SEXP do_function, in eval.c in the main directory.

line 695:  WrongArgCount("lambda")

Beyond that I'm afraid I'm getting in over my head.

Matt


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Sep 18 00:53:55 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Sep 1999 01:53:55 +0200
Subject: lambda error update
In-Reply-To: Matthew Wiener's message of "Fri, 17 Sep 1999 16:44:17 -0400 (EDT)"
References: <Pine.SGI.3.96.990917164220.909I-100000@ln.nimh.nih.gov>
Message-ID: <x2aeqlt7qk.fsf@blueberry.kubism.ku.dk>

Matthew Wiener <mcw@ln.nimh.nih.gov> writes:

> Two more details:
> 
> Someone else who works here, and hasn't used 0.65.0, thinks he's seen the
> error before.  He restarted R, and it went away.
> 
> Second, I think the relevant code is in 
> SEXP do_function, in eval.c in the main directory.
> 
> line 695:  WrongArgCount("lambda")
> 
> Beyond that I'm afraid I'm getting in over my head.
> 
> Matt

"lambda" is essentially "function" (revealing the fact that R's engine
is really a Lisp/Scheme dialect). It's a very strange error you're
getting because the calls to "function" are almost impossible to
create, except by having the parser parse a

function (<args>) <body> 

construction and that would set up a call with the right number of
parameters (xxdefun in gram.y calls lang4). The arg count got changed
from 0.64.2 to 0.65.0 (from 3 to 4) to accommodate the stored source
attribute. I suppose that a function stored in a saved workspace might
cause some kind of mess when restored.

You can provoke the error by messing with the parse tree of function()
constructs, e.g.

> e<-quote(function()1)
> e[[4]]<-NULL
> eval(e)
Error: incorrect number of arguments to "lambda"
> e
function() 1
> e<-quote(function()1)
> e[[3]]<-NULL
> eval(e)
Error: incorrect number of arguments to "lambda"
> e
function() "function()1"
> e[[2]]<-NULL
> eval(e)
Error: incorrect number of arguments to "lambda"
> e
Segmentation fault (core dumped)

(That last one seems to indicate yet another spot where the deparser
needs to take better care).

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From mcw@ln.nimh.nih.gov  Sat Sep 18 06:55:51 1999
From: mcw@ln.nimh.nih.gov (Matthew Wiener)
Date: Sat, 18 Sep 1999 01:55:51 -0400 (EDT)
Subject: lambda error update
In-Reply-To: <x2aeqlt7qk.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.SGI.3.96.990918015308.10757B-100000@ln.nimh.nih.gov>



On 18 Sep 1999, Peter Dalgaard BSA wrote:

> "lambda" is essentially "function" (revealing the fact that R's engine
> is really a Lisp/Scheme dialect). It's a very strange error you're
> getting because the calls to "function" are almost impossible to
> create, except by having the parser parse a
> 
> function (<args>) <body> 
> 
> construction and that would set up a call with the right number of
> parameters (xxdefun in gram.y calls lang4). The arg count got changed
> from 0.64.2 to 0.65.0 (from 3 to 4) to accommodate the stored source
> attribute. I suppose that a function stored in a saved workspace might
> cause some kind of mess when restored.
> 

If I understand this correctly, it would seem to mean that I'm unlikely to
get this error more than once from any given function, since when I
re-store (rather than restore) it under 0.65.0 things will get fixed.
Does that seem right?  If not, is there anything I can do?

Thanks (for this help and for R generally).

Matt

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Sep 18 10:40:00 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Sat, 18 Sep 1999 11:40:00 +0200 (MET DST)
Subject: lambda error update (PR#282)
Message-ID: <199909180940.LAA12533@pubhealth.ku.dk>

Matthew Wiener <mcw@ln.nimh.nih.gov> writes:

> > parameters (xxdefun in gram.y calls lang4). The arg count got changed
> > from 0.64.2 to 0.65.0 (from 3 to 4) to accommodate the stored source
> > attribute. I suppose that a function stored in a saved workspace might
> > cause some kind of mess when restored.
> > 
> 
> If I understand this correctly, it would seem to mean that I'm unlikely to
> get this error more than once from any given function, since when I
> re-store (rather than restore) it under 0.65.0 things will get fixed.
> Does that seem right?  If not, is there anything I can do?

No, that doesn't work, because you'll just store the old call again.
However if you just edit the function, e.g. with fix(), the problem
goes away. You don't have to change it, just make sure that the code
gets reparsed.

Here's the essence of the problem:

R : Copyright 1999, The R Development Core Team
Version 0.64.1 Patched (unreleased snapshot) (May 14, 1999)
> f<-function(){g<-function()2}  
> save(f,file="xxx")

R : Copyright 1999, The R Development Core Team
Version 0.65.0 Patched (unreleased) (September 16, 1999)
> load("xxx")
> f
function () 
{
    g <- function() 2
}
> f()
Error: incorrect number of arguments to "lambda"
> fix(f)
...
> f()
>

D*mn! I should have thought of that. I'll see if I can cook up a fix
for 0.65.1. Filed as a bug report.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Sep 18 11:21:42 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 18 Sep 1999 12:21:42 +0200
Subject: lambda error update (PR#282)
In-Reply-To: p.dalgaard@biostat.ku.dk's message of "Sat, 18 Sep 1999 11:40:00 +0200 (MET DST)"
References: <199909180940.LAA12533@pubhealth.ku.dk>
Message-ID: <x2yae4zfih.fsf@blueberry.kubism.ku.dk>

p.dalgaard@biostat.ku.dk writes:

> Error: incorrect number of arguments to "lambda"
> > fix(f)
> ...
> > f()
> >
> 
> D*mn! I should have thought of that. I'll see if I can cook up a fix
> for 0.65.1. Filed as a bug report.

Heh. Turned out to be absolutely trivial:

diff -u -r1.62.2.1 eval.c
--- eval.c	1999/09/02 15:11:59	1.62.2.1
+++ eval.c	1999/09/18 10:06:30
@@ -691,7 +691,7 @@
 {
     SEXP rval;
 
-    if (length(args) < 3)
+    if (length(args) < 2)
	WrongArgCount("lambda");
     CheckFormals(CAR(args));
     rval = mkCLOSXP(CAR(args), CADR(args), rho);

If the 3rd argument is absent, R_NilValue gets passed for the CADDR in

   setAttrib(rval, R_SourceSymbol, CADDR(args));

and that is exactly what should happen!

This has to be the smallest bugfix possible, AFAICS a single bit gets
flipped, both in the source and in the binaries....

Will commit in a moment.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Sat Sep 18 20:03:13 1999
From: p.dalgaard@biostat.ku.dk (p.dalgaard@biostat.ku.dk)
Date: Sat, 18 Sep 1999 21:03:13 +0200 (MET DST)
Subject: hsv strangeness (PR#283)
Message-ID: <199909181903.VAA13542@pubhealth.ku.dk>

This doesn't look right:

 piechart(rep(1,48),col=hsv((1:48)/48,1,1))

Hues 8,16,32 are completely out of whack. 

(Linux RedHat6.0, X11 driver, but probably not driver dependant.)

This also sends topo.colors, terrain.colors, and heat.colors way off.
Look at example(heat.colors) for instance.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Adrian.Trapletti@wu-wien.ac.at  Mon Sep 20 17:08:25 1999
From: Adrian.Trapletti@wu-wien.ac.at (Adrian Trapletti)
Date: Mon, 20 Sep 1999 16:08:25 +0000
Subject: Updated tseries package
Message-ID: <37E65BF9.B37B63C0@wu-wien.ac.at>

Fritz just put the updated tseries package to CRAN. I mainly removed
(and corrected) code such that tseries fits together with package ts.
New code is White's and Teraesvirta's tests for neglected non-linearity
(also for the regression case). From the INDEX file:

NelPlo                   Nelson-Plosser Macroeconomic Time Series
adf.test                 Augmented Dickey-Fuller Test
amif                     Auto Mutual Information Function
bds.test                 BDS Test
portfolio.optim          Portfolio Optimization
quadmap                  Quadratic Map (Logistic Equation)
read.matrix              Read Matrix Data
read.ts                  Read Time Series Data
runs.test                Runs Test
surrogate                Generate Surrogate Data
tcm                      Yields on Treasury Securities
terasvirta.test          Teraesvirta Neural Network Test for
Nonlinearity
white.test               White Neural Network Test for Nonlinearity

Comments and suggestions are welcome!

Adrian


--
Adrian Trapletti, Vienna University of Economics and Business
Administration, Augasse 2-6, A-1090 Vienna, Austria
Phone: ++43 1 31336 4561, Fax: ++43 1 31336 708,
Email: adrian.trapletti@wu-wien.ac.at



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pd@biostat.ku.dk  Tue Sep 21 06:15:04 1999
From: pd@biostat.ku.dk (Peter Dalgaard BSA)
Date: Tue, 21 Sep 1999 07:15:04 +0200
Subject: Bug list summary (automatic post)
Message-ID: <199909210515.HAA12539@biostat.ku.dk>

=================================================
This is an automated summary of the status of the R-bugs
repository.

Note that this may be neither complete nor perfectly
correct at any given instance: Not all bugs are reported,
and some reported bugs may have been fixed, but the
repository not yet updated.

Some bug fixes are difficult to verify because they pertain
to specific hardware or operating system versions. If you
have information to contribute, please do so.

If you happen to know how to fix a problem please send
patches to the bug repository, too.

New bugs are reported either through the web
interface at r-bugs.biostat.ku.dk or via email to
r-bugs@biostat.ku.dk. The bug.report() function can be
used to automate parts of the procedure on many systems.
Followups on older bugs can be done by including the string
"(PR#999)" in the Subject of an email (change 999 to the
actual reference number, of course!).
=================================================

Directory:  Accuracy

* PR# 138 *
Subject: Re: [R] bug? and New bug.
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Wed, 10 Mar 1999 17:21:16 +0100
--pt() for large df. Solved, but problem remains for pf et al.

Directory:  Add-ons

* PR# 137 *
Subject: funfits
From: "Alvaro A. Novo" <novo@uiuc.edu>
Date: Tue, 9 Mar 1999 22:24:54 -0600
--Not our problem. Dubious whether a bug at all.

Directory:  Analyses

* PR# 144 *
Subject: glm throws erroneous(?)'names attribute must be the same length as the vector' 
From: wagman@enteract.com
Date: Thu, 18 Mar 1999 08:58:47 +0100
--Can anyone reproduce this ??
--Same error as when doing regression on empty subset. All fitted
--values might be 0 or 1

Directory:  Documentation

none

Directory:  Graphics

* PR# 61 *
Subject: points(...,  cex = ..)  is pretty wrong...
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 2 Nov 1998 19:15:06 +0100
--Symbols getting decentered when too large cex for X. Still there 22feb99  
* PR# 69 *
Subject: Some graphics bugs
From: Martyn Plummer <plummer@iarc.fr>
Date: Fri, 04 Dec 1998 11:42:50 -0000 ()
Date: 04-Dec-98
--Various anomalies with text size and alignment. 2B appears to be solved. The 
--rest is still there (22feb99)
* PR# 120 *
Subject: graphics bug: type="l"
From: Matthew Wiener <mcw@ln.nimh.nih.gov>
Date: Tue, 16 Feb 1999 15:30:25 -0500 (EST)
--X server problem drawing > 64K lines at once. Workaround?
* PR# 123 *
Subject: Text in plot
From: Ennapadam Venkatraman <venkat@biosta.mskcc.org>
Date: Thu, 18 Feb 1999 13:05:37 -0500
--Multiline text not working
* PR# 130 *
Subject: lty=0 -- shouldn't it give an invisible line?
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 28 Feb 1999 21:45:43 +0100
--Strange effect on barplot
* PR# 149 *
Subject: plot.formula and pch=
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 25 Mar 1999 21:22:44 +0100
--plot(y~x,pch=z) may subset x and y but leave z.
--E.g. with missing values you can get incorrect plot symbols.
* PR# 202 *
Subject: persp box occlusion bug
From: wsi@gcal.ac.uk
Date: Wed, 2 Jun 1999 15:02:03 +0200 (MET DST)
--Don't think I (pd) got the point there...
* PR# 225 *
Subject: pch and mkh bug
From: Stephen Harker <sjh@ph.adfa.edu.au>
Date: Wed, 14 Jul 1999 13:10:31 +1000 (EST)
--(1) is an S incompatibility, but the S rules may not be a good model
--(2) is a bug, fixed for 0.65.0
--(3) has gone away in 0.65.0
* PR# 229 *
Subject: dev.print scaling bug?
From: John.Peters@tip.csiro.au (John Peters)
Date: Fri, 16 Jul 1999 12:10:48 +1000 (EST)
* PR# 230 *
Subject: Use of lwd = 0, lty = 2 in segments.
From: Douglas Bates <bates@stat.wisc.edu>
Date: Sat, 17 Jul 1999 17:18:44 -0500 (CDT)
* PR# 238 *
Subject: EPS compliance of postscript device: initclip operator
From: David Middleton <dajm@deeq.demon.co.uk>
Date: Tue, 03 Aug 1999 17:51:47 -0300
--initclip is removed. Still need new argument onefile/onepage to ensure one page
--and use %!PS-Adobe-3.0 EPSF-3.0 header

Directory:  In-Out

* PR# 125 *
Subject: scan rejects complex
From: John.Peters@tip.csiro.au (John Peters)
Date: Mon, 22 Feb 1999 10:08:14 +1100 (EST)
* PR# 129 *
Subject: Formatting in formatC and format
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 28 Feb 1999 08:53:34 +0000 (GMT)
--Documentation and ``merge'' of format() and formatC() would be desired - MM
* PR# 207 *
Subject: Lines longer than ~1000 chars truncated at parsing
From: msa@biostat.mgh.harvard.edu
Date: Mon, 7 Jun 1999 22:27:10 +0200 (MET DST)
--Fixed buffer used during input.
--Not fixable without major changes to readline lib.

Directory:  Installation

none

Directory:  Language

* PR# 105 *
Subject: an old bug resurfaces
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Fri, 29 Jan 1999 08:28:32 +0100 (MET)
--Model formulas. Proper fix probably requires extensive rewrite of model formula
--parser, which would make in non-S-compatible.
* PR# 239 *
Subject: cbind is not generic as claimed, omits labels where S has them 
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 5 Aug 1999 12:29:58 +0100 (BST)
--Cbind is now generic, still labelling issues. See also PR#240 and PR#241.
* PR# 240 *
Subject: Re: cbind is not generic as claimed, omits labels where S has them
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 5 Aug 1999 17:19:08 +0100 (BST)
--See PR#239
* PR# 241 *
Subject: Re: cbind is not generic as claimed, omits labels where S has them
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Fri, 6 Aug 1999 06:52:35 +0100 (BST)
--See PR#239

Directory:  Low-level

* PR# 37 *
Subject: S.h compatibility issues
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Sun, 6 Sep 1998 19:58:47 +0100 (BST)
--1 is fixed
--2 R's own RNG entry points are still not public
--3 is the perennial issue of what is the `public' API -- specific points are
--fixed
* PR# 101 *
Subject: Re: [R] Re: R-0.63.2 for Windows - some comments
From: Guido Masarotto <guido@hal.stat.unipd.it>
Date: Fri, 22 Jan 1999 12:40:26 +0100
--This is really about fixed buffer sizes in printutils.c
* PR# 135 *
Subject: summary() of lm() problem
From: Simon Fear <fears@roycastle.liv.ac.uk>
Date: Tue, 9 Mar 1999 13:18:37 -0000 
--lm (?) AND Windows problem;  Win solved (fudged) for 0.63.3
--
--Another low-level buffer-size problem
* PR# 185 *
Subject: Re: [R] R_problem_buf in the S.h files & lists in .C
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 05 May 1999 00:32:49 +0200
--S objects in .C calls (not just lists) are now documented in the help file
* PR# 197 *
Subject: glm crash
From: Cor en Aylin <Cor.Berrevoets@gironet.nl>
Date: Fri, 21 May 1999 19:44:23 +0200
--Obscure report. Cannot reproduce from given info.
* PR# 210 *
Subject: definition of R_problem_buf in S.h
From: vogels@ieee.org
Date: Mon, 14 Jun 1999 17:56:04 +0200 (MET DST)
--Same as #185
* PR# 235 *
Subject:  round(numeric(0)) 
From: Prof Brian Ripley <ripley@stats.ox.ac.uk>
Date: Thu, 29 Jul 1999 15:20:21 +0100 (BST)
--Some followup of this on R-devel not sent here.

Directory:  Misc

* PR# 91 *
Subject: possible bug
From: Rashid Nassar <rnassar@duke.edu>
Date: Sat, 9 Jan 1999 14:50:58 -0500 (EST)
--Remaining issue is whether we can do something more friendly than dumping 
--users into vi?

Directory:  Models

* PR# 121 *
Subject:  model.frame mangles time series 
From: Peter Dalgaard BSA <pd@biostat.ku.dk>
Date: Thu, 18 Feb 1999 15:47:24 +0100
--Subset in C code + attributes = mess
--Switch to interpreted ("[")

Directory:  Startup

none

Directory:  System-specific

* PR# 214 *
From: Charles Taylor <charles@amsta.leeds.ac.uk>
Date: Thu, 24 Jun 1999 11:20:06 +0100 (BST)
* PR# 222 *
Subject: Use of R-Coda
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Fri, 9 Jul 1999 10:54:16 +0200 
--In Danish (?)  Looks as if PR#246 is the same in English
* PR# 234 *
Subject: R-bugs
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Tue, 27 Jul 1999 13:49:31 +0200
--Looks like PR#222 again, in Danish. See PR#246 for English version
* PR# 246 *
Subject: R-Coda on rs6000-ibm-aix4.2.1.0
From: =?iso-8859-1?Q?Jette_Halkj=E6r_Jakobsen?=
Date: Wed, 11 Aug 1999 08:49:47 +0200
--Problem with ps on AIX in 0.64.2. Try again with 0.65.0?

Directory:  TooMuchAtOnce

* PR# 53 *
Subject: 0.62.3 bugs, incompatibilities and problems
From: Jim Lindsey <jlindsey@alpha.luc.ac.be>
Date: Mon, 12 Oct 1998 09:43:51 +0200 (MET DST)
--Of Jims points: (checked in 0.65 April 26 compared to Splus 3.4)
-- 4. works the same as S
-- 5. Splus gives NA and the if(class(z)=="repeated") doesn't work in either
-- 10. seems to work
-- 7.  seems to do what Jim wants now
--  
* PR# 76 *
Subject: R-0.63.0
From: Rashid Nassar <rnassar@acpub.duke.edu>
Date: Fri, 11 Dec 1998 23:20:08 -0500 (EST)

Directory:  Windows

none

Directory:  incoming

* PR# 248 *
Subject: scan() + error interferes with count.fields() in some cases
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 13 Aug 1999 17:44:48 +0200
* PR# 249 *
Subject: axis ignores srt/crt
From: Thomas Lumley <thomas@biostat.washington.edu>
Date: Mon, 16 Aug 1999 15:51:49 -0700 (PDT)
* PR# 250 *
From: Peter Malewski <peter@tu-bs.de>
Date: Tue, 17 Aug 1999 12:21:38 +0200 (CEST)
* PR# 251 *
From: Peter Malewski <peter@tu-bs.de>
Date: Tue, 17 Aug 1999 12:21:45 +0200 (CEST)
* PR# 252 *
Subject: bug: R says "Floating exception" on DEC-Alpha w/OSF1
From: "Michael Thompson" <mlthomps@yayoi.mt.m-kagaku.co.jp>
Date: Thu, 19 Aug 1999 06:03:06 +0900
* PR# 253 *
Subject: seg.fault for some illegal .Random.seed (new since 0.64)
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 20 Aug 1999 14:17:31 +0200
* PR# 254 *
Subject: Strange 'Unimplemented feature in rep' error
From: Lutz Prechelt <prechelt@ira.uka.de>
Date: Mon, 23 Aug 1999 19:43:24 +0200
* PR# 255 *
Subject: broken link in R FAQ page?
From: Tian-Xiong Lu <tian@chico.ma.adfa.edu.au>
Date: Tue, 24 Aug 1999 13:41:21 +1000 (EST)
* PR# 256 *
Subject: Error in ?text
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
Date: Wed, 25 Aug 1999 10:00:19 +0100 (BST)
* PR# 257 *
Subject:  dimnames names lost when subscripting 
From: Andreas Weingessel <weingessel@ci.tuwien.ac.at>
Date: Wed, 25 Aug 1999 12:45:28 +0200
* PR# 258 *
Subject: Greek letters in outer margins.
From: "BXC (Bendix Carstensen)" <BXC@NOVO.dk>
Date: Thu, 26 Aug 1999 12:09:17 +0200
* PR# 259 *
Subject: R without X11?
From: "Jack N." <jnf@pcisys.net>
Date: Sat, 28 Aug 1999 09:22:57 -0600
* PR# 260 *
Subject: Re: Compiling R under Caldera Open Linux 2.2
Subject: Compilation of R under Caldera OpenLinux 2.2
From: John Maindonald <john.maindonald@anu.edu.au>
Date: Sun, 29 Aug 1999 19:38:13 +1000 (EST)
* PR# 261 *
Subject: interface w/ emacs
From: gautier@lion-ag.de
Date: Mon, 30 Aug 1999 13:28:52 +0200 (MET DST)
* PR# 262 *
Subject: Problems compiling R65.0
From: Patrick Lindsey <plindsey@alpha.luc.ac.be>
Date: Wed, 1 Sep 1999 11:52:29 +0200 (MET DST)
* PR# 263 *
Subject: Problems sourcing functions with R65.0
From: Patrick Lindsey <plindsey@alpha.luc.ac.be>
Date: Wed, 1 Sep 1999 11:58:51 +0200 (MET DST)
* PR# 264 *
Subject: R 0.65.x bug :  attach()/eval() {was "lib.source() within library()"}
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Thu, 2 Sep 1999 12:23:43 +0200
* PR# 265 *
Subject: trouble with the 'exclude' parameter of factor()
From: gautier@lion-ag.de
Date: Thu, 2 Sep 1999 17:40:47 +0200 (MET DST)
* PR# 266 *
Subject: Re: [R] data frame component replacement: feature or bug?
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 06 Sep 1999 00:03:29 +0200
* PR# 267 *
Subject: matplot(... panel.first=..) fails  <==> dealing with "..."
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Mon, 6 Sep 1999 11:04:03 +0200
* PR# 268 *
Subject: Re: Compiling R under Caldera Open Linux 2.2
From: "Jack N." <jnf@pcisys.net>
Date: Mon, 06 Sep 1999 08:03:02 -0600
* PR# 269 *
Subject: sys.on.exit appears non-functional
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Tue, 7 Sep 1999 17:41:28 +0100 (BST)
* PR# 270 *
Subject: Y2K Cereal bowl News Release
From: crispy1@newmail.net
Date: Tue, 7 Sep 1999 20:59:05 -0700
* PR# 271 *
Subject: R with Windows 95
From: pascal.grandeau@wanadoo.fr
Date: Wed, 8 Sep 1999 17:56:12 +0200 (MET DST)
* PR# 272 *
Subject:  problem in R.sh.in script 
From: "Mitsuru Oka" <oka@debian.or.jp>
Date: 10 Sep 1999 06:53:01 -0000
* PR# 273 *
Subject: Re: problem in R.sh.in script 
From: Mitsuru Oka <oka@debian.or.jp>
Date: Fri, 10 Sep 1999 16:08:39 +0900
* PR# 274 *
Subject: axis() produces junk on DEC alpha
From: albrecht.gebhardt@uni-klu.ac.at
Date: Mon, 13 Sep 1999 03:02:20 +0200 (MET DST)
* PR# 275 *
Subject: Re: R with a broken finite() (was [R] Problems with R-0.65.0)
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Tue, 14 Sep 1999 15:17:17 +0100 (BST)
* PR# 276 *
Subject: Re: chisqsim broken on alpha (was Re: axis() produces junk on DEC
From: Prof Brian D Ripley <ripley@stats.ox.ac.uk>
Date: Wed, 15 Sep 1999 08:18:42 +0100 (BST)
* PR# 277 *
Subject: Re: chisqsim broken on alpha - solved + next bug in fft found
From: Albrecht Gebhardt <albrecht.gebhardt@uni-klu.ac.at>
Date: Wed, 15 Sep 1999 15:33:09 +0200 (MET DST)
* PR# 278 *
Subject: buglet in lm.influence() -- easy fix but...
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Wed, 15 Sep 1999 17:36:46 +0200
* PR# 279 *
Subject: plot ( <aov.obj> ) failed -- easy fix
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Wed, 15 Sep 1999 18:42:56 +0200
* PR# 280 *
Subject: install/libraries on solaris2.6
From: ulrich.poetter@ruhr-uni-bochum.de
Date: Thu, 16 Sep 1999 22:43:34 +0200 (MET DST)
* PR# 281 *
Subject: mtext(. col = ...) stopped working in 0.65.0
From: Martin Maechler <maechler@stat.math.ethz.ch>
Date: Fri, 17 Sep 1999 15:10:40 +0200
* PR# 282 *
Subject: Re: lambda error update
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 18 Sep 1999 11:44:26 +0200
* PR# 283 *
Subject: hsv strangeness
From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
Date: 18 Sep 1999 21:07:50 +0200
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From plummer@iarc.fr  Wed Sep 22 10:42:18 1999
From: plummer@iarc.fr (plummer@iarc.fr)
Date: Wed, 22 Sep 1999 11:42:18 +0200 (MET DST)
Subject: quasi-likelihood in glm (PR#284)
Message-ID: <199909220942.LAA16986@pubhealth.ku.dk>

I have been using quasi-likelihood to analyze some overdispersed lesion
count data which requires the variance function "mu^2" (specifically,
I am using glm with the family quasi(var="mu^2", link="log")). Some of
the counts are zero which led to problems fitting the model in R.

1) glm was unable to find starting values
2) after I supplied initial values from the fit of a Poisson
   model, glm could not proceed because the deviance was infinite.

Splus 5.0 had no problems fitting the model.  I was able to
reproduce the Splus results by editing the quasi() family
generator and using the unnormalized quasi-likelihood

- log(mu) - y/mu                  (*)

in place of the normalized version

log(y/mu) - (y - mu)/mu            (**)

Further investigation of Splus shows how it overcomes these
two problems
1) A fudge factor (in this case 0.167) is added to zero observations 
   so that they can be used as starting values. 
2) The contribution to the deviance is (*) for zero observations
   and (**) for the rest.

I suggest that R also uses this approach for quasi-likelihood
models.
Martyn

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Wed Sep 22 11:32:12 1999
From: J.C.Rougier@durham.ac.uk (J.C.Rougier@durham.ac.uk)
Date: Wed, 22 Sep 1999 12:32:12 +0200 (MET DST)
Subject: model.matrix() (PR#285)
Message-ID: <199909221032.MAA17796@pubhealth.ku.dk>

I was alarmed to discover that model.matrix.default() can permute columns
with respect to the formula.  This seems to happen with user-defined
components of the formula.  Thus

X <- matrix(1:4, 1, 4, dimnames = list(NULL, LETTERS[1:4]))
Q <- function(x) x^2 # because model.matrix() does not like, eg, A:A

model.matrix(~ -1 + A + A:B + Q(C), data.frame(X))

has columns ordered A, Q(C), and A.B, not A, A.B, Q(C), as you might
expect (and I certainly expected!). This appears to happen .Internal-ly. 

While on the subject, would it be reasonable to standardise the names of
interaction terms to be A:B not A.B, to match the terms in the formula.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Sep 22 11:38:29 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Wed, 22 Sep 1999 12:38:29 +0200 (MET DST)
Subject: quasi-likelihood in glm (PR#284)
Message-ID: <199909221038.MAA17899@pubhealth.ku.dk>

On Wed, 22 Sep 1999 plummer@iarc.fr wrote:

> I have been using quasi-likelihood to analyze some overdispersed lesion
> count data which requires the variance function "mu^2" (specifically,
> I am using glm with the family quasi(var="mu^2", link="log")). Some of
> the counts are zero which led to problems fitting the model in R.
> 
> 1) glm was unable to find starting values
> 2) after I supplied initial values from the fit of a Poisson
>    model, glm could not proceed because the deviance was infinite.
> 
> Splus 5.0 had no problems fitting the model.  I was able to
> reproduce the Splus results by editing the quasi() family
> generator and using the unnormalized quasi-likelihood
> 
> - log(mu) - y/mu                  (*)
> 
> in place of the normalized version
> 
> log(y/mu) - (y - mu)/mu            (**)
> 
> Further investigation of Splus shows how it overcomes these
> two problems
> 1) A fudge factor (in this case 0.167) is added to zero observations 
>    so that they can be used as starting values. 
> 2) The contribution to the deviance is (*) for zero observations
>    and (**) for the rest.
> 
> I suggest that R also uses this approach for quasi-likelihood
> models.

That is not quite what S-PLUS 5.1 and 2000 have: replace
(*) by

-log(mu) - (y - mu)/mu 

That is, the formula is

-log(mu) - (y - mu)/mu + log(y)I(y > 0)

Note that earlier versions of S-PLUS (e.g. 3.4) are plain wrong (and as
I found the bug I know what the replacment is).

Unless there are any objections I will put these fixes in.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Wed Sep 22 12:47:55 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 22 Sep 1999 13:47:55 +0200
Subject: Private data libraries (idea & trick)
Message-ID: <x2iu5388wk.fsf@blueberry.kubism.ku.dk>

It has been annoying me for a while that data in user areas are more
difficult to handle than those in the packages. 

Especially for beginners, it would be very handy to be able just to
say "data(mydata)", rather than
"mydata<-read.table('mydata.txt',header=T)"

What just occurred to me was that the following hack actually works:

Type

library('.',lib.loc='.')

and everything in ./data behaves as if it were in a package. 

Another interesting hack is that one can do this:

[pd@blueberry data]$ cat > file.txt
a b
1 2
3 4
[pd@blueberry data]$ cat > file.R
file<-transform(read.table('file.txt',header=T),
    b=factor(b,levels=1:4,labels=letters[1:4]))

and then from inside R, get the dataframe with factor recoding and
everything as

> data(file)
> file
  a b
1 1 b
2 3 d

Question: Should we perhaps clean this up a little and formalize it?

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From William.Venables@cmis.CSIRO.AU  Wed Sep 22 13:17:38 1999
From: William.Venables@cmis.CSIRO.AU (Bill Venables)
Date: Wed, 22 Sep 1999 22:17:38 +1000
Subject: model.matrix() (PR#285)
In-Reply-To: Your message of "Wed, 22 Sep 1999 12:32:12 +0200."
 <199909221032.MAA17796@pubhealth.ku.dk>
Message-ID: <199909221219.WAA14736@snowy.nsw.cmis.CSIRO.AU>

> I was alarmed to discover that model.matrix.default() can permute columns
> with respect to the formula.						

You are very easily alarmed, then.  The order of the terms is
relevant to a sequential anova and in such an anova it is a
normal and very reasonable strategy for main effects to be
included in the model before interactions (and it is only
interaction terms that are displaced, arranging them in
increasing order by degree).

> This seems to happen with user-defined components of the
> formula.  Thus
> 
> X <- matrix(1:4, 1, 4, dimnames = list(NULL, LETTERS[1:4]))
> Q <- function(x) x^2 # because model.matrix() does not like, eg, A:A
> 
> model.matrix(~ -1 + A + A:B + Q(C), data.frame(X))
> 
> has columns ordered A, Q(C), and A.B, not A, A.B, Q(C), as you might
> expect (and I certainly expected!). This appears to happen .Internal-ly. 

There is a standard method common to R and S of holding terms
together in the strict order they are generated that I suggest is
adequate.  Your model matrix, order intact, could be generated
using

> model.matrix(terms(~ -1 + A + A:B + I(C^2), keep.order = T), data.frame(X))

This is now a very standard idiom but not often needed.  Your
function Q() is not needed, by the way.  The I() function
(`identity') allows you to include arbitrary terms of this form.
This is also a standard and well known idiom.  (I won't ask in
what context you need a quadratic term in C but no linear term...)

There is, though, a clear improvement possible and I do suggest R
core consider it sympathetically.  For quantitative terms A:A
should be an allowable form for the quadratic term, but more
generally ~(x1 + x2 + x3 + x4)^3 should be an allowable form for
a complete 3rd order model, including powers.  I know this is
diffucult since it requires parsing and simplification to be
suspended until the classes of the terms are known, but it is
well worth the effort.

> While on the subject, would it be reasonable to standardise the names of
> interaction terms to be A:B not A.B, to match the terms in the formula.

I agree it would indeed.  The `dot' form is potentially ambiguous
but more seriously I get the horrible feeling I am back using
glim once more and it's plain creepy...

Bill Venables.

-- 
-----------------------------------------------------------------
Bill Venables, Statistician, CMIS Environmetrics Project.

Physical address:                            Postal address:
CSIRO Marine Laboratories,                   PO Box 120,       
233 Middle St, Cleveland, Queensland         Cleveland, Qld, 4163
AUSTRALIA                                    AUSTRALIA

Telephone: +61 7 3826 7251     Email: Bill.Venables@cmis.csiro.au     
      Fax: +61 7 3826 7304
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From novo@uiuc.edu  Fri Sep 24 02:49:17 1999
From: novo@uiuc.edu (Alvaro A. Novo)
Date: Thu, 23 Sep 1999 20:49:17 -0500
Subject: analysis of multivariate normal (missing values)
Message-ID: <99092320592900.04464@friedman>

Hi,

I could not find an R package for the analysis of multivariate normal
datasets with missing values. Prof. Joseph Schafer has created an S+ library
(norm) that does such type of analysis, which I now ported to R. 

I guess that I should have asked here if there are other people working on
such project, before I actually ported it, but... If such package has not been
ported, I will upload the package (norm, original name) anytime soon.
Please let me know if you are working on such project.

Thank you,

Alvaro A. Novo


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Sep 24 09:58:46 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 24 Sep 1999 10:58:46 +0200
Subject: R's startup : .Rprofile & .Renviron  -- info and RFC
Message-ID: <199909240858.KAA04862@sophie.ethz.ch>

		[RFC = Request for Comments]

{ Yes, the documentation for .Renviron is really not there (but the FAQ...);
  the rest is in ?Startup }

In R's Startup (on Unix only??) {unless --no-environ is specified}
 ~/.Renviron (if there) is read as an 'sh' script before R is called,

then R looks ((for the site-wide Rprofile and then))
for .Rprofile in the current directory and then for ~/.Rprofile
(in the user's home directory).

I'd like to set R_NSIZE and R_VSIZE ``project dependent'' automatically,
and therefore would like  .Renviron also searched in the currenct directory
before the $HOME directory.
(setting --nsize or --vsize explicitly would always override as they
should).

Is this desired?  

Is is portable (at least) to Windows?
In the windows FAQ I've learnt that you must set the command line
arguments --nsize ..  when defining a shortcut to the R executable
in the corresponding directory (correct?).
Is this *the* windows way or does is make sense to have .Renviron files
($HOME would only be used on NT, I presume ?
	-- yes, I am a complete ``Wingnorant'' !)

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Sep 24 11:07:40 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 24 Sep 1999 11:07:40 +0100 (BST)
Subject: R's startup : .Rprofile & .Renviron  -- info and RFC
In-Reply-To: <199909240858.KAA04862@sophie.ethz.ch>
Message-ID: <Pine.GSO.4.05.9909241053250.13755-100000@auk.stats>

On Fri, 24 Sep 1999, Martin Maechler wrote:

> 		[RFC = Request for Comments]
> 
> { Yes, the documentation for .Renviron is really not there (but the FAQ...);
>   the rest is in ?Startup }
> 
> In R's Startup (on Unix only??) {unless --no-environ is specified}
>  ~/.Renviron (if there) is read as an 'sh' script before R is called,

On Windows it is read as a set of NAME=VALUE statements.

> then R looks ((for the site-wide Rprofile and then))
> for .Rprofile in the current directory and then for ~/.Rprofile
> (in the user's home directory).
> 
> I'd like to set R_NSIZE and R_VSIZE ``project dependent'' automatically,
> and therefore would like  .Renviron also searched in the currenct directory
> before the $HOME directory.
> (setting --nsize or --vsize explicitly would always override as they
> should).
> 
> Is this desired?  
> 
> Is is portable (at least) to Windows?

Yes, no problem. 

> In the windows FAQ I've learnt that you must set the command line
> arguments --nsize ..  when defining a shortcut to the R executable
> in the corresponding directory (correct?).
> Is this *the* windows way or does is make sense to have .Renviron files
> ($HOME would only be used on NT, I presume ?

Sorry, I don't see that as the only way in the rw-FAQ, but I do see how to
use .Renviron under Q2.2.

The current position is:

R figures out a value for R_USER.
It (effectively) reads its environment
It then reads R_USER/.Renviron as NAME=VALUE pairs
It then reads NAME=VALUE pairs off the command line.
It then processes --nsize etc.

The algorithm for R_USER is

If set, use it.
Else if HOME is set, use that (it normally is not).
Else if HOMEDRIVE and HOMEPATH are set (they usually are on NT) use
 HOMEDRIVE\HOMEPATH (the docs have this wrong, I see).
Else use the startup directory.

All we would need is to look for ./.Renviron then R_USER/.Renviron.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From rossini@biostat.washington.edu  Fri Sep 24 14:54:25 1999
From: rossini@biostat.washington.edu (A.J. Rossini)
Date: 24 Sep 1999 06:54:25 -0700
Subject: analysis of multivariate normal (missing values)
In-Reply-To: "Alvaro A. Novo"'s message of "Thu, 23 Sep 1999 20:49:17 -0500"
References: <99092320592900.04464@friedman>
Message-ID: <871zbojtym.fsf@alpha.cfas.washington.edu>



I've ported it as well, (and Shafer's other two) but havn't managed to
finish the job (and package it) -- if you cleaned up the Fortran
problems, up load it!  (provided no one else has...).

best,
-tony

>>>>> "AAN" == Alvaro A Novo <novo@uiuc.edu> writes:

    AAN> Hi, I could not find an R package for the analysis of
    AAN> multivariate normal datasets with missing
    AAN> values. Prof. Joseph Schafer has created an S+ library (norm)
    AAN> that does such type of analysis, which I now ported to R.

    AAN> I guess that I should have asked here if there are other
    AAN> people working on such project, before I actually ported it,
    AAN> but... If such package has not been ported, I will upload the
    AAN> package (norm, original name) anytime soon.  Please let me
    AAN> know if you are working on such project.

    AAN> Thank you,

    AAN> Alvaro A. Novo


    AAN> -.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
    AAN> r-devel mailing list -- Read
    AAN> http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html Send "info",
    AAN> "help", or "[un]subscribe" (in the "body", not the subject !)
    AAN> To: r-devel-request@stat.math.ethz.ch
    AAN> _._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Kurt.Hornik@ci.tuwien.ac.at  Fri Sep 24 15:13:51 1999
From: Kurt.Hornik@ci.tuwien.ac.at (Kurt Hornik)
Date: Fri, 24 Sep 1999 16:13:51 +0200 (CEST)
Subject: Private data libraries (idea & trick)
In-Reply-To: <x2iu5388wk.fsf@blueberry.kubism.ku.dk>
References: <x2iu5388wk.fsf@blueberry.kubism.ku.dk>
Message-ID: <14315.34591.572539.50534@fangorn.ci.tuwien.ac.at>

>>>>> Peter Dalgaard BSA writes:

> It has been annoying me for a while that data in user areas are more
> difficult to handle than those in the packages. 

> Especially for beginners, it would be very handy to be able just to
> say "data(mydata)", rather than
> "mydata<-read.table('mydata.txt',header=T)"

> What just occurred to me was that the following hack actually works:

> Type

> library('.',lib.loc='.')

> and everything in ./data behaves as if it were in a package. 

> Another interesting hack is that one can do this:

> [pd@blueberry data]$ cat > file.txt
> a b
> 1 2
> 3 4
> [pd@blueberry data]$ cat > file.R
> file<-transform(read.table('file.txt',header=T),
>     b=factor(b,levels=1:4,labels=letters[1:4]))

> and then from inside R, get the dataframe with factor recoding and
> everything as

>> data(file)
>> file
>   a b
> 1 1 b
> 2 3 d

> Question: Should we perhaps clean this up a little and formalize it?

Actually, this works in directories different from the current one as
well, as the working directory is changed temporarily.  However, someone
pointed out that this is not thread-safe, so we should be careful about
announcing this feature.

-k
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Fri Sep 24 15:29:44 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 24 Sep 1999 16:29:44 +0200
Subject: Private data libraries (idea & trick)
In-Reply-To: Kurt Hornik's message of "Fri, 24 Sep 1999 16:13:51 +0200 (CEST)"
References: <x2iu5388wk.fsf@blueberry.kubism.ku.dk> <14315.34591.572539.50534@fangorn.ci.tuwien.ac.at>
Message-ID: <x2iu508js7.fsf@blueberry.kubism.ku.dk>

Kurt Hornik <Kurt.Hornik@ci.tuwien.ac.at> writes:

> >>>>> Peter Dalgaard BSA writes:
...
> >> data(file)
> >> file
> >   a b
> > 1 1 b
> > 2 3 d
> 
> > Question: Should we perhaps clean this up a little and formalize it?
> 
> Actually, this works in directories different from the current one as
> well, as the working directory is changed temporarily. 

Yes. Actually it relies on it because file.{R,txt} would be in ./data

> However, someone
> pointed out that this is not thread-safe, so we should be careful about
> announcing this feature.

Er, didn't that just mean that the CWD would have to be yet another
per-thread item, or source() would have to block other threads for the
duration? Would seem a bit silly to have a chdir option and not be
allowed to use it...

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Sep 24 15:50:07 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 24 Sep 1999 15:50:07 +0100 (BST)
Subject: argument PACKAGE in .C/.Fortran
Message-ID: <Pine.GSO.4.05.9909241537230.27548-100000@auk.stats>

One problem with linking compiled code is getting the symbol from the right
shared library/DLL (hereafter DLL). This actually happened to Guido
Masarotto recently: both leaps and ts had "ss", and leaps got ts's
version (and thereby crashed R).

We have added an argument PACKAGE to .C, .Fortran, .Call and .External,
which confines the symbol search to the named DLL (name without extension).
This in today's R-release, but it is backwards compatible if used as the
last argument (one surplus argument does no harm).  We would like to
encourage package writers to make use of it: R's own code now does.

For future reference, especially for porting projects, tomorrow's version
of R-release also allows passing float/REAL arguments to and from
.C/.Fortran, and has handling of Fortran character strings that
actually works on all the systems I have access to.

Brian Ripley

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Fri Sep 24 18:02:00 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Fri, 24 Sep 1999 19:02:00 +0200
Subject: RFC: enhancement for sapply() : do.names
Message-ID: <199909241702.TAA12166@sophie.ethz.ch>

Among other uses of  sapply(), I use to use it for 
"analyzing" / "summarizing" components of a list or to `summarize' objects
in my search path,
typically such as

sapply(obj.names, function(n){ r <- get(n); unlist(r[c("x","y","par")]) })

which gives a list or a 3-col matrix (depending if "x", "y","par" have always
same length..) that has no (row)names unfortunately, even though it's clear
that I would want my initial names...

  for(n in 1:3) 
	  assign(paste("o",n,sep=""), list(x=n,y=n^2,par=n/4))
  (obj.n <- paste("o",1:3,sep=""))
  sapply(obj.n, function(n){ unlist(get(n)[c("x","y","par")]) })

which gives

	[,1] [,2] [,3]
    x   1.00  2.0 3.00
    y   1.00  4.0 9.00
    par 0.25  0.5 0.75

but I would want

	  o1  o2   o3
    x   1.00 2.0 3.00
    y   1.00 4.0 9.00
    par 0.25 0.5 0.75

----
I can get this with the following patch :

--- sapply.R	1999/01/29 17:39:28	1.3
+++ sapply.R	1999/09/24 16:12:53
@@ -1,8 +1,10 @@
-sapply <- function(X, FUN, ..., simplify = TRUE)
+sapply <- function(X, FUN, ..., simplify = TRUE, do.names = TRUE)
 {
     FUN <- match.fun(FUN)
-
     answer <- lapply(as.list(X), FUN, ...)
+    if(do.names && is.null(names(answer))) { # create names if sensible
+        if(is.character(X)) names(answer) <- X
+    }
     if(simplify && length(answer) &&
        length(common.len <- unique(unlist(lapply(answer, length)))) == 1) {
 	if(common.len == 1)

---------------

Now, before implementing this:

1) is "do.names" proper naming or should we rather use
	"DO.NAMES", "USE.NAMES", ...
   (at the moment, I'd prefer  USE.NAMES)


2) Inside the new  if(do.names ....) { .... }  clause, 
   we can try harder, e.g.,

  if(do.names && is.null(names(answer))) { # create names if sensible
	names(answer) <- 
	    if(is.character(X)) X  else  abbreviate(deparse(substitute(X)))
  }

   - actually this wouldn't always work as desired;  
     `substitute(X)' would have to be saved
     before the first use of X ( evaluation of expressions...)
   - In that case, do.names (or USE.NAMES) should probably have
     the default  is.character(X)  -- for efficiency & back-compatibility

Opinions?

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Fri Sep 24 19:53:07 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Fri, 24 Sep 1999 19:53:07 +0100 (BST)
Subject: R's startup : .Rprofile & .Renviron  -- info and RFC
In-Reply-To: <199909240858.KAA04862@sophie.ethz.ch>
Message-ID: <Pine.GSO.4.05.9909241949210.27899-100000@auk.stats>

On Fri, 24 Sep 1999, Martin Maechler wrote:

> 		[RFC = Request for Comments]
> 
> { Yes, the documentation for .Renviron is really not there (but the FAQ...);
>   the rest is in ?Startup }
> 
> In R's Startup (on Unix only??) {unless --no-environ is specified}
>  ~/.Renviron (if there) is read as an 'sh' script before R is called,
> 
> then R looks ((for the site-wide Rprofile and then))
> for .Rprofile in the current directory and then for ~/.Rprofile
> (in the user's home directory).
> 
> I'd like to set R_NSIZE and R_VSIZE ``project dependent'' automatically,
> and therefore would like  .Renviron also searched in the currenct directory
> before the $HOME directory.
> (setting --nsize or --vsize explicitly would always override as they
> should).
> 
> Is this desired?  

It seems done on Unix, so now on Windows too, if not committed yet.

You had been worried, but all the info is in the Windows README. However,
I had got HOMEDRIVE as HOMEDIR, so thank you getting me to re-read it!

Brian

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From oka@debian.or.jp  Sat Sep 25 18:16:05 1999
From: oka@debian.or.jp (oka@debian.or.jp)
Date: Sat, 25 Sep 1999 19:16:05 +0200 (MET DST)
Subject: segmentation fault in R (PR#286)
Message-ID: <199909251716.TAA20918@pubhealth.ku.dk>


Hi,

  c(1,2,3) %*% c(1,2,3)[drop=TRUE]

or

  c(1,2,3) %*% c(1,2,3)[drop=FALSE]

caused segmentation fault.

--please do not edit the information below--

Version:
 platform = i686-unknown-linux
 arch = i686
 os = linux
 system = i686, linux
 status = 
 status.rev = 0
 major = 0
 minor = 65.0
 year = 1999
 month = August
 day = 27
 language = R

Search Path:
 .GlobalEnv, Autoloads, package:base

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Sat Sep 25 19:01:47 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Sat, 25 Sep 1999 20:01:47 +0200 (MET DST)
Subject: segmentation fault in R (PR#286)
Message-ID: <199909251801.UAA20977@pubhealth.ku.dk>

On Sat, 25 Sep 1999 oka@debian.or.jp wrote:

>   c(1,2,3) %*% c(1,2,3)[drop=TRUE]
> 
> or
> 
>   c(1,2,3) %*% c(1,2,3)[drop=FALSE]
> 
> caused segmentation fault. < 0.65.0, Linux >

We are very grateful to Martin Maechler for working hard on tracking down
many such things. In the current R-release it reports (as it should)

> c(1,2,3) %*% c(1,2,3)[drop=TRUE]
Error in c(1, 2, 3)[drop = TRUE] : no index specified

Thank you for your report.

[... system details]

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Mon Sep 27 08:52:15 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Mon, 27 Sep 1999 09:52:15 +0200
Subject: boxplot()'s return value names
Message-ID: <199909270752.JAA01756@sophie.ethz.ch>

Something worth discussing,

I think these output names  NEED  a change :

    > boxplot(rt(250,df=3), plot=F)
    $"1"
    $"1"$stats
    [1] -2.7995357 -0.7170382  0.1109581  0.8426811  3.0483316

    $"1"$n
    [1] 250

    $"1"$conf
    [1] -0.04490152  0.26681765

    $"1"$out
     [1]  5.784389  4.766206 -3.932449 -3.460407 -3.695599  5.486126 -3.141079
     [8]  4.484507 12.731848  3.867611  4.040786  4.137455  3.772149  7.693779
    [15] -3.431560  3.860079 -4.087880  3.766799  4.497379 -3.543726 -6.196635
    [22] -6.322201

- "1" should rather be 1

and

 str(boxplot(data.frame(x=1:10,y=rt(10,df=4)),plot=F))

List of 2
 $ x:List of 4
  ..$ stats: num [1:5] 1 3 5.5 8 10
  ..$ n    : int 10
  ..$ conf : num [1:2] 3 8
  ..$ out  : int(0) 
 $ y:List of 4
  ..$ stats: num [1:5] -1.4097  0.0251  0.4533  1.0871  1.4427
  ..$ n    : int 10
  ..$ conf : num [1:2] -0.0774  0.9840
  ..$ out  : num(0) 
 - attr(*, "row.names")= chr [1:10] "1" "2" "3" "4" "5" "6" "7" "8" "9" "10"

where the `trailing'  "row.names" attribute seems *very* unnecessary.

{I'm in a hurry..}


-- 
Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From maechler@stat.math.ethz.ch  Mon Sep 27 10:12:21 1999
From: maechler@stat.math.ethz.ch (maechler@stat.math.ethz.ch)
Date: Mon, 27 Sep 1999 11:12:21 +0200 (MET DST)
Subject: text( col=, cex=, font=) : doesn't allow more than length-1 arg (PR#287)
Message-ID: <199909270912.LAA27339@pubhealth.ku.dk>


text(..., col = <..>)   doesn't work if col has length more than one;

and the same for 'cex' and 'font'

A toy example, showing what is desired

plot(1);text(1.2, .8+(0:5)/16, LETTERS[6:1])
## works alright

plot(1);text(1.2, .8+(0:5)/16, LETTERS[6:1],col=1:6)
##>>> Error in par(args) : parameter "col" has the wrong length

---
Explanation:
The source code is in  src/main/plot.c  in do_text(),
and from reading it, "col" (& "cex" & "font") are extracted via GetPar()
(and later would nicely be recycled).
HOWEVER, the ProcessInlinePars() called after the three GetPar() gives the
error message, because "col" (cex, or font) are still part of the `args'
list.

All boils down to the FIXME part of the following description of
GetPar() [around line 120 in plot.c] :

/* GetPar is intended for looking through a list  -- typically that bound
 *	to ... --  for a particular parameter value.  This is easier than
 *	trying to match every graphics parameter in argument lists explicitly.
 * FIXME: This needs to be destructive, so that "ProcessInlinePars"
 *	can be safely called afterwards.
 */

PLEASE, can we fix this!

Idea: don't shorten the `parlist' argument of GetPar(), 
      for efficiency.
Just set the TAG to "", such that it will be disregarded subsequently,
i.e., do something like

SEXP GetPar(char *which, SEXP parlist)
{
    SEXP w, p;
    w = install(which);
    for (p = parlist; p != R_NilValue; p = CDR(p)) {
	if (TAG(p) == w) {
 NEW>>>	    TAG(p) == mkString("");
	    return CAR(p);
	}
    }
    return R_NilValue;
}

	  

-- 
Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Mon Sep 27 11:18:52 1999
From: J.C.Rougier@durham.ac.uk (Jonathan Rougier)
Date: Mon, 27 Sep 1999 11:18:52 +0100 (BST)
Subject: chol() dimnames
Message-ID: <Pine.GSO.3.96.990927110820.382H-100000@laplace>

Hi Everyone,

Just a minor point, but could chol() be changed to include the dimnames of
the original matrix?  This will ensure that x and t(R) %*% R have the same
dimnames, where R <- chol(x).  So we just need to insert

    if (!is.null(dx <- dimnames(x))) 
        dimnames(z$v) <- dx

ahead of the return.  Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Sep 27 12:25:05 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 27 Sep 1999 12:25:05 +0100 (BST)
Subject: chol() dimnames
Message-ID: <199909271125.MAA07858@toucan.stats.ox.ac.uk>


> Date: Mon, 27 Sep 1999 11:18:52 +0100 (BST)
> From: Jonathan Rougier <J.C.Rougier@durham.ac.uk>
> To: r-devel@stat.math.ethz.ch
> Subject: chol() dimnames
> 
> Hi Everyone,
> 
> Just a minor point, but could chol() be changed to include the dimnames of
> the original matrix?  This will ensure that x and t(R) %*% R have the same
> dimnames, where R <- chol(x).  So we just need to insert
> 
>     if (!is.null(dx <- dimnames(x))) 
>         dimnames(z$v) <- dx
> 
> ahead of the return.  Cheers, Jonathan.

This is a picky comment, but maybe we should try to get this spot on.

(i) Suppose that the row and column names of x are different? Which should
one use?

(ii) I don't think that R has any obvious row names: effectively this is
a linear transformation to a different and unamed basis for the space.

I believe all one actually knows is that the colnames of R should be the
colnames of x, if the row and column names of x match. However, the 
prototype does preserve the names.  Should we just preserve the colnames?


-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Sep 27 13:03:52 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Sep 1999 14:03:52 +0200
Subject: chol() dimnames
In-Reply-To: Prof Brian Ripley's message of "Mon, 27 Sep 1999 12:25:05 +0100 (BST)"
References: <199909271125.MAA07858@toucan.stats.ox.ac.uk>
Message-ID: <x2905s8st3.fsf@blueberry.kubism.ku.dk>

Prof Brian Ripley <ripley@stats.ox.ac.uk> writes:

> I believe all one actually knows is that the colnames of R should be the
> colnames of x, if the row and column names of x match. However, the 
> prototype does preserve the names.  Should we just preserve the colnames?

That would make OK sense to me. By assumption X == t(X) so if it doesn't
have the same row and column names, something is wrong anyway and we
can do whatever we please to fix things up.

However: Somewhere in the back of my mind lies a note to the effect
that chol() should really handle the rank-deficient cases better, via
some sort of pivoting. Will this muck things up (possibly not if it
only removes singularities and plugs in rows/cols of zeroes)? I seem to
recall that the current chol() got lme() in trouble. I got as far as
locating the candidate replacement for chol.f on Netlib and then got
away from it.

Currently, we get

> z<-matrix(rnorm(15),3,5)
> x<-t(z)*z
> chol(x)
Error: singular matrix in chol

The prototype (Splus 3.4) handles this a bit better:
> chol(x)
         [,1]      [,2]        [,3]          [,4]          [,5] 
[1,] 1.703739 1.9199843 -0.94401977 -1.129732e+00 -8.387157e-01
[2,] 0.000000 0.7605888  0.08437014  8.385107e-01 -2.259906e-01
[3,] 0.000000 0.0000000  0.86549993  7.381480e-01  5.811783e-01
[4,] 0.000000 0.0000000  0.00000000 -7.771561e-16  1.110223e-16
[5,] 0.000000 0.0000000  0.00000000  0.000000e+00  0.000000e+00
attr(, "rank"):
[1] 3
Warning messages:
  Choleski decomposition not of full rank in: chol(x)

It also allows pivoting, but I don't think we want their algorithm:

> chol(x,piv=T)
         [,1]       [,2]       [,3]          [,4]          [,5] 
[1,] 2.065148 -0.7414994 -0.8465894  1.583980e+00 -8.629924e-01
[2,] 0.000000  1.4051462  0.8172503 -5.339291e-01  3.893657e-01
[3,] 0.000000  0.0000000  0.5126111  3.296278e-01  4.426312e-01
[4,] 0.000000  0.0000000  0.0000000  2.107342e-08  5.268356e-09
[5,] 0.000000  0.0000000  0.0000000  0.000000e+00  7.850462e-17
attr(, "pivot"):
[1] 2 4 3 1 5
attr(, "rank"):
[1] 5
    ^
    !
oops....


-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Jonathan Rougier <J.C.Rougier@durham.ac.uk>  Mon Sep 27 13:02:39 1999
From: Jonathan Rougier <J.C.Rougier@durham.ac.uk> (Jonathan Rougier)
Date: Mon, 27 Sep 1999 13:02:39 +0100 (BST)
Subject: chol() dimnames
In-Reply-To: <199909271125.MAA07858@toucan.stats.ox.ac.uk>
Message-ID: <Pine.GSO.3.96.990927122553.382I-100000@laplace>

Hi Brian,

On Mon, 27 Sep 1999, Prof Brian Ripley wrote:

> This is a picky comment, but maybe we should try to get this spot on.

> (i) Suppose that the row and column names of x are different? Which should
> one use?
>
> (ii) I don't think that R has any obvious row names: effectively this is
> a linear transformation to a different and unamed basis for the space.
> 
> I believe all one actually knows is that the colnames of R should be the
> colnames of x, if the row and column names of x match. However, the 
> prototype does preserve the names.  Should we just preserve the colnames?

I think your qualms would be answered if the attribution of dimnames was
only made in the event that x has matching row and column names.  Whether
just the column names should be preserved in this case is a moot point.
But you might imagine a cautious programmer wanting to be sure that the
row names of Q correspond with the row names of some other matrix A in the
calculation t(Q) %*% A.  Preserving the row names doesn't do any harm, and
it might just be helpful.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From J.C.Rougier@durham.ac.uk  Mon Sep 27 13:10:26 1999
From: J.C.Rougier@durham.ac.uk (Jonathan Rougier)
Date: Mon, 27 Sep 1999 13:10:26 +0100 (BST)
Subject: chol() dimnames
In-Reply-To: <x2905s8st3.fsf@blueberry.kubism.ku.dk>
Message-ID: <Pine.GSO.3.96.990927130308.382J-100000@laplace>

Hi Peter,

> However: Somewhere in the back of my mind lies a note to the effect
> that chol() should really handle the rank-deficient cases better, via
> some sort of pivoting.

I agree completely.  I have an ugly patch to catch the case where zeros
appear on the diagonal but a pivoting flag to handle the semi-definite
case and more generally to improve the performance of the algorithm would
be a big help.

Cheers, Jonathan.

Jonathan Rougier                       Science Laboratories
Department of Mathematical Sciences    South Road
University of Durham                   Durham DH1 3LE

"[B]egin upon the precept ... that the things we see are to be 
 weighed in the scale with what we know"  (Meredith, 1879, The Egoist)

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From bates@stat.wisc.edu  Mon Sep 27 13:44:15 1999
From: bates@stat.wisc.edu (Douglas Bates)
Date: 27 Sep 1999 07:44:15 -0500
Subject: chol() dimnames
In-Reply-To: Peter Dalgaard BSA's message of "27 Sep 1999 14:03:52 +0200"
References: <199909271125.MAA07858@toucan.stats.ox.ac.uk> <x2905s8st3.fsf@blueberry.kubism.ku.dk>
Message-ID: <6rbtao34o0.fsf@franz.stat.wisc.edu>

Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk> writes:

> However: Somewhere in the back of my mind lies a note to the effect
> that chol() should really handle the rank-deficient cases better, via
> some sort of pivoting. Will this muck things up (possibly not if it
> only removes singularities and plugs in rows/cols of zeroes)? I seem to
> recall that the current chol() got lme() in trouble. 

I believe the trouble there was not due to R's chol not handling the
semi-definite case.  (Sorry about the double negative.)  I think it is
because internally chol is called differently than in S.  We have code
like

#ifdef R_S_H
	  F77_CALL(chol)(auxRes, &ncol, &ncol, auxRes, &l);
#else
	  F77_CALL(chol)(auxRes, &ncol, res, &zero, &zero, &l);
#endif /* R_S_H */

in the C code that implements lme.

I believe there is a pivoting option available for the Linpack dchdc
routine but not for the dpodc routine.  (My copy of the manual is at
the office so I can't check this.)  That pivoting is similar to the
pivoting in dqrdc - you specify which columns (and the corresponding
rows in the case of dchdc) are available to be re-ordered and it
re-orders everything in the optimal ordering.  This doesn't work well
for model matrices or quantities derived from model matrices where you
want to keep the columns associated with the same terms adjacent if
possible.

Notice that in your example the diagonal elements of the decomposition
are strictly decreasing after pivoting.  That is what I mean by the
optimal ordering.

> > chol(x,piv=T)
>          [,1]       [,2]       [,3]          [,4]          [,5] 
> [1,] 2.065148 -0.7414994 -0.8465894  1.583980e+00 -8.629924e-01
> [2,] 0.000000  1.4051462  0.8172503 -5.339291e-01  3.893657e-01
> [3,] 0.000000  0.0000000  0.5126111  3.296278e-01  4.426312e-01
> [4,] 0.000000  0.0000000  0.0000000  2.107342e-08  5.268356e-09
> [5,] 0.000000  0.0000000  0.0000000  0.000000e+00  7.850462e-17
> attr(, "pivot"):
> [1] 2 4 3 1 5
> attr(, "rank"):
> [1] 5
>     ^
>     !
> oops....
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Mon Sep 27 14:58:46 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 27 Sep 1999 15:58:46 +0200
Subject: chol() dimnames
In-Reply-To: Douglas Bates's message of "27 Sep 1999 07:44:15 -0500"
References: <199909271125.MAA07858@toucan.stats.ox.ac.uk> <x2905s8st3.fsf@blueberry.kubism.ku.dk> <6rbtao34o0.fsf@franz.stat.wisc.edu>
Message-ID: <x2670w8nhl.fsf@blueberry.kubism.ku.dk>

Douglas Bates <bates@stat.wisc.edu> writes:

> I believe there is a pivoting option available for the Linpack dchdc
> routine but not for the dpodc routine.  (My copy of the manual is at
> the office so I can't check this.)  That pivoting is similar to the
> pivoting in dqrdc - you specify which columns (and the corresponding
> rows in the case of dchdc) are available to be re-ordered and it
> re-orders everything in the optimal ordering.  This doesn't work well
> for model matrices or quantities derived from model matrices where you
> want to keep the columns associated with the same terms adjacent if
> possible.

Exactly, dchdc was the one I had been thinking of too. I don't really
see the problem in the reordering, though. Just put things back in
order afterwards? However, the column locking feature doesn't seem too
useful to me.

> 
> Notice that in your example the diagonal elements of the decomposition
> are strictly decreasing after pivoting.  That is what I mean by the
> optimal ordering. 

Yup. Although there are some obvious scaling issues that makes the
optimality a bit dubious (such as when you change the units on a
regressor from uM to M).

There's a variation of Cholesky where you essentially just put a zero
in the diagonal in case of singularity and proceed with the remainder
of the matrix, but noone seems to implement that.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Prof Brian Ripley <ripley@stats.ox.ac.uk>  Mon Sep 27 16:37:57 1999
From: Prof Brian Ripley <ripley@stats.ox.ac.uk> (Prof Brian Ripley)
Date: Mon, 27 Sep 1999 16:37:57 +0100 (BST)
Subject: chol() dimnames
Message-ID: <199909271537.QAA15954@toucan.stats.ox.ac.uk>

> From: Peter Dalgaard BSA <p.dalgaard@biostat.ku.dk>
> Date: 27 Sep 1999 15:58:46 +0200
> 
> There's a variation of Cholesky where you essentially just put a zero
> in the diagonal in case of singularity and proceed with the remainder
> of the matrix, but noone seems to implement that.

src/appl/uncmin has a choldc that is some variation of that sort.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From caves@yorvic.york.ac.uk  Tue Sep 28 09:30:55 1999
From: caves@yorvic.york.ac.uk (caves@yorvic.york.ac.uk)
Date: Tue, 28 Sep 1999 10:30:55 +0200 (MET DST)
Subject: configure bug with IRIX 6.5 (Makedep) (PR#288)
Message-ID: <199909280830.KAA07916@pubhealth.ku.dk>

Full_Name: Leo Caves
Version: 0.65.0
OS: SGI/IRIX 6.5
Submission from: (NULL) (144.32.72.76)


using default configure under SGI/IRIX 6.5.
(I switched to gnumake, after initial problems, this might not be necesssary).

the make rule for creating dependencies is wrong for the SGI C compiler.
The rule assumes that cc -M file.c -o file.d works (it doesn't).
One needs to explicitly capture stdout to grab the dependencies:
i.e. cc -M file.c > file.d

simple as that.

when I run tests, there are 2 errors reported

1/ in print-tests.R
(printing *very* small numbers with the statement:)
> cat("dig|  formatC(signif(txn, d=dig)\n")
dig|  formatC(signif(txn, d=dig)
> for(dig in 1:14)#15: Linux 2.1.120, libc-2.0.7 differs from Debian 2.0
+     cat(formatC(dig,w=2), formatC(signif(txn, d=dig), dig=dig+2,
wid=-20),"\n")

Where the blessed version has 0 (zero), the SGI version shows 2.e-308

This looks pretty benign and is flagged in the test script as dependent on
specific libraries etc under linux.

2/ in simple-tests.R
(comparing numbers at limit of word precision)
abs(1- .Machine$double.xmax * 10^(-.Machine$double.max.exp*log10(2)))/Meps <
1e3

This statement returns F instead of T.

This may have effects in pathological cases, but doesn't seem to be a
show-stopper.

So, it looks like a kosher build under SGI/IRIX 6.5.

*Many thanks* for a great system.
Leo
(vanilla AT&T S user since 1991)



-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Sep 28 15:44:52 1999
From: ripley@stats.ox.ac.uk (ripley@stats.ox.ac.uk)
Date: Tue, 28 Sep 1999 16:44:52 +0200 (MET DST)
Subject: Collating sequences are used inconsistently. (PR#289)
Message-ID: <199909281444.QAA14157@pubhealth.ku.dk>

R 0.65.0 (and all others I have seen), Solaris 2.6.

> sort(c("a", "A", "b", "B"))
[1] "A" "a" "B" "b"
> "a" < "B"
[1] FALSE

in the en_UK locale. I don't think it is good idea that sort and <
have a different idea of ordering, so I rate this as a bug. As far as I can
see sort uses strcoll and hence the locale, and < uses ASCII.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From p.dalgaard@biostat.ku.dk  Tue Sep 28 16:13:17 1999
From: p.dalgaard@biostat.ku.dk (Peter Dalgaard BSA)
Date: 28 Sep 1999 17:13:17 +0200
Subject: Collating sequences are used inconsistently. (PR#289)
In-Reply-To: ripley@stats.ox.ac.uk's message of "Tue, 28 Sep 1999 16:44:52 +0200 (MET DST)"
References: <199909281444.QAA14157@pubhealth.ku.dk>
Message-ID: <x2905rt6gi.fsf@blueberry.kubism.ku.dk>

ripley@stats.ox.ac.uk writes:

> R 0.65.0 (and all others I have seen), Solaris 2.6.
> 
> > sort(c("a", "A", "b", "B"))
> [1] "A" "a" "B" "b"
> > "a" < "B"
> [1] FALSE
> 
> in the en_UK locale. I don't think it is good idea that sort and <
> have a different idea of ordering, so I rate this as a bug. As far as I can
> see sort uses strcoll and hence the locale, and < uses ASCII.

Agreed. I did a i quick runover of all uses of strcmp in the code, and it
seems that the sign only gets used in two files, relop.c (4 times)
and in gnuwin32/dynload.c. The latter one is in a binary search of the
symbol table, which I'll assume is in ASCII order...

I'll make the changes to relop.c if you haven't done so already.

-- 
   O__  ---- Peter Dalgaard             Blegdamsvej 3  
  c/ /'_ --- Dept. of Biostatistics     2200 Cph. N   
 (*) \(*) -- University of Copenhagen   Denmark      Ph: (+45) 35327918
~~~~~~~~~~ - (p.dalgaard@biostat.ku.dk)             FAX: (+45) 35327907
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Tue Sep 28 17:23:24 1999
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Tue, 28 Sep 1999 18:23:24 +0200
Subject: read.fwf, perl on win
Message-ID: <37F0EB7C.560D18AC@univie.ac.at>

i just used read.fwf
(which calls perl)
and i noticed something.

i also have mat;lab installed on this machine,
and matlab also installs a version of perl,
but a different one.
additionally, matlab puts its bin directory in the system
path. so, if one does not canerully set the path,
r will call the matlab verion of perl,
and things won't work.

if anybody is collection a list of pitfalls,
this probably should go there.


--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Tue Sep 28 18:19:54 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Tue, 28 Sep 1999 18:19:54 +0100 (BST)
Subject: read.fwf, perl on win
In-Reply-To: <37F0EB7C.560D18AC@univie.ac.at>
Message-ID: <Pine.GSO.4.05.9909281813250.28124-100000@auk.stats>

On Tue, 28 Sep 1999, Erich Neuwirth wrote:

> i just used read.fwf
> (which calls perl)
> and i noticed something.
> 
> i also have mat;lab installed on this machine,
> and matlab also installs a version of perl,
> but a different one.
> additionally, matlab puts its bin directory in the system
> path. so, if one does not canerully set the path,
> r will call the matlab verion of perl,
> and things won't work.

That's horrible! There is an official current Perl, and that
works for R, so I presume that Matlab has an outdated one (Perl 4 ?)
Do you know what version Matlab uses?

One thing we can do is to put a require 5.001; or whatever in the
script.

This will apply on binary Unix distributions too, I assume.

> if anybody is collection a list of pitfalls,
> this probably should go there.

With n packages there seem to be n^2 interactions.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Tue Sep 28 21:14:09 1999
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Tue, 28 Sep 1999 22:14:09 +0200
Subject: read.fwf, perl on win
References: <Pine.GSO.4.05.9909281813250.28124-100000@auk.stats>
Message-ID: <37F12191.187930C5@univie.ac.at>

here is the version information.
one of the problems i noticed is that
libraries seem to be different.
i had an error because
perl called 
getopt.pl,
and the library module was called
getopts.pl

since i changed my path so the official perl
from www.perl.org is found first,
things work.



-=-=-=-=-=-=-=-
This is perl, version 5.003_07

Copyright 1987-1996, Larry Wall

        + suidperl security patch
        Win32 port Copyright (c) 1995-1996 Microsoft Corporation.
                All rights reserved.
        Developed by ActiveWare Internet Corp.,
http://www.ActiveWare.com

Perl for Win32 Build 307 - Built 10:11:54 Jul 15 1997

Perl may be copied only under the terms of either the Artistic License
or the
GNU General Public License, which may be found in the Perl 5.0 source
kit.


Prof Brian D Ripley wrote:
> 
> On Tue, 28 Sep 1999, Erich Neuwirth wrote:
> 
> > i just used read.fwf
> > (which calls perl)
> > and i noticed something.
> >
> > i also have mat;lab installed on this machine,
> > and matlab also installs a version of perl,
> > but a different one.
> > additionally, matlab puts its bin directory in the system
> > path. so, if one does not canerully set the path,
> > r will call the matlab verion of perl,
> > and things won't work.
> 
> That's horrible! There is an official current Perl, and that
> works for R, so I presume that Matlab has an outdated one (Perl 4 ?)
> Do you know what version Matlab uses?
> 
> One thing we can do is to put a require 5.001; or whatever in the
> script.
> 
> This will apply on binary Unix distributions too, I assume.
> 
> > if anybody is collection a list of pitfalls,
> > this probably should go there.
> 
> With n packages there seem to be n^2 interactions.
> 
> --
> Brian D. Ripley,                  ripley@stats.ox.ac.uk
> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
> University of Oxford,             Tel:  +44 1865 272861 (self)
> 1 South Parks Road,                     +44 1865 272860 (secr)
> Oxford OX1 3TG, UK                Fax:  +44 1865 272595

--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Wed Sep 29 08:13:58 1999
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Wed, 29 Sep 1999 09:13:58 +0200
Subject: date() in win version
Message-ID: <37F1BC36.37505F29@univie.ac.at>

when i do 
print(date())

the output is
[1] "Wed Sep 29 09:13:04 1999\n"

ios it on purpose the the linfeed is
shown as abbreviation and not done?


--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Sep 29 08:33:57 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 29 Sep 1999 09:33:57 +0200
Subject: date() in win version
In-Reply-To: <37F1BC36.37505F29@univie.ac.at> (message from Erich Neuwirth on
 Wed, 29 Sep 1999 09:13:58 +0200)
References: <37F1BC36.37505F29@univie.ac.at>
Message-ID: <199909290733.JAA04955@sophie.ethz.ch>

>>>>> Erich Neuwirth <erich.neuwirth@univie.ac.at> said:

    Erich> when i do print(date())

    Erich> the output is [1] "Wed Sep 29 09:13:04 1999\n"

    Erich> is it on purpose that the linefeed is shown as abbreviation and
    Erich> not done?

it's not on purpose;  it is a bug that has been fixed even in 0.65.0

Btw, print(.) itself adds a new line;
 but then, why use print() at all?  it is *the default function* 
 { as long as the object hasn't been  invisible()ized },
i.e.
	date()

should be what you want (once you use 0.65.0 or newer..)

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Sep 29 14:57:09 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 29 Sep 1999 15:57:09 +0200
Subject: getenv() can't differentiate  "defined but empty" and "undefined"
Message-ID: <199909291357.PAA15567@sophie.ethz.ch>

getenv(<varname>)  currently returns  ""
if the <varname> is undefined.

However, if <varname> is defined but empty,
getenv(<varname>) still only returns "".

I think this is quite unfortunate  
but consistent with the prototype.

---
I'd propose to change the current behavior.
Something which should be pretty back compatible would 
for the first case (undefined environment variable)
to return "" with an attribute "defined" set to FALSE
i.e.  return(structure("", defined = FALSE))

Does anyone see a problem with this approach ?

Martin Maechler <maechler@stat.math.ethz.ch>	http://stat.ethz.ch/~maechler/
Seminar fuer Statistik, ETH-Zentrum  LEO D10	Leonhardstr. 27
ETH (Federal Inst. Technology)	8092 Zurich	SWITZERLAND
phone: x-41-1-632-3408		fax: ...-1228			<><
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From ripley@stats.ox.ac.uk  Wed Sep 29 15:52:35 1999
From: ripley@stats.ox.ac.uk (Prof Brian D Ripley)
Date: Wed, 29 Sep 1999 15:52:35 +0100 (BST)
Subject: getenv() can't differentiate  "defined but empty" and "undefined"
In-Reply-To: <199909291357.PAA15567@sophie.ethz.ch>
Message-ID: <Pine.GSO.4.05.9909291546210.13114-100000@auk.stats>

On Wed, 29 Sep 1999, Martin Maechler wrote:

> getenv(<varname>)  currently returns  ""
> if the <varname> is undefined.
> 
> However, if <varname> is defined but empty,
> getenv(<varname>) still only returns "".
> 
> I think this is quite unfortunate  
> but consistent with the prototype.
> 
> ---
> I'd propose to change the current behavior.
> Something which should be pretty back compatible would 
> for the first case (undefined environment variable)
> to return "" with an attribute "defined" set to FALSE
> i.e.  return(structure("", defined = FALSE))
> 
> Does anyone see a problem with this approach ?

I think it should really be NULL if undefined: attributes which may or may
not be there are a nuisance.  The only problem I can see is in
system.gnw.r, whihc doe use nchar on getenv.

Small point: when do you want to change this? It is platform-specific code.

-- 
Brian D. Ripley,                  ripley@stats.ox.ac.uk
Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/
University of Oxford,             Tel:  +44 1865 272861 (self)
1 South Parks Road,                     +44 1865 272860 (secr)
Oxford OX1 3TG, UK                Fax:  +44 1865 272595

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Martin Maechler <maechler@stat.math.ethz.ch>  Wed Sep 29 16:52:17 1999
From: Martin Maechler <maechler@stat.math.ethz.ch> (Martin Maechler)
Date: Wed, 29 Sep 1999 17:52:17 +0200
Subject: getenv() can't differentiate  "defined but empty" and "undefined"
In-Reply-To: <Pine.GSO.4.05.9909291546210.13114-100000@auk.stats> (message
 from Prof Brian D Ripley on Wed, 29 Sep 1999 15:52:35 +0100 (BST))
References: <Pine.GSO.4.05.9909291546210.13114-100000@auk.stats>
Message-ID: <199909291552.RAA15706@sophie.ethz.ch>

>>>>> On Wed, 29 Sep 1999 Prof Brian D Ripley <ripley@stats.ox.ac.uk> said:

    BDR> On Wed, 29 Sep 1999, Martin Maechler wrote:
    >> getenv(<varname>) currently returns "" if the <varname> is
    >> undefined.
    >> 
    >> However, if <varname> is defined but empty, getenv(<varname>) still
    >> only returns "".
    >> 
    >> I think this is quite unfortunate but consistent with the prototype.
    >> 
    >> ---
    >> I'd propose to change the current behavior.  Something which should
    >> be pretty back compatible would for the first case (undefined
    >> environment variable) to return "" with an attribute "defined" set
    >> to FALSE i.e.  return(structure("", defined = FALSE))
    >> 
    >> Does anyone see a problem with this approach ?

    BDR> I think it should really be NULL if undefined: attributes which
    BDR> may or may not be there are a nuisance. 

that was my first thought, as well, however ...

    BDR> The only problem I can
    BDR> see is in system.gnw.r, whihc doe use nchar on getenv.

and all the user code from S and R which assumes that getenv() returns 
a character() as it is documented !

    BDR> Small point: when do you want to change this? It is
    BDR> platform-specific code.

 (why does this need to be specific? 
   -- yes I was too lazy to study the code ..)

Martin
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From erich.neuwirth@univie.ac.at  Thu Sep 30 02:36:11 1999
From: erich.neuwirth@univie.ac.at (Erich Neuwirth)
Date: Thu, 30 Sep 1999 03:36:11 +0200
Subject: perl on win32, again
Message-ID: <37F2BE8B.790ADD8C@univie.ac.at>

i downloaded the latest release of perl for win (just a few days old)
and it now has a smarter installation routine.
it puts itself in front of all other dirs (in path),
and it als tells that it tries to remove any other path leading
to another perl.
well,
the offending matlab perl lives in
\matlabr11\bin
and this path also contains the whole matlab stuff,
so it cannot be removed.
but with official perl before matylab in the path,
things now work without fiddling
with the path.


--
Erich Neuwirth, Computer Supported Didactics Working Group
Visit our SunSITE at http://sunsite.univie.ac.at
Phone: +43-1-4277-38624 Fax: +43-1-4277-9386

-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From pgutwin@us.ibm.com  Thu Sep 30 20:18:51 1999
From: pgutwin@us.ibm.com (pgutwin@us.ibm.com)
Date: Thu, 30 Sep 1999 21:18:51 +0200 (MET DST)
Subject: Error compiling R on RS6000 (PR#290)
Message-ID: <199909301918.VAA06212@pubhealth.ku.dk>

Full_Name: Paul Gutwin
Version: 65.0
OS: AIX
Submission from: (NULL) (198.133.22.69)


I get an error when I try to compile R on an RS6000. I ran configure, then make,
and received the following:


.....(stuff deleted)....
	ld -bdynamic -bE:../../etc/R.exp -bM:SRE -lc -lm
/usr/prod/contrib/lib/gcc-lib/rs6000-ibm-aix4.1.4/2.8.1/libgcc.a  -o
../../bin/R.X11 arithmetic.o array.o attrib.o bind.o builtin.o character.o
coerce.o colors.o complex.o context.o cov.o cum.o debug.o devPS.o devPicTeX.o
deparse.o deriv.o devices.o dotcode.o dstruct.o duplicate.o envir.o errors.o
eval.o format.o fourier.o gram.o gram-ex.o graphics.o iosupport.o list.o logic.o
main.o match.o memory.o model.o names.o objects.o optimize.o options.o par.o
paste.o platform.o plot.o plot3d.o plotmath.o print.o printarray.o printvector.o
printutils.o random.o relop.o saveload.o scan.o seq.o sort.o source.o split.o
subassign.o subscript.o subset.o summary.o unique.o util.o version.o
./unix/libunix.a ../appl/libappl.a ../nmath/libmath.a  -lX11  -lblas  -lxlf90
-lxlf -lm /lib/crt0.o -lz -ldl -lncurses -lm 
ld: 0706-006 Cannot find or open library file: -l z
	ld:open(): A file or directory in the path name does not exist.
ld: 0706-006 Cannot find or open library file: -l ncurses
	ld:open(): A file or directory in the path name does not exist.
make: 1254-004 The error code from the last command is 255.


Stop.
make: 1254-004 The error code from the last command is 2.


Stop.
make: 1254-004 The error code from the last command is 1.


Stop.
make: 1254-004 The error code from the last command is 1.


Stop.

Compilation exited abnormally with code 2 at Thu Sep 30 15:09:00


-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

From Thomas Vogels <tov@ece.cmu.edu>  Thu Sep 30 22:21:13 1999
From: Thomas Vogels <tov@ece.cmu.edu> (Thomas Vogels)
Date: Thu, 30 Sep 1999 17:21:13 -0400
Subject: Error compiling R on RS6000 (PR#290)
In-Reply-To: Your message of "Thu, 30 Sep 1999 21:18:51 EDT."
 <199909301918.VAA06212@pubhealth.ku.dk>
Message-ID: <199909302121.RAA22750@infiniti.ece.cmu.edu>


Paul,

  do you have the output from configure?  What probably happens is
that the libs libz.a and libncurses.a get picked up erroneously in the
configure stage.  For a quick fix, could you check whether R compiles
cleanly after adding in config.site:

LIBS="-L/usr/local/lib -lreadline -lcurses"

(Replacing /usr/prod/contrib/lib with the path to the directory where
you find libreadline.a on your system.  Other candidates are /usr/lib or
/usr/prod/contrib/lib.)

  -tom

P.S. which version of AIX are using?

"PG" == pgutwin  <pgutwin@us.ibm.com> writes:

PG> Full_Name: Paul Gutwin
PG> Version: 65.0
PG> OS: AIX
PG> Submission from: (NULL) (198.133.22.69)
PG> 
PG> 
PG> I get an error when I try to compile R on an RS6000. I ran configure, then make,
PG> and received the following:
PG> 
[snip]

-- 
mailto:tov@ece.cmu.edu (Tom Vogels)   Tel: (412) 268-6638   FAX: -3204
-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-
r-devel mailing list -- Read http://www.ci.tuwien.ac.at/~hornik/R/R-FAQ.html
Send "info", "help", or "[un]subscribe"
(in the "body", not the subject !)  To: r-devel-request@stat.math.ethz.ch
_._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._._

